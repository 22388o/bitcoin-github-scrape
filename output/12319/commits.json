[
  {
    "sha": "85751349d15289e562183ae238fe1da3a95007e2",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4NTc1MTM0OWQxNTI4OWU1NjIxODNhZTIzOGZlMWRhM2E5NTAwN2Uy",
    "commit": {
      "author": {
        "name": "Ben Woosley",
        "email": "ben.woosley@gmail.com",
        "date": "2018-01-31T11:36:02Z"
      },
      "committer": {
        "name": "Ben Woosley",
        "email": "ben.woosley@gmail.com",
        "date": "2018-02-16T03:42:28Z"
      },
      "message": "Extract CPubKey::SIGNATURE_SIZE and COMPACT_SIGNATURE_SIZE\n\nAs CPubKeySig::SIZE and COMPACT_SIZE",
      "tree": {
        "sha": "630ffcc036ad7aa718d4fb222c101d81d9644cf6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/630ffcc036ad7aa718d4fb222c101d81d9644cf6"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/85751349d15289e562183ae238fe1da3a95007e2",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQEcBAABCgAGBQJahlMlAAoJEG7l83hfeLNFtCQH/jrzsDrOnQ+J0qsjBMpaUhWi\nu5LZZX/Ojk8wH/B3XqbAFGVXIs5B25Nu7CWjFw1gTC2W4xdbTdw/zEUmxV3LEDx7\n4P7bikYvWqu3bsKzxI+osj9mK+4nXUV5zWNKgRuiwqugWxTwwK7nOSlvfF9pPP0X\njk9lhyCfYmgyvRwz5BFhqvOYYHFhyNsmVzEbfEN+Gr2hEstjtGKiWgOFoBOfOld9\n954DdMCFZfxQMZYhZZyAQzuYxePsmbrJJTgOL9TJm51twYJyraxfgtSvX1uTFZ3j\n82Hb5NOx7IJQO5wxIMDpO83Kd2RhgyiMSv834I9WY4n4wsQHg42RTpVjxvk3v3E=\n=4dnY\n-----END PGP SIGNATURE-----",
        "payload": "tree 630ffcc036ad7aa718d4fb222c101d81d9644cf6\nparent a233fb4f1d037e68ff70eef3a9f5b7bf1d631918\nauthor Ben Woosley <ben.woosley@gmail.com> 1517398562 -0800\ncommitter Ben Woosley <ben.woosley@gmail.com> 1518752548 -0800\n\nExtract CPubKey::SIGNATURE_SIZE and COMPACT_SIGNATURE_SIZE\n\nAs CPubKeySig::SIZE and COMPACT_SIZE\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/85751349d15289e562183ae238fe1da3a95007e2",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/85751349d15289e562183ae238fe1da3a95007e2",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/85751349d15289e562183ae238fe1da3a95007e2/comments",
    "author": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "a233fb4f1d037e68ff70eef3a9f5b7bf1d631918",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a233fb4f1d037e68ff70eef3a9f5b7bf1d631918",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/a233fb4f1d037e68ff70eef3a9f5b7bf1d631918"
      }
    ],
    "stats": {
      "total": 20,
      "additions": 14,
      "deletions": 6
    },
    "files": [
      {
        "sha": "2cd8f1c387155160686c96be045a1b93121e95d0",
        "filename": "src/key.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 3,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/85751349d15289e562183ae238fe1da3a95007e2/src/key.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/85751349d15289e562183ae238fe1da3a95007e2/src/key.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/key.cpp?ref=85751349d15289e562183ae238fe1da3a95007e2",
        "patch": "@@ -192,8 +192,8 @@ CPubKey CKey::GetPubKey() const {\n bool CKey::Sign(const uint256 &hash, std::vector<unsigned char>& vchSig, uint32_t test_case) const {\n     if (!fValid)\n         return false;\n-    vchSig.resize(CPubKey::SIGNATURE_SIZE);\n-    size_t nSigLen = CPubKey::SIGNATURE_SIZE;\n+    vchSig.resize(CPubKeySig::SIZE);\n+    size_t nSigLen = CPubKeySig::SIZE;\n     unsigned char extra_entropy[32] = {0};\n     WriteLE32(extra_entropy, test_case);\n     secp256k1_ecdsa_signature sig;\n@@ -221,7 +221,7 @@ bool CKey::VerifyPubKey(const CPubKey& pubkey) const {\n bool CKey::SignCompact(const uint256 &hash, std::vector<unsigned char>& vchSig) const {\n     if (!fValid)\n         return false;\n-    vchSig.resize(CPubKey::COMPACT_SIGNATURE_SIZE);\n+    vchSig.resize(CPubKeySig::COMPACT_SIZE);\n     int rec = -1;\n     secp256k1_ecdsa_recoverable_signature sig;\n     int ret = secp256k1_ecdsa_sign_recoverable(secp256k1_context_sign, &sig, hash.begin(), begin(), secp256k1_nonce_function_rfc6979, nullptr);"
      },
      {
        "sha": "794df2570946943812a932c767770b9d774491bd",
        "filename": "src/pubkey.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/85751349d15289e562183ae238fe1da3a95007e2/src/pubkey.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/85751349d15289e562183ae238fe1da3a95007e2/src/pubkey.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/pubkey.cpp?ref=85751349d15289e562183ae238fe1da3a95007e2",
        "patch": "@@ -184,7 +184,7 @@ bool CPubKey::Verify(const uint256 &hash, const std::vector<unsigned char>& vchS\n }\n \n bool CPubKey::RecoverCompact(const uint256 &hash, const std::vector<unsigned char>& vchSig) {\n-    if (vchSig.size() != COMPACT_SIGNATURE_SIZE)\n+    if (vchSig.size() != CPubKeySig::COMPACT_SIZE)\n         return false;\n     int recid = (vchSig[0] - 27) & 3;\n     bool fComp = ((vchSig[0] - 27) & 4) != 0;"
      },
      {
        "sha": "d1b428fc9e0d55cd632aa5f1d50534462ec19910",
        "filename": "src/pubkey.h",
        "status": "modified",
        "additions": 10,
        "deletions": 2,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/85751349d15289e562183ae238fe1da3a95007e2/src/pubkey.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/85751349d15289e562183ae238fe1da3a95007e2/src/pubkey.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/pubkey.h?ref=85751349d15289e562183ae238fe1da3a95007e2",
        "patch": "@@ -26,6 +26,16 @@ class CKeyID : public uint160\n \n typedef uint256 ChainCode;\n \n+class CPubKeySig\n+{\n+public:\n+    /**\n+     * secp256k1:\n+     */\n+    static const unsigned int SIZE         = 72;\n+    static const unsigned int COMPACT_SIZE = 65;\n+};\n+\n /** An encapsulated public key. */\n class CPubKey\n {\n@@ -35,8 +45,6 @@ class CPubKey\n      */\n     static const unsigned int PUBLIC_KEY_SIZE             = 65;\n     static const unsigned int COMPRESSED_PUBLIC_KEY_SIZE  = 33;\n-    static const unsigned int SIGNATURE_SIZE              = 72;\n-    static const unsigned int COMPACT_SIGNATURE_SIZE      = 65;\n     /**\n      * see www.keylength.com\n      * script supports up to 75 for single byte push"
      }
    ]
  },
  {
    "sha": "7d4e713cf728819990b1a2a34064a2d136fa5184",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3ZDRlNzEzY2Y3Mjg4MTk5OTBiMWEyYTM0MDY0YTJkMTM2ZmE1MTg0",
    "commit": {
      "author": {
        "name": "Ben Woosley",
        "email": "ben.woosley@gmail.com",
        "date": "2018-01-31T11:39:23Z"
      },
      "committer": {
        "name": "Ben Woosley",
        "email": "ben.woosley@gmail.com",
        "date": "2018-02-16T03:42:29Z"
      },
      "message": "Rename CPubKey::PUBLIC_KEY_SIZE and COMPRESSED_PUBLIC_KEY_SIZE\n\nAs SIZE and COMPRESSED_SIZE",
      "tree": {
        "sha": "7cae0f9cb096453715bfa1b6817d275139e1f938",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7cae0f9cb096453715bfa1b6817d275139e1f938"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7d4e713cf728819990b1a2a34064a2d136fa5184",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQEcBAABCgAGBQJahlMlAAoJEG7l83hfeLNFIAEH/RbreC98KpwQzsKeBedLcTTL\nAeR/Ix5QYtuiHkmkgTtip74jSwVaLmBZbvO0eNqotpoEVa0xUV+5FTdeUHYqfO9F\ndy5tDu124GmI4fif3noGbF+uRnXba5Rbk0EtgUVoxLY0gJieXv5Cy0IB1QGezcHK\nZ+Fesz37gjYpLa1CBMW4EjF2cRf12VZHimCC+JXoDSK6Em96PFjdzUyqxb+vpWhh\n9UDWkISo4M55QKmwl8lwpbMJ/9/p6iOrU1huvHFOcobRj45sJgNp5EV00FurQKUx\nulP5tuyrPI2sad33Qt9WQ/pmKq7VBIGef6cM6g0nsvyFAAqZVKe4XADeXo+qfqc=\n=dr6o\n-----END PGP SIGNATURE-----",
        "payload": "tree 7cae0f9cb096453715bfa1b6817d275139e1f938\nparent 85751349d15289e562183ae238fe1da3a95007e2\nauthor Ben Woosley <ben.woosley@gmail.com> 1517398763 -0800\ncommitter Ben Woosley <ben.woosley@gmail.com> 1518752549 -0800\n\nRename CPubKey::PUBLIC_KEY_SIZE and COMPRESSED_PUBLIC_KEY_SIZE\n\nAs SIZE and COMPRESSED_SIZE\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7d4e713cf728819990b1a2a34064a2d136fa5184",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/7d4e713cf728819990b1a2a34064a2d136fa5184",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7d4e713cf728819990b1a2a34064a2d136fa5184/comments",
    "author": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "85751349d15289e562183ae238fe1da3a95007e2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/85751349d15289e562183ae238fe1da3a95007e2",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/85751349d15289e562183ae238fe1da3a95007e2"
      }
    ],
    "stats": {
      "total": 44,
      "additions": 22,
      "deletions": 22
    },
    "files": [
      {
        "sha": "dbc42577a972cd053df8ade7d1db5ee53977cf53",
        "filename": "src/key.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 4,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7d4e713cf728819990b1a2a34064a2d136fa5184/src/key.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7d4e713cf728819990b1a2a34064a2d136fa5184/src/key.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/key.cpp?ref=7d4e713cf728819990b1a2a34064a2d136fa5184",
        "patch": "@@ -116,7 +116,7 @@ static int ec_privkey_export_der(const secp256k1_context *ctx, unsigned char *pr\n         memcpy(ptr, begin, sizeof(begin)); ptr += sizeof(begin);\n         memcpy(ptr, key32, 32); ptr += 32;\n         memcpy(ptr, middle, sizeof(middle)); ptr += sizeof(middle);\n-        pubkeylen = CPubKey::COMPRESSED_PUBLIC_KEY_SIZE;\n+        pubkeylen = CPubKey::COMPRESSED_SIZE;\n         secp256k1_ec_pubkey_serialize(ctx, ptr, &pubkeylen, &pubkey, SECP256K1_EC_COMPRESSED);\n         ptr += pubkeylen;\n         *privkeylen = ptr - privkey;\n@@ -142,7 +142,7 @@ static int ec_privkey_export_der(const secp256k1_context *ctx, unsigned char *pr\n         memcpy(ptr, begin, sizeof(begin)); ptr += sizeof(begin);\n         memcpy(ptr, key32, 32); ptr += 32;\n         memcpy(ptr, middle, sizeof(middle)); ptr += sizeof(middle);\n-        pubkeylen = CPubKey::PUBLIC_KEY_SIZE;\n+        pubkeylen = CPubKey::SIZE;\n         secp256k1_ec_pubkey_serialize(ctx, ptr, &pubkeylen, &pubkey, SECP256K1_EC_UNCOMPRESSED);\n         ptr += pubkeylen;\n         *privkeylen = ptr - privkey;\n@@ -179,7 +179,7 @@ CPrivKey CKey::GetPrivKey() const {\n CPubKey CKey::GetPubKey() const {\n     assert(fValid);\n     secp256k1_pubkey pubkey;\n-    size_t clen = CPubKey::PUBLIC_KEY_SIZE;\n+    size_t clen = CPubKey::SIZE;\n     CPubKey result;\n     int ret = secp256k1_ec_pubkey_create(secp256k1_context_sign, &pubkey, begin());\n     assert(ret);\n@@ -251,7 +251,7 @@ bool CKey::Derive(CKey& keyChild, ChainCode &ccChild, unsigned int nChild, const\n     std::vector<unsigned char, secure_allocator<unsigned char>> vout(64);\n     if ((nChild >> 31) == 0) {\n         CPubKey pubkey = GetPubKey();\n-        assert(pubkey.size() == CPubKey::COMPRESSED_PUBLIC_KEY_SIZE);\n+        assert(pubkey.size() == CPubKey::COMPRESSED_SIZE);\n         BIP32Hash(cc, nChild, *pubkey.begin(), pubkey.begin()+1, vout.data());\n     } else {\n         assert(size() == 32);"
      },
      {
        "sha": "40268fd29881994efeb9a4d8a47cff052ceca406",
        "filename": "src/pubkey.cpp",
        "status": "modified",
        "additions": 9,
        "deletions": 9,
        "changes": 18,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7d4e713cf728819990b1a2a34064a2d136fa5184/src/pubkey.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7d4e713cf728819990b1a2a34064a2d136fa5184/src/pubkey.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/pubkey.cpp?ref=7d4e713cf728819990b1a2a34064a2d136fa5184",
        "patch": "@@ -196,8 +196,8 @@ bool CPubKey::RecoverCompact(const uint256 &hash, const std::vector<unsigned cha\n     if (!secp256k1_ecdsa_recover(secp256k1_context_verify, &pubkey, &sig, hash.begin())) {\n         return false;\n     }\n-    unsigned char pub[PUBLIC_KEY_SIZE];\n-    size_t publen = PUBLIC_KEY_SIZE;\n+    unsigned char pub[SIZE];\n+    size_t publen = SIZE;\n     secp256k1_ec_pubkey_serialize(secp256k1_context_verify, pub, &publen, &pubkey, fComp ? SECP256K1_EC_COMPRESSED : SECP256K1_EC_UNCOMPRESSED);\n     Set(pub, pub + publen);\n     return true;\n@@ -217,8 +217,8 @@ bool CPubKey::Decompress() {\n     if (!secp256k1_ec_pubkey_parse(secp256k1_context_verify, &pubkey, &(*this)[0], size())) {\n         return false;\n     }\n-    unsigned char pub[PUBLIC_KEY_SIZE];\n-    size_t publen = PUBLIC_KEY_SIZE;\n+    unsigned char pub[SIZE];\n+    size_t publen = SIZE;\n     secp256k1_ec_pubkey_serialize(secp256k1_context_verify, pub, &publen, &pubkey, SECP256K1_EC_UNCOMPRESSED);\n     Set(pub, pub + publen);\n     return true;\n@@ -227,7 +227,7 @@ bool CPubKey::Decompress() {\n bool CPubKey::Derive(CPubKey& pubkeyChild, ChainCode &ccChild, unsigned int nChild, const ChainCode& cc) const {\n     assert(IsValid());\n     assert((nChild >> 31) == 0);\n-    assert(size() == COMPRESSED_PUBLIC_KEY_SIZE);\n+    assert(size() == COMPRESSED_SIZE);\n     unsigned char out[64];\n     BIP32Hash(cc, nChild, *begin(), begin()+1, out);\n     memcpy(ccChild.begin(), out+32, 32);\n@@ -238,8 +238,8 @@ bool CPubKey::Derive(CPubKey& pubkeyChild, ChainCode &ccChild, unsigned int nChi\n     if (!secp256k1_ec_pubkey_tweak_add(secp256k1_context_verify, &pubkey, out)) {\n         return false;\n     }\n-    unsigned char pub[COMPRESSED_PUBLIC_KEY_SIZE];\n-    size_t publen = COMPRESSED_PUBLIC_KEY_SIZE;\n+    unsigned char pub[COMPRESSED_SIZE];\n+    size_t publen = COMPRESSED_SIZE;\n     secp256k1_ec_pubkey_serialize(secp256k1_context_verify, pub, &publen, &pubkey, SECP256K1_EC_COMPRESSED);\n     pubkeyChild.Set(pub, pub + publen);\n     return true;\n@@ -251,8 +251,8 @@ void CExtPubKey::Encode(unsigned char code[BIP32_EXTKEY_SIZE]) const {\n     code[5] = (nChild >> 24) & 0xFF; code[6] = (nChild >> 16) & 0xFF;\n     code[7] = (nChild >>  8) & 0xFF; code[8] = (nChild >>  0) & 0xFF;\n     memcpy(code+9, chaincode.begin(), 32);\n-    assert(pubkey.size() == CPubKey::COMPRESSED_PUBLIC_KEY_SIZE);\n-    memcpy(code+41, pubkey.begin(), CPubKey::COMPRESSED_PUBLIC_KEY_SIZE);\n+    assert(pubkey.size() == CPubKey::COMPRESSED_SIZE);\n+    memcpy(code+41, pubkey.begin(), CPubKey::COMPRESSED_SIZE);\n }\n \n void CExtPubKey::Decode(const unsigned char code[BIP32_EXTKEY_SIZE]) {"
      },
      {
        "sha": "5b8a6c2bd772ee63bf8432e0e4bad1d8ee1fb016",
        "filename": "src/pubkey.h",
        "status": "modified",
        "additions": 9,
        "deletions": 9,
        "changes": 18,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7d4e713cf728819990b1a2a34064a2d136fa5184/src/pubkey.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7d4e713cf728819990b1a2a34064a2d136fa5184/src/pubkey.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/pubkey.h?ref=7d4e713cf728819990b1a2a34064a2d136fa5184",
        "patch": "@@ -43,31 +43,31 @@ class CPubKey\n     /**\n      * secp256k1:\n      */\n-    static const unsigned int PUBLIC_KEY_SIZE             = 65;\n-    static const unsigned int COMPRESSED_PUBLIC_KEY_SIZE  = 33;\n+    static const unsigned int SIZE            = 65;\n+    static const unsigned int COMPRESSED_SIZE = 33;\n     /**\n      * see www.keylength.com\n      * script supports up to 75 for single byte push\n      */\n     static_assert(\n-        PUBLIC_KEY_SIZE >= COMPRESSED_PUBLIC_KEY_SIZE,\n-        \"COMPRESSED_PUBLIC_KEY_SIZE is larger than PUBLIC_KEY_SIZE\");\n+        SIZE >= COMPRESSED_SIZE,\n+        \"COMPRESSED_SIZE is larger than SIZE\");\n \n private:\n \n     /**\n      * Just store the serialized data.\n      * Its length can very cheaply be computed from the first byte.\n      */\n-    unsigned char vch[PUBLIC_KEY_SIZE];\n+    unsigned char vch[SIZE];\n \n     //! Compute the length of a pubkey with a given first byte.\n     unsigned int static GetLen(unsigned char chHeader)\n     {\n         if (chHeader == 2 || chHeader == 3)\n-            return COMPRESSED_PUBLIC_KEY_SIZE;\n+            return COMPRESSED_SIZE;\n         if (chHeader == 4 || chHeader == 6 || chHeader == 7)\n-            return PUBLIC_KEY_SIZE;\n+            return SIZE;\n         return 0;\n     }\n \n@@ -142,7 +142,7 @@ class CPubKey\n     void Unserialize(Stream& s)\n     {\n         unsigned int len = ::ReadCompactSize(s);\n-        if (len <= PUBLIC_KEY_SIZE) {\n+        if (len <= SIZE) {\n             s.read((char*)vch, len);\n         } else {\n             // invalid pubkey, skip available data\n@@ -181,7 +181,7 @@ class CPubKey\n     //! Check whether this is a compressed public key.\n     bool IsCompressed() const\n     {\n-        return size() == COMPRESSED_PUBLIC_KEY_SIZE;\n+        return size() == COMPRESSED_SIZE;\n     }\n \n     /**"
      }
    ]
  },
  {
    "sha": "1ff95cc7cf1b0cdc30b0ebc50491078c2dec20c9",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxZmY5NWNjN2NmMWIwY2RjMzBiMGViYzUwNDkxMDc4YzJkZWMyMGM5",
    "commit": {
      "author": {
        "name": "Ben Woosley",
        "email": "ben.woosley@gmail.com",
        "date": "2018-01-31T12:37:55Z"
      },
      "committer": {
        "name": "Ben Woosley",
        "email": "ben.woosley@gmail.com",
        "date": "2018-02-16T03:42:29Z"
      },
      "message": "Rename CKey::PRIVATE_KEY_SIZE and COMPRESSED_PRIVATE_KEY_SIZE\n\nTo SIZE and COMPRESSED_SIZE",
      "tree": {
        "sha": "0f4539d198af027ca916afad43db8e6f0e1b6ff6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0f4539d198af027ca916afad43db8e6f0e1b6ff6"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1ff95cc7cf1b0cdc30b0ebc50491078c2dec20c9",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQEcBAABCgAGBQJahlMlAAoJEG7l83hfeLNF+G0H/jJUrxrO5tT7gMZ/KRgvgilV\n32+dNI+tKwbR+o+V+KCDg+NGwMLSqvv1xETZA+nayUaoahUeHIpgMUAgH2sw5n1J\n8d+Vp7OAO0j5hLUOijI+jSDrAmdE02h+w/in2T5jPPxmC/DgJuNVPT3XCV0R0gwz\nEqp9ni2Zc/ep/WVlNfZT20A4yk2ssg/DPeqfunBlTYbH1RJ10SLauJg8MOdVUzmI\nAHCiFRDvmClnjeQ84JJDFe+sCf81kOSC6DCs7aGDfYP32/ciZ6/KwALhh5g3MFPW\nrrZycS7a1MBRvUuE3XraSyqCXPi9AC3EkakeUFHWjmyYfyBduFgS4UahYP5oXYs=\n=imb/\n-----END PGP SIGNATURE-----",
        "payload": "tree 0f4539d198af027ca916afad43db8e6f0e1b6ff6\nparent 7d4e713cf728819990b1a2a34064a2d136fa5184\nauthor Ben Woosley <ben.woosley@gmail.com> 1517402275 -0800\ncommitter Ben Woosley <ben.woosley@gmail.com> 1518752549 -0800\n\nRename CKey::PRIVATE_KEY_SIZE and COMPRESSED_PRIVATE_KEY_SIZE\n\nTo SIZE and COMPRESSED_SIZE\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1ff95cc7cf1b0cdc30b0ebc50491078c2dec20c9",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/1ff95cc7cf1b0cdc30b0ebc50491078c2dec20c9",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1ff95cc7cf1b0cdc30b0ebc50491078c2dec20c9/comments",
    "author": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "7d4e713cf728819990b1a2a34064a2d136fa5184",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7d4e713cf728819990b1a2a34064a2d136fa5184",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/7d4e713cf728819990b1a2a34064a2d136fa5184"
      }
    ],
    "stats": {
      "total": 22,
      "additions": 11,
      "deletions": 11
    },
    "files": [
      {
        "sha": "45d35ec4daccaa1d601816bbbfc3f405d194a9d2",
        "filename": "src/key.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 6,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1ff95cc7cf1b0cdc30b0ebc50491078c2dec20c9/src/key.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1ff95cc7cf1b0cdc30b0ebc50491078c2dec20c9/src/key.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/key.cpp?ref=1ff95cc7cf1b0cdc30b0ebc50491078c2dec20c9",
        "patch": "@@ -84,13 +84,13 @@ static int ec_privkey_import_der(const secp256k1_context* ctx, unsigned char *ou\n  * <http://www.secg.org/sec1-v2.pdf>. The optional parameters and publicKey fields are\n  * included.\n  *\n- * privkey must point to an output buffer of length at least CKey::PRIVATE_KEY_SIZE bytes.\n+ * privkey must point to an output buffer of length at least CKey::SIZE bytes.\n  * privkeylen must initially be set to the size of the privkey buffer. Upon return it\n  * will be set to the number of bytes used in the buffer.\n  * key32 must point to a 32-byte raw private key.\n  */\n static int ec_privkey_export_der(const secp256k1_context *ctx, unsigned char *privkey, size_t *privkeylen, const unsigned char *key32, int compressed) {\n-    assert(*privkeylen >= CKey::PRIVATE_KEY_SIZE);\n+    assert(*privkeylen >= CKey::SIZE);\n     secp256k1_pubkey pubkey;\n     size_t pubkeylen = 0;\n     if (!secp256k1_ec_pubkey_create(ctx, &pubkey, key32)) {\n@@ -120,7 +120,7 @@ static int ec_privkey_export_der(const secp256k1_context *ctx, unsigned char *pr\n         secp256k1_ec_pubkey_serialize(ctx, ptr, &pubkeylen, &pubkey, SECP256K1_EC_COMPRESSED);\n         ptr += pubkeylen;\n         *privkeylen = ptr - privkey;\n-        assert(*privkeylen == CKey::COMPRESSED_PRIVATE_KEY_SIZE);\n+        assert(*privkeylen == CKey::COMPRESSED_SIZE);\n     } else {\n         static const unsigned char begin[] = {\n             0x30,0x82,0x01,0x13,0x02,0x01,0x01,0x04,0x20\n@@ -146,7 +146,7 @@ static int ec_privkey_export_der(const secp256k1_context *ctx, unsigned char *pr\n         secp256k1_ec_pubkey_serialize(ctx, ptr, &pubkeylen, &pubkey, SECP256K1_EC_UNCOMPRESSED);\n         ptr += pubkeylen;\n         *privkeylen = ptr - privkey;\n-        assert(*privkeylen == CKey::PRIVATE_KEY_SIZE);\n+        assert(*privkeylen == CKey::SIZE);\n     }\n     return 1;\n }\n@@ -168,8 +168,8 @@ CPrivKey CKey::GetPrivKey() const {\n     CPrivKey privkey;\n     int ret;\n     size_t privkeylen;\n-    privkey.resize(PRIVATE_KEY_SIZE);\n-    privkeylen = PRIVATE_KEY_SIZE;\n+    privkey.resize(SIZE);\n+    privkeylen = SIZE;\n     ret = ec_privkey_export_der(secp256k1_context_sign, (unsigned char*) privkey.data(), &privkeylen, begin(), fCompressed ? SECP256K1_EC_COMPRESSED : SECP256K1_EC_UNCOMPRESSED);\n     assert(ret);\n     privkey.resize(privkeylen);"
      },
      {
        "sha": "116f64a3974225001a352b7b80149ba6378d05dd",
        "filename": "src/key.h",
        "status": "modified",
        "additions": 5,
        "deletions": 5,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1ff95cc7cf1b0cdc30b0ebc50491078c2dec20c9/src/key.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1ff95cc7cf1b0cdc30b0ebc50491078c2dec20c9/src/key.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/key.h?ref=1ff95cc7cf1b0cdc30b0ebc50491078c2dec20c9",
        "patch": "@@ -19,7 +19,7 @@\n /**\n  * secure_allocator is defined in allocators.h\n  * CPrivKey is a serialized private key, with all parameters included\n- * (PRIVATE_KEY_SIZE bytes)\n+ * (SIZE bytes)\n  */\n typedef std::vector<unsigned char, secure_allocator<unsigned char> > CPrivKey;\n \n@@ -30,15 +30,15 @@ class CKey\n     /**\n      * secp256k1:\n      */\n-    static const unsigned int PRIVATE_KEY_SIZE            = 279;\n-    static const unsigned int COMPRESSED_PRIVATE_KEY_SIZE = 214;\n+    static const unsigned int SIZE            = 279;\n+    static const unsigned int COMPRESSED_SIZE = 214;\n     /**\n      * see www.keylength.com\n      * script supports up to 75 for single byte push\n      */\n     static_assert(\n-        PRIVATE_KEY_SIZE >= COMPRESSED_PRIVATE_KEY_SIZE,\n-        \"COMPRESSED_PRIVATE_KEY_SIZE is larger than PRIVATE_KEY_SIZE\");\n+        SIZE >= COMPRESSED_SIZE,\n+        \"COMPRESSED_SIZE is larger than SIZE\");\n \n private:\n     //! Whether this private key is valid. We check for correctness when modifying the key"
      }
    ]
  },
  {
    "sha": "80a2c3aed77aff39dc0967d306f1d21f35c822fe",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4MGEyYzNhZWQ3N2FmZjM5ZGMwOTY3ZDMwNmYxZDIxZjM1YzgyMmZl",
    "commit": {
      "author": {
        "name": "Ben Woosley",
        "email": "ben.woosley@gmail.com",
        "date": "2018-01-31T12:06:58Z"
      },
      "committer": {
        "name": "Ben Woosley",
        "email": "ben.woosley@gmail.com",
        "date": "2018-02-16T03:43:49Z"
      },
      "message": "Assert CPubKey::ValidLength to the pubkey's header-relevent size\n\nPreviously this was an inline test where the specificity was probably judged\noverly specific. As a class method it makes sense to maintain consistency.",
      "tree": {
        "sha": "f28125581a702b645a9bc3a4bcbe725f2fcea356",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f28125581a702b645a9bc3a4bcbe725f2fcea356"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/80a2c3aed77aff39dc0967d306f1d21f35c822fe",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQEcBAABCgAGBQJahlN8AAoJEG7l83hfeLNFAd4IALHQSjhCBF+mL2+YrTSAoQf3\ndZnJ0wvEcOpGnbFyhhecmRoHDUft/hBjCdHd3MUAodFvgoRia0yKgpg7TTVjb6+i\nhGi3fdDIdKD2AFxZHOjZDC4NroBTahFCZ9wLyP9j2ZotTV9jDcCZzLvyMReOcIS9\nc3KGHl0vCo2lUPO18Zchp2/Js9n+q8SEXmI5k6qXkr/s3Mp9NKugg6nlZDyTl2r0\nrPiSJ3PIZPMeWeUnjwDXe+aqZ4n+0TxZ/Qfx3aOp7G9+pWQqGZDX/iQQBv+smBbm\n71OUOX2zD0b82LBLZisxc4TdsQ5fH7nQV6ahC+rmvDfnYzpgUF3w8rnEyEp/OKM=\n=0nD6\n-----END PGP SIGNATURE-----",
        "payload": "tree f28125581a702b645a9bc3a4bcbe725f2fcea356\nparent 1ff95cc7cf1b0cdc30b0ebc50491078c2dec20c9\nauthor Ben Woosley <ben.woosley@gmail.com> 1517400418 +0000\ncommitter Ben Woosley <ben.woosley@gmail.com> 1518752629 -0800\n\nAssert CPubKey::ValidLength to the pubkey's header-relevent size\n\nPreviously this was an inline test where the specificity was probably judged\noverly specific. As a class method it makes sense to maintain consistency.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/80a2c3aed77aff39dc0967d306f1d21f35c822fe",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/80a2c3aed77aff39dc0967d306f1d21f35c822fe",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/80a2c3aed77aff39dc0967d306f1d21f35c822fe/comments",
    "author": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "1ff95cc7cf1b0cdc30b0ebc50491078c2dec20c9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1ff95cc7cf1b0cdc30b0ebc50491078c2dec20c9",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/1ff95cc7cf1b0cdc30b0ebc50491078c2dec20c9"
      }
    ],
    "stats": {
      "total": 19,
      "additions": 12,
      "deletions": 7
    },
    "files": [
      {
        "sha": "e3f2a1700975ae4148e73c67d31843c0f6009056",
        "filename": "src/keystore.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/80a2c3aed77aff39dc0967d306f1d21f35c822fe/src/keystore.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/80a2c3aed77aff39dc0967d306f1d21f35c822fe/src/keystore.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/keystore.cpp?ref=80a2c3aed77aff39dc0967d306f1d21f35c822fe",
        "patch": "@@ -131,7 +131,7 @@ static bool ExtractPubKey(const CScript &dest, CPubKey& pubKeyOut)\n     CScript::const_iterator pc = dest.begin();\n     opcodetype opcode;\n     std::vector<unsigned char> vch;\n-    if (!dest.GetOp(pc, opcode, vch) || vch.size() < 33 || vch.size() > 65)\n+    if (!dest.GetOp(pc, opcode, vch) || !CPubKey::ValidSize(vch))\n         return false;\n     pubKeyOut = CPubKey(vch);\n     if (!pubKeyOut.IsFullyValid())"
      },
      {
        "sha": "0b65f3cf24f2076d64033685efdf9df449db8db5",
        "filename": "src/pubkey.h",
        "status": "modified",
        "additions": 5,
        "deletions": 0,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/80a2c3aed77aff39dc0967d306f1d21f35c822fe/src/pubkey.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/80a2c3aed77aff39dc0967d306f1d21f35c822fe/src/pubkey.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/pubkey.h?ref=80a2c3aed77aff39dc0967d306f1d21f35c822fe",
        "patch": "@@ -78,6 +78,11 @@ class CPubKey\n     }\n \n public:\n+\n+    bool static ValidSize(const std::vector<unsigned char> &vch) {\n+      return vch.size() > 0 && GetLen(vch[0]) == vch.size();\n+    }\n+\n     //! Construct an invalid public key.\n     CPubKey()\n     {"
      },
      {
        "sha": "3b02dcc76415a498840d54ab56e80b3b16faec61",
        "filename": "src/script/interpreter.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 4,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/80a2c3aed77aff39dc0967d306f1d21f35c822fe/src/script/interpreter.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/80a2c3aed77aff39dc0967d306f1d21f35c822fe/src/script/interpreter.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script/interpreter.cpp?ref=80a2c3aed77aff39dc0967d306f1d21f35c822fe",
        "patch": "@@ -61,17 +61,17 @@ static inline void popstack(std::vector<valtype>& stack)\n }\n \n bool static IsCompressedOrUncompressedPubKey(const valtype &vchPubKey) {\n-    if (vchPubKey.size() < 33) {\n+    if (vchPubKey.size() < CPubKey::COMPRESSED_SIZE) {\n         //  Non-canonical public key: too short\n         return false;\n     }\n     if (vchPubKey[0] == 0x04) {\n-        if (vchPubKey.size() != 65) {\n+        if (vchPubKey.size() != CPubKey::SIZE) {\n             //  Non-canonical public key: invalid length for uncompressed key\n             return false;\n         }\n     } else if (vchPubKey[0] == 0x02 || vchPubKey[0] == 0x03) {\n-        if (vchPubKey.size() != 33) {\n+        if (vchPubKey.size() != CPubKey::COMPRESSED_SIZE) {\n             //  Non-canonical public key: invalid length for compressed key\n             return false;\n         }\n@@ -83,7 +83,7 @@ bool static IsCompressedOrUncompressedPubKey(const valtype &vchPubKey) {\n }\n \n bool static IsCompressedPubKey(const valtype &vchPubKey) {\n-    if (vchPubKey.size() != 33) {\n+    if (vchPubKey.size() != CPubKey::COMPRESSED_SIZE) {\n         //  Non-canonical public key: invalid length for compressed key\n         return false;\n     }"
      },
      {
        "sha": "0b9053d7fcff75f25daa4d78446236ba89763887",
        "filename": "src/script/standard.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/80a2c3aed77aff39dc0967d306f1d21f35c822fe/src/script/standard.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/80a2c3aed77aff39dc0967d306f1d21f35c822fe/src/script/standard.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script/standard.cpp?ref=80a2c3aed77aff39dc0967d306f1d21f35c822fe",
        "patch": "@@ -132,7 +132,7 @@ bool Solver(const CScript& scriptPubKey, txnouttype& typeRet, std::vector<std::v\n             // Template matching opcodes:\n             if (opcode2 == OP_PUBKEYS)\n             {\n-                while (vch1.size() >= 33 && vch1.size() <= 65)\n+                while (CPubKey::ValidSize(vch1))\n                 {\n                     vSolutionsRet.push_back(vch1);\n                     if (!script1.GetOp(pc1, opcode1, vch1))\n@@ -146,7 +146,7 @@ bool Solver(const CScript& scriptPubKey, txnouttype& typeRet, std::vector<std::v\n \n             if (opcode2 == OP_PUBKEY)\n             {\n-                if (vch1.size() < 33 || vch1.size() > 65)\n+                if (!CPubKey::ValidSize(vch1))\n                     break;\n                 vSolutionsRet.push_back(vch1);\n             }"
      }
    ]
  },
  {
    "sha": "6d024f82cee3335e8e7ccd4303e23392f230a952",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2ZDAyNGY4MmNlZTMzMzVlOGU3Y2NkNDMwM2UyMzM5MmYyMzBhOTUy",
    "commit": {
      "author": {
        "name": "Ben Woosley",
        "email": "ben.woosley@gmail.com",
        "date": "2018-02-04T10:27:08Z"
      },
      "committer": {
        "name": "Ben Woosley",
        "email": "ben.woosley@gmail.com",
        "date": "2018-02-16T03:43:56Z"
      },
      "message": "Assert compressed / compact keys and sigs are strictly shorter than regular\n\nThis is currently true and intuitively expected\n\nReword COMPRESSED_SIZE static assert message to make the desired arrangement\nexplicit.",
      "tree": {
        "sha": "81dd4e451c1f0f32aff9cd171a05801821486122",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/81dd4e451c1f0f32aff9cd171a05801821486122"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6d024f82cee3335e8e7ccd4303e23392f230a952",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQEcBAABCgAGBQJahlN8AAoJEG7l83hfeLNFzGYIAJnuIdKFvncGHv2NF9p0mvq2\nVZ7mcjrGB9SxfpWbnpDGVX8bVlTlEMuLHvUvbCQoU0SDEpewb848yWQf/g6lR4I4\nOiL3Mb/nwm7VBth4ACcnsQ564ghfIGj075Gr3H48sTKrOuoaSfmJ+pHZ1AsKz5BC\nhaBNP0vAP2KRfKWIXwclpjY7wsVlzClEOIOx8NDHM3FaHnvA0sM98Gefsx0A59oM\nmJsIPBuGdz6yuIvzlHpeJx1pHKVYe6JHzBUFbqKXc0ZSyA0x/OOmNE/HycwL9d6h\nRI+7v+LGieS2iK/SPfJK6cR8rPLDvN2Q0sdtdszpFAeEbcLRTAZuijmQm4yGnYs=\n=/Gfd\n-----END PGP SIGNATURE-----",
        "payload": "tree 81dd4e451c1f0f32aff9cd171a05801821486122\nparent 80a2c3aed77aff39dc0967d306f1d21f35c822fe\nauthor Ben Woosley <ben.woosley@gmail.com> 1517740028 -0800\ncommitter Ben Woosley <ben.woosley@gmail.com> 1518752636 -0800\n\nAssert compressed / compact keys and sigs are strictly shorter than regular\n\nThis is currently true and intuitively expected\n\nReword COMPRESSED_SIZE static assert message to make the desired arrangement\nexplicit.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6d024f82cee3335e8e7ccd4303e23392f230a952",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/6d024f82cee3335e8e7ccd4303e23392f230a952",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6d024f82cee3335e8e7ccd4303e23392f230a952/comments",
    "author": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "80a2c3aed77aff39dc0967d306f1d21f35c822fe",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/80a2c3aed77aff39dc0967d306f1d21f35c822fe",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/80a2c3aed77aff39dc0967d306f1d21f35c822fe"
      }
    ],
    "stats": {
      "total": 12,
      "additions": 8,
      "deletions": 4
    },
    "files": [
      {
        "sha": "4ec7a1dbdc8a2e111af58c446b48b438aa734c51",
        "filename": "src/key.h",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6d024f82cee3335e8e7ccd4303e23392f230a952/src/key.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6d024f82cee3335e8e7ccd4303e23392f230a952/src/key.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/key.h?ref=6d024f82cee3335e8e7ccd4303e23392f230a952",
        "patch": "@@ -37,8 +37,8 @@ class CKey\n      * script supports up to 75 for single byte push\n      */\n     static_assert(\n-        SIZE >= COMPRESSED_SIZE,\n-        \"COMPRESSED_SIZE is larger than SIZE\");\n+        SIZE > COMPRESSED_SIZE,\n+        \"COMPRESSED_SIZE should be smaller than SIZE\");\n \n private:\n     //! Whether this private key is valid. We check for correctness when modifying the key"
      },
      {
        "sha": "150cb46eef5b52180c1b98b4c155e322bde5ff3d",
        "filename": "src/pubkey.h",
        "status": "modified",
        "additions": 6,
        "deletions": 2,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6d024f82cee3335e8e7ccd4303e23392f230a952/src/pubkey.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6d024f82cee3335e8e7ccd4303e23392f230a952/src/pubkey.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/pubkey.h?ref=6d024f82cee3335e8e7ccd4303e23392f230a952",
        "patch": "@@ -34,6 +34,10 @@ class CPubKeySig\n      */\n     static const unsigned int SIZE         = 72;\n     static const unsigned int COMPACT_SIZE = 65;\n+\n+    static_assert(\n+        SIZE > COMPACT_SIZE,\n+        \"COMPACT_SIZE should be smaller than SIZE\");\n };\n \n /** An encapsulated public key. */\n@@ -50,8 +54,8 @@ class CPubKey\n      * script supports up to 75 for single byte push\n      */\n     static_assert(\n-        SIZE >= COMPRESSED_SIZE,\n-        \"COMPRESSED_SIZE is larger than SIZE\");\n+        SIZE > COMPRESSED_SIZE,\n+        \"COMPRESSED_SIZE should be smaller than SIZE\");\n \n private:\n "
      }
    ]
  }
]