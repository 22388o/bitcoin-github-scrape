[
  {
    "sha": "1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxZDQwMjRiY2E4MDg2Y2NlZmY3NTM5ZGQ4YzE1ZTBiN2ZlMWNjNWVh",
    "commit": {
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2020-07-08T07:32:09Z"
      },
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2020-07-11T17:41:21Z"
      },
      "message": "net: remove -banscore configuration option",
      "tree": {
        "sha": "3cb640eb7860718367192cef40763be65746e419",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3cb640eb7860718367192cef40763be65746e419"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEd6u7+MhX7zEv6RP5T1chs9Djkh0FAl8J+cEACgkQT1chs9Dj\nkh1+eA//W2hIZjKQGz3H0PuJ6IQwnCxo7qvb2yI18Ii4iIWU+qrka+/Q2YWq38BE\nLKwrUGT1Oz7+4vIis2jJ5LfVpeKP2WF9sRO89zU10+M1ZR1pEKM+drf7z/rrCiIn\nlkEj0BmNFfmvvl/rEu4PJ4wqlJjPqhwGxzp1/G29FZnyM7UBmolq1W4xxH/QFB+F\n6X7HiCLkyEwLhE7e/hR4FMDKZVTz2IudYHuw5HgzRZlyZ5DpPrdqlaWD0aCes93u\nbqhIekV5zCLNjSHuXA1YjF+1E9zueJlt21BfNrU0garKIJgWegwz8o107NChA1rY\n/0tclu+yUTyslLjoEdbj8MQroHoVzZNW7e1VtkvPseczEDqUCq7rOwrj1WKhO/Yo\n1ykrI7iGLlCkk4czpvo6PDQT9vHc6PLfZL5F9QLN/nf7uPPPWIsAhZrpvCICQK1g\n14Z8fKHfvNvtBknbltb5To9f01FNr4iH7wQ/9/nUIy6SHkctyAVRm7cgTu80rSbU\nss4majqzEO7+QOpycJsfp+D0B4CmtXGnkABmwu22g+uxzm9oWIvpusxS/B2FsCv6\nEdHO6hYgIC0QUVHkoqnx5CHhfMqGW8ap5Iz3vxwysC2WyMSaLsAbRQ9AyBHxBd0s\nmWdjo0xJ9sH5fgvQx9L3TPfl2ODF5UX/Iv2JFTRRztN/z/FlaNw=\n=NQQ9\n-----END PGP SIGNATURE-----\n-----BEGIN OPENTIMESTAMPS GIT TIMESTAMP-----\n\nAQHwIHU74wMdlclz34Y5tiPxaJbQcCzIhVNQZAwClOLlITpOCP/wEBjsddIsLrXR\n9yxDgXzrgfEI8QRfCfnE8AgXrE7Ms+WIaQCD3+MNLvkMji4taHR0cHM6Ly9hbGlj\nZS5idGMuY2FsZW5kYXIub3BlbnRpbWVzdGFtcHMub3Jn//AQOQzYeUKgHpIXiwzV\nCbt96QjwIFjSgRC9vyT7o1dUZSoR6R5oWQzrQeomw1ZZsrNAhxi9CPEEXwn5w/AI\nakWogM6tCLcAg9/jDS75DI4sK2h0dHBzOi8vYm9iLmJ0Yy5jYWxlbmRhci5vcGVu\ndGltZXN0YW1wcy5vcmf/8BBUkbLnzghgZgQdjADPYEHVCPAgP/kVAXCDtbByuyPK\n8tsoyy4x+s0HOhO1UR+WsRut+U8I8QRfCfnD8AiXPRgyinz6gACD3+MNLvkMjiMi\naHR0cHM6Ly9idGMuY2FsZW5kYXIuY2F0YWxsYXh5LmNvbfAQmdSgjIfZFTmSXYBD\nf1uKsgjxIA0ouR5Gb217gz1a6LozGw5Yg9qqEodKi6u2g23PjxfOCPEEXwn5w/AI\nt2oyEKorW3IAg9/jDS75DI4pKGh0dHBzOi8vZmlubmV5LmNhbGVuZGFyLmV0ZXJu\naXR5d2FsbC5jb20=\n-----END OPENTIMESTAMPS GIT TIMESTAMP-----",
        "payload": "tree 3cb640eb7860718367192cef40763be65746e419\nparent 42fe6aad326f62c7e6ea12ee873149257f67ce5d\nauthor Jon Atack <jon@atack.com> 1594193529 +0200\ncommitter Jon Atack <jon@atack.com> 1594489281 +0200\n\nnet: remove -banscore configuration option\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea/comments",
    "author": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "42fe6aad326f62c7e6ea12ee873149257f67ce5d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/42fe6aad326f62c7e6ea12ee873149257f67ce5d",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/42fe6aad326f62c7e6ea12ee873149257f67ce5d"
      }
    ],
    "stats": {
      "total": 27,
      "additions": 14,
      "deletions": 13
    },
    "files": [
      {
        "sha": "08230e3cd5a3297f99fca1116f3d030761192cd5",
        "filename": "doc/release-notes.md",
        "status": "modified",
        "additions": 5,
        "deletions": 0,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea/doc/release-notes.md",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea/doc/release-notes.md",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/doc/release-notes.md?ref=1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea",
        "patch": "@@ -99,6 +99,11 @@ Build System\n Updated settings\n ----------------\n \n+- The `-banscore` configuration option, which modified the default threshold for\n+  disconnecting and discouraging misbehaving peers, has been removed as part of\n+  changes in this release to the handling of misbehaving peers. Refer to the\n+  section, \"Changes regarding misbehaving peers\", for details. (#19464)\n+\n - The `-debug=db` logging category, which was deprecated in 0.20 and replaced by\n   `-debug=walletdb` to distinguish it from `coindb`, has been removed. (#19202)\n "
      },
      {
        "sha": "7b893a08d702828ff4697d598d9cebd207ea6995",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea",
        "patch": "@@ -431,7 +431,6 @@ void SetupServerArgs(NodeContext& node)\n \n     gArgs.AddArg(\"-addnode=<ip>\", \"Add a node to connect to and attempt to keep the connection open (see the `addnode` RPC command help for more info). This option can be specified multiple times to add multiple nodes.\", ArgsManager::ALLOW_ANY | ArgsManager::NETWORK_ONLY, OptionsCategory::CONNECTION);\n     gArgs.AddArg(\"-asmap=<file>\", strprintf(\"Specify asn mapping used for bucketing of the peers (default: %s). Relative paths will be prefixed by the net-specific datadir location.\", DEFAULT_ASMAP_FILENAME), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);\n-    gArgs.AddArg(\"-banscore=<n>\", strprintf(\"Threshold for disconnecting and discouraging misbehaving peers (default: %u)\", DEFAULT_BANSCORE_THRESHOLD), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);\n     gArgs.AddArg(\"-bantime=<n>\", strprintf(\"Default duration (in seconds) of manually configured bans (default: %u)\", DEFAULT_MISBEHAVING_BANTIME), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);\n     gArgs.AddArg(\"-bind=<addr>\", \"Bind to given address and always listen on it. Use [host]:port notation for IPv6\", ArgsManager::ALLOW_ANY | ArgsManager::NETWORK_ONLY, OptionsCategory::CONNECTION);\n     gArgs.AddArg(\"-connect=<ip>\", \"Connect only to the specified node; -noconnect disables automatic connections (the rules for this peer are the same as for -addnode). This option can be specified multiple times to connect to multiple nodes.\", ArgsManager::ALLOW_ANY | ArgsManager::NETWORK_ONLY, OptionsCategory::CONNECTION);"
      },
      {
        "sha": "0e0a8a5b480c6aa0e706ec0ad50674195fcbd729",
        "filename": "src/net_processing.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 3,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea/src/net_processing.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea/src/net_processing.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net_processing.cpp?ref=1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea",
        "patch": "@@ -1016,7 +1016,8 @@ unsigned int LimitOrphanTxSize(unsigned int nMaxOrphans)\n }\n \n /**\n- * Increment peer's misbehavior score. If the new value surpasses banscore (specified on startup or by default), mark node to be discouraged, meaning the peer might be disconnected & added to the discouragement filter.\n+ * Increment peer's misbehavior score. If the new value >= DEFAULT_BANSCORE_THRESHOLD, mark the node\n+ * to be discouraged, meaning the peer might be disconnected and added to the discouragement filter.\n  */\n void Misbehaving(NodeId pnode, int howmuch, const std::string& message) EXCLUSIVE_LOCKS_REQUIRED(cs_main)\n {\n@@ -1028,9 +1029,8 @@ void Misbehaving(NodeId pnode, int howmuch, const std::string& message) EXCLUSIV\n         return;\n \n     state->nMisbehavior += howmuch;\n-    int banscore = gArgs.GetArg(\"-banscore\", DEFAULT_BANSCORE_THRESHOLD);\n     std::string message_prefixed = message.empty() ? \"\" : (\": \" + message);\n-    if (state->nMisbehavior >= banscore && state->nMisbehavior - howmuch < banscore)\n+    if (state->nMisbehavior >= DEFAULT_BANSCORE_THRESHOLD && state->nMisbehavior - howmuch < DEFAULT_BANSCORE_THRESHOLD)\n     {\n         LogPrint(BCLog::NET, \"%s: %s peer=%d (%d -> %d) DISCOURAGE THRESHOLD EXCEEDED%s\\n\", __func__, state->name, pnode, state->nMisbehavior-howmuch, state->nMisbehavior, message_prefixed);\n         state->m_should_discourage = true;"
      },
      {
        "sha": "6f7effcce950ebd848fa82b177646bc51520b985",
        "filename": "src/test/denialofservice_tests.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 5,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea/src/test/denialofservice_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea/src/test/denialofservice_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/denialofservice_tests.cpp?ref=1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea",
        "patch": "@@ -232,7 +232,7 @@ BOOST_AUTO_TEST_CASE(DoS_banning)\n     dummyNode1.fSuccessfullyConnected = true;\n     {\n         LOCK(cs_main);\n-        Misbehaving(dummyNode1.GetId(), 100); // Should get banned\n+        Misbehaving(dummyNode1.GetId(), DEFAULT_BANSCORE_THRESHOLD); // Should get banned\n     }\n     {\n         LOCK2(cs_main, dummyNode1.cs_sendProcessing);\n@@ -279,7 +279,6 @@ BOOST_AUTO_TEST_CASE(DoS_banscore)\n     auto peerLogic = MakeUnique<PeerLogicValidation>(connman.get(), banman.get(), *m_node.scheduler, *m_node.chainman, *m_node.mempool);\n \n     banman->ClearBanned();\n-    gArgs.ForceSetArg(\"-banscore\", \"111\"); // because 11 is my favorite number\n     CAddress addr1(ip(0xa0b0c001), NODE_NONE);\n     CNode dummyNode1(id++, NODE_NETWORK, 0, INVALID_SOCKET, addr1, 3, 1, CAddress(), \"\", true);\n     dummyNode1.SetSendVersion(PROTOCOL_VERSION);\n@@ -288,7 +287,7 @@ BOOST_AUTO_TEST_CASE(DoS_banscore)\n     dummyNode1.fSuccessfullyConnected = true;\n     {\n         LOCK(cs_main);\n-        Misbehaving(dummyNode1.GetId(), 100);\n+        Misbehaving(dummyNode1.GetId(), DEFAULT_BANSCORE_THRESHOLD - 11);\n     }\n     {\n         LOCK2(cs_main, dummyNode1.cs_sendProcessing);\n@@ -313,7 +312,6 @@ BOOST_AUTO_TEST_CASE(DoS_banscore)\n         BOOST_CHECK(peerLogic->SendMessages(&dummyNode1));\n     }\n     BOOST_CHECK(banman->IsDiscouraged(addr1));\n-    gArgs.ForceSetArg(\"-banscore\", ToString(DEFAULT_BANSCORE_THRESHOLD));\n \n     bool dummy;\n     peerLogic->FinalizeNode(dummyNode1.GetId(), dummy);\n@@ -338,7 +336,7 @@ BOOST_AUTO_TEST_CASE(DoS_bantime)\n \n     {\n         LOCK(cs_main);\n-        Misbehaving(dummyNode.GetId(), 100);\n+        Misbehaving(dummyNode.GetId(), DEFAULT_BANSCORE_THRESHOLD);\n     }\n     {\n         LOCK2(cs_main, dummyNode.cs_sendProcessing);"
      },
      {
        "sha": "23ad4e20dff9765e009f479be698ee0b160fdfaa",
        "filename": "src/validation.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea/src/validation.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea/src/validation.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/validation.h?ref=1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea",
        "patch": "@@ -74,7 +74,7 @@ static const int64_t DEFAULT_MAX_TIP_AGE = 24 * 60 * 60;\n static const bool DEFAULT_CHECKPOINTS_ENABLED = true;\n static const bool DEFAULT_TXINDEX = false;\n static const char* const DEFAULT_BLOCKFILTERINDEX = \"0\";\n-static const unsigned int DEFAULT_BANSCORE_THRESHOLD = 100;\n+static const int DEFAULT_BANSCORE_THRESHOLD = 100;\n /** Default for -persistmempool */\n static const bool DEFAULT_PERSIST_MEMPOOL = true;\n /** Default for using fee filter */"
      },
      {
        "sha": "a35420226356c02d12eac4df32f68665116527ee",
        "filename": "test/functional/p2p_leak.py",
        "status": "modified",
        "additions": 2,
        "deletions": 3,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea/test/functional/p2p_leak.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea/test/functional/p2p_leak.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/p2p_leak.py?ref=1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea",
        "patch": "@@ -26,7 +26,7 @@\n     wait_until,\n )\n \n-banscore = 10\n+DEFAULT_BANSCORE_THRESHOLD = 100\n \n \n class CLazyNode(P2PInterface):\n@@ -70,7 +70,7 @@ class CNodeNoVersionBan(CLazyNode):\n     # NOTE: implementation-specific check here. Remove if bitcoind ban behavior changes\n     def on_open(self):\n         super().on_open()\n-        for i in range(banscore):\n+        for _ in range(DEFAULT_BANSCORE_THRESHOLD):\n             self.send_message(msg_verack())\n \n # Node that never sends a version. This one just sits idle and hopes to receive\n@@ -106,7 +106,6 @@ def on_version(self, msg):\n class P2PLeakTest(BitcoinTestFramework):\n     def set_test_params(self):\n         self.num_nodes = 1\n-        self.extra_args = [['-banscore=' + str(banscore)]]\n \n     def run_test(self):\n         no_version_bannode = self.nodes[0].add_p2p_connection(CNodeNoVersionBan(), send_version=False, wait_for_verack=False)"
      }
    ]
  },
  {
    "sha": "06059b0c2a6c2db70c87a7715f8a344a13400fa1",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzowNjA1OWIwYzJhNmMyZGI3MGM4N2E3NzE1ZjhhMzQ0YTEzNDAwZmEx",
    "commit": {
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2020-07-08T07:33:30Z"
      },
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2020-07-11T17:41:24Z"
      },
      "message": "net: rename DEFAULT_BANSCORE_THRESHOLD to DISCOURAGEMENT_THRESHOLD\n\nand move it from validation to net processing.",
      "tree": {
        "sha": "a0f7c09df27c25e8a3c624f6b3ad1334670105e9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a0f7c09df27c25e8a3c624f6b3ad1334670105e9"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/06059b0c2a6c2db70c87a7715f8a344a13400fa1",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEd6u7+MhX7zEv6RP5T1chs9Djkh0FAl8J+cQACgkQT1chs9Dj\nkh3yRg//RhJvwv3tF+gwIEbsEcpcLnA/D2Z6Ou03ZdyQ4JIo+DFmDGwsgCW6pcmC\njbTB8qbOvx5+bLduA5OS44VIui4Zjpn3MwY8iPsZBFWm7+1JrxrIP/tKiijceuVh\n4xF/JYmn7k0oJ5iS7RyhJPlHWsAt0RANYoy76paDnl2oAMcNTWA0rCxJXovTYKRa\nxbz7fP9EVw2amyi6owGYmLk9AeVj0L2NZbAz7id6Hb0AoMWonyddQg5AY71cQty5\nrsLp9p73KVZqvsDLdAQHIzxZlUw6x3Qm7aiOD4C3Zm3J0AMVK3wdXuZY96z7w+uK\nC4hQSnFkFBv41mZrwpOr8hAidZ+mNs7LmK2MesF4u/r3slD5Tk3Ydoomk1BQ8nXo\nTyXeBiGpHygJqULuQP1OdMlznLPGtxC2yE30E+OK9UjgZKwmQz2mkaF9a2/nE/Uh\nzwI9SV5m/wbkr+bsC9TsJ0pFI8QawbBJH6+5hDZD+nKjUPKuS1NHtoh5kO/5IqKR\n7tVvy5V5e2mBmVtFzUjsMSiuvgJ7AcP+1AYXjgjBjef046iJsCJXqjLswAtJpV/9\ntaOPiiFRt18LzwcSVJOkGk0C6LRjnDS32tfBPSQZmO8x94wC2LipgrFBsas163kj\n35KrJDiYxL2fQmjHZ5yIqID9NeGTsJtDJtd5x27kopr+3Ept734=\n=q91V\n-----END PGP SIGNATURE-----\n-----BEGIN OPENTIMESTAMPS GIT TIMESTAMP-----\n\nAQHwIMkhKdSGsMgBAaA3x15Q/jAzGVYlCht+6JE24MEz9bmUCP/wEKkF7Myu4lIu\nBETN9ryC8nMI8QRfCfnG8AghxzPLQ8VbSwCD3+MNLvkMjiMiaHR0cHM6Ly9idGMu\nY2FsZW5kYXIuY2F0YWxsYXh5LmNvbf/wEMyUJ8hen5us32mnjVSwOGgI8QRfCfnG\n8AjkNHebssRNTwCD3+MNLvkMji4taHR0cHM6Ly9hbGljZS5idGMuY2FsZW5kYXIu\nb3BlbnRpbWVzdGFtcHMub3Jn//AQ3T/UkCIXqZu02ttw6eVVPwjxBF8J+cbwCO08\npE3AOAYkAIPf4w0u+QyOKShodHRwczovL2Zpbm5leS5jYWxlbmRhci5ldGVybml0\neXdhbGwuY29t8BDuC6XY2hXDKLEE9CIkSz6wCPEEXwn5xvAIXYR8dFIVCkUAg9/j\nDS75DI4sK2h0dHBzOi8vYm9iLmJ0Yy5jYWxlbmRhci5vcGVudGltZXN0YW1wcy5v\ncmc=\n-----END OPENTIMESTAMPS GIT TIMESTAMP-----",
        "payload": "tree a0f7c09df27c25e8a3c624f6b3ad1334670105e9\nparent 1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea\nauthor Jon Atack <jon@atack.com> 1594193610 +0200\ncommitter Jon Atack <jon@atack.com> 1594489284 +0200\n\nnet: rename DEFAULT_BANSCORE_THRESHOLD to DISCOURAGEMENT_THRESHOLD\n\nand move it from validation to net processing.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/06059b0c2a6c2db70c87a7715f8a344a13400fa1",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/06059b0c2a6c2db70c87a7715f8a344a13400fa1",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/06059b0c2a6c2db70c87a7715f8a344a13400fa1/comments",
    "author": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/1d4024bca8086cceff7539dd8c15e0b7fe1cc5ea"
      }
    ],
    "stats": {
      "total": 21,
      "additions": 11,
      "deletions": 10
    },
    "files": [
      {
        "sha": "bf8849025ece47cbd18d8735f469129d971a026c",
        "filename": "src/net_processing.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/06059b0c2a6c2db70c87a7715f8a344a13400fa1/src/net_processing.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/06059b0c2a6c2db70c87a7715f8a344a13400fa1/src/net_processing.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net_processing.cpp?ref=06059b0c2a6c2db70c87a7715f8a344a13400fa1",
        "patch": "@@ -1016,7 +1016,7 @@ unsigned int LimitOrphanTxSize(unsigned int nMaxOrphans)\n }\n \n /**\n- * Increment peer's misbehavior score. If the new value >= DEFAULT_BANSCORE_THRESHOLD, mark the node\n+ * Increment peer's misbehavior score. If the new value >= DISCOURAGEMENT_THRESHOLD, mark the node\n  * to be discouraged, meaning the peer might be disconnected and added to the discouragement filter.\n  */\n void Misbehaving(NodeId pnode, int howmuch, const std::string& message) EXCLUSIVE_LOCKS_REQUIRED(cs_main)\n@@ -1030,7 +1030,7 @@ void Misbehaving(NodeId pnode, int howmuch, const std::string& message) EXCLUSIV\n \n     state->nMisbehavior += howmuch;\n     std::string message_prefixed = message.empty() ? \"\" : (\": \" + message);\n-    if (state->nMisbehavior >= DEFAULT_BANSCORE_THRESHOLD && state->nMisbehavior - howmuch < DEFAULT_BANSCORE_THRESHOLD)\n+    if (state->nMisbehavior >= DISCOURAGEMENT_THRESHOLD && state->nMisbehavior - howmuch < DISCOURAGEMENT_THRESHOLD)\n     {\n         LogPrint(BCLog::NET, \"%s: %s peer=%d (%d -> %d) DISCOURAGE THRESHOLD EXCEEDED%s\\n\", __func__, state->name, pnode, state->nMisbehavior-howmuch, state->nMisbehavior, message_prefixed);\n         state->m_should_discourage = true;"
      },
      {
        "sha": "3479ef686572fccd845f57be4916d02b23919bd8",
        "filename": "src/net_processing.h",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/06059b0c2a6c2db70c87a7715f8a344a13400fa1/src/net_processing.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/06059b0c2a6c2db70c87a7715f8a344a13400fa1/src/net_processing.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net_processing.h?ref=06059b0c2a6c2db70c87a7715f8a344a13400fa1",
        "patch": "@@ -23,6 +23,8 @@ static const unsigned int DEFAULT_MAX_ORPHAN_TRANSACTIONS = 100;\n static const unsigned int DEFAULT_BLOCK_RECONSTRUCTION_EXTRA_TXN = 100;\n static const bool DEFAULT_PEERBLOOMFILTERS = false;\n static const bool DEFAULT_PEERBLOCKFILTERS = false;\n+/** Threshold for marking a node to be discouraged, e.g. disconnected and added to the discouragement filter. */\n+static const int DISCOURAGEMENT_THRESHOLD{100};\n \n class PeerLogicValidation final : public CValidationInterface, public NetEventsInterface {\n private:"
      },
      {
        "sha": "3d84fa855f5758ba9bfb911fb22915725d25362d",
        "filename": "src/test/denialofservice_tests.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 5,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/06059b0c2a6c2db70c87a7715f8a344a13400fa1/src/test/denialofservice_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/06059b0c2a6c2db70c87a7715f8a344a13400fa1/src/test/denialofservice_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/denialofservice_tests.cpp?ref=06059b0c2a6c2db70c87a7715f8a344a13400fa1",
        "patch": "@@ -232,14 +232,14 @@ BOOST_AUTO_TEST_CASE(DoS_banning)\n     dummyNode1.fSuccessfullyConnected = true;\n     {\n         LOCK(cs_main);\n-        Misbehaving(dummyNode1.GetId(), DEFAULT_BANSCORE_THRESHOLD); // Should get banned\n+        Misbehaving(dummyNode1.GetId(), DISCOURAGEMENT_THRESHOLD); // Should be discouraged\n     }\n     {\n         LOCK2(cs_main, dummyNode1.cs_sendProcessing);\n         BOOST_CHECK(peerLogic->SendMessages(&dummyNode1));\n     }\n     BOOST_CHECK(banman->IsDiscouraged(addr1));\n-    BOOST_CHECK(!banman->IsDiscouraged(ip(0xa0b0c001|0x0000ff00))); // Different IP, not banned\n+    BOOST_CHECK(!banman->IsDiscouraged(ip(0xa0b0c001|0x0000ff00))); // Different IP, not discouraged\n \n     CAddress addr2(ip(0xa0b0c002), NODE_NONE);\n     CNode dummyNode2(id++, NODE_NETWORK, 0, INVALID_SOCKET, addr2, 1, 1, CAddress(), \"\", true);\n@@ -255,7 +255,7 @@ BOOST_AUTO_TEST_CASE(DoS_banning)\n         LOCK2(cs_main, dummyNode2.cs_sendProcessing);\n         BOOST_CHECK(peerLogic->SendMessages(&dummyNode2));\n     }\n-    BOOST_CHECK(!banman->IsDiscouraged(addr2)); // 2 not banned yet...\n+    BOOST_CHECK(!banman->IsDiscouraged(addr2)); // 2 not discouraged yet...\n     BOOST_CHECK(banman->IsDiscouraged(addr1));  // ... but 1 still should be\n     {\n         LOCK(cs_main);\n@@ -287,7 +287,7 @@ BOOST_AUTO_TEST_CASE(DoS_banscore)\n     dummyNode1.fSuccessfullyConnected = true;\n     {\n         LOCK(cs_main);\n-        Misbehaving(dummyNode1.GetId(), DEFAULT_BANSCORE_THRESHOLD - 11);\n+        Misbehaving(dummyNode1.GetId(), DISCOURAGEMENT_THRESHOLD - 11);\n     }\n     {\n         LOCK2(cs_main, dummyNode1.cs_sendProcessing);\n@@ -336,7 +336,7 @@ BOOST_AUTO_TEST_CASE(DoS_bantime)\n \n     {\n         LOCK(cs_main);\n-        Misbehaving(dummyNode.GetId(), DEFAULT_BANSCORE_THRESHOLD);\n+        Misbehaving(dummyNode.GetId(), DISCOURAGEMENT_THRESHOLD);\n     }\n     {\n         LOCK2(cs_main, dummyNode.cs_sendProcessing);"
      },
      {
        "sha": "acadf151c507bd2a4d31bf7523e20ac01367d5b5",
        "filename": "src/validation.h",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/06059b0c2a6c2db70c87a7715f8a344a13400fa1/src/validation.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/06059b0c2a6c2db70c87a7715f8a344a13400fa1/src/validation.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/validation.h?ref=06059b0c2a6c2db70c87a7715f8a344a13400fa1",
        "patch": "@@ -74,7 +74,6 @@ static const int64_t DEFAULT_MAX_TIP_AGE = 24 * 60 * 60;\n static const bool DEFAULT_CHECKPOINTS_ENABLED = true;\n static const bool DEFAULT_TXINDEX = false;\n static const char* const DEFAULT_BLOCKFILTERINDEX = \"0\";\n-static const int DEFAULT_BANSCORE_THRESHOLD = 100;\n /** Default for -persistmempool */\n static const bool DEFAULT_PERSIST_MEMPOOL = true;\n /** Default for using fee filter */"
      },
      {
        "sha": "6cf252e626334822e889e3a3ccf619546d26950b",
        "filename": "test/functional/p2p_leak.py",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/06059b0c2a6c2db70c87a7715f8a344a13400fa1/test/functional/p2p_leak.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/06059b0c2a6c2db70c87a7715f8a344a13400fa1/test/functional/p2p_leak.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/p2p_leak.py?ref=06059b0c2a6c2db70c87a7715f8a344a13400fa1",
        "patch": "@@ -26,7 +26,7 @@\n     wait_until,\n )\n \n-DEFAULT_BANSCORE_THRESHOLD = 100\n+DISCOURAGEMENT_THRESHOLD = 100\n \n \n class CLazyNode(P2PInterface):\n@@ -70,7 +70,7 @@ class CNodeNoVersionBan(CLazyNode):\n     # NOTE: implementation-specific check here. Remove if bitcoind ban behavior changes\n     def on_open(self):\n         super().on_open()\n-        for _ in range(DEFAULT_BANSCORE_THRESHOLD):\n+        for _ in range(DISCOURAGEMENT_THRESHOLD):\n             self.send_message(msg_verack())\n \n # Node that never sends a version. This one just sits idle and hopes to receive"
      }
    ]
  }
]