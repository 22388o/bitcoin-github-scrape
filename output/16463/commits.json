[
  {
    "sha": "30a9b28d8e8639e23e78c3b8a9023d43308c571d",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozMGE5YjI4ZDhlODYzOWUyM2U3OGMzYjhhOTAyM2Q0MzMwOGM1NzFk",
    "commit": {
      "author": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2019-07-25T15:26:20Z"
      },
      "committer": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2021-01-12T20:41:23Z"
      },
      "message": "moveonly: Move (Un)Serialize(To/From)Vector, (De)SerializeHDKeypaths to psbt module\n\nSerializeToVector, UnserializeFromVector, DeserializeHDKeypaths, and SerializeHDKeypaths\nwere in sign.h where PSBT was originally implemented. Since all of the PSBT serialization\nhas moved to its own file, these functions should follow.",
      "tree": {
        "sha": "78a8d30135782a5de0c5b5a13c263f092cb3db86",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/78a8d30135782a5de0c5b5a13c263f092cb3db86"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/30a9b28d8e8639e23e78c3b8a9023d43308c571d",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/30a9b28d8e8639e23e78c3b8a9023d43308c571d",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/30a9b28d8e8639e23e78c3b8a9023d43308c571d",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/30a9b28d8e8639e23e78c3b8a9023d43308c571d/comments",
    "author": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "bc8ada1c15345d14e324aee68488c8aa8a75cae0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bc8ada1c15345d14e324aee68488c8aa8a75cae0",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/bc8ada1c15345d14e324aee68488c8aa8a75cae0"
      }
    ],
    "stats": {
      "total": 149,
      "additions": 75,
      "deletions": 74
    },
    "files": [
      {
        "sha": "5d8ad5d0c38dad5703b9b5737cd0bab5dbdea26f",
        "filename": "src/psbt.h",
        "status": "modified",
        "additions": 74,
        "deletions": 0,
        "changes": 74,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/30a9b28d8e8639e23e78c3b8a9023d43308c571d/src/psbt.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/30a9b28d8e8639e23e78c3b8a9023d43308c571d/src/psbt.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/psbt.h?ref=30a9b28d8e8639e23e78c3b8a9023d43308c571d",
        "patch": "@@ -44,6 +44,80 @@ static constexpr uint8_t PSBT_SEPARATOR = 0x00;\n // to prevent reading a stream indefinitely and running out of memory.\n const std::streamsize MAX_FILE_SIZE_PSBT = 100000000; // 100 MiB\n \n+// Takes a stream and multiple arguments and serializes them as if first serialized into a vector and then into the stream\n+// The resulting output into the stream has the total serialized length of all of the objects followed by all objects concatenated with each other.\n+template<typename Stream, typename... X>\n+void SerializeToVector(Stream& s, const X&... args)\n+{\n+    WriteCompactSize(s, GetSerializeSizeMany(s.GetVersion(), args...));\n+    SerializeMany(s, args...);\n+}\n+\n+// Takes a stream and multiple arguments and unserializes them first as a vector then each object individually in the order provided in the arguments\n+template<typename Stream, typename... X>\n+void UnserializeFromVector(Stream& s, X&... args)\n+{\n+    size_t expected_size = ReadCompactSize(s);\n+    size_t remaining_before = s.size();\n+    UnserializeMany(s, args...);\n+    size_t remaining_after = s.size();\n+    if (remaining_after + expected_size != remaining_before) {\n+        throw std::ios_base::failure(\"Size of value was not the stated size\");\n+    }\n+}\n+\n+// Deserialize HD keypaths into a map\n+template<typename Stream>\n+void DeserializeHDKeypaths(Stream& s, const std::vector<unsigned char>& key, std::map<CPubKey, KeyOriginInfo>& hd_keypaths)\n+{\n+    // Make sure that the key is the size of pubkey + 1\n+    if (key.size() != CPubKey::SIZE + 1 && key.size() != CPubKey::COMPRESSED_SIZE + 1) {\n+        throw std::ios_base::failure(\"Size of key was not the expected size for the type BIP32 keypath\");\n+    }\n+    // Read in the pubkey from key\n+    CPubKey pubkey(key.begin() + 1, key.end());\n+    if (!pubkey.IsFullyValid()) {\n+       throw std::ios_base::failure(\"Invalid pubkey\");\n+    }\n+    if (hd_keypaths.count(pubkey) > 0) {\n+        throw std::ios_base::failure(\"Duplicate Key, pubkey derivation path already provided\");\n+    }\n+\n+    // Read in key path\n+    uint64_t value_len = ReadCompactSize(s);\n+    if (value_len % 4 || value_len == 0) {\n+        throw std::ios_base::failure(\"Invalid length for HD key path\");\n+    }\n+\n+    KeyOriginInfo keypath;\n+    s >> keypath.fingerprint;\n+    for (unsigned int i = 4; i < value_len; i += sizeof(uint32_t)) {\n+        uint32_t index;\n+        s >> index;\n+        keypath.path.push_back(index);\n+    }\n+\n+    // Add to map\n+    hd_keypaths.emplace(pubkey, std::move(keypath));\n+}\n+\n+// Serialize HD keypaths to a stream from a map\n+template<typename Stream>\n+void SerializeHDKeypaths(Stream& s, const std::map<CPubKey, KeyOriginInfo>& hd_keypaths, uint8_t type)\n+{\n+    for (auto keypath_pair : hd_keypaths) {\n+        if (!keypath_pair.first.IsValid()) {\n+            throw std::ios_base::failure(\"Invalid CPubKey being serialized\");\n+        }\n+        SerializeToVector(s, type, MakeSpan(keypath_pair.first));\n+        WriteCompactSize(s, (keypath_pair.second.path.size() + 1) * sizeof(uint32_t));\n+        s << keypath_pair.second.fingerprint;\n+        for (const auto& path : keypath_pair.second.path) {\n+            s << path;\n+        }\n+    }\n+}\n+\n /** A structure for PSBTs which contain per-input information */\n struct PSBTInput\n {"
      },
      {
        "sha": "68db431b57ff8f4dc44dd45d97cfafe425cff088",
        "filename": "src/script/sign.h",
        "status": "modified",
        "additions": 0,
        "deletions": 74,
        "changes": 74,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/30a9b28d8e8639e23e78c3b8a9023d43308c571d/src/script/sign.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/30a9b28d8e8639e23e78c3b8a9023d43308c571d/src/script/sign.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script/sign.h?ref=30a9b28d8e8639e23e78c3b8a9023d43308c571d",
        "patch": "@@ -76,80 +76,6 @@ struct SignatureData {\n     void MergeSignatureData(SignatureData sigdata);\n };\n \n-// Takes a stream and multiple arguments and serializes them as if first serialized into a vector and then into the stream\n-// The resulting output into the stream has the total serialized length of all of the objects followed by all objects concatenated with each other.\n-template<typename Stream, typename... X>\n-void SerializeToVector(Stream& s, const X&... args)\n-{\n-    WriteCompactSize(s, GetSerializeSizeMany(s.GetVersion(), args...));\n-    SerializeMany(s, args...);\n-}\n-\n-// Takes a stream and multiple arguments and unserializes them first as a vector then each object individually in the order provided in the arguments\n-template<typename Stream, typename... X>\n-void UnserializeFromVector(Stream& s, X&... args)\n-{\n-    size_t expected_size = ReadCompactSize(s);\n-    size_t remaining_before = s.size();\n-    UnserializeMany(s, args...);\n-    size_t remaining_after = s.size();\n-    if (remaining_after + expected_size != remaining_before) {\n-        throw std::ios_base::failure(\"Size of value was not the stated size\");\n-    }\n-}\n-\n-// Deserialize HD keypaths into a map\n-template<typename Stream>\n-void DeserializeHDKeypaths(Stream& s, const std::vector<unsigned char>& key, std::map<CPubKey, KeyOriginInfo>& hd_keypaths)\n-{\n-    // Make sure that the key is the size of pubkey + 1\n-    if (key.size() != CPubKey::SIZE + 1 && key.size() != CPubKey::COMPRESSED_SIZE + 1) {\n-        throw std::ios_base::failure(\"Size of key was not the expected size for the type BIP32 keypath\");\n-    }\n-    // Read in the pubkey from key\n-    CPubKey pubkey(key.begin() + 1, key.end());\n-    if (!pubkey.IsFullyValid()) {\n-       throw std::ios_base::failure(\"Invalid pubkey\");\n-    }\n-    if (hd_keypaths.count(pubkey) > 0) {\n-        throw std::ios_base::failure(\"Duplicate Key, pubkey derivation path already provided\");\n-    }\n-\n-    // Read in key path\n-    uint64_t value_len = ReadCompactSize(s);\n-    if (value_len % 4 || value_len == 0) {\n-        throw std::ios_base::failure(\"Invalid length for HD key path\");\n-    }\n-\n-    KeyOriginInfo keypath;\n-    s >> keypath.fingerprint;\n-    for (unsigned int i = 4; i < value_len; i += sizeof(uint32_t)) {\n-        uint32_t index;\n-        s >> index;\n-        keypath.path.push_back(index);\n-    }\n-\n-    // Add to map\n-    hd_keypaths.emplace(pubkey, std::move(keypath));\n-}\n-\n-// Serialize HD keypaths to a stream from a map\n-template<typename Stream>\n-void SerializeHDKeypaths(Stream& s, const std::map<CPubKey, KeyOriginInfo>& hd_keypaths, uint8_t type)\n-{\n-    for (auto keypath_pair : hd_keypaths) {\n-        if (!keypath_pair.first.IsValid()) {\n-            throw std::ios_base::failure(\"Invalid CPubKey being serialized\");\n-        }\n-        SerializeToVector(s, type, MakeSpan(keypath_pair.first));\n-        WriteCompactSize(s, (keypath_pair.second.path.size() + 1) * sizeof(uint32_t));\n-        s << keypath_pair.second.fingerprint;\n-        for (const auto& path : keypath_pair.second.path) {\n-            s << path;\n-        }\n-    }\n-}\n-\n /** Produce a script signature using a generic signature creator. */\n bool ProduceSignature(const SigningProvider& provider, const BaseSignatureCreator& creator, const CScript& scriptPubKey, SignatureData& sigdata);\n "
      },
      {
        "sha": "dfb6aaeeb7eb91b40a2cd59292b3a22cce3861a9",
        "filename": "src/test/fuzz/script_sign.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/30a9b28d8e8639e23e78c3b8a9023d43308c571d/src/test/fuzz/script_sign.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/30a9b28d8e8639e23e78c3b8a9023d43308c571d/src/test/fuzz/script_sign.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/script_sign.cpp?ref=30a9b28d8e8639e23e78c3b8a9023d43308c571d",
        "patch": "@@ -5,6 +5,7 @@\n #include <chainparams.h>\n #include <chainparamsbase.h>\n #include <key.h>\n+#include <psbt.h>\n #include <pubkey.h>\n #include <script/keyorigin.h>\n #include <script/sign.h>"
      }
    ]
  },
  {
    "sha": "f8a078d9bf0547b1db4e20ac6ae800abfa019765",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmOGEwNzhkOWJmMDU0N2IxZGI0ZTIwYWM2YWU4MDBhYmZhMDE5NzY1",
    "commit": {
      "author": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2019-07-25T15:28:57Z"
      },
      "committer": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2021-01-12T20:41:23Z"
      },
      "message": "Store version bytes and be able to serialize them in CExtPubKey\n\nCExtPubKey does not store the version bytes for the extended public key.\nWe store these so that a CExtPubKey can be serialized and deserialized with\nthe same version bytes.",
      "tree": {
        "sha": "ce824331c1d9dd0215f6d87040ab81b3999e5b6b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ce824331c1d9dd0215f6d87040ab81b3999e5b6b"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f8a078d9bf0547b1db4e20ac6ae800abfa019765",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f8a078d9bf0547b1db4e20ac6ae800abfa019765",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/f8a078d9bf0547b1db4e20ac6ae800abfa019765",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f8a078d9bf0547b1db4e20ac6ae800abfa019765/comments",
    "author": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "30a9b28d8e8639e23e78c3b8a9023d43308c571d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/30a9b28d8e8639e23e78c3b8a9023d43308c571d",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/30a9b28d8e8639e23e78c3b8a9023d43308c571d"
      }
    ],
    "stats": {
      "total": 16,
      "additions": 16,
      "deletions": 0
    },
    "files": [
      {
        "sha": "fee181394cdc76a6f363162acb75dcd32c65d985",
        "filename": "src/pubkey.cpp",
        "status": "modified",
        "additions": 12,
        "deletions": 0,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f8a078d9bf0547b1db4e20ac6ae800abfa019765/src/pubkey.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f8a078d9bf0547b1db4e20ac6ae800abfa019765/src/pubkey.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/pubkey.cpp?ref=f8a078d9bf0547b1db4e20ac6ae800abfa019765",
        "patch": "@@ -290,6 +290,18 @@ void CExtPubKey::Decode(const unsigned char code[BIP32_EXTKEY_SIZE]) {\n     pubkey.Set(code+41, code+BIP32_EXTKEY_SIZE);\n }\n \n+void CExtPubKey::EncodeWithVersion(unsigned char code[BIP32_EXTKEY_WITH_VERSION_SIZE]) const\n+{\n+    memcpy(code, version, 4);\n+    Encode(&code[4]);\n+}\n+\n+void CExtPubKey::DecodeWithVersion(const unsigned char code[BIP32_EXTKEY_WITH_VERSION_SIZE])\n+{\n+    memcpy(version, code, 4);\n+    Decode(&code[4]);\n+}\n+\n bool CExtPubKey::Derive(CExtPubKey &out, unsigned int _nChild) const {\n     out.nDepth = nDepth + 1;\n     CKeyID id = pubkey.GetID();"
      },
      {
        "sha": "f03bf087bbb0370c7bbf18af32c115878f98c5d2",
        "filename": "src/pubkey.h",
        "status": "modified",
        "additions": 4,
        "deletions": 0,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f8a078d9bf0547b1db4e20ac6ae800abfa019765/src/pubkey.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f8a078d9bf0547b1db4e20ac6ae800abfa019765/src/pubkey.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/pubkey.h?ref=f8a078d9bf0547b1db4e20ac6ae800abfa019765",
        "patch": "@@ -16,6 +16,7 @@\n #include <vector>\n \n const unsigned int BIP32_EXTKEY_SIZE = 74;\n+const unsigned int BIP32_EXTKEY_WITH_VERSION_SIZE = 78;\n \n /** A reference to a CKey: the Hash160 of its serialized public key */\n class CKeyID : public uint160\n@@ -238,6 +239,7 @@ class XOnlyPubKey\n };\n \n struct CExtPubKey {\n+    unsigned char version[4];\n     unsigned char nDepth;\n     unsigned char vchFingerprint[4];\n     unsigned int nChild;\n@@ -260,6 +262,8 @@ struct CExtPubKey {\n \n     void Encode(unsigned char code[BIP32_EXTKEY_SIZE]) const;\n     void Decode(const unsigned char code[BIP32_EXTKEY_SIZE]);\n+    void EncodeWithVersion(unsigned char code[BIP32_EXTKEY_WITH_VERSION_SIZE]) const;\n+    void DecodeWithVersion(const unsigned char code[BIP32_EXTKEY_WITH_VERSION_SIZE]);\n     bool Derive(CExtPubKey& out, unsigned int nChild) const;\n };\n "
      }
    ]
  },
  {
    "sha": "868281d1dc4ecd5674aa7196535ff9d5d117874a",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4NjgyODFkMWRjNGVjZDU2NzRhYTcxOTY1MzVmZjlkNWQxMTc4NzRh",
    "commit": {
      "author": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2019-07-25T15:32:13Z"
      },
      "committer": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2021-01-12T20:41:23Z"
      },
      "message": "Separate individual HD Keypath serialization into separate functions",
      "tree": {
        "sha": "b6a2eeab6c434f7c609013b595f97cc40e7949c4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b6a2eeab6c434f7c609013b595f97cc40e7949c4"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/868281d1dc4ecd5674aa7196535ff9d5d117874a",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/868281d1dc4ecd5674aa7196535ff9d5d117874a",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/868281d1dc4ecd5674aa7196535ff9d5d117874a",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/868281d1dc4ecd5674aa7196535ff9d5d117874a/comments",
    "author": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "f8a078d9bf0547b1db4e20ac6ae800abfa019765",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f8a078d9bf0547b1db4e20ac6ae800abfa019765",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/f8a078d9bf0547b1db4e20ac6ae800abfa019765"
      }
    ],
    "stats": {
      "total": 48,
      "additions": 31,
      "deletions": 17
    },
    "files": [
      {
        "sha": "834167b152126d124a586fee54b4b4d503398c2b",
        "filename": "src/psbt.h",
        "status": "modified",
        "additions": 31,
        "deletions": 17,
        "changes": 48,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/868281d1dc4ecd5674aa7196535ff9d5d117874a/src/psbt.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/868281d1dc4ecd5674aa7196535ff9d5d117874a/src/psbt.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/psbt.h?ref=868281d1dc4ecd5674aa7196535ff9d5d117874a",
        "patch": "@@ -66,6 +66,24 @@ void UnserializeFromVector(Stream& s, X&... args)\n     }\n }\n \n+// Deserialize an individual HD keypath to a stream\n+template<typename Stream>\n+void DeserializeHDKeypath(Stream& s, KeyOriginInfo& hd_keypath)\n+{\n+    // Read in key path\n+    uint64_t value_len = ReadCompactSize(s);\n+    if (value_len % 4 || value_len == 0) {\n+        throw std::ios_base::failure(\"Invalid length for HD key path\");\n+    }\n+\n+    s >> hd_keypath.fingerprint;\n+    for (unsigned int i = 4; i < value_len; i += sizeof(uint32_t)) {\n+        uint32_t index;\n+        s >> index;\n+        hd_keypath.path.push_back(index);\n+    }\n+}\n+\n // Deserialize HD keypaths into a map\n template<typename Stream>\n void DeserializeHDKeypaths(Stream& s, const std::vector<unsigned char>& key, std::map<CPubKey, KeyOriginInfo>& hd_keypaths)\n@@ -83,24 +101,24 @@ void DeserializeHDKeypaths(Stream& s, const std::vector<unsigned char>& key, std\n         throw std::ios_base::failure(\"Duplicate Key, pubkey derivation path already provided\");\n     }\n \n-    // Read in key path\n-    uint64_t value_len = ReadCompactSize(s);\n-    if (value_len % 4 || value_len == 0) {\n-        throw std::ios_base::failure(\"Invalid length for HD key path\");\n-    }\n-\n     KeyOriginInfo keypath;\n-    s >> keypath.fingerprint;\n-    for (unsigned int i = 4; i < value_len; i += sizeof(uint32_t)) {\n-        uint32_t index;\n-        s >> index;\n-        keypath.path.push_back(index);\n-    }\n+    DeserializeHDKeypath(s, keypath);\n \n     // Add to map\n     hd_keypaths.emplace(pubkey, std::move(keypath));\n }\n \n+// Serialize an individual HD keypath to a stream\n+template<typename Stream>\n+void SerializeHDKeypath(Stream& s, KeyOriginInfo hd_keypath)\n+{\n+    WriteCompactSize(s, (hd_keypath.path.size() + 1) * sizeof(uint32_t));\n+    s << hd_keypath.fingerprint;\n+    for (const auto& path : hd_keypath.path) {\n+        s << path;\n+    }\n+}\n+\n // Serialize HD keypaths to a stream from a map\n template<typename Stream>\n void SerializeHDKeypaths(Stream& s, const std::map<CPubKey, KeyOriginInfo>& hd_keypaths, uint8_t type)\n@@ -110,11 +128,7 @@ void SerializeHDKeypaths(Stream& s, const std::map<CPubKey, KeyOriginInfo>& hd_k\n             throw std::ios_base::failure(\"Invalid CPubKey being serialized\");\n         }\n         SerializeToVector(s, type, MakeSpan(keypath_pair.first));\n-        WriteCompactSize(s, (keypath_pair.second.path.size() + 1) * sizeof(uint32_t));\n-        s << keypath_pair.second.fingerprint;\n-        for (const auto& path : keypath_pair.second.path) {\n-            s << path;\n-        }\n+        SerializeHDKeypath(s, keypath_pair.second);\n     }\n }\n "
      }
    ]
  },
  {
    "sha": "22e7161feb8b5afdb913b0007066b71b716f3f9c",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyMmU3MTYxZmViOGI1YWZkYjkxM2IwMDA3MDY2YjcxYjcxNmYzZjlj",
    "commit": {
      "author": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2019-07-25T15:58:14Z"
      },
      "committer": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2021-01-12T20:41:23Z"
      },
      "message": "Implement operator< for KeyOriginInfo and CExtPubKey",
      "tree": {
        "sha": "9d6a9be1bd9612990e0cbf753437b1239649ce39",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9d6a9be1bd9612990e0cbf753437b1239649ce39"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/22e7161feb8b5afdb913b0007066b71b716f3f9c",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/22e7161feb8b5afdb913b0007066b71b716f3f9c",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/22e7161feb8b5afdb913b0007066b71b716f3f9c",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/22e7161feb8b5afdb913b0007066b71b716f3f9c/comments",
    "author": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "868281d1dc4ecd5674aa7196535ff9d5d117874a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/868281d1dc4ecd5674aa7196535ff9d5d117874a",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/868281d1dc4ecd5674aa7196535ff9d5d117874a"
      }
    ],
    "stats": {
      "total": 27,
      "additions": 27,
      "deletions": 0
    },
    "files": [
      {
        "sha": "f1d176556fffe62bc1a8ae593170429c3b18f627",
        "filename": "src/pubkey.h",
        "status": "modified",
        "additions": 8,
        "deletions": 0,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/22e7161feb8b5afdb913b0007066b71b716f3f9c/src/pubkey.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/22e7161feb8b5afdb913b0007066b71b716f3f9c/src/pubkey.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/pubkey.h?ref=22e7161feb8b5afdb913b0007066b71b716f3f9c",
        "patch": "@@ -260,6 +260,14 @@ struct CExtPubKey {\n         return !(a == b);\n     }\n \n+    friend bool operator<(const CExtPubKey &a, const CExtPubKey &b)\n+    {\n+        if (a.pubkey < b.pubkey) {\n+            return true;\n+        }\n+        return a.chaincode < b.chaincode;\n+    }\n+\n     void Encode(unsigned char code[BIP32_EXTKEY_SIZE]) const;\n     void Decode(const unsigned char code[BIP32_EXTKEY_SIZE]);\n     void EncodeWithVersion(unsigned char code[BIP32_EXTKEY_WITH_VERSION_SIZE]) const;"
      },
      {
        "sha": "c779872be2c4dbeef66d89d35502c1e676bbc28a",
        "filename": "src/script/keyorigin.h",
        "status": "modified",
        "additions": 19,
        "deletions": 0,
        "changes": 19,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/22e7161feb8b5afdb913b0007066b71b716f3f9c/src/script/keyorigin.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/22e7161feb8b5afdb913b0007066b71b716f3f9c/src/script/keyorigin.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script/keyorigin.h?ref=22e7161feb8b5afdb913b0007066b71b716f3f9c",
        "patch": "@@ -18,6 +18,25 @@ struct KeyOriginInfo\n         return std::equal(std::begin(a.fingerprint), std::end(a.fingerprint), std::begin(b.fingerprint)) && a.path == b.path;\n     }\n \n+    friend bool operator<(const KeyOriginInfo& a, const KeyOriginInfo& b)\n+    {\n+        // Compare the fingerprints lexicographically\n+        int fpr_cmp = memcmp(a.fingerprint, b.fingerprint, 4);\n+        if (fpr_cmp < 0) {\n+            return true;\n+        } else if (fpr_cmp > 0) {\n+            return false;\n+        }\n+        // Compare the sizes of the paths, shorter is \"less than\"\n+        if (a.path.size() < b.path.size()) {\n+            return true;\n+        } else if (a.path.size() > b.path.size()) {\n+            return false;\n+        }\n+        // Paths same length, compare them lexicographically\n+        return a.path < b.path;\n+    }\n+\n     SERIALIZE_METHODS(KeyOriginInfo, obj) { READWRITE(obj.fingerprint, obj.path); }\n \n     void clear()"
      }
    ]
  },
  {
    "sha": "6c121791b96ff0ff4f1ba94ef31205571d63040e",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2YzEyMTc5MWI5NmZmMGZmNGYxYmE5NGVmMzEyMDU1NzFkNjMwNDBl",
    "commit": {
      "author": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2019-07-25T15:58:28Z"
      },
      "committer": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2021-01-12T20:41:23Z"
      },
      "message": "Implement serializations for PSBT_GLOBAL_XPUB",
      "tree": {
        "sha": "7ff75e978da7bd474a1532e9e97d02da2abb6eba",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7ff75e978da7bd474a1532e9e97d02da2abb6eba"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6c121791b96ff0ff4f1ba94ef31205571d63040e",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6c121791b96ff0ff4f1ba94ef31205571d63040e",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/6c121791b96ff0ff4f1ba94ef31205571d63040e",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6c121791b96ff0ff4f1ba94ef31205571d63040e/comments",
    "author": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "22e7161feb8b5afdb913b0007066b71b716f3f9c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/22e7161feb8b5afdb913b0007066b71b716f3f9c",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/22e7161feb8b5afdb913b0007066b71b716f3f9c"
      }
    ],
    "stats": {
      "total": 49,
      "additions": 49,
      "deletions": 0
    },
    "files": [
      {
        "sha": "cd716cf18e4363bb2ed10e86b53965d3734b52aa",
        "filename": "src/psbt.h",
        "status": "modified",
        "additions": 49,
        "deletions": 0,
        "changes": 49,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6c121791b96ff0ff4f1ba94ef31205571d63040e/src/psbt.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6c121791b96ff0ff4f1ba94ef31205571d63040e/src/psbt.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/psbt.h?ref=6c121791b96ff0ff4f1ba94ef31205571d63040e",
        "patch": "@@ -19,6 +19,7 @@ static constexpr uint8_t PSBT_MAGIC_BYTES[5] = {'p', 's', 'b', 't', 0xff};\n \n // Global types\n static constexpr uint8_t PSBT_GLOBAL_UNSIGNED_TX = 0x00;\n+static constexpr uint8_t PSBT_GLOBAL_XPUB = 0x01;\n \n // Input types\n static constexpr uint8_t PSBT_IN_NON_WITNESS_UTXO = 0x00;\n@@ -478,6 +479,9 @@ struct PSBTOutput\n struct PartiallySignedTransaction\n {\n     Optional<CMutableTransaction> tx;\n+    // We use a vector of CExtPubKey in the event that there happens to be the same KeyOriginInfos for different CExtPubKeys\n+    // Note that this map swaps the key and values from the serialization\n+    std::map<KeyOriginInfo, std::set<CExtPubKey>> xpubs;\n     std::vector<PSBTInput> inputs;\n     std::vector<PSBTOutput> outputs;\n     std::map<std::vector<unsigned char>, std::vector<unsigned char>> unknown;\n@@ -513,6 +517,18 @@ struct PartiallySignedTransaction\n         OverrideStream<Stream> os(&s, s.GetType(), s.GetVersion() | SERIALIZE_TRANSACTION_NO_WITNESS);\n         SerializeToVector(os, *tx);\n \n+        // Write xpubs\n+        for (const auto& xpub_pair : xpubs) {\n+            for (const auto& xpub : xpub_pair.second) {\n+                unsigned char ser_xpub[BIP32_EXTKEY_WITH_VERSION_SIZE];\n+                xpub.EncodeWithVersion(ser_xpub);\n+                // Note that the serialization swaps the key and value\n+                // The xpub is the key (for uniqueness) while the path is the value\n+                SerializeToVector(s, PSBT_GLOBAL_XPUB, ser_xpub);\n+                SerializeHDKeypath(s, xpub_pair.first);\n+            }\n+        }\n+\n         // Write the unknown things\n         for (auto& entry : unknown) {\n             s << entry.first;\n@@ -545,6 +561,9 @@ struct PartiallySignedTransaction\n         // Used for duplicate key detection\n         std::set<std::vector<unsigned char>> key_lookup;\n \n+        // Track the global xpubs we have already seen. Just for sanity checking\n+        std::set<CExtPubKey> global_xpubs;\n+\n         // Read global data\n         bool found_sep = false;\n         while(!s.empty()) {\n@@ -584,6 +603,36 @@ struct PartiallySignedTransaction\n                     }\n                     break;\n                 }\n+                case PSBT_GLOBAL_XPUB:\n+                {\n+                    if (key.size() != BIP32_EXTKEY_WITH_VERSION_SIZE + 1) {\n+                        throw std::ios_base::failure(\"Size of key was not the expected size for the type global xpub\");\n+                    }\n+                    // Read in the xpub from key\n+                    CExtPubKey xpub;\n+                    xpub.DecodeWithVersion(&key.data()[1]);\n+                    if (!xpub.pubkey.IsFullyValid()) {\n+                       throw std::ios_base::failure(\"Invalid pubkey\");\n+                    }\n+                    if (global_xpubs.count(xpub) > 0) {\n+                       throw std::ios_base::failure(\"Duplicate key, global xpub already provided\");\n+                    }\n+                    global_xpubs.insert(xpub);\n+                    // Read in the keypath from stream\n+                    KeyOriginInfo keypath;\n+                    DeserializeHDKeypath(s, keypath);\n+\n+                    // Note that we store these swapped to make searches faster.\n+                    // Serialization uses xpub -> keypath to enqure key uniqueness\n+                    if (xpubs.count(keypath) == 0) {\n+                        // Make a new set to put the xpub in\n+                        xpubs[keypath] = {xpub};\n+                    } else {\n+                        // Insert xpub into existing set\n+                        xpubs[keypath].insert(xpub);\n+                    }\n+                    break;\n+                }\n                 // Unknown stuff\n                 default: {\n                     if (unknown.count(key) > 0) {"
      }
    ]
  },
  {
    "sha": "ebb194838d1b0b21d5d9ad62d8f70b8a065c216d",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplYmIxOTQ4MzhkMWIwYjIxZDVkOWFkNjJkOGY3MGI4YTA2NWMyMTZk",
    "commit": {
      "author": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2019-07-25T17:20:38Z"
      },
      "committer": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2021-01-12T20:41:23Z"
      },
      "message": "Add global_xpubs to decodepsbt",
      "tree": {
        "sha": "6ace11ea654c7397f9d4c6da38b7b320e43b8299",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6ace11ea654c7397f9d4c6da38b7b320e43b8299"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ebb194838d1b0b21d5d9ad62d8f70b8a065c216d",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ebb194838d1b0b21d5d9ad62d8f70b8a065c216d",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/ebb194838d1b0b21d5d9ad62d8f70b8a065c216d",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ebb194838d1b0b21d5d9ad62d8f70b8a065c216d/comments",
    "author": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "6c121791b96ff0ff4f1ba94ef31205571d63040e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6c121791b96ff0ff4f1ba94ef31205571d63040e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/6c121791b96ff0ff4f1ba94ef31205571d63040e"
      }
    ],
    "stats": {
      "total": 27,
      "additions": 27,
      "deletions": 0
    },
    "files": [
      {
        "sha": "f010da0a7739fb1996ee9ef06c7f2a5399721d9b",
        "filename": "src/rpc/rawtransaction.cpp",
        "status": "modified",
        "additions": 27,
        "deletions": 0,
        "changes": 27,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ebb194838d1b0b21d5d9ad62d8f70b8a065c216d/src/rpc/rawtransaction.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ebb194838d1b0b21d5d9ad62d8f70b8a065c216d/src/rpc/rawtransaction.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/rawtransaction.cpp?ref=ebb194838d1b0b21d5d9ad62d8f70b8a065c216d",
        "patch": "@@ -3,6 +3,7 @@\n // Distributed under the MIT software license, see the accompanying\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n+#include <base58.h>\n #include <chain.h>\n #include <coins.h>\n #include <consensus/validation.h>\n@@ -1001,6 +1002,15 @@ static RPCHelpMan decodepsbt()\n                         {\n                             {RPCResult::Type::ELISION, \"\", \"The layout is the same as the output of decoderawtransaction.\"},\n                         }},\n+                        {RPCResult::Type::ARR, \"global_xpubs\", \"\",\n+                        {\n+                            {RPCResult::Type::OBJ, \"\", \"\",\n+                            {\n+                                {RPCResult::Type::STR, \"xpub\", \"The extended public key this path corresponds to\"},\n+                                {RPCResult::Type::STR_HEX, \"master_fingerprint\", \"The fingerprint of the master key\"},\n+                                {RPCResult::Type::STR, \"path\", \"The path\"},\n+                            }},\n+                        }},\n                         {RPCResult::Type::OBJ_DYN, \"unknown\", \"The unknown global fields\",\n                         {\n                              {RPCResult::Type::STR_HEX, \"key\", \"(key-value pair) An unknown key-value pair\"},\n@@ -1119,6 +1129,23 @@ static RPCHelpMan decodepsbt()\n     TxToUniv(CTransaction(*psbtx.tx), uint256(), tx_univ, false);\n     result.pushKV(\"tx\", tx_univ);\n \n+    // Add the global xpubs\n+    UniValue global_xpubs(UniValue::VARR);\n+    for (std::pair<KeyOriginInfo, std::set<CExtPubKey>> xpub_pair : psbtx.xpubs) {\n+        for (auto& xpub : xpub_pair.second) {\n+            std::vector<unsigned char> ser_xpub;\n+            ser_xpub.assign(BIP32_EXTKEY_WITH_VERSION_SIZE, 0);\n+            xpub.EncodeWithVersion(ser_xpub.data());\n+\n+            UniValue keypath(UniValue::VOBJ);\n+            keypath.pushKV(\"xpub\", EncodeBase58Check(ser_xpub));\n+            keypath.pushKV(\"master_fingerprint\", HexStr(Span<unsigned char>(xpub_pair.first.fingerprint, xpub_pair.first.fingerprint + 4)));\n+            keypath.pushKV(\"path\", WriteHDKeypath(xpub_pair.first.path));\n+            global_xpubs.push_back(keypath);\n+        }\n+    }\n+    result.pushKV(\"global_xpubs\", global_xpubs);\n+\n     // Unknown data\n     UniValue unknowns(UniValue::VOBJ);\n     for (auto entry : psbtx.unknown) {"
      }
    ]
  },
  {
    "sha": "4bf66a3743d722d7e0213248388475265e2442fd",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0YmY2NmEzNzQzZDcyMmQ3ZTAyMTMyNDgzODg0NzUyNjVlMjQ0MmZk",
    "commit": {
      "author": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2019-07-25T17:43:07Z"
      },
      "committer": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2021-01-12T20:41:23Z"
      },
      "message": "Add global xpub test vectors from BIP",
      "tree": {
        "sha": "302f9d1f3f82bf43aeb3a3b614dc0f7d539ce61f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/302f9d1f3f82bf43aeb3a3b614dc0f7d539ce61f"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4bf66a3743d722d7e0213248388475265e2442fd",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4bf66a3743d722d7e0213248388475265e2442fd",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/4bf66a3743d722d7e0213248388475265e2442fd",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4bf66a3743d722d7e0213248388475265e2442fd/comments",
    "author": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "ebb194838d1b0b21d5d9ad62d8f70b8a065c216d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ebb194838d1b0b21d5d9ad62d8f70b8a065c216d",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/ebb194838d1b0b21d5d9ad62d8f70b8a065c216d"
      }
    ],
    "stats": {
      "total": 4,
      "additions": 3,
      "deletions": 1
    },
    "files": [
      {
        "sha": "4bc3b9849ca73970f51be916b27bdd2834ac7dcc",
        "filename": "test/functional/data/rpc_psbt.json",
        "status": "modified",
        "additions": 3,
        "deletions": 1,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4bf66a3743d722d7e0213248388475265e2442fd/test/functional/data/rpc_psbt.json",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4bf66a3743d722d7e0213248388475265e2442fd/test/functional/data/rpc_psbt.json",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/data/rpc_psbt.json?ref=4bf66a3743d722d7e0213248388475265e2442fd",
        "patch": "@@ -34,7 +34,9 @@\n         \"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\"\n     ],\n     \"creator\" : [\n         {"
      }
    ]
  },
  {
    "sha": "9926a387eab52c5421c9340380152862ff010ef2",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo5OTI2YTM4N2VhYjUyYzU0MjFjOTM0MDM4MDE1Mjg2MmZmMDEwZWYy",
    "commit": {
      "author": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2019-07-31T21:24:44Z"
      },
      "committer": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2021-01-12T20:41:23Z"
      },
      "message": "Merge global xpubs in joinpsbts and combinepsbts",
      "tree": {
        "sha": "6d188959aa11577733b78d72252402406a82831d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6d188959aa11577733b78d72252402406a82831d"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9926a387eab52c5421c9340380152862ff010ef2",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9926a387eab52c5421c9340380152862ff010ef2",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/9926a387eab52c5421c9340380152862ff010ef2",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9926a387eab52c5421c9340380152862ff010ef2/comments",
    "author": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "4bf66a3743d722d7e0213248388475265e2442fd",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4bf66a3743d722d7e0213248388475265e2442fd",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/4bf66a3743d722d7e0213248388475265e2442fd"
      }
    ],
    "stats": {
      "total": 14,
      "additions": 14,
      "deletions": 0
    },
    "files": [
      {
        "sha": "0fc42bf530e85f61d6ab1d0420bdb0aa26ad7c2d",
        "filename": "src/psbt.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 0,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/9926a387eab52c5421c9340380152862ff010ef2/src/psbt.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/9926a387eab52c5421c9340380152862ff010ef2/src/psbt.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/psbt.cpp?ref=9926a387eab52c5421c9340380152862ff010ef2",
        "patch": "@@ -32,6 +32,13 @@ bool PartiallySignedTransaction::Merge(const PartiallySignedTransaction& psbt)\n     for (unsigned int i = 0; i < outputs.size(); ++i) {\n         outputs[i].Merge(psbt.outputs[i]);\n     }\n+    for (auto& xpub_pair : psbt.xpubs) {\n+        if (xpubs.count(xpub_pair.first) == 0) {\n+            xpubs[xpub_pair.first] = xpub_pair.second;\n+        } else {\n+            xpubs[xpub_pair.first].insert(xpub_pair.second.begin(), xpub_pair.second.end());\n+        }\n+    }\n     unknown.insert(psbt.unknown.begin(), psbt.unknown.end());\n \n     return true;"
      },
      {
        "sha": "d01a61367c67c3a24553155ce87f084d4efa2dc1",
        "filename": "src/rpc/rawtransaction.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 0,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/9926a387eab52c5421c9340380152862ff010ef2/src/rpc/rawtransaction.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/9926a387eab52c5421c9340380152862ff010ef2/src/rpc/rawtransaction.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/rawtransaction.cpp?ref=9926a387eab52c5421c9340380152862ff010ef2",
        "patch": "@@ -1738,6 +1738,13 @@ static RPCHelpMan joinpsbts()\n         for (unsigned int i = 0; i < psbt.tx->vout.size(); ++i) {\n             merged_psbt.AddOutput(psbt.tx->vout[i], psbt.outputs[i]);\n         }\n+        for (auto& xpub_pair : psbt.xpubs) {\n+            if (merged_psbt.xpubs.count(xpub_pair.first) == 0) {\n+                merged_psbt.xpubs[xpub_pair.first] = xpub_pair.second;\n+            } else {\n+                merged_psbt.xpubs[xpub_pair.first].insert(xpub_pair.second.begin(), xpub_pair.second.end());\n+            }\n+        }\n         merged_psbt.unknown.insert(psbt.unknown.begin(), psbt.unknown.end());\n     }\n "
      }
    ]
  }
]