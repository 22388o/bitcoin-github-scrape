[
  {
    "sha": "410f99faed47e27fca77531a864383b6119e7b0b",
    "node_id": "C_kwDOABII59oAKDQxMGY5OWZhZWQ0N2UyN2ZjYTc3NTMxYTg2NDM4M2I2MTE5ZTdiMGI",
    "commit": {
      "author": {
        "name": "CallMeMisterOwl",
        "email": "denizhasler@outlook.de",
        "date": "2021-11-14T14:00:29Z"
      },
      "committer": {
        "name": "CallMeMisterOwl",
        "email": "denizhasler@outlook.de",
        "date": "2021-11-14T14:00:29Z"
      },
      "message": "build_msvc/bitcoin_config.h is generated using build_msvc/msvc-autogen.py",
      "tree": {
        "sha": "43c6dd011e691e5b1cf3cb1d2fb194a34730aa5a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/43c6dd011e691e5b1cf3cb1d2fb194a34730aa5a"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/410f99faed47e27fca77531a864383b6119e7b0b",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/410f99faed47e27fca77531a864383b6119e7b0b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/410f99faed47e27fca77531a864383b6119e7b0b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/410f99faed47e27fca77531a864383b6119e7b0b/comments",
    "author": {
      "login": "CallMeMisterOwl",
      "id": 51458033,
      "node_id": "MDQ6VXNlcjUxNDU4MDMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/51458033?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/CallMeMisterOwl",
      "html_url": "https://github.com/CallMeMisterOwl",
      "followers_url": "https://api.github.com/users/CallMeMisterOwl/followers",
      "following_url": "https://api.github.com/users/CallMeMisterOwl/following{/other_user}",
      "gists_url": "https://api.github.com/users/CallMeMisterOwl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/CallMeMisterOwl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/CallMeMisterOwl/subscriptions",
      "organizations_url": "https://api.github.com/users/CallMeMisterOwl/orgs",
      "repos_url": "https://api.github.com/users/CallMeMisterOwl/repos",
      "events_url": "https://api.github.com/users/CallMeMisterOwl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/CallMeMisterOwl/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "CallMeMisterOwl",
      "id": 51458033,
      "node_id": "MDQ6VXNlcjUxNDU4MDMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/51458033?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/CallMeMisterOwl",
      "html_url": "https://github.com/CallMeMisterOwl",
      "followers_url": "https://api.github.com/users/CallMeMisterOwl/followers",
      "following_url": "https://api.github.com/users/CallMeMisterOwl/following{/other_user}",
      "gists_url": "https://api.github.com/users/CallMeMisterOwl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/CallMeMisterOwl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/CallMeMisterOwl/subscriptions",
      "organizations_url": "https://api.github.com/users/CallMeMisterOwl/orgs",
      "repos_url": "https://api.github.com/users/CallMeMisterOwl/repos",
      "events_url": "https://api.github.com/users/CallMeMisterOwl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/CallMeMisterOwl/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "9d2895157ec0ff6e356f40c5fe84d3007fc991c1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9d2895157ec0ff6e356f40c5fe84d3007fc991c1",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/9d2895157ec0ff6e356f40c5fe84d3007fc991c1"
      }
    ],
    "stats": {
      "total": 53,
      "additions": 44,
      "deletions": 9
    },
    "files": [
      {
        "sha": "83e53c8d567993291aa184d1ed3d653558d35365",
        "filename": "build_msvc/bitcoin_config.h.in",
        "status": "renamed",
        "additions": 7,
        "deletions": 7,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/410f99faed47e27fca77531a864383b6119e7b0b/build_msvc/bitcoin_config.h.in",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/410f99faed47e27fca77531a864383b6119e7b0b/build_msvc/bitcoin_config.h.in",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/build_msvc/bitcoin_config.h.in?ref=410f99faed47e27fca77531a864383b6119e7b0b",
        "patch": "@@ -6,16 +6,16 @@\n #define BITCOIN_BITCOIN_CONFIG_H\n \n /* Version Build */\n-#define CLIENT_VERSION_BUILD 0\n+#define CLIENT_VERSION_BUILD $\n \n /* Version is release */\n-#define CLIENT_VERSION_IS_RELEASE false\n+#define CLIENT_VERSION_IS_RELEASE $\n \n /* Major version */\n-#define CLIENT_VERSION_MAJOR 22\n+#define CLIENT_VERSION_MAJOR $\n \n /* Minor version */\n-#define CLIENT_VERSION_MINOR 99\n+#define CLIENT_VERSION_MINOR $\n \n /* Copyright holder(s) before %s replacement */\n #define COPYRIGHT_HOLDERS \"The %s developers\"\n@@ -27,7 +27,7 @@\n #define COPYRIGHT_HOLDERS_SUBSTITUTION \"Bitcoin Core\"\n \n /* Copyright year */\n-#define COPYRIGHT_YEAR 2021\n+#define COPYRIGHT_YEAR $\n \n /* Define to 1 to enable wallet functions */\n #define ENABLE_WALLET 1\n@@ -184,13 +184,13 @@\n #define PACKAGE_NAME \"Bitcoin Core\"\n \n /* Define to the full name and version of this package. */\n-#define PACKAGE_STRING \"Bitcoin Core 22.99.0\"\n+#define PACKAGE_STRING $\n \n /* Define to the home page for this package. */\n #define PACKAGE_URL \"https://bitcoincore.org/\"\n \n /* Define to the version of this package. */\n-#define PACKAGE_VERSION \"22.99.0\"\n+#define PACKAGE_VERSION $\n \n /* Define this symbol if the minimal qt platform exists */\n #define QT_QPA_PLATFORM_MINIMAL 1",
        "previous_filename": "build_msvc/bitcoin_config.h"
      },
      {
        "sha": "6ce65f3fa3a2bd2a8c1a275747d73ac076e2c3a7",
        "filename": "build_msvc/msvc-autogen.py",
        "status": "modified",
        "additions": 36,
        "deletions": 0,
        "changes": 36,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/410f99faed47e27fca77531a864383b6119e7b0b/build_msvc/msvc-autogen.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/410f99faed47e27fca77531a864383b6119e7b0b/build_msvc/msvc-autogen.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/build_msvc/msvc-autogen.py?ref=410f99faed47e27fca77531a864383b6119e7b0b",
        "patch": "@@ -57,6 +57,41 @@ def set_common_properties(toolset):\n     with open(os.path.join(SOURCE_DIR, '../build_msvc/common.init.vcxproj'), 'w', encoding='utf-8',newline='\\n') as wfile:\n         wfile.write(s)\n \n+def parse_config_into_btc_config():\n+    def find_between( s, first, last ):\n+        try:\n+            start = s.index( first ) + len( first )\n+            end = s.index( last, start )\n+            return s[start:end]\n+        except ValueError:\n+            return \"\"\n+\n+    config_info = []\n+    with open(os.path.join(SOURCE_DIR,'../configure.ac'), encoding=\"utf8\") as f:\n+        for line in f:\n+            if line.startswith(\"define\"):\n+                config_info.append(find_between(line, \"(_\", \")\"))\n+\n+    config_info = [c for c in config_info if not c.startswith(\"COPYRIGHT_HOLDERS\")]\n+\n+    config_dict = dict(item.split(\", \") for item in config_info)\n+    config_dict[\"PACKAGE_VERSION\"] = f\"\\\"{config_dict['CLIENT_VERSION_MAJOR']}.{config_dict['CLIENT_VERSION_MINOR']}.{config_dict['CLIENT_VERSION_BUILD']}\\\"\"\n+    version = config_dict[\"PACKAGE_VERSION\"].strip('\"')\n+    config_dict[\"PACKAGE_STRING\"] = f\"\\\"Bitcoin Core {version}\\\"\"\n+\n+    with open(os.path.join(SOURCE_DIR,'../build_msvc/bitcoin_config.h.in'), \"r\", encoding=\"utf8\") as template_file:\n+        template = template_file.readlines()\n+\n+    for index, line in enumerate(template):\n+        header = \"\"\n+        if line.startswith(\"#define\"):\n+            header = line.split(\" \")[1]\n+        if header in config_dict:\n+            template[index] = line.replace(\"$\", f\"{config_dict[header]}\")\n+\n+    with open(os.path.join(SOURCE_DIR,'../build_msvc/bitcoin_config.h'), \"w\", encoding=\"utf8\") as btc_config:\n+        btc_config.writelines(template)\n+\n def main():\n     parser = argparse.ArgumentParser(description='Bitcoin-core msbuild configuration initialiser.')\n     parser.add_argument('-toolset', nargs='?',help='Optionally sets the msbuild platform toolset, e.g. v142 for Visual Studio 2019.'\n@@ -79,6 +114,7 @@ def main():\n             with open(vcxproj_filename, 'w', encoding='utf-8') as vcxproj_file:\n                 vcxproj_file.write(vcxproj_in_file.read().replace(\n                     '@SOURCE_FILES@\\n', content))\n+    parse_config_into_btc_config()\n     copyfile(os.path.join(SOURCE_DIR,'../build_msvc/bitcoin_config.h'), os.path.join(SOURCE_DIR, 'config/bitcoin-config.h'))\n     copyfile(os.path.join(SOURCE_DIR,'../build_msvc/libsecp256k1_config.h'), os.path.join(SOURCE_DIR, 'secp256k1/src/libsecp256k1-config.h'))\n "
      },
      {
        "sha": "f786b345b1a94052e6d1ca6687d1ed0b2b8995f7",
        "filename": "doc/release-process.md",
        "status": "modified",
        "additions": 1,
        "deletions": 2,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/410f99faed47e27fca77531a864383b6119e7b0b/doc/release-process.md",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/410f99faed47e27fca77531a864383b6119e7b0b/doc/release-process.md",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/doc/release-process.md?ref=410f99faed47e27fca77531a864383b6119e7b0b",
        "patch": "@@ -19,8 +19,7 @@ Release Process\n \n * On both the master branch and the new release branch:\n   - update `CLIENT_VERSION_MAJOR` in [`configure.ac`](../configure.ac)\n-  - update `CLIENT_VERSION_MAJOR`, `PACKAGE_VERSION`, and `PACKAGE_STRING` in [`build_msvc/bitcoin_config.h`](/build_msvc/bitcoin_config.h)\n-* On the new release branch in [`configure.ac`](../configure.ac) and [`build_msvc/bitcoin_config.h`](/build_msvc/bitcoin_config.h) (see [this commit](https://github.com/bitcoin/bitcoin/commit/742f7dd)):\n+* On the new release branch in [`configure.ac`](../configure.ac)(see [this commit](https://github.com/bitcoin/bitcoin/commit/742f7dd)):\n   - set `CLIENT_VERSION_MINOR` to `0`\n   - set `CLIENT_VERSION_BUILD` to `0`\n   - set `CLIENT_VERSION_IS_RELEASE` to `true`"
      }
    ]
  }
]