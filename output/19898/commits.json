[
  {
    "sha": "62dba9628d2532dca0c44934600f5aac3b21e275",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2MmRiYTk2MjhkMjUzMmRjYTBjNDQ5MzQ2MDBmNWFhYzNiMjFlMjc1",
    "commit": {
      "author": {
        "name": "nthumann",
        "email": "me@n-thumann.de",
        "date": "2020-09-06T16:11:18Z"
      },
      "committer": {
        "name": "nthumann",
        "email": "me@n-thumann.de",
        "date": "2020-09-09T18:57:06Z"
      },
      "message": "log: print unexpected version warning in validation log category\n\nInstead of printing \"<n> of the last 100 blocks have unexpected version\"\nas a warning appended to UpdateTip, it is now printed in the validation\nlog category.",
      "tree": {
        "sha": "770e4becb6379289ae569c71822b299462df2265",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/770e4becb6379289ae569c71822b299462df2265"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/62dba9628d2532dca0c44934600f5aac3b21e275",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEECpbFYxDyKGvEvGXoka4m9S3lS3YFAl9ZJYIACgkQka4m9S3l\nS3Z1sRAAhlhB2h7QBG3eQ48tORMRTByB/P2ff2+Ik+SZXolTROdYA5IRh/Z827hJ\nNpQnez3doz+7zTn0liBAyrSsnxeLtraT/RDaPJwnEPyeZ3+EGTR+oYwtssUc/vxt\nmj4C2h+vd60EZz+lJGStbXnO4n5T7i6X3LQATQDD2u6/Y5NcFgrM5RuYCP/1Sa3v\nYEjntOSyRJa2+f6KqjSlzgNXEPaVVq+qjO3xvjLE9I5ZrZMGrT7czQXV2SNtixNc\nsWltfNCAJjwJ4+j44bbveqw2hv0ck4at0Fjwlrw4e8NHI3ykQAqV5kshsUzT/myM\nIMj/pSsq0ld/6sGMIbysQ9z4HqmGyaHYptzkvmVfId8MTD9UBhcW+ne0mZq2wRV3\nh09UsjnCaYbEkvJ2B8JcplGq5yzuT9+mcfeMp8SHa5GbjLT3FA5LqrGs1A6g5dfQ\nf1zHYujDyZ/J15rglyHKBdIGIoztcq0n1O+7GN3O/ApQerPPhcwyivirogZ+51vT\nnvU9SU1pbpv0vWr7LjEK1hmKorm+fHs6T8dH4zJrRkDvdjTqBWtZaXzilcyJMm84\nTmefmSeQwStMnWhTMXMc4CttjPysE/ZjeU23/hd1thPr8P67Zta/IPgWfzUL4snT\nu1h2fVfMHgFugHHD002RUJZ0I34IvpqfzY67tsqEvp2Q/yxrhIM=\n=0wSJ\n-----END PGP SIGNATURE-----",
        "payload": "tree 770e4becb6379289ae569c71822b299462df2265\nparent 68d1f1698f50f9f3c848d988b6f89fe981cc662c\nauthor nthumann <me@n-thumann.de> 1599408678 +0200\ncommitter nthumann <me@n-thumann.de> 1599677826 +0200\n\nlog: print unexpected version warning in validation log category\n\nInstead of printing \"<n> of the last 100 blocks have unexpected version\"\nas a warning appended to UpdateTip, it is now printed in the validation\nlog category.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/62dba9628d2532dca0c44934600f5aac3b21e275",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/62dba9628d2532dca0c44934600f5aac3b21e275",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/62dba9628d2532dca0c44934600f5aac3b21e275/comments",
    "author": {
      "login": "n-thumann",
      "id": 46975855,
      "node_id": "MDQ6VXNlcjQ2OTc1ODU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/46975855?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/n-thumann",
      "html_url": "https://github.com/n-thumann",
      "followers_url": "https://api.github.com/users/n-thumann/followers",
      "following_url": "https://api.github.com/users/n-thumann/following{/other_user}",
      "gists_url": "https://api.github.com/users/n-thumann/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/n-thumann/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/n-thumann/subscriptions",
      "organizations_url": "https://api.github.com/users/n-thumann/orgs",
      "repos_url": "https://api.github.com/users/n-thumann/repos",
      "events_url": "https://api.github.com/users/n-thumann/events{/privacy}",
      "received_events_url": "https://api.github.com/users/n-thumann/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "n-thumann",
      "id": 46975855,
      "node_id": "MDQ6VXNlcjQ2OTc1ODU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/46975855?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/n-thumann",
      "html_url": "https://github.com/n-thumann",
      "followers_url": "https://api.github.com/users/n-thumann/followers",
      "following_url": "https://api.github.com/users/n-thumann/following{/other_user}",
      "gists_url": "https://api.github.com/users/n-thumann/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/n-thumann/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/n-thumann/subscriptions",
      "organizations_url": "https://api.github.com/users/n-thumann/orgs",
      "repos_url": "https://api.github.com/users/n-thumann/repos",
      "events_url": "https://api.github.com/users/n-thumann/events{/privacy}",
      "received_events_url": "https://api.github.com/users/n-thumann/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "68d1f1698f50f9f3c848d988b6f89fe981cc662c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/68d1f1698f50f9f3c848d988b6f89fe981cc662c",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/68d1f1698f50f9f3c848d988b6f89fe981cc662c"
      }
    ],
    "stats": {
      "total": 10,
      "additions": 6,
      "deletions": 4
    },
    "files": [
      {
        "sha": "824f4a766b2b46a1733773669682dbdaa40f0d72",
        "filename": "src/validation.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 4,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/62dba9628d2532dca0c44934600f5aac3b21e275/src/validation.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/62dba9628d2532dca0c44934600f5aac3b21e275/src/validation.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/validation.cpp?ref=62dba9628d2532dca0c44934600f5aac3b21e275",
        "patch": "@@ -2441,9 +2441,9 @@ static void UpdateTip(CTxMemPool& mempool, const CBlockIndex* pindexNew, const C\n     }\n \n     bilingual_str warning_messages;\n+    int num_unexpected_version = 0;\n     if (!::ChainstateActive().IsInitialBlockDownload())\n     {\n-        int nUpgraded = 0;\n         const CBlockIndex* pindex = pindexNew;\n         for (int bit = 0; bit < VERSIONBITS_NUM_BITS; bit++) {\n             WarningBitsConditionChecker checker(bit);\n@@ -2462,18 +2462,20 @@ static void UpdateTip(CTxMemPool& mempool, const CBlockIndex* pindexNew, const C\n         {\n             int32_t nExpectedVersion = ComputeBlockVersion(pindex->pprev, chainParams.GetConsensus());\n             if (pindex->nVersion > VERSIONBITS_LAST_OLD_BLOCK_VERSION && (pindex->nVersion & ~nExpectedVersion) != 0)\n-                ++nUpgraded;\n+                ++num_unexpected_version;\n             pindex = pindex->pprev;\n         }\n-        if (nUpgraded > 0)\n-            AppendWarning(warning_messages, strprintf(_(\"%d of last 100 blocks have unexpected version\"), nUpgraded));\n     }\n     LogPrintf(\"%s: new best=%s height=%d version=0x%08x log2_work=%f tx=%lu date='%s' progress=%f cache=%.1fMiB(%utxo)%s\\n\", __func__,\n       pindexNew->GetBlockHash().ToString(), pindexNew->nHeight, pindexNew->nVersion,\n       log(pindexNew->nChainWork.getdouble())/log(2.0), (unsigned long)pindexNew->nChainTx,\n       FormatISO8601DateTime(pindexNew->GetBlockTime()),\n       GuessVerificationProgress(chainParams.TxData(), pindexNew), ::ChainstateActive().CoinsTip().DynamicMemoryUsage() * (1.0 / (1<<20)), ::ChainstateActive().CoinsTip().GetCacheSize(),\n       !warning_messages.empty() ? strprintf(\" warning='%s'\", warning_messages.original) : \"\");\n+\n+    if (num_unexpected_version > 0) {\n+        LogPrint(BCLog::VALIDATION, \"%d of last 100 blocks have unexpected version\\n\", num_unexpected_version);\n+    }\n }\n \n /** Disconnect m_chain's tip."
      }
    ]
  }
]