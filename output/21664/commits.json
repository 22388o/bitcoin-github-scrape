[
  {
    "sha": "465967b5ef4b4f02e9d6783a94eca012d4ebcdab",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0NjU5NjdiNWVmNGI0ZjAyZTlkNjc4M2E5NGVjYTAxMmQ0ZWJjZGFi",
    "commit": {
      "author": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-04-09T02:11:47Z"
      },
      "committer": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-05-04T12:47:58Z"
      },
      "message": "gitian: install LIEF in gitian container",
      "tree": {
        "sha": "2ed83be0110f6ee229431c5c88faf405e5617626",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2ed83be0110f6ee229431c5c88faf405e5617626"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/465967b5ef4b4f02e9d6783a94eca012d4ebcdab",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz7FuIclQ9n+pXlWPLuufXMCVJsEFAmCRQn8ACgkQLuufXMCV\nJsGOcg//dABMddmvzDHA7VI3XEH5yDah9YEQxa/PcMw+vsUEb8IVkl53ckG+dL81\nCh4p7i/6D1lIcOiBuYDIWO6ulADn32FtmXTdw8ogqT/qcjsNaWPCSl0TVKX1z1Xr\nchlpgWkcwvLEgKHNRa/j7eWUGcU5wOCSUwPSLHNcl+kldTHjUp6TXdR87IAWqkUO\nC8G7IsF10R0BXuTkUYUd+Sg9fUBOsG7hOx43GT44NpNKA07VBYMDBy4tSsTCjEkJ\nUu2jMc5LhNFiyw2OZkHq/yYIrCziinG87IqOkV+Y+bq8aNZ5OPYsko5lo9ZQ2SfX\nGozTggmuUujvgG7gxNFgumV7robqi2CYvSVaeR2DZl7uH1eKH1kwA52MCgBSVVPO\nfmIApdq8XhyZUCvqHiU4sEH8ViV5Ht44OdT4wwLYMtWQ8WqAkcOd0x22inWG5vZ3\nsCdMrUSWmabV9f55PbbJU3TAc54hLHXvx9lH8TgSrF2/ylgPTVgtmCvi8HlUNpXE\nJfH3H3zfbFepCnKltmqQUAy1969Kc2PCi93IpAY3PMya9/2KUNXFLsvMJ1vktPLl\nYXyro5iPOkkc9NUftJSaVSu1bQK8Ao9AyE6WO6BQYUefmmXt03alblyiyhEbwkUm\ntxh1svUcRXKTfsVtwjcGc+/aj7gsQI+u3UomnFBIY2Men6Es/eU=\n=J4sQ\n-----END PGP SIGNATURE-----",
        "payload": "tree 2ed83be0110f6ee229431c5c88faf405e5617626\nparent 0ca8b7e7ecd5bc537fbc1e372f6755a34a136f7f\nauthor fanquake <fanquake@gmail.com> 1617934307 +0800\ncommitter fanquake <fanquake@gmail.com> 1620132478 +0800\n\ngitian: install LIEF in gitian container\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/465967b5ef4b4f02e9d6783a94eca012d4ebcdab",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/465967b5ef4b4f02e9d6783a94eca012d4ebcdab",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/465967b5ef4b4f02e9d6783a94eca012d4ebcdab/comments",
    "author": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "0ca8b7e7ecd5bc537fbc1e372f6755a34a136f7f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0ca8b7e7ecd5bc537fbc1e372f6755a34a136f7f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/0ca8b7e7ecd5bc537fbc1e372f6755a34a136f7f"
      }
    ],
    "stats": {
      "total": 9,
      "additions": 9,
      "deletions": 0
    },
    "files": [
      {
        "sha": "103e249e332a70ee9bad6d874c74d6a63bf94657",
        "filename": "contrib/gitian-descriptors/gitian-linux.yml",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/465967b5ef4b4f02e9d6783a94eca012d4ebcdab/contrib/gitian-descriptors/gitian-linux.yml",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/465967b5ef4b4f02e9d6783a94eca012d4ebcdab/contrib/gitian-descriptors/gitian-linux.yml",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/gitian-descriptors/gitian-linux.yml?ref=465967b5ef4b4f02e9d6783a94eca012d4ebcdab",
        "patch": "@@ -23,6 +23,7 @@ packages:\n - \"patch\"\n - \"pkg-config\"\n - \"python3\"\n+- \"python3-pip\"\n # Cross compilation HOSTS:\n #  - arm-linux-gnueabihf\n - \"binutils-arm-linux-gnueabihf\"\n@@ -99,6 +100,8 @@ script: |\n   done\n   }\n \n+  pip3 install lief==0.11.4\n+\n   # Faketime for depends so intermediate results are comparable\n   export PATH_orig=${PATH}\n   create_global_faketime_wrappers \"2000-01-01 12:00:00\""
      },
      {
        "sha": "d6c41b2c43cb1fbd11a5684323acc97235477956",
        "filename": "contrib/gitian-descriptors/gitian-osx.yml",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/465967b5ef4b4f02e9d6783a94eca012d4ebcdab/contrib/gitian-descriptors/gitian-osx.yml",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/465967b5ef4b4f02e9d6783a94eca012d4ebcdab/contrib/gitian-descriptors/gitian-osx.yml",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/gitian-descriptors/gitian-osx.yml?ref=465967b5ef4b4f02e9d6783a94eca012d4ebcdab",
        "patch": "@@ -23,6 +23,7 @@ packages:\n - \"imagemagick\"\n - \"libz-dev\"\n - \"python3\"\n+- \"python3-pip\"\n - \"python3-setuptools\"\n - \"fonts-tuffy\"\n - \"xorriso\"\n@@ -78,6 +79,8 @@ script: |\n   done\n   }\n \n+  pip3 install lief==0.11.4\n+\n   # Faketime for depends so intermediate results are comparable\n   export PATH_orig=${PATH}\n   create_global_faketime_wrappers \"2000-01-01 12:00:00\""
      },
      {
        "sha": "eabcdaa79d30bb8202cbd7941f3a5ea4cfa6f15b",
        "filename": "contrib/gitian-descriptors/gitian-win.yml",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/465967b5ef4b4f02e9d6783a94eca012d4ebcdab/contrib/gitian-descriptors/gitian-win.yml",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/465967b5ef4b4f02e9d6783a94eca012d4ebcdab/contrib/gitian-descriptors/gitian-win.yml",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/gitian-descriptors/gitian-win.yml?ref=465967b5ef4b4f02e9d6783a94eca012d4ebcdab",
        "patch": "@@ -22,6 +22,7 @@ packages:\n - \"zip\"\n - \"ca-certificates\"\n - \"python3\"\n+- \"python3-pip\"\n remotes:\n - \"url\": \"https://github.com/bitcoin/bitcoin.git\"\n   \"dir\": \"bitcoin\"\n@@ -86,6 +87,8 @@ script: |\n   done\n   }\n \n+  pip3 install lief==0.11.4\n+\n   # Faketime for depends so intermediate results are comparable\n   export PATH_orig=${PATH}\n   create_global_faketime_wrappers \"2000-01-01 12:00:00\""
      }
    ]
  },
  {
    "sha": "2e7a9f7ade0c7b31e762c0ddb9e0944a0d9c798e",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyZTdhOWY3YWRlMGM3YjMxZTc2MmMwZGRiOWUwOTQ0YTBkOWM3OThl",
    "commit": {
      "author": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-04-09T02:12:14Z"
      },
      "committer": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-05-04T12:47:59Z"
      },
      "message": "guix: install LIEF in Guix container\n\nCo-authored-by: Carl Dong <contact@carldong.me>",
      "tree": {
        "sha": "7cd03bdb7d468ee2c9382b2b8155403e43d5e76b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7cd03bdb7d468ee2c9382b2b8155403e43d5e76b"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2e7a9f7ade0c7b31e762c0ddb9e0944a0d9c798e",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz7FuIclQ9n+pXlWPLuufXMCVJsEFAmCRQn8ACgkQLuufXMCV\nJsHhbxAAlPGIQK5v2zrzY4Mhreom4UYSrrpUn8D+p5pwNsKr2/8ozYEjKSdXaLjb\nsSIAZhT9ba4Gs0lVKqNDw4jSiXhEvE7YRfJtifgFcHWrVhj17HUhnORtHxvvUjVg\nHm1AhAXRjPVIrmR439rMh7K9OJ1LSkdZogtMUziow8MhjhtmwCzYVEqwkHLWGPBi\njMHJdHw1Hwzkwtoz/I15bar0Rn014iBMe1/vp4ASSlFa3s6faxC/Aruk0HPk6wwX\n8zbUzLmyJ9Iihw7wmBb0fxnKLN2t8Z/k1Cs5PPaV/QOQCdnJCbQyXke2AdhI/tE5\nsWZWYHSVEIjXa/HAamyLviGZKsCZBuyBFpgHqg1kUcEFPv8mLR+r+I4v1ELoI9PD\n+OUN+HEvZC4ERdQwFvDHq/8xnI5zngfxFnoZKTrQ6gW7pxqMiZMm1GgUS6Jw0r4a\n8xwZnPAk2OT9G5n/HPukYaUaCYw/PiB6WDhKCYaEFK7apGXDAd/kW2lTCWp962oE\nfWRFba2tS5EczKBF1oMqKz5OcwsDbME8Sm7GtZm+1ySg3V4yq8zg6e362+JqwFaT\nIQJoml20u6YuqOl8hAuTUnxU5rLiEv6RaGR22eLQYamy5M3+r99w9SgDM95R80vS\nVy8sjE+kEfe63kwiayEQ3xnLtajaqnBAX2oBGCRcPlTPYzetX3s=\n=QmT6\n-----END PGP SIGNATURE-----",
        "payload": "tree 7cd03bdb7d468ee2c9382b2b8155403e43d5e76b\nparent 465967b5ef4b4f02e9d6783a94eca012d4ebcdab\nauthor fanquake <fanquake@gmail.com> 1617934334 +0800\ncommitter fanquake <fanquake@gmail.com> 1620132479 +0800\n\nguix: install LIEF in Guix container\n\nCo-authored-by: Carl Dong <contact@carldong.me>\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2e7a9f7ade0c7b31e762c0ddb9e0944a0d9c798e",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/2e7a9f7ade0c7b31e762c0ddb9e0944a0d9c798e",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2e7a9f7ade0c7b31e762c0ddb9e0944a0d9c798e/comments",
    "author": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "465967b5ef4b4f02e9d6783a94eca012d4ebcdab",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/465967b5ef4b4f02e9d6783a94eca012d4ebcdab",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/465967b5ef4b4f02e9d6783a94eca012d4ebcdab"
      }
    ],
    "stats": {
      "total": 27,
      "additions": 27,
      "deletions": 0
    },
    "files": [
      {
        "sha": "c85aa0ebc93b9a5cedf592053819c5dd5d5f2969",
        "filename": "contrib/guix/manifest.scm",
        "status": "modified",
        "additions": 27,
        "deletions": 0,
        "changes": 27,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/2e7a9f7ade0c7b31e762c0ddb9e0944a0d9c798e/contrib/guix/manifest.scm",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/2e7a9f7ade0c7b31e762c0ddb9e0944a0d9c798e/contrib/guix/manifest.scm",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/guix/manifest.scm?ref=2e7a9f7ade0c7b31e762c0ddb9e0944a0d9c798e",
        "patch": "@@ -27,9 +27,11 @@\n              (gnu packages version-control)\n              (guix build-system font)\n              (guix build-system gnu)\n+             (guix build-system python)\n              (guix build-system trivial)\n              (guix download)\n              (guix gexp)\n+             (guix git-download)\n              ((guix licenses) #:prefix license:)\n              (guix packages)\n              (guix profiles)\n@@ -192,6 +194,29 @@ chain for \" target \" development.\"))\n     \"Thatcher Ulrich's first outline font design. He started with the goal of producing a neutral, readable sans-serif text font. There are lots of \\\"expressive\\\" fonts out there, but he wanted to start with something very plain and clean, something he might want to actually use. \")\n    (license license:public-domain)))\n \n+(define-public lief\n+  (package\n+   (name \"python-lief\")\n+   (version \"0.11.4\")\n+   (source\n+    (origin\n+     (method git-fetch)\n+     (uri (git-reference\n+           (url \"https://github.com/lief-project/LIEF.git\")\n+           (commit version)))\n+     (file-name (git-file-name name version))\n+     (sha256\n+      (base32\n+       \"0h4kcwr9z478almjqhmils8imfpflzk0r7d05g4xbkdyknn162qf\"))))\n+   (build-system python-build-system)\n+   (native-inputs\n+    `((\"cmake\" ,cmake)))\n+   (home-page \"https://github.com/lief-project/LIEF\")\n+   (synopsis \"Library to Instrument Executable Formats\")\n+   (description \"Python library to to provide a cross platform library which can\n+parse, modify and abstract ELF, PE and MachO formats.\")\n+   (license license:asl2.0)))\n+\n (packages->manifest\n  (append\n   (list ;; The Basics\n@@ -227,6 +252,8 @@ chain for \" target \" development.\"))\n         python-3\n         ;; Git\n         git\n+        ;; Tests\n+        lief\n         ;; Native gcc 7 toolchain\n         gcc-toolchain-7\n         (list gcc-toolchain-7 \"static\"))"
      }
    ]
  },
  {
    "sha": "7e7eae7aa86ab95c44eed601f8c993285a256bbc",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3ZTdlYWU3YWE4NmFiOTVjNDRlZWQ2MDFmOGM5OTMyODVhMjU2YmJj",
    "commit": {
      "author": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-04-07T01:37:16Z"
      },
      "committer": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-05-04T12:47:59Z"
      },
      "message": "contrib: use f strings in security-check.py",
      "tree": {
        "sha": "f6854a99d5577a681978a0246fa3edd4136e81f0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f6854a99d5577a681978a0246fa3edd4136e81f0"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7e7eae7aa86ab95c44eed601f8c993285a256bbc",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz7FuIclQ9n+pXlWPLuufXMCVJsEFAmCRQn8ACgkQLuufXMCV\nJsFRCg//WjEbvtJX7Qy/WxUe4WaFDsqgN+SPiN5I9kTKJ/oKQASRFZEPh4fEa1GU\nSZhn6x6VQaqNFch9z/2jbOVeMkAZFVWQrkl/W1fo9CfuUSMsSCHiz4n/FijHJNON\nl7B0QgdX+Ulj4Q8WnHvtaWdU7aJZpXljEYA2izERWwex3VfpcXbLLpWaRv+nXV4j\nUxWVtqNR4gVz1vPAjUGo5AeDl2vKZ+RRLBCb2geZI0AbNMz6jBjDpgx2dOyxPpIE\nWi5uAY/NTtF6KGlmLJLTLXGipTgPo0DjTQSixvPTUHdnG6PLkJauhjSPmBdLFKKh\n3/F8KKPA17CkSG0IWG5JSrO+tJPEGKkQIzBu9LZPaPH49wAEtjg1r0Hcl1hhwEnu\nyeW4eExPG27mYvCad2d0JaACNpd/IuYCesVq3+8ecbSbB4qqjan/pFszKng8SL0B\n8BLc/3civdimFsFPvUBX21En6O2XDkX0Sq+aPulg6IYOyT9CXsSbialW3zWa2TBZ\nqx/LTBg/+AaYRELkPPNskgHellB+s/Ep0SFco8H408hrU2KEMg685cGDeSldkfPV\ngVCEXOHoMId6RdvKPhH6D0bfS2QsaJ4s1SGWZAGA50q7/w+gzLsJWMde84SHl7wn\nEfziY2m2MuXNjOp1x1kHjA76sNTVPDzU+/gQ8QjZI7LWDhwgB0A=\n=aFVu\n-----END PGP SIGNATURE-----",
        "payload": "tree f6854a99d5577a681978a0246fa3edd4136e81f0\nparent 2e7a9f7ade0c7b31e762c0ddb9e0944a0d9c798e\nauthor fanquake <fanquake@gmail.com> 1617759436 +0800\ncommitter fanquake <fanquake@gmail.com> 1620132479 +0800\n\ncontrib: use f strings in security-check.py\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7e7eae7aa86ab95c44eed601f8c993285a256bbc",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/7e7eae7aa86ab95c44eed601f8c993285a256bbc",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7e7eae7aa86ab95c44eed601f8c993285a256bbc/comments",
    "author": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "2e7a9f7ade0c7b31e762c0ddb9e0944a0d9c798e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2e7a9f7ade0c7b31e762c0ddb9e0944a0d9c798e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/2e7a9f7ade0c7b31e762c0ddb9e0944a0d9c798e"
      }
    ],
    "stats": {
      "total": 10,
      "additions": 5,
      "deletions": 5
    },
    "files": [
      {
        "sha": "7a0761ad1570ad88580f449994b9e5be8842c325",
        "filename": "contrib/devtools/security-check.py",
        "status": "modified",
        "additions": 5,
        "deletions": 5,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7e7eae7aa86ab95c44eed601f8c993285a256bbc/contrib/devtools/security-check.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7e7eae7aa86ab95c44eed601f8c993285a256bbc/contrib/devtools/security-check.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/devtools/security-check.py?ref=7e7eae7aa86ab95c44eed601f8c993285a256bbc",
        "patch": "@@ -285,24 +285,24 @@ def identify_executable(executable) -> Optional[str]:\n     return None\n \n if __name__ == '__main__':\n-    retval = 0\n+    retval: int = 0\n     for filename in sys.argv[1:]:\n         try:\n             etype = identify_executable(filename)\n             if etype is None:\n-                print('%s: unknown format' % filename)\n+                print(f'{filename}: unknown format')\n                 retval = 1\n                 continue\n \n-            failed = []\n+            failed: List[str] = []\n             for (name, func) in CHECKS[etype]:\n                 if not func(filename):\n                     failed.append(name)\n             if failed:\n-                print('%s: failed %s' % (filename, ' '.join(failed)))\n+                print(f'{filename}: failed {\" \".join(failed)}')\n                 retval = 1\n         except IOError:\n-            print('%s: cannot open' % filename)\n+            print(f'{filename}: cannot open')\n             retval = 1\n     sys.exit(retval)\n "
      }
    ]
  },
  {
    "sha": "a25b2e965c93fe2a46a2f8f1e7bdf5642d453511",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphMjViMmU5NjVjOTNmZTJhNDZhMmY4ZjFlN2JkZjU2NDJkNDUzNTEx",
    "commit": {
      "author": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-04-07T01:38:00Z"
      },
      "committer": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-05-04T12:47:59Z"
      },
      "message": "contrib: use LIEF for macOS security checks",
      "tree": {
        "sha": "c4cb7754aead90af3f31671d10e803c27f75ab05",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c4cb7754aead90af3f31671d10e803c27f75ab05"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a25b2e965c93fe2a46a2f8f1e7bdf5642d453511",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz7FuIclQ9n+pXlWPLuufXMCVJsEFAmCRQn8ACgkQLuufXMCV\nJsFgfQ//ecaKYBKPbgZBb0Ce2NchFl9dKTfThxoEjflJm8cgJldYW5OTctHBCd9U\nnDXjVrtcq4lm2IG+5omkqn5DzLVsujWSa6KqC7cNdzqnM1bd/8tpszw83F3H3KFo\nz32YFcluLEtp+1xvqxZt9Wx3/9IOChHRA6KKy3YaJnREpq2nGqZX1KzbyxVzSW0E\n2AtGD57+S/LTFQaHJ5iGxALnVUTrZdkq3GSEiZS62VfXPeCSwk0YWNjmwQ91GZ+V\nBfXhtKCXDo82rNeIVopd21B+y6AkYQv9EU4pMg3EDZ9WDCAZXZKlnbO8ma5b2IM5\n1fEMKIXWwjkKSAzDSbf9tICTDG2ffgymSZjwVmpwVUKgnzyoNpqeXqZaHmVTl4Kc\nRR7TQVXbVOa/wSds3tmV5XRsZD3YYLtDrt93qv4eOyfklqbmznIqz9gvgbvsVKFa\nBjiB/32NnmRGn9Zpn6S2ybM9HoZm84rmer1eMWPinckxVEffBNSSNgGErz9SG/iS\n+hD8gztNHCLZuHNXTgTFj9A4vBm7r9yFJvLKPvnBhWcPPmp62ZUfG21HdzQ2VsKs\neJpGcuNgQc2Zcsjt05bVzVL/B8zsALi6gBMVhzSWYQC9CjjFU08NsE6aOiSVYnuY\nPb6P00XyD0DPP/+k/YYt+Ues0H8gNua6K8jsCmVf3kEXOAJnTg8=\n=udQI\n-----END PGP SIGNATURE-----",
        "payload": "tree c4cb7754aead90af3f31671d10e803c27f75ab05\nparent 7e7eae7aa86ab95c44eed601f8c993285a256bbc\nauthor fanquake <fanquake@gmail.com> 1617759480 +0800\ncommitter fanquake <fanquake@gmail.com> 1620132479 +0800\n\ncontrib: use LIEF for macOS security checks\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a25b2e965c93fe2a46a2f8f1e7bdf5642d453511",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/a25b2e965c93fe2a46a2f8f1e7bdf5642d453511",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a25b2e965c93fe2a46a2f8f1e7bdf5642d453511/comments",
    "author": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "7e7eae7aa86ab95c44eed601f8c993285a256bbc",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7e7eae7aa86ab95c44eed601f8c993285a256bbc",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/7e7eae7aa86ab95c44eed601f8c993285a256bbc"
      }
    ],
    "stats": {
      "total": 54,
      "additions": 12,
      "deletions": 42
    },
    "files": [
      {
        "sha": "bc65d9a9be5a9c148d5a2f41368fcb71f2956d07",
        "filename": "contrib/devtools/security-check.py",
        "status": "modified",
        "additions": 12,
        "deletions": 42,
        "changes": 54,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a25b2e965c93fe2a46a2f8f1e7bdf5642d453511/contrib/devtools/security-check.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a25b2e965c93fe2a46a2f8f1e7bdf5642d453511/contrib/devtools/security-check.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/devtools/security-check.py?ref=a25b2e965c93fe2a46a2f8f1e7bdf5642d453511",
        "patch": "@@ -6,17 +6,17 @@\n Perform basic security checks on a series of executables.\n Exit status will be 0 if successful, and the program will be silent.\n Otherwise the exit status will be 1 and it will log which executables failed which checks.\n-Needs `objdump` (for PE) and `otool` (for MACHO).\n+Needs `objdump` (for PE).\n '''\n import subprocess\n import sys\n import os\n from typing import List, Optional\n \n+import lief\n import pixie\n \n OBJDUMP_CMD = os.getenv('OBJDUMP', '/usr/bin/objdump')\n-OTOOL_CMD = os.getenv('OTOOL', '/usr/bin/otool')\n \n def run_command(command) -> str:\n     p = subprocess.run(command, stdout=subprocess.PIPE, check=True, universal_newlines=True)\n@@ -184,71 +184,41 @@ def check_PE_NX(executable) -> bool:\n     bits = get_PE_dll_characteristics(executable)\n     return (bits & IMAGE_DLL_CHARACTERISTICS_NX_COMPAT) == IMAGE_DLL_CHARACTERISTICS_NX_COMPAT\n \n-def get_MACHO_executable_flags(executable) -> List[str]:\n-    stdout = run_command([OTOOL_CMD, '-vh', executable])\n-\n-    flags: List[str] = []\n-    for line in stdout.splitlines():\n-        tokens = line.split()\n-        # filter first two header lines\n-        if 'magic' in tokens or 'Mach' in tokens:\n-            continue\n-        # filter ncmds and sizeofcmds values\n-        flags += [t for t in tokens if not t.isdigit()]\n-    return flags\n-\n def check_MACHO_PIE(executable) -> bool:\n     '''\n     Check for position independent executable (PIE), allowing for address space randomization.\n     '''\n-    flags = get_MACHO_executable_flags(executable)\n-    if 'PIE' in flags:\n-        return True\n-    return False\n+    binary = lief.parse(executable)\n+    return binary.is_pie\n \n def check_MACHO_NOUNDEFS(executable) -> bool:\n     '''\n     Check for no undefined references.\n     '''\n-    flags = get_MACHO_executable_flags(executable)\n-    if 'NOUNDEFS' in flags:\n-        return True\n-    return False\n+    binary = lief.parse(executable)\n+    return binary.header.has(lief.MachO.HEADER_FLAGS.NOUNDEFS)\n \n def check_MACHO_NX(executable) -> bool:\n     '''\n     Check for no stack execution\n     '''\n-    flags = get_MACHO_executable_flags(executable)\n-    if 'ALLOW_STACK_EXECUTION' in flags:\n-        return False\n-    return True\n+    binary = lief.parse(executable)\n+    return binary.has_nx\n \n def check_MACHO_LAZY_BINDINGS(executable) -> bool:\n     '''\n     Check for no lazy bindings.\n     We don't use or check for MH_BINDATLOAD. See #18295.\n     '''\n-    stdout = run_command([OTOOL_CMD, '-l', executable])\n-\n-    for line in stdout.splitlines():\n-        tokens = line.split()\n-        if 'lazy_bind_off' in tokens or 'lazy_bind_size' in tokens:\n-            if tokens[1] != '0':\n-                return False\n-    return True\n+    binary = lief.parse(executable)\n+    return binary.dyld_info.lazy_bind == (0,0)\n \n def check_MACHO_Canary(executable) -> bool:\n     '''\n     Check for use of stack canary\n     '''\n-    stdout = run_command([OTOOL_CMD, '-Iv', executable])\n-\n-    ok = False\n-    for line in stdout.splitlines():\n-        if '___stack_chk_fail' in line:\n-            ok = True\n-    return ok\n+    binary = lief.parse(executable)\n+    return binary.has_symbol('___stack_chk_fail')\n \n CHECKS = {\n 'ELF': ["
      }
    ]
  },
  {
    "sha": "8e1f40dd9a5135dbdec2c25961fbd0729a42254c",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4ZTFmNDBkZDlhNTEzNWRiZGVjMmMyNTk2MWZiZDA3MjlhNDIyNTRj",
    "commit": {
      "author": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-04-06T02:03:03Z"
      },
      "committer": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-05-04T12:47:59Z"
      },
      "message": "contrib: use LIEF for PE security checks",
      "tree": {
        "sha": "f7e684d2695ca4eb3909486b0a8886660163659d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f7e684d2695ca4eb3909486b0a8886660163659d"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8e1f40dd9a5135dbdec2c25961fbd0729a42254c",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz7FuIclQ9n+pXlWPLuufXMCVJsEFAmCRQn8ACgkQLuufXMCV\nJsEbrw/5AdV1kWctLOSYiq+bK9h9JL7LdEMbSWd5JYpcinI2aoYF26URDuwZB6LD\nDU4Y6YLko77fx2eHYIXDvr3vTPbFJ/gNi46jJ9sO1wl50EMCcyq7EMgphU9OWwY/\nNHcsdDEfLQhHOZRgif6UIq5Ex+kWn3L9fZ0NlhRTe1dcqWMLOPk4SXycp4ahviu8\n3Z+6bY/FfiHeqqqEfrLAt1qQ5VPlqy6WlHloTf6/p9iBGFJaw8kAQ3aMjM6EQ3Nd\nku0l/MIE5Jp1LOJIkVYFMAOnBV++zpjtdE2X/GoQzfI/3CHDC2oQVaalE5Fj1Q6c\nC37XLGrSXEVw7JVyy17bjzDFLbmzquXqbmdUOSpwoF/86As/FJUNx7ACL9qF6CSv\nvutf9q5NqSuQUvYUr+LeJKgpL05x1Qzvqk2BsHKZyGKQcUYQrFHU8cBlXHF78y5q\nOpKunQXfTX0MrKZsiPiD79T6DRcHX3AmAALgPMHy6o1DX88PuddT1yZ8JcjpcuXF\nOhYsVgLIBDdrHaqqY3WFf41Z7l73LuE1Xm092JklFz+9DQqC/IHyGioyYpiaVPbr\nHGWhRyu8FC+tmONnYIQ2ic2WSgVOIEJq0Gl9GNjAt9GCsW76bnDeoanuCExDxJv4\nPgayMbtjIRYyh/fFKLmgl3goQTfJxkWK+3L51CkMvxmdbMi9FC8=\n=p9nY\n-----END PGP SIGNATURE-----",
        "payload": "tree f7e684d2695ca4eb3909486b0a8886660163659d\nparent a25b2e965c93fe2a46a2f8f1e7bdf5642d453511\nauthor fanquake <fanquake@gmail.com> 1617674583 +0800\ncommitter fanquake <fanquake@gmail.com> 1620132479 +0800\n\ncontrib: use LIEF for PE security checks\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/8e1f40dd9a5135dbdec2c25961fbd0729a42254c",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/8e1f40dd9a5135dbdec2c25961fbd0729a42254c",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/8e1f40dd9a5135dbdec2c25961fbd0729a42254c/comments",
    "author": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "a25b2e965c93fe2a46a2f8f1e7bdf5642d453511",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a25b2e965c93fe2a46a2f8f1e7bdf5642d453511",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/a25b2e965c93fe2a46a2f8f1e7bdf5642d453511"
      }
    ],
    "stats": {
      "total": 44,
      "additions": 8,
      "deletions": 36
    },
    "files": [
      {
        "sha": "2c44d67d3304eddf5289fa3c7f46e84dc358318c",
        "filename": "contrib/devtools/security-check.py",
        "status": "modified",
        "additions": 8,
        "deletions": 36,
        "changes": 44,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/8e1f40dd9a5135dbdec2c25961fbd0729a42254c/contrib/devtools/security-check.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/8e1f40dd9a5135dbdec2c25961fbd0729a42254c/contrib/devtools/security-check.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/devtools/security-check.py?ref=8e1f40dd9a5135dbdec2c25961fbd0729a42254c",
        "patch": "@@ -6,22 +6,13 @@\n Perform basic security checks on a series of executables.\n Exit status will be 0 if successful, and the program will be silent.\n Otherwise the exit status will be 1 and it will log which executables failed which checks.\n-Needs `objdump` (for PE).\n '''\n-import subprocess\n import sys\n-import os\n from typing import List, Optional\n \n import lief\n import pixie\n \n-OBJDUMP_CMD = os.getenv('OBJDUMP', '/usr/bin/objdump')\n-\n-def run_command(command) -> str:\n-    p = subprocess.run(command, stdout=subprocess.PIPE, check=True, universal_newlines=True)\n-    return p.stdout\n-\n def check_ELF_PIE(executable) -> bool:\n     '''\n     Check for position independent executable (PIE), allowing for address space randomization.\n@@ -143,46 +134,27 @@ def check_ELF_separate_code(executable):\n                 return False\n     return True\n \n-def get_PE_dll_characteristics(executable) -> int:\n-    '''Get PE DllCharacteristics bits'''\n-    stdout = run_command([OBJDUMP_CMD, '-x',  executable])\n-\n-    bits = 0\n-    for line in stdout.splitlines():\n-        tokens = line.split()\n-        if len(tokens)>=2 and tokens[0] == 'DllCharacteristics':\n-            bits = int(tokens[1],16)\n-    return bits\n-\n-IMAGE_DLL_CHARACTERISTICS_HIGH_ENTROPY_VA = 0x0020\n-IMAGE_DLL_CHARACTERISTICS_DYNAMIC_BASE    = 0x0040\n-IMAGE_DLL_CHARACTERISTICS_NX_COMPAT       = 0x0100\n-\n def check_PE_DYNAMIC_BASE(executable) -> bool:\n     '''PIE: DllCharacteristics bit 0x40 signifies dynamicbase (ASLR)'''\n-    bits = get_PE_dll_characteristics(executable)\n-    return (bits & IMAGE_DLL_CHARACTERISTICS_DYNAMIC_BASE) == IMAGE_DLL_CHARACTERISTICS_DYNAMIC_BASE\n+    binary = lief.parse(executable)\n+    return lief.PE.DLL_CHARACTERISTICS.DYNAMIC_BASE in binary.optional_header.dll_characteristics_lists\n \n # Must support high-entropy 64-bit address space layout randomization\n # in addition to DYNAMIC_BASE to have secure ASLR.\n def check_PE_HIGH_ENTROPY_VA(executable) -> bool:\n     '''PIE: DllCharacteristics bit 0x20 signifies high-entropy ASLR'''\n-    bits = get_PE_dll_characteristics(executable)\n-    return (bits & IMAGE_DLL_CHARACTERISTICS_HIGH_ENTROPY_VA) == IMAGE_DLL_CHARACTERISTICS_HIGH_ENTROPY_VA\n+    binary = lief.parse(executable)\n+    return lief.PE.DLL_CHARACTERISTICS.HIGH_ENTROPY_VA in binary.optional_header.dll_characteristics_lists\n \n def check_PE_RELOC_SECTION(executable) -> bool:\n     '''Check for a reloc section. This is required for functional ASLR.'''\n-    stdout = run_command([OBJDUMP_CMD, '-h',  executable])\n-\n-    for line in stdout.splitlines():\n-        if '.reloc' in line:\n-            return True\n-    return False\n+    binary = lief.parse(executable)\n+    return binary.has_relocations\n \n def check_PE_NX(executable) -> bool:\n     '''NX: DllCharacteristics bit 0x100 signifies nxcompat (DEP)'''\n-    bits = get_PE_dll_characteristics(executable)\n-    return (bits & IMAGE_DLL_CHARACTERISTICS_NX_COMPAT) == IMAGE_DLL_CHARACTERISTICS_NX_COMPAT\n+    binary = lief.parse(executable)\n+    return binary.has_nx\n \n def check_MACHO_PIE(executable) -> bool:\n     '''"
      }
    ]
  },
  {
    "sha": "0f5d77c8e4db691733edb455dd9e31dabe933b8d",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzowZjVkNzdjOGU0ZGI2OTE3MzNlZGI0NTVkZDllMzFkYWJlOTMzYjhk",
    "commit": {
      "author": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-04-06T02:13:06Z"
      },
      "committer": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-05-04T12:48:00Z"
      },
      "message": "contrib: add PE PIE check to security checks",
      "tree": {
        "sha": "6b8f817a1690eb7413b9282a6d004ccfe1749579",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6b8f817a1690eb7413b9282a6d004ccfe1749579"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0f5d77c8e4db691733edb455dd9e31dabe933b8d",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz7FuIclQ9n+pXlWPLuufXMCVJsEFAmCRQoAACgkQLuufXMCV\nJsFZAQ/+KhBfq6c+WNmdKLd0G3+KMxHsiaiPH2AZ3d2a5VF0ZpyX6xSi4FHhcv5e\nFzL3Z9IBZnC01HgWYwq9AO0lf7DqpTDH14u8AGJEE6eGCGWIzQByF8yz0xJr9EJG\nBN2pS3L23bba3vWalxLIcBSuNh64CPWoRUmggJAm9GkGdh4xnQBmIQmY7Cl+KP6Z\nO1jdvuNkM/22lgKK/gvA3Glwu7ag/7c6ib+nM2cC8aYft6x1B2RcMdzV32PpikE/\n3v1/fcXgPdYoBQlR+zSxAPGCyNT+CjbTvvrILgIK2V7K8tAt5y8HcfXTsLCir9bW\nxVOweUZ3ohvWyHXtN2qX/NEZvyLoZeg1M5Xp1s7mDo4xtfS3aGjFZQrR4sVAnwLq\nuEh0ytM7EY3Wh7xz05MsC/RqEPgQxXWR/kPKYKKwPjWIUX2je4UVhaVCbGNd1reZ\nwgMfVrUF2VC9q5Vir9gVC7LHpEFWkn+I8K5vo59xUrMiDbDlwsRl6z1r93W7O1yI\nj3TaekHfNryeLkv9qLTZ9BKFFkZ2SaWZQG89rJchDP7tdeABnh3nzbHywFiLQubB\nnSGR+qoI8HqT7qSC23hIVdVl5fuvRImgT8812syPO8ZzZ/NQc88YvEGV5MudWgN4\nFy526Zf1yJ5RPl6HqNX44pHArLOVq5bh0sNm+ELAYJuFF2Ho6Qs=\n=sTkv\n-----END PGP SIGNATURE-----",
        "payload": "tree 6b8f817a1690eb7413b9282a6d004ccfe1749579\nparent 8e1f40dd9a5135dbdec2c25961fbd0729a42254c\nauthor fanquake <fanquake@gmail.com> 1617675186 +0800\ncommitter fanquake <fanquake@gmail.com> 1620132480 +0800\n\ncontrib: add PE PIE check to security checks\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0f5d77c8e4db691733edb455dd9e31dabe933b8d",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/0f5d77c8e4db691733edb455dd9e31dabe933b8d",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0f5d77c8e4db691733edb455dd9e31dabe933b8d/comments",
    "author": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "8e1f40dd9a5135dbdec2c25961fbd0729a42254c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/8e1f40dd9a5135dbdec2c25961fbd0729a42254c",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/8e1f40dd9a5135dbdec2c25961fbd0729a42254c"
      }
    ],
    "stats": {
      "total": 9,
      "additions": 9,
      "deletions": 0
    },
    "files": [
      {
        "sha": "4f4c9565fa7829a9e6db53a8aa3c5f726e312fe1",
        "filename": "contrib/devtools/security-check.py",
        "status": "modified",
        "additions": 9,
        "deletions": 0,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/0f5d77c8e4db691733edb455dd9e31dabe933b8d/contrib/devtools/security-check.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/0f5d77c8e4db691733edb455dd9e31dabe933b8d/contrib/devtools/security-check.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/devtools/security-check.py?ref=0f5d77c8e4db691733edb455dd9e31dabe933b8d",
        "patch": "@@ -134,6 +134,14 @@ def check_ELF_separate_code(executable):\n                 return False\n     return True\n \n+def check_PE_PIE(executable) -> bool:\n+    '''\n+    Check for position independent executable (PIE),\n+    allowing for address space randomization.\n+    '''\n+    binary = lief.parse(executable)\n+    return binary.is_pie\n+\n def check_PE_DYNAMIC_BASE(executable) -> bool:\n     '''PIE: DllCharacteristics bit 0x40 signifies dynamicbase (ASLR)'''\n     binary = lief.parse(executable)\n@@ -201,6 +209,7 @@ def check_MACHO_Canary(executable) -> bool:\n     ('separate_code', check_ELF_separate_code),\n ],\n 'PE': [\n+    ('PIE', check_PE_PIE),\n     ('DYNAMIC_BASE', check_PE_DYNAMIC_BASE),\n     ('HIGH_ENTROPY_VA', check_PE_HIGH_ENTROPY_VA),\n     ('NX', check_PE_NX),"
      }
    ]
  },
  {
    "sha": "a632cbcee5ae982f50aba625713b7686aef29168",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphNjMyY2JjZWU1YWU5ODJmNTBhYmE2MjU3MTNiNzY4NmFlZjI5MTY4",
    "commit": {
      "author": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-04-07T01:41:43Z"
      },
      "committer": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-05-04T12:48:00Z"
      },
      "message": "contrib: use f strings in symbol-check.py",
      "tree": {
        "sha": "dfaca08064efa5109c30df3d094262f85229d372",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/dfaca08064efa5109c30df3d094262f85229d372"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a632cbcee5ae982f50aba625713b7686aef29168",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz7FuIclQ9n+pXlWPLuufXMCVJsEFAmCRQoAACgkQLuufXMCV\nJsGOiA/8Ckqv7dvm6Stnyxkr1yz7pbsgqXS8om5+1eaWZ0E98Ftp2mX9KqnKHWVx\nRKLFhJbEaw35srqzB3uPdqXZXLly6CVytJTWHRSkfjtPMqh8FNOopC79kOpgF8/+\n0BxTzqI70mZu3lfr00tXnoMzu+UzLrT5e2MjsSJ/2Q3tn9V8ZOTe2NGUx1c1jKr8\nxfhkyMqZzemM0+xo7gztkxwdcGGPjQOiC26Q2FMvxuUbammtXeT0o2tK3ue4WPyy\nGvy94HOiQoVorOcKw8AluzxByHCrZf0PgowdMbkTvYDHkGDkrtCRn8tOnXBBPepv\nNIzWT2wkTaqHsC866371XFzCK7DHOnogA0x7V4mTGfyLPaeECn5125aVFEg6x0bs\n6b0C34Ft6iJj8/sawRgS6oygJOKBUAi0XHKk7RT4PeEWPiQfd7WoZMHOsqKPFb7a\nwN5Sne+NZrwi4wp6eI4Cnx+EN0gharHL8Gie6Vb9cAdEYis1bWoiiic78NbjDOYj\nq6CHm8xvcZc494H90XuOd+/Dy7lzpMgQWvsyjki88YA+Gty1WYCY6n/BxyiEpA1V\n3fUjZ4LFraQYFnTz6K7ylLdkdQcsTBAryA+fU+JSyngNJ8Ko6hTTeJFXwBWnW6CU\nG60WcIGugMAFYgDdbzXG7N2qrLDt/uEhr8wox9gj2kqZoBLVEps=\n=xLVa\n-----END PGP SIGNATURE-----",
        "payload": "tree dfaca08064efa5109c30df3d094262f85229d372\nparent 0f5d77c8e4db691733edb455dd9e31dabe933b8d\nauthor fanquake <fanquake@gmail.com> 1617759703 +0800\ncommitter fanquake <fanquake@gmail.com> 1620132480 +0800\n\ncontrib: use f strings in symbol-check.py\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a632cbcee5ae982f50aba625713b7686aef29168",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/a632cbcee5ae982f50aba625713b7686aef29168",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a632cbcee5ae982f50aba625713b7686aef29168/comments",
    "author": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "0f5d77c8e4db691733edb455dd9e31dabe933b8d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0f5d77c8e4db691733edb455dd9e31dabe933b8d",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/0f5d77c8e4db691733edb455dd9e31dabe933b8d"
      }
    ],
    "stats": {
      "total": 6,
      "additions": 3,
      "deletions": 3
    },
    "files": [
      {
        "sha": "19eb4eaf9fb8e988a8efdb3bbb953197331edd2d",
        "filename": "contrib/devtools/symbol-check.py",
        "status": "modified",
        "additions": 3,
        "deletions": 3,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a632cbcee5ae982f50aba625713b7686aef29168/contrib/devtools/symbol-check.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a632cbcee5ae982f50aba625713b7686aef29168/contrib/devtools/symbol-check.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/devtools/symbol-check.py?ref=a632cbcee5ae982f50aba625713b7686aef29168",
        "patch": "@@ -275,7 +275,7 @@ def identify_executable(executable) -> Optional[str]:\n         try:\n             etype = identify_executable(filename)\n             if etype is None:\n-                print('{}: unknown format'.format(filename))\n+                print(f'{filename}: unknown format')\n                 retval = 1\n                 continue\n \n@@ -284,9 +284,9 @@ def identify_executable(executable) -> Optional[str]:\n                 if not func(filename):\n                     failed.append(name)\n             if failed:\n-                print('{}: failed {}'.format(filename, ' '.join(failed)))\n+                print(f'{filename}: failed {\" \".join(failed)}')\n                 retval = 1\n         except IOError:\n-            print('{}: cannot open'.format(filename))\n+            print(f'{filename}: cannot open')\n             retval = 1\n     sys.exit(retval)"
      }
    ]
  },
  {
    "sha": "e93ac26b8563576345c13e83c777dd39e7616b1e",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplOTNhYzI2Yjg1NjM1NzYzNDVjMTNlODNjNzc3ZGQzOWU3NjE2YjFl",
    "commit": {
      "author": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-04-07T01:42:08Z"
      },
      "committer": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-05-04T12:48:00Z"
      },
      "message": "contrib: use LIEF in macOS symbol checks",
      "tree": {
        "sha": "d3c58394ecaee335d8e7edaf1c4091383eb031d7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d3c58394ecaee335d8e7edaf1c4091383eb031d7"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e93ac26b8563576345c13e83c777dd39e7616b1e",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz7FuIclQ9n+pXlWPLuufXMCVJsEFAmCRQoAACgkQLuufXMCV\nJsGFAg/9E0f9fN/2lecXaJRv8F8OKdDUO6oYvPEicFDfLKKkdStVVoZ9vxepDKss\n9Z3lbP4GXh8iLwUv4m3bin7q3eg5ImNJ/kb9ta2GpGsahQDAG63ES06KeT4+ndgX\npiQ5d9Ivnbfpbfg0x3NhdBT6JO5bBULiXN4khI+/77vUwWgNh/7SBvCm05IZ86yB\nEvq9b/d+ZckuqfQmrm1eWfJYBQdSObtRMoxMKc5K/FNmK/TnNoemsgJwAFyLc98U\njstA5ofXYxRDt8B4rJrVALFUFv5X/i9/q+rO9exkHHFZwWB5u0zFVD4592Ku3sYk\n+0fKhu5twYSsPZro9z7bKxKd9xEmoWdXNc/v4tLELoyOlgmTjddl2e6ZGhUscuoS\nXgJ5IYqt9X7CZZfchnXpK6lsSl4sBik8MokmHEp0TahbPPuuouLxjLJ06EKFbGO7\n226LthIwGRO6NJ55EUoHxpB7LxmZeSM61HMDYnAD2IzeIshpQW9jT0VI39RlxvFY\nRHo3PYM8VbqwX8CFfdcBVwsjdzRtlamVhgLdqrwhO5mO5IXw1+nMCDXQUOShIQnI\npf3lpGlUcHEdNvvYDGA+qsO8t3dBgLQlDi56YoVZpmM5uiSL7hhBpfkiioqvT3pD\nMR+a4NkeX1yfcHRlevQngpxMd8vA3opzm6WzghBbckx0takiFgU=\n=/6RF\n-----END PGP SIGNATURE-----",
        "payload": "tree d3c58394ecaee335d8e7edaf1c4091383eb031d7\nparent a632cbcee5ae982f50aba625713b7686aef29168\nauthor fanquake <fanquake@gmail.com> 1617759728 +0800\ncommitter fanquake <fanquake@gmail.com> 1620132480 +0800\n\ncontrib: use LIEF in macOS symbol checks\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e93ac26b8563576345c13e83c777dd39e7616b1e",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/e93ac26b8563576345c13e83c777dd39e7616b1e",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e93ac26b8563576345c13e83c777dd39e7616b1e/comments",
    "author": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "a632cbcee5ae982f50aba625713b7686aef29168",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a632cbcee5ae982f50aba625713b7686aef29168",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/a632cbcee5ae982f50aba625713b7686aef29168"
      }
    ],
    "stats": {
      "total": 23,
      "additions": 6,
      "deletions": 17
    },
    "files": [
      {
        "sha": "a4ada7357378bc6d5a05cb825c8bff3269bb3977",
        "filename": "contrib/devtools/symbol-check.py",
        "status": "modified",
        "additions": 6,
        "deletions": 17,
        "changes": 23,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e93ac26b8563576345c13e83c777dd39e7616b1e/contrib/devtools/symbol-check.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e93ac26b8563576345c13e83c777dd39e7616b1e/contrib/devtools/symbol-check.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/devtools/symbol-check.py?ref=e93ac26b8563576345c13e83c777dd39e7616b1e",
        "patch": "@@ -15,6 +15,7 @@\n import os\n from typing import List, Optional\n \n+import lief\n import pixie\n \n # Debian 8 (Jessie) EOL: 2020. https://wiki.debian.org/DebianReleases#Production_Releases\n@@ -53,7 +54,6 @@\n }\n CPPFILT_CMD = os.getenv('CPPFILT', '/usr/bin/c++filt')\n OBJDUMP_CMD = os.getenv('OBJDUMP', '/usr/bin/objdump')\n-OTOOL_CMD = os.getenv('OTOOL', '/usr/bin/otool')\n \n # Allowed NEEDED libraries\n ELF_ALLOWED_LIBRARIES = {\n@@ -203,24 +203,13 @@ def check_ELF_libraries(filename) -> bool:\n             ok = False\n     return ok\n \n-def macho_read_libraries(filename) -> List[str]:\n-    p = subprocess.Popen([OTOOL_CMD, '-L', filename], stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE, universal_newlines=True)\n-    (stdout, stderr) = p.communicate()\n-    if p.returncode:\n-        raise IOError('Error opening file')\n-    libraries = []\n-    for line in stdout.splitlines():\n-        tokens = line.split()\n-        if len(tokens) == 1: # skip executable name\n-            continue\n-        libraries.append(tokens[0].split('/')[-1])\n-    return libraries\n-\n def check_MACHO_libraries(filename) -> bool:\n     ok: bool = True\n-    for dylib in macho_read_libraries(filename):\n-        if dylib not in MACHO_ALLOWED_LIBRARIES:\n-            print('{} is not in ALLOWED_LIBRARIES!'.format(dylib))\n+    binary = lief.parse(filename)\n+    for dylib in binary.libraries:\n+        split = dylib.name.split('/')\n+        if split[-1] not in MACHO_ALLOWED_LIBRARIES:\n+            print(f'{split[-1]} is not in ALLOWED_LIBRARIES!')\n             ok = False\n     return ok\n "
      }
    ]
  },
  {
    "sha": "2aa1631822b2fdbc6cf7a3dcd99adaf4d2745ed4",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyYWExNjMxODIyYjJmZGJjNmNmN2EzZGNkOTlhZGFmNGQyNzQ1ZWQ0",
    "commit": {
      "author": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-04-06T02:18:07Z"
      },
      "committer": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-05-04T12:48:00Z"
      },
      "message": "contrib: use LIEF in PE symbol checks",
      "tree": {
        "sha": "353fd92fd7edb8a5d2a19751014be5aa98438e5e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/353fd92fd7edb8a5d2a19751014be5aa98438e5e"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2aa1631822b2fdbc6cf7a3dcd99adaf4d2745ed4",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz7FuIclQ9n+pXlWPLuufXMCVJsEFAmCRQoAACgkQLuufXMCV\nJsHLvw/8DDtTwqTf3qyjGq1+FQEr6Ffk2ADtpmyVR0T9mM7HejgBJ6pf3Q48XqO/\nC79CmNiQ+q7p7btrE3HaahCPQSK1VVEbe5Z9W2UzGdsG72kM9bR6xPXYn+yW4sY/\nbDJ6nmpRT9Ir8qfnPO8Y1X80vrUkPRI8Zjk/HY5yT9ijga/+rabgmqeqGX/2v9Z7\nqoDjI82HX6kIF3azeydbDgtPwytPKt0Tx9R9SoKtuC7/TB9QziBs2BMmqx9u9OZ5\n8d+4rylb5pZJyeBV+jRL1lOLmSyElhIJuH+NxAyQ2mwr8ObHQ9b1852UkAw0i6nV\nJFuuRms7czXPGwZPacynA8wIgBJnny53YU3zOHLSa3MsHdRF1ddZOusfoWJrepkU\nrDSOXW4qCRHabbioVhHIqO+3htX9smVnQ515Gi17vpn8APKoIyj4z3CtCRXzFYen\nc+1Kp2biiYD/4pzlTvLsdxtUYif9+VNR7n6vBwlhGd8xQcc+qpsC+IXmgXEeiILi\nkndcVo9nZRlEsXji5XQDwhoAaqlJxT1JoieltYgx2lIJ/LC2knTBev+MwY28heIJ\nN4vsLRe4oFxrculZl5+cVULNvPx8YnQc/yAbNMjNGenftpik90KrSSycWRqSGL9l\nrhzTW/JJNgGiFu70v7EYOWcrjxoGDcg52mMzO3xA471KuBMES9A=\n=3Jtp\n-----END PGP SIGNATURE-----",
        "payload": "tree 353fd92fd7edb8a5d2a19751014be5aa98438e5e\nparent e93ac26b8563576345c13e83c777dd39e7616b1e\nauthor fanquake <fanquake@gmail.com> 1617675487 +0800\ncommitter fanquake <fanquake@gmail.com> 1620132480 +0800\n\ncontrib: use LIEF in PE symbol checks\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2aa1631822b2fdbc6cf7a3dcd99adaf4d2745ed4",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/2aa1631822b2fdbc6cf7a3dcd99adaf4d2745ed4",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2aa1631822b2fdbc6cf7a3dcd99adaf4d2745ed4/comments",
    "author": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "e93ac26b8563576345c13e83c777dd39e7616b1e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e93ac26b8563576345c13e83c777dd39e7616b1e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/e93ac26b8563576345c13e83c777dd39e7616b1e"
      }
    ],
    "stats": {
      "total": 18,
      "additions": 3,
      "deletions": 15
    },
    "files": [
      {
        "sha": "d740a945607bd3b009d6fb9ffc605bbb57a5f8e5",
        "filename": "contrib/devtools/symbol-check.py",
        "status": "modified",
        "additions": 3,
        "deletions": 15,
        "changes": 18,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/2aa1631822b2fdbc6cf7a3dcd99adaf4d2745ed4/contrib/devtools/symbol-check.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/2aa1631822b2fdbc6cf7a3dcd99adaf4d2745ed4/contrib/devtools/symbol-check.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/devtools/symbol-check.py?ref=2aa1631822b2fdbc6cf7a3dcd99adaf4d2745ed4",
        "patch": "@@ -53,7 +53,6 @@\n 'environ', '_environ', '__environ',\n }\n CPPFILT_CMD = os.getenv('CPPFILT', '/usr/bin/c++filt')\n-OBJDUMP_CMD = os.getenv('OBJDUMP', '/usr/bin/objdump')\n \n # Allowed NEEDED libraries\n ELF_ALLOWED_LIBRARIES = {\n@@ -213,23 +212,12 @@ def check_MACHO_libraries(filename) -> bool:\n             ok = False\n     return ok\n \n-def pe_read_libraries(filename) -> List[str]:\n-    p = subprocess.Popen([OBJDUMP_CMD, '-x', filename], stdout=subprocess.PIPE, stderr=subprocess.PIPE, stdin=subprocess.PIPE, universal_newlines=True)\n-    (stdout, stderr) = p.communicate()\n-    if p.returncode:\n-        raise IOError('Error opening file')\n-    libraries = []\n-    for line in stdout.splitlines():\n-        if 'DLL Name:' in line:\n-            tokens = line.split(': ')\n-            libraries.append(tokens[1])\n-    return libraries\n-\n def check_PE_libraries(filename) -> bool:\n     ok: bool = True\n-    for dylib in pe_read_libraries(filename):\n+    binary = lief.parse(filename)\n+    for dylib in binary.libraries:\n         if dylib not in PE_ALLOWED_LIBRARIES:\n-            print('{} is not in ALLOWED_LIBRARIES!'.format(dylib))\n+            print(f'{dylib} is not in ALLOWED_LIBRARIES!')\n             ok = False\n     return ok\n "
      }
    ]
  },
  {
    "sha": "955140b3265d3bcb9504c61d73fbfdadfff8a2b2",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo5NTUxNDBiMzI2NWQzYmNiOTUwNGM2MWQ3M2ZiZmRhZGZmZjhhMmIy",
    "commit": {
      "author": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-04-12T03:19:44Z"
      },
      "committer": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-05-04T12:48:00Z"
      },
      "message": "contrib: consolidate PIE and NX security checks",
      "tree": {
        "sha": "1798404897e6a7548a5a570f19e229f89a957d9d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1798404897e6a7548a5a570f19e229f89a957d9d"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/955140b3265d3bcb9504c61d73fbfdadfff8a2b2",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz7FuIclQ9n+pXlWPLuufXMCVJsEFAmCRQoAACgkQLuufXMCV\nJsGAdA/8D/nTcqpFUaoNj21yxNW1WydAxfYAADBiyCdG9A0aKTtjQFqFbHe3akdW\nKTqdg9UUNZLAIQiGpRkbJ40s6Of5qPW5y85KmbKL+3imf+LNniyPw5SsCbxPbpdk\nBELtGyhvz6hxc+fLsswM5Yg2KCafUsD0WZIXKSFG/nbPKKNlH9YKJUX1RC1AjPqj\nuMGKeeH9lKGSLC6ryOWdHxRCvY7WKVi1s0Ljm7lSCunzGx2Riwy8JSx36X3QOZgO\nLhRxZ2cu32WyGTo/lFxYdA4T5UiuWKsWdxzWZJ8oW4ewCUwThfxNiuW+OMqNEXjX\n8X+dPCUrf+zu2ovAQokcr7mwUTE5yxJOiAVxi1KmNBS6ZtLFTILLF0Lo3l4tdatH\nBD9VERLeAUPaZhAw1ZOr0HcIuV1g7kEvGnabWP6H2qyyXpH7ShHsSq7hfa2Kg6hs\n1+j7mYUKOCmgAID1sKahL3SB4xRh6zMinj3Kym5BtlTfBuUEyAEYIknd3Qjw8l83\ns42alou+5+s0PlrAyCtABf1v66ak3a5Z2BnSsOv+8R/iMhBJWVRDu7Ia67YcedlO\ntEp/p1yhiaRHfCkwaeps3PnCfnh/M2ZagNOGCeMEgdsQx4c+5vn2KsCebGKLs/Hd\nYqx/STdqISJY3j7Lk0jig9IWfJ415kd6lkyeIMhQVUT2w5am7r0=\n=LvaW\n-----END PGP SIGNATURE-----",
        "payload": "tree 1798404897e6a7548a5a570f19e229f89a957d9d\nparent 2aa1631822b2fdbc6cf7a3dcd99adaf4d2745ed4\nauthor fanquake <fanquake@gmail.com> 1618197584 +0800\ncommitter fanquake <fanquake@gmail.com> 1620132480 +0800\n\ncontrib: consolidate PIE and NX security checks\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/955140b3265d3bcb9504c61d73fbfdadfff8a2b2",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/955140b3265d3bcb9504c61d73fbfdadfff8a2b2",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/955140b3265d3bcb9504c61d73fbfdadfff8a2b2/comments",
    "author": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "2aa1631822b2fdbc6cf7a3dcd99adaf4d2745ed4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2aa1631822b2fdbc6cf7a3dcd99adaf4d2745ed4",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/2aa1631822b2fdbc6cf7a3dcd99adaf4d2745ed4"
      }
    ],
    "stats": {
      "total": 50,
      "additions": 19,
      "deletions": 31
    },
    "files": [
      {
        "sha": "b6628c2ad5c95a3ef9c31b75dda8a7d69fb29094",
        "filename": "contrib/devtools/security-check.py",
        "status": "modified",
        "additions": 19,
        "deletions": 31,
        "changes": 50,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/955140b3265d3bcb9504c61d73fbfdadfff8a2b2/contrib/devtools/security-check.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/955140b3265d3bcb9504c61d73fbfdadfff8a2b2/contrib/devtools/security-check.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/devtools/security-check.py?ref=955140b3265d3bcb9504c61d73fbfdadfff8a2b2",
        "patch": "@@ -134,14 +134,6 @@ def check_ELF_separate_code(executable):\n                 return False\n     return True\n \n-def check_PE_PIE(executable) -> bool:\n-    '''\n-    Check for position independent executable (PIE),\n-    allowing for address space randomization.\n-    '''\n-    binary = lief.parse(executable)\n-    return binary.is_pie\n-\n def check_PE_DYNAMIC_BASE(executable) -> bool:\n     '''PIE: DllCharacteristics bit 0x40 signifies dynamicbase (ASLR)'''\n     binary = lief.parse(executable)\n@@ -159,32 +151,13 @@ def check_PE_RELOC_SECTION(executable) -> bool:\n     binary = lief.parse(executable)\n     return binary.has_relocations\n \n-def check_PE_NX(executable) -> bool:\n-    '''NX: DllCharacteristics bit 0x100 signifies nxcompat (DEP)'''\n-    binary = lief.parse(executable)\n-    return binary.has_nx\n-\n-def check_MACHO_PIE(executable) -> bool:\n-    '''\n-    Check for position independent executable (PIE), allowing for address space randomization.\n-    '''\n-    binary = lief.parse(executable)\n-    return binary.is_pie\n-\n def check_MACHO_NOUNDEFS(executable) -> bool:\n     '''\n     Check for no undefined references.\n     '''\n     binary = lief.parse(executable)\n     return binary.header.has(lief.MachO.HEADER_FLAGS.NOUNDEFS)\n \n-def check_MACHO_NX(executable) -> bool:\n-    '''\n-    Check for no stack execution\n-    '''\n-    binary = lief.parse(executable)\n-    return binary.has_nx\n-\n def check_MACHO_LAZY_BINDINGS(executable) -> bool:\n     '''\n     Check for no lazy bindings.\n@@ -200,6 +173,21 @@ def check_MACHO_Canary(executable) -> bool:\n     binary = lief.parse(executable)\n     return binary.has_symbol('___stack_chk_fail')\n \n+def check_PIE(executable) -> bool:\n+    '''\n+    Check for position independent executable (PIE),\n+    allowing for address space randomization.\n+    '''\n+    binary = lief.parse(executable)\n+    return binary.is_pie\n+\n+def check_NX(executable) -> bool:\n+    '''\n+    Check for no stack execution\n+    '''\n+    binary = lief.parse(executable)\n+    return binary.has_nx\n+\n CHECKS = {\n 'ELF': [\n     ('PIE', check_ELF_PIE),\n@@ -209,16 +197,16 @@ def check_MACHO_Canary(executable) -> bool:\n     ('separate_code', check_ELF_separate_code),\n ],\n 'PE': [\n-    ('PIE', check_PE_PIE),\n+    ('PIE', check_PIE),\n     ('DYNAMIC_BASE', check_PE_DYNAMIC_BASE),\n     ('HIGH_ENTROPY_VA', check_PE_HIGH_ENTROPY_VA),\n-    ('NX', check_PE_NX),\n+    ('NX', check_NX),\n     ('RELOC_SECTION', check_PE_RELOC_SECTION)\n ],\n 'MACHO': [\n-    ('PIE', check_MACHO_PIE),\n+    ('PIE', check_PIE),\n     ('NOUNDEFS', check_MACHO_NOUNDEFS),\n-    ('NX', check_MACHO_NX),\n+    ('NX', check_NX),\n     ('LAZY_BINDINGS', check_MACHO_LAZY_BINDINGS),\n     ('Canary', check_MACHO_Canary)\n ]"
      }
    ]
  },
  {
    "sha": "7fc5e865b93af59364e9c8bf75ec68b4decc7e5d",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3ZmM1ZTg2NWI5M2FmNTkzNjRlOWM4YmY3NWVjNjhiNGRlY2M3ZTVk",
    "commit": {
      "author": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-04-13T04:40:15Z"
      },
      "committer": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-05-04T12:48:53Z"
      },
      "message": "test: install lief in CI",
      "tree": {
        "sha": "adbf8755365e5a1a53942a9a06d3ba5e88deac24",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/adbf8755365e5a1a53942a9a06d3ba5e88deac24"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7fc5e865b93af59364e9c8bf75ec68b4decc7e5d",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz7FuIclQ9n+pXlWPLuufXMCVJsEFAmCRQrgACgkQLuufXMCV\nJsHakhAAtMEWKxGwq6XwsmAJOfRRHYoP6zoqZiEgUGY2vIb4qQI4vFKYGQAoeaJE\neqySn5BXtWRfFYF6VhUag0IcFDInN3smSHYtzk2pbrsil+DRQeLEMM1mP+zSGNph\nq+urnaPTCozH2X+TPRSKfapYGO1MOjqPHr2+/Pmqi83h2y+ylvSvAL1FNieDxNim\nLVSROafeLdIfBjc+FcbuyPt29FpZzxre+AOemNVLpssK3EWp2zRaIMxnPCvaNS3i\nEcToMcEypSO60GFfDyJDiscVrWNXKUO2s0BVR3G6cYypA9fIw+3wTEC/K5z24zQ8\neWl69gjFRfAH0PHKzGLXYRF6Rzu1B4wHDdmJTUDXzlXw+OHvWcHj58r/U1H8IdVA\nUX0aZX+wR/6IWALNFXJ4rz2UBxDklL69qgVAjsiX4yplHtvRxYpiLwgwJXWOSkgb\nTZf+BCU3QZEm45ff0KjWB/761ST/+drqxiw8CChIcHjOSDZQQ5D7ZHRppDlW2Szz\nz9CSg7j56riDOV3Ss8vfbfhkH8fu8+RtDS/HSBcCqIpCK4mr0jeB8t/8VceLwy/O\nXf79F5Gl9UumyqeYcOa8fPALsUsi6rL9v+dIGnYVI3GdiIm4DWnLhP1fGY3u3Zkx\ntnlCJDLz0pHPFuuHuYk5c44Bqp0bUhgWmhjFvPj5vaq8rpfNWJ8=\n=a1fX\n-----END PGP SIGNATURE-----",
        "payload": "tree adbf8755365e5a1a53942a9a06d3ba5e88deac24\nparent 955140b3265d3bcb9504c61d73fbfdadfff8a2b2\nauthor fanquake <fanquake@gmail.com> 1618288815 +0800\ncommitter fanquake <fanquake@gmail.com> 1620132533 +0800\n\ntest: install lief in CI\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7fc5e865b93af59364e9c8bf75ec68b4decc7e5d",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/7fc5e865b93af59364e9c8bf75ec68b4decc7e5d",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7fc5e865b93af59364e9c8bf75ec68b4decc7e5d/comments",
    "author": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "955140b3265d3bcb9504c61d73fbfdadfff8a2b2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/955140b3265d3bcb9504c61d73fbfdadfff8a2b2",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/955140b3265d3bcb9504c61d73fbfdadfff8a2b2"
      }
    ],
    "stats": {
      "total": 9,
      "additions": 6,
      "deletions": 3
    },
    "files": [
      {
        "sha": "898c1530a178792d97f0cd5bd82cf597162066a9",
        "filename": "ci/test/00_setup_env_mac_host.sh",
        "status": "modified",
        "additions": 1,
        "deletions": 2,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7fc5e865b93af59364e9c8bf75ec68b4decc7e5d/ci/test/00_setup_env_mac_host.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7fc5e865b93af59364e9c8bf75ec68b4decc7e5d/ci/test/00_setup_env_mac_host.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/ci/test/00_setup_env_mac_host.sh?ref=7fc5e865b93af59364e9c8bf75ec68b4decc7e5d",
        "patch": "@@ -7,12 +7,11 @@\n export LC_ALL=C.UTF-8\n \n export HOST=x86_64-apple-darwin18\n-export PIP_PACKAGES=\"zmq\"\n+export PIP_PACKAGES=\"zmq lief\"\n export GOAL=\"install\"\n export BITCOIN_CONFIG=\"--with-gui --enable-reduce-exports --enable-external-signer\"\n export CI_OS_NAME=\"macos\"\n export NO_DEPENDS=1\n export OSX_SDK=\"\"\n export CCACHE_SIZE=300M\n-\n export RUN_SECURITY_TESTS=\"true\""
      },
      {
        "sha": "37d714400b75f68b50dd46904dd9992b9c885525",
        "filename": "ci/test/00_setup_env_native_multiprocess.sh",
        "status": "modified",
        "additions": 2,
        "deletions": 1,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7fc5e865b93af59364e9c8bf75ec68b4decc7e5d/ci/test/00_setup_env_native_multiprocess.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7fc5e865b93af59364e9c8bf75ec68b4decc7e5d/ci/test/00_setup_env_native_multiprocess.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/ci/test/00_setup_env_native_multiprocess.sh?ref=7fc5e865b93af59364e9c8bf75ec68b4decc7e5d",
        "patch": "@@ -8,9 +8,10 @@ export LC_ALL=C.UTF-8\n \n export CONTAINER_NAME=ci_native_multiprocess\n export DOCKER_NAME_TAG=ubuntu:20.04\n-export PACKAGES=\"cmake python3 llvm clang\"\n+export PACKAGES=\"cmake python3 python3-pip llvm clang\"\n export DEP_OPTS=\"DEBUG=1 MULTIPROCESS=1\"\n export GOAL=\"install\"\n export BITCOIN_CONFIG=\"--enable-external-signer --enable-debug CC=clang CXX=clang++\"  # Use clang to avoid OOM\n export TEST_RUNNER_ENV=\"BITCOIND=bitcoin-node\"\n export RUN_SECURITY_TESTS=\"true\"\n+export PIP_PACKAGES=\"lief\""
      },
      {
        "sha": "c3d83c84e3c344c226cc65e157dca1037a8e62da",
        "filename": "ci/test/04_install.sh",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7fc5e865b93af59364e9c8bf75ec68b4decc7e5d/ci/test/04_install.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7fc5e865b93af59364e9c8bf75ec68b4decc7e5d/ci/test/04_install.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/ci/test/04_install.sh?ref=7fc5e865b93af59364e9c8bf75ec68b4decc7e5d",
        "patch": "@@ -67,6 +67,9 @@ if [[ $DOCKER_NAME_TAG == centos* ]]; then\n elif [ \"$CI_USE_APT_INSTALL\" != \"no\" ]; then\n   ${CI_RETRY_EXE} DOCKER_EXEC apt-get update\n   ${CI_RETRY_EXE} DOCKER_EXEC apt-get install --no-install-recommends --no-upgrade -y $PACKAGES $DOCKER_PACKAGES\n+  if [ -n \"$PIP_PACKAGES\" ]; then\n+    ${CI_RETRY_EXE} pip3 install --user $PIP_PACKAGES\n+  fi\n fi\n \n if [ \"$CI_OS_NAME\" == \"macos\" ]; then"
      }
    ]
  }
]