[
  {
    "sha": "6f50dbd2fdeef7bc24317a487936502e25a05de9",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2ZjUwZGJkMmZkZWVmN2JjMjQzMTdhNDg3OTM2NTAyZTI1YTA1ZGU5",
    "commit": {
      "author": {
        "name": "Suhas Daftuar",
        "email": "sdaftuar@gmail.com",
        "date": "2015-02-09T20:28:35Z"
      },
      "committer": {
        "name": "Suhas Daftuar",
        "email": "sdaftuar@gmail.com",
        "date": "2015-02-10T18:23:57Z"
      },
      "message": "Fix NegateSignatureS to not duplicate last byte of S\n\nNegateSignatureS is called with a signature without a hashtype, so\ndo not save the last byte and append it after S negation.\n\nUpdates the two tests which were affected by this bug.",
      "tree": {
        "sha": "cffe21b53032fc9faa6f55b090cf2222c7a03857",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/cffe21b53032fc9faa6f55b090cf2222c7a03857"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6f50dbd2fdeef7bc24317a487936502e25a05de9",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6f50dbd2fdeef7bc24317a487936502e25a05de9",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/6f50dbd2fdeef7bc24317a487936502e25a05de9",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6f50dbd2fdeef7bc24317a487936502e25a05de9/comments",
    "author": {
      "login": "sdaftuar",
      "id": 7463573,
      "node_id": "MDQ6VXNlcjc0NjM1NzM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sdaftuar",
      "html_url": "https://github.com/sdaftuar",
      "followers_url": "https://api.github.com/users/sdaftuar/followers",
      "following_url": "https://api.github.com/users/sdaftuar/following{/other_user}",
      "gists_url": "https://api.github.com/users/sdaftuar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
      "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
      "repos_url": "https://api.github.com/users/sdaftuar/repos",
      "events_url": "https://api.github.com/users/sdaftuar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sdaftuar",
      "id": 7463573,
      "node_id": "MDQ6VXNlcjc0NjM1NzM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sdaftuar",
      "html_url": "https://github.com/sdaftuar",
      "followers_url": "https://api.github.com/users/sdaftuar/followers",
      "following_url": "https://api.github.com/users/sdaftuar/following{/other_user}",
      "gists_url": "https://api.github.com/users/sdaftuar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
      "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
      "repos_url": "https://api.github.com/users/sdaftuar/repos",
      "events_url": "https://api.github.com/users/sdaftuar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "1c4e3f99f05273e4d0fae7246d3afe5a33c52ee0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1c4e3f99f05273e4d0fae7246d3afe5a33c52ee0",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/1c4e3f99f05273e4d0fae7246d3afe5a33c52ee0"
      }
    ],
    "stats": {
      "total": 6,
      "additions": 2,
      "deletions": 4
    },
    "files": [
      {
        "sha": "3b2f64d766df3144c12539ec8157ec3eada0f1fb",
        "filename": "src/test/data/script_invalid.json",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6f50dbd2fdeef7bc24317a487936502e25a05de9/src/test/data/script_invalid.json",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6f50dbd2fdeef7bc24317a487936502e25a05de9/src/test/data/script_invalid.json",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/data/script_invalid.json?ref=6f50dbd2fdeef7bc24317a487936502e25a05de9",
        "patch": "@@ -696,7 +696,7 @@\n     \"BIP66 example 11, with DERSIG\"\n ],\n [\n-    \"0x49 0x304502203e4516da7253cf068effec6b95c41221c0cf3a8e6ccb8cbf1725b562e9afde2c022100ab1e3da73d67e32045a20e0b999e049978ea8d6ee5480d485fcf2ce0d03b2ef05101\",\n+    \"0x48 0x304502203e4516da7253cf068effec6b95c41221c0cf3a8e6ccb8cbf1725b562e9afde2c022100ab1e3da73d67e32045a20e0b999e049978ea8d6ee5480d485fcf2ce0d03b2ef001\",\n     \"0x21 0x03363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640 CHECKSIG\",\n     \"LOW_S\",\n     \"P2PK with high S\""
      },
      {
        "sha": "2b4b0989b99063ec7220a566b5e7826fcfc87d11",
        "filename": "src/test/data/script_valid.json",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6f50dbd2fdeef7bc24317a487936502e25a05de9/src/test/data/script_valid.json",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6f50dbd2fdeef7bc24317a487936502e25a05de9/src/test/data/script_valid.json",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/data/script_valid.json?ref=6f50dbd2fdeef7bc24317a487936502e25a05de9",
        "patch": "@@ -814,7 +814,7 @@\n     \"BIP66 example 12, with DERSIG\"\n ],\n [\n-    \"0x49 0x304502203e4516da7253cf068effec6b95c41221c0cf3a8e6ccb8cbf1725b562e9afde2c022100ab1e3da73d67e32045a20e0b999e049978ea8d6ee5480d485fcf2ce0d03b2ef05101\",\n+    \"0x48 0x304502203e4516da7253cf068effec6b95c41221c0cf3a8e6ccb8cbf1725b562e9afde2c022100ab1e3da73d67e32045a20e0b999e049978ea8d6ee5480d485fcf2ce0d03b2ef001\",\n     \"0x21 0x03363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640 CHECKSIG\",\n     \"\",\n     \"P2PK with high S but no LOW_S\""
      },
      {
        "sha": "35a7f6639ac643c6599def45884eca1e7bb59128",
        "filename": "src/test/script_tests.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 2,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6f50dbd2fdeef7bc24317a487936502e25a05de9/src/test/script_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6f50dbd2fdeef7bc24317a487936502e25a05de9/src/test/script_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/script_tests.cpp?ref=6f50dbd2fdeef7bc24317a487936502e25a05de9",
        "patch": "@@ -107,7 +107,6 @@ void static NegateSignatureS(std::vector<unsigned char>& vchSig) {\n     std::vector<unsigned char> r, s;\n     r = std::vector<unsigned char>(vchSig.begin() + 4, vchSig.begin() + 4 + vchSig[3]);\n     s = std::vector<unsigned char>(vchSig.begin() + 6 + vchSig[3], vchSig.begin() + 6 + vchSig[3] + vchSig[5 + vchSig[3]]);\n-    unsigned char hashtype = vchSig.back();\n \n     // Really ugly to implement mod-n negation here, but it would be feature creep to expose such functionality from libsecp256k1.\n     static const unsigned char order[33] = {\n@@ -141,7 +140,6 @@ void static NegateSignatureS(std::vector<unsigned char>& vchSig) {\n     vchSig.push_back(0x02);\n     vchSig.push_back(s.size());\n     vchSig.insert(vchSig.end(), s.begin(), s.end());\n-    vchSig.push_back(hashtype);\n }\n \n namespace"
      }
    ]
  },
  {
    "sha": "78c6bedb9cd3ed85f829a288146533e3b41f784b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3OGM2YmVkYjljZDNlZDg1ZjgyOWEyODgxNDY1MzNlM2I0MWY3ODRi",
    "commit": {
      "author": {
        "name": "Suhas Daftuar",
        "email": "sdaftuar@gmail.com",
        "date": "2015-02-10T17:11:59Z"
      },
      "committer": {
        "name": "Suhas Daftuar",
        "email": "sdaftuar@gmail.com",
        "date": "2015-02-10T18:25:41Z"
      },
      "message": "Add test for DER-encoding edge case\n\nThe fix to NegateSignatureS caused a test which had been failing\nin IsValidSignatureEncoding to then fail in IsLowDERSignature.\nAdd new test so the original check remains exercised.",
      "tree": {
        "sha": "4121912553a9292039683105611d6917cff5c038",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4121912553a9292039683105611d6917cff5c038"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/78c6bedb9cd3ed85f829a288146533e3b41f784b",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/78c6bedb9cd3ed85f829a288146533e3b41f784b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/78c6bedb9cd3ed85f829a288146533e3b41f784b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/78c6bedb9cd3ed85f829a288146533e3b41f784b/comments",
    "author": {
      "login": "sdaftuar",
      "id": 7463573,
      "node_id": "MDQ6VXNlcjc0NjM1NzM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sdaftuar",
      "html_url": "https://github.com/sdaftuar",
      "followers_url": "https://api.github.com/users/sdaftuar/followers",
      "following_url": "https://api.github.com/users/sdaftuar/following{/other_user}",
      "gists_url": "https://api.github.com/users/sdaftuar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
      "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
      "repos_url": "https://api.github.com/users/sdaftuar/repos",
      "events_url": "https://api.github.com/users/sdaftuar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sdaftuar",
      "id": 7463573,
      "node_id": "MDQ6VXNlcjc0NjM1NzM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sdaftuar",
      "html_url": "https://github.com/sdaftuar",
      "followers_url": "https://api.github.com/users/sdaftuar/followers",
      "following_url": "https://api.github.com/users/sdaftuar/following{/other_user}",
      "gists_url": "https://api.github.com/users/sdaftuar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
      "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
      "repos_url": "https://api.github.com/users/sdaftuar/repos",
      "events_url": "https://api.github.com/users/sdaftuar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "6f50dbd2fdeef7bc24317a487936502e25a05de9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6f50dbd2fdeef7bc24317a487936502e25a05de9",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/6f50dbd2fdeef7bc24317a487936502e25a05de9"
      }
    ],
    "stats": {
      "total": 18,
      "additions": 18,
      "deletions": 0
    },
    "files": [
      {
        "sha": "3c52547a64e22fe439545e4561cb931948ad3034",
        "filename": "src/test/data/script_invalid.json",
        "status": "modified",
        "additions": 6,
        "deletions": 0,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/78c6bedb9cd3ed85f829a288146533e3b41f784b/src/test/data/script_invalid.json",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/78c6bedb9cd3ed85f829a288146533e3b41f784b/src/test/data/script_invalid.json",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/data/script_invalid.json?ref=78c6bedb9cd3ed85f829a288146533e3b41f784b",
        "patch": "@@ -695,6 +695,12 @@\n     \"DERSIG\",\n     \"BIP66 example 11, with DERSIG\"\n ],\n+[\n+    \"0x48 0x304402203e4516da7253cf068effec6b95c41221c0cf3a8e6ccb8cbf1725b562e9afde2c022054e1c258c2981cdfba5df1f46661fb6541c44f77ca0092f3600331abfffb12510101\",\n+    \"0x21 0x03363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640 CHECKSIG\",\n+    \"DERSIG\",\n+    \"P2PK with multi-byte hashtype, with DERSIG\"\n+],\n [\n     \"0x48 0x304502203e4516da7253cf068effec6b95c41221c0cf3a8e6ccb8cbf1725b562e9afde2c022100ab1e3da73d67e32045a20e0b999e049978ea8d6ee5480d485fcf2ce0d03b2ef001\",\n     \"0x21 0x03363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640 CHECKSIG\","
      },
      {
        "sha": "34e2c8d61a7dc131159c199dae5a01a0e80d8950",
        "filename": "src/test/data/script_valid.json",
        "status": "modified",
        "additions": 6,
        "deletions": 0,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/78c6bedb9cd3ed85f829a288146533e3b41f784b/src/test/data/script_valid.json",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/78c6bedb9cd3ed85f829a288146533e3b41f784b/src/test/data/script_valid.json",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/data/script_valid.json?ref=78c6bedb9cd3ed85f829a288146533e3b41f784b",
        "patch": "@@ -813,6 +813,12 @@\n     \"DERSIG\",\n     \"BIP66 example 12, with DERSIG\"\n ],\n+[\n+    \"0x48 0x304402203e4516da7253cf068effec6b95c41221c0cf3a8e6ccb8cbf1725b562e9afde2c022054e1c258c2981cdfba5df1f46661fb6541c44f77ca0092f3600331abfffb12510101\",\n+    \"0x21 0x03363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640 CHECKSIG\",\n+    \"\",\n+    \"P2PK with multi-byte hashtype, without DERSIG\"\n+],\n [\n     \"0x48 0x304502203e4516da7253cf068effec6b95c41221c0cf3a8e6ccb8cbf1725b562e9afde2c022100ab1e3da73d67e32045a20e0b999e049978ea8d6ee5480d485fcf2ce0d03b2ef001\",\n     \"0x21 0x03363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640 CHECKSIG\","
      },
      {
        "sha": "e410b59710c144c2c88d8c0481e317844d18dc60",
        "filename": "src/test/script_tests.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 0,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/78c6bedb9cd3ed85f829a288146533e3b41f784b/src/test/script_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/78c6bedb9cd3ed85f829a288146533e3b41f784b/src/test/script_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/script_tests.cpp?ref=78c6bedb9cd3ed85f829a288146533e3b41f784b",
        "patch": "@@ -476,6 +476,12 @@ BOOST_AUTO_TEST_CASE(script_build)\n     good.push_back(TestBuilder(CScript() << OP_2 << ToByteVector(keys.pubkey1C) << ToByteVector(keys.pubkey2C) << OP_2 << OP_CHECKMULTISIG << OP_NOT,\n                                \"BIP66 example 12, with DERSIG\", SCRIPT_VERIFY_DERSIG\n                               ).Num(0).PushSig(keys.key1, SIGHASH_ALL, 33, 32).EditPush(1, \"45022100\", \"440220\").Num(0));\n+    good.push_back(TestBuilder(CScript() << ToByteVector(keys.pubkey2C) << OP_CHECKSIG,\n+                               \"P2PK with multi-byte hashtype, without DERSIG\", 0\n+                              ).PushSig(keys.key2, SIGHASH_ALL).EditPush(70, \"01\", \"0101\"));\n+    bad.push_back(TestBuilder(CScript() << ToByteVector(keys.pubkey2C) << OP_CHECKSIG,\n+                               \"P2PK with multi-byte hashtype, with DERSIG\", SCRIPT_VERIFY_DERSIG\n+                              ).PushSig(keys.key2, SIGHASH_ALL).EditPush(70, \"01\", \"0101\"));\n \n     good.push_back(TestBuilder(CScript() << ToByteVector(keys.pubkey2C) << OP_CHECKSIG,\n                                \"P2PK with high S but no LOW_S\", 0"
      }
    ]
  }
]