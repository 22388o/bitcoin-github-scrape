[
  {
    "sha": "995dd89d884bda3fb5ca1885c5887d989cd2cad3",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo5OTVkZDg5ZDg4NGJkYTNmYjVjYTE4ODVjNTg4N2Q5ODljZDJjYWQz",
    "commit": {
      "author": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2018-08-24T15:14:45Z"
      },
      "committer": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2018-08-24T15:55:05Z"
      },
      "message": "[Tests] Make combine_logs.py handle multi-line logs\n\ncombine_logs.py currently inserts additional newlines into multi-line\nlog messages, and doesn't color them properly. Fix both of those.",
      "tree": {
        "sha": "f579b581b7737561f41e39c44fd60b362811c932",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f579b581b7737561f41e39c44fd60b362811c932"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/995dd89d884bda3fb5ca1885c5887d989cd2cad3",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/995dd89d884bda3fb5ca1885c5887d989cd2cad3",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/995dd89d884bda3fb5ca1885c5887d989cd2cad3",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/995dd89d884bda3fb5ca1885c5887d989cd2cad3/comments",
    "author": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "540bf8aacc50aae0ea5beb76511905a7d2a3e15f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/540bf8aacc50aae0ea5beb76511905a7d2a3e15f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/540bf8aacc50aae0ea5beb76511905a7d2a3e15f"
      }
    ],
    "stats": {
      "total": 9,
      "additions": 7,
      "deletions": 2
    },
    "files": [
      {
        "sha": "f5eb4c453769eab1b28e973f52526afc8231b3e3",
        "filename": "test/functional/combine_logs.py",
        "status": "modified",
        "additions": 7,
        "deletions": 2,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/995dd89d884bda3fb5ca1885c5887d989cd2cad3/test/functional/combine_logs.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/995dd89d884bda3fb5ca1885c5887d989cd2cad3/test/functional/combine_logs.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/combine_logs.py?ref=995dd89d884bda3fb5ca1885c5887d989cd2cad3",
        "patch": "@@ -79,7 +79,8 @@ def get_log_events(source, logfile):\n                     timestamp = time_match.group()\n                 # if it doesn't have a timestamp, it's a continuation line of the previous log.\n                 else:\n-                    event += \"\\n\" + line\n+                    # Add the line. Prefix with space equivalent to the source + timestamp so log lines are aligned\n+                    event += \"                                   \" + line\n             # Flush the final event\n             yield LogEvent(timestamp=timestamp, source=source, event=event.rstrip())\n     except FileNotFoundError:\n@@ -98,7 +99,11 @@ def print_logs(log_events, color=False, html=False):\n             colors[\"reset\"] = \"\\033[0m\"     # Reset font color\n \n         for event in log_events:\n-            print(\"{0} {1: <5} {2} {3}\".format(colors[event.source.rstrip()], event.source, event.event, colors[\"reset\"]))\n+            lines = event.event.splitlines()\n+            print(\"{0} {1: <5} {2} {3}\".format(colors[event.source.rstrip()], event.source, lines[0], colors[\"reset\"]))\n+            if len(lines) > 1:\n+                for line in lines[1:]:\n+                    print(\"{0}{1}{2}\".format(colors[event.source.rstrip()], line, colors[\"reset\"]))\n \n     else:\n         try:"
      }
    ]
  },
  {
    "sha": "16e288acdd61fa5fa5e39f3936fb50499f82c085",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxNmUyODhhY2RkNjFmYTVmYTVlMzlmMzkzNmZiNTA0OTlmODJjMDg1",
    "commit": {
      "author": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2018-08-27T18:16:33Z"
      },
      "committer": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2018-08-27T18:31:44Z"
      },
      "message": "test padding non micro timestamps",
      "tree": {
        "sha": "3cc5f4488f93f8514dfab63265373044622fbc2f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3cc5f4488f93f8514dfab63265373044622fbc2f"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/16e288acdd61fa5fa5e39f3936fb50499f82c085",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/16e288acdd61fa5fa5e39f3936fb50499f82c085",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/16e288acdd61fa5fa5e39f3936fb50499f82c085",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/16e288acdd61fa5fa5e39f3936fb50499f82c085/comments",
    "author": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "995dd89d884bda3fb5ca1885c5887d989cd2cad3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/995dd89d884bda3fb5ca1885c5887d989cd2cad3",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/995dd89d884bda3fb5ca1885c5887d989cd2cad3"
      }
    ],
    "stats": {
      "total": 9,
      "additions": 7,
      "deletions": 2
    },
    "files": [
      {
        "sha": "3759913e4425bf2bdd115a4f706e9a08513c504b",
        "filename": "test/functional/combine_logs.py",
        "status": "modified",
        "additions": 7,
        "deletions": 2,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/16e288acdd61fa5fa5e39f3936fb50499f82c085/test/functional/combine_logs.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/16e288acdd61fa5fa5e39f3936fb50499f82c085/test/functional/combine_logs.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/combine_logs.py?ref=16e288acdd61fa5fa5e39f3936fb50499f82c085",
        "patch": "@@ -13,7 +13,7 @@\n import sys\n \n # Matches on the date format at the start of the log event\n-TIMESTAMP_PATTERN = re.compile(r\"^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}\\.\\d{6}Z\")\n+TIMESTAMP_PATTERN = re.compile(r\"^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(\\.\\d{6})?Z\")\n \n LogEvent = namedtuple('LogEvent', ['timestamp', 'source', 'event'])\n \n@@ -75,8 +75,13 @@ def get_log_events(source, logfile):\n                 if time_match:\n                     if event:\n                         yield LogEvent(timestamp=timestamp, source=source, event=event.rstrip())\n-                    event = line\n                     timestamp = time_match.group()\n+                    if time_match.group(1) is None:\n+                        # timestamp does not have microseconds. Add zeroes.\n+                        timestamp_micro = timestamp.replace(\"Z\", \".000000Z\")\n+                        line = line.replace(timestamp, timestamp_micro)\n+                        timestamp = timestamp_micro\n+                    event = line\n                 # if it doesn't have a timestamp, it's a continuation line of the previous log.\n                 else:\n                     # Add the line. Prefix with space equivalent to the source + timestamp so log lines are aligned"
      }
    ]
  }
]