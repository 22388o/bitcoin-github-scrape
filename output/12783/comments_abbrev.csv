Empact,2018-03-26T05:43:10Z,#5804,https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-376052517,376052517,
jonasschnelli,2018-03-26T07:59:39Z,utACK e41bb4a4568e08fe75ab8af7de7db1a2684cd989,https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-376078819,376078819,
Sjors,2018-03-27T08:36:39Z,"Will review later. Good question regarding which macOS version to support. The release notes state [10.8+](https://github.com/bitcoin/bitcoin/blob/master/doc/release-notes.md#compatibility), but I wonder how true that is. Apple pushes macOS updates quite aggressively and the lack of VM's make downgrades impractical. So unless any of the active devs here still runs an older version, I don't think i",https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-376442663,376442663,
jonasschnelli,2018-03-27T08:41:42Z,We do currently support 10.8+ and I have VMs for all OSX versions from 10.5 upwards. I do test the RC regularly in 10.8 till 10.x VMs.,https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-376444097,376444097,
Sjors,2018-03-27T09:00:16Z,"@jonasschnelli ok, that's great to know. Any hints for setting up a 10.8 VM on an iMac?",https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-376449654,376449654,
laanwj,2018-03-27T17:01:34Z,"Concept ACK.\nShould appnap always be disabled, or just during initial sync? It's something that could be done later, but worth thinking about I think.",https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-376599742,376599742,
theuni,2018-03-28T22:03:18Z,"I really really don't like the idea of adding a new compiler requirement for bitcoind (which is why we closed #5804).\n\nHow about using this for bitcoin-qt only ?",https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-377052649,377052649,
Sjors,2018-03-29T10:44:38Z,"I think it's reasonable* to expect bitcoind users to understand their OS power management.\n\n* = [though not always true](https://botbot.me/freenode/bitcoin-core-dev/2018-03-01/?msg=97377246&page=2) :-)",https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-377196786,377196786,
krab,2018-03-31T16:55:55Z,how to i squash all my commits in PR they contain merging commits from upstream/master  :confused: ,https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-377707175,377707175,
krab,2018-03-31T18:28:22Z,"Squashed all my commits into single one. \n\nOS X Mountain Lion 10.8 not supported by Apple anymore. Mozilla/Google don't support 10.8 either in their web browsers.\nQt 5.7 (currently used in bitcoin-qt0.16.0) support expired in June 15, 2017.\nQt 5.8 supports only 10.9+.\nQt 5.9 only 10.10+.\nSo OS X 10.8 support in bitcoin-qt pretty much pointless since it requires Qt 5.6/5.7 and very old ",https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-377713415,377713415,
laanwj,2018-04-07T13:51:32Z,"> How about using this for bitcoin-qt only ?\n\nWould make sense to me. Would (for me) be preferable to having objective C in the core code.\n\n> I think it's reasonable* to expect bitcoind users to understand their OS power management.\n\nVirtually no one uses bitcoind on MacOSX. For a long time, we didn't even build it, and there was about one person that requested it :)\n",https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-379470808,379470808,
fanquake,2018-04-12T01:16:18Z,"Started doing some testing.\nUsing master (979f59850c72624137d25f80be4188c3ba6b5fa0) I can make ```bitcoin-qt``` and Bitcoin Core (app bundle) enter app nap quite quickly just by starting and then minimising the app window. \nYou can check App Nap status using Activity Monitor -> Energy.\n\n![master - bitcoin-qt - nap](https://user-images.githubusercontent.com/863730/38650377-15d3b06a-3e2e-11e",https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-380643801,380643801,
theuni,2018-04-12T18:48:31Z,"Concept ACK. What's the point of MacOSIdleInhibitor though? In #5804, CIdleInhibitor was introduced as a generic object that could used to be hold any/all platform-specific inhibitors. Here, MacOSIdleInhibitor seems to just be an extra level of indirection.",https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-380907258,380907258,
krab,2018-04-13T03:11:42Z,"Well windows and linux can't lower cpu performance per application, on windows user can only change system-wide power plans. This thing pretty much only macos specific, MacOSIdleInhibitor  change reverted anyways.",https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-381008704,381008704,
theuni,2018-04-19T15:24:59Z,"CIdleInhibitor is still there, maybe an issue with the rebase? BitcoinCore::BitcoinCore can just create a CAppNapInhibitor.",https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-382777668,382777668,
fanquake,2018-05-29T13:53:38Z,@krab could you now squash your commits.,https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-392784909,392784909,
luke-jr,2018-06-12T17:11:04Z,Why is LSAppNapIsDisabled insufficient?,https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-396665209,396665209,
theuni,2018-06-12T20:54:10Z,"@luke-jr It's no longer referenced in their docs, and I believe it doesn't work at all in recent macOS versions.\n\nutACK, though I can't vouch for the correctness of the ObjC inhibitor itself.",https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-396730333,396730333,
fanquake,2018-06-13T16:17:21Z,"Retested 192b9e7 on macOS 10.13.5. Cannot make Bitcoin Core enter app nap:\n![12783](https://user-images.githubusercontent.com/863730/41364071-20a4d562-6f68-11e8-8afd-a92c199d7f58.png)\n\nMaster (f532d52) still enters app nap fairly quickly:\n![master](https://user-images.githubusercontent.com/863730/41364084-2f28398a-6f68-11e8-9407-b5f7dd846743.png)\n",https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-396998060,396998060,
laanwj,2018-07-05T15:37:55Z,"@krab can you take a look if you can reproduce ^^, if this works it's ready for merge, if it doesn't then let's try to fix this.",https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-402764210,402764210,
Sjors,2018-07-05T19:03:48Z,"For a future PR it would be nice to disable app nap only during sync, as @laanwj points out.\n\nCurrently the choice is between having initial sync grind (master) to a halt or wasting (a little)\n battery life for people who leave QT on for a long time (this PR). I think this PR is the better alternative, since it's more realistic to exit the application to save energy than it is to keep it in ",https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-402822163,402822163,
krab,2018-07-06T12:40:10Z,"If they changed api then code won't even start \n`if ([processInfo respondsToSelector:@selector(beginActivityWithOptions:reason:)]) {`\nhttps://i.imgur.com/g3uKu0g.png\n\n> it would be nice to disable app nap only during sync\n\nAgree, but i can't find any signal in src/qt about ""sync/initial sync"" state changed.\nOnly: [BlockTipChanged](https://github.com/bitcoin/bitcoin/blob/master/src/qt",https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-403022244,403022244,
fanquake,2018-09-03T13:19:04Z,"Added to the 0.18 milestone (not sure if we can add this to 0.17.1?). @krab has done a good job of keeping this rebased/updated. I've also done some rudimentary benchmarking, and have seen a ~20% detriment in sync times if Core falls into App Nap, which seems worth addressing.",https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-418113103,418113103,
fanquake,2018-10-09T05:39:54Z,Retested that 663efef doesn't enter app-nap. master (1d14174) still does after a short period of window minimisation. Also added `needs gitian build` label.,https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-428066598,428066598,
DrahtBot,2018-10-10T00:45:54Z,<!--a722867cd34abeea1fadc8d60700f111-->\nGitian builds for commit 1d1417430c829a0c21bf5a2fe4a5b2f592a9423f (master):\n * `a5be6400a8e93da53877a84ed34f1291...` [bitcoin-0.17.99-aarch64-linux-gnu-debug.tar.gz](https://drahtbot.space/gitian/bitcoin/bitcoin/1d1417430c829a0c21bf5a2fe4a5b2f592a9423f/bitcoin-0.17.99-aarch64-linux-gnu-debug.tar.gz)\n * `6227401a7521db83b8f3c9fe19702b4d...` [bitcoin-0.17.9,https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-428400117,428400117,
krab,2018-10-11T02:23:27Z,Rebased against master branch. A bit less code in `bitcoingui.cpp`.  `macos_appnap.mm/h` in pimpl style. Fixed checks for `activityId`. `activityId = nil;` required if we want reuse same pointer.,https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-428796180,428796180,
DrahtBot,2018-10-20T11:07:22Z,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#14137](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14137.html) (gui: Add Windows taskbar progress by ken281",https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-431570865,431570865,
Sjors,2018-10-23T03:41:14Z,"tACK 2a14df1 on macOS 10.14 (in July I tested on 10.13) \n\nI previously wrote:\n> it would be nice to disable app nap only during sync,\n\nThis works now. With the app in the background, it enters app nap after a minute or so. If however I rewind the chain a bit e.g. with `invalidateblock` & `reconsiderblock` and wait for resync, it won't enter app nap.\n\nIt does enter app nap during expe",https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-432078923,432078923,
fanquake,2018-10-31T07:14:41Z,"Related upstream ticket [QTBUG-43861](https://bugreports.qt.io/browse/QTBUG-43861). If we're lucky, one day Qt might expose an API for this functionality, so we don't have to ship the Objective-C ourselves.",https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-434584761,434584761,
Sjors,2018-11-02T17:43:54Z,utACK 1e0f3c4 (rebased),https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-435456856,435456856,
laanwj,2018-11-10T09:40:34Z,utACK 1e0f3c44992fb82e6bf36c2ef9277b0759c17c4c,https://github.com/bitcoin/bitcoin/pull/12783#issuecomment-437571494,437571494,
jonasschnelli,2018-03-26T07:57:10Z,Is there a difference in using `NSObject *activityId`?,https://github.com/bitcoin/bitcoin/pull/12783#discussion_r177005187,177005187,src/support/macos_appnap.mm
jonasschnelli,2018-03-26T07:57:31Z,"nit: code styling, use brackets {}",https://github.com/bitcoin/bitcoin/pull/12783#discussion_r177005267,177005267,src/support/macos_appnap.mm
jonasschnelli,2018-03-26T07:59:10Z,"Since we are only holding a `NSObject` pointer, is this deallocation really required or could it even be messing with the autorelease pool?",https://github.com/bitcoin/bitcoin/pull/12783#discussion_r177005637,177005637,src/support/macos_appnap.mm
theuni,2018-04-09T18:11:23Z,"Since this isn't defined for < MAC_OS_X_VERSION_10_9, does it need a runtime check?",https://github.com/bitcoin/bitcoin/pull/12783#discussion_r180182806,180182806,src/qt/macos_appnap.mm
krab,2018-04-09T23:34:02Z,"No idea, i can't setup 10.8 build vm to test code properly, so pre 10.9 support removed.",https://github.com/bitcoin/bitcoin/pull/12783#discussion_r180260587,180260587,src/qt/macos_appnap.mm
fanquake,2018-04-19T07:45:53Z,nit: macOS instead of OSX,https://github.com/bitcoin/bitcoin/pull/12783#discussion_r182658544,182658544,src/qt/bitcoin.cpp
fanquake,2018-04-19T07:47:34Z,"This is missing a copyright header\n```\n// Copyright (c) 2018 The Bitcoin Core developers\n// Distributed under the MIT software license, see the accompanying\n// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n```",https://github.com/bitcoin/bitcoin/pull/12783#discussion_r182658880,182658880,src/qt/macos_appnap.mm
fanquake,2018-04-19T07:48:05Z,"You can just use:\n```\n// Copyright (c) 2018 The Bitcoin Core developers\n// Distributed under the MIT software license, see the accompanying\n// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n```\nas the copyright header here",https://github.com/bitcoin/bitcoin/pull/12783#discussion_r182658988,182658988,src/qt/macos_appnap.h
luke-jr,2018-07-07T11:30:28Z,"Even if it doesn't work in latest versions, why not keep it for older ones?",https://github.com/bitcoin/bitcoin/pull/12783#discussion_r200809953,200809953,share/qt/Info.plist.in
luke-jr,2018-07-07T11:35:21Z,Why latency critical?,https://github.com/bitcoin/bitcoin/pull/12783#discussion_r200810019,200810019,src/qt/macos_appnap.mm
Sjors,2018-07-07T11:44:02Z,I'm having a hard time finding any Apple documentation about that flag. Do we know where it got deprecated? See also #13362,https://github.com/bitcoin/bitcoin/pull/12783#discussion_r200810186,200810186,share/qt/Info.plist.in
fanquake,2018-07-25T14:58:18Z,These `if defs` should no longer be required now that we only support 10.10+.,https://github.com/bitcoin/bitcoin/pull/12783#discussion_r205143837,205143837,src/qt/macos_appnap.mm
practicalswift,2018-09-06T07:42:24Z,Should be `explicit`? :-),https://github.com/bitcoin/bitcoin/pull/12783#discussion_r215524599,215524599,src/qt/macos_appnap.h
promag,2018-10-10T00:43:07Z,nit `Private* d;` or `std::unique_ptr<Private> d;`,https://github.com/bitcoin/bitcoin/pull/12783#discussion_r223907161,223907161,src/qt/macos_appnap.h
promag,2018-10-10T00:43:18Z,"nit, `final`?",https://github.com/bitcoin/bitcoin/pull/12783#discussion_r223907190,223907190,src/qt/macos_appnap.h
promag,2018-10-10T00:45:59Z,"Should be deleted? Maybe use `std::unique`. nit, `m_app_nap_inhibitor`;",https://github.com/bitcoin/bitcoin/pull/12783#discussion_r223907545,223907545,src/qt/bitcoingui.h
krab,2018-10-11T02:15:09Z,Delete what and why? 🤔,https://github.com/bitcoin/bitcoin/pull/12783#discussion_r224295990,224295990,src/qt/bitcoingui.h
