hebasto,2021-06-03 14:57:18,"Concept ACK. The same idea (a separated making of tools) is used for other dependencies.\n\nNeed more investigation to find out if this approach is compatible with adding additional Qt modules.",https://github.com/bitcoin/bitcoin/pull/22142#issuecomment-853934837,853934837,
DrahtBot,2021-06-04 03:29:39,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20641 (depends: Use Qt top-level build facilities by hebasto)\n\nIf you consider this pull request important, please also",https://github.com/bitcoin/bitcoin/pull/22142#issuecomment-854331802,854331802,
hebasto,2021-06-07 03:04:15,I think the reason of the failure on Centos 8 is wrong architecture the `qmake` is configured for -- `x86_64` instead of `i386`.,https://github.com/bitcoin/bitcoin/pull/22142#issuecomment-855541892,855541892,
hebasto,2021-06-08 16:44:22,"I'm able to `make -C depends qt_configured HOST=i686-pc-linux-gnu` with the correct architecture detection:\n```\n...\nConfigure summary:\n\nBuilding on: linux-g++ (x86_64, CPU features: mmx sse sse2)\nBuilding for: linux-g++-32 (i386, CPU features: <none>)\n...\n```\nwith the following patch:\n```diff\n--- a/depends/packages/qt.mk\n+++ b/depends/packages/qt.mk\n@@ -111,10 +111,6 @@ $",https://github.com/bitcoin/bitcoin/pull/22142#issuecomment-856926951,856926951,
hebasto,2021-06-08 17:22:53,"The branch with applied [fixup](https://github.com/bitcoin/bitcoin/pull/22142#issuecomment-856926951) is [here](https://github.com/hebasto/bitcoin/commits/210608-qtbase-5).\nCI -- https://cirrus-ci.com/build/4834341327994880 -- is green :tiger2: ",https://github.com/bitcoin/bitcoin/pull/22142#issuecomment-856952883,856952883,
hebasto,2021-06-08 19:07:24,"> The branch with applied [fixup](https://github.com/bitcoin/bitcoin/pull/22142#issuecomment-856926951) is [here](https://github.com/hebasto/bitcoin/commits/210608-qtbase-5).\n\nTested on Armbian 21.02.3 -- #18536 is fixed, and #21589 could be dropped.",https://github.com/bitcoin/bitcoin/pull/22142#issuecomment-857024594,857024594,
hebasto,2021-06-08 20:54:34,"The `linguist` stuff could be simplified:\n```diff\n--- a/depends/packages/native_qtbase.mk\n+++ b/depends/packages/native_qtbase.mk\n@@ -162,9 +162,7 @@ define $(package)_config_cmds\n   qtbase/bin/qmake -o qtbase/src/tools/qfloat16-tables/Makefile qtbase/src/tools/qfloat16-tables/qfloat16-tables.pro && \\n   qtbase/bin/qmake -o qtbase/src/tools/qvkgen/Makefile qtbase/src/tools/qvkgen/qvkge",https://github.com/bitcoin/bitcoin/pull/22142#issuecomment-857134981,857134981,
fanquake,2021-06-09 07:44:33,"> I'm able to make -C depends qt_configured HOST=i686-pc-linux-gnu with the correct architecture detection:\n> The linguist stuff could be simplified:\n\nThanks, I've addressed both of these points. Also addressed the comments you left inline and rebased for #22174. I think we can merge #22186 before this. I'm not really happy with how qt patches end up duplicated, but we should be able to fix ",https://github.com/bitcoin/bitcoin/pull/22142#issuecomment-857467847,857467847,
hebasto,2021-06-10 20:25:20,"> Splitting the build in this way has a few advantages. For example, we can enable the xml module while building the tools, and ideally fix issues like #14648 or #18536 without needing changes like #21589 or #21420, or having to build it alongside our libs.\n\nIt is true that avoiding intrusive fixes to the build system--i.e., patching Qt code base--makes it more maintainable and more comprehens",https://github.com/bitcoin/bitcoin/pull/22142#issuecomment-859026573,859026573,
fanquake,2021-06-11 00:49:27,"> compatibility with possible including other modules in the future\n\nIs this approach actually incompatible with doing that?",https://github.com/bitcoin/bitcoin/pull/22142#issuecomment-859180948,859180948,
hebasto,2021-06-11 00:56:38,"> > compatibility with possible including other modules in the future\n> \n> Is this approach actually incompatible with doing that?\n\nIf new modules depends on core and tools are built in the `native_qtbase.mk` only -- that is ok.\nBut if they have mutual dependencies, this approach could fail (without additional hacks).",https://github.com/bitcoin/bitcoin/pull/22142#issuecomment-859183409,859183409,
fanquake,2021-06-18 07:23:14,Closing this in favour of #20641 for now.,https://github.com/bitcoin/bitcoin/pull/22142#issuecomment-863820410,863820410,
hebasto,2021-06-08 20:25:07,This line seems unneeded. Verified with 9046de8a4cbc3899fed9eae084115f423e7ac5bd (from #21995).,https://github.com/bitcoin/bitcoin/pull/22142#discussion_r647768455,647768455,depends/packages/native_qtbase.mk
hebasto,2021-06-08 20:26:22,"style nit, extra spaces:\n```suggestion\n  echo ""$($(package)_sha256_hash) $($(package)_source)"" > $($(package)_extract_dir)/.$($(package)_file_name).hash && \\n  echo ""$($(package)_qttools_sha256_hash) $($(package)_source_dir)/$($(package)_qttools_file_name)"" >> $($(package)_extract_dir)/.$($(package)_file_name).hash && \\n```",https://github.com/bitcoin/bitcoin/pull/22142#discussion_r647769294,647769294,depends/packages/native_qtbase.mk
fanquake,2021-06-09 07:31:11,Addressed in next push.,https://github.com/bitcoin/bitcoin/pull/22142#discussion_r648041348,648041348,depends/packages/native_qtbase.mk
fanquake,2021-06-09 07:31:22,Addressed in next push.,https://github.com/bitcoin/bitcoin/pull/22142#discussion_r648041468,648041468,depends/packages/native_qtbase.mk
fanquake,2021-06-09 13:26:28,5. needs to be restored here.,https://github.com/bitcoin/bitcoin/pull/22142#discussion_r648299517,648299517,depends/packages/qt.mk
