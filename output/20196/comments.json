[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/712900844",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-712900844",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 712900844,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxMjkwMDg0NA==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-20T14:37:33Z",
    "updated_at": "2021-11-26T22:03:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#23561](https://github.com/bitcoin/bitcoin/pull/23561) (BIP324: Handshake prerequisites by dhruv)\n* [#23233](https://github.com/bitcoin/bitcoin/pull/23233) (BIP324: Add encrypted p2p transport {de}serializer by dhruv)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/712900844/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/714427142",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-714427142",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 714427142,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNDQyNzE0Mg==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-22T11:25:21Z",
    "updated_at": "2020-10-22T11:25:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "Addressed review suggestions and added a test to cover case `4.` from https://github.com/bitcoin/bitcoin/issues/20184.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/714427142/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/714462655",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-714462655",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 714462655,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNDQ2MjY1NQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-22T12:34:37Z",
    "updated_at": "2020-10-22T12:34:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "Addressed review suggestions.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/714462655/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/714613601",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-714613601",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 714613601,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcxNDYxMzYwMQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-22T16:32:54Z",
    "updated_at": "2020-10-22T16:32:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "Fixed linter error `feature_bind_port_discover.py:25:18: E703 statement ends with a semicolon` :facepalm: ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/714613601/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/747587485",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-747587485",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 747587485,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0NzU4NzQ4NQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-17T17:34:13Z",
    "updated_at": "2020-12-17T17:34:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased and changed port numbers used in the functional tests.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/747587485/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/760184250",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-760184250",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 760184250,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MDE4NDI1MA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-14T13:04:41Z",
    "updated_at": "2021-01-14T13:04:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "3e55fbfe3...5647ca32e: rebased due to conflicts + address a [suggestion](https://github.com/bitcoin/bitcoin/pull/20196#discussion_r556430946).",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/760184250/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/761805075",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-761805075",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 761805075,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MTgwNTA3NQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-17T12:33:33Z",
    "updated_at": "2021-01-17T12:33:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "5647ca32e...58755690a: rebase, what's up with appveyor?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/761805075/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/761810859",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-761810859",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 761810859,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MTgxMDg1OQ==",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?u=7297e8aaf9188c0cb98bc549a8a02a1dc8d59e4c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-17T13:13:43Z",
    "updated_at": "2021-01-17T13:13:43Z",
    "author_association": "MEMBER",
    "body": "@vasild \r\n> what's up with appveyor?\r\n\r\nWhat do you mean?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/761810859/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/761811157",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-761811157",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 761811157,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MTgxMTE1Nw==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-17T13:15:51Z",
    "updated_at": "2021-01-17T13:15:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "@hebasto https://ci.appveyor.com/project/DrahtBot/bitcoin/builds/37305037",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/761811157/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/762262711",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-762262711",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 762262711,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MjI2MjcxMQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-18T13:49:34Z",
    "updated_at": "2021-01-18T13:49:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "58755690a...d8c6dc0b6: undo the effects of `AddTimeData()` called indirectly by the newly added test `net_tests/initial_advertise_from_version_message` so that `timedata_tests/addtimedata` is not confused. Thanks, @MarcoFalke!",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/762262711/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/762766676",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-762766676",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 762766676,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2Mjc2NjY3Ng==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-19T10:57:34Z",
    "updated_at": "2021-01-19T10:57:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "d8c6dc0b6...70cd1eaef: address [suggestion](https://github.com/bitcoin/bitcoin/pull/20196#discussion_r559688334)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/762766676/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/776812456",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-776812456",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 776812456,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3NjgxMjQ1Ng==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-10T15:57:45Z",
    "updated_at": "2021-02-10T15:57:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "70cd1eaef...698590c57: rebase due to conflicts",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/776812456/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/785081112",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-785081112",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 785081112,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4NTA4MTExMg==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-24T13:37:57Z",
    "updated_at": "2021-02-24T13:37:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "`698590c57...400cbd480`: rebase due to conflicts",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/785081112/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/799517957",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-799517957",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 799517957,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5OTUxNzk1Nw==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-15T15:36:16Z",
    "updated_at": "2021-03-15T15:36:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "`400cbd480...b6fb4b928`: rebase due to conflicts",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/799517957/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/799589570",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-799589570",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 799589570,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5OTU4OTU3MA==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-15T17:09:41Z",
    "updated_at": "2021-03-15T17:09:41Z",
    "author_association": "MEMBER",
    "body": "Concept ACK",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/799589570/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/801079743",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-801079743",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 801079743,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwMTA3OTc0Mw==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-17T13:28:22Z",
    "updated_at": "2021-03-17T13:28:22Z",
    "author_association": "CONTRIBUTOR",
    "body": "`b6fb4b928...0c24971f9`: rebase due to conflicts",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/801079743/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/808079560",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-808079560",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 808079560,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwODA3OTU2MA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-26T09:47:24Z",
    "updated_at": "2021-03-26T09:47:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "`0c24971f9...4977c0fdb`: rebase due to conflicts",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/808079560/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/808210718",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-808210718",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 808210718,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwODIxMDcxOA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-26T13:22:33Z",
    "updated_at": "2021-03-26T13:22:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "`4977c0fdb...7d5d2416e`: address review suggestions",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/808210718/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/816660759",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-816660759",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 816660759,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxNjY2MDc1OQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-09T12:53:39Z",
    "updated_at": "2021-04-09T12:53:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "> ...a test that accepts the \"wrong\" option\r\n\r\nThat must be some \"feature\" in the testing framework - it also accepts `--ihave11`.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/816660759/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/816683688",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-816683688",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 816683688,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxNjY4MzY4OA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-09T13:30:43Z",
    "updated_at": "2021-04-09T13:30:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "`7d5d2416e...3501180d3`: rebase due to conflicts",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/816683688/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/816684259",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-816684259",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 816684259,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxNjY4NDI1OQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-09T13:31:39Z",
    "updated_at": "2021-04-09T13:31:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "`3501180d3...33b0a79df`: address suggestions",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/816684259/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/818873660",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-818873660",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 818873660,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxODg3MzY2MA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-13T16:29:57Z",
    "updated_at": "2021-04-13T16:29:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "`33b0a79df...a5590dcf9`: use `NetPermissions::HasFlag()` to check if `PF_NOBAN` is set, thanks @jonatack!",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/818873660/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/818955338",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-818955338",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 818955338,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxODk1NTMzOA==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-13T18:19:17Z",
    "updated_at": "2021-04-13T18:19:35Z",
    "author_association": "MEMBER",
    "body": "ACK a5590dcf9dccd82bb0784349d2a3c91dec263380\r\n\r\nHappy to re-ack if you add the `NetPermissionFlags::` scope mentioned in https://github.com/bitcoin/bitcoin/pull/20196#discussion_r612676028.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/818955338/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/819270856",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-819270856",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 819270856,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxOTI3MDg1Ng==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-14T06:42:03Z",
    "updated_at": "2021-04-14T06:42:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "`a5590dcf9...7126e12fa`: use `NetPermissionFlags::PF_NOBAN` instead of `PF_NOBAN`",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/819270856/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/819342877",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-819342877",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 819342877,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxOTM0Mjg3Nw==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-14T08:39:16Z",
    "updated_at": "2021-04-14T08:39:16Z",
    "author_association": "MEMBER",
    "body": "re-ACK  7126e12fab1eff95efeaab349a49e4f1f714ed4f  per `git diff a5590dc 7126e12`\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/819342877/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/844012726",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-844012726",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 844012726,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NDAxMjcyNg==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-19T11:29:17Z",
    "updated_at": "2021-05-19T11:29:17Z",
    "author_association": "MEMBER",
    "body": "Bump. This could use a review by someone!",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/844012726/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/844022157",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-844022157",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 844022157,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NDAyMjE1Nw==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-19T11:43:14Z",
    "updated_at": "2021-05-19T11:43:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "`7126e12fab...9c15f204e5`: conflictless rebase to get green CI",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/844022157/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/844049274",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-844049274",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 844049274,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NDA0OTI3NA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-19T12:19:14Z",
    "updated_at": "2021-05-19T12:19:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "`9c15f204e5...2519696300`: fix silent merge conflict",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/844049274/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/844269202",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-844269202",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 844269202,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NDI2OTIwMg==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-19T16:30:23Z",
    "updated_at": "2021-05-19T16:30:23Z",
    "author_association": "CONTRIBUTOR",
    "body": "`2519696300...b962cbc22c`: address review suggestion",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/844269202/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/844277942",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-844277942",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 844277942,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NDI3Nzk0Mg==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-19T16:41:19Z",
    "updated_at": "2021-05-19T16:41:19Z",
    "author_association": "MEMBER",
    "body": "Thanks!\r\n\r\nCode review re-ACK  b962cbc22cd35a6f7c5b42a0f3a113c109b4cee2 per `git range-diff d4c409c 2519696 b962cbc`\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/844277942/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/883287873",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-883287873",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 883287873,
    "node_id": "IC_kwDOABII5840pedB",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-20T10:36:37Z",
    "updated_at": "2021-07-20T10:36:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "`b962cbc22c...4ea0a60f75`: rebase due to conflicts",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/883287873/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/883444294",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-883444294",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 883444294,
    "node_id": "IC_kwDOABII5840qEpG",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-20T14:34:29Z",
    "updated_at": "2021-07-20T14:34:29Z",
    "author_association": "MEMBER",
    "body": "Build:\r\n```\r\ntest/net_tests.cpp:964:34: error: no member named 'vAddrToSend' in 'CNode'\r\n    BOOST_CHECK(std::any_of(peer.vAddrToSend.begin(), peer.vAddrToSend.end(),\r\n                            ~~~~ ^\r\n\r\ntest/net_tests.cpp:964:60: error: no member named 'vAddrToSend' in 'CNode'\r\n    BOOST_CHECK(std::any_of(peer.vAddrToSend.begin(), peer.vAddrToSend.end(),\r\n                                                      ~~~~ ^\r\n2 errors generated.\r\n```\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/883444294/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/883470756",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-883470756",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 883470756,
    "node_id": "IC_kwDOABII5840qLGk",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-20T15:08:32Z",
    "updated_at": "2021-07-20T15:08:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yes :sob: after recent changes `CNode::vAddrToSend` has been moved to `Peer::m_addrs_to_send` (`Peer` is defined only in `net_processing.cpp`, not exposed outside). So this is now nearly untestable. I am considering how to resolve this. Would hate to drop the test.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/883470756/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 1,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/885058188",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-885058188",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 885058188,
    "node_id": "IC_kwDOABII5840wOqM",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-22T16:43:54Z",
    "updated_at": "2021-07-22T16:43:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "`4ea0a60f75...6813052724`: rewrite the test `net_tests/initial_advertise_from_version_message` so that it works with latest `master`",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/885058188/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/885423256",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-885423256",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 885423256,
    "node_id": "IC_kwDOABII5840xnyY",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-23T06:11:20Z",
    "updated_at": "2021-07-23T06:11:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "`6813052724...2aee1b92c5`: fix `net_tests/get_local_addr_for_peer_port`: compare `CService` instead of `CAddress` - \"time\" and \"services\" (part of `CAddress`) are irrelevant and should not be compared (they differ).",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/885423256/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/889272310",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-889272310",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 889272310,
    "node_id": "IC_kwDOABII5841ATf2",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-29T16:04:24Z",
    "updated_at": "2021-07-29T16:04:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "`2aee1b92c5...ad6c1fbe8f`: address suggestions",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/889272310/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/889290175",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-889290175",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 889290175,
    "node_id": "IC_kwDOABII5841AX2_",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-29T16:28:14Z",
    "updated_at": "2021-07-29T16:28:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "`ad6c1fbe8f...e4474f66d9`: change forgotten argument to pass `Span` by value",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/889290175/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/889305628",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-889305628",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 889305628,
    "node_id": "IC_kwDOABII5841Aboc",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-07-29T16:52:37Z",
    "updated_at": "2021-07-29T16:52:37Z",
    "author_association": "MEMBER",
    "body": "ACK e4474f66d91228b8ddcc8ce4fb5ebdb447ecede5 rebased and debug-built to current master to check for silent merge conflicts, reviewed code, removed the code behind each behavior change and verified the relevant test failed where expected, and passed with the code re-inserted\r\n\r\nPossible additional to-do: manually reproduce and verify the issues outlined in https://github.com/bitcoin/bitcoin/issues/20184.\r\n\r\nThis PR fixes a number of issues--nice work!\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/889305628/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/902628603",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-902628603",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 902628603,
    "node_id": "IC_kwDOABII5841zQT7",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-20T11:31:38Z",
    "updated_at": "2021-08-20T11:31:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "`e4474f66d9...812deb7470`: rebase due to conflicts",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/902628603/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/902972112",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-902972112",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 902972112,
    "node_id": "IC_kwDOABII58410kLQ",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-20T21:39:57Z",
    "updated_at": "2021-08-20T21:39:57Z",
    "author_association": "MEMBER",
    "body": "utACK 812deb7470d1d60ee6756b2cbec72bb32999312e. Agree with the concept and code changes. I've only superficially reviewed the new test.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/902972112/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/902975593",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-902975593",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 902975593,
    "node_id": "IC_kwDOABII58410lBp",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-20T21:50:00Z",
    "updated_at": "2021-08-20T21:50:00Z",
    "author_association": "MEMBER",
    "body": "Code review re-ACK 812deb7470d1d60ee6756b2cbec72bb32999312e per `git range-diff f8b837 e4474f6 812deb7` rebase-only since my last review",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/902975593/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/930190064",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#issuecomment-930190064",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20196",
    "id": 930190064,
    "node_id": "IC_kwDOABII5843cZLw",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-29T13:44:28Z",
    "updated_at": "2021-09-29T13:44:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "`812deb7470...cb86c1fd20`: rebase due to conflicts\r\n\r\nInvalidates ACKs from @sipa, @jonatack.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/930190064/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/509346608",
    "pull_request_review_id": 513764292,
    "id": 509346608,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM0NjYwOA==",
    "diff_hunk": "@@ -0,0 +1,76 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that the proper port is used for -externalip=\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal\n+\n+# We need to bind to a routable address for this test to exercise the relevant code.\n+# To set a routable IP address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up  # to set up\n+# ifconfig lo:0 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig lo0 1.1.1.1/32 alias  # to set up\n+# ifconfig lo0 1.1.1.1 -alias  # to remove it, after the test\n+addr = '1.1.1.1'\n+\n+# array of tuples [arguments, expected port in localaddresses]\n+expected = [\n+    [['-externalip=2.2.2.2',       '-port=20001'                               ], 20001],\n+    [['-externalip=2.2.2.2',       '-port=20002', '-bind={}'.format(addr)],       20002],\n+    [['-externalip=2.2.2.2',                      '-bind={}'.format(addr)],       11002],\n+    [['-externalip=2.2.2.2',       '-port=20003', '-bind={}:20004'.format(addr)], 20004],\n+    [['-externalip=2.2.2.2',                      '-bind={}:20005'.format(addr)], 20005],\n+    [['-externalip=2.2.2.2:20006', '-port=20007'                               ], 20006],\n+    [['-externalip=2.2.2.2:20008', '-port=20009', '-bind={}'.format(addr)],       20008],\n+    [['-externalip=2.2.2.2:20010',                '-bind={}'.format(addr)],       20010],\n+    [['-externalip=2.2.2.2:20011', '-port=20012', '-bind={}:20013'.format(addr)], 20011],\n+    [['-externalip=2.2.2.2:20014',                '-bind={}:20015'.format(addr)], 20014],\n+    [['-externalip=2.2.2.2',       '-port=20016', '-bind={}:20017'.format(addr),\n+                                             '-whitebind={}:20018'.format(addr)], 20017],\n+    [['-externalip=2.2.2.2',       '-port=20019',\n+                                             '-whitebind={}:20020'.format(addr)], 20020],\n+]\n+\n+class BindPortTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        # Avoid any -bind= on the command line. Force the framework to avoid adding -bind=127.0.0.1.\n+        self.setup_clean_chain = True\n+        self.bind_to_localhost_only = False\n+        self.num_nodes = len(expected)\n+\n+    def add_options(self, parser):\n+        parser.add_argument(\n+            \"--ihave1111\", action='store_true', dest=\"ihave1111\",\n+            help=\"Run the test, assuming {} is configured on the machine\".format(addr),\n+            default=False)\n+\n+    def setup_nodes(self):\n+        if not self.options.ihave1111:\n+            raise SkipTest(\n+                \"To run this test make sure that {} (a routable address) is assigned \"\n+                \"to one of the interfaces on this machine and rerun with --ihave1111\".format(addr))\n+        args = []\n+        for t in expected:\n+            args.append(t[0])\n+        self.add_nodes(self.num_nodes, extra_args=args)\n+        self.start_nodes()\n+\n+    def run_test(self):\n+        for i in range(len(expected)):\n+            expected_port = expected[i][1]\n+            found = False\n+            for local in self.nodes[i].getnetworkinfo()['localaddresses']:\n+                if local['address'] == '2.2.2.2':\n+                    assert_equal(local['port'], expected_port)\n+                    found = True\n+                    break\n+            assert(found)",
    "path": "test/functional/feature_bind_port_externalip.py",
    "position": null,
    "original_position": 73,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "e6c3de7178ff3e2b0961e71635729bbfe6784f1e",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I believe this can be written shorter\r\n\r\n```suggestion\r\n            local = next(l for l in self.nodes[i].getnetworkinfo()['localaddresses'] if l['address'] == '2.2.2.2')\r\n            assert_equal(local['port'], expected_port)\r\n```",
    "created_at": "2020-10-21T14:40:21Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r509346608",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/509346608"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r509346608"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/509346608/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 67,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 72,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/509350641",
    "pull_request_review_id": 513764292,
    "id": 509350641,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM1MDY0MQ==",
    "diff_hunk": "@@ -0,0 +1,76 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that the proper port is used for -externalip=\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal\n+\n+# We need to bind to a routable address for this test to exercise the relevant code.\n+# To set a routable IP address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up  # to set up\n+# ifconfig lo:0 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig lo0 1.1.1.1/32 alias  # to set up\n+# ifconfig lo0 1.1.1.1 -alias  # to remove it, after the test\n+addr = '1.1.1.1'\n+\n+# array of tuples [arguments, expected port in localaddresses]\n+expected = [\n+    [['-externalip=2.2.2.2',       '-port=20001'                               ], 20001],\n+    [['-externalip=2.2.2.2',       '-port=20002', '-bind={}'.format(addr)],       20002],\n+    [['-externalip=2.2.2.2',                      '-bind={}'.format(addr)],       11002],\n+    [['-externalip=2.2.2.2',       '-port=20003', '-bind={}:20004'.format(addr)], 20004],\n+    [['-externalip=2.2.2.2',                      '-bind={}:20005'.format(addr)], 20005],\n+    [['-externalip=2.2.2.2:20006', '-port=20007'                               ], 20006],\n+    [['-externalip=2.2.2.2:20008', '-port=20009', '-bind={}'.format(addr)],       20008],\n+    [['-externalip=2.2.2.2:20010',                '-bind={}'.format(addr)],       20010],\n+    [['-externalip=2.2.2.2:20011', '-port=20012', '-bind={}:20013'.format(addr)], 20011],\n+    [['-externalip=2.2.2.2:20014',                '-bind={}:20015'.format(addr)], 20014],\n+    [['-externalip=2.2.2.2',       '-port=20016', '-bind={}:20017'.format(addr),\n+                                             '-whitebind={}:20018'.format(addr)], 20017],\n+    [['-externalip=2.2.2.2',       '-port=20019',\n+                                             '-whitebind={}:20020'.format(addr)], 20020],\n+]\n+\n+class BindPortTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        # Avoid any -bind= on the command line. Force the framework to avoid adding -bind=127.0.0.1.\n+        self.setup_clean_chain = True\n+        self.bind_to_localhost_only = False\n+        self.num_nodes = len(expected)\n+\n+    def add_options(self, parser):\n+        parser.add_argument(\n+            \"--ihave1111\", action='store_true', dest=\"ihave1111\",\n+            help=\"Run the test, assuming {} is configured on the machine\".format(addr),\n+            default=False)\n+\n+    def setup_nodes(self):",
    "path": "test/functional/feature_bind_port_externalip.py",
    "position": null,
    "original_position": 53,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "e6c3de7178ff3e2b0961e71635729bbfe6784f1e",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Does this need to be overwritten? You can use `skip_test_if_missing_module`",
    "created_at": "2020-10-21T14:45:00Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r509350641",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/509350641"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r509350641"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/509350641/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 53,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/509350836",
    "pull_request_review_id": 513764292,
    "id": 509350836,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM1MDgzNg==",
    "diff_hunk": "@@ -0,0 +1,76 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that the proper port is used for -externalip=\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal\n+\n+# We need to bind to a routable address for this test to exercise the relevant code.\n+# To set a routable IP address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up  # to set up\n+# ifconfig lo:0 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig lo0 1.1.1.1/32 alias  # to set up\n+# ifconfig lo0 1.1.1.1 -alias  # to remove it, after the test\n+addr = '1.1.1.1'\n+\n+# array of tuples [arguments, expected port in localaddresses]\n+expected = [",
    "path": "test/functional/feature_bind_port_externalip.py",
    "position": null,
    "original_position": 23,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "e6c3de7178ff3e2b0961e71635729bbfe6784f1e",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "uppercase constants",
    "created_at": "2020-10-21T14:45:16Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r509350836",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/509350836"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r509350836"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/509350836/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 23,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/509351706",
    "pull_request_review_id": 513764292,
    "id": 509351706,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM1MTcwNg==",
    "diff_hunk": "@@ -1944,11 +1942,15 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     connOptions.nMaxOutboundLimit = nMaxOutboundLimit;\n     connOptions.m_peer_connect_timeout = peer_connect_timeout;\n \n+    // Port to bind to if `-bind=addr` is provided without a `:port` suffix.\n+    const uint16_t default_bind_port =\n+        static_cast<uint16_t>(gArgs.GetArg(\"-port\", Params().GetDefaultPort()));",
    "path": "src/init.cpp",
    "position": null,
    "original_position": 15,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "e6c3de7178ff3e2b0961e71635729bbfe6784f1e",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "```suggestion\r\n        static_cast<uint16_t>(args.GetArg(\"-port\", Params().GetDefaultPort()));\r\n```",
    "created_at": "2020-10-21T14:46:18Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r509351706",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/509351706"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r509351706"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/509351706/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1947,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/509353895",
    "pull_request_review_id": 513764292,
    "id": 509353895,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM1Mzg5NQ==",
    "diff_hunk": "@@ -677,8 +682,80 @@ BOOST_AUTO_TEST_CASE(ipv4_peer_with_ipv6_addrMe_test)\n \n     // suppress no-checks-run warning; if this test fails, it's by triggering a sanitizer\n     BOOST_CHECK(1);\n+\n+    // Cleanup, so that we don't confuse other tests.\n+    {\n+        LOCK(cs_mapLocalHost);\n+        mapLocalHost.erase(addr_in_mapLocalHost);\n+    }\n }\n \n+BOOST_AUTO_TEST_CASE(advertise_local_port)\n+{\n+    // Test that AdvertiseLocal() properly self-advertises us:\n+    //\n+    // 1. AdvertiseLocal() calls GetLocalAddress() which returns an address that is not routable.\n+    // 2. AdvertiseLocal() overrides the address with whatever the peer has told us he sees us as.\n+    // 2.1. For inbound connections we must override both the address and the port.\n+    // 2.2. For outbound connections we must override only the address.\n+\n+    // Pretend that we bound to this port.\n+    const uint16_t bind_port = 20001;\n+    gArgs.ForceSetArg(\"-bind\", strprintf(\"3.4.5.6:%u\", bind_port));\n+\n+    // Our address:port as seen from the peer.\n+    in_addr peer_us_addr;\n+    peer_us_addr.s_addr = htonl(0x02030405);\n+    const CAddress peer_us{CService{peer_us_addr, 20002}, NODE_NETWORK};\n+\n+    // Create a peer with a routable IPv4 address (outbound).\n+    in_addr peer_out_in_addr;\n+    peer_out_in_addr.s_addr = htonl(0x01020304);\n+    CNode peer_out{0,\n+                   NODE_NETWORK,\n+                   0,\n+                   INVALID_SOCKET,\n+                   CAddress{CService{peer_out_in_addr, 8333}, NODE_NETWORK},\n+                   0,\n+                   0,\n+                   CAddress{},\n+                   std::string{},\n+                   ConnectionType::OUTBOUND_FULL_RELAY};\n+    peer_out.fSuccessfullyConnected = true;\n+    peer_out.SetAddrLocal(peer_us);\n+\n+    AdvertiseLocal(&peer_out);\n+\n+    // Without the fix peer_us:8333 ends up in vAddrToSend instead of the proper peer_us:bind_port.\n+    const CAddress expected{CService{peer_us_addr, bind_port}, NODE_NETWORK};\n+    BOOST_CHECK(std::any_of(peer_out.vAddrToSend.begin(), peer_out.vAddrToSend.end(),\n+                            [&expected](const CAddress& cur) { return cur == expected; }));\n+\n+    // Create a peer with a routable IPv4 address (inbound).\n+    in_addr peer_in_in_addr;\n+    peer_in_in_addr.s_addr = htonl(0x05060708);\n+    CNode peer_in{0,\n+                  NODE_NETWORK,\n+                  0,\n+                  INVALID_SOCKET,\n+                  CAddress{CService{peer_in_in_addr, 8333}, NODE_NETWORK},\n+                  0,\n+                  0,\n+                  CAddress{},\n+                  std::string{},\n+                  ConnectionType::INBOUND};\n+    peer_in.fSuccessfullyConnected = true;\n+    peer_in.SetAddrLocal(peer_us);\n+\n+    AdvertiseLocal(&peer_in);\n+\n+    // Without the fix peer_us:8333 ends up in vAddrToSend instead of the proper\n+    // peer_us:peer_us.GetPort().\n+    BOOST_CHECK(std::any_of(peer_in.vAddrToSend.begin(), peer_in.vAddrToSend.end(),\n+                            [&peer_us](const CAddress& cur) { return cur == peer_us; }));\n+\n+    gArgs.ForceSetArg(\"-bind\", \"\");",
    "path": "src/test/net_tests.cpp",
    "position": null,
    "original_position": 131,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "e6c3de7178ff3e2b0961e71635729bbfe6784f1e",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "would be good to remove the global here, but that can be done in a follow-up",
    "created_at": "2020-10-21T14:48:49Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r509353895",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/509353895"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r509353895"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/509353895/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 757,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/509355760",
    "pull_request_review_id": 513764292,
    "id": 509355760,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTM1NTc2MA==",
    "diff_hunk": "@@ -769,4 +846,62 @@ BOOST_AUTO_TEST_CASE(PoissonNextSend)\n     g_mock_deterministic_tests = false;\n }\n \n+BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n+{\n+    // Pretend that we bound to this port.\n+    const uint16_t bind_port = 20001;\n+    gArgs.ForceSetArg(\"-bind\", strprintf(\"3.4.5.6:%u\", bind_port));\n+\n+    // Our address:port as seen from the peer.\n+    in_addr peer_us_addr;\n+    peer_us_addr.s_addr = htonl(0x02030405);\n+    const CAddress peer_us{CService{peer_us_addr, 20002}, NODE_NETWORK};\n+\n+    // Create a peer with a routable IPv4 address.\n+    in_addr peer_in_addr;\n+    peer_in_addr.s_addr = htonl(0x01020304);\n+    CNode peer{0,\n+               NODE_NETWORK,\n+               0,\n+               INVALID_SOCKET,\n+               CAddress{CService{peer_in_addr, 8333}, NODE_NETWORK},\n+               0,\n+               0,\n+               CAddress{},\n+               std::string{},\n+               ConnectionType::OUTBOUND_FULL_RELAY};\n+\n+    const uint64_t services{NODE_NETWORK | NODE_WITNESS};\n+    const int64_t time{0};\n+    // Our address, as seen from the peer.\n+    const CNetMsgMaker msg_maker{PROTOCOL_VERSION};\n+    const auto msg = msg_maker.Make(NetMsgType::VERSION, PROTOCOL_VERSION, services, time, peer_us);\n+\n+    CDataStream recv_stream{msg.data, SER_NETWORK, PROTOCOL_VERSION};\n+\n+    // Force CChainState::IsInitialBlockDownload() to return false.\n+    const auto nMinimumChainWork_orig = nMinimumChainWork;\n+    const auto nMaxTipAge_orig = nMaxTipAge;\n+    nMinimumChainWork = 0;\n+    nMaxTipAge = GetTime();",
    "path": "src/test/net_tests.cpp",
    "position": null,
    "original_position": 177,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "e6c3de7178ff3e2b0961e71635729bbfe6784f1e",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Can be written shorter\r\n\r\n```suggestion\r\n    generatetoaddress(m_node, ADDRESS_BCRT1_UNSPENDABLE);\r\n```",
    "created_at": "2020-10-21T14:51:02Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r509355760",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/509355760"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r509355760"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/509355760/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 883,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 887,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510003013",
    "pull_request_review_id": 514516183,
    "id": 510003013,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDAwMzAxMw==",
    "diff_hunk": "@@ -0,0 +1,76 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that the proper port is used for -externalip=\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal\n+\n+# We need to bind to a routable address for this test to exercise the relevant code.\n+# To set a routable IP address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up  # to set up\n+# ifconfig lo:0 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig lo0 1.1.1.1/32 alias  # to set up\n+# ifconfig lo0 1.1.1.1 -alias  # to remove it, after the test\n+addr = '1.1.1.1'\n+\n+# array of tuples [arguments, expected port in localaddresses]\n+expected = [\n+    [['-externalip=2.2.2.2',       '-port=20001'                               ], 20001],\n+    [['-externalip=2.2.2.2',       '-port=20002', '-bind={}'.format(addr)],       20002],\n+    [['-externalip=2.2.2.2',                      '-bind={}'.format(addr)],       11002],\n+    [['-externalip=2.2.2.2',       '-port=20003', '-bind={}:20004'.format(addr)], 20004],\n+    [['-externalip=2.2.2.2',                      '-bind={}:20005'.format(addr)], 20005],\n+    [['-externalip=2.2.2.2:20006', '-port=20007'                               ], 20006],\n+    [['-externalip=2.2.2.2:20008', '-port=20009', '-bind={}'.format(addr)],       20008],\n+    [['-externalip=2.2.2.2:20010',                '-bind={}'.format(addr)],       20010],\n+    [['-externalip=2.2.2.2:20011', '-port=20012', '-bind={}:20013'.format(addr)], 20011],\n+    [['-externalip=2.2.2.2:20014',                '-bind={}:20015'.format(addr)], 20014],\n+    [['-externalip=2.2.2.2',       '-port=20016', '-bind={}:20017'.format(addr),\n+                                             '-whitebind={}:20018'.format(addr)], 20017],\n+    [['-externalip=2.2.2.2',       '-port=20019',\n+                                             '-whitebind={}:20020'.format(addr)], 20020],\n+]\n+\n+class BindPortTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        # Avoid any -bind= on the command line. Force the framework to avoid adding -bind=127.0.0.1.\n+        self.setup_clean_chain = True\n+        self.bind_to_localhost_only = False\n+        self.num_nodes = len(expected)\n+\n+    def add_options(self, parser):\n+        parser.add_argument(\n+            \"--ihave1111\", action='store_true', dest=\"ihave1111\",\n+            help=\"Run the test, assuming {} is configured on the machine\".format(addr),\n+            default=False)\n+\n+    def setup_nodes(self):",
    "path": "test/functional/feature_bind_port_externalip.py",
    "position": null,
    "original_position": 53,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "e6c3de7178ff3e2b0961e71635729bbfe6784f1e",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`raise SkipTest()` is not the main reason to override `setup_nodes()`. It is necessary to specify the command line arguments for each bitcoind node. The current test does that by `self.add_nodes(..., extra_args=my_variable_here)` in `setup_nodes()`. Other tests do that either in `setup_nodes()` or `setup_network()`.\r\n\r\nIs there a better way?",
    "created_at": "2020-10-22T09:09:43Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510003013",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510003013"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510003013"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510003013/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 53,
    "side": "RIGHT",
    "in_reply_to_id": 509350641
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510005534",
    "pull_request_review_id": 514519379,
    "id": 510005534,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDAwNTUzNA==",
    "diff_hunk": "@@ -0,0 +1,76 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that the proper port is used for -externalip=\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal\n+\n+# We need to bind to a routable address for this test to exercise the relevant code.\n+# To set a routable IP address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up  # to set up\n+# ifconfig lo:0 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig lo0 1.1.1.1/32 alias  # to set up\n+# ifconfig lo0 1.1.1.1 -alias  # to remove it, after the test\n+addr = '1.1.1.1'\n+\n+# array of tuples [arguments, expected port in localaddresses]\n+expected = [\n+    [['-externalip=2.2.2.2',       '-port=20001'                               ], 20001],\n+    [['-externalip=2.2.2.2',       '-port=20002', '-bind={}'.format(addr)],       20002],\n+    [['-externalip=2.2.2.2',                      '-bind={}'.format(addr)],       11002],\n+    [['-externalip=2.2.2.2',       '-port=20003', '-bind={}:20004'.format(addr)], 20004],\n+    [['-externalip=2.2.2.2',                      '-bind={}:20005'.format(addr)], 20005],\n+    [['-externalip=2.2.2.2:20006', '-port=20007'                               ], 20006],\n+    [['-externalip=2.2.2.2:20008', '-port=20009', '-bind={}'.format(addr)],       20008],\n+    [['-externalip=2.2.2.2:20010',                '-bind={}'.format(addr)],       20010],\n+    [['-externalip=2.2.2.2:20011', '-port=20012', '-bind={}:20013'.format(addr)], 20011],\n+    [['-externalip=2.2.2.2:20014',                '-bind={}:20015'.format(addr)], 20014],\n+    [['-externalip=2.2.2.2',       '-port=20016', '-bind={}:20017'.format(addr),\n+                                             '-whitebind={}:20018'.format(addr)], 20017],\n+    [['-externalip=2.2.2.2',       '-port=20019',\n+                                             '-whitebind={}:20020'.format(addr)], 20020],\n+]\n+\n+class BindPortTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        # Avoid any -bind= on the command line. Force the framework to avoid adding -bind=127.0.0.1.\n+        self.setup_clean_chain = True\n+        self.bind_to_localhost_only = False\n+        self.num_nodes = len(expected)\n+\n+    def add_options(self, parser):\n+        parser.add_argument(\n+            \"--ihave1111\", action='store_true', dest=\"ihave1111\",\n+            help=\"Run the test, assuming {} is configured on the machine\".format(addr),\n+            default=False)\n+\n+    def setup_nodes(self):\n+        if not self.options.ihave1111:\n+            raise SkipTest(\n+                \"To run this test make sure that {} (a routable address) is assigned \"\n+                \"to one of the interfaces on this machine and rerun with --ihave1111\".format(addr))\n+        args = []\n+        for t in expected:\n+            args.append(t[0])\n+        self.add_nodes(self.num_nodes, extra_args=args)\n+        self.start_nodes()\n+\n+    def run_test(self):\n+        for i in range(len(expected)):\n+            expected_port = expected[i][1]\n+            found = False\n+            for local in self.nodes[i].getnetworkinfo()['localaddresses']:\n+                if local['address'] == '2.2.2.2':\n+                    assert_equal(local['port'], expected_port)\n+                    found = True\n+                    break\n+            assert(found)",
    "path": "test/functional/feature_bind_port_externalip.py",
    "position": null,
    "original_position": 73,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "e6c3de7178ff3e2b0961e71635729bbfe6784f1e",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "To me that is less readable. Maybe my python level is poor, but then maybe other readers of this are also poor pythoners. I prefer to keep it simple stupid:\r\n```\r\nfor ...\r\n    if ...\r\n        break\r\n```\r\nthat is nearly the same in any programming language.",
    "created_at": "2020-10-22T09:13:22Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510005534",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510005534"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510005534"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510005534/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 67,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 72,
    "side": "RIGHT",
    "in_reply_to_id": 509346608
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510047632",
    "pull_request_review_id": 514574602,
    "id": 510047632,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDA0NzYzMg==",
    "diff_hunk": "@@ -769,4 +846,62 @@ BOOST_AUTO_TEST_CASE(PoissonNextSend)\n     g_mock_deterministic_tests = false;\n }\n \n+BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n+{\n+    // Pretend that we bound to this port.\n+    const uint16_t bind_port = 20001;\n+    gArgs.ForceSetArg(\"-bind\", strprintf(\"3.4.5.6:%u\", bind_port));\n+\n+    // Our address:port as seen from the peer.\n+    in_addr peer_us_addr;\n+    peer_us_addr.s_addr = htonl(0x02030405);\n+    const CAddress peer_us{CService{peer_us_addr, 20002}, NODE_NETWORK};\n+\n+    // Create a peer with a routable IPv4 address.\n+    in_addr peer_in_addr;\n+    peer_in_addr.s_addr = htonl(0x01020304);\n+    CNode peer{0,\n+               NODE_NETWORK,\n+               0,\n+               INVALID_SOCKET,\n+               CAddress{CService{peer_in_addr, 8333}, NODE_NETWORK},\n+               0,\n+               0,\n+               CAddress{},\n+               std::string{},\n+               ConnectionType::OUTBOUND_FULL_RELAY};\n+\n+    const uint64_t services{NODE_NETWORK | NODE_WITNESS};\n+    const int64_t time{0};\n+    // Our address, as seen from the peer.\n+    const CNetMsgMaker msg_maker{PROTOCOL_VERSION};\n+    const auto msg = msg_maker.Make(NetMsgType::VERSION, PROTOCOL_VERSION, services, time, peer_us);\n+\n+    CDataStream recv_stream{msg.data, SER_NETWORK, PROTOCOL_VERSION};\n+\n+    // Force CChainState::IsInitialBlockDownload() to return false.\n+    const auto nMinimumChainWork_orig = nMinimumChainWork;\n+    const auto nMaxTipAge_orig = nMaxTipAge;\n+    nMinimumChainWork = 0;\n+    nMaxTipAge = GetTime();",
    "path": "src/test/net_tests.cpp",
    "position": null,
    "original_position": 177,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "e6c3de7178ff3e2b0961e71635729bbfe6784f1e",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`CChainState::IsInitialBlockDownload()` still returns `true` :/\r\n\r\n(it was necessary to `s/TestingSetup/RegTestingSetup/` in `BOOST_FIXTURE_TEST_SUITE()` in order to get `generatetoaddress()` to accept `ADDRESS_BCRT1_UNSPENDABLE`)",
    "created_at": "2020-10-22T10:19:39Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510047632",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510047632"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510047632"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510047632/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 883,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 887,
    "side": "RIGHT",
    "in_reply_to_id": 509355760
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510065599",
    "pull_request_review_id": 514598275,
    "id": 510065599,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDA2NTU5OQ==",
    "diff_hunk": "@@ -0,0 +1,76 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that the proper port is used for -externalip=\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal\n+\n+# We need to bind to a routable address for this test to exercise the relevant code.\n+# To set a routable IP address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up  # to set up\n+# ifconfig lo:0 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig lo0 1.1.1.1/32 alias  # to set up\n+# ifconfig lo0 1.1.1.1 -alias  # to remove it, after the test\n+addr = '1.1.1.1'\n+\n+# array of tuples [arguments, expected port in localaddresses]\n+expected = [\n+    [['-externalip=2.2.2.2',       '-port=20001'                               ], 20001],\n+    [['-externalip=2.2.2.2',       '-port=20002', '-bind={}'.format(addr)],       20002],\n+    [['-externalip=2.2.2.2',                      '-bind={}'.format(addr)],       11002],\n+    [['-externalip=2.2.2.2',       '-port=20003', '-bind={}:20004'.format(addr)], 20004],\n+    [['-externalip=2.2.2.2',                      '-bind={}:20005'.format(addr)], 20005],\n+    [['-externalip=2.2.2.2:20006', '-port=20007'                               ], 20006],\n+    [['-externalip=2.2.2.2:20008', '-port=20009', '-bind={}'.format(addr)],       20008],\n+    [['-externalip=2.2.2.2:20010',                '-bind={}'.format(addr)],       20010],\n+    [['-externalip=2.2.2.2:20011', '-port=20012', '-bind={}:20013'.format(addr)], 20011],\n+    [['-externalip=2.2.2.2:20014',                '-bind={}:20015'.format(addr)], 20014],\n+    [['-externalip=2.2.2.2',       '-port=20016', '-bind={}:20017'.format(addr),\n+                                             '-whitebind={}:20018'.format(addr)], 20017],\n+    [['-externalip=2.2.2.2',       '-port=20019',\n+                                             '-whitebind={}:20020'.format(addr)], 20020],\n+]\n+\n+class BindPortTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        # Avoid any -bind= on the command line. Force the framework to avoid adding -bind=127.0.0.1.\n+        self.setup_clean_chain = True\n+        self.bind_to_localhost_only = False\n+        self.num_nodes = len(expected)\n+\n+    def add_options(self, parser):\n+        parser.add_argument(\n+            \"--ihave1111\", action='store_true', dest=\"ihave1111\",\n+            help=\"Run the test, assuming {} is configured on the machine\".format(addr),\n+            default=False)\n+\n+    def setup_nodes(self):",
    "path": "test/functional/feature_bind_port_externalip.py",
    "position": null,
    "original_position": 53,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "e6c3de7178ff3e2b0961e71635729bbfe6784f1e",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Set `self.extra_args = ...`?",
    "created_at": "2020-10-22T10:51:21Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510065599",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510065599"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510065599"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510065599/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 53,
    "side": "RIGHT",
    "in_reply_to_id": 509350641
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510081932",
    "pull_request_review_id": 514619495,
    "id": 510081932,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDA4MTkzMg==",
    "diff_hunk": "@@ -0,0 +1,76 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that the proper port is used for -externalip=\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal\n+\n+# We need to bind to a routable address for this test to exercise the relevant code.\n+# To set a routable IP address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up  # to set up\n+# ifconfig lo:0 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig lo0 1.1.1.1/32 alias  # to set up\n+# ifconfig lo0 1.1.1.1 -alias  # to remove it, after the test\n+addr = '1.1.1.1'\n+\n+# array of tuples [arguments, expected port in localaddresses]\n+expected = [\n+    [['-externalip=2.2.2.2',       '-port=20001'                               ], 20001],\n+    [['-externalip=2.2.2.2',       '-port=20002', '-bind={}'.format(addr)],       20002],\n+    [['-externalip=2.2.2.2',                      '-bind={}'.format(addr)],       11002],\n+    [['-externalip=2.2.2.2',       '-port=20003', '-bind={}:20004'.format(addr)], 20004],\n+    [['-externalip=2.2.2.2',                      '-bind={}:20005'.format(addr)], 20005],\n+    [['-externalip=2.2.2.2:20006', '-port=20007'                               ], 20006],\n+    [['-externalip=2.2.2.2:20008', '-port=20009', '-bind={}'.format(addr)],       20008],\n+    [['-externalip=2.2.2.2:20010',                '-bind={}'.format(addr)],       20010],\n+    [['-externalip=2.2.2.2:20011', '-port=20012', '-bind={}:20013'.format(addr)], 20011],\n+    [['-externalip=2.2.2.2:20014',                '-bind={}:20015'.format(addr)], 20014],\n+    [['-externalip=2.2.2.2',       '-port=20016', '-bind={}:20017'.format(addr),\n+                                             '-whitebind={}:20018'.format(addr)], 20017],\n+    [['-externalip=2.2.2.2',       '-port=20019',\n+                                             '-whitebind={}:20020'.format(addr)], 20020],\n+]\n+\n+class BindPortTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        # Avoid any -bind= on the command line. Force the framework to avoid adding -bind=127.0.0.1.\n+        self.setup_clean_chain = True\n+        self.bind_to_localhost_only = False\n+        self.num_nodes = len(expected)\n+\n+    def add_options(self, parser):\n+        parser.add_argument(\n+            \"--ihave1111\", action='store_true', dest=\"ihave1111\",\n+            help=\"Run the test, assuming {} is configured on the machine\".format(addr),\n+            default=False)\n+\n+    def setup_nodes(self):",
    "path": "test/functional/feature_bind_port_externalip.py",
    "position": null,
    "original_position": 53,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "e6c3de7178ff3e2b0961e71635729bbfe6784f1e",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Indeed! Changed, thanks for the suggestion!",
    "created_at": "2020-10-22T11:21:51Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510081932",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510081932"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510081932"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510081932/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 53,
    "side": "RIGHT",
    "in_reply_to_id": 509350641
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510082073",
    "pull_request_review_id": 514619723,
    "id": 510082073,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDA4MjA3Mw==",
    "diff_hunk": "@@ -0,0 +1,76 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that the proper port is used for -externalip=\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal\n+\n+# We need to bind to a routable address for this test to exercise the relevant code.\n+# To set a routable IP address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up  # to set up\n+# ifconfig lo:0 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig lo0 1.1.1.1/32 alias  # to set up\n+# ifconfig lo0 1.1.1.1 -alias  # to remove it, after the test\n+addr = '1.1.1.1'\n+\n+# array of tuples [arguments, expected port in localaddresses]\n+expected = [",
    "path": "test/functional/feature_bind_port_externalip.py",
    "position": null,
    "original_position": 23,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "e6c3de7178ff3e2b0961e71635729bbfe6784f1e",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Changed",
    "created_at": "2020-10-22T11:22:11Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510082073",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510082073"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510082073"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510082073/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 23,
    "side": "RIGHT",
    "in_reply_to_id": 509350836
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510082162",
    "pull_request_review_id": 514619827,
    "id": 510082162,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDA4MjE2Mg==",
    "diff_hunk": "@@ -1944,11 +1942,15 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n     connOptions.nMaxOutboundLimit = nMaxOutboundLimit;\n     connOptions.m_peer_connect_timeout = peer_connect_timeout;\n \n+    // Port to bind to if `-bind=addr` is provided without a `:port` suffix.\n+    const uint16_t default_bind_port =\n+        static_cast<uint16_t>(gArgs.GetArg(\"-port\", Params().GetDefaultPort()));",
    "path": "src/init.cpp",
    "position": null,
    "original_position": 15,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "e6c3de7178ff3e2b0961e71635729bbfe6784f1e",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Changed",
    "created_at": "2020-10-22T11:22:22Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510082162",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510082162"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510082162"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510082162/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1947,
    "side": "RIGHT",
    "in_reply_to_id": 509351706
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510082566",
    "pull_request_review_id": 514620361,
    "id": 510082566,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDA4MjU2Ng==",
    "diff_hunk": "@@ -677,8 +682,80 @@ BOOST_AUTO_TEST_CASE(ipv4_peer_with_ipv6_addrMe_test)\n \n     // suppress no-checks-run warning; if this test fails, it's by triggering a sanitizer\n     BOOST_CHECK(1);\n+\n+    // Cleanup, so that we don't confuse other tests.\n+    {\n+        LOCK(cs_mapLocalHost);\n+        mapLocalHost.erase(addr_in_mapLocalHost);\n+    }\n }\n \n+BOOST_AUTO_TEST_CASE(advertise_local_port)\n+{\n+    // Test that AdvertiseLocal() properly self-advertises us:\n+    //\n+    // 1. AdvertiseLocal() calls GetLocalAddress() which returns an address that is not routable.\n+    // 2. AdvertiseLocal() overrides the address with whatever the peer has told us he sees us as.\n+    // 2.1. For inbound connections we must override both the address and the port.\n+    // 2.2. For outbound connections we must override only the address.\n+\n+    // Pretend that we bound to this port.\n+    const uint16_t bind_port = 20001;\n+    gArgs.ForceSetArg(\"-bind\", strprintf(\"3.4.5.6:%u\", bind_port));\n+\n+    // Our address:port as seen from the peer.\n+    in_addr peer_us_addr;\n+    peer_us_addr.s_addr = htonl(0x02030405);\n+    const CAddress peer_us{CService{peer_us_addr, 20002}, NODE_NETWORK};\n+\n+    // Create a peer with a routable IPv4 address (outbound).\n+    in_addr peer_out_in_addr;\n+    peer_out_in_addr.s_addr = htonl(0x01020304);\n+    CNode peer_out{0,\n+                   NODE_NETWORK,\n+                   0,\n+                   INVALID_SOCKET,\n+                   CAddress{CService{peer_out_in_addr, 8333}, NODE_NETWORK},\n+                   0,\n+                   0,\n+                   CAddress{},\n+                   std::string{},\n+                   ConnectionType::OUTBOUND_FULL_RELAY};\n+    peer_out.fSuccessfullyConnected = true;\n+    peer_out.SetAddrLocal(peer_us);\n+\n+    AdvertiseLocal(&peer_out);\n+\n+    // Without the fix peer_us:8333 ends up in vAddrToSend instead of the proper peer_us:bind_port.\n+    const CAddress expected{CService{peer_us_addr, bind_port}, NODE_NETWORK};\n+    BOOST_CHECK(std::any_of(peer_out.vAddrToSend.begin(), peer_out.vAddrToSend.end(),\n+                            [&expected](const CAddress& cur) { return cur == expected; }));\n+\n+    // Create a peer with a routable IPv4 address (inbound).\n+    in_addr peer_in_in_addr;\n+    peer_in_in_addr.s_addr = htonl(0x05060708);\n+    CNode peer_in{0,\n+                  NODE_NETWORK,\n+                  0,\n+                  INVALID_SOCKET,\n+                  CAddress{CService{peer_in_in_addr, 8333}, NODE_NETWORK},\n+                  0,\n+                  0,\n+                  CAddress{},\n+                  std::string{},\n+                  ConnectionType::INBOUND};\n+    peer_in.fSuccessfullyConnected = true;\n+    peer_in.SetAddrLocal(peer_us);\n+\n+    AdvertiseLocal(&peer_in);\n+\n+    // Without the fix peer_us:8333 ends up in vAddrToSend instead of the proper\n+    // peer_us:peer_us.GetPort().\n+    BOOST_CHECK(std::any_of(peer_in.vAddrToSend.begin(), peer_in.vAddrToSend.end(),\n+                            [&peer_us](const CAddress& cur) { return cur == peer_us; }));\n+\n+    gArgs.ForceSetArg(\"-bind\", \"\");",
    "path": "src/test/net_tests.cpp",
    "position": null,
    "original_position": 131,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "e6c3de7178ff3e2b0961e71635729bbfe6784f1e",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Changed to `m_node.args->ForceSetArg(\"-bind\", \"\");`",
    "created_at": "2020-10-22T11:23:10Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510082566",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510082566"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510082566"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510082566/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 757,
    "side": "RIGHT",
    "in_reply_to_id": 509353895
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510090395",
    "pull_request_review_id": 514630626,
    "id": 510090395,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDA5MDM5NQ==",
    "diff_hunk": "@@ -769,4 +846,62 @@ BOOST_AUTO_TEST_CASE(PoissonNextSend)\n     g_mock_deterministic_tests = false;\n }\n \n+BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n+{\n+    // Pretend that we bound to this port.\n+    const uint16_t bind_port = 20001;\n+    gArgs.ForceSetArg(\"-bind\", strprintf(\"3.4.5.6:%u\", bind_port));\n+\n+    // Our address:port as seen from the peer.\n+    in_addr peer_us_addr;\n+    peer_us_addr.s_addr = htonl(0x02030405);\n+    const CAddress peer_us{CService{peer_us_addr, 20002}, NODE_NETWORK};\n+\n+    // Create a peer with a routable IPv4 address.\n+    in_addr peer_in_addr;\n+    peer_in_addr.s_addr = htonl(0x01020304);\n+    CNode peer{0,\n+               NODE_NETWORK,\n+               0,\n+               INVALID_SOCKET,\n+               CAddress{CService{peer_in_addr, 8333}, NODE_NETWORK},\n+               0,\n+               0,\n+               CAddress{},\n+               std::string{},\n+               ConnectionType::OUTBOUND_FULL_RELAY};\n+\n+    const uint64_t services{NODE_NETWORK | NODE_WITNESS};\n+    const int64_t time{0};\n+    // Our address, as seen from the peer.\n+    const CNetMsgMaker msg_maker{PROTOCOL_VERSION};\n+    const auto msg = msg_maker.Make(NetMsgType::VERSION, PROTOCOL_VERSION, services, time, peer_us);\n+\n+    CDataStream recv_stream{msg.data, SER_NETWORK, PROTOCOL_VERSION};\n+\n+    // Force CChainState::IsInitialBlockDownload() to return false.\n+    const auto nMinimumChainWork_orig = nMinimumChainWork;\n+    const auto nMaxTipAge_orig = nMaxTipAge;\n+    nMinimumChainWork = 0;\n+    nMaxTipAge = GetTime();",
    "path": "src/test/net_tests.cpp",
    "position": null,
    "original_position": 177,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "e6c3de7178ff3e2b0961e71635729bbfe6784f1e",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Oh, sorry my bad. The mined block will have the timestamp of genesis (plus one), so the time is still too far back.\r\n\r\nAn alternative would be to use mocktime, also ugly, but less LOC.\r\n\r\n```diff\r\ndiff --git a/src/test/net_tests.cpp b/src/test/net_tests.cpp\r\nindex 9519f3fd0c..7e77b758b2 100644\r\n--- a/src/test/net_tests.cpp\r\n+++ b/src/test/net_tests.cpp\r\n@@ -88,7 +88,7 @@ static CDataStream AddrmanToStream(CAddrManSerializationMock& _addrman)\r\n     return CDataStream(vchData, SER_DISK, CLIENT_VERSION);\r\n }\r\n \r\n-BOOST_FIXTURE_TEST_SUITE(net_tests, TestingSetup)\r\n+BOOST_FIXTURE_TEST_SUITE(net_tests, RegTestingSetup)\r\n \r\n BOOST_AUTO_TEST_CASE(cnode_listen_port)\r\n {\r\n@@ -879,11 +879,10 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\r\n \r\n     CDataStream recv_stream{msg.data, SER_NETWORK, PROTOCOL_VERSION};\r\n \r\n-    // Force CChainState::IsInitialBlockDownload() to return false.\r\n-    const auto nMinimumChainWork_orig = nMinimumChainWork;\r\n-    const auto nMaxTipAge_orig = nMaxTipAge;\r\n-    nMinimumChainWork = 0;\r\n-    nMaxTipAge = GetTime();\r\n+    // Force CChainState::IsInitialBlockDownload() to return false, otherwise PushAddress isn't called\r\n+    SetMockTime(1);\r\n+    BOOST_REQUIRE(!m_node.chainman->ActiveChainstate().IsInitialBlockDownload());\r\n+    SetMockTime(0);\r\n \r\n     m_node.peerman->InitializeNode(&peer);\r\n \r\n@@ -898,9 +897,6 @@ BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\r\n     BOOST_CHECK(std::any_of(peer.vAddrToSend.begin(), peer.vAddrToSend.end(),\r\n                             [&expected](const CAddress& cur) { return cur == expected; }));\r\n \r\n-    nMinimumChainWork = nMinimumChainWork_orig;\r\n-    nMaxTipAge = nMaxTipAge_orig;\r\n-\r\n     gArgs.ForceSetArg(\"-bind\", \"\");\r\n }\r\n \r\n",
    "created_at": "2020-10-22T11:37:39Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510090395",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510090395"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510090395"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510090395/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 883,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 887,
    "side": "RIGHT",
    "in_reply_to_id": 509355760
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510093818",
    "pull_request_review_id": 514634989,
    "id": 510093818,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDA5MzgxOA==",
    "diff_hunk": "@@ -0,0 +1,75 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that -discover does not add all intefaces' addresses if we listen just on some\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal\n+\n+# We need to bind to a routable address for this test to exercise the relevant code\n+# and also must have another routable address on another interface which must not\n+# be named \"lo\" or \"lo0\".\n+# To set a routable address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up && ifconfig lo:1 2.2.2.2/32 up  # to set up\n+# ifconfig lo:0 down && ifconfig lo:1 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig em0 1.1.1.1/32 alias && ifconfig wlan0 2.2.2.2/32 alias  # to set up\n+# ifconfig em0 1.1.1.1 -alias && ifconfig wlan0 2.2.2.2 -alias  # to remove it, after the test\n+ADDR1 = '1.1.1.1'\n+ADDR2 = '2.2.2.2'\n+\n+BIND_PORT = 20001;\n+\n+class BindPortDiscoverTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        # Avoid any -bind= on the command line. Force the framework to avoid adding -bind=127.0.0.1.\n+        self.setup_clean_chain = True\n+        self.bind_to_localhost_only = False\n+        self.num_nodes = 2\n+\n+    def add_options(self, parser):\n+        parser.add_argument(\n+            \"--ihave1111and2222\", action='store_true', dest=\"ihave1111and2222\",\n+            help=\"Run the test, assuming {} and {} are configured on the machine\".format(ADDR1, ADDR2),\n+            default=False)\n+\n+    def setup_nodes(self):\n+        if not self.options.ihave1111and2222:\n+            raise SkipTest(",
    "path": "test/functional/feature_bind_port_discover.py",
    "position": 46,
    "original_position": 42,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "1ae0d404f8ace0312c2b8dcd5e5bcb6af1e844d8",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "same feedback here ;)",
    "created_at": "2020-10-22T11:43:54Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510093818",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510093818"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510093818"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510093818/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 46,
    "original_line": 46,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510123145",
    "pull_request_review_id": 514673816,
    "id": 510123145,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDEyMzE0NQ==",
    "diff_hunk": "@@ -0,0 +1,75 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that -discover does not add all intefaces' addresses if we listen just on some\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal\n+\n+# We need to bind to a routable address for this test to exercise the relevant code\n+# and also must have another routable address on another interface which must not\n+# be named \"lo\" or \"lo0\".\n+# To set a routable address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up && ifconfig lo:1 2.2.2.2/32 up  # to set up\n+# ifconfig lo:0 down && ifconfig lo:1 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig em0 1.1.1.1/32 alias && ifconfig wlan0 2.2.2.2/32 alias  # to set up\n+# ifconfig em0 1.1.1.1 -alias && ifconfig wlan0 2.2.2.2 -alias  # to remove it, after the test\n+ADDR1 = '1.1.1.1'\n+ADDR2 = '2.2.2.2'\n+\n+BIND_PORT = 20001;\n+\n+class BindPortDiscoverTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        # Avoid any -bind= on the command line. Force the framework to avoid adding -bind=127.0.0.1.\n+        self.setup_clean_chain = True\n+        self.bind_to_localhost_only = False\n+        self.num_nodes = 2\n+\n+    def add_options(self, parser):\n+        parser.add_argument(\n+            \"--ihave1111and2222\", action='store_true', dest=\"ihave1111and2222\",\n+            help=\"Run the test, assuming {} and {} are configured on the machine\".format(ADDR1, ADDR2),\n+            default=False)\n+\n+    def setup_nodes(self):\n+        if not self.options.ihave1111and2222:\n+            raise SkipTest(",
    "path": "test/functional/feature_bind_port_discover.py",
    "position": 46,
    "original_position": 42,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "1ae0d404f8ace0312c2b8dcd5e5bcb6af1e844d8",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Changed",
    "created_at": "2020-10-22T12:33:40Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510123145",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510123145"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510123145"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510123145/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 46,
    "original_line": 46,
    "side": "RIGHT",
    "in_reply_to_id": 510093818
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510123549",
    "pull_request_review_id": 514674346,
    "id": 510123549,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDEyMzU0OQ==",
    "diff_hunk": "@@ -769,4 +846,62 @@ BOOST_AUTO_TEST_CASE(PoissonNextSend)\n     g_mock_deterministic_tests = false;\n }\n \n+BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n+{\n+    // Pretend that we bound to this port.\n+    const uint16_t bind_port = 20001;\n+    gArgs.ForceSetArg(\"-bind\", strprintf(\"3.4.5.6:%u\", bind_port));\n+\n+    // Our address:port as seen from the peer.\n+    in_addr peer_us_addr;\n+    peer_us_addr.s_addr = htonl(0x02030405);\n+    const CAddress peer_us{CService{peer_us_addr, 20002}, NODE_NETWORK};\n+\n+    // Create a peer with a routable IPv4 address.\n+    in_addr peer_in_addr;\n+    peer_in_addr.s_addr = htonl(0x01020304);\n+    CNode peer{0,\n+               NODE_NETWORK,\n+               0,\n+               INVALID_SOCKET,\n+               CAddress{CService{peer_in_addr, 8333}, NODE_NETWORK},\n+               0,\n+               0,\n+               CAddress{},\n+               std::string{},\n+               ConnectionType::OUTBOUND_FULL_RELAY};\n+\n+    const uint64_t services{NODE_NETWORK | NODE_WITNESS};\n+    const int64_t time{0};\n+    // Our address, as seen from the peer.\n+    const CNetMsgMaker msg_maker{PROTOCOL_VERSION};\n+    const auto msg = msg_maker.Make(NetMsgType::VERSION, PROTOCOL_VERSION, services, time, peer_us);\n+\n+    CDataStream recv_stream{msg.data, SER_NETWORK, PROTOCOL_VERSION};\n+\n+    // Force CChainState::IsInitialBlockDownload() to return false.\n+    const auto nMinimumChainWork_orig = nMinimumChainWork;\n+    const auto nMaxTipAge_orig = nMaxTipAge;\n+    nMinimumChainWork = 0;\n+    nMaxTipAge = GetTime();",
    "path": "src/test/net_tests.cpp",
    "position": null,
    "original_position": 177,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "e6c3de7178ff3e2b0961e71635729bbfe6784f1e",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Changed, less LOC. Thanks!",
    "created_at": "2020-10-22T12:34:20Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510123549",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510123549"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510123549"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510123549/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 883,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 887,
    "side": "RIGHT",
    "in_reply_to_id": 509355760
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510889053",
    "pull_request_review_id": 515673544,
    "id": 510889053,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDg4OTA1Mw==",
    "diff_hunk": "@@ -0,0 +1,72 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that the proper port is used for -externalip=\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal\n+\n+# We need to bind to a routable address for this test to exercise the relevant code.\n+# To set a routable address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up  # to set up\n+# ifconfig lo:0 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig lo0 1.1.1.1/32 alias  # to set up\n+# ifconfig lo0 1.1.1.1 -alias  # to remove it, after the test\n+ADDR = '1.1.1.1'\n+\n+# array of tuples [arguments, expected port in localaddresses]\n+EXPECTED = [\n+    [['-externalip=2.2.2.2',       '-port=20001'                               ], 20001],",
    "path": "test/functional/feature_bind_port_externalip.py",
    "position": null,
    "original_position": 24,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "053ba089fca3e41bf815ac16346352fd7e1eb69d",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The ports used better not be hardcoded but derived from `p2p_port()` in order not to clash with other tests that may be running on the system at the same time.",
    "created_at": "2020-10-23T13:37:10Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510889053",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510889053"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510889053"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510889053/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 24,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510908676",
    "pull_request_review_id": 515700325,
    "id": 510908676,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMDkwODY3Ng==",
    "diff_hunk": "@@ -0,0 +1,72 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that the proper port is used for -externalip=\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal\n+\n+# We need to bind to a routable address for this test to exercise the relevant code.\n+# To set a routable address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up  # to set up\n+# ifconfig lo:0 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig lo0 1.1.1.1/32 alias  # to set up\n+# ifconfig lo0 1.1.1.1 -alias  # to remove it, after the test\n+ADDR = '1.1.1.1'\n+\n+# array of tuples [arguments, expected port in localaddresses]\n+EXPECTED = [\n+    [['-externalip=2.2.2.2',       '-port=20001'                               ], 20001],",
    "path": "test/functional/feature_bind_port_externalip.py",
    "position": null,
    "original_position": 24,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "053ba089fca3e41bf815ac16346352fd7e1eb69d",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Or you could start in a fresh range (ports that are not used by p2p or rpc in other tests)",
    "created_at": "2020-10-23T14:06:31Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510908676",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510908676"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r510908676"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/510908676/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 24,
    "side": "RIGHT",
    "in_reply_to_id": 510889053
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/545272234",
    "pull_request_review_id": 554831311,
    "id": 545272234,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0NTI3MjIzNA==",
    "diff_hunk": "@@ -0,0 +1,72 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that the proper port is used for -externalip=\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal\n+\n+# We need to bind to a routable address for this test to exercise the relevant code.\n+# To set a routable address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up  # to set up\n+# ifconfig lo:0 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig lo0 1.1.1.1/32 alias  # to set up\n+# ifconfig lo0 1.1.1.1 -alias  # to remove it, after the test\n+ADDR = '1.1.1.1'\n+\n+# array of tuples [arguments, expected port in localaddresses]\n+EXPECTED = [\n+    [['-externalip=2.2.2.2',       '-port=20001'                               ], 20001],",
    "path": "test/functional/feature_bind_port_externalip.py",
    "position": null,
    "original_position": 24,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "053ba089fca3e41bf815ac16346352fd7e1eb69d",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Changed to start in a fresh range from 30000 as that is the easiest (maximum that can be returned by `p2p_port()` or `rpc_port()` is `PORT_MIN + 2 * PORT_RANGE` which his `21000` :eyes:).",
    "created_at": "2020-12-17T17:33:41Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r545272234",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/545272234"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r545272234"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/545272234/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 24,
    "side": "RIGHT",
    "in_reply_to_id": 510889053
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/556430946",
    "pull_request_review_id": 567103762,
    "id": 556430946,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NjQzMDk0Ng==",
    "diff_hunk": "@@ -926,4 +1002,59 @@ BOOST_AUTO_TEST_CASE(node_eviction_test)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n+{\n+    // Pretend that we bound to this port.\n+    const uint16_t bind_port = 20001;\n+    m_node.args->ForceSetArg(\"-bind\", strprintf(\"3.4.5.6:%u\", bind_port));\n+\n+    // Our address:port as seen from the peer - 2.3.4.5:20002 (different from the above).\n+    in_addr peer_us_addr;\n+    peer_us_addr.s_addr = htonl(0x02030405);\n+    const CAddress peer_us{CService{peer_us_addr, 20002}, NODE_NETWORK};\n+\n+    // Create a peer with a routable IPv4 address.\n+    in_addr peer_in_addr;\n+    peer_in_addr.s_addr = htonl(0x01020304);\n+    CNode peer{0,\n+               NODE_NETWORK,\n+               0,\n+               INVALID_SOCKET,\n+               CAddress{CService{peer_in_addr, 8333}, NODE_NETWORK},\n+               0,\n+               0,\n+               CAddress{},\n+               std::string{},\n+               ConnectionType::OUTBOUND_FULL_RELAY};\n+\n+    const uint64_t services{NODE_NETWORK | NODE_WITNESS};\n+    const int64_t time{0};\n+    // Our address, as seen from the peer.\n+    const CNetMsgMaker msg_maker{PROTOCOL_VERSION};\n+    const auto msg = msg_maker.Make(NetMsgType::VERSION, PROTOCOL_VERSION, services, time, peer_us);\n+\n+    CDataStream recv_stream{msg.data, SER_NETWORK, PROTOCOL_VERSION};\n+\n+    // Force CChainState::IsInitialBlockDownload() to return false.\n+    // Otherwise PushAddress() isn't called by PeerManager::ProcessMessage().\n+    SetMockTime(1);\n+    BOOST_REQUIRE(!m_node.chainman->ActiveChainstate().IsInitialBlockDownload());\n+    SetMockTime(0);",
    "path": "src/test/net_tests.cpp",
    "position": null,
    "original_position": 172,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "3e55fbfe31e58619d8858399dea3bc3ef420b111",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: Might be possible to write, shorter, and to abstract away the inner workings of IsIbd\r\n\r\n```suggestion\r\nTestChainState& chainstate = *(TestChainState*)&m_node.chainman->ActiveChainstate();\r\nchainstate.JumpOutOfIbd();\r\n```",
    "created_at": "2021-01-13T10:52:22Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r556430946",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/556430946"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r556430946"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/556430946/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 1040,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 1042,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557380409",
    "pull_request_review_id": 568213153,
    "id": 557380409,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NzM4MDQwOQ==",
    "diff_hunk": "@@ -926,4 +1002,59 @@ BOOST_AUTO_TEST_CASE(node_eviction_test)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n+{\n+    // Pretend that we bound to this port.\n+    const uint16_t bind_port = 20001;\n+    m_node.args->ForceSetArg(\"-bind\", strprintf(\"3.4.5.6:%u\", bind_port));\n+\n+    // Our address:port as seen from the peer - 2.3.4.5:20002 (different from the above).\n+    in_addr peer_us_addr;\n+    peer_us_addr.s_addr = htonl(0x02030405);\n+    const CAddress peer_us{CService{peer_us_addr, 20002}, NODE_NETWORK};\n+\n+    // Create a peer with a routable IPv4 address.\n+    in_addr peer_in_addr;\n+    peer_in_addr.s_addr = htonl(0x01020304);\n+    CNode peer{0,\n+               NODE_NETWORK,\n+               0,\n+               INVALID_SOCKET,\n+               CAddress{CService{peer_in_addr, 8333}, NODE_NETWORK},\n+               0,\n+               0,\n+               CAddress{},\n+               std::string{},\n+               ConnectionType::OUTBOUND_FULL_RELAY};\n+\n+    const uint64_t services{NODE_NETWORK | NODE_WITNESS};\n+    const int64_t time{0};\n+    // Our address, as seen from the peer.\n+    const CNetMsgMaker msg_maker{PROTOCOL_VERSION};\n+    const auto msg = msg_maker.Make(NetMsgType::VERSION, PROTOCOL_VERSION, services, time, peer_us);\n+\n+    CDataStream recv_stream{msg.data, SER_NETWORK, PROTOCOL_VERSION};\n+\n+    // Force CChainState::IsInitialBlockDownload() to return false.\n+    // Otherwise PushAddress() isn't called by PeerManager::ProcessMessage().\n+    SetMockTime(1);\n+    BOOST_REQUIRE(!m_node.chainman->ActiveChainstate().IsInitialBlockDownload());\n+    SetMockTime(0);",
    "path": "src/test/net_tests.cpp",
    "position": null,
    "original_position": 172,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "3e55fbfe31e58619d8858399dea3bc3ef420b111",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done. This cast to a class which it actually is not looks quite hackish.",
    "created_at": "2021-01-14T13:05:53Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r557380409",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557380409"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r557380409"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557380409/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 1040,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 1042,
    "side": "RIGHT",
    "in_reply_to_id": 556430946
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559180800",
    "pull_request_review_id": 570056925,
    "id": 559180800,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1OTE4MDgwMA==",
    "diff_hunk": "@@ -929,4 +1004,57 @@ BOOST_AUTO_TEST_CASE(node_eviction_test)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n+{\n+    // Pretend that we bound to this port.\n+    const uint16_t bind_port = 20001;\n+    m_node.args->ForceSetArg(\"-bind\", strprintf(\"3.4.5.6:%u\", bind_port));\n+\n+    // Our address:port as seen from the peer - 2.3.4.5:20002 (different from the above).\n+    in_addr peer_us_addr;\n+    peer_us_addr.s_addr = htonl(0x02030405);\n+    const CAddress peer_us{CService{peer_us_addr, 20002}, NODE_NETWORK};\n+\n+    // Create a peer with a routable IPv4 address.\n+    in_addr peer_in_addr;\n+    peer_in_addr.s_addr = htonl(0x01020304);\n+    CNode peer{0,\n+               NODE_NETWORK,\n+               INVALID_SOCKET,\n+               CAddress{CService{peer_in_addr, 8333}, NODE_NETWORK},\n+               0,\n+               0,\n+               CAddress{},\n+               std::string{},\n+               ConnectionType::OUTBOUND_FULL_RELAY};\n+\n+    const uint64_t services{NODE_NETWORK | NODE_WITNESS};\n+    const int64_t time{0};\n+    // Our address, as seen from the peer.\n+    const CNetMsgMaker msg_maker{PROTOCOL_VERSION};\n+    const auto msg = msg_maker.Make(NetMsgType::VERSION, PROTOCOL_VERSION, services, time, peer_us);\n+\n+    CDataStream recv_stream{msg.data, SER_NETWORK, PROTOCOL_VERSION};\n+\n+    // Force CChainState::IsInitialBlockDownload() to return false.\n+    // Otherwise PushAddress() isn't called by PeerManager::ProcessMessage().\n+    TestChainState& chainstate = *(TestChainState*)&m_node.chainman->ActiveChainstate();\n+    chainstate.JumpOutOfIbd();\n+\n+    m_node.peerman->InitializeNode(&peer);\n+\n+    std::atomic<bool> interrupt_dummy{false};\n+    std::chrono::microseconds time_received_dummy{0};\n+\n+    m_node.peerman->ProcessMessage(peer, NetMsgType::VERSION, recv_stream, time_received_dummy,\n+                                   interrupt_dummy);",
    "path": "src/test/net_tests.cpp",
    "position": null,
    "original_position": 179,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "58755690a7e79e5ae4e3dcf1cba3dc0d28dfa3cd",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I presume this line will make appveyor etc fail if the test process isn't restarted in between test cases.",
    "created_at": "2021-01-17T13:21:04Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r559180800",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559180800"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r559180800"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559180800/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 960,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559181011",
    "pull_request_review_id": 570057077,
    "id": 559181011,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1OTE4MTAxMQ==",
    "diff_hunk": "@@ -929,4 +1004,57 @@ BOOST_AUTO_TEST_CASE(node_eviction_test)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n+{\n+    // Pretend that we bound to this port.\n+    const uint16_t bind_port = 20001;\n+    m_node.args->ForceSetArg(\"-bind\", strprintf(\"3.4.5.6:%u\", bind_port));\n+\n+    // Our address:port as seen from the peer - 2.3.4.5:20002 (different from the above).\n+    in_addr peer_us_addr;\n+    peer_us_addr.s_addr = htonl(0x02030405);\n+    const CAddress peer_us{CService{peer_us_addr, 20002}, NODE_NETWORK};\n+\n+    // Create a peer with a routable IPv4 address.\n+    in_addr peer_in_addr;\n+    peer_in_addr.s_addr = htonl(0x01020304);\n+    CNode peer{0,\n+               NODE_NETWORK,\n+               INVALID_SOCKET,\n+               CAddress{CService{peer_in_addr, 8333}, NODE_NETWORK},\n+               0,\n+               0,\n+               CAddress{},\n+               std::string{},\n+               ConnectionType::OUTBOUND_FULL_RELAY};\n+\n+    const uint64_t services{NODE_NETWORK | NODE_WITNESS};\n+    const int64_t time{0};\n+    // Our address, as seen from the peer.\n+    const CNetMsgMaker msg_maker{PROTOCOL_VERSION};\n+    const auto msg = msg_maker.Make(NetMsgType::VERSION, PROTOCOL_VERSION, services, time, peer_us);\n+\n+    CDataStream recv_stream{msg.data, SER_NETWORK, PROTOCOL_VERSION};\n+\n+    // Force CChainState::IsInitialBlockDownload() to return false.\n+    // Otherwise PushAddress() isn't called by PeerManager::ProcessMessage().\n+    TestChainState& chainstate = *(TestChainState*)&m_node.chainman->ActiveChainstate();\n+    chainstate.JumpOutOfIbd();\n+\n+    m_node.peerman->InitializeNode(&peer);\n+\n+    std::atomic<bool> interrupt_dummy{false};\n+    std::chrono::microseconds time_received_dummy{0};\n+\n+    m_node.peerman->ProcessMessage(peer, NetMsgType::VERSION, recv_stream, time_received_dummy,\n+                                   interrupt_dummy);",
    "path": "src/test/net_tests.cpp",
    "position": null,
    "original_position": 179,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "58755690a7e79e5ae4e3dcf1cba3dc0d28dfa3cd",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "See\r\n\r\n```\r\nTest cases order is shuffled using seed: 193951562\r\n```\r\n\r\nhttps://cirrus-ci.com/task/5953114714931200?command=ci#L3792\r\n\r\nWhich should make it reproducible ",
    "created_at": "2021-01-17T13:22:58Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r559181011",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559181011"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r559181011"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559181011/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 960,
    "side": "RIGHT",
    "in_reply_to_id": 559180800
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559577818",
    "pull_request_review_id": 570504260,
    "id": 559577818,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1OTU3NzgxOA==",
    "diff_hunk": "@@ -929,4 +1004,57 @@ BOOST_AUTO_TEST_CASE(node_eviction_test)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n+{\n+    // Pretend that we bound to this port.\n+    const uint16_t bind_port = 20001;\n+    m_node.args->ForceSetArg(\"-bind\", strprintf(\"3.4.5.6:%u\", bind_port));\n+\n+    // Our address:port as seen from the peer - 2.3.4.5:20002 (different from the above).\n+    in_addr peer_us_addr;\n+    peer_us_addr.s_addr = htonl(0x02030405);\n+    const CAddress peer_us{CService{peer_us_addr, 20002}, NODE_NETWORK};\n+\n+    // Create a peer with a routable IPv4 address.\n+    in_addr peer_in_addr;\n+    peer_in_addr.s_addr = htonl(0x01020304);\n+    CNode peer{0,\n+               NODE_NETWORK,\n+               INVALID_SOCKET,\n+               CAddress{CService{peer_in_addr, 8333}, NODE_NETWORK},\n+               0,\n+               0,\n+               CAddress{},\n+               std::string{},\n+               ConnectionType::OUTBOUND_FULL_RELAY};\n+\n+    const uint64_t services{NODE_NETWORK | NODE_WITNESS};\n+    const int64_t time{0};\n+    // Our address, as seen from the peer.\n+    const CNetMsgMaker msg_maker{PROTOCOL_VERSION};\n+    const auto msg = msg_maker.Make(NetMsgType::VERSION, PROTOCOL_VERSION, services, time, peer_us);\n+\n+    CDataStream recv_stream{msg.data, SER_NETWORK, PROTOCOL_VERSION};\n+\n+    // Force CChainState::IsInitialBlockDownload() to return false.\n+    // Otherwise PushAddress() isn't called by PeerManager::ProcessMessage().\n+    TestChainState& chainstate = *(TestChainState*)&m_node.chainman->ActiveChainstate();\n+    chainstate.JumpOutOfIbd();\n+\n+    m_node.peerman->InitializeNode(&peer);\n+\n+    std::atomic<bool> interrupt_dummy{false};\n+    std::chrono::microseconds time_received_dummy{0};\n+\n+    m_node.peerman->ProcessMessage(peer, NetMsgType::VERSION, recv_stream, time_received_dummy,\n+                                   interrupt_dummy);",
    "path": "src/test/net_tests.cpp",
    "position": null,
    "original_position": 179,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "58755690a7e79e5ae4e3dcf1cba3dc0d28dfa3cd",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Thanks, that helped a lot nailing the issue down. Fixed now.",
    "created_at": "2021-01-18T13:47:35Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r559577818",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559577818"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r559577818"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559577818/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 960,
    "side": "RIGHT",
    "in_reply_to_id": 559180800
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559688046",
    "pull_request_review_id": 570647860,
    "id": 559688046,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1OTY4ODA0Ng==",
    "diff_hunk": "@@ -96,9 +96,10 @@ BOOST_AUTO_TEST_CASE(addtimedata)\n     // not to fix this because it prevents possible attacks. See the comment in AddTimeData() or issue #4521\n     // for a more detailed explanation.\n     MultiAddTimeData(2, 100); // filter median is 100 now, but nTimeOffset will not change\n+    // We want this test to end with nTimeOffset==0, otherwise subsequent tests of the suite will fail.\n     BOOST_CHECK_EQUAL(GetTimeOffset(), 0);\n \n-    // We want this test to end with nTimeOffset==0, otherwise subsequent tests of the suite will fail.\n+    ResetTimeData();",
    "path": "src/test/timedata_tests.cpp",
    "position": null,
    "original_position": 8,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "9d8bb13b1dfc5103e2678ba803ecd3220dce052d",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "in 9d8bb13b1dfc5103e2678ba803ecd3220dce052d: Shouldn't the reset be before the check equal?",
    "created_at": "2021-01-18T16:37:54Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r559688046",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559688046"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r559688046"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559688046/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 102,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559688334",
    "pull_request_review_id": 570647860,
    "id": 559688334,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1OTY4ODMzNA==",
    "diff_hunk": "@@ -106,3 +107,12 @@ void AddTimeData(const CNetAddr& ip, int64_t nOffsetSample)\n         }\n     }\n }\n+\n+void ResetTimeData()",
    "path": "src/timedata.cpp",
    "position": null,
    "original_position": 36,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "9d8bb13b1dfc5103e2678ba803ecd3220dce052d",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Could rename this to `TestOnlyResetTimeData`?",
    "created_at": "2021-01-18T16:38:23Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r559688334",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559688334"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r559688334"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559688334/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 111,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/560083361",
    "pull_request_review_id": 571119121,
    "id": 560083361,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MDA4MzM2MQ==",
    "diff_hunk": "@@ -96,9 +96,10 @@ BOOST_AUTO_TEST_CASE(addtimedata)\n     // not to fix this because it prevents possible attacks. See the comment in AddTimeData() or issue #4521\n     // for a more detailed explanation.\n     MultiAddTimeData(2, 100); // filter median is 100 now, but nTimeOffset will not change\n+    // We want this test to end with nTimeOffset==0, otherwise subsequent tests of the suite will fail.\n     BOOST_CHECK_EQUAL(GetTimeOffset(), 0);\n \n-    // We want this test to end with nTimeOffset==0, otherwise subsequent tests of the suite will fail.\n+    ResetTimeData();",
    "path": "src/test/timedata_tests.cpp",
    "position": null,
    "original_position": 8,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "9d8bb13b1dfc5103e2678ba803ecd3220dce052d",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I don't think so. The `BOOST_CHECK_EQUAL(GetTimeOffset(), 0)` check is to ensure that the net result from all the previous calls is 0. This is still true and better keep that check to ensure it remains so. Surely the check will also pass after `ResetTimeData()` not because the net result is 0, but because the reset obliterated the entire state.",
    "created_at": "2021-01-19T10:46:06Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r560083361",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/560083361"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r560083361"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/560083361/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 102,
    "side": "RIGHT",
    "in_reply_to_id": 559688046
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/560089965",
    "pull_request_review_id": 571127545,
    "id": 560089965,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MDA4OTk2NQ==",
    "diff_hunk": "@@ -106,3 +107,12 @@ void AddTimeData(const CNetAddr& ip, int64_t nOffsetSample)\n         }\n     }\n }\n+\n+void ResetTimeData()",
    "path": "src/timedata.cpp",
    "position": null,
    "original_position": 36,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "9d8bb13b1dfc5103e2678ba803ecd3220dce052d",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Renamed. I would have preferred to surround it in `#ifdef UNIT_TESTS_ARE_ENABLED` but couldn't find such a macro.",
    "created_at": "2021-01-19T10:56:37Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r560089965",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/560089965"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r560089965"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/560089965/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 111,
    "side": "RIGHT",
    "in_reply_to_id": 559688334
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596347332",
    "pull_request_review_id": 614741012,
    "id": 596347332,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NjM0NzMzMg==",
    "diff_hunk": "@@ -70,26 +72,25 @@ void AddTimeData(const CNetAddr& ip, int64_t nOffsetSample)\n     // So we should hold off on fixing this and clean it up as part of\n     // a timing cleanup that strengthens it in a number of other ways.\n     //\n-    if (vTimeOffsets.size() >= 5 && vTimeOffsets.size() % 2 == 1) {\n-        int64_t nMedian = vTimeOffsets.median();\n-        std::vector<int64_t> vSorted = vTimeOffsets.sorted();\n+    if (g_time_offsets.size() >= 5 && g_time_offsets.size() % 2 == 1) {",
    "path": "src/timedata.cpp",
    "position": 47,
    "original_position": 36,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "950c9f6 ~0 on updating these names, as it is done only partially, the header file isn't updated, nor is `nTimeOffset`, and there are omissions: 2 occurrences of `vTimeOffsets` in the comments were not updated (a scripted diff should catch this)",
    "created_at": "2021-03-17T20:11:10Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596347332",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596347332"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596347332"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596347332/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 76,
    "original_line": 76,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596355935",
    "pull_request_review_id": 614741012,
    "id": 596355935,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NjM1NTkzNQ==",
    "diff_hunk": "@@ -0,0 +1,75 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that the proper port is used for -externalip=\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal, p2p_port\n+\n+# We need to bind to a routable address for this test to exercise the relevant code.\n+# To set a routable address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up  # to set up\n+# ifconfig lo:0 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig lo0 1.1.1.1/32 alias  # to set up\n+# ifconfig lo0 1.1.1.1 -alias  # to remove it, after the test\n+ADDR = '1.1.1.1'\n+\n+# array of tuples [arguments, expected port in localaddresses]\n+EXPECTED = [\n+    [['-externalip=2.2.2.2',       '-port=30001'                               ], 30001],\n+    [['-externalip=2.2.2.2',       '-port=30002', '-bind={}'.format(ADDR)],       30002],\n+    [['-externalip=2.2.2.2',                      '-bind={}'.format(ADDR)],       'default_p2p_port'],\n+    [['-externalip=2.2.2.2',       '-port=30003', '-bind={}:30004'.format(ADDR)], 30004],\n+    [['-externalip=2.2.2.2',                      '-bind={}:30005'.format(ADDR)], 30005],\n+    [['-externalip=2.2.2.2:30006', '-port=30007'                               ], 30006],\n+    [['-externalip=2.2.2.2:30008', '-port=30009', '-bind={}'.format(ADDR)],       30008],\n+    [['-externalip=2.2.2.2:30010',                '-bind={}'.format(ADDR)],       30010],\n+    [['-externalip=2.2.2.2:30011', '-port=30012', '-bind={}:30013'.format(ADDR)], 30011],\n+    [['-externalip=2.2.2.2:30014',                '-bind={}:30015'.format(ADDR)], 30014],\n+    [['-externalip=2.2.2.2',       '-port=30016', '-bind={}:30017'.format(ADDR),\n+                                             '-whitebind={}:30018'.format(ADDR)], 30017],\n+    [['-externalip=2.2.2.2',       '-port=30019',\n+                                             '-whitebind={}:30020'.format(ADDR)], 30020],",
    "path": "test/functional/feature_bind_port_externalip.py",
    "position": null,
    "original_position": 37,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "39b4a0c can replace all the `.format()` commands in the 2 new functional test files with the more compact, cleaner f-strings",
    "created_at": "2021-03-17T20:25:04Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596355935",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596355935"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596355935"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596355935/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 37,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596366771",
    "pull_request_review_id": 614741012,
    "id": 596366771,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NjM2Njc3MQ==",
    "diff_hunk": "@@ -945,4 +1022,63 @@ BOOST_AUTO_TEST_CASE(node_eviction_test)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n+{\n+    // Pretend that we bound to this port.\n+    const uint16_t bind_port = 20001;\n+    m_node.args->ForceSetArg(\"-bind\", strprintf(\"3.4.5.6:%u\", bind_port));\n+\n+    // Our address:port as seen from the peer - 2.3.4.5:20002 (different from the above).\n+    in_addr peer_us_addr;\n+    peer_us_addr.s_addr = htonl(0x02030405);\n+    const CAddress peer_us{CService{peer_us_addr, 20002}, NODE_NETWORK};\n+\n+    // Create a peer with a routable IPv4 address.\n+    in_addr peer_in_addr;\n+    peer_in_addr.s_addr = htonl(0x01020304);\n+    CNode peer{0,\n+               NODE_NETWORK,\n+               INVALID_SOCKET,\n+               CAddress{CService{peer_in_addr, 8333}, NODE_NETWORK},\n+               0,\n+               0,\n+               CAddress{},\n+               std::string{},\n+               ConnectionType::OUTBOUND_FULL_RELAY,\n+               false};",
    "path": "src/test/net_tests.cpp",
    "position": null,
    "original_position": 159,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "39b4a0c309c5f63bd here and 2 other places in the `get_local_addr_for_peer_port` test above\r\n```diff\r\n-               0,\r\n-               0,\r\n+               /* nKeyedNetGroupIn = */ 0,\r\n+               /* nLocalHostNonceIn = */ 0,\r\n                CAddress{},\r\n                std::string{},\r\n                ConnectionType::OUTBOUND_FULL_RELAY,\r\n-               false};\r\n+               /* inbound_onion = */ false};\r\n```\r\n",
    "created_at": "2021-03-17T20:41:23Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596366771",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596366771"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596366771"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596366771/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1049,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596374373",
    "pull_request_review_id": 614741012,
    "id": 596374373,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NjM3NDM3Mw==",
    "diff_hunk": "@@ -945,4 +1022,63 @@ BOOST_AUTO_TEST_CASE(node_eviction_test)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n+{\n+    // Pretend that we bound to this port.\n+    const uint16_t bind_port = 20001;\n+    m_node.args->ForceSetArg(\"-bind\", strprintf(\"3.4.5.6:%u\", bind_port));\n+\n+    // Our address:port as seen from the peer - 2.3.4.5:20002 (different from the above).\n+    in_addr peer_us_addr;\n+    peer_us_addr.s_addr = htonl(0x02030405);\n+    const CAddress peer_us{CService{peer_us_addr, 20002}, NODE_NETWORK};\n+\n+    // Create a peer with a routable IPv4 address.\n+    in_addr peer_in_addr;\n+    peer_in_addr.s_addr = htonl(0x01020304);\n+    CNode peer{0,\n+               NODE_NETWORK,\n+               INVALID_SOCKET,\n+               CAddress{CService{peer_in_addr, 8333}, NODE_NETWORK},\n+               0,\n+               0,\n+               CAddress{},\n+               std::string{},\n+               ConnectionType::OUTBOUND_FULL_RELAY,\n+               false};\n+\n+    const uint64_t services{NODE_NETWORK | NODE_WITNESS};\n+    const int64_t time{0};\n+    // Our address, as seen from the peer.\n+    const CNetMsgMaker msg_maker{PROTOCOL_VERSION};\n+    const auto msg = msg_maker.Make(NetMsgType::VERSION, PROTOCOL_VERSION, services, time, peer_us);\n+\n+    CDataStream recv_stream{msg.data, SER_NETWORK, PROTOCOL_VERSION};\n+\n+    // Force CChainState::IsInitialBlockDownload() to return false.\n+    // Otherwise PushAddress() isn't called by PeerManager::ProcessMessage().\n+    TestChainState& chainstate = *(TestChainState*)&m_node.chainman->ActiveChainstate();",
    "path": "src/test/net_tests.cpp",
    "position": null,
    "original_position": 171,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "39b4a0c309c5f63bdf0bdbde0d76ee3edce3ac19\r\n```suggestion\r\n    TestChainState& chainstate = *static_cast<TestChainState*>(&m_node.chainman->ActiveChainstate());\r\n```",
    "created_at": "2021-03-17T20:53:23Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596374373",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596374373"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596374373"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596374373/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1061,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596379551",
    "pull_request_review_id": 614741012,
    "id": 596379551,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NjM3OTU1MQ==",
    "diff_hunk": "@@ -2465,6 +2465,10 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                     LogPrint(BCLog::NET, \"ProcessMessages: advertising address %s\\n\", addr.ToString());\n                     pfrom.PushAddress(addr, insecure_rand);\n                 } else if (IsPeerAddrLocalGood(&pfrom)) {\n+                    // Override just the address with whatever the peer sees us as.\n+                    // Leave the port in addr as it was returned by GetLocalAddress()\n+                    // above because this is outbound connection and the peer cannot",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "39b4a0c309c5f\r\n```suggestion\r\n                    // above, as this is an outbound connection and the peer cannot\r\n```",
    "created_at": "2021-03-17T21:01:40Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596379551",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596379551"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596379551"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596379551/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2453,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596382600",
    "pull_request_review_id": 614741012,
    "id": 596382600,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NjM4MjYwMA==",
    "diff_hunk": "@@ -207,7 +233,17 @@ std::optional<CAddress> GetLocalAddrForPeer(CNode *pnode)\n     if (IsPeerAddrLocalGood(pnode) && (!addrLocal.IsRoutable() ||\n          rng.randbits((GetnScore(addrLocal) > LOCAL_MANUAL) ? 3 : 1) == 0))\n     {\n-        addrLocal.SetIP(pnode->GetAddrLocal());\n+        if (pnode->IsInboundConn()) {\n+            // For inbound connections assume both the address and the port\n+            // as seen from the peer.\n+            addrLocal = CAddress(pnode->GetAddrLocal(), addrLocal.nServices);\n+        } else {\n+            // For outbound connections assume just the address as seen from\n+            // the peer and leave the port in `addrLocal` as returned by\n+            // `GetLocalAddress()` above. The peer has no way to observe our\n+            // listening port when we have initiated the connection.",
    "path": "src/net.cpp",
    "position": 45,
    "original_position": 46,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "39b4a0c309 a few ideas\r\n```diff\r\n         if (pnode->IsInboundConn()) {\r\n-            // For inbound connections assume both the address and the port\r\n+            // For inbound connections, assume both the address and the port\r\n             // as seen from the peer.\r\n-            addrLocal = CAddress(pnode->GetAddrLocal(), addrLocal.nServices);\r\n+            addrLocal = CAddress{pnode->GetAddrLocal(), addrLocal.nServices};\r\n         } else {\r\n-            // For outbound connections assume just the address as seen from\r\n+            // For outbound connections, assume only the address as seen from\r\n             // the peer and leave the port in `addrLocal` as returned by\r\n             // `GetLocalAddress()` above. The peer has no way to observe our\r\n             // listening port when we have initiated the connection.\r\n```\r\n",
    "created_at": "2021-03-17T21:06:46Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596382600",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596382600"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596382600"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596382600/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 254,
    "original_line": 254,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596395788",
    "pull_request_review_id": 614741012,
    "id": 596395788,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NjM5NTc4OA==",
    "diff_hunk": "@@ -184,7 +184,15 @@ enum class ConnectionType {\n \n /** Convert ConnectionType enum to a string value */\n std::string ConnectionTypeAsString(ConnectionType conn_type);\n+\n+/**\n+ * Lookup IP addresses from all interfaces on the machine and add them to the",
    "path": "src/net.h",
    "position": null,
    "original_position": 6,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "0c24971f nits: \"lookup\" is a noun, \"look up\" is the verb; s/for/to/\r\n```diff\r\n- * Lookup IP addresses from all interfaces on the machine and add them to the\r\n- * list of local addresses for self-advertise.\r\n+ * Look up IP addresses from all interfaces on the machine and add them to the\r\n+ * list of local addresses to self-advertise.\r\n```",
    "created_at": "2021-03-17T21:29:12Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596395788",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596395788"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596395788"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596395788/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 189,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596402934",
    "pull_request_review_id": 614741012,
    "id": 596402934,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NjQwMjkzNA==",
    "diff_hunk": "@@ -0,0 +1,74 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that -discover does not add all intefaces' addresses if we listen just on some\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal\n+\n+# We need to bind to a routable address for this test to exercise the relevant code\n+# and also must have another routable address on another interface which must not\n+# be named \"lo\" or \"lo0\".\n+# To set a routable address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up && ifconfig lo:1 2.2.2.2/32 up  # to set up\n+# ifconfig lo:0 down && ifconfig lo:1 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig em0 1.1.1.1/32 alias && ifconfig wlan0 2.2.2.2/32 alias  # to set up\n+# ifconfig em0 1.1.1.1 -alias && ifconfig wlan0 2.2.2.2 -alias  # to remove it, after the test\n+ADDR1 = '1.1.1.1'\n+ADDR2 = '2.2.2.2'\n+\n+BIND_PORT = 31001\n+\n+class BindPortDiscoverTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        # Avoid any -bind= on the command line. Force the framework to avoid adding -bind=127.0.0.1.\n+        self.setup_clean_chain = True\n+        self.bind_to_localhost_only = False\n+        self.extra_args = [\n+            ['-discover', '-port={}'.format(BIND_PORT)], # bind on any\n+            ['-discover', '-bind={}:{}'.format(ADDR1, BIND_PORT)],\n+        ]\n+        self.num_nodes = len(self.extra_args)\n+\n+    def add_options(self, parser):\n+        parser.add_argument(\n+            \"--ihave1111and2222\", action='store_true', dest=\"ihave1111and2222\",\n+            help=\"Run the test, assuming {} and {} are configured on the machine\".format(ADDR1, ADDR2),\n+            default=False)\n+\n+    def skip_test_if_missing_module(self):\n+        if not self.options.ihave1111and2222:\n+            raise SkipTest(\n+                \"To run this test make sure that {} and {} (a routable addresses) are assigned \"",
    "path": "test/functional/feature_bind_port_discover.py",
    "position": null,
    "original_position": 47,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "0c24971f97d5e6b03aef4911a s/a routable/routable/, or...\r\n```suggestion\r\n                \"To run this test make sure that routable addresses {} and {} are assigned \"\r\n```\r\n",
    "created_at": "2021-03-17T21:42:37Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596402934",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596402934"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596402934"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596402934/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 47,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596403782",
    "pull_request_review_id": 614741012,
    "id": 596403782,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NjQwMzc4Mg==",
    "diff_hunk": "@@ -0,0 +1,74 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that -discover does not add all intefaces' addresses if we listen just on some",
    "path": "test/functional/feature_bind_port_discover.py",
    "position": null,
    "original_position": 6,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "0c24971f97d5e6b03aef4911a1f772b6\r\n```suggestion\r\nTest that -discover does not add all interfaces' addresses if we listen on only some of them.\r\n```",
    "created_at": "2021-03-17T21:44:22Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596403782",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596403782"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596403782"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596403782/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 6,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596405070",
    "pull_request_review_id": 614741012,
    "id": 596405070,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NjQwNTA3MA==",
    "diff_hunk": "@@ -0,0 +1,74 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that -discover does not add all intefaces' addresses if we listen just on some\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal\n+\n+# We need to bind to a routable address for this test to exercise the relevant code\n+# and also must have another routable address on another interface which must not\n+# be named \"lo\" or \"lo0\".\n+# To set a routable address on the machine use:",
    "path": "test/functional/feature_bind_port_discover.py",
    "position": null,
    "original_position": 15,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "0c24971f97d5e6b0\r\n```suggestion\r\n# To set these routable addresses on the machine, use:\r\n```",
    "created_at": "2021-03-17T21:46:32Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596405070",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596405070"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596405070"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596405070/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 15,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596407087",
    "pull_request_review_id": 614741012,
    "id": 596407087,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NjQwNzA4Nw==",
    "diff_hunk": "@@ -0,0 +1,74 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that -discover does not add all intefaces' addresses if we listen just on some\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal\n+\n+# We need to bind to a routable address for this test to exercise the relevant code\n+# and also must have another routable address on another interface which must not\n+# be named \"lo\" or \"lo0\".\n+# To set a routable address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up && ifconfig lo:1 2.2.2.2/32 up  # to set up\n+# ifconfig lo:0 down && ifconfig lo:1 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig em0 1.1.1.1/32 alias && ifconfig wlan0 2.2.2.2/32 alias  # to set up\n+# ifconfig em0 1.1.1.1 -alias && ifconfig wlan0 2.2.2.2 -alias  # to remove it, after the test\n+ADDR1 = '1.1.1.1'\n+ADDR2 = '2.2.2.2'\n+\n+BIND_PORT = 31001\n+\n+class BindPortDiscoverTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        # Avoid any -bind= on the command line. Force the framework to avoid adding -bind=127.0.0.1.\n+        self.setup_clean_chain = True\n+        self.bind_to_localhost_only = False\n+        self.extra_args = [\n+            ['-discover', '-port={}'.format(BIND_PORT)], # bind on any\n+            ['-discover', '-bind={}:{}'.format(ADDR1, BIND_PORT)],\n+        ]\n+        self.num_nodes = len(self.extra_args)\n+\n+    def add_options(self, parser):\n+        parser.add_argument(\n+            \"--ihave1111and2222\", action='store_true', dest=\"ihave1111and2222\",\n+            help=\"Run the test, assuming {} and {} are configured on the machine\".format(ADDR1, ADDR2),\n+            default=False)\n+\n+    def skip_test_if_missing_module(self):\n+        if not self.options.ihave1111and2222:\n+            raise SkipTest(\n+                \"To run this test make sure that {} and {} (a routable addresses) are assigned \"\n+                \"to the interfaces on this machine and rerun with --ihave1111and2222\".format(ADDR1, ADDR2))\n+\n+    def run_test(self):\n+        # Check that if no -bind= is given, then all addresses are added to localaddresses.",
    "path": "test/functional/feature_bind_port_discover.py",
    "position": null,
    "original_position": 51,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "0c24971f97d5e6b03a\r\n```suggestion\r\n        self.log.info(\"Test if -bind= is not passed, all addresses are added to localaddresses\")\r\n```",
    "created_at": "2021-03-17T21:50:21Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596407087",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596407087"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596407087"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596407087/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 51,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596407395",
    "pull_request_review_id": 614741012,
    "id": 596407395,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NjQwNzM5NQ==",
    "diff_hunk": "@@ -0,0 +1,74 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that -discover does not add all intefaces' addresses if we listen just on some\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal\n+\n+# We need to bind to a routable address for this test to exercise the relevant code\n+# and also must have another routable address on another interface which must not\n+# be named \"lo\" or \"lo0\".\n+# To set a routable address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up && ifconfig lo:1 2.2.2.2/32 up  # to set up\n+# ifconfig lo:0 down && ifconfig lo:1 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig em0 1.1.1.1/32 alias && ifconfig wlan0 2.2.2.2/32 alias  # to set up\n+# ifconfig em0 1.1.1.1 -alias && ifconfig wlan0 2.2.2.2 -alias  # to remove it, after the test\n+ADDR1 = '1.1.1.1'\n+ADDR2 = '2.2.2.2'\n+\n+BIND_PORT = 31001\n+\n+class BindPortDiscoverTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        # Avoid any -bind= on the command line. Force the framework to avoid adding -bind=127.0.0.1.\n+        self.setup_clean_chain = True\n+        self.bind_to_localhost_only = False\n+        self.extra_args = [\n+            ['-discover', '-port={}'.format(BIND_PORT)], # bind on any\n+            ['-discover', '-bind={}:{}'.format(ADDR1, BIND_PORT)],\n+        ]\n+        self.num_nodes = len(self.extra_args)\n+\n+    def add_options(self, parser):\n+        parser.add_argument(\n+            \"--ihave1111and2222\", action='store_true', dest=\"ihave1111and2222\",\n+            help=\"Run the test, assuming {} and {} are configured on the machine\".format(ADDR1, ADDR2),\n+            default=False)\n+\n+    def skip_test_if_missing_module(self):\n+        if not self.options.ihave1111and2222:\n+            raise SkipTest(\n+                \"To run this test make sure that {} and {} (a routable addresses) are assigned \"\n+                \"to the interfaces on this machine and rerun with --ihave1111and2222\".format(ADDR1, ADDR2))\n+\n+    def run_test(self):\n+        # Check that if no -bind= is given, then all addresses are added to localaddresses.\n+        found_addr1 = False\n+        found_addr2 = False\n+        for local in self.nodes[0].getnetworkinfo()['localaddresses']:\n+            if local['address'] == ADDR1:\n+                found_addr1 = True\n+                assert_equal(local['port'], BIND_PORT)\n+            if local['address'] == ADDR2:\n+                found_addr2 = True\n+                assert_equal(local['port'], BIND_PORT)\n+        assert(found_addr1)\n+        assert(found_addr2)\n+\n+        # Check that if -bind= is given, just that address is added to localaddresses.",
    "path": "test/functional/feature_bind_port_discover.py",
    "position": null,
    "original_position": 64,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "0c24971f97d5e6b03a\r\n```suggestion\r\n        self.log.info(\"Test if -bind= is passed, only that address is added to localaddresses\")\r\n```",
    "created_at": "2021-03-17T21:50:54Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596407395",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596407395"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596407395"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596407395/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 64,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596410851",
    "pull_request_review_id": 614741012,
    "id": 596410851,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NjQxMDg1MQ==",
    "diff_hunk": "@@ -0,0 +1,76 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that the proper port is used for -externalip=\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal\n+\n+# We need to bind to a routable address for this test to exercise the relevant code.\n+# To set a routable IP address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up  # to set up\n+# ifconfig lo:0 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig lo0 1.1.1.1/32 alias  # to set up\n+# ifconfig lo0 1.1.1.1 -alias  # to remove it, after the test\n+addr = '1.1.1.1'\n+\n+# array of tuples [arguments, expected port in localaddresses]\n+expected = [\n+    [['-externalip=2.2.2.2',       '-port=20001'                               ], 20001],\n+    [['-externalip=2.2.2.2',       '-port=20002', '-bind={}'.format(addr)],       20002],\n+    [['-externalip=2.2.2.2',                      '-bind={}'.format(addr)],       11002],\n+    [['-externalip=2.2.2.2',       '-port=20003', '-bind={}:20004'.format(addr)], 20004],\n+    [['-externalip=2.2.2.2',                      '-bind={}:20005'.format(addr)], 20005],\n+    [['-externalip=2.2.2.2:20006', '-port=20007'                               ], 20006],\n+    [['-externalip=2.2.2.2:20008', '-port=20009', '-bind={}'.format(addr)],       20008],\n+    [['-externalip=2.2.2.2:20010',                '-bind={}'.format(addr)],       20010],\n+    [['-externalip=2.2.2.2:20011', '-port=20012', '-bind={}:20013'.format(addr)], 20011],\n+    [['-externalip=2.2.2.2:20014',                '-bind={}:20015'.format(addr)], 20014],\n+    [['-externalip=2.2.2.2',       '-port=20016', '-bind={}:20017'.format(addr),\n+                                             '-whitebind={}:20018'.format(addr)], 20017],\n+    [['-externalip=2.2.2.2',       '-port=20019',\n+                                             '-whitebind={}:20020'.format(addr)], 20020],\n+]\n+\n+class BindPortTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        # Avoid any -bind= on the command line. Force the framework to avoid adding -bind=127.0.0.1.\n+        self.setup_clean_chain = True\n+        self.bind_to_localhost_only = False\n+        self.num_nodes = len(expected)\n+\n+    def add_options(self, parser):\n+        parser.add_argument(\n+            \"--ihave1111\", action='store_true', dest=\"ihave1111\",\n+            help=\"Run the test, assuming {} is configured on the machine\".format(addr),\n+            default=False)\n+\n+    def setup_nodes(self):\n+        if not self.options.ihave1111:\n+            raise SkipTest(\n+                \"To run this test make sure that {} (a routable address) is assigned \"\n+                \"to one of the interfaces on this machine and rerun with --ihave1111\".format(addr))\n+        args = []\n+        for t in expected:\n+            args.append(t[0])\n+        self.add_nodes(self.num_nodes, extra_args=args)\n+        self.start_nodes()\n+\n+    def run_test(self):\n+        for i in range(len(expected)):\n+            expected_port = expected[i][1]\n+            found = False\n+            for local in self.nodes[i].getnetworkinfo()['localaddresses']:\n+                if local['address'] == '2.2.2.2':\n+                    assert_equal(local['port'], expected_port)\n+                    found = True\n+                    break\n+            assert(found)",
    "path": "test/functional/feature_bind_port_externalip.py",
    "position": null,
    "original_position": 73,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "e6c3de7178ff3e2b0961e71635729bbfe6784f1e",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "A few micro-optimisations\r\n```diff\r\n+LEN_EXPECTED = len(EXPECTED)\r\n \r\n class BindPortExternalIPTest(BitcoinTestFramework):\r\n     def set_test_params(self):\r\n         # Avoid any -bind= on the command line. Force the framework to avoid adding -bind=127.0.0.1.\r\n         self.setup_clean_chain = True\r\n         self.bind_to_localhost_only = False\r\n-        self.num_nodes = len(EXPECTED)\r\n+        self.num_nodes = LEN_EXPECTED\r\n         self.extra_args = list(map(lambda e: e[0], EXPECTED))\r\n \r\n     def add_options(self, parser):\r\n@@ -58,11 +59,13 @@ class BindPortExternalIPTest(BitcoinTestFramework):\r\n                 \"to one of the interfaces on this machine and rerun with --ihave1111\".format(ADDR))\r\n \r\n     def run_test(self):\r\n-        for i in range(len(EXPECTED)):\r\n-            if EXPECTED[i][1] == 'default_p2p_port':\r\n+        self.log.info(\"Test the proper port is used for -externalip=\")\r\n+        for i in range(LEN_EXPECTED):\r\n+            port = EXPECTED[i][1]\r\n+            if port == 'default_p2p_port':\r\n                 expected_port = p2p_port(i)\r\n             else:\r\n-                expected_port = EXPECTED[i][1]\r\n+                expected_port = port\r\n```\r\n",
    "created_at": "2021-03-17T21:57:27Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596410851",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596410851"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596410851"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/596410851/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 67,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 72,
    "side": "RIGHT",
    "in_reply_to_id": 509346608
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597130602",
    "pull_request_review_id": 615722631,
    "id": 597130602,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzEzMDYwMg==",
    "diff_hunk": "@@ -725,8 +731,79 @@ BOOST_AUTO_TEST_CASE(ipv4_peer_with_ipv6_addrMe_test)\n \n     // suppress no-checks-run warning; if this test fails, it's by triggering a sanitizer\n     BOOST_CHECK(1);\n+\n+    // Cleanup, so that we don't confuse other tests.\n+    {\n+        LOCK(cs_mapLocalHost);\n+        mapLocalHost.erase(addr_in_mapLocalHost);\n+    }\n }\n \n+BOOST_AUTO_TEST_CASE(get_local_addr_for_peer_port)\n+{\n+    // Test that GetLocalAddrForPeer() properly selects the address for self-advertise:",
    "path": "src/test/net_tests.cpp",
    "position": null,
    "original_position": 66,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "39b4a0c309c5f63bdf0bdbde0d76ee3edce3ac19 \"for self-advertisement\" or \"to self-advertise\"",
    "created_at": "2021-03-18T18:17:32Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r597130602",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597130602"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r597130602"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597130602/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 745,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602206794",
    "pull_request_review_id": 622032205,
    "id": 602206794,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjIwNjc5NA==",
    "diff_hunk": "@@ -70,26 +72,25 @@ void AddTimeData(const CNetAddr& ip, int64_t nOffsetSample)\n     // So we should hold off on fixing this and clean it up as part of\n     // a timing cleanup that strengthens it in a number of other ways.\n     //\n-    if (vTimeOffsets.size() >= 5 && vTimeOffsets.size() % 2 == 1) {\n-        int64_t nMedian = vTimeOffsets.median();\n-        std::vector<int64_t> vSorted = vTimeOffsets.sorted();\n+    if (g_time_offsets.size() >= 5 && g_time_offsets.size() % 2 == 1) {",
    "path": "src/timedata.cpp",
    "position": 47,
    "original_position": 36,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> as it is done only partially\r\n\r\nThe commit does not claim to rename all variables, just the 3 ones mentioned in the commit message.\r\n\r\n> the header file isn't updated\r\n\r\nWhat do you think needs to be updated in the header file (I assume `timedata.h`)? The variables that were renamed are `static` in `timedata.cpp`.\r\n\r\n> 2 occurrences of `vTimeOffsets` in the comments were not updated\r\n\r\nUpdated the comments, thanks!",
    "created_at": "2021-03-26T11:29:14Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602206794",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602206794"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602206794"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602206794/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 76,
    "original_line": 76,
    "side": "RIGHT",
    "in_reply_to_id": 596347332
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602217428",
    "pull_request_review_id": 622032205,
    "id": 602217428,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjIxNzQyOA==",
    "diff_hunk": "@@ -0,0 +1,75 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that the proper port is used for -externalip=\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal, p2p_port\n+\n+# We need to bind to a routable address for this test to exercise the relevant code.\n+# To set a routable address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up  # to set up\n+# ifconfig lo:0 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig lo0 1.1.1.1/32 alias  # to set up\n+# ifconfig lo0 1.1.1.1 -alias  # to remove it, after the test\n+ADDR = '1.1.1.1'\n+\n+# array of tuples [arguments, expected port in localaddresses]\n+EXPECTED = [\n+    [['-externalip=2.2.2.2',       '-port=30001'                               ], 30001],\n+    [['-externalip=2.2.2.2',       '-port=30002', '-bind={}'.format(ADDR)],       30002],\n+    [['-externalip=2.2.2.2',                      '-bind={}'.format(ADDR)],       'default_p2p_port'],\n+    [['-externalip=2.2.2.2',       '-port=30003', '-bind={}:30004'.format(ADDR)], 30004],\n+    [['-externalip=2.2.2.2',                      '-bind={}:30005'.format(ADDR)], 30005],\n+    [['-externalip=2.2.2.2:30006', '-port=30007'                               ], 30006],\n+    [['-externalip=2.2.2.2:30008', '-port=30009', '-bind={}'.format(ADDR)],       30008],\n+    [['-externalip=2.2.2.2:30010',                '-bind={}'.format(ADDR)],       30010],\n+    [['-externalip=2.2.2.2:30011', '-port=30012', '-bind={}:30013'.format(ADDR)], 30011],\n+    [['-externalip=2.2.2.2:30014',                '-bind={}:30015'.format(ADDR)], 30014],\n+    [['-externalip=2.2.2.2',       '-port=30016', '-bind={}:30017'.format(ADDR),\n+                                             '-whitebind={}:30018'.format(ADDR)], 30017],\n+    [['-externalip=2.2.2.2',       '-port=30019',\n+                                             '-whitebind={}:30020'.format(ADDR)], 30020],",
    "path": "test/functional/feature_bind_port_externalip.py",
    "position": null,
    "original_position": 37,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2021-03-26T11:45:30Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602217428",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602217428"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602217428"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602217428/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 37,
    "side": "RIGHT",
    "in_reply_to_id": 596355935
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602232488",
    "pull_request_review_id": 622063423,
    "id": 602232488,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjIzMjQ4OA==",
    "diff_hunk": "@@ -945,4 +1022,63 @@ BOOST_AUTO_TEST_CASE(node_eviction_test)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n+{\n+    // Pretend that we bound to this port.\n+    const uint16_t bind_port = 20001;\n+    m_node.args->ForceSetArg(\"-bind\", strprintf(\"3.4.5.6:%u\", bind_port));\n+\n+    // Our address:port as seen from the peer - 2.3.4.5:20002 (different from the above).\n+    in_addr peer_us_addr;\n+    peer_us_addr.s_addr = htonl(0x02030405);\n+    const CAddress peer_us{CService{peer_us_addr, 20002}, NODE_NETWORK};\n+\n+    // Create a peer with a routable IPv4 address.\n+    in_addr peer_in_addr;\n+    peer_in_addr.s_addr = htonl(0x01020304);\n+    CNode peer{0,\n+               NODE_NETWORK,\n+               INVALID_SOCKET,\n+               CAddress{CService{peer_in_addr, 8333}, NODE_NETWORK},\n+               0,\n+               0,\n+               CAddress{},\n+               std::string{},\n+               ConnectionType::OUTBOUND_FULL_RELAY,\n+               false};",
    "path": "src/test/net_tests.cpp",
    "position": null,
    "original_position": 159,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2021-03-26T12:12:36Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602232488",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602232488"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602232488"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602232488/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1049,
    "side": "RIGHT",
    "in_reply_to_id": 596366771
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602233546",
    "pull_request_review_id": 622064849,
    "id": 602233546,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjIzMzU0Ng==",
    "diff_hunk": "@@ -945,4 +1022,63 @@ BOOST_AUTO_TEST_CASE(node_eviction_test)\n     }\n }\n \n+BOOST_AUTO_TEST_CASE(initial_advertise_from_version_message)\n+{\n+    // Pretend that we bound to this port.\n+    const uint16_t bind_port = 20001;\n+    m_node.args->ForceSetArg(\"-bind\", strprintf(\"3.4.5.6:%u\", bind_port));\n+\n+    // Our address:port as seen from the peer - 2.3.4.5:20002 (different from the above).\n+    in_addr peer_us_addr;\n+    peer_us_addr.s_addr = htonl(0x02030405);\n+    const CAddress peer_us{CService{peer_us_addr, 20002}, NODE_NETWORK};\n+\n+    // Create a peer with a routable IPv4 address.\n+    in_addr peer_in_addr;\n+    peer_in_addr.s_addr = htonl(0x01020304);\n+    CNode peer{0,\n+               NODE_NETWORK,\n+               INVALID_SOCKET,\n+               CAddress{CService{peer_in_addr, 8333}, NODE_NETWORK},\n+               0,\n+               0,\n+               CAddress{},\n+               std::string{},\n+               ConnectionType::OUTBOUND_FULL_RELAY,\n+               false};\n+\n+    const uint64_t services{NODE_NETWORK | NODE_WITNESS};\n+    const int64_t time{0};\n+    // Our address, as seen from the peer.\n+    const CNetMsgMaker msg_maker{PROTOCOL_VERSION};\n+    const auto msg = msg_maker.Make(NetMsgType::VERSION, PROTOCOL_VERSION, services, time, peer_us);\n+\n+    CDataStream recv_stream{msg.data, SER_NETWORK, PROTOCOL_VERSION};\n+\n+    // Force CChainState::IsInitialBlockDownload() to return false.\n+    // Otherwise PushAddress() isn't called by PeerManager::ProcessMessage().\n+    TestChainState& chainstate = *(TestChainState*)&m_node.chainman->ActiveChainstate();",
    "path": "src/test/net_tests.cpp",
    "position": null,
    "original_position": 171,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2021-03-26T12:14:25Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602233546",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602233546"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602233546"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602233546/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1061,
    "side": "RIGHT",
    "in_reply_to_id": 596374373
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602234375",
    "pull_request_review_id": 622065912,
    "id": 602234375,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjIzNDM3NQ==",
    "diff_hunk": "@@ -2465,6 +2465,10 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n                     LogPrint(BCLog::NET, \"ProcessMessages: advertising address %s\\n\", addr.ToString());\n                     pfrom.PushAddress(addr, insecure_rand);\n                 } else if (IsPeerAddrLocalGood(&pfrom)) {\n+                    // Override just the address with whatever the peer sees us as.\n+                    // Leave the port in addr as it was returned by GetLocalAddress()\n+                    // above because this is outbound connection and the peer cannot",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2021-03-26T12:15:47Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602234375",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602234375"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602234375"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602234375/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2453,
    "side": "RIGHT",
    "in_reply_to_id": 596379551
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602235298",
    "pull_request_review_id": 622067134,
    "id": 602235298,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjIzNTI5OA==",
    "diff_hunk": "@@ -207,7 +233,17 @@ std::optional<CAddress> GetLocalAddrForPeer(CNode *pnode)\n     if (IsPeerAddrLocalGood(pnode) && (!addrLocal.IsRoutable() ||\n          rng.randbits((GetnScore(addrLocal) > LOCAL_MANUAL) ? 3 : 1) == 0))\n     {\n-        addrLocal.SetIP(pnode->GetAddrLocal());\n+        if (pnode->IsInboundConn()) {\n+            // For inbound connections assume both the address and the port\n+            // as seen from the peer.\n+            addrLocal = CAddress(pnode->GetAddrLocal(), addrLocal.nServices);\n+        } else {\n+            // For outbound connections assume just the address as seen from\n+            // the peer and leave the port in `addrLocal` as returned by\n+            // `GetLocalAddress()` above. The peer has no way to observe our\n+            // listening port when we have initiated the connection.",
    "path": "src/net.cpp",
    "position": 45,
    "original_position": 46,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2021-03-26T12:17:21Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602235298",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602235298"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602235298"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602235298/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 254,
    "original_line": 254,
    "side": "RIGHT",
    "in_reply_to_id": 596382600
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602236869",
    "pull_request_review_id": 622069262,
    "id": 602236869,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjIzNjg2OQ==",
    "diff_hunk": "@@ -184,7 +184,15 @@ enum class ConnectionType {\n \n /** Convert ConnectionType enum to a string value */\n std::string ConnectionTypeAsString(ConnectionType conn_type);\n+\n+/**\n+ * Lookup IP addresses from all interfaces on the machine and add them to the",
    "path": "src/net.h",
    "position": null,
    "original_position": 6,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2021-03-26T12:19:47Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602236869",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602236869"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602236869"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602236869/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 189,
    "side": "RIGHT",
    "in_reply_to_id": 596395788
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602239036",
    "pull_request_review_id": 622072164,
    "id": 602239036,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjIzOTAzNg==",
    "diff_hunk": "@@ -0,0 +1,74 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that -discover does not add all intefaces' addresses if we listen just on some\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal\n+\n+# We need to bind to a routable address for this test to exercise the relevant code\n+# and also must have another routable address on another interface which must not\n+# be named \"lo\" or \"lo0\".\n+# To set a routable address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up && ifconfig lo:1 2.2.2.2/32 up  # to set up\n+# ifconfig lo:0 down && ifconfig lo:1 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig em0 1.1.1.1/32 alias && ifconfig wlan0 2.2.2.2/32 alias  # to set up\n+# ifconfig em0 1.1.1.1 -alias && ifconfig wlan0 2.2.2.2 -alias  # to remove it, after the test\n+ADDR1 = '1.1.1.1'\n+ADDR2 = '2.2.2.2'\n+\n+BIND_PORT = 31001\n+\n+class BindPortDiscoverTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        # Avoid any -bind= on the command line. Force the framework to avoid adding -bind=127.0.0.1.\n+        self.setup_clean_chain = True\n+        self.bind_to_localhost_only = False\n+        self.extra_args = [\n+            ['-discover', '-port={}'.format(BIND_PORT)], # bind on any\n+            ['-discover', '-bind={}:{}'.format(ADDR1, BIND_PORT)],\n+        ]\n+        self.num_nodes = len(self.extra_args)\n+\n+    def add_options(self, parser):\n+        parser.add_argument(\n+            \"--ihave1111and2222\", action='store_true', dest=\"ihave1111and2222\",\n+            help=\"Run the test, assuming {} and {} are configured on the machine\".format(ADDR1, ADDR2),\n+            default=False)\n+\n+    def skip_test_if_missing_module(self):\n+        if not self.options.ihave1111and2222:\n+            raise SkipTest(\n+                \"To run this test make sure that {} and {} (a routable addresses) are assigned \"",
    "path": "test/functional/feature_bind_port_discover.py",
    "position": null,
    "original_position": 47,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2021-03-26T12:23:23Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602239036",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602239036"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602239036"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602239036/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 47,
    "side": "RIGHT",
    "in_reply_to_id": 596402934
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602240514",
    "pull_request_review_id": 622073939,
    "id": 602240514,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjI0MDUxNA==",
    "diff_hunk": "@@ -0,0 +1,74 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that -discover does not add all intefaces' addresses if we listen just on some",
    "path": "test/functional/feature_bind_port_discover.py",
    "position": null,
    "original_position": 6,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2021-03-26T12:25:41Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602240514",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602240514"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602240514"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602240514/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 6,
    "side": "RIGHT",
    "in_reply_to_id": 596403782
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602241006",
    "pull_request_review_id": 622074613,
    "id": 602241006,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjI0MTAwNg==",
    "diff_hunk": "@@ -0,0 +1,74 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that -discover does not add all intefaces' addresses if we listen just on some\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal\n+\n+# We need to bind to a routable address for this test to exercise the relevant code\n+# and also must have another routable address on another interface which must not\n+# be named \"lo\" or \"lo0\".\n+# To set a routable address on the machine use:",
    "path": "test/functional/feature_bind_port_discover.py",
    "position": null,
    "original_position": 15,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2021-03-26T12:26:35Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602241006",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602241006"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602241006"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602241006/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 15,
    "side": "RIGHT",
    "in_reply_to_id": 596405070
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602243277",
    "pull_request_review_id": 622077600,
    "id": 602243277,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjI0MzI3Nw==",
    "diff_hunk": "@@ -0,0 +1,74 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that -discover does not add all intefaces' addresses if we listen just on some\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal\n+\n+# We need to bind to a routable address for this test to exercise the relevant code\n+# and also must have another routable address on another interface which must not\n+# be named \"lo\" or \"lo0\".\n+# To set a routable address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up && ifconfig lo:1 2.2.2.2/32 up  # to set up\n+# ifconfig lo:0 down && ifconfig lo:1 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig em0 1.1.1.1/32 alias && ifconfig wlan0 2.2.2.2/32 alias  # to set up\n+# ifconfig em0 1.1.1.1 -alias && ifconfig wlan0 2.2.2.2 -alias  # to remove it, after the test\n+ADDR1 = '1.1.1.1'\n+ADDR2 = '2.2.2.2'\n+\n+BIND_PORT = 31001\n+\n+class BindPortDiscoverTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        # Avoid any -bind= on the command line. Force the framework to avoid adding -bind=127.0.0.1.\n+        self.setup_clean_chain = True\n+        self.bind_to_localhost_only = False\n+        self.extra_args = [\n+            ['-discover', '-port={}'.format(BIND_PORT)], # bind on any\n+            ['-discover', '-bind={}:{}'.format(ADDR1, BIND_PORT)],\n+        ]\n+        self.num_nodes = len(self.extra_args)\n+\n+    def add_options(self, parser):\n+        parser.add_argument(\n+            \"--ihave1111and2222\", action='store_true', dest=\"ihave1111and2222\",\n+            help=\"Run the test, assuming {} and {} are configured on the machine\".format(ADDR1, ADDR2),\n+            default=False)\n+\n+    def skip_test_if_missing_module(self):\n+        if not self.options.ihave1111and2222:\n+            raise SkipTest(\n+                \"To run this test make sure that {} and {} (a routable addresses) are assigned \"\n+                \"to the interfaces on this machine and rerun with --ihave1111and2222\".format(ADDR1, ADDR2))\n+\n+    def run_test(self):\n+        # Check that if no -bind= is given, then all addresses are added to localaddresses.",
    "path": "test/functional/feature_bind_port_discover.py",
    "position": null,
    "original_position": 51,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2021-03-26T12:30:23Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602243277",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602243277"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602243277"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602243277/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 51,
    "side": "RIGHT",
    "in_reply_to_id": 596407087
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602243355",
    "pull_request_review_id": 622077709,
    "id": 602243355,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjI0MzM1NQ==",
    "diff_hunk": "@@ -0,0 +1,74 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that -discover does not add all intefaces' addresses if we listen just on some\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal\n+\n+# We need to bind to a routable address for this test to exercise the relevant code\n+# and also must have another routable address on another interface which must not\n+# be named \"lo\" or \"lo0\".\n+# To set a routable address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up && ifconfig lo:1 2.2.2.2/32 up  # to set up\n+# ifconfig lo:0 down && ifconfig lo:1 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig em0 1.1.1.1/32 alias && ifconfig wlan0 2.2.2.2/32 alias  # to set up\n+# ifconfig em0 1.1.1.1 -alias && ifconfig wlan0 2.2.2.2 -alias  # to remove it, after the test\n+ADDR1 = '1.1.1.1'\n+ADDR2 = '2.2.2.2'\n+\n+BIND_PORT = 31001\n+\n+class BindPortDiscoverTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        # Avoid any -bind= on the command line. Force the framework to avoid adding -bind=127.0.0.1.\n+        self.setup_clean_chain = True\n+        self.bind_to_localhost_only = False\n+        self.extra_args = [\n+            ['-discover', '-port={}'.format(BIND_PORT)], # bind on any\n+            ['-discover', '-bind={}:{}'.format(ADDR1, BIND_PORT)],\n+        ]\n+        self.num_nodes = len(self.extra_args)\n+\n+    def add_options(self, parser):\n+        parser.add_argument(\n+            \"--ihave1111and2222\", action='store_true', dest=\"ihave1111and2222\",\n+            help=\"Run the test, assuming {} and {} are configured on the machine\".format(ADDR1, ADDR2),\n+            default=False)\n+\n+    def skip_test_if_missing_module(self):\n+        if not self.options.ihave1111and2222:\n+            raise SkipTest(\n+                \"To run this test make sure that {} and {} (a routable addresses) are assigned \"\n+                \"to the interfaces on this machine and rerun with --ihave1111and2222\".format(ADDR1, ADDR2))\n+\n+    def run_test(self):\n+        # Check that if no -bind= is given, then all addresses are added to localaddresses.\n+        found_addr1 = False\n+        found_addr2 = False\n+        for local in self.nodes[0].getnetworkinfo()['localaddresses']:\n+            if local['address'] == ADDR1:\n+                found_addr1 = True\n+                assert_equal(local['port'], BIND_PORT)\n+            if local['address'] == ADDR2:\n+                found_addr2 = True\n+                assert_equal(local['port'], BIND_PORT)\n+        assert(found_addr1)\n+        assert(found_addr2)\n+\n+        # Check that if -bind= is given, just that address is added to localaddresses.",
    "path": "test/functional/feature_bind_port_discover.py",
    "position": null,
    "original_position": 64,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2021-03-26T12:30:31Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602243355",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602243355"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602243355"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602243355/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 64,
    "side": "RIGHT",
    "in_reply_to_id": 596407395
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602278513",
    "pull_request_review_id": 622126013,
    "id": 602278513,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMjI3ODUxMw==",
    "diff_hunk": "@@ -725,8 +731,79 @@ BOOST_AUTO_TEST_CASE(ipv4_peer_with_ipv6_addrMe_test)\n \n     // suppress no-checks-run warning; if this test fails, it's by triggering a sanitizer\n     BOOST_CHECK(1);\n+\n+    // Cleanup, so that we don't confuse other tests.\n+    {\n+        LOCK(cs_mapLocalHost);\n+        mapLocalHost.erase(addr_in_mapLocalHost);\n+    }\n }\n \n+BOOST_AUTO_TEST_CASE(get_local_addr_for_peer_port)\n+{\n+    // Test that GetLocalAddrForPeer() properly selects the address for self-advertise:",
    "path": "src/test/net_tests.cpp",
    "position": null,
    "original_position": 66,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "0c24971f97d5e6b03aef4911a1f772b6ccfcd6b7",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2021-03-26T13:11:58Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602278513",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602278513"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r602278513"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/602278513/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 745,
    "side": "RIGHT",
    "in_reply_to_id": 597130602
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603630473",
    "pull_request_review_id": 623671461,
    "id": 603630473,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMzYzMDQ3Mw==",
    "diff_hunk": "@@ -726,8 +732,79 @@ BOOST_AUTO_TEST_CASE(ipv4_peer_with_ipv6_addrMe_test)\n \n     // suppress no-checks-run warning; if this test fails, it's by triggering a sanitizer\n     BOOST_CHECK(1);\n+\n+    // Cleanup, so that we don't confuse other tests.\n+    {\n+        LOCK(cs_mapLocalHost);\n+        mapLocalHost.erase(addr_in_mapLocalHost);\n+    }\n }\n \n+BOOST_AUTO_TEST_CASE(get_local_addr_for_peer_port)\n+{\n+    // Test that GetLocalAddrForPeer() properly selects the address to self-advertis:",
    "path": "src/test/net_tests.cpp",
    "position": null,
    "original_position": 67,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "7d5d2416e70925ee65bca455d88427335dc12008",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "```suggestion\r\n    // Test that GetLocalAddrForPeer() properly selects the address to self-advertise:\r\n```",
    "created_at": "2021-03-29T21:37:32Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r603630473",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603630473"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r603630473"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603630473/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 799,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603631261",
    "pull_request_review_id": 623671461,
    "id": 603631261,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMzYzMTI2MQ==",
    "diff_hunk": "@@ -0,0 +1,78 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020-2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that -discover does not add all interfaces' addresses if we listen just on only some of them",
    "path": "test/functional/feature_bind_port_discover.py",
    "position": null,
    "original_position": 6,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "7d5d2416e70925ee65bca455d88427335dc12008",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "```suggestion\r\nTest that -discover does not add all interfaces' addresses if we listen on only some of them\r\n```",
    "created_at": "2021-03-29T21:38:54Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r603631261",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603631261"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r603631261"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603631261/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 6,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603897791",
    "pull_request_review_id": 623671461,
    "id": 603897791,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMzg5Nzc5MQ==",
    "diff_hunk": "@@ -0,0 +1,75 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020-2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that the proper port is used for -externalip=\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal, p2p_port\n+\n+# We need to bind to a routable address for this test to exercise the relevant code.\n+# To set a routable address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up  # to set up\n+# ifconfig lo:0 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig lo0 1.1.1.1/32 alias  # to set up\n+# ifconfig lo0 1.1.1.1 -alias  # to remove it, after the test\n+ADDR = '1.1.1.1'\n+\n+# array of tuples [arguments, expected port in localaddresses]\n+EXPECTED = [\n+    [['-externalip=2.2.2.2',       '-port=30001'],                        30001],\n+    [['-externalip=2.2.2.2',       '-port=30002', f'-bind={ADDR}'],       30002],\n+    [['-externalip=2.2.2.2',                      f'-bind={ADDR}'],       'default_p2p_port'],\n+    [['-externalip=2.2.2.2',       '-port=30003', f'-bind={ADDR}:30004'], 30004],\n+    [['-externalip=2.2.2.2',                      f'-bind={ADDR}:30005'], 30005],\n+    [['-externalip=2.2.2.2:30006', '-port=30007'],                        30006],\n+    [['-externalip=2.2.2.2:30008', '-port=30009', f'-bind={ADDR}'],       30008],\n+    [['-externalip=2.2.2.2:30010',                f'-bind={ADDR}'],       30010],\n+    [['-externalip=2.2.2.2:30011', '-port=30012', f'-bind={ADDR}:30013'], 30011],\n+    [['-externalip=2.2.2.2:30014',                f'-bind={ADDR}:30015'], 30014],\n+    [['-externalip=2.2.2.2',       '-port=30016', f'-bind={ADDR}:30017',\n+                                             f'-whitebind={ADDR}:30018'], 30017],\n+    [['-externalip=2.2.2.2',       '-port=30019',\n+                                             f'-whitebind={ADDR}:30020'], 30020],\n+]\n+\n+class BindPortExternalIPTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        # Avoid any -bind= on the command line. Force the framework to avoid adding -bind=127.0.0.1.\n+        self.setup_clean_chain = True\n+        self.bind_to_localhost_only = False\n+        self.num_nodes = len(EXPECTED)\n+        self.extra_args = list(map(lambda e: e[0], EXPECTED))\n+\n+    def add_options(self, parser):\n+        parser.add_argument(\n+            \"--ihave1111\", action='store_true', dest=\"ihave1111\",\n+            help=f\"Run the test, assuming {ADDR} is configured on the machine\",\n+            default=False)\n+\n+    def skip_test_if_missing_module(self):\n+        if not self.options.ihave1111:\n+            raise SkipTest(\n+                f\"To run this test make sure that {ADDR} (a routable address) is assigned \"\n+                \"to one of the interfaces on this machine and rerun with --ihave1111\")\n+\n+    def run_test(self):\n+        for i in range(len(EXPECTED)):",
    "path": "test/functional/feature_bind_port_externalip.py",
    "position": 62,
    "original_position": 61,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "7d5d2416e70925ee65bca455d88427335dc12008",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "would be good to add the missing logging suggested in https://github.com/bitcoin/bitcoin/pull/20196#discussion_r596410851\r\n```diff\r\n     def run_test(self):\r\n+        self.log.info(\"Test the proper port is used for -externalip=\")\r\n         for i in range(len(EXPECTED)):\r\n             if EXPECTED[i][1] == 'default_p2p_port':\r\n                 expected_port = p2p_port(i)\r\n@@ -69,7 +70,8 @@ class BindPortExternalIPTest(BitcoinTestFramework):\r\n                     assert_equal(local['port'], expected_port)\r\n                     found = True\r\n                     break\r\n-            assert(found)\r\n+            assert found\r\n+\r\n```\r\nnit, remove brackets after the assert and two lines before the `main` section)",
    "created_at": "2021-03-30T08:39:42Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r603897791",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603897791"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r603897791"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/603897791/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 62,
    "original_line": 62,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/610612311",
    "pull_request_review_id": 632394163,
    "id": 610612311,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMDYxMjMxMQ==",
    "diff_hunk": "@@ -726,8 +732,79 @@ BOOST_AUTO_TEST_CASE(ipv4_peer_with_ipv6_addrMe_test)\n \n     // suppress no-checks-run warning; if this test fails, it's by triggering a sanitizer\n     BOOST_CHECK(1);\n+\n+    // Cleanup, so that we don't confuse other tests.\n+    {\n+        LOCK(cs_mapLocalHost);\n+        mapLocalHost.erase(addr_in_mapLocalHost);\n+    }\n }\n \n+BOOST_AUTO_TEST_CASE(get_local_addr_for_peer_port)\n+{\n+    // Test that GetLocalAddrForPeer() properly selects the address to self-advertis:",
    "path": "src/test/net_tests.cpp",
    "position": null,
    "original_position": 67,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "7d5d2416e70925ee65bca455d88427335dc12008",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Fixed.",
    "created_at": "2021-04-09T13:09:06Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r610612311",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/610612311"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r610612311"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/610612311/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 799,
    "side": "RIGHT",
    "in_reply_to_id": 603630473
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/610614554",
    "pull_request_review_id": 632397218,
    "id": 610614554,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMDYxNDU1NA==",
    "diff_hunk": "@@ -0,0 +1,78 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020-2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that -discover does not add all interfaces' addresses if we listen just on only some of them",
    "path": "test/functional/feature_bind_port_discover.py",
    "position": null,
    "original_position": 6,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "7d5d2416e70925ee65bca455d88427335dc12008",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Changed.",
    "created_at": "2021-04-09T13:12:13Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r610614554",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/610614554"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r610614554"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/610614554/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 6,
    "side": "RIGHT",
    "in_reply_to_id": 603631261
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/610618854",
    "pull_request_review_id": 632403230,
    "id": 610618854,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMDYxODg1NA==",
    "diff_hunk": "@@ -0,0 +1,75 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020-2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test that the proper port is used for -externalip=\n+\"\"\"\n+\n+from test_framework.test_framework import BitcoinTestFramework, SkipTest\n+from test_framework.util import assert_equal, p2p_port\n+\n+# We need to bind to a routable address for this test to exercise the relevant code.\n+# To set a routable address on the machine use:\n+# Linux:\n+# ifconfig lo:0 1.1.1.1/32 up  # to set up\n+# ifconfig lo:0 down  # to remove it, after the test\n+# FreeBSD:\n+# ifconfig lo0 1.1.1.1/32 alias  # to set up\n+# ifconfig lo0 1.1.1.1 -alias  # to remove it, after the test\n+ADDR = '1.1.1.1'\n+\n+# array of tuples [arguments, expected port in localaddresses]\n+EXPECTED = [\n+    [['-externalip=2.2.2.2',       '-port=30001'],                        30001],\n+    [['-externalip=2.2.2.2',       '-port=30002', f'-bind={ADDR}'],       30002],\n+    [['-externalip=2.2.2.2',                      f'-bind={ADDR}'],       'default_p2p_port'],\n+    [['-externalip=2.2.2.2',       '-port=30003', f'-bind={ADDR}:30004'], 30004],\n+    [['-externalip=2.2.2.2',                      f'-bind={ADDR}:30005'], 30005],\n+    [['-externalip=2.2.2.2:30006', '-port=30007'],                        30006],\n+    [['-externalip=2.2.2.2:30008', '-port=30009', f'-bind={ADDR}'],       30008],\n+    [['-externalip=2.2.2.2:30010',                f'-bind={ADDR}'],       30010],\n+    [['-externalip=2.2.2.2:30011', '-port=30012', f'-bind={ADDR}:30013'], 30011],\n+    [['-externalip=2.2.2.2:30014',                f'-bind={ADDR}:30015'], 30014],\n+    [['-externalip=2.2.2.2',       '-port=30016', f'-bind={ADDR}:30017',\n+                                             f'-whitebind={ADDR}:30018'], 30017],\n+    [['-externalip=2.2.2.2',       '-port=30019',\n+                                             f'-whitebind={ADDR}:30020'], 30020],\n+]\n+\n+class BindPortExternalIPTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        # Avoid any -bind= on the command line. Force the framework to avoid adding -bind=127.0.0.1.\n+        self.setup_clean_chain = True\n+        self.bind_to_localhost_only = False\n+        self.num_nodes = len(EXPECTED)\n+        self.extra_args = list(map(lambda e: e[0], EXPECTED))\n+\n+    def add_options(self, parser):\n+        parser.add_argument(\n+            \"--ihave1111\", action='store_true', dest=\"ihave1111\",\n+            help=f\"Run the test, assuming {ADDR} is configured on the machine\",\n+            default=False)\n+\n+    def skip_test_if_missing_module(self):\n+        if not self.options.ihave1111:\n+            raise SkipTest(\n+                f\"To run this test make sure that {ADDR} (a routable address) is assigned \"\n+                \"to one of the interfaces on this machine and rerun with --ihave1111\")\n+\n+    def run_test(self):\n+        for i in range(len(EXPECTED)):",
    "path": "test/functional/feature_bind_port_externalip.py",
    "position": 62,
    "original_position": 61,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "7d5d2416e70925ee65bca455d88427335dc12008",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2021-04-09T13:18:19Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r610618854",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/610618854"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r610618854"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/610618854/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 62,
    "original_line": 62,
    "side": "RIGHT",
    "in_reply_to_id": 603897791
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/610770148",
    "pull_request_review_id": 632609065,
    "id": 610770148,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMDc3MDE0OA==",
    "diff_hunk": "@@ -117,6 +117,32 @@ void CConnman::AddAddrFetch(const std::string& strDest)\n \n uint16_t GetListenPort()\n {\n+    // If -bind= is provided with \":port\" part, use that (first one if multiple are provided).\n+    for (const std::string& bind_arg : gArgs.GetArgs(\"-bind\")) {\n+        constexpr uint16_t dummy_port = 0;\n+        constexpr bool allow_lookup = false;\n+        CService bind_addr;\n+\n+        if (Lookup(bind_arg, bind_addr, dummy_port, allow_lookup)) {\n+            if (bind_addr.GetPort() != dummy_port) {\n+                return bind_addr.GetPort();\n+            }\n+        }\n+    }\n+\n+    // Otherwise, if -whitebind= without PF_NOBAN is provided, use that\n+    // (-whitebind= is required to have \":port\").\n+    for (const std::string& whitebind_arg : gArgs.GetArgs(\"-whitebind\")) {\n+        NetWhitebindPermissions whitebind;\n+        bilingual_str error;\n+        if (NetWhitebindPermissions::TryParse(whitebind_arg, whitebind, error)) {\n+            if (!(whitebind.m_flags & PF_NOBAN)) {",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 23,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "33b0a79df62d99baaf1e37f13a9c52b7bbe3955e",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "7d06e0b4c09d0faed2673cf18b51a77201a91222 `PF_NOBAN` is a multi-flag, so this will return false for both the \"noban\" and the \"download\" statuses. If you want it to be false only for noban, use `HasFlag()`\r\n\r\n```suggestion\r\n            if (!NetPermissions::HasFlag(whitebind.m_flags, NetPermissionFlags::PF_NOBAN)) {\r\n```\r\n\r\n(and if you want it to be false for both \"noban\" and \"download\" the following would be more explicit and simplify the change in #21506)\r\n\r\n```suggestion\r\n            if (!NetPermissions::HasFlag(whitebind.m_flags, NetPermissionFlags::PF_NOBAN) &&\r\n                !NetPermissions::HasFlag(whitebind.m_flags, NetPermissionFlags::PF_DOWNLOAD)) {\r\n```\r\n\r\nTo illustrate, these tests pass if added to `netbase_tests.cpp` in the \"netpermissions_test\":\r\n```cpp\r\n    // \"noban\" implies \"download\"\r\n    BOOST_CHECK(NetWhitebindPermissions::TryParse(\"noban@1.2.3.4:32\", whitebindPermissions, error));\r\n    BOOST_CHECK_EQUAL(whitebindPermissions.m_flags, PF_NOBAN);\r\n    BOOST_CHECK(NetPermissions::HasFlag(whitebindPermissions.m_flags, PF_NOBAN));\r\n    BOOST_CHECK(NetPermissions::HasFlag(whitebindPermissions.m_flags, PF_DOWNLOAD));\r\n    BOOST_CHECK(whitebindPermissions.m_flags & PF_NOBAN);\r\n    BOOST_CHECK(whitebindPermissions.m_flags & PF_DOWNLOAD);\r\n\r\n    // \"download\" excludes (does not imply) \"noban\"\r\n    BOOST_CHECK(NetWhitebindPermissions::TryParse(\"download@1.2.3.4:32\", whitebindPermissions, error));\r\n    BOOST_CHECK_EQUAL(whitebindPermissions.m_flags, PF_DOWNLOAD);\r\n    BOOST_CHECK(whitebindPermissions.m_flags != PF_NOBAN);\r\n    BOOST_CHECK(!NetPermissions::HasFlag(whitebindPermissions.m_flags, PF_NOBAN));\r\n    BOOST_CHECK(NetPermissions::HasFlag(whitebindPermissions.m_flags, PF_DOWNLOAD));\r\n    BOOST_CHECK(whitebindPermissions.m_flags & PF_NOBAN);\r\n    BOOST_CHECK(whitebindPermissions.m_flags & PF_DOWNLOAD);\r\n```\r\n",
    "created_at": "2021-04-09T16:45:06Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r610770148",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/610770148"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r610770148"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/610770148/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 139,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/612601895",
    "pull_request_review_id": 634798333,
    "id": 612601895,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMjYwMTg5NQ==",
    "diff_hunk": "@@ -117,6 +117,32 @@ void CConnman::AddAddrFetch(const std::string& strDest)\n \n uint16_t GetListenPort()\n {\n+    // If -bind= is provided with \":port\" part, use that (first one if multiple are provided).\n+    for (const std::string& bind_arg : gArgs.GetArgs(\"-bind\")) {\n+        constexpr uint16_t dummy_port = 0;\n+        constexpr bool allow_lookup = false;\n+        CService bind_addr;\n+\n+        if (Lookup(bind_arg, bind_addr, dummy_port, allow_lookup)) {\n+            if (bind_addr.GetPort() != dummy_port) {\n+                return bind_addr.GetPort();\n+            }\n+        }\n+    }\n+\n+    // Otherwise, if -whitebind= without PF_NOBAN is provided, use that\n+    // (-whitebind= is required to have \":port\").\n+    for (const std::string& whitebind_arg : gArgs.GetArgs(\"-whitebind\")) {\n+        NetWhitebindPermissions whitebind;\n+        bilingual_str error;\n+        if (NetWhitebindPermissions::TryParse(whitebind_arg, whitebind, error)) {\n+            if (!(whitebind.m_flags & PF_NOBAN)) {",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 23,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "33b0a79df62d99baaf1e37f13a9c52b7bbe3955e",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Good catch!\r\n\r\nPreviously, if `-whitebind=download@1.1.1.1:8765` was specified we would not have returned `8765` from `GetListenPort()` but we should have.",
    "created_at": "2021-04-13T16:28:51Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r612601895",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/612601895"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r612601895"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/612601895/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 139,
    "side": "RIGHT",
    "in_reply_to_id": 610770148
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/612676028",
    "pull_request_review_id": 634894630,
    "id": 612676028,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMjY3NjAyOA==",
    "diff_hunk": "@@ -117,6 +117,32 @@ void CConnman::AddAddrFetch(const std::string& strDest)\n \n uint16_t GetListenPort()\n {\n+    // If -bind= is provided with \":port\" part, use that (first one if multiple are provided).\n+    for (const std::string& bind_arg : gArgs.GetArgs(\"-bind\")) {\n+        constexpr uint16_t dummy_port = 0;\n+        constexpr bool allow_lookup = false;\n+        CService bind_addr;\n+\n+        if (Lookup(bind_arg, bind_addr, dummy_port, allow_lookup)) {\n+            if (bind_addr.GetPort() != dummy_port) {\n+                return bind_addr.GetPort();\n+            }\n+        }\n+    }\n+\n+    // Otherwise, if -whitebind= without PF_NOBAN is provided, use that\n+    // (-whitebind= is required to have \":port\").\n+    for (const std::string& whitebind_arg : gArgs.GetArgs(\"-whitebind\")) {\n+        NetWhitebindPermissions whitebind;\n+        bilingual_str error;\n+        if (NetWhitebindPermissions::TryParse(whitebind_arg, whitebind, error)) {\n+            if (!(whitebind.m_flags & PF_NOBAN)) {",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 23,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "33b0a79df62d99baaf1e37f13a9c52b7bbe3955e",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes, I've been working on this issue with #21644 that fixes the same issue and #21506 that would eliminate this form of `NetPermissionFlags` bug.\r\n\r\nCan you please use the `NetPermissionFlags::` scope as suggested in https://github.com/bitcoin/bitcoin/pull/20196#discussion_r610770148? This is already the case in other places and it would avoid an unnecessary future commit (or rebase of #21506).",
    "created_at": "2021-04-13T18:16:19Z",
    "updated_at": "2021-04-14T06:41:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r612676028",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/612676028"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r612676028"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/612676028/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 139,
    "side": "RIGHT",
    "in_reply_to_id": 610770148
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/635287348",
    "pull_request_review_id": 663272668,
    "id": 635287348,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzNTI4NzM0OA==",
    "diff_hunk": "@@ -118,6 +118,32 @@ void CConnman::AddAddrFetch(const std::string& strDest)\n \n uint16_t GetListenPort()\n {\n+    // If -bind= is provided with \":port\" part, use that (first one if multiple are provided).\n+    for (const std::string& bind_arg : gArgs.GetArgs(\"-bind\")) {\n+        constexpr uint16_t dummy_port = 0;\n+        constexpr bool allow_lookup = false;\n+        CService bind_addr;\n+\n+        if (Lookup(bind_arg, bind_addr, dummy_port, allow_lookup)) {\n+            if (bind_addr.GetPort() != dummy_port) {\n+                return bind_addr.GetPort();\n+            }\n+        }\n+    }\n+\n+    // Otherwise, if -whitebind= without \"noban\" is provided, use that",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 17,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "2519696300a356ba2876d37bb01ba620ad46bc0c",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit, while updating here could be consistent with 7075f604e8d0b21 (and sorry for causing the rebase)\r\n ```suggestion\r\n    // Otherwise, if -whitebind= without NetPermissionFlags::NoBan permission is provided, use that\r\n```",
    "created_at": "2021-05-19T14:20:53Z",
    "updated_at": "2021-05-19T14:24:29Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r635287348",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/635287348"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r635287348"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/635287348/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 134,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/635404933",
    "pull_request_review_id": 663427369,
    "id": 635404933,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzNTQwNDkzMw==",
    "diff_hunk": "@@ -118,6 +118,32 @@ void CConnman::AddAddrFetch(const std::string& strDest)\n \n uint16_t GetListenPort()\n {\n+    // If -bind= is provided with \":port\" part, use that (first one if multiple are provided).\n+    for (const std::string& bind_arg : gArgs.GetArgs(\"-bind\")) {\n+        constexpr uint16_t dummy_port = 0;\n+        constexpr bool allow_lookup = false;\n+        CService bind_addr;\n+\n+        if (Lookup(bind_arg, bind_addr, dummy_port, allow_lookup)) {\n+            if (bind_addr.GetPort() != dummy_port) {\n+                return bind_addr.GetPort();\n+            }\n+        }\n+    }\n+\n+    // Otherwise, if -whitebind= without \"noban\" is provided, use that",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 17,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "2519696300a356ba2876d37bb01ba620ad46bc0c",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2021-05-19T16:30:33Z",
    "updated_at": "2021-05-19T16:30:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r635404933",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/635404933"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r635404933"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/635404933/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 134,
    "side": "RIGHT",
    "in_reply_to_id": 635287348
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677448859",
    "pull_request_review_id": 715912928,
    "id": 677448859,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzQ0ODg1OQ==",
    "diff_hunk": "@@ -3102,3 +3141,9 @@ void CaptureMessage(const CAddress& addr, const std::string& msg_type, const Spa\n     ser_writedata32(f, size);\n     f.write((const char*)data.data(), data.size());\n }\n+\n+std::function<void(const CAddress& addr,\n+                   const std::string& msg_type,\n+                   const Span<const unsigned char>& data,",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 71,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "2aee1b92c5e9e72541586a304233636c9609f050",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "c8034d4 suggest passing the `Span` param here, line 3116 above, in `src/net.h` and in `src/test/net_tests.cpp` by value, as these are lightweight, and previous feedback elsewhere suggested the codebase should move toward passing them by value. (Have a look at `git grep \"Span<unsigned char>\"`)",
    "created_at": "2021-07-27T13:27:43Z",
    "updated_at": "2021-07-27T16:41:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r677448859",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677448859"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r677448859"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677448859/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3147,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677452191",
    "pull_request_review_id": 715912928,
    "id": 677452191,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzQ1MjE5MQ==",
    "diff_hunk": "@@ -1696,11 +1694,15 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     connOptions.nMaxOutboundLimit = 1024 * 1024 * args.GetArg(\"-maxuploadtarget\", DEFAULT_MAX_UPLOAD_TARGET);\n     connOptions.m_peer_connect_timeout = peer_connect_timeout;\n \n+    // Port to bind to if `-bind=addr` is provided without a `:port` suffix.\n+    const uint16_t default_bind_port =\n+        static_cast<uint16_t>(args.GetArg(\"-port\", Params().GetDefaultPort()));\n+\n     for (const std::string& bind_arg : args.GetArgs(\"-bind\")) {\n         CService bind_addr;\n         const size_t index = bind_arg.rfind('=');\n         if (index == std::string::npos) {\n-            if (Lookup(bind_arg, bind_addr, GetListenPort(), false)) {\n+            if (Lookup(bind_arg, bind_addr, default_bind_port, false)) {",
    "path": "src/init.cpp",
    "position": null,
    "original_position": 22,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "2aee1b92c5e9e72541586a304233636c9609f050",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "47606db1d721c45cbd053a9a7651b674e2bd4bb1 pico-suggestion while touching this line\r\n```suggestion\r\n            if (Lookup(bind_arg, bind_addr, default_bind_port, /* allow_lookup */ false)) {\r\n```",
    "created_at": "2021-07-27T13:31:28Z",
    "updated_at": "2021-07-27T15:42:52Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r677452191",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677452191"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r677452191"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677452191/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1705,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677456155",
    "pull_request_review_id": 715912928,
    "id": 677456155,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzQ1NjE1NQ==",
    "diff_hunk": "@@ -106,3 +107,12 @@ void AddTimeData(const CNetAddr& ip, int64_t nOffsetSample)\n         }\n     }\n }\n+\n+void TestOnlyResetTimeData()\n+{\n+    LOCK(g_timeoffset_mutex);\n+    nTimeOffset = 0;\n+    g_sources.clear();\n+    g_time_offsets = CMedianFilter<int64_t>(BITCOIN_TIMEDATA_MAX_SAMPLES, 0);",
    "path": "src/timedata.cpp",
    "position": null,
    "original_position": 82,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "2aee1b92c5e9e72541586a304233636c9609f050",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "1882599\r\n```diff\r\n@@ -39,7 +39,7 @@ int64_t GetAdjustedTime()\r\n #define BITCOIN_TIMEDATA_MAX_SAMPLES 200\r\n \r\n static std::set<CNetAddr> g_sources;\r\n-static CMedianFilter<int64_t> g_time_offsets(BITCOIN_TIMEDATA_MAX_SAMPLES, 0);\r\n+static CMedianFilter<int64_t> g_time_offsets{BITCOIN_TIMEDATA_MAX_SAMPLES, 0};\r\n static bool g_warning_emitted;\r\n \r\n void AddTimeData(const CNetAddr& ip, int64_t nOffsetSample)\r\n@@ -113,6 +113,6 @@ void TestOnlyResetTimeData()\r\n     LOCK(g_timeoffset_mutex);\r\n     nTimeOffset = 0;\r\n     g_sources.clear();\r\n-    g_time_offsets = CMedianFilter<int64_t>(BITCOIN_TIMEDATA_MAX_SAMPLES, 0);\r\n+    g_time_offsets = CMedianFilter<int64_t>{BITCOIN_TIMEDATA_MAX_SAMPLES, 0};\r\n     g_warning_emitted = false;\r\n }\r\n```\r\n",
    "created_at": "2021-07-27T13:35:52Z",
    "updated_at": "2021-07-27T15:42:52Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r677456155",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677456155"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r677456155"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677456155/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 116,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677494923",
    "pull_request_review_id": 715912928,
    "id": 677494923,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzQ5NDkyMw==",
    "diff_hunk": "@@ -215,7 +241,17 @@ std::optional<CAddress> GetLocalAddrForPeer(CNode *pnode)\n     if (IsPeerAddrLocalGood(pnode) && (!addrLocal.IsRoutable() ||\n          rng.randbits((GetnScore(addrLocal) > LOCAL_MANUAL) ? 3 : 1) == 0))\n     {\n-        addrLocal.SetIP(pnode->GetAddrLocal());\n+        if (pnode->IsInboundConn()) {\n+            // For inbound connections, assume both the address and the port\n+            // as seen from the peer.\n+            addrLocal = CAddress{pnode->GetAddrLocal(), addrLocal.nServices};",
    "path": "src/net.cpp",
    "position": 40,
    "original_position": 41,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "2aee1b92c5e9e72541586a304233636c9609f050",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "47606db verified that without this change, this assertion of the new test fails\r\n```\r\ntest/net_tests.cpp(836): error: in \"net_tests/get_local_addr_for_peer_port\": check *chosen_local_addr == peer_us has failed\r\n```\r\n",
    "created_at": "2021-07-27T14:17:09Z",
    "updated_at": "2021-07-27T15:42:52Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r677494923",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677494923"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r677494923"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677494923/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 249,
    "original_line": 249,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677503975",
    "pull_request_review_id": 715912928,
    "id": 677503975,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzUwMzk3NQ==",
    "diff_hunk": "@@ -120,6 +120,32 @@ void CConnman::AddAddrFetch(const std::string& strDest)\n \n uint16_t GetListenPort()\n {\n+    // If -bind= is provided with \":port\" part, use that (first one if multiple are provided).\n+    for (const std::string& bind_arg : gArgs.GetArgs(\"-bind\")) {\n+        constexpr uint16_t dummy_port = 0;\n+        constexpr bool allow_lookup = false;\n+        CService bind_addr;\n+\n+        if (Lookup(bind_arg, bind_addr, dummy_port, allow_lookup)) {\n+            if (bind_addr.GetPort() != dummy_port) {\n+                return bind_addr.GetPort();\n+            }\n+        }\n+    }",
    "path": "src/net.cpp",
    "position": 14,
    "original_position": 15,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "2aee1b92c5e9e72541586a304233636c9609f050",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "47606db verified that without this new section, the following asserts in this commit fail:\r\n```\r\ntest/net_tests.cpp(815): error: in \"net_tests/get_local_addr_for_peer_port\": check *chosen_local_addr == expected has failed\r\ntest/net_tests.cpp(1007): error: in \"net_tests/initial_advertise_from_version_message\": check sent has failed\r\n```\r\n\r\nAvoiding an unneeded declaration seems clearer to me: \r\n```diff\r\n     // If -bind= is provided with \":port\" part, use that (first one if multiple are provided).\r\n     for (const std::string& bind_arg : gArgs.GetArgs(\"-bind\")) {\r\n-        constexpr uint16_t dummy_port = 0;\r\n-        constexpr bool allow_lookup = false;\r\n         CService bind_addr;\r\n+        constexpr uint16_t dummy_port = 0;\r\n \r\n-        if (Lookup(bind_arg, bind_addr, dummy_port, allow_lookup)) {\r\n+        if (Lookup(bind_arg, bind_addr, dummy_port, /* allow_lookup */ false)) {\r\n             if (bind_addr.GetPort() != dummy_port) {\r\n                 return bind_addr.GetPort();\r\n             }\r\n```",
    "created_at": "2021-07-27T14:26:16Z",
    "updated_at": "2021-07-27T15:44:28Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r677503975",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677503975"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r677503975"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677503975/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 136,
    "original_line": 136,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677506617",
    "pull_request_review_id": 715912928,
    "id": 677506617,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzUwNjYxNw==",
    "diff_hunk": "@@ -120,6 +120,32 @@ void CConnman::AddAddrFetch(const std::string& strDest)\n \n uint16_t GetListenPort()\n {\n+    // If -bind= is provided with \":port\" part, use that (first one if multiple are provided).\n+    for (const std::string& bind_arg : gArgs.GetArgs(\"-bind\")) {\n+        constexpr uint16_t dummy_port = 0;\n+        constexpr bool allow_lookup = false;\n+        CService bind_addr;\n+\n+        if (Lookup(bind_arg, bind_addr, dummy_port, allow_lookup)) {\n+            if (bind_addr.GetPort() != dummy_port) {\n+                return bind_addr.GetPort();\n+            }\n+        }\n+    }\n+\n+    // Otherwise, if -whitebind= without NetPermissionFlags::NoBan is provided, use that\n+    // (-whitebind= is required to have \":port\").\n+    for (const std::string& whitebind_arg : gArgs.GetArgs(\"-whitebind\")) {\n+        NetWhitebindPermissions whitebind;\n+        bilingual_str error;\n+        if (NetWhitebindPermissions::TryParse(whitebind_arg, whitebind, error)) {\n+            if (!NetPermissions::HasFlag(whitebind.m_flags, NetPermissionFlags::NoBan)) {\n+                return whitebind.m_service.GetPort();\n+            }\n+        }\n+    }",
    "path": "src/net.cpp",
    "position": 26,
    "original_position": 27,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "2aee1b92c5e9e72541586a304233636c9609f050",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "47606db removing this new section causes no failure in the `net_tests` added in this commit, but it does raise in the added functional test:\r\n\r\n```\r\nFile \"~/bitcoin/test/functional/feature_bind_port_externalip.py\", line 69, in run_test\r\n    assert_equal(local['port'], expected_port)\r\n    raise AssertionError(\"not(%s)\" % \" == \".join(str(arg) for arg in (thing1, thing2) + args))\r\nAssertionError: not(30019 == 30020)\r\n```\r\n",
    "created_at": "2021-07-27T14:28:54Z",
    "updated_at": "2021-07-27T15:54:13Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r677506617",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677506617"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r677506617"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677506617/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 148,
    "original_line": 148,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677585956",
    "pull_request_review_id": 716098241,
    "id": 677585956,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3NzU4NTk1Ng==",
    "diff_hunk": "@@ -1745,6 +1747,12 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n         StartTorControl(onion_service_target);\n     }\n \n+    if (connOptions.bind_on_any) {\n+        // Only add all IP addresses of the machine if we would be listening on\n+        // any address - 0.0.0.0 (IPv4) and :: (IPv6).\n+        Discover();",
    "path": "src/init.cpp",
    "position": 33,
    "original_position": 33,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "2aee1b92c5e9e72541586a304233636c9609f050",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "2aee1b92 verified that without the change in this commit, the accompanying functional test fails at the expected assertion\r\n```\r\nFile \"~/bitcoin/test/functional/feature_bind_port_discover.py\", line 74, in run_test\r\n    assert local['address'] != ADDR2\r\nAssertionError\r\n```\r\n",
    "created_at": "2021-07-27T15:53:46Z",
    "updated_at": "2021-07-27T15:53:46Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r677585956",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677585956"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r677585956"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/677585956/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1771,
    "original_line": 1771,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679289444",
    "pull_request_review_id": 718279128,
    "id": 679289444,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3OTI4OTQ0NA==",
    "diff_hunk": "@@ -3102,3 +3141,9 @@ void CaptureMessage(const CAddress& addr, const std::string& msg_type, const Spa\n     ser_writedata32(f, size);\n     f.write((const char*)data.data(), data.size());\n }\n+\n+std::function<void(const CAddress& addr,\n+                   const std::string& msg_type,\n+                   const Span<const unsigned char>& data,",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 71,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "2aee1b92c5e9e72541586a304233636c9609f050",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2021-07-29T16:04:53Z",
    "updated_at": "2021-07-29T16:04:53Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r679289444",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679289444"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r679289444"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679289444/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3147,
    "side": "RIGHT",
    "in_reply_to_id": 677448859
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679289633",
    "pull_request_review_id": 718279378,
    "id": 679289633,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3OTI4OTYzMw==",
    "diff_hunk": "@@ -1696,11 +1694,15 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     connOptions.nMaxOutboundLimit = 1024 * 1024 * args.GetArg(\"-maxuploadtarget\", DEFAULT_MAX_UPLOAD_TARGET);\n     connOptions.m_peer_connect_timeout = peer_connect_timeout;\n \n+    // Port to bind to if `-bind=addr` is provided without a `:port` suffix.\n+    const uint16_t default_bind_port =\n+        static_cast<uint16_t>(args.GetArg(\"-port\", Params().GetDefaultPort()));\n+\n     for (const std::string& bind_arg : args.GetArgs(\"-bind\")) {\n         CService bind_addr;\n         const size_t index = bind_arg.rfind('=');\n         if (index == std::string::npos) {\n-            if (Lookup(bind_arg, bind_addr, GetListenPort(), false)) {\n+            if (Lookup(bind_arg, bind_addr, default_bind_port, false)) {",
    "path": "src/init.cpp",
    "position": null,
    "original_position": 22,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "2aee1b92c5e9e72541586a304233636c9609f050",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2021-07-29T16:05:07Z",
    "updated_at": "2021-07-29T16:05:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r679289633",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679289633"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r679289633"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679289633/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1705,
    "side": "RIGHT",
    "in_reply_to_id": 677452191
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679289756",
    "pull_request_review_id": 718279554,
    "id": 679289756,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3OTI4OTc1Ng==",
    "diff_hunk": "@@ -106,3 +107,12 @@ void AddTimeData(const CNetAddr& ip, int64_t nOffsetSample)\n         }\n     }\n }\n+\n+void TestOnlyResetTimeData()\n+{\n+    LOCK(g_timeoffset_mutex);\n+    nTimeOffset = 0;\n+    g_sources.clear();\n+    g_time_offsets = CMedianFilter<int64_t>(BITCOIN_TIMEDATA_MAX_SAMPLES, 0);",
    "path": "src/timedata.cpp",
    "position": null,
    "original_position": 82,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "2aee1b92c5e9e72541586a304233636c9609f050",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2021-07-29T16:05:19Z",
    "updated_at": "2021-07-29T16:05:19Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r679289756",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679289756"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r679289756"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679289756/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 116,
    "side": "RIGHT",
    "in_reply_to_id": 677456155
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679289908",
    "pull_request_review_id": 718279770,
    "id": 679289908,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY3OTI4OTkwOA==",
    "diff_hunk": "@@ -120,6 +120,32 @@ void CConnman::AddAddrFetch(const std::string& strDest)\n \n uint16_t GetListenPort()\n {\n+    // If -bind= is provided with \":port\" part, use that (first one if multiple are provided).\n+    for (const std::string& bind_arg : gArgs.GetArgs(\"-bind\")) {\n+        constexpr uint16_t dummy_port = 0;\n+        constexpr bool allow_lookup = false;\n+        CService bind_addr;\n+\n+        if (Lookup(bind_arg, bind_addr, dummy_port, allow_lookup)) {\n+            if (bind_addr.GetPort() != dummy_port) {\n+                return bind_addr.GetPort();\n+            }\n+        }\n+    }",
    "path": "src/net.cpp",
    "position": 14,
    "original_position": 15,
    "commit_id": "cb86c1fd20715c9a7e95dea1fd2ce6894d7e9ad5",
    "original_commit_id": "2aee1b92c5e9e72541586a304233636c9609f050",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2021-07-29T16:05:31Z",
    "updated_at": "2021-07-29T16:05:31Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r679289908",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679289908"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20196#discussion_r679289908"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20196"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/679289908/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 136,
    "original_line": 136,
    "side": "RIGHT",
    "in_reply_to_id": 677503975
  }
]