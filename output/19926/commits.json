[
  {
    "sha": "8acdea2b08d3de9512c8acb8e639a9ff566880d8",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4YWNkZWEyYjA4ZDNkZTk1MTJjOGFjYjhlNjM5YTlmZjU2Njg4MGQ4",
    "commit": {
      "author": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2020-09-02T19:05:27Z"
      },
      "committer": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2020-09-09T14:02:16Z"
      },
      "message": "gui: Add Tor icon\n\nCo-authored-by: bosch <bosch5@pm.me>",
      "tree": {
        "sha": "2b7b051105d735a896e1c46ce17f6e45462d7051",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2b7b051105d735a896e1c46ce17f6e45462d7051"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8acdea2b08d3de9512c8acb8e639a9ff566880d8",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE0dvyxLlvLev0wWZUQQEIES5+qB8FAl9Y4GgACgkQQQEIES5+\nqB+lzw//ZSHb6Whj7vbfT5LIzVyaao3yJb9mJbCQ7O9laFIbUVEbvxkZXZioDV1X\nZqA8KnKByOUIVhAXbWCu1IkPmCHGjZsAHn9J+XSjv5Gyfmp08s37wY5XmDjN2V/3\nzoExUfSOJc4v5jsAk6VZkdGtOXxpkiKJg75Tc5ac8WS+v9Y22m5ZwDi/llTbfmVO\nPfMhRmZ9zl6e0uRVoCTZd7ResH35N2etGwvh5nNbvQRDg7pC9+FOT89tNwNxEMvD\nDNHkLiJwLVDlBmxfhmgXUy3H7WBhI2Ad+u5Qg5ozXcO/NqOBB2beI80vWx74yKl3\nB8+3YoMxQxB/Y/NDN+CRSHQ1UawQTBJUmgERWGHd2DHkAgFTwwtbvtzmf9w4jbW4\nNR1B48KZtczXkN0QcLYKq/FNnZJDWRxqHcNwOllQ0Z5+Hip6OWdRHuTTRAoLf+3H\nN26XC8zxzj15kwSpv3/24zojXcf2jNV55QPxNlX0IaSlJg555JzRfrEyNhhF8yep\nGEzTwQB2RVEuyXPEqWOaA3aqTFkxm5NZN7j4TmP6SHfHhzy7qTVPmKISjxeykSzO\nXP5z22o5Iwp8SLKaA/0VvglQmKg8nsWYvUBBMO1/yvXciXFusVCmJgrEwe3uXYSE\nR87LX01YEAQ5QLv+qdaL7jtizqAfSdpgnuiAVTbQiP8jv2tAXq8=\n=yh64\n-----END PGP SIGNATURE-----",
        "payload": "tree 2b7b051105d735a896e1c46ce17f6e45462d7051\nparent 564e1ab0f3dc573bd3ea60a80f6649c361243df9\nauthor Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1599073527 +0300\ncommitter Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1599660136 +0300\n\ngui: Add Tor icon\n\nCo-authored-by: bosch <bosch5@pm.me>\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/8acdea2b08d3de9512c8acb8e639a9ff566880d8",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/8acdea2b08d3de9512c8acb8e639a9ff566880d8",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/8acdea2b08d3de9512c8acb8e639a9ff566880d8/comments",
    "author": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "564e1ab0f3dc573bd3ea60a80f6649c361243df9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/564e1ab0f3dc573bd3ea60a80f6649c361243df9",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/564e1ab0f3dc573bd3ea60a80f6649c361243df9"
      }
    ],
    "stats": {
      "total": 35,
      "additions": 35,
      "deletions": 0
    },
    "files": [
      {
        "sha": "2a057e549383c40861c412c293e94a731489b81e",
        "filename": "src/Makefile.qt.include",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/8acdea2b08d3de9512c8acb8e639a9ff566880d8/src/Makefile.qt.include",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/8acdea2b08d3de9512c8acb8e639a9ff566880d8/src/Makefile.qt.include",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.qt.include?ref=8acdea2b08d3de9512c8acb8e639a9ff566880d8",
        "patch": "@@ -200,6 +200,7 @@ RES_ICONS = \\\n   qt/res/icons/remove.png \\\n   qt/res/icons/send.png \\\n   qt/res/icons/synced.png \\\n+  qt/res/icons/tor_connected.png \\\n   qt/res/icons/transaction0.png \\\n   qt/res/icons/transaction2.png \\\n   qt/res/icons/transaction_abandoned.png \\"
      },
      {
        "sha": "60d4e93a28598ef2ce0a75abef2615c8b64e5473",
        "filename": "src/interfaces/node.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 0,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/8acdea2b08d3de9512c8acb8e639a9ff566880d8/src/interfaces/node.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/8acdea2b08d3de9512c8acb8e639a9ff566880d8/src/interfaces/node.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/interfaces/node.cpp?ref=8acdea2b08d3de9512c8acb8e639a9ff566880d8",
        "patch": "@@ -87,6 +87,12 @@ class NodeImpl : public Node\n         }\n     }\n     bool getProxy(Network net, proxyType& proxy_info) override { return GetProxy(net, proxy_info); }\n+\n+    bool hasTorOnlyConnections() override\n+    {\n+        return !fListen && !IsReachable(NET_IPV4) && !IsReachable(NET_IPV6) && IsReachable(NET_ONION);\n+    }\n+\n     size_t getNodeCount(CConnman::NumConnections flags) override\n     {\n         return m_context->connman ? m_context->connman->GetNodeCount(flags) : 0;"
      },
      {
        "sha": "50d4e690e5801b1a838ab051358efd2cd953eb54",
        "filename": "src/interfaces/node.h",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/8acdea2b08d3de9512c8acb8e639a9ff566880d8/src/interfaces/node.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/8acdea2b08d3de9512c8acb8e639a9ff566880d8/src/interfaces/node.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/interfaces/node.h?ref=8acdea2b08d3de9512c8acb8e639a9ff566880d8",
        "patch": "@@ -87,6 +87,9 @@ class Node\n     //! Get proxy.\n     virtual bool getProxy(Network net, proxyType& proxy_info) = 0;\n \n+    //! Check if Tor only connections are allowed by settings.\n+    virtual bool hasTorOnlyConnections() = 0;\n+\n     //! Get number of connections.\n     virtual size_t getNodeCount(CConnman::NumConnections flags) = 0;\n "
      },
      {
        "sha": "4d8707baeb25900832c4ee66ad2eed7f47f7e14b",
        "filename": "src/qt/bitcoin.qrc",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/8acdea2b08d3de9512c8acb8e639a9ff566880d8/src/qt/bitcoin.qrc",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/8acdea2b08d3de9512c8acb8e639a9ff566880d8/src/qt/bitcoin.qrc",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoin.qrc?ref=8acdea2b08d3de9512c8acb8e639a9ff566880d8",
        "patch": "@@ -43,6 +43,7 @@\n         <file alias=\"hd_enabled\">res/icons/hd_enabled.png</file>\n         <file alias=\"hd_disabled\">res/icons/hd_disabled.png</file>\n         <file alias=\"network_disabled\">res/icons/network_disabled.png</file>\n+        <file alias=\"tor_connected\">res/icons/tor_connected.png</file>\n         <file alias=\"proxy\">res/icons/proxy.png</file>\n     </qresource>\n     <qresource prefix=\"/animation\">"
      },
      {
        "sha": "75761215f7478235ff6d76be9da92997993c2383",
        "filename": "src/qt/bitcoingui.cpp",
        "status": "modified",
        "additions": 15,
        "deletions": 0,
        "changes": 15,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/8acdea2b08d3de9512c8acb8e639a9ff566880d8/src/qt/bitcoingui.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/8acdea2b08d3de9512c8acb8e639a9ff566880d8/src/qt/bitcoingui.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoingui.cpp?ref=8acdea2b08d3de9512c8acb8e639a9ff566880d8",
        "patch": "@@ -77,6 +77,7 @@ const std::string BitcoinGUI::DEFAULT_UIPLATFORM =\n BitcoinGUI::BitcoinGUI(interfaces::Node& node, const PlatformStyle *_platformStyle, const NetworkStyle *networkStyle, QWidget *parent) :\n     QMainWindow(parent),\n     m_node(node),\n+    m_tor_icon{new GUIUtil::ClickableLabel()},\n     trayIconMenu{new QMenu()},\n     platformStyle(_platformStyle),\n     m_network_style(networkStyle)\n@@ -160,6 +161,7 @@ BitcoinGUI::BitcoinGUI(interfaces::Node& node, const PlatformStyle *_platformSty\n         frameBlocksLayout->addWidget(labelWalletEncryptionIcon);\n         frameBlocksLayout->addWidget(labelWalletHDStatusIcon);\n     }\n+    frameBlocksLayout->addWidget(m_tor_icon);\n     frameBlocksLayout->addWidget(labelProxyIcon);\n     frameBlocksLayout->addStretch();\n     frameBlocksLayout->addWidget(connectionsControl);\n@@ -202,6 +204,9 @@ BitcoinGUI::BitcoinGUI(interfaces::Node& node, const PlatformStyle *_platformSty\n     connect(labelProxyIcon, &GUIUtil::ClickableLabel::clicked, [this] {\n         openOptionsDialogWithTab(OptionsDialog::TAB_NETWORK);\n     });\n+    connect(m_tor_icon, &GUIUtil::ClickableLabel::clicked, [this] {\n+        openOptionsDialogWithTab(OptionsDialog::TAB_NETWORK);\n+    });\n \n     connect(labelBlocksIcon, &GUIUtil::ClickableLabel::clicked, this, &BitcoinGUI::showModalOverlay);\n     connect(progressBar, &GUIUtil::ClickableProgressBar::clicked, this, &BitcoinGUI::showModalOverlay);\n@@ -602,6 +607,7 @@ void BitcoinGUI::setClientModel(ClientModel *_clientModel, interfaces::BlockAndH\n \n         rpcConsole->setClientModel(_clientModel, tip_info->block_height, tip_info->block_time, tip_info->verification_progress);\n \n+        updateTorIcon();\n         updateProxyIcon();\n \n #ifdef ENABLE_WALLET\n@@ -1317,6 +1323,15 @@ void BitcoinGUI::updateProxyIcon()\n     }\n }\n \n+void BitcoinGUI::updateTorIcon()\n+{\n+    if (clientModel->hasTorOnlyConnections()) {\n+        m_tor_icon->setPixmap(platformStyle->SingleColorIcon(\":/icons/tor_connected\").pixmap(STATUSBAR_ICONSIZE, STATUSBAR_ICONSIZE));\n+        m_tor_icon->setToolTip(tr(\"All connections are <b>via Tor</b> only\"));\n+        m_tor_icon->show();\n+    }\n+}\n+\n void BitcoinGUI::updateWindowTitle()\n {\n     QString window_title = PACKAGE_NAME;"
      },
      {
        "sha": "f9816a3f651b0f7f42cb0f5a03ab0859b15daa6f",
        "filename": "src/qt/bitcoingui.h",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/8acdea2b08d3de9512c8acb8e639a9ff566880d8/src/qt/bitcoingui.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/8acdea2b08d3de9512c8acb8e639a9ff566880d8/src/qt/bitcoingui.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoingui.h?ref=8acdea2b08d3de9512c8acb8e639a9ff566880d8",
        "patch": "@@ -121,6 +121,7 @@ class BitcoinGUI : public QMainWindow\n     UnitDisplayStatusBarControl* unitDisplayControl = nullptr;\n     QLabel* labelWalletEncryptionIcon = nullptr;\n     QLabel* labelWalletHDStatusIcon = nullptr;\n+    GUIUtil::ClickableLabel* m_tor_icon{nullptr};\n     GUIUtil::ClickableLabel* labelProxyIcon = nullptr;\n     GUIUtil::ClickableLabel* connectionsControl = nullptr;\n     GUIUtil::ClickableLabel* labelBlocksIcon = nullptr;\n@@ -263,6 +264,7 @@ public Q_SLOTS:\n private:\n     /** Set the proxy-enabled icon as shown in the UI. */\n     void updateProxyIcon();\n+    void updateTorIcon();\n     void updateWindowTitle();\n \n public Q_SLOTS:"
      },
      {
        "sha": "f0f524deae718ad702727eb5e6c5443a3b847c01",
        "filename": "src/qt/clientmodel.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 0,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/8acdea2b08d3de9512c8acb8e639a9ff566880d8/src/qt/clientmodel.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/8acdea2b08d3de9512c8acb8e639a9ff566880d8/src/qt/clientmodel.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/clientmodel.cpp?ref=8acdea2b08d3de9512c8acb8e639a9ff566880d8",
        "patch": "@@ -320,3 +320,8 @@ bool ClientModel::getProxyInfo(std::string& ip_port) const\n     }\n     return false;\n }\n+\n+bool ClientModel::hasTorOnlyConnections() const\n+{\n+    return m_node.hasTorOnlyConnections();\n+}"
      },
      {
        "sha": "e5adae6b07de8485f976ed32f393945fab2b9307",
        "filename": "src/qt/clientmodel.h",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/8acdea2b08d3de9512c8acb8e639a9ff566880d8/src/qt/clientmodel.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/8acdea2b08d3de9512c8acb8e639a9ff566880d8/src/qt/clientmodel.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/clientmodel.h?ref=8acdea2b08d3de9512c8acb8e639a9ff566880d8",
        "patch": "@@ -77,6 +77,8 @@ class ClientModel : public QObject\n \n     bool getProxyInfo(std::string& ip_port) const;\n \n+    bool hasTorOnlyConnections() const;\n+\n     // caches for the best header: hash, number of blocks and block time\n     mutable std::atomic<int> cachedBestHeaderHeight;\n     mutable std::atomic<int64_t> cachedBestHeaderTime;"
      },
      {
        "sha": "5d9774497ab00ca20cbad3a3ca7fcce380005901",
        "filename": "src/qt/res/icons/tor_connected.png",
        "status": "added",
        "additions": 0,
        "deletions": 0,
        "changes": 0,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/8acdea2b08d3de9512c8acb8e639a9ff566880d8/src/qt/res/icons/tor_connected.png",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/8acdea2b08d3de9512c8acb8e639a9ff566880d8/src/qt/res/icons/tor_connected.png",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/res/icons/tor_connected.png?ref=8acdea2b08d3de9512c8acb8e639a9ff566880d8"
      }
    ]
  }
]