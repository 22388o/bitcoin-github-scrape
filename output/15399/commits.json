[
  {
    "sha": "fabcfa5f0cfe2484fe5cf5ced7cbae34a35c47c9",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYWJjZmE1ZjBjZmUyNDg0ZmU1Y2Y1Y2VkN2NiYWUzNGEzNWM0N2M5",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2019-02-13T16:49:00Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2019-02-13T16:46:36Z"
      },
      "message": "fuzz: Move deserialize tests to test/fuzz/deserialize.cpp",
      "tree": {
        "sha": "4e6bf4d248686db84203172532d353dd7721a553",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4e6bf4d248686db84203172532d353dd7721a553"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fabcfa5f0cfe2484fe5cf5ced7cbae34a35c47c9",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGcBAABCgAGBQJcZEnsAAoJEM4rdWl+aaVIaS4L/RM8mhH5zht1WOpiw/+V6rPf\nZf4Ra4KxQMBSqnBIYSZvsjdIQxEVyPHgR8G/b3W3E3gISmghZ7fPPwGUFDieDFC5\nXv3RXlujLfX/zwRLy8RlUVkFXqMwjg3yz6dQKJVU4dX/RlGyTZKz5AHkzYe8E+3t\n83JfkbKIoJHIM8J3En9poOHX5v7Ex54B5BXdXUvKM7NMS5av0KOkQn0RsHduWx1e\nGt4P4tRixvQQPdK+4hlde3Bb988xPJPNpThkx34MGLz5Yjfv2SENSzl2KYW12CJR\ntkwyP3naflmnJj+Kc9RSpSJq8dXKCnKdTnoIhpxpwQ11MQIftmpsWCLcBLLh4Ec8\nigHQ0LbstM3GZKvZj8inT05uVv6RLyZVCvnhmtyjGna8g11hisqD7vLjiDOp5FWe\nZHrjQTc5yvDlgCZOrSbR6DxftaBy4DvBPL4Rk5ZdI8EIxXfiNdAxHDXZe1w2EgLv\nQa8REPIS7p66i55GlFxRPVjiifLNdLeA47sGrL54LA==\n=8J1P\n-----END PGP SIGNATURE-----",
        "payload": "tree 4e6bf4d248686db84203172532d353dd7721a553\nparent d73918447faf168670b5dfdd55f6c19ed6dd8632\nauthor MarcoFalke <falke.marco@gmail.com> 1550076540 -0500\ncommitter MarcoFalke <falke.marco@gmail.com> 1550076396 -0500\n\nfuzz: Move deserialize tests to test/fuzz/deserialize.cpp\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fabcfa5f0cfe2484fe5cf5ced7cbae34a35c47c9",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fabcfa5f0cfe2484fe5cf5ced7cbae34a35c47c9",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fabcfa5f0cfe2484fe5cf5ced7cbae34a35c47c9/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "d73918447faf168670b5dfdd55f6c19ed6dd8632",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d73918447faf168670b5dfdd55f6c19ed6dd8632",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/d73918447faf168670b5dfdd55f6c19ed6dd8632"
      }
    ],
    "stats": {
      "total": 40,
      "additions": 20,
      "deletions": 20
    },
    "files": [
      {
        "sha": "f7007050f2289ad173a2bcadf1692189e5a09d01",
        "filename": "src/Makefile.test.include",
        "status": "modified",
        "additions": 20,
        "deletions": 20,
        "changes": 40,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fabcfa5f0cfe2484fe5cf5ced7cbae34a35c47c9/src/Makefile.test.include",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fabcfa5f0cfe2484fe5cf5ced7cbae34a35c47c9/src/Makefile.test.include",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.test.include?ref=fabcfa5f0cfe2484fe5cf5ced7cbae34a35c47c9",
        "patch": "@@ -171,7 +171,7 @@ test_test_bitcoin_LDADD += $(ZMQ_LIBS)\n endif\n \n if ENABLE_FUZZ\n-test_fuzz_block_deserialize_SOURCES = $(FUZZ_SUITE) test/test_bitcoin_fuzzy.cpp\n+test_fuzz_block_deserialize_SOURCES = $(FUZZ_SUITE) test/fuzz/deserialize.cpp\n test_fuzz_block_deserialize_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES) -DBLOCK_DESERIALIZE=1\n test_fuzz_block_deserialize_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n test_fuzz_block_deserialize_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n@@ -188,7 +188,7 @@ test_fuzz_block_deserialize_LDADD = \\\n  $(LIBSECP256K1)\n test_fuzz_block_deserialize_LDADD += $(BOOST_LIBS) $(CRYPTO_LIBS)\n \n-test_fuzz_transaction_deserialize_SOURCES = $(FUZZ_SUITE) test/test_bitcoin_fuzzy.cpp\n+test_fuzz_transaction_deserialize_SOURCES = $(FUZZ_SUITE) test/fuzz/deserialize.cpp\n test_fuzz_transaction_deserialize_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES) -DTRANSACTION_DESERIALIZE=1\n test_fuzz_transaction_deserialize_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n test_fuzz_transaction_deserialize_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n@@ -205,7 +205,7 @@ test_fuzz_transaction_deserialize_LDADD = \\\n  $(LIBSECP256K1)\n test_fuzz_transaction_deserialize_LDADD += $(BOOST_LIBS) $(CRYPTO_LIBS)\n \n-test_fuzz_blocklocator_deserialize_SOURCES = $(FUZZ_SUITE) test/test_bitcoin_fuzzy.cpp\n+test_fuzz_blocklocator_deserialize_SOURCES = $(FUZZ_SUITE) test/fuzz/deserialize.cpp\n test_fuzz_blocklocator_deserialize_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES) -DBLOCKLOCATOR_DESERIALIZE=1\n test_fuzz_blocklocator_deserialize_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n test_fuzz_blocklocator_deserialize_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n@@ -222,7 +222,7 @@ test_fuzz_blocklocator_deserialize_LDADD = \\\n  $(LIBSECP256K1)\n test_fuzz_blocklocator_deserialize_LDADD += $(BOOST_LIBS) $(CRYPTO_LIBS)\n \n-test_fuzz_blockmerkleroot_SOURCES = $(FUZZ_SUITE) test/test_bitcoin_fuzzy.cpp\n+test_fuzz_blockmerkleroot_SOURCES = $(FUZZ_SUITE) test/fuzz/deserialize.cpp\n test_fuzz_blockmerkleroot_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES) -DBLOCKMERKLEROOT=1\n test_fuzz_blockmerkleroot_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n test_fuzz_blockmerkleroot_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n@@ -239,7 +239,7 @@ test_fuzz_blockmerkleroot_LDADD = \\\n  $(LIBSECP256K1)\n test_fuzz_blockmerkleroot_LDADD += $(BOOST_LIBS) $(CRYPTO_LIBS)\n \n-test_fuzz_addrman_deserialize_SOURCES = $(FUZZ_SUITE) test/test_bitcoin_fuzzy.cpp\n+test_fuzz_addrman_deserialize_SOURCES = $(FUZZ_SUITE) test/fuzz/deserialize.cpp\n test_fuzz_addrman_deserialize_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES) -DADDRMAN_DESERIALIZE=1\n test_fuzz_addrman_deserialize_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n test_fuzz_addrman_deserialize_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n@@ -256,7 +256,7 @@ test_fuzz_addrman_deserialize_LDADD = \\\n  $(LIBSECP256K1)\n test_fuzz_addrman_deserialize_LDADD += $(BOOST_LIBS) $(CRYPTO_LIBS)\n \n-test_fuzz_blockheader_deserialize_SOURCES = $(FUZZ_SUITE) test/test_bitcoin_fuzzy.cpp\n+test_fuzz_blockheader_deserialize_SOURCES = $(FUZZ_SUITE) test/fuzz/deserialize.cpp\n test_fuzz_blockheader_deserialize_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES) -DBLOCKHEADER_DESERIALIZE=1\n test_fuzz_blockheader_deserialize_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n test_fuzz_blockheader_deserialize_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n@@ -273,7 +273,7 @@ test_fuzz_blockheader_deserialize_LDADD = \\\n  $(LIBSECP256K1)\n test_fuzz_blockheader_deserialize_LDADD += $(BOOST_LIBS) $(CRYPTO_LIBS)\n \n-test_fuzz_banentry_deserialize_SOURCES = $(FUZZ_SUITE) test/test_bitcoin_fuzzy.cpp\n+test_fuzz_banentry_deserialize_SOURCES = $(FUZZ_SUITE) test/fuzz/deserialize.cpp\n test_fuzz_banentry_deserialize_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES) -DBANENTRY_DESERIALIZE=1\n test_fuzz_banentry_deserialize_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n test_fuzz_banentry_deserialize_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n@@ -290,7 +290,7 @@ test_fuzz_banentry_deserialize_LDADD = \\\n  $(LIBSECP256K1)\n test_fuzz_banentry_deserialize_LDADD += $(BOOST_LIBS) $(CRYPTO_LIBS)\n \n-test_fuzz_txundo_deserialize_SOURCES = $(FUZZ_SUITE) test/test_bitcoin_fuzzy.cpp\n+test_fuzz_txundo_deserialize_SOURCES = $(FUZZ_SUITE) test/fuzz/deserialize.cpp\n test_fuzz_txundo_deserialize_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES) -DTXUNDO_DESERIALIZE=1\n test_fuzz_txundo_deserialize_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n test_fuzz_txundo_deserialize_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n@@ -307,7 +307,7 @@ test_fuzz_txundo_deserialize_LDADD = \\\n  $(LIBSECP256K1)\n test_fuzz_txundo_deserialize_LDADD += $(BOOST_LIBS) $(CRYPTO_LIBS)\n \n-test_fuzz_blockundo_deserialize_SOURCES = $(FUZZ_SUITE) test/test_bitcoin_fuzzy.cpp\n+test_fuzz_blockundo_deserialize_SOURCES = $(FUZZ_SUITE) test/fuzz/deserialize.cpp\n test_fuzz_blockundo_deserialize_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES) -DBLOCKUNDO_DESERIALIZE=1\n test_fuzz_blockundo_deserialize_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n test_fuzz_blockundo_deserialize_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n@@ -324,7 +324,7 @@ test_fuzz_blockundo_deserialize_LDADD = \\\n  $(LIBSECP256K1)\n test_fuzz_blockundo_deserialize_LDADD += $(BOOST_LIBS) $(CRYPTO_LIBS)\n \n-test_fuzz_coins_deserialize_SOURCES = $(FUZZ_SUITE) test/test_bitcoin_fuzzy.cpp\n+test_fuzz_coins_deserialize_SOURCES = $(FUZZ_SUITE) test/fuzz/deserialize.cpp\n test_fuzz_coins_deserialize_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES) -DCOINS_DESERIALIZE=1\n test_fuzz_coins_deserialize_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n test_fuzz_coins_deserialize_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n@@ -341,7 +341,7 @@ test_fuzz_coins_deserialize_LDADD = \\\n  $(LIBSECP256K1)\n test_fuzz_coins_deserialize_LDADD += $(BOOST_LIBS) $(CRYPTO_LIBS)\n \n-test_fuzz_netaddr_deserialize_SOURCES = $(FUZZ_SUITE) test/test_bitcoin_fuzzy.cpp\n+test_fuzz_netaddr_deserialize_SOURCES = $(FUZZ_SUITE) test/fuzz/deserialize.cpp\n test_fuzz_netaddr_deserialize_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES) -DNETADDR_DESERIALIZE=1\n test_fuzz_netaddr_deserialize_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n test_fuzz_netaddr_deserialize_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n@@ -358,7 +358,7 @@ test_fuzz_netaddr_deserialize_LDADD = \\\n  $(LIBSECP256K1)\n test_fuzz_netaddr_deserialize_LDADD += $(BOOST_LIBS) $(CRYPTO_LIBS)\n \n-test_fuzz_service_deserialize_SOURCES = $(FUZZ_SUITE) test/test_bitcoin_fuzzy.cpp\n+test_fuzz_service_deserialize_SOURCES = $(FUZZ_SUITE) test/fuzz/deserialize.cpp\n test_fuzz_service_deserialize_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES) -DSERVICE_DESERIALIZE=1\n test_fuzz_service_deserialize_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n test_fuzz_service_deserialize_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n@@ -375,7 +375,7 @@ test_fuzz_service_deserialize_LDADD = \\\n  $(LIBSECP256K1)\n test_fuzz_service_deserialize_LDADD += $(BOOST_LIBS) $(CRYPTO_LIBS)\n \n-test_fuzz_messageheader_deserialize_SOURCES = $(FUZZ_SUITE) test/test_bitcoin_fuzzy.cpp\n+test_fuzz_messageheader_deserialize_SOURCES = $(FUZZ_SUITE) test/fuzz/deserialize.cpp\n test_fuzz_messageheader_deserialize_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES) -DMESSAGEHEADER_DESERIALIZE=1\n test_fuzz_messageheader_deserialize_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n test_fuzz_messageheader_deserialize_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n@@ -392,7 +392,7 @@ test_fuzz_messageheader_deserialize_LDADD = \\\n  $(LIBSECP256K1)\n test_fuzz_messageheader_deserialize_LDADD += $(BOOST_LIBS) $(CRYPTO_LIBS)\n \n-test_fuzz_address_deserialize_SOURCES = $(FUZZ_SUITE) test/test_bitcoin_fuzzy.cpp\n+test_fuzz_address_deserialize_SOURCES = $(FUZZ_SUITE) test/fuzz/deserialize.cpp\n test_fuzz_address_deserialize_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES) -DADDRESS_DESERIALIZE=1\n test_fuzz_address_deserialize_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n test_fuzz_address_deserialize_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n@@ -409,7 +409,7 @@ test_fuzz_address_deserialize_LDADD = \\\n  $(LIBSECP256K1)\n test_fuzz_address_deserialize_LDADD += $(BOOST_LIBS) $(CRYPTO_LIBS)\n \n-test_fuzz_inv_deserialize_SOURCES = $(FUZZ_SUITE) test/test_bitcoin_fuzzy.cpp\n+test_fuzz_inv_deserialize_SOURCES = $(FUZZ_SUITE) test/fuzz/deserialize.cpp\n test_fuzz_inv_deserialize_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES) -DINV_DESERIALIZE=1\n test_fuzz_inv_deserialize_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n test_fuzz_inv_deserialize_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n@@ -426,7 +426,7 @@ test_fuzz_inv_deserialize_LDADD = \\\n  $(LIBSECP256K1)\n test_fuzz_inv_deserialize_LDADD += $(BOOST_LIBS) $(CRYPTO_LIBS)\n \n-test_fuzz_bloomfilter_deserialize_SOURCES = $(FUZZ_SUITE) test/test_bitcoin_fuzzy.cpp\n+test_fuzz_bloomfilter_deserialize_SOURCES = $(FUZZ_SUITE) test/fuzz/deserialize.cpp\n test_fuzz_bloomfilter_deserialize_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES) -DBLOOMFILTER_DESERIALIZE=1\n test_fuzz_bloomfilter_deserialize_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n test_fuzz_bloomfilter_deserialize_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n@@ -443,7 +443,7 @@ test_fuzz_bloomfilter_deserialize_LDADD = \\\n  $(LIBSECP256K1)\n test_fuzz_bloomfilter_deserialize_LDADD += $(BOOST_LIBS) $(CRYPTO_LIBS)\n \n-test_fuzz_diskblockindex_deserialize_SOURCES = $(FUZZ_SUITE) test/test_bitcoin_fuzzy.cpp\n+test_fuzz_diskblockindex_deserialize_SOURCES = $(FUZZ_SUITE) test/fuzz/deserialize.cpp\n test_fuzz_diskblockindex_deserialize_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES) -DDISKBLOCKINDEX_DESERIALIZE=1\n test_fuzz_diskblockindex_deserialize_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n test_fuzz_diskblockindex_deserialize_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n@@ -460,7 +460,7 @@ test_fuzz_diskblockindex_deserialize_LDADD = \\\n  $(LIBSECP256K1)\n test_fuzz_diskblockindex_deserialize_LDADD += $(BOOST_LIBS) $(CRYPTO_LIBS)\n \n-test_fuzz_txoutcompressor_deserialize_SOURCES = $(FUZZ_SUITE) test/test_bitcoin_fuzzy.cpp\n+test_fuzz_txoutcompressor_deserialize_SOURCES = $(FUZZ_SUITE) test/fuzz/deserialize.cpp\n test_fuzz_txoutcompressor_deserialize_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES) -DTXOUTCOMPRESSOR_DESERIALIZE=1\n test_fuzz_txoutcompressor_deserialize_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n test_fuzz_txoutcompressor_deserialize_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n@@ -477,7 +477,7 @@ test_fuzz_txoutcompressor_deserialize_LDADD = \\\n  $(LIBSECP256K1)\n test_fuzz_txoutcompressor_deserialize_LDADD += $(BOOST_LIBS) $(CRYPTO_LIBS)\n \n-test_fuzz_blocktransactions_deserialize_SOURCES = $(FUZZ_SUITE) test/test_bitcoin_fuzzy.cpp\n+test_fuzz_blocktransactions_deserialize_SOURCES = $(FUZZ_SUITE) test/fuzz/deserialize.cpp\n test_fuzz_blocktransactions_deserialize_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES) -DBLOCKTRANSACTIONS_DESERIALIZE=1\n test_fuzz_blocktransactions_deserialize_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n test_fuzz_blocktransactions_deserialize_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n@@ -494,7 +494,7 @@ test_fuzz_blocktransactions_deserialize_LDADD = \\\n  $(LIBSECP256K1)\n test_fuzz_blocktransactions_deserialize_LDADD += $(BOOST_LIBS) $(CRYPTO_LIBS)\n \n-test_fuzz_blocktransactionsrequest_deserialize_SOURCES = $(FUZZ_SUITE) test/test_bitcoin_fuzzy.cpp\n+test_fuzz_blocktransactionsrequest_deserialize_SOURCES = $(FUZZ_SUITE) test/fuzz/deserialize.cpp\n test_fuzz_blocktransactionsrequest_deserialize_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES) -DBLOCKTRANSACTIONSREQUEST_DESERIALIZE=1\n test_fuzz_blocktransactionsrequest_deserialize_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n test_fuzz_blocktransactionsrequest_deserialize_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)"
      },
      {
        "sha": "859fba0bdc19dfb0024bd16e02091c4419d753ed",
        "filename": "src/test/fuzz/deserialize.cpp",
        "status": "renamed",
        "additions": 0,
        "deletions": 0,
        "changes": 0,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fabcfa5f0cfe2484fe5cf5ced7cbae34a35c47c9/src/test/fuzz/deserialize.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fabcfa5f0cfe2484fe5cf5ced7cbae34a35c47c9/src/test/fuzz/deserialize.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/deserialize.cpp?ref=fabcfa5f0cfe2484fe5cf5ced7cbae34a35c47c9",
        "previous_filename": "src/test/test_bitcoin_fuzzy.cpp"
      }
    ]
  },
  {
    "sha": "fab15ff70e8db26942db83a9aab7ebf974e8b6b2",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYWIxNWZmNzBlOGRiMjY5NDJkYjgzYTlhYWI3ZWJmOTc0ZThiNmIy",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2019-02-13T19:25:49Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2019-02-13T19:53:57Z"
      },
      "message": "fuzz: Script validation flags",
      "tree": {
        "sha": "d53a64bc8bc3a0e3db277d5d724489047a39bde6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d53a64bc8bc3a0e3db277d5d724489047a39bde6"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fab15ff70e8db26942db83a9aab7ebf974e8b6b2",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGcBAABCgAGBQJcZHXVAAoJEM4rdWl+aaVIkW8MAKFuFJwLBfR3AVaCw4pnIpp9\nyHGXBHVr3Yzk1lShikTTwPsobju1CDaSufKcGCiSP+IC+I+z/RAWoleOdUn5JigC\n8wA95PI42zC0JyGkfwknP1u0AYC/yW9zub61qx6ivfqOregr1noGDJIFaE3ST2Q+\nMM3x1vTsxw2Q4HCkmhK2PAL/1AI3hcfFaIryHqEikufnHWMWWoTtRbgX47RKlMmO\nPSRV2aImwNOtMCTp2rjXIiG/cGhb80sF425FrkId5MGhb771XyoL1KJ1+8ZAMzyg\nNWwyxLoxIYvWKBTr07huxHEmVTBW86gFQ+47jqsCv9bc+CgMzJF0qQOQHHy1v8WJ\n0AOiVrwIRasNVAMC9/n54v0MWXXBx3MplAoqU8+75RYbtgBwccz7zgVUqKXtKprf\nPpLAhugh32w/J2zqrHav4/5qwE2ZGjTQhad42XxlfXrATf2mIlDrkyUrFddBRQdw\nLRdeh/LrOv3/O3361Jcv8K0wNf9hLb7xWMLNY2jFhg==\n=0Hxq\n-----END PGP SIGNATURE-----",
        "payload": "tree d53a64bc8bc3a0e3db277d5d724489047a39bde6\nparent fabcfa5f0cfe2484fe5cf5ced7cbae34a35c47c9\nauthor MarcoFalke <falke.marco@gmail.com> 1550085949 -0500\ncommitter MarcoFalke <falke.marco@gmail.com> 1550087637 -0500\n\nfuzz: Script validation flags\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fab15ff70e8db26942db83a9aab7ebf974e8b6b2",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fab15ff70e8db26942db83a9aab7ebf974e8b6b2",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fab15ff70e8db26942db83a9aab7ebf974e8b6b2/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fabcfa5f0cfe2484fe5cf5ced7cbae34a35c47c9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fabcfa5f0cfe2484fe5cf5ced7cbae34a35c47c9",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fabcfa5f0cfe2484fe5cf5ced7cbae34a35c47c9"
      }
    ],
    "stats": {
      "total": 90,
      "additions": 90,
      "deletions": 0
    },
    "files": [
      {
        "sha": "be6633e3d3975d97e88727a93e027b6d6ebff83c",
        "filename": "src/Makefile.test.include",
        "status": "modified",
        "additions": 18,
        "deletions": 0,
        "changes": 18,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fab15ff70e8db26942db83a9aab7ebf974e8b6b2/src/Makefile.test.include",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fab15ff70e8db26942db83a9aab7ebf974e8b6b2/src/Makefile.test.include",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.test.include?ref=fab15ff70e8db26942db83a9aab7ebf974e8b6b2",
        "patch": "@@ -21,6 +21,7 @@ FUZZ_TARGETS = \\\n   test/fuzz/inv_deserialize \\\n   test/fuzz/messageheader_deserialize \\\n   test/fuzz/netaddr_deserialize \\\n+  test/fuzz/script_flags \\\n   test/fuzz/service_deserialize \\\n   test/fuzz/transaction_deserialize \\\n   test/fuzz/txoutcompressor_deserialize \\\n@@ -358,6 +359,23 @@ test_fuzz_netaddr_deserialize_LDADD = \\\n  $(LIBSECP256K1)\n test_fuzz_netaddr_deserialize_LDADD += $(BOOST_LIBS) $(CRYPTO_LIBS)\n \n+test_fuzz_script_flags_SOURCES = $(FUZZ_SUITE) test/fuzz/script_flags.cpp\n+test_fuzz_script_flags_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES)\n+test_fuzz_script_flags_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n+test_fuzz_script_flags_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n+test_fuzz_script_flags_LDADD = \\\n+ $(LIBUNIVALUE) \\\n+ $(LIBBITCOIN_SERVER) \\\n+ $(LIBBITCOIN_COMMON) \\\n+ $(LIBBITCOIN_UTIL) \\\n+ $(LIBBITCOIN_CONSENSUS) \\\n+ $(LIBBITCOIN_CRYPTO) \\\n+ $(LIBBITCOIN_CRYPTO_SSE41) \\\n+ $(LIBBITCOIN_CRYPTO_AVX2) \\\n+ $(LIBBITCOIN_CRYPTO_SHANI) \\\n+ $(LIBSECP256K1)\n+test_fuzz_script_flags_LDADD += $(BOOST_LIBS) $(CRYPTO_LIBS)\n+\n test_fuzz_service_deserialize_SOURCES = $(FUZZ_SUITE) test/fuzz/deserialize.cpp\n test_fuzz_service_deserialize_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES) -DSERVICE_DESERIALIZE=1\n test_fuzz_service_deserialize_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)"
      },
      {
        "sha": "2c0bfa360c7ee814b3488c714827f01330f77008",
        "filename": "src/test/fuzz/script_flags.cpp",
        "status": "added",
        "additions": 72,
        "deletions": 0,
        "changes": 72,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fab15ff70e8db26942db83a9aab7ebf974e8b6b2/src/test/fuzz/script_flags.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fab15ff70e8db26942db83a9aab7ebf974e8b6b2/src/test/fuzz/script_flags.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/script_flags.cpp?ref=fab15ff70e8db26942db83a9aab7ebf974e8b6b2",
        "patch": "@@ -0,0 +1,72 @@\n+// Copyright (c) 2009-2019 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <script/interpreter.h>\n+#include <script/script.h>\n+#include <streams.h>\n+#include <version.h>\n+\n+#include <test/fuzz/fuzz.h>\n+\n+/** Flags that are not forbidden by an assert */\n+static bool IsValidFlagCombination(unsigned flags);\n+\n+void test_one_input(std::vector<uint8_t> buffer)\n+{\n+    CDataStream ds(buffer, SER_NETWORK, INIT_PROTO_VERSION);\n+    try {\n+        int nVersion;\n+        ds >> nVersion;\n+        ds.SetVersion(nVersion);\n+    } catch (const std::ios_base::failure&) {\n+        return;\n+    }\n+\n+    try {\n+        const CTransaction tx(deserialize, ds);\n+        const PrecomputedTransactionData txdata(tx);\n+\n+        unsigned int verify_flags;\n+        ds >> verify_flags;\n+\n+        if (!IsValidFlagCombination(verify_flags)) return;\n+\n+        unsigned int fuzzed_flags;\n+        ds >> fuzzed_flags;\n+\n+        for (unsigned i = 0; i < tx.vin.size(); ++i) {\n+            CTxOut prevout;\n+            ds >> prevout;\n+\n+            const TransactionSignatureChecker checker{&tx, i, prevout.nValue, txdata};\n+\n+            ScriptError serror;\n+            const bool ret = VerifyScript(tx.vin.at(i).scriptSig, prevout.scriptPubKey, &tx.vin.at(i).scriptWitness, verify_flags, checker, &serror);\n+            assert(ret == (serror == SCRIPT_ERR_OK));\n+\n+            // Verify that removing flags from a passing test or adding flags to a failing test does not change the result\n+            if (ret) {\n+                verify_flags &= ~fuzzed_flags;\n+            } else {\n+                verify_flags |= fuzzed_flags;\n+            }\n+            if (!IsValidFlagCombination(verify_flags)) return;\n+\n+            ScriptError serror_fuzzed;\n+            const bool ret_fuzzed = VerifyScript(tx.vin.at(i).scriptSig, prevout.scriptPubKey, &tx.vin.at(i).scriptWitness, verify_flags, checker, &serror_fuzzed);\n+            assert(ret_fuzzed == (serror_fuzzed == SCRIPT_ERR_OK));\n+\n+            assert(ret_fuzzed == ret);\n+        }\n+    } catch (const std::ios_base::failure&) {\n+        return;\n+    }\n+}\n+\n+static bool IsValidFlagCombination(unsigned flags)\n+{\n+    if (flags & SCRIPT_VERIFY_CLEANSTACK && ~flags & (SCRIPT_VERIFY_P2SH | SCRIPT_VERIFY_WITNESS)) return false;\n+    if (flags & SCRIPT_VERIFY_WITNESS && ~flags & SCRIPT_VERIFY_P2SH) return false;\n+    return true;\n+}"
      }
    ]
  }
]