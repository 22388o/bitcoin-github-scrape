MarcoFalke,2021-09-15 12:23:29,"Setup clang-tidy:\n\n```\napt install clang-tidy bear clang\n./autogen.sh && ./configure --with-incompatible-bdb CC=clang CXX=clang++\nmake clean && bear make -j $(nproc)     # For bear 2.x\nmake clean && bear -- make -j $(nproc)  # For bear 3.x\n```\n\nFull test:\n\n```\n( cd ./src/ && run-clang-tidy  -j $(nproc) )\n```\n\nDiff test:\n```\ngit diff | ( cd ./src/ && clang-tidy-dif",https://github.com/bitcoin/bitcoin/pull/22981#issuecomment-919971778,919971778,
laanwj,2021-09-15 18:36:36,"Concept ACK, being able to check these automatically with a tool is a good idea.",https://github.com/bitcoin/bitcoin/pull/22981#issuecomment-920277921,920277921,
DrahtBot,2021-09-15 21:56:23,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#23499](https://github.com/bitcoin/bitcoin/pull/23499) (multiprocess: Add interfaces::Node::broadCastTransaction method b",https://github.com/bitcoin/bitcoin/pull/22981#issuecomment-920410437,920410437,
MarcoFalke,2021-09-16 06:43:56,"> we should be integrating this into the CI at some point soon.\n\nHappy to review a pull doing this. Though, I think it is also acceptable to run it only once before every major release.",https://github.com/bitcoin/bitcoin/pull/22981#issuecomment-920622887,920622887,
laanwj,2021-09-21 11:41:53,"I think we should first make sure our argument names make sense, then do this.",https://github.com/bitcoin/bitcoin/pull/22981#issuecomment-923900205,923900205,
practicalswift,2021-10-20 08:33:47,Concept ACK,https://github.com/bitcoin/bitcoin/pull/22981#issuecomment-947447816,947447816,
jnewbery,2021-11-05 07:29:06,Concept ACK. Should we document the required comment style somewhere in the developer docs?,https://github.com/bitcoin/bitcoin/pull/22981#issuecomment-961679904,961679904,
MarcoFalke,2021-11-05 09:16:23,Happy to document the style in a follow-up. I have one follow-up myself that adjusts the style of existing args. The goal of this pull is to replace wrong names with correct names.,https://github.com/bitcoin/bitcoin/pull/22981#issuecomment-961737413,961737413,
MarcoFalke,2021-11-11 17:46:18,"> Should compile_commands.json be added to .gitignore ?\n\nYeah, will do on the next force push or the next follow-up pull, unless someone beats me to it.",https://github.com/bitcoin/bitcoin/pull/22981#issuecomment-966497532,966497532,
katesalazar,2021-11-13 18:16:09,Concept ACK.,https://github.com/bitcoin/bitcoin/pull/22981#issuecomment-968111970,968111970,
fanquake,2021-11-16 05:19:55,"```bash\n/usr/local/opt/llvm/bin/clang-tidy --use-color -p=/Users/michael/github/bitcoin-merge-tree /Users/michael/github/bitcoin-merge-tree/src/psbt.cpp\npsbt.cpp:226:53: error: argument name 'input_idx' in comment does not match parameter name 'nInIn' [bugprone-argument-comment,-warnings-as-errors]\n    MutableTransactionSignatureCreator creator(&tx, /*input_idx=*/0, out.nValue, SIGHASH_ALL);",https://github.com/bitcoin/bitcoin/pull/22981#issuecomment-969869991,969869991,
MarcoFalke,2021-11-16 12:41:50,Good catch. Fixed in https://github.com/bitcoin/bitcoin/pull/23525,https://github.com/bitcoin/bitcoin/pull/22981#issuecomment-970234669,970234669,
MarcoFalke,2021-11-17 13:47:37,Rebased to get rid of already fixed instances. Only 29 left in this pull for now.,https://github.com/bitcoin/bitcoin/pull/22981#issuecomment-971598661,971598661,
fanquake,2021-09-16 03:53:01,"```suggestion\n        setenv(""QT_QPA_PLATFORM"", ""minimal"", /* overwrite */0);\n```\n\nI assume this isn't updated to `/*overwrite=*/` because that will fail the check:\n```bash\n/bitcoin/src/qt/test/test_main.cpp:73:46: error: argument name 'overwrite' in comment does not match parameter name '__replace' [bugprone-argument-comment,-warnings-as-errors]\n        setenv(""QT_QPA_PLATFORM"", ""mi",https://github.com/bitcoin/bitcoin/pull/22981#discussion_r709731245,709731245,src/qt/test/test_main.cpp
MarcoFalke,2021-09-16 06:42:45,"I think for consistency named args that are not enforced should be trailing. If it was kept in the beginning, it could confuse devs and trick them into adding an `=`, which again would fail clang-tidy. See also the comment in `src/test/fuzz/tx_pool.cpp`, which I moved to the end.",https://github.com/bitcoin/bitcoin/pull/22981#discussion_r709823031,709823031,src/qt/test/test_main.cpp
laanwj,2021-09-21 11:36:02,"It's unfortunate in these cases that these argument names are so ugly (e.g. `_nTime` doesn't just have an underscore, but also the long deprecated syntax)",https://github.com/bitcoin/bitcoin/pull/22981#discussion_r712951611,712951611,src/bench/rpc_mempool.cpp
laanwj,2021-09-21 11:36:41,Same here. I'm not sure this is an improvement in readability. What is a `nInIn`? Might as well strip the comment out.,https://github.com/bitcoin/bitcoin/pull/22981#discussion_r712952068,712952068,src/psbt.cpp
MarcoFalke,2021-09-21 11:37:37,"Happy to review a follow-up to fixup the name of the args, or should I do it here?",https://github.com/bitcoin/bitcoin/pull/22981#discussion_r712952663,712952663,src/bench/rpc_mempool.cpp
laanwj,2021-09-21 11:38:47,"maybe `/* don't overwrite */` ? if it doesn't look like an argument name, any confusion is gone",https://github.com/bitcoin/bitcoin/pull/22981#discussion_r712953424,712953424,src/qt/test/test_main.cpp
MarcoFalke,2021-09-21 11:39:02,"`nInIn` is used as comment elsewhere, so this is a pre-existing issue. I think every literal numeric type passed to a function should have a name.\n\nI can offer to rename `nInIn` here or in a follow-up.",https://github.com/bitcoin/bitcoin/pull/22981#discussion_r712953558,712953558,src/psbt.cpp
laanwj,2021-09-21 11:40:37,I don't know. It does make me reconsider whether automatically checking this is a good idea.,https://github.com/bitcoin/bitcoin/pull/22981#discussion_r712954647,712954647,src/bench/rpc_mempool.cpp
MarcoFalke,2021-09-21 11:42:28,"It is the correct argument name according to `man`, but the headers shipped on the system may pick a different name (implementation detail).\n\n```\n$ man setenv | head -9\nSETENV(3)             Linux Programmer's Manual            SETENV(3)\n\nNAME\n       setenv - change or add an environment variable\n\nSYNOPSIS\n       #include <stdlib.h>\n\n       int setenv(const char *name, cons",https://github.com/bitcoin/bitcoin/pull/22981#discussion_r712956002,712956002,src/qt/test/test_main.cpp
MarcoFalke,2021-09-21 11:45:55,"Not checking them makes it harder to catch bugs, like #22979. So I think this is overall a good idea.\n\n",https://github.com/bitcoin/bitcoin/pull/22981#discussion_r712958278,712958278,src/bench/rpc_mempool.cpp
MarcoFalke,2021-09-21 12:14:29,Fixed in #23054,https://github.com/bitcoin/bitcoin/pull/22981#discussion_r712978286,712978286,src/bench/rpc_mempool.cpp
MarcoFalke,2021-09-21 14:43:39,Done here in a new commit,https://github.com/bitcoin/bitcoin/pull/22981#discussion_r713114635,713114635,src/psbt.cpp
