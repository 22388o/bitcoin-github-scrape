MarcoFalke,2015-11-11T21:09:31Z,Concept ACK. \n,https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-155911428,155911428,
dcousens,2015-11-11T21:48:53Z,"I'm not sure we need a separate 'space' for the priority transactions.\nConceptually the entire mempool algorithm shouldn't be more complicated than:\n- Sort transactions by descending, comparing fees, then priority.\n- Fees less than `minRelayTxFee` should be considered `0`, allowing priority to take precedence\n- Drop transactions on the lower part of the spectrum until ideal memory usage is met",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-155920268,155920268,
TheBlueMatt,2015-11-11T21:52:27Z,NAK. I thought there was agreement that priority space is a bad idea in general. The amount of developer time that has gone into making priority space work properly is no where near the gains from having it.\n,https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-155921181,155921181,
sturles,2015-11-11T22:18:45Z,"I am testing now it to see if it solves my problems.  It can't possibly be worse than the current version, which almost led to loss of coins for me due to transactions with negative confirmations reappearing as unconfirmed after a restart, and loss of trust from other people when my client double spent inputs instead of rebroadcasting high priority transactions.\n",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-155927431,155927431,
TheBlueMatt,2015-11-11T22:21:17Z,"The solution, as mentioned by @morcos in #6972 is the last commit in #6134, not re-adding priority area when there is actual fee-paying traffic.\n",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-155928029,155928029,
sipa,2015-11-11T22:27:33Z,"My idea was that we'd get rid of priority, and replace it with a small adjustment to the fee or size of a transaction.\n\nOne idea is to treat the total bitcoindays of the UTXO set as limited resource and treat it as currency, and that burning it should be treated like extra fee, with a small factor. Specifically:\n- for each transaction you compute the bitcoin-days-destroyed\n- divide it by the a",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-155929352,155929352,
sipa,2015-11-11T22:31:45Z,"@sturles I believe that the wallet treating evicted transactions as spendable again is an outright bug, and a blocker we should fix before release (so thanks for reporting that). What the right solution is w.r.t. priority, I don't know - it's a hard problem that tries to balance the advantage of allowing a small amount of free transactions on the network (but only to the privileged few who have en",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-155930238,155930238,
sturles,2015-11-11T22:37:32Z,"@TheBlueMatt The last commit in #6134 is a kludge to hide some symptoms.  It doesn't solve the bugs I just mentioned here.  It would just have added a fee to one of the transactions I mentioned.  The rest would still be treated the same.  If this patch works as advertised, it will solve all the problems I mentioned.  (Not guaranteed, in case a lot of extremely high priority transactions suddenly s",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-155931427,155931427,
TheBlueMatt,2015-11-11T22:45:11Z,"@sipa I'm not sure its worth the incentive-incompatibility for miners to do that. You could probably get away with it (with a cap) for some time yet, but we'll be back here in 6-12 months getting rid of priority at that point.\n",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-155933122,155933122,
dcousens,2015-11-11T23:51:49Z,"Agreed, NACK\n",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-155947516,155947516,
sdaftuar,2015-11-12T01:37:03Z,"To me the most important question is, is priority something that miners want to use?\n\nIf a non-negligible amount of hashpower intends to use it in their transaction selection, then I think it makes sense for nodes to use it too, because it's generally helpful to have your mempool predict the UTXO as much as possible, and for nodes to be able to have reasonable fee and priority estimates (which w",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-155969455,155969455,
morcos,2015-11-12T02:47:11Z,"Concept ACK from me.\nAlthough it looks like a fair amount of code, its not a terribly invasive change.\n\nFundamentally I agree that supporting priority is probably more trouble than it's worth.  However I think we backed ourselves into a bit of a corner by not more clearly communicating and building consensus that priority based transactions were going away before now.   \n\nWe can of course sti",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-155981599,155981599,
pstratem,2015-11-12T03:19:14Z,Strong NACK.\n\nFree transactions are a thing of the past.\n\nWe've made the mistake in the past of failing to signal that things are going away.\n\nLets not make that mistake again.\n,https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-155985199,155985199,
jgarzik,2015-11-12T03:33:48Z,"""My idea was that we'd get rid of priority, and replace it with a small adjustment to the fee or size of a transaction.""\n\nthat's pretty much exactly what my remove-priority PR did...\n\nRemoving priority vastly simplifies a lot of the code.  Fee deltas continue to exist...\n",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-155986864,155986864,
TheBlueMatt,2015-11-12T03:35:56Z,"Fee deltas continue to exist as an RPC interface for manual control, sure, though I'm not sure I understand why we should be applying a ""default"" fee delta to all transactions.\n",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-155987074,155987074,
sturles,2015-11-12T06:51:35Z,"I have been running this since yesterday evening, and made a few free transactions with varying priority to test.  This morning I checked if my transactions were still in my mempool.  They were not.  Even the lowest priority transactions I made were mined, not evicted.  From this I can conclude:\n1. The patch has worked so far, but the transactions were probably mined before my mempool was full.\n",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-156017520,156017520,
TheBlueMatt,2015-11-12T09:27:51Z,"@sturles No one claimed free transactions would not be mined today. Most miners will absolutely mine free transactions since that is still the default policy in released versions of Bitcoin Core. The point was that a few miners have already turned this off, and more will in the future (it is the only incentive-compatible outcome...if they arent receiving enough in fees for them to strongly want to",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-156045580,156045580,
sturles,2015-11-12T10:00:43Z,"@TheBlueMatt I may be crazy, but at least I know I can't predict the future accurately.  Right now there is no difference in income between reserving half the block for high priority transactions or reserving nothing.  If you drop the rest of the anti spam measures, e.g. by accepting dust outputs and other non standard transactions, you can make a few satoshis more.  Introducing bugs by purpose to",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-156055177,156055177,
TheBlueMatt,2015-11-12T10:04:35Z,"I didn't mean to even imply that the way things are now in master is acceptable. Indeed, it is not. And, yes, my preference would be to remove priority in its entirety.\n\nOn November 12, 2015 2:00:52 AM PST, sturles notifications@github.com wrote:\n\n> @TheBlueMatt I may be crazy, but at least I know I can't predict the\n> future accurately.  Right now there is no difference in income between\n> ",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-156056031,156056031,
MarcoFalke,2015-11-12T10:44:36Z,"I like what @sipa proposed (translate priority into additional fee). This should simplify the code and make it easier to configure by just setting the conversion rate via parameters. Also, the default conversion rate could be adjusted based on how the future turns out. (Similar to minRelayTxFee)\n",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-156068474,156068474,
morcos,2015-11-12T11:18:15Z,"@sturles The problem you reference with with defaulting to too low a priority is fixed by the rest of #6134.  Obviously if this PR is merged, I'll modify #6134 to look at the appropriate minimum priority of the mempool instead if the mempool reject fee is non zero.\n\n@MarcoFalke I don't think its possible to accomplish the same goals by translating priority into fee.\n\n@TheBlueMatt Yes thats par",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-156077605,156077605,
sdaftuar,2015-11-12T17:21:41Z,"I think if we are deciding to stop supporting priority, then we need a reasonable plan for how to make that happen (something better than silently allowing performance degradation without adequate communication to users in advance).\n\nI propose that if the consensus here is to deprecate priority (which is okay with me in principle) that we do the following:\n- For 0.12, set the default block prio",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-156172737,156172737,
TheBlueMatt,2015-11-12T18:29:54Z,"@morcos Yes, last I checked there was consensus to remove priority (see #6405 and #6675)\n",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-156193583,156193583,
morcos,2015-11-12T18:35:34Z,Initial code review ACK.   I will do a more thorough review and testing when it's clear the fate of this.\n,https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-156195401,156195401,
sturles,2015-11-12T19:10:41Z,"ACK from me fwiw.  I have not been able to reproduce #6972 or #6959 using this patch. \n\nWhen comparing periodic output from getmempoolinfo on the node running this patch since yesterday, and a different node which run current git version as of two days ago, more transactions are removed from the mempool for each new block on the node running this patch.  Mempool size is the same.  The difference",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-156204686,156204686,
sdaftuar,2015-11-12T19:34:56Z,Closing after discussion on IRC\n,https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-156210721,156210721,
dcousens,2015-11-13T01:09:03Z,@sdaftuar what was your conclusion for those of us who weren't there?\n,https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-156286578,156286578,
sdaftuar,2015-11-13T15:29:56Z,"@dcousens Well most developers seemed to favor deprecating priority at a slightly faster pace than I proposed above.  @TheBlueMatt sent an email to the -dev list yesterday summarizing the discussion on priority (http://lists.linuxfoundation.org/pipermail/bitcoin-dev/2015-November/011713.html).\n\nAlong those lines, there was a general sentiment to not merge changes like this one or #6357 to improv",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-156464023,156464023,
sturles,2015-11-13T15:49:28Z,"In that case the current mempool limiting code must be removed and added later when priority transactions have been deprecated, to avoid bugs #6972 and #6959.  The current code is broken.\n",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-156469454,156469454,
sturles,2015-11-13T16:17:12Z,"From what I can see from the IRC discussion, only one person is in favor of removing support for priority in 0.12 (BlueMatt).  Most want to warn users first, starting in 0.12, before removing support later, or to replace priority with another mechanism.  One is against removing priority (Luke-Jr).\n\nAs long as priority is supported, this patch is wanted by at least me, as it fixes two bugs and wo",https://github.com/bitcoin/bitcoin/pull/6992#issuecomment-156477081,156477081,
dcousens,2015-11-11T21:43:10Z,"This algorithm is done several times, and is a cluster to read.  Could you extract it out at all to make review easier?\n",https://github.com/bitcoin/bitcoin/pull/6992#discussion_r44590588,44590588,src/main.cpp
morcos,2015-11-12T18:12:12Z,you don't need this `mempoolRejectFee > 0 &&`\n,https://github.com/bitcoin/bitcoin/pull/6992#discussion_r44692353,44692353,src/main.cpp
morcos,2015-11-12T18:24:15Z,Too much debugging\n,https://github.com/bitcoin/bitcoin/pull/6992#discussion_r44694054,44694054,src/txmempool.cpp
morcos,2015-11-12T18:28:06Z,sipa didn't let me do this.\n,https://github.com/bitcoin/bitcoin/pull/6992#discussion_r44694539,44694539,src/txmempool.h
