[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/265137401",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-265137401",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 265137401,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTEzNzQwMQ==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-06T12:24:00Z",
    "updated_at": "2016-12-06T12:24:00Z",
    "author_association": "MEMBER",
    "body": "Concept ACK",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/265137401/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/265249618",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-265249618",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 265249618,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTI0OTYxOA==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-06T19:35:25Z",
    "updated_at": "2016-12-06T19:35:25Z",
    "author_association": "MEMBER",
    "body": "Would it make sense to introduce a utility function like MilliSleep which takes a reference to a condition variable and an atomic flag? The pattern that replaces the MilliSleep calls is pretty complicated and repeats several times.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/265249618/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/265417999",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-265417999",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 265417999,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTQxNzk5OQ==",
    "user": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?u=a0e0040aacd7d4f0787481e8ac30b494fa429e11&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-07T10:57:56Z",
    "updated_at": "2016-12-07T10:57:56Z",
    "author_association": "MEMBER",
    "body": "Concept ACK",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/265417999/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/265747217",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-265747217",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 265747217,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTc0NzIxNw==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-08T14:05:22Z",
    "updated_at": "2016-12-08T14:05:22Z",
    "author_association": "MEMBER",
    "body": "@sipa Sure, will do.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/265747217/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/265904134",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-265904134",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 265904134,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTkwNDEzNA==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-09T01:07:07Z",
    "updated_at": "2016-12-09T01:07:07Z",
    "author_association": "MEMBER",
    "body": "@sipa done. I'm not sure if it's generic enough to add to utiltime, happy to move it back to net if that makes more sense.\r\n\r\nAlso fixed up the TODO that I was mistaken about.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/265904134/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/267488595",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-267488595",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 267488595,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NzQ4ODU5NQ==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-16T00:51:44Z",
    "updated_at": "2016-12-16T00:51:44Z",
    "author_association": "MEMBER",
    "body": "Just noticed that this PR would've broken interruptible proxy recvs, so I pushed a commit to fix that. The proxy code will soon be dumped anyway, so I'm ok with the hackish global there for now.\r\n\r\nAlso squashed down the header fix while I was at it.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/267488595/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268450262",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-268450262",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 268450262,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2ODQ1MDI2Mg==",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?u=8cdd8653982252593843d7369ecfebe432b89768&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-21T06:51:09Z",
    "updated_at": "2016-12-21T06:51:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "@TheBlueMatt I think you might be confused as to how the atomic flags are used in this code. They're used in \"clear triggered mode\", so there is no need to reset them after every check. The other usage (\"test_and_set triggered mode\") would introduce race conditions when the checking thread clears the flag as a concurrent interrupt could be cleared.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268450262/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268469097",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-268469097",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 268469097,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2ODQ2OTA5Nw==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-21T08:50:26Z",
    "updated_at": "2016-12-21T08:50:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "@JeremyRubin I see how they're used, am only commenting on the likelihood of this pattern introducing future bugs. Eg someone uses break instead of return and then a loop gets moved around, making the thread no longer exit.\n\nOn December 20, 2016 10:51:14 PM PST, Jeremy Rubin <notifications@github.com> wrote:\n>@TheBlueMatt I think you might be confused as to how the atomic flags\n>are used in this code. They're used in \"clear triggered mode\", so there\n>is no need to reset them after every check. The other usage\n>(\"test_and_set triggered mode\") would introduce race conditions when\n>the checking thread clears the flag as a concurrent interrupt could be\n>cleared.\n>\n>-- \n>You are receiving this because you were mentioned.\n>Reply to this email directly or view it on GitHub:\n>https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-268450262\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268469097/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268614837",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-268614837",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 268614837,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2ODYxNDgzNw==",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?u=8cdd8653982252593843d7369ecfebe432b89768&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-21T19:19:24Z",
    "updated_at": "2016-12-21T19:19:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "@TheBlueMatt ok I was responding to \"atomic_flags and resetting them to dont-wake every time you check them.\", not sure what you meant by that if not my earlier interpretation.\r\n\r\nI agree with you on the semantics being off if your worry is future code breaking it. We should either make it throw an Interruption, or call std::terminate. Changing it to an atomic_bool will not have any effect on reducing likelihood future code changes don't break intended behavior. Implemented here for comparison https://github.com/theuni/bitcoin/compare/connman-threads...JeremyRubin:connman-threads The only negative of this approach is that local cleanup can't be handled as neatly.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268614837/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268619821",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-268619821",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 268619821,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2ODYxOTgyMQ==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-21T19:41:19Z",
    "updated_at": "2016-12-21T19:41:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "@JeremyRubin well my note was that if you use an atomic_bool instead of a flag (which means you can check without resetting the state to the dont-exit-now state) then even if there is a bug the worst that happens is you will exit the thread at the next check.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268619821/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268625684",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-268625684",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 268625684,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2ODYyNTY4NA==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-21T20:06:50Z",
    "updated_at": "2016-12-21T20:06:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "@JeremyRubin sadly I'm not sure about the execution propagation from within condition_variable...cppreference seems to indicate it was cleaned up in C++14, but its unclear if its guaranteed to propagation from the predicate or if it just \"may\".",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268625684/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268638123",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-268638123",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 268638123,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2ODYzODEyMw==",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?u=8cdd8653982252593843d7369ecfebe432b89768&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-21T20:59:59Z",
    "updated_at": "2016-12-21T20:59:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for clarifying the kind of bug you were imagining, I had a different type of bug in mind (there being no code flow which can cause a termination, rather than being catchable on the next iteration).\r\n\r\nYou're absolutely right on the \"may\" for exceptions thrown from wait_for.  Semantics should be fixed now (moved InterruptibleSleep into interruption_point and made the throwing external to wait_for).",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268638123/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268644797",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-268644797",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 268644797,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2ODY0NDc5Nw==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-21T21:28:06Z",
    "updated_at": "2016-12-21T21:28:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "@JeremyRubin ehh, I mean yes regaring wrappers, no regarding exceptions - I think its generally accepted that using exceptions in C++ is bad, and I'm not sure we want to add any more uses than we already have.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268644797/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268704281",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-268704281",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 268704281,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2ODcwNDI4MQ==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-22T02:43:56Z",
    "updated_at": "2016-12-22T02:43:56Z",
    "author_association": "MEMBER",
    "body": "@JeremyRubin and @TheBlueMatt Thanks for having a look.\r\n\r\nAfter a debate (probably more than necessary), and running it by a third party, I think I'll concede and just use an atomic bool instead. The convincing argument was that a bool allows us to deviate from the current \"got an interrupt, bail from thread!\", and lets us do quick on-thread teardown post-interruption. It will need to stay in check though, our usages of Interrupt() assume that it won't block.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268704281/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268735467",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-268735467",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 268735467,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2ODczNTQ2Nw==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-22T07:19:55Z",
    "updated_at": "2016-12-22T07:34:30Z",
    "author_association": "MEMBER",
    "body": "@TheBlueMatt I pushed up a new attempt to  https://github.com/theuni/bitcoin/commits/connman-threads-redo. I think you'll like that much better.\r\n\r\nI need to split a few non-obvious things into different commits, but mind having a quick look at the concept?\r\n\r\nI borrowed @JeremyRubin's wrapper idea but implemented it a bit differently: https://github.com/theuni/bitcoin/commit/7b4d8f608cca17fba7311c310e74c4cbd7671b73#diff-09404f8fdd1f69609d329cb0b1f1252e\r\n\r\nThe usage is (imo) pretty straightforward: https://github.com/theuni/bitcoin/commit/7b4d8f608cca17fba7311c310e74c4cbd7671b73#diff-9a82240fe7dfe86564178691cc57f2f1L1660",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268735467/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268858517",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-268858517",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 268858517,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2ODg1ODUxNw==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-22T18:17:01Z",
    "updated_at": "2016-12-22T18:17:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "@theuni Yup, really like that version.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268858517/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268916125",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-268916125",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 268916125,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2ODkxNjEyNQ==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-22T23:51:08Z",
    "updated_at": "2016-12-22T23:51:08Z",
    "author_association": "MEMBER",
    "body": "Socket handler moved up just so that there's a consistent start/stop order.\r\n\r\nThanks for pointing out the MilliSleep, definitely not intentional!",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268916125/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268917829",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-268917829",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 268917829,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2ODkxNzgyOQ==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-23T00:04:55Z",
    "updated_at": "2016-12-23T00:04:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yes, I guess my conception is different - if we make it a generic wrapper for condition variables then moving sleep into it would make sense. I thought some about what that would mean for net_processing, but missed that you'd need to expose the lock (exposing interrupt seems otherwise reasonable to me).\n\nNo longer convinced which one is nicer, up to you.\n\nOn December 22, 2016 3:48:21 PM PST, Cory Fields <notifications@github.com> wrote:\n>theuni commented on this pull request.\n>\n>\n>\n>> +    std::condition_variable& cond;\n>+    std::mutex& mut;\n>+    std::atomic<bool> val;\n>+\n>+    template <typename Duration>\n>+    friend bool InterruptibleSleep(const Duration&,\n>CThreadInterrupt&);\n>+};\n>+\n>+/*\n>+ * Sleep for the stated period of time, interruptible by clearing the\n>flag and notifying the condvar.\n>+ * @param   rel_time maximum time to wait. Should be a\n>std::chrono::duration.\n>+ * @param   threadInterrupt The interrupt that may wake the sleep\n>+ * @returns false if the sleep was interrupted, true otherwise\n>+ */\n>+template <typename Duration>\n>+bool InterruptibleSleep(const Duration& rel_time, CThreadInterrupt&\n>threadInterrupt)\n>\n>This started out as a member function, but interrupt.sleep_for() felt\n>awkward conceptually.\n>\n>We can probably just force this to milliseconds. If we need microsecond\n>precision later, we can just add another function.\n>\n>-- \n>You are receiving this because you were mentioned.\n>Reply to this email directly or view it on GitHub:\n>https://github.com/bitcoin/bitcoin/pull/9289\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268917829/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268919416",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-268919416",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 268919416,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2ODkxOTQxNg==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-23T00:19:16Z",
    "updated_at": "2016-12-23T00:19:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "Actually, I'm not sure you need to expose the lock, you just need to take the lock on the notifying thread prior to the notify but after setting the wakeup condition.\n\nIf you want to try it this way, I'd say you'd want to have two wakeup conditions, a wake-up and an interrupt condition, and just expose the various operations that you need. Not sure it's worth it, but I think that would be the cleanest API (modulo the too-much-wrapper potential issue).\n\nOn December 22, 2016 3:53:28 PM PST, Cory Fields <notifications@github.com> wrote:\n>theuni commented on this pull request.\n>\n>\n>\n>> @@ -0,0 +1,51 @@\n>+// Copyright (c) 2009-2010 Satoshi Nakamoto\n>+// Copyright (c) 2009-2016 The Bitcoin Core developers\n>+// Distributed under the MIT software license, see the accompanying\n>+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n>+\n>+#include <mutex>\n>+#include <condition_variable>\n>+#include <atomic>\n>+\n>+class CThreadInterrupt\n>\n>I suppose this could be rigged up with a separate condvar/mutex and\n>some additional manual isinterruped checks.\n>\n>-- \n>You are receiving this because you were mentioned.\n>Reply to this email directly or view it on GitHub:\n>https://github.com/bitcoin/bitcoin/pull/9289\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268919416/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268923628",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-268923628",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 268923628,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2ODkyMzYyOA==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-23T01:02:42Z",
    "updated_at": "2016-12-23T01:02:42Z",
    "author_association": "MEMBER",
    "body": "That would require the wakeup condition to be atomic, no?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268923628/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268930136",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-268930136",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 268930136,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2ODkzMDEzNg==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-23T02:16:38Z",
    "updated_at": "2016-12-23T02:16:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yes, I believe that implies the wakeup condition must be atomic, but it can be release/acquire since a mutex unlock implies a full memory barrier.\n\nIn the other case that I proposed (doing it with two atomics - one for wake-up and one for interruption all hidden inside the object they would both be atomic and you'd want ClearWakeupState() and Wake() functions).\n\nOn December 22, 2016 5:02:46 PM PST, Cory Fields <notifications@github.com> wrote:\n>That would require the wakeup condition to be atomic, no?\n>\n>-- \n>You are receiving this because you were mentioned.\n>Reply to this email directly or view it on GitHub:\n>https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-268923628\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/268930136/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/269063437",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-269063437",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 269063437,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2OTA2MzQzNw==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-24T01:49:10Z",
    "updated_at": "2016-12-24T01:49:10Z",
    "author_association": "MEMBER",
    "body": "@TheBlueMatt Pushed a round of changes after last night's IRC discussion. I hope we can compromise on this approach.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/269063437/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/269063960",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-269063960",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 269063960,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2OTA2Mzk2MA==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-24T02:05:03Z",
    "updated_at": "2016-12-24T02:05:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "Looks good, will do a more thourough review when you add threadinterrupt.cpp to git :)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/269063960/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/269067788",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-269067788",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 269067788,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2OTA2Nzc4OA==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-24T04:00:02Z",
    "updated_at": "2016-12-24T04:00:02Z",
    "author_association": "MEMBER",
    "body": "grr.. added.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/269067788/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/269095615",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-269095615",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 269095615,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2OTA5NTYxNQ==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-24T18:39:26Z",
    "updated_at": "2016-12-24T18:39:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "utACK 992bbc01a0d33fdf47a55336f82825f43ad29522\r\nYou can remove the boost/thread.hpp include in netbase now, I believe.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/269095615/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/269236168",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-269236168",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 269236168,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2OTIzNjE2OA==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-26T19:22:29Z",
    "updated_at": "2016-12-26T19:22:29Z",
    "author_association": "MEMBER",
    "body": "Updated and squashed. The diff from 992bbc0 can be seen here: https://gist.github.com/theuni/32409c39e045cd3f2a6d6e4316d228ec.\r\n\r\nThe only things changed in the squash (can be seen in the diff above):\r\n- Rename interruptSocks5 to avoid a symbol with same-name-different-case (and make it static while we're at it)\r\n- Initialize the atomics in DoS_tests\r\n\r\nOne commit was added on top to cleanup includes.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/269236168/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/269390335",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-269390335",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 269390335,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2OTM5MDMzNQ==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-27T22:15:04Z",
    "updated_at": "2016-12-27T22:15:04Z",
    "author_association": "MEMBER",
    "body": "@sipa reordered and fixed the \"if(\"s. I didn't rebase for now to avoid invalidating @TheBlueMatt's review.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/269390335/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/269682780",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-269682780",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 269682780,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2OTY4Mjc4MA==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-29T19:44:31Z",
    "updated_at": "2016-12-29T19:44:31Z",
    "author_association": "MEMBER",
    "body": "rebased at @TheBlueMatt's request.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/269682780/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/269812676",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-269812676",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 269812676,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2OTgxMjY3Ng==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-30T19:32:55Z",
    "updated_at": "2016-12-30T19:32:55Z",
    "author_association": "MEMBER",
    "body": "Pushed a commit for @sipa's nits. I've been running my dev branches on top of this for several days, killing bitcoind in all kinds of rude ways while debugging, and it has continued to shutdown reliably.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/269812676/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/269817476",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-269817476",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 269817476,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2OTgxNzQ3Ng==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-30T20:20:11Z",
    "updated_at": "2016-12-30T20:20:11Z",
    "author_association": "MEMBER",
    "body": "@sipa I figured you'd have more nits :)\r\n\r\nWent ahead and squashed.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/269817476/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270236046",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-270236046",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 270236046,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDIzNjA0Ng==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-03T21:55:00Z",
    "updated_at": "2017-01-03T21:55:00Z",
    "author_association": "MEMBER",
    "body": "Needs rebase.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270236046/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270261333",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-270261333",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 270261333,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDI2MTMzMw==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-04T00:06:50Z",
    "updated_at": "2017-01-04T00:06:50Z",
    "author_association": "MEMBER",
    "body": "Done.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270261333/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270349514",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#issuecomment-270349514",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9289",
    "id": 270349514,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDM0OTUxNA==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-04T11:20:59Z",
    "updated_at": "2017-01-04T11:20:59Z",
    "author_association": "MEMBER",
    "body": "lightly-tested ACK 67ee4ec",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270349514/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93713812",
    "pull_request_review_id": 14247718,
    "id": 93713812,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDkzNzEzODEy",
    "diff_hunk": "@@ -0,0 +1,51 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2016 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <mutex>\n+#include <condition_variable>\n+#include <atomic>\n+\n+class CThreadInterrupt",
    "path": "src/threadinterrupt.h",
    "position": null,
    "original_position": 10,
    "commit_id": "67ee4ec9015592c8447955356adfcbb1bf473e32",
    "original_commit_id": "e0bdb1d62ca62c9eae570a5d3dde3267672f5ce0",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Generally, I think it might make sense to just rename this \"InterruptibleSleeper\" and have it own the mutex and condition_variable. Then you dont have to have its owner own memory it points to and should still be able to keep +/- the same API.",
    "created_at": "2016-12-22T23:34:10Z",
    "updated_at": "2017-01-03T22:59:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r93713812",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93713812"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r93713812"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93713812/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 18,
    "original_line": 10,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93713941",
    "pull_request_review_id": 14247718,
    "id": 93713941,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDkzNzEzOTQx",
    "diff_hunk": "@@ -0,0 +1,51 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2016 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <mutex>\n+#include <condition_variable>\n+#include <atomic>\n+\n+class CThreadInterrupt\n+{\n+public:\n+    CThreadInterrupt(std::condition_variable& condIn, std::mutex& mutIn) : cond(condIn), mut(mutIn), val(false) {}\n+    void reset()\n+    {\n+        val.store(false, std::memory_order_release);\n+    }\n+    void operator()()\n+    {\n+        {\n+            std::unique_lock<std::mutex> lock(mut);\n+            val.store(true, std::memory_order_release);\n+        }\n+        cond.notify_all();\n+    }\n+    explicit operator bool() const\n+    {\n+        return val.load(std::memory_order_acquire) == true;\n+    }\n+\n+private:\n+    std::condition_variable& cond;\n+    std::mutex& mut;\n+    std::atomic<bool> val;\n+\n+    template <typename Duration>\n+    friend bool InterruptibleSleep(const Duration&, CThreadInterrupt&);\n+};\n+\n+/*\n+ * Sleep for the stated period of time, interruptible by clearing the flag and notifying the condvar.\n+ * @param   rel_time maximum time to wait. Should be a std::chrono::duration.\n+ * @param   threadInterrupt The interrupt that may wake the sleep\n+ * @returns false if the sleep was interrupted, true otherwise\n+ */\n+template <typename Duration>\n+bool InterruptibleSleep(const Duration& rel_time, CThreadInterrupt& threadInterrupt)",
    "path": "src/threadinterrupt.h",
    "position": null,
    "original_position": 47,
    "commit_id": "67ee4ec9015592c8447955356adfcbb1bf473e32",
    "original_commit_id": "e0bdb1d62ca62c9eae570a5d3dde3267672f5ce0",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Can we just move this into a member function of the class?\r\n\r\nAlso, does it need to be a template? I think if you set Duration to something that the various durations can be converted into it should do so intelligently. Would mean less stuff to compile in headers.",
    "created_at": "2016-12-22T23:35:30Z",
    "updated_at": "2017-01-03T22:59:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r93713941",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93713941"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r93713941"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93713941/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 47,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93713996",
    "pull_request_review_id": 14247718,
    "id": 93713996,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDkzNzEzOTk2",
    "diff_hunk": "@@ -0,0 +1,51 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2016 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <mutex>\n+#include <condition_variable>\n+#include <atomic>\n+\n+class CThreadInterrupt\n+{\n+public:\n+    CThreadInterrupt(std::condition_variable& condIn, std::mutex& mutIn) : cond(condIn), mut(mutIn), val(false) {}\n+    void reset()",
    "path": "src/threadinterrupt.h",
    "position": null,
    "original_position": 14,
    "commit_id": "67ee4ec9015592c8447955356adfcbb1bf473e32",
    "original_commit_id": "e0bdb1d62ca62c9eae570a5d3dde3267672f5ce0",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Please no new implementations-in-headers. I know its mostly single-line stuff but we're fighting to reduce compile-time memory usage, so every little bit helps. :)",
    "created_at": "2016-12-22T23:36:08Z",
    "updated_at": "2017-01-03T22:59:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r93713996",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93713996"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r93713996"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93713996/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 14,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93714848",
    "pull_request_review_id": 14248684,
    "id": 93714848,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDkzNzE0ODQ4",
    "diff_hunk": "@@ -0,0 +1,51 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2016 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <mutex>\n+#include <condition_variable>\n+#include <atomic>\n+\n+class CThreadInterrupt",
    "path": "src/threadinterrupt.h",
    "position": null,
    "original_position": 10,
    "commit_id": "67ee4ec9015592c8447955356adfcbb1bf473e32",
    "original_commit_id": "e0bdb1d62ca62c9eae570a5d3dde3267672f5ce0",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Sometimes you'll want a real interruptible condvar, though. See https://github.com/theuni/bitcoin/commit/da68e3cf5832878fbb1951eb1eeb01d8cd22d1e1#diff-9a82240fe7dfe86564178691cc57f2f1R1887.\r\n\r\nThe alternative would be to add wait_for/wait_until/notify_one/notify_all to CThreadInterrupt, then just forward them to the condvar. But for that, you'd still need to expose the mutex.",
    "created_at": "2016-12-22T23:45:19Z",
    "updated_at": "2017-01-03T22:59:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r93714848",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93714848"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r93714848"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93714848/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 18,
    "original_line": 10,
    "side": "RIGHT",
    "in_reply_to_id": 93713812
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93714949",
    "pull_request_review_id": 14248778,
    "id": 93714949,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDkzNzE0OTQ5",
    "diff_hunk": "@@ -0,0 +1,51 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2016 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <mutex>\n+#include <condition_variable>\n+#include <atomic>\n+\n+class CThreadInterrupt\n+{\n+public:\n+    CThreadInterrupt(std::condition_variable& condIn, std::mutex& mutIn) : cond(condIn), mut(mutIn), val(false) {}\n+    void reset()",
    "path": "src/threadinterrupt.h",
    "position": null,
    "original_position": 14,
    "commit_id": "67ee4ec9015592c8447955356adfcbb1bf473e32",
    "original_commit_id": "e0bdb1d62ca62c9eae570a5d3dde3267672f5ce0",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Sure. Though some of these need to be inlined. I figured someone would yell if I added a .cpp with 2 functions :p",
    "created_at": "2016-12-22T23:46:27Z",
    "updated_at": "2017-01-03T22:59:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r93714949",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93714949"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r93714949"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93714949/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 14,
    "side": "RIGHT",
    "in_reply_to_id": 93713996
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93715113",
    "pull_request_review_id": 14248926,
    "id": 93715113,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDkzNzE1MTEz",
    "diff_hunk": "@@ -0,0 +1,51 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2016 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <mutex>\n+#include <condition_variable>\n+#include <atomic>\n+\n+class CThreadInterrupt\n+{\n+public:\n+    CThreadInterrupt(std::condition_variable& condIn, std::mutex& mutIn) : cond(condIn), mut(mutIn), val(false) {}\n+    void reset()\n+    {\n+        val.store(false, std::memory_order_release);\n+    }\n+    void operator()()\n+    {\n+        {\n+            std::unique_lock<std::mutex> lock(mut);\n+            val.store(true, std::memory_order_release);\n+        }\n+        cond.notify_all();\n+    }\n+    explicit operator bool() const\n+    {\n+        return val.load(std::memory_order_acquire) == true;\n+    }\n+\n+private:\n+    std::condition_variable& cond;\n+    std::mutex& mut;\n+    std::atomic<bool> val;\n+\n+    template <typename Duration>\n+    friend bool InterruptibleSleep(const Duration&, CThreadInterrupt&);\n+};\n+\n+/*\n+ * Sleep for the stated period of time, interruptible by clearing the flag and notifying the condvar.\n+ * @param   rel_time maximum time to wait. Should be a std::chrono::duration.\n+ * @param   threadInterrupt The interrupt that may wake the sleep\n+ * @returns false if the sleep was interrupted, true otherwise\n+ */\n+template <typename Duration>\n+bool InterruptibleSleep(const Duration& rel_time, CThreadInterrupt& threadInterrupt)",
    "path": "src/threadinterrupt.h",
    "position": null,
    "original_position": 47,
    "commit_id": "67ee4ec9015592c8447955356adfcbb1bf473e32",
    "original_commit_id": "e0bdb1d62ca62c9eae570a5d3dde3267672f5ce0",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This started out as a member function, but interrupt.sleep_for() felt awkward conceptually.\r\n\r\nWe can probably just force this to milliseconds. If we need microsecond precision later, we can just add another function.",
    "created_at": "2016-12-22T23:48:17Z",
    "updated_at": "2017-01-03T22:59:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r93715113",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93715113"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r93715113"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93715113/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 47,
    "side": "RIGHT",
    "in_reply_to_id": 93713941
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93715557",
    "pull_request_review_id": 14249348,
    "id": 93715557,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDkzNzE1NTU3",
    "diff_hunk": "@@ -0,0 +1,51 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2016 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <mutex>\n+#include <condition_variable>\n+#include <atomic>\n+\n+class CThreadInterrupt",
    "path": "src/threadinterrupt.h",
    "position": null,
    "original_position": 10,
    "commit_id": "67ee4ec9015592c8447955356adfcbb1bf473e32",
    "original_commit_id": "e0bdb1d62ca62c9eae570a5d3dde3267672f5ce0",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I suppose this could be rigged up with a separate condvar/mutex and some additional manual isinterruped checks.",
    "created_at": "2016-12-22T23:53:23Z",
    "updated_at": "2017-01-03T22:59:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r93715557",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93715557"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r93715557"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93715557/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 18,
    "original_line": 10,
    "side": "RIGHT",
    "in_reply_to_id": 93713812
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93822030",
    "pull_request_review_id": 14357877,
    "id": 93822030,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDkzODIyMDMw",
    "diff_hunk": "@@ -715,3 +717,8 @@ bool SetSocketNonBlocking(SOCKET& hSocket, bool fNonBlocking)\n \n     return true;\n }\n+\n+void InterruptSocks5(bool interrupt)",
    "path": "src/netbase.cpp",
    "position": 54,
    "original_position": 32,
    "commit_id": "67ee4ec9015592c8447955356adfcbb1bf473e32",
    "original_commit_id": "e0bdb1d62ca62c9eae570a5d3dde3267672f5ce0",
    "user": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Do we really want symbols that differ only in case?",
    "created_at": "2016-12-24T22:34:32Z",
    "updated_at": "2017-01-03T22:59:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r93822030",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93822030"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r93822030"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93822030/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 715,
    "original_line": 721,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93824187",
    "pull_request_review_id": 14359943,
    "id": 93824187,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDkzODI0MTg3",
    "diff_hunk": "@@ -715,3 +717,8 @@ bool SetSocketNonBlocking(SOCKET& hSocket, bool fNonBlocking)\n \n     return true;\n }\n+\n+void InterruptSocks5(bool interrupt)",
    "path": "src/netbase.cpp",
    "position": 54,
    "original_position": 32,
    "commit_id": "67ee4ec9015592c8447955356adfcbb1bf473e32",
    "original_commit_id": "e0bdb1d62ca62c9eae570a5d3dde3267672f5ce0",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Ah yes, probably unwise. Will change the atomic.",
    "created_at": "2016-12-25T05:21:39Z",
    "updated_at": "2017-01-03T22:59:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r93824187",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93824187"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r93824187"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93824187/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 715,
    "original_line": 721,
    "side": "RIGHT",
    "in_reply_to_id": 93822030
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93949474",
    "pull_request_review_id": 14480494,
    "id": 93949474,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDkzOTQ5NDc0",
    "diff_hunk": "@@ -901,7 +901,9 @@ void static ProcessGetData(CNode* pfrom, const Consensus::Params& consensusParam\n \n         const CInv &inv = *it;\n         {\n-            boost::this_thread::interruption_point();\n+            if(interruptMsgProc)",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 14,
    "commit_id": "67ee4ec9015592c8447955356adfcbb1bf473e32",
    "original_commit_id": "c827c1ac150ae1131781a7c86f8af17fef8e1736",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Style nit (in many places): space after `if`.",
    "created_at": "2016-12-27T16:51:29Z",
    "updated_at": "2017-01-03T22:59:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r93949474",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93949474"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r93949474"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/93949474/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 904,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94173760",
    "pull_request_review_id": 14704866,
    "id": 94173760,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0MTczNzYw",
    "diff_hunk": "@@ -0,0 +1,41 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto",
    "path": "src/threadinterrupt.cpp",
    "position": 1,
    "original_position": 1,
    "commit_id": "67ee4ec9015592c8447955356adfcbb1bf473e32",
    "original_commit_id": "bf2b0ad2583ceb7bb6d25db255bb54e6d92dae3f",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Satoshi did not write this... as far as I know at least? Nor was it written in 2009.",
    "created_at": "2016-12-29T19:53:18Z",
    "updated_at": "2017-01-03T22:59:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r94173760",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94173760"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r94173760"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94173760/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1,
    "original_line": 1,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94227634",
    "pull_request_review_id": 14704866,
    "id": 94227634,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0MjI3NjM0",
    "diff_hunk": "@@ -1877,8 +1887,10 @@ void CConnman::ThreadMessageHandler()\n                 pnode->Release();\n         }\n \n-        if (fSleep)\n-            messageHandlerCondition.timed_wait(lock, boost::posix_time::microsec_clock::universal_time() + boost::posix_time::milliseconds(100));\n+        if (fSleep) {\n+            std::unique_lock<std::mutex> lock(mutexMsgProc);\n+            condMsgProc.wait_until(lock, std::chrono::steady_clock::now() + std::chrono::milliseconds(100));",
    "path": "src/net.cpp",
    "position": 209,
    "original_position": 182,
    "commit_id": "67ee4ec9015592c8447955356adfcbb1bf473e32",
    "original_commit_id": "24e17858f4189d8535dbfb32efd4c2cbf7119bea",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It seems that `mutexMsgProc` is only used for locking `flagInterruptMsgProc` and waiting, making it very similar to `CThreadInterrupt`. If you'd add a `wake()` method to that class, which breaks from sleeps, but doesn't set the interrupt point, wouldn't you be able to replace the explicit mutex/flag/condvar with a CThreadInterrupt>",
    "created_at": "2016-12-30T13:32:49Z",
    "updated_at": "2017-01-03T22:59:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r94227634",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94227634"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r94227634"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94227634/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1890,
    "original_line": 1892,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94227749",
    "pull_request_review_id": 14704866,
    "id": 94227749,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0MjI3NzQ5",
    "diff_hunk": "@@ -2185,12 +2198,36 @@ class CNetCleanup\n }\n instance_of_cnetcleanup;\n \n-void CConnman::Stop()\n+void CConnman::Interrupt()\n {\n     LogPrintf(\"%s\\n\",__func__);\n+    {\n+        std::lock_guard<std::mutex> lock(mutexMsgProc);\n+        flagInterruptMsgProc = true;\n+    }\n+    condMsgProc.notify_all();\n+\n+    interruptNet();\n+    InterruptSocks5(true);\n+\n     if (semOutbound)\n         for (int i=0; i<(nMaxOutbound + nMaxFeeler); i++)\n             semOutbound->post();\n+}\n+\n+void CConnman::Stop()\n+{\n+    LogPrintf(\"%s\\n\",__func__);",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 290,
    "commit_id": "67ee4ec9015592c8447955356adfcbb1bf473e32",
    "original_commit_id": "bf2b0ad2583ceb7bb6d25db255bb54e6d92dae3f",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Leftover debug statement?",
    "created_at": "2016-12-30T13:34:53Z",
    "updated_at": "2017-01-03T22:59:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r94227749",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94227749"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r94227749"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94227749/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2220,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94249745",
    "pull_request_review_id": 14780924,
    "id": 94249745,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0MjQ5NzQ1",
    "diff_hunk": "@@ -1877,8 +1887,10 @@ void CConnman::ThreadMessageHandler()\n                 pnode->Release();\n         }\n \n-        if (fSleep)\n-            messageHandlerCondition.timed_wait(lock, boost::posix_time::microsec_clock::universal_time() + boost::posix_time::milliseconds(100));\n+        if (fSleep) {\n+            std::unique_lock<std::mutex> lock(mutexMsgProc);\n+            condMsgProc.wait_until(lock, std::chrono::steady_clock::now() + std::chrono::milliseconds(100));",
    "path": "src/net.cpp",
    "position": 209,
    "original_position": 182,
    "commit_id": "67ee4ec9015592c8447955356adfcbb1bf473e32",
    "original_commit_id": "24e17858f4189d8535dbfb32efd4c2cbf7119bea",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I tried to make CThreadInterrupt do this at first (see some of the back+forth with @TheBlueMatt) above. Your suggestion works fine here, I think, but it's not generic due to the lack of accounting for wake conditions. I think it could be done by having wait_until accept an optional predicate, which would be used internally as \"while !internal_wake && !pred()\".\r\n\r\nThe compromise was to only use it for plain sleeps. But it's bounced back and forth enough times that I really have no preference. If you'd prefer that, I'm happy to make the change.",
    "created_at": "2016-12-30T18:50:23Z",
    "updated_at": "2017-01-03T22:59:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r94249745",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94249745"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r94249745"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94249745/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1890,
    "original_line": 1892,
    "side": "RIGHT",
    "in_reply_to_id": 94227634
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94249763",
    "pull_request_review_id": 14780946,
    "id": 94249763,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0MjQ5NzYz",
    "diff_hunk": "@@ -0,0 +1,41 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto",
    "path": "src/threadinterrupt.cpp",
    "position": 1,
    "original_position": 1,
    "commit_id": "67ee4ec9015592c8447955356adfcbb1bf473e32",
    "original_commit_id": "bf2b0ad2583ceb7bb6d25db255bb54e6d92dae3f",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Caught me!",
    "created_at": "2016-12-30T18:50:39Z",
    "updated_at": "2017-01-03T22:59:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r94249763",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94249763"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r94249763"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94249763/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1,
    "original_line": 1,
    "side": "RIGHT",
    "in_reply_to_id": 94173760
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94249773",
    "pull_request_review_id": 14780955,
    "id": 94249773,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0MjQ5Nzcz",
    "diff_hunk": "@@ -2185,12 +2198,36 @@ class CNetCleanup\n }\n instance_of_cnetcleanup;\n \n-void CConnman::Stop()\n+void CConnman::Interrupt()\n {\n     LogPrintf(\"%s\\n\",__func__);\n+    {\n+        std::lock_guard<std::mutex> lock(mutexMsgProc);\n+        flagInterruptMsgProc = true;\n+    }\n+    condMsgProc.notify_all();\n+\n+    interruptNet();\n+    InterruptSocks5(true);\n+\n     if (semOutbound)\n         for (int i=0; i<(nMaxOutbound + nMaxFeeler); i++)\n             semOutbound->post();\n+}\n+\n+void CConnman::Stop()\n+{\n+    LogPrintf(\"%s\\n\",__func__);",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 290,
    "commit_id": "67ee4ec9015592c8447955356adfcbb1bf473e32",
    "original_commit_id": "bf2b0ad2583ceb7bb6d25db255bb54e6d92dae3f",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Will remove.",
    "created_at": "2016-12-30T18:50:48Z",
    "updated_at": "2017-01-03T22:59:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r94249773",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94249773"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r94249773"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94249773/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2220,
    "side": "RIGHT",
    "in_reply_to_id": 94227749
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94249944",
    "pull_request_review_id": 14781120,
    "id": 94249944,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0MjQ5OTQ0",
    "diff_hunk": "@@ -1877,8 +1887,10 @@ void CConnman::ThreadMessageHandler()\n                 pnode->Release();\n         }\n \n-        if (fSleep)\n-            messageHandlerCondition.timed_wait(lock, boost::posix_time::microsec_clock::universal_time() + boost::posix_time::milliseconds(100));\n+        if (fSleep) {\n+            std::unique_lock<std::mutex> lock(mutexMsgProc);\n+            condMsgProc.wait_until(lock, std::chrono::steady_clock::now() + std::chrono::milliseconds(100));",
    "path": "src/net.cpp",
    "position": 209,
    "original_position": 182,
    "commit_id": "67ee4ec9015592c8447955356adfcbb1bf473e32",
    "original_commit_id": "24e17858f4189d8535dbfb32efd4c2cbf7119bea",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Whoops, that's right, that didn't work because it would force the internal mutex to be exposed so the caller could actually set the wake condition.",
    "created_at": "2016-12-30T18:53:15Z",
    "updated_at": "2017-01-03T22:59:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r94249944",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94249944"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r94249944"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94249944/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1890,
    "original_line": 1892,
    "side": "RIGHT",
    "in_reply_to_id": 94227634
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94252014",
    "pull_request_review_id": 14783272,
    "id": 94252014,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0MjUyMDE0",
    "diff_hunk": "@@ -1877,8 +1887,10 @@ void CConnman::ThreadMessageHandler()\n                 pnode->Release();\n         }\n \n-        if (fSleep)\n-            messageHandlerCondition.timed_wait(lock, boost::posix_time::microsec_clock::universal_time() + boost::posix_time::milliseconds(100));\n+        if (fSleep) {\n+            std::unique_lock<std::mutex> lock(mutexMsgProc);\n+            condMsgProc.wait_until(lock, std::chrono::steady_clock::now() + std::chrono::milliseconds(100));",
    "path": "src/net.cpp",
    "position": 209,
    "original_position": 182,
    "commit_id": "67ee4ec9015592c8447955356adfcbb1bf473e32",
    "original_commit_id": "24e17858f4189d8535dbfb32efd4c2cbf7119bea",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Ok, I see. Let's think about generalizing this later. No need to hold this PR up.",
    "created_at": "2016-12-30T19:24:27Z",
    "updated_at": "2017-01-03T22:59:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r94252014",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94252014"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9289#discussion_r94252014"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9289"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94252014/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1890,
    "original_line": 1892,
    "side": "RIGHT",
    "in_reply_to_id": 94227634
  }
]