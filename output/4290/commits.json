[
  {
    "sha": "56b07d2dcdec336173b866210c535439b03416a1",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo1NmIwN2QyZGNkZWMzMzYxNzNiODY2MjEwYzUzNTQzOWIwMzQxNmEx",
    "commit": {
      "author": {
        "name": "Philip Kaufmann",
        "email": "phil.kaufmann@t-online.de",
        "date": "2014-05-29T11:02:22Z"
      },
      "committer": {
        "name": "Philip Kaufmann",
        "email": "phil.kaufmann@t-online.de",
        "date": "2014-06-11T10:04:17Z"
      },
      "message": "[Qt] allow setting listen via GUI\n\n- add DEFAULT_LISTEN in net.h and use in the code (shared\n  setting between core and GUI)\n\nImportant: This makes it obvious, that we need to re-think the\nsettings/options handling, as GUI settings are processed before\nany parameter-interaction (which is mostly important for network\nstuff) in AppInit2()!",
      "tree": {
        "sha": "939a4888f8d4cbc15d53fb928ba338c0c7ddfe30",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/939a4888f8d4cbc15d53fb928ba338c0c7ddfe30"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/56b07d2dcdec336173b866210c535439b03416a1",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/56b07d2dcdec336173b866210c535439b03416a1",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/56b07d2dcdec336173b866210c535439b03416a1",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/56b07d2dcdec336173b866210c535439b03416a1/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "5905d71fe3bb22d0111da7fb4ca8433ed54c9abf",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/5905d71fe3bb22d0111da7fb4ca8433ed54c9abf",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/5905d71fe3bb22d0111da7fb4ca8433ed54c9abf"
      }
    ],
    "stats": {
      "total": 30,
      "additions": 29,
      "deletions": 1
    },
    "files": [
      {
        "sha": "528c3df0648f349bbb1ec691959ab1bf58a52308",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/56b07d2dcdec336173b866210c535439b03416a1/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/56b07d2dcdec336173b866210c535439b03416a1/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=56b07d2dcdec336173b866210c535439b03416a1",
        "patch": "@@ -766,7 +766,7 @@ bool AppInit2(boost::thread_group& threadGroup)\n     }\n \n     // see Step 2: parameter interactions for more information about these\n-    fListen = GetBoolArg(\"-listen\", true);\n+    fListen = GetBoolArg(\"-listen\", DEFAULT_LISTEN);\n     fDiscover = GetBoolArg(\"-discover\", true);\n     fNameLookup = GetBoolArg(\"-dns\", true);\n "
      },
      {
        "sha": "11744aa7c4aba14ffeee2e673a26fcae028f5f86",
        "filename": "src/net.h",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/56b07d2dcdec336173b866210c535439b03416a1/src/net.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/56b07d2dcdec336173b866210c535439b03416a1/src/net.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.h?ref=56b07d2dcdec336173b866210c535439b03416a1",
        "patch": "@@ -38,6 +38,8 @@ namespace boost {\n \n /** The maximum number of entries in an 'inv' protocol message */\n static const unsigned int MAX_INV_SZ = 50000;\n+/** -listen default */\n+static const bool DEFAULT_LISTEN = true;\n /** -upnp default */\n #ifdef USE_UPNP\n static const bool DEFAULT_UPNP = USE_UPNP;"
      },
      {
        "sha": "0c5b8895aae1677678239864ea7f5ea3c55753bb",
        "filename": "src/qt/forms/optionsdialog.ui",
        "status": "modified",
        "additions": 10,
        "deletions": 0,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/56b07d2dcdec336173b866210c535439b03416a1/src/qt/forms/optionsdialog.ui",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/56b07d2dcdec336173b866210c535439b03416a1/src/qt/forms/optionsdialog.ui",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/forms/optionsdialog.ui?ref=56b07d2dcdec336173b866210c535439b03416a1",
        "patch": "@@ -242,6 +242,16 @@\n          </property>\n         </widget>\n        </item>\n+       <item>\n+        <widget class=\"QCheckBox\" name=\"allowIncoming\">\n+         <property name=\"toolTip\">\n+          <string>Accept connections from outside</string>\n+         </property>\n+         <property name=\"text\">\n+          <string>Allow incoming connections</string>\n+         </property>\n+        </widget>\n+       </item>\n        <item>\n         <widget class=\"QCheckBox\" name=\"connectSocks\">\n          <property name=\"toolTip\">"
      },
      {
        "sha": "abfd4123e0f549aafc956403bbb038be8697c878",
        "filename": "src/qt/optionsdialog.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/56b07d2dcdec336173b866210c535439b03416a1/src/qt/optionsdialog.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/56b07d2dcdec336173b866210c535439b03416a1/src/qt/optionsdialog.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/optionsdialog.cpp?ref=56b07d2dcdec336173b866210c535439b03416a1",
        "patch": "@@ -151,6 +151,7 @@ void OptionsDialog::setModel(OptionsModel *model)\n     /* Wallet */\n     connect(ui->spendZeroConfChange, SIGNAL(clicked(bool)), this, SLOT(showRestartWarning()));\n     /* Network */\n+    connect(ui->allowIncoming, SIGNAL(clicked(bool)), this, SLOT(showRestartWarning()));\n     connect(ui->connectSocks, SIGNAL(clicked(bool)), this, SLOT(showRestartWarning()));\n     /* Display */\n     connect(ui->lang, SIGNAL(valueChanged()), this, SLOT(showRestartWarning()));\n@@ -171,6 +172,7 @@ void OptionsDialog::setMapper()\n \n     /* Network */\n     mapper->addMapping(ui->mapPortUpnp, OptionsModel::MapPortUPnP);\n+    mapper->addMapping(ui->allowIncoming, OptionsModel::Listen);\n \n     mapper->addMapping(ui->connectSocks, OptionsModel::ProxyUse);\n     mapper->addMapping(ui->proxyIp, OptionsModel::ProxyIP);"
      },
      {
        "sha": "4dafd9d2afabd7799fe30f870730a5cd37ce402e",
        "filename": "src/qt/optionsmodel.cpp",
        "status": "modified",
        "additions": 13,
        "deletions": 0,
        "changes": 13,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/56b07d2dcdec336173b866210c535439b03416a1/src/qt/optionsmodel.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/56b07d2dcdec336173b866210c535439b03416a1/src/qt/optionsmodel.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/optionsmodel.cpp?ref=56b07d2dcdec336173b866210c535439b03416a1",
        "patch": "@@ -110,6 +110,11 @@ void OptionsModel::Init()\n     if (!SoftSetBoolArg(\"-upnp\", settings.value(\"fUseUPnP\").toBool()))\n         addOverriddenOption(\"-upnp\");\n \n+    if (!settings.contains(\"fListen\"))\n+        settings.setValue(\"fListen\", DEFAULT_LISTEN);\n+    if (!SoftSetBoolArg(\"-listen\", settings.value(\"fListen\").toBool()))\n+        addOverriddenOption(\"-listen\");\n+\n     if (!settings.contains(\"fUseProxy\"))\n         settings.setValue(\"fUseProxy\", false);\n     if (!settings.contains(\"addrProxy\"))\n@@ -214,6 +219,8 @@ QVariant OptionsModel::data(const QModelIndex & index, int role) const\n             return settings.value(\"nDatabaseCache\");\n         case ThreadsScriptVerif:\n             return settings.value(\"nThreadsScriptVerif\");\n+        case Listen:\n+            return settings.value(\"fListen\");\n         default:\n             return QVariant();\n         }\n@@ -339,6 +346,12 @@ bool OptionsModel::setData(const QModelIndex & index, const QVariant & value, in\n                 setRestartRequired(true);\n             }\n             break;\n+        case Listen:\n+            if (settings.value(\"fListen\") != value) {\n+                settings.setValue(\"fListen\", value);\n+                setRestartRequired(true);\n+            }\n+            break;\n         default:\n             break;\n         }"
      },
      {
        "sha": "2596682d07a4642ffe6581ed94a575820323d91b",
        "filename": "src/qt/optionsmodel.h",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/56b07d2dcdec336173b866210c535439b03416a1/src/qt/optionsmodel.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/56b07d2dcdec336173b866210c535439b03416a1/src/qt/optionsmodel.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/optionsmodel.h?ref=56b07d2dcdec336173b866210c535439b03416a1",
        "patch": "@@ -42,6 +42,7 @@ class OptionsModel : public QAbstractListModel\n         ThreadsScriptVerif,     // int\n         DatabaseCache,          // int\n         SpendZeroConfChange,    // bool\n+        Listen,                 // bool\n         OptionIDRowCount,\n     };\n "
      }
    ]
  }
]