[
  {
    "sha": "38f900290cc3a839e99bef13474d35e1c02e6b0d",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozOGY5MDAyOTBjYzNhODM5ZTk5YmVmMTM0NzRkMzVlMWMwMmU2YjBk",
    "commit": {
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2021-05-31T15:18:49Z"
      },
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2021-07-09T09:19:35Z"
      },
      "message": "net: change assumed I2P port to 0\n\n* When accepting an I2P connection, assume the peer has port 0 instead\n  of the default 8333 (for mainnet). It is not being sent to us, so we\n  must assume something.\n* When deriving our own I2P listen CService use port 0 instead of the\n  default 8333 (for mainnet). So that we later advertise it to peers\n  with port 0.\n\nIn the I2P protocol SAM 3.1 and older (we use 3.1) ports are not used,\nso they are irrelevant. However in SAM 3.2 and newer ports are used and\nfrom the point of view of SAM 3.2, a peer using SAM 3.1 seems to have\nspecified port=0.",
      "tree": {
        "sha": "a2b675570fd8095ebbd14876c3297626a80e1354",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a2b675570fd8095ebbd14876c3297626a80e1354"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/38f900290cc3a839e99bef13474d35e1c02e6b0d",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmDoFKcACgkQVN8G9ktV\ny7+t3x/+J1g2JtSGfyl+5ZxQlnqK//uiDzWa2PM8A1zGtJTUgLhkgt32mjmMuWgQ\nWkUUuoV404U7ae1fLY5FKhTg6mA9SzwQuhIVpmuAy8Y3jTCLN1JRsSeyrGapZ4SA\n4kS9BDfFQb3V3oji+nxR0wFSCcs1N4XiBrhnpdJ5q7wh7wx2pTzzq75OoDqfpvjk\n0Rx3OUklK/blY5zKmHtASwBr8l5N4Zhe1ToA43+8OQ4s1uKDb2+sZ0zkYi3W3tnQ\njprK1XK5TI5JQ4rS0bIq4TEr+VOpUFxHsa6q0mNSGWBw/En2kvysrcEsF0XPCFhW\nhW4X86Be6KqttuS8arsN3np8hnpaPOzBQAYVwj864HhSxPTmT4ebIvyIebYWPWuT\n39cSFVg6pvyHDGMh78Y2LfpTwVPTpQlN1Kkk6l3yOR9MjUky7m4H7RsPrfpyCnvU\nbX55T+AzO0ZrMaD0kHTk0eFQD5z43NWukXLzU/uYe0/6sEZm4AQoTiMB4xyu1zzv\nR8Y9t84vJAUtpeVBCIKpOc+DR93AaQ6KeAbfp+CayLB58oEaCtC4eVwJJLCzR6L7\npa7ytYNfuSfMnGniW9yZhkYd4y+h8obDiEZY/kAI5l/j8y50pEx2LfKpqsew2GQZ\n+4ctfBLPgBrXBr1npiX8gOqjcCF3yLb2/OP5x3FdhD6pOcbiiuY6BDVK0Nw6pqER\nfGHKoHI03eQMBihHgrxfGpIXt1fKP6105x9Dm6p4q1+/UlGN5TxlDLNaPJO2YMft\naAN/hPlQ/tVPQOWumMWw2EJJ1YcbtrlQnfuugPjhHBH5jaXjoLENwE/ADAgDrr9E\nbCDSIySijS43pCN9rtL8Wsqpz5CQR03LN5n9o7nroekO4iuU3yqLyduVwPvdawQc\n/PVAFxJ5qxjHNgimum+RWMGLXyuFNoFidEMFn9GZ7XZPFeZKhC7n3R1ax1Ziv3b9\ngHqB0LhPrwzRiSFsOCt2fWYYgSJZs7s4W3PZVvTN725xC2Tn3s3vF5wC1LT/RoRg\nPio70vHTVJKsXgwI1fJNoCjZ5XpQIAVCscEc0e4zDKrm5tP+grHsJUbknMsEyvj7\ntFjmnh/VmabMFMhkb8JzeJzPyyM8VG62uwKVQ9StK7xD/QFRJkGXbjJHENgFL1IA\nd4CAx/VIQvfwNKcmq0nWHiJUKF2o84+0ME9nnUZ9TG86ZeFe5o/2FuznBLfxxPff\nZlpjzgPpR84KYTMciQj6CZPCoZqWz7aC0Ix6XxhwnNqvjefCjvnDbIYVheFt+hP6\nRpQEekwEQZtEwYhyNkhwIUrtIaxBgxSq8IVDGxAK197FK/lKp23XUXSjfiDoqiFJ\npfavhB1ocT5CEau1sh6NdVA2rLnp4A==\n=CHc1\n-----END PGP SIGNATURE-----",
        "payload": "tree a2b675570fd8095ebbd14876c3297626a80e1354\nparent efff9c3494a944a1a9288fec13e8bb5f23235920\nauthor Vasil Dimov <vd@FreeBSD.org> 1622474329 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1625822375 +0200\n\nnet: change assumed I2P port to 0\n\n* When accepting an I2P connection, assume the peer has port 0 instead\n  of the default 8333 (for mainnet). It is not being sent to us, so we\n  must assume something.\n* When deriving our own I2P listen CService use port 0 instead of the\n  default 8333 (for mainnet). So that we later advertise it to peers\n  with port 0.\n\nIn the I2P protocol SAM 3.1 and older (we use 3.1) ports are not used,\nso they are irrelevant. However in SAM 3.2 and newer ports are used and\nfrom the point of view of SAM 3.2, a peer using SAM 3.1 seems to have\nspecified port=0.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/38f900290cc3a839e99bef13474d35e1c02e6b0d",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/38f900290cc3a839e99bef13474d35e1c02e6b0d",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/38f900290cc3a839e99bef13474d35e1c02e6b0d/comments",
    "author": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "efff9c3494a944a1a9288fec13e8bb5f23235920",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/efff9c3494a944a1a9288fec13e8bb5f23235920",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/efff9c3494a944a1a9288fec13e8bb5f23235920"
      }
    ],
    "stats": {
      "total": 9,
      "additions": 6,
      "deletions": 3
    },
    "files": [
      {
        "sha": "dbd4d46baa73116096bbf7f7bc0db1d0f50bd4f9",
        "filename": "src/i2p.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/38f900290cc3a839e99bef13474d35e1c02e6b0d/src/i2p.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/38f900290cc3a839e99bef13474d35e1c02e6b0d/src/i2p.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/i2p.cpp?ref=38f900290cc3a839e99bef13474d35e1c02e6b0d",
        "patch": "@@ -159,7 +159,7 @@ bool Session::Accept(Connection& conn)\n             const std::string& peer_dest =\n                 conn.sock->RecvUntilTerminator('\\n', MAX_WAIT_FOR_IO, *m_interrupt, MAX_MSG_SIZE);\n \n-            conn.peer = CService(DestB64ToAddr(peer_dest), Params().GetDefaultPort());\n+            conn.peer = CService(DestB64ToAddr(peer_dest), I2P_SAM31_PORT);\n \n             return true;\n         }\n@@ -366,7 +366,7 @@ void Session::CreateIfNotCreatedAlready()\n     SendRequestAndGetReply(*sock, strprintf(\"SESSION CREATE STYLE=STREAM ID=%s DESTINATION=%s\",\n                                             session_id, private_key_b64));\n \n-    m_my_addr = CService(DestBinToAddr(MyDestination()), Params().GetDefaultPort());\n+    m_my_addr = CService(DestBinToAddr(MyDestination()), I2P_SAM31_PORT);\n     m_session_id = session_id;\n     m_control_sock = std::move(sock);\n "
      },
      {
        "sha": "7dc822bcf6a355ad067a0885c05e5adc89165213",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/38f900290cc3a839e99bef13474d35e1c02e6b0d/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/38f900290cc3a839e99bef13474d35e1c02e6b0d/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=38f900290cc3a839e99bef13474d35e1c02e6b0d",
        "patch": "@@ -442,7 +442,7 @@ void SetupServerArgs(ArgsManager& argsman)\n     argsman.AddArg(\"-peerbloomfilters\", strprintf(\"Support filtering of blocks and transaction with bloom filters (default: %u)\", DEFAULT_PEERBLOOMFILTERS), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);\n     argsman.AddArg(\"-peerblockfilters\", strprintf(\"Serve compact block filters to peers per BIP 157 (default: %u)\", DEFAULT_PEERBLOCKFILTERS), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);\n     argsman.AddArg(\"-permitbaremultisig\", strprintf(\"Relay non-P2SH multisig (default: %u)\", DEFAULT_PERMIT_BAREMULTISIG), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);\n-    argsman.AddArg(\"-port=<port>\", strprintf(\"Listen for connections on <port>. Nodes not using the default ports (default: %u, testnet: %u, signet: %u, regtest: %u) are unlikely to get incoming connections.\", defaultChainParams->GetDefaultPort(), testnetChainParams->GetDefaultPort(), signetChainParams->GetDefaultPort(), regtestChainParams->GetDefaultPort()), ArgsManager::ALLOW_ANY | ArgsManager::NETWORK_ONLY, OptionsCategory::CONNECTION);\n+    argsman.AddArg(\"-port=<port>\", strprintf(\"Listen for connections on <port>. Nodes not using the default ports (default: %u, testnet: %u, signet: %u, regtest: %u) are unlikely to get incoming connections. Not relevant for I2P (see doc/i2p.md).\", defaultChainParams->GetDefaultPort(), testnetChainParams->GetDefaultPort(), signetChainParams->GetDefaultPort(), regtestChainParams->GetDefaultPort()), ArgsManager::ALLOW_ANY | ArgsManager::NETWORK_ONLY, OptionsCategory::CONNECTION);\n     argsman.AddArg(\"-proxy=<ip:port>\", \"Connect through SOCKS5 proxy, set -noproxy to disable (default: disabled)\", ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);\n     argsman.AddArg(\"-proxyrandomize\", strprintf(\"Randomize credentials for every proxy connection. This enables Tor stream isolation (default: %u)\", DEFAULT_PROXYRANDOMIZE), ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);\n     argsman.AddArg(\"-seednode=<ip>\", \"Connect to a node to retrieve peer addresses, and disconnect. This option can be specified multiple times to connect to multiple nodes.\", ArgsManager::ALLOW_ANY, OptionsCategory::CONNECTION);"
      },
      {
        "sha": "d5049963472511f2432f6023b997952ebf46560f",
        "filename": "src/netaddress.h",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/38f900290cc3a839e99bef13474d35e1c02e6b0d/src/netaddress.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/38f900290cc3a839e99bef13474d35e1c02e6b0d/src/netaddress.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/netaddress.h?ref=38f900290cc3a839e99bef13474d35e1c02e6b0d",
        "patch": "@@ -112,6 +112,9 @@ static constexpr size_t ADDR_CJDNS_SIZE = 16;\n /// Size of \"internal\" (NET_INTERNAL) address (in bytes).\n static constexpr size_t ADDR_INTERNAL_SIZE = 10;\n \n+/// SAM 3.1 and earlier do not support specifying ports and force the port to 0.\n+static constexpr uint16_t I2P_SAM31_PORT{0};\n+\n /**\n  * Network address.\n  */"
      }
    ]
  },
  {
    "sha": "aeac3bce3ead1f24ca782079ef0defa86fd8cb98",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphZWFjM2JjZTNlYWQxZjI0Y2E3ODIwNzllZjBkZWZhODZmZDhjYjk4",
    "commit": {
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2021-05-31T15:26:02Z"
      },
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2021-07-09T09:19:35Z"
      },
      "message": "net: change I2P seeds' ports to 0",
      "tree": {
        "sha": "918f94458e1928c03271524e68fe00533058935a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/918f94458e1928c03271524e68fe00533058935a"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/aeac3bce3ead1f24ca782079ef0defa86fd8cb98",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmDoFKgACgkQVN8G9ktV\ny78Oox/9FBHkFUeF/e+uFvqCJLUs485ng3pWLI3PVQvfnWrel4tFBkPoSTe8k5VC\nNj833wivXrzQhuFC/2MCLtqCFf421vprAh8r8iBHaprDRosXtwaKbQBEgdvzAuZx\n9AnoJbscD8VQyW/drO6mEe8NcMAo5y/wanZrUSlBSgjE5h+wbsCqcvas49VF+DY2\nyuhaUfKL2wCy5nWxvcOmNgalNI6/C0+INVPPMybtU+blNBuyPcWsB+Wo9B8THuqr\nNyLzMjPZoK+grKHtD1KO8PODujybzO4w++ZBXX58Y+fbr0mSfoj35bACMc+WCjKH\neueH4uYS6NKUKsq146a8gKDCKtcuJxkEQzYWUQqJxhBY4QiOi8uY+XZhE90r5jnc\ndaCb/BPOk1AOtvikU8uDu5LgLTwmqAtpYSSnY5Defg6KOon0dYtCYziURy9lhEoo\nlEbWGyVC+rQRMjRNYVjboGG1QaJ6MqyYdEjDsKtRAd7zGuxGYiazWmjQBpwoiXvR\nsoaD2lUugpb0aXJ5Ycjjt0B6ZHA68aQwZGIlToK1Lex8Q5IAQMbb6+kpEQdK10vk\nJQWwCV0czW6Sr5r6OpugzlS2NlK3HTNrB+SskH8G/KKnlf7kNQfQvYjpm9ySIEcJ\n8R6VuH/3iRg3m3TbZmhUMJDC2CHPvOD9ClxoIgXURzRzEwLakdYxYyWdJj+OZ990\nrwxEI1+xs4thdDk/ojLlt727sV0rv4tkApo5GzY249/9HdUbzc6Byfa2OmGtVXgr\n31ktvWiGR1E8ceacN9TEbymZOBJTrizWECU9xfcp67ladAg6aI1yvAnjmHio1Kg6\n6rXw1vtFYbtISleg9s2R4T6S4Sonk0EU/2SrOgRLLLPRwdKgCjNtpRchQWBjUFp2\nE7cyHd2apccm3oL46ztDLg8JHkBt2CqUg8XRSSz3w8Hr0rfObG74ner3c51mPiCg\n8jVcMDFJdxJIkVN8D/pAnj6UopBpJjj8ytlucFTB27kprVicNFW5RulcGtRGuBzn\nDDnVOx05zNPCRh9IjIGWgssg6btrzhXVh9/+bFyooMtuQj+4iNPJjhd1G7DbILFl\nNYGpKL9YVb+8h15S/FA025dkCgCEoYHZeteEM9Pu4d7de/u/IN8ZrprzrEIvQ3f+\nRQidTBUqVB630fBxKVuely9H7ZtNMv5F5YkZD3VtBuusMZL4XGoK0f1dBT3lTHQl\neFvRH264C/6Rhmug7QQooRtGO1mY0KT7RhykO69vyJXPdoicr2wT37235AH1JEBs\n+wqp2fIN6tCKAGWadYryMYFjccgWVZW1mf/qwvsB9jv5ygfuQnHqMXGb+5fFyGIC\neYJA/cKrJyNTqi6VFdEXAoKumacgHw==\n=3qXu\n-----END PGP SIGNATURE-----",
        "payload": "tree 918f94458e1928c03271524e68fe00533058935a\nparent 38f900290cc3a839e99bef13474d35e1c02e6b0d\nauthor Vasil Dimov <vd@FreeBSD.org> 1622474762 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1625822375 +0200\n\nnet: change I2P seeds' ports to 0\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/aeac3bce3ead1f24ca782079ef0defa86fd8cb98",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/aeac3bce3ead1f24ca782079ef0defa86fd8cb98",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/aeac3bce3ead1f24ca782079ef0defa86fd8cb98/comments",
    "author": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "38f900290cc3a839e99bef13474d35e1c02e6b0d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/38f900290cc3a839e99bef13474d35e1c02e6b0d",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/38f900290cc3a839e99bef13474d35e1c02e6b0d"
      }
    ],
    "stats": {
      "total": 32,
      "additions": 16,
      "deletions": 16
    },
    "files": [
      {
        "sha": "f7bfb6eb0a239ba17ff2aa8579a4ba85217cc498",
        "filename": "contrib/seeds/nodes_main.txt",
        "status": "modified",
        "additions": 8,
        "deletions": 8,
        "changes": 16,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/aeac3bce3ead1f24ca782079ef0defa86fd8cb98/contrib/seeds/nodes_main.txt",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/aeac3bce3ead1f24ca782079ef0defa86fd8cb98/contrib/seeds/nodes_main.txt",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/seeds/nodes_main.txt?ref=aeac3bce3ead1f24ca782079ef0defa86fd8cb98",
        "patch": "@@ -678,11 +678,11 @@ vi5bnbxkleeqi6hfccjochnn65lcxlfqs4uwgmhudph554zibiusqnad.onion:8333\n xqt25cobm5zqucac3634zfght72he6u3eagfyej5ellbhcdgos7t2had.onion:8333\n \n # manually added 2021-05 for minimal i2p bootstrap support\n-72l3ucjkuscrbiiepoehuwqgknyzgo7zuix5ty4puwrkyhtmnsga.b32.i2p:8333\n-c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p:8333\n-gehtac45oaghz54ypyopim64mql7oad2bqclla74l6tfeolzmodq.b32.i2p:8333\n-h3r6bkn46qxftwja53pxiykntegfyfjqtnzbm6iv6r5mungmqgmq.b32.i2p:8333\n-hnbbyjpxx54623l555sta7pocy3se4sdgmuebi5k6reesz5rjp6q.b32.i2p:8333\n-pjs7or2ctvteeo5tu4bwyrtydeuhqhvdprtujn4daxr75jpebjxa.b32.i2p:8333\n-wwbw7nqr3ahkqv62cuqfwgtneekvvpnuc4i4f6yo7tpoqjswvcwa.b32.i2p:8333\n-zsxwyo6qcn3chqzwxnseusqgsnuw3maqnztkiypyfxtya4snkoka.b32.i2p:8333\n+72l3ucjkuscrbiiepoehuwqgknyzgo7zuix5ty4puwrkyhtmnsga.b32.i2p:0\n+c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p:0\n+gehtac45oaghz54ypyopim64mql7oad2bqclla74l6tfeolzmodq.b32.i2p:0\n+h3r6bkn46qxftwja53pxiykntegfyfjqtnzbm6iv6r5mungmqgmq.b32.i2p:0\n+hnbbyjpxx54623l555sta7pocy3se4sdgmuebi5k6reesz5rjp6q.b32.i2p:0\n+pjs7or2ctvteeo5tu4bwyrtydeuhqhvdprtujn4daxr75jpebjxa.b32.i2p:0\n+wwbw7nqr3ahkqv62cuqfwgtneekvvpnuc4i4f6yo7tpoqjswvcwa.b32.i2p:0\n+zsxwyo6qcn3chqzwxnseusqgsnuw3maqnztkiypyfxtya4snkoka.b32.i2p:0"
      },
      {
        "sha": "a22529c38659d8714718b24ec7e0e5fc89df0363",
        "filename": "src/chainparamsseeds.h",
        "status": "modified",
        "additions": 8,
        "deletions": 8,
        "changes": 16,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/aeac3bce3ead1f24ca782079ef0defa86fd8cb98/src/chainparamsseeds.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/aeac3bce3ead1f24ca782079ef0defa86fd8cb98/src/chainparamsseeds.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/chainparamsseeds.h?ref=aeac3bce3ead1f24ca782079ef0defa86fd8cb98",
        "patch": "@@ -683,14 +683,14 @@ static const uint8_t chainparams_seed_main[] = {\n     0x04,0x20,0x98,0xc6,0x44,0x27,0x90,0x41,0xa6,0x98,0xf9,0x25,0x6c,0x59,0x0f,0x06,0x6d,0x44,0x59,0x0e,0xb2,0x46,0xb0,0xa4,0x37,0x88,0x69,0x8f,0xc1,0x32,0xcd,0x9f,0x15,0xd7,0x20,0x8d,\n     0x04,0x20,0xaa,0x3a,0x16,0x86,0xea,0x59,0x09,0x04,0x78,0xe5,0x10,0x92,0xe1,0x1d,0xad,0xf7,0x56,0x2b,0xac,0xb0,0x97,0x29,0x63,0x30,0xf4,0x1b,0xcf,0xde,0xf3,0x28,0x0a,0x29,0x20,0x8d,\n     0x04,0x20,0xbc,0x27,0xae,0x89,0xc1,0x67,0x73,0x0a,0x08,0x02,0xdf,0xb7,0xcc,0x94,0xc7,0x9f,0xf4,0x72,0x7a,0x9b,0x20,0x0c,0x5c,0x11,0x3d,0x22,0xd6,0x13,0x88,0x66,0x74,0xbf,0x20,0x8d,\n-    0x05,0x20,0xfe,0x97,0xba,0x09,0x2a,0xa4,0x85,0x10,0xa1,0x04,0x7b,0x88,0x7a,0x5a,0x06,0x53,0x71,0x93,0x3b,0xf9,0xa2,0x2f,0xd9,0xe3,0x8f,0xa5,0xa2,0xac,0x1e,0x6c,0x6c,0x8c,0x20,0x8d,\n-    0x05,0x20,0x17,0x0c,0x56,0xce,0x72,0xa5,0xa0,0xe6,0x23,0x06,0xa3,0xc7,0x08,0x43,0x18,0xee,0x3a,0x46,0x35,0x5d,0x17,0xf6,0x78,0x96,0xa0,0x9c,0x51,0xef,0xbe,0x23,0xfd,0x71,0x20,0x8d,\n-    0x05,0x20,0x31,0x0f,0x30,0x0b,0x9d,0x70,0x0c,0x7c,0xf7,0x98,0x7e,0x1c,0xf4,0x33,0xdc,0x64,0x17,0xf7,0x00,0x7a,0x0c,0x04,0xb5,0x83,0xfc,0x5f,0xa6,0x52,0x39,0x79,0x63,0x87,0x20,0x8d,\n-    0x05,0x20,0x3e,0xe3,0xe0,0xa9,0xbc,0xf4,0x2e,0x59,0xd9,0x20,0xee,0xdf,0x74,0x61,0x4d,0x99,0x0c,0x5c,0x15,0x30,0x9b,0x72,0x16,0x79,0x15,0xf4,0x7a,0xca,0x34,0xcc,0x81,0x99,0x20,0x8d,\n-    0x05,0x20,0x3b,0x42,0x1c,0x25,0xf7,0xbf,0x79,0xed,0x6d,0x7d,0xef,0x65,0x30,0x7d,0xee,0x16,0x37,0x22,0x72,0x43,0x33,0x28,0x40,0xa3,0xaa,0xf4,0x48,0x49,0x67,0xb1,0x4b,0xfd,0x20,0x8d,\n-    0x05,0x20,0x7a,0x65,0xf7,0x47,0x42,0x9d,0x66,0x42,0x3b,0xb3,0xa7,0x03,0x6c,0x46,0x78,0x19,0x28,0x78,0x1e,0xa3,0x7c,0x67,0x44,0xb7,0x83,0x05,0xe3,0xfe,0xa5,0xe4,0x0a,0x6e,0x20,0x8d,\n-    0x05,0x20,0xb5,0x83,0x6f,0xb6,0x11,0xd8,0x0e,0xa8,0x57,0xda,0x15,0x20,0x5b,0x1a,0x6d,0x21,0x15,0x5a,0xbd,0xb4,0x17,0x11,0xc2,0xfb,0x0e,0xfc,0xde,0xe8,0x26,0x56,0xa8,0xac,0x20,0x8d,\n-    0x05,0x20,0xcc,0xaf,0x6c,0x3b,0xd0,0x13,0x76,0x23,0xc3,0x36,0xbb,0x64,0x4a,0x4a,0x06,0x93,0x69,0x6d,0xb0,0x10,0x6e,0x66,0xa4,0x61,0xf8,0x2d,0xe7,0x80,0x72,0x4d,0x53,0x94,0x20,0x8d,\n+    0x05,0x20,0xfe,0x97,0xba,0x09,0x2a,0xa4,0x85,0x10,0xa1,0x04,0x7b,0x88,0x7a,0x5a,0x06,0x53,0x71,0x93,0x3b,0xf9,0xa2,0x2f,0xd9,0xe3,0x8f,0xa5,0xa2,0xac,0x1e,0x6c,0x6c,0x8c,0x00,0x00,\n+    0x05,0x20,0x17,0x0c,0x56,0xce,0x72,0xa5,0xa0,0xe6,0x23,0x06,0xa3,0xc7,0x08,0x43,0x18,0xee,0x3a,0x46,0x35,0x5d,0x17,0xf6,0x78,0x96,0xa0,0x9c,0x51,0xef,0xbe,0x23,0xfd,0x71,0x00,0x00,\n+    0x05,0x20,0x31,0x0f,0x30,0x0b,0x9d,0x70,0x0c,0x7c,0xf7,0x98,0x7e,0x1c,0xf4,0x33,0xdc,0x64,0x17,0xf7,0x00,0x7a,0x0c,0x04,0xb5,0x83,0xfc,0x5f,0xa6,0x52,0x39,0x79,0x63,0x87,0x00,0x00,\n+    0x05,0x20,0x3e,0xe3,0xe0,0xa9,0xbc,0xf4,0x2e,0x59,0xd9,0x20,0xee,0xdf,0x74,0x61,0x4d,0x99,0x0c,0x5c,0x15,0x30,0x9b,0x72,0x16,0x79,0x15,0xf4,0x7a,0xca,0x34,0xcc,0x81,0x99,0x00,0x00,\n+    0x05,0x20,0x3b,0x42,0x1c,0x25,0xf7,0xbf,0x79,0xed,0x6d,0x7d,0xef,0x65,0x30,0x7d,0xee,0x16,0x37,0x22,0x72,0x43,0x33,0x28,0x40,0xa3,0xaa,0xf4,0x48,0x49,0x67,0xb1,0x4b,0xfd,0x00,0x00,\n+    0x05,0x20,0x7a,0x65,0xf7,0x47,0x42,0x9d,0x66,0x42,0x3b,0xb3,0xa7,0x03,0x6c,0x46,0x78,0x19,0x28,0x78,0x1e,0xa3,0x7c,0x67,0x44,0xb7,0x83,0x05,0xe3,0xfe,0xa5,0xe4,0x0a,0x6e,0x00,0x00,\n+    0x05,0x20,0xb5,0x83,0x6f,0xb6,0x11,0xd8,0x0e,0xa8,0x57,0xda,0x15,0x20,0x5b,0x1a,0x6d,0x21,0x15,0x5a,0xbd,0xb4,0x17,0x11,0xc2,0xfb,0x0e,0xfc,0xde,0xe8,0x26,0x56,0xa8,0xac,0x00,0x00,\n+    0x05,0x20,0xcc,0xaf,0x6c,0x3b,0xd0,0x13,0x76,0x23,0xc3,0x36,0xbb,0x64,0x4a,0x4a,0x06,0x93,0x69,0x6d,0xb0,0x10,0x6e,0x66,0xa4,0x61,0xf8,0x2d,0xe7,0x80,0x72,0x4d,0x53,0x94,0x00,0x00,\n };\n \n static const uint8_t chainparams_seed_test[] = {"
      }
    ]
  },
  {
    "sha": "1f096f091ebd88efb18154b8894a38122c39624f",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxZjA5NmYwOTFlYmQ4OGVmYjE4MTU0Yjg4OTRhMzgxMjJjMzk2MjRm",
    "commit": {
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2021-05-31T15:30:18Z"
      },
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2021-07-09T09:19:36Z"
      },
      "message": "net: distinguish default port per network\n\nChange `CChainParams::GetDefaultPort()` to return 0 if the network is\nI2P.",
      "tree": {
        "sha": "5c1883100bfd0705e1d40ab1144d56ee0fe18fa9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5c1883100bfd0705e1d40ab1144d56ee0fe18fa9"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1f096f091ebd88efb18154b8894a38122c39624f",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmDoFKgACgkQVN8G9ktV\ny79QUB//X3H7j5IHTGe2bO1BrZw4UQjNy7vOQNUPiMlf/r2rdW0dSnlfNkNHFQqz\nKW83YMric+OEZvYUiG1BxIr4URqk2tOF6VnYuC/1RjXuy0hD7WNjLCGVw8xxVpBF\nrVEzg/yjh6OEFZsxJT1kifxaA6PyrZ+eCm+3XCF+ZhrBrKWEe0PibkBFAMhbO0tg\ngXBlfQqQlf3ALDSMzlNnoZMIpRyVyPzOG2WAepbjXzIK6dy+nyVkDCeXASNrV7yJ\nKCtQl/WBSAYeatP4oyt/6hyZiY1Gp3T9W/2potSp9dXHUGyJPEava6f1NlFj6JEt\nYbXbER012qUbP1yiVIzXsrrXJHz7RULH3G6Jq/NUsz+ILusRD4AFsTcwoqju2x+y\no/a6CrPyzuq9/DgHVEL2KM51+/eSldKCrZswDA0bk0Rt5tZnsqAleKmL7v7NZDbO\nBk9iluyi3CIjr0/yl9y50nlelCZVby10DopCM4WiqHSPvzpxfINEGuRn8m24FKM7\ngQLxY1kDs/0czXEn74sALtWJHtkqfNLWX4zWj3MHARV4SFp8xzlWNBahXLaZWyBm\nPVH62gWXtucxPYBgkp5jLtgnsZQnTvLOiOusUYXw6iTlaBNloYS7NE7/ZrK5/Xdx\nTkuw5/+RW7M/6QE2yoKCY8W1if0lkwKWg8Gjk02SVFRDJ/G07GP3CpFHwfUMjFK8\nIqVr1EQXDYwjt1d2TR8pmFnQRetxBPrfeJ5QDBXuB6OWMLOkiZ/Q66IYLlLjvfUI\nr0QF4qaJmrBKm0N0qYcEiPl5JDWTVOQ6R9/g54+q6IsOy5fc37BQhhoyGtrAWx76\nvUkN3oKoa/j+m2IJ8x5p05Zi64ptSjOfGcBrZB4m8GA2hSboMFhH02ElKjeaSROv\nCir1nBvLSBRksB0oWU/gEFGDLNTYtiz/SVdIOXvpBTMEvYb0BZgMvAJzGfuXLAuq\nlQ4oMZ3Hq0R0nwmx/zKz3r7YZRFtMDDBJ7bbNf0r6NZwo8fpqUi4Ky/cjDUMrHCa\nU3fn8p7Cwi9+UhoUlcNMghW9FdhmRNQ3iK0UdTigynm0laFF1L3l4vxC21RsKshE\nI5Hi3QHtCWYbuKfziIa+2Gn9hhuQCmSqHJMmi32QArG+xox9w4GC/XtsA0kxk88d\nvRTqbJoQa+eV1dwCdMUBd9NNFUoMBqCHlOdPwra0JbHg7TjRwH+kIRRacaw9bQ2J\ntEyllTlh45jz8818GA6fGy/ZKvdZlQvnWNkIckVZRHta2YItc0WsDVZyzmNRPh/Q\nZWCHObuVj0VhxJahcZHUqrQCtco3dJg6I0SaCaJXc568Rf2ePBwUzIc0jb3XEln8\nCdChOPTk5QpFcjcbc57hE+9TmEkY8g==\n=AXtw\n-----END PGP SIGNATURE-----",
        "payload": "tree 5c1883100bfd0705e1d40ab1144d56ee0fe18fa9\nparent aeac3bce3ead1f24ca782079ef0defa86fd8cb98\nauthor Vasil Dimov <vd@FreeBSD.org> 1622475018 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1625822376 +0200\n\nnet: distinguish default port per network\n\nChange `CChainParams::GetDefaultPort()` to return 0 if the network is\nI2P.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1f096f091ebd88efb18154b8894a38122c39624f",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/1f096f091ebd88efb18154b8894a38122c39624f",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1f096f091ebd88efb18154b8894a38122c39624f/comments",
    "author": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "aeac3bce3ead1f24ca782079ef0defa86fd8cb98",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/aeac3bce3ead1f24ca782079ef0defa86fd8cb98",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/aeac3bce3ead1f24ca782079ef0defa86fd8cb98"
      }
    ],
    "stats": {
      "total": 19,
      "additions": 16,
      "deletions": 3
    },
    "files": [
      {
        "sha": "4faa6f8d06a1cfe482347fa606dc8685a4cd97c1",
        "filename": "src/chainparams.h",
        "status": "modified",
        "additions": 11,
        "deletions": 0,
        "changes": 11,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1f096f091ebd88efb18154b8894a38122c39624f/src/chainparams.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1f096f091ebd88efb18154b8894a38122c39624f/src/chainparams.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/chainparams.h?ref=1f096f091ebd88efb18154b8894a38122c39624f",
        "patch": "@@ -8,11 +8,13 @@\n \n #include <chainparamsbase.h>\n #include <consensus/params.h>\n+#include <netaddress.h>\n #include <primitives/block.h>\n #include <protocol.h>\n #include <util/hash_type.h>\n \n #include <memory>\n+#include <string>\n #include <vector>\n \n typedef std::map<int, uint256> MapCheckpoints;\n@@ -80,6 +82,15 @@ class CChainParams\n     const Consensus::Params& GetConsensus() const { return consensus; }\n     const CMessageHeader::MessageStartChars& MessageStart() const { return pchMessageStart; }\n     uint16_t GetDefaultPort() const { return nDefaultPort; }\n+    uint16_t GetDefaultPort(Network net) const\n+    {\n+        return net == NET_I2P ? I2P_SAM31_PORT : GetDefaultPort();\n+    }\n+    uint16_t GetDefaultPort(const std::string& addr) const\n+    {\n+        CNetAddr a;\n+        return a.SetSpecial(addr) ? GetDefaultPort(a.GetNetwork()) : GetDefaultPort();\n+    }\n \n     const CBlock& GenesisBlock() const { return genesis; }\n     /** Default value for -checkmempool and -checkblockindex argument */"
      },
      {
        "sha": "a6f439674f8081dd188d6a4ebeb05748f5ac26cb",
        "filename": "src/net.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 3,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1f096f091ebd88efb18154b8894a38122c39624f/src/net.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1f096f091ebd88efb18154b8894a38122c39624f/src/net.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.cpp?ref=1f096f091ebd88efb18154b8894a38122c39624f",
        "patch": "@@ -402,7 +402,8 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n         pszDest ? 0.0 : (double)(GetAdjustedTime() - addrConnect.nTime)/3600.0);\n \n     // Resolve\n-    const uint16_t default_port{Params().GetDefaultPort()};\n+    const uint16_t default_port{pszDest != nullptr ? Params().GetDefaultPort(pszDest) :\n+                                                     Params().GetDefaultPort()};\n     if (pszDest) {\n         std::vector<CService> resolved;\n         if (Lookup(pszDest, resolved,  default_port, fNameLookup && !HaveNameProxy(), 256) && !resolved.empty()) {\n@@ -2059,8 +2060,9 @@ void CConnman::ThreadOpenConnections(const std::vector<std::string> connect)\n             // from advertising themselves as a service on another host and\n             // port, causing a DoS attack as nodes around the network attempt\n             // to connect to it fruitlessly.\n-            if (addr.GetPort() != Params().GetDefaultPort() && nTries < 50)\n+            if (addr.GetPort() != Params().GetDefaultPort(addr.GetNetwork()) && nTries < 50) {\n                 continue;\n+            }\n \n             addrConnect = addr;\n             break;\n@@ -2123,7 +2125,7 @@ std::vector<AddedNodeInfo> CConnman::GetAddedNodeInfo() const\n     }\n \n     for (const std::string& strAddNode : lAddresses) {\n-        CService service(LookupNumeric(strAddNode, Params().GetDefaultPort()));\n+        CService service(LookupNumeric(strAddNode, Params().GetDefaultPort(strAddNode)));\n         AddedNodeInfo addedNode{strAddNode, CService(), false, false};\n         if (service.IsValid()) {\n             // strAddNode is an IP:port"
      }
    ]
  },
  {
    "sha": "4f432bd738c420512a86a51ab3e00323f396b89e",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0ZjQzMmJkNzM4YzQyMDUxMmE4NmE1MWFiM2UwMDMyM2YzOTZiODll",
    "commit": {
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2021-05-31T16:07:40Z"
      },
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2021-07-09T09:19:37Z"
      },
      "message": "net: do not connect to I2P hosts on port!=0\n\nWhen connecting to an I2P host we don't specify destination port and it\nis being forced to 0 by the SAM 3.1 proxy, so if we connect to the same\nhost on two different ports, that would be actually two connections to\nthe same service (listening on port 0).\n\nFixes https://github.com/bitcoin/bitcoin/issues/21389",
      "tree": {
        "sha": "7ca2d736342bd8861265e9164b800abdf15867d1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7ca2d736342bd8861265e9164b800abdf15867d1"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4f432bd738c420512a86a51ab3e00323f396b89e",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmDoFKkACgkQVN8G9ktV\ny7+VjB//QftD2PbdsAcgP4yt0iFPQcd1eRMWo7BhcpUxHmRUDRI/KODWzuGzdVoa\nwA12YFsYVOjcW8nSBcmMOX2fSsXffxX6WdE2eqaOF96bD3bEqt2v89f9EW9cnF5T\n+qdcAMB4Mu1UPiM6a4shtSRALhQH/Zx2GJPLmY4342S+k2F7aGc3slrQkPeV2694\nKof0vfbVjGuCiDad5CSZRFah/dWvBpucXcp4RARvt+KRnQ4s59IlhqXBXdV30R17\nao9/Y8yoVWZFqtm8MwRlk34tLq95k6BHkGV0hVYvuKwubdG4WbdX6EyuHbNUxgh6\nSbLX5z+Y1Hm852LatYflKv5xxRPRgC+1IIdLC7YSAu5RGNYsOhkZLEPuzO/vc7eT\n4VsD9SbOEYzKJk8B54GsNxMiRyzIsGYvklteBF5Rr7/NhPKJj2evVO4z6YERwIII\njGznLg6hxUelkZm5b7VY8TY/ZC+UZnc1jsJ8Xq/+NNGkpYUejHGqT8XhnCXCHq85\n48MR8p7nMn+49bPsbYwflVLlAR+fAAzDB15Pq2ai94rD6OT5XzjyuKBu2wVg7C7E\noJuRxFDWYqCUnhf+n9dHlsAKUnFelGzegTfJQONyuW/MUeuw8D3tt98ciOa7NN0E\nXzCxIySYg/IkSK4M8XEcsTPec2s4sXhYX0YB2m6LRW5yf1sW6WmWtvY9jL1POMPt\nw+FtUPE4lZeL+06Zrdl/KmLHLOaDIZ4BWax1qRmDYLM1OUAEjK6CZ5lGUj7sp0Zj\nnJ7g/0ADvaz2bmLNIYWwOYXIr5FC+f6gVUdiVTo/HDlmBBl0EpbOCx6v3YNdHhmD\noZglZJSk6KtCNQrpddgkphb3Jf7m5j7HURE2E0ITEClW+5T2qWCodqX2gvtLGgDF\ngZ85xu4werb0kplhM0wVYa8gkABLyNE6wyOo/BwchD+4O/PwkJJYfEtlTdtpR1ZN\nYBH7Wf7Q4DhoiOYZqzcZBloE5KaX294T29TuBu21FpYSFPqQ92aVjsUM/QOdY57x\nI4b3uf3u+na60Lb59TiOdid6IzRQ3CuCst8eSX75uKoVbjXVpyL9I4kA8SB8pQKR\nRl90xojEh7La6dvNrRA4gGjqIIxB3Act23m6A/RrTOuQWUJLekyvv67ZXEbTAABz\nV4mYGYWyFedybcVAoV7lIo8ZupUL7d3mqFhG3R8eGqbCnyXFbpvcYuuBGezMSI2v\nXnUzG5KVRwn8nTLiRY8ym21KU1Nbl/GwaMGVaQ2JxOzKPrDzGS0R8YGc8Q08aEeB\nDf7weivOYP1C4TuJOubxEMKlkKpMZ+0plo4iULycAvDzFv56iHiK2WKrJY7+g5JW\ngmO4KOUpu16DiAz31BByXDdmmtgfVA==\n=E0PK\n-----END PGP SIGNATURE-----",
        "payload": "tree 7ca2d736342bd8861265e9164b800abdf15867d1\nparent 1f096f091ebd88efb18154b8894a38122c39624f\nauthor Vasil Dimov <vd@FreeBSD.org> 1622477260 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1625822377 +0200\n\nnet: do not connect to I2P hosts on port!=0\n\nWhen connecting to an I2P host we don't specify destination port and it\nis being forced to 0 by the SAM 3.1 proxy, so if we connect to the same\nhost on two different ports, that would be actually two connections to\nthe same service (listening on port 0).\n\nFixes https://github.com/bitcoin/bitcoin/issues/21389\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4f432bd738c420512a86a51ab3e00323f396b89e",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/4f432bd738c420512a86a51ab3e00323f396b89e",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4f432bd738c420512a86a51ab3e00323f396b89e/comments",
    "author": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "1f096f091ebd88efb18154b8894a38122c39624f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1f096f091ebd88efb18154b8894a38122c39624f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/1f096f091ebd88efb18154b8894a38122c39624f"
      }
    ],
    "stats": {
      "total": 7,
      "additions": 7,
      "deletions": 0
    },
    "files": [
      {
        "sha": "5e7e42fb775ad24c08130bfe8379d269c572fff6",
        "filename": "src/i2p.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 0,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4f432bd738c420512a86a51ab3e00323f396b89e/src/i2p.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4f432bd738c420512a86a51ab3e00323f396b89e/src/i2p.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/i2p.cpp?ref=4f432bd738c420512a86a51ab3e00323f396b89e",
        "patch": "@@ -172,6 +172,13 @@ bool Session::Accept(Connection& conn)\n \n bool Session::Connect(const CService& to, Connection& conn, bool& proxy_error)\n {\n+    // Refuse connecting to arbitrary ports. We don't specify any destination port to the SAM proxy\n+    // when connecting (SAM 3.1 does not use ports) and it forces/defaults it to I2P_SAM31_PORT.\n+    if (to.GetPort() != I2P_SAM31_PORT) {\n+        proxy_error = false;\n+        return false;\n+    }\n+\n     proxy_error = true;\n \n     std::string session_id;"
      }
    ]
  },
  {
    "sha": "41cda9d075ebcab1dbb950160ebe9d0ba7b5745e",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0MWNkYTlkMDc1ZWJjYWIxZGJiOTUwMTYwZWJlOWQwYmE3YjU3NDVl",
    "commit": {
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2021-06-23T08:57:28Z"
      },
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2021-07-09T09:19:37Z"
      },
      "message": "test: ensure I2P ports are handled as expected",
      "tree": {
        "sha": "3090758b4a26ef20c6229d73228d7e535772bfb9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3090758b4a26ef20c6229d73228d7e535772bfb9"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/41cda9d075ebcab1dbb950160ebe9d0ba7b5745e",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmDoFKoACgkQVN8G9ktV\ny7/Wch//cdwM/aEgW9xqpY3/WFNTglRE1Wc/meX/qhBm4yWo67oigA9dKz3Qc7MP\nwNDeg32joB4ycqhSi/zpzdXLeEL2QyEc9z829RrrWfgYKq7mB+RClDPqTGLQyRaU\nxrfjh63G2YItkqSUNNzq+epzYJ7JUiR7rzm+LLOz5AlC/rvW4rPEK0xAxpzID+JT\nDpJnw7heW3LP4po19D1y4snuRdMUs7UHOwPnP+6IQINPohdVLOpYriHFAZTqG+kP\nQtvOAAvagJc6u0b0r//LtyTsBGe8YLJbCnvCQhaEhs7VbNfXJaexxhBR1blp2JUO\nGq+A9qC7fBVyIWjCH9HGn3DgnXo1kNs/3Gvxh5VxTB1J3WigjkMX5jahs7DBHbWf\niNkkleT544XWgKTwaSOvqid52LyD85J/+7/qWJGk6R+XWyiTIli2AZHupfw/6gy8\nsDdUmdnACcUYXm2wZKx1rVQSIPhkNRggnDozqc52Ia4fYEE86SZQSgbkpWnJ7ZeJ\nd1P3N2SrDEQtwBiz0PipWImevqU4WHfzkOvGuwU33S7aEkr6BCZzi7Fs3iZyOBb8\nXLteMyUhPjz/I0uCqsu3B5MeOHmZ7ojDj+QSZEsoPyTF9EMBtSzA0IvQY/FlfPc2\nPTEiXfgMXvMQOZChLQRrwx5BLhL1mtIZNwOD62eJpnD8ibbObzExDId5uLgWrgVK\nULcQ6VHUCCP86OXrS7/OmPsqlq5b290LG4NoyvFoe5cUibJ1rzom0OMq4adF/SDp\nmm7fqS0CE/XtPGQ6EwAyAMXMInHpFqsjvNBejrrXQo76V0SG19Vnb+UcwHYm9+xd\nOR72FyjLqSXJSUylhdrQbqeOQHgQMjWNzW1sN5GaHYlnVvEAjm/oQ2VTSZeJZ0fr\n+O4KetADrhTSlIhOdWPP61WfxuhVLLwG3zTt/lPPf2eXnm7CE7vGKbmti9Q80eNx\n9I5CrHqRxisNSzsJCYFQr5iHQTlp1n37l0goLi4Zv69HBnMNC1hCLC1VSPc4DKxY\nmaSWjocA5yBOeBU+n6fDpfFN+yEsW3RERrb0mTPrBY/jHMVPTEpE2AmUFRTaF+5W\nVv0v/FvhYTLqDBdQDA8NL3sdlNVBodWo7RsHnJjPp1T/zGmbmnqAY8tDp8jT05ig\nO2m6G0dIeaUNe5hhdThAj4Gy74+nyE+Avm69ga+t6eEfbvZACaRJcsn1eIk9Vto2\n38yW670rGuDTofqVeiPWyqF4ceTWik6OJ0dbbIwjqf0/R6zi+ZduJpCDiOojtkAR\nUWLR/JyU2AIzwcXcP/swzjNaIHtCB5zhbE61bXgAKmU359Wnj8hpM10N8G8GZTks\nyvmMN6Y5xMMcBQ+s+GOp4m90b/HAxQ==\n=3qLs\n-----END PGP SIGNATURE-----",
        "payload": "tree 3090758b4a26ef20c6229d73228d7e535772bfb9\nparent 4f432bd738c420512a86a51ab3e00323f396b89e\nauthor Vasil Dimov <vd@FreeBSD.org> 1624438648 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1625822377 +0200\n\ntest: ensure I2P ports are handled as expected\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/41cda9d075ebcab1dbb950160ebe9d0ba7b5745e",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/41cda9d075ebcab1dbb950160ebe9d0ba7b5745e",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/41cda9d075ebcab1dbb950160ebe9d0ba7b5745e/comments",
    "author": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "4f432bd738c420512a86a51ab3e00323f396b89e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4f432bd738c420512a86a51ab3e00323f396b89e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/4f432bd738c420512a86a51ab3e00323f396b89e"
      }
    ],
    "stats": {
      "total": 44,
      "additions": 44,
      "deletions": 0
    },
    "files": [
      {
        "sha": "13188b9305773178e19bf56f19588c4ac970faa4",
        "filename": "test/functional/p2p_i2p_ports.py",
        "status": "added",
        "additions": 43,
        "deletions": 0,
        "changes": 43,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/41cda9d075ebcab1dbb950160ebe9d0ba7b5745e/test/functional/p2p_i2p_ports.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/41cda9d075ebcab1dbb950160ebe9d0ba7b5745e/test/functional/p2p_i2p_ports.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/p2p_i2p_ports.py?ref=41cda9d075ebcab1dbb950160ebe9d0ba7b5745e",
        "patch": "@@ -0,0 +1,43 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2021-2021 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"\n+Test ports handling for I2P hosts\n+\"\"\"\n+\n+import re\n+\n+from test_framework.test_framework import BitcoinTestFramework\n+\n+\n+class I2PPorts(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 1\n+        # The test assumes that an I2P SAM proxy is not listening here.\n+        self.extra_args = [[\"-i2psam=127.0.0.1:60000\"]]\n+\n+    def run_test(self):\n+        node = self.nodes[0]\n+\n+        self.log.info(\"Ensure we don't try to connect if port!=0\")\n+        addr = \"zsxwyo6qcn3chqzwxnseusqgsnuw3maqnztkiypyfxtya4snkoka.b32.i2p:8333\"\n+        raised = False\n+        try:\n+            with node.assert_debug_log(expected_msgs=[f\"Error connecting to {addr}\"]):\n+                node.addnode(node=addr, command=\"onetry\")\n+        except AssertionError as e:\n+            raised = True\n+            if not re.search(r\"Expected messages .* does not partially match log\", str(e)):\n+                raise AssertionError(f\"Assertion raised as expected, but with an unexpected message: {str(e)}\")\n+        if not raised:\n+            raise AssertionError(\"Assertion should have been raised\")\n+\n+        self.log.info(\"Ensure we try to connect if port=0 and get an error due to missing I2P proxy\")\n+        addr = \"h3r6bkn46qxftwja53pxiykntegfyfjqtnzbm6iv6r5mungmqgmq.b32.i2p:0\"\n+        with node.assert_debug_log(expected_msgs=[f\"Error connecting to {addr}\"]):\n+            node.addnode(node=addr, command=\"onetry\")\n+\n+\n+if __name__ == '__main__':\n+    I2PPorts().main()"
      },
      {
        "sha": "fbd9d6028a854e09d42cd4f792255fe4c9d6abf0",
        "filename": "test/functional/test_runner.py",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/41cda9d075ebcab1dbb950160ebe9d0ba7b5745e/test/functional/test_runner.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/41cda9d075ebcab1dbb950160ebe9d0ba7b5745e/test/functional/test_runner.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/test_runner.py?ref=41cda9d075ebcab1dbb950160ebe9d0ba7b5745e",
        "patch": "@@ -291,6 +291,7 @@\n     'p2p_permissions.py',\n     'feature_blocksdir.py',\n     'wallet_startup.py',\n+    'p2p_i2p_ports.py',\n     'feature_config_args.py',\n     'feature_settings.py',\n     'rpc_getdescriptorinfo.py',"
      }
    ]
  },
  {
    "sha": "e0a2b390c144e123e2fc8a289fdff36815476964",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplMGEyYjM5MGMxNDRlMTIzZTJmYzhhMjg5ZmRmZjM2ODE1NDc2OTY0",
    "commit": {
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2021-06-28T14:54:45Z"
      },
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2021-07-09T09:19:38Z"
      },
      "message": "addrman: reset I2P ports to 0 when loading from disk\n\nThis is a temporary change to convert I2P addresses that have propagated\nwith port 8333 to ones with port 0.\n\nIt would cause a problem some day if indeed some bitcoin software is\nlistening on port 8333 only and rejects connections to port 0 and we are\nstill using SAM 3.1 which only supports port 0. In this case we would\nreplace 8333 with 0 and try to connect to such nodes.\n\nThis commit should be included in 22.0 and be reverted before 23.0 is\nreleased.",
      "tree": {
        "sha": "82fbf2ebcdd5ccb38cb1add7ec8390801013eb8a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/82fbf2ebcdd5ccb38cb1add7ec8390801013eb8a"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e0a2b390c144e123e2fc8a289fdff36815476964",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmDoFKoACgkQVN8G9ktV\ny79U/h//VMtpDsb2+elbB/kNSBBsbhsdIKTRYTxYrbO5LGcoGu+S6YfGlHV94ATG\nAyCCfeJ5WLwjb19lQM9n7Q3FT7yr8poSfQR/PQyP1ijhMvgVcT5kpzm8Ylwnp52N\nPI2ot5a5QgKNvmmZEfR10sk30WhiKPlse2W9bt99z2+ptvkf8HbAtW5lni3cl/mT\nbipvw3ORhClb/Lxd91xGx2w3DdFIxWp0wDJmpaTvzjOjkjFn6ERS0mefgrk9kLhz\n5rlGlRifq/uCseaxcDgfRVf54lvLO3bx+dZIds33W7jgNT3xflEwhD75seTGkufr\n42f7PzD0JPxzgUYGgSPXaJtTBKRX+SQYs5aV7tzF7uwavwZ3e/VaUXh8DKMYcr4t\nCtqIHYBvgBDfqObHId6UT9vXmhSMDx4MAs/DUEOPwKfPXxUU+Xb8e+PjIrc/w0m9\n1S/CU3WUeu9/7i/hk4rnueUszqkwg2A1GWRQjkiNM8r5IfQkukvLikqYw5BWxkki\nKIvZHsmpYHDpb9YIuyiP5KdZbp2k/8ew5sKkVTjZs3ArkMEoGQYyb9Fjq5VXPRuF\n2UkakKboBi8rY6j/UXOyGcnCAwZeAB1gtnYbY/u4NAx0FET9yJ0XFaSFz1yxjtrd\nmZrZVkNd8FCXDsOnVS59FuC03AVsqPI8LBVbD5C1DKDhIfIWPnTr17YUS+MKbQ73\nteALtYcYqO5s3FgJMr8nzbv52eqxQJxYIsMfZ1+eSBEX8IglMjFmajlw0zXBA07S\nKyv2iPLTQFKXYXRhDERrqbHLuCwmJQZVycEz1N21kwtKN8w+hS5qVBW/y9I5yDrv\nne61JtpeR2wEOkJILJi7ZU7o8Dntcue38JxKCg8syTa9rdmQLwgyy/hiME+9/zGb\nnVMKiUh9OBblgkBVcNSX/wjTEvJ9/9DiHHpnMnCXNnwpN4EC7pzcMw0LN8H/JJ+J\nihl3HtMpoFZ7Z06A8+v6Vocu6ppqrwVaW0O0zvUbNsv2THCDnW+36V31TP9glQpu\nqnrKUfjyNNlotW5necIqL2YKUYdCxLRTtcY4UN3yJPPn4cBFh4ARNl17u57JlXBi\nV6KZdHCS6K1p3qNNVhuq29ue911EtzWzUAjozzd8iDIVbz671/4Bb7ta2/hACYDm\n3k/7MoxYDKiHhDmr1jz/N/k+RCnm5HG4gJqOprWjjH5Qq4kzinNmKBoiqUurEqXF\nMMs681gS1zJuWaSbCsHS5avCGi5H/uTu1CtH2ploJsaJZXjzpUPgLa2gBp1cUWRb\nO2HnrZk5gDMXAPZFPja//mfNi5V2DqZa/hEy0azbcZln6kZK54HGBcRx36ekMtns\nZRPg+lQrObTTmBDEY2PJt9ZdownySg==\n=Tr3J\n-----END PGP SIGNATURE-----",
        "payload": "tree 82fbf2ebcdd5ccb38cb1add7ec8390801013eb8a\nparent 41cda9d075ebcab1dbb950160ebe9d0ba7b5745e\nauthor Vasil Dimov <vd@FreeBSD.org> 1624892085 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1625822378 +0200\n\naddrman: reset I2P ports to 0 when loading from disk\n\nThis is a temporary change to convert I2P addresses that have propagated\nwith port 8333 to ones with port 0.\n\nIt would cause a problem some day if indeed some bitcoin software is\nlistening on port 8333 only and rejects connections to port 0 and we are\nstill using SAM 3.1 which only supports port 0. In this case we would\nreplace 8333 with 0 and try to connect to such nodes.\n\nThis commit should be included in 22.0 and be reverted before 23.0 is\nreleased.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e0a2b390c144e123e2fc8a289fdff36815476964",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/e0a2b390c144e123e2fc8a289fdff36815476964",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e0a2b390c144e123e2fc8a289fdff36815476964/comments",
    "author": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "41cda9d075ebcab1dbb950160ebe9d0ba7b5745e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/41cda9d075ebcab1dbb950160ebe9d0ba7b5745e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/41cda9d075ebcab1dbb950160ebe9d0ba7b5745e"
      }
    ],
    "stats": {
      "total": 225,
      "additions": 225,
      "deletions": 0
    },
    "files": [
      {
        "sha": "389d106164d5995f195067ccec7c58edb733ab39",
        "filename": "src/addrman.cpp",
        "status": "modified",
        "additions": 98,
        "deletions": 0,
        "changes": 98,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e0a2b390c144e123e2fc8a289fdff36815476964/src/addrman.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e0a2b390c144e123e2fc8a289fdff36815476964/src/addrman.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/addrman.cpp?ref=e0a2b390c144e123e2fc8a289fdff36815476964",
        "patch": "@@ -6,6 +6,7 @@\n #include <addrman.h>\n \n #include <hash.h>\n+#include <i2p.h>\n #include <logging.h>\n #include <netaddress.h>\n #include <serialize.h>\n@@ -731,3 +732,100 @@ std::vector<bool> CAddrMan::DecodeAsmap(fs::path path)\n     }\n     return bits;\n }\n+\n+void CAddrMan::ResetI2PPorts()\n+{\n+    for (int bucket = 0; bucket < ADDRMAN_NEW_BUCKET_COUNT; ++bucket) {\n+        for (int i = 0; i < ADDRMAN_BUCKET_SIZE; ++i) {\n+            const auto id = vvNew[bucket][i];\n+            if (id == -1) {\n+                continue;\n+            }\n+            auto it = mapInfo.find(id);\n+            if (it == mapInfo.end()) {\n+                return;\n+            }\n+            auto& addr_info = it->second;\n+            if (!addr_info.IsI2P() || addr_info.GetPort() == I2P_SAM31_PORT) {\n+                continue;\n+            }\n+\n+            auto addr_info_newport = addr_info;\n+            // The below changes addr_info_newport.GetKey(), which is used in finding a\n+            // bucket and a position within that bucket. So a re-bucketing may be necessary.\n+            addr_info_newport.port = I2P_SAM31_PORT;\n+\n+            // Reposition entries of vvNew within the same bucket because we don't know the source\n+            // address which led to the decision to store the entry in vvNew[bucket] so we can't\n+            // re-evaluate that decision, but even if we could, CAddrInfo::GetNewBucket() does not\n+            // use CAddrInfo::GetKey() so it would end up in the same bucket as before the port\n+            // change.\n+            const auto i_target = addr_info_newport.GetBucketPosition(nKey, true, bucket);\n+\n+            if (i_target == i) { // No need to re-position.\n+                addr_info = addr_info_newport;\n+                continue;\n+            }\n+\n+            // Reposition from i to i_target, removing the entry from i_target (if any).\n+            ClearNew(bucket, i_target);\n+            vvNew[bucket][i_target] = id;\n+            vvNew[bucket][i] = -1;\n+            addr_info = addr_info_newport;\n+        }\n+    }\n+\n+    for (int bucket = 0; bucket < ADDRMAN_TRIED_BUCKET_COUNT; ++bucket) {\n+        for (int i = 0; i < ADDRMAN_BUCKET_SIZE; ++i) {\n+            const auto id = vvTried[bucket][i];\n+            if (id == -1) {\n+                continue;\n+            }\n+            auto it = mapInfo.find(id);\n+            if (it == mapInfo.end()) {\n+                return;\n+            }\n+            auto& addr_info = it->second;\n+            if (!addr_info.IsI2P() || addr_info.GetPort() == I2P_SAM31_PORT) {\n+                continue;\n+            }\n+\n+            auto addr_info_newport = addr_info;\n+            // The below changes addr_info_newport.GetKey(), which is used in finding a\n+            // bucket and a position within that bucket. So a re-bucketing may be necessary.\n+            addr_info_newport.port = I2P_SAM31_PORT;\n+\n+            const auto bucket_target = addr_info_newport.GetTriedBucket(nKey, m_asmap);\n+            const auto i_target = addr_info_newport.GetBucketPosition(nKey, false, bucket_target);\n+\n+            if (bucket_target == bucket && i_target == i) { // No need to re-position.\n+                addr_info = addr_info_newport;\n+                continue;\n+            }\n+\n+            // Reposition from (bucket, i) to (bucket_target, i_target). If the latter is\n+            // occupied, then move the entry from there to vvNew.\n+\n+            const auto old_target_id = vvTried[bucket_target][i_target];\n+            if (old_target_id != -1) {\n+                CAddrInfo& old_target_info = mapInfo[old_target_id];\n+\n+                old_target_info.fInTried = false;\n+                vvTried[bucket_target][i_target] = -1;\n+                --nTried;\n+\n+                const auto new_bucket = old_target_info.GetNewBucket(nKey, m_asmap);\n+                const auto new_bucket_i = old_target_info.GetBucketPosition(nKey, true, new_bucket);\n+                ClearNew(new_bucket, new_bucket_i);\n+\n+                old_target_info.nRefCount = 1;\n+                vvNew[new_bucket][new_bucket_i] = old_target_id;\n+                ++nNew;\n+            }\n+\n+            vvTried[bucket_target][i_target] = id;\n+            vvTried[bucket][i] = -1;\n+            addr_info = addr_info_newport;\n+        }\n+    }\n+}"
      },
      {
        "sha": "2a5c6c06b4ef722a5a826d02506d3bb9151aa305",
        "filename": "src/addrman.h",
        "status": "modified",
        "additions": 10,
        "deletions": 0,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e0a2b390c144e123e2fc8a289fdff36815476964/src/addrman.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e0a2b390c144e123e2fc8a289fdff36815476964/src/addrman.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/addrman.h?ref=e0a2b390c144e123e2fc8a289fdff36815476964",
        "patch": "@@ -452,6 +452,8 @@ class CAddrMan\n \n         RemoveInvalid();\n \n+        ResetI2PPorts();\n+\n         Check();\n     }\n \n@@ -767,6 +769,14 @@ class CAddrMan\n     //! Remove invalid addresses.\n     void RemoveInvalid() EXCLUSIVE_LOCKS_REQUIRED(cs);\n \n+    /**\n+     * Reset the ports of I2P peers to 0.\n+     * This is needed as a temporary measure because now we enforce port 0 and\n+     * only connect to I2P hosts if the port is 0, but in the early days some\n+     * I2P addresses with port 8333 were rumoured and persisted into addrmans.\n+     */\n+    void ResetI2PPorts() EXCLUSIVE_LOCKS_REQUIRED(cs);\n+\n     friend class CAddrManTest;\n };\n "
      },
      {
        "sha": "f2eed956cd6ed9b8c6f66aaf44389c168f59a1b4",
        "filename": "src/test/addrman_tests.cpp",
        "status": "modified",
        "additions": 117,
        "deletions": 0,
        "changes": 117,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e0a2b390c144e123e2fc8a289fdff36815476964/src/test/addrman_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e0a2b390c144e123e2fc8a289fdff36815476964/src/test/addrman_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/addrman_tests.cpp?ref=e0a2b390c144e123e2fc8a289fdff36815476964",
        "patch": "@@ -2,6 +2,7 @@\n // Distributed under the MIT software license, see the accompanying\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n #include <addrman.h>\n+#include <i2p.h>\n #include <test/data/asmap.raw.h>\n #include <test/util/setup_common.h>\n #include <util/asmap.h>\n@@ -966,5 +967,121 @@ BOOST_AUTO_TEST_CASE(addrman_evictionworks)\n     BOOST_CHECK(addrman.SelectTriedCollision().ToString() == \"[::]:0\");\n }\n \n+BOOST_AUTO_TEST_CASE(reset_i2p_ports)\n+{\n+    CAddrManTest addrman1;\n+    CAddrManTest addrman2;\n+    const uint32_t good_time{static_cast<uint32_t>(GetAdjustedTime())};\n+    constexpr uint16_t port = 8333;\n+\n+    // Has its port changed, will be re-positioned within the same bucket in vvNew.\n+    const CAddress i2p_new1{\n+        ResolveService(\"72l3ucjkuscrbiiepoehuwqgknyzgo7zuix5ty4puwrkyhtmnsga.b32.i2p\", port),\n+        NODE_NONE,\n+        good_time};\n+\n+    // Has its port changed, will not be re-positioned in vvNew because ports 0 and 10075 result in\n+    // the same bucket position.\n+    const CAddress i2p_new2{\n+        ResolveService(\"gehtac45oaghz54ypyopim64mql7oad2bqclla74l6tfeolzmodq.b32.i2p\", 10075),\n+        NODE_NONE,\n+        good_time};\n+\n+    // Remains unchanged, port is already as it should be.\n+    const CAddress i2p_new3{\n+        ResolveService(\"c4gfnttsuwqomiygupdqqqyy5y5emnk5c73hrfvatri67prd7vyq.b32.i2p\",\n+                       I2P_SAM31_PORT),\n+        NODE_NONE,\n+        good_time};\n+\n+    // Has its port changed, re-positioning in vvNew will cause i2p_new3 to be evicted.\n+    const CAddress i2p_new4{\n+        ResolveService(\"c4cbbkn46qxftwja53pxiykntegfyfjqtnzbm6iv6r5mungmqgmq.b32.i2p\", port),\n+        NODE_NONE,\n+        good_time};\n+\n+    // Remains unchanged.\n+    const CAddress ipv4_new{ResolveService(\"1.2.3.4\", port), NODE_NONE, good_time};\n+\n+    // Has its port changed, will be re-positioned in vvTried.\n+    const CAddress i2p_tried1{\n+        ResolveService(\"h3r6bkn46qxftwja53pxiykntegfyfjqtnzbm6iv6r5mungmqgmq.b32.i2p\", port),\n+        NODE_NONE,\n+        good_time};\n+\n+    // Has its port changed, will not be re-positioned in vvTried because ports 0 and 10537\n+    // result in the same position (bucket, i).\n+    const CAddress i2p_tried2{\n+        ResolveService(\"pjs7or2ctvteeo5tu4bwyrtydeuhqhvdprtujn4daxr75jpebjxa.b32.i2p\", 10537),\n+        NODE_NONE,\n+        good_time};\n+\n+    // Remains unchanged, port is already as it should be.\n+    const CAddress i2p_tried3{\n+        ResolveService(\"hnbbyjpxx54623l555sta7pocy3se4sdgmuebi5k6reesz5rjp6q.b32.i2p\",\n+                       I2P_SAM31_PORT),\n+        NODE_NONE,\n+        good_time};\n+\n+    // Has its port changed, re-positioning in vvTried will cause i2p_tried3 to be moved to vvNew.\n+    const CAddress i2p_tried4{\n+        ResolveService(\"hna37nqr3ahkqv62cuqfwgtneekvvpnuc4i4f6yo7tpoqjswvcwa.b32.i2p\", port),\n+        NODE_NONE,\n+        good_time};\n+\n+    // Remains unchanged.\n+    const CAddress ipv4_tried{ResolveService(\"2.3.4.5\", port), NODE_NONE, good_time};\n+\n+    const CNetAddr source;\n+\n+    CDataStream stream(SER_NETWORK, PROTOCOL_VERSION);\n+\n+    addrman1.Add(i2p_new1, source);\n+    addrman1.Add(i2p_new2, source);\n+    addrman1.Add(i2p_new3, source);\n+    addrman1.Add(i2p_new4, source);\n+    addrman1.Add(ipv4_new, source);\n+\n+    addrman1.Add(i2p_tried1, source);\n+    addrman1.Good(i2p_tried1);\n+    addrman1.Add(i2p_tried2, source);\n+    addrman1.Good(i2p_tried2);\n+    addrman1.Add(i2p_tried3, source);\n+    addrman1.Good(i2p_tried3);\n+    addrman1.Add(i2p_tried4, source);\n+    addrman1.Good(i2p_tried4);\n+    addrman1.Add(ipv4_tried, source);\n+    addrman1.Good(ipv4_tried);\n+\n+    stream << addrman1;\n+    stream >> addrman2;\n+\n+    const size_t max_addresses{0};\n+    const size_t max_pct{0};\n+\n+    auto addresses = addrman2.GetAddr(max_addresses, max_pct, NET_I2P);\n+    BOOST_REQUIRE_EQUAL(addresses.size(), 7UL);\n+    std::sort(addresses.begin(), addresses.end()); // Just some deterministic order.\n+    BOOST_CHECK_EQUAL(addresses[0].ToStringIP(), i2p_new4.ToStringIP());\n+    BOOST_CHECK_EQUAL(addresses[0].GetPort(), I2P_SAM31_PORT);\n+    BOOST_CHECK_EQUAL(addresses[1].ToStringIP(), i2p_new2.ToStringIP());\n+    BOOST_CHECK_EQUAL(addresses[1].GetPort(), I2P_SAM31_PORT);\n+    BOOST_CHECK_EQUAL(addresses[2].ToStringIP(), i2p_tried4.ToStringIP());\n+    BOOST_CHECK_EQUAL(addresses[2].GetPort(), I2P_SAM31_PORT);\n+    BOOST_CHECK_EQUAL(addresses[3].ToStringIP(), i2p_tried3.ToStringIP());\n+    BOOST_CHECK_EQUAL(addresses[3].GetPort(), I2P_SAM31_PORT);\n+    BOOST_CHECK_EQUAL(addresses[4].ToStringIP(), i2p_tried1.ToStringIP());\n+    BOOST_CHECK_EQUAL(addresses[4].GetPort(), I2P_SAM31_PORT);\n+    BOOST_CHECK_EQUAL(addresses[5].ToStringIP(), i2p_tried2.ToStringIP());\n+    BOOST_CHECK_EQUAL(addresses[5].GetPort(), I2P_SAM31_PORT);\n+    BOOST_CHECK_EQUAL(addresses[6].ToStringIP(), i2p_new1.ToStringIP());\n+    BOOST_CHECK_EQUAL(addresses[6].GetPort(), I2P_SAM31_PORT);\n+\n+    addresses = addrman2.GetAddr(max_addresses, max_pct, NET_IPV4);\n+    BOOST_REQUIRE_EQUAL(addresses.size(), 2UL);\n+    std::sort(addresses.begin(), addresses.end()); // Just some deterministic order.\n+    BOOST_CHECK_EQUAL(addresses[0].ToStringIPPort(), ipv4_new.ToStringIPPort());\n+    BOOST_CHECK_EQUAL(addresses[1].ToStringIPPort(), ipv4_tried.ToStringIPPort());\n+}\n \n BOOST_AUTO_TEST_SUITE_END()"
      }
    ]
  },
  {
    "sha": "4101ec9d2e05a35c35f587a28f1feee6cebcc61b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0MTAxZWM5ZDJlMDVhMzVjMzVmNTg3YTI4ZjFmZWVlNmNlYmNjNjFi",
    "commit": {
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2021-07-02T08:33:38Z"
      },
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2021-07-09T09:19:38Z"
      },
      "message": "doc: mention that we enforce port=0 in I2P\n\nCo-authored-by: Jon Atack <jon@atack.com>",
      "tree": {
        "sha": "203e74f7ffc8a65674e5d159737d2892cec8d860",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/203e74f7ffc8a65674e5d159737d2892cec8d860"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4101ec9d2e05a35c35f587a28f1feee6cebcc61b",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmDoFKsACgkQVN8G9ktV\ny7+Sjh//Q75fZICRt0S+dJpU7P2i0I+QaqQV30xmtex4g/OqIX0K/hcQLxDUMQrg\n8z1b4dFKQ5z/kVgkIsxDj7AjkpokLt/kQDtbWnYhE48zY7oHglBZj/xGxOsvxfao\nmUhb3eyjB/a1TbJIfRMx5gKeyYYtz4CRrqUDYNuvGK6fy+UH2uBzV4G7DTgHMpIx\nKSYWc8fzA/OBTyp1+E2xtXxPntl8RKtL8MfVryXGnoXRy7gHn3fNL993sa8wE8vu\nqyBfsuSpgfFRtdB1Iu2xsSc2AICxYrhUwRavjSRWemHDYYAQvxcNRLWIFaIwE64c\nuSJ2UWxOUyx8KpqXwG1F3/rKbAtHdfvAHPX1wY1BstskwPbSX70hud/ch04r23vM\nGeVtyVX95+WxZrJIxqCTnW0SSPNl/rpi3cXBDooJr9Z9JuyxqCqiNfY/0c3at33M\ntmcqdhpyoMklB0Ikni0qWdBNe2Pk45lT0ijFtL90ZavqXWZQAN/wPKIjve0TZG8I\no+g293i4HyaRygR4LokZeCa4KhFHzYHdds/apeR+cVY+9DdFFGbZop27p6v77ULS\nGN3kBM6fvwokuWNfrMAwLIIpCs+t7PZN6Ahkwzc99E432G7EH0geHkasCcRTIeMd\nN3CWmlzEd4rPlULNWnOuKgY+rOWuvttx9raI2R+8sbJoSJsOtpser3nSHIrSxnlC\nfAcfty1/qY2P1e0rEXghRwS0fymifqdZg3oO39Pps4On85Vp1k/r4ke6DUtjHb/8\nHWtXgSyzCsW1zUVn5MgfXzKOCQMqnoJDa+p/lCvTbxs7rG6Ga4JIhbJVCYN81O5B\nZ7JmjMyruCzp44qK67TS8Jfe2ZDGgZWDkFaGu1iACxPZRnex+pYEHth6HCoAyaKL\nCSec/KU+gxYkyOmi7PAwKwdvMj9x8HGS4m2xDd9rMBrIoPguBByvaaFRa+FPru+z\noha3hZ1Qm7nVrvDxSE8oXBCHnaMEjT3E2aywddrkb+wvQ87N2iRYLAGg49MBt35E\nH+jKdChJxFuVdbS/41tKz0G7fiF5myD0Sh7tFub3x6DQLk1iQ5n6vAN8gv7dyUNO\n8Aivsu/0tt7cIJUtfUyLwn+vpERkXW94NqMHlNo4vDTkuIszScNSSAUo+nDaxLgZ\nnQISuZ4L3GN7c7B5840VCXk7DpESmb6ijZsVTwxgisy5GcMnXMDmNIoBeq3/kv1a\nfWCbmhZiAwfJluggcPduCEeQd+g0mcq/Om4PShHfTwpdBrFElVyB0kMFnVvYcjVg\ng2/+u592hzUN9BcpIh8THPOZTx0Nl1hf+KpsvbPAEIZWWACes72dN4lV3G6IAGko\nn0MA+B49FFz0U/ByiQTAWKUPTAqwBQ==\n=Cu5q\n-----END PGP SIGNATURE-----",
        "payload": "tree 203e74f7ffc8a65674e5d159737d2892cec8d860\nparent e0a2b390c144e123e2fc8a289fdff36815476964\nauthor Vasil Dimov <vd@FreeBSD.org> 1625214818 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1625822378 +0200\n\ndoc: mention that we enforce port=0 in I2P\n\nCo-authored-by: Jon Atack <jon@atack.com>\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4101ec9d2e05a35c35f587a28f1feee6cebcc61b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/4101ec9d2e05a35c35f587a28f1feee6cebcc61b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4101ec9d2e05a35c35f587a28f1feee6cebcc61b/comments",
    "author": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "e0a2b390c144e123e2fc8a289fdff36815476964",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e0a2b390c144e123e2fc8a289fdff36815476964",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/e0a2b390c144e123e2fc8a289fdff36815476964"
      }
    ],
    "stats": {
      "total": 15,
      "additions": 15,
      "deletions": 0
    },
    "files": [
      {
        "sha": "27ef4d9d9f0d995bbebff7af816bc0f55b655693",
        "filename": "doc/i2p.md",
        "status": "modified",
        "additions": 15,
        "deletions": 0,
        "changes": 15,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4101ec9d2e05a35c35f587a28f1feee6cebcc61b/doc/i2p.md",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4101ec9d2e05a35c35f587a28f1feee6cebcc61b/doc/i2p.md",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/doc/i2p.md?ref=4101ec9d2e05a35c35f587a28f1feee6cebcc61b",
        "patch": "@@ -70,3 +70,18 @@ RPC.\n \n Bitcoin Core uses the [SAM v3.1](https://geti2p.net/en/docs/api/samv3) protocol\n to connect to the I2P network. Any I2P router that supports it can be used.\n+\n+## Ports in I2P and Bitcoin Core\n+\n+Bitcoin Core uses the [SAM v3.1](https://geti2p.net/en/docs/api/samv3)\n+protocol. One particularity of SAM v3.1 is that it does not support ports,\n+unlike newer versions of SAM (v3.2 and up) that do support them and default the\n+port numbers to 0. From the point of view of peers that use newer versions of\n+SAM or other protocols that support ports, a SAM v3.1 peer is connecting to them\n+on port 0, from source port 0.\n+\n+To allow future upgrades to newer versions of SAM, Bitcoin Core sets its\n+listening port to 0 when listening for incoming I2P connections and advertises\n+its own I2P address with port 0. Furthermore, it will not attempt to connect to\n+I2P addresses with a non-zero port number because with SAM v3.1 the destination\n+port (`TO_PORT`) is always set to 0 and is not in the control of Bitcoin Core."
      }
    ]
  }
]