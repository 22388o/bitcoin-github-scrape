zallarak,2018-11-16T01:48:06Z,"`net.cpp|h` was much more relevant than `netbase.cpp|h` - moved.\n\nI didn't move it into `CNode` because it didn't seem right to duplicate the timeout information into every peer. `CConnman` isn't a parameter to `InactivityCheck`, so having it as a top-level setting seemed to make most sense for now.\n\nThanks for your prompt comments @MarcoFalke - looking forward to any further thoughts!",https://github.com/bitcoin/bitcoin/pull/14733#issuecomment-439253764,439253764,
MarcoFalke,2018-11-16T02:12:00Z,"> CConnman isn't a parameter to InactivityCheck\n\nconman is passed as `this` or `self` if you prefer python.",https://github.com/bitcoin/bitcoin/pull/14733#issuecomment-439258001,439258001,
zallarak,2018-11-16T03:36:34Z,"@MarcoFalke great call. I have updated with this per your feedback. Please let me know what you think of the change.\n\n- Pass in `nPeerConnectTimeout` through `connOptions` and add it to `CConnman`",https://github.com/bitcoin/bitcoin/pull/14733#issuecomment-439271680,439271680,
DrahtBot,2018-11-16T04:25:03Z,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#14856](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14856.html) ([WIP] net: remove more CConnman globals (th",https://github.com/bitcoin/bitcoin/pull/14733#issuecomment-439278074,439278074,
meshcollider,2018-11-16T18:48:52Z,"This looks good, although please use snake case even though the surrounding code doesn't :) Also please squash the nit commit",https://github.com/bitcoin/bitcoin/pull/14733#issuecomment-439489682,439489682,
zallarak,2018-11-16T19:16:24Z,@MeshCollider done!,https://github.com/bitcoin/bitcoin/pull/14733#issuecomment-439497463,439497463,
meshcollider,2018-11-18T22:06:05Z,utACK https://github.com/bitcoin/bitcoin/commit/2c7fbedf8187a9589866b669af273a33cbfdfac5,https://github.com/bitcoin/bitcoin/pull/14733#issuecomment-439730012,439730012,
dongcarl,2018-11-28T16:20:57Z,"Overall, I'm very excited that the test that's changed here will be sped up quite a bit! :smile: ",https://github.com/bitcoin/bitcoin/pull/14733#issuecomment-442507989,442507989,
zallarak,2018-11-29T01:24:36Z,"@dongcarl @MarcoFalke - I have resolved every comment you left:\n\n- Add log assertions to the test to ensure the right code path is being hit -- this greatly improves the tests!\n- Make time values consistent with the rest of the codebase (signed)\n- Made cli helptext more clear\n- Fix log messages that had 60 seconds hard-coded\n- prefix class members with `m_`\n\nReally appreciate the g",https://github.com/bitcoin/bitcoin/pull/14733#issuecomment-442670103,442670103,
dongcarl,2018-11-29T02:07:19Z,tACK 8042bbfbf001d60feead6f04c99e0fca93dbba3c,https://github.com/bitcoin/bitcoin/pull/14733#issuecomment-442678818,442678818,
MarcoFalke,2018-11-29T20:42:34Z,utACK 8042bbfbf0,https://github.com/bitcoin/bitcoin/pull/14733#issuecomment-442985851,442985851,
zallarak,2018-11-29T20:58:15Z,"@MarcoFalke do you mean make a new pull request, or should I add the nit commits to this one? Thank you!\n\nEDIT: I will add the commit here, but not squash it so that the review is preserved. Let me know if I should do otherwise.",https://github.com/bitcoin/bitcoin/pull/14733#issuecomment-442990674,442990674,
MarcoFalke,2018-11-29T21:13:01Z,utACK 48b37db50f4a5dc6d2dd1a01183bdb993ca97f8b,https://github.com/bitcoin/bitcoin/pull/14733#issuecomment-442995052,442995052,
meshcollider,2018-11-30T22:25:00Z,re-utACK https://github.com/bitcoin/bitcoin/pull/14733/commits/48b37db50f4a5dc6d2dd1a01183bdb993ca97f8b,https://github.com/bitcoin/bitcoin/pull/14733#issuecomment-443358099,443358099,
MarcoFalke,2018-11-16T00:09:13Z,These files are autogenerated and shouldn't be modified.,https://github.com/bitcoin/bitcoin/pull/14733#discussion_r234053220,234053220,doc/man/bitcoin-qt.1
MarcoFalke,2018-11-16T00:10:23Z,Why here? Shouldn't this be in net (e.g. CNode or CConnman)?,https://github.com/bitcoin/bitcoin/pull/14733#discussion_r234053398,234053398,src/netbase.cpp
MarcoFalke,2018-11-16T00:10:50Z,Missing `{}` after `if`,https://github.com/bitcoin/bitcoin/pull/14733#discussion_r234053470,234053470,src/init.cpp
MarcoFalke,2018-11-16T00:12:02Z,"Time deltas are measured in type `int64_t`, not `int`",https://github.com/bitcoin/bitcoin/pull/14733#discussion_r234053688,234053688,src/netbase.h
practicalswift,2018-11-17T11:07:59Z,Nit: Missing whitespace around `=` :-),https://github.com/bitcoin/bitcoin/pull/14733#discussion_r234404859,234404859,test/functional/p2p_timeouts.py
zallarak,2018-11-17T18:11:32Z,"Great catch :-), thanks @practicalswift - updated.",https://github.com/bitcoin/bitcoin/pull/14733#discussion_r234416511,234416511,test/functional/p2p_timeouts.py
MarcoFalke,2018-11-27T20:40:02Z,It should be clear to the user that this is different (and how it is different) from the `-timeout` above without having to read the source code. Otherwise it should be made a hidden debug option.,https://github.com/bitcoin/bitcoin/pull/14733#discussion_r236837274,236837274,src/init.cpp
MarcoFalke,2018-11-27T20:46:29Z,"Any reason to change this? Unless there is a strong reason, I'd say keep it the way it was. Also `int64_t` seems preferable to avoid (future) unsigned integer overflow issues.",https://github.com/bitcoin/bitcoin/pull/14733#discussion_r236839348,236839348,src/net.h
MarcoFalke,2018-11-27T20:46:58Z,This is a member? Should start with `m_`...,https://github.com/bitcoin/bitcoin/pull/14733#discussion_r236839508,236839508,src/net.h
MarcoFalke,2018-11-27T20:47:58Z,"\n\nThis is a member? Should start with `m_`...\n",https://github.com/bitcoin/bitcoin/pull/14733#discussion_r236839837,236839837,src/net.h
MarcoFalke,2018-11-27T20:48:45Z,Same review applies for the newly introduced variables.,https://github.com/bitcoin/bitcoin/pull/14733#discussion_r236840167,236840167,src/net.h
MarcoFalke,2018-11-27T20:49:38Z,Needs the debug log message adjusted,https://github.com/bitcoin/bitcoin/pull/14733#discussion_r236840451,236840451,src/net.cpp
MarcoFalke,2018-11-27T20:55:14Z,"Should sleep `with assert_debug_log(... ""timeout ...""):`\n\nto assert we hit the right code path.",https://github.com/bitcoin/bitcoin/pull/14733#discussion_r236842210,236842210,test/functional/p2p_timeouts.py
dongcarl,2018-11-28T03:03:35Z,Nit: Class member variables should have a `m_` prefix.,https://github.com/bitcoin/bitcoin/pull/14733#discussion_r236927155,236927155,src/net.h
dongcarl,2018-11-28T03:07:32Z,"The `LogPrint` on line 1239 should be changed to not be hardcoded to ""60 seconds"" anymore.",https://github.com/bitcoin/bitcoin/pull/14733#discussion_r236927714,236927714,src/net.cpp
dongcarl,2018-11-28T03:30:00Z,(1/3) It would seem the insistence on making `peer_connect_timeout` a `uint64_t` is making the code a tiny more verbose (compared the block here with the one above for `-timeout`).,https://github.com/bitcoin/bitcoin/pull/14733#discussion_r236930585,236930585,src/init.cpp
dongcarl,2018-11-28T03:45:05Z,(2/3) The choice of using `uint64_t` here means that there's an implicit conversion.,https://github.com/bitcoin/bitcoin/pull/14733#discussion_r236932312,236932312,src/net.cpp
dongcarl,2018-11-28T03:45:10Z,"(3/3) You've changed the type for `CNodeStats`'s `nTimeConnected`, but not `CNode`'s, which means that when `CNode::copyStats` is invoked, the `X` macro would be expanded and the `int64_t` from `CNode` would be implicitly converted to a `uint64_t`.",https://github.com/bitcoin/bitcoin/pull/14733#discussion_r236932320,236932320,src/net.h
zallarak,2018-11-29T01:20:53Z,I added a sentence that clarifies that this timeout refers to the period of inactivity we tolerate from peers before they are dropped. Great point.,https://github.com/bitcoin/bitcoin/pull/14733#discussion_r237323760,237323760,src/init.cpp
zallarak,2018-11-29T01:21:29Z,Excellent point! I added the correct log assertions. This makes this test even better.,https://github.com/bitcoin/bitcoin/pull/14733#discussion_r237323854,237323854,test/functional/p2p_timeouts.py
MarcoFalke,2018-11-29T20:50:05Z,"Should probably set `debug_only=true` to hide the option from users, unless there is a reason to expose it.",https://github.com/bitcoin/bitcoin/pull/14733#discussion_r237653321,237653321,src/init.cpp
MarcoFalke,2018-11-29T20:50:57Z,"No need to translate this error, imo.",https://github.com/bitcoin/bitcoin/pull/14733#discussion_r237653588,237653588,src/init.cpp
