[
  {
    "sha": "60e190ceb3563a8102d42fdfcbefccdd1b53e812",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2MGUxOTBjZWIzNTYzYTgxMDJkNDJmZGZjYmVmY2NkZDFiNTNlODEy",
    "commit": {
      "author": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2019-01-29T00:06:17Z"
      },
      "committer": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2019-02-03T22:23:43Z"
      },
      "message": "gui: Fix WalletController deletion\n\nThe wallet controller instanced must be deleted after the window instance\nsince it is used there.",
      "tree": {
        "sha": "67dac9dbfa8c1c5f24606d6fd9a855c0aca87687",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/67dac9dbfa8c1c5f24606d6fd9a855c0aca87687"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/60e190ceb3563a8102d42fdfcbefccdd1b53e812",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/60e190ceb3563a8102d42fdfcbefccdd1b53e812",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/60e190ceb3563a8102d42fdfcbefccdd1b53e812",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/60e190ceb3563a8102d42fdfcbefccdd1b53e812/comments",
    "author": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "2fbf6a57d282d80c128c910dd1fcdd0ee0542654",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2fbf6a57d282d80c128c910dd1fcdd0ee0542654",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/2fbf6a57d282d80c128c910dd1fcdd0ee0542654"
      }
    ],
    "stats": {
      "total": 6,
      "additions": 2,
      "deletions": 4
    },
    "files": [
      {
        "sha": "0f06bbaaa6a677e5a6b107767e06fa8e830f15c8",
        "filename": "src/qt/bitcoin.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 4,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/60e190ceb3563a8102d42fdfcbefccdd1b53e812/src/qt/bitcoin.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/60e190ceb3563a8102d42fdfcbefccdd1b53e812/src/qt/bitcoin.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoin.cpp?ref=60e190ceb3563a8102d42fdfcbefccdd1b53e812",
        "patch": "@@ -218,6 +218,8 @@ BitcoinApplication::~BitcoinApplication()\n #ifdef ENABLE_WALLET\n     delete paymentServer;\n     paymentServer = nullptr;\n+    delete m_wallet_controller;\n+    m_wallet_controller = nullptr;\n #endif\n     delete optionsModel;\n     optionsModel = nullptr;\n@@ -310,10 +312,6 @@ void BitcoinApplication::requestShutdown()\n     window->setClientModel(nullptr);\n     pollShutdownTimer->stop();\n \n-#ifdef ENABLE_WALLET\n-    delete m_wallet_controller;\n-    m_wallet_controller = nullptr;\n-#endif\n     delete clientModel;\n     clientModel = nullptr;\n "
      }
    ]
  },
  {
    "sha": "07b9aadcfc7cc72be9df344dd5715cf8fc78f0ad",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzowN2I5YWFkY2ZjN2NjNzJiZTlkZjM0NGRkNTcxNWNmOGZjNzhmMGFk",
    "commit": {
      "author": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2019-01-29T00:08:20Z"
      },
      "committer": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2019-02-03T22:23:43Z"
      },
      "message": "gui: Expose BitcoinGUI::unsubscribeFromCoreSignals\n\nMove only change that makes unsubscribeFromCoreSignals public. It must be\ncalled if the event loop is not running otherwise core signals handlers\ncan deadlock.",
      "tree": {
        "sha": "c7f80708290f04af48d37937ba6054f3be0de52d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c7f80708290f04af48d37937ba6054f3be0de52d"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/07b9aadcfc7cc72be9df344dd5715cf8fc78f0ad",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/07b9aadcfc7cc72be9df344dd5715cf8fc78f0ad",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/07b9aadcfc7cc72be9df344dd5715cf8fc78f0ad",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/07b9aadcfc7cc72be9df344dd5715cf8fc78f0ad/comments",
    "author": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "60e190ceb3563a8102d42fdfcbefccdd1b53e812",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/60e190ceb3563a8102d42fdfcbefccdd1b53e812",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/60e190ceb3563a8102d42fdfcbefccdd1b53e812"
      }
    ],
    "stats": {
      "total": 5,
      "additions": 3,
      "deletions": 2
    },
    "files": [
      {
        "sha": "c31cefe603fee9c0a85eb43922768b3481962544",
        "filename": "src/qt/bitcoingui.h",
        "status": "modified",
        "additions": 3,
        "deletions": 2,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/07b9aadcfc7cc72be9df344dd5715cf8fc78f0ad/src/qt/bitcoingui.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/07b9aadcfc7cc72be9df344dd5715cf8fc78f0ad/src/qt/bitcoingui.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoingui.h?ref=07b9aadcfc7cc72be9df344dd5715cf8fc78f0ad",
        "patch": "@@ -95,6 +95,9 @@ class BitcoinGUI : public QMainWindow\n     */\n     bool hasTrayIcon() const { return trayIcon; }\n \n+    /** Disconnect core signals from GUI client */\n+    void unsubscribeFromCoreSignals();\n+\n protected:\n     void changeEvent(QEvent *e);\n     void closeEvent(QCloseEvent *event);\n@@ -184,8 +187,6 @@ class BitcoinGUI : public QMainWindow\n \n     /** Connect core signals to GUI client */\n     void subscribeToCoreSignals();\n-    /** Disconnect core signals from GUI client */\n-    void unsubscribeFromCoreSignals();\n \n     /** Update UI with latest network info from model. */\n     void updateNetworkState();"
      }
    ]
  },
  {
    "sha": "fd6d499bdacfa29f25b0f675375e3feaced08667",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmZDZkNDk5YmRhY2ZhMjlmMjViMGY2NzUzNzVlM2ZlYWNlZDA4NjY3",
    "commit": {
      "author": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2019-01-29T00:08:48Z"
      },
      "committer": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2019-02-03T22:23:43Z"
      },
      "message": "gui: Fix m_node.startShutdown() order\n\nThis change forwards the shutdown request on the GUI (close the\napplication for instace) to the node as soon as possible. This way the\nGUI doesn't have to wait for long operations to complete (rescan the\nwallet for instance), instead those operations detect the shutdown\nrequest and abort/interrupt.",
      "tree": {
        "sha": "b549686e21cd20ec5472c0253371bda172ad0988",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b549686e21cd20ec5472c0253371bda172ad0988"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fd6d499bdacfa29f25b0f675375e3feaced08667",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fd6d499bdacfa29f25b0f675375e3feaced08667",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fd6d499bdacfa29f25b0f675375e3feaced08667",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fd6d499bdacfa29f25b0f675375e3feaced08667/comments",
    "author": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "07b9aadcfc7cc72be9df344dd5715cf8fc78f0ad",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/07b9aadcfc7cc72be9df344dd5715cf8fc78f0ad",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/07b9aadcfc7cc72be9df344dd5715cf8fc78f0ad"
      }
    ],
    "stats": {
      "total": 10,
      "additions": 8,
      "deletions": 2
    },
    "files": [
      {
        "sha": "85d79ee26c3c995dc850ff6f779f143b4a68c65d",
        "filename": "src/qt/bitcoin.cpp",
        "status": "modified",
        "additions": 8,
        "deletions": 2,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fd6d499bdacfa29f25b0f675375e3feaced08667/src/qt/bitcoin.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fd6d499bdacfa29f25b0f675375e3feaced08667/src/qt/bitcoin.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoin.cpp?ref=fd6d499bdacfa29f25b0f675375e3feaced08667",
        "patch": "@@ -309,14 +309,20 @@ void BitcoinApplication::requestShutdown()\n     qDebug() << __func__ << \": Requesting shutdown\";\n     startThread();\n     window->hide();\n+    // Must disconnect node signals otherwise current thread can deadlock since\n+    // no event loop is running.\n+    window->unsubscribeFromCoreSignals();\n+    // Request node shutdown, which can interrupt long operations, like\n+    // rescanning a wallet.\n+    m_node.startShutdown();\n+    // Unsetting the client model can cause the current thread to wait for node\n+    // to complete an operation, like wait for a RPC execution to complate.\n     window->setClientModel(nullptr);\n     pollShutdownTimer->stop();\n \n     delete clientModel;\n     clientModel = nullptr;\n \n-    m_node.startShutdown();\n-\n     // Request shutdown from core thread\n     Q_EMIT requestedShutdown();\n }"
      }
    ]
  },
  {
    "sha": "0dd6a8c12489ea4428b398a2328dde5d1a9fe39b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzowZGQ2YThjMTI0ODllYTQ0MjhiMzk4YTIzMjhkZGU1ZDFhOWZlMzli",
    "commit": {
      "author": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2019-01-29T01:08:30Z"
      },
      "committer": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2019-02-03T22:23:44Z"
      },
      "message": "Check m_internals in UnregisterValidationInterface\n\nWhen a wallet is created it is registered in the validation interface (in\nCWallet::CreateWalletFromFile) but it is not immediately added to the\nwallets list. If a shutdown is requested before AddWallet (case more\nevident when -rescan is set) then m_internals can be released (in\nShutdown -> UnregisterBackgroundSignalScheduler) before the wallet and\nthen ReleaseWallet would call UnregisterValidationInterface with\nm_internals already released.",
      "tree": {
        "sha": "f73cae4bb143a18ab0ac1854328a47ade2a62a42",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f73cae4bb143a18ab0ac1854328a47ade2a62a42"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0dd6a8c12489ea4428b398a2328dde5d1a9fe39b",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0dd6a8c12489ea4428b398a2328dde5d1a9fe39b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/0dd6a8c12489ea4428b398a2328dde5d1a9fe39b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0dd6a8c12489ea4428b398a2328dde5d1a9fe39b/comments",
    "author": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fd6d499bdacfa29f25b0f675375e3feaced08667",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fd6d499bdacfa29f25b0f675375e3feaced08667",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fd6d499bdacfa29f25b0f675375e3feaced08667"
      }
    ],
    "stats": {
      "total": 4,
      "additions": 3,
      "deletions": 1
    },
    "files": [
      {
        "sha": "70c274d20e3efbf8f79f092b6fc3dd0ff0045dc2",
        "filename": "src/validationinterface.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 1,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/0dd6a8c12489ea4428b398a2328dde5d1a9fe39b/src/validationinterface.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/0dd6a8c12489ea4428b398a2328dde5d1a9fe39b/src/validationinterface.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/validationinterface.cpp?ref=0dd6a8c12489ea4428b398a2328dde5d1a9fe39b",
        "patch": "@@ -107,7 +107,9 @@ void RegisterValidationInterface(CValidationInterface* pwalletIn) {\n }\n \n void UnregisterValidationInterface(CValidationInterface* pwalletIn) {\n-    g_signals.m_internals->m_connMainSignals.erase(pwalletIn);\n+    if (g_signals.m_internals) {\n+        g_signals.m_internals->m_connMainSignals.erase(pwalletIn);\n+    }\n }\n \n void UnregisterAllValidationInterfaces() {"
      }
    ]
  }
]