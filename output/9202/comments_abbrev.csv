morcos,2016-11-22T15:38:21Z,"@laanwj I was playing around with this type of timing earlier and read that I should be wary of rdtsc getting reordered with respect to other instructions and that if you can't use rdtscp instead, then you should add a serializing instruction first like cpuid.   Also do you not have any issues with the thread migrating to another core?  I had to set cpu affinity.\n\nI couldn't find where I was r",https://github.com/bitcoin/bitcoin/pull/9202#issuecomment-262274371,262274371,
laanwj,2016-11-23T05:54:41Z,"> I was playing around with this type of timing earlier and read that I should be wary of rdtsc getting reordered with respect to other instructions\n\nYes, both the compiler and the CPU pipeline may reorder it. In this specific case it's not too bad, though, because the call is already from a function (State::KeepRunning) called inside the benchmark. So there is quite some overhead already, mak",https://github.com/bitcoin/bitcoin/pull/9202#issuecomment-262439410,262439410,
fanquake,2016-11-23T06:40:53Z,"Running on OSX (3.4GHz i7)\n```\n#Benchmark,count,min,max,average,min_cycles,max_cycles,average_cycles\nBase58CheckEncode,262144,0.000003828128683,0.000004008295946,0.000003908591680,12985,13597,13260\nBase58Decode,983040,0.000000999269105,0.000001138963853,0.000001040822341,3389,3863,3530\nBase58Encode,425984,0.000002385859261,0.000002805812983,0.000002487964454,8093,9517,8440\nCCoinsCachin",https://github.com/bitcoin/bitcoin/pull/9202#issuecomment-262443586,262443586,
jonasschnelli,2016-11-23T07:18:46Z,@fanquake: did you compile with `-O2` or `-O0` (`--enable-debug`)?,https://github.com/bitcoin/bitcoin/pull/9202#issuecomment-262447458,262447458,
paveljanik,2016-11-23T10:20:10Z,"It looks like `RollingBloom-refresh` bench is not changed to the new output format.\n",https://github.com/bitcoin/bitcoin/pull/9202#issuecomment-262476986,262476986,
laanwj,2016-11-23T11:06:49Z,"Yes those  lines are ""faked"" they don't go through the framework. so cycles\nis missing there, it will only be shown for the total. not a big deal,\nthough there will need to be a proper solution for nested benchmarks at\nsome point that doesn't involve printing from inside the benchmarked code.\nNot in this pull though.\n",https://github.com/bitcoin/bitcoin/pull/9202#issuecomment-262486079,262486079,
paveljanik,2016-11-23T11:10:13Z,"Agreed.\n\nACK https://github.com/bitcoin/bitcoin/pull/9202/commits/35328187463a7078b4206e394c21d5515929c7de",https://github.com/bitcoin/bitcoin/pull/9202#issuecomment-262486715,262486715,
fanquake,2016-11-23T11:18:50Z,"@jonasschnelli\n#### --enable-debug\n```\nOptions used to compile and link:\n  debug enabled = yes\n  target os     = darwin\n  build os      = darwin\n\n  CC            = /usr/local/bin/ccache gcc\n  CFLAGS        = -g -O2 -g3 -O0\n  CPPFLAGS      = -Qunused-arguments  -DDEBUG -DDEBUG_LOCKORDER -DHAVE_BUILD_INFO -D__STDC_FORMAT_MACROS -I/usr/local/opt/berkeley-db4/include -DMAC_OSX\n  ",https://github.com/bitcoin/bitcoin/pull/9202#issuecomment-262488309,262488309,
