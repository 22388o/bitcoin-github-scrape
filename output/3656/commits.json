[
  {
    "sha": "e7853a91cf646a6a4701158d148f036924575a97",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplNzg1M2E5MWNmNjQ2YTZhNDcwMTE1OGQxNDhmMDM2OTI0NTc1YTk3",
    "commit": {
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2014-02-10T11:23:33Z"
      },
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2014-02-12T00:20:42Z"
      },
      "message": "Add normalized transaction hash",
      "tree": {
        "sha": "bfa02c20c6cf1564656b14768df174d8efb34367",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bfa02c20c6cf1564656b14768df174d8efb34367"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e7853a91cf646a6a4701158d148f036924575a97",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e7853a91cf646a6a4701158d148f036924575a97",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/e7853a91cf646a6a4701158d148f036924575a97",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e7853a91cf646a6a4701158d148f036924575a97/comments",
    "author": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "b19bcb752bc19f7b6780fd8c099bb3d79e4d7cc9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b19bcb752bc19f7b6780fd8c099bb3d79e4d7cc9",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/b19bcb752bc19f7b6780fd8c099bb3d79e4d7cc9"
      }
    ],
    "stats": {
      "total": 32,
      "additions": 32,
      "deletions": 0
    },
    "files": [
      {
        "sha": "79f462c5823d2851ed8705c2999ff7b7b4a1fe8b",
        "filename": "src/core.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 0,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e7853a91cf646a6a4701158d148f036924575a97/src/core.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e7853a91cf646a6a4701158d148f036924575a97/src/core.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/core.cpp?ref=e7853a91cf646a6a4701158d148f036924575a97",
        "patch": "@@ -77,6 +77,11 @@ uint256 CTransaction::GetHash() const\n     return SerializeHash(*this);\n }\n \n+uint256 CTransaction::GetNormalizedHash() const\n+{\n+    return SignatureHash(CScript(), *this, 0, SIGHASH_ALL);\n+}\n+\n bool CTransaction::IsNewerThan(const CTransaction& old) const\n {\n     if (vin.size() != old.vin.size())"
      },
      {
        "sha": "133524e198297e94edb22729db50ff87051def9a",
        "filename": "src/core.h",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e7853a91cf646a6a4701158d148f036924575a97/src/core.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e7853a91cf646a6a4701158d148f036924575a97/src/core.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/core.h?ref=e7853a91cf646a6a4701158d148f036924575a97",
        "patch": "@@ -219,6 +219,7 @@ class CTransaction\n     }\n \n     uint256 GetHash() const;\n+    uint256 GetNormalizedHash() const;\n     bool IsNewerThan(const CTransaction& old) const;\n \n     // Return sum of txouts."
      },
      {
        "sha": "26fa3911b22d03e43f55f34a59f4ef3570a41f9d",
        "filename": "src/rpcrawtransaction.cpp",
        "status": "modified",
        "additions": 22,
        "deletions": 0,
        "changes": 22,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e7853a91cf646a6a4701158d148f036924575a97/src/rpcrawtransaction.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e7853a91cf646a6a4701158d148f036924575a97/src/rpcrawtransaction.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpcrawtransaction.cpp?ref=e7853a91cf646a6a4701158d148f036924575a97",
        "patch": "@@ -801,3 +801,25 @@ Value sendrawtransaction(const Array& params, bool fHelp)\n \n     return hashTx.GetHex();\n }\n+\n+Value getnormalizedtxid(const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size() != 1)\n+        throw runtime_error(\"blah\");\n+\n+    // parse hex string from parameter\n+    vector<unsigned char> txData(ParseHexV(params[0], \"parameter\"));\n+    CDataStream ssData(txData, SER_NETWORK, PROTOCOL_VERSION);\n+    CTransaction tx;\n+\n+    // deserialize binary data stream\n+    try {\n+        ssData >> tx;\n+    }\n+    catch (std::exception &e) {\n+        throw JSONRPCError(RPC_DESERIALIZATION_ERROR, \"TX decode failed\");\n+    }\n+    uint256 hashNormalized = tx.GetNormalizedHash();\n+\n+    return hashNormalized.GetHex();\n+}"
      },
      {
        "sha": "8766947167c44ead735fb22506591060a3905d33",
        "filename": "src/rpcserver.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e7853a91cf646a6a4701158d148f036924575a97/src/rpcserver.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e7853a91cf646a6a4701158d148f036924575a97/src/rpcserver.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpcserver.cpp?ref=e7853a91cf646a6a4701158d148f036924575a97",
        "patch": "@@ -244,6 +244,7 @@ static const CRPCCommand vRPCCommands[] =\n     { \"decodescript\",           &decodescript,           false,     false,      false },\n     { \"signrawtransaction\",     &signrawtransaction,     false,     false,      false },\n     { \"sendrawtransaction\",     &sendrawtransaction,     false,     false,      false },\n+    { \"getnormalizedtxid\",      &getnormalizedtxid,      true,      true,       false },\n     { \"gettxoutsetinfo\",        &gettxoutsetinfo,        true,      false,      false },\n     { \"gettxout\",               &gettxout,               true,      false,      false },\n     { \"verifychain\",            &verifychain,            true,      false,      false },"
      },
      {
        "sha": "75e5d9dc2ffa57b6a29a4ee792bbf73ff4562896",
        "filename": "src/rpcserver.h",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e7853a91cf646a6a4701158d148f036924575a97/src/rpcserver.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e7853a91cf646a6a4701158d148f036924575a97/src/rpcserver.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpcserver.h?ref=e7853a91cf646a6a4701158d148f036924575a97",
        "patch": "@@ -173,6 +173,7 @@ extern json_spirit::Value decoderawtransaction(const json_spirit::Array& params,\n extern json_spirit::Value decodescript(const json_spirit::Array& params, bool fHelp);\n extern json_spirit::Value signrawtransaction(const json_spirit::Array& params, bool fHelp);\n extern json_spirit::Value sendrawtransaction(const json_spirit::Array& params, bool fHelp);\n+extern json_spirit::Value getnormalizedtxid(const json_spirit::Array& params, bool fHelp);\n \n extern json_spirit::Value getblockcount(const json_spirit::Array& params, bool fHelp); // in rpcblockchain.cpp\n extern json_spirit::Value getbestblockhash(const json_spirit::Array& params, bool fHelp);"
      },
      {
        "sha": "105e6c89cbd1c6a0cd94f3800f98caf7121e1617",
        "filename": "src/rpcwallet.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e7853a91cf646a6a4701158d148f036924575a97/src/rpcwallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e7853a91cf646a6a4701158d148f036924575a97/src/rpcwallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpcwallet.cpp?ref=e7853a91cf646a6a4701158d148f036924575a97",
        "patch": "@@ -52,6 +52,7 @@ void WalletTxToJSON(const CWalletTx& wtx, Object& entry)\n         entry.push_back(Pair(\"blocktime\", (boost::int64_t)(mapBlockIndex[wtx.hashBlock]->nTime)));\n     }\n     entry.push_back(Pair(\"txid\", wtx.GetHash().GetHex()));\n+    entry.push_back(Pair(\"normtxid\", wtx.GetNormalizedHash().GetHex()));\n     entry.push_back(Pair(\"time\", (boost::int64_t)wtx.GetTxTime()));\n     entry.push_back(Pair(\"timereceived\", (boost::int64_t)wtx.nTimeReceived));\n     BOOST_FOREACH(const PAIRTYPE(string,string)& item, wtx.mapValue)"
      },
      {
        "sha": "67ded039176f20526aca08071665e700017a3010",
        "filename": "src/script.h",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e7853a91cf646a6a4701158d148f036924575a97/src/script.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e7853a91cf646a6a4701158d148f036924575a97/src/script.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script.h?ref=e7853a91cf646a6a4701158d148f036924575a97",
        "patch": "@@ -687,6 +687,7 @@ class CScriptCompressor\n bool IsCanonicalPubKey(const std::vector<unsigned char> &vchPubKey, unsigned int flags);\n bool IsCanonicalSignature(const std::vector<unsigned char> &vchSig, unsigned int flags);\n \n+uint256 SignatureHash(const CScript &scriptCode, const CTransaction& txTo, unsigned int nIn, int nHashType);\n bool EvalScript(std::vector<std::vector<unsigned char> >& stack, const CScript& script, const CTransaction& txTo, unsigned int nIn, unsigned int flags, int nHashType);\n bool Solver(const CScript& scriptPubKey, txnouttype& typeRet, std::vector<std::vector<unsigned char> >& vSolutionsRet);\n int ScriptSigArgsExpected(txnouttype t, const std::vector<std::vector<unsigned char> >& vSolutions);"
      }
    ]
  }
]