sipa,2014-12-30T00:59:54Z,@TheBlueMatt This will probably require a comparison tool update to remove tests for the BIP34 changeover logic.\n,https://github.com/bitcoin/bitcoin/pull/5562#issuecomment-68320464,68320464,
petertodd,2015-01-03T05:04:09Z,"You know, conceptually it feels like what we really want here is for the block validation logic to only apply BIP34, but allow the test to fail if we're validating a block prior to a BIP34-specific checkpoint.\n\nWhat you've written now has the weird effect that a huge reorg can create a different blockchain where BIP34 rules are disabled prior to a certain block height. A pedantic difference sure",https://github.com/bitcoin/bitcoin/pull/5562#issuecomment-68583655,68583655,
sipa,2015-01-04T15:56:52Z,"@petertodd Good point - ideally the BIP34 check is indeed guarded by a block hash rather than just height. It does add a complication in the decision logic though, as it means we need to wait until the switchover header is downloaded and validated before we can do block validation. I'm not convinced that complication is worth the benefit in this case.\n\nI don't think we can remove checkpoints ent",https://github.com/bitcoin/bitcoin/pull/5562#issuecomment-68637511,68637511,
petertodd,2015-01-04T23:48:22Z,"I agree it's not worth it yet; more thinking down the road when we've had a bunch of these little upgrades. My understanding with headers first was it'd be totally reasonable to download the entire set of block headers, and only then start downloading blocks.\n\nWe can't yet I agree, although it's easy to forsee us being able to in the nearish future when we have better ways of determining the tot",https://github.com/bitcoin/bitcoin/pull/5562#issuecomment-68655394,68655394,
luke-jr,2015-01-05T02:14:44Z,"I would think we may want to keep IsSuperMajority around for future softforks, and I agree testnet should not be hard-coded like this.\n",https://github.com/bitcoin/bitcoin/pull/5562#issuecomment-68661040,68661040,
petertodd,2015-01-05T03:52:03Z,"@luke-jr Oh, I'm not suggesting we remove it, just suggesting there may be a simpler way to deal with older rule changes.\n",https://github.com/bitcoin/bitcoin/pull/5562#issuecomment-68665648,68665648,
petertodd,2015-01-05T03:54:06Z,"@luke-jr Oh wait, you mean @sipa's removal - well, that can be recovered from git history.\n\nre: testnet, we should be careful to make sure testnet and mainnet use as similar code as possible - it might make sense to have the testnet rule switchover even be _not_ block zero, certainly to keep the logic there w/ block zero as the switchover.\n",https://github.com/bitcoin/bitcoin/pull/5562#issuecomment-68665754,68665754,
gmaxwell,2015-01-05T06:36:36Z,"BIP34 checks are uninteresting enough (in terms of what you get from violating them) that I wouldn't want any additional complexity for them, and so I think it's fine to retcon the rule into being a straight up height threshold. Such a test is pretty much the easiest behaviour change to implement, and to implement mostly correctly.\n\nWhen we simplified BIP30 we were unable to do this (well, unabl",https://github.com/bitcoin/bitcoin/pull/5562#issuecomment-68673200,68673200,
sipa,2015-01-13T02:23:11Z,"@luke-jr I wouldn't want to use that implementation anymore for future rule changes, both semantically (it unnecessarily constrains the block version number further) and implementation-wise (it needs to scan over 1000 block index entries for every block check).\n",https://github.com/bitcoin/bitcoin/pull/5562#issuecomment-69685419,69685419,
petertodd,2015-01-13T02:36:45Z,@sipa What alternative are you thinking of?\n,https://github.com/bitcoin/bitcoin/pull/5562#issuecomment-69686542,69686542,
laanwj,2015-03-26T07:15:08Z,"We're using `IsSuperMajority` for the BIP66 block version 2 to 3 switch, so the implementation here needs to be changed.\n",https://github.com/bitcoin/bitcoin/pull/5562#issuecomment-86366546,86366546,
laanwj,2015-04-03T07:19:29Z,Rebased as #5966\n,https://github.com/bitcoin/bitcoin/pull/5562#issuecomment-89200082,89200082,
