jgarzik,2011-07-31T00:28:20Z,"Your GetFileSize change is a regression, introducing a minor race window.  If we have an open FILE*, then we may fstat via fileno.  The current code implicitly does this, by working on the already-open file.\n\nYour change refers to the file by name, which may have been renamed, and may no longer refer to the already-open file.\n",https://github.com/bitcoin/bitcoin/pull/439#issuecomment-1693451,1693451,
jrmithdobbs,2011-07-31T00:30:58Z,win32 does not have a fstat() that I can find. That is why I did it this way. There doesn't seem to be a way to easily guarantee that fseek()/ftell() will give you a 64bit int. Suggestions?\n,https://github.com/bitcoin/bitcoin/pull/439#issuecomment-1693456,1693456,
jrmithdobbs,2011-07-31T00:42:55Z,Also it actually doesn't add any new kind of race condition. It's only first opened a line before the call (and this is the only caller) and gets closed and reopened immediately afterwards if the file with that filename at the time is longer than the specified hardcoded value.\n\nWorst case we'll get old logs from a different file appended to the top of the new debug.log than was actually in the o,https://github.com/bitcoin/bitcoin/pull/439#issuecomment-1693480,1693480,
jgarzik,2011-07-31T01:38:27Z,Windows supports _ftelli64.\n\nThe ftell approach remains superior because it avoids the aforementioned regression.\n,https://github.com/bitcoin/bitcoin/pull/439#issuecomment-1693604,1693604,
jrmithdobbs,2011-07-31T02:25:41Z,"There we go, race condition gone.\n",https://github.com/bitcoin/bitcoin/pull/439#issuecomment-1693691,1693691,
gavinandresen,2011-08-09T15:49:24Z,"Seems to me this is fixing the symptom, not the disease.  The disease is writing way too much to debug.log by default.\n",https://github.com/bitcoin/bitcoin/pull/439#issuecomment-1764512,1764512,
jrmithdobbs,2011-08-09T23:29:32Z,"I agree that the default logging level probably needs to be reworked; but, this is a problem in itself. No software should just stop logging out of the blue unless it has no space on the device it's logging to.\n",https://github.com/bitcoin/bitcoin/pull/439#issuecomment-1768480,1768480,
jrmithdobbs,2011-09-07T16:23:43Z,Added test instructions to description:\n\nThis can be tested with:\n\n dd if=/dev/zero of=debug.log bs=$((1024 \* 1024)) count=2048; tail -f debug.log & bitcoind -daemon;\n\nIf logs get appended to where debug.log continues past 2GB it is working. Must be tested on a 32bit build.\n,https://github.com/bitcoin/bitcoin/pull/439#issuecomment-2030495,2030495,
alexwaters,2011-09-18T08:25:52Z,"I have to agree that we shouldn't have a 2GB+ logfile in the first place. For the majority of people, I would think that the advantage of having verbose logs is outweighed by the inconvenience of their size.\n\nhttps://github.com/bitcoin/bitcoin/issues/515 - logfile size reference\n\nhttps://github.com/bitcoin/bitcoin/pull/125 - log filters\nhttps://github.com/bitcoin/bitcoin/pull/520 - streamlini",https://github.com/bitcoin/bitcoin/pull/439#issuecomment-2125834,2125834,
laanwj,2011-11-26T08:11:38Z,"I agree with @jrmithdobbs here. >2GB log files are a problem in itself, but it should not simply stop logging after that, that can be dangerous and lead to non-debuggable issues. \n",https://github.com/bitcoin/bitcoin/pull/439#issuecomment-2880506,2880506,
sipa,2012-04-08T17:15:36Z,"This seems to have been forgotten over time. Looking at it again, it seems to remove the automatic pruning of debug.log. Is this intentional/wanted?\n",https://github.com/bitcoin/bitcoin/pull/439#issuecomment-5016842,5016842,
laanwj,2012-05-15T07:49:50Z,"Hm I understood from the bug reported was that it stopped logging after 2Gb. It's good to solve that.\n\nAuto-pruning should not be disabled though, IMO, as most users don't want to be concerned with the debug.log file at all. So having it grow to fill their disk is not so nice. Pruning at startup when the file is big is a good compromise.\n",https://github.com/bitcoin/bitcoin/pull/439#issuecomment-5710394,5710394,
Diapolo,2012-05-15T12:37:33Z,But processing a 2GB file should be quite time-intense and will for sure hurt user-experience!?\n,https://github.com/bitcoin/bitcoin/pull/439#issuecomment-5714722,5714722,
jrmithdobbs,2012-05-15T13:30:09Z,"Processing how? It's never read back in let alone ""processed.""\n\nMy removing of the pruning was intentional. Auto-pruning logs is just bad practice. What if I need to look at something in my log from a month ago? Things log way too verbosely by default, sure, fix that don't mangle the log.\n\nFeel free to close this. It needs fixing but I have no interest in rebasing/etc.\n",https://github.com/bitcoin/bitcoin/pull/439#issuecomment-5715735,5715735,
Diapolo,2012-05-15T14:50:42Z,"I meant Auto-pruning a large log-file could be time-intense, no?\n",https://github.com/bitcoin/bitcoin/pull/439#issuecomment-5717726,5717726,
