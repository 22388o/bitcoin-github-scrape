{
  "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17132",
  "id": 327624427,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MzI3NjI0NDI3",
  "html_url": "https://github.com/bitcoin/bitcoin/pull/17132",
  "diff_url": "https://github.com/bitcoin/bitcoin/pull/17132.diff",
  "patch_url": "https://github.com/bitcoin/bitcoin/pull/17132.patch",
  "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17132",
  "number": 17132,
  "state": "closed",
  "locked": false,
  "title": "[WIP] Add an update checker",
  "user": {
    "login": "emilengler",
    "id": 12272949,
    "node_id": "MDQ6VXNlcjEyMjcyOTQ5",
    "avatar_url": "https://avatars.githubusercontent.com/u/12272949?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/emilengler",
    "html_url": "https://github.com/emilengler",
    "followers_url": "https://api.github.com/users/emilengler/followers",
    "following_url": "https://api.github.com/users/emilengler/following{/other_user}",
    "gists_url": "https://api.github.com/users/emilengler/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/emilengler/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/emilengler/subscriptions",
    "organizations_url": "https://api.github.com/users/emilengler/orgs",
    "repos_url": "https://api.github.com/users/emilengler/repos",
    "events_url": "https://api.github.com/users/emilengler/events{/privacy}",
    "received_events_url": "https://api.github.com/users/emilengler/received_events",
    "type": "User",
    "site_admin": false
  },
  "body": "### About\r\nThis adds a cryptography system to check for newer versions of Bitcoin Core. It will never update binaries itself.\r\nIt adds a new RPC command called `check-update` and displays a message in the GUI if a new version is available.\r\n### How does this work\r\nThere is a list of sources where a file is hosted which says the newest version + a digital signature of it. When checking for a new version it does the following steps:\r\n\r\n1. Checks if the client is a release and not a dirty build (disabled right now for testing purpose)\r\n2. It will choose a random source from where to get the versions file\r\n3. It will try to download the versions file, if it fails it will select a new source. If no source is found, it will fail\r\n4. It will parse the downloaded file\r\n5. It will verify if the signature matches one of the hard coded public keys\r\n6. It will check if the version is newer than the current one (disabled because of testing)\r\n7. It will check if the new version string only contains numbers, dots and 'v'\r\n\r\n### Q&A\r\n**Q:** Alert Key system remastered?\r\n**A:** No, the alert key system was a bitcoin specific thing which happened over the protocol, this happens over HTTP and is only related to Bitcoin Core and will only give a new version (or anything that can be done with just numbers and dots)\r\n**Q:** What happens if someone gets a public version signing key?\r\n**A:** Nothing. Unless he does not control a source, he can't do anything with it. If he controls a source he could give a message with just numbers, dots and 'v' and it would be only visible to these peers who randomly select his source\r\n**Q:** What happens when an attacker gets the control over a source?\r\n**A:** Nothing, as long as he doesn't have the private key of a version signing address. He could just remove the version or install an older\r\n**Q:** Is it centralization?\r\n**A:** Well yes, but Bitcoin Core is a centralized project (it has maintainers, governance, etc.). Like I said, the system has nothing to do with Bitcoin directly\r\n\r\n### Version Signing Address\r\nA Version Signing Address needs to be legacy to create and verify signatures\r\n\r\n### Source\r\nThe source is just a txt file hosted on a web server. It needs to be exactly two lines long. The first line contains the text and the second one the message.\r\nExample:\r\n```\r\nv0.99.0\r\nIEHPu8Bc609G9wxc0TPOfGlnSbtEcvoZA68e/pi5pEZqeqegvovwqcNtXfU50ju+hD5OIJWsuOTjHISLV+KprVs=\r\n```\r\n\r\n### Testing\r\nBecause it uses libcurl and I am a complete disaster when it comes to build systems it only works with libcurl installed and I only tested it on (g++ (Debian 8.3.0-6) 8.3.0)\r\n\r\nFirst install libcurl\r\nOn Debian 10\r\n```\r\napt install libcurl4-openssl\r\n```\r\n\r\nWhen you build this PR and run check-update you will get\r\n```\r\nv0.99.0\r\n```\r\nWhen you run bitcoin-qt you will get\r\n![](https://i.imgur.com/oiKVVJk.png)\r\nIt will use a source on my webserver with a public key that only I have\r\n(The server might be down around 4am german time every day)\r\n\r\n### Testing with own source or address\r\n#### Source\r\n1. Setup a web server\r\n2. Copy a valid source file (you can use mine) to the webserver\r\n3. Add the URL of the file to the class constructor with adding the function `addSource(\"http://yourhost\");`\r\n#### Address\r\n1. Create a new legacy address (can be done over getnewaddress)\r\n2. Copy this address to the class contructor with `addKey(\"YOURADDRESS\");`\r\n3. Create a source file with signing the version text from line 1\r\n\r\n### To-Do before merging\r\n* Get address from laanwj and others (just as backups)\r\n* Integrate libcurl better to the build system and if it's not available disable this feature.\r\n* Setup multiple sources for the case that one is down and to add decentralization.\r\n* Add options to the RPC call to use a custom source and address (for testing)\r\n\r\n**Because this PR uses new dependencies a compilation might not work**\r\n**Contact me whenever you have questions or problems of any kind**",
  "created_at": "2019-10-14T02:56:23Z",
  "updated_at": "2019-10-15T14:01:14Z",
  "closed_at": "2019-10-14T15:25:13Z",
  "merged_at": null,
  "merge_commit_sha": "8507509412afe48636f076868b03d96d4765c0a5",
  "assignee": null,
  "assignees": [],
  "requested_reviewers": [],
  "requested_teams": [],
  "labels": [
    {
      "id": 61889416,
      "node_id": "MDU6TGFiZWw2MTg4OTQxNg==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Build%20system",
      "name": "Build system",
      "color": "5319e7",
      "default": false,
      "description": null
    },
    {
      "id": 98279177,
      "node_id": "MDU6TGFiZWw5ODI3OTE3Nw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/RPC/REST/ZMQ",
      "name": "RPC/REST/ZMQ",
      "color": "0052cc",
      "default": false,
      "description": null
    },
    {
      "id": 1392286103,
      "node_id": "MDU6TGFiZWwxMzkyMjg2MTAz",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/Needs%20Conceptual%20Review",
      "name": "Needs Conceptual Review",
      "color": "fef2c0",
      "default": false,
      "description": ""
    }
  ],
  "milestone": null,
  "draft": true,
  "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17132/commits",
  "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17132/comments",
  "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments{/number}",
  "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17132/comments",
  "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/a7534a226012cb04bdc364c3627a7056086221ca",
  "head": {
    "label": "emilengler:2019-10-check-update-system",
    "ref": "2019-10-check-update-system",
    "sha": "a7534a226012cb04bdc364c3627a7056086221ca",
    "user": {
      "login": "emilengler",
      "id": 12272949,
      "node_id": "MDQ6VXNlcjEyMjcyOTQ5",
      "avatar_url": "https://avatars.githubusercontent.com/u/12272949?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emilengler",
      "html_url": "https://github.com/emilengler",
      "followers_url": "https://api.github.com/users/emilengler/followers",
      "following_url": "https://api.github.com/users/emilengler/following{/other_user}",
      "gists_url": "https://api.github.com/users/emilengler/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emilengler/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emilengler/subscriptions",
      "organizations_url": "https://api.github.com/users/emilengler/orgs",
      "repos_url": "https://api.github.com/users/emilengler/repos",
      "events_url": "https://api.github.com/users/emilengler/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emilengler/received_events",
      "type": "User",
      "site_admin": false
    },
    "repo": null
  },
  "base": {
    "label": "bitcoin:master",
    "ref": "master",
    "sha": "e82f874a2376998567ecbf9be3b979ff1db4754c",
    "user": {
      "login": "bitcoin",
      "id": 528860,
      "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bitcoin",
      "html_url": "https://github.com/bitcoin",
      "followers_url": "https://api.github.com/users/bitcoin/followers",
      "following_url": "https://api.github.com/users/bitcoin/following{/other_user}",
      "gists_url": "https://api.github.com/users/bitcoin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bitcoin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
      "organizations_url": "https://api.github.com/users/bitcoin/orgs",
      "repos_url": "https://api.github.com/users/bitcoin/repos",
      "events_url": "https://api.github.com/users/bitcoin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bitcoin/received_events",
      "type": "Organization",
      "site_admin": false
    },
    "repo": {
      "id": 1181927,
      "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
      "name": "bitcoin",
      "full_name": "bitcoin/bitcoin",
      "private": false,
      "owner": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following{/other_user}",
        "gists_url": "https://api.github.com/users/bitcoin/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bitcoin/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin",
      "description": "Bitcoin Core integration/staging tree",
      "fork": false,
      "url": "https://api.github.com/repos/bitcoin/bitcoin",
      "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
      "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys{/key_id}",
      "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators{/collaborator}",
      "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
      "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
      "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events{/number}",
      "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
      "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees{/user}",
      "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches{/branch}",
      "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
      "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs{/sha}",
      "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags{/sha}",
      "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs{/sha}",
      "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees{/sha}",
      "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/{sha}",
      "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
      "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
      "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
      "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
      "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
      "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits{/sha}",
      "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits{/sha}",
      "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments{/number}",
      "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments{/number}",
      "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/{+path}",
      "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/{base}...{head}",
      "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
      "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/{archive_format}{/ref}",
      "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
      "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues{/number}",
      "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls{/number}",
      "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones{/number}",
      "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications{?since,all,participating}",
      "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels{/name}",
      "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases{/id}",
      "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
      "created_at": "2010-12-19T15:16:43Z",
      "updated_at": "2021-12-02T09:16:34Z",
      "pushed_at": "2021-12-02T08:26:02Z",
      "git_url": "git://github.com/bitcoin/bitcoin.git",
      "ssh_url": "git@github.com:bitcoin/bitcoin.git",
      "clone_url": "https://github.com/bitcoin/bitcoin.git",
      "svn_url": "https://github.com/bitcoin/bitcoin",
      "homepage": "https://bitcoincore.org/en/download",
      "size": 188203,
      "stargazers_count": 59737,
      "watchers_count": 59737,
      "language": "C++",
      "has_issues": true,
      "has_projects": true,
      "has_downloads": false,
      "has_wiki": false,
      "has_pages": false,
      "forks_count": 30709,
      "mirror_url": null,
      "archived": false,
      "disabled": false,
      "open_issues_count": 1021,
      "license": {
        "key": "mit",
        "name": "MIT License",
        "spdx_id": "MIT",
        "url": "https://api.github.com/licenses/mit",
        "node_id": "MDc6TGljZW5zZTEz"
      },
      "allow_forking": true,
      "is_template": false,
      "topics": [
        "bitcoin",
        "c-plus-plus",
        "cryptocurrency",
        "cryptography",
        "p2p"
      ],
      "visibility": "public",
      "forks": 30709,
      "open_issues": 1021,
      "watchers": 59737,
      "default_branch": "master"
    }
  },
  "_links": {
    "self": {
      "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17132"
    },
    "html": {
      "href": "https://github.com/bitcoin/bitcoin/pull/17132"
    },
    "issue": {
      "href": "https://api.github.com/repos/bitcoin/bitcoin/issues/17132"
    },
    "comments": {
      "href": "https://api.github.com/repos/bitcoin/bitcoin/issues/17132/comments"
    },
    "review_comments": {
      "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17132/comments"
    },
    "review_comment": {
      "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments{/number}"
    },
    "commits": {
      "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17132/commits"
    },
    "statuses": {
      "href": "https://api.github.com/repos/bitcoin/bitcoin/statuses/a7534a226012cb04bdc364c3627a7056086221ca"
    }
  },
  "author_association": "CONTRIBUTOR",
  "auto_merge": null,
  "active_lock_reason": null,
  "merged": false,
  "mergeable": null,
  "rebaseable": null,
  "mergeable_state": "draft",
  "merged_by": null,
  "comments": 15,
  "review_comments": 0,
  "maintainer_can_modify": false,
  "commits": 1,
  "additions": 228,
  "deletions": 1,
  "changed_files": 5
}