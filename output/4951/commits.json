[
  {
    "sha": "d6712db35419e36b2c89191eb730a86d95abf4b0",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkNjcxMmRiMzU0MTllMzZiMmM4OTE5MWViNzMwYTg2ZDk1YWJmNGIw",
    "commit": {
      "author": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2014-09-20T08:56:25Z"
      },
      "committer": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2014-09-20T09:03:59Z"
      },
      "message": "Also create pid file in non-daemon mode\n\nAlways make a pid file, not only when `-daemon` specified.\n\nThis is useful for troubleshooting, for attaching debuggers and loggers\nand such.\n\n- Write the pid file only after the datadir lock was acquired\n- Don't create or remove a pid file on WIN32, and also don't show the option",
      "tree": {
        "sha": "2f251c16c9b9689aaef24f0012378d410c005591",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2f251c16c9b9689aaef24f0012378d410c005591"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d6712db35419e36b2c89191eb730a86d95abf4b0",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1\n\niQEcBAABCgAGBQJUHUMAAAoJEHSBCwEjRsmmzWIH/iHUXUFj0Vu+ptu6SRXa6IP3\nEPxnQlUEPJ6Va+qP6YaP1RnRRCbhEDcIc6birVF/6Nrgn9cz0tFlCYEIyUJ3js/l\nX7ryCecze3AlPcMmfbcnUVJaqtnvkqxbIUIk328aug2KkuHzyiFAScoYK7yI6h1/\nLJQpbQIMmuZPg25n/dWdYvVQU3N71cSPBLeh/9GFJQAJf+da/XTJ/kj5tYedV6v7\n5qhQLyLzZGttBIoR0KgJA8gLnMpiisTEJCqhKRsFCZFUhrqtC9869ptEhse/3ei/\nYDkx+s5ftolydoMjtRB/NVtpNFz9sGr9sirAZcXrAYamyDOxaGlX22naIfNjYNs=\n=Z7Lw\n-----END PGP SIGNATURE-----",
        "payload": "tree 2f251c16c9b9689aaef24f0012378d410c005591\nparent 25308337d659108e3320257fb6c1c16d5fe24aa9\nauthor Wladimir J. van der Laan <laanwj@gmail.com> 1411203385 +0200\ncommitter Wladimir J. van der Laan <laanwj@gmail.com> 1411203839 +0200\n\nAlso create pid file in non-daemon mode\n\nAlways make a pid file, not only when `-daemon` specified.\n\nThis is useful for troubleshooting, for attaching debuggers and loggers\nand such.\n\n- Write the pid file only after the datadir lock was acquired\n- Don't create or remove a pid file on WIN32, and also don't show the option\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d6712db35419e36b2c89191eb730a86d95abf4b0",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/d6712db35419e36b2c89191eb730a86d95abf4b0",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d6712db35419e36b2c89191eb730a86d95abf4b0/comments",
    "author": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "25308337d659108e3320257fb6c1c16d5fe24aa9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/25308337d659108e3320257fb6c1c16d5fe24aa9",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/25308337d659108e3320257fb6c1c16d5fe24aa9"
      }
    ],
    "stats": {
      "total": 13,
      "additions": 9,
      "deletions": 4
    },
    "files": [
      {
        "sha": "0737b5a83dad27dca36e55d32f6c068b26802266",
        "filename": "src/bitcoind.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d6712db35419e36b2c89191eb730a86d95abf4b0/src/bitcoind.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d6712db35419e36b2c89191eb730a86d95abf4b0/src/bitcoind.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoind.cpp?ref=d6712db35419e36b2c89191eb730a86d95abf4b0",
        "patch": "@@ -129,7 +129,6 @@ bool AppInit(int argc, char* argv[])\n             }\n             if (pid > 0) // Parent process, pid is child process id\n             {\n-                CreatePidFile(GetPidFile(), pid);\n                 return true;\n             }\n             // Child process falls through to rest of initialization"
      },
      {
        "sha": "7299bd0f4a732bfbfe1a773648c7929e41b9e07b",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 1,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d6712db35419e36b2c89191eb730a86d95abf4b0/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d6712db35419e36b2c89191eb730a86d95abf4b0/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=d6712db35419e36b2c89191eb730a86d95abf4b0",
        "patch": "@@ -160,7 +160,9 @@ void Shutdown()\n     if (pwalletMain)\n         bitdb.Flush(true);\n #endif\n+#ifndef WIN32\n     boost::filesystem::remove(GetPidFile());\n+#endif\n     UnregisterAllWallets();\n #ifdef ENABLE_WALLET\n     if (pwalletMain)\n@@ -228,7 +230,9 @@ std::string HelpMessage(HelpMessageMode mode)\n     strUsage += \"  -maxorphanblocks=<n>   \" + strprintf(_(\"Keep at most <n> unconnectable blocks in memory (default: %u)\"), DEFAULT_MAX_ORPHAN_BLOCKS) + \"\\n\";\n     strUsage += \"  -maxorphantx=<n>       \" + strprintf(_(\"Keep at most <n> unconnectable transactions in memory (default: %u)\"), DEFAULT_MAX_ORPHAN_TRANSACTIONS) + \"\\n\";\n     strUsage += \"  -par=<n>               \" + strprintf(_(\"Set the number of script verification threads (%u to %d, 0 = auto, <0 = leave that many cores free, default: %d)\"), -(int)boost::thread::hardware_concurrency(), MAX_SCRIPTCHECK_THREADS, DEFAULT_SCRIPTCHECK_THREADS) + \"\\n\";\n+#ifndef WIN32\n     strUsage += \"  -pid=<file>            \" + _(\"Specify pid file (default: bitcoind.pid)\") + \"\\n\";\n+#endif\n     strUsage += \"  -reindex               \" + _(\"Rebuild block chain index from current blk000??.dat files\") + \" \" + _(\"on startup\") + \"\\n\";\n #if !defined(WIN32)\n     strUsage += \"  -sysperms              \" + _(\"Create new files with system default permissions, instead of umask 077 (only effective with disabled wallet functionality)\") + \"\\n\";\n@@ -714,7 +718,9 @@ bool AppInit2(boost::thread_group& threadGroup)\n     static boost::interprocess::file_lock lock(pathLockFile.string().c_str());\n     if (!lock.try_lock())\n         return InitError(strprintf(_(\"Cannot obtain a lock on data directory %s. Bitcoin Core is probably already running.\"), strDataDir));\n-\n+#ifndef WIN32\n+    CreatePidFile(GetPidFile(), getpid());\n+#endif\n     if (GetBoolArg(\"-shrinkdebugfile\", !fDebug))\n         ShrinkDebugFile();\n     LogPrintf(\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\");"
      },
      {
        "sha": "f387fce8c7b528e729474af45867edffc28555f7",
        "filename": "src/util.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d6712db35419e36b2c89191eb730a86d95abf4b0/src/util.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d6712db35419e36b2c89191eb730a86d95abf4b0/src/util.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util.cpp?ref=d6712db35419e36b2c89191eb730a86d95abf4b0",
        "patch": "@@ -472,14 +472,14 @@ void ReadConfigFile(map<string, string>& mapSettingsRet,\n     ClearDatadirCache();\n }\n \n+#ifndef WIN32\n boost::filesystem::path GetPidFile()\n {\n     boost::filesystem::path pathPidFile(GetArg(\"-pid\", \"bitcoind.pid\"));\n     if (!pathPidFile.is_complete()) pathPidFile = GetDataDir() / pathPidFile;\n     return pathPidFile;\n }\n \n-#ifndef WIN32\n void CreatePidFile(const boost::filesystem::path &path, pid_t pid)\n {\n     FILE* file = fopen(path.string().c_str(), \"w\");"
      },
      {
        "sha": "4b2415278ba33e361134783d7b50e9245e0d430c",
        "filename": "src/util.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d6712db35419e36b2c89191eb730a86d95abf4b0/src/util.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d6712db35419e36b2c89191eb730a86d95abf4b0/src/util.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util.h?ref=d6712db35419e36b2c89191eb730a86d95abf4b0",
        "patch": "@@ -93,8 +93,8 @@ bool TryCreateDirectory(const boost::filesystem::path& p);\n boost::filesystem::path GetDefaultDataDir();\n const boost::filesystem::path &GetDataDir(bool fNetSpecific = true);\n boost::filesystem::path GetConfigFile();\n-boost::filesystem::path GetPidFile();\n #ifndef WIN32\n+boost::filesystem::path GetPidFile();\n void CreatePidFile(const boost::filesystem::path &path, pid_t pid);\n #endif\n void ReadConfigFile(std::map<std::string, std::string>& mapSettingsRet, std::map<std::string, std::vector<std::string> >& mapMultiSettingsRet);"
      }
    ]
  }
]