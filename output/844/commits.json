[
  {
    "sha": "cc201e01f8216b2a95c9825b31530df9beb0f32b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpjYzIwMWUwMWY4MjE2YjJhOTVjOTgyNWIzMTUzMGRmOWJlYjBmMzJi",
    "commit": {
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2012-02-15T20:17:15Z"
      },
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2012-02-15T20:17:15Z"
      },
      "message": "Several shutdown-related fixes\n\n* do not let vnThreadsRunning[1] go negative\n* do not perform locking operations while vnThreadsRunning[1] is decreased\n* check vnThreadsRunning[1] at exit",
      "tree": {
        "sha": "e5a04b7ee69937c14acef350ed255abb4caa2c02",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e5a04b7ee69937c14acef350ed255abb4caa2c02"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cc201e01f8216b2a95c9825b31530df9beb0f32b",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/cc201e01f8216b2a95c9825b31530df9beb0f32b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/cc201e01f8216b2a95c9825b31530df9beb0f32b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/cc201e01f8216b2a95c9825b31530df9beb0f32b/comments",
    "author": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "c85c37acb16df6c8911c81689932890eec6864a3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c85c37acb16df6c8911c81689932890eec6864a3",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/c85c37acb16df6c8911c81689932890eec6864a3"
      }
    ],
    "stats": {
      "total": 13,
      "additions": 8,
      "deletions": 5
    },
    "files": [
      {
        "sha": "92afdb0dc71749bd0bb0b9bd39cf44610e2604d4",
        "filename": "src/net.cpp",
        "status": "modified",
        "additions": 8,
        "deletions": 5,
        "changes": 13,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/cc201e01f8216b2a95c9825b31530df9beb0f32b/src/net.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/cc201e01f8216b2a95c9825b31530df9beb0f32b/src/net.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.cpp?ref=cc201e01f8216b2a95c9825b31530df9beb0f32b",
        "patch": "@@ -1274,9 +1274,13 @@ void ThreadOpenConnections2(void* parg)\n     int64 nStart = GetTime();\n     loop\n     {\n-        // Limit outbound connections\n         vnThreadsRunning[1]--;\n         Sleep(500);\n+        vnThreadsRunning[1]++;\n+        if (fShutdown)\n+            return;\n+\n+        // Limit outbound connections\n         loop\n         {\n             int nOutbound = 0;\n@@ -1288,13 +1292,12 @@ void ThreadOpenConnections2(void* parg)\n             nMaxOutboundConnections = min(nMaxOutboundConnections, (int)GetArg(\"-maxconnections\", 125));\n             if (nOutbound < nMaxOutboundConnections)\n                 break;\n+            vnThreadsRunning[1]--;\n             Sleep(2000);\n+            vnThreadsRunning[1]++;\n             if (fShutdown)\n                 return;\n         }\n-        vnThreadsRunning[1]++;\n-        if (fShutdown)\n-            return;\n \n         bool fAddSeeds = false;\n \n@@ -1766,7 +1769,7 @@ bool StopNode()\n     fShutdown = true;\n     nTransactionsUpdated++;\n     int64 nStart = GetTime();\n-    while (vnThreadsRunning[0] > 0 || vnThreadsRunning[2] > 0 || vnThreadsRunning[3] > 0 || vnThreadsRunning[4] > 0\n+    while (vnThreadsRunning[0] > 0 || vnThreadsRunning[1] > 0 || vnThreadsRunning[2] > 0 || vnThreadsRunning[3] > 0 || vnThreadsRunning[4] > 0\n         || (fHaveUPnP && vnThreadsRunning[5] > 0) || vnThreadsRunning[6] > 0 || vnThreadsRunning[7] > 0\n     )\n     {"
      }
    ]
  }
]