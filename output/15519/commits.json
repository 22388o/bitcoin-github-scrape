[
  {
    "sha": "03be7f48fad10aa8da3291c28a185ed750193c7b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzowM2JlN2Y0OGZhZDEwYWE4ZGEzMjkxYzI4YTE4NWVkNzUwMTkzYzdi",
    "commit": {
      "author": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2019-03-03T20:12:34Z"
      },
      "committer": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2019-03-26T17:12:29Z"
      },
      "message": "Add Poly1305 implementation",
      "tree": {
        "sha": "9c12ca2dbbee4b234ece52ee748ef4434735bf68",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9c12ca2dbbee4b234ece52ee748ef4434735bf68"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/03be7f48fad10aa8da3291c28a185ed750193c7b",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyhopCNzi8TB0xizeHrd2uwPHki0FAlyaXX4ACgkQHrd2uwPH\nki3QuxAAv/ZmXv4cQiPb9L02+OBUhhYNNc/pX2qXT61nUg8/OpbSLh6BErXeihmP\nKVnpy2QzaokIQiAxaIoobnSZ+aD8JgVUtnqxclegoUT0MzboMHO+l579y4YHy+8Y\nUbOjaNJn6szxapadpO9xUkQefXNIodukUGas7Z6OXhRCL810YLUnRp+RMs1lxbHf\ncgXmP54k3vRjAw4HccOBv9Ncv75ECC4hYNv5hVwXX/osDoXWJqyFSp82bnBLAepY\n40nTmoqSDWkMwRPGLXAwVghyzL84wKnhb25TxPP4inn13xQyhs2trSIlH5rnn3QG\nbkSIE0S/bnoT6DkJUFlA5SWPkns4Tutq/wpiubVyWgm9rpliFy7kxsK0tnTuRKW1\nrZv33iT+W17ppF5qWzHSMf6HeAf9Vm7meEoyQV4Y8M5CkcpuUWoBenPJwIZBNhCR\niMQPKMnbABdltoMiPdDu8gJtKapKSMO8D65mziluVCbNURbrE/b7T+hl48EuO4WZ\nBLRaekJvj/m8rk607BsHlKZ2wDGyii+9gAVamF+q8JnNgBWf8/6I0Ufg/swSWST0\nsznJlo2zNpcjRSsl5sSOZcn990qOZ29ujllE9Uvzr2HI1uHU1MF4XbGsTxGeRdDC\nwuiX0tBpzuKy5cvB909iLQSTgxuzdCzwWRmZ3cT/SkLdq5jhJRo=\n=M5vA\n-----END PGP SIGNATURE-----",
        "payload": "tree 9c12ca2dbbee4b234ece52ee748ef4434735bf68\nparent 2d46f1be0c3c8b7287aa1f62bb1f5b4a8d00ff6e\nauthor Jonas Schnelli <dev@jonasschnelli.ch> 1551643954 +0100\ncommitter Jonas Schnelli <dev@jonasschnelli.ch> 1553620349 +0100\n\nAdd Poly1305 implementation\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/03be7f48fad10aa8da3291c28a185ed750193c7b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/03be7f48fad10aa8da3291c28a185ed750193c7b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/03be7f48fad10aa8da3291c28a185ed750193c7b/comments",
    "author": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "2d46f1be0c3c8b7287aa1f62bb1f5b4a8d00ff6e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2d46f1be0c3c8b7287aa1f62bb1f5b4a8d00ff6e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/2d46f1be0c3c8b7287aa1f62bb1f5b4a8d00ff6e"
      }
    ],
    "stats": {
      "total": 242,
      "additions": 242,
      "deletions": 0
    },
    "files": [
      {
        "sha": "b2e13fb6cb4ec0ff11c02f36b7d029cfc72e7092",
        "filename": "src/Makefile.am",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/03be7f48fad10aa8da3291c28a185ed750193c7b/src/Makefile.am",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/03be7f48fad10aa8da3291c28a185ed750193c7b/src/Makefile.am",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.am?ref=03be7f48fad10aa8da3291c28a185ed750193c7b",
        "patch": "@@ -344,6 +344,8 @@ crypto_libbitcoin_crypto_base_a_SOURCES = \\\n   crypto/hmac_sha256.h \\\n   crypto/hmac_sha512.cpp \\\n   crypto/hmac_sha512.h \\\n+  crypto/poly1305.h \\\n+  crypto/poly1305.cpp \\\n   crypto/ripemd160.cpp \\\n   crypto/ripemd160.h \\\n   crypto/sha1.cpp \\"
      },
      {
        "sha": "8a86c9601ce72d0641827479543c693625f14b18",
        "filename": "src/crypto/poly1305.cpp",
        "status": "added",
        "additions": 141,
        "deletions": 0,
        "changes": 141,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/03be7f48fad10aa8da3291c28a185ed750193c7b/src/crypto/poly1305.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/03be7f48fad10aa8da3291c28a185ed750193c7b/src/crypto/poly1305.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/crypto/poly1305.cpp?ref=03be7f48fad10aa8da3291c28a185ed750193c7b",
        "patch": "@@ -0,0 +1,141 @@\n+// Copyright (c) 2019 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+// Based on the public domain implementation by Andrew Moon\n+// poly1305-donna-unrolled.c from https://github.com/floodyberry/poly1305-donna\n+\n+#include <crypto/common.h>\n+#include <crypto/poly1305.h>\n+\n+#include <string.h>\n+\n+#define mul32x32_64(a,b) ((uint64_t)(a) * (b))\n+\n+void poly1305_auth(unsigned char out[POLY1305_TAGLEN], const unsigned char *m, size_t inlen, const unsigned char key[POLY1305_KEYLEN]) {\n+    uint32_t t0,t1,t2,t3;\n+    uint32_t h0,h1,h2,h3,h4;\n+    uint32_t r0,r1,r2,r3,r4;\n+    uint32_t s1,s2,s3,s4;\n+    uint32_t b, nb;\n+    size_t j;\n+    uint64_t t[5];\n+    uint64_t f0,f1,f2,f3;\n+    uint64_t g0,g1,g2,g3,g4;\n+    uint64_t c;\n+    unsigned char mp[16];\n+\n+    /* clamp key */\n+    t0 = ReadLE32(key+0);\n+    t1 = ReadLE32(key+4);\n+    t2 = ReadLE32(key+8);\n+    t3 = ReadLE32(key+12);\n+\n+    /* precompute multipliers */\n+    r0 = t0 & 0x3ffffff; t0 >>= 26; t0 |= t1 << 6;\n+    r1 = t0 & 0x3ffff03; t1 >>= 20; t1 |= t2 << 12;\n+    r2 = t1 & 0x3ffc0ff; t2 >>= 14; t2 |= t3 << 18;\n+    r3 = t2 & 0x3f03fff; t3 >>= 8;\n+    r4 = t3 & 0x00fffff;\n+\n+    s1 = r1 * 5;\n+    s2 = r2 * 5;\n+    s3 = r3 * 5;\n+    s4 = r4 * 5;\n+\n+    /* init state */\n+    h0 = 0;\n+    h1 = 0;\n+    h2 = 0;\n+    h3 = 0;\n+    h4 = 0;\n+\n+    /* full blocks */\n+    if (inlen < 16) goto poly1305_donna_atmost15bytes;\n+poly1305_donna_16bytes:\n+    m += 16;\n+    inlen -= 16;\n+\n+    t0 = ReadLE32(m-16);\n+    t1 = ReadLE32(m-12);\n+    t2 = ReadLE32(m-8);\n+    t3 = ReadLE32(m-4);\n+\n+    h0 += t0 & 0x3ffffff;\n+    h1 += ((((uint64_t)t1 << 32) | t0) >> 26) & 0x3ffffff;\n+    h2 += ((((uint64_t)t2 << 32) | t1) >> 20) & 0x3ffffff;\n+    h3 += ((((uint64_t)t3 << 32) | t2) >> 14) & 0x3ffffff;\n+    h4 += (t3 >> 8) | (1 << 24);\n+\n+\n+poly1305_donna_mul:\n+    t[0]  = mul32x32_64(h0,r0) + mul32x32_64(h1,s4) + mul32x32_64(h2,s3) + mul32x32_64(h3,s2) + mul32x32_64(h4,s1);\n+    t[1]  = mul32x32_64(h0,r1) + mul32x32_64(h1,r0) + mul32x32_64(h2,s4) + mul32x32_64(h3,s3) + mul32x32_64(h4,s2);\n+    t[2]  = mul32x32_64(h0,r2) + mul32x32_64(h1,r1) + mul32x32_64(h2,r0) + mul32x32_64(h3,s4) + mul32x32_64(h4,s3);\n+    t[3]  = mul32x32_64(h0,r3) + mul32x32_64(h1,r2) + mul32x32_64(h2,r1) + mul32x32_64(h3,r0) + mul32x32_64(h4,s4);\n+    t[4]  = mul32x32_64(h0,r4) + mul32x32_64(h1,r3) + mul32x32_64(h2,r2) + mul32x32_64(h3,r1) + mul32x32_64(h4,r0);\n+\n+                    h0 = (uint32_t)t[0] & 0x3ffffff; c =           (t[0] >> 26);\n+    t[1] += c;      h1 = (uint32_t)t[1] & 0x3ffffff; b = (uint32_t)(t[1] >> 26);\n+    t[2] += b;      h2 = (uint32_t)t[2] & 0x3ffffff; b = (uint32_t)(t[2] >> 26);\n+    t[3] += b;      h3 = (uint32_t)t[3] & 0x3ffffff; b = (uint32_t)(t[3] >> 26);\n+    t[4] += b;      h4 = (uint32_t)t[4] & 0x3ffffff; b = (uint32_t)(t[4] >> 26);\n+    h0 += b * 5;\n+\n+    if (inlen >= 16) goto poly1305_donna_16bytes;\n+\n+    /* final bytes */\n+poly1305_donna_atmost15bytes:\n+    if (!inlen) goto poly1305_donna_finish;\n+\n+    for (j = 0; j < inlen; j++) mp[j] = m[j];\n+    mp[j++] = 1;\n+    for (; j < 16; j++) mp[j] = 0;\n+    inlen = 0;\n+\n+    t0 = ReadLE32(mp+0);\n+    t1 = ReadLE32(mp+4);\n+    t2 = ReadLE32(mp+8);\n+    t3 = ReadLE32(mp+12);\n+\n+    h0 += t0 & 0x3ffffff;\n+    h1 += ((((uint64_t)t1 << 32) | t0) >> 26) & 0x3ffffff;\n+    h2 += ((((uint64_t)t2 << 32) | t1) >> 20) & 0x3ffffff;\n+    h3 += ((((uint64_t)t3 << 32) | t2) >> 14) & 0x3ffffff;\n+    h4 += (t3 >> 8);\n+\n+    goto poly1305_donna_mul;\n+\n+poly1305_donna_finish:\n+                 b = h0 >> 26; h0 = h0 & 0x3ffffff;\n+    h1 +=     b; b = h1 >> 26; h1 = h1 & 0x3ffffff;\n+    h2 +=     b; b = h2 >> 26; h2 = h2 & 0x3ffffff;\n+    h3 +=     b; b = h3 >> 26; h3 = h3 & 0x3ffffff;\n+    h4 +=     b; b = h4 >> 26; h4 = h4 & 0x3ffffff;\n+    h0 += b * 5; b = h0 >> 26; h0 = h0 & 0x3ffffff;\n+    h1 +=     b;\n+\n+    g0 = h0 + 5; b = g0 >> 26; g0 &= 0x3ffffff;\n+    g1 = h1 + b; b = g1 >> 26; g1 &= 0x3ffffff;\n+    g2 = h2 + b; b = g2 >> 26; g2 &= 0x3ffffff;\n+    g3 = h3 + b; b = g3 >> 26; g3 &= 0x3ffffff;\n+    g4 = h4 + b - (1 << 26);\n+\n+    b = (g4 >> 31) - 1;\n+    nb = ~b;\n+    h0 = (h0 & nb) | (g0 & b);\n+    h1 = (h1 & nb) | (g1 & b);\n+    h2 = (h2 & nb) | (g2 & b);\n+    h3 = (h3 & nb) | (g3 & b);\n+    h4 = (h4 & nb) | (g4 & b);\n+\n+    f0 = ((h0      ) | (h1 << 26)) + (uint64_t)ReadLE32(&key[16]);\n+    f1 = ((h1 >>  6) | (h2 << 20)) + (uint64_t)ReadLE32(&key[20]);\n+    f2 = ((h2 >> 12) | (h3 << 14)) + (uint64_t)ReadLE32(&key[24]);\n+    f3 = ((h3 >> 18) | (h4 <<  8)) + (uint64_t)ReadLE32(&key[28]);\n+\n+    WriteLE32(&out[ 0], f0); f1 += (f0 >> 32);\n+    WriteLE32(&out[ 4], f1); f2 += (f1 >> 32);\n+    WriteLE32(&out[ 8], f2); f3 += (f2 >> 32);\n+    WriteLE32(&out[12], f3);\n+}"
      },
      {
        "sha": "1598b013b9668c0f4490d30f71e948930e72173b",
        "filename": "src/crypto/poly1305.h",
        "status": "added",
        "additions": 17,
        "deletions": 0,
        "changes": 17,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/03be7f48fad10aa8da3291c28a185ed750193c7b/src/crypto/poly1305.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/03be7f48fad10aa8da3291c28a185ed750193c7b/src/crypto/poly1305.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/crypto/poly1305.h?ref=03be7f48fad10aa8da3291c28a185ed750193c7b",
        "patch": "@@ -0,0 +1,17 @@\n+// Copyright (c) 2019 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_CRYPTO_POLY1305_H\n+#define BITCOIN_CRYPTO_POLY1305_H\n+\n+#include <stdint.h>\n+#include <stdlib.h>\n+\n+#define POLY1305_KEYLEN 32\n+#define POLY1305_TAGLEN 16\n+\n+void poly1305_auth(unsigned char out[POLY1305_TAGLEN], const unsigned char *m, size_t inlen,\n+    const unsigned char key[POLY1305_KEYLEN]);\n+\n+#endif // BITCOIN_CRYPTO_POLY1305_H"
      },
      {
        "sha": "352cff37d1f7ecbe6fae89373c053aa497fb6450",
        "filename": "src/test/crypto_tests.cpp",
        "status": "modified",
        "additions": 82,
        "deletions": 0,
        "changes": 82,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/03be7f48fad10aa8da3291c28a185ed750193c7b/src/test/crypto_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/03be7f48fad10aa8da3291c28a185ed750193c7b/src/test/crypto_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/crypto_tests.cpp?ref=03be7f48fad10aa8da3291c28a185ed750193c7b",
        "patch": "@@ -4,6 +4,7 @@\n \n #include <crypto/aes.h>\n #include <crypto/chacha20.h>\n+#include <crypto/poly1305.h>\n #include <crypto/ripemd160.h>\n #include <crypto/sha1.h>\n #include <crypto/sha256.h>\n@@ -200,6 +201,17 @@ static void TestChaCha20(const std::string &hexkey, uint64_t nonce, uint64_t see\n     BOOST_CHECK(out == outres);\n }\n \n+static void TestPoly1305(const std::string &hexmessage, const std::string &hexkey, const std::string& hextag)\n+{\n+    std::vector<unsigned char> key = ParseHex(hexkey);\n+    std::vector<unsigned char> m = ParseHex(hexmessage);\n+    std::vector<unsigned char> tag = ParseHex(hextag);\n+    std::vector<unsigned char> tagres;\n+    tagres.resize(POLY1305_TAGLEN);\n+    poly1305_auth(tagres.data(), m.data(), m.size(), key.data());\n+    BOOST_CHECK(tag == tagres);\n+}\n+\n static std::string LongTestString() {\n     std::string ret;\n     for (int i=0; i<200000; i++) {\n@@ -524,6 +536,76 @@ BOOST_AUTO_TEST_CASE(chacha20_testvector)\n                  \"fab78c9\");\n }\n \n+BOOST_AUTO_TEST_CASE(poly1305_testvector)\n+{\n+    // RFC 7539, section 2.5.2.\n+    TestPoly1305(\"43727970746f6772617068696320466f72756d2052657365617263682047726f7570\",\n+                 \"85d6be7857556d337f4452fe42d506a80103808afb0db2fd4abff6af4149f51b\",\n+                 \"a8061dc1305136c6c22b8baf0c0127a9\");\n+\n+    // RFC 7539, section A.3.\n+    TestPoly1305(\"00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\"\n+                 \"000000000000000000000000000\",\n+                 \"0000000000000000000000000000000000000000000000000000000000000000\",\n+                 \"00000000000000000000000000000000\");\n+\n+    TestPoly1305(\"416e79207375626d697373696f6e20746f20746865204945544620696e74656e6465642062792074686520436f6e747269627\"\n+                 \"5746f7220666f72207075626c69636174696f6e20617320616c6c206f722070617274206f6620616e204945544620496e7465\"\n+                 \"726e65742d4472616674206f722052464320616e6420616e792073746174656d656e74206d6164652077697468696e2074686\"\n+                 \"520636f6e74657874206f6620616e204945544620616374697669747920697320636f6e7369646572656420616e2022494554\"\n+                 \"4620436f6e747269627574696f6e222e20537563682073746174656d656e747320696e636c756465206f72616c20737461746\"\n+                 \"56d656e747320696e20494554462073657373696f6e732c2061732077656c6c206173207772697474656e20616e6420656c65\"\n+                 \"6374726f6e696320636f6d6d756e69636174696f6e73206d61646520617420616e792074696d65206f7220706c6163652c207\"\n+                 \"768696368206172652061646472657373656420746f\",\n+                 \"0000000000000000000000000000000036e5f6b5c5e06070f0efca96227a863e\",\n+                 \"36e5f6b5c5e06070f0efca96227a863e\");\n+\n+    TestPoly1305(\"416e79207375626d697373696f6e20746f20746865204945544620696e74656e6465642062792074686520436f6e747269627\"\n+                 \"5746f7220666f72207075626c69636174696f6e20617320616c6c206f722070617274206f6620616e204945544620496e7465\"\n+                 \"726e65742d4472616674206f722052464320616e6420616e792073746174656d656e74206d6164652077697468696e2074686\"\n+                 \"520636f6e74657874206f6620616e204945544620616374697669747920697320636f6e7369646572656420616e2022494554\"\n+                 \"4620436f6e747269627574696f6e222e20537563682073746174656d656e747320696e636c756465206f72616c20737461746\"\n+                 \"56d656e747320696e20494554462073657373696f6e732c2061732077656c6c206173207772697474656e20616e6420656c65\"\n+                 \"6374726f6e696320636f6d6d756e69636174696f6e73206d61646520617420616e792074696d65206f7220706c6163652c207\"\n+                 \"768696368206172652061646472657373656420746f\",\n+                 \"36e5f6b5c5e06070f0efca96227a863e00000000000000000000000000000000\",\n+                 \"f3477e7cd95417af89a6b8794c310cf0\");\n+\n+    TestPoly1305(\"2754776173206272696c6c69672c20616e642074686520736c6974687920746f7665730a446964206779726520616e6420676\"\n+                 \"96d626c6520696e2074686520776162653a0a416c6c206d696d737920776572652074686520626f726f676f7665732c0a416e\"\n+                 \"6420746865206d6f6d65207261746873206f757467726162652e\",\n+                 \"1c9240a5eb55d38af333888604f6b5f0473917c1402b80099dca5cbc207075c0\",\n+                 \"4541669a7eaaee61e708dc7cbcc5eb62\");\n+\n+    TestPoly1305(\"ffffffffffffffffffffffffffffffff\",\n+                 \"0200000000000000000000000000000000000000000000000000000000000000\",\n+                 \"03000000000000000000000000000000\");\n+\n+    TestPoly1305(\"02000000000000000000000000000000\",\n+                 \"02000000000000000000000000000000ffffffffffffffffffffffffffffffff\",\n+                 \"03000000000000000000000000000000\");\n+\n+    TestPoly1305(\"fffffffffffffffffffffffffffffffff0ffffffffffffffffffffffffffffff11000000000000000000000000000000\",\n+                 \"0100000000000000000000000000000000000000000000000000000000000000\",\n+                 \"05000000000000000000000000000000\");\n+\n+    TestPoly1305(\"fffffffffffffffffffffffffffffffffbfefefefefefefefefefefefefefefe01010101010101010101010101010101\",\n+                 \"0100000000000000000000000000000000000000000000000000000000000000\",\n+                 \"00000000000000000000000000000000\");\n+\n+    TestPoly1305(\"fdffffffffffffffffffffffffffffff\",\n+                 \"0200000000000000000000000000000000000000000000000000000000000000\",\n+                 \"faffffffffffffffffffffffffffffff\");\n+\n+    TestPoly1305(\"e33594d7505e43b900000000000000003394d7505e4379cd01000000000000000000000000000000000000000000000001000000000000000000000000000000\",\n+                 \"0100000000000000040000000000000000000000000000000000000000000000\",\n+                 \"14000000000000005500000000000000\");\n+\n+    TestPoly1305(\"e33594d7505e43b900000000000000003394d7505e4379cd010000000000000000000000000000000000000000000000\",\n+                 \"0100000000000000040000000000000000000000000000000000000000000000\",\n+                 \"13000000000000000000000000000000\");\n+}\n+\n BOOST_AUTO_TEST_CASE(countbits_tests)\n {\n     FastRandomContext ctx;"
      }
    ]
  },
  {
    "sha": "b34bf302f26c7cede47cc20b3bdfb613c51ab67e",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiMzRiZjMwMmYyNmM3Y2VkZTQ3Y2MyMGIzYmRmYjYxM2M1MWFiNjdl",
    "commit": {
      "author": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2019-03-05T10:00:14Z"
      },
      "committer": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2019-03-26T17:12:31Z"
      },
      "message": "Add Poly1305 bench",
      "tree": {
        "sha": "a27132f3510cf987fee3bcb74d7e1fe7c33de42e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a27132f3510cf987fee3bcb74d7e1fe7c33de42e"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b34bf302f26c7cede47cc20b3bdfb613c51ab67e",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyhopCNzi8TB0xizeHrd2uwPHki0FAlyaXX8ACgkQHrd2uwPH\nki0zhw/+JNZNy5SCim0745jsLTJU9/x6u1rb/3DNqLXohqwrkwe3hD02bLFJPQHH\nWHgMsuyD9tD54kV27YyMQHwWYsN/45qWsE3s2JZs8neHlHVEfNpRjkgIYgyKfamv\nqMR/TqJ/x7VydUaftYSSWKtuqgDOOR921PWlG76fWQQP4ZNciswUXw4LNZcnPSC5\n/wjKqxhHAK49qkdzE8yCpCyuP1sHM1SQzFGpYtwQ8TGEzhzTjOmp7aCjBp6FCNDk\nrxSc0J2YXLAAgq7lRhhPQFacozREEwNLWm3KdzQyMaq/hJoo6I81Clke2KVtxguW\ng+7pI6rI5VS2qXOPj6INQEIgJLFUBzOfLUSK+2WZCRnviwHdJ8RFiJJzc/ggTypQ\nHIRHHfUd6eAnWUZqTtBlQbDzEjjqyjIq/xtoH96v2E0KnoVOM9y6HIp57So7Na8p\n2MQvr8PdIbA5LFziCYOcOsMSp0nJkl7Irczn9Sv1EzfYMOHtGH/GOGC1/4h5zmYD\ngEzz5y4cDQoy4zShHFt1aer1mGZyY6QfhCdwM5iZoPLllMfZLlE+lCQsSfZr3ISo\nyjNWeN+AMT+QZTGLdxqNKlcv39GAVOutZpb8gcOmrzT+FhsAzqA6CTUa1a887ee5\nP3RsLpV4Dgw34NtU3Mo2+mke/5FlEKuKDqzA4UVxX3Hy6VMLF+8=\n=rvTG\n-----END PGP SIGNATURE-----",
        "payload": "tree a27132f3510cf987fee3bcb74d7e1fe7c33de42e\nparent 03be7f48fad10aa8da3291c28a185ed750193c7b\nauthor Jonas Schnelli <dev@jonasschnelli.ch> 1551780014 +0100\ncommitter Jonas Schnelli <dev@jonasschnelli.ch> 1553620351 +0100\n\nAdd Poly1305 bench\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b34bf302f26c7cede47cc20b3bdfb613c51ab67e",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/b34bf302f26c7cede47cc20b3bdfb613c51ab67e",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b34bf302f26c7cede47cc20b3bdfb613c51ab67e/comments",
    "author": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "03be7f48fad10aa8da3291c28a185ed750193c7b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/03be7f48fad10aa8da3291c28a185ed750193c7b",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/03be7f48fad10aa8da3291c28a185ed750193c7b"
      }
    ],
    "stats": {
      "total": 42,
      "additions": 42,
      "deletions": 0
    },
    "files": [
      {
        "sha": "09ce4a02374dbdbb8ff0aac4572fbb0a61bc8056",
        "filename": "src/Makefile.bench.include",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b34bf302f26c7cede47cc20b3bdfb613c51ab67e/src/Makefile.bench.include",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b34bf302f26c7cede47cc20b3bdfb613c51ab67e/src/Makefile.bench.include",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.bench.include?ref=b34bf302f26c7cede47cc20b3bdfb613c51ab67e",
        "patch": "@@ -30,6 +30,7 @@ bench_bench_bitcoin_SOURCES = \\\n   bench/base58.cpp \\\n   bench/bech32.cpp \\\n   bench/lockedpool.cpp \\\n+  bench/poly1305.cpp \\\n   bench/prevector.cpp\n \n nodist_bench_bench_bitcoin_SOURCES = $(GENERATED_BENCH_FILES)"
      },
      {
        "sha": "16342d0fbe946172f20ca3a76b5d6203cb9d4d22",
        "filename": "src/bench/poly1305.cpp",
        "status": "added",
        "additions": 41,
        "deletions": 0,
        "changes": 41,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b34bf302f26c7cede47cc20b3bdfb613c51ab67e/src/bench/poly1305.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b34bf302f26c7cede47cc20b3bdfb613c51ab67e/src/bench/poly1305.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bench/poly1305.cpp?ref=b34bf302f26c7cede47cc20b3bdfb613c51ab67e",
        "patch": "@@ -0,0 +1,41 @@\n+// Copyright (c) 2019 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <iostream>\n+\n+#include <bench/bench.h>\n+#include <crypto/poly1305.h>\n+\n+/* Number of bytes to process per iteration */\n+static constexpr uint64_t BUFFER_SIZE_TINY  = 64;\n+static constexpr uint64_t BUFFER_SIZE_SMALL = 256;\n+static constexpr uint64_t BUFFER_SIZE_LARGE = 1024*1024;\n+\n+static void POLY1305(benchmark::State& state, size_t buffersize)\n+{\n+    std::vector<unsigned char> tag(POLY1305_TAGLEN, 0);\n+    std::vector<unsigned char> key(POLY1305_KEYLEN, 0);\n+    std::vector<unsigned char> in(buffersize, 0);\n+    while (state.KeepRunning())\n+        poly1305_auth(tag.data(), in.data(), in.size(), key.data());\n+}\n+\n+static void POLY1305_64BYTES(benchmark::State& state)\n+{\n+    POLY1305(state, BUFFER_SIZE_TINY);\n+}\n+\n+static void POLY1305_256BYTES(benchmark::State& state)\n+{\n+    POLY1305(state, BUFFER_SIZE_SMALL);\n+}\n+\n+static void POLY1305_1MB(benchmark::State& state)\n+{\n+    POLY1305(state, BUFFER_SIZE_LARGE);\n+}\n+\n+BENCHMARK(POLY1305_64BYTES, 500000);\n+BENCHMARK(POLY1305_256BYTES, 250000);\n+BENCHMARK(POLY1305_1MB, 340);"
      }
    ]
  },
  {
    "sha": "e9d5e975612e828ec44f9247b4c5c08f0268d360",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplOWQ1ZTk3NTYxMmU4MjhlYzQ0ZjkyNDdiNGM1YzA4ZjAyNjhkMzYw",
    "commit": {
      "author": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2019-03-05T14:45:20Z"
      },
      "committer": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2019-03-26T17:12:31Z"
      },
      "message": "Poly1305: tolerate the intentional unsigned wraparound in poly1305.cpp",
      "tree": {
        "sha": "c30d39a4d1fe18014c7b9beb19fe14f206c76ff9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c30d39a4d1fe18014c7b9beb19fe14f206c76ff9"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e9d5e975612e828ec44f9247b4c5c08f0268d360",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyhopCNzi8TB0xizeHrd2uwPHki0FAlyaXYAACgkQHrd2uwPH\nki1oDxAAmVKZHg3qNE1bCDeXsL5/wZwxeIHrwZV7zGjjC2vxK65YYrYB+dSg3E/w\nZ/ARQ1ujRZz2Rb0sO3SWpXlu+U4ylw+ybARY+uIdiAadQfEvB/TRu6pNmoEIg+0L\nKeUKsrCv6e6IUfNHV8QFhwsgfcZoYQOzcGE7mnZBGtEV+Mw4ogrBLCcxJbIi7QZY\nmJ5iCP2lLOvHtLFEfeMjflDu9cg4t9BxHXcu9fdjZBwA5R8jKN6Q3f03+52NDeE6\nO8tM5eQVso4QvqyR3N7V3vUP3MytQ0GhU/m9P6Qa6lndE3dd/O2TfxVG/pbuGCzP\n+30VN70anYaR+QhLQMwyS0WArnFAZ/KdZmwfrRiWTC6KANDZY+FMWetK+XHLIBcq\n1m+wmOf/5W6ErmBVplgoP/jOtfGVnW7ziPH4idif3xcDMA4ZlPW7SAsipqY9jLbQ\nJTxPeWqPtjzjfJlCIBg8sgNb8h44huE2Mt/hshTm1T+oHWW5RamInJH8X8aIUsxh\nG6C3MuV9qMrH5cQMWJgRTh5NYuSXCZL4rW95UFXzOrpVhQ1gEDGbJvToBlxbPfu3\n1TidiUi7IUHtRgvba2jqeypdUP9mITGIKIAu8wBXQ9WkkNsS+H5JfiO6zZEwEDcY\nGJAqlFsHH1oVhgE4mkfzFmfQQAC9u9MziW0MO/d7QoGlJdkwMnI=\n=Q0vw\n-----END PGP SIGNATURE-----",
        "payload": "tree c30d39a4d1fe18014c7b9beb19fe14f206c76ff9\nparent b34bf302f26c7cede47cc20b3bdfb613c51ab67e\nauthor Jonas Schnelli <dev@jonasschnelli.ch> 1551797120 +0100\ncommitter Jonas Schnelli <dev@jonasschnelli.ch> 1553620351 +0100\n\nPoly1305: tolerate the intentional unsigned wraparound in poly1305.cpp\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e9d5e975612e828ec44f9247b4c5c08f0268d360",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/e9d5e975612e828ec44f9247b4c5c08f0268d360",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e9d5e975612e828ec44f9247b4c5c08f0268d360/comments",
    "author": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "b34bf302f26c7cede47cc20b3bdfb613c51ab67e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b34bf302f26c7cede47cc20b3bdfb613c51ab67e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/b34bf302f26c7cede47cc20b3bdfb613c51ab67e"
      }
    ],
    "stats": {
      "total": 1,
      "additions": 1,
      "deletions": 0
    },
    "files": [
      {
        "sha": "643272de52a042dfba2fa8948e0953776f2782a5",
        "filename": "test/sanitizer_suppressions/ubsan",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e9d5e975612e828ec44f9247b4c5c08f0268d360/test/sanitizer_suppressions/ubsan",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e9d5e975612e828ec44f9247b4c5c08f0268d360/test/sanitizer_suppressions/ubsan",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/sanitizer_suppressions/ubsan?ref=e9d5e975612e828ec44f9247b4c5c08f0268d360",
        "patch": "@@ -15,6 +15,7 @@ unsigned-integer-overflow:coded_stream.h\n unsigned-integer-overflow:core_write.cpp\n unsigned-integer-overflow:crypto/chacha20.cpp\n unsigned-integer-overflow:crypto/ctaes/ctaes.c\n+unsigned-integer-overflow:crypto/poly1305.cpp\n unsigned-integer-overflow:crypto/ripemd160.cpp\n unsigned-integer-overflow:crypto/sha1.cpp\n unsigned-integer-overflow:crypto/sha256.cpp"
      }
    ]
  }
]