[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270953023",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-270953023",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 270953023,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDk1MzAyMw==",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-06T17:14:13Z",
    "updated_at": "2017-01-06T17:14:13Z",
    "author_association": "MEMBER",
    "body": "(Prefer if we don't propagate the misuse of \"SPV\" for things that don't support fraud proofs)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270953023/reactions",
      "total_count": 3,
      "+1": 2,
      "-1": 1,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271011343",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-271011343",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 271011343,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTAxMTM0Mw==",
    "user": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?u=63e5c438c242094837a9deeda775d77988b508bf&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-06T21:24:55Z",
    "updated_at": "2017-01-06T21:24:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "I kinda want to use an open lock icon instead of the likely meaningless to uses SPV in any case. \r\n\r\nWe also should do something about the confirmed counts in this mode. I'm not sure what. The issue is that confirmations mean less when you're not validating.  Perhaps displaying transactions like they are unconfirmed until they have 6 blocks might be the thing to do. Or displaying a visible \"not-verified\" on any transaction with the not validated flag. ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271011343/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271040132",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-271040132",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 271040132,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTA0MDEzMg==",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-06T23:42:05Z",
    "updated_at": "2017-01-06T23:42:05Z",
    "author_association": "MEMBER",
    "body": "Indeed, I would assume any mode like this shouldn't count confirmation at all.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271040132/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271063561",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-271063561",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 271063561,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTA2MzU2MQ==",
    "user": {
      "login": "dabura667",
      "id": 6586275,
      "node_id": "MDQ6VXNlcjY1ODYyNzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6586275?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dabura667",
      "html_url": "https://github.com/dabura667",
      "followers_url": "https://api.github.com/users/dabura667/followers",
      "following_url": "https://api.github.com/users/dabura667/following{/other_user}",
      "gists_url": "https://api.github.com/users/dabura667/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dabura667/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dabura667/subscriptions",
      "organizations_url": "https://api.github.com/users/dabura667/orgs",
      "repos_url": "https://api.github.com/users/dabura667/repos",
      "events_url": "https://api.github.com/users/dabura667/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dabura667/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-07T05:05:56Z",
    "updated_at": "2017-01-07T05:05:56Z",
    "author_association": "NONE",
    "body": "How about a flag for showing confirmations during SPV mode? Default to off.\r\n\r\nPeople who understand the implications and just don't want to bother having to search their address on an explorer can enable in the menu / config",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271063561/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271065224",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-271065224",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 271065224,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTA2NTIyNA==",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-07T05:52:12Z",
    "updated_at": "2017-01-07T05:52:12Z",
    "author_association": "MEMBER",
    "body": "@dabura667 Is it sufficient to simply show it in the transaction details dialog, perhaps?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271065224/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271072461",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-271072461",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 271072461,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTA3MjQ2MQ==",
    "user": {
      "login": "dabura667",
      "id": 6586275,
      "node_id": "MDQ6VXNlcjY1ODYyNzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6586275?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dabura667",
      "html_url": "https://github.com/dabura667",
      "followers_url": "https://api.github.com/users/dabura667/followers",
      "following_url": "https://api.github.com/users/dabura667/following{/other_user}",
      "gists_url": "https://api.github.com/users/dabura667/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dabura667/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dabura667/subscriptions",
      "organizations_url": "https://api.github.com/users/dabura667/orgs",
      "repos_url": "https://api.github.com/users/dabura667/repos",
      "events_url": "https://api.github.com/users/dabura667/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dabura667/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-07T09:13:34Z",
    "updated_at": "2017-01-07T09:13:34Z",
    "author_association": "NONE",
    "body": "@luke-jr I would think so, yes.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271072461/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271170997",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-271170997",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 271170997,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTE3MDk5Nw==",
    "user": {
      "login": "molxyz",
      "id": 21127776,
      "node_id": "MDQ6VXNlcjIxMTI3Nzc2",
      "avatar_url": "https://avatars.githubusercontent.com/u/21127776?u=9f4cf9bb976b087c4d9d813e8d638bcf255549c6&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/molxyz",
      "html_url": "https://github.com/molxyz",
      "followers_url": "https://api.github.com/users/molxyz/followers",
      "following_url": "https://api.github.com/users/molxyz/following{/other_user}",
      "gists_url": "https://api.github.com/users/molxyz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/molxyz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/molxyz/subscriptions",
      "organizations_url": "https://api.github.com/users/molxyz/orgs",
      "repos_url": "https://api.github.com/users/molxyz/repos",
      "events_url": "https://api.github.com/users/molxyz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/molxyz/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-08T18:58:01Z",
    "updated_at": "2017-01-08T18:58:01Z",
    "author_association": "NONE",
    "body": "On transactions screen, fully-confirmed receiving txs show only one confirmation, and fully-confirmed sending txs show \"unconfirmed\" with question marks.  \r\n![spv-txscreen](https://cloud.githubusercontent.com/assets/21127776/21752655/6e4431e0-d5aa-11e6-9493-141437b40085.png)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271170997/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271174040",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-271174040",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 271174040,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTE3NDA0MA==",
    "user": {
      "login": "diegoviola",
      "id": 4371,
      "node_id": "MDQ6VXNlcjQzNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4371?u=868a5c3352444a70d6684e8636164c1ce5ab6e8a&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/diegoviola",
      "html_url": "https://github.com/diegoviola",
      "followers_url": "https://api.github.com/users/diegoviola/followers",
      "following_url": "https://api.github.com/users/diegoviola/following{/other_user}",
      "gists_url": "https://api.github.com/users/diegoviola/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/diegoviola/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/diegoviola/subscriptions",
      "organizations_url": "https://api.github.com/users/diegoviola/orgs",
      "repos_url": "https://api.github.com/users/diegoviola/repos",
      "events_url": "https://api.github.com/users/diegoviola/events{/privacy}",
      "received_events_url": "https://api.github.com/users/diegoviola/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-08T19:45:06Z",
    "updated_at": "2017-01-08T19:45:06Z",
    "author_association": "CONTRIBUTOR",
    "body": "@molxyz I've also noticed the same thing, confirmations in Transactions list don't update, unless I restart Core.\r\n\r\nOther than that it works great.\r\n\r\nI used this for testing: `./bitcoin-qt -spv=1 -autorequestblocks=0 -testnet`.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271174040/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271181374",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-271181374",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 271181374,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTE4MTM3NA==",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?u=eab5d0cdbb6cc25087cb61d4ca4a6f85255f42a7&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-08T21:35:41Z",
    "updated_at": "2017-01-08T21:35:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for reporting. This seems to be a UI update issue. Will fix it in the next overhaul / PR update.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271181374/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274171231",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-274171231",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 274171231,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NDE3MTIzMQ==",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-20T20:25:46Z",
    "updated_at": "2017-01-20T20:25:46Z",
    "author_association": "MEMBER",
    "body": "Thought: Can this be made to work with external wallets/software?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274171231/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274250613",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-274250613",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 274250613,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NDI1MDYxMw==",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?u=eab5d0cdbb6cc25087cb61d4ca4a6f85255f42a7&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-21T09:29:32Z",
    "updated_at": "2017-01-21T09:29:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Thought: Can this be made to work with external wallets/software?\r\n\r\nI don't know what you mean by this.\r\nCan you make an use-case example?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274250613/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274812696",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-274812696",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 274812696,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NDgxMjY5Ng==",
    "user": {
      "login": "jtimon",
      "id": 1008458,
      "node_id": "MDQ6VXNlcjEwMDg0NTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1008458?u=636a89c913ac407f52bb8d57c4fff384b98f421f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtimon",
      "html_url": "https://github.com/jtimon",
      "followers_url": "https://api.github.com/users/jtimon/followers",
      "following_url": "https://api.github.com/users/jtimon/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtimon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtimon/subscriptions",
      "organizations_url": "https://api.github.com/users/jtimon/orgs",
      "repos_url": "https://api.github.com/users/jtimon/repos",
      "events_url": "https://api.github.com/users/jtimon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtimon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-24T14:12:47Z",
    "updated_at": "2017-01-24T14:12:47Z",
    "author_association": "MEMBER",
    "body": "Needs rebase.\r\nConcept ACK\r\n\r\nWhat happens with -autorequestblocks=0 -spv=0?\r\nI assume both -spv and -autorequestblocks are 1 by default. With -spv=0 -autorequestblocks=1 you would get what you have today, but is it really so useful compared to -spv=1 -autorequestblocks=1 ?\r\n\r\nI don't know it seems overly complicated. I thought we would just have a single param spvonly that defaults to 0 (equivalent to this autorequestblocks, and your spv is always =1, ie spvonly=0 equivalent to -spv=1 -autorequestblocks=1, spvonly=1 equivalent to -spv=1 -autorequestblocks=0). Not sure, just thinking out loud.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274812696/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274830852",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-274830852",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 274830852,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NDgzMDg1Mg==",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?u=eab5d0cdbb6cc25087cb61d4ca4a6f85255f42a7&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-24T15:10:14Z",
    "updated_at": "2017-01-24T15:10:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased.\r\n\r\n> What happens with -autorequestblocks=0 -spv=0?\r\n\r\nThis would result in a mode where no blocks are automatically requested (only headers are fetched).\r\n`autorequestblocks=0` is a debug option and I could imagine some interesting use-cases where you only want to fetch certain blocks with `requestblocks` RPC call.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274830852/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274924573",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-274924573",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 274924573,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NDkyNDU3Mw==",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?u=eab5d0cdbb6cc25087cb61d4ca4a6f85255f42a7&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-24T20:12:44Z",
    "updated_at": "2017-01-24T20:12:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "Adapted to work with bumpfee.\r\nAdded a fix for the UI update issue reported by @molxyz and @diegoviola (https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-271170997).",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/274924573/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/278799990",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-278799990",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 278799990,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3ODc5OTk5MA==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-09T22:47:29Z",
    "updated_at": "2017-02-09T22:47:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "I reviewed all the commits and left many minor comments, but I have two broader concerns about this PR that may be worth some discussion:\r\n\r\n1) Architecture. It seems this change would be a lot simpler if it just added a `deque<const CBlockIndex*> blocksToDownloadFirst` net_processing variable that the wallet could add blocks to (through a function) and that net_processing code would process within its existing control flow (with some tweaks to `FindNextBlocksToDownload` and `ProcessNewBlock`). Aside from the simplifications this would allow, I also think this would be better because it would no longer be adding wallet code that has to be responsible for batching and orchestrating block downloads (in `CWallet::RequestSPVScan`).\r\n\r\n2) Naming and UI. The `-autorequestblocks` flag makes sense to me. The `-spv` option makes less sense to me and I think it would be better off called something like `-priorityrequestblocks`. Renaming `-spv` to `-priorityrequestblocks` would give a more coherent set of options:\r\n\r\n```\r\n-priorityrequestblocks\r\n\r\n       Prioritized block request. If enabled, full IBD/sync-up will be delayed\r\n       until complete blockchain headers and the contents of blocks newer than\r\n       the oldest wallet key have been downloaded. Any wallet transactions that\r\n       are picked up in the prioritized blocks will show up as non-validated until\r\n       the full IBD/sync completes. (default: 0)\r\n\r\n-autorequestblocks\r\n\r\n       Automatic block request. If disabled, no blocks will be requested in\r\n       IBD/sync-up, and only previously downloaded blocks, and blocks \r\n       requested through the `requestblocks` RPC or `-priorityrequestblocks`\r\n       option will be available. (default: 1)\r\n```\r\n\r\nSimilarly, I don't think it makes sense to have a so-called \"SPV mode\" in the wallet that just reflects the `-priorityrequestblocks` setting while ignoring the `-autorequestblocks` setting. Certainly if there are non-validated transactions in the wallet, they should clearly show up as non-validated. And if the wallet transaction history in the wallet is incomplete, this should clearly be indicated (as discussed in #9409). But beyond these two things, I don't understand what the wallet \"SPV mode\" is supposed to indicate. Why would it be helpful to me to know that my wallet is in SPV mode if I don't actually have any nonvalidated transactions? Why would it helpful be to me to know my wallet is not in SPV mode if I do have nonvalidated transactions?\r\n\r\nIf changing the wallet SPV mode toggled the `-autorequestblocks` behavior, having the mode would begin to make a certain amount of sense, though it also seems it like it would be overselling the SPV feature when the wallet will still be downloading and storing the complete contents of all blocks after a point.\r\n\r\nApart from externally visible names, naming in the code should definitely be made more consistent. If there was a global search and replace in this PR to change all occurrences of \"nonvalidation,\" \"nvs,\" \"headers only,\" \"spv,\" \"hybrid,\" and \"auxilliary\" with just \"nonvalidated\" it would help a lot with readability, because the seemingly random choices of names make the implementation seem more haphazard than it needs to be.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/278799990/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/279077608",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-279077608",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 279077608,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3OTA3NzYwOA==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-10T21:58:29Z",
    "updated_at": "2017-02-10T21:58:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "To summarize my feedback above, here's what I think ideally would be next steps for this PR:\r\n\r\n- [ ] Get rid of the `CAuxiliaryBlockRequest` class and integrate prioritized block download logic directly into `net_processing.cpp` so more code responsible for regular and prioritized block downloads can be shared, and the wallet will not have to be involved in batching and sequencing p2p requests.\r\n- [ ] Search and replace for occurrences of \"nonvalidation,\" \"nvs,\" \"headers only,\" \"spv,\" \"hybrid,\" and \"auxiliary\" in new code and just say \"nonvalidated\" in all the places it makes sense.\r\n- [ ] Change this PR title from \"_Complete hybrid full block SPV mode_\" to something more descriptive and literal like \"_Support nonvalidated transactions in wallet to increase usability during IBD_\".\r\n- [ ] Rename the `-spv` flag to `-priorityrequestblocks` or similar to be consistent with `-autorequestblocks`\r\n- [ ] Instead of labeling nonvalidated transactions in the wallet as \"SPV\", label them as \"nonvalidated.\"\r\n- [ ] Either remove the wallet SPV mode display and toggle until more SPV features are implemented, or extend the SPV mode to toggle both `-priorityrequestblocks` and `-autorequestblocks` settings. Having the SPV mode toggle only the `-priorityrequestblocks` setting while leaving `-autorequestblocks` set to 1 would be adding a limited feature that's confusing and useless as soon as the initial sync finishes.\r\n- [ ] Consider defaulting the `-priorityrequestblocks` flag to true instead of false. There should be few drawbacks if the wallet transactions are clearly labeled as nonvalidated and the wallet can be usable before the IBD completes.\r\n- [ ] Merge this PR with all the great features it adds. Then follow up with more options for reducing disk and network usage and bring the wallet SPV mode toggle to provide an easy way of enabling them.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/279077608/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/314397959",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-314397959",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 314397959,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxNDM5Nzk1OQ==",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?u=eab5d0cdbb6cc25087cb61d4ca4a6f85255f42a7&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-07-11T10:07:42Z",
    "updated_at": "2017-07-11T10:07:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ryanofsky: Thanks for your review and sorry for the late response.\r\n\r\n* About the idea of getting rid of `CAuxiliaryBlockRequest`:\r\nI think keeping it in a separate file/class allows simpler rebases. I expect to rebase that PR a lot. Also, clustering to much into net_processing would result against in a moster-class/Impl.-file that does everything net related. I think in terms of architecture, splitting of stuff into separate classes/files makes sense. \r\n\r\n* SPV versus non-validating mode:\r\nI haven't really found the ideal term. A first sight, SPV seems to miss the point (if we assume SPV = bloom filter, though I disagree here), but is does allow everybody quickly understand what this PR does. If we look at Satoshi's white paper \"Simplified Payment Verification\" (chapter 8) then I guess this is more or less what this PR is about. That's why I haven't given up on calling it SPV.\r\nClient-mode seems wrong-ish to me, because no \"server\" is involved.\r\nNon-validating mode seems to nail it, but it implies we validate nothing (we still validate headers/PoW) and therefore gives it a negative general direction. Ideally the term should not include what we not do (`non`) and should be formed in a positive way.\r\n\r\nAny objections calling this SPV mode?\r\nAlso, very likely, this mode will once have client side filtering.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/314397959/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/314514909",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-314514909",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 314514909,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxNDUxNDkwOQ==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-07-11T17:26:20Z",
    "updated_at": "2017-07-11T17:26:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "> About the idea of getting rid of CAuxiliaryBlockRequest\r\n\r\nSee https://github.com/bitcoin/bitcoin/pull/10794#issuecomment-314508746\r\n\r\n> Any objections calling this SPV mode?\r\n\r\nI don't like it, but I wouldn't object to a useful feature because it has a confusing name, and my complaints above are more about naming inconsistency than about this name in particular. Also, I wish you would respond to my some of my suggestions in detail. I wasn't suggesting renaming \"SPV mode\" to \"non-validating mode\" or to \"client-mode\" (I don't even know where \"client-mode\" comes from). I suggested renaming the `-spv` flag to `-priorityrequestblocks`, to be consistent with `-autorequestblocks` flag, and because the point of the feature is to be smarter about the order blocks are downloaded.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/314514909/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/314516404",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-314516404",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 314516404,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxNDUxNjQwNA==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-07-11T17:31:29Z",
    "updated_at": "2017-07-11T17:31:29Z",
    "author_association": "MEMBER",
    "body": "@ryanofsky In early 2011, there was an incomplete feature in the codebase called \"client mode\", which probably was intended to be some sort of SPV version. It never got finished, and was eventually removed.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/314516404/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/314517728",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-314517728",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 314517728,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxNDUxNzcyOA==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-07-11T17:36:17Z",
    "updated_at": "2017-07-11T17:36:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "That's interesting. I don't think client is a bad name either (seems pretty innocuous). I just hadn't heard it before.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/314517728/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/343682125",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-343682125",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 343682125,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzY4MjEyNQ==",
    "user": {
      "login": "nopara73",
      "id": 9156103,
      "node_id": "MDQ6VXNlcjkxNTYxMDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/9156103?u=055dc1d02e67f058091e275429c95e9429edce01&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/nopara73",
      "html_url": "https://github.com/nopara73",
      "followers_url": "https://api.github.com/users/nopara73/followers",
      "following_url": "https://api.github.com/users/nopara73/following{/other_user}",
      "gists_url": "https://api.github.com/users/nopara73/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/nopara73/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/nopara73/subscriptions",
      "organizations_url": "https://api.github.com/users/nopara73/orgs",
      "repos_url": "https://api.github.com/users/nopara73/repos",
      "events_url": "https://api.github.com/users/nopara73/events{/privacy}",
      "received_events_url": "https://api.github.com/users/nopara73/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-11T17:54:18Z",
    "updated_at": "2017-11-11T17:54:18Z",
    "author_association": "NONE",
    "body": " What would be needed to progress this issue further?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/343682125/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/343807661",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-343807661",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 343807661,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0MzgwNzY2MQ==",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?u=eab5d0cdbb6cc25087cb61d4ca4a6f85255f42a7&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-13T04:20:47Z",
    "updated_at": "2017-11-13T04:20:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "I have plans to soon re-do / overhaul the SPV work...",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/343807661/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/349790765",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-349790765",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 349790765,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0OTc5MDc2NQ==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-06T22:07:40Z",
    "updated_at": "2017-12-06T22:07:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "Instead of headersChainActive, which seems hard to get to automatically reorg to the new-best-headers-chain after a block is found to be invalid when we get the full block, you may want to take a look at https://github.com/TheBlueMatt/bitcoin/commits/2017-10-best-header-tracking which should handle most of that work for you. ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/349790765/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/350824738",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-350824738",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 350824738,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MDgyNDczOA==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-11T19:06:22Z",
    "updated_at": "2017-12-11T19:06:22Z",
    "author_association": "MEMBER",
    "body": "I'll take a look after rebase. From the description:\r\n\r\n> requests and persist all blocks that are relevant for the wallet\r\n\r\nHow does it achieve this? BIP 37? In light of #11863, would it make sense to allow dropping in some arbitrary class that figures out which blocks to request?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/350824738/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/353414933",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-353414933",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 353414933,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1MzQxNDkzMw==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-12-21T17:52:50Z",
    "updated_at": "2017-12-21T17:52:50Z",
    "author_association": "MEMBER",
    "body": "> How does it achieve this? BIP 37? \r\n\r\nNo BIP37 involved here, to retain privacy uses full-block SPV mode. The relevant blocks are only those from the birthdate of the wallet on.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/353414933/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/370882003",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-370882003",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 370882003,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MDg4MjAwMw==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-06T18:33:50Z",
    "updated_at": "2018-03-06T18:33:50Z",
    "author_association": "MEMBER",
    "body": "Sorry for the very late comment here, but I think this is introducing a lot of complexity and then building on top of it.\r\n\r\nI think a first step should be what @ryanofsky suggested above (\"Get rid of the CAuxiliaryBlockRequest class and integrate prioritized block download logic directly into net_processing.cpp so more code responsible for regular and prioritized block downloads can be shared, and the wallet will not have to be involved in batching and sequencing p2p requests.\"). This is more generally useful than just lightweight mode too; it could be used for rescanning while pruning too, for example.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/370882003/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/370884991",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-370884991",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 370884991,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MDg4NDk5MQ==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-06T18:43:41Z",
    "updated_at": "2018-03-06T18:43:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "> I think a first step should be what @ryanofsky suggested above (\"Get rid of the CAuxiliaryBlockRequest class and integrate prioritized block download logic directly into net_processing.cpp so more code responsible for regular and prioritized block downloads can be shared, and the wallet will not have to be involved in batching and sequencing p2p requests.\").\r\n\r\nThis is actually implemented in #10794. @jonasschnelli, it would probably be good to reference #10794 in the PR description, and make sure the PR description is up to date generally.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/370884991/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/375763906",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-375763906",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 375763906,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3NTc2MzkwNg==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-23T18:45:03Z",
    "updated_at": "2018-03-23T18:45:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "@TheBlueMatt pointed out at core dev that the sync implemented here sometimes can't recover from invalid blocks, and that basing this change on #12138 might fix this.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/375763906/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/394544704",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-394544704",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 394544704,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NDU0NDcwNA==",
    "user": {
      "login": "AlbertChanX",
      "id": 19488835,
      "node_id": "MDQ6VXNlcjE5NDg4ODM1",
      "avatar_url": "https://avatars.githubusercontent.com/u/19488835?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AlbertChanX",
      "html_url": "https://github.com/AlbertChanX",
      "followers_url": "https://api.github.com/users/AlbertChanX/followers",
      "following_url": "https://api.github.com/users/AlbertChanX/following{/other_user}",
      "gists_url": "https://api.github.com/users/AlbertChanX/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AlbertChanX/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AlbertChanX/subscriptions",
      "organizations_url": "https://api.github.com/users/AlbertChanX/orgs",
      "repos_url": "https://api.github.com/users/AlbertChanX/repos",
      "events_url": "https://api.github.com/users/AlbertChanX/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AlbertChanX/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-05T00:46:31Z",
    "updated_at": "2018-06-05T00:46:31Z",
    "author_association": "NONE",
    "body": "hey, how to run this version locally? thx",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/394544704/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/397579541",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-397579541",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 397579541,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5NzU3OTU0MQ==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-15T10:23:31Z",
    "updated_at": "2018-06-15T10:47:38Z",
    "author_association": "MEMBER",
    "body": "I'm also in favor of not using the word SPV in the PR description, which does not imply giving up on the term.\r\n\r\n<img width=\"1146\" alt=\"schermafbeelding 2018-06-15 om 12 14 15\" src=\"https://user-images.githubusercontent.com/10217/41463137-a4f32750-7095-11e8-891e-114c5b8fe1da.png\">\r\n\r\nCan you clarify this:\r\n\r\n> Pure full block SPV mode is possible by setting -autorequestblocks=0, in that mode, no blocks for validating the chain will be downloaded, resulting in a SPV only mode.\r\n\r\nDid you mean no blocks _older than the wallet_? If so, how do you check if the UTXO set is correct? If you don't, then maybe the flag should have a scarier name like `-partial_utxo_set`. Maybe it's better to add that option in a followup PR to improve the worst case security we have to reason about here.\r\n\r\n@ryanofsky wrote:\r\n> But beyond these two things, I don't understand what the wallet \"SPV mode\" is supposed to indicate. Why would it be helpful to me to know that my wallet is in SPV mode if I don't actually have any nonvalidated transactions? Why would it helpful be to me to know my wallet is not in SPV mode if I do have nonvalidated transactions?\r\n\r\nMy suggestion would be to show the usual IBD progress bar*, as well as mark transactions as not-fully-validated. In that case there's no need for an extra icon.\r\n\r\n* = you could go really fancy and draw a thin blue slice at the right most edge to indicate that we have a fragmented chain, using a lighter shade to indicate that it might be completely invalid.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/397579541/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/443782818",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-443782818",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 443782818,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0Mzc4MjgxOA==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-03T16:54:24Z",
    "updated_at": "2018-12-03T16:54:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--5fd3d806e98f4a0ca80977bb178665a0-->There hasn't been much activity lately and the patch still needs rebase, so I am closing this for now. Please let me know when you want to continue working on this, so the pull request can be re-opened.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/443782818/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/529640078",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-529640078",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 529640078,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyOTY0MDA3OA==",
    "user": {
      "login": "BlockMechanic",
      "id": 24528627,
      "node_id": "MDQ6VXNlcjI0NTI4NjI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/24528627?u=2bfb0f2f6fba1768b3a2abd756a00504d6a4e2c6&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BlockMechanic",
      "html_url": "https://github.com/BlockMechanic",
      "followers_url": "https://api.github.com/users/BlockMechanic/followers",
      "following_url": "https://api.github.com/users/BlockMechanic/following{/other_user}",
      "gists_url": "https://api.github.com/users/BlockMechanic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BlockMechanic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BlockMechanic/subscriptions",
      "organizations_url": "https://api.github.com/users/BlockMechanic/orgs",
      "repos_url": "https://api.github.com/users/BlockMechanic/repos",
      "events_url": "https://api.github.com/users/BlockMechanic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BlockMechanic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-09T19:56:20Z",
    "updated_at": "2019-09-09T19:56:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "Hi\r\n\r\nI've always liked the idea of the reference client ie core being available across all platforms. With my work on https://github.com/bitcoin/bitcoin/issues/16568 proving succeful for android , I'd like to request that an SPV mode be considered seriously for the next major release (0.20). I think ensuring that the core client is accesible across as many platforms (particularly mobile) is a project worth considering. ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/529640078/reactions",
      "total_count": 4,
      "+1": 4,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/538674058",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#issuecomment-538674058",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9483",
    "id": 538674058,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzODY3NDA1OA==",
    "user": {
      "login": "BlockMechanic",
      "id": 24528627,
      "node_id": "MDQ6VXNlcjI0NTI4NjI3",
      "avatar_url": "https://avatars.githubusercontent.com/u/24528627?u=2bfb0f2f6fba1768b3a2abd756a00504d6a4e2c6&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BlockMechanic",
      "html_url": "https://github.com/BlockMechanic",
      "followers_url": "https://api.github.com/users/BlockMechanic/followers",
      "following_url": "https://api.github.com/users/BlockMechanic/following{/other_user}",
      "gists_url": "https://api.github.com/users/BlockMechanic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BlockMechanic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BlockMechanic/subscriptions",
      "organizations_url": "https://api.github.com/users/BlockMechanic/orgs",
      "repos_url": "https://api.github.com/users/BlockMechanic/repos",
      "events_url": "https://api.github.com/users/BlockMechanic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BlockMechanic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-05T18:02:28Z",
    "updated_at": "2019-10-05T18:02:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "As we already sync headers , is there a reason to have a separate headers chain ?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/538674058/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/97670226",
    "pull_request_review_id": 18287308,
    "id": 97670226,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk3NjcwMjI2",
    "diff_hunk": "@@ -141,6 +141,9 @@ class CWalletDB : public CDB\n     bool WriteBestBlock(const CBlockLocator& locator);\n     bool ReadBestBlock(CBlockLocator& locator);\n \n+    bool WriteNonValidationBestBlock(const CBlockLocator& locator);\n+    bool ReadNonValidationBestBlock(CBlockLocator& locator);",
    "path": "src/wallet/walletdb.h",
    "position": 5,
    "original_position": 5,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It would be nice if you could choose one of the terms \"nonvalidation\" \"nonvalidated\" and \"nvs\" and use it consistently everywhere in the code (personally I like \"nonvalidated\"). Right now it seems like everything is named randomly and it's hard to remember what things are called.",
    "created_at": "2017-01-24T22:43:26Z",
    "updated_at": "2017-02-08T22:10:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r97670226",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/97670226"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r97670226"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/97670226/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 145,
    "original_line": 145,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/97671419",
    "pull_request_review_id": 18287308,
    "id": 97671419,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk3NjcxNDE5",
    "diff_hunk": "@@ -3085,13 +3122,16 @@ bool SendMessages(CNode* pto, CConnman& connman, std::atomic<bool>& interruptMsg\n                     }\n                     // Not in the mempool anymore? don't bother sending it.",
    "path": "src/net_processing.cpp",
    "position": 149,
    "original_position": 149,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Comment is out of date. Could you update it to mention that this now checks the wallet, and also mention why it does this (maybe it should be obvious, but the reason isn't clear to me yet).",
    "created_at": "2017-01-24T22:50:21Z",
    "updated_at": "2017-01-24T23:12:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r97671419",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/97671419"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r97671419"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/97671419/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 3123,
    "original_line": 3123,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/97672157",
    "pull_request_review_id": 18287308,
    "id": 97672157,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk3NjcyMTU3",
    "diff_hunk": "@@ -1182,6 +1212,14 @@ void CWallet::SyncTransaction(const CTransaction& tx, const CBlockIndex *pindex,\n     }\n }\n \n+void CWallet::GetNonMempoolTransaction(const uint256 &hash, CTransactionRef &txsp)",
    "path": "src/wallet/wallet.cpp",
    "position": 94,
    "original_position": 94,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Any reason not to call this `FindTransaction` like the signal which it binds to? FindTransaction definitely seems like a better name given the implementation because if this method is called, it will return a transaction whether it is in the mempool or not.",
    "created_at": "2017-01-24T22:54:59Z",
    "updated_at": "2017-02-09T21:04:30Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r97672157",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/97672157"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r97672157"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/97672157/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1215,
    "original_line": 1215,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/97672320",
    "pull_request_review_id": 18287308,
    "id": 97672320,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk3NjcyMzIw",
    "diff_hunk": "@@ -1182,6 +1212,14 @@ void CWallet::SyncTransaction(const CTransaction& tx, const CBlockIndex *pindex,\n     }\n }\n \n+void CWallet::GetNonMempoolTransaction(const uint256 &hash, CTransactionRef &txsp)\n+{\n+    map<uint256, CWalletTx>::const_iterator mi = mapWallet.find(hash);\n+    if (mi != mapWallet.end())\n+    {\n+        txsp = MakeTransactionRef(mi->second);",
    "path": "src/wallet/wallet.cpp",
    "position": 99,
    "original_position": 99,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "txsp = mi->second.tx; might be better to avoid a temporary.",
    "created_at": "2017-01-24T22:55:55Z",
    "updated_at": "2017-01-24T23:12:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r97672320",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/97672320"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r97672320"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/97672320/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1220,
    "original_line": 1220,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/97673509",
    "pull_request_review_id": 18287308,
    "id": 97673509,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk3NjczNTA5",
    "diff_hunk": "@@ -1165,11 +1175,31 @@ void CWallet::MarkConflicted(const uint256& hashBlock, const uint256& hashTx)\n     }\n }\n \n-void CWallet::SyncTransaction(const CTransaction& tx, const CBlockIndex *pindex, int posInBlock)\n+void CWallet::UpdatedBlockHeaderTip(bool fInitialDownload, const CBlockIndex *pindexNew)\n {\n     LOCK2(cs_main, cs_wallet);\n \n-    if (!AddToWalletIfInvolvingMe(tx, pindex, posInBlock, true))\n+    if (pNVSLastKnownBestHeader && !headersChainActive.Contains(pNVSLastKnownBestHeader))\n+    {\n+        const CBlockIndex *pindexFork = headersChainActive.FindFork(pNVSLastKnownBestHeader);\n+        if (headersChainActive.Tip() && headersChainActive.Tip() != pindexFork)\n+        {\n+            pNVSLastKnownBestHeader = const_cast<CBlockIndex *>(pindexFork);",
    "path": "src/wallet/wallet.cpp",
    "position": 71,
    "original_position": 71,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think you can just make pNVSLastKnownBestHeader and pNVSBestBlock into const pointers to avoid these const_casts.",
    "created_at": "2017-01-24T23:03:13Z",
    "updated_at": "2017-01-24T23:12:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r97673509",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/97673509"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r97673509"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/97673509/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1187,
    "original_line": 1187,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/97673910",
    "pull_request_review_id": 18287308,
    "id": 97673910,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk3NjczOTEw",
    "diff_hunk": "@@ -1165,11 +1175,31 @@ void CWallet::MarkConflicted(const uint256& hashBlock, const uint256& hashTx)\n     }\n }\n \n-void CWallet::SyncTransaction(const CTransaction& tx, const CBlockIndex *pindex, int posInBlock)\n+void CWallet::UpdatedBlockHeaderTip(bool fInitialDownload, const CBlockIndex *pindexNew)",
    "path": "src/wallet/wallet.cpp",
    "position": 61,
    "original_position": 61,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "fInitialDownload isn't actually used, though maybe it is worth keeping if you plan to unify with the NotifyHeaderTip signal in the future.",
    "created_at": "2017-01-24T23:05:25Z",
    "updated_at": "2017-01-24T23:12:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r97673910",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/97673910"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r97673910"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/97673910/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1178,
    "original_line": 1178,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100077677",
    "pull_request_review_id": 20771685,
    "id": 100077677,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDA3NzY3Nw==",
    "diff_hunk": "@@ -0,0 +1,55 @@\n+// Copyright (c) 2016 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_AUXILIARYBLOCKREQUEST_H\n+#define BITCOIN_AUXILIARYBLOCKREQUEST_H\n+\n+#include <atomic>\n+#include \"chain.h\"\n+#include \"consensus/consensus.h\"\n+#include \"net.h\"\n+#include <stdint.h>\n+#include <vector>\n+\n+// \"Lock free\" auxiliary block request\n+class CAuxiliaryBlockRequest : public std::enable_shared_from_this<CAuxiliaryBlockRequest> {",
    "path": "src/auxiliaryblockrequest.h",
    "position": 16,
    "original_position": 16,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "3a6364de88913b6bbf480c3ed1e17286528252ca",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think it would be better if this class didn't exist, and the logic to download and process these blocks was integrated into the normal network processing logic instead of being segregated. This could mean:\r\n\r\n- Getting rid of the new `currentBlockRequest` global variable. Instead just add a simple `deque<const CBlockIndex*> blocksToDownloadFirst` or similar variable in `net_processing.cpp` alongside related variables like `mapBlocksInFlight`.\r\n- Replacing `CAuxiliaryBlockRequest::progressCallback` with an ordinary validationinterface signal.\r\n- Moving logic currently in `CAuxiliaryBlockRequest::fillInNextBlocks` to `FindNextBlocksToDownload`. Instead of having a convoluted control flow where `FindNextBlocksToDownload` calls `fillInNextBlocks` which calls back to a `FindNextBlocksToDownload` closure just to push a few `CBlockIndex` pointers onto a vector, you could use a regular for loop to fill the vector.\r\n- Moving logic currently in `CAuxiliaryBlockRequest::processWithPossibleBlock` into `ProcessNewBlock` or into an analog of `ActivateBestChain` called by `ProcessNewBlock` that sends the needed wallet and ui notifications for unvalidated blocks in the same way that `ActivateBestChain` does for validated blocks.",
    "created_at": "2017-02-08T14:34:11Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100077677",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100077677"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100077677"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100077677/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 16,
    "original_line": 16,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100100096",
    "pull_request_review_id": 20771685,
    "id": 100100096,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDEwMDA5Ng==",
    "diff_hunk": "@@ -231,7 +232,7 @@ static const uint64_t MIN_DISK_SPACE_FOR_BLOCK_FILES = 550 * 1024 * 1024;\n  * @param[out]  fNewBlock A boolean which is set to indicate if the block was first received via this call",
    "path": "src/validation.h",
    "position": 9,
    "original_position": 9,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "3a6364de88913b6bbf480c3ed1e17286528252ca",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Doxygen comment is now out of date.",
    "created_at": "2017-02-08T16:02:01Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100100096",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100100096"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100100096"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100100096/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 232,
    "original_line": 232,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100105549",
    "pull_request_review_id": 20771685,
    "id": 100105549,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDEwNTU0OQ==",
    "diff_hunk": "@@ -3160,40 +3160,47 @@ static bool AcceptBlock(const std::shared_ptr<const CBlock>& pblock, CValidation\n     if (!AcceptBlockHeader(block, state, chainparams, &pindex))\n         return false;\n \n-    // Try to process all requested blocks that we don't have, but only\n-    // process an unrequested block if it's new and has enough work to\n-    // advance our tip, and isn't too many blocks ahead.\n-    bool fAlreadyHave = pindex->nStatus & BLOCK_HAVE_DATA;\n-    bool fHasMoreWork = (chainActive.Tip() ? pindex->nChainWork > chainActive.Tip()->nChainWork : true);\n-    // Blocks that are too out-of-order needlessly limit the effectiveness of\n-    // pruning, because pruning will not delete block files that contain any\n-    // blocks which are too close in height to the tip.  Apply this test\n-    // regardless of whether pruning is enabled; it should generally be safe to\n-    // not process unrequested blocks.\n-    bool fTooFarAhead = (pindex->nHeight > int(chainActive.Height() + MIN_BLOCKS_TO_KEEP));\n-\n-    // TODO: Decouple this function from the block download logic by removing fRequested\n-    // This requires some new chain datastructure to efficiently look up if a\n-    // block is in a chain leading to a candidate for best tip, despite not\n-    // being such a candidate itself.\n-\n-    // TODO: deal better with return value and error conditions for duplicate\n-    // and unrequested blocks.\n-    if (fAlreadyHave) return true;\n-    if (!fRequested) {  // If we didn't ask for it:\n-        if (pindex->nTx != 0) return true;  // This is a previously-processed block that was pruned\n-        if (!fHasMoreWork) return true;     // Don't process less-work chains\n-        if (fTooFarAhead) return true;      // Block height is too high\n-    }\n-    if (fNewBlock) *fNewBlock = true;\n-\n-    if (!CheckBlock(block, state, chainparams.GetConsensus(), GetAdjustedTime()) ||\n-        !ContextualCheckBlock(block, state, chainparams.GetConsensus(), pindex->pprev)) {\n-        if (state.IsInvalid() && !state.CorruptionPossible()) {\n-            pindex->nStatus |= BLOCK_FAILED_VALID;\n-            setDirtyBlockIndex.insert(pindex);\n+    // don't validate the block if we fetch it with a auxiliary CAuxiliaryBlockRequest\n+    if (onlyHeaderCheck) {\n+        LogPrint(\"net\", \"Accept specific block %s (%d)\\n\", pindex->GetBlockHash().ToString(), pindex->nHeight);\n+    }\n+    else\n+    {\n+        // Try to process all requested blocks that we don't have, but only\n+        // process an unrequested block if it's new and has enough work to\n+        // advance our tip, and isn't too many blocks ahead.\n+        bool fAlreadyHave = pindex->nStatus & BLOCK_HAVE_DATA;",
    "path": "src/validation.cpp",
    "position": 150,
    "original_position": 54,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "3a6364de88913b6bbf480c3ed1e17286528252ca",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Do you really want to skip this whole section just because blockRequest is not null? E.g. wouldn't it make sense to avoid WriteBlockToDisk below when fAlreadyHave is true like this is doing?\r\n\r\nAlso it's not clear to me whether `BLOCK_FAILED_VALID` and `setDirtyBlockIndex` below should be updated for blockRequest blocks. If you know that they should not be updated, it would be useful to have a comment explaining why.",
    "created_at": "2017-02-08T16:22:09Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100105549",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100105549"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100105549"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100105549/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 3183,
    "original_line": 3172,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100135571",
    "pull_request_review_id": 20771685,
    "id": 100135571,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDEzNTU3MQ==",
    "diff_hunk": "@@ -30,7 +30,7 @@ class PeerLogicValidation : public CValidationInterface {\n public:\n     PeerLogicValidation(CConnman* connmanIn);\n \n-    virtual void SyncTransaction(const CTransaction& tx, const CBlockIndex* pindex, int nPosInBlock);\n+    virtual void SyncTransaction(const CTransaction& tx, const CBlockIndex* pindex, int nPosInBlock, bool validated);",
    "path": "src/net_processing.h",
    "position": 19,
    "original_position": 5,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "340e363a7f229e42a02badbbb8ab26f5ed5a5215",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Why change signature of SyncTransaction when the value of the new argument can already be derived from pindex? It seems like it would make handling code clearer if the validated condition were written out there where it is actually used, instead of determined by the networking code and then passed along.",
    "created_at": "2017-02-08T18:31:03Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100135571",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100135571"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100135571"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100135571/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 40,
    "original_line": 33,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100137348",
    "pull_request_review_id": 20771685,
    "id": 100137348,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDEzNzM0OA==",
    "diff_hunk": "@@ -1413,6 +1419,98 @@ UniValue reconsiderblock(const JSONRPCRequest& request)\n     return NullUniValue;\n }\n \n+UniValue requestblocks(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() < 1 || request.params.size() > 3)\n+        throw runtime_error(\n+                            \"requestblocks (start|cancel|status) ([\\\"hash_0\\\", \\\"hash_1\\\", ...]) (<pass-internally>)\\n\"\n+                            \"\\nRequests blocks (auxiliary) by eventually downloading them.\\n\"\n+                            \"\\nDownload of the requested blocks will be priorized.\\n\"\n+                            \"\\nArguments:\\n\"\n+                            \"1. action            (string, required) the action to execute\\n\"\n+                            \"                                        start  = start a new block request (overwrite existing one)\\n\"\n+                            \"                                        cancel = stop current block request\\n\"\n+                            \"                                        status = get info about current request\\n\"\n+                            \"2. blockhashes       (array, optional) the hashes of the blocks to download\\n\"\n+                            \"3. pass-internally   (boolean, optional, default = false) If set, the transactions of the requested blocks get passed into the wallet/ZMQ/etc.\\n\"\n+                            \"\\nResult:\\n\"\n+                            \"   cancel: <true|false> (\\\"true\\\" if a blockrequest was present)\\n\"\n+                            \"   start: {\\\"overwrite\\\": <true|false>} (if the new blocksrequest has overwritten an already existign one\\n\"\n+                            \"   status: {\\n\"\n+                            \"              \\\"created\\\": <timestamp> (block request was created at this timestamp)\\n\"\n+                            \"              \\\"is_cancled\\\": <true|false> (set if blockrequest is cancled)\\n\"\n+                            \"              \\\"requested_blocks\\\": <number> (amount of requestes blocks)\\n\"\n+                            \"              \\\"loaded_blocks\\\": <number> (amount of blocks already available on disk)\\n\"\n+                            \"              \\\"processed_blocks\\\": <number> (amount of already processed blocks)\\n\"\n+                            \"           }\\n\"\n+                            \"\\nExamples:\\n\"\n+                            + HelpExampleCli(\"requestblocks\", \"\\\"'[\\\"<blockhash>\\\"]'\\\"\")\n+                            + HelpExampleRpc(\"requestblocks\", \"\\\"'[\\\"<blockhash>\\\"]'\\\"\")\n+                            );\n+\n+    if (request.params[0].get_str() == \"cancel\")\n+    {\n+        if (CAuxiliaryBlockRequest::GetCurrentRequest()) {\n+            CAuxiliaryBlockRequest::GetCurrentRequest()->cancel();\n+            return UniValue(true);\n+        }\n+        else\n+            return UniValue(false);\n+    }\n+    if (request.params[0].get_str() == \"status\")\n+    {\n+        std::shared_ptr<CAuxiliaryBlockRequest> blockRequest = CAuxiliaryBlockRequest::GetCurrentRequest();\n+        UniValue ret(UniValue::VOBJ);\n+        ret.pushKV(\"request_present\", (bool)blockRequest);\n+        if (blockRequest) {\n+            ret.pushKV(\"created\", UniValue(blockRequest->created));\n+            ret.pushKV(\"is_cancled\", UniValue(blockRequest->isCancelled()));",
    "path": "src/rpc/blockchain.cpp",
    "position": 137,
    "original_position": 90,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "df6e5b873edd4058ec197da9363708162e5f2ec6",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Maybe change \"is_cancled\" to \"cancelled\" (to be consistent with \"created\"). Spelling error is also above in rpc documentation.",
    "created_at": "2017-02-08T18:38:58Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100137348",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100137348"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100137348"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100137348/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1472,
    "original_line": 1467,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100141701",
    "pull_request_review_id": 20771685,
    "id": 100141701,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDE0MTcwMQ==",
    "diff_hunk": "@@ -1413,6 +1419,98 @@ UniValue reconsiderblock(const JSONRPCRequest& request)\n     return NullUniValue;\n }\n \n+UniValue requestblocks(const JSONRPCRequest& request)",
    "path": "src/rpc/blockchain.cpp",
    "position": 92,
    "original_position": 45,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "df6e5b873edd4058ec197da9363708162e5f2ec6",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Can you explain what the the use-cases for this api are, and also what the use cases for the cancellation and SyncTransaction-suppressing options are? It doesn't seem good that this RPC can interfere with block download in spv mode and prevent transactions from getting to the wallet, but I can't figure out if this is designed to interact this way intentionally or if it is something that should be fixed.\r\n\r\n",
    "created_at": "2017-02-08T18:58:01Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100141701",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100141701"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100141701"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100141701/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1427,
    "original_line": 1422,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100142206",
    "pull_request_review_id": 20771685,
    "id": 100142206,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDE0MjIwNg==",
    "diff_hunk": "@@ -1413,6 +1419,98 @@ UniValue reconsiderblock(const JSONRPCRequest& request)\n     return NullUniValue;\n }\n \n+UniValue requestblocks(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() < 1 || request.params.size() > 3)\n+        throw runtime_error(\n+                            \"requestblocks (start|cancel|status) ([\\\"hash_0\\\", \\\"hash_1\\\", ...]) (<pass-internally>)\\n\"\n+                            \"\\nRequests blocks (auxiliary) by eventually downloading them.\\n\"\n+                            \"\\nDownload of the requested blocks will be priorized.\\n\"\n+                            \"\\nArguments:\\n\"\n+                            \"1. action            (string, required) the action to execute\\n\"\n+                            \"                                        start  = start a new block request (overwrite existing one)\\n\"\n+                            \"                                        cancel = stop current block request\\n\"\n+                            \"                                        status = get info about current request\\n\"\n+                            \"2. blockhashes       (array, optional) the hashes of the blocks to download\\n\"\n+                            \"3. pass-internally   (boolean, optional, default = false) If set, the transactions of the requested blocks get passed into the wallet/ZMQ/etc.\\n\"\n+                            \"\\nResult:\\n\"\n+                            \"   cancel: <true|false> (\\\"true\\\" if a blockrequest was present)\\n\"\n+                            \"   start: {\\\"overwrite\\\": <true|false>} (if the new blocksrequest has overwritten an already existign one\\n\"\n+                            \"   status: {\\n\"\n+                            \"              \\\"created\\\": <timestamp> (block request was created at this timestamp)\\n\"\n+                            \"              \\\"is_cancled\\\": <true|false> (set if blockrequest is cancled)\\n\"\n+                            \"              \\\"requested_blocks\\\": <number> (amount of requestes blocks)\\n\"\n+                            \"              \\\"loaded_blocks\\\": <number> (amount of blocks already available on disk)\\n\"\n+                            \"              \\\"processed_blocks\\\": <number> (amount of already processed blocks)\\n\"\n+                            \"           }\\n\"\n+                            \"\\nExamples:\\n\"\n+                            + HelpExampleCli(\"requestblocks\", \"\\\"'[\\\"<blockhash>\\\"]'\\\"\")\n+                            + HelpExampleRpc(\"requestblocks\", \"\\\"'[\\\"<blockhash>\\\"]'\\\"\")\n+                            );\n+\n+    if (request.params[0].get_str() == \"cancel\")\n+    {\n+        if (CAuxiliaryBlockRequest::GetCurrentRequest()) {\n+            CAuxiliaryBlockRequest::GetCurrentRequest()->cancel();\n+            return UniValue(true);\n+        }\n+        else\n+            return UniValue(false);\n+    }\n+    if (request.params[0].get_str() == \"status\")\n+    {\n+        std::shared_ptr<CAuxiliaryBlockRequest> blockRequest = CAuxiliaryBlockRequest::GetCurrentRequest();\n+        UniValue ret(UniValue::VOBJ);\n+        ret.pushKV(\"request_present\", (bool)blockRequest);\n+        if (blockRequest) {\n+            ret.pushKV(\"created\", UniValue(blockRequest->created));\n+            ret.pushKV(\"is_cancled\", UniValue(blockRequest->isCancelled()));\n+            ret.pushKV(\"requested_blocks\", (int64_t)blockRequest->vBlocksToDownload.size());\n+            ret.pushKV(\"loaded_blocks\", (int)blockRequest->amountOfBlocksLoaded());\n+            ret.pushKV(\"processed_blocks\", (int64_t)blockRequest->processedUpToSize);\n+        }\n+        return ret;\n+    }\n+    if (request.params[0].get_str() == \"start\")\n+    {\n+        if (request.params.size() < 2)\n+            throw JSONRPCError(RPC_INVALID_PARAMETER, \"Missing blocks array\");\n+        UniValue hash_Uarray = request.params[1].get_array();\n+        if (!hash_Uarray.isArray())\n+            throw JSONRPCError(RPC_INVALID_PARAMETER, \"Second parameter must be an array\");\n+\n+        std::vector<const CBlockIndex*> blocksToDownload;\n+        {\n+            LOCK(cs_main); //mapBlockIndex\n+            for (UniValue strHashU : hash_Uarray.getValues())",
    "path": "src/rpc/blockchain.cpp",
    "position": 155,
    "original_position": 108,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "df6e5b873edd4058ec197da9363708162e5f2ec6",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Maybe avoid copy with const &",
    "created_at": "2017-02-08T18:59:56Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100142206",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100142206"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100142206"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100142206/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1490,
    "original_line": 1485,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100144981",
    "pull_request_review_id": 20771685,
    "id": 100144981,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDE0NDk4MQ==",
    "diff_hunk": "@@ -1433,8 +1531,8 @@ static const CRPCCommand commands[] =\n     { \"blockchain\",         \"gettxoutsetinfo\",        &gettxoutsetinfo,        true,  {} },\n     { \"blockchain\",         \"pruneblockchain\",        &pruneblockchain,        true,  {\"height\"} },\n     { \"blockchain\",         \"verifychain\",            &verifychain,            true,  {\"checklevel\",\"nblocks\"} },\n-\n     { \"blockchain\",         \"preciousblock\",          &preciousblock,          true,  {\"blockhash\"} },\n+    { \"blockchain\",         \"requestblocks\",          &requestblocks,          true,  {\"action\", \"blockhashes\", \"pass-internally\"} },",
    "path": "src/rpc/blockchain.cpp",
    "position": 217,
    "original_position": 146,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "df6e5b873edd4058ec197da9363708162e5f2ec6",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Probably should use \"pass_internally\" (underscore instead of dash) so the argument can be a valid identifier in python and other languages.",
    "created_at": "2017-02-08T19:12:29Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100144981",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100144981"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100144981"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100144981/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1564,
    "original_line": 1535,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100171010",
    "pull_request_review_id": 20771685,
    "id": 100171010,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDE3MTAxMA==",
    "diff_hunk": "@@ -1251,9 +1252,12 @@ UniValue getchaintips(const JSONRPCRequest& request)\n         } else if (block->nStatus & BLOCK_FAILED_MASK) {\n             // This block or one of its ancestors is invalid.\n             status = \"invalid\";\n-        } else if (block->nChainTx == 0) {\n+        } else if (headersChainActive.Contains(block)) {",
    "path": "src/rpc/blockchain.cpp",
    "position": 79,
    "original_position": 13,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "1687a0e5bc958bd204644f2d5ad3647ab461d65d",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Seems like it makes sense to return \"headers-only-fork\" when `block->nChainTx == 0 && !headersChainActive.Contains(block)`, but I don't see how it makes sense to return \"headers-only\" when `block->nChainTx != 0 && headersChainActive.Contains(block)` instead of valid-fork or valid-headers when those conditions apply.\r\n\r\nMaybe this should be changed to:\r\n\r\n```\r\n} else if (block->nChainTx == 0) {\r\n    // This block cannot be connected because full block data for it or one of its parents is missing.\r\n    status = headersChainActive.Contains(block) ? \"headers-only-fork\" : \"headers-only\";\r\n} ...\r\n```",
    "created_at": "2017-02-08T21:11:54Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100171010",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100171010"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100171010"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100171010/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1255,
    "original_line": 1255,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100180187",
    "pull_request_review_id": 20771685,
    "id": 100180187,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDE4MDE4Nw==",
    "diff_hunk": "@@ -1947,7 +1944,7 @@ CAmount CWallet::GetUnconfirmedBalance() const\n         for (map<uint256, CWalletTx>::const_iterator it = mapWallet.begin(); it != mapWallet.end(); ++it)\n         {\n             const CWalletTx* pcoin = &(*it).second;\n-            if (!pcoin->IsTrusted() && pcoin->GetDepthInMainChain() == 0 && pcoin->InMempool())\n+            if (!pcoin->IsTrusted() && pcoin->GetDepthInMainChain() == 0 && (!pcoin->fValidated || pcoin->InMempool()))",
    "path": "src/wallet/wallet.cpp",
    "position": 137,
    "original_position": 45,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "1cc9293bfaa9e506ee8bd9f83154ab0b905d6cab",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`!pcoin->fValidated` seems like it might be too lax a condition, because the transaction could be from an orphaned block. \r\n\r\nAnd it's unclear why this change would have any desirable effect given that `GetDepthInMainChain` is updated in this commit to search headersChainActive, so presumably any nonvalidated transaction in headersChainActive would return true for IsTrusted.",
    "created_at": "2017-02-08T21:55:45Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100180187",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100180187"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100180187"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100180187/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1971,
    "original_line": 1947,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100182392",
    "pull_request_review_id": 20771685,
    "id": 100182392,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDE4MjM5Mg==",
    "diff_hunk": "@@ -1173,7 +1173,21 @@ void CWallet::MarkConflicted(const uint256& hashBlock, const uint256& hashTx)\n \n void CWallet::UpdatedBlockHeaderTip(bool fInitialDownload, const CBlockIndex *pindexNew)\n {\n+    LOCK2(cs_main, cs_wallet);\n \n+    if (pLastKnownBestHeader != NULL)\n+    {\n+        if (!headersChainActive.Contains(pLastKnownBestHeader))\n+        {\n+            const CBlockIndex *pindexFork = headersChainActive.FindFork(pLastKnownBestHeader);\n+            if (headersChainActive.Tip() && headersChainActive.Tip() != pindexFork)\n+            {\n+                // fork detected\n+                // TODO",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 14,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "1d3011ef91ae88fce88647e7d4a3fe924ff0cb22",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Probably should just squash this commit (`Keep track of the headers chain tip to detect forks`) together with commit `Add full working SPV mode to the wallet` to avoid the code churn here.",
    "created_at": "2017-02-08T22:06:52Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100182392",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100182392"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100182392"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100182392/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1186,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100182620",
    "pull_request_review_id": 20771685,
    "id": 100182620,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDE4MjYyMA==",
    "diff_hunk": "@@ -1173,7 +1173,21 @@ void CWallet::MarkConflicted(const uint256& hashBlock, const uint256& hashTx)\n \n void CWallet::UpdatedBlockHeaderTip(bool fInitialDownload, const CBlockIndex *pindexNew)\n {\n+    LOCK2(cs_main, cs_wallet);\n \n+    if (pLastKnownBestHeader != NULL)\n+    {\n+        if (!headersChainActive.Contains(pLastKnownBestHeader))\n+        {\n+            const CBlockIndex *pindexFork = headersChainActive.FindFork(pLastKnownBestHeader);\n+            if (headersChainActive.Tip() && headersChainActive.Tip() != pindexFork)\n+            {\n+                // fork detected\n+                // TODO\n+            }\n+        }\n+    }\n+    pLastKnownBestHeader = (CBlockIndex *)pindexNew;",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 18,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "1d3011ef91ae88fce88647e7d4a3fe924ff0cb22",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Should just make pLastKnownBestHeader a pointer to const to avoid the need for this cast.",
    "created_at": "2017-02-08T22:07:55Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100182620",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100182620"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100182620"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100182620/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1190,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100183635",
    "pull_request_review_id": 20771685,
    "id": 100183635,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDE4MzYzNQ==",
    "diff_hunk": "@@ -3897,6 +3914,95 @@ bool CWallet::ParameterInteraction()\n     return true;\n }\n \n+void CWallet::RequestNonValidationScan(int64_t optional_timestamp)\n+{\n+    if (CAuxiliaryBlockRequest::GetCurrentRequest() && !CAuxiliaryBlockRequest::GetCurrentRequest()->isCompleted())",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 87,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "5585662d372ec422b45a6ae44d45c38d8c63eb82",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "There's a race condition here where GetCurrentRequest() can return null between the first and second calls.",
    "created_at": "2017-02-08T22:11:49Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100183635",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100183635"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100183635"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100183635/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3919,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100183791",
    "pull_request_review_id": 20771685,
    "id": 100183791,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDE4Mzc5MQ==",
    "diff_hunk": "@@ -3897,6 +3914,95 @@ bool CWallet::ParameterInteraction()\n     return true;\n }\n \n+void CWallet::RequestNonValidationScan(int64_t optional_timestamp)\n+{\n+    if (CAuxiliaryBlockRequest::GetCurrentRequest() && !CAuxiliaryBlockRequest::GetCurrentRequest()->isCompleted())\n+        return;\n+\n+    CBlockIndex *pIndex = NULL;\n+    CBlockIndex *chainActiveTip = NULL;\n+    int64_t oldest_key = std::numeric_limits<int64_t>::max();;",
    "path": "src/wallet/wallet.cpp",
    "position": 239,
    "original_position": 92,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "5585662d372ec422b45a6ae44d45c38d8c63eb82",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "double semicolon here, also probably should choose consistently between snake_case and camelCase for local variable names.",
    "created_at": "2017-02-08T22:12:14Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100183791",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100183791"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100183791"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100183791/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 3931,
    "original_line": 3924,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100184230",
    "pull_request_review_id": 20771685,
    "id": 100184230,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDE4NDIzMA==",
    "diff_hunk": "@@ -3897,6 +3914,95 @@ bool CWallet::ParameterInteraction()\n     return true;\n }\n \n+void CWallet::RequestNonValidationScan(int64_t optional_timestamp)\n+{\n+    if (CAuxiliaryBlockRequest::GetCurrentRequest() && !CAuxiliaryBlockRequest::GetCurrentRequest()->isCompleted())\n+        return;\n+\n+    CBlockIndex *pIndex = NULL;\n+    CBlockIndex *chainActiveTip = NULL;\n+    int64_t oldest_key = std::numeric_limits<int64_t>::max();;\n+    int nonValidationScanUpToHeight = 0;\n+    {\n+        LOCK2(cs_main, cs_wallet);\n+        if (pNVSBestBlock)\n+            nonValidationScanUpToHeight = pNVSBestBlock->nHeight;\n+        chainActiveTip = chainActive.Tip();\n+        pIndex = headersChainActive.Tip();\n+        std::map<CKeyID, int64_t> mapKeyBirth;\n+        GetKeyBirthTimes(mapKeyBirth);\n+        for (std::map<CKeyID, int64_t>::const_iterator it = mapKeyBirth.begin(); it != mapKeyBirth.end(); it++) {",
    "path": "src/wallet/wallet.cpp",
    "position": 249,
    "original_position": 102,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "5585662d372ec422b45a6ae44d45c38d8c63eb82",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Maybe for (const auto& entry : mapKeyBirth)",
    "created_at": "2017-02-08T22:13:55Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100184230",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100184230"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100184230"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100184230/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 3941,
    "original_line": 3934,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100184301",
    "pull_request_review_id": 20771685,
    "id": 100184301,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDE4NDMwMQ==",
    "diff_hunk": "@@ -3897,6 +3914,95 @@ bool CWallet::ParameterInteraction()\n     return true;\n }\n \n+void CWallet::RequestNonValidationScan(int64_t optional_timestamp)\n+{\n+    if (CAuxiliaryBlockRequest::GetCurrentRequest() && !CAuxiliaryBlockRequest::GetCurrentRequest()->isCompleted())\n+        return;\n+\n+    CBlockIndex *pIndex = NULL;\n+    CBlockIndex *chainActiveTip = NULL;\n+    int64_t oldest_key = std::numeric_limits<int64_t>::max();;\n+    int nonValidationScanUpToHeight = 0;\n+    {\n+        LOCK2(cs_main, cs_wallet);\n+        if (pNVSBestBlock)\n+            nonValidationScanUpToHeight = pNVSBestBlock->nHeight;\n+        chainActiveTip = chainActive.Tip();\n+        pIndex = headersChainActive.Tip();\n+        std::map<CKeyID, int64_t> mapKeyBirth;\n+        GetKeyBirthTimes(mapKeyBirth);\n+        for (std::map<CKeyID, int64_t>::const_iterator it = mapKeyBirth.begin(); it != mapKeyBirth.end(); it++) {\n+            if ((*it).second < oldest_key)",
    "path": "src/wallet/wallet.cpp",
    "position": 250,
    "original_position": 103,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "5585662d372ec422b45a6ae44d45c38d8c63eb82",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Maybe it->second",
    "created_at": "2017-02-08T22:14:11Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100184301",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100184301"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100184301"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100184301/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 3942,
    "original_line": 3935,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100186329",
    "pull_request_review_id": 20771685,
    "id": 100186329,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDE4NjMyOQ==",
    "diff_hunk": "@@ -3897,6 +3914,95 @@ bool CWallet::ParameterInteraction()\n     return true;\n }\n \n+void CWallet::RequestNonValidationScan(int64_t optional_timestamp)",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 85,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "5585662d372ec422b45a6ae44d45c38d8c63eb82",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Eliminate optional_timestamp argument? I don't see any calls where optional_timestamp is nonzero.",
    "created_at": "2017-02-08T22:23:46Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100186329",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100186329"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100186329"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100186329/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3917,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100186596",
    "pull_request_review_id": 20771685,
    "id": 100186596,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDE4NjU5Ng==",
    "diff_hunk": "@@ -3897,6 +3914,95 @@ bool CWallet::ParameterInteraction()\n     return true;\n }\n \n+void CWallet::RequestNonValidationScan(int64_t optional_timestamp)\n+{\n+    if (CAuxiliaryBlockRequest::GetCurrentRequest() && !CAuxiliaryBlockRequest::GetCurrentRequest()->isCompleted())\n+        return;\n+\n+    CBlockIndex *pIndex = NULL;\n+    CBlockIndex *chainActiveTip = NULL;\n+    int64_t oldest_key = std::numeric_limits<int64_t>::max();;\n+    int nonValidationScanUpToHeight = 0;\n+    {\n+        LOCK2(cs_main, cs_wallet);\n+        if (pNVSBestBlock)\n+            nonValidationScanUpToHeight = pNVSBestBlock->nHeight;\n+        chainActiveTip = chainActive.Tip();\n+        pIndex = headersChainActive.Tip();\n+        std::map<CKeyID, int64_t> mapKeyBirth;\n+        GetKeyBirthTimes(mapKeyBirth);\n+        for (std::map<CKeyID, int64_t>::const_iterator it = mapKeyBirth.begin(); it != mapKeyBirth.end(); it++) {\n+            if ((*it).second < oldest_key)\n+                oldest_key = (*it).second;\n+        }\n+    }\n+\n+    if (optional_timestamp > 0)",
    "path": "src/wallet/wallet.cpp",
    "position": 255,
    "original_position": 108,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "5585662d372ec422b45a6ae44d45c38d8c63eb82",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "As noted above, this case never seems to happen. But if it could happen, it would seem to negate all the code right above this, so maybe that code should be moved into an else.",
    "created_at": "2017-02-08T22:24:57Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100186596",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100186596"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100186596"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100186596/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 3947,
    "original_line": 3940,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100187697",
    "pull_request_review_id": 20771685,
    "id": 100187697,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDE4NzY5Nw==",
    "diff_hunk": "@@ -3897,6 +3914,95 @@ bool CWallet::ParameterInteraction()\n     return true;\n }\n \n+void CWallet::RequestNonValidationScan(int64_t optional_timestamp)\n+{\n+    if (CAuxiliaryBlockRequest::GetCurrentRequest() && !CAuxiliaryBlockRequest::GetCurrentRequest()->isCompleted())\n+        return;\n+\n+    CBlockIndex *pIndex = NULL;\n+    CBlockIndex *chainActiveTip = NULL;\n+    int64_t oldest_key = std::numeric_limits<int64_t>::max();;\n+    int nonValidationScanUpToHeight = 0;\n+    {\n+        LOCK2(cs_main, cs_wallet);\n+        if (pNVSBestBlock)\n+            nonValidationScanUpToHeight = pNVSBestBlock->nHeight;\n+        chainActiveTip = chainActive.Tip();\n+        pIndex = headersChainActive.Tip();\n+        std::map<CKeyID, int64_t> mapKeyBirth;\n+        GetKeyBirthTimes(mapKeyBirth);\n+        for (std::map<CKeyID, int64_t>::const_iterator it = mapKeyBirth.begin(); it != mapKeyBirth.end(); it++) {\n+            if ((*it).second < oldest_key)\n+                oldest_key = (*it).second;\n+        }\n+    }\n+\n+    if (optional_timestamp > 0)\n+    {\n+        oldest_key = optional_timestamp;\n+        nonValidationScanUpToHeight = 0;\n+    }\n+\n+    // find header\n+    if (!pIndex)\n+        return;\n+\n+    std::vector<const CBlockIndex*> blocksToDownload;\n+    do {\n+        if (pIndex == chainActiveTip)\n+            break;\n+\n+        // don't request blocks that are already scanned\n+        if (pIndex->nHeight <= nonValidationScanUpToHeight)\n+            break;\n+\n+        // check if block is relevant to this wallet\n+        if (pIndex->GetBlockTime() + 7200 < oldest_key)\n+            break;\n+\n+        // block is relevant, request\n+        blocksToDownload.push_back(pIndex);\n+\n+        // ensure we only request up to nMaxBlocksPerAuxiliaryRequest\n+        if (blocksToDownload.size() > nMaxBlocksPerAuxiliaryRequest)\n+            blocksToDownload.erase(blocksToDownload.begin());\n+        pIndex = pIndex->pprev;\n+    } while (pIndex->pprev);\n+\n+    // don't create empty CBlockRequests\n+    if (blocksToDownload.size() == 0)\n+        return;\n+    // reverse the blocks vector from older->newer\n+    std::reverse(blocksToDownload.begin(), blocksToDownload.end());\n+    // create an auxiliary block request\n+    std::shared_ptr<CAuxiliaryBlockRequest> auxiliaryRequest(new CAuxiliaryBlockRequest(blocksToDownload, GetAdjustedTime(), true, [this](std::shared_ptr<CAuxiliaryBlockRequest> cb_AuxiliaryBlockRequest, const CBlockIndex *pindex) -> bool {\n+\n+        LOCK2(cs_main, cs_wallet);\n+        if (pindex && (!pNVSBestBlock || pindex->nHeight > pNVSBestBlock->nHeight))\n+        {\n+            // write non validation best block\n+            pNVSBestBlock = const_cast<CBlockIndex *>(pindex);",
    "path": "src/wallet/wallet.cpp",
    "position": 299,
    "original_position": 152,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "5585662d372ec422b45a6ae44d45c38d8c63eb82",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "No need for const_cast if you just make pNVSBestBlock a const pointer.",
    "created_at": "2017-02-08T22:30:34Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100187697",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100187697"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100187697"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100187697/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 3991,
    "original_line": 3984,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100188554",
    "pull_request_review_id": 20771685,
    "id": 100188554,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDE4ODU1NA==",
    "diff_hunk": "@@ -3897,6 +3914,95 @@ bool CWallet::ParameterInteraction()\n     return true;\n }\n \n+void CWallet::RequestNonValidationScan(int64_t optional_timestamp)\n+{\n+    if (CAuxiliaryBlockRequest::GetCurrentRequest() && !CAuxiliaryBlockRequest::GetCurrentRequest()->isCompleted())\n+        return;\n+\n+    CBlockIndex *pIndex = NULL;\n+    CBlockIndex *chainActiveTip = NULL;\n+    int64_t oldest_key = std::numeric_limits<int64_t>::max();;\n+    int nonValidationScanUpToHeight = 0;\n+    {\n+        LOCK2(cs_main, cs_wallet);\n+        if (pNVSBestBlock)\n+            nonValidationScanUpToHeight = pNVSBestBlock->nHeight;\n+        chainActiveTip = chainActive.Tip();\n+        pIndex = headersChainActive.Tip();\n+        std::map<CKeyID, int64_t> mapKeyBirth;\n+        GetKeyBirthTimes(mapKeyBirth);\n+        for (std::map<CKeyID, int64_t>::const_iterator it = mapKeyBirth.begin(); it != mapKeyBirth.end(); it++) {\n+            if ((*it).second < oldest_key)\n+                oldest_key = (*it).second;\n+        }\n+    }\n+\n+    if (optional_timestamp > 0)\n+    {\n+        oldest_key = optional_timestamp;\n+        nonValidationScanUpToHeight = 0;\n+    }\n+\n+    // find header\n+    if (!pIndex)\n+        return;\n+\n+    std::vector<const CBlockIndex*> blocksToDownload;\n+    do {\n+        if (pIndex == chainActiveTip)\n+            break;\n+\n+        // don't request blocks that are already scanned\n+        if (pIndex->nHeight <= nonValidationScanUpToHeight)\n+            break;\n+\n+        // check if block is relevant to this wallet\n+        if (pIndex->GetBlockTime() + 7200 < oldest_key)\n+            break;\n+\n+        // block is relevant, request\n+        blocksToDownload.push_back(pIndex);\n+\n+        // ensure we only request up to nMaxBlocksPerAuxiliaryRequest\n+        if (blocksToDownload.size() > nMaxBlocksPerAuxiliaryRequest)\n+            blocksToDownload.erase(blocksToDownload.begin());",
    "path": "src/wallet/wallet.cpp",
    "position": 283,
    "original_position": 136,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "5585662d372ec422b45a6ae44d45c38d8c63eb82",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Could switch to from vector to deque, or treat blocksToDownload as a circular buffer and call std::rotate after the loop to avoid O(n^2) cost of erasing from the beginning of a vector in a loop.",
    "created_at": "2017-02-08T22:34:45Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100188554",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100188554"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100188554"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100188554/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 3975,
    "original_line": 3968,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100325280",
    "pull_request_review_id": 20771685,
    "id": 100325280,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDMyNTI4MA==",
    "diff_hunk": "@@ -2913,6 +2914,32 @@ UniValue bumpfee(const JSONRPCRequest& request)\n     return result;\n }\n \n+UniValue setspv(const JSONRPCRequest& request)\n+{\n+    if (!EnsureWalletIsAvailable(request.fHelp))\n+        return NullUniValue;\n+\n+    if (request.fHelp || request.params.size() > 1)",
    "path": "src/wallet/rpcwallet.cpp",
    "position": 94,
    "original_position": 17,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "3756ad373539be49dab9cac08c42f3ca35d1b2d6",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Maybe should throw if no arguments passed.",
    "created_at": "2017-02-09T15:04:46Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100325280",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100325280"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100325280"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100325280/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2932,
    "original_line": 2922,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100326127",
    "pull_request_review_id": 20771685,
    "id": 100326127,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDMyNjEyNw==",
    "diff_hunk": "@@ -2913,6 +2914,32 @@ UniValue bumpfee(const JSONRPCRequest& request)\n     return result;\n }\n \n+UniValue setspv(const JSONRPCRequest& request)\n+{\n+    if (!EnsureWalletIsAvailable(request.fHelp))\n+        return NullUniValue;\n+\n+    if (request.fHelp || request.params.size() > 1)\n+        throw runtime_error(\n+                            \"setspv (true|false)\\n\"\n+                            \"\\nEnabled or disabled full block SPV mode.\\n\"\n+                            \"\\nArguments:\\n\"\n+                            \"1. state             (boolean, optional) enables or disables the spv mode\\n\"\n+                            \"\\nResult:\\n\"\n+                            \"   status: <true|false> (\\\"true\\\" if the spv mode is enabled)\\n\"\n+                            \"\\nExamples:\\n\"\n+                            + HelpExampleCli(\"setspv\", \"\\\"true\\\"\")\n+                            + HelpExampleRpc(\"setspv\", \"\\\"true\\\"\")\n+                            );\n+\n+    if (request.params.size() == 1)\n+        pwalletMain->setSPVEnabled(request.params[0].get_bool());",
    "path": "src/wallet/rpcwallet.cpp",
    "position": 108,
    "original_position": 31,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "3756ad373539be49dab9cac08c42f3ca35d1b2d6",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Seems incongruous that unlike the setting -spv option, enabling spv via RPC does not update `fFetchBlocksWhileFetchingHeaders`",
    "created_at": "2017-02-09T15:08:05Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100326127",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100326127"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100326127"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100326127/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2946,
    "original_line": 2936,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100326881",
    "pull_request_review_id": 20771685,
    "id": 100326881,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDMyNjg4MQ==",
    "diff_hunk": "@@ -702,6 +710,21 @@ bool WalletModel::hdEnabled() const\n     return wallet->IsHDEnabled();\n }\n \n+bool WalletModel::spvEnabled() const\n+{\n+    return wallet->IsSPVEnabled();\n+}\n+\n+void WalletModel::setSpvEnabled(bool state)\n+{\n+    wallet->setSPVEnabled(state);",
    "path": "src/qt/walletmodel.cpp",
    "position": 65,
    "original_position": 40,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "e783bae27220e24e62ab7badd872b7411766623e",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Seems incongruous that unlike setting the -spv option, toggling the spv mode in the GUI does not update `fFetchBlocksWhileFetchingHeaders`.",
    "created_at": "2017-02-09T15:11:25Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100326881",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100326881"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100326881"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100326881/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 722,
    "original_line": 720,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100354856",
    "pull_request_review_id": 20771685,
    "id": 100354856,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDM1NDg1Ng==",
    "diff_hunk": "@@ -3187,7 +3188,9 @@ bool SendMessages(CNode* pto, CConnman& connman, std::atomic<bool>& interruptMsg\n         // Message: getdata (blocks)\n         //\n         vector<CInv> vGetData;\n-        if (!pto->fClient && (fFetch || !IsInitialBlockDownload()) && state.nBlocksInFlight < MAX_BLOCKS_IN_TRANSIT_PER_PEER) {\n+        if (!pto->fClient && (fFetch || !IsInitialBlockDownload()) && state.nBlocksInFlight < MAX_BLOCKS_IN_TRANSIT_PER_PEER\n+                && (fFetchBlocksWhileFetchingHeaders || (headersChainActive.Tip() && headersChainActive.Tip()->GetBlockTime() > GetAdjustedTime()-600*24))",
    "path": "src/net_processing.cpp",
    "position": 183,
    "original_position": 14,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "9c4055dc46ad8dceecf098524e4577bb71da62d7",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think it would make the logic of this PR (and the code) clearer if both `fFetchBlocksWhileFetchingHeaders` and `fAutoRequestBlocks` flags were both handled inside of `FindNextBlocksToDownload`, instead of one flag handled inside, and one outside.",
    "created_at": "2017-02-09T16:59:14Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100354856",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100354856"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100354856"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100354856/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 3192,
    "original_line": 3192,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100361215",
    "pull_request_review_id": 20771685,
    "id": 100361215,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDM2MTIxNQ==",
    "diff_hunk": "@@ -27,6 +27,9 @@ void UnregisterNodeSignals(CNodeSignals& nodeSignals);\n static const bool DEFAULT_AUTOMATIC_BLOCK_REQUESTS = true;\n extern std::atomic<bool> fAutoRequestBlocks;\n \n+static const bool DEFAULT_FETCH_BLOCKS_WHILE_FETCH_HEADERS = true;\n+extern std::atomic<bool> fFetchBlocksWhileFetchingHeaders;",
    "path": "src/net_processing.h",
    "position": null,
    "original_position": 5,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "9c4055dc46ad8dceecf098524e4577bb71da62d7",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Maybe rename `fFetchBlocksWhileFetchingHeaders` to `fRequestBlocksWhileFetchingHeaders` for consistency with `fAutoRequestBlocks`.",
    "created_at": "2017-02-09T17:24:21Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100361215",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100361215"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100361215"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100361215/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 31,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100361396",
    "pull_request_review_id": 20771685,
    "id": 100361396,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDM2MTM5Ng==",
    "diff_hunk": "@@ -3187,7 +3188,9 @@ bool SendMessages(CNode* pto, CConnman& connman, std::atomic<bool>& interruptMsg\n         // Message: getdata (blocks)\n         //\n         vector<CInv> vGetData;\n-        if (!pto->fClient && (fFetch || !IsInitialBlockDownload()) && state.nBlocksInFlight < MAX_BLOCKS_IN_TRANSIT_PER_PEER) {\n+        if (!pto->fClient && (fFetch || !IsInitialBlockDownload()) && state.nBlocksInFlight < MAX_BLOCKS_IN_TRANSIT_PER_PEER\n+                && (fFetchBlocksWhileFetchingHeaders || (headersChainActive.Tip() && headersChainActive.Tip()->GetBlockTime() > GetAdjustedTime()-600*24))",
    "path": "src/net_processing.cpp",
    "position": 183,
    "original_position": 14,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "9c4055dc46ad8dceecf098524e4577bb71da62d7",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Should 600 be 3600?",
    "created_at": "2017-02-09T17:25:04Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100361396",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100361396"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100361396"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100361396/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 3192,
    "original_line": 3192,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100392268",
    "pull_request_review_id": 20771685,
    "id": 100392268,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDM5MjI2OA==",
    "diff_hunk": "@@ -435,6 +435,7 @@ std::string HelpMessage(HelpMessageMode mode)\n         strUsage += HelpMessageOpt(\"-limitdescendantcount=<n>\", strprintf(\"Do not accept transactions if any ancestor would have <n> or more in-mempool descendants (default: %u)\", DEFAULT_DESCENDANT_LIMIT));\n         strUsage += HelpMessageOpt(\"-limitdescendantsize=<n>\", strprintf(\"Do not accept transactions if any ancestor would have more than <n> kilobytes of in-mempool descendants (default: %u).\", DEFAULT_DESCENDANT_SIZE_LIMIT));\n         strUsage += HelpMessageOpt(\"-bip9params=deployment:start:end\", \"Use given start/end times for specified BIP9 deployment (regtest-only)\");\n+        strUsage += HelpMessageOpt(\"-autorequestblocks\", strprintf(\"Automatic block request, if disabled, blocks will not be requested in IBD/sync-up (default: %u)\", DEFAULT_AUTOMATIC_BLOCK_REQUESTS));",
    "path": "src/init.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "567055e6c4894707d5bd8ea28402dbb721d24f15",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Need to update the man page, too, I believe. Maybe also worth documenting that when -autorequestblocks is disabled, it only prevents blocks downloaded as part of the normal sync. It doesn't prevent downloading of blocks newer than the oldest wallet key in the -spv syncing code.",
    "created_at": "2017-02-09T19:33:45Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100392268",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100392268"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100392268"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100392268/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 438,
    "original_line": 438,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100393126",
    "pull_request_review_id": 20771685,
    "id": 100393126,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDM5MzEyNg==",
    "diff_hunk": "@@ -507,6 +509,10 @@ void FindNextBlocksToDownload(NodeId nodeid, unsigned int count, std::vector<con\n         return;\n     }\n \n+    // don't request any other blocks if we are in non autorequest mode (usefull for non-validation mode)",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 13,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "567055e6c4894707d5bd8ea28402dbb721d24f15",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "spelling \"useful\"",
    "created_at": "2017-02-09T19:37:24Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100393126",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100393126"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100393126"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100393126/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 512,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100397625",
    "pull_request_review_id": 20771685,
    "id": 100397625,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDM5NzYyNQ==",
    "diff_hunk": "@@ -1175,19 +1178,20 @@ void CWallet::UpdatedBlockHeaderTip(bool fInitialDownload, const CBlockIndex *pi\n {\n     LOCK2(cs_main, cs_wallet);\n \n-    if (pLastKnownBestHeader != NULL)\n+    if (pNVSLastKnownBestHeader && !headersChainActive.Contains(pNVSLastKnownBestHeader))\n     {\n-        if (!headersChainActive.Contains(pLastKnownBestHeader))\n+        const CBlockIndex *pindexFork = headersChainActive.FindFork(pNVSLastKnownBestHeader);\n+        if (headersChainActive.Tip() && headersChainActive.Tip() != pindexFork)\n         {\n-            const CBlockIndex *pindexFork = headersChainActive.FindFork(pLastKnownBestHeader);\n-            if (headersChainActive.Tip() && headersChainActive.Tip() != pindexFork)\n-            {\n-                // fork detected\n-                // TODO\n-            }\n+            pNVSLastKnownBestHeader = const_cast<CBlockIndex *>(pindexFork);",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 34,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "5585662d372ec422b45a6ae44d45c38d8c63eb82",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Const casts here should not be necessary if you declare pNVSLastKnownBestHeader and pNVSLastKnownBestHeader as pointers to const CBlockIndex objects.",
    "created_at": "2017-02-09T19:57:22Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100397625",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100397625"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100397625"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100397625/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1186,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100399039",
    "pull_request_review_id": 20771685,
    "id": 100399039,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDM5OTAzOQ==",
    "diff_hunk": "@@ -1151,7 +1152,7 @@ UniValue ListReceived(const UniValue& params, bool fByAccounts)\n     {\n         const CWalletTx& wtx = (*it).second;\n \n-        if (wtx.IsCoinBase() || !CheckFinalTx(*wtx.tx))\n+        if (wtx.IsCoinBase() || !CheckFinalTx(*wtx.tx, -1, wtx.fValidated))",
    "path": "src/wallet/rpcwallet.cpp",
    "position": 40,
    "original_position": 40,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "1cc9293bfaa9e506ee8bd9f83154ab0b905d6cab",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Seems to be a bug, this should probably say `!wtx.fValidated`.\r\n\r\nThis `CheckFinalTx(*wtx.tx, -1, !wtx.fValidated)` pattern is repeated enough times that I think it would be better if it were wrapped in a method:\r\n\r\n```\r\nbool CWalletTx::CheckFinal() const {\r\n    return CheckFinalTx(*tx, -1, !fValidated);\r\n}\r\n```",
    "created_at": "2017-02-09T20:03:54Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100399039",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100399039"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100399039"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100399039/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1155,
    "original_line": 1155,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100400047",
    "pull_request_review_id": 20771685,
    "id": 100400047,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDQwMDA0Nw==",
    "diff_hunk": "@@ -3897,6 +3914,95 @@ bool CWallet::ParameterInteraction()\n     return true;\n }\n \n+void CWallet::RequestNonValidationScan(int64_t optional_timestamp)\n+{\n+    if (CAuxiliaryBlockRequest::GetCurrentRequest() && !CAuxiliaryBlockRequest::GetCurrentRequest()->isCompleted())\n+        return;\n+\n+    CBlockIndex *pIndex = NULL;\n+    CBlockIndex *chainActiveTip = NULL;\n+    int64_t oldest_key = std::numeric_limits<int64_t>::max();;\n+    int nonValidationScanUpToHeight = 0;\n+    {\n+        LOCK2(cs_main, cs_wallet);\n+        if (pNVSBestBlock)\n+            nonValidationScanUpToHeight = pNVSBestBlock->nHeight;\n+        chainActiveTip = chainActive.Tip();\n+        pIndex = headersChainActive.Tip();\n+        std::map<CKeyID, int64_t> mapKeyBirth;\n+        GetKeyBirthTimes(mapKeyBirth);\n+        for (std::map<CKeyID, int64_t>::const_iterator it = mapKeyBirth.begin(); it != mapKeyBirth.end(); it++) {\n+            if ((*it).second < oldest_key)\n+                oldest_key = (*it).second;\n+        }\n+    }\n+\n+    if (optional_timestamp > 0)\n+    {\n+        oldest_key = optional_timestamp;\n+        nonValidationScanUpToHeight = 0;\n+    }\n+\n+    // find header\n+    if (!pIndex)\n+        return;\n+\n+    std::vector<const CBlockIndex*> blocksToDownload;\n+    do {\n+        if (pIndex == chainActiveTip)\n+            break;\n+\n+        // don't request blocks that are already scanned\n+        if (pIndex->nHeight <= nonValidationScanUpToHeight)\n+            break;\n+\n+        // check if block is relevant to this wallet\n+        if (pIndex->GetBlockTime() + 7200 < oldest_key)\n+            break;\n+\n+        // block is relevant, request\n+        blocksToDownload.push_back(pIndex);\n+\n+        // ensure we only request up to nMaxBlocksPerAuxiliaryRequest\n+        if (blocksToDownload.size() > nMaxBlocksPerAuxiliaryRequest)\n+            blocksToDownload.erase(blocksToDownload.begin());\n+        pIndex = pIndex->pprev;\n+    } while (pIndex->pprev);\n+\n+    // don't create empty CBlockRequests\n+    if (blocksToDownload.size() == 0)\n+        return;\n+    // reverse the blocks vector from older->newer\n+    std::reverse(blocksToDownload.begin(), blocksToDownload.end());\n+    // create an auxiliary block request\n+    std::shared_ptr<CAuxiliaryBlockRequest> auxiliaryRequest(new CAuxiliaryBlockRequest(blocksToDownload, GetAdjustedTime(), true, [this](std::shared_ptr<CAuxiliaryBlockRequest> cb_AuxiliaryBlockRequest, const CBlockIndex *pindex) -> bool {",
    "path": "src/wallet/wallet.cpp",
    "position": 293,
    "original_position": 146,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "5585662d372ec422b45a6ae44d45c38d8c63eb82",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Maybe use make_shared.",
    "created_at": "2017-02-09T20:08:36Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100400047",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100400047"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100400047"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100400047/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 3985,
    "original_line": 3978,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100401972",
    "pull_request_review_id": 20771685,
    "id": 100401972,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDQwMTk3Mg==",
    "diff_hunk": "@@ -1413,6 +1419,98 @@ UniValue reconsiderblock(const JSONRPCRequest& request)\n     return NullUniValue;\n }\n \n+UniValue requestblocks(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() < 1 || request.params.size() > 3)\n+        throw runtime_error(\n+                            \"requestblocks (start|cancel|status) ([\\\"hash_0\\\", \\\"hash_1\\\", ...]) (<pass-internally>)\\n\"\n+                            \"\\nRequests blocks (auxiliary) by eventually downloading them.\\n\"\n+                            \"\\nDownload of the requested blocks will be priorized.\\n\"\n+                            \"\\nArguments:\\n\"\n+                            \"1. action            (string, required) the action to execute\\n\"\n+                            \"                                        start  = start a new block request (overwrite existing one)\\n\"\n+                            \"                                        cancel = stop current block request\\n\"\n+                            \"                                        status = get info about current request\\n\"\n+                            \"2. blockhashes       (array, optional) the hashes of the blocks to download\\n\"\n+                            \"3. pass-internally   (boolean, optional, default = false) If set, the transactions of the requested blocks get passed into the wallet/ZMQ/etc.\\n\"\n+                            \"\\nResult:\\n\"\n+                            \"   cancel: <true|false> (\\\"true\\\" if a blockrequest was present)\\n\"\n+                            \"   start: {\\\"overwrite\\\": <true|false>} (if the new blocksrequest has overwritten an already existign one\\n\"\n+                            \"   status: {\\n\"\n+                            \"              \\\"created\\\": <timestamp> (block request was created at this timestamp)\\n\"\n+                            \"              \\\"is_cancled\\\": <true|false> (set if blockrequest is cancled)\\n\"\n+                            \"              \\\"requested_blocks\\\": <number> (amount of requestes blocks)\\n\"\n+                            \"              \\\"loaded_blocks\\\": <number> (amount of blocks already available on disk)\\n\"\n+                            \"              \\\"processed_blocks\\\": <number> (amount of already processed blocks)\\n\"\n+                            \"           }\\n\"\n+                            \"\\nExamples:\\n\"\n+                            + HelpExampleCli(\"requestblocks\", \"\\\"'[\\\"<blockhash>\\\"]'\\\"\")\n+                            + HelpExampleRpc(\"requestblocks\", \"\\\"'[\\\"<blockhash>\\\"]'\\\"\")\n+                            );\n+\n+    if (request.params[0].get_str() == \"cancel\")\n+    {\n+        if (CAuxiliaryBlockRequest::GetCurrentRequest()) {\n+            CAuxiliaryBlockRequest::GetCurrentRequest()->cancel();\n+            return UniValue(true);\n+        }\n+        else\n+            return UniValue(false);\n+    }\n+    if (request.params[0].get_str() == \"status\")\n+    {\n+        std::shared_ptr<CAuxiliaryBlockRequest> blockRequest = CAuxiliaryBlockRequest::GetCurrentRequest();\n+        UniValue ret(UniValue::VOBJ);\n+        ret.pushKV(\"request_present\", (bool)blockRequest);\n+        if (blockRequest) {\n+            ret.pushKV(\"created\", UniValue(blockRequest->created));\n+            ret.pushKV(\"is_cancled\", UniValue(blockRequest->isCancelled()));\n+            ret.pushKV(\"requested_blocks\", (int64_t)blockRequest->vBlocksToDownload.size());\n+            ret.pushKV(\"loaded_blocks\", (int)blockRequest->amountOfBlocksLoaded());\n+            ret.pushKV(\"processed_blocks\", (int64_t)blockRequest->processedUpToSize);\n+        }\n+        return ret;\n+    }\n+    if (request.params[0].get_str() == \"start\")\n+    {\n+        if (request.params.size() < 2)\n+            throw JSONRPCError(RPC_INVALID_PARAMETER, \"Missing blocks array\");\n+        UniValue hash_Uarray = request.params[1].get_array();\n+        if (!hash_Uarray.isArray())\n+            throw JSONRPCError(RPC_INVALID_PARAMETER, \"Second parameter must be an array\");\n+\n+        std::vector<const CBlockIndex*> blocksToDownload;\n+        {\n+            LOCK(cs_main); //mapBlockIndex\n+            for (UniValue strHashU : hash_Uarray.getValues())\n+            {\n+                uint256 hash(uint256S(strHashU.get_str()));\n+                BlockMap::iterator mi = mapBlockIndex.find(hash);\n+                if (mi == mapBlockIndex.end())\n+                    throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Block not found\");\n+                blocksToDownload.push_back((*mi).second);\n+            }\n+        }\n+\n+        bool passThroughSignals = false;\n+        if (request.params.size() == 3 && request.params[2].isBool())\n+            passThroughSignals = request.params[2].get_bool();\n+\n+        std::shared_ptr<CAuxiliaryBlockRequest> blockRequest(new CAuxiliaryBlockRequest(blocksToDownload, GetAdjustedTime(), passThroughSignals, [](std::shared_ptr<CAuxiliaryBlockRequest> cb_spvRequest, const CBlockIndex *pindex) -> bool {\n+            return true;\n+        }));\n+        bool overwrite = (CAuxiliaryBlockRequest::GetCurrentRequest() != nullptr);",
    "path": "src/rpc/blockchain.cpp",
    "position": 172,
    "original_position": 125,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "df6e5b873edd4058ec197da9363708162e5f2ec6",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "There's a race condition here if the state changes between the GetCurrentRequest() and setAsCurrentRequest() calls. Could easily be avoided by having setAsCurrentRequest return the overwrite bool, or a pointer to the previous request.",
    "created_at": "2017-02-09T20:17:49Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100401972",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100401972"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100401972"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100401972/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1507,
    "original_line": 1502,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100402468",
    "pull_request_review_id": 20771685,
    "id": 100402468,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDQwMjQ2OA==",
    "diff_hunk": "@@ -1413,6 +1419,98 @@ UniValue reconsiderblock(const JSONRPCRequest& request)\n     return NullUniValue;\n }\n \n+UniValue requestblocks(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() < 1 || request.params.size() > 3)\n+        throw runtime_error(\n+                            \"requestblocks (start|cancel|status) ([\\\"hash_0\\\", \\\"hash_1\\\", ...]) (<pass-internally>)\\n\"\n+                            \"\\nRequests blocks (auxiliary) by eventually downloading them.\\n\"\n+                            \"\\nDownload of the requested blocks will be priorized.\\n\"\n+                            \"\\nArguments:\\n\"\n+                            \"1. action            (string, required) the action to execute\\n\"\n+                            \"                                        start  = start a new block request (overwrite existing one)\\n\"\n+                            \"                                        cancel = stop current block request\\n\"\n+                            \"                                        status = get info about current request\\n\"\n+                            \"2. blockhashes       (array, optional) the hashes of the blocks to download\\n\"\n+                            \"3. pass-internally   (boolean, optional, default = false) If set, the transactions of the requested blocks get passed into the wallet/ZMQ/etc.\\n\"\n+                            \"\\nResult:\\n\"\n+                            \"   cancel: <true|false> (\\\"true\\\" if a blockrequest was present)\\n\"\n+                            \"   start: {\\\"overwrite\\\": <true|false>} (if the new blocksrequest has overwritten an already existign one\\n\"\n+                            \"   status: {\\n\"\n+                            \"              \\\"created\\\": <timestamp> (block request was created at this timestamp)\\n\"\n+                            \"              \\\"is_cancled\\\": <true|false> (set if blockrequest is cancled)\\n\"\n+                            \"              \\\"requested_blocks\\\": <number> (amount of requestes blocks)\\n\"\n+                            \"              \\\"loaded_blocks\\\": <number> (amount of blocks already available on disk)\\n\"\n+                            \"              \\\"processed_blocks\\\": <number> (amount of already processed blocks)\\n\"\n+                            \"           }\\n\"\n+                            \"\\nExamples:\\n\"\n+                            + HelpExampleCli(\"requestblocks\", \"\\\"'[\\\"<blockhash>\\\"]'\\\"\")\n+                            + HelpExampleRpc(\"requestblocks\", \"\\\"'[\\\"<blockhash>\\\"]'\\\"\")\n+                            );\n+\n+    if (request.params[0].get_str() == \"cancel\")\n+    {\n+        if (CAuxiliaryBlockRequest::GetCurrentRequest()) {\n+            CAuxiliaryBlockRequest::GetCurrentRequest()->cancel();\n+            return UniValue(true);\n+        }\n+        else\n+            return UniValue(false);\n+    }\n+    if (request.params[0].get_str() == \"status\")\n+    {\n+        std::shared_ptr<CAuxiliaryBlockRequest> blockRequest = CAuxiliaryBlockRequest::GetCurrentRequest();\n+        UniValue ret(UniValue::VOBJ);\n+        ret.pushKV(\"request_present\", (bool)blockRequest);\n+        if (blockRequest) {\n+            ret.pushKV(\"created\", UniValue(blockRequest->created));\n+            ret.pushKV(\"is_cancled\", UniValue(blockRequest->isCancelled()));\n+            ret.pushKV(\"requested_blocks\", (int64_t)blockRequest->vBlocksToDownload.size());\n+            ret.pushKV(\"loaded_blocks\", (int)blockRequest->amountOfBlocksLoaded());\n+            ret.pushKV(\"processed_blocks\", (int64_t)blockRequest->processedUpToSize);\n+        }\n+        return ret;\n+    }\n+    if (request.params[0].get_str() == \"start\")\n+    {\n+        if (request.params.size() < 2)\n+            throw JSONRPCError(RPC_INVALID_PARAMETER, \"Missing blocks array\");\n+        UniValue hash_Uarray = request.params[1].get_array();\n+        if (!hash_Uarray.isArray())\n+            throw JSONRPCError(RPC_INVALID_PARAMETER, \"Second parameter must be an array\");\n+\n+        std::vector<const CBlockIndex*> blocksToDownload;\n+        {\n+            LOCK(cs_main); //mapBlockIndex\n+            for (UniValue strHashU : hash_Uarray.getValues())\n+            {\n+                uint256 hash(uint256S(strHashU.get_str()));\n+                BlockMap::iterator mi = mapBlockIndex.find(hash);\n+                if (mi == mapBlockIndex.end())\n+                    throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Block not found\");\n+                blocksToDownload.push_back((*mi).second);\n+            }\n+        }\n+\n+        bool passThroughSignals = false;\n+        if (request.params.size() == 3 && request.params[2].isBool())\n+            passThroughSignals = request.params[2].get_bool();\n+\n+        std::shared_ptr<CAuxiliaryBlockRequest> blockRequest(new CAuxiliaryBlockRequest(blocksToDownload, GetAdjustedTime(), passThroughSignals, [](std::shared_ptr<CAuxiliaryBlockRequest> cb_spvRequest, const CBlockIndex *pindex) -> bool {",
    "path": "src/rpc/blockchain.cpp",
    "position": 169,
    "original_position": 122,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "df6e5b873edd4058ec197da9363708162e5f2ec6",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Could use make_shared.",
    "created_at": "2017-02-09T20:20:34Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100402468",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100402468"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100402468"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100402468/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1504,
    "original_line": 1499,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100404045",
    "pull_request_review_id": 20771685,
    "id": 100404045,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDQwNDA0NQ==",
    "diff_hunk": "@@ -1413,6 +1419,98 @@ UniValue reconsiderblock(const JSONRPCRequest& request)\n     return NullUniValue;\n }\n \n+UniValue requestblocks(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() < 1 || request.params.size() > 3)\n+        throw runtime_error(\n+                            \"requestblocks (start|cancel|status) ([\\\"hash_0\\\", \\\"hash_1\\\", ...]) (<pass-internally>)\\n\"\n+                            \"\\nRequests blocks (auxiliary) by eventually downloading them.\\n\"\n+                            \"\\nDownload of the requested blocks will be priorized.\\n\"\n+                            \"\\nArguments:\\n\"\n+                            \"1. action            (string, required) the action to execute\\n\"\n+                            \"                                        start  = start a new block request (overwrite existing one)\\n\"\n+                            \"                                        cancel = stop current block request\\n\"\n+                            \"                                        status = get info about current request\\n\"\n+                            \"2. blockhashes       (array, optional) the hashes of the blocks to download\\n\"\n+                            \"3. pass-internally   (boolean, optional, default = false) If set, the transactions of the requested blocks get passed into the wallet/ZMQ/etc.\\n\"\n+                            \"\\nResult:\\n\"\n+                            \"   cancel: <true|false> (\\\"true\\\" if a blockrequest was present)\\n\"\n+                            \"   start: {\\\"overwrite\\\": <true|false>} (if the new blocksrequest has overwritten an already existign one\\n\"\n+                            \"   status: {\\n\"\n+                            \"              \\\"created\\\": <timestamp> (block request was created at this timestamp)\\n\"\n+                            \"              \\\"is_cancled\\\": <true|false> (set if blockrequest is cancled)\\n\"\n+                            \"              \\\"requested_blocks\\\": <number> (amount of requestes blocks)\\n\"\n+                            \"              \\\"loaded_blocks\\\": <number> (amount of blocks already available on disk)\\n\"\n+                            \"              \\\"processed_blocks\\\": <number> (amount of already processed blocks)\\n\"\n+                            \"           }\\n\"\n+                            \"\\nExamples:\\n\"\n+                            + HelpExampleCli(\"requestblocks\", \"\\\"'[\\\"<blockhash>\\\"]'\\\"\")\n+                            + HelpExampleRpc(\"requestblocks\", \"\\\"'[\\\"<blockhash>\\\"]'\\\"\")\n+                            );\n+\n+    if (request.params[0].get_str() == \"cancel\")\n+    {\n+        if (CAuxiliaryBlockRequest::GetCurrentRequest()) {\n+            CAuxiliaryBlockRequest::GetCurrentRequest()->cancel();\n+            return UniValue(true);\n+        }\n+        else\n+            return UniValue(false);\n+    }\n+    if (request.params[0].get_str() == \"status\")\n+    {\n+        std::shared_ptr<CAuxiliaryBlockRequest> blockRequest = CAuxiliaryBlockRequest::GetCurrentRequest();\n+        UniValue ret(UniValue::VOBJ);\n+        ret.pushKV(\"request_present\", (bool)blockRequest);\n+        if (blockRequest) {\n+            ret.pushKV(\"created\", UniValue(blockRequest->created));\n+            ret.pushKV(\"is_cancled\", UniValue(blockRequest->isCancelled()));\n+            ret.pushKV(\"requested_blocks\", (int64_t)blockRequest->vBlocksToDownload.size());\n+            ret.pushKV(\"loaded_blocks\", (int)blockRequest->amountOfBlocksLoaded());\n+            ret.pushKV(\"processed_blocks\", (int64_t)blockRequest->processedUpToSize);\n+        }\n+        return ret;\n+    }\n+    if (request.params[0].get_str() == \"start\")\n+    {\n+        if (request.params.size() < 2)\n+            throw JSONRPCError(RPC_INVALID_PARAMETER, \"Missing blocks array\");\n+        UniValue hash_Uarray = request.params[1].get_array();\n+        if (!hash_Uarray.isArray())\n+            throw JSONRPCError(RPC_INVALID_PARAMETER, \"Second parameter must be an array\");\n+\n+        std::vector<const CBlockIndex*> blocksToDownload;\n+        {\n+            LOCK(cs_main); //mapBlockIndex\n+            for (UniValue strHashU : hash_Uarray.getValues())\n+            {\n+                uint256 hash(uint256S(strHashU.get_str()));\n+                BlockMap::iterator mi = mapBlockIndex.find(hash);\n+                if (mi == mapBlockIndex.end())\n+                    throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Block not found\");\n+                blocksToDownload.push_back((*mi).second);\n+            }\n+        }\n+\n+        bool passThroughSignals = false;\n+        if (request.params.size() == 3 && request.params[2].isBool())\n+            passThroughSignals = request.params[2].get_bool();\n+\n+        std::shared_ptr<CAuxiliaryBlockRequest> blockRequest(new CAuxiliaryBlockRequest(blocksToDownload, GetAdjustedTime(), passThroughSignals, [](std::shared_ptr<CAuxiliaryBlockRequest> cb_spvRequest, const CBlockIndex *pindex) -> bool {",
    "path": "src/rpc/blockchain.cpp",
    "position": 169,
    "original_position": 122,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "df6e5b873edd4058ec197da9363708162e5f2ec6",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Could just pass {} or nullptr for progress function instead of writing out the long lambda declaration.",
    "created_at": "2017-02-09T20:28:00Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100404045",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100404045"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100404045"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100404045/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1504,
    "original_line": 1499,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100406742",
    "pull_request_review_id": 20771685,
    "id": 100406742,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDQwNjc0Mg==",
    "diff_hunk": "@@ -253,15 +253,21 @@ bool CheckFinalTx(const CTransaction &tx, int flags)\n     // evaluated is what is used. Thus if we want to know if a\n     // transaction can be part of the *next* block, we need to call\n     // IsFinalTx() with one more than chainActive.Height().\n-    const int nBlockHeight = chainActive.Height() + 1;\n+    //\n+    // If calcHeightFromHeaders is set to true, we use the headers-\n+    // chain-tip to calculate the block height\n+    CChain *chainToUse = &chainActive;\n+    if (calcHeightFromHeaders && headersChainActive.Tip())\n+        chainToUse = &headersChainActive;",
    "path": "src/validation.cpp",
    "position": 36,
    "original_position": 19,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "a86c66d9dab7574ecef891ddff0accd5e31a3ab4",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`headersChainActive` variable doesn't seem to be defined yet. Should reorder this commit (\"Allow CheckFinalTx() without validation using the headers chain\") after \"Add CChain object for headers-only chain.\"",
    "created_at": "2017-02-09T20:41:44Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100406742",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100406742"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100406742"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100406742/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 262,
    "original_line": 261,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100408846",
    "pull_request_review_id": 20771685,
    "id": 100408846,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDQwODg0Ng==",
    "diff_hunk": "@@ -20,9 +20,10 @@ class CAuxiliaryBlockRequest : public std::enable_shared_from_this<CAuxiliaryBlo\n \n     const std::vector<const CBlockIndex*> vBlocksToDownload;\n     const int64_t created; //!timestamp when the block request was created\n+    const bool passThroughSignals; //!if passThroughSignals is set, the received blocks transaction will be passed through the SyncTransaction signal */\n \n     /** Constructor of the lock free CAuxiliaryBlockRequest, vBlocksToDownloadIn remains constant */\n-    CAuxiliaryBlockRequest(std::vector<const CBlockIndex*> vBlocksToDownloadIn, int64_t created, const std::function<bool(std::shared_ptr<CAuxiliaryBlockRequest>, const CBlockIndex *pindex)> progressCallbackIn);\n+    CAuxiliaryBlockRequest(std::vector<const CBlockIndex*> vBlocksToDownloadIn, int64_t created, bool passThroughSignalsIn, const std::function<bool(std::shared_ptr<CAuxiliaryBlockRequest>, const CBlockIndex *pindex)> progressCallbackIn);",
    "path": "src/auxiliaryblockrequest.h",
    "position": null,
    "original_position": 8,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "ba99197aef1ba3bda5f5ab32dcd27c6c46e9a7f0",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Probably should just squash this \"CBlockRequest: make SyncTransaction() optional\" commit into \"Add CAuxiliaryBlockRequest, a class to handle auxiliary blocks downloads\" to avoid churn.",
    "created_at": "2017-02-09T20:52:01Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100408846",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100408846"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100408846"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100408846/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 26,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100410117",
    "pull_request_review_id": 20771685,
    "id": 100410117,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDQxMDExNw==",
    "diff_hunk": "@@ -1169,6 +1169,9 @@ void CWallet::SyncTransaction(const CTransaction& tx, const CBlockIndex *pindex,\n {\n     LOCK2(cs_main, cs_wallet);\n \n+    if (!validated)",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "32770b8bf7fbbf016d2d176571cd67da9a68dcab",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Would be good to squash this \"[Wallet] don't consume non-validated transactions\" commit into the \"Pass CBlockRequest blocks through SyncTransaction signal\" to make commit order less fragile and review more straightforward.",
    "created_at": "2017-02-09T20:58:20Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100410117",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100410117"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100410117"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100410117/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1172,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100410334",
    "pull_request_review_id": 20771685,
    "id": 100410334,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDQxMDMzNA==",
    "diff_hunk": "@@ -1511,6 +1512,30 @@ UniValue requestblocks(const JSONRPCRequest& request)\n         throw JSONRPCError(RPC_INVALID_PARAMETER, \"Unkown action\");\n }\n \n+UniValue setautorequestblocks(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() > 1)",
    "path": "src/rpc/blockchain.cpp",
    "position": null,
    "original_position": 32,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "567055e6c4894707d5bd8ea28402dbb721d24f15",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Probably should throw if no arguments passed.",
    "created_at": "2017-02-09T20:59:35Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100410334",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100410334"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100410334"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100410334/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1517,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100411448",
    "pull_request_review_id": 20771685,
    "id": 100411448,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDQxMTQ0OA==",
    "diff_hunk": "@@ -1185,6 +1185,14 @@ void CWallet::SyncTransaction(const CTransaction& tx, const CBlockIndex *pindex,\n     }\n }\n \n+void CWallet::GetNonMempoolTransaction(const uint256 &hash, CTransactionRef &txsp)",
    "path": "src/wallet/wallet.cpp",
    "position": 94,
    "original_position": 4,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "7ca1a8738a878078c0d1546f7743a05ee474dd1b",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Method looks like it could be const.",
    "created_at": "2017-02-09T21:05:05Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100411448",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100411448"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100411448"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100411448/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1215,
    "original_line": 1188,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100416401",
    "pull_request_review_id": 20771685,
    "id": 100416401,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDQxNjQwMQ==",
    "diff_hunk": "@@ -45,6 +45,9 @@ class CAuxiliaryBlockRequest : public std::enable_shared_from_this<CAuxiliaryBlo\n     /** returns the amount of already loaded/local-stored blocks from this blockrequest */\n     unsigned int amountOfBlocksLoaded();\n \n+    /** returns true if all blocks have been downloaded & processed */\n+    bool isCompleted();",
    "path": "src/auxiliaryblockrequest.h",
    "position": null,
    "original_position": 5,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "48c4c3c7c187c28608cecd39cd1401b062e97d3c",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Should probably squash this commit (`Little CAuxiliaryBlockRequest refactor`) into commit `Add CAuxiliaryBlockRequest, a class to handle auxiliary blocks downloads` to avoid code churn in the review.",
    "created_at": "2017-02-09T21:28:37Z",
    "updated_at": "2017-02-09T22:47:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100416401",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100416401"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100416401"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100416401/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 49,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100418246",
    "pull_request_review_id": 20771685,
    "id": 100418246,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwMDQxODI0Ng==",
    "diff_hunk": "@@ -760,10 +760,30 @@\n            </layout>\n           </item>\n           <item>\n+           <widget class=\"QLabel\" name=\"fallbackFeeWarningLabel\">\n+            <property name=\"toolTip\">\n+             <string>Using the fallbackfee can result in sending a transaction that will take serval hours or days (or never) to confirm. Consider choosing your fee manually or wait until your have validated the complete chain.</string>",
    "path": "src/qt/forms/sendcoinsdialog.ui",
    "position": null,
    "original_position": 6,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "87fb7fbcb013265dd31730cdf3db5126c60c26d0",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "spelling: several",
    "created_at": "2017-02-09T21:37:53Z",
    "updated_at": "2017-12-30T11:10:55Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100418246",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100418246"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r100418246"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/100418246/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 765,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126654061",
    "pull_request_review_id": 49156983,
    "id": 126654061,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyNjY1NDA2MQ==",
    "diff_hunk": "@@ -30,7 +30,7 @@ class PeerLogicValidation : public CValidationInterface {\n public:\n     PeerLogicValidation(CConnman* connmanIn);\n \n-    virtual void SyncTransaction(const CTransaction& tx, const CBlockIndex* pindex, int nPosInBlock);\n+    virtual void SyncTransaction(const CTransaction& tx, const CBlockIndex* pindex, int nPosInBlock, bool validated);",
    "path": "src/net_processing.h",
    "position": 19,
    "original_position": 5,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "340e363a7f229e42a02badbbb8ab26f5ed5a5215",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Good point.",
    "created_at": "2017-07-11T10:42:07Z",
    "updated_at": "2017-07-11T10:42:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r126654061",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126654061"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r126654061"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126654061/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 40,
    "original_line": 33,
    "side": "RIGHT",
    "in_reply_to_id": 100135571
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126671612",
    "pull_request_review_id": 49176729,
    "id": 126671612,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyNjY3MTYxMg==",
    "diff_hunk": "@@ -1413,6 +1419,98 @@ UniValue reconsiderblock(const JSONRPCRequest& request)\n     return NullUniValue;\n }\n \n+UniValue requestblocks(const JSONRPCRequest& request)",
    "path": "src/rpc/blockchain.cpp",
    "position": 92,
    "original_position": 45,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "df6e5b873edd4058ec197da9363708162e5f2ec6",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The use cases for the RPC `requestblocks` API:\r\nYou start your peer with `auto-download-blocks = false`, you will only sync the headers then. You can selectively download blocks and eventually pass them through the signal (== ZMQ), use cases: experiments, SPV, light-client backend, ideally if you have a full validated node within your network and you want to selectively load blocks from that node (you don't want to validate everything again).",
    "created_at": "2017-07-11T12:21:27Z",
    "updated_at": "2017-07-11T12:21:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r126671612",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126671612"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r126671612"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126671612/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1427,
    "original_line": 1422,
    "side": "RIGHT",
    "in_reply_to_id": 100141701
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126714741",
    "pull_request_review_id": 49224406,
    "id": 126714741,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyNjcxNDc0MQ==",
    "diff_hunk": "@@ -1413,6 +1419,98 @@ UniValue reconsiderblock(const JSONRPCRequest& request)\n     return NullUniValue;\n }\n \n+UniValue requestblocks(const JSONRPCRequest& request)\n+{\n+    if (request.fHelp || request.params.size() < 1 || request.params.size() > 3)\n+        throw runtime_error(\n+                            \"requestblocks (start|cancel|status) ([\\\"hash_0\\\", \\\"hash_1\\\", ...]) (<pass-internally>)\\n\"\n+                            \"\\nRequests blocks (auxiliary) by eventually downloading them.\\n\"\n+                            \"\\nDownload of the requested blocks will be priorized.\\n\"\n+                            \"\\nArguments:\\n\"\n+                            \"1. action            (string, required) the action to execute\\n\"\n+                            \"                                        start  = start a new block request (overwrite existing one)\\n\"\n+                            \"                                        cancel = stop current block request\\n\"\n+                            \"                                        status = get info about current request\\n\"\n+                            \"2. blockhashes       (array, optional) the hashes of the blocks to download\\n\"\n+                            \"3. pass-internally   (boolean, optional, default = false) If set, the transactions of the requested blocks get passed into the wallet/ZMQ/etc.\\n\"\n+                            \"\\nResult:\\n\"\n+                            \"   cancel: <true|false> (\\\"true\\\" if a blockrequest was present)\\n\"\n+                            \"   start: {\\\"overwrite\\\": <true|false>} (if the new blocksrequest has overwritten an already existign one\\n\"\n+                            \"   status: {\\n\"\n+                            \"              \\\"created\\\": <timestamp> (block request was created at this timestamp)\\n\"\n+                            \"              \\\"is_cancled\\\": <true|false> (set if blockrequest is cancled)\\n\"\n+                            \"              \\\"requested_blocks\\\": <number> (amount of requestes blocks)\\n\"\n+                            \"              \\\"loaded_blocks\\\": <number> (amount of blocks already available on disk)\\n\"\n+                            \"              \\\"processed_blocks\\\": <number> (amount of already processed blocks)\\n\"\n+                            \"           }\\n\"\n+                            \"\\nExamples:\\n\"\n+                            + HelpExampleCli(\"requestblocks\", \"\\\"'[\\\"<blockhash>\\\"]'\\\"\")\n+                            + HelpExampleRpc(\"requestblocks\", \"\\\"'[\\\"<blockhash>\\\"]'\\\"\")\n+                            );\n+\n+    if (request.params[0].get_str() == \"cancel\")\n+    {\n+        if (CAuxiliaryBlockRequest::GetCurrentRequest()) {\n+            CAuxiliaryBlockRequest::GetCurrentRequest()->cancel();\n+            return UniValue(true);\n+        }\n+        else\n+            return UniValue(false);\n+    }\n+    if (request.params[0].get_str() == \"status\")\n+    {\n+        std::shared_ptr<CAuxiliaryBlockRequest> blockRequest = CAuxiliaryBlockRequest::GetCurrentRequest();\n+        UniValue ret(UniValue::VOBJ);\n+        ret.pushKV(\"request_present\", (bool)blockRequest);\n+        if (blockRequest) {\n+            ret.pushKV(\"created\", UniValue(blockRequest->created));\n+            ret.pushKV(\"is_cancled\", UniValue(blockRequest->isCancelled()));\n+            ret.pushKV(\"requested_blocks\", (int64_t)blockRequest->vBlocksToDownload.size());\n+            ret.pushKV(\"loaded_blocks\", (int)blockRequest->amountOfBlocksLoaded());\n+            ret.pushKV(\"processed_blocks\", (int64_t)blockRequest->processedUpToSize);\n+        }\n+        return ret;\n+    }\n+    if (request.params[0].get_str() == \"start\")\n+    {\n+        if (request.params.size() < 2)\n+            throw JSONRPCError(RPC_INVALID_PARAMETER, \"Missing blocks array\");\n+        UniValue hash_Uarray = request.params[1].get_array();\n+        if (!hash_Uarray.isArray())\n+            throw JSONRPCError(RPC_INVALID_PARAMETER, \"Second parameter must be an array\");\n+\n+        std::vector<const CBlockIndex*> blocksToDownload;\n+        {\n+            LOCK(cs_main); //mapBlockIndex\n+            for (UniValue strHashU : hash_Uarray.getValues())\n+            {\n+                uint256 hash(uint256S(strHashU.get_str()));\n+                BlockMap::iterator mi = mapBlockIndex.find(hash);\n+                if (mi == mapBlockIndex.end())\n+                    throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Block not found\");\n+                blocksToDownload.push_back((*mi).second);\n+            }\n+        }\n+\n+        bool passThroughSignals = false;\n+        if (request.params.size() == 3 && request.params[2].isBool())\n+            passThroughSignals = request.params[2].get_bool();\n+\n+        std::shared_ptr<CAuxiliaryBlockRequest> blockRequest(new CAuxiliaryBlockRequest(blocksToDownload, GetAdjustedTime(), passThroughSignals, [](std::shared_ptr<CAuxiliaryBlockRequest> cb_spvRequest, const CBlockIndex *pindex) -> bool {",
    "path": "src/rpc/blockchain.cpp",
    "position": 169,
    "original_position": 122,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "df6e5b873edd4058ec197da9363708162e5f2ec6",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Would returning `true` be guaranteed then?",
    "created_at": "2017-07-11T14:58:00Z",
    "updated_at": "2017-07-11T14:58:00Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r126714741",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126714741"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r126714741"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126714741/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1504,
    "original_line": 1499,
    "side": "RIGHT",
    "in_reply_to_id": 100404045
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214549151",
    "pull_request_review_id": 151629236,
    "id": 214549151,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNDU0OTE1MQ==",
    "diff_hunk": "@@ -0,0 +1,145 @@\n+// Copyright (c) 2016 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"auxiliaryblockrequest.h\"\n+\n+#include \"chainparams.h\"\n+#include \"validation.h\"\n+#include \"validationinterface.h\"\n+#include \"ui_interface.h\"\n+\n+#include <exception>\n+\n+static const unsigned int MAX_BLOCK_TO_PROCESS_PER_ITERATION = 5;\n+\n+std::shared_ptr<CAuxiliaryBlockRequest> currentBlockRequest; //thread-safe pointer (CAuxiliaryBlockRequest, the object, is also lock-free)\n+\n+CAuxiliaryBlockRequest::CAuxiliaryBlockRequest(std::vector<const CBlockIndex*> vBlocksToDownloadIn, int64_t createdIn, bool passThroughSignalsIn, const std::function<bool(std::shared_ptr<CAuxiliaryBlockRequest>, const CBlockIndex *pindex)> progressCallbackIn) : vBlocksToDownload(vBlocksToDownloadIn), created(createdIn), passThroughSignals(passThroughSignalsIn), progressCallback(progressCallbackIn)\n+{\n+    fCancelled = false;\n+    requestedUpToSize = 0;\n+    processedUpToSize = 0;\n+\n+    NotifyUI();\n+}\n+\n+void CAuxiliaryBlockRequest::NotifyUI()\n+{\n+    // Notify UI\n+    uiInterface.NotifyAuxiliaryBlockRequestProgress(this->created, this->vBlocksToDownload.size(), this->amountOfBlocksLoaded(), this->processedUpToSize);\n+}\n+\n+void CAuxiliaryBlockRequest::processWithPossibleBlock(const std::shared_ptr<const CBlock> pblock, CBlockIndex *pindex)\n+{\n+    // don't process anything if the request was cancled",
    "path": "src/auxiliaryblockrequest.cpp",
    "position": 35,
    "original_position": 35,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Typo found by `codespell`: cancled",
    "created_at": "2018-09-02T18:31:23Z",
    "updated_at": "2018-09-02T18:31:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r214549151",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214549151"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r214549151"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214549151/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 35,
    "original_line": 35,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214549161",
    "pull_request_review_id": 151629246,
    "id": 214549161,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNDU0OTE2MQ==",
    "diff_hunk": "@@ -0,0 +1,145 @@\n+// Copyright (c) 2016 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"auxiliaryblockrequest.h\"\n+\n+#include \"chainparams.h\"\n+#include \"validation.h\"\n+#include \"validationinterface.h\"\n+#include \"ui_interface.h\"\n+\n+#include <exception>\n+\n+static const unsigned int MAX_BLOCK_TO_PROCESS_PER_ITERATION = 5;\n+\n+std::shared_ptr<CAuxiliaryBlockRequest> currentBlockRequest; //thread-safe pointer (CAuxiliaryBlockRequest, the object, is also lock-free)\n+\n+CAuxiliaryBlockRequest::CAuxiliaryBlockRequest(std::vector<const CBlockIndex*> vBlocksToDownloadIn, int64_t createdIn, bool passThroughSignalsIn, const std::function<bool(std::shared_ptr<CAuxiliaryBlockRequest>, const CBlockIndex *pindex)> progressCallbackIn) : vBlocksToDownload(vBlocksToDownloadIn), created(createdIn), passThroughSignals(passThroughSignalsIn), progressCallback(progressCallbackIn)\n+{\n+    fCancelled = false;\n+    requestedUpToSize = 0;\n+    processedUpToSize = 0;\n+\n+    NotifyUI();\n+}\n+\n+void CAuxiliaryBlockRequest::NotifyUI()\n+{\n+    // Notify UI\n+    uiInterface.NotifyAuxiliaryBlockRequestProgress(this->created, this->vBlocksToDownload.size(), this->amountOfBlocksLoaded(), this->processedUpToSize);\n+}\n+\n+void CAuxiliaryBlockRequest::processWithPossibleBlock(const std::shared_ptr<const CBlock> pblock, CBlockIndex *pindex)\n+{\n+    // don't process anything if the request was cancled\n+    if (this->fCancelled)\n+        return;\n+\n+    for (unsigned int i = this->processedUpToSize; i < this->vBlocksToDownload.size() ; i++) {\n+        const CBlockIndex *pindexRequest = this->vBlocksToDownload[i];\n+        std::shared_ptr<const CBlock> currentBlock;\n+\n+        // if a block has been passed, check if it's the next item in the sequence\n+        if (pindex && pblock && pindex == pindexRequest)\n+            currentBlock = pblock;\n+        else if (pindexRequest->nStatus & BLOCK_HAVE_DATA) {\n+            CBlock loadBlock;\n+            // we should already have this block on disk, process it\n+            if (!ReadBlockFromDisk(loadBlock, pindexRequest, Params().GetConsensus()))\n+                throw std::runtime_error(std::string(__func__) + \"Can't read block from disk\");\n+            currentBlock = std::make_shared<const CBlock>(loadBlock);\n+        } else {\n+            break;\n+        }\n+\n+        // fire signal with txns\n+        if (passThroughSignals) {\n+            unsigned int cnt = 0;\n+            for(const auto& tx : currentBlock->vtx)\n+            {\n+                bool valid = ((pindexRequest->nStatus & BLOCK_VALID_MASK) == BLOCK_VALID_MASK);\n+                GetMainSignals().SyncTransaction(*tx, pindexRequest, cnt, valid);\n+                cnt++;\n+            }\n+        }\n+        this->processedUpToSize++;\n+\n+        // log some info\n+        LogPrint(\"net\", \"BlockRequest: proccessed up to %ld of total requested %ld blocks\\n\", this->processedUpToSize, this->vBlocksToDownload.size());",
    "path": "src/auxiliaryblockrequest.cpp",
    "position": 69,
    "original_position": 69,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Typo found by `codespell`: proccessed",
    "created_at": "2018-09-02T18:31:47Z",
    "updated_at": "2018-09-02T18:31:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r214549161",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214549161"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r214549161"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214549161/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 69,
    "original_line": 69,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214549170",
    "pull_request_review_id": 151629255,
    "id": 214549170,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNDU0OTE3MA==",
    "diff_hunk": "@@ -481,6 +493,27 @@ void FindNextBlocksToDownload(NodeId nodeid, unsigned int count, std::vector<con\n     // Make sure pindexBestKnownBlock is up to date, we'll need it.\n     ProcessBlockAvailability(nodeid);\n \n+    // if there is an open CAuxiliaryBlockRequest (out-of-band/specific block donwload), privileg it",
    "path": "src/net_processing.cpp",
    "position": 87,
    "original_position": 87,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Typo found by `codespell`: donwload annd privileg",
    "created_at": "2018-09-02T18:32:13Z",
    "updated_at": "2018-09-02T18:32:42Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r214549170",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214549170"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r214549170"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214549170/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 496,
    "original_line": 496,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214549204",
    "pull_request_review_id": 151629282,
    "id": 214549204,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNDU0OTIwNA==",
    "diff_hunk": "@@ -481,6 +493,27 @@ void FindNextBlocksToDownload(NodeId nodeid, unsigned int count, std::vector<con\n     // Make sure pindexBestKnownBlock is up to date, we'll need it.\n     ProcessBlockAvailability(nodeid);\n \n+    // if there is an open CAuxiliaryBlockRequest (out-of-band/specific block donwload), privileg it\n+    if (blockRequest && !blockRequest->isCancelled()) {\n+        // fill in next blocks to download, pass in a filter function to check mapBlocksInFlight\n+        blockRequest->fillInNextBlocks(vBlocks, count, [state](const CBlockIndex *pIndexCheck) -> bool {\n+            // make sure the remote node has this block\n+            // we have already verified the chainWork through the headers-sync\n+            // lets just compare heights\n+            // missing blocks will lead to a time-out/missbehave and re-request (from different peer) (TODO: check)\n+            if (state->pindexBestKnownBlock == NULL || state->pindexBestKnownBlock->nHeight < pIndexCheck->nHeight)\n+                return false;\n+            return (mapBlocksInFlight.count(pIndexCheck->GetBlockHash()) == 0);\n+        });\n+\n+        // if we haven't completed the individual CAuxiliaryBlockRequest, we wont continue with \"normal\" IBD",
    "path": "src/net_processing.cpp",
    "position": 100,
    "original_position": 100,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Typo found by `codespell`: wont",
    "created_at": "2018-09-02T18:33:32Z",
    "updated_at": "2018-09-02T18:33:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r214549204",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214549204"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r214549204"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214549204/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 509,
    "original_line": 509,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214549225",
    "pull_request_review_id": 151629304,
    "id": 214549225,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNDU0OTIyNQ==",
    "diff_hunk": "@@ -0,0 +1,145 @@\n+// Copyright (c) 2016 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"auxiliaryblockrequest.h\"\n+\n+#include \"chainparams.h\"\n+#include \"validation.h\"\n+#include \"validationinterface.h\"\n+#include \"ui_interface.h\"\n+\n+#include <exception>\n+\n+static const unsigned int MAX_BLOCK_TO_PROCESS_PER_ITERATION = 5;\n+\n+std::shared_ptr<CAuxiliaryBlockRequest> currentBlockRequest; //thread-safe pointer (CAuxiliaryBlockRequest, the object, is also lock-free)\n+\n+CAuxiliaryBlockRequest::CAuxiliaryBlockRequest(std::vector<const CBlockIndex*> vBlocksToDownloadIn, int64_t createdIn, bool passThroughSignalsIn, const std::function<bool(std::shared_ptr<CAuxiliaryBlockRequest>, const CBlockIndex *pindex)> progressCallbackIn) : vBlocksToDownload(vBlocksToDownloadIn), created(createdIn), passThroughSignals(passThroughSignalsIn), progressCallback(progressCallbackIn)\n+{\n+    fCancelled = false;\n+    requestedUpToSize = 0;\n+    processedUpToSize = 0;\n+\n+    NotifyUI();\n+}\n+\n+void CAuxiliaryBlockRequest::NotifyUI()\n+{\n+    // Notify UI\n+    uiInterface.NotifyAuxiliaryBlockRequestProgress(this->created, this->vBlocksToDownload.size(), this->amountOfBlocksLoaded(), this->processedUpToSize);\n+}\n+\n+void CAuxiliaryBlockRequest::processWithPossibleBlock(const std::shared_ptr<const CBlock> pblock, CBlockIndex *pindex)\n+{\n+    // don't process anything if the request was cancled",
    "path": "src/auxiliaryblockrequest.cpp",
    "position": 35,
    "original_position": 35,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This should be fixed throughout in this PR :-)",
    "created_at": "2018-09-02T18:34:27Z",
    "updated_at": "2018-09-02T18:34:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r214549225",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214549225"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r214549225"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214549225/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 35,
    "original_line": 35,
    "side": "RIGHT",
    "in_reply_to_id": 214549151
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214549240",
    "pull_request_review_id": 151629321,
    "id": 214549240,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNDU0OTI0MA==",
    "diff_hunk": "@@ -481,6 +493,27 @@ void FindNextBlocksToDownload(NodeId nodeid, unsigned int count, std::vector<con\n     // Make sure pindexBestKnownBlock is up to date, we'll need it.\n     ProcessBlockAvailability(nodeid);\n \n+    // if there is an open CAuxiliaryBlockRequest (out-of-band/specific block donwload), privileg it\n+    if (blockRequest && !blockRequest->isCancelled()) {\n+        // fill in next blocks to download, pass in a filter function to check mapBlocksInFlight\n+        blockRequest->fillInNextBlocks(vBlocks, count, [state](const CBlockIndex *pIndexCheck) -> bool {\n+            // make sure the remote node has this block\n+            // we have already verified the chainWork through the headers-sync\n+            // lets just compare heights\n+            // missing blocks will lead to a time-out/missbehave and re-request (from different peer) (TODO: check)\n+            if (state->pindexBestKnownBlock == NULL || state->pindexBestKnownBlock->nHeight < pIndexCheck->nHeight)\n+                return false;\n+            return (mapBlocksInFlight.count(pIndexCheck->GetBlockHash()) == 0);\n+        });\n+\n+        // if we haven't completed the individual CAuxiliaryBlockRequest, we wont continue with \"normal\" IBD\n+        return;\n+    }\n+\n+    // don't request any other blocks if we are in non autorequest mode (usefull for non-validation mode)",
    "path": "src/net_processing.cpp",
    "position": 104,
    "original_position": 104,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Typo found by `codespell`: usefull (also below)",
    "created_at": "2018-09-02T18:35:01Z",
    "updated_at": "2018-09-02T18:35:01Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r214549240",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214549240"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r214549240"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214549240/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 513,
    "original_line": 513,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214618882",
    "pull_request_review_id": 151712222,
    "id": 214618882,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNDYxODg4Mg==",
    "diff_hunk": "@@ -0,0 +1,145 @@\n+// Copyright (c) 2016 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"auxiliaryblockrequest.h\"\n+\n+#include \"chainparams.h\"\n+#include \"validation.h\"\n+#include \"validationinterface.h\"\n+#include \"ui_interface.h\"\n+\n+#include <exception>\n+\n+static const unsigned int MAX_BLOCK_TO_PROCESS_PER_ITERATION = 5;\n+\n+std::shared_ptr<CAuxiliaryBlockRequest> currentBlockRequest; //thread-safe pointer (CAuxiliaryBlockRequest, the object, is also lock-free)\n+\n+CAuxiliaryBlockRequest::CAuxiliaryBlockRequest(std::vector<const CBlockIndex*> vBlocksToDownloadIn, int64_t createdIn, bool passThroughSignalsIn, const std::function<bool(std::shared_ptr<CAuxiliaryBlockRequest>, const CBlockIndex *pindex)> progressCallbackIn) : vBlocksToDownload(vBlocksToDownloadIn), created(createdIn), passThroughSignals(passThroughSignalsIn), progressCallback(progressCallbackIn)\n+{\n+    fCancelled = false;\n+    requestedUpToSize = 0;\n+    processedUpToSize = 0;\n+\n+    NotifyUI();\n+}\n+\n+void CAuxiliaryBlockRequest::NotifyUI()\n+{\n+    // Notify UI\n+    uiInterface.NotifyAuxiliaryBlockRequestProgress(this->created, this->vBlocksToDownload.size(), this->amountOfBlocksLoaded(), this->processedUpToSize);\n+}\n+\n+void CAuxiliaryBlockRequest::processWithPossibleBlock(const std::shared_ptr<const CBlock> pblock, CBlockIndex *pindex)\n+{\n+    // don't process anything if the request was cancled",
    "path": "src/auxiliaryblockrequest.cpp",
    "position": 35,
    "original_position": 35,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Maybe we need a linter?",
    "created_at": "2018-09-03T08:59:02Z",
    "updated_at": "2018-09-03T08:59:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r214618882",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214618882"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r214618882"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214618882/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 35,
    "original_line": 35,
    "side": "RIGHT",
    "in_reply_to_id": 214549151
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214620858",
    "pull_request_review_id": 151714659,
    "id": 214620858,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxNDYyMDg1OA==",
    "diff_hunk": "@@ -0,0 +1,145 @@\n+// Copyright (c) 2016 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"auxiliaryblockrequest.h\"\n+\n+#include \"chainparams.h\"\n+#include \"validation.h\"\n+#include \"validationinterface.h\"\n+#include \"ui_interface.h\"\n+\n+#include <exception>\n+\n+static const unsigned int MAX_BLOCK_TO_PROCESS_PER_ITERATION = 5;\n+\n+std::shared_ptr<CAuxiliaryBlockRequest> currentBlockRequest; //thread-safe pointer (CAuxiliaryBlockRequest, the object, is also lock-free)\n+\n+CAuxiliaryBlockRequest::CAuxiliaryBlockRequest(std::vector<const CBlockIndex*> vBlocksToDownloadIn, int64_t createdIn, bool passThroughSignalsIn, const std::function<bool(std::shared_ptr<CAuxiliaryBlockRequest>, const CBlockIndex *pindex)> progressCallbackIn) : vBlocksToDownload(vBlocksToDownloadIn), created(createdIn), passThroughSignals(passThroughSignalsIn), progressCallback(progressCallbackIn)\n+{\n+    fCancelled = false;\n+    requestedUpToSize = 0;\n+    processedUpToSize = 0;\n+\n+    NotifyUI();\n+}\n+\n+void CAuxiliaryBlockRequest::NotifyUI()\n+{\n+    // Notify UI\n+    uiInterface.NotifyAuxiliaryBlockRequestProgress(this->created, this->vBlocksToDownload.size(), this->amountOfBlocksLoaded(), this->processedUpToSize);\n+}\n+\n+void CAuxiliaryBlockRequest::processWithPossibleBlock(const std::shared_ptr<const CBlock> pblock, CBlockIndex *pindex)\n+{\n+    // don't process anything if the request was cancled",
    "path": "src/auxiliaryblockrequest.cpp",
    "position": 35,
    "original_position": 35,
    "commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "original_commit_id": "254c94ca45d990d7eb745110486eb9c6ecfcb8b4",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@Sjors Please review #13954 which adds a `codespell` linter :-)",
    "created_at": "2018-09-03T09:06:14Z",
    "updated_at": "2018-09-03T17:18:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r214620858",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214620858"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9483#discussion_r214620858"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9483"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/214620858/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 35,
    "original_line": 35,
    "side": "RIGHT",
    "in_reply_to_id": 214549151
  }
]