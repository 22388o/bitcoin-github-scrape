[
  {
    "sha": "1078275b50a2b44638956686ea744fe481ce8978",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxMDc4Mjc1YjUwYTJiNDQ2Mzg5NTY2ODZlYTc0NGZlNDgxY2U4OTc4",
    "commit": {
      "author": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2017-02-06T07:34:57Z"
      },
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2017-02-06T08:16:04Z"
      },
      "message": "net: fix a few races. Credit @TheBlueMatt\n\nThese are (afaik) all long-standing races or concurrent accesses. Going\nforward, we can clean these up so that they're not all individual atomic\naccesses.\n\n- Reintroduce cs_vRecv to guard receive-specific vars\n- Lock vRecv/vSend for CNodeStats\n- Make some vars atomic.\n- Only set the connection time in CNode's constructor so that it doesn't change",
      "tree": {
        "sha": "e33ee6a80ed102f0b97860d74124e0e21a541a5b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e33ee6a80ed102f0b97860d74124e0e21a541a5b"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1078275b50a2b44638956686ea744fe481ce8978",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1078275b50a2b44638956686ea744fe481ce8978",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/1078275b50a2b44638956686ea744fe481ce8978",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1078275b50a2b44638956686ea744fe481ce8978/comments",
    "author": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "923dc447eaa8e017985b2afbbb12dd1283fbea0e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/923dc447eaa8e017985b2afbbb12dd1283fbea0e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/923dc447eaa8e017985b2afbbb12dd1283fbea0e"
      }
    ],
    "stats": {
      "total": 37,
      "additions": 22,
      "deletions": 15
    },
    "files": [
      {
        "sha": "b0491647e0732a97e6adad93f753a229d4d403ed",
        "filename": "src/net.cpp",
        "status": "modified",
        "additions": 11,
        "deletions": 5,
        "changes": 16,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1078275b50a2b44638956686ea744fe481ce8978/src/net.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1078275b50a2b44638956686ea744fe481ce8978/src/net.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.cpp?ref=1078275b50a2b44638956686ea744fe481ce8978",
        "patch": "@@ -389,7 +389,6 @@ CNode* CConnman::ConnectNode(CAddress addrConnect, const char *pszDest, bool fCo\n         uint64_t nonce = GetDeterministicRandomizer(RANDOMIZER_ID_LOCALHOSTNONCE).Write(id).Finalize();\n         CNode* pnode = new CNode(id, nLocalServices, GetBestHeight(), hSocket, addrConnect, CalculateKeyedNetGroup(addrConnect), nonce, pszDest ? pszDest : \"\", false);\n         pnode->nServicesExpected = ServiceFlags(addrConnect.nServices & nRelevantServices);\n-        pnode->nTimeConnected = GetSystemTimeInSeconds();\n         pnode->AddRef();\n \n         return pnode;\n@@ -611,10 +610,16 @@ void CNode::copyStats(CNodeStats &stats)\n     X(fInbound);\n     X(fAddnode);\n     X(nStartingHeight);\n-    X(nSendBytes);\n-    X(mapSendBytesPerMsgCmd);\n-    X(nRecvBytes);\n-    X(mapRecvBytesPerMsgCmd);\n+    {\n+        LOCK(cs_vSend);\n+        X(mapSendBytesPerMsgCmd);\n+        X(nSendBytes);\n+    }\n+    {\n+        LOCK(cs_vRecv);\n+        X(mapRecvBytesPerMsgCmd);\n+        X(nRecvBytes);\n+    }\n     X(fWhitelisted);\n \n     // It is common for nodes with good ping times to suddenly become lagged,\n@@ -642,6 +647,7 @@ bool CNode::ReceiveMsgBytes(const char *pch, unsigned int nBytes, bool& complete\n {\n     complete = false;\n     int64_t nTimeMicros = GetTimeMicros();\n+    LOCK(cs_vRecv);\n     nLastRecv = nTimeMicros / 1000000;\n     nRecvBytes += nBytes;\n     while (nBytes > 0) {"
      },
      {
        "sha": "c6f57826a1e5de782baa79ec00e3618d748ad55f",
        "filename": "src/net.h",
        "status": "modified",
        "additions": 10,
        "deletions": 9,
        "changes": 19,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1078275b50a2b44638956686ea744fe481ce8978/src/net.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1078275b50a2b44638956686ea744fe481ce8978/src/net.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.h?ref=1078275b50a2b44638956686ea744fe481ce8978",
        "patch": "@@ -572,6 +572,7 @@ class CNode\n     uint64_t nSendBytes;\n     std::deque<std::vector<unsigned char>> vSendMsg;\n     CCriticalSection cs_vSend;\n+    CCriticalSection cs_vRecv;\n \n     CCriticalSection cs_vProcessMsg;\n     std::list<CNetMessage> vProcessMsg;\n@@ -583,10 +584,10 @@ class CNode\n     uint64_t nRecvBytes;\n     std::atomic<int> nRecvVersion;\n \n-    int64_t nLastSend;\n-    int64_t nLastRecv;\n+    std::atomic<int64_t> nLastSend;\n+    std::atomic<int64_t> nLastRecv;\n     int64_t nTimeConnected;\n-    int64_t nTimeOffset;\n+    std::atomic<int64_t> nTimeOffset;\n     const CAddress addr;\n     std::string addrName;\n     CService addrLocal;\n@@ -613,7 +614,7 @@ class CNode\n     CSemaphoreGrant grantOutbound;\n     CCriticalSection cs_filter;\n     CBloomFilter* pfilter;\n-    int nRefCount;\n+    std::atomic<int> nRefCount;\n     const NodeId id;\n \n     const uint64_t nKeyedNetGroup;\n@@ -664,15 +665,15 @@ class CNode\n \n     // Ping time measurement:\n     // The pong reply we're expecting, or 0 if no pong expected.\n-    uint64_t nPingNonceSent;\n+    std::atomic<uint64_t> nPingNonceSent;\n     // Time (in usec) the last ping was sent, or 0 if no ping was ever sent.\n-    int64_t nPingUsecStart;\n+    std::atomic<int64_t> nPingUsecStart;\n     // Last measured round-trip time.\n-    int64_t nPingUsecTime;\n+    std::atomic<int64_t> nPingUsecTime;\n     // Best measured round-trip time.\n-    int64_t nMinPingUsecTime;\n+    std::atomic<int64_t> nMinPingUsecTime;\n     // Whether a ping is requested.\n-    bool fPingQueued;\n+    std::atomic<bool> fPingQueued;\n     // Minimum fee rate with which to filter inv's to this node\n     CAmount minFeeFilter;\n     CCriticalSection cs_feeFilter;"
      },
      {
        "sha": "420f92937b71ee73b540432c8e79405377f20d1a",
        "filename": "src/net_processing.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1078275b50a2b44638956686ea744fe481ce8978/src/net_processing.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1078275b50a2b44638956686ea744fe481ce8978/src/net_processing.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net_processing.cpp?ref=1078275b50a2b44638956686ea744fe481ce8978",
        "patch": "@@ -2442,7 +2442,7 @@ bool static ProcessMessage(CNode* pfrom, std::string strCommand, CDataStream& vR\n                     if (pingUsecTime > 0) {\n                         // Successful ping time measurement, replace previous\n                         pfrom->nPingUsecTime = pingUsecTime;\n-                        pfrom->nMinPingUsecTime = std::min(pfrom->nMinPingUsecTime, pingUsecTime);\n+                        pfrom->nMinPingUsecTime = std::min(pfrom->nMinPingUsecTime.load(), pingUsecTime);\n                     } else {\n                         // This should never happen\n                         sProblem = \"Timing mishap\";"
      }
    ]
  },
  {
    "sha": "69e46f017d010d13c3dd99c1d0eade9295effb12",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2OWU0NmYwMTdkMDEwZDEzYzNkZDk5YzFkMGVhZGU5Mjk1ZWZmYjEy",
    "commit": {
      "author": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2017-02-06T16:42:49Z"
      },
      "committer": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2017-02-06T16:42:49Z"
      },
      "message": "Make nTimeConnected const in CNode",
      "tree": {
        "sha": "6c989d31f76dc784b24a1aaccb81ab2a980b61d8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6c989d31f76dc784b24a1aaccb81ab2a980b61d8"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/69e46f017d010d13c3dd99c1d0eade9295effb12",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/69e46f017d010d13c3dd99c1d0eade9295effb12",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/69e46f017d010d13c3dd99c1d0eade9295effb12",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/69e46f017d010d13c3dd99c1d0eade9295effb12/comments",
    "author": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "1078275b50a2b44638956686ea744fe481ce8978",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1078275b50a2b44638956686ea744fe481ce8978",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/1078275b50a2b44638956686ea744fe481ce8978"
      }
    ],
    "stats": {
      "total": 4,
      "additions": 2,
      "deletions": 2
    },
    "files": [
      {
        "sha": "604fdad25ac960a97d9a4e1406cd2340eaea7a80",
        "filename": "src/net.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/69e46f017d010d13c3dd99c1d0eade9295effb12/src/net.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/69e46f017d010d13c3dd99c1d0eade9295effb12/src/net.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.cpp?ref=69e46f017d010d13c3dd99c1d0eade9295effb12",
        "patch": "@@ -2551,6 +2551,7 @@ unsigned int CConnman::GetReceiveFloodSize() const { return nReceiveFloodSize; }\n unsigned int CConnman::GetSendBufferSize() const{ return nSendBufferMaxSize; }\n \n CNode::CNode(NodeId idIn, ServiceFlags nLocalServicesIn, int nMyStartingHeightIn, SOCKET hSocketIn, const CAddress& addrIn, uint64_t nKeyedNetGroupIn, uint64_t nLocalHostNonceIn, const std::string& addrNameIn, bool fInboundIn) :\n+    nTimeConnected(GetSystemTimeInSeconds()),\n     addr(addrIn),\n     fInbound(fInboundIn),\n     id(idIn),\n@@ -2570,7 +2571,6 @@ CNode::CNode(NodeId idIn, ServiceFlags nLocalServicesIn, int nMyStartingHeightIn\n     nLastRecv = 0;\n     nSendBytes = 0;\n     nRecvBytes = 0;\n-    nTimeConnected = GetSystemTimeInSeconds();\n     nTimeOffset = 0;\n     addrName = addrNameIn == \"\" ? addr.ToStringIPPort() : addrNameIn;\n     nVersion = 0;"
      },
      {
        "sha": "c70d52602c92b7c3abd36d9120bdfc5411058b3f",
        "filename": "src/net.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/69e46f017d010d13c3dd99c1d0eade9295effb12/src/net.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/69e46f017d010d13c3dd99c1d0eade9295effb12/src/net.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.h?ref=69e46f017d010d13c3dd99c1d0eade9295effb12",
        "patch": "@@ -586,7 +586,7 @@ class CNode\n \n     std::atomic<int64_t> nLastSend;\n     std::atomic<int64_t> nLastRecv;\n-    int64_t nTimeConnected;\n+    const int64_t nTimeConnected;\n     std::atomic<int64_t> nTimeOffset;\n     const CAddress addr;\n     std::string addrName;"
      }
    ]
  },
  {
    "sha": "15efb59a35fd0f8f392b6ed00f539d3e6366aca0",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxNWVmYjU5YTM1ZmQwZjhmMzkyYjZlZDAwZjUzOWQzZTYzNjZhY2Ew",
    "commit": {
      "author": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2017-02-06T16:44:38Z"
      },
      "committer": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2017-02-06T16:44:38Z"
      },
      "message": "Avoid copying CNodeStats to make helgrind OK with buggy std::string",
      "tree": {
        "sha": "de659da1faa131234835da3ffb1819184d216676",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/de659da1faa131234835da3ffb1819184d216676"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/15efb59a35fd0f8f392b6ed00f539d3e6366aca0",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/15efb59a35fd0f8f392b6ed00f539d3e6366aca0",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/15efb59a35fd0f8f392b6ed00f539d3e6366aca0",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/15efb59a35fd0f8f392b6ed00f539d3e6366aca0/comments",
    "author": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "69e46f017d010d13c3dd99c1d0eade9295effb12",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/69e46f017d010d13c3dd99c1d0eade9295effb12",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/69e46f017d010d13c3dd99c1d0eade9295effb12"
      }
    ],
    "stats": {
      "total": 5,
      "additions": 2,
      "deletions": 3
    },
    "files": [
      {
        "sha": "dab759171ea12fcd40efbd77db37f09a4acdafbc",
        "filename": "src/net.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 3,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/15efb59a35fd0f8f392b6ed00f539d3e6366aca0/src/net.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/15efb59a35fd0f8f392b6ed00f539d3e6366aca0/src/net.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.cpp?ref=15efb59a35fd0f8f392b6ed00f539d3e6366aca0",
        "patch": "@@ -2397,9 +2397,8 @@ void CConnman::GetNodeStats(std::vector<CNodeStats>& vstats)\n     vstats.reserve(vNodes.size());\n     for(std::vector<CNode*>::iterator it = vNodes.begin(); it != vNodes.end(); ++it) {\n         CNode* pnode = *it;\n-        CNodeStats stats;\n-        pnode->copyStats(stats);\n-        vstats.push_back(stats);\n+        vstats.emplace_back();\n+        pnode->copyStats(vstats.back());\n     }\n }\n "
      }
    ]
  },
  {
    "sha": "fe2cec8395c285670a6f00fda1f94a6d2b206f8a",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmZTJjZWM4Mzk1YzI4NTY3MGE2ZjAwZmRhMWY5NGE2ZDJiMjA2Zjhh",
    "commit": {
      "author": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2017-02-06T16:53:34Z"
      },
      "committer": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2017-02-06T16:53:34Z"
      },
      "message": "Access fRelayTxes with cs_filter lock in copyStats",
      "tree": {
        "sha": "080b5f422883459248335a13b0054e47280858ab",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/080b5f422883459248335a13b0054e47280858ab"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fe2cec8395c285670a6f00fda1f94a6d2b206f8a",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fe2cec8395c285670a6f00fda1f94a6d2b206f8a",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fe2cec8395c285670a6f00fda1f94a6d2b206f8a",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fe2cec8395c285670a6f00fda1f94a6d2b206f8a/comments",
    "author": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "15efb59a35fd0f8f392b6ed00f539d3e6366aca0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/15efb59a35fd0f8f392b6ed00f539d3e6366aca0",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/15efb59a35fd0f8f392b6ed00f539d3e6366aca0"
      }
    ],
    "stats": {
      "total": 5,
      "additions": 4,
      "deletions": 1
    },
    "files": [
      {
        "sha": "f92d0b62cf92c540f87fe003b332a89ecaf7066f",
        "filename": "src/net.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 1,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fe2cec8395c285670a6f00fda1f94a6d2b206f8a/src/net.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fe2cec8395c285670a6f00fda1f94a6d2b206f8a/src/net.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.cpp?ref=fe2cec8395c285670a6f00fda1f94a6d2b206f8a",
        "patch": "@@ -599,7 +599,10 @@ void CNode::copyStats(CNodeStats &stats)\n     stats.nodeid = this->GetId();\n     X(nServices);\n     X(addr);\n-    X(fRelayTxes);\n+    {\n+        LOCK(cs_filter);\n+        X(fRelayTxes);\n+    }\n     X(nLastSend);\n     X(nLastRecv);\n     X(nTimeConnected);"
      }
    ]
  },
  {
    "sha": "cbfa270bb7852f4537cd1541216b2d441e56ae3a",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpjYmZhMjcwYmI3ODUyZjQ1MzdjZDE1NDEyMTZiMmQ0NDFlNTZhZTNh",
    "commit": {
      "author": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2017-02-06T17:15:30Z"
      },
      "committer": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2017-02-06T20:49:23Z"
      },
      "message": "Make nStartingHeight atomic",
      "tree": {
        "sha": "83d598f5d54483c48ddd1ba43bb48c8555f55a8b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/83d598f5d54483c48ddd1ba43bb48c8555f55a8b"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cbfa270bb7852f4537cd1541216b2d441e56ae3a",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/cbfa270bb7852f4537cd1541216b2d441e56ae3a",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/cbfa270bb7852f4537cd1541216b2d441e56ae3a",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/cbfa270bb7852f4537cd1541216b2d441e56ae3a/comments",
    "author": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fe2cec8395c285670a6f00fda1f94a6d2b206f8a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fe2cec8395c285670a6f00fda1f94a6d2b206f8a",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fe2cec8395c285670a6f00fda1f94a6d2b206f8a"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 1,
      "deletions": 1
    },
    "files": [
      {
        "sha": "678dd1925a2acce4539f444a12ead60e65818dbe",
        "filename": "src/net.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/cbfa270bb7852f4537cd1541216b2d441e56ae3a/src/net.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/cbfa270bb7852f4537cd1541216b2d441e56ae3a/src/net.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.h?ref=cbfa270bb7852f4537cd1541216b2d441e56ae3a",
        "patch": "@@ -627,7 +627,7 @@ class CNode\n \n public:\n     uint256 hashContinue;\n-    int nStartingHeight;\n+    std::atomic<int> nStartingHeight;\n \n     // flood relay\n     std::vector<CAddress> vAddrToSend;"
      }
    ]
  },
  {
    "sha": "29113eb78e6e44a3acadc68a74508a57b031c79d",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyOTExM2ViNzhlNmU0NGEzYWNhZGM2OGE3NDUwOGE1N2IwMzFjNzlk",
    "commit": {
      "author": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2017-02-06T17:20:16Z"
      },
      "committer": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2017-02-06T20:49:23Z"
      },
      "message": "Make nServices atomic",
      "tree": {
        "sha": "7a320875783502f8a28170cfcc42f653b207180e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7a320875783502f8a28170cfcc42f653b207180e"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/29113eb78e6e44a3acadc68a74508a57b031c79d",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/29113eb78e6e44a3acadc68a74508a57b031c79d",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/29113eb78e6e44a3acadc68a74508a57b031c79d",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/29113eb78e6e44a3acadc68a74508a57b031c79d/comments",
    "author": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "cbfa270bb7852f4537cd1541216b2d441e56ae3a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/cbfa270bb7852f4537cd1541216b2d441e56ae3a",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/cbfa270bb7852f4537cd1541216b2d441e56ae3a"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 1,
      "deletions": 1
    },
    "files": [
      {
        "sha": "8a12825a8397f0290f730f52144fade5963a1daa",
        "filename": "src/net.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/29113eb78e6e44a3acadc68a74508a57b031c79d/src/net.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/29113eb78e6e44a3acadc68a74508a57b031c79d/src/net.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.h?ref=29113eb78e6e44a3acadc68a74508a57b031c79d",
        "patch": "@@ -564,7 +564,7 @@ class CNode\n     friend class CConnman;\n public:\n     // socket\n-    ServiceFlags nServices;\n+    std::atomic<ServiceFlags> nServices;\n     ServiceFlags nServicesExpected;\n     SOCKET hSocket;\n     size_t nSendSize; // total size of all vSendMsg entries"
      }
    ]
  },
  {
    "sha": "7706f6327c66da733d14c08a9e48b2bdf36150e8",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3NzA2ZjYzMjdjNjZkYTczM2QxNGMwOGE5ZTQ4YjJiZGYzNjE1MGU4",
    "commit": {
      "author": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2017-02-06T17:08:31Z"
      },
      "committer": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2017-02-06T22:28:59Z"
      },
      "message": "Move [clean|str]SubVer writes/copyStats into a lock",
      "tree": {
        "sha": "0a628d44487701ad212fe32b4584fd527197c000",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0a628d44487701ad212fe32b4584fd527197c000"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7706f6327c66da733d14c08a9e48b2bdf36150e8",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7706f6327c66da733d14c08a9e48b2bdf36150e8",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/7706f6327c66da733d14c08a9e48b2bdf36150e8",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7706f6327c66da733d14c08a9e48b2bdf36150e8/comments",
    "author": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "29113eb78e6e44a3acadc68a74508a57b031c79d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/29113eb78e6e44a3acadc68a74508a57b031c79d",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/29113eb78e6e44a3acadc68a74508a57b031c79d"
      }
    ],
    "stats": {
      "total": 17,
      "additions": 13,
      "deletions": 4
    },
    "files": [
      {
        "sha": "238fffbc4068e8a55e42baa70c527260c8e64da3",
        "filename": "src/net.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 1,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7706f6327c66da733d14c08a9e48b2bdf36150e8/src/net.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7706f6327c66da733d14c08a9e48b2bdf36150e8/src/net.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.cpp?ref=7706f6327c66da733d14c08a9e48b2bdf36150e8",
        "patch": "@@ -609,7 +609,10 @@ void CNode::copyStats(CNodeStats &stats)\n     X(nTimeOffset);\n     X(addrName);\n     X(nVersion);\n-    X(cleanSubVer);\n+    {\n+        LOCK(cs_SubVer);\n+        X(cleanSubVer);\n+    }\n     X(fInbound);\n     X(fAddnode);\n     X(nStartingHeight);"
      },
      {
        "sha": "4b37ed2d728160d96ede68839ede8492dc857c1f",
        "filename": "src/net.h",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7706f6327c66da733d14c08a9e48b2bdf36150e8/src/net.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7706f6327c66da733d14c08a9e48b2bdf36150e8/src/net.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.h?ref=7706f6327c66da733d14c08a9e48b2bdf36150e8",
        "patch": "@@ -597,6 +597,7 @@ class CNode\n     // store the sanitized version in cleanSubVer. The original should be used when dealing with\n     // the network or wire types and the cleaned string used when displayed or logged.\n     std::string strSubVer, cleanSubVer;\n+    CCriticalSection cs_SubVer; // used for both cleanSubVer and strSubVer\n     bool fWhitelisted; // This peer can bypass DoS banning.\n     bool fFeeler; // If true this node is being used as a short lived feeler.\n     bool fOneShot;"
      },
      {
        "sha": "56fa38daa6ca50ddb9527f0a3b0acfbe4b513bc1",
        "filename": "src/net_processing.cpp",
        "status": "modified",
        "additions": 8,
        "deletions": 3,
        "changes": 11,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7706f6327c66da733d14c08a9e48b2bdf36150e8/src/net_processing.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7706f6327c66da733d14c08a9e48b2bdf36150e8/src/net_processing.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net_processing.cpp?ref=7706f6327c66da733d14c08a9e48b2bdf36150e8",
        "patch": "@@ -1203,6 +1203,7 @@ bool static ProcessMessage(CNode* pfrom, std::string strCommand, CDataStream& vR\n         int nVersion;\n         int nSendVersion;\n         std::string strSubVer;\n+        std::string cleanSubVer;\n         int nStartingHeight = -1;\n         bool fRelay = true;\n \n@@ -1238,6 +1239,7 @@ bool static ProcessMessage(CNode* pfrom, std::string strCommand, CDataStream& vR\n             vRecv >> addrFrom >> nNonce;\n         if (!vRecv.empty()) {\n             vRecv >> LIMITED_STRING(strSubVer, MAX_SUBVERSION_LENGTH);\n+            cleanSubVer = SanitizeString(strSubVer);\n         }\n         if (!vRecv.empty()) {\n             vRecv >> nStartingHeight;\n@@ -1265,8 +1267,11 @@ bool static ProcessMessage(CNode* pfrom, std::string strCommand, CDataStream& vR\n \n         pfrom->nServices = nServices;\n         pfrom->addrLocal = addrMe;\n-        pfrom->strSubVer = strSubVer;\n-        pfrom->cleanSubVer = SanitizeString(strSubVer);\n+        {\n+            LOCK(pfrom->cs_SubVer);\n+            pfrom->strSubVer = strSubVer;\n+            pfrom->cleanSubVer = cleanSubVer;\n+        }\n         pfrom->nStartingHeight = nStartingHeight;\n         pfrom->fClient = !(nServices & NODE_NETWORK);\n         {\n@@ -1322,7 +1327,7 @@ bool static ProcessMessage(CNode* pfrom, std::string strCommand, CDataStream& vR\n             remoteAddr = \", peeraddr=\" + pfrom->addr.ToString();\n \n         LogPrintf(\"receive version message: %s: version %d, blocks=%d, us=%s, peer=%d%s\\n\",\n-                  pfrom->cleanSubVer, pfrom->nVersion,\n+                  cleanSubVer, pfrom->nVersion,\n                   pfrom->nStartingHeight, addrMe.ToString(), pfrom->id,\n                   remoteAddr);\n "
      }
    ]
  },
  {
    "sha": "7d4250c670413a7f8416cc8b1d6d03a3e38e39f8",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3ZDQyNTBjNjcwNDEzYTdmODQxNmNjOGIxZDZkMDNhM2UzOGUzOWY4",
    "commit": {
      "author": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2017-02-06T22:38:57Z"
      },
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2017-02-06T23:40:45Z"
      },
      "message": "Make nTimeBestReceived atomic",
      "tree": {
        "sha": "d752ebdb0692b117e3a80f757271caa28c37bc0e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d752ebdb0692b117e3a80f757271caa28c37bc0e"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7d4250c670413a7f8416cc8b1d6d03a3e38e39f8",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7d4250c670413a7f8416cc8b1d6d03a3e38e39f8",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/7d4250c670413a7f8416cc8b1d6d03a3e38e39f8",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7d4250c670413a7f8416cc8b1d6d03a3e38e39f8/comments",
    "author": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "7706f6327c66da733d14c08a9e48b2bdf36150e8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7706f6327c66da733d14c08a9e48b2bdf36150e8",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/7706f6327c66da733d14c08a9e48b2bdf36150e8"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 1,
      "deletions": 1
    },
    "files": [
      {
        "sha": "ce48698b2195e3132a08fad3f9c6c814dd68bea1",
        "filename": "src/net_processing.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7d4250c670413a7f8416cc8b1d6d03a3e38e39f8/src/net_processing.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7d4250c670413a7f8416cc8b1d6d03a3e38e39f8/src/net_processing.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net_processing.cpp?ref=7d4250c670413a7f8416cc8b1d6d03a3e38e39f8",
        "patch": "@@ -36,7 +36,7 @@\n # error \"Bitcoin cannot be compiled without assertions.\"\n #endif\n \n-int64_t nTimeBestReceived = 0; // Used only to inform the wallet of when we last received a block\n+std::atomic<int64_t> nTimeBestReceived(0); // Used only to inform the wallet of when we last received a block\n \n struct IteratorComparator\n {"
      }
    ]
  }
]