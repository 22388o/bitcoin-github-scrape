[
  {
    "sha": "f1c1faf7b3d7d47c2eff3d629b0113f5d82259a7",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmMWMxZmFmN2IzZDdkNDdjMmVmZjNkNjI5YjAxMTNmNWQ4MjI1OWE3",
    "commit": {
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2015-02-03T18:11:07Z"
      },
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2015-02-03T18:11:07Z"
      },
      "message": "Add max-integer size rule to BIP66",
      "tree": {
        "sha": "45649360aed3953629d8e59bb5f852458a39aed5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/45649360aed3953629d8e59bb5f852458a39aed5"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f1c1faf7b3d7d47c2eff3d629b0113f5d82259a7",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f1c1faf7b3d7d47c2eff3d629b0113f5d82259a7",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/f1c1faf7b3d7d47c2eff3d629b0113f5d82259a7",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f1c1faf7b3d7d47c2eff3d629b0113f5d82259a7/comments",
    "author": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fcf646c9b08e7f846d6c99314f937ace50809d7a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fcf646c9b08e7f846d6c99314f937ace50809d7a",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fcf646c9b08e7f846d6c99314f937ace50809d7a"
      }
    ],
    "stats": {
      "total": 12,
      "additions": 8,
      "deletions": 4
    },
    "files": [
      {
        "sha": "9f84046d3599c2cb0b56d425defbffd190edad15",
        "filename": "src/script/interpreter.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 4,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f1c1faf7b3d7d47c2eff3d629b0113f5d82259a7/src/script/interpreter.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f1c1faf7b3d7d47c2eff3d629b0113f5d82259a7/src/script/interpreter.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script/interpreter.cpp?ref=f1c1faf7b3d7d47c2eff3d629b0113f5d82259a7",
        "patch": "@@ -135,8 +135,8 @@ bool static IsValidSignatureEncoding(const std::vector<unsigned char> &sig) {\n     // Check whether the R element is an integer.\n     if (sig[2] != 0x02) return false;\n \n-    // Zero-length integers are not allowed for R.\n-    if (lenR == 0) return false;\n+    // R needs to be between 1 and 33 bytes.\n+    if (lenR == 0 || lenR > 33) return false;\n \n     // Negative numbers are not allowed for R.\n     if (sig[4] & 0x80) return false;\n@@ -148,8 +148,8 @@ bool static IsValidSignatureEncoding(const std::vector<unsigned char> &sig) {\n     // Check whether the S element is an integer.\n     if (sig[lenR + 4] != 0x02) return false;\n \n-    // Zero-length integers are not allowed for S.\n-    if (lenS == 0) return false;\n+    // S needs to be between 1 and 33 bytes.\n+    if (lenS == 0 || lenS > 33) return false;\n \n     // Negative numbers are not allowed for S.\n     if (sig[lenR + 6] & 0x80) return false;"
      },
      {
        "sha": "867d04b5b2d7c015e80a6027a3770b7d51ccfcaa",
        "filename": "src/test/data/script_invalid.json",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f1c1faf7b3d7d47c2eff3d629b0113f5d82259a7/src/test/data/script_invalid.json",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f1c1faf7b3d7d47c2eff3d629b0113f5d82259a7/src/test/data/script_invalid.json",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/data/script_invalid.json?ref=f1c1faf7b3d7d47c2eff3d629b0113f5d82259a7",
        "patch": "@@ -512,6 +512,8 @@\n \n [\"Increase DERSIG test coverage\"],\n [\"0x4a 0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\", \"0 CHECKSIG NOT\", \"DERSIG\", \"Overly long signature is incorrectly encoded for DERSIG\"],\n+[\"0x2a 0x302702220100000000000000000000000000000000000000000000000000000000000000000002010101\", \"0 CHECKSIG NOT\", \"DERSIG\", \"34-byte R is incorrectly encoded for DERSIG\"],\n+[\"0x2a 0x302702010102220100000000000000000000000000000000000000000000000000000000000000000001\", \"0 CHECKSIG NOT\", \"DERSIG\", \"34-byte S is incorrectly encoded for DERSIG\"],\n [\"0x25 0x30220220000000000000000000000000000000000000000000000000000000000000000000\", \"0 CHECKSIG NOT\", \"DERSIG\", \"Missing S is incorrectly encoded for DERSIG\"],\n [\"0x27 0x3024021077777777777777777777777777777777020a7777777777777777777777777777777701\", \"0 CHECKSIG NOT\", \"DERSIG\", \"S with invalid S length is incorrectly encoded for DERSIG\"],\n [\"0x27 0x302403107777777777777777777777777777777702107777777777777777777777777777777701\", \"0 CHECKSIG NOT\", \"DERSIG\", \"Non-integer R is incorrectly encoded for DERSIG\"],"
      },
      {
        "sha": "f3974049a20d01f996f06ba9c6ece34ea98b3732",
        "filename": "src/test/data/script_valid.json",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f1c1faf7b3d7d47c2eff3d629b0113f5d82259a7/src/test/data/script_valid.json",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f1c1faf7b3d7d47c2eff3d629b0113f5d82259a7/src/test/data/script_valid.json",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/data/script_valid.json?ref=f1c1faf7b3d7d47c2eff3d629b0113f5d82259a7",
        "patch": "@@ -690,6 +690,8 @@\n \n [\"Increase test coverage for DERSIG\"],\n [\"0x4a 0x0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000\", \"0 CHECKSIG NOT\", \"\", \"Overly long signature is correctly encoded\"],\n+[\"0x2a 0x302702220100000000000000000000000000000000000000000000000000000000000000000002010101\", \"0 CHECKSIG NOT\", \"\", \"34-byte R is correctly encoded\"],\n+[\"0x2a 0x302702010102220100000000000000000000000000000000000000000000000000000000000000000001\", \"0 CHECKSIG NOT\", \"\", \"34-byte S is correctly encoded\"],\n [\"0x25 0x30220220000000000000000000000000000000000000000000000000000000000000000000\", \"0 CHECKSIG NOT\", \"\", \"Missing S is correctly encoded\"],\n [\"0x27 0x3024021077777777777777777777777777777777020a7777777777777777777777777777777701\", \"0 CHECKSIG NOT\", \"\", \"S with invalid S length is correctly encoded\"],\n [\"0x27 0x302403107777777777777777777777777777777702107777777777777777777777777777777701\", \"0 CHECKSIG NOT\", \"\", \"Non-integer R is correctly encoded\"],"
      }
    ]
  }
]