[
  {
    "sha": "ed12d5df1ba52b5ef3dd3799de26bb5e1d3fc654",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplZDEyZDVkZjFiYTUyYjVlZjNkZDM3OTlkZTI2YmI1ZTFkM2ZjNjU0",
    "commit": {
      "author": {
        "name": "Jim Posen",
        "email": "jim.posen@gmail.com",
        "date": "2018-08-27T19:28:35Z"
      },
      "committer": {
        "name": "Jim Posen",
        "email": "jim.posen@gmail.com",
        "date": "2018-08-28T00:03:24Z"
      },
      "message": "index: Fix for indexers skipping genesis block.",
      "tree": {
        "sha": "947882744b34f59d1668b3d4636641c4b9daaed3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/947882744b34f59d1668b3d4636641c4b9daaed3"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ed12d5df1ba52b5ef3dd3799de26bb5e1d3fc654",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ed12d5df1ba52b5ef3dd3799de26bb5e1d3fc654",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/ed12d5df1ba52b5ef3dd3799de26bb5e1d3fc654",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ed12d5df1ba52b5ef3dd3799de26bb5e1d3fc654/comments",
    "author": {
      "login": "jimpo",
      "id": 881253,
      "node_id": "MDQ6VXNlcjg4MTI1Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/881253?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jimpo",
      "html_url": "https://github.com/jimpo",
      "followers_url": "https://api.github.com/users/jimpo/followers",
      "following_url": "https://api.github.com/users/jimpo/following{/other_user}",
      "gists_url": "https://api.github.com/users/jimpo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jimpo/subscriptions",
      "organizations_url": "https://api.github.com/users/jimpo/orgs",
      "repos_url": "https://api.github.com/users/jimpo/repos",
      "events_url": "https://api.github.com/users/jimpo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jimpo/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jimpo",
      "id": 881253,
      "node_id": "MDQ6VXNlcjg4MTI1Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/881253?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jimpo",
      "html_url": "https://github.com/jimpo",
      "followers_url": "https://api.github.com/users/jimpo/followers",
      "following_url": "https://api.github.com/users/jimpo/following{/other_user}",
      "gists_url": "https://api.github.com/users/jimpo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jimpo/subscriptions",
      "organizations_url": "https://api.github.com/users/jimpo/orgs",
      "repos_url": "https://api.github.com/users/jimpo/repos",
      "events_url": "https://api.github.com/users/jimpo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jimpo/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "0df9b0aed23127acd12d9ed6a008c12be47b1cd9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0df9b0aed23127acd12d9ed6a008c12be47b1cd9",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/0df9b0aed23127acd12d9ed6a008c12be47b1cd9"
      }
    ],
    "stats": {
      "total": 16,
      "additions": 15,
      "deletions": 1
    },
    "files": [
      {
        "sha": "3cf2a89a2d0f1d9368e9ba5f5108b4f797ec423e",
        "filename": "src/index/base.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 1,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ed12d5df1ba52b5ef3dd3799de26bb5e1d3fc654/src/index/base.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ed12d5df1ba52b5ef3dd3799de26bb5e1d3fc654/src/index/base.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/index/base.cpp?ref=ed12d5df1ba52b5ef3dd3799de26bb5e1d3fc654",
        "patch": "@@ -60,7 +60,11 @@ bool BaseIndex::Init()\n     }\n \n     LOCK(cs_main);\n-    m_best_block_index = FindForkInGlobalIndex(chainActive, locator);\n+    if (locator.IsNull()) {\n+        m_best_block_index = nullptr;\n+    } else {\n+        m_best_block_index = FindForkInGlobalIndex(chainActive, locator);\n+    }\n     m_synced = m_best_block_index.load() == chainActive.Tip();\n     return true;\n }"
      },
      {
        "sha": "224004ce1c0c5b6e6ebcdb6011544f7ed5ae1b30",
        "filename": "src/index/txindex.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ed12d5df1ba52b5ef3dd3799de26bb5e1d3fc654/src/index/txindex.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ed12d5df1ba52b5ef3dd3799de26bb5e1d3fc654/src/index/txindex.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/index/txindex.cpp?ref=ed12d5df1ba52b5ef3dd3799de26bb5e1d3fc654",
        "patch": "@@ -245,6 +245,9 @@ bool TxIndex::Init()\n \n bool TxIndex::WriteBlock(const CBlock& block, const CBlockIndex* pindex)\n {\n+    // Exclude genesis block transaction because outputs are not spendable.\n+    if (pindex->nHeight == 0) return true;\n+\n     CDiskTxPos pos(pindex->GetBlockPos(), GetSizeOfCompactSize(block.vtx.size()));\n     std::vector<std::pair<uint256, CDiskTxPos>> vPos;\n     vPos.reserve(block.vtx.size());"
      },
      {
        "sha": "b5aa8160ed2e6dc139d5c7623cfc903e169a87f3",
        "filename": "src/test/txindex_tests.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 0,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ed12d5df1ba52b5ef3dd3799de26bb5e1d3fc654/src/test/txindex_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ed12d5df1ba52b5ef3dd3799de26bb5e1d3fc654/src/test/txindex_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/txindex_tests.cpp?ref=ed12d5df1ba52b5ef3dd3799de26bb5e1d3fc654",
        "patch": "@@ -2,6 +2,7 @@\n // Distributed under the MIT software license, see the accompanying\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n+#include <chainparams.h>\n #include <index/txindex.h>\n #include <script/standard.h>\n #include <test/test_bitcoin.h>\n@@ -38,6 +39,12 @@ BOOST_FIXTURE_TEST_CASE(txindex_initial_sync, TestChain100Setup)\n         MilliSleep(100);\n     }\n \n+    // Check that txindex excludes genesis block transactions.\n+    const CBlock& genesis_block = Params().GenesisBlock();\n+    for (const auto& txn : genesis_block.vtx) {\n+        BOOST_CHECK(!txindex.FindTx(txn->GetHash(), block_hash, tx_disk));\n+    }\n+\n     // Check that txindex has all txs that were in the chain before it started.\n     for (const auto& txn : m_coinbase_txns) {\n         if (!txindex.FindTx(txn->GetHash(), block_hash, tx_disk)) {"
      }
    ]
  }
]