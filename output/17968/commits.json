[
  {
    "sha": "4fc1df41d570ab631a8b47e4427a0b84305e37d1",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0ZmMxZGY0MWQ1NzBhYjYzMWE4YjQ3ZTQ0MjdhMGI4NDMwNWUzN2Qx",
    "commit": {
      "author": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2020-02-12T20:57:56Z"
      },
      "committer": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2020-04-29T18:45:17Z"
      },
      "message": "qt: Track QEvent::Resize during animation",
      "tree": {
        "sha": "d71c54c403a8b7a83b741c2ca08d3f741b784791",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d71c54c403a8b7a83b741c2ca08d3f741b784791"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4fc1df41d570ab631a8b47e4427a0b84305e37d1",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE0dvyxLlvLev0wWZUQQEIES5+qB8FAl6py0UACgkQQQEIES5+\nqB/9uhAAqUaq5icwErdkezoakC53tUwDearuQ0+7DzZPcXDLj2Lc3T5jU1Jy4Afw\nk3wwWhnnVQHgkF9iy1x2woV8x59s3npnfBRuNQbkTec49wkrzZ5caonwVB/Be0xl\n8vyhCFGUC9p37wi4yHT08zm5mcb+XFhGD6pkY0TaCbOokq0H2zm7i8SrMlZgaaBs\ny0YmHWbfoa6LT77gHytkBikIUlPFIRHgN/uLWljBK7cFUQYCPs8uDK4u8lAat0rW\npSD8CIMpxIVZiuJLBtB+uVRsGv7VNJC+DC8qBPs5zlLAbBIArNTWT/2iWSQnlWwh\nChrHtPvUmIi1ZzIUXsBeL/SbUnMUMRQMWcfItyHDcx4L7Yq3cMLWffbPfyVHDqoF\n3BlGDHx3jv5TrwjaMENeZQ0/7YzqamijJkGFB47qxF3EqFLjz4mc5LfFPqZSlsLX\nqJif5NtS63zsyT2c9nK/3XlPHp92HxU4wtxEKGg6IZyNTNhCgXbGFCN2FNLcqoIb\nv/c3rV/oNT0luitEMyLZyUYqaE942zH0Q46Tulz3urisMwxIRsqq+KpXEUtltccp\n/OUgMU1Ad0wxOEx4Gv1FIUiUB+NKQS/kIikoSUl0M7ga3vYwKHG104vPnQwc/G7Q\nzKJT7rhgXS8WjPPHeonVr4yHQx101q/lzmdT/TvSWtG85a3f2g4=\n=Ny1Z\n-----END PGP SIGNATURE-----",
        "payload": "tree d71c54c403a8b7a83b741c2ca08d3f741b784791\nparent d4fc9aeb8b6a66d8d40ab93547c8b1390458d638\nauthor Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1581541076 +0200\ncommitter Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1588185917 +0300\n\nqt: Track QEvent::Resize during animation\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4fc1df41d570ab631a8b47e4427a0b84305e37d1",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/4fc1df41d570ab631a8b47e4427a0b84305e37d1",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4fc1df41d570ab631a8b47e4427a0b84305e37d1/comments",
    "author": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "d4fc9aeb8b6a66d8d40ab93547c8b1390458d638",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d4fc9aeb8b6a66d8d40ab93547c8b1390458d638",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/d4fc9aeb8b6a66d8d40ab93547c8b1390458d638"
      }
    ],
    "stats": {
      "total": 28,
      "additions": 17,
      "deletions": 11
    },
    "files": [
      {
        "sha": "f0b2bd23189a0a5f14adc33922c40b88d544065a",
        "filename": "src/qt/modaloverlay.cpp",
        "status": "modified",
        "additions": 15,
        "deletions": 11,
        "changes": 26,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4fc1df41d570ab631a8b47e4427a0b84305e37d1/src/qt/modaloverlay.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4fc1df41d570ab631a8b47e4427a0b84305e37d1/src/qt/modaloverlay.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/modaloverlay.cpp?ref=4fc1df41d570ab631a8b47e4427a0b84305e37d1",
        "patch": "@@ -5,12 +5,12 @@\n #include <qt/modaloverlay.h>\n #include <qt/forms/ui_modaloverlay.h>\n \n-#include <qt/guiutil.h>\n-\n #include <chainparams.h>\n+#include <qt/guiutil.h>\n \n-#include <QResizeEvent>\n+#include <QEasingCurve>\n #include <QPropertyAnimation>\n+#include <QResizeEvent>\n \n ModalOverlay::ModalOverlay(bool enable_wallet, QWidget *parent) :\n QWidget(parent),\n@@ -33,6 +33,11 @@ userClosed(false)\n         ui->infoText->setVisible(false);\n         ui->infoTextStrong->setText(tr(\"%1 is currently syncing.  It will download headers and blocks from peers and validate them until reaching the tip of the block chain.\").arg(PACKAGE_NAME));\n     }\n+\n+    m_animation.setTargetObject(this);\n+    m_animation.setPropertyName(\"pos\");\n+    m_animation.setDuration(300 /* ms */);\n+    m_animation.setEasingCurve(QEasingCurve::OutQuad);\n }\n \n ModalOverlay::~ModalOverlay()\n@@ -48,6 +53,9 @@ bool ModalOverlay::eventFilter(QObject * obj, QEvent * ev) {\n             if (!layerIsVisible)\n                 setGeometry(0, height(), width(), height());\n \n+            if (m_animation.endValue().toPoint().y() > 0) {\n+                m_animation.setEndValue(QPoint(0, height()));\n+            }\n         }\n         else if (ev->type() == QEvent::ChildAdded) {\n             raise();\n@@ -166,14 +174,10 @@ void ModalOverlay::showHide(bool hide, bool userRequested)\n     if (!isVisible() && !hide)\n         setVisible(true);\n \n-    setGeometry(0, hide ? 0 : height(), width(), height());\n-\n-    QPropertyAnimation* animation = new QPropertyAnimation(this, \"pos\");\n-    animation->setDuration(300);\n-    animation->setStartValue(QPoint(0, hide ? 0 : this->height()));\n-    animation->setEndValue(QPoint(0, hide ? this->height() : 0));\n-    animation->setEasingCurve(QEasingCurve::OutQuad);\n-    animation->start(QAbstractAnimation::DeleteWhenStopped);\n+    m_animation.setStartValue(QPoint(0, hide ? 0 : height()));\n+    // The eventFilter() updates the endValue if it is required for QEvent::Resize.\n+    m_animation.setEndValue(QPoint(0, hide ? height() : 0));\n+    m_animation.start(QAbstractAnimation::KeepWhenStopped);\n     layerIsVisible = !hide;\n }\n "
      },
      {
        "sha": "28f4d4f7208f3510938bf571470fbc3299080831",
        "filename": "src/qt/modaloverlay.h",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4fc1df41d570ab631a8b47e4427a0b84305e37d1/src/qt/modaloverlay.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4fc1df41d570ab631a8b47e4427a0b84305e37d1/src/qt/modaloverlay.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/modaloverlay.h?ref=4fc1df41d570ab631a8b47e4427a0b84305e37d1",
        "patch": "@@ -6,6 +6,7 @@\n #define BITCOIN_QT_MODALOVERLAY_H\n \n #include <QDateTime>\n+#include <QPropertyAnimation>\n #include <QWidget>\n \n //! The required delta of headers to the estimated number of available headers until we show the IBD progress\n@@ -45,6 +46,7 @@ public Q_SLOTS:\n     QVector<QPair<qint64, double> > blockProcessTime;\n     bool layerIsVisible;\n     bool userClosed;\n+    QPropertyAnimation m_animation;\n     void UpdateHeaderSyncLabel();\n };\n "
      }
    ]
  }
]