DrahtBot,2020-04-29 16:21:44,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #21036 (gitian: Bump descriptors to Focal for 22.0 by fanquake)\n\nIf you consider this pull request important, please als",https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-621317807,621317807,
DrahtBot,2020-04-30 08:27:02,<!--a722867cd34abeea1fadc8d60700f111-->\n### Gitian builds\n\n| File | commit 978c5a212240fd03af13d6f72ba3c27da6298f61<br>(master) | commit b3ccb885028531a89aef0e010036ea3fe79d1036<br>(master and this pull) |\n|--|--|--|\n| bitcoin-*-aarch64-linux-gnu-debug.tar.gz | [`a7900f03fdbecc03...`](https://drahtbot.space/gitian/bitcoin/bitcoin/978c5a212240fd03af13d6f72ba3c27da6298f61/bitcoin-978c5a2122-aar,https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-621691298,621691298,
MarcoFalke,2020-04-30 19:16:15,"cc @dongcarl @fanquake \n\nDoes this break guix builds in any way?\n\n*    #18741 (guix: Make source tarball using git-archive by dongcarl)\n\n",https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-622051012,622051012,
DrahtBot,2020-05-01 08:29:12,<!--9cd9c72976c961c55c7acef8f6ba82cd-->\n### Guix builds\n\n| File | commit e5b9308920a151946b83694fe1701d90316a2a9e<br>(master) | commit de73e4f81866bc4f333fd3b6025c93ad56a07256<br>(master and this pull) |\n|--|--|--|\n| bitcoin-0.20.99-aarch64-linux-gnu-debug.tar.gz | [`bfa9f239a7fe270a...`](https://drahtbot.space/guix/bitcoin/bitcoin/e5b9308920a151946b83694fe1701d90316a2a9e/bitcoin-0.20.99-aarc,https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-622299338,622299338,
dongcarl,2020-05-05 18:36:54,"I think we previously decided specifically that we're not going to pre-autogen our tarballs.\n\nSee context:\n- #18331\n- #18478\n- #18547 \n\n100% on board with restoring the tar leading directory though.",https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-624233092,624233092,
luke-jr,2020-05-05 21:08:39,"This doesn't have the complexity of `git ls-files` etc in #18478. I see no decision-making relating to intentionally excluding configure (which is a standard/expected part of source code distributions), only a few people being okay with losing it as a side effect.",https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-624307278,624307278,
dongcarl,2020-05-05 23:02:30,"Okay, at this point, I don't have an opinion either way anymore. Will give it a review after others chime in!",https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-624350943,624350943,
hebasto,2020-05-05 23:29:56,"Why not follow @MarcoFalke's [suggestion](http://www.erisian.com.au/bitcoin-core-dev/log-2020-04-30.html#l-378) on IRC:\n> \<MarcoFalke\> luke-jr: Maybe split out the first commit into a pull, so that gitian builds can be performed on it more easily?\n\n?",https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-624359319,624359319,
luke-jr,2020-05-06 01:30:43,http://www.erisian.com.au/bitcoin-core-dev/log-2020-04-30.html#l-380,https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-624397782,624397782,
luke-jr,2020-05-06 13:43:43,Rebased,https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-624657819,624657819,
MarcoFalke,2020-05-06 15:43:53,"So if this is backported, the only additional commit that also needs backport is 395c1137f630dc495ffb2752a23bc1dfd470ee53, I think (haven't checked).",https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-624727140,624727140,
dongcarl,2020-05-06 16:01:59,"For the record, my thinking in #18478 originally was this:\n\n- `make dist` seems to be designed to know exactly which bootstrapped files to include (or not include) in its archive\n- `git archive` or `git ls-files` seems to be good at knowing all the other files we want to include in its archive\n\nWhich means that if we combine these two, we'll get the best of both worlds, without having to",https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-624737633,624737633,
luke-jr,2020-05-06 16:08:29,"@dongcarl Your (1) would miss the substitutions git-archive makes in `src/clientversion.cpp`. I don't see a problem with (2), although it's slightly more complex and requires care I don't know if we want to spend time reviewing (in particular, tar is picky about specific tar file formats when concatenating, and even if we just use `--update`, there's a risk that the `git archive` timestamp is afte",https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-624741169,624741169,
hebasto,2020-05-07 03:40:44,"@luke-jr \n> 2. The tarball should be pre-autogen'd, so the user can begin with `./configure` and not need maintainer tools.\n\nI have no experience as a package maintainer so I kindly ask you to share the real-world cases when a user cannot begin with `./autogen.sh`. It seems having maintainer tools is not a much burden for a user, no?",https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-625011285,625011285,
ryanofsky,2020-05-07 04:33:48,"> I have no experience as a package maintainer so I kindly ask you to share the real-world cases when a user cannot begin with `./autogen.sh`\n\nIt used to be common to want to distribute source packages for unix systems that might not have gnu tools installed (solaris, irix, hpux, bsds) but would have a bare-bones make, c compiler, and posix shell. \n\nTo easily support building packages on t",https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-625023451,625023451,
luke-jr,2020-05-07 12:43:32,"I don't know of any case where the user can't install autotools, but this isn't about ""can't""...\n\nIncluding the configure script, and starting with just `./configure` is standard, and what people expect both in general and even specifically for Bitcoin Core. There are no real benefits to suddenly *not* including it, and doing so this way does not add much complexity.\n\nFurthermore, I don't ",https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-625232072,625232072,
hebasto,2020-05-07 12:49:34,"> Including the configure script, and starting with just `./configure` is standard, and what people expect both in general and even specifically for Bitcoin Core. There are no real benefits to suddenly _not_ including it, and doing so this way does not add much complexity.\n\nFrom [UNIX BUILD NOTES -- To Build](https://github.com/bitcoin/bitcoin/blob/master/doc/build-unix.md#to-build):\n>    ./",https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-625234989,625234989,
ryanofsky,2020-05-07 13:16:04,"> just `./configure` is standard\n\nNot an actual standard, just a common practice that's become less common because of new build systems and languages and git, and because it doesn't have logical or practical benefits",https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-625248939,625248939,
luke-jr,2020-05-07 13:32:41,"Nothing here stops people from using autogen, as documented.\n\nAgain, there is no benefit to removing configure and breaking the de facto standard practice.",https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-625258079,625258079,
ryanofsky,2020-05-07 13:39:03,"> Again, there is no benefit to removing configure\n\nIt's fine to disagree and I'm not interested in delaying this PR if it contains an essential fix and other desired changes. I just don't want to to be misrepresented. So from https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-625023451, ""I think the main benefits of dropping the autotools generated files are having fewer differences b",https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-625261623,625261623,
Sjors,2020-05-11 17:26:18,"tACK 3897f3a2ec077f2be8f0d08f28e79165a6cae6d4\n\nConcept ACK on maintaining the behaviour from earlier releases, if it's not too much trouble. This is even an improvement, because it adds `depends` to the source tarball.\n\nI never used the source tarball, and can only imagine needing it if Github disappeared and there's no reliable place to `git clone` from.\n\nOn the one hand I share @ryan",https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-626841028,626841028,
theuni,2020-06-24 20:00:50,"> > Including the configure script, and starting with just `./configure` is standard, and what people expect both in general and even specifically for Bitcoin Core. There are no real benefits to suddenly _not_ including it, and doing so this way does not add much complexity.\n> \n> From [UNIX BUILD NOTES -- To Build](https://github.com/bitcoin/bitcoin/blob/master/doc/build-unix.md#to-build):\n>",https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-649039598,649039598,
laanwj,2020-08-05 15:17:01,"Just a data point: I haven't had, or otherwise heard of, any complaints about the 0.20.x tarball aren't bootstrapped.",https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-669254031,669254031,
luke-jr,2020-08-05 17:34:30,"Well, it's not like we've ever had complete/usable tarballs before either... Maybe people are just used to needing to use git? Dunno.",https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-669328705,669328705,
MarcoFalke,2020-11-05 19:22:21,"Removed from 0.21 milestone for now\n\n(The autogen.sh part was controversial and is not a regression-bugfix)",https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-722588576,722588576,
DrahtBot,2021-02-08 11:56:11,"<!--cf906140f33d8803c4a75a2196329ecb-->\nüêô This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a ""draft"".</sub>",https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-775092921,775092921,
fanquake,2021-08-11 02:15:30,"Closing this, as at this point, we aren't likely going back on the build / dist changes. I also don't think I'm aware of any complaints in regards to the release tarball being broken (that's for 0.20 and 0.21).",https://github.com/bitcoin/bitcoin/pull/18818#issuecomment-896446674,896446674,
dongcarl,2020-05-06 15:44:58,"Are these the only things we need to exclude?\n\nWould be nice to have a comparison between ""make dist minus all the git-tracked files"" vs ""bootstrapped files created this way minus the git-tracked files""",https://github.com/bitcoin/bitcoin/pull/18818#discussion_r420895515,420895515,contrib/gitian-descriptors/make_release_tarball
luke-jr,2020-05-06 16:03:00,"```\ntar -tpf build/out/src/bitcoin-3897f3a2ec07.tar.gz | cut -b 22- | sort\ngit ls-files | perl -nle '$a=$_; while (s[/[^/]+/?$][/]) { if (not exists $d{$_}) { $d{$_} = undef; print } } print $a' | sort\n```\n\nResult:\n```\nMakefile.in\naclocal.m4\nbuild-aux/compile\nbuild-aux/config.guess\nbuild-aux/config.sub\nbuild-aux/depcomp\nbuild-aux/install-sh\nbuild-aux/ltmain.sh\nbuild-a",https://github.com/bitcoin/bitcoin/pull/18818#discussion_r420908902,420908902,contrib/gitian-descriptors/make_release_tarball
