[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734683947",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20514#issuecomment-734683947",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20514",
    "id": 734683947,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDY4Mzk0Nw==",
    "user": {
      "login": "naumenkogs",
      "id": 7975071,
      "node_id": "MDQ6VXNlcjc5NzUwNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7975071?u=06eb9ae4f9b3f954056098860decccbf1340e40f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naumenkogs",
      "html_url": "https://github.com/naumenkogs",
      "followers_url": "https://api.github.com/users/naumenkogs/followers",
      "following_url": "https://api.github.com/users/naumenkogs/following{/other_user}",
      "gists_url": "https://api.github.com/users/naumenkogs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
      "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
      "repos_url": "https://api.github.com/users/naumenkogs/repos",
      "events_url": "https://api.github.com/users/naumenkogs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-27T07:13:50Z",
    "updated_at": "2020-11-27T07:28:01Z",
    "author_association": "MEMBER",
    "body": "utACK.\r\n\r\nI assume this code won't fail a node if you feed it an older anchors.dat format? At least I think it should not.\r\n\r\nPushing it to 0.21 solves it at scale, but we probably want to handle even corner cases.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734683947/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734686623",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20514#issuecomment-734686623",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20514",
    "id": 734686623,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDY4NjYyMw==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-27T07:21:15Z",
    "updated_at": "2020-11-27T07:21:15Z",
    "author_association": "MEMBER",
    "body": "@naumenkogs Yes, it should be as deserialization uses the version number written in the CAddress record. So anchors.dat from rc1 or rc2 should be read correctly.\n\nStill, it seems there aren't any tests for the anchoring functionality, so it'd be good if someone wrote one, or it gets tested manually.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734686623/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734776843",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20514#issuecomment-734776843",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20514",
    "id": 734776843,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDc3Njg0Mw==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-27T10:57:50Z",
    "updated_at": "2020-11-27T10:57:50Z",
    "author_association": "MEMBER",
    "body": "Concept ACK, could use test coverage.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734776843/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734780212",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20514#issuecomment-734780212",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20514",
    "id": 734780212,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDc4MDIxMg==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-27T11:05:54Z",
    "updated_at": "2020-11-27T11:05:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "> it's very possible I've misread the code - this is split across addrdb/netaddress/net\r\n\r\nI think you read it correctly (or at least I read it in the same way). It will deserialize 0s from disk which will be invalid addresses which later will be skipped gracefully:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/50091592dd875a1c94030dbed74112b003732d68/src/net.cpp#L1971-L1975",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734780212/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734780327",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20514#issuecomment-734780327",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20514",
    "id": 734780327,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDc4MDMyNw==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-27T11:06:10Z",
    "updated_at": "2020-11-27T11:06:10Z",
    "author_association": "MEMBER",
    "body": "> it uses the client version stored in the CAddress records to decide which deserializer to use.\r\n\r\n> anchors.dat from rc1 or rc2 should be read correctly.\r\n\r\n@sipa I don't understand this. With this PR, we always unserialize anchors.dat using a CAutoFile with version ADDRV2_FORMAT. I think the version stored in the CAddress will be used to deserialize the services in the CAddress, but the underlying CNetAddr will always be unserialized as addrv2.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734780327/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734783860",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20514#issuecomment-734783860",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20514",
    "id": 734783860,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDc4Mzg2MA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-27T11:14:38Z",
    "updated_at": "2020-11-27T11:14:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "I think the inconsistency in `CAddress` deserialization should be fixed in one way (#20509) or another:\r\n\r\n<details>\r\n<summary>fix CAddress deser inconsistency</summary>\r\n\r\n```diff\r\ndiff --git i/src/protocol.h w/src/protocol.h\r\nindex 309fac621..634a1a91a 100644\r\n--- i/src/protocol.h\r\n+++ w/src/protocol.h\r\n@@ -367,17 +367,17 @@ public:\r\n     CAddress(CService ipIn, ServiceFlags nServicesIn, uint32_t nTimeIn) : CService{ipIn}, nTime{nTimeIn}, nServices{nServicesIn} {};\r\n \r\n     SERIALIZE_METHODS(CAddress, obj)\r\n     {\r\n         SER_READ(obj, obj.nTime = TIME_INIT);\r\n         int nVersion = s.GetVersion();\r\n-        if (s.GetType() & SER_DISK) {\r\n+        const bool is_disk_ser = s.GetType() & SER_DISK;\r\n+        if (is_disk_ser) {\r\n             READWRITE(nVersion);\r\n         }\r\n-        if ((s.GetType() & SER_DISK) ||\r\n-            (nVersion != INIT_PROTO_VERSION && !(s.GetType() & SER_GETHASH))) {\r\n+        if (is_disk_ser || (nVersion != INIT_PROTO_VERSION && !(s.GetType() & SER_GETHASH))) {\r\n             // The only time we serialize a CAddress object without nTime is in\r\n             // the initial VERSION messages which contain two CAddress records.\r\n             // At that point, the serialization version is INIT_PROTO_VERSION.\r\n             // After the version handshake, serialization version is >=\r\n             // MIN_PEER_PROTO_VERSION and all ADDR messages are serialized with\r\n             // nTime.\r\n@@ -388,13 +388,16 @@ public:\r\n             SER_WRITE(obj, services_tmp = obj.nServices);\r\n             READWRITE(Using<CompactSizeFormatter<false>>(services_tmp));\r\n             SER_READ(obj, obj.nServices = static_cast<ServiceFlags>(services_tmp));\r\n         } else {\r\n             READWRITE(Using<CustomUintFormatter<8>>(obj.nServices));\r\n         }\r\n+        const int stream_version_orig = s.GetVersion();\r\n+        SER_READ(obj, if (is_disk_ser) { s.SetVersion(nVersion); });\r\n         READWRITEAS(CService, obj);\r\n+        SER_READ(obj, if (is_disk_ser) { s.SetVersion(stream_version_orig); });\r\n     }\r\n```\r\n</details>\r\n\r\nThe above patch, on top of this PR will:\r\n* Fix the problem which #20509 is fixing, so that PR can be closed\r\n* Make \"old\" `anchors.dat` readable (that may not be a concern, other than some obscure/scary message about being unable to read `anchors.dat` when a user/tester upgrades from rc2 to rc3)\r\n* Work just fine if there is ever addrv3 format",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734783860/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734787077",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20514#issuecomment-734787077",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20514",
    "id": 734787077,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDc4NzA3Nw==",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?u=7297e8aaf9188c0cb98bc549a8a02a1dc8d59e4c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-27T11:22:23Z",
    "updated_at": "2020-11-27T11:22:23Z",
    "author_association": "MEMBER",
    "body": ">  * Work just fine if there is ever addrv3 format\r\n\r\nFuture proof is good.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734787077/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734809739",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20514#issuecomment-734809739",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20514",
    "id": 734809739,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDgwOTczOQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-27T12:21:16Z",
    "updated_at": "2020-11-27T12:21:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "> I think the same problem exists for banlist.dat - we'll always serialize/deserialize in addrv1 format.\r\n\r\nTrue that we will always ser/deser in addrv1, but that is not a problem because the banlist contains `CSubNet` objects which must be either IPv4 or IPv6 (no Tor v3 involved):\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/e2ff5e7b35d71195278d2a2ed9485f141de33d7a/src/netaddress.cpp#L992-L995",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734809739/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734811296",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20514#issuecomment-734811296",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20514",
    "id": 734811296,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDgxMTI5Ng==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-27T12:25:30Z",
    "updated_at": "2020-11-27T12:25:30Z",
    "author_association": "MEMBER",
    "body": "> that is not a problem because the banlist contains CSubNet objects which must be either IPv4 or IPv6 (no Tor v3 involved)\r\n\r\nAh good. Thanks @vasild!",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734811296/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734920438",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20514#issuecomment-734920438",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20514",
    "id": 734920438,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDkyMDQzOA==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-27T16:56:00Z",
    "updated_at": "2020-11-27T16:56:00Z",
    "author_association": "MEMBER",
    "body": "@vasild Did you see #20516?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734920438/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734922990",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20514#issuecomment-734922990",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20514",
    "id": 734922990,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDkyMjk5MA==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-27T17:03:43Z",
    "updated_at": "2020-11-27T17:03:43Z",
    "author_association": "MEMBER",
    "body": "@jnewbery Oops, yes, that is only true when combined with #20516, or with @vasild's patch above.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734922990/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734954531",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20514#issuecomment-734954531",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20514",
    "id": 734954531,
    "node_id": "MDEyOklzc3VlQ29tbWVudDczNDk1NDUzMQ==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-27T19:01:01Z",
    "updated_at": "2020-11-27T19:01:01Z",
    "author_association": "MEMBER",
    "body": "> If I'm right, then I don't think we necessarily need to fix this for 0.21. We didn't have anchor connections or torv3 before, so the fact that they don't work together isn't a regression and can always be fixed up later\r\n\r\nThat's fair, and you've shown that this PR as-is actually makes things worse, as it'll fail to deserialize the `CService` object.\r\n\r\nTo fix it, we'll either need @vasild's patch from https://github.com/bitcoin/bitcoin/pull/20514#issuecomment-734783860, or doing it on top of #20516. I'm going to close this PR, and take the functionality there.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/734954531/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/531498359",
    "pull_request_review_id": 539849703,
    "id": 531498359,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTQ5ODM1OQ==",
    "diff_hunk": "@@ -161,13 +161,13 @@ bool CAddrDB::Read(CAddrMan& addr, CDataStream& ssPeers)\n void DumpAnchors(const fs::path& anchors_db_path, const std::vector<CAddress>& anchors)\n {\n     LOG_TIME_SECONDS(strprintf(\"Flush %d outbound block-relay-only peer addresses to anchors.dat\", anchors.size()));\n-    SerializeFileDB(\"anchors\", anchors_db_path, anchors);\n+    SerializeFileDB(\"anchors\", anchors_db_path, anchors, ADDRV2_FORMAT);",
    "path": "src/addrdb.cpp",
    "position": 46,
    "original_position": 46,
    "commit_id": "8ed2c72a063576b5c114cd006c47369a72e9a61b",
    "original_commit_id": "8ed2c72a063576b5c114cd006c47369a72e9a61b",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Maybe this comment should be updated, given that now `ADDRV2_FORMAT` is also used here instead of `CLIENT_VERSION`:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/50091592dd875a1c94030dbed74112b003732d68/src/netaddress.h#L26-L32",
    "created_at": "2020-11-27T10:01:04Z",
    "updated_at": "2020-11-27T10:19:11Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20514#discussion_r531498359",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20514",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/531498359"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20514#discussion_r531498359"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20514"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/531498359/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 164,
    "original_line": 164,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/531507712",
    "pull_request_review_id": 539849703,
    "id": 531507712,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTUwNzcxMg==",
    "diff_hunk": "@@ -161,13 +161,13 @@ bool CAddrDB::Read(CAddrMan& addr, CDataStream& ssPeers)\n void DumpAnchors(const fs::path& anchors_db_path, const std::vector<CAddress>& anchors)\n {\n     LOG_TIME_SECONDS(strprintf(\"Flush %d outbound block-relay-only peer addresses to anchors.dat\", anchors.size()));\n-    SerializeFileDB(\"anchors\", anchors_db_path, anchors);\n+    SerializeFileDB(\"anchors\", anchors_db_path, anchors, ADDRV2_FORMAT);\n }\n \n std::vector<CAddress> ReadAnchors(const fs::path& anchors_db_path)\n {\n     std::vector<CAddress> anchors;\n-    if (DeserializeFileDB(anchors_db_path, anchors)) {\n+    if (DeserializeFileDB(anchors_db_path, anchors, ADDRV2_FORMAT)) {",
    "path": "src/addrdb.cpp",
    "position": 53,
    "original_position": 53,
    "commit_id": "8ed2c72a063576b5c114cd006c47369a72e9a61b",
    "original_commit_id": "8ed2c72a063576b5c114cd006c47369a72e9a61b",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think this will not deserialize properly `anchors.dat` from before this PR.\r\n* `CLIENT_VERSION` is something like `219900`\r\n* `ADDRV2_FORMAT` is `0x20000000`\r\n\r\nIn `anchors.dat` before this PR we have `CAddress` entries which contain `version=219900` and addresses serialized in addrv1 format.\r\n\r\nWith this PR we will set the stream version to `ADDRV2_FORMAT` during [deserialize](https://github.com/bitcoin/bitcoin/blob/50091592dd875a1c94030dbed74112b003732d68/src/protocol.h#L369-L395):\r\n\r\n```cpp\r\n    // Notice added comments below\r\n    SERIALIZE_METHODS(CAddress, obj)\r\n    {\r\n        SER_READ(obj, obj.nTime = TIME_INIT);\r\n        int nVersion = s.GetVersion(); // nVersion will be assigned ADDRV2_FORMAT (0x20000000)\r\n        if (s.GetType() & SER_DISK) {\r\n            READWRITE(nVersion); // nVersion will be assigned CLIENT_VERSION (219900)\r\n        }\r\n...\r\n        if (nVersion & ADDRV2_FORMAT) { // this will be false\r\n            uint64_t services_tmp;\r\n            SER_WRITE(obj, services_tmp = obj.nServices);\r\n            READWRITE(Using<CompactSizeFormatter<false>>(services_tmp));\r\n            SER_READ(obj, obj.nServices = static_cast<ServiceFlags>(services_tmp));\r\n        } else {\r\n            // it will read services as 8 bytes (correct, as that is what is actually stored on disk)\r\n            READWRITE(Using<CustomUintFormatter<8>>(obj.nServices));\r\n        }\r\n        // oops, this will deserialize CService, which will deserialize CNetAddr which will check\r\n        // s.GetVersion() which is ADDRV2_FORMAT (0x20000000) and will deserialize the\r\n        // address as if it is stored in addrv2 format on disk, but it is actually stored in addrv1,\r\n        // so this will deserialize garbage\r\n        READWRITEAS(CService, obj);\r\n    }\r\n```",
    "created_at": "2020-11-27T10:18:00Z",
    "updated_at": "2020-11-27T10:19:11Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20514#discussion_r531507712",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20514",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/531507712"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20514#discussion_r531507712"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20514"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/531507712/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 170,
    "original_line": 170,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/531515369",
    "pull_request_review_id": 539871667,
    "id": 531515369,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTUxNTM2OQ==",
    "diff_hunk": "@@ -161,13 +161,13 @@ bool CAddrDB::Read(CAddrMan& addr, CDataStream& ssPeers)\n void DumpAnchors(const fs::path& anchors_db_path, const std::vector<CAddress>& anchors)\n {\n     LOG_TIME_SECONDS(strprintf(\"Flush %d outbound block-relay-only peer addresses to anchors.dat\", anchors.size()));\n-    SerializeFileDB(\"anchors\", anchors_db_path, anchors);\n+    SerializeFileDB(\"anchors\", anchors_db_path, anchors, ADDRV2_FORMAT);\n }\n \n std::vector<CAddress> ReadAnchors(const fs::path& anchors_db_path)\n {\n     std::vector<CAddress> anchors;\n-    if (DeserializeFileDB(anchors_db_path, anchors)) {\n+    if (DeserializeFileDB(anchors_db_path, anchors, ADDRV2_FORMAT)) {",
    "path": "src/addrdb.cpp",
    "position": 53,
    "original_position": 53,
    "commit_id": "8ed2c72a063576b5c114cd006c47369a72e9a61b",
    "original_commit_id": "8ed2c72a063576b5c114cd006c47369a72e9a61b",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think in this case the file checksum will mismatch and we won't load any anchors at all, which is ok (anchors.dat is not in any release and losing the file isn't a problem).",
    "created_at": "2020-11-27T10:32:02Z",
    "updated_at": "2020-11-27T10:32:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20514#discussion_r531515369",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20514",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/531515369"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20514#discussion_r531515369"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20514"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/531515369/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 170,
    "original_line": 170,
    "side": "RIGHT",
    "in_reply_to_id": 531507712
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/531523841",
    "pull_request_review_id": 539880875,
    "id": 531523841,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTUyMzg0MQ==",
    "diff_hunk": "@@ -161,13 +161,13 @@ bool CAddrDB::Read(CAddrMan& addr, CDataStream& ssPeers)\n void DumpAnchors(const fs::path& anchors_db_path, const std::vector<CAddress>& anchors)\n {\n     LOG_TIME_SECONDS(strprintf(\"Flush %d outbound block-relay-only peer addresses to anchors.dat\", anchors.size()));\n-    SerializeFileDB(\"anchors\", anchors_db_path, anchors);\n+    SerializeFileDB(\"anchors\", anchors_db_path, anchors, ADDRV2_FORMAT);\n }\n \n std::vector<CAddress> ReadAnchors(const fs::path& anchors_db_path)\n {\n     std::vector<CAddress> anchors;\n-    if (DeserializeFileDB(anchors_db_path, anchors)) {\n+    if (DeserializeFileDB(anchors_db_path, anchors, ADDRV2_FORMAT)) {",
    "path": "src/addrdb.cpp",
    "position": 53,
    "original_position": 53,
    "commit_id": "8ed2c72a063576b5c114cd006c47369a72e9a61b",
    "original_commit_id": "8ed2c72a063576b5c114cd006c47369a72e9a61b",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "My point is that it will not be able to read \"old\" `anchors.dat` (I am not sure of the exact way it will fail, maybe it will be indeed checksum failure).\r\n\r\nI mention this because the comments above give the impression that \"old\" `anchors.dat` would be readable.",
    "created_at": "2020-11-27T10:44:57Z",
    "updated_at": "2020-11-27T10:44:57Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20514#discussion_r531523841",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20514",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/531523841"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20514#discussion_r531523841"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20514"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/531523841/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 170,
    "original_line": 170,
    "side": "RIGHT",
    "in_reply_to_id": 531507712
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/531524544",
    "pull_request_review_id": 539881682,
    "id": 531524544,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTUyNDU0NA==",
    "diff_hunk": "@@ -35,7 +35,7 @@ bool SerializeDB(Stream& stream, const Data& data)\n }\n \n template <typename Data>\n-bool SerializeFileDB(const std::string& prefix, const fs::path& path, const Data& data)\n+bool SerializeFileDB(const std::string& prefix, const fs::path& path, const Data& data, int version = CLIENT_VERSION)",
    "path": "src/addrdb.cpp",
    "position": 14,
    "original_position": 14,
    "commit_id": "8ed2c72a063576b5c114cd006c47369a72e9a61b",
    "original_commit_id": "8ed2c72a063576b5c114cd006c47369a72e9a61b",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I'd prefer this (and DeserializeFileDB) to not have a default argument. There are only three places where they're called, and it seems better to be explicit in those places.",
    "created_at": "2020-11-27T10:46:13Z",
    "updated_at": "2020-11-27T10:54:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20514#discussion_r531524544",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20514",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/531524544"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20514#discussion_r531524544"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20514"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/531524544/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 38,
    "original_line": 38,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/531525415",
    "pull_request_review_id": 539882750,
    "id": 531525415,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUzMTUyNTQxNQ==",
    "diff_hunk": "@@ -161,13 +161,13 @@ bool CAddrDB::Read(CAddrMan& addr, CDataStream& ssPeers)\n void DumpAnchors(const fs::path& anchors_db_path, const std::vector<CAddress>& anchors)\n {\n     LOG_TIME_SECONDS(strprintf(\"Flush %d outbound block-relay-only peer addresses to anchors.dat\", anchors.size()));\n-    SerializeFileDB(\"anchors\", anchors_db_path, anchors);\n+    SerializeFileDB(\"anchors\", anchors_db_path, anchors, ADDRV2_FORMAT);\n }\n \n std::vector<CAddress> ReadAnchors(const fs::path& anchors_db_path)\n {\n     std::vector<CAddress> anchors;\n-    if (DeserializeFileDB(anchors_db_path, anchors)) {\n+    if (DeserializeFileDB(anchors_db_path, anchors, ADDRV2_FORMAT)) {",
    "path": "src/addrdb.cpp",
    "position": 53,
    "original_position": 53,
    "commit_id": "8ed2c72a063576b5c114cd006c47369a72e9a61b",
    "original_commit_id": "8ed2c72a063576b5c114cd006c47369a72e9a61b",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> This should be compatible with (v1) addresses stored by 0.21.0rc{1,2} as well...\r\n\r\nSuch compatibility shouldn't be a point for the reason mentioned by @jnewbery.",
    "created_at": "2020-11-27T10:47:47Z",
    "updated_at": "2020-11-27T10:47:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20514#discussion_r531525415",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20514",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/531525415"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20514#discussion_r531525415"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20514"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/531525415/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 170,
    "original_line": 170,
    "side": "RIGHT",
    "in_reply_to_id": 531507712
  }
]