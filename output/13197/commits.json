[
  {
    "sha": "c5bcc7dbe9af7f4124e7c78159fe36eae3a304d4",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpjNWJjYzdkYmU5YWY3ZjQxMjRlN2M3ODE1OWZlMzZlYWUzYTMwNGQ0",
    "commit": {
      "author": {
        "name": "Karl-Johan Alm",
        "email": "karljohan-alm@garage.co.jp",
        "date": "2018-05-09T07:49:59Z"
      },
      "committer": {
        "name": "Karl-Johan Alm",
        "email": "karljohan-alm@garage.co.jp",
        "date": "2018-05-10T02:02:20Z"
      },
      "message": "util: warn about recursive -includeconf arguments in configuration files\n\nSince -includeconf cannot be used recursively, the user would not see feedback that an -includeconf\nin an -includeconf'd file was silently ignored.",
      "tree": {
        "sha": "86657083fbed158fe4aaaade7c718b818de43a3b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/86657083fbed158fe4aaaade7c718b818de43a3b"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c5bcc7dbe9af7f4124e7c78159fe36eae3a304d4",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEExCr/fGGz5EoUVM01V692LbM1MyIFAlrzqCwACgkQV692LbM1\nMyIFQA/+JTdkB+gNMXSVdxJjum+9zd1500anTgO4WDDLKz1AecORXd10KbEvyg1r\nkSBFjOnOMN1KUg8+3U+6/7RMR0kS9Akzdi2pFMo4hMHupstLZBDEWHDnpH8FrPFQ\n4clwh6kung62CvWaZ3ycvC4AfvbXUXR33uZfGrKtQ0veXhPIstgl6tUomPmCYGjq\ncezF4fCpe3WQ66fQPD5oByV0IPzia8I3btBxugNk5FBKk7lwjOq7G5CpjwaP1q7T\nPI+ycJnvPfbc22l3JP23GzfJYnInhfqsStOtAcUyUSwzMKivdzhgd2D3Njc2hxtX\n454WDmv9NDCrwdgT3lc79tHNKY9Ltgti5IS6/FWe3OrT5sKHvTX27fEMESlZuaGF\njo0Mfn3OZAHkY0Y0Np9xL1KJruojPn5sYl1HaHhkbBc0IOGhOsY5YXMHP25PoF38\nlTzhUZXgeLND6XEoRapVOL/5C9MRde3ZtR+JBj1klUmvleWO2jlvuw0RYAuP6XoX\nNbvnx0UkCncA1KWwq+Ad83niAshPOatwMXTFkibsZ6eSGu0vs7tCbUzQ9kbX4o9W\nZS+eim+7f6Lfxb2ZM63VBKylUc/ZW18YEc7E4Mx64dFuFfplWKNh46aYo/ZCk/Hl\nL16cWnX/h7Z1HOrYX+ULPNRx22DEwfkiFk/nGB02AdC635g7p94=\n=Ubyq\n-----END PGP SIGNATURE-----",
        "payload": "tree 86657083fbed158fe4aaaade7c718b818de43a3b\nparent 196c5a947a071f7c9c5b211f0a47787a7d540ecb\nauthor Karl-Johan Alm <karljohan-alm@garage.co.jp> 1525852199 +0900\ncommitter Karl-Johan Alm <karljohan-alm@garage.co.jp> 1525917740 +0900\n\nutil: warn about recursive -includeconf arguments in configuration files\n\nSince -includeconf cannot be used recursively, the user would not see feedback that an -includeconf\nin an -includeconf'd file was silently ignored.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c5bcc7dbe9af7f4124e7c78159fe36eae3a304d4",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/c5bcc7dbe9af7f4124e7c78159fe36eae3a304d4",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c5bcc7dbe9af7f4124e7c78159fe36eae3a304d4/comments",
    "author": {
      "login": "kallewoof",
      "id": 250224,
      "node_id": "MDQ6VXNlcjI1MDIyNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/250224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kallewoof",
      "html_url": "https://github.com/kallewoof",
      "followers_url": "https://api.github.com/users/kallewoof/followers",
      "following_url": "https://api.github.com/users/kallewoof/following{/other_user}",
      "gists_url": "https://api.github.com/users/kallewoof/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kallewoof/subscriptions",
      "organizations_url": "https://api.github.com/users/kallewoof/orgs",
      "repos_url": "https://api.github.com/users/kallewoof/repos",
      "events_url": "https://api.github.com/users/kallewoof/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kallewoof/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "kallewoof",
      "id": 250224,
      "node_id": "MDQ6VXNlcjI1MDIyNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/250224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kallewoof",
      "html_url": "https://github.com/kallewoof",
      "followers_url": "https://api.github.com/users/kallewoof/followers",
      "following_url": "https://api.github.com/users/kallewoof/following{/other_user}",
      "gists_url": "https://api.github.com/users/kallewoof/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kallewoof/subscriptions",
      "organizations_url": "https://api.github.com/users/kallewoof/orgs",
      "repos_url": "https://api.github.com/users/kallewoof/repos",
      "events_url": "https://api.github.com/users/kallewoof/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kallewoof/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "196c5a947a071f7c9c5b211f0a47787a7d540ecb",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/196c5a947a071f7c9c5b211f0a47787a7d540ecb",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/196c5a947a071f7c9c5b211f0a47787a7d540ecb"
      }
    ],
    "stats": {
      "total": 18,
      "additions": 18,
      "deletions": 0
    },
    "files": [
      {
        "sha": "6a2b2c1ed4cb6d7afea8592443b52d64cb5313bb",
        "filename": "src/util.cpp",
        "status": "modified",
        "additions": 18,
        "deletions": 0,
        "changes": 18,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/c5bcc7dbe9af7f4124e7c78159fe36eae3a304d4/src/util.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/c5bcc7dbe9af7f4124e7c78159fe36eae3a304d4/src/util.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util.cpp?ref=c5bcc7dbe9af7f4124e7c78159fe36eae3a304d4",
        "patch": "@@ -790,6 +790,14 @@ void ArgsManager::ReadConfigFiles()\n                 includeconf.insert(includeconf.end(), includeconf_net.begin(), includeconf_net.end());\n             }\n \n+            // Remove -includeconf from configuration, so we can warn about recursion\n+            // later\n+            {\n+                LOCK(cs_args);\n+                m_config_args.erase(\"-includeconf\");\n+                m_config_args.erase(std::string(\"-\") + GetChainName() + \".includeconf\");\n+            }\n+\n             for (const std::string& to_include : includeconf) {\n                 fs::ifstream include_config(GetConfigFile(to_include));\n                 if (include_config.good()) {\n@@ -799,6 +807,16 @@ void ArgsManager::ReadConfigFiles()\n                     fprintf(stderr, \"Failed to include configuration file %s\\n\", to_include.c_str());\n                 }\n             }\n+\n+            // Warn about recursive -includeconf\n+            includeconf = GetArgs(\"-includeconf\");\n+            {\n+                std::vector<std::string> includeconf_net(GetArgs(std::string(\"-\") + GetChainName() + \".includeconf\"));\n+                includeconf.insert(includeconf.end(), includeconf_net.begin(), includeconf_net.end());\n+            }\n+            for (const std::string& to_include : includeconf) {\n+                fprintf(stderr, \"warning: -includeconf cannot be used from included files; ignoring -includeconf=%s\\n\", to_include.c_str());\n+            }\n         }\n     }\n "
      }
    ]
  },
  {
    "sha": "2352aa9f3681fbcfb89a1910d9c5529dac9ca2e9",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyMzUyYWE5ZjM2ODFmYmNmYjg5YTE5MTBkOWM1NTI5ZGFjOWNhMmU5",
    "commit": {
      "author": {
        "name": "Karl-Johan Alm",
        "email": "karljohan-alm@garage.co.jp",
        "date": "2018-05-09T07:50:02Z"
      },
      "committer": {
        "name": "Karl-Johan Alm",
        "email": "karljohan-alm@garage.co.jp",
        "date": "2018-05-10T02:06:04Z"
      },
      "message": "test: Ensure that recursive -includeconf produces appropriate warnings",
      "tree": {
        "sha": "302c1ceeca1d2734fca66547296071b1ded28abe",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/302c1ceeca1d2734fca66547296071b1ded28abe"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2352aa9f3681fbcfb89a1910d9c5529dac9ca2e9",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEExCr/fGGz5EoUVM01V692LbM1MyIFAlrzqQwACgkQV692LbM1\nMyLDIw/9EzeYOIE9Du8cd57JyoIcoP9JyIr8nt/x6NugZWitY5NciftuO9LaU5Gg\nD8uyuxxfPuf+wIFaz5NYD2sOf28oRj/nDDr0uRY/nQ1QPuuCYalhQcdnL8/nn0Wb\nho6DcOTlYuxvrBg3FExYdokLaRUjS9ZmRIEoZ/5o95WBV9IcYnjKIaZ3ulFfjR1h\nTzqGQ+iaouBxeA5op5028f8I5Tf143X/NKzji+WHWBfp472iWU4kOh1du4hw4TNj\nfr0pLWwVsUX82IjZedVtVA/MZEcjoyrD1MkRfI/qMjftLOzG0GZp1lHv87fpmJQA\n5lM9sJ7E119kzih21fzB1EdwwNWqmRS/OggcSemxUbQoLLh6WA4E7ohLYT64vjMV\nD2a/p6dg6WAF6u+fQTTQ7BXY7NVjxm1FYBp30b/sZFmuDJ/vohF04xJZBpeDCzcu\n7/qwX7j5Zk4wqT0IlweRuTyeRjVJAzw8LnWzJF1DITJ7vsqK8C17mhf+DVtdO6Q2\nekHKRU4nwx1QDxLlgXUfysFe1P+c8p+Y1ev80DhnvR7Yun1+I+eznGJbkSfbyQpY\n1gtdFwuwP1SQJo3JdRBRW1pLkX2cSCKK4uSFlQdc48GvkDiCXGIpLnUXIMVzvGPa\nB3dYKfbdUBgbPqCSpchX0kXITfNwmLmB7V45ofTeIir/sJ0Y28s=\n=qq0y\n-----END PGP SIGNATURE-----",
        "payload": "tree 302c1ceeca1d2734fca66547296071b1ded28abe\nparent c5bcc7dbe9af7f4124e7c78159fe36eae3a304d4\nauthor Karl-Johan Alm <karljohan-alm@garage.co.jp> 1525852202 +0900\ncommitter Karl-Johan Alm <karljohan-alm@garage.co.jp> 1525917964 +0900\n\ntest: Ensure that recursive -includeconf produces appropriate warnings\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2352aa9f3681fbcfb89a1910d9c5529dac9ca2e9",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/2352aa9f3681fbcfb89a1910d9c5529dac9ca2e9",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2352aa9f3681fbcfb89a1910d9c5529dac9ca2e9/comments",
    "author": {
      "login": "kallewoof",
      "id": 250224,
      "node_id": "MDQ6VXNlcjI1MDIyNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/250224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kallewoof",
      "html_url": "https://github.com/kallewoof",
      "followers_url": "https://api.github.com/users/kallewoof/followers",
      "following_url": "https://api.github.com/users/kallewoof/following{/other_user}",
      "gists_url": "https://api.github.com/users/kallewoof/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kallewoof/subscriptions",
      "organizations_url": "https://api.github.com/users/kallewoof/orgs",
      "repos_url": "https://api.github.com/users/kallewoof/repos",
      "events_url": "https://api.github.com/users/kallewoof/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kallewoof/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "kallewoof",
      "id": 250224,
      "node_id": "MDQ6VXNlcjI1MDIyNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/250224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kallewoof",
      "html_url": "https://github.com/kallewoof",
      "followers_url": "https://api.github.com/users/kallewoof/followers",
      "following_url": "https://api.github.com/users/kallewoof/following{/other_user}",
      "gists_url": "https://api.github.com/users/kallewoof/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kallewoof/subscriptions",
      "organizations_url": "https://api.github.com/users/kallewoof/orgs",
      "repos_url": "https://api.github.com/users/kallewoof/repos",
      "events_url": "https://api.github.com/users/kallewoof/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kallewoof/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "c5bcc7dbe9af7f4124e7c78159fe36eae3a304d4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c5bcc7dbe9af7f4124e7c78159fe36eae3a304d4",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/c5bcc7dbe9af7f4124e7c78159fe36eae3a304d4"
      }
    ],
    "stats": {
      "total": 4,
      "additions": 2,
      "deletions": 2
    },
    "files": [
      {
        "sha": "9ccb89af434a072e2ae26376d319d51ceaa793e8",
        "filename": "test/functional/feature_includeconf.py",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/2352aa9f3681fbcfb89a1910d9c5529dac9ca2e9/test/functional/feature_includeconf.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/2352aa9f3681fbcfb89a1910d9c5529dac9ca2e9/test/functional/feature_includeconf.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/feature_includeconf.py?ref=2352aa9f3681fbcfb89a1910d9c5529dac9ca2e9",
        "patch": "@@ -53,11 +53,11 @@ def run_test(self):\n         self.log.info(\"-includeconf cannot be used recursively. subversion should end with 'main; relative)/'\")\n         with open(os.path.join(self.options.tmpdir, \"node0\", \"relative.conf\"), \"a\", encoding=\"utf8\") as f:\n             f.write(\"includeconf=relative2.conf\\n\")\n-\n         self.start_node(0)\n \n         subversion = self.nodes[0].getnetworkinfo()[\"subversion\"]\n         assert subversion.endswith(\"main; relative)/\")\n+        self.stop_node(0, expected_stderr=\"warning: -includeconf cannot be used from included files; ignoring -includeconf=relative2.conf\")\n \n         self.log.info(\"multiple -includeconf args can be used from the base config file. subversion should end with 'main; relative; relative2)/'\")\n         with open(os.path.join(self.options.tmpdir, \"node0\", \"relative.conf\"), \"w\", encoding=\"utf8\") as f:\n@@ -66,7 +66,7 @@ def run_test(self):\n         with open(os.path.join(self.options.tmpdir, \"node0\", \"bitcoin.conf\"), \"a\", encoding='utf8') as f:\n             f.write(\"includeconf=relative2.conf\\n\")\n \n-        self.restart_node(0)\n+        self.start_node(0)\n \n         subversion = self.nodes[0].getnetworkinfo()[\"subversion\"]\n         assert subversion.endswith(\"main; relative; relative2)/\")"
      }
    ]
  }
]