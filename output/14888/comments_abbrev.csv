gmaxwell,2018-12-06T19:07:24Z,"NAK.  Network IsStandard rules prohibit multiple op_returns (https://github.com/bitcoin/bitcoin/blob/master/src/policy/policy.cpp#L135), additional bloat on the blockchain is also not desired. The inputs to this RPC are also an array, so duplicating inputs is also pretty broken.",https://github.com/bitcoin/bitcoin/pull/14888#issuecomment-444991074,444991074,
isghe,2018-12-06T19:17:12Z,"@gmaxwell so maybe we should raise an error? Because actually it's producing a strange thing\n```\nbitcoin-cli createrawtransaction ""[]"" ""{\""data\"":\""ee\"", \""data\"":\""ff\""}""\n0200000000020000000000000000036a01ee0000000000000000036a01ee00000000\n```\n",https://github.com/bitcoin/bitcoin/pull/14888#issuecomment-444994824,444994824,
Empact,2018-12-06T21:08:28Z,"@isghe you can help review by making your PR minimal:\n> Patchsets should always be focused. For example, a pull request could add a feature, fix a bug, or refactor code; but not a mixture.\nhttps://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#pull-request-philosophy",https://github.com/bitcoin/bitcoin/pull/14888#issuecomment-445030078,445030078,
DrahtBot,2018-12-06T21:34:30Z,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#14890](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14890.html) (rpc: Avoid creating non-standard raw transa",https://github.com/bitcoin/bitcoin/pull/14888#issuecomment-445037612,445037612,
isghe,2018-12-06T23:08:01Z,"https://github.com/isghe/bitcoin/commits/raise-error-createrawtransaction-multi-OP_RETURN \njust adding on this PR\n```c++\n    const CTransaction rawTxCopy (rawTx);\n    std::string error;\n    if (!IsStandardTx (rawTxCopy, error)) {\n        throw JSONRPCError(RPC_INVALID_PARAMETER, ""Invalid parameter combination: "" + error);\n    }\n```\nobtaining:\n```\n$ ./src/bitcoin-cli createraw",https://github.com/bitcoin/bitcoin/pull/14888#issuecomment-445063560,445063560,
Empact,2018-12-06T23:23:24Z,"5987b7cadd15cd1b524fec430868ee0c174f06da makes sense to me, independent of this issue. Calls for another PR IMO.",https://github.com/bitcoin/bitcoin/pull/14888#issuecomment-445066983,445066983,
isghe,2018-12-06T23:42:39Z,"@Empact my idea, is that `createrawtransaction` should check if a transaction is standard or not, just delegating to `IsStandardTx` function. If not, we are spreading the rules in the source code, and  doesn't sound good. At this point I think it would be better to create a PR removing hard-coded rules written in `createrawtransaction`, delegating the all things to `IsStandardTx`. I'll work on it,",https://github.com/bitcoin/bitcoin/pull/14888#issuecomment-445071021,445071021,
isghe,2018-12-07T01:38:45Z,"anyway, `createrawtransaction` could be created as an external tool, without affecting the consensus rules\n",https://github.com/bitcoin/bitcoin/pull/14888#issuecomment-445092688,445092688,
Empact,2018-12-07T02:07:24Z,"@isghe to get this done safely and most easily, I recommend approaching this incrementally, e.g.:\n1) fixing the immediate issue\n2) applying the `IsStandardTx` check to `createrawtransaction`\n3) removing the then-redundant checks",https://github.com/bitcoin/bitcoin/pull/14888#issuecomment-445097754,445097754,
gmaxwell,2018-12-07T09:26:59Z,"Rejecting duplicate data fields instead of mangling them is the right thing to do regardless of standardness rules:  as I pointed out, the input is a dictionary...  and also even if standardness permitted multiple op_returns we probably would not support it. \n\nIsStandard probably shouldn't be run on non-final/signed transactions so it isn't a solution here.  (It might actually work, but if so ",https://github.com/bitcoin/bitcoin/pull/14888#issuecomment-445173267,445173267,
promag,2018-12-07T09:48:23Z,"NACK, this changes nothing.",https://github.com/bitcoin/bitcoin/pull/14888#issuecomment-445178982,445178982,
DrahtBot,2018-12-07T16:45:59Z,<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase,https://github.com/bitcoin/bitcoin/pull/14888#issuecomment-445292286,445292286,
isghe,2018-12-07T18:36:42Z,@gmaxwell thanks for the explanation. I think we can close this PR.,https://github.com/bitcoin/bitcoin/pull/14888#issuecomment-445324795,445324795,
