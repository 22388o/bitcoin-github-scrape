jonasschnelli,2017-11-06T03:03:40Z,"Tend to NACK.\nOne of the downsides of our RPC concept is that everything is based on JSON. JSON has serval downsides ([parsing is in general a minefield](http://seriot.ch/parsing_json.php)).\n\nIMO ZMQ should be JSON-free and ideally binary/net-serialized only.\n\nWhy not just listening via ZMQ and fetch the required data via RPC if a ZMQ notification arrives?\n\nOr where is the benefit of",https://github.com/bitcoin/bitcoin/pull/11614#issuecomment-342034646,342034646,
astanway,2017-11-06T03:10:07Z,"The benefit is much greater speed than through RPC, primarily because ZMQ can be configured to use a unix domain socket instead of TCP (which RPC currently does not support). In addition, to listen for `hashtx` via ZMQ and then make an additional RPC request with it seems like a waste, when the needed data could be sent right off the bat.\n\nRe: decoding client side - by decoding with the same m",https://github.com/bitcoin/bitcoin/pull/11614#issuecomment-342035396,342035396,
dcousens,2017-11-06T03:43:57Z,@astanway perhaps a better long term outcome is some kind of IPC socket instead of the RPC/ZMQ.,https://github.com/bitcoin/bitcoin/pull/11614#issuecomment-342039041,342039041,
promag,2017-11-06T08:19:28Z,">  as opposed to rolling your own decoder which might differ / be buggy / lack features, especially as time goes on and the RPC output is possibly changed\n\nThere are libraries for this already.\n\nIMO rich notifications are fine, even though it is possible to have the same data thru RPC or some client library. With `rawtx` you just have to parse the JSON and for prototypes or simple applicat",https://github.com/bitcoin/bitcoin/pull/11614#issuecomment-342076135,342076135,
laanwj,2017-11-06T08:54:40Z,"> IMO ZMQ should be JSON-free and ideally binary/net-serialized only.\n\nI tend to agree here. The point of ZMQ is that it's fast, and adding JSON overhead (formatting on the server, parsing on the client) negates that. \nWhy doesn't your application process the raw transaction data instead?\n\n> as opposed to rolling your own decoder which might differ / be buggy / lack features, especially ",https://github.com/bitcoin/bitcoin/pull/11614#issuecomment-342083858,342083858,
promag,2017-11-06T09:38:47Z,"FYI this was discussed here https://github.com/bitcoin/bitcoin/pull/6103#issuecomment-99076113.\n\nThis being an option and using the same RPC format I keep the concept ACK. IMO the overhead is not that much (or it shouldn't be). Also, everything is in place to easily add new notifiers.",https://github.com/bitcoin/bitcoin/pull/11614#issuecomment-342094713,342094713,
astanway,2017-11-10T00:46:58Z,"As far as performance goes - if the option is not enabled, it has zero impact (as far as I can understand from the rest of ZMQ project).\n\nI haven't yet really heard a compelling reason to _not_ add it - I think it's a very convenient and useful feature and will enable a lot of people to start developing quickly, without needing to write their own transaction parser from scratch (difficult) or ",https://github.com/bitcoin/bitcoin/pull/11614#issuecomment-343340100,343340100,
dcousens,2017-11-10T01:38:44Z,">  transaction parser from scratch (difficult) \n\nThere are libraries in nearly every language you would use.  It is probably a 1-line function call.\n\nThe only reasonable advantage of the RPC format** is the *extra* information encoded into the JSON format,  eg block information that would otherwise be an *extra* round trip.",https://github.com/bitcoin/bitcoin/pull/11614#issuecomment-343348852,343348852,
astanway,2017-11-10T01:47:03Z,"> There are libraries in nearly every language you would use. It is probably a 1-line function call.\n\nTruly there are not; the state of transaction parsers is in pretty horrible shape and none really match the canonical RPC JSON output.\n\n> The only reasonable advantage of the RPC \n\nSorry, not sure what we're talking about - I am defending using this ZMQ extension, not RPC.",https://github.com/bitcoin/bitcoin/pull/11614#issuecomment-343350238,343350238,
dcousens,2017-11-10T01:55:12Z,"> I am defending using this ZMQ extension, not RPC.\n\nApologies,  I meant the RPC *JSON format*.  Edited my reply to fit that.\n\n> Truly there are not; the state of transaction parsers is in pretty horrible shape and none really match the canonical RPC JSON output.\n\nWhat language(s) are you using?\nTransaction parsing is a relatively simple task,  approximating about 50-120 lines of cod",https://github.com/bitcoin/bitcoin/pull/11614#issuecomment-343351484,343351484,
luke-jr,2017-11-10T16:30:06Z,This is too wasteful and pointless IMO. Just decode the raw transaction on the client side.,https://github.com/bitcoin/bitcoin/pull/11614#issuecomment-343520396,343520396,
jnewbery,2018-03-27T20:33:42Z,"I'm a -0 on this, for the reasons from @jonasschnelli and @laanwj .\n\nThis doesn't seem to have garnered support. @astanway - are you happy to close this?",https://github.com/bitcoin/bitcoin/pull/11614#issuecomment-376665575,376665575,
astanway,2018-03-27T22:05:41Z,"I still think it can be quite useful to a lot of folks who want to get started developing on top of the blockchain. There's no reason to force parsing on users when we can do a little bit of work to do it natively and in a simple (aka, readily both human and machine readable) format like JSON. However, if ease of application development is not a priority for the project, then sure - happy to close",https://github.com/bitcoin/bitcoin/pull/11614#issuecomment-376691346,376691346,
jnewbery,2018-03-28T11:05:39Z,"> if ease of application development is not a priority...\n\nThanks @astanway , this isn't so much about priorities, as whether the concept has gathered support from other contributors. This PR has 5 concept NACKs from regular contributors, so it seems unlikely to get support for merge.\n\nI've had plenty of my PRs NACKed in the past. It's part of the open source process.",https://github.com/bitcoin/bitcoin/pull/11614#issuecomment-376848244,376848244,
promag,2018-03-28T11:48:24Z,"Agree with closing.\n\n> Truly there are not; the state of transaction parsers is in pretty horrible shape and none really match the canonical RPC JSON output.\n\nPerhaps you could help to improve this instead.",https://github.com/bitcoin/bitcoin/pull/11614#issuecomment-376858329,376858329,
promag,2017-11-06T00:49:31Z,Add newline.,https://github.com/bitcoin/bitcoin/pull/11614#discussion_r148977987,148977987,src/zmq/zmqpublishnotifier.cpp
promag,2017-11-06T00:50:58Z,Remove raw? Same below.,https://github.com/bitcoin/bitcoin/pull/11614#discussion_r148978040,148978040,test/functional/zmq_test.py
promag,2017-11-06T00:52:52Z,Have you tried `TxToJSON`?,https://github.com/bitcoin/bitcoin/pull/11614#discussion_r148978104,148978104,src/zmq/zmqpublishnotifier.cpp
promag,2017-11-06T00:53:21Z,"Nit, sort includes.",https://github.com/bitcoin/bitcoin/pull/11614#discussion_r148978122,148978122,src/zmq/zmqpublishnotifier.cpp
promag,2017-11-06T00:55:17Z,"Nit, sort.",https://github.com/bitcoin/bitcoin/pull/11614#discussion_r148978190,148978190,src/zmq/zmqpublishnotifier.cpp
promag,2017-11-06T00:55:47Z,Care to explain the offset?,https://github.com/bitcoin/bitcoin/pull/11614#discussion_r148978207,148978207,test/functional/zmq_test.py
astanway,2017-11-06T02:21:43Z,"`TxToJSON` just calls `TxToUniv` internally, and also adds that extra `hashBlock` check, which is not strictly necessary imo. If we think that extra info would be useful though (confirmations, time, blocktime, blockhash), we can try to get the block hash beforehand and switch to using this method.",https://github.com/bitcoin/bitcoin/pull/11614#discussion_r148982778,148982778,src/zmq/zmqpublishnotifier.cpp
astanway,2017-11-06T02:23:15Z,"Looks like it was some kind of header added by `CDataStream` - I'm not entirely sure, tbh. I switched it over to a vanilla string and char array and the offset went away.",https://github.com/bitcoin/bitcoin/pull/11614#discussion_r148982851,148982851,test/functional/zmq_test.py
