gmaxwell,2015-11-25T23:12:08Z,"From the ""things I am tired of patching out locally"".\n\nFull disclosure: this behavior has surprised me twice and caused me to waste hours of time. I think it's generally nuts as a default. I believe in and agree with the applications for it, but I think they're pretty specialized.\n",https://github.com/bitcoin/bitcoin/pull/7099#issuecomment-159752463,159752463,
sipa,2015-11-25T23:20:22Z,"This seems like a pretty big change, and removing the original reason for whitelisted peers as a default: running a wallet behind an edge router and making it able to rebroadcast.\n\nHow about always relaying for whitelisted peers, except when the transactions are invalid (but do relay when they were already in the mempool).\n",https://github.com/bitcoin/bitcoin/pull/7099#issuecomment-159753527,159753527,
sipa,2015-11-25T23:36:31Z,"Wait a minute! That's already broken by the recently-added ""if (AlreadyHave(inv))"" test before the AcceptToMemoryPool call. We could just move the white relay behaviour there I think?\n",https://github.com/bitcoin/bitcoin/pull/7099#issuecomment-159755461,159755461,
gmaxwell,2015-11-25T23:40:49Z,"The forced relaying has made whitelistning useless to me since day one: It means I cannot whitelist my mining software (so that it won't get banned), it means I cannot whitelist the relay node client (so that it won't get banned and can populate my mempool).  It means I cannot whitelist nodes inside my network (that run various sets of software and sometimes spam invalid transactions) to bypass th",https://github.com/bitcoin/bitcoin/pull/7099#issuecomment-159755988,159755988,
dcousens,2015-11-26T00:22:37Z,"> Maybe we should unconditionally never forward invalid transactions; and if we did, I wouldn't mind putting this back to default on.\n\nDo you mean invalid in terms of node policy, or invalid in terms of its badly formatted / scripts evaluate false?\n",https://github.com/bitcoin/bitcoin/pull/7099#issuecomment-159764567,159764567,
gmaxwell,2015-11-26T00:32:26Z,"Invalid means that it is badly formatted, spends non-existing coins, scripts evaluate to false, etc.\n",https://github.com/bitcoin/bitcoin/pull/7099#issuecomment-159765605,159765605,
dcousens,2015-11-26T00:53:10Z,Is there any reason to ever relay them?\n,https://github.com/bitcoin/bitcoin/pull/7099#issuecomment-159768934,159768934,
sipa,2015-11-26T00:57:11Z,"I think the only use for whitelist's relay behaviour is to relay things that are already in the mempool, or perhaps things that were refused due to policy. I don't think it should ever relay actually invalid things.\n",https://github.com/bitcoin/bitcoin/pull/7099#issuecomment-159769366,159769366,
gmaxwell,2015-11-26T00:59:24Z,"I gave an example: something which is invalid due to mempool script verify flags... it's arguably that these should be relayed for the same reason as other policy violations.\n\nIf we don't mind not relaying those, I'll go fix this to not relay invalids, fix the fact that it's currently broken entirely (as sipa mentioned) and default this to ON (and make it soft-set off by blockonly, of course).\n",https://github.com/bitcoin/bitcoin/pull/7099#issuecomment-159769635,159769635,
sipa,2015-11-26T01:03:39Z,@gmaxwell We don't ever DoS ban for failing a non-consensus rule in scripts. Maybe that criterion could be reuse: don't ever relay (not even to whitelisted peers) if our own validation logic set a non-zero DoS score?\n,https://github.com/bitcoin/bitcoin/pull/7099#issuecomment-159770080,159770080,
gmaxwell,2015-11-26T21:13:30Z,"@sipa indeed.  In any case, the fact that whitelist relay hasn't worked since 0.11.1 without complaint supports my belief that almost no one uses it / expects it.\n",https://github.com/bitcoin/bitcoin/pull/7099#issuecomment-159994749,159994749,
gmaxwell,2015-11-28T11:20:43Z,"Rebased on #7106 and in consideration of the fact that it makes the node not relay invalid transactions, I changed the default here to on. I still think making this configurable is important.\n",https://github.com/bitcoin/bitcoin/pull/7099#issuecomment-160277950,160277950,
sipa,2015-11-28T12:00:12Z,Needs rebase...\n,https://github.com/bitcoin/bitcoin/pull/7099#issuecomment-160287637,160287637,
laanwj,2016-01-28T12:38:19Z,Needs rebase again (sorry)\nAlso needs text for the 0.13 release notes as this is indeed a pretty big change.\n,https://github.com/bitcoin/bitcoin/pull/7099#issuecomment-176158602,176158602,
gmaxwell,2016-01-28T22:16:41Z,"@laanwj It's not a big change: it was updated to default to off-- I got tired of arguing about it, and sipa fixed the most grave of the misbehavior (sending invalid transactions) with it turned on in 0.12.\n\nI can rebase.\n",https://github.com/bitcoin/bitcoin/pull/7099#issuecomment-176446233,176446233,
gmaxwell,2016-01-28T22:53:58Z,"#7439 now, sorry. I couldn't figure out how to update this with the branch having been deleted on my tree.\n",https://github.com/bitcoin/bitcoin/pull/7099#issuecomment-176468809,176468809,
