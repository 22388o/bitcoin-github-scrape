marcoagner,2018-06-04T15:01:07Z,"Shouldn't this account for html tags too?\nAs I understand, I could upload a translation with the text `Nosso endereço: 3K9Tjd<span>UWMXRG</span>feRefeW<span>o48NQjp9syDdeXh</span>`, bypass an address-only regex, and have the same effect in the GUI.",https://github.com/bitcoin/bitcoin/pull/13374#issuecomment-394386399,394386399,
MarcoFalke,2018-06-04T15:14:04Z,"Imo, html tags should never end up in translation, so should probably be rejected as well.",https://github.com/bitcoin/bitcoin/pull/13374#issuecomment-394391043,394391043,
marcoagner,2018-06-04T15:23:49Z,"I agree. There are still some tr() calls here and there containing html tags, though ([example](https://github.com/eudisd/bitcoin/blob/master/src/qt/askpassphrasedialog.cpp#L115)).\nThey should probably be eliminated and then rejected in `update-translations.py` as well (probably in another PR)..",https://github.com/bitcoin/bitcoin/pull/13374#issuecomment-394394700,394394700,
kaplanmaxe,2018-06-04T15:24:54Z,@marcoagner @MarcoFalke I think it makes sense to reject any translations that contain HTML. How do you want to go forward with this? The issue here was to prevent bitcoin addresses from getting inside a translation. What I could do is strip out any html tags then do a check to see if the translation matches a bitcoin address. However if we want to prevent any html tags from ending up in a transla,https://github.com/bitcoin/bitcoin/pull/13374#issuecomment-394395102,394395102,
marcoagner,2018-06-04T15:34:50Z,"@kaplanmaxe In my opinion, this PR should focus on rejecting addresses only.\nIt just made me think that, as it is now, it will be kind of by-passable, but the problem is not with your check. Imo, it is the `tr()` calls with html tags that should be eliminated and then have html tags rejected in another check by another PR as well.",https://github.com/bitcoin/bitcoin/pull/13374#issuecomment-394398890,394398890,
kaplanmaxe,2018-06-04T16:16:51Z,Commits have been squashed,https://github.com/bitcoin/bitcoin/pull/13374#issuecomment-394413226,394413226,
kaplanmaxe,2018-06-04T17:00:03Z,"Hm, anyone know why the CI failed all of a sudden? Correct me if I'm wrong here, but it looks like it's failing in an area that has nothing to do with this PR?\n\nPotentially related to #11696 ?",https://github.com/bitcoin/bitcoin/pull/13374#issuecomment-394426420,394426420,
MarcoFalke,2018-06-04T17:11:23Z,This is `http.client.RemoteDisconnected: Remote end closed connection without response` #11777,https://github.com/bitcoin/bitcoin/pull/13374#issuecomment-394429595,394429595,
kaplanmaxe,2018-06-07T00:58:54Z,"Hey guys, anything else I can do on this PR?",https://github.com/bitcoin/bitcoin/pull/13374#issuecomment-395259598,395259598,
kaplanmaxe,2018-06-07T03:08:02Z,"@promag just responding to your comment in the other PR (https://github.com/bitcoin/bitcoin/pull/13375#issuecomment-395268629) so we can keep discussions relevant to this PR in here without clogging up someone elses.\n\n> maybe incorporate above suggestions in yours?\n\nCan you clarify which suggestions you are referring to? The only one I could see being relevant is your suggestion on how to ",https://github.com/bitcoin/bitcoin/pull/13374#issuecomment-395278440,395278440,
kaplanmaxe,2018-06-07T14:20:28Z,"@promag I think you bring up an interesting point with the spaces. I think it really depends on how granular we want to get with this. If we want to prevent spaces, there are still plenty of ways ""around"" this regular expression. Ex: \n\n`b̈c1qar0srrr7xfkvy5l643lydnw9re59gtzzwf5mdq`\n\nPersonally, I would argue that if the user can't copy and paste it and use it as a valid bitcoin address, we ",https://github.com/bitcoin/bitcoin/pull/13374#issuecomment-395438056,395438056,
kaplanmaxe,2018-06-08T13:34:59Z,"@laanwj I saw your comment in #13375 . I have tested this pretty extensively and haven't had any false positives. It will also catch addresses between words like I mentioned here (https://github.com/bitcoin/bitcoin/pull/13374#issuecomment-395278440) which I feel is really important. When you get a chance, maybe you could check this one out?",https://github.com/bitcoin/bitcoin/pull/13374#issuecomment-395762452,395762452,
laanwj,2018-06-08T14:16:05Z,"@kaplanmaxe Thanks, I'll test this one next.",https://github.com/bitcoin/bitcoin/pull/13374#issuecomment-395774620,395774620,
laanwj,2018-06-08T14:52:36Z,Tested ACK 85f0135eaefe3d9f696689a7e83606c579da40a8 (with normal and bech32 address),https://github.com/bitcoin/bitcoin/pull/13374#issuecomment-395785866,395785866,
MarcoFalke,2018-06-08T14:53:30Z,utACK 85f0135eaefe3d9f696689a7e83606c579da40a8,https://github.com/bitcoin/bitcoin/pull/13374#issuecomment-395786148,395786148,
marcoagner,2018-06-02T18:01:32Z,This line is not needed; re is already imported above.,https://github.com/bitcoin/bitcoin/pull/13374#discussion_r192566118,192566118,contrib/devtools/update-translations.py
MarcoFalke,2018-06-02T18:14:02Z,This is too strict and wouldn't match an address hidden between words.,https://github.com/bitcoin/bitcoin/pull/13374#discussion_r192566414,192566414,contrib/devtools/update-translations.py
kaplanmaxe,2018-06-02T18:33:07Z,"Agreed. I want to avoid false positives here. What do you suggest the best way forward is? I could split on any spaces in the string then perform this check, but that might be rather expensive, although I'm not sure if performance is all that important in this file? If I don't set some sort of string length in the regex pattern, there are going to be a bunch of false positives.",https://github.com/bitcoin/bitcoin/pull/13374#discussion_r192566826,192566826,contrib/devtools/update-translations.py
MarcoFalke,2018-06-02T19:14:39Z,"Hmm, could you elaborate what you mean by false positives? Imo a word that is longer than 30 chars and includes at least one digit should never be part of a translation (regardless if it was a bitcoin address)",https://github.com/bitcoin/bitcoin/pull/13374#discussion_r192567791,192567791,contrib/devtools/update-translations.py
kaplanmaxe,2018-06-02T22:01:04Z,You're right here. There were some translations that started with a 1 but they all contain spaces. The new commit I just pushed should work. Thanks for the input,https://github.com/bitcoin/bitcoin/pull/13374#discussion_r192571515,192571515,contrib/devtools/update-translations.py
marcoagner,2018-06-02T23:25:35Z,"This still won't match an address between words (as @MarcoFalke pointed). You may want to remove the start and end of line anchors, use a group like `(.*?)`, or something else.",https://github.com/bitcoin/bitcoin/pull/13374#discussion_r192572946,192572946,contrib/devtools/update-translations.py
Empact,2018-06-03T00:45:39Z,nit: could return the comparison directly,https://github.com/bitcoin/bitcoin/pull/13374#discussion_r192573966,192573966,contrib/devtools/update-translations.py
Empact,2018-06-03T00:45:49Z,nit: could test on the method call directly,https://github.com/bitcoin/bitcoin/pull/13374#discussion_r192573971,192573971,contrib/devtools/update-translations.py
Empact,2018-06-03T00:46:16Z,nit: could call this something declarative like `contains_bitcoin_addr`,https://github.com/bitcoin/bitcoin/pull/13374#discussion_r192573976,192573976,contrib/devtools/update-translations.py
Empact,2018-06-03T00:49:16Z,Probably want to make this a constant computed once on load rather than once per method call.,https://github.com/bitcoin/bitcoin/pull/13374#discussion_r192574017,192574017,contrib/devtools/update-translations.py
laanwj,2018-06-04T14:44:27Z,"Why not move this with the `check_format_specifiers` check below. It means you set valid to false and can re-use the !valid code.\n```\n                     if not valid: # set type to unfinished and clear string if invalid\n                         translation_node.clear()\n                         translation_node.set('type', 'unfinished')\nhave_errors = True\n```",https://github.com/bitcoin/bitcoin/pull/13374#discussion_r192766236,192766236,contrib/devtools/update-translations.py
kaplanmaxe,2018-06-04T15:51:32Z,"Good call. I have updated this. I'm not all that familiar with Python so if there's a better way of formatting what I have now, let me know.",https://github.com/bitcoin/bitcoin/pull/13374#discussion_r192790768,192790768,contrib/devtools/update-translations.py
MarcoFalke,2018-06-04T15:57:11Z,Should say `translation` instead of `translation_node`?,https://github.com/bitcoin/bitcoin/pull/13374#discussion_r192792720,192792720,contrib/devtools/update-translations.py
kaplanmaxe,2018-06-04T16:00:05Z,Whoops! Good catch. Copied and pasted from my previous commit. Updating now,https://github.com/bitcoin/bitcoin/pull/13374#discussion_r192793753,192793753,contrib/devtools/update-translations.py
Empact,2018-06-05T10:12:12Z,"Would like to have a report of what error occurred. Current code reports only what ends up in `errors` which is not set in this case, so the failure is silent.",https://github.com/bitcoin/bitcoin/pull/13374#discussion_r193018506,193018506,contrib/devtools/update-translations.py
promag,2018-06-07T13:57:18Z,"Could be:\n```py\nif ADDRESS_REGEXP.search(text):\n    ...\n```\n",https://github.com/bitcoin/bitcoin/pull/13374#discussion_r193755793,193755793,contrib/devtools/update-translations.py
kaplanmaxe,2018-06-07T18:11:47Z,"If someone else feels strongly about making the change here, lmk and I will make it. If it's not necessary, don't want to reset the ACKs based off a new commit hash :)",https://github.com/bitcoin/bitcoin/pull/13374#discussion_r193841594,193841594,contrib/devtools/update-translations.py
