[
  {
    "sha": "7da4a8ffb3c9807c59f8ba63781169e4045594ba",
    "node_id": "C_kwDOABII59oAKDdkYTRhOGZmYjNjOTgwN2M1OWY4YmE2Mzc4MTE2OWU0MDQ1NTk0YmE",
    "commit": {
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-12-03T15:34:07Z"
      },
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@pm.me",
        "date": "2021-12-03T15:34:07Z"
      },
      "message": "cover DisconnectBlock with lock annotation\n\nCoinsTip() access requires cs_main and therefore so should this function.",
      "tree": {
        "sha": "6a16d8577abbee2bdcc7016db0903ca41d8a82d2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6a16d8577abbee2bdcc7016db0903ca41d8a82d2"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7da4a8ffb3c9807c59f8ba63781169e4045594ba",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEGNRVI1NPYuZCSIrGepNdrbLETwUFAmGqOZMACgkQepNdrbLE\nTwVH/Q//ZEbCvO/TQyQCMumPysXStYf4kscmWna0nf+Mt6RS97pehsY5Kv6KWgVX\nChkTANPjBRQud6ZeljJ7gmPs8oeSVVqkrqzYKc9uWIpJ4NZy1/YySRz1wcB4xRiE\nOlLdATlqXhPTmnK866UPsvLjdrnJbWrQLPrnXIPukZ+zCiLerRt2RIIscZRYo1Uu\n1HY7UAb9qO5GCeEm4VGVMwGiUXVsFy5wygZGs0qXmYpjk/MSPw1xn0p2b+m5C2rb\nNO+QBcY6bQeJCJEctunt0nb1Reyf2bhDaE468P+QXLh7KAMZLgujGIMASHXmS9K6\nQzeptDl8N7uluK3fwCxP7PkPzgF1SRRNLqZyYPbYo8OmAHKaKnV2II4fGhI31xBG\n/NCWOk7dxOSLcUYBsEbO92ABK7HZkLU956blLJnV6Mq3Siu7Rud6xBeFAoOIWlpN\n6KT/eAP9HMRq+9QQCvfe4jVmjl8MhcPDh29sIzJXiW3f0CyIAL15EutLq3wXETrp\niSC5ayaUcwlMtjZwTZOp1HNmCAFbNordebhHBYxI9ZZPXxPFrnyZ3M8ZQeep27kt\ngLiiHFUPVClesUHwip+CW7qkTuoQVHvoGe5SKHhyfSGjynGPJKjylxf4/Pg0XNSq\nH6LNGEJOPzZ4YDGJbLbJcSHismlhpC9/m5Q0J3Rfp1kfB+LLkOo=\n=8CqF\n-----END PGP SIGNATURE-----",
        "payload": "tree 6a16d8577abbee2bdcc7016db0903ca41d8a82d2\nparent 57982f419e36d0023c83af2dd0d683ca3160dc2a\nauthor James O'Beirne <james.obeirne@pm.me> 1638545647 -0500\ncommitter James O'Beirne <james.obeirne@pm.me> 1638545647 -0500\n\ncover DisconnectBlock with lock annotation\n\nCoinsTip() access requires cs_main and therefore so should this function.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7da4a8ffb3c9807c59f8ba63781169e4045594ba",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/7da4a8ffb3c9807c59f8ba63781169e4045594ba",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7da4a8ffb3c9807c59f8ba63781169e4045594ba/comments",
    "author": {
      "login": "jamesob",
      "id": 73197,
      "node_id": "MDQ6VXNlcjczMTk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jamesob",
      "html_url": "https://github.com/jamesob",
      "followers_url": "https://api.github.com/users/jamesob/followers",
      "following_url": "https://api.github.com/users/jamesob/following{/other_user}",
      "gists_url": "https://api.github.com/users/jamesob/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
      "organizations_url": "https://api.github.com/users/jamesob/orgs",
      "repos_url": "https://api.github.com/users/jamesob/repos",
      "events_url": "https://api.github.com/users/jamesob/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jamesob/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jamesob",
      "id": 73197,
      "node_id": "MDQ6VXNlcjczMTk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jamesob",
      "html_url": "https://github.com/jamesob",
      "followers_url": "https://api.github.com/users/jamesob/followers",
      "following_url": "https://api.github.com/users/jamesob/following{/other_user}",
      "gists_url": "https://api.github.com/users/jamesob/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
      "organizations_url": "https://api.github.com/users/jamesob/orgs",
      "repos_url": "https://api.github.com/users/jamesob/repos",
      "events_url": "https://api.github.com/users/jamesob/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jamesob/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "57982f419e36d0023c83af2dd0d683ca3160dc2a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/57982f419e36d0023c83af2dd0d683ca3160dc2a",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/57982f419e36d0023c83af2dd0d683ca3160dc2a"
      }
    ],
    "stats": {
      "total": 4,
      "additions": 3,
      "deletions": 1
    },
    "files": [
      {
        "sha": "91ef961964be3706bb1bfc88e290a1a90e07d337",
        "filename": "src/validation.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7da4a8ffb3c9807c59f8ba63781169e4045594ba/src/validation.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7da4a8ffb3c9807c59f8ba63781169e4045594ba/src/validation.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/validation.cpp?ref=7da4a8ffb3c9807c59f8ba63781169e4045594ba",
        "patch": "@@ -1485,6 +1485,7 @@ int ApplyTxInUndo(Coin&& undo, CCoinsViewCache& view, const COutPoint& out)\n  *  When FAILED is returned, view is left in an indeterminate state. */\n DisconnectResult CChainState::DisconnectBlock(const CBlock& block, const CBlockIndex* pindex, CCoinsViewCache& view)\n {\n+    AssertLockHeld(::cs_main);\n     bool fClean = true;\n \n     CBlockUndo blockUndo;"
      },
      {
        "sha": "2609538ecec0036dabddc3a9c97376d8d9448dab",
        "filename": "src/validation.h",
        "status": "modified",
        "additions": 2,
        "deletions": 1,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7da4a8ffb3c9807c59f8ba63781169e4045594ba/src/validation.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7da4a8ffb3c9807c59f8ba63781169e4045594ba/src/validation.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/validation.h?ref=7da4a8ffb3c9807c59f8ba63781169e4045594ba",
        "patch": "@@ -718,7 +718,8 @@ class CChainState\n     bool AcceptBlock(const std::shared_ptr<const CBlock>& pblock, BlockValidationState& state, CBlockIndex** ppindex, bool fRequested, const FlatFilePos* dbp, bool* fNewBlock) EXCLUSIVE_LOCKS_REQUIRED(cs_main);\n \n     // Block (dis)connection on a given view:\n-    DisconnectResult DisconnectBlock(const CBlock& block, const CBlockIndex* pindex, CCoinsViewCache& view);\n+    DisconnectResult DisconnectBlock(const CBlock& block, const CBlockIndex* pindex, CCoinsViewCache& view)\n+        EXCLUSIVE_LOCKS_REQUIRED(::cs_main);\n     bool ConnectBlock(const CBlock& block, BlockValidationState& state, CBlockIndex* pindex,\n                       CCoinsViewCache& view, bool fJustCheck = false) EXCLUSIVE_LOCKS_REQUIRED(cs_main);\n "
      }
    ]
  }
]