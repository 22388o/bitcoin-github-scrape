DrahtBot,2019-08-08 12:52:45,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#15268](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15268.html) (doc: suggest using timeoutstopsec in system",https://github.com/bitcoin/bitcoin/pull/16569#issuecomment-519505153,519505153,
dongcarl,2019-08-08 15:55:34,"Documentation for `TimeoutStopSec=`: https://www.freedesktop.org/software/systemd/man/systemd.service.html#TimeoutStopSec=\n\nRelevant quotations:\n\n> ...it configures the time to wait for the service itself to stop. If it doesn't terminate in the specified time, it will be forcibly terminated by `SIGKILL` (see `KillMode=` in systemd.kill(5)).\n\n> Takes a unit-less value in seconds, or a t",https://github.com/bitcoin/bitcoin/pull/16569#issuecomment-519578899,519578899,
setpill,2019-08-09 12:10:29,"I have recently encountered a situation on a system with decent specs (4 cores, 16 GB ram, 15 GB db cache, blocksdir on HDD, datadir on SSD) where the clean shutdown took almost 9 minutes. 10 minutes seems like it would be too close for comfort, especially considering the myriad of lower-end hardware that might run `bitcoind`. I have not attempted to analyse the bounds, but in a situation where th",https://github.com/bitcoin/bitcoin/pull/16569#issuecomment-519895012,519895012,
instagibbs,2019-08-12 13:10:34,"@setpill if the shutdown gets wedged somehow, would `infinity` cause this to never recover? Unclean shutdown at some point may be preferable. ",https://github.com/bitcoin/bitcoin/pull/16569#issuecomment-520418394,520418394,
setpill,2019-08-16 09:51:23,"@instagibbs It is true it will never automatically recover if it gets wedged; but like I said if that happens one probably wants to inspect manually what is going on and if the node is still safe to use, perhaps file a bug report.\n\nThe systemd service file can also be overridden by admins to have a shutdown timeout in case it is needed, imho the default one provided with the program should err",https://github.com/bitcoin/bitcoin/pull/16569#issuecomment-521954671,521954671,
luke-jr,2019-08-23 18:59:20,">I have recently encountered a situation on a system with decent specs (4 cores, 16 GB ram, 15 GB db cache, blocksdir on HDD, datadir on SSD) where the clean shutdown took almost 9 minutes.\n\nWhat caused this? It certainly doesn't look normal.\n\nIMO *some* timeout should be kept.\n\n>  if that happens one probably wants to inspect manually what is going on\n\nNot possible during shutdown",https://github.com/bitcoin/bitcoin/pull/16569#issuecomment-524426607,524426607,
dongcarl,2019-09-05 17:43:48,"So perhaps what @setpill is saying is that for those who enabled the systemd debug shell (`sudo systemctl enable --now debug-shell.service`), even when the service is stuck, they can debug using a root shell on TTY9?",https://github.com/bitcoin/bitcoin/pull/16569#issuecomment-528493467,528493467,
setpill,2019-09-06 13:33:51,"My opinion is that if bitcoin core truly does hang in a way that does not recover automatically, that it should not just be killed and restarted. It's (imho) better to require manual intervention and let whoever runs the node decide if it is still ok to still trust that node. \n\nBut that is my preference, at the very least I think the current timeout should be reconsidered as it appears to be f",https://github.com/bitcoin/bitcoin/pull/16569#issuecomment-528856536,528856536,
instagibbs,2019-09-06 13:40:58,"> at the very least I think the current timeout should be reconsidered\n\nI think everyone is in agreement on this point. Mind compromising and just picking a ""fairly long"" shutdown period of say 10 minutes as @dongcarl suggests? ",https://github.com/bitcoin/bitcoin/pull/16569#issuecomment-528859095,528859095,
setpill,2019-09-06 15:02:29,"I suppose a 15gb dbcache is a somewhat exceptional situation, perhaps 10 minutes is a decent default. I'm also looking into implementing it in the other init files for consistency's sake.",https://github.com/bitcoin/bitcoin/pull/16569#issuecomment-528890528,528890528,
setpill,2019-09-06 15:08:57,NB: init files aside from systemd are untested; especially the centos `bitcoind.init` since it's not merely an increase of an existing parameter but a setting of a new parameter.,https://github.com/bitcoin/bitcoin/pull/16569#issuecomment-528893176,528893176,
instagibbs,2019-09-06 15:12:35,"utACK https://github.com/bitcoin/bitcoin/pull/16569/commits/7fb7acfc206b4bf8c296d72b66f3bd4fe342fd87\n\n(~no experience in non systemd stuff fwiw)",https://github.com/bitcoin/bitcoin/pull/16569#issuecomment-528894574,528894574,
laanwj,2019-10-08 09:37:57,Agree on increasing this timeout. Better be safe than sorry. It is frustrating to lose your entire sync state (with a high dbcache) on shutdown.,https://github.com/bitcoin/bitcoin/pull/16569#issuecomment-539434935,539434935,
