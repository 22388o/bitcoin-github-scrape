jonasschnelli,2017-07-09T18:52:09Z,"Makes sense. I guess I over-engineered the flexible callback (I thought we should have a way to not only shutdown and have the future option to ""continue"" but this really makes little sense).\n\nutACK 1d62f6eb35f248ff44aeac39673014bb1c9cbe71",https://github.com/bitcoin/bitcoin/pull/10770#issuecomment-313938704,313938704,
sipa,2017-07-11T07:43:39Z,"This begs the question whether we shouldn't just have 'q for shutdown' always available? Maybe in some cases there is some initializationstep-specific cleanup, but there shouldn't be much as we're always allowed to crash anyway.",https://github.com/bitcoin/bitcoin/pull/10770#issuecomment-314362163,314362163,
TheBlueMatt,2017-07-11T15:01:30Z,"@sipa yea, I thought about that. We should maybe move the boolean to just change the message to ""will complete later if you shutdown now"". I still think this is a nice cleanup, and given we're already in freeze for 0.15 it'd be too late to make that change for 0.15. If this sits for the next month without any movement I'll make that change for 16.",https://github.com/bitcoin/bitcoin/pull/10770#issuecomment-314472928,314472928,
sipa,2017-07-15T20:07:41Z,"Tested. Segfaults when cancelling during upgrade:\n```\nThread 4 ""bitcoin-shutoff"" received signal SIGSEGV, Segmentation fault.\n[Switching to Thread 0x7fffe117d700 (LWP 6034)]\nCCoinsViewCache::DynamicMemoryUsage (this=0x0) at coins.cpp:40\n40	    return memusage::DynamicUsage(cacheCoins) + cachedCoinsUsage;\n(gdb) bt\n#0  CCoinsViewCache::DynamicMemoryUsage (this=0x0) at coins.cpp:40\n#1",https://github.com/bitcoin/bitcoin/pull/10770#issuecomment-315558931,315558931,
TheBlueMatt,2017-07-15T23:56:08Z,"@sipa hmm, I could be wrong but that strikes me as an issue that would also be present prior to the changes in this PR.",https://github.com/bitcoin/bitcoin/pull/10770#issuecomment-315571336,315571336,
TheBlueMatt,2017-07-16T00:01:16Z,"@sipa yes, that appears to be another bug introduced in #10179 after d6af06d68aae985436cbc942f0d11078041d121b changed some semantics, I'll fix it in #10758 with my other pile of fixes that are gonna need to land for 15 anyway.",https://github.com/bitcoin/bitcoin/pull/10770#issuecomment-315571520,315571520,
jj1010,2017-07-16T04:42:30Z,"Como faço para criar minha própria moeda virtual\n\nEm sábado, 15 de julho de 2017, Matt Corallo <notifications@github.com>\nescreveu:\n\n> @sipa <https://github.com/sipa> yes, that appears to be another bug\n> introduced in d6af06d\n> <https://github.com/bitcoin/bitcoin/commit/d6af06d68aae985436cbc942f0d11078041d121b>,\n> I'll fix it in #10758 <https://github.com/bitcoin/bitcoin/pull/10758>\n> wi",https://github.com/bitcoin/bitcoin/pull/10770#issuecomment-315585138,315585138,
achow101,2017-08-07T23:47:59Z,Having this would make fixing #10992 much easier.,https://github.com/bitcoin/bitcoin/pull/10770#issuecomment-320810682,320810682,
jonasschnelli,2017-08-15T18:46:45Z,@TheBlueMatt: can you rebase?,https://github.com/bitcoin/bitcoin/pull/10770#issuecomment-322554081,322554081,
TheBlueMatt,2017-08-16T21:38:25Z,"""Rebased"", but also just dropped the ""cancelable"" idea (as @sipa originally suggested) and always allow shutdown, using the passd-up boolean just to change the message to inform the user the current action will resume on restart.",https://github.com/bitcoin/bitcoin/pull/10770#issuecomment-322906981,322906981,
sipa,2017-08-16T21:54:58Z,"@TheBlueMatt There may be a use for keeping the cancellation boolean, so the interface can be reused to make the ""rescanning"" dialog in the GUI interruptible (cc @achow101).",https://github.com/bitcoin/bitcoin/pull/10770#issuecomment-322910672,322910672,
TheBlueMatt,2017-08-16T22:11:24Z,"@sipa that is going to need a very different interface anyway, as StartShutdown() is not appropriate there (better to separate the interface between during-init progress and other-things progress IMO).",https://github.com/bitcoin/bitcoin/pull/10770#issuecomment-322914064,322914064,
jonasschnelli,2017-08-18T10:16:27Z,"@achow101: for the rescan progress work, would having this PR be better or not having it?",https://github.com/bitcoin/bitcoin/pull/10770#issuecomment-323316718,323316718,
achow101,2017-08-18T16:22:22Z,"For rescan progress we needed the cancellation boolean, But since that has been dropped, it doesn't matter.",https://github.com/bitcoin/bitcoin/pull/10770#issuecomment-323398297,323398297,
TheBlueMatt,2017-08-21T00:04:30Z,"@achow101 well the cancellation boolean wouldn't have really helped, because the cancellation boolean in the previous version of this PR indicated to the GUI that it can call StartShutdown() to cancel, which is most definitely not what you want to do when its a rescan we're talking about.\n\n@ryanofsky thanks, fixed.",https://github.com/bitcoin/bitcoin/pull/10770#issuecomment-323620590,323620590,
jonasschnelli,2017-09-07T16:20:32Z,Tested ACK ee4d1493e2a871b26201580c5a990a1df7a5e3f7,https://github.com/bitcoin/bitcoin/pull/10770#issuecomment-327850595,327850595,
ryanofsky,2017-07-07T21:26:02Z,"Don't you need to invoke `setBreakAction(nullptr)` here when `cancel_possible` is false?\n\nMaybe better would be to get rid of this `std::function` madness and replace the `SplashScreen::breakAction` pointer with a simpler boolean `std::atomic<bool> m_cancel_possible` which you can just assign directly.",https://github.com/bitcoin/bitcoin/pull/10770#discussion_r126248902,126248902,src/qt/splashscreen.cpp
TheBlueMatt,2017-07-07T21:33:22Z,Nice.,https://github.com/bitcoin/bitcoin/pull/10770#discussion_r126250056,126250056,src/qt/splashscreen.cpp
ryanofsky,2017-07-10T14:23:51Z,"I'd consider replacing ""cancel possible"" with ""shutdown possible"" everywhere in this PR. The function this is controlling is called `StartShutdown`. The display text is `press q to shutdown`. Why should this thing be named differently?",https://github.com/bitcoin/bitcoin/pull/10770#discussion_r126435654,126435654,src/qt/splashscreen.h
TheBlueMatt,2017-07-10T14:38:37Z,"""shutdown"" is always possible (just may be slow), what you care about is cancelling the currnent ""in progress"" thing (and shutting down). I dont really care, but also dont think its particularly unclear?",https://github.com/bitcoin/bitcoin/pull/10770#discussion_r126440472,126440472,src/qt/splashscreen.h
ryanofsky,2017-07-10T18:02:40Z,"> I dont really care, but also dont think its particularly unclear?\n\nIt's unclear to me what the flag is supposed to indicate or why it wouldn't always be true if shutdown is always possible. Maybe it should be called `fast_shutdown_possible` if that's what it actually means. Acked this because the PR is definitely a simplification, but I don't think the code or the reason for preventing the q",https://github.com/bitcoin/bitcoin/pull/10770#discussion_r126494301,126494301,src/qt/splashscreen.h
TheBlueMatt,2017-07-11T01:27:24Z,"Added some additional comments. I'm not really sure if thats a better name, though I agree cancel_possible is a bit strange.",https://github.com/bitcoin/bitcoin/pull/10770#discussion_r126575615,126575615,src/qt/splashscreen.h
sipa,2017-07-16T19:27:31Z,Please put a space or a newline between the title and the progress.,https://github.com/bitcoin/bitcoin/pull/10770#discussion_r127614608,127614608,src/qt/splashscreen.cpp
TheBlueMatt,2017-07-16T23:21:38Z,"OK, cleaned it up.",https://github.com/bitcoin/bitcoin/pull/10770#discussion_r127619781,127619781,src/qt/splashscreen.cpp
ryanofsky,2017-08-16T22:05:14Z,This seems to be set but not actually used anywhere?,https://github.com/bitcoin/bitcoin/pull/10770#discussion_r133579589,133579589,src/qt/splashscreen.cpp
