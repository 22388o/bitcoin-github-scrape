[
  {
    "sha": "506bae3ac94ae9d5edfa794d9b80a7c9921ace17",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo1MDZiYWUzYWM5NGFlOWQ1ZWRmYTc5NGQ5YjgwYTdjOTkyMWFjZTE3",
    "commit": {
      "author": {
        "name": "dexX7",
        "email": "dexx@bitwatch.co",
        "date": "2015-06-09T15:11:13Z"
      },
      "committer": {
        "name": "dexX7",
        "email": "dexx@bitwatch.co",
        "date": "2015-06-09T15:21:27Z"
      },
      "message": "Return all available information via validateaddress\n\n`\"validateaddress\"` omits some information, even in cases where is it available.\n\nThe primary motivation is to be able to retrieve redeemScripts, after using `\"addmultisigaddress\"`, when not all keys are available in the keystore, but the redeemScript actually is.\n\nThe output of `\"validateaddress\"` with this commit:\n\nKeys not available:\n```js\nvalidateaddress \"n4KWZKx349gdMQGgTnZ8W6WfgSwybkGSK3\"\n{\n  \"isvalid\": true,\n  \"address\": \"n4KWZKx349gdMQGgTnZ8W6WfgSwybkGSK3\",\n  \"scriptPubKey\": \"76a914fa20d564550b105787f7ce3a9ad7fd9a45cd407088ac\",\n  \"ismine\": false,\n  \"iswatchonly\": false,\n  \"isscript\": false\n}\n```\n```js\nvalidateaddress \"2N2g2H7gjA8a11g1yKBgh5VTqndyvbnWpBK\"\n{\n  \"isvalid\": true,\n  \"address\": \"2N2g2H7gjA8a11g1yKBgh5VTqndyvbnWpBK\",\n  \"scriptPubKey\": \"a9146769c19a16c9400b908756e19a4d2afb9e9760e187\",\n  \"ismine\": false,\n  \"iswatchonly\": false,\n  \"isscript\": true\n}\n```\n\nAfter adding the redeemScript:\n```js\naddmultisigaddress 2 '[\"02537357B156A33306A7A014A3748631C59DF405B56F11BA4AA4A3CE81501AF095\",\"02F1FB200390E7864EF4450C07B15988179A57C3CF3A878F668E1070CB615749FE\"]'\n2N2g2H7gjA8a11g1yKBgh5VTqndyvbnWpBK\n\nvalidateaddress \"2N2g2H7gjA8a11g1yKBgh5VTqndyvbnWpBK\"\n{\n  \"isvalid\": true,\n  \"address\": \"2N2g2H7gjA8a11g1yKBgh5VTqndyvbnWpBK\",\n  \"scriptPubKey\": \"a9146769c19a16c9400b908756e19a4d2afb9e9760e187\",\n  \"ismine\": false,\n  \"iswatchonly\": false,\n  \"isscript\": true,\n  \"script\": \"multisig\",\n  \"hex\": \"522102537357b156a33306a7a014a3748631c59df405b56f11ba4aa4a3ce81501af0952102f1fb200390e7864ef4450c07b15988179a57c3cf3a878f668e1070cb615749fe52ae\",\n  \"addresses\": [\n    \"n4KWZKx349gdMQGgTnZ8W6WfgSwybkGSK3\",\n    \"mmSKNtbYYHRrhTLKiok5TuYrGEs4Y2A4k6\"\n  ],\n  \"sigsrequired\": 2,\n  \"account\": \"\"\n}\n```\n\nAll keys available:\n```js\nvalidateaddress \"n4KWZKx349gdMQGgTnZ8W6WfgSwybkGSK3\"\n{\n  \"isvalid\": true,\n  \"address\": \"n4KWZKx349gdMQGgTnZ8W6WfgSwybkGSK3\",\n  \"scriptPubKey\": \"76a914fa20d564550b105787f7ce3a9ad7fd9a45cd407088ac\",\n  \"ismine\": true,\n  \"iswatchonly\": false,\n  \"isscript\": false,\n  \"pubkey\": \"02537357b156a33306a7a014a3748631c59df405b56f11ba4aa4a3ce81501af095\",\n  \"iscompressed\": true,\n  \"account\": \"\"\n}\n```\n```js\nvalidateaddress \"2N2g2H7gjA8a11g1yKBgh5VTqndyvbnWpBK\"\n{\n  \"isvalid\": true,\n  \"address\": \"2N2g2H7gjA8a11g1yKBgh5VTqndyvbnWpBK\",\n  \"scriptPubKey\": \"a9146769c19a16c9400b908756e19a4d2afb9e9760e187\",\n  \"ismine\": true,\n  \"iswatchonly\": false,\n  \"isscript\": true,\n  \"script\": \"multisig\",\n  \"hex\": \"522102537357b156a33306a7a014a3748631c59df405b56f11ba4aa4a3ce81501af0952102f1fb200390e7864ef4450c07b15988179a57c3cf3a878f668e1070cb615749fe52ae\",\n  \"addresses\": [\n    \"n4KWZKx349gdMQGgTnZ8W6WfgSwybkGSK3\",\n    \"mmSKNtbYYHRrhTLKiok5TuYrGEs4Y2A4k6\"\n  ],\n  \"sigsrequired\": 2,\n  \"account\": \"\"\n}\n```",
      "tree": {
        "sha": "9ac541c57726e70b6b0576d3ce1cdaaea79cd97f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9ac541c57726e70b6b0576d3ce1cdaaea79cd97f"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/506bae3ac94ae9d5edfa794d9b80a7c9921ace17",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1\n\niQIcBAABAgAGBQJVdwSoAAoJEHZ14xz1cZgyooMQAKDbfRzlyzDdl+M7SfYTG56N\n77dnTKGBX9kXrgpXydtXW5X2srXySzRyY6PVwgnezvzryF1YBRxxilyxhCo+OsUH\nrTc0USqDZOmqbJRK7wLP45IsShJaAu0oi0J1mex9TQUdThyZstfnbb2bZwASYPha\nC/MujA5BpZDfbtxhIBtjNs1iO7rRD0Y5VVWHB6mAFCxS5VjmeZU+AxWPQYQk0+Hn\nHFi16+d/GhLksYUCSrpOJcJgqNZQ3o5lqies2GjG43KYjwcVyuZQGtI2R51bBDqS\nDkgpZdZ8TCnOBsEp6mXOQGuvaE6D4sukvtIwLDByCn0p5+Rzn3pTvKHp4vxlED36\nTObbf/+nn+xGPnH1+Fc93iXmVHXOTonTMbEaBFRenNN8CNH0ooeLi/5+rSsKYSFJ\n/pCEHb//HqYlggALq8Tc9XIW4BT+Tjm1AxSHbMltIMXS66CcpuBYJcNQjqZtSLla\n2pm9R+F3YafOltVWn5NRUlsqAbPSJPKs7szoZccvY70q2YWC/iXmsoYgzBXIiUlT\nH0Zjmv+7i9XlGID24xtMAhPA+7uMDFNF9TMdq+taeXWwGR+G5eBFGtRuLQ8le6wd\nPFHYQu0YtnoBZzm2ey1yPrpsJtgcmtp6RZIYkpUrbAgXEoaXkqjqa1sTDAiUF5yg\n6xXHmjH9Z5ikwfbVExez\n=QFTS\n-----END PGP SIGNATURE-----",
        "payload": "tree 9ac541c57726e70b6b0576d3ce1cdaaea79cd97f\nparent defa4fc25c6dc1b360fb974690516df35629db1d\nauthor dexX7 <dexx@bitwatch.co> 1433862673 +0200\ncommitter dexX7 <dexx@bitwatch.co> 1433863287 +0200\n\nReturn all available information via validateaddress\n\n`\"validateaddress\"` omits some information, even in cases where is it available.\n\nThe primary motivation is to be able to retrieve redeemScripts, after using `\"addmultisigaddress\"`, when not all keys are available in the keystore, but the redeemScript actually is.\n\nThe output of `\"validateaddress\"` with this commit:\n\nKeys not available:\n```js\nvalidateaddress \"n4KWZKx349gdMQGgTnZ8W6WfgSwybkGSK3\"\n{\n  \"isvalid\": true,\n  \"address\": \"n4KWZKx349gdMQGgTnZ8W6WfgSwybkGSK3\",\n  \"scriptPubKey\": \"76a914fa20d564550b105787f7ce3a9ad7fd9a45cd407088ac\",\n  \"ismine\": false,\n  \"iswatchonly\": false,\n  \"isscript\": false\n}\n```\n```js\nvalidateaddress \"2N2g2H7gjA8a11g1yKBgh5VTqndyvbnWpBK\"\n{\n  \"isvalid\": true,\n  \"address\": \"2N2g2H7gjA8a11g1yKBgh5VTqndyvbnWpBK\",\n  \"scriptPubKey\": \"a9146769c19a16c9400b908756e19a4d2afb9e9760e187\",\n  \"ismine\": false,\n  \"iswatchonly\": false,\n  \"isscript\": true\n}\n```\n\nAfter adding the redeemScript:\n```js\naddmultisigaddress 2 '[\"02537357B156A33306A7A014A3748631C59DF405B56F11BA4AA4A3CE81501AF095\",\"02F1FB200390E7864EF4450C07B15988179A57C3CF3A878F668E1070CB615749FE\"]'\n2N2g2H7gjA8a11g1yKBgh5VTqndyvbnWpBK\n\nvalidateaddress \"2N2g2H7gjA8a11g1yKBgh5VTqndyvbnWpBK\"\n{\n  \"isvalid\": true,\n  \"address\": \"2N2g2H7gjA8a11g1yKBgh5VTqndyvbnWpBK\",\n  \"scriptPubKey\": \"a9146769c19a16c9400b908756e19a4d2afb9e9760e187\",\n  \"ismine\": false,\n  \"iswatchonly\": false,\n  \"isscript\": true,\n  \"script\": \"multisig\",\n  \"hex\": \"522102537357b156a33306a7a014a3748631c59df405b56f11ba4aa4a3ce81501af0952102f1fb200390e7864ef4450c07b15988179a57c3cf3a878f668e1070cb615749fe52ae\",\n  \"addresses\": [\n    \"n4KWZKx349gdMQGgTnZ8W6WfgSwybkGSK3\",\n    \"mmSKNtbYYHRrhTLKiok5TuYrGEs4Y2A4k6\"\n  ],\n  \"sigsrequired\": 2,\n  \"account\": \"\"\n}\n```\n\nAll keys available:\n```js\nvalidateaddress \"n4KWZKx349gdMQGgTnZ8W6WfgSwybkGSK3\"\n{\n  \"isvalid\": true,\n  \"address\": \"n4KWZKx349gdMQGgTnZ8W6WfgSwybkGSK3\",\n  \"scriptPubKey\": \"76a914fa20d564550b105787f7ce3a9ad7fd9a45cd407088ac\",\n  \"ismine\": true,\n  \"iswatchonly\": false,\n  \"isscript\": false,\n  \"pubkey\": \"02537357b156a33306a7a014a3748631c59df405b56f11ba4aa4a3ce81501af095\",\n  \"iscompressed\": true,\n  \"account\": \"\"\n}\n```\n```js\nvalidateaddress \"2N2g2H7gjA8a11g1yKBgh5VTqndyvbnWpBK\"\n{\n  \"isvalid\": true,\n  \"address\": \"2N2g2H7gjA8a11g1yKBgh5VTqndyvbnWpBK\",\n  \"scriptPubKey\": \"a9146769c19a16c9400b908756e19a4d2afb9e9760e187\",\n  \"ismine\": true,\n  \"iswatchonly\": false,\n  \"isscript\": true,\n  \"script\": \"multisig\",\n  \"hex\": \"522102537357b156a33306a7a014a3748631c59df405b56f11ba4aa4a3ce81501af0952102f1fb200390e7864ef4450c07b15988179a57c3cf3a878f668e1070cb615749fe52ae\",\n  \"addresses\": [\n    \"n4KWZKx349gdMQGgTnZ8W6WfgSwybkGSK3\",\n    \"mmSKNtbYYHRrhTLKiok5TuYrGEs4Y2A4k6\"\n  ],\n  \"sigsrequired\": 2,\n  \"account\": \"\"\n}\n```\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/506bae3ac94ae9d5edfa794d9b80a7c9921ace17",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/506bae3ac94ae9d5edfa794d9b80a7c9921ace17",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/506bae3ac94ae9d5edfa794d9b80a7c9921ace17/comments",
    "author": {
      "login": "dexX7",
      "id": 5836089,
      "node_id": "MDQ6VXNlcjU4MzYwODk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5836089?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dexX7",
      "html_url": "https://github.com/dexX7",
      "followers_url": "https://api.github.com/users/dexX7/followers",
      "following_url": "https://api.github.com/users/dexX7/following{/other_user}",
      "gists_url": "https://api.github.com/users/dexX7/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dexX7/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dexX7/subscriptions",
      "organizations_url": "https://api.github.com/users/dexX7/orgs",
      "repos_url": "https://api.github.com/users/dexX7/repos",
      "events_url": "https://api.github.com/users/dexX7/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dexX7/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "dexX7",
      "id": 5836089,
      "node_id": "MDQ6VXNlcjU4MzYwODk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5836089?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dexX7",
      "html_url": "https://github.com/dexX7",
      "followers_url": "https://api.github.com/users/dexX7/followers",
      "following_url": "https://api.github.com/users/dexX7/following{/other_user}",
      "gists_url": "https://api.github.com/users/dexX7/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dexX7/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dexX7/subscriptions",
      "organizations_url": "https://api.github.com/users/dexX7/orgs",
      "repos_url": "https://api.github.com/users/dexX7/repos",
      "events_url": "https://api.github.com/users/dexX7/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dexX7/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "defa4fc25c6dc1b360fb974690516df35629db1d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/defa4fc25c6dc1b360fb974690516df35629db1d",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/defa4fc25c6dc1b360fb974690516df35629db1d"
      }
    ],
    "stats": {
      "total": 21,
      "additions": 6,
      "deletions": 15
    },
    "files": [
      {
        "sha": "1d47bc06a5131f4baba7d544e5264c03ab76b7eb",
        "filename": "src/rpcmisc.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 15,
        "changes": 21,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/506bae3ac94ae9d5edfa794d9b80a7c9921ace17/src/rpcmisc.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/506bae3ac94ae9d5edfa794d9b80a7c9921ace17/src/rpcmisc.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpcmisc.cpp?ref=506bae3ac94ae9d5edfa794d9b80a7c9921ace17",
        "patch": "@@ -109,20 +109,14 @@ UniValue getinfo(const UniValue& params, bool fHelp)\n #ifdef ENABLE_WALLET\n class DescribeAddressVisitor : public boost::static_visitor<UniValue>\n {\n-private:\n-    isminetype mine;\n-\n public:\n-    DescribeAddressVisitor(isminetype mineIn) : mine(mineIn) {}\n-\n     UniValue operator()(const CNoDestination &dest) const { return UniValue(UniValue::VOBJ); }\n \n     UniValue operator()(const CKeyID &keyID) const {\n         UniValue obj(UniValue::VOBJ);\n         CPubKey vchPubKey;\n         obj.push_back(Pair(\"isscript\", false));\n-        if (mine == ISMINE_SPENDABLE) {\n-            pwalletMain->GetPubKey(keyID, vchPubKey);\n+        if (pwalletMain->GetPubKey(keyID, vchPubKey)) {\n             obj.push_back(Pair(\"pubkey\", HexStr(vchPubKey)));\n             obj.push_back(Pair(\"iscompressed\", vchPubKey.IsCompressed()));\n         }\n@@ -131,10 +125,9 @@ class DescribeAddressVisitor : public boost::static_visitor<UniValue>\n \n     UniValue operator()(const CScriptID &scriptID) const {\n         UniValue obj(UniValue::VOBJ);\n+        CScript subscript;\n         obj.push_back(Pair(\"isscript\", true));\n-        if (mine != ISMINE_NO) {\n-            CScript subscript;\n-            pwalletMain->GetCScript(scriptID, subscript);\n+        if (pwalletMain->GetCScript(scriptID, subscript)) {\n             std::vector<CTxDestination> addresses;\n             txnouttype whichType;\n             int nRequired;\n@@ -200,11 +193,9 @@ UniValue validateaddress(const UniValue& params, bool fHelp)\n #ifdef ENABLE_WALLET\n         isminetype mine = pwalletMain ? IsMine(*pwalletMain, dest) : ISMINE_NO;\n         ret.push_back(Pair(\"ismine\", (mine & ISMINE_SPENDABLE) ? true : false));\n-        if (mine != ISMINE_NO) {\n-            ret.push_back(Pair(\"iswatchonly\", (mine & ISMINE_WATCH_ONLY) ? true: false));\n-            UniValue detail = boost::apply_visitor(DescribeAddressVisitor(mine), dest);\n-            ret.pushKVs(detail);\n-        }\n+        ret.push_back(Pair(\"iswatchonly\", (mine & ISMINE_WATCH_ONLY) ? true: false));\n+        UniValue detail = boost::apply_visitor(DescribeAddressVisitor(), dest);\n+        ret.pushKVs(detail);\n         if (pwalletMain && pwalletMain->mapAddressBook.count(dest))\n             ret.push_back(Pair(\"account\", pwalletMain->mapAddressBook[dest].name));\n #endif"
      }
    ]
  }
]