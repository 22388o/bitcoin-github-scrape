[
  {
    "sha": "fa121f058fdc5f09dd11678480f551246cb3c5e2",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYTEyMWYwNThmZGM1ZjA5ZGQxMTY3ODQ4MGY1NTEyNDZjYjNjNWUy",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-12-28T20:53:19Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-01-02T14:05:21Z"
      },
      "message": "fuzz: Use ConsumeNode in process_messages target",
      "tree": {
        "sha": "30d6e4a49289af36598152a1cf319f8d94cf2663",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/30d6e4a49289af36598152a1cf319f8d94cf2663"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa121f058fdc5f09dd11678480f551246cb3c5e2",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUgKGQv+PxZz3wszTVXH1/Clkboe1PF9VH34Rtm6iGq9YoiP+x/Ki9GSJhaP3/xP\nwLWTFRQF+RaCZr94GrmPu+ISWJhlBJlOQ9W9b4s1wb6ae8nyDk0lEgenKy6InkSj\naHc3UZNmWMUz4yBfd1EVr1qrsJLPQFduv1B+gqXK/EC1JR7zuy3TroKZTpZ3plu6\ncf3vXT+Rw5ihwwkUQDB2QA8S2gLWOjjos6d+zR+/vp6vJn/q61HN2IPTCB+R9xQO\ndRWTBTDnlUL1HQVDzYJ39nRLAAHmes1najaR4JCKW4K8PAX8Ihb3mi6snd34hE/d\ny51uB5by8yhucaKaMJQv0UwBiXk7ZSgAsGWvBs4uz2TVgINtapqQ+pNg9jVJ3hGx\nB9YreVZ6PLUxEhSx3aFQB3IHKEa6B1hDVxYPHg2Rbh1Uw/lzd/9NjHdZxHA1OUTV\nX9pEKP//XVTuWywHGyEWDVn0Pe2V7aFokwEnUSO1SeAMcn5JdaTVT6oqe/GZlg2i\n1+lPGwYL\n=mPQ/\n-----END PGP SIGNATURE-----",
        "payload": "tree 30d6e4a49289af36598152a1cf319f8d94cf2663\nparent 6f97172b4296395f93648c86ea4c9fc519bcb488\nauthor MarcoFalke <falke.marco@gmail.com> 1609188799 +0100\ncommitter MarcoFalke <falke.marco@gmail.com> 1609596321 +0100\n\nfuzz: Use ConsumeNode in process_messages target\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa121f058fdc5f09dd11678480f551246cb3c5e2",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fa121f058fdc5f09dd11678480f551246cb3c5e2",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa121f058fdc5f09dd11678480f551246cb3c5e2/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "6f97172b4296395f93648c86ea4c9fc519bcb488",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6f97172b4296395f93648c86ea4c9fc519bcb488",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/6f97172b4296395f93648c86ea4c9fc519bcb488"
      }
    ],
    "stats": {
      "total": 16,
      "additions": 10,
      "deletions": 6
    },
    "files": [
      {
        "sha": "fcfa623508d211094b7ea01f4be6ec6ccbf70b3c",
        "filename": "src/test/fuzz/process_messages.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 3,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa121f058fdc5f09dd11678480f551246cb3c5e2/src/test/fuzz/process_messages.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa121f058fdc5f09dd11678480f551246cb3c5e2/src/test/fuzz/process_messages.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/process_messages.cpp?ref=fa121f058fdc5f09dd11678480f551246cb3c5e2",
        "patch": "@@ -47,9 +47,7 @@ FUZZ_TARGET_INIT(process_messages, initialize_process_messages)\n \n     const auto num_peers_to_add = fuzzed_data_provider.ConsumeIntegralInRange(1, 3);\n     for (int i = 0; i < num_peers_to_add; ++i) {\n-        const ServiceFlags service_flags = ServiceFlags(fuzzed_data_provider.ConsumeIntegral<uint64_t>());\n-        const ConnectionType conn_type = fuzzed_data_provider.PickValueInArray({ConnectionType::INBOUND, ConnectionType::OUTBOUND_FULL_RELAY, ConnectionType::MANUAL, ConnectionType::FEELER, ConnectionType::BLOCK_RELAY, ConnectionType::ADDR_FETCH});\n-        peers.push_back(MakeUnique<CNode>(i, service_flags, INVALID_SOCKET, CAddress{CService{in_addr{0x0100007f}, 7777}, NODE_NETWORK}, 0, 0, CAddress{}, std::string{}, conn_type).release());\n+        peers.push_back(ConsumeNodeAsUniquePtr(fuzzed_data_provider, i).release());\n         CNode& p2p_node = *peers.back();\n \n         p2p_node.fSuccessfullyConnected = true;"
      },
      {
        "sha": "8fdb16d2df2d516e5c540f377790c4387873d2db",
        "filename": "src/test/fuzz/util.h",
        "status": "modified",
        "additions": 9,
        "deletions": 3,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa121f058fdc5f09dd11678480f551246cb3c5e2/src/test/fuzz/util.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa121f058fdc5f09dd11678480f551246cb3c5e2/src/test/fuzz/util.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/util.h?ref=fa121f058fdc5f09dd11678480f551246cb3c5e2",
        "patch": "@@ -286,9 +286,10 @@ inline CAddress ConsumeAddress(FuzzedDataProvider& fuzzed_data_provider) noexcep\n     return {ConsumeService(fuzzed_data_provider), static_cast<ServiceFlags>(fuzzed_data_provider.ConsumeIntegral<uint64_t>()), fuzzed_data_provider.ConsumeIntegral<uint32_t>()};\n }\n \n-inline CNode ConsumeNode(FuzzedDataProvider& fuzzed_data_provider) noexcept\n+template <bool ReturnUniquePtr = false>\n+auto ConsumeNode(FuzzedDataProvider& fuzzed_data_provider, const std::optional<NodeId>& node_id_in = nullopt) noexcept\n {\n-    const NodeId node_id = fuzzed_data_provider.ConsumeIntegral<NodeId>();\n+    const NodeId node_id = node_id_in.value_or(fuzzed_data_provider.ConsumeIntegral<NodeId>());\n     const ServiceFlags local_services = static_cast<ServiceFlags>(fuzzed_data_provider.ConsumeIntegral<uint64_t>());\n     const SOCKET socket = INVALID_SOCKET;\n     const CAddress address = ConsumeAddress(fuzzed_data_provider);\n@@ -298,8 +299,13 @@ inline CNode ConsumeNode(FuzzedDataProvider& fuzzed_data_provider) noexcept\n     const std::string addr_name = fuzzed_data_provider.ConsumeRandomLengthString(64);\n     const ConnectionType conn_type = fuzzed_data_provider.PickValueInArray({ConnectionType::INBOUND, ConnectionType::OUTBOUND_FULL_RELAY, ConnectionType::MANUAL, ConnectionType::FEELER, ConnectionType::BLOCK_RELAY, ConnectionType::ADDR_FETCH});\n     const bool inbound_onion{conn_type == ConnectionType::INBOUND ? fuzzed_data_provider.ConsumeBool() : false};\n-    return {node_id, local_services, socket, address, keyed_net_group, local_host_nonce, addr_bind, addr_name, conn_type, inbound_onion};\n+    if constexpr (ReturnUniquePtr) {\n+        return std::make_unique<CNode>(node_id, local_services, socket, address, keyed_net_group, local_host_nonce, addr_bind, addr_name, conn_type, inbound_onion);\n+    } else {\n+        return CNode{node_id, local_services, socket, address, keyed_net_group, local_host_nonce, addr_bind, addr_name, conn_type, inbound_onion};\n+    }\n }\n+inline std::unique_ptr<CNode> ConsumeNodeAsUniquePtr(FuzzedDataProvider& fdp, const std::optional<NodeId>& node_id_in = nullopt) { return ConsumeNode<true>(fdp, node_id_in); }\n \n inline void InitializeFuzzingContext(const std::string& chain_name = CBaseChainParams::REGTEST)\n {"
      }
    ]
  },
  {
    "sha": "fa42da2d5424c0aeccfae4b49fde2bea330b63dc",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYTQyZGEyZDU0MjRjMGFlY2NmYWU0YjQ5ZmRlMmJlYTMzMGI2M2Rj",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-12-28T20:52:40Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-01-02T14:05:24Z"
      },
      "message": "fuzz: Use ConsumeNode in process_message target",
      "tree": {
        "sha": "879476467c68fb4ec7324dc1ecaf37a0d4cbd039",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/879476467c68fb4ec7324dc1ecaf37a0d4cbd039"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa42da2d5424c0aeccfae4b49fde2bea330b63dc",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUjuhAv+PLKlRv1nvwE7EaijFj736d/cqIE9To6TMEpw0ikKQOGOgeXa0IOo3Aev\nCan2QLBKgQREOiP0qJkW0WdvlzIKANvnV6NKjOsnN6og5p1s/UQf83kukvhtyszW\n7z8NJ3Gh+FBXe7+46hXJQ83UmjkhmsUHDNLaLWX8jEmde2AmOUUScR6yxkMRhb9p\nlnOUo5bPKyIlXqY17iblK9ECGDtbn0xbAlf+NOS9sYeG9MeDsAePIKOBgGVW3tDL\nXHItb+DVAcIECz9DNteoPyYL43ZimpSgTDmAJQ/OpikD2Hq6BEbHGcZPbkTGC1ug\nFpP0fIMOJyXwcpCYlLwtb5jbU2V5VHN66KqclgxO9KMLOyqpDFbHhDRkNN8yCX3W\nurJU/S9Zy0hkpjEKMhf8HMvhME86B12URJLKgHYQcKMgmubH4Ul/Oi+4ydzCQLQs\nId7Rkh76pIZnUtQSEc9CYlTB11fiGXIOhZ6VlyMyY0zAij+yfsybnTibS1J0Fs1s\nPQSsJij2\n=vkCr\n-----END PGP SIGNATURE-----",
        "payload": "tree 879476467c68fb4ec7324dc1ecaf37a0d4cbd039\nparent fa121f058fdc5f09dd11678480f551246cb3c5e2\nauthor MarcoFalke <falke.marco@gmail.com> 1609188760 +0100\ncommitter MarcoFalke <falke.marco@gmail.com> 1609596324 +0100\n\nfuzz: Use ConsumeNode in process_message target\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa42da2d5424c0aeccfae4b49fde2bea330b63dc",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fa42da2d5424c0aeccfae4b49fde2bea330b63dc",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa42da2d5424c0aeccfae4b49fde2bea330b63dc/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fa121f058fdc5f09dd11678480f551246cb3c5e2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa121f058fdc5f09dd11678480f551246cb3c5e2",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fa121f058fdc5f09dd11678480f551246cb3c5e2"
      }
    ],
    "stats": {
      "total": 7,
      "additions": 5,
      "deletions": 2
    },
    "files": [
      {
        "sha": "b6865c534781fdd03d4ebccfa9baff955802d75a",
        "filename": "src/test/fuzz/process_message.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 2,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa42da2d5424c0aeccfae4b49fde2bea330b63dc/src/test/fuzz/process_message.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa42da2d5424c0aeccfae4b49fde2bea330b63dc/src/test/fuzz/process_message.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/process_message.cpp?ref=fa42da2d5424c0aeccfae4b49fde2bea330b63dc",
        "patch": "@@ -13,6 +13,7 @@\n #include <streams.h>\n #include <test/fuzz/FuzzedDataProvider.h>\n #include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n #include <test/util/mining.h>\n #include <test/util/net.h>\n #include <test/util/setup_common.h>\n@@ -63,13 +64,15 @@ void fuzz_target(const std::vector<uint8_t>& buffer, const std::string& LIMIT_TO\n     }\n     const bool jump_out_of_ibd{fuzzed_data_provider.ConsumeBool()};\n     if (jump_out_of_ibd) chainstate.JumpOutOfIbd();\n-    CDataStream random_bytes_data_stream{fuzzed_data_provider.ConsumeRemainingBytes<unsigned char>(), SER_NETWORK, PROTOCOL_VERSION};\n-    CNode& p2p_node = *MakeUnique<CNode>(0, ServiceFlags(NODE_NETWORK | NODE_WITNESS | NODE_BLOOM), INVALID_SOCKET, CAddress{CService{in_addr{0x0100007f}, 7777}, NODE_NETWORK}, 0, 0, CAddress{}, std::string{}, ConnectionType::OUTBOUND_FULL_RELAY).release();\n+    CNode& p2p_node = *ConsumeNodeAsUniquePtr(fuzzed_data_provider).release();\n     p2p_node.fSuccessfullyConnected = true;\n     p2p_node.nVersion = PROTOCOL_VERSION;\n     p2p_node.SetCommonVersion(PROTOCOL_VERSION);\n     connman.AddTestNode(p2p_node);\n     g_setup->m_node.peerman->InitializeNode(&p2p_node);\n+\n+    // fuzzed_data_provider is fully consumed after this call, don't use it\n+    CDataStream random_bytes_data_stream{fuzzed_data_provider.ConsumeRemainingBytes<unsigned char>(), SER_NETWORK, PROTOCOL_VERSION};\n     try {\n         g_setup->m_node.peerman->ProcessMessage(p2p_node, random_message_type, random_bytes_data_stream,\n                                                 GetTime<std::chrono::microseconds>(), std::atomic<bool>{false});"
      }
    ]
  },
  {
    "sha": "faaef9434c19e3643322ee442c240c166af5adbd",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYWFlZjk0MzRjMTllMzY0MzMyMmVlNDQyYzI0MGMxNjZhZjVhZGJk",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-12-28T20:31:33Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-01-02T14:06:36Z"
      },
      "message": "fuzz: [refactor] Extract ALL_CONNECTION_TYPES constant",
      "tree": {
        "sha": "57b83f64d35d1c4258109cf901847385cfd463be",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/57b83f64d35d1c4258109cf901847385cfd463be"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/faaef9434c19e3643322ee442c240c166af5adbd",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUhv8wwAldX+37fapC9ehdgp59y51GZUXDTLiTv8kd4D8evy0kt0/Oj9SM638jSh\nmiOxrbpTHfOW0/3jYg8pcXtRNUA9UqDOGkYWvGEb2vsNhUlpwH1QqbmX5E/vCxi+\nMrbd5etT1eameEC0aXqIyVBEZGJYydCBEJW1BetIq8TdeUA/z/7+3tdK2F72fmDW\nqrPeBbaNwXhyYTQYsKcx7DzgHO9JA7uYZNrVFyG2GsQ1fZ2ZO2U2nI1OSw+m+jbv\nYiYATM+bYycaN4JpP2dyfBg6CH6DGB+mPta6ksCoESQDas1sctj0STTcweGtSt+C\n8+Gysfdf9DoSLUg6PsS9qoNSKoBXHornRPhur899KHLrBe0nRN28782LHtiSmV9q\nsCrZAufMVbRtDV9I7OHg0FYzFbFU8MykILKUj9pxtZeLEpGYEbmGgAsJ+IboBnzN\nMu14pKeUJAFaW4Lef9fT6+LNUt+JZjxhXzlBzhuTQ6wtEHaX1GuFhXNSZS/l6gpa\nwb6clxeL\n=hxXZ\n-----END PGP SIGNATURE-----",
        "payload": "tree 57b83f64d35d1c4258109cf901847385cfd463be\nparent fa42da2d5424c0aeccfae4b49fde2bea330b63dc\nauthor MarcoFalke <falke.marco@gmail.com> 1609187493 +0100\ncommitter MarcoFalke <falke.marco@gmail.com> 1609596396 +0100\n\nfuzz: [refactor] Extract ALL_CONNECTION_TYPES constant\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faaef9434c19e3643322ee442c240c166af5adbd",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/faaef9434c19e3643322ee442c240c166af5adbd",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faaef9434c19e3643322ee442c240c166af5adbd/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fa42da2d5424c0aeccfae4b49fde2bea330b63dc",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa42da2d5424c0aeccfae4b49fde2bea330b63dc",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fa42da2d5424c0aeccfae4b49fde2bea330b63dc"
      }
    ],
    "stats": {
      "total": 12,
      "additions": 11,
      "deletions": 1
    },
    "files": [
      {
        "sha": "cd5da8aae831896ade918c31ef5375b3991a0922",
        "filename": "src/test/fuzz/util.h",
        "status": "modified",
        "additions": 2,
        "deletions": 1,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faaef9434c19e3643322ee442c240c166af5adbd/src/test/fuzz/util.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faaef9434c19e3643322ee442c240c166af5adbd/src/test/fuzz/util.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/util.h?ref=faaef9434c19e3643322ee442c240c166af5adbd",
        "patch": "@@ -22,6 +22,7 @@\n #include <streams.h>\n #include <test/fuzz/FuzzedDataProvider.h>\n #include <test/fuzz/fuzz.h>\n+#include <test/util/net.h>\n #include <test/util/setup_common.h>\n #include <txmempool.h>\n #include <uint256.h>\n@@ -297,7 +298,7 @@ auto ConsumeNode(FuzzedDataProvider& fuzzed_data_provider, const std::optional<N\n     const uint64_t local_host_nonce = fuzzed_data_provider.ConsumeIntegral<uint64_t>();\n     const CAddress addr_bind = ConsumeAddress(fuzzed_data_provider);\n     const std::string addr_name = fuzzed_data_provider.ConsumeRandomLengthString(64);\n-    const ConnectionType conn_type = fuzzed_data_provider.PickValueInArray({ConnectionType::INBOUND, ConnectionType::OUTBOUND_FULL_RELAY, ConnectionType::MANUAL, ConnectionType::FEELER, ConnectionType::BLOCK_RELAY, ConnectionType::ADDR_FETCH});\n+    const ConnectionType conn_type = fuzzed_data_provider.PickValueInArray(ALL_CONNECTION_TYPES);\n     const bool inbound_onion{conn_type == ConnectionType::INBOUND ? fuzzed_data_provider.ConsumeBool() : false};\n     if constexpr (ReturnUniquePtr) {\n         return std::make_unique<CNode>(node_id, local_services, socket, address, keyed_net_group, local_host_nonce, addr_bind, addr_name, conn_type, inbound_onion);"
      },
      {
        "sha": "5fad570c29f6fbe57ac9679f9d0115a38107b710",
        "filename": "src/test/util/net.h",
        "status": "modified",
        "additions": 9,
        "deletions": 0,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faaef9434c19e3643322ee442c240c166af5adbd/src/test/util/net.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faaef9434c19e3643322ee442c240c166af5adbd/src/test/util/net.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/util/net.h?ref=faaef9434c19e3643322ee442c240c166af5adbd",
        "patch": "@@ -30,4 +30,13 @@ struct ConnmanTestMsg : public CConnman {\n     bool ReceiveMsgFrom(CNode& node, CSerializedNetMsg& ser_msg) const;\n };\n \n+constexpr ConnectionType ALL_CONNECTION_TYPES[]{\n+    ConnectionType::INBOUND,\n+    ConnectionType::OUTBOUND_FULL_RELAY,\n+    ConnectionType::MANUAL,\n+    ConnectionType::FEELER,\n+    ConnectionType::BLOCK_RELAY,\n+    ConnectionType::ADDR_FETCH,\n+};\n+\n #endif // BITCOIN_TEST_UTIL_NET_H"
      }
    ]
  },
  {
    "sha": "fa9949b91414ee0da376a322cee32ba4e3989d8c",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYTk5NDliOTE0MTRlZTBkYTM3NmEzMjJjZWUzMmJhNGUzOTg5ZDhj",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-12-28T20:58:00Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-01-02T14:07:07Z"
      },
      "message": "fuzz: Add ConsumeWeakEnum helper, Extract ALL_NET_PERMISSION_FLAGS",
      "tree": {
        "sha": "10cf748ce8c83c85d6a8f6fc490c42754055fe83",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/10cf748ce8c83c85d6a8f6fc490c42754055fe83"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa9949b91414ee0da376a322cee32ba4e3989d8c",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUhsygv/aXeVBNHrPJdQTUQR2u/eepMrjIgs2yGu/lTGnUz6GNfwKmwoFiTD2BzE\n1UTzM6Gqd5UHAonhrn6Ulxbyo6sQqOoA6D8axZ6z5V809l9lDIZV/wHQfiDWegz5\no9+YABoLbW8IQegyonpWBV1rC62tz4Le8xSS+TcMV0wD4dI9ll2tPK+jUShXCrdb\ns0FD6xJwGrboMGg18IdrTlh6F11bK/g09e+7TV/S6NPExDJKs1kmyhQNEzzZavDJ\nwovpaHJ/3ht8HBiUEcHl2T/7Ot87oWfCP8Ba4/YVR3vroplvr3fc8htNxuqNo8sM\nvs2qfa17F4qMSF+V/ywRP/XRq5enFKf8MylkLFiaOOYd+0l+uur+RTV4Y48gmGPT\nuy9dHVRWTL0Xw8OOg6qpK5YjmEem93+Fdlj2DGpmWm9jKTSsAsIopesW1Rpmu5HX\nfzU3dDZXATQTo4bF/3e2KsPb7C5y+Cf/9eQEylrG/OrVvps4FpvYr0uJNqhSOogd\nc3wf35+r\n=QZ8o\n-----END PGP SIGNATURE-----",
        "payload": "tree 10cf748ce8c83c85d6a8f6fc490c42754055fe83\nparent faaef9434c19e3643322ee442c240c166af5adbd\nauthor MarcoFalke <falke.marco@gmail.com> 1609189080 +0100\ncommitter MarcoFalke <falke.marco@gmail.com> 1609596427 +0100\n\nfuzz: Add ConsumeWeakEnum helper, Extract ALL_NET_PERMISSION_FLAGS\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa9949b91414ee0da376a322cee32ba4e3989d8c",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fa9949b91414ee0da376a322cee32ba4e3989d8c",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa9949b91414ee0da376a322cee32ba4e3989d8c/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "faaef9434c19e3643322ee442c240c166af5adbd",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faaef9434c19e3643322ee442c240c166af5adbd",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/faaef9434c19e3643322ee442c240c166af5adbd"
      }
    ],
    "stats": {
      "total": 39,
      "additions": 24,
      "deletions": 15
    },
    "files": [
      {
        "sha": "3ca921b5cf8e5b7bac0192b6efa1033237eb69f0",
        "filename": "src/test/fuzz/net.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 3,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa9949b91414ee0da376a322cee32ba4e3989d8c/src/test/fuzz/net.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa9949b91414ee0da376a322cee32ba4e3989d8c/src/test/fuzz/net.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/net.cpp?ref=fa9949b91414ee0da376a322cee32ba4e3989d8c",
        "patch": "@@ -13,6 +13,7 @@\n #include <test/fuzz/FuzzedDataProvider.h>\n #include <test/fuzz/fuzz.h>\n #include <test/fuzz/util.h>\n+#include <test/util/net.h>\n #include <test/util/setup_common.h>\n \n #include <cstdint>\n@@ -122,9 +123,7 @@ FUZZ_TARGET_INIT(net, initialize_net)\n     (void)node.GetCommonVersion();\n     (void)node.RelayAddrsWithConn();\n \n-    const NetPermissionFlags net_permission_flags = fuzzed_data_provider.ConsumeBool() ?\n-                                                        fuzzed_data_provider.PickValueInArray<NetPermissionFlags>({NetPermissionFlags::PF_NONE, NetPermissionFlags::PF_BLOOMFILTER, NetPermissionFlags::PF_RELAY, NetPermissionFlags::PF_FORCERELAY, NetPermissionFlags::PF_NOBAN, NetPermissionFlags::PF_MEMPOOL, NetPermissionFlags::PF_ISIMPLICIT, NetPermissionFlags::PF_ALL}) :\n-                                                        static_cast<NetPermissionFlags>(fuzzed_data_provider.ConsumeIntegral<uint32_t>());\n+    const NetPermissionFlags net_permission_flags = ConsumeWeakEnum(fuzzed_data_provider, ALL_NET_PERMISSION_FLAGS);\n     (void)node.HasPermission(net_permission_flags);\n     (void)node.ConnectedThroughNetwork();\n }"
      },
      {
        "sha": "544a33047bb35a6bd23baad1a7c11565a5fc8cc4",
        "filename": "src/test/fuzz/net_permissions.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 12,
        "changes": 13,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa9949b91414ee0da376a322cee32ba4e3989d8c/src/test/fuzz/net_permissions.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa9949b91414ee0da376a322cee32ba4e3989d8c/src/test/fuzz/net_permissions.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/net_permissions.cpp?ref=fa9949b91414ee0da376a322cee32ba4e3989d8c",
        "patch": "@@ -17,18 +17,7 @@ FUZZ_TARGET(net_permissions)\n {\n     FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n     const std::string s = fuzzed_data_provider.ConsumeRandomLengthString(32);\n-    const NetPermissionFlags net_permission_flags = fuzzed_data_provider.ConsumeBool() ? fuzzed_data_provider.PickValueInArray<NetPermissionFlags>({\n-                                                                                             NetPermissionFlags::PF_NONE,\n-                                                                                             NetPermissionFlags::PF_BLOOMFILTER,\n-                                                                                             NetPermissionFlags::PF_RELAY,\n-                                                                                             NetPermissionFlags::PF_FORCERELAY,\n-                                                                                             NetPermissionFlags::PF_NOBAN,\n-                                                                                             NetPermissionFlags::PF_MEMPOOL,\n-                                                                                             NetPermissionFlags::PF_ADDR,\n-                                                                                             NetPermissionFlags::PF_ISIMPLICIT,\n-                                                                                             NetPermissionFlags::PF_ALL,\n-                                                                                         }) :\n-                                                                                         static_cast<NetPermissionFlags>(fuzzed_data_provider.ConsumeIntegral<uint32_t>());\n+    const NetPermissionFlags net_permission_flags = ConsumeWeakEnum(fuzzed_data_provider, ALL_NET_PERMISSION_FLAGS);\n \n     NetWhitebindPermissions net_whitebind_permissions;\n     bilingual_str error_net_whitebind_permissions;"
      },
      {
        "sha": "1aa6463b88fceac36dd36149e2bd26a29c1d8a76",
        "filename": "src/test/fuzz/util.h",
        "status": "modified",
        "additions": 8,
        "deletions": 0,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa9949b91414ee0da376a322cee32ba4e3989d8c/src/test/fuzz/util.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa9949b91414ee0da376a322cee32ba4e3989d8c/src/test/fuzz/util.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/util.h?ref=fa9949b91414ee0da376a322cee32ba4e3989d8c",
        "patch": "@@ -87,6 +87,14 @@ template <typename T>\n     return obj;\n }\n \n+template <typename WeakEnumType, size_t size>\n+[[nodiscard]] WeakEnumType ConsumeWeakEnum(FuzzedDataProvider& fuzzed_data_provider, const WeakEnumType (&all_types)[size]) noexcept\n+{\n+    return fuzzed_data_provider.ConsumeBool() ?\n+               fuzzed_data_provider.PickValueInArray<WeakEnumType>(all_types) :\n+               WeakEnumType(fuzzed_data_provider.ConsumeIntegral<typename std::underlying_type<WeakEnumType>::type>());\n+}\n+\n [[nodiscard]] inline opcodetype ConsumeOpcodeType(FuzzedDataProvider& fuzzed_data_provider) noexcept\n {\n     return static_cast<opcodetype>(fuzzed_data_provider.ConsumeIntegralInRange<uint32_t>(0, MAX_OPCODE));"
      },
      {
        "sha": "661d21227fd088e8dd12fcc730a7e647b0736298",
        "filename": "src/test/util/net.h",
        "status": "modified",
        "additions": 13,
        "deletions": 0,
        "changes": 13,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa9949b91414ee0da376a322cee32ba4e3989d8c/src/test/util/net.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa9949b91414ee0da376a322cee32ba4e3989d8c/src/test/util/net.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/util/net.h?ref=fa9949b91414ee0da376a322cee32ba4e3989d8c",
        "patch": "@@ -30,6 +30,19 @@ struct ConnmanTestMsg : public CConnman {\n     bool ReceiveMsgFrom(CNode& node, CSerializedNetMsg& ser_msg) const;\n };\n \n+constexpr NetPermissionFlags ALL_NET_PERMISSION_FLAGS[]{\n+    NetPermissionFlags::PF_NONE,\n+    NetPermissionFlags::PF_BLOOMFILTER,\n+    NetPermissionFlags::PF_RELAY,\n+    NetPermissionFlags::PF_FORCERELAY,\n+    NetPermissionFlags::PF_NOBAN,\n+    NetPermissionFlags::PF_MEMPOOL,\n+    NetPermissionFlags::PF_ADDR,\n+    NetPermissionFlags::PF_DOWNLOAD,\n+    NetPermissionFlags::PF_ISIMPLICIT,\n+    NetPermissionFlags::PF_ALL,\n+};\n+\n constexpr ConnectionType ALL_CONNECTION_TYPES[]{\n     ConnectionType::INBOUND,\n     ConnectionType::OUTBOUND_FULL_RELAY,"
      }
    ]
  },
  {
    "sha": "eeee43bc48ea7fbacd3c5e3f076f01f04744adb8",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplZWVlNDNiYzQ4ZWE3ZmJhY2QzYzVlM2YwNzZmMDFmMDQ3NDRhZGI4",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-01-02T09:14:39Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-01-02T14:07:29Z"
      },
      "message": "fuzz: Use ConsumeWeakEnum for ServiceFlags",
      "tree": {
        "sha": "618c197ac3f3199925d01bb1cf7e56fbe07d8ca0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/618c197ac3f3199925d01bb1cf7e56fbe07d8ca0"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/eeee43bc48ea7fbacd3c5e3f076f01f04744adb8",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUjLTQv/amhBTcJWgqD9emB/ltTpQZ9Kb6pEteZjN6VEJDYOeD4xCkGaZKtaGi+U\nwOueujMt56JW6My4u7MOVm1J+BeiDT9vqWLvyWa+XT9mRCRf7M0dAsCu+wQQQdjT\n1RgqP5V1tfjJjyFQl9VTYg70pi29Bkeky+ZcSYVMhPAH0Z/BMPcYtb6Lc8vkRUnM\nGX7ZMhIpelTtUQclyCPF2iG3XXeT15uoBaQsVUi8WDxgruj95gQuBE3RnRCkdrS8\nUczitlQKU1MOMKPgcuhZaqOg8Zix75NtROfVK6hazrhj+ZmNFEUgX0wOEn8pYo1a\nY1s6ChEajg/fN04iSs0ZA5rfSvluolGk/naSUeFB5M7JCJgpL74OsjmrRg9pKpCg\nC0p/MqC0wCxTDX4Z3+bJ0E+bbZaEclyRwSZ2V3AH6N218IYCvydZ3krsRZwY+eUw\nJfy8fF8w6iUC0MSkHHnbK4ehYAVZnP3JOaD7J697Dso+M4ZZT+C7nj1RLvHmUKN3\nQZSDq2iu\n=5v0Z\n-----END PGP SIGNATURE-----",
        "payload": "tree 618c197ac3f3199925d01bb1cf7e56fbe07d8ca0\nparent fa9949b91414ee0da376a322cee32ba4e3989d8c\nauthor MarcoFalke <falke.marco@gmail.com> 1609578879 +0100\ncommitter MarcoFalke <falke.marco@gmail.com> 1609596449 +0100\n\nfuzz: Use ConsumeWeakEnum for ServiceFlags\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/eeee43bc48ea7fbacd3c5e3f076f01f04744adb8",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/eeee43bc48ea7fbacd3c5e3f076f01f04744adb8",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/eeee43bc48ea7fbacd3c5e3f076f01f04744adb8/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fa9949b91414ee0da376a322cee32ba4e3989d8c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa9949b91414ee0da376a322cee32ba4e3989d8c",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fa9949b91414ee0da376a322cee32ba4e3989d8c"
      }
    ],
    "stats": {
      "total": 15,
      "additions": 12,
      "deletions": 3
    },
    "files": [
      {
        "sha": "fdf51d8558c7beb221ec82a41bc5883d31a8f202",
        "filename": "src/test/fuzz/connman.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/eeee43bc48ea7fbacd3c5e3f076f01f04744adb8/src/test/fuzz/connman.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/eeee43bc48ea7fbacd3c5e3f076f01f04744adb8/src/test/fuzz/connman.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/connman.cpp?ref=eeee43bc48ea7fbacd3c5e3f076f01f04744adb8",
        "patch": "@@ -128,7 +128,7 @@ FUZZ_TARGET_INIT(connman, initialize_connman)\n             connman.SetNetworkActive(fuzzed_data_provider.ConsumeBool());\n             break;\n         case 26:\n-            connman.SetServices(random_service, static_cast<ServiceFlags>(fuzzed_data_provider.ConsumeIntegral<uint64_t>()));\n+            connman.SetServices(random_service, ConsumeWeakEnum(fuzzed_data_provider, ALL_SERVICE_FLAGS));\n             break;\n         case 27:\n             connman.SetTryNewOutboundPeer(fuzzed_data_provider.ConsumeBool());"
      },
      {
        "sha": "94c691936e7c14e5ea1d87712ed50ba3711c810d",
        "filename": "src/test/fuzz/util.h",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/eeee43bc48ea7fbacd3c5e3f076f01f04744adb8/src/test/fuzz/util.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/eeee43bc48ea7fbacd3c5e3f076f01f04744adb8/src/test/fuzz/util.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/util.h?ref=eeee43bc48ea7fbacd3c5e3f076f01f04744adb8",
        "patch": "@@ -292,14 +292,14 @@ inline CService ConsumeService(FuzzedDataProvider& fuzzed_data_provider) noexcep\n \n inline CAddress ConsumeAddress(FuzzedDataProvider& fuzzed_data_provider) noexcept\n {\n-    return {ConsumeService(fuzzed_data_provider), static_cast<ServiceFlags>(fuzzed_data_provider.ConsumeIntegral<uint64_t>()), fuzzed_data_provider.ConsumeIntegral<uint32_t>()};\n+    return {ConsumeService(fuzzed_data_provider), ConsumeWeakEnum(fuzzed_data_provider, ALL_SERVICE_FLAGS), fuzzed_data_provider.ConsumeIntegral<uint32_t>()};\n }\n \n template <bool ReturnUniquePtr = false>\n auto ConsumeNode(FuzzedDataProvider& fuzzed_data_provider, const std::optional<NodeId>& node_id_in = nullopt) noexcept\n {\n     const NodeId node_id = node_id_in.value_or(fuzzed_data_provider.ConsumeIntegral<NodeId>());\n-    const ServiceFlags local_services = static_cast<ServiceFlags>(fuzzed_data_provider.ConsumeIntegral<uint64_t>());\n+    const ServiceFlags local_services = ConsumeWeakEnum(fuzzed_data_provider, ALL_SERVICE_FLAGS);\n     const SOCKET socket = INVALID_SOCKET;\n     const CAddress address = ConsumeAddress(fuzzed_data_provider);\n     const uint64_t keyed_net_group = fuzzed_data_provider.ConsumeIntegral<uint64_t>();"
      },
      {
        "sha": "e25036be26aafd5cbe58c37e0373c1e8554de01e",
        "filename": "src/test/util/net.h",
        "status": "modified",
        "additions": 9,
        "deletions": 0,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/eeee43bc48ea7fbacd3c5e3f076f01f04744adb8/src/test/util/net.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/eeee43bc48ea7fbacd3c5e3f076f01f04744adb8/src/test/util/net.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/util/net.h?ref=eeee43bc48ea7fbacd3c5e3f076f01f04744adb8",
        "patch": "@@ -30,6 +30,15 @@ struct ConnmanTestMsg : public CConnman {\n     bool ReceiveMsgFrom(CNode& node, CSerializedNetMsg& ser_msg) const;\n };\n \n+constexpr ServiceFlags ALL_SERVICE_FLAGS[]{\n+    NODE_NONE,\n+    NODE_NETWORK,\n+    NODE_BLOOM,\n+    NODE_WITNESS,\n+    NODE_COMPACT_FILTERS,\n+    NODE_NETWORK_LIMITED,\n+};\n+\n constexpr NetPermissionFlags ALL_NET_PERMISSION_FLAGS[]{\n     NetPermissionFlags::PF_NONE,\n     NetPermissionFlags::PF_BLOOMFILTER,"
      }
    ]
  }
]