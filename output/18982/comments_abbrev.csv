DrahtBot,2020-05-15 13:58:31,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19116 ([WIP] wallet: use BlockFilterIndex in ScanForWalletTransactions by pstratem)\n* #18600 ([wallet] Track conflicted ",https://github.com/bitcoin/bitcoin/pull/18982#issuecomment-629251455,629251455,
ryanofsky,2020-05-21 11:53:56,"(requested @jonatack as reviewer to help with documentation, since a lot is added here, and it'd be good to know if it makes sense to someone not in the weeds of transaction state tracking)",https://github.com/bitcoin/bitcoin/pull/18982#issuecomment-632045253,632045253,
jonatack,2020-05-22 16:25:40,"Also, AFAICT the added documentation in this PR coherently describes what the code is doing.",https://github.com/bitcoin/bitcoin/pull/18982#issuecomment-632782318,632782318,
jonatack,2020-05-24 12:13:37,"Re-ACK 7eaf86d3bfc83f \n\n<details><summary>changes since last review</summary><p>\n\n```diff\n((HEAD detached at origin/pr/18982))$ git diff 8242b09 7eaf86d\ndiff --git a/doc/release-notes-18982.md b/doc/release-notes-18982.md\nindex ee15a1070b..d1b8528d13 100644\n--- a/doc/release-notes-18982.md\n+++ b/doc/release-notes-18982.md\n@@ -3,6 +3,6 @@ Notification changes\n \n `-walletnoti",https://github.com/bitcoin/bitcoin/pull/18982#issuecomment-633222090,633222090,
ariard,2020-05-24 23:49:25,"ACK 7eaf86d, reviewed, built and ran tests.\n\nThanks for stretching my fix to the minimal required !",https://github.com/bitcoin/bitcoin/pull/18982#issuecomment-633318233,633318233,
MarcoFalke,2020-06-02 22:11:21,"Side-note: For backport only the first commit is required\n\n\n\nACK 7eaf86d3bfc83f2beb3ef449707d5156853126fb üç°\n\n<details><summary>Show signature and timestamp</summary>\n\nSignature:\n\n```\n-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA512\n\nACK 7eaf86d3bfc83f2beb3ef449707d5156853126fb üç°\n-----BEGIN PGP SIGNATURE-----\n\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQ",https://github.com/bitcoin/bitcoin/pull/18982#issuecomment-637832918,637832918,
ariard,2020-05-20 07:29:25,"I think we can dry-up MemPoolRemovalReason completely in the future. The only control flow pending on it I can see is in `removeUnchecked` and it's only consumed by `TransactionRemovedFromMempool`\n",https://github.com/bitcoin/bitcoin/pull/18982#discussion_r427797119,427797119,src/validationinterface.h
ariard,2020-05-20 07:33:19,"Can you explain which one are going to updated with CONFLICTED status and which not, i.e transactions not directly connected to a previous wallet transaction ?",https://github.com/bitcoin/bitcoin/pull/18982#discussion_r427799161,427799161,src/wallet/wallet.cpp
ariard,2020-05-20 07:34:42,"Also, document that conflict transaction tracking will always be a best-effort, an unconfirmed transaction may be removed while wallet is shutdown an therefore never getting the notification.",https://github.com/bitcoin/bitcoin/pull/18982#discussion_r427799842,427799842,src/wallet/wallet.cpp
ryanofsky,2020-05-20 23:16:46,"re: https://github.com/bitcoin/bitcoin/pull/18982#discussion_r427797119\n\n> I think we can dry-up MemPoolRemovalReason completely in the future. The only control flow pending on it I can see is in `removeUnchecked` and it's only consumed by `TransactionRemovedFromMempool`\n\nI'm open to removing MemPoolRemovalReason in the future if it simplifies code, hopefully without losing debug or loggin",https://github.com/bitcoin/bitcoin/pull/18982#discussion_r428360222,428360222,src/validationinterface.h
ryanofsky,2020-05-20 23:17:11,"re: https://github.com/bitcoin/bitcoin/pull/18982#discussion_r427799842\n\n> Also, document that conflict transaction tracking will always be a best-effort, an unconfirmed transaction may be removed while wallet is shutdown an therefore never getting the notification.\n\nThe shutdown thing seems like a good thing to document, but this doesn't seem like a great place to document it. This commen",https://github.com/bitcoin/bitcoin/pull/18982#discussion_r428360339,428360339,src/wallet/wallet.cpp
ryanofsky,2020-05-21 04:28:41,"re: https://github.com/bitcoin/bitcoin/pull/18982#discussion_r427799161\n\n> Can you explain which one are going to updated with CONFLICTED status and which not, i.e transactions not directly connected to a previous wallet transaction ?\n\nSure, added more details",https://github.com/bitcoin/bitcoin/pull/18982#discussion_r428438413,428438413,src/wallet/wallet.cpp
jonatack,2020-05-22 14:54:23,"nit: remove EOL comma, otherwise some people following the link may end up here :)\n\n![Screenshot from 2020-05-22 16-50-24](https://user-images.githubusercontent.com/2415484/82680590-05f2f200-9c3c-11ea-81f8-fd2438d3a832.jpg)\n",https://github.com/bitcoin/bitcoin/pull/18982#discussion_r429295636,429295636,src/wallet/wallet.cpp
jonatack,2020-05-22 15:19:57,"nit: is `ptx` a pointer?\n```diff\n-const CTransactionRef &ptx\n+const CTransactionRef& tx\n```\n",https://github.com/bitcoin/bitcoin/pull/18982#discussion_r429309505,429309505,src/validationinterface.cpp
jonatack,2020-05-22 15:36:07,"nit: suggested nicety while touching this code, at lines 1106 and 1178:\n```diff\n- CWalletTx::Confirmation confirm(CWalletTx::Status::UNCONFIRMED, /* block_height */ 0, {}, /* nIndex */ 0);\n+ CWalletTx::Confirmation confirm(CWalletTx::Status::UNCONFIRMED, /* block_height */ 0, /* hashBlock= */ {}, /* nIndex */ 0);\n```\n",https://github.com/bitcoin/bitcoin/pull/18982#discussion_r429317905,429317905,src/wallet/wallet.cpp
ryanofsky,2020-05-22 19:53:52,"re: https://github.com/bitcoin/bitcoin/pull/18982#discussion_r429309505\n\n> nit: is `ptx` a pointer?\n> \n> ```diff\n> -const CTransactionRef &ptx\n> +const CTransactionRef& tx\n> ```\n\nThanks, changed. It is a pointer (shared_ptr), as well: https://github.com/bitcoin/bitcoin/blob/b5c423c48e094bd098e11c3d1f57acae7502a4da/src/primitives/transaction.h#L387",https://github.com/bitcoin/bitcoin/pull/18982#discussion_r429429300,429429300,src/validationinterface.cpp
ryanofsky,2020-05-22 19:54:00,"re: https://github.com/bitcoin/bitcoin/pull/18982#discussion_r429295636\n\n> nit: remove EOL comma, otherwise some people following the link may end up here :)\n\nThanks! Removed",https://github.com/bitcoin/bitcoin/pull/18982#discussion_r429429319,429429319,src/wallet/wallet.cpp
ryanofsky,2020-05-22 19:54:09,"re: https://github.com/bitcoin/bitcoin/pull/18982#discussion_r429317905\n\n> nit: suggested nicety while touching this code, at lines 1106 and 1178:\n> \n> ```diff\n> - CWalletTx::Confirmation confirm(CWalletTx::Status::UNCONFIRMED, /* block_height */ 0, {}, /* nIndex */ 0);\n> + CWalletTx::Confirmation confirm(CWalletTx::Status::UNCONFIRMED, /* block_height */ 0, /* hashBlock= */ {}, /* nIn",https://github.com/bitcoin/bitcoin/pull/18982#discussion_r429429367,429429367,src/wallet/wallet.cpp
