[
  {
    "sha": "dca799e1db6e319fdd47e0bfdb038eab0efabb85",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkY2E3OTllMWRiNmUzMTlmZGQ0N2UwYmZkYjAzOGVhYjBlZmFiYjg1",
    "commit": {
      "author": {
        "name": "Ivan Pustogarov",
        "email": "ivanpustogarov@users.noreply.github.com",
        "date": "2014-12-07T16:30:57Z"
      },
      "committer": {
        "name": "Ivan Pustogarov",
        "email": "ivanpustogarov@users.noreply.github.com",
        "date": "2015-02-06T21:03:42Z"
      },
      "message": "Ignore getaddr messages on Outbound connections.\n\nThe only time when a client sends a \"getaddr\" message is when he\nesatblishes an Outbound connection (see ProcessMessage() in\nsrc/main.cpp).  Another bitcoin client is expected to receive a\n\"getaddr\" message only on Inbound connection. Ignoring \"gettaddr\"\nrequests on Outbound connections can resolve potential privacy issues\n(and as was said such request normally do not happen anyway).",
      "tree": {
        "sha": "ced9b22d5688baf8ed31b37a59f34e4db2851673",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ced9b22d5688baf8ed31b37a59f34e4db2851673"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dca799e1db6e319fdd47e0bfdb038eab0efabb85",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dca799e1db6e319fdd47e0bfdb038eab0efabb85",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/dca799e1db6e319fdd47e0bfdb038eab0efabb85",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dca799e1db6e319fdd47e0bfdb038eab0efabb85/comments",
    "author": {
      "login": "ivanpustogarov",
      "id": 8126617,
      "node_id": "MDQ6VXNlcjgxMjY2MTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8126617?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ivanpustogarov",
      "html_url": "https://github.com/ivanpustogarov",
      "followers_url": "https://api.github.com/users/ivanpustogarov/followers",
      "following_url": "https://api.github.com/users/ivanpustogarov/following{/other_user}",
      "gists_url": "https://api.github.com/users/ivanpustogarov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ivanpustogarov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ivanpustogarov/subscriptions",
      "organizations_url": "https://api.github.com/users/ivanpustogarov/orgs",
      "repos_url": "https://api.github.com/users/ivanpustogarov/repos",
      "events_url": "https://api.github.com/users/ivanpustogarov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ivanpustogarov/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "ivanpustogarov",
      "id": 8126617,
      "node_id": "MDQ6VXNlcjgxMjY2MTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8126617?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ivanpustogarov",
      "html_url": "https://github.com/ivanpustogarov",
      "followers_url": "https://api.github.com/users/ivanpustogarov/followers",
      "following_url": "https://api.github.com/users/ivanpustogarov/following{/other_user}",
      "gists_url": "https://api.github.com/users/ivanpustogarov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ivanpustogarov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ivanpustogarov/subscriptions",
      "organizations_url": "https://api.github.com/users/ivanpustogarov/orgs",
      "repos_url": "https://api.github.com/users/ivanpustogarov/repos",
      "events_url": "https://api.github.com/users/ivanpustogarov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ivanpustogarov/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fb6140b54bad51e3b063dfb005bfde13aca64eb4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fb6140b54bad51e3b063dfb005bfde13aca64eb4",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fb6140b54bad51e3b063dfb005bfde13aca64eb4"
      }
    ],
    "stats": {
      "total": 7,
      "additions": 6,
      "deletions": 1
    },
    "files": [
      {
        "sha": "a30084a75bd5dc7e3057edd3168fb8e90b27cb5d",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 1,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/dca799e1db6e319fdd47e0bfdb038eab0efabb85/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/dca799e1db6e319fdd47e0bfdb038eab0efabb85/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=dca799e1db6e319fdd47e0bfdb038eab0efabb85",
        "patch": "@@ -4008,7 +4008,12 @@ bool static ProcessMessage(CNode* pfrom, string strCommand, CDataStream& vRecv,\n     }\n \n \n-    else if (strCommand == \"getaddr\")\n+    // This asymmetric behavior for inbound and outbound connections was introduced\n+    // to prevent a fingerprinting attack: an attacker can send specific fake addresses\n+    // to users' AddrMan and later request them by sending getaddr messages. \n+    // Making users (which are behind NAT and can only make outgoing connections) ignore \n+    // getaddr message mitigates the attack.\n+    else if ((strCommand == \"getaddr\") && (pfrom->fInbound))\n     {\n         pfrom->vAddrToSend.clear();\n         vector<CAddress> vAddr = addrman.GetAddr();"
      }
    ]
  }
]