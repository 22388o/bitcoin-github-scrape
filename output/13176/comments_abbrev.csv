laanwj,2018-05-07T12:02:59Z,"Changed the tag: as the result of `FastMod` is not the same as `%` this is not only a refactor.\n\nIt looks like a feasible alternative in this case (*h* should be evenly distributed 0..2^32-1 by MurmurHash), and ~25% speed-up is nice. `CRollingBloomFilter` is used in the net processing code to keep track of recent rejects. This is a fast path (reject-quickly), so I think this matters.\n\nutAC",https://github.com/bitcoin/bitcoin/pull/13176#issuecomment-387043511,387043511,
jimpo,2018-05-08T07:01:15Z,utACK 9aac9f9,https://github.com/bitcoin/bitcoin/pull/13176#issuecomment-387304926,387304926,
gmaxwell,2018-05-15T00:18:33Z,Perhaps share code and or description with cuckoocache.h compute_hashes?,https://github.com/bitcoin/bitcoin/pull/13176#issuecomment-389002748,389002748,
martinus,2018-05-15T06:18:53Z,"@gmaxwell oh right, compute_hashes does the same. What would the preferred way to remove this duplication, refactor cuckoocache.h and to use a static method fast_mod, include & use that in bloom.cpp? ",https://github.com/bitcoin/bitcoin/pull/13176#issuecomment-389055340,389055340,
laanwj,2018-05-18T16:36:33Z,"Normally sharing common code is a good thing but I'm not sure that is worth it here, this is only a few lines, and would involve sharing code between otherwise unrelated units. Would be different if e.g. `bloom.cpp` already included `cuckoocache.h` but now the way to now handle this would be to create a new header...",https://github.com/bitcoin/bitcoin/pull/13176#issuecomment-390263321,390263321,
Empact,2018-05-07T17:18:07Z,nit: Could replace `inline` with `constexpr`,https://github.com/bitcoin/bitcoin/pull/13176#discussion_r186487599,186487599,src/bloom.cpp
laanwj,2018-05-10T20:58:44Z,Would that make a difference in the generated code?,https://github.com/bitcoin/bitcoin/pull/13176#discussion_r187458483,187458483,src/bloom.cpp
sipa,2018-05-11T18:06:29Z,"That's very unlikely - the sort of optimizations that apply to constexpr things also apply to things which the compiler can infer being constant expressions (which is obvious here).\n\nThe advantage to using `constexpr` is making sure those optimizations aren't made impossible for some reason.",https://github.com/bitcoin/bitcoin/pull/13176#discussion_r187690731,187690731,src/bloom.cpp
Empact,2018-05-13T00:04:30Z,"Agreed it's unlikely. My inclination is to minimize surface area and maximally restrain the code to reduce the space of errors that might occur. It's not always meaningful, but it can be a helpful precaution and can pay incidental dividends, e.g. by surfacing changes to the use of variables over time that were not intended. But yeah, it's a nit rather than an objection.",https://github.com/bitcoin/bitcoin/pull/13176#discussion_r187785861,187785861,src/bloom.cpp
