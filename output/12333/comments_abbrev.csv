promag,2018-02-02T11:46:20Z,"Note to reviewers, 2nd commit is just indentation, see 1st commit. I'll squash before merge.",https://github.com/bitcoin/bitcoin/pull/12333#issuecomment-362565336,362565336,
MarcoFalke,2018-02-02T16:19:03Z,Just noting that you can fixup right now. It is possible to ignore-all-space in git diff,https://github.com/bitcoin/bitcoin/pull/12333#issuecomment-362631647,362631647,
promag,2018-02-02T18:30:51Z,"I know but IIRC it's not possible to add comments with that option, so I've decided to split for now.",https://github.com/bitcoin/bitcoin/pull/12333#issuecomment-362666666,362666666,
devrandom,2018-02-03T17:09:37Z,ACK https://github.com/bitcoin/bitcoin/pull/12333/commits/834529f3c097386b82feb01bd2cc3e0f90418813,https://github.com/bitcoin/bitcoin/pull/12333#issuecomment-362835185,362835185,
sipa,2018-02-05T21:08:16Z,utACK 834529f3c097386b82feb01bd2cc3e0f90418813 (very easy to review with `-w` / `?w=1`).,https://github.com/bitcoin/bitcoin/pull/12333#issuecomment-363221763,363221763,
promag,2018-02-05T21:50:40Z,"Followed @ryanofsky suggestion, [1st commit](https://github.com/bitcoin/bitcoin/pull/12333/commits/dc0f32252334b7c305e33c1e1151b0f445ce0ce3) and [2nd commit](https://github.com/bitcoin/bitcoin/pull/12333/commits/4848f093c4755794ca57c6514cb1e3c484cf3867?w=1).",https://github.com/bitcoin/bitcoin/pull/12333#issuecomment-363233317,363233317,
ryanofsky,2018-02-05T22:23:08Z,"utACK 4848f093c4755794ca57c6514cb1e3c484cf3867, only change since last review is commit description",https://github.com/bitcoin/bitcoin/pull/12333#issuecomment-363241715,363241715,
promag,2018-02-06T00:35:22Z,Conflicts with #10605.,https://github.com/bitcoin/bitcoin/pull/12333#issuecomment-363269470,363269470,
jamesob,2018-02-02T19:32:07Z,"Both are recursive locks, so any reason we can't just use `LOCK2` here?",https://github.com/bitcoin/bitcoin/pull/12333#discussion_r165738263,165738263,src/wallet/wallet.cpp
promag,2018-02-02T19:36:51Z,Long term plan is to remove recursive locks. Correct me if I'm wrong @TheBlueMatt.,https://github.com/bitcoin/bitcoin/pull/12333#discussion_r165739359,165739359,src/wallet/wallet.cpp
ryanofsky,2018-02-02T19:40:10Z,"I think in general we want to move away from recursive locking: https://github.com/bitcoin/bitcoin/blob/85123be78df5a4e9447e70f9ee727416d45843d7/src/sync.h#L92\n\nhttp://www.zaval.org/resources/library/butenhof1.html has some interesting rationale and history",https://github.com/bitcoin/bitcoin/pull/12333#discussion_r165740121,165740121,src/wallet/wallet.cpp
promag,2018-02-02T19:42:47Z,Thanks @ryanofsky for the reference.,https://github.com/bitcoin/bitcoin/pull/12333#discussion_r165740738,165740738,src/wallet/wallet.cpp
jamesob,2018-02-02T20:37:11Z,"Ah, thanks for the clarification.",https://github.com/bitcoin/bitcoin/pull/12333#discussion_r165753492,165753492,src/wallet/wallet.cpp
laanwj,2018-02-08T10:31:33Z,"This locks the cs_main and cs_wallet for the entire rest of this test, which is somewhat awkward scoping-wise, is that intentional?",https://github.com/bitcoin/bitcoin/pull/12333#discussion_r166890531,166890531,src/wallet/test/wallet_tests.cpp
laanwj,2018-02-08T10:33:02Z,"Yes, recursive locking is one of the codebase's sins that we inherited and should be corrected in the long run.",https://github.com/bitcoin/bitcoin/pull/12333#discussion_r166891317,166891317,src/wallet/wallet.cpp
promag,2018-02-08T10:49:47Z,Nothing else happens and below the lock is again required so I've decided for the minimal diff. I can lock only until `ListCoins` below if you prefer.,https://github.com/bitcoin/bitcoin/pull/12333#discussion_r166897045,166897045,src/wallet/test/wallet_tests.cpp
ryanofsky,2018-02-08T12:54:19Z,"> Yes, recursive locking is one of the codebase's sins that we inherited and should be corrected in the long run.\n\nIf anyone is interested in this, #11640 followed by #11599 are steps towards removing recursive locking. #11640 has one ack and needs more review.\n",https://github.com/bitcoin/bitcoin/pull/12333#discussion_r166924178,166924178,src/wallet/wallet.cpp
laanwj,2018-02-08T18:06:35Z,"Yes please, For readability I prefer locks to be taken at the beginning of a block.",https://github.com/bitcoin/bitcoin/pull/12333#discussion_r167020014,167020014,src/wallet/test/wallet_tests.cpp
promag,2018-02-08T18:19:54Z,"Done, 2 blocks instead of one.",https://github.com/bitcoin/bitcoin/pull/12333#discussion_r167023485,167023485,src/wallet/test/wallet_tests.cpp
