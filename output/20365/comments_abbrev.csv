DrahtBot,2020-11-11 12:34:58,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19137 (wallettool: Add dump and createfromdump commands by achow101)\n* #19078 (test: Add salvage test for wallet tool by",https://github.com/bitcoin/bitcoin/pull/20365#issuecomment-725398667,725398667,
Sjors,2020-11-12 12:51:39,Concept ACK. cc @achow101 ,https://github.com/bitcoin/bitcoin/pull/20365#issuecomment-726058845,726058845,
achow101,2020-11-12 17:02:24,"Concept ACK, could use some tests.",https://github.com/bitcoin/bitcoin/pull/20365#issuecomment-726207650,726207650,
achow101,2020-12-02 22:55:25,ACK 173cc9b7be335b5dd2cc1bb112dfa6ec5c13ec12,https://github.com/bitcoin/bitcoin/pull/20365#issuecomment-737545508,737545508,
ryanofsky,2020-12-11 15:15:21,Seems like this might be ready for merge. This is a straightforward change just adding a wallet tool create option. Does it need more review than it's had?,https://github.com/bitcoin/bitcoin/pull/20365#issuecomment-743251629,743251629,
achow101,2020-11-12 17:01:32,"For a followup, we should de-duplicate this logic with the setup in `CWallet::Create`.",https://github.com/bitcoin/bitcoin/pull/20365#discussion_r522265003,522265003,src/wallet/wallettool.cpp
S3RK,2020-11-13 08:10:18,"That is what I was thinking too. The main challenge is that `CWallet::Create` requires a `chain` object which is used in quite a few places. Other than that it does what we need. I have a few ideas how to deal with it:\n\na) create dummy chain object that would return only zero/null values\nb) make `chain` argument optional and check every time before using it\nc) chip away a piece of `CWallet",https://github.com/bitcoin/bitcoin/pull/20365#discussion_r522771512,522771512,src/wallet/wallettool.cpp
ryanofsky,2020-11-16 18:55:08,"re: https://github.com/bitcoin/bitcoin/pull/20365#discussion_r522771512\n\nOffhand (c) sounds great, (b) would be also be good, and it would be nice to avoid (a). The CWallet class is huge and to the extent you can pull out more functionality into standalone functions that's a good thing. Especially any functionality that does not require access to a chain state and a running node is a good cand",https://github.com/bitcoin/bitcoin/pull/20365#discussion_r524499630,524499630,src/wallet/wallettool.cpp
achow101,2020-11-16 19:02:01,Agree with @ryanofsky. The best option I think is to break apart `CWallet::Create` and refactor pieces of it into standalone functions.,https://github.com/bitcoin/bitcoin/pull/20365#discussion_r524503841,524503841,src/wallet/wallettool.cpp
S3RK,2020-11-17 03:07:28,"@ryanofsky @achow101 thanks for the advice and the reference. I'll start working on the refactoring in separate PR as I think it's better not to mix things up.\n\nI've extended functional tests to cover for the new parameter. Any comments on this PR?",https://github.com/bitcoin/bitcoin/pull/20365#discussion_r524855811,524855811,src/wallet/wallettool.cpp
ryanofsky,2020-12-02 18:37:54,"In commit ""wallettool: add param to create descriptors wallet"" (345e88eecf1b28607d5da3af38e19794a8a115ce)\n\nIt would be good to have enforcement in ExecuteWalletToolFunc that option is only allowed for create command so existing ""info"" and ""salvage"" commands don't start accepting but ignoring this option now, and so future commands like ""createfromdump"" don't start accepting it in the future. S",https://github.com/bitcoin/bitcoin/pull/20365#discussion_r534395176,534395176,src/bitcoin-wallet.cpp
ryanofsky,2020-12-02 18:38:17,"re: https://github.com/bitcoin/bitcoin/pull/20365#discussion_r524855811\n\n> @ryanofsky @achow101 thanks for the advice and the reference. I'll start working on the refactoring in separate PR as I think it's better not to mix things up.\n> \n> I've extended functional tests to cover for the new parameter. Any comments on this PR?\n\nLooks good!",https://github.com/bitcoin/bitcoin/pull/20365#discussion_r534395401,534395401,src/wallet/wallettool.cpp
