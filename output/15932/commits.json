[
  {
    "sha": "fa1c3591add184ecb43eb3b149f4833f241e3858",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYTFjMzU5MWFkZDE4NGVjYjQzZWIzYjE0OWY0ODMzZjI0MWUzODU4",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2019-05-01T15:21:30Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2019-05-01T15:16:21Z"
      },
      "message": "rpc: Use IsValidNumArgs in getblock",
      "tree": {
        "sha": "98cc6c73738365f6153bd073a29fad16cd106b1d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/98cc6c73738365f6153bd073a29fad16cd106b1d"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa1c3591add184ecb43eb3b149f4833f241e3858",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUjXUAv9FmvPnX64NZeHcFp9rI7lWX1nmI41KRcy3AH2502ZsN/LS0d50szVRnqg\nVGL8VxfVROrKCMnIynrVDD/t7bbOYGXbMtRUoH9hEpL8vKyv1C1IU7gJF9BI7m2d\nUNHJadVRUTr8SkyxkNcoG9ZK1pkDQSh6lqhd+UFnM6pP7IuZHs3mp1DlysFCAI6J\nPJe1xcYCfwPZO003RY+jpJ8vENm7Ccz4JdLV/aqI/xCMRpUOHX6RQqw/cE0Xvpv1\njdnI7x/19XxKV9NtN3j65DlSmjA8iOlUHup5Jb2bcdPsiBN/F755W3Ig/29e+z/u\n5RKV3Sh3hMM0yQPzviBYnENkeJrDJjTdP/ob9gHJ5GM9Tl4iV2GbN0dCo2l46rp1\nZrqZyT2ZFhB6LFnvi3LGaKHxpy2y3qtQqAsCUJqrKTys9sJVGPxZJnquP3toqSrl\nkdtzEB0kEh3PBfogDKUHt2e1xraK3FhXkHZdqfFb0g6JMibXyC2YzFhjYsNauH5O\noKb1wbba\n=2jAj\n-----END PGP SIGNATURE-----",
        "payload": "tree 98cc6c73738365f6153bd073a29fad16cd106b1d\nparent 2eb8c5d7a28b4dcecd60484773eaacd1608f6291\nauthor MarcoFalke <falke.marco@gmail.com> 1556724090 -0400\ncommitter MarcoFalke <falke.marco@gmail.com> 1556723781 -0400\n\nrpc: Use IsValidNumArgs in getblock\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa1c3591add184ecb43eb3b149f4833f241e3858",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fa1c3591add184ecb43eb3b149f4833f241e3858",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa1c3591add184ecb43eb3b149f4833f241e3858/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "2eb8c5d7a28b4dcecd60484773eaacd1608f6291",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2eb8c5d7a28b4dcecd60484773eaacd1608f6291",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/2eb8c5d7a28b4dcecd60484773eaacd1608f6291"
      }
    ],
    "stats": {
      "total": 10,
      "additions": 6,
      "deletions": 4
    },
    "files": [
      {
        "sha": "cd56e48ab8a31de54a43617a6e938fc695af3b69",
        "filename": "src/rpc/blockchain.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 4,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa1c3591add184ecb43eb3b149f4833f241e3858/src/rpc/blockchain.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa1c3591add184ecb43eb3b149f4833f241e3858/src/rpc/blockchain.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/blockchain.cpp?ref=fa1c3591add184ecb43eb3b149f4833f241e3858",
        "patch": "@@ -824,9 +824,7 @@ static CBlock GetBlockChecked(const CBlockIndex* pblockindex)\n \n static UniValue getblock(const JSONRPCRequest& request)\n {\n-    if (request.fHelp || request.params.size() < 1 || request.params.size() > 2)\n-        throw std::runtime_error(\n-            RPCHelpMan{\"getblock\",\n+    const RPCHelpMan help{\"getblock\",\n                 \"\\nIf verbosity is 0, returns a string that is serialized, hex-encoded data for block 'hash'.\\n\"\n                 \"If verbosity is 1, returns an Object with information about block <hash>.\\n\"\n                 \"If verbosity is 2, returns an Object with information about block <hash> and information about each transaction. \\n\",\n@@ -878,7 +876,11 @@ static UniValue getblock(const JSONRPCRequest& request)\n                     HelpExampleCli(\"getblock\", \"\\\"00000000c937983704a73af28acdec37b049d214adbda81d7e2a3dd146f6ed09\\\"\")\n             + HelpExampleRpc(\"getblock\", \"\\\"00000000c937983704a73af28acdec37b049d214adbda81d7e2a3dd146f6ed09\\\"\")\n                 },\n-            }.ToString());\n+    };\n+\n+    if (request.fHelp || !help.IsValidNumArgs(request.params.size())) {\n+        throw std::runtime_error(help.ToString());\n+    }\n \n     LOCK(cs_main);\n "
      }
    ]
  },
  {
    "sha": "fab00a5cb90053e9671627af6a35e57610a44e89",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYWIwMGE1Y2I5MDA1M2U5NjcxNjI3YWY2YTM1ZTU3NjEwYTQ0ZTg5",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2019-05-01T16:24:55Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2019-05-01T16:32:11Z"
      },
      "message": "rpc: Serialize in getblock without cs_main",
      "tree": {
        "sha": "9a549153a12e1eb56fa61de80c90ec8ba268b879",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9a549153a12e1eb56fa61de80c90ec8ba268b879"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fab00a5cb90053e9671627af6a35e57610a44e89",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUjrcwv+OoGqsSUGrfBZS8CBsm16tGcMKh65eWJSBSruliVZreq+4B5wWwcz6wfg\n0N8v/ikn5TIxNXPH44hFWoXmYQDq/xgR1Y4EUgy9vnkG2Y7NR2Ll95C5QvZRKYFn\nCocwHHhHtZvjLF2rEfUh93J8IYiMzTrfysh8gw92lx2oLuTolmxyntSo+C8tn5aM\n1rA/9ZZ63WgjrexCAtYeQxVPO2FFoU+L7rc08SxJgRmTieHwkfo04mrxjmB/ZF5t\n581LnxJuQMLt+fouMldnNyb+6zn95law2Pg6hO9ICqdPJ2ELyJ+ZcBEbPOFcRMsc\nOXUvyhk3JIVf/E+pwO/vkPYiZrtG5xU5rSZGiA8ZDgPQ87c6LBqeD1EFxtVlKklw\n8e6AOFFX9OOKZEIsie7hBGvytTgbPDVQYmKahN7Gb7E0ilpaXJxzKF+MliBW6UDv\nYJ8tmYM87SVMErWhw0LbfhGJIqhKVrXUBlKQGX2wdGNRU/aCAjvorAvMBbeSTiPW\n+SIW4c2Z\n=Vn3H\n-----END PGP SIGNATURE-----",
        "payload": "tree 9a549153a12e1eb56fa61de80c90ec8ba268b879\nparent fa1c3591add184ecb43eb3b149f4833f241e3858\nauthor MarcoFalke <falke.marco@gmail.com> 1556727895 -0400\ncommitter MarcoFalke <falke.marco@gmail.com> 1556728331 -0400\n\nrpc: Serialize in getblock without cs_main\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fab00a5cb90053e9671627af6a35e57610a44e89",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fab00a5cb90053e9671627af6a35e57610a44e89",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fab00a5cb90053e9671627af6a35e57610a44e89/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fa1c3591add184ecb43eb3b149f4833f241e3858",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa1c3591add184ecb43eb3b149f4833f241e3858",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fa1c3591add184ecb43eb3b149f4833f241e3858"
      }
    ],
    "stats": {
      "total": 24,
      "additions": 16,
      "deletions": 8
    },
    "files": [
      {
        "sha": "cd636a7127907d950391c909221e8c87b69cde46",
        "filename": "src/rpc/blockchain.cpp",
        "status": "modified",
        "additions": 16,
        "deletions": 8,
        "changes": 24,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fab00a5cb90053e9671627af6a35e57610a44e89/src/rpc/blockchain.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fab00a5cb90053e9671627af6a35e57610a44e89/src/rpc/blockchain.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/blockchain.cpp?ref=fab00a5cb90053e9671627af6a35e57610a44e89",
        "patch": "@@ -93,6 +93,7 @@ static int ComputeNextBlockAndDepth(const CBlockIndex* tip, const CBlockIndex* b\n \n UniValue blockheaderToJSON(const CBlockIndex* tip, const CBlockIndex* blockindex)\n {\n+    // Serialize passed information without accessing chain state of the active chain!\n     UniValue result(UniValue::VOBJ);\n     result.pushKV(\"hash\", blockindex->GetBlockHash().GetHex());\n     const CBlockIndex* pnext;\n@@ -119,6 +120,7 @@ UniValue blockheaderToJSON(const CBlockIndex* tip, const CBlockIndex* blockindex\n \n UniValue blockToJSON(const CBlock& block, const CBlockIndex* tip, const CBlockIndex* blockindex, bool txDetails)\n {\n+    // Serialize passed information without accessing chain state of the active chain!\n     UniValue result(UniValue::VOBJ);\n     result.pushKV(\"hash\", blockindex->GetBlockHash().GetHex());\n     const CBlockIndex* pnext;\n@@ -882,8 +884,6 @@ static UniValue getblock(const JSONRPCRequest& request)\n         throw std::runtime_error(help.ToString());\n     }\n \n-    LOCK(cs_main);\n-\n     uint256 hash(ParseHashV(request.params[0], \"blockhash\"));\n \n     int verbosity = 1;\n@@ -894,12 +894,20 @@ static UniValue getblock(const JSONRPCRequest& request)\n             verbosity = request.params[1].get_bool() ? 1 : 0;\n     }\n \n-    const CBlockIndex* pblockindex = LookupBlockIndex(hash);\n-    if (!pblockindex) {\n-        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Block not found\");\n-    }\n+    CBlock block;\n+    const CBlockIndex* pblockindex;\n+    const CBlockIndex* tip;\n+    {\n+        LOCK(cs_main);\n+        pblockindex = LookupBlockIndex(hash);\n+        tip = chainActive.Tip();\n+\n+        if (!pblockindex) {\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Block not found\");\n+        }\n \n-    const CBlock block = GetBlockChecked(pblockindex);\n+        block = GetBlockChecked(pblockindex);\n+    }\n \n     if (verbosity <= 0)\n     {\n@@ -909,7 +917,7 @@ static UniValue getblock(const JSONRPCRequest& request)\n         return strHex;\n     }\n \n-    return blockToJSON(block, chainActive.Tip(), pblockindex, verbosity >= 2);\n+    return blockToJSON(block, tip, pblockindex, verbosity >= 2);\n }\n \n struct CCoinsStats"
      }
    ]
  },
  {
    "sha": "faea56400d5578023133cf4d1c761cdeb0c3e3da",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYWVhNTY0MDBkNTU3ODAyMzEzM2NmNGQxYzc2MWNkZWIwYzNlM2Rh",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2019-05-02T18:34:09Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2019-05-02T18:33:26Z"
      },
      "message": "rpc: Add lock annotations to block{,header}ToJSON",
      "tree": {
        "sha": "84f66d66aacf11aacae1b2eff4ba39563a1b61b8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/84f66d66aacf11aacae1b2eff4ba39563a1b61b8"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/faea56400d5578023133cf4d1c761cdeb0c3e3da",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUhULQwAjWU9tslZJGxVitDo99OTr/OVqtgJ4PYUmsP6GmzD+DKlckou+uI0Y6Ib\n02WA/i5BXO/1j3gz1i6NiFqdFUZ0iyTeeCRTLA+v8ju7hAvdpLPFvCP1pu8TksX4\n5Qimm/h+OKXwM8zA48qlB+Uc0yPHUeU/XHybPDXv5MG9soioktVlS62nk67gQCfU\noPHypLISewX79AERrpP2KE/i3Hg0DpFAdq/FwQNB6GKUm1o0LjUnnYmN+jrUYmGC\nDQbKn5gelIOipCoqhkaee2+D+vXtr7yhreS5qFSPYlXr8hOTZKSYh7D6I0guB5nG\n7qGb71B9U8SnH39kyikMdZG7Fu1bd4s/u3UROgcUumun/usEZ4gpR4P0DbHVoI6U\n5B1IKTKjTv9J7oEImk9evsibcvWdHBq0RFy+7acMnVXsDg1rEzqAg8F7E7SEbwEE\nVlaYCeI4gQ4+6fTxg4CwSGqCNSz2L1IXq0GPyGvWuYThsWcVPG+bn+atVA7TN/ef\n8EmHC0fq\n=Vx7k\n-----END PGP SIGNATURE-----",
        "payload": "tree 84f66d66aacf11aacae1b2eff4ba39563a1b61b8\nparent fab00a5cb90053e9671627af6a35e57610a44e89\nauthor MarcoFalke <falke.marco@gmail.com> 1556822049 -0400\ncommitter MarcoFalke <falke.marco@gmail.com> 1556822006 -0400\n\nrpc: Add lock annotations to block{,header}ToJSON\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faea56400d5578023133cf4d1c761cdeb0c3e3da",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/faea56400d5578023133cf4d1c761cdeb0c3e3da",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faea56400d5578023133cf4d1c761cdeb0c3e3da/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fab00a5cb90053e9671627af6a35e57610a44e89",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fab00a5cb90053e9671627af6a35e57610a44e89",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fab00a5cb90053e9671627af6a35e57610a44e89"
      }
    ],
    "stats": {
      "total": 16,
      "additions": 12,
      "deletions": 4
    },
    "files": [
      {
        "sha": "9d7d213f6bd45b741cf42a0ae40e182ee1b8c748",
        "filename": "src/rpc/blockchain.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 0,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faea56400d5578023133cf4d1c761cdeb0c3e3da/src/rpc/blockchain.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faea56400d5578023133cf4d1c761cdeb0c3e3da/src/rpc/blockchain.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/blockchain.cpp?ref=faea56400d5578023133cf4d1c761cdeb0c3e3da",
        "patch": "@@ -94,6 +94,8 @@ static int ComputeNextBlockAndDepth(const CBlockIndex* tip, const CBlockIndex* b\n UniValue blockheaderToJSON(const CBlockIndex* tip, const CBlockIndex* blockindex)\n {\n     // Serialize passed information without accessing chain state of the active chain!\n+    AssertLockNotHeld(cs_main); // For performance reasons\n+\n     UniValue result(UniValue::VOBJ);\n     result.pushKV(\"hash\", blockindex->GetBlockHash().GetHex());\n     const CBlockIndex* pnext;\n@@ -121,6 +123,8 @@ UniValue blockheaderToJSON(const CBlockIndex* tip, const CBlockIndex* blockindex\n UniValue blockToJSON(const CBlock& block, const CBlockIndex* tip, const CBlockIndex* blockindex, bool txDetails)\n {\n     // Serialize passed information without accessing chain state of the active chain!\n+    AssertLockNotHeld(cs_main); // For performance reasons\n+\n     UniValue result(UniValue::VOBJ);\n     result.pushKV(\"hash\", blockindex->GetBlockHash().GetHex());\n     const CBlockIndex* pnext;"
      },
      {
        "sha": "ff461fbcbcfdcb2a81a84d7b0ac37c7cddc19b03",
        "filename": "src/rpc/blockchain.h",
        "status": "modified",
        "additions": 8,
        "deletions": 4,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faea56400d5578023133cf4d1c761cdeb0c3e3da/src/rpc/blockchain.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faea56400d5578023133cf4d1c761cdeb0c3e3da/src/rpc/blockchain.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/blockchain.h?ref=faea56400d5578023133cf4d1c761cdeb0c3e3da",
        "patch": "@@ -5,9 +5,13 @@\n #ifndef BITCOIN_RPC_BLOCKCHAIN_H\n #define BITCOIN_RPC_BLOCKCHAIN_H\n \n-#include <vector>\n-#include <stdint.h>\n #include <amount.h>\n+#include <sync.h>\n+\n+#include <stdint.h>\n+#include <vector>\n+\n+extern RecursiveMutex cs_main;\n \n class CBlock;\n class CBlockIndex;\n@@ -28,7 +32,7 @@ double GetDifficulty(const CBlockIndex* blockindex);\n void RPCNotifyBlockChange(bool ibd, const CBlockIndex *);\n \n /** Block description to JSON */\n-UniValue blockToJSON(const CBlock& block, const CBlockIndex* tip, const CBlockIndex* blockindex, bool txDetails = false);\n+UniValue blockToJSON(const CBlock& block, const CBlockIndex* tip, const CBlockIndex* blockindex, bool txDetails = false) LOCKS_EXCLUDED(cs_main);\n \n /** Mempool information to JSON */\n UniValue MempoolInfoToJSON(const CTxMemPool& pool);\n@@ -37,7 +41,7 @@ UniValue MempoolInfoToJSON(const CTxMemPool& pool);\n UniValue MempoolToJSON(const CTxMemPool& pool, bool verbose = false);\n \n /** Block header to JSON */\n-UniValue blockheaderToJSON(const CBlockIndex* tip, const CBlockIndex* blockindex);\n+UniValue blockheaderToJSON(const CBlockIndex* tip, const CBlockIndex* blockindex) LOCKS_EXCLUDED(cs_main);\n \n /** Used by getblockstats to get feerates at different percentiles by weight  */\n void CalculatePercentilesByWeight(CAmount result[NUM_GETBLOCKSTATS_PERCENTILES], std::vector<std::pair<CAmount, int64_t>>& scores, int64_t total_weight);"
      }
    ]
  }
]