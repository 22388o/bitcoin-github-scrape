[
  {
    "sha": "63067bb8c51f3bf2bf3c278d2394537039b09b6e",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2MzA2N2JiOGM1MWYzYmYyYmYzYzI3OGQyMzk0NTM3MDM5YjA5YjZl",
    "commit": {
      "author": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2011-10-03T21:39:24Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2012-02-01T02:59:50Z"
      },
      "message": "JSON-RPC method: accepttxn <txid> -- accepts transaction without a fee",
      "tree": {
        "sha": "c5c6b85c1e002926f26955dbe86368e8e7864486",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c5c6b85c1e002926f26955dbe86368e8e7864486"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/63067bb8c51f3bf2bf3c278d2394537039b09b6e",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/63067bb8c51f3bf2bf3c278d2394537039b09b6e",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/63067bb8c51f3bf2bf3c278d2394537039b09b6e",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/63067bb8c51f3bf2bf3c278d2394537039b09b6e/comments",
    "author": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "c52296a73e5222628bf6a03eaf727622594bf464",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c52296a73e5222628bf6a03eaf727622594bf464",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/c52296a73e5222628bf6a03eaf727622594bf464"
      }
    ],
    "stats": {
      "total": 57,
      "additions": 57,
      "deletions": 0
    },
    "files": [
      {
        "sha": "bcb73d983056fc49f2c376ef1e09b1d62801e5b9",
        "filename": "src/bitcoinrpc.cpp",
        "status": "modified",
        "additions": 14,
        "deletions": 0,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/63067bb8c51f3bf2bf3c278d2394537039b09b6e/src/bitcoinrpc.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/63067bb8c51f3bf2bf3c278d2394537039b09b6e/src/bitcoinrpc.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoinrpc.cpp?ref=63067bb8c51f3bf2bf3c278d2394537039b09b6e",
        "patch": "@@ -1757,6 +1757,18 @@ Value validateaddress(const Array& params, bool fHelp)\n     return ret;\n }\n \n+\n+Value accepttxn(const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size() != 1)\n+        throw runtime_error(\n+            \"accepttxn <txid>\\n\"\n+            \"Accepts the transaction into mined blocks without a fee\");\n+\n+    return AcceptTransaction(params[0].get_str());\n+}\n+\n+\n Value getwork(const Array& params, bool fHelp)\n {\n     if (fHelp || params.size() > 1)\n@@ -2047,6 +2059,7 @@ pair<string, rpcfn_type> pCallTable[] =\n     make_pair(\"listtransactions\",       &listtransactions),\n     make_pair(\"signmessage\",            &signmessage),\n     make_pair(\"verifymessage\",          &verifymessage),\n+    make_pair(\"accepttxn\",              &accepttxn),\n     make_pair(\"getwork\",                &getwork),\n     make_pair(\"listaccounts\",           &listaccounts),\n     make_pair(\"settxfee\",               &settxfee),\n@@ -2079,6 +2092,7 @@ string pAllowInSafeMode[] =\n     \"walletpassphrase\",\n     \"walletlock\",\n     \"validateaddress\",\n+    \"accepttxn\",\n     \"getwork\",\n     \"getmemorypool\",\n };"
      },
      {
        "sha": "d2b4bc9bad0c806e7d616a4c4a67488a50456351",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 33,
        "deletions": 0,
        "changes": 33,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/63067bb8c51f3bf2bf3c278d2394537039b09b6e/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/63067bb8c51f3bf2bf3c278d2394537039b09b6e/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=63067bb8c51f3bf2bf3c278d2394537039b09b6e",
        "patch": "@@ -2977,6 +2977,39 @@ class COrphan\n };\n \n \n+bool AcceptTransaction(const uint256 hash, const string strHash)\n+{\n+    if (!mapTransactions.count(hash))\n+    {\n+        printf(\"AcceptTransaction: cannot find %s\\n\", strHash.c_str());\n+        return false;\n+    }\n+\n+    CTransaction &txn = mapTransactions[hash];\n+    if (txn.fNoFee)\n+        printf(\"AcceptTransaction: %s already accepted!\\n\", strHash.c_str());\n+    else\n+    {\n+        printf(\"AcceptTransaction: will accept %s\\n\", strHash.c_str());\n+        txn.fNoFee = true;\n+    }\n+\n+    return true;\n+}\n+\n+bool AcceptTransaction(const uint256 hash)\n+{\n+    return AcceptTransaction(hash, hash.GetHex());\n+}\n+\n+bool AcceptTransaction(const string strHash)\n+{\n+    uint256 hash;\n+    hash.SetHex(strHash);\n+    return AcceptTransaction(hash, strHash);\n+}\n+\n+\n uint64 nLastBlockTx = 0;\n uint64 nLastBlockSize = 0;\n "
      },
      {
        "sha": "17b2d269fe5dd940926ab1e6efa34be6888c66d9",
        "filename": "src/main.h",
        "status": "modified",
        "additions": 10,
        "deletions": 0,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/63067bb8c51f3bf2bf3c278d2394537039b09b6e/src/main.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/63067bb8c51f3bf2bf3c278d2394537039b09b6e/src/main.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.h?ref=63067bb8c51f3bf2bf3c278d2394537039b09b6e",
        "patch": "@@ -107,6 +107,9 @@ void PrintBlockTree();\n bool ProcessMessages(CNode* pfrom);\n bool SendMessages(CNode* pto, bool fSendTrickle);\n void GenerateBitcoins(bool fGenerate, CWallet* pwallet);\n+bool AcceptTransaction(const uint256 hash, const std::string strHash);\n+bool AcceptTransaction(const uint256 hash);\n+bool AcceptTransaction(const std::string strHash);\n CBlock* CreateNewBlock(CReserveKey& reservekey);\n void IncrementExtraNonce(CBlock* pblock, CBlockIndex* pindexPrev, unsigned int& nExtraNonce);\n void FormatHashBuffers(CBlock* pblock, char* pmidstate, char* pdata, char* phash1);\n@@ -427,8 +430,12 @@ class CTransaction\n     mutable int nDoS;\n     bool DoS(int nDoSIn, bool fIn) const { nDoS += nDoSIn; return fIn; }\n \n+    bool fNoFee;\n+\n+\n     CTransaction()\n     {\n+        fNoFee = false;\n         SetNull();\n     }\n \n@@ -571,6 +578,9 @@ class CTransaction\n \n     int64 GetMinFee(unsigned int nBlockSize=1, bool fAllowFree=true, enum GetMinFee_mode mode=GMF_BLOCK) const\n     {\n+        if (fNoFee)\n+            return 0;\n+\n         // Base fee is either MIN_TX_FEE or MIN_RELAY_TX_FEE\n         int64 nBaseFee = (mode == GMF_RELAY) ? MIN_RELAY_TX_FEE : MIN_TX_FEE;\n "
      }
    ]
  },
  {
    "sha": "84cf5257c71556df242fccfdbab83e72554ff9e3",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4NGNmNTI1N2M3MTU1NmRmMjQyZmNjZmRiYWI4M2U3MjU1NGZmOWUz",
    "commit": {
      "author": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2011-10-03T21:56:34Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2012-02-01T02:59:55Z"
      },
      "message": "Support piggy-backing an accepttxn onto a getwork",
      "tree": {
        "sha": "db66315597721b7bc0fa09e8af23410737c337d2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/db66315597721b7bc0fa09e8af23410737c337d2"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/84cf5257c71556df242fccfdbab83e72554ff9e3",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/84cf5257c71556df242fccfdbab83e72554ff9e3",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/84cf5257c71556df242fccfdbab83e72554ff9e3",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/84cf5257c71556df242fccfdbab83e72554ff9e3/comments",
    "author": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "63067bb8c51f3bf2bf3c278d2394537039b09b6e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/63067bb8c51f3bf2bf3c278d2394537039b09b6e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/63067bb8c51f3bf2bf3c278d2394537039b09b6e"
      }
    ],
    "stats": {
      "total": 10,
      "additions": 7,
      "deletions": 3
    },
    "files": [
      {
        "sha": "04e4d27be80ce48a0a40712885e39c0ffce8a595",
        "filename": "src/bitcoinrpc.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 3,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/84cf5257c71556df242fccfdbab83e72554ff9e3/src/bitcoinrpc.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/84cf5257c71556df242fccfdbab83e72554ff9e3/src/bitcoinrpc.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoinrpc.cpp?ref=84cf5257c71556df242fccfdbab83e72554ff9e3",
        "patch": "@@ -1771,15 +1771,16 @@ Value accepttxn(const Array& params, bool fHelp)\n \n Value getwork(const Array& params, bool fHelp)\n {\n-    if (fHelp || params.size() > 1)\n+    if (fHelp || params.size() > 2)\n         throw runtime_error(\n-            \"getwork [data]\\n\"\n+            \"getwork [data] [txid]\\n\"\n             \"If [data] is not specified, returns formatted hash data to work on:\\n\"\n             \"  \\\"midstate\\\" : precomputed hash state after hashing the first half of the data (DEPRECATED)\\n\" // deprecated\n             \"  \\\"data\\\" : block data\\n\"\n             \"  \\\"hash1\\\" : formatted hash buffer for second hash (DEPRECATED)\\n\" // deprecated\n             \"  \\\"target\\\" : little endian hash target\\n\"\n-            \"If [data] is specified, tries to solve the block and returns true if it was successful.\");\n+            \"If [data] is specified, tries to solve the block and returns true if it was successful.\\n\"\n+            \"If [txid] is specified, silently tries to accept the transaction without a fee.\");\n \n     if (vNodes.empty())\n         throw JSONRPCError(-9, \"Bitcoin is not connected!\");\n@@ -1792,6 +1793,9 @@ Value getwork(const Array& params, bool fHelp)\n     static vector<CBlock*> vNewBlock;\n     static CReserveKey reservekey(pwalletMain);\n \n+    if (params.size() > 1)\n+        AcceptTransaction(params[1].get_str());\n+\n     if (params.size() == 0)\n     {\n         // Update block"
      }
    ]
  }
]