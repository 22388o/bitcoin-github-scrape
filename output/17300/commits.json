[
  {
    "sha": "52cf68f7ffa1dd3a6850606a75c32b77b1308c4b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo1MmNmNjhmN2ZmYTFkZDNhNjg1MDYwNmE3NWMzMmI3N2IxMzA4YzRi",
    "commit": {
      "author": {
        "name": "Russell Yanofsky",
        "email": "russ@yanofsky.org",
        "date": "2019-10-29T16:20:19Z"
      },
      "committer": {
        "name": "Russell Yanofsky",
        "email": "russ@yanofsky.org",
        "date": "2019-10-29T16:20:19Z"
      },
      "message": "Refactor: Add GetLegacyScriptPubKeyMan helper\n\nSuggested by Jo\u00e3o Barbosa <joao.paulo.barbosa@gmail.com>\nhttps://github.com/bitcoin/bitcoin/pull/17260#discussion_r339505236",
      "tree": {
        "sha": "c814fdfbff7abf57c80c02d734dd88a7d2107a28",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c814fdfbff7abf57c80c02d734dd88a7d2107a28"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/52cf68f7ffa1dd3a6850606a75c32b77b1308c4b",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/52cf68f7ffa1dd3a6850606a75c32b77b1308c4b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/52cf68f7ffa1dd3a6850606a75c32b77b1308c4b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/52cf68f7ffa1dd3a6850606a75c32b77b1308c4b/comments",
    "author": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "6a97e8a060f7632bbaee27d3de8035dc6ebe3895",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6a97e8a060f7632bbaee27d3de8035dc6ebe3895",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/6a97e8a060f7632bbaee27d3de8035dc6ebe3895"
      }
    ],
    "stats": {
      "total": 72,
      "additions": 30,
      "deletions": 42
    },
    "files": [
      {
        "sha": "f7353ebbbb083159bf725a5412e3eb4a3abad7ff",
        "filename": "src/wallet/rpcdump.cpp",
        "status": "modified",
        "additions": 30,
        "deletions": 42,
        "changes": 72,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/52cf68f7ffa1dd3a6850606a75c32b77b1308c4b/src/wallet/rpcdump.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/52cf68f7ffa1dd3a6850606a75c32b77b1308c4b/src/wallet/rpcdump.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/rpcdump.cpp?ref=52cf68f7ffa1dd3a6850606a75c32b77b1308c4b",
        "patch": "@@ -87,6 +87,15 @@ static void RescanWallet(CWallet& wallet, const WalletRescanReserver& reserver,\n     }\n }\n \n+static LegacyScriptPubKeyMan& GetLegacyScriptPubKeyMan(CWallet& wallet)\n+{\n+    LegacyScriptPubKeyMan* spk_man = wallet.GetLegacyScriptPubKeyMan();\n+    if (!spk_man) {\n+        throw JSONRPCError(RPC_WALLET_ERROR, \"This type of wallet does not support this command\");\n+    }\n+    return *spk_man;\n+}\n+\n UniValue importprivkey(const JSONRPCRequest& request)\n {\n     std::shared_ptr<CWallet> const wallet = GetWalletForJSONRPCRequest(request);\n@@ -125,10 +134,7 @@ UniValue importprivkey(const JSONRPCRequest& request)\n         throw JSONRPCError(RPC_WALLET_ERROR, \"Cannot import private keys to a wallet with private keys disabled\");\n     }\n \n-    LegacyScriptPubKeyMan* spk_man = pwallet->GetLegacyScriptPubKeyMan();\n-    if (!spk_man) {\n-        throw JSONRPCError(RPC_WALLET_ERROR, \"This type of wallet does not support this command\");\n-    }\n+    LegacyScriptPubKeyMan& spk_man = GetLegacyScriptPubKeyMan(*wallet);\n \n     WalletRescanReserver reserver(pwallet);\n     bool fRescan = true;\n@@ -256,10 +262,7 @@ UniValue importaddress(const JSONRPCRequest& request)\n                 },\n             }.Check(request);\n \n-    LegacyScriptPubKeyMan* spk_man = pwallet->GetLegacyScriptPubKeyMan();\n-    if (!spk_man) {\n-        throw JSONRPCError(RPC_WALLET_ERROR, \"This type of wallet does not support this command\");\n-    }\n+    LegacyScriptPubKeyMan& spk_man = GetLegacyScriptPubKeyMan(*pwallet);\n \n     std::string strLabel;\n     if (!request.params[1].isNull())\n@@ -462,10 +465,7 @@ UniValue importpubkey(const JSONRPCRequest& request)\n                 },\n             }.Check(request);\n \n-    LegacyScriptPubKeyMan* spk_man = pwallet->GetLegacyScriptPubKeyMan();\n-    if (!spk_man) {\n-        throw JSONRPCError(RPC_WALLET_ERROR, \"This type of wallet does not support this command\");\n-    }\n+    LegacyScriptPubKeyMan& spk_man = GetLegacyScriptPubKeyMan(*wallet);\n \n     std::string strLabel;\n     if (!request.params[1].isNull())\n@@ -549,10 +549,7 @@ UniValue importwallet(const JSONRPCRequest& request)\n                 },\n             }.Check(request);\n \n-    LegacyScriptPubKeyMan* spk_man = pwallet->GetLegacyScriptPubKeyMan();\n-    if (!spk_man) {\n-        throw JSONRPCError(RPC_WALLET_ERROR, \"This type of wallet does not support this command\");\n-    }\n+    LegacyScriptPubKeyMan& spk_man = GetLegacyScriptPubKeyMan(*wallet);\n \n     if (pwallet->chain().havePruned()) {\n         // Exit early and print an error.\n@@ -711,10 +708,7 @@ UniValue dumpprivkey(const JSONRPCRequest& request)\n                 },\n             }.Check(request);\n \n-    LegacyScriptPubKeyMan* spk_man = pwallet->GetLegacyScriptPubKeyMan();\n-    if (!spk_man) {\n-        throw JSONRPCError(RPC_WALLET_ERROR, \"This type of wallet does not support this command\");\n-    }\n+    LegacyScriptPubKeyMan& spk_man = GetLegacyScriptPubKeyMan(*wallet);\n \n     auto locked_chain = pwallet->chain().lock();\n     LOCK(pwallet->cs_wallet);\n@@ -726,12 +720,12 @@ UniValue dumpprivkey(const JSONRPCRequest& request)\n     if (!IsValidDestination(dest)) {\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid Bitcoin address\");\n     }\n-    auto keyid = GetKeyForDestination(*spk_man, dest);\n+    auto keyid = GetKeyForDestination(spk_man, dest);\n     if (keyid.IsNull()) {\n         throw JSONRPCError(RPC_TYPE_ERROR, \"Address does not refer to a key\");\n     }\n     CKey vchSecret;\n-    if (!spk_man->GetKey(keyid, vchSecret)) {\n+    if (!spk_man.GetKey(keyid, vchSecret)) {\n         throw JSONRPCError(RPC_WALLET_ERROR, \"Private key for address \" + strAddress + \" is not known\");\n     }\n     return EncodeSecret(vchSecret);\n@@ -765,14 +759,11 @@ UniValue dumpwallet(const JSONRPCRequest& request)\n                 },\n             }.Check(request);\n \n-    LegacyScriptPubKeyMan* spk_man = pwallet->GetLegacyScriptPubKeyMan();\n-    if (!spk_man) {\n-        throw JSONRPCError(RPC_WALLET_ERROR, \"This type of wallet does not support this command\");\n-    }\n+    LegacyScriptPubKeyMan& spk_man = GetLegacyScriptPubKeyMan(*wallet);\n \n     auto locked_chain = pwallet->chain().lock();\n     LOCK(pwallet->cs_wallet);\n-    AssertLockHeld(spk_man->cs_wallet);\n+    AssertLockHeld(spk_man.cs_wallet);\n \n     EnsureWalletIsUnlocked(pwallet);\n \n@@ -794,10 +785,10 @@ UniValue dumpwallet(const JSONRPCRequest& request)\n         throw JSONRPCError(RPC_INVALID_PARAMETER, \"Cannot open wallet dump file\");\n \n     std::map<CKeyID, int64_t> mapKeyBirth;\n-    const std::map<CKeyID, int64_t>& mapKeyPool = spk_man->GetAllReserveKeys();\n+    const std::map<CKeyID, int64_t>& mapKeyPool = spk_man.GetAllReserveKeys();\n     pwallet->GetKeyBirthTimes(*locked_chain, mapKeyBirth);\n \n-    std::set<CScriptID> scripts = spk_man->GetCScripts();\n+    std::set<CScriptID> scripts = spk_man.GetCScripts();\n \n     // sort time/key pairs\n     std::vector<std::pair<int64_t, CKeyID> > vKeyBirth;\n@@ -816,11 +807,11 @@ UniValue dumpwallet(const JSONRPCRequest& request)\n     file << \"\\n\";\n \n     // add the base58check encoded extended master if the wallet uses HD\n-    CKeyID seed_id = spk_man->GetHDChain().seed_id;\n+    CKeyID seed_id = spk_man.GetHDChain().seed_id;\n     if (!seed_id.IsNull())\n     {\n         CKey seed;\n-        if (spk_man->GetKey(seed_id, seed)) {\n+        if (spk_man.GetKey(seed_id, seed)) {\n             CExtKey masterKey;\n             masterKey.SetSeed(seed.begin(), seed.size());\n \n@@ -833,20 +824,20 @@ UniValue dumpwallet(const JSONRPCRequest& request)\n         std::string strAddr;\n         std::string strLabel;\n         CKey key;\n-        if (spk_man->GetKey(keyid, key)) {\n+        if (spk_man.GetKey(keyid, key)) {\n             file << strprintf(\"%s %s \", EncodeSecret(key), strTime);\n-            if (GetWalletAddressesForKey(spk_man, pwallet, keyid, strAddr, strLabel)) {\n+            if (GetWalletAddressesForKey(&spk_man, pwallet, keyid, strAddr, strLabel)) {\n                file << strprintf(\"label=%s\", strLabel);\n             } else if (keyid == seed_id) {\n                 file << \"hdseed=1\";\n             } else if (mapKeyPool.count(keyid)) {\n                 file << \"reserve=1\";\n-            } else if (spk_man->mapKeyMetadata[keyid].hdKeypath == \"s\") {\n+            } else if (spk_man.mapKeyMetadata[keyid].hdKeypath == \"s\") {\n                 file << \"inactivehdseed=1\";\n             } else {\n                 file << \"change=1\";\n             }\n-            file << strprintf(\" # addr=%s%s\\n\", strAddr, (spk_man->mapKeyMetadata[keyid].has_key_origin ? \" hdkeypath=\"+WriteHDKeypath(spk_man->mapKeyMetadata[keyid].key_origin.path) : \"\"));\n+            file << strprintf(\" # addr=%s%s\\n\", strAddr, (spk_man.mapKeyMetadata[keyid].has_key_origin ? \" hdkeypath=\"+WriteHDKeypath(spk_man.mapKeyMetadata[keyid].key_origin.path) : \"\"));\n         }\n     }\n     file << \"\\n\";\n@@ -855,11 +846,11 @@ UniValue dumpwallet(const JSONRPCRequest& request)\n         std::string create_time = \"0\";\n         std::string address = EncodeDestination(ScriptHash(scriptid));\n         // get birth times for scripts with metadata\n-        auto it = spk_man->m_script_metadata.find(scriptid);\n-        if (it != spk_man->m_script_metadata.end()) {\n+        auto it = spk_man.m_script_metadata.find(scriptid);\n+        if (it != spk_man.m_script_metadata.end()) {\n             create_time = FormatISO8601DateTime(it->second.nCreateTime);\n         }\n-        if(spk_man->GetCScript(scriptid, script)) {\n+        if(spk_man.GetCScript(scriptid, script)) {\n             file << strprintf(\"%s %s script=1\", HexStr(script.begin(), script.end()), create_time);\n             file << strprintf(\" # addr=%s\\n\", address);\n         }\n@@ -1355,10 +1346,7 @@ UniValue importmulti(const JSONRPCRequest& mainRequest)\n \n     RPCTypeCheck(mainRequest.params, {UniValue::VARR, UniValue::VOBJ});\n \n-    LegacyScriptPubKeyMan* spk_man = pwallet->GetLegacyScriptPubKeyMan();\n-    if (!spk_man) {\n-        throw JSONRPCError(RPC_WALLET_ERROR, \"This type of wallet does not support this command\");\n-    }\n+    LegacyScriptPubKeyMan& spk_man = GetLegacyScriptPubKeyMan(*wallet);\n \n     const UniValue& requests = mainRequest.params[0];\n "
      }
    ]
  },
  {
    "sha": "628d11b2ba0f1ba715c2358373e603a56d9f69ff",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2MjhkMTFiMmJhMGYxYmE3MTVjMjM1ODM3M2U2MDNhNTZkOWY2OWZm",
    "commit": {
      "author": {
        "name": "Russell Yanofsky",
        "email": "russ@yanofsky.org",
        "date": "2019-10-29T16:21:57Z"
      },
      "committer": {
        "name": "Russell Yanofsky",
        "email": "russ@yanofsky.org",
        "date": "2019-10-29T16:21:57Z"
      },
      "message": "Add back mistakenly removed AssertLockHeld\n\nSuggestion from MarcoFalke <falke.marco@gmail.com>\nhttps://github.com/bitcoin/bitcoin/pull/17260#discussion_r340029481",
      "tree": {
        "sha": "60dbdb84e672f2ca17175fbff26d21bb3bf44780",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/60dbdb84e672f2ca17175fbff26d21bb3bf44780"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/628d11b2ba0f1ba715c2358373e603a56d9f69ff",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/628d11b2ba0f1ba715c2358373e603a56d9f69ff",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/628d11b2ba0f1ba715c2358373e603a56d9f69ff",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/628d11b2ba0f1ba715c2358373e603a56d9f69ff/comments",
    "author": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "52cf68f7ffa1dd3a6850606a75c32b77b1308c4b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/52cf68f7ffa1dd3a6850606a75c32b77b1308c4b",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/52cf68f7ffa1dd3a6850606a75c32b77b1308c4b"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 2,
      "deletions": 0
    },
    "files": [
      {
        "sha": "259bfcd76d1ad4553d4716cb10a55ebc01e483b9",
        "filename": "src/wallet/scriptpubkeyman.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/628d11b2ba0f1ba715c2358373e603a56d9f69ff/src/wallet/scriptpubkeyman.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/628d11b2ba0f1ba715c2358373e603a56d9f69ff/src/wallet/scriptpubkeyman.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/scriptpubkeyman.cpp?ref=628d11b2ba0f1ba715c2358373e603a56d9f69ff",
        "patch": "@@ -386,6 +386,8 @@ bool LegacyScriptPubKeyMan::AddKeyPubKey(const CKey& secret, const CPubKey &pubk\n \n bool LegacyScriptPubKeyMan::AddKeyPubKeyWithDB(WalletBatch& batch, const CKey& secret, const CPubKey& pubkey)\n {\n+    AssertLockHeld(cs_wallet);\n+\n     // Make sure we aren't adding private keys to private key disabled wallets\n     assert(!m_storage.IsWalletFlagSet(WALLET_FLAG_DISABLE_PRIVATE_KEYS));\n "
      }
    ]
  },
  {
    "sha": "2632b1f12466f970b667b42f462a6503df88e128",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyNjMyYjFmMTI0NjZmOTcwYjY2N2I0MmY0NjJhNjUwM2RmODhlMTI4",
    "commit": {
      "author": {
        "name": "Russell Yanofsky",
        "email": "russ@yanofsky.org",
        "date": "2019-10-29T16:23:47Z"
      },
      "committer": {
        "name": "Russell Yanofsky",
        "email": "russ@yanofsky.org",
        "date": "2019-10-29T16:23:47Z"
      },
      "message": "doc: Clarify WalletStorage / Wallet relation\n\nSuggested by MarcoFalke <falke.marco@gmail.com>\nhttps://github.com/bitcoin/bitcoin/pull/17260#discussion_r340031507",
      "tree": {
        "sha": "831e7c3c2e2f9abc851b0eb0bd9d7e821c0a6fbd",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/831e7c3c2e2f9abc851b0eb0bd9d7e821c0a6fbd"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2632b1f12466f970b667b42f462a6503df88e128",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2632b1f12466f970b667b42f462a6503df88e128",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/2632b1f12466f970b667b42f462a6503df88e128",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2632b1f12466f970b667b42f462a6503df88e128/comments",
    "author": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "628d11b2ba0f1ba715c2358373e603a56d9f69ff",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/628d11b2ba0f1ba715c2358373e603a56d9f69ff",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/628d11b2ba0f1ba715c2358373e603a56d9f69ff"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 1,
      "deletions": 1
    },
    "files": [
      {
        "sha": "16a5c9b9794a7c992176f0443953a3eec9312353",
        "filename": "src/wallet/scriptpubkeyman.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/2632b1f12466f970b667b42f462a6503df88e128/src/wallet/scriptpubkeyman.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/2632b1f12466f970b667b42f462a6503df88e128/src/wallet/scriptpubkeyman.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/scriptpubkeyman.h?ref=2632b1f12466f970b667b42f462a6503df88e128",
        "patch": "@@ -20,7 +20,7 @@ enum class OutputType;\n // It provides access to things that are part of the entire wallet and not specific to a ScriptPubKeyMan such as\n // wallet flags, wallet version, encryption keys, encryption status, and the database itself. This allows a\n // ScriptPubKeyMan to have callbacks into CWallet without causing a circular dependency.\n-// WalletStorage should be the same for all ScriptPubKeyMans.\n+// WalletStorage should be the same for all ScriptPubKeyMans of a wallet.\n class WalletStorage\n {\n public:"
      }
    ]
  },
  {
    "sha": "4b28a05f080de8acefaaa74f1204829995611d9e",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0YjI4YTA1ZjA4MGRlOGFjZWZhYWE3NGYxMjA0ODI5OTk1NjExZDll",
    "commit": {
      "author": {
        "name": "Russell Yanofsky",
        "email": "russ@yanofsky.org",
        "date": "2019-10-29T16:24:34Z"
      },
      "committer": {
        "name": "Russell Yanofsky",
        "email": "russ@yanofsky.org",
        "date": "2019-10-29T16:24:34Z"
      },
      "message": "Fix misplaced AssertLockHeld\n\nSuggestion from MarcoFalke <falke.marco@gmail.com>\nhttps://github.com/bitcoin/bitcoin/pull/17260#discussion_r340033021",
      "tree": {
        "sha": "bf5856ae96c47d57b2ef4ee14bb2ba9f23ff8a71",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bf5856ae96c47d57b2ef4ee14bb2ba9f23ff8a71"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4b28a05f080de8acefaaa74f1204829995611d9e",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4b28a05f080de8acefaaa74f1204829995611d9e",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/4b28a05f080de8acefaaa74f1204829995611d9e",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4b28a05f080de8acefaaa74f1204829995611d9e/comments",
    "author": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "2632b1f12466f970b667b42f462a6503df88e128",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2632b1f12466f970b667b42f462a6503df88e128",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/2632b1f12466f970b667b42f462a6503df88e128"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 1,
      "deletions": 1
    },
    "files": [
      {
        "sha": "7ffdcd13681c9668144c13dd3448725df6cc36a9",
        "filename": "src/wallet/wallet.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4b28a05f080de8acefaaa74f1204829995611d9e/src/wallet/wallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4b28a05f080de8acefaaa74f1204829995611d9e/src/wallet/wallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/wallet.cpp?ref=4b28a05f080de8acefaaa74f1204829995611d9e",
        "patch": "@@ -249,8 +249,8 @@ const CWalletTx* CWallet::GetWalletTx(const uint256& hash) const\n \n void CWallet::UpgradeKeyMetadata()\n {\n-    AssertLockHeld(m_spk_man->cs_wallet);\n     if (m_spk_man) {\n+        AssertLockHeld(m_spk_man->cs_wallet);\n         m_spk_man->UpgradeKeyMetadata();\n     }\n }"
      }
    ]
  },
  {
    "sha": "53fe0b70adeffe4cb94e6fa18a9abbdf674a2cd0",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo1M2ZlMGI3MGFkZWZmZTRjYjk0ZTZmYTE4YTlhYmJkZjY3NGEyY2Qw",
    "commit": {
      "author": {
        "name": "Russell Yanofsky",
        "email": "russ@yanofsky.org",
        "date": "2019-10-29T16:25:28Z"
      },
      "committer": {
        "name": "Russell Yanofsky",
        "email": "russ@yanofsky.org",
        "date": "2019-10-29T16:25:28Z"
      },
      "message": "Fix missing strFailReason in CreateTransaction\n\nSuggested by MarcoFalke <falke.marco@gmail.com>\nhttps://github.com/bitcoin/bitcoin/pull/17260#discussion_r340036269",
      "tree": {
        "sha": "b872832b26baabc5354154dd07642c4de45527db",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b872832b26baabc5354154dd07642c4de45527db"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/53fe0b70adeffe4cb94e6fa18a9abbdf674a2cd0",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/53fe0b70adeffe4cb94e6fa18a9abbdf674a2cd0",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/53fe0b70adeffe4cb94e6fa18a9abbdf674a2cd0",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/53fe0b70adeffe4cb94e6fa18a9abbdf674a2cd0/comments",
    "author": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "4b28a05f080de8acefaaa74f1204829995611d9e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4b28a05f080de8acefaaa74f1204829995611d9e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/4b28a05f080de8acefaaa74f1204829995611d9e"
      }
    ],
    "stats": {
      "total": 6,
      "additions": 1,
      "deletions": 5
    },
    "files": [
      {
        "sha": "069ae57878902558f9f1f5b892e9dd47f0f7d79a",
        "filename": "src/wallet/wallet.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 5,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/53fe0b70adeffe4cb94e6fa18a9abbdf674a2cd0/src/wallet/wallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/53fe0b70adeffe4cb94e6fa18a9abbdf674a2cd0/src/wallet/wallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/wallet.cpp?ref=53fe0b70adeffe4cb94e6fa18a9abbdf674a2cd0",
        "patch": "@@ -2783,11 +2783,7 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 SignatureData sigdata;\n \n                 const SigningProvider* provider = GetSigningProvider();\n-                if (!provider) {\n-                    return false;\n-                }\n-\n-                if (!ProduceSignature(*provider, MutableTransactionSignatureCreator(&txNew, nIn, coin.txout.nValue, SIGHASH_ALL), scriptPubKey, sigdata))\n+                if (!provider || !ProduceSignature(*provider, MutableTransactionSignatureCreator(&txNew, nIn, coin.txout.nValue, SIGHASH_ALL), scriptPubKey, sigdata))\n                 {\n                     strFailReason = _(\"Signing transaction failed\").translated;\n                     return false;"
      }
    ]
  }
]