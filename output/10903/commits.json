[
  {
    "sha": "c86b77fc44c74628f5c890c9015338600c69739b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpjODZiNzdmYzQ0Yzc0NjI4ZjVjODkwYzkwMTUzMzg2MDBjNjk3Mzli",
    "commit": {
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@gmail.com",
        "date": "2017-07-22T05:08:23Z"
      },
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@gmail.com",
        "date": "2017-07-22T17:05:29Z"
      },
      "message": "Add configuration files for a Docker-based development environment\n\nThanks to @emanuelb @stevendlander for feedback.",
      "tree": {
        "sha": "e9596b05971eb43f702d1ec4a6d7418b23a4346c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e9596b05971eb43f702d1ec4a6d7418b23a4346c"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c86b77fc44c74628f5c890c9015338600c69739b",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c86b77fc44c74628f5c890c9015338600c69739b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/c86b77fc44c74628f5c890c9015338600c69739b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c86b77fc44c74628f5c890c9015338600c69739b/comments",
    "author": {
      "login": "jamesob",
      "id": 73197,
      "node_id": "MDQ6VXNlcjczMTk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jamesob",
      "html_url": "https://github.com/jamesob",
      "followers_url": "https://api.github.com/users/jamesob/followers",
      "following_url": "https://api.github.com/users/jamesob/following{/other_user}",
      "gists_url": "https://api.github.com/users/jamesob/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
      "organizations_url": "https://api.github.com/users/jamesob/orgs",
      "repos_url": "https://api.github.com/users/jamesob/repos",
      "events_url": "https://api.github.com/users/jamesob/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jamesob/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jamesob",
      "id": 73197,
      "node_id": "MDQ6VXNlcjczMTk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jamesob",
      "html_url": "https://github.com/jamesob",
      "followers_url": "https://api.github.com/users/jamesob/followers",
      "following_url": "https://api.github.com/users/jamesob/following{/other_user}",
      "gists_url": "https://api.github.com/users/jamesob/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
      "organizations_url": "https://api.github.com/users/jamesob/orgs",
      "repos_url": "https://api.github.com/users/jamesob/repos",
      "events_url": "https://api.github.com/users/jamesob/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jamesob/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "420238d3103aa5c2e0ad29be840ba5d04b9d243e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/420238d3103aa5c2e0ad29be840ba5d04b9d243e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/420238d3103aa5c2e0ad29be840ba5d04b9d243e"
      }
    ],
    "stats": {
      "total": 204,
      "additions": 204,
      "deletions": 0
    },
    "files": [
      {
        "sha": "07cfcc4c739b6392112fe12af8935cb71f17d060",
        "filename": "Dockerfile",
        "status": "added",
        "additions": 35,
        "deletions": 0,
        "changes": 35,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/c86b77fc44c74628f5c890c9015338600c69739b/Dockerfile",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/c86b77fc44c74628f5c890c9015338600c69739b/Dockerfile",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/Dockerfile?ref=c86b77fc44c74628f5c890c9015338600c69739b",
        "patch": "@@ -0,0 +1,35 @@\n+# A base Docker image running Python 3.6.2 and Debian 8 \"Jessie\"\n+# See: https://github.com/docker-library/python/blob/master/3.6/jessie/Dockerfile\n+FROM python:3.6.2-jessie\n+\n+RUN apt-get update && \\\n+    apt-get install -y \\\n+    libboost-system-dev libboost-filesystem-dev libboost-chrono-dev \\\n+    libboost-program-options-dev libboost-test-dev libboost-thread-dev \\\n+    build-essential libtool autotools-dev automake pkg-config libssl-dev \\\n+    libevent-dev bsdmainutils \\\n+    libzmq3 miniupnpc \\\n+    # Install clang for potential use over g++.\n+    clang\n+\n+# The Bitcoin source code will be located at /code and mounted by \n+# docker-compose.\n+ENV HOME /code\n+WORKDIR /code\n+\n+# Install Berkeley DB 4.8 for use with wallet functionality.\n+ENV BDB_PREFIX /db4\n+ENV BDB_VERSION db-4.8.30.NC\n+RUN mkdir -p $BDB_PREFIX && \\\n+    wget --no-check-certificate \\\n+        \"https://download.oracle.com/berkeley-db/${BDB_VERSION}.tar.gz\" \\\n+        -O ${BDB_VERSION}.tar.gz && \\\n+    echo \"12edc0df75bf9abd7f82f821795bcee50f42cb2e5f76a6a281b85732798364ef  ${BDB_VERSION}.tar.gz\" \\\n+        | sha256sum -c && \\\n+    tar -xzvf ${BDB_VERSION}.tar.gz -C $BDB_PREFIX && \\\n+    rm ${BDB_VERSION}.tar.gz && \\\n+    ${BDB_PREFIX}/${BDB_VERSION}/dist/configure \\\n+        --enable-cxx --disable-shared --with-pic --prefix=$BDB_PREFIX && \\\n+    make install\n+\n+ENTRYPOINT [\"./bin/docker_entrypoint.sh\"]"
      },
      {
        "sha": "88424e943bbb5e88a6bb69308450f384b99632f8",
        "filename": "bin/docker_entrypoint.sh",
        "status": "added",
        "additions": 82,
        "deletions": 0,
        "changes": 82,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/c86b77fc44c74628f5c890c9015338600c69739b/bin/docker_entrypoint.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/c86b77fc44c74628f5c890c9015338600c69739b/bin/docker_entrypoint.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/bin/docker_entrypoint.sh?ref=c86b77fc44c74628f5c890c9015338600c69739b",
        "patch": "@@ -0,0 +1,82 @@\n+#!/usr/bin/env bash\n+\n+set -e\n+\n+#\n+# Docker entrypoint \n+#   (see: https://docs.docker.com/engine/reference/builder/#entrypoint)\n+#\n+# This script is for use with the Docker container built by `../Dockerfile`\n+# and run with `docker-compose` (see `docker-compose.yml`).\n+#\n+# Recognized arguments:\n+#\n+#   - `test`: Run all tests. \n+#      E.g. `docker-compose run --rm bitcoind test`.\n+#\n+#   - `test-cpp`: Run all C++-based tests. \n+#      E.g. `docker-compose run --rm bitcoind test-cpp`.\n+#\n+#   - `test-python`: Run all Python-based tests. \n+#      E.g. `docker-compose run --rm bitcoind test-python --coverage`.\n+#\n+#   - `[no args]`: Start bitcoind.\n+#      E.g. `docker-compose up bitcoind`.\n+#\n+# Any arguments that aren't the above are executed in the container image as\n+# normal.\n+\n+[ -z \"${MAKE_JOBS}\" ] && MAKE_JOBS=$(nproc)\n+[ -z \"${CC}\" ] && export CC=/usr/bin/clang\n+if [ -z \"${CXX}\" ]; then\n+  export CXX=/usr/bin/clang++\n+  export CXXFLAGS=\"-std=c++11 ${CXXFLAGS}\"\n+fi\n+ \n+run_make() {\n+  make -j $MAKE_JOBS \"$@\"\n+}\n+ \n+# If we haven't run libtool, do so.\n+[ ! -f \"configure\" ] && ./autogen.sh\n+\n+# Configure Bitcoin Core to use our own-built instance of BDB.\n+[ ! -f \"config.status\" ] && ./configure \\\n+  LDFLAGS=\"-L${BDB_PREFIX}/lib/\" \\\n+  CPPFLAGS=\"-I${BDB_PREFIX}/include/\" \\\n+  CXXFLAGS=\"${CXXFLAGS}\"\n+[ ! -f \"src/bitcoind\" ] && run_make\n+\n+test_cpp() { \n+  run_make check \"$@\" \n+}\n+\n+test_python() { \n+  ./test/functional/test_runner.py \"$@\" \n+}\n+\n+case \"${1}\" in\n+  \"test\")\n+    shift;\n+    run_make\n+    test_cpp\n+    test_python --coverage\n+    ;;\n+\n+  \"test-cpp\")\n+    shift;\n+    run_make\n+    test_cpp $EXTRA_ARGS\n+    ;;\n+\n+  \"test-python\")\n+    shift;\n+    run_make\n+    [ -z \"${EXTRA_ARGS}\" ] && EXTRA_ARGS='--coverage'\n+    test_python $EXTRA_ARGS\n+    ;;\n+\n+  *)\n+    exec \"$@\"\n+    ;;\n+esac"
      },
      {
        "sha": "69dd0e1df5fe6e309647110137ffd4b2dc3b7d75",
        "filename": "doc/README.md",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/c86b77fc44c74628f5c890c9015338600c69739b/doc/README.md",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/c86b77fc44c74628f5c890c9015338600c69739b/doc/README.md",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/doc/README.md?ref=c86b77fc44c74628f5c890c9015338600c69739b",
        "patch": "@@ -39,6 +39,7 @@ The following are developer notes on how to build Bitcoin on your native platfor\n \n - [OS X Build Notes](build-osx.md)\n - [Unix Build Notes](build-unix.md)\n+- [Docker Build Notes](build-docker.md)\n - [Windows Build Notes](build-windows.md)\n - [OpenBSD Build Notes](build-openbsd.md)\n - [Gitian Building Guide](gitian-building.md)"
      },
      {
        "sha": "d4da9cae3427af07393df5d355aed085a43a54cd",
        "filename": "doc/build-docker.md",
        "status": "added",
        "additions": 64,
        "deletions": 0,
        "changes": 64,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/c86b77fc44c74628f5c890c9015338600c69739b/doc/build-docker.md",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/c86b77fc44c74628f5c890c9015338600c69739b/doc/build-docker.md",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/doc/build-docker.md?ref=c86b77fc44c74628f5c890c9015338600c69739b",
        "patch": "@@ -0,0 +1,64 @@\n+# Docker Build Instructions and Notes\n+\n+Bitcoind can be easily built on any platform which hosts a \n+[Docker](https://en.wikipedia.org/wiki/Docker_(software)) daemon. This is\n+likely the lowest-effort way to get a bitcoin development environment on your\n+machine.\n+\n+The Docker development environment does not facilitate development of the\n+GUI.\n+\n+## Preparation\n+\n+1. [Install Docker](https://www.docker.com/community-edition#/download).\n+2. If on Linux, install Docker Compose with `pip install docker-compose`.\n+3. Change directory to the root of this repository.\n+4. Run `docker-compose run bitcoind` to compile bitcoin.\n+\n+Bitcoin's source tree will be\n+[mounted](https://docs.docker.com/compose/compose-file/compose-file-v2/#volumes-volume_driver) \n+into the Docker container, so any changes you make to the source tree on\n+your host computer will be immediately reflected within the Docker container.\n+\n+## Commands\n+\n+### Run all tests\n+\n+```sh\n+docker-compose run --rm bitcoind test\n+```\n+\n+### Run C++ tests\n+\n+```sh\n+docker-compose run --rm bitcoind test-cpp [args ...]\n+```\n+\n+### Run Python tests\n+\n+```sh\n+docker-compose run --rm bitcoind test-python [args ...]\n+```\n+  \n+### Run bitcoind\n+\n+In the foreground\n+\n+```sh\n+docker-compose up bitcoind\n+```\n+\n+or in the background\n+\n+```sh\n+docker-compose up -d bitcoind\n+```\n+ \n+### Other commands\n+\n+Any command can be run within the container image by passing it as additional\n+arguments:\n+ \n+```sh\n+docker-compose run --rm bitcoind [cmd ...]\n+```             "
      },
      {
        "sha": "fc842c48a48f74b7fe3cd2b008dff6580bfe73e1",
        "filename": "docker-compose.yml",
        "status": "added",
        "additions": 22,
        "deletions": 0,
        "changes": 22,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/c86b77fc44c74628f5c890c9015338600c69739b/docker-compose.yml",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/c86b77fc44c74628f5c890c9015338600c69739b/docker-compose.yml",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/docker-compose.yml?ref=c86b77fc44c74628f5c890c9015338600c69739b",
        "patch": "@@ -0,0 +1,22 @@\n+version: '2'\n+\n+services:\n+  bitcoind:\n+    build:\n+      context: .\n+      dockerfile: Dockerfile\n+    image: bitcoind\n+    # By default, run the bitcoind daemon. This can be overridden with\n+    # additional arguments to `docker-compose run bitcoind`.\n+    command: \"src/bitcoind -printtoconsole\"\n+    volumes:\n+      # Mount `pwd` into the container to support immediate code updates.\n+      - .:/code\n+      # Persist bash history in the web container.\n+      - .docker_bash_history:/root/.bash_history\n+    ports:\n+      - \"8333:8333\"\n+    environment:\n+      CC:\n+      CXX:\n+      CXX_FLAGS:"
      }
    ]
  }
]