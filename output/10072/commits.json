[
  {
    "sha": "1f3d78b4e099f22b03ffeec9e91c02de81430702",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxZjNkNzhiNGUwOTlmMjJiMDNmZmVlYzllOTFjMDJkZTgxNDMwNzAy",
    "commit": {
      "author": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2017-03-24T20:14:13Z"
      },
      "committer": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2017-03-28T20:15:38Z"
      },
      "message": "Wait for connection to open in bip9-softforks.py\n\nbip9-sofforks.py stop-starts the bitcoind node twice during the test\nrun, but it doesn't wait for the connection from mininode to open before\ncontinuing with the test. This leads to race conditions where the test\ncan fail getblocktemplate() because it has no p2p connections.",
      "tree": {
        "sha": "defd3cfd2577db6d94ce65ef57ef20f160d1323e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/defd3cfd2577db6d94ce65ef57ef20f160d1323e"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1f3d78b4e099f22b03ffeec9e91c02de81430702",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1f3d78b4e099f22b03ffeec9e91c02de81430702",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/1f3d78b4e099f22b03ffeec9e91c02de81430702",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1f3d78b4e099f22b03ffeec9e91c02de81430702/comments",
    "author": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "0b9fb682890b8fe10cec54072b809a5efe57d33d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0b9fb682890b8fe10cec54072b809a5efe57d33d",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/0b9fb682890b8fe10cec54072b809a5efe57d33d"
      }
    ],
    "stats": {
      "total": 10,
      "additions": 4,
      "deletions": 6
    },
    "files": [
      {
        "sha": "60d262da81ab286520f75f2e45a48ff74455c376",
        "filename": "test/functional/bip9-softforks.py",
        "status": "modified",
        "additions": 4,
        "deletions": 6,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1f3d78b4e099f22b03ffeec9e91c02de81430702/test/functional/bip9-softforks.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1f3d78b4e099f22b03ffeec9e91c02de81430702/test/functional/bip9-softforks.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/bip9-softforks.py?ref=1f3d78b4e099f22b03ffeec9e91c02de81430702",
        "patch": "@@ -200,16 +200,14 @@ def test_BIP(self, bipName, activated_version, invalidate, invalidatePostSignatu\n         yield TestInstance([[block, False]])\n \n         # Restart all\n-        self.test.block_store.close()\n+        self.test.clear_all_connections()\n         stop_nodes(self.nodes)\n-        shutil.rmtree(self.options.tmpdir)\n+        shutil.rmtree(self.options.tmpdir + \"/node0\")\n         self.setup_chain()\n         self.setup_network()\n-        self.test.block_store = BlockStore(self.options.tmpdir)\n-        self.test.clear_all_connections()\n         self.test.add_all_connections(self.nodes)\n-        NetworkThread().start() # Start up network handling in another thread\n-\n+        NetworkThread().start()\n+        self.test.test_nodes[0].wait_for_verack()\n \n     def get_tests(self):\n         for test in itertools.chain("
      }
    ]
  },
  {
    "sha": "a4fd89fddba49c56e77f131fe95feffa8d7cf6ed",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphNGZkODlmZGRiYTQ5YzU2ZTc3ZjEzMWZlOTVmZWZmYThkN2NmNmVk",
    "commit": {
      "author": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2017-03-24T16:35:28Z"
      },
      "committer": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2017-03-28T20:22:19Z"
      },
      "message": "Make forknotify.py more robust\n\nforknotify would intermittently fail because the alert file was not\nbeing written fast enough. This commit adds a timeout so the test does\nnot fail immediately.",
      "tree": {
        "sha": "c92e4e001a97410c58fa495940d67be9603ab623",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c92e4e001a97410c58fa495940d67be9603ab623"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a4fd89fddba49c56e77f131fe95feffa8d7cf6ed",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a4fd89fddba49c56e77f131fe95feffa8d7cf6ed",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/a4fd89fddba49c56e77f131fe95feffa8d7cf6ed",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a4fd89fddba49c56e77f131fe95feffa8d7cf6ed/comments",
    "author": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "1f3d78b4e099f22b03ffeec9e91c02de81430702",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1f3d78b4e099f22b03ffeec9e91c02de81430702",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/1f3d78b4e099f22b03ffeec9e91c02de81430702"
      }
    ],
    "stats": {
      "total": 15,
      "additions": 12,
      "deletions": 3
    },
    "files": [
      {
        "sha": "7a365438cc24f7c6f38d2c7c80e2d8885d31643f",
        "filename": "test/functional/forknotify.py",
        "status": "modified",
        "additions": 12,
        "deletions": 3,
        "changes": 15,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a4fd89fddba49c56e77f131fe95feffa8d7cf6ed/test/functional/forknotify.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a4fd89fddba49c56e77f131fe95feffa8d7cf6ed/test/functional/forknotify.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/forknotify.py?ref=a4fd89fddba49c56e77f131fe95feffa8d7cf6ed",
        "patch": "@@ -3,6 +3,8 @@\n # Distributed under the MIT software license, see the accompanying\n # file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \"\"\"Test the -alertnotify option.\"\"\"\n+import os\n+import time\n \n from test_framework.test_framework import BitcoinTestFramework\n from test_framework.util import *\n@@ -41,12 +43,19 @@ def run_test(self):\n         self.nodes[1].generate(1)\n         self.sync_all()\n \n+        # Give bitcoind 10 seconds to write the alert notification\n+        timeout = 10.0\n+        while timeout > 0:\n+            if os.path.exists(self.alert_filename) and os.path.getsize(self.alert_filename):\n+                break\n+            time.sleep(0.1)\n+            timeout -= 0.1\n+        else:\n+            assert False, \"-alertnotify did not warn of up-version blocks\"\n+\n         with open(self.alert_filename, 'r', encoding='utf8') as f:\n             alert_text = f.read()\n \n-        if len(alert_text) == 0:\n-            raise AssertionError(\"-alertnotify did not warn of up-version blocks\")\n-\n         # Mine more up-version blocks, should not get more alerts:\n         self.nodes[1].generate(1)\n         self.sync_all()"
      }
    ]
  }
]