jnewbery,2017-03-28T20:23:23Z,Pushed a new version using while/else and not using assert for control flow.,https://github.com/bitcoin/bitcoin/pull/10072#issuecomment-289892911,289892911,
MarcoFalke,2017-04-02T10:51:02Z,"utACK a4fd89f. Going to merge this, so that the failures are a thing of the past.",https://github.com/bitcoin/bitcoin/pull/10072#issuecomment-290978641,290978641,
jnewbery,2017-04-02T19:53:15Z,"ðŸŽ‰ first successful daily run of extended tests on Travis: https://travis-ci.org/bitcoin/bitcoin/builds/217786785\n\nThanks for merging @MarcoFalke ",https://github.com/bitcoin/bitcoin/pull/10072#issuecomment-291010398,291010398,
JeremyRubin,2017-03-28T17:43:08Z,Do we want the same behavior on L44?,https://github.com/bitcoin/bitcoin/pull/10072#discussion_r108487850,108487850,test/functional/bip9-softforks.py
JeremyRubin,2017-03-28T17:44:08Z,"Is there any work we can do in-between this and the wait for verack?\n\nMaybe have a comment here about having to wait for verack rather than just deleting the comment.",https://github.com/bitcoin/bitcoin/pull/10072#discussion_r108488077,108488077,test/functional/bip9-softforks.py
JeremyRubin,2017-03-28T17:44:22Z,Is there a more idiomatic way to get the dirname?,https://github.com/bitcoin/bitcoin/pull/10072#discussion_r108488136,108488136,test/functional/bip9-softforks.py
JeremyRubin,2017-03-28T17:46:18Z,"Maybe raise the error yourself rather than `assert`, unless you only want it in debug mode?",https://github.com/bitcoin/bitcoin/pull/10072#discussion_r108488637,108488637,test/functional/forknotify.py
JeremyRubin,2017-03-28T18:04:49Z,"Maybe a bit cleaner to do something like (a couple of changes, feel free to pick and choose -- I was torn on the os.path.exists+getsize v.s. continual reading with open).\n\n```python\n        for t in xrange(100):\n            if os.path.exists(self.alert_filename) and os.path.getsize(self.alert_filename):\n                break\n            if t != 99: time.sleep(0.1) \n        else:\n  ",https://github.com/bitcoin/bitcoin/pull/10072#discussion_r108493763,108493763,test/functional/forknotify.py
JeremyRubin,2017-03-28T18:07:35Z,"This should rarely actually take 10 seconds, if the code is correct, right? Maybe 1 second will be a bit better in the case where it is actually broken & you're trying to fix it.",https://github.com/bitcoin/bitcoin/pull/10072#discussion_r108494509,108494509,test/functional/forknotify.py
jnewbery,2017-03-28T18:45:52Z,"Not that I know of.\n\nI don't like the fact that this test is using shutil and removing files itself. This change just makes it slightly less damaging (ie it's only removing the datadir rather than the entire tmpdir)",https://github.com/bitcoin/bitcoin/pull/10072#discussion_r108505201,108505201,test/functional/bip9-softforks.py
jnewbery,2017-03-28T18:46:51Z,"No, we need to wait for the network thread to start before receiving the verack (the network thread is what catches the verack and calls the callback).",https://github.com/bitcoin/bitcoin/pull/10072#discussion_r108505549,108505549,test/functional/bip9-softforks.py
jnewbery,2017-03-28T18:48:39Z,wait_for_verack() is called by the comparison test framework at the start of the test run (comptest.py line 300).,https://github.com/bitcoin/bitcoin/pull/10072#discussion_r108506068,108506068,test/functional/bip9-softforks.py
jnewbery,2017-03-28T18:49:48Z,Depends. Travis catches a lot of timing edge cases. I don't think there's any problem making the timeout something high like 10 seconds since the while loop will break as soon as the file is written.,https://github.com/bitcoin/bitcoin/pull/10072#discussion_r108506362,108506362,test/functional/forknotify.py
jnewbery,2017-03-28T18:51:40Z,I think this is equivalent.,https://github.com/bitcoin/bitcoin/pull/10072#discussion_r108506887,108506887,test/functional/forknotify.py
jnewbery,2017-03-28T18:53:14Z,I don't think there's any difference. No-one runs the test cases with `-O`,https://github.com/bitcoin/bitcoin/pull/10072#discussion_r108507304,108507304,test/functional/forknotify.py
JeremyRubin,2017-03-28T19:57:46Z,"yeah; mostly this was motivated by being able to get rid of the stateful `timeout = 10; assert timeout > 0; timeout -= 0.1` combo.\nThis is also fine.\n```python\n        for t in xrange(100):\n            with open(self.alert_filename, 'r', encoding='utf8') as f:\n                alert_text = f.read()\n            if alert_text:\n                break\n            time.sleep(0.1) \n     ",https://github.com/bitcoin/bitcoin/pull/10072#discussion_r108521935,108521935,test/functional/forknotify.py
JeremyRubin,2017-03-28T20:02:40Z,using asserts as control flow is generally an antipattern (I think that the for/else loop is a bit clearer in any case).,https://github.com/bitcoin/bitcoin/pull/10072#discussion_r108522911,108522911,test/functional/forknotify.py
jnewbery,2017-03-28T20:11:10Z,"ah. I see what you're saying now. Yes, I'll remove the assert from the control flow.",https://github.com/bitcoin/bitcoin/pull/10072#discussion_r108524745,108524745,test/functional/forknotify.py
MarcoFalke,2017-04-02T10:53:21Z,@jnewbery nit: Any reason you changed the raise AssertionError to assert False?,https://github.com/bitcoin/bitcoin/pull/10072#discussion_r109305808,109305808,test/functional/forknotify.py
jnewbery,2017-04-02T13:12:40Z,No good reason. Equivalent behaviour but you're probably right that `raise AssertionError` is better style here.,https://github.com/bitcoin/bitcoin/pull/10072#discussion_r109308519,109308519,test/functional/forknotify.py
