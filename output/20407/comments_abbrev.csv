MarcoFalke,2020-11-17 07:33:29,How is this different from includeconf with the rpcauth in it as the only content?,https://github.com/bitcoin/bitcoin/pull/20407#issuecomment-728743668,728743668,
promag,2020-11-17 08:48:39,"@MarcoFalke I thought about suggesting that but main issue is that `-includeconf` can't be specified in the command line. Also the file pointed by `-includeconf` can have more configurations.\n\nMaybe @ruimarinho and @NicolasDorier can weight on the the approach.",https://github.com/bitcoin/bitcoin/pull/20407#issuecomment-728781240,728781240,
promag,2020-11-17 13:43:01,Your approach doesn't support multiple credentials. I also see the cookie as a local authentication mechanism.,https://github.com/bitcoin/bitcoin/pull/20407#issuecomment-728935177,728935177,
laanwj,2020-11-18 10:29:40,"Kind of meh on adding yet another RPC authentication method that's only a slight variation from the other ones, but as long as it (and all combinatorial options it opens up) are tested sufficiently I'm not strongly against it either.\n",https://github.com/bitcoin/bitcoin/pull/20407#issuecomment-729586864,729586864,
promag,2020-11-18 11:36:22,"@laanwj while @ryanofsky approach is indeed simple (just misses the detail of not erasing cookie file on shutdown) it doesn't support different users with different whitelists. Also note that @ryanofsky approach changes cookie semantic - the cookie is available while the daemon is running. I'd even limit cookie authentication to loopback interface.\n\n> the cookie value would be automatically pi",https://github.com/bitcoin/bitcoin/pull/20407#issuecomment-729622254,729622254,
ryanofsky,2020-11-18 12:40:03,"@promag sure, and thanks for implementing this. I just suggested the [`-rpccookiegenerate`](https://github.com/bitcoin/bitcoin/pull/20407#pullrequestreview-532347871) boolean option because it seemed to directly address the reported issue, because it seemed simple to implement as a ~one-line change, and because it seemed like a simpler configuration to set up: not requiring any scripting or hashin",https://github.com/bitcoin/bitcoin/pull/20407#issuecomment-729651383,729651383,
promag,2020-11-18 12:48:40,I'd say the advantage of `-rpcauthfile` is to have a file with just the token and so more suitable as a shared secret.,https://github.com/bitcoin/bitcoin/pull/20407#issuecomment-729655483,729655483,
promag,2020-11-18 12:49:46,"> I do agree with you that it would probably make sense to stop allowing cookie authentication from non-local connections by default.\n\nOk, this can be submitted on a separate branch.",https://github.com/bitcoin/bitcoin/pull/20407#issuecomment-729656006,729656006,
DrahtBot,2020-11-23 22:17:12,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20461 (rpc: Validate -rpcauth arguments by promag)\n\nIf you consider this pull request important, please also help to re",https://github.com/bitcoin/bitcoin/pull/20407#issuecomment-732457946,732457946,
ryanofsky,2020-11-17 13:15:51,"I guess it's a preexisting problem, but lack of any error feedback when the syntax is wrong seems like a usability nightmare",https://github.com/bitcoin/bitcoin/pull/20407#discussion_r525144140,525144140,src/httprpc.cpp
promag,2020-11-17 13:40:34,"Yeah it is, can be improved.",https://github.com/bitcoin/bitcoin/pull/20407#discussion_r525159841,525159841,src/httprpc.cpp
promag,2020-11-17 14:25:10,"Actually I think I'll do it in this branch, `-rpcauth` values are now processed once.",https://github.com/bitcoin/bitcoin/pull/20407#discussion_r525193797,525193797,src/httprpc.cpp
schildbach,2020-11-17 17:24:59,Such an `-rpccookiegenerate=false` option is what I had in mind in #20387. I would prefer that exactly for the simplicity of using an arbitrary string as cookie (which I can share via Docker's secret mechanism).,https://github.com/bitcoin/bitcoin/pull/20407#discussion_r525346331,525346331,src/httprpc.cpp
ryanofsky,2020-11-18 12:55:08,"In commit ""rpc: Support -rpcauthfile argument"" (10ef7321f0dab8cb7dfe79f7c0f9d886d8fe0097)\n\nI think this should refuse to load if the rpcauthfile isn't formatted correctly. Logging and error and returning false might be sufficient to do this.\n\nI think an invalid -rpcauth option above should also trigger an error, or at least report an error, but it's pre-existing code so not directly relate",https://github.com/bitcoin/bitcoin/pull/20407#discussion_r526064188,526064188,src/httprpc.cpp
ryanofsky,2020-11-18 12:58:39,"In commit ""rpcauth: Support storing credentials in a file"" (ff5d7fa1e4c340657110436a29aecff85de6eb80)\n\nSame line is printed in else branch, could dedup.",https://github.com/bitcoin/bitcoin/pull/20407#discussion_r526066250,526066250,share/rpcauth/rpcauth.py
ryanofsky,2020-11-18 13:00:57,"In commit ""rpcauth: Support storing credentials in a file"" (ff5d7fa1e4c340657110436a29aecff85de6eb80)\n\nDoesn't really matter but \n\n```python\nwith open(args.output, ""x"") as file:\n   file.write(...)\n```\n\nIs slightly better style because it ensures that the file is closed immediately after the write.\n\nAlso may wish to avoid `file` variable name and use something like `f` or `fp`",https://github.com/bitcoin/bitcoin/pull/20407#discussion_r526067687,526067687,share/rpcauth/rpcauth.py
promag,2020-11-18 13:18:35,"> I think this should refuse to load\n\nYou mean the process should exit?",https://github.com/bitcoin/bitcoin/pull/20407#discussion_r526080624,526080624,src/httprpc.cpp
ryanofsky,2020-11-18 13:26:48,"re: https://github.com/bitcoin/bitcoin/pull/20407#discussion_r526080624\n\n> > I think this should refuse to load\n> \n> You mean the process should exit?\n\nI would exit, but don't think it would be crazy not to exit, do think it would be crazy to silently ignore a configuration error giving no feedback. I am presuming returning false exits, but didn't check.",https://github.com/bitcoin/bitcoin/pull/20407#discussion_r526085847,526085847,src/httprpc.cpp
luke-jr,2020-11-24 23:26:08,Mode should probably be `'a'`,https://github.com/bitcoin/bitcoin/pull/20407#discussion_r530000587,530000587,share/rpcauth/rpcauth.py
luke-jr,2020-11-24 23:28:12,"Syntax isn't necessarily wrong. It could be a 4th field added (eg, Knots uses it to restrict access to the named wallet).\n\nA debug log line can't hurt though.",https://github.com/bitcoin/bitcoin/pull/20407#discussion_r530002535,530002535,src/httprpc.cpp
luke-jr,2020-11-24 23:29:48,"See above, it's not necessarily an error",https://github.com/bitcoin/bitcoin/pull/20407#discussion_r530004151,530004151,src/httprpc.cpp
promag,2020-11-24 23:37:01,I was thinking it should fail if the file already exists.,https://github.com/bitcoin/bitcoin/pull/20407#discussion_r530010928,530010928,share/rpcauth/rpcauth.py
promag,2020-11-24 23:38:33,"@luke-jr please review #20461, this one should rebase with that.",https://github.com/bitcoin/bitcoin/pull/20407#discussion_r530012368,530012368,src/httprpc.cpp
luke-jr,2020-11-25 00:05:40,Then how would you build a file with many lines?,https://github.com/bitcoin/bitcoin/pull/20407#discussion_r530023136,530023136,share/rpcauth/rpcauth.py
luke-jr,2020-11-30 02:27:08,"Needs to specify encoding\n\n```suggestion\n        file = open(args.output, ""x"", encoding=""utf8"")\n```",https://github.com/bitcoin/bitcoin/pull/20407#discussion_r532315862,532315862,share/rpcauth/rpcauth.py
luke-jr,2021-08-31 01:17:39,This breaks the ability to set `-rpcauth=` to void all prior `-rpcauth` parameters.,https://github.com/bitcoin/bitcoin/pull/20407#discussion_r698912478,698912478,src/httprpc.cpp
