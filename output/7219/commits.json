[
  {
    "sha": "26096acf94accc96e281af1bb59ecdc4a99b6ef0",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyNjA5NmFjZjk0YWNjYzk2ZTI4MWFmMWJiNTllY2RjNGE5OWI2ZWYw",
    "commit": {
      "author": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2015-12-16T12:02:04Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2015-12-16T12:17:47Z"
      },
      "message": "util: GetArg might sometimes want a valueless result besides 0",
      "tree": {
        "sha": "f5494c8ca7ed84ce6be9c7d83a86c96b3b58815f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f5494c8ca7ed84ce6be9c7d83a86c96b3b58815f"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/26096acf94accc96e281af1bb59ecdc4a99b6ef0",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/26096acf94accc96e281af1bb59ecdc4a99b6ef0",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/26096acf94accc96e281af1bb59ecdc4a99b6ef0",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/26096acf94accc96e281af1bb59ecdc4a99b6ef0/comments",
    "author": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "63b5840257a0b892228dfa9cce943b5a2bb94e1a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/63b5840257a0b892228dfa9cce943b5a2bb94e1a",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/63b5840257a0b892228dfa9cce943b5a2bb94e1a"
      }
    ],
    "stats": {
      "total": 13,
      "additions": 9,
      "deletions": 4
    },
    "files": [
      {
        "sha": "d3a8423e5ab016e5149d6358fd58abf20a218971",
        "filename": "src/util.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 3,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/26096acf94accc96e281af1bb59ecdc4a99b6ef0/src/util.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/26096acf94accc96e281af1bb59ecdc4a99b6ef0/src/util.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util.cpp?ref=26096acf94accc96e281af1bb59ecdc4a99b6ef0",
        "patch": "@@ -381,10 +381,14 @@ std::string GetArg(const std::string& strArg, const std::string& strDefault)\n     return strDefault;\n }\n \n-int64_t GetArg(const std::string& strArg, int64_t nDefault)\n+int64_t GetArg(const std::string& strArg, int64_t nDefault, int64_t nNoValue)\n {\n-    if (mapArgs.count(strArg))\n-        return atoi64(mapArgs[strArg]);\n+    if (mapArgs.count(strArg)) {\n+        const std::string& strValue = mapArgs[strArg];\n+        if (strValue.empty())\n+            return nNoValue;\n+        return atoi64(strValue);\n+    }\n     return nDefault;\n }\n "
      },
      {
        "sha": "8afada23ce856adf75af6185a3ed96abbcf88df3",
        "filename": "src/util.h",
        "status": "modified",
        "additions": 2,
        "deletions": 1,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/26096acf94accc96e281af1bb59ecdc4a99b6ef0/src/util.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/26096acf94accc96e281af1bb59ecdc4a99b6ef0/src/util.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util.h?ref=26096acf94accc96e281af1bb59ecdc4a99b6ef0",
        "patch": "@@ -156,9 +156,10 @@ std::string GetArg(const std::string& strArg, const std::string& strDefault);\n  *\n  * @param strArg Argument to get (e.g. \"-foo\")\n  * @param default (e.g. 1)\n+ * @param novalue What to return if option provided with no value\n  * @return command-line argument (0 if invalid number) or default value\n  */\n-int64_t GetArg(const std::string& strArg, int64_t nDefault);\n+int64_t GetArg(const std::string& strArg, int64_t nDefault, int64_t nNoValue = 0);\n \n /**\n  * Return boolean argument or default value"
      }
    ]
  },
  {
    "sha": "786f92d420650ee2918c482a31f44e1bd9326574",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3ODZmOTJkNDIwNjUwZWUyOTE4YzQ4MmEzMWY0NGUxYmQ5MzI2NTc0",
    "commit": {
      "author": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2015-12-16T12:02:29Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2015-12-17T13:00:09Z"
      },
      "message": "policy: Allow configuring replace-by-fee by either disabling or enabling it",
      "tree": {
        "sha": "b729c9d85c845f814da8acc8735db3de1ae58e14",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b729c9d85c845f814da8acc8735db3de1ae58e14"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/786f92d420650ee2918c482a31f44e1bd9326574",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/786f92d420650ee2918c482a31f44e1bd9326574",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/786f92d420650ee2918c482a31f44e1bd9326574",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/786f92d420650ee2918c482a31f44e1bd9326574/comments",
    "author": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "26096acf94accc96e281af1bb59ecdc4a99b6ef0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/26096acf94accc96e281af1bb59ecdc4a99b6ef0",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/26096acf94accc96e281af1bb59ecdc4a99b6ef0"
      }
    ],
    "stats": {
      "total": 21,
      "additions": 17,
      "deletions": 4
    },
    "files": [
      {
        "sha": "609eff9573121cf6942b1c75d9d4e4eeeb9e3c39",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/786f92d420650ee2918c482a31f44e1bd9326574/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/786f92d420650ee2918c482a31f44e1bd9326574/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=786f92d420650ee2918c482a31f44e1bd9326574",
        "patch": "@@ -456,6 +456,7 @@ std::string HelpMessage(HelpMessageMode mode)\n         strUsage += HelpMessageOpt(\"-acceptnonstdtxn\", strprintf(\"Relay and mine \\\"non-standard\\\" transactions (%sdefault: %u)\", \"testnet/regtest only; \", !Params(CBaseChainParams::TESTNET).RequireStandard()));\n     strUsage += HelpMessageOpt(\"-datacarrier\", strprintf(_(\"Relay and mine data carrier transactions (default: %u)\"), 1));\n     strUsage += HelpMessageOpt(\"-datacarriersize\", strprintf(_(\"Maximum size of data in data carrier transactions we relay and mine (default: %u)\"), MAX_OP_RETURN_RELAY));\n+    strUsage += HelpMessageOpt(\"-replacebyfee\", strprintf(_(\"Allow replacement of transactions paying sufficiently higher fees (0 = never, 1 = always, 2 = opt-in, default: %s)\"), nRbfPolicy));\n \n     strUsage += HelpMessageGroup(_(\"Block creation options:\"));\n     strUsage += HelpMessageOpt(\"-blockminsize=<n>\", strprintf(_(\"Set minimum block size in bytes (default: %u)\"), 0));\n@@ -956,6 +957,7 @@ bool AppInit2(boost::thread_group& threadGroup, CScheduler& scheduler)\n \n     fIsBareMultisigStd = GetBoolArg(\"-permitbaremultisig\", true);\n     nMaxDatacarrierBytes = GetArg(\"-datacarriersize\", nMaxDatacarrierBytes);\n+    nRbfPolicy = GetArg(\"-replacebyfee\", nRbfPolicy, 1);\n \n     fAlerts = GetBoolArg(\"-alerts\", DEFAULT_ALERTS);\n "
      },
      {
        "sha": "8d317b7c95e22e0b8f4f810891628a9c36e9c2df",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 10,
        "deletions": 4,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/786f92d420650ee2918c482a31f44e1bd9326574/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/786f92d420650ee2918c482a31f44e1bd9326574/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=786f92d420650ee2918c482a31f44e1bd9326574",
        "patch": "@@ -838,9 +838,15 @@ bool AcceptToMemoryPool(CTxMemPool& pool, CValidationState &state, const CTransa\n     {\n         if (pool.mapNextTx.count(txin.prevout))\n         {\n+            if (!nRbfPolicy)\n+                // No replacement allowed by policy\n+                return state.Invalid(false, REJECT_CONFLICT, \"txn-mempool-conflict\");\n+\n             const CTransaction *ptxConflicting = pool.mapNextTx[txin.prevout].ptx;\n-            if (!setConflicts.count(ptxConflicting->GetHash()))\n-            {\n+            if (setConflicts.count(ptxConflicting->GetHash()))\n+                continue;\n+\n+            if (nRbfPolicy > 1) {\n                 // Allow opt-out of transaction replacement by setting\n                 // nSequence >= maxint-1 on all inputs.\n                 //\n@@ -864,9 +870,9 @@ bool AcceptToMemoryPool(CTxMemPool& pool, CValidationState &state, const CTransa\n                 }\n                 if (fReplacementOptOut)\n                     return state.Invalid(false, REJECT_CONFLICT, \"txn-mempool-conflict\");\n-\n-                setConflicts.insert(ptxConflicting->GetHash());\n             }\n+\n+            setConflicts.insert(ptxConflicting->GetHash());\n         }\n     }\n     }"
      },
      {
        "sha": "afb1511f85d8871a8fc595d0a7acc62e898d29b9",
        "filename": "src/policy/policy.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/786f92d420650ee2918c482a31f44e1bd9326574/src/policy/policy.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/786f92d420650ee2918c482a31f44e1bd9326574/src/policy/policy.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/policy/policy.cpp?ref=786f92d420650ee2918c482a31f44e1bd9326574",
        "patch": "@@ -14,6 +14,9 @@\n \n #include <boost/foreach.hpp>\n \n+/** Default for -replacebyfee, which controls replace-by-fee policy */\n+unsigned int nRbfPolicy = 2;\n+\n     /**\n      * Check transaction inputs to mitigate two\n      * potential denial-of-service attacks:"
      },
      {
        "sha": "54216e1bd9705a5c15aed3968e4d60a409ef290f",
        "filename": "src/policy/policy.h",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/786f92d420650ee2918c482a31f44e1bd9326574/src/policy/policy.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/786f92d420650ee2918c482a31f44e1bd9326574/src/policy/policy.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/policy/policy.h?ref=786f92d420650ee2918c482a31f44e1bd9326574",
        "patch": "@@ -14,6 +14,8 @@\n \n class CCoinsViewCache;\n \n+extern unsigned int nRbfPolicy;\n+\n /** Default for -blockmaxsize and -blockminsize, which control the range of sizes the mining code will create **/\n static const unsigned int DEFAULT_BLOCK_MAX_SIZE = 750000;\n static const unsigned int DEFAULT_BLOCK_MIN_SIZE = 0;"
      }
    ]
  }
]