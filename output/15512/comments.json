[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/469630268",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#issuecomment-469630268",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/15512",
    "id": 469630268,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2OTYzMDI2OA==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-05T10:36:13Z",
    "updated_at": "2019-03-27T17:37:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#15649](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15649.html) (Add ChaCha20Poly1305@Bitcoin AEAD by jonasschnelli)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/469630268/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/489238698",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#issuecomment-489238698",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/15512",
    "id": 489238698,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4OTIzODY5OA==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-03T21:01:44Z",
    "updated_at": "2019-05-03T21:01:44Z",
    "author_association": "MEMBER",
    "body": "Looks good. utACK 2dfe2751713c814aea53b5a7563eb74ad1baea00.\r\n\r\nIn general, it's better to have less code duplication, so I'd like to hear from @sipa his reasoning for https://github.com/bitcoin/bitcoin/pull/15512#discussion_r269692281",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/489238698/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/489240638",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#issuecomment-489240638",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/15512",
    "id": 489240638,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4OTI0MDYzOA==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-03T21:09:20Z",
    "updated_at": "2019-05-03T21:09:20Z",
    "author_association": "MEMBER",
    "body": "@jnewbery I just thought that it'd be preferable not to burden the RNG code with branches that are only used for encryption. In cryptographic code like this, I don't care too much about duplication, as it isn't code that subject to many possible future changes.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/489240638/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/489644210",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#issuecomment-489644210",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/15512",
    "id": 489644210,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4OTY0NDIxMA==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-06T14:36:26Z",
    "updated_at": "2019-05-06T14:36:26Z",
    "author_association": "MEMBER",
    "body": "ok, my aesthetic preference is for less duplication, either by having a single Keystream/Crypt function, or by calling Keystream() from Crypt() with a zero'ed message. As sipa points out though, this code is unlikely to be modified much in future, so it's not a big deal either way.\r\n\r\nutACK 2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/489644210/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/491113087",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#issuecomment-491113087",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/15512",
    "id": 491113087,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5MTExMzA4Nw==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-10T00:33:07Z",
    "updated_at": "2019-05-10T00:33:07Z",
    "author_association": "MEMBER",
    "body": "utACK 2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/491113087/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268286916",
    "pull_request_review_id": 217907518,
    "id": 268286916,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODI4NjkxNg==",
    "diff_hunk": "@@ -100,6 +102,10 @@ void ChaCha20::Output(unsigned char* c, size_t bytes)\n \n     for (;;) {\n         if (bytes < 64) {\n+            if (m != nullptr) {\n+                for (i = 0;i < bytes;++i) tmp[i] = m[i];",
    "path": "src/crypto/chacha20.cpp",
    "position": null,
    "original_position": 23,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "b05bb64dc624c45bf340490db06346cefdbff48a",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "A comment would be helpful here: \"If m has fewer than 64 bytes available, copy m to tmp and read from tmp instead\"",
    "created_at": "2019-03-22T18:17:37Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268286916",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268286916"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268286916"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268286916/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 106,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268287371",
    "pull_request_review_id": 217907518,
    "id": 268287371,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODI4NzM3MQ==",
    "diff_hunk": "@@ -100,6 +102,10 @@ void ChaCha20::Output(unsigned char* c, size_t bytes)\n \n     for (;;) {\n         if (bytes < 64) {\n+            if (m != nullptr) {\n+                for (i = 0;i < bytes;++i) tmp[i] = m[i];",
    "path": "src/crypto/chacha20.cpp",
    "position": null,
    "original_position": 23,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "b05bb64dc624c45bf340490db06346cefdbff48a",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Just `memcpy(tmp, m, bytes)` might be simpler and easy to read than this for loop.",
    "created_at": "2019-03-22T18:18:51Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268287371",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268287371"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268287371"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268287371/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 106,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268287967",
    "pull_request_review_id": 217907518,
    "id": 268287967,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODI4Nzk2Nw==",
    "diff_hunk": "@@ -146,6 +152,25 @@ void ChaCha20::Output(unsigned char* c, size_t bytes)\n         x14 += j14;\n         x15 += j15;\n \n+        if (m != nullptr) {\n+            x0 = XOR(x0, ReadLE32(m + 0));",
    "path": "src/crypto/chacha20.cpp",
    "position": null,
    "original_position": 34,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "b05bb64dc624c45bf340490db06346cefdbff48a",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Not sure what the benefit of defining XOR macro is. Isn't `x0 ^= ReadLE32(m + 0)` more readable and less error-prone than `x0 = XOR(x0, ReadLE32(m + 0))`?",
    "created_at": "2019-03-22T18:20:25Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268287967",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268287967"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268287967"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268287967/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 156,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268289944",
    "pull_request_review_id": 217907518,
    "id": 268289944,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODI4OTk0NA==",
    "diff_hunk": "@@ -20,7 +20,9 @@ class ChaCha20\n     void SetKey(const unsigned char* key, size_t keylen);\n     void SetIV(uint64_t iv);\n     void Seek(uint64_t pos);\n-    void Output(unsigned char* output, size_t bytes);\n+\n+    // if <input> is provided, the ciphertext will be written to <output> otherwise the current keystream",
    "path": "src/crypto/chacha20.h",
    "position": null,
    "original_position": 6,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "b05bb64dc624c45bf340490db06346cefdbff48a",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This comment seems imply that output is not written if input is null. Maybe rephrase: \"If \\<input> is non-null, the specified number of \\<bytes> from \\<input> will encrypted and written to \\<output>, otherwise just the keystream will be written to \\<output\\> (which may be useful for random number generation). Either way, the number of bytes written to \\<output> will be \\<bytes>.\"",
    "created_at": "2019-03-22T18:25:42Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268289944",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268289944"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268289944"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268289944/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 24,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268293664",
    "pull_request_review_id": 217907518,
    "id": 268293664,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODI5MzY2NA==",
    "diff_hunk": "@@ -187,16 +187,19 @@ static void TestAES256CBC(const std::string &hexkey, const std::string &hexiv, b\n     }\n }\n \n-static void TestChaCha20(const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n+static void TestChaCha20(const std::string &hex_message, const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n {\n     std::vector<unsigned char> key = ParseHex(hexkey);\n+    std::vector<unsigned char> m = ParseHex(hex_message);\n     ChaCha20 rng(key.data(), key.size());\n     rng.SetIV(nonce);\n     rng.Seek(seek);\n     std::vector<unsigned char> out = ParseHex(hexout);\n     std::vector<unsigned char> outres;\n     outres.resize(out.size());\n-    rng.Output(outres.data(), outres.size());\n+",
    "path": "src/test/crypto_tests.cpp",
    "position": 17,
    "original_position": 16,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "4325da919a042dfb4eed87b6d038dbb236959e5b",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Maybe `assert(hex_message.empty() || m.size() == out.size())`",
    "created_at": "2019-03-22T18:36:40Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268293664",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268293664"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268293664"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268293664/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 201,
    "original_line": 201,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268298310",
    "pull_request_review_id": 217907518,
    "id": 268298310,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODI5ODMxMA==",
    "diff_hunk": "@@ -187,16 +187,19 @@ static void TestAES256CBC(const std::string &hexkey, const std::string &hexiv, b\n     }\n }\n \n-static void TestChaCha20(const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n+static void TestChaCha20(const std::string &hex_message, const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n {\n     std::vector<unsigned char> key = ParseHex(hexkey);\n+    std::vector<unsigned char> m = ParseHex(hex_message);\n     ChaCha20 rng(key.data(), key.size());\n     rng.SetIV(nonce);\n     rng.Seek(seek);\n     std::vector<unsigned char> out = ParseHex(hexout);\n     std::vector<unsigned char> outres;\n     outres.resize(out.size());\n-    rng.Output(outres.data(), outres.size());\n+\n+    // perform the ChaCha20 round(s), if message is provided it will output the encrypted ciphertext otherwise the keystream\n+    rng.Output(hex_message.empty() ? nullptr : m.data(), outres.data(), outres.size());",
    "path": "src/test/crypto_tests.cpp",
    "position": null,
    "original_position": 18,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "4325da919a042dfb4eed87b6d038dbb236959e5b",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It seems like a useful additional test would be call `rng.Output` twice if `hex_message` is nonempty, once with input and once without, and confirm that xoring the two outputs yields the input again.",
    "created_at": "2019-03-22T18:50:31Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268298310",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268298310"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268298310"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268298310/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 203,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268828344",
    "pull_request_review_id": 218556895,
    "id": 268828344,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODgyODM0NA==",
    "diff_hunk": "@@ -100,6 +102,10 @@ void ChaCha20::Output(unsigned char* c, size_t bytes)\n \n     for (;;) {\n         if (bytes < 64) {\n+            if (m != nullptr) {\n+                for (i = 0;i < bytes;++i) tmp[i] = m[i];",
    "path": "src/crypto/chacha20.cpp",
    "position": null,
    "original_position": 23,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "b05bb64dc624c45bf340490db06346cefdbff48a",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I'm not to familiar with compiler optimisations and stuff but I just checked the reference implementation by DJB and some other C based ChaCha implementations and all of them seems to use the byte per byte assignment. I prefer to leave it as it is.",
    "created_at": "2019-03-25T20:07:20Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268828344",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268828344"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268828344"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268828344/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 106,
    "side": "RIGHT",
    "in_reply_to_id": 268287371
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842266",
    "pull_request_review_id": 218574212,
    "id": 268842266,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODg0MjI2Ng==",
    "diff_hunk": "@@ -187,16 +187,19 @@ static void TestAES256CBC(const std::string &hexkey, const std::string &hexiv, b\n     }\n }\n \n-static void TestChaCha20(const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n+static void TestChaCha20(const std::string &hex_message, const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n {\n     std::vector<unsigned char> key = ParseHex(hexkey);\n+    std::vector<unsigned char> m = ParseHex(hex_message);\n     ChaCha20 rng(key.data(), key.size());\n     rng.SetIV(nonce);\n     rng.Seek(seek);\n     std::vector<unsigned char> out = ParseHex(hexout);\n     std::vector<unsigned char> outres;\n     outres.resize(out.size());\n-    rng.Output(outres.data(), outres.size());\n+\n+    // perform the ChaCha20 round(s), if message is provided it will output the encrypted ciphertext otherwise the keystream\n+    rng.Output(hex_message.empty() ? nullptr : m.data(), outres.data(), outres.size());",
    "path": "src/test/crypto_tests.cpp",
    "position": null,
    "original_position": 18,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "4325da919a042dfb4eed87b6d038dbb236959e5b",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Good point. Added.",
    "created_at": "2019-03-25T20:43:11Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268842266",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842266"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268842266"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842266/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 203,
    "side": "RIGHT",
    "in_reply_to_id": 268298310
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842309",
    "pull_request_review_id": 218574257,
    "id": 268842309,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODg0MjMwOQ==",
    "diff_hunk": "@@ -187,16 +187,19 @@ static void TestAES256CBC(const std::string &hexkey, const std::string &hexiv, b\n     }\n }\n \n-static void TestChaCha20(const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n+static void TestChaCha20(const std::string &hex_message, const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n {\n     std::vector<unsigned char> key = ParseHex(hexkey);\n+    std::vector<unsigned char> m = ParseHex(hex_message);\n     ChaCha20 rng(key.data(), key.size());\n     rng.SetIV(nonce);\n     rng.Seek(seek);\n     std::vector<unsigned char> out = ParseHex(hexout);\n     std::vector<unsigned char> outres;\n     outres.resize(out.size());\n-    rng.Output(outres.data(), outres.size());\n+",
    "path": "src/test/crypto_tests.cpp",
    "position": 17,
    "original_position": 16,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "4325da919a042dfb4eed87b6d038dbb236959e5b",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Added.",
    "created_at": "2019-03-25T20:43:18Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268842309",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842309"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268842309"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842309/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 201,
    "original_line": 201,
    "side": "RIGHT",
    "in_reply_to_id": 268293664
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842397",
    "pull_request_review_id": 218574379,
    "id": 268842397,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODg0MjM5Nw==",
    "diff_hunk": "@@ -20,7 +20,9 @@ class ChaCha20\n     void SetKey(const unsigned char* key, size_t keylen);\n     void SetIV(uint64_t iv);\n     void Seek(uint64_t pos);\n-    void Output(unsigned char* output, size_t bytes);\n+\n+    // if <input> is provided, the ciphertext will be written to <output> otherwise the current keystream",
    "path": "src/crypto/chacha20.h",
    "position": null,
    "original_position": 6,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "b05bb64dc624c45bf340490db06346cefdbff48a",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Valid point. Fixed.",
    "created_at": "2019-03-25T20:43:32Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268842397",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842397"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268842397"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842397/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 24,
    "side": "RIGHT",
    "in_reply_to_id": 268289944
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842508",
    "pull_request_review_id": 218574552,
    "id": 268842508,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODg0MjUwOA==",
    "diff_hunk": "@@ -100,6 +102,10 @@ void ChaCha20::Output(unsigned char* c, size_t bytes)\n \n     for (;;) {\n         if (bytes < 64) {\n+            if (m != nullptr) {\n+                for (i = 0;i < bytes;++i) tmp[i] = m[i];",
    "path": "src/crypto/chacha20.cpp",
    "position": null,
    "original_position": 23,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "b05bb64dc624c45bf340490db06346cefdbff48a",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Added.",
    "created_at": "2019-03-25T20:43:55Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268842508",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842508"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268842508"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842508/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 106,
    "side": "RIGHT",
    "in_reply_to_id": 268286916
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842649",
    "pull_request_review_id": 218574714,
    "id": 268842649,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2ODg0MjY0OQ==",
    "diff_hunk": "@@ -146,6 +152,25 @@ void ChaCha20::Output(unsigned char* c, size_t bytes)\n         x14 += j14;\n         x15 += j15;\n \n+        if (m != nullptr) {\n+            x0 = XOR(x0, ReadLE32(m + 0));",
    "path": "src/crypto/chacha20.cpp",
    "position": null,
    "original_position": 34,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "b05bb64dc624c45bf340490db06346cefdbff48a",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Thanks for the review! Your right. Changed.",
    "created_at": "2019-03-25T20:44:14Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268842649",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842649"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r268842649"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/268842649/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 156,
    "side": "RIGHT",
    "in_reply_to_id": 268287967
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/269692281",
    "pull_request_review_id": 219628168,
    "id": 269692281,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI2OTY5MjI4MQ==",
    "diff_hunk": "@@ -71,7 +71,7 @@ void ChaCha20::Seek(uint64_t pos)\n     input[13] = pos >> 32;\n }\n \n-void ChaCha20::Output(unsigned char* c, size_t bytes)\n+void ChaCha20::Output(const unsigned char* m, unsigned char* c, size_t bytes)",
    "path": "src/crypto/chacha20.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "9d3ea6a77693f366c57d6f706665eb989deafb9c",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think it would be better to duplicate the logic here and turn the stream cipher version into a separate function.\r\n\r\nAs is, it introduces an unnecessary branch in the output version.",
    "created_at": "2019-03-27T17:48:22Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r269692281",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/269692281"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r269692281"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/269692281/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 74,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270180420",
    "pull_request_review_id": 220249493,
    "id": 270180420,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MDE4MDQyMA==",
    "diff_hunk": "@@ -71,7 +71,7 @@ void ChaCha20::Seek(uint64_t pos)\n     input[13] = pos >> 32;\n }\n \n-void ChaCha20::Output(unsigned char* c, size_t bytes)\n+void ChaCha20::Output(const unsigned char* m, unsigned char* c, size_t bytes)",
    "path": "src/crypto/chacha20.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "9d3ea6a77693f366c57d6f706665eb989deafb9c",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Good point. Adapted the duplication approach.",
    "created_at": "2019-03-28T20:12:49Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r270180420",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270180420"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r270180420"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270180420/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 74,
    "side": "RIGHT",
    "in_reply_to_id": 269692281
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270206310",
    "pull_request_review_id": 220283487,
    "id": 270206310,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MDIwNjMxMA==",
    "diff_hunk": "@@ -178,3 +178,135 @@ void ChaCha20::Output(unsigned char* c, size_t bytes)\n         c += 64;\n     }\n }\n+\n+void ChaCha20::Crypt(const unsigned char* m, unsigned char* c, size_t bytes)\n+{\n+    uint32_t x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14, x15;\n+    uint32_t j0, j1, j2, j3, j4, j5, j6, j7, j8, j9, j10, j11, j12, j13, j14, j15;\n+    unsigned char *ctarget = nullptr;\n+    unsigned char tmp[64];\n+    unsigned int i;\n+\n+    if (!bytes) return;\n+\n+    j0 = input[0];\n+    j1 = input[1];\n+    j2 = input[2];\n+    j3 = input[3];\n+    j4 = input[4];\n+    j5 = input[5];\n+    j6 = input[6];\n+    j7 = input[7];\n+    j8 = input[8];\n+    j9 = input[9];\n+    j10 = input[10];\n+    j11 = input[11];\n+    j12 = input[12];\n+    j13 = input[13];\n+    j14 = input[14];\n+    j15 = input[15];\n+\n+    for (;;) {\n+        if (bytes < 64) {\n+            // if m has fewer than 64 bytes available, copy m to tmp and\n+            // read from tmp instead\n+            for (i = 0;i < bytes;++i) tmp[i] = m[i];\n+            m = tmp;\n+            ctarget = c;\n+            c = tmp;\n+        }\n+        x0 = j0;\n+        x1 = j1;\n+        x2 = j2;\n+        x3 = j3;\n+        x4 = j4;\n+        x5 = j5;\n+        x6 = j6;\n+        x7 = j7;\n+        x8 = j8;\n+        x9 = j9;\n+        x10 = j10;\n+        x11 = j11;\n+        x12 = j12;\n+        x13 = j13;\n+        x14 = j14;\n+        x15 = j15;\n+        for (i = 20;i > 0;i -= 2) {\n+            QUARTERROUND( x0, x4, x8,x12)\n+            QUARTERROUND( x1, x5, x9,x13)\n+            QUARTERROUND( x2, x6,x10,x14)\n+            QUARTERROUND( x3, x7,x11,x15)\n+            QUARTERROUND( x0, x5,x10,x15)\n+            QUARTERROUND( x1, x6,x11,x12)\n+            QUARTERROUND( x2, x7, x8,x13)\n+            QUARTERROUND( x3, x4, x9,x14)\n+        }\n+        x0 += j0;\n+        x1 += j1;\n+        x2 += j2;\n+        x3 += j3;\n+        x4 += j4;\n+        x5 += j5;\n+        x6 += j6;\n+        x7 += j7;\n+        x8 += j8;\n+        x9 += j9;\n+        x10 += j10;\n+        x11 += j11;\n+        x12 += j12;\n+        x13 += j13;\n+        x14 += j14;\n+        x15 += j15;\n+\n+        if (m != nullptr) {",
    "path": "src/crypto/chacha20.cpp",
    "position": null,
    "original_position": 84,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "7f2028f04cd51c944046cf0b664bdd308dcdb397",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "No need for this `if`.",
    "created_at": "2019-03-28T21:28:46Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r270206310",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270206310"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r270206310"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270206310/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 261,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270323780",
    "pull_request_review_id": 220429735,
    "id": 270323780,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI3MDMyMzc4MA==",
    "diff_hunk": "@@ -178,3 +178,135 @@ void ChaCha20::Output(unsigned char* c, size_t bytes)\n         c += 64;\n     }\n }\n+\n+void ChaCha20::Crypt(const unsigned char* m, unsigned char* c, size_t bytes)\n+{\n+    uint32_t x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14, x15;\n+    uint32_t j0, j1, j2, j3, j4, j5, j6, j7, j8, j9, j10, j11, j12, j13, j14, j15;\n+    unsigned char *ctarget = nullptr;\n+    unsigned char tmp[64];\n+    unsigned int i;\n+\n+    if (!bytes) return;\n+\n+    j0 = input[0];\n+    j1 = input[1];\n+    j2 = input[2];\n+    j3 = input[3];\n+    j4 = input[4];\n+    j5 = input[5];\n+    j6 = input[6];\n+    j7 = input[7];\n+    j8 = input[8];\n+    j9 = input[9];\n+    j10 = input[10];\n+    j11 = input[11];\n+    j12 = input[12];\n+    j13 = input[13];\n+    j14 = input[14];\n+    j15 = input[15];\n+\n+    for (;;) {\n+        if (bytes < 64) {\n+            // if m has fewer than 64 bytes available, copy m to tmp and\n+            // read from tmp instead\n+            for (i = 0;i < bytes;++i) tmp[i] = m[i];\n+            m = tmp;\n+            ctarget = c;\n+            c = tmp;\n+        }\n+        x0 = j0;\n+        x1 = j1;\n+        x2 = j2;\n+        x3 = j3;\n+        x4 = j4;\n+        x5 = j5;\n+        x6 = j6;\n+        x7 = j7;\n+        x8 = j8;\n+        x9 = j9;\n+        x10 = j10;\n+        x11 = j11;\n+        x12 = j12;\n+        x13 = j13;\n+        x14 = j14;\n+        x15 = j15;\n+        for (i = 20;i > 0;i -= 2) {\n+            QUARTERROUND( x0, x4, x8,x12)\n+            QUARTERROUND( x1, x5, x9,x13)\n+            QUARTERROUND( x2, x6,x10,x14)\n+            QUARTERROUND( x3, x7,x11,x15)\n+            QUARTERROUND( x0, x5,x10,x15)\n+            QUARTERROUND( x1, x6,x11,x12)\n+            QUARTERROUND( x2, x7, x8,x13)\n+            QUARTERROUND( x3, x4, x9,x14)\n+        }\n+        x0 += j0;\n+        x1 += j1;\n+        x2 += j2;\n+        x3 += j3;\n+        x4 += j4;\n+        x5 += j5;\n+        x6 += j6;\n+        x7 += j7;\n+        x8 += j8;\n+        x9 += j9;\n+        x10 += j10;\n+        x11 += j11;\n+        x12 += j12;\n+        x13 += j13;\n+        x14 += j14;\n+        x15 += j15;\n+\n+        if (m != nullptr) {",
    "path": "src/crypto/chacha20.cpp",
    "position": null,
    "original_position": 84,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "7f2028f04cd51c944046cf0b664bdd308dcdb397",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes. Fixed.",
    "created_at": "2019-03-29T08:58:14Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r270323780",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270323780"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r270323780"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/270323780/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 261,
    "side": "RIGHT",
    "in_reply_to_id": 270206310
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280833386",
    "pull_request_review_id": 233547118,
    "id": 280833386,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDgzMzM4Ng==",
    "diff_hunk": "@@ -71,7 +71,7 @@ void ChaCha20::Seek(uint64_t pos)\n     input[13] = pos >> 32;\n }\n \n-void ChaCha20::Output(unsigned char* c, size_t bytes)\n+void ChaCha20::Output(const unsigned char* m, unsigned char* c, size_t bytes)",
    "path": "src/crypto/chacha20.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "9d3ea6a77693f366c57d6f706665eb989deafb9c",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "What's the reasoning here? Performance?\r\n\r\nHow does the version in the refrence implementation compare?\r\n\r\n```c\r\nvoid ECRYPT_keystream_bytes(ECRYPT_ctx *x,u8 *stream,u32 bytes)\r\n{\r\n  u32 i;\r\n  for (i = 0;i < bytes;++i) stream[i] = 0;\r\n  ECRYPT_encrypt_bytes(x,stream,stream,bytes);\r\n}\r\n```\r\n\r\nie setting `Output(c, bytes)` to call `Crypt(c, c, bytes)`?",
    "created_at": "2019-05-03T15:58:14Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280833386",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280833386"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280833386"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280833386/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 74,
    "side": "RIGHT",
    "in_reply_to_id": 269692281
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280833698",
    "pull_request_review_id": 233547521,
    "id": 280833698,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDgzMzY5OA==",
    "diff_hunk": "@@ -20,7 +20,9 @@ class ChaCha20\n     void SetKey(const unsigned char* key, size_t keylen);\n     void SetIV(uint64_t iv);\n     void Seek(uint64_t pos);\n-    void Output(unsigned char* output, size_t bytes);\n+",
    "path": "src/crypto/chacha20.h",
    "position": 21,
    "original_position": 5,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "427b49dcdbfb25153ee4228dda49aa07db16d59c",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: why the extra newline?",
    "created_at": "2019-05-03T15:59:08Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280833698",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280833698"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280833698"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280833698/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 24,
    "original_line": 24,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280834907",
    "pull_request_review_id": 233547521,
    "id": 280834907,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDgzNDkwNw==",
    "diff_hunk": "@@ -20,7 +20,9 @@ class ChaCha20\n     void SetKey(const unsigned char* key, size_t keylen);\n     void SetIV(uint64_t iv);\n     void Seek(uint64_t pos);\n-    void Output(unsigned char* output, size_t bytes);\n+\n+    void Output(unsigned char* c, size_t bytes);\n+    void Crypt(const unsigned char* input, unsigned char* output, size_t bytes);",
    "path": "src/crypto/chacha20.h",
    "position": 28,
    "original_position": 7,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "427b49dcdbfb25153ee4228dda49aa07db16d59c",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Now that this class can encrypt plaintext, the class comment should be updated from \"A PRNG class for ChaCha20.\"\r\n\r\nReally, I'd like to see more commenting for this class in general (ie note that `SetIV` sets the nonce, `Seek` sets the counter, that the counter is 64 bytes and the nonce is 64 bytes as in the original ChaCha20 spec instead of 32 byte counter/96 byte nonce as in the IETF spec).\r\n\r\n(there are a couple of good resources on the different counter/nonce sizes here: https://libsodium.gitbook.io/doc/advanced/stream_ciphers/chacha20 and here: http://loup-vaillant.fr/tutorials/chacha20-design)",
    "created_at": "2019-05-03T16:02:53Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280834907",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280834907"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280834907"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280834907/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 31,
    "original_line": 31,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280836054",
    "pull_request_review_id": 233547521,
    "id": 280836054,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDgzNjA1NA==",
    "diff_hunk": "@@ -20,7 +20,9 @@ class ChaCha20\n     void SetKey(const unsigned char* key, size_t keylen);\n     void SetIV(uint64_t iv);\n     void Seek(uint64_t pos);\n-    void Output(unsigned char* output, size_t bytes);\n+\n+    void Output(unsigned char* c, size_t bytes);",
    "path": "src/crypto/chacha20.h",
    "position": null,
    "original_position": 6,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "427b49dcdbfb25153ee4228dda49aa07db16d59c",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: This function should be renamed `Keystream` now that the class is not just used for PRNG",
    "created_at": "2019-05-03T16:06:32Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280836054",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280836054"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280836054"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280836054/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 24,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280836767",
    "pull_request_review_id": 233547521,
    "id": 280836767,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDgzNjc2Nw==",
    "diff_hunk": "@@ -187,17 +187,36 @@ static void TestAES256CBC(const std::string &hexkey, const std::string &hexiv, b\n     }\n }\n \n-static void TestChaCha20(const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n+static void TestChaCha20(const std::string &hex_message, const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n {\n     std::vector<unsigned char> key = ParseHex(hexkey);\n+    std::vector<unsigned char> m = ParseHex(hex_message);\n     ChaCha20 rng(key.data(), key.size());\n     rng.SetIV(nonce);\n     rng.Seek(seek);\n     std::vector<unsigned char> out = ParseHex(hexout);\n     std::vector<unsigned char> outres;\n     outres.resize(out.size());\n-    rng.Output(outres.data(), outres.size());\n+    assert(hex_message.empty() || m.size() == out.size());\n+\n+    // perform the ChaCha20 round(s), if message is provided it will output the encrypted ciphertext otherwise the keystream\n+    if (!hex_message.empty()) {\n+        rng.Crypt(m.data(), outres.data(), outres.size());\n+    } else {\n+        rng.Output(outres.data(), outres.size());\n+    }\n     BOOST_CHECK(out == outres);\n+    if (!hex_message.empty()) {",
    "path": "src/test/crypto_tests.cpp",
    "position": 25,
    "original_position": 25,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "427b49dcdbfb25153ee4228dda49aa07db16d59c",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This test seems redundant to me. How could it ever fail if the test above succeeds?",
    "created_at": "2019-05-03T16:08:56Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280836767",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280836767"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280836767"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280836767/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 209,
    "original_line": 209,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280853494",
    "pull_request_review_id": 233573706,
    "id": 280853494,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDg1MzQ5NA==",
    "diff_hunk": "@@ -187,17 +187,36 @@ static void TestAES256CBC(const std::string &hexkey, const std::string &hexiv, b\n     }\n }\n \n-static void TestChaCha20(const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n+static void TestChaCha20(const std::string &hex_message, const std::string &hexkey, uint64_t nonce, uint64_t seek, const std::string& hexout)\n {\n     std::vector<unsigned char> key = ParseHex(hexkey);\n+    std::vector<unsigned char> m = ParseHex(hex_message);\n     ChaCha20 rng(key.data(), key.size());\n     rng.SetIV(nonce);\n     rng.Seek(seek);\n     std::vector<unsigned char> out = ParseHex(hexout);\n     std::vector<unsigned char> outres;\n     outres.resize(out.size());\n-    rng.Output(outres.data(), outres.size());\n+    assert(hex_message.empty() || m.size() == out.size());\n+\n+    // perform the ChaCha20 round(s), if message is provided it will output the encrypted ciphertext otherwise the keystream\n+    if (!hex_message.empty()) {\n+        rng.Crypt(m.data(), outres.data(), outres.size());\n+    } else {\n+        rng.Output(outres.data(), outres.size());\n+    }\n     BOOST_CHECK(out == outres);\n+    if (!hex_message.empty()) {",
    "path": "src/test/crypto_tests.cpp",
    "position": 25,
    "original_position": 25,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "427b49dcdbfb25153ee4228dda49aa07db16d59c",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "re: https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280836767\r\n\r\nNot sure exactly what you want to get rid of, but if you're talking about the `out == outres` check below, I suggested it and think it'd be better to keep, because it means if the test passes you can be reassured that Crypt() and Output() results are consistent without manually verifying `4c616 ^ 6e2e3 == 224f5`... in the test cases.",
    "created_at": "2019-05-03T17:03:02Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280853494",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280853494"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280853494"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280853494/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 209,
    "original_line": 209,
    "side": "RIGHT",
    "in_reply_to_id": 280836767
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280881759",
    "pull_request_review_id": 233610331,
    "id": 280881759,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDg4MTc1OQ==",
    "diff_hunk": "@@ -20,7 +20,9 @@ class ChaCha20\n     void SetKey(const unsigned char* key, size_t keylen);\n     void SetIV(uint64_t iv);\n     void Seek(uint64_t pos);\n-    void Output(unsigned char* output, size_t bytes);\n+\n+    void Output(unsigned char* c, size_t bytes);",
    "path": "src/crypto/chacha20.h",
    "position": null,
    "original_position": 6,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "427b49dcdbfb25153ee4228dda49aa07db16d59c",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Renamed to `Keystream`",
    "created_at": "2019-05-03T18:27:22Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280881759",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280881759"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280881759"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280881759/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 24,
    "side": "RIGHT",
    "in_reply_to_id": 280836054
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280883499",
    "pull_request_review_id": 233612626,
    "id": 280883499,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDg4MzQ5OQ==",
    "diff_hunk": "@@ -20,7 +20,9 @@ class ChaCha20\n     void SetKey(const unsigned char* key, size_t keylen);\n     void SetIV(uint64_t iv);\n     void Seek(uint64_t pos);\n-    void Output(unsigned char* output, size_t bytes);\n+\n+    void Output(unsigned char* c, size_t bytes);\n+    void Crypt(const unsigned char* input, unsigned char* output, size_t bytes);",
    "path": "src/crypto/chacha20.h",
    "position": 28,
    "original_position": 7,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "427b49dcdbfb25153ee4228dda49aa07db16d59c",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The IETF has a slightly modified recommendation AFAIK.\r\nWe use Bernstein-Vanilly 64bit nonce and 64bit block counter.\r\n\r\n* Changed the class comment\r\n* Added some function comments",
    "created_at": "2019-05-03T18:32:33Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280883499",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280883499"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280883499"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280883499/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 31,
    "original_line": 31,
    "side": "RIGHT",
    "in_reply_to_id": 280834907
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280897800",
    "pull_request_review_id": 233630987,
    "id": 280897800,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDg5NzgwMA==",
    "diff_hunk": "@@ -0,0 +1,72 @@\n+// Copyright (c) 2019 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <iostream>\n+\n+#include <bench/bench.h>\n+#include <hash.h>\n+#include <crypto/chacha20.h>\n+\n+/* Number of bytes to process per iteration */\n+static const uint64_t BUFFER_SIZE_TINY  = 64;\n+static const uint64_t BUFFER_SIZE_SMALL = 256;\n+static const uint64_t BUFFER_SIZE_LARGE = 1024*1024;\n+\n+static void CHACHA20(benchmark::State& state, size_t buffersize)\n+{\n+    std::vector<uint8_t> key(32,0);\n+    ChaCha20 ctx(key.data(), key.size());\n+    ctx.SetIV(0);\n+    ctx.Seek(0);\n+    std::vector<uint8_t> in(buffersize,0);\n+    std::vector<uint8_t> out(buffersize,0);\n+    while (state.KeepRunning())\n+        ctx.Crypt(in.data(), out.data(), in.size());",
    "path": "src/bench/chacha20.cpp",
    "position": 25,
    "original_position": 25,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "66d682bfc3c5d31a84c26d344cbc19897bb26a87",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "micronit: same line or braces for while code block please! Same for while block in `HASH()` below.",
    "created_at": "2019-05-03T19:17:26Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280897800",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280897800"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280897800"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280897800/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 25,
    "original_line": 25,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280897984",
    "pull_request_review_id": 233630987,
    "id": 280897984,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDg5Nzk4NA==",
    "diff_hunk": "@@ -0,0 +1,72 @@\n+// Copyright (c) 2019 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <iostream>\n+\n+#include <bench/bench.h>\n+#include <hash.h>\n+#include <crypto/chacha20.h>\n+\n+/* Number of bytes to process per iteration */\n+static const uint64_t BUFFER_SIZE_TINY  = 64;\n+static const uint64_t BUFFER_SIZE_SMALL = 256;\n+static const uint64_t BUFFER_SIZE_LARGE = 1024*1024;\n+\n+static void CHACHA20(benchmark::State& state, size_t buffersize)\n+{\n+    std::vector<uint8_t> key(32,0);\n+    ChaCha20 ctx(key.data(), key.size());\n+    ctx.SetIV(0);\n+    ctx.Seek(0);\n+    std::vector<uint8_t> in(buffersize,0);\n+    std::vector<uint8_t> out(buffersize,0);\n+    while (state.KeepRunning())\n+        ctx.Crypt(in.data(), out.data(), in.size());\n+}\n+\n+static void HASH(benchmark::State& state, size_t buffersize)",
    "path": "src/bench/chacha20.cpp",
    "position": null,
    "original_position": 28,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "66d682bfc3c5d31a84c26d344cbc19897bb26a87",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Is a reason you've added these `CHash256` benchmarks to chacha20.cpp?",
    "created_at": "2019-05-03T19:18:10Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280897984",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280897984"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280897984"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280897984/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 28,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280922853",
    "pull_request_review_id": 233663959,
    "id": 280922853,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDkyMjg1Mw==",
    "diff_hunk": "@@ -0,0 +1,72 @@\n+// Copyright (c) 2019 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <iostream>\n+\n+#include <bench/bench.h>\n+#include <hash.h>\n+#include <crypto/chacha20.h>\n+\n+/* Number of bytes to process per iteration */\n+static const uint64_t BUFFER_SIZE_TINY  = 64;\n+static const uint64_t BUFFER_SIZE_SMALL = 256;\n+static const uint64_t BUFFER_SIZE_LARGE = 1024*1024;\n+\n+static void CHACHA20(benchmark::State& state, size_t buffersize)\n+{\n+    std::vector<uint8_t> key(32,0);\n+    ChaCha20 ctx(key.data(), key.size());\n+    ctx.SetIV(0);\n+    ctx.Seek(0);\n+    std::vector<uint8_t> in(buffersize,0);\n+    std::vector<uint8_t> out(buffersize,0);\n+    while (state.KeepRunning())\n+        ctx.Crypt(in.data(), out.data(), in.size());\n+}\n+\n+static void HASH(benchmark::State& state, size_t buffersize)",
    "path": "src/bench/chacha20.cpp",
    "position": null,
    "original_position": 28,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "66d682bfc3c5d31a84c26d344cbc19897bb26a87",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I added if for comparison and the impact on the networking... though I think it belong to an extra commit in https://github.com/bitcoin/bitcoin/pull/15649\r\nWill remove it from here.",
    "created_at": "2019-05-03T20:43:27Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280922853",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280922853"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280922853"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280922853/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 28,
    "side": "RIGHT",
    "in_reply_to_id": 280897984
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280923476",
    "pull_request_review_id": 233664806,
    "id": 280923476,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDkyMzQ3Ng==",
    "diff_hunk": "@@ -71,7 +71,7 @@ void ChaCha20::Seek(uint64_t pos)\n     input[13] = pos >> 32;\n }\n \n-void ChaCha20::Output(unsigned char* c, size_t bytes)\n+void ChaCha20::Output(const unsigned char* m, unsigned char* c, size_t bytes)",
    "path": "src/crypto/chacha20.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "9d3ea6a77693f366c57d6f706665eb989deafb9c",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I had it in the initial version like @jnewbery just proposed.\r\nAfter @sipa recommended to separate it, I thought that a strict separation may be beneficial for verification and later optimizations. But maybe @sipa can clarify...",
    "created_at": "2019-05-03T20:45:30Z",
    "updated_at": "2019-05-03T20:53:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280923476",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280923476"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280923476"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280923476/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 74,
    "side": "RIGHT",
    "in_reply_to_id": 269692281
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280925547",
    "pull_request_review_id": 233667548,
    "id": 280925547,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI4MDkyNTU0Nw==",
    "diff_hunk": "@@ -0,0 +1,72 @@\n+// Copyright (c) 2019 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <iostream>\n+\n+#include <bench/bench.h>\n+#include <hash.h>\n+#include <crypto/chacha20.h>\n+\n+/* Number of bytes to process per iteration */\n+static const uint64_t BUFFER_SIZE_TINY  = 64;\n+static const uint64_t BUFFER_SIZE_SMALL = 256;\n+static const uint64_t BUFFER_SIZE_LARGE = 1024*1024;\n+\n+static void CHACHA20(benchmark::State& state, size_t buffersize)\n+{\n+    std::vector<uint8_t> key(32,0);\n+    ChaCha20 ctx(key.data(), key.size());\n+    ctx.SetIV(0);\n+    ctx.Seek(0);\n+    std::vector<uint8_t> in(buffersize,0);\n+    std::vector<uint8_t> out(buffersize,0);\n+    while (state.KeepRunning())\n+        ctx.Crypt(in.data(), out.data(), in.size());",
    "path": "src/bench/chacha20.cpp",
    "position": 25,
    "original_position": 25,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "66d682bfc3c5d31a84c26d344cbc19897bb26a87",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Fixed",
    "created_at": "2019-05-03T20:53:04Z",
    "updated_at": "2019-05-03T20:53:04Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280925547",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280925547"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r280925547"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/280925547/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 25,
    "original_line": 25,
    "side": "RIGHT",
    "in_reply_to_id": 280897800
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/299470103",
    "pull_request_review_id": 256875721,
    "id": 299470103,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI5OTQ3MDEwMw==",
    "diff_hunk": "@@ -178,3 +178,133 @@ void ChaCha20::Output(unsigned char* c, size_t bytes)\n         c += 64;\n     }\n }\n+\n+void ChaCha20::Crypt(const unsigned char* m, unsigned char* c, size_t bytes)\n+{\n+    uint32_t x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14, x15;\n+    uint32_t j0, j1, j2, j3, j4, j5, j6, j7, j8, j9, j10, j11, j12, j13, j14, j15;\n+    unsigned char *ctarget = nullptr;\n+    unsigned char tmp[64];\n+    unsigned int i;\n+\n+    if (!bytes) return;\n+\n+    j0 = input[0];\n+    j1 = input[1];\n+    j2 = input[2];\n+    j3 = input[3];\n+    j4 = input[4];\n+    j5 = input[5];\n+    j6 = input[6];\n+    j7 = input[7];\n+    j8 = input[8];\n+    j9 = input[9];\n+    j10 = input[10];\n+    j11 = input[11];\n+    j12 = input[12];\n+    j13 = input[13];\n+    j14 = input[14];\n+    j15 = input[15];\n+\n+    for (;;) {\n+        if (bytes < 64) {\n+            // if m has fewer than 64 bytes available, copy m to tmp and\n+            // read from tmp instead\n+            for (i = 0;i < bytes;++i) tmp[i] = m[i];\n+            m = tmp;\n+            ctarget = c;\n+            c = tmp;\n+        }\n+        x0 = j0;\n+        x1 = j1;\n+        x2 = j2;\n+        x3 = j3;\n+        x4 = j4;\n+        x5 = j5;\n+        x6 = j6;\n+        x7 = j7;\n+        x8 = j8;\n+        x9 = j9;\n+        x10 = j10;\n+        x11 = j11;\n+        x12 = j12;\n+        x13 = j13;\n+        x14 = j14;\n+        x15 = j15;\n+        for (i = 20;i > 0;i -= 2) {\n+            QUARTERROUND( x0, x4, x8,x12)\n+            QUARTERROUND( x1, x5, x9,x13)\n+            QUARTERROUND( x2, x6,x10,x14)\n+            QUARTERROUND( x3, x7,x11,x15)\n+            QUARTERROUND( x0, x5,x10,x15)\n+            QUARTERROUND( x1, x6,x11,x12)\n+            QUARTERROUND( x2, x7, x8,x13)\n+            QUARTERROUND( x3, x4, x9,x14)\n+        }\n+        x0 += j0;\n+        x1 += j1;\n+        x2 += j2;\n+        x3 += j3;\n+        x4 += j4;\n+        x5 += j5;\n+        x6 += j6;\n+        x7 += j7;\n+        x8 += j8;\n+        x9 += j9;\n+        x10 += j10;\n+        x11 += j11;\n+        x12 += j12;\n+        x13 += j13;\n+        x14 += j14;\n+        x15 += j15;\n+\n+        x0 ^= ReadLE32(m + 0);\n+        x1 ^= ReadLE32(m + 4);\n+        x2 ^= ReadLE32(m + 8);\n+        x3 ^= ReadLE32(m + 12);\n+        x4 ^= ReadLE32(m + 16);\n+        x5 ^= ReadLE32(m + 20);\n+        x6 ^= ReadLE32(m + 24);\n+        x7 ^= ReadLE32(m + 28);\n+        x8 ^= ReadLE32(m + 32);\n+        x9 ^= ReadLE32(m + 36);\n+        x10 ^= ReadLE32(m + 40);\n+        x11 ^= ReadLE32(m + 44);\n+        x12 ^= ReadLE32(m + 48);\n+        x13 ^= ReadLE32(m + 52);\n+        x14 ^= ReadLE32(m + 56);\n+        x15 ^= ReadLE32(m + 60);\n+\n+        ++j12;\n+        if (!j12) ++j13;\n+\n+        WriteLE32(c + 0, x0);\n+        WriteLE32(c + 4, x1);\n+        WriteLE32(c + 8, x2);\n+        WriteLE32(c + 12, x3);\n+        WriteLE32(c + 16, x4);\n+        WriteLE32(c + 20, x5);\n+        WriteLE32(c + 24, x6);\n+        WriteLE32(c + 28, x7);\n+        WriteLE32(c + 32, x8);\n+        WriteLE32(c + 36, x9);\n+        WriteLE32(c + 40, x10);\n+        WriteLE32(c + 44, x11);\n+        WriteLE32(c + 48, x12);\n+        WriteLE32(c + 52, x13);\n+        WriteLE32(c + 56, x14);\n+        WriteLE32(c + 60, x15);\n+\n+        if (bytes <= 64) {\n+            if (bytes < 64) {\n+                for (i = 0;i < bytes;++i) ctarget[i] = c[i];",
    "path": "src/crypto/chacha20.cpp",
    "position": 132,
    "original_position": 132,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "user": {
      "login": "Kixunil",
      "id": 1178779,
      "node_id": "MDQ6VXNlcjExNzg3Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1178779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Kixunil",
      "html_url": "https://github.com/Kixunil",
      "followers_url": "https://api.github.com/users/Kixunil/followers",
      "following_url": "https://api.github.com/users/Kixunil/following{/other_user}",
      "gists_url": "https://api.github.com/users/Kixunil/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Kixunil/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Kixunil/subscriptions",
      "organizations_url": "https://api.github.com/users/Kixunil/orgs",
      "repos_url": "https://api.github.com/users/Kixunil/repos",
      "events_url": "https://api.github.com/users/Kixunil/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Kixunil/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Isn't this no-op? When `bytes < 64` line 215 get's executed which makes ctarget and c equal pointers, therefore it's copying a value to itself.",
    "created_at": "2019-07-02T13:01:04Z",
    "updated_at": "2019-07-02T13:04:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r299470103",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "NONE",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/299470103"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r299470103"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/299470103/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 300,
    "original_line": 300,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/299471703",
    "pull_request_review_id": 256875721,
    "id": 299471703,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI5OTQ3MTcwMw==",
    "diff_hunk": "@@ -17,10 +18,17 @@ class ChaCha20\n public:\n     ChaCha20();\n     ChaCha20(const unsigned char* key, size_t keylen);\n-    void SetKey(const unsigned char* key, size_t keylen);\n-    void SetIV(uint64_t iv);\n-    void Seek(uint64_t pos);\n-    void Output(unsigned char* output, size_t bytes);\n+    void SetKey(const unsigned char* key, size_t keylen); //!< set key with flexible keylength; 256bit recommended */",
    "path": "src/crypto/chacha20.h",
    "position": 18,
    "original_position": 18,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "user": {
      "login": "Kixunil",
      "id": 1178779,
      "node_id": "MDQ6VXNlcjExNzg3Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1178779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Kixunil",
      "html_url": "https://github.com/Kixunil",
      "followers_url": "https://api.github.com/users/Kixunil/followers",
      "following_url": "https://api.github.com/users/Kixunil/following{/other_user}",
      "gists_url": "https://api.github.com/users/Kixunil/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Kixunil/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Kixunil/subscriptions",
      "organizations_url": "https://api.github.com/users/Kixunil/orgs",
      "repos_url": "https://api.github.com/users/Kixunil/repos",
      "events_url": "https://api.github.com/users/Kixunil/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Kixunil/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I like the renaming. Would be nice if the comments included information about pointers (e.g. \"key must be non-null, pointer isn't stored\").",
    "created_at": "2019-07-02T13:04:30Z",
    "updated_at": "2019-07-02T13:04:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r299471703",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "NONE",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/299471703"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r299471703"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/299471703/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 21,
    "original_line": 21,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/299867339",
    "pull_request_review_id": 257372830,
    "id": 299867339,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI5OTg2NzMzOQ==",
    "diff_hunk": "@@ -178,3 +178,133 @@ void ChaCha20::Output(unsigned char* c, size_t bytes)\n         c += 64;\n     }\n }\n+\n+void ChaCha20::Crypt(const unsigned char* m, unsigned char* c, size_t bytes)\n+{\n+    uint32_t x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14, x15;\n+    uint32_t j0, j1, j2, j3, j4, j5, j6, j7, j8, j9, j10, j11, j12, j13, j14, j15;\n+    unsigned char *ctarget = nullptr;\n+    unsigned char tmp[64];\n+    unsigned int i;\n+\n+    if (!bytes) return;\n+\n+    j0 = input[0];\n+    j1 = input[1];\n+    j2 = input[2];\n+    j3 = input[3];\n+    j4 = input[4];\n+    j5 = input[5];\n+    j6 = input[6];\n+    j7 = input[7];\n+    j8 = input[8];\n+    j9 = input[9];\n+    j10 = input[10];\n+    j11 = input[11];\n+    j12 = input[12];\n+    j13 = input[13];\n+    j14 = input[14];\n+    j15 = input[15];\n+\n+    for (;;) {\n+        if (bytes < 64) {\n+            // if m has fewer than 64 bytes available, copy m to tmp and\n+            // read from tmp instead\n+            for (i = 0;i < bytes;++i) tmp[i] = m[i];\n+            m = tmp;\n+            ctarget = c;\n+            c = tmp;\n+        }\n+        x0 = j0;\n+        x1 = j1;\n+        x2 = j2;\n+        x3 = j3;\n+        x4 = j4;\n+        x5 = j5;\n+        x6 = j6;\n+        x7 = j7;\n+        x8 = j8;\n+        x9 = j9;\n+        x10 = j10;\n+        x11 = j11;\n+        x12 = j12;\n+        x13 = j13;\n+        x14 = j14;\n+        x15 = j15;\n+        for (i = 20;i > 0;i -= 2) {\n+            QUARTERROUND( x0, x4, x8,x12)\n+            QUARTERROUND( x1, x5, x9,x13)\n+            QUARTERROUND( x2, x6,x10,x14)\n+            QUARTERROUND( x3, x7,x11,x15)\n+            QUARTERROUND( x0, x5,x10,x15)\n+            QUARTERROUND( x1, x6,x11,x12)\n+            QUARTERROUND( x2, x7, x8,x13)\n+            QUARTERROUND( x3, x4, x9,x14)\n+        }\n+        x0 += j0;\n+        x1 += j1;\n+        x2 += j2;\n+        x3 += j3;\n+        x4 += j4;\n+        x5 += j5;\n+        x6 += j6;\n+        x7 += j7;\n+        x8 += j8;\n+        x9 += j9;\n+        x10 += j10;\n+        x11 += j11;\n+        x12 += j12;\n+        x13 += j13;\n+        x14 += j14;\n+        x15 += j15;\n+\n+        x0 ^= ReadLE32(m + 0);\n+        x1 ^= ReadLE32(m + 4);\n+        x2 ^= ReadLE32(m + 8);\n+        x3 ^= ReadLE32(m + 12);\n+        x4 ^= ReadLE32(m + 16);\n+        x5 ^= ReadLE32(m + 20);\n+        x6 ^= ReadLE32(m + 24);\n+        x7 ^= ReadLE32(m + 28);\n+        x8 ^= ReadLE32(m + 32);\n+        x9 ^= ReadLE32(m + 36);\n+        x10 ^= ReadLE32(m + 40);\n+        x11 ^= ReadLE32(m + 44);\n+        x12 ^= ReadLE32(m + 48);\n+        x13 ^= ReadLE32(m + 52);\n+        x14 ^= ReadLE32(m + 56);\n+        x15 ^= ReadLE32(m + 60);\n+\n+        ++j12;\n+        if (!j12) ++j13;\n+\n+        WriteLE32(c + 0, x0);\n+        WriteLE32(c + 4, x1);\n+        WriteLE32(c + 8, x2);\n+        WriteLE32(c + 12, x3);\n+        WriteLE32(c + 16, x4);\n+        WriteLE32(c + 20, x5);\n+        WriteLE32(c + 24, x6);\n+        WriteLE32(c + 28, x7);\n+        WriteLE32(c + 32, x8);\n+        WriteLE32(c + 36, x9);\n+        WriteLE32(c + 40, x10);\n+        WriteLE32(c + 44, x11);\n+        WriteLE32(c + 48, x12);\n+        WriteLE32(c + 52, x13);\n+        WriteLE32(c + 56, x14);\n+        WriteLE32(c + 60, x15);\n+\n+        if (bytes <= 64) {\n+            if (bytes < 64) {\n+                for (i = 0;i < bytes;++i) ctarget[i] = c[i];",
    "path": "src/crypto/chacha20.cpp",
    "position": 132,
    "original_position": 132,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I don't think so.\r\nIf we do less then 64 bytes, we execute the round on `tmp` (because we do 64bytes always, see line 216, `c` points to `tmp` if <64 bytes). So in the case of <64 bytes, `c` points to the temporary 64byte buffer and `ctarget` points to the function provided `c` argument.",
    "created_at": "2019-07-03T09:39:36Z",
    "updated_at": "2019-07-03T09:39:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r299867339",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/299867339"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r299867339"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/299867339/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 300,
    "original_line": 300,
    "side": "RIGHT",
    "in_reply_to_id": 299470103
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/299867520",
    "pull_request_review_id": 257373053,
    "id": 299867520,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI5OTg2NzUyMA==",
    "diff_hunk": "@@ -17,10 +18,17 @@ class ChaCha20\n public:\n     ChaCha20();\n     ChaCha20(const unsigned char* key, size_t keylen);\n-    void SetKey(const unsigned char* key, size_t keylen);\n-    void SetIV(uint64_t iv);\n-    void Seek(uint64_t pos);\n-    void Output(unsigned char* output, size_t bytes);\n+    void SetKey(const unsigned char* key, size_t keylen); //!< set key with flexible keylength; 256bit recommended */",
    "path": "src/crypto/chacha20.h",
    "position": 18,
    "original_position": 18,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes. That would have been useful. Feel free to PR.",
    "created_at": "2019-07-03T09:39:58Z",
    "updated_at": "2019-07-03T09:39:59Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r299867520",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/299867520"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r299867520"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/299867520/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 21,
    "original_line": 21,
    "side": "RIGHT",
    "in_reply_to_id": 299471703
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/300349240",
    "pull_request_review_id": 257979424,
    "id": 300349240,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMwMDM0OTI0MA==",
    "diff_hunk": "@@ -178,3 +178,133 @@ void ChaCha20::Output(unsigned char* c, size_t bytes)\n         c += 64;\n     }\n }\n+\n+void ChaCha20::Crypt(const unsigned char* m, unsigned char* c, size_t bytes)\n+{\n+    uint32_t x0, x1, x2, x3, x4, x5, x6, x7, x8, x9, x10, x11, x12, x13, x14, x15;\n+    uint32_t j0, j1, j2, j3, j4, j5, j6, j7, j8, j9, j10, j11, j12, j13, j14, j15;\n+    unsigned char *ctarget = nullptr;\n+    unsigned char tmp[64];\n+    unsigned int i;\n+\n+    if (!bytes) return;\n+\n+    j0 = input[0];\n+    j1 = input[1];\n+    j2 = input[2];\n+    j3 = input[3];\n+    j4 = input[4];\n+    j5 = input[5];\n+    j6 = input[6];\n+    j7 = input[7];\n+    j8 = input[8];\n+    j9 = input[9];\n+    j10 = input[10];\n+    j11 = input[11];\n+    j12 = input[12];\n+    j13 = input[13];\n+    j14 = input[14];\n+    j15 = input[15];\n+\n+    for (;;) {\n+        if (bytes < 64) {\n+            // if m has fewer than 64 bytes available, copy m to tmp and\n+            // read from tmp instead\n+            for (i = 0;i < bytes;++i) tmp[i] = m[i];\n+            m = tmp;\n+            ctarget = c;\n+            c = tmp;\n+        }\n+        x0 = j0;\n+        x1 = j1;\n+        x2 = j2;\n+        x3 = j3;\n+        x4 = j4;\n+        x5 = j5;\n+        x6 = j6;\n+        x7 = j7;\n+        x8 = j8;\n+        x9 = j9;\n+        x10 = j10;\n+        x11 = j11;\n+        x12 = j12;\n+        x13 = j13;\n+        x14 = j14;\n+        x15 = j15;\n+        for (i = 20;i > 0;i -= 2) {\n+            QUARTERROUND( x0, x4, x8,x12)\n+            QUARTERROUND( x1, x5, x9,x13)\n+            QUARTERROUND( x2, x6,x10,x14)\n+            QUARTERROUND( x3, x7,x11,x15)\n+            QUARTERROUND( x0, x5,x10,x15)\n+            QUARTERROUND( x1, x6,x11,x12)\n+            QUARTERROUND( x2, x7, x8,x13)\n+            QUARTERROUND( x3, x4, x9,x14)\n+        }\n+        x0 += j0;\n+        x1 += j1;\n+        x2 += j2;\n+        x3 += j3;\n+        x4 += j4;\n+        x5 += j5;\n+        x6 += j6;\n+        x7 += j7;\n+        x8 += j8;\n+        x9 += j9;\n+        x10 += j10;\n+        x11 += j11;\n+        x12 += j12;\n+        x13 += j13;\n+        x14 += j14;\n+        x15 += j15;\n+\n+        x0 ^= ReadLE32(m + 0);\n+        x1 ^= ReadLE32(m + 4);\n+        x2 ^= ReadLE32(m + 8);\n+        x3 ^= ReadLE32(m + 12);\n+        x4 ^= ReadLE32(m + 16);\n+        x5 ^= ReadLE32(m + 20);\n+        x6 ^= ReadLE32(m + 24);\n+        x7 ^= ReadLE32(m + 28);\n+        x8 ^= ReadLE32(m + 32);\n+        x9 ^= ReadLE32(m + 36);\n+        x10 ^= ReadLE32(m + 40);\n+        x11 ^= ReadLE32(m + 44);\n+        x12 ^= ReadLE32(m + 48);\n+        x13 ^= ReadLE32(m + 52);\n+        x14 ^= ReadLE32(m + 56);\n+        x15 ^= ReadLE32(m + 60);\n+\n+        ++j12;\n+        if (!j12) ++j13;\n+\n+        WriteLE32(c + 0, x0);\n+        WriteLE32(c + 4, x1);\n+        WriteLE32(c + 8, x2);\n+        WriteLE32(c + 12, x3);\n+        WriteLE32(c + 16, x4);\n+        WriteLE32(c + 20, x5);\n+        WriteLE32(c + 24, x6);\n+        WriteLE32(c + 28, x7);\n+        WriteLE32(c + 32, x8);\n+        WriteLE32(c + 36, x9);\n+        WriteLE32(c + 40, x10);\n+        WriteLE32(c + 44, x11);\n+        WriteLE32(c + 48, x12);\n+        WriteLE32(c + 52, x13);\n+        WriteLE32(c + 56, x14);\n+        WriteLE32(c + 60, x15);\n+\n+        if (bytes <= 64) {\n+            if (bytes < 64) {\n+                for (i = 0;i < bytes;++i) ctarget[i] = c[i];",
    "path": "src/crypto/chacha20.cpp",
    "position": 132,
    "original_position": 132,
    "commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "original_commit_id": "2dfe2751713c814aea53b5a7563eb74ad1baea00",
    "user": {
      "login": "Kixunil",
      "id": 1178779,
      "node_id": "MDQ6VXNlcjExNzg3Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1178779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Kixunil",
      "html_url": "https://github.com/Kixunil",
      "followers_url": "https://api.github.com/users/Kixunil/followers",
      "following_url": "https://api.github.com/users/Kixunil/following{/other_user}",
      "gists_url": "https://api.github.com/users/Kixunil/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Kixunil/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Kixunil/subscriptions",
      "organizations_url": "https://api.github.com/users/Kixunil/orgs",
      "repos_url": "https://api.github.com/users/Kixunil/repos",
      "events_url": "https://api.github.com/users/Kixunil/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Kixunil/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Ah, yes, missed that. Thanks and sorry for bothering.",
    "created_at": "2019-07-04T11:05:00Z",
    "updated_at": "2019-07-04T11:05:01Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r300349240",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512",
    "author_association": "NONE",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/300349240"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15512#discussion_r300349240"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15512"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/300349240/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 300,
    "original_line": 300,
    "side": "RIGHT",
    "in_reply_to_id": 299470103
  }
]