[
  {
    "sha": "62d41358c1dbe7b2dd94a6ab4206413dbfcbff6b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2MmQ0MTM1OGMxZGJlN2IyZGQ5NGE2YWI0MjA2NDEzZGJmY2JmZjZi",
    "commit": {
      "author": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2020-11-08T20:40:30Z"
      },
      "committer": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2020-11-09T11:04:36Z"
      },
      "message": "util: Get rid of RecursiveMutex in Get{Blocks,Data}Dir\n\nThis change removes the RecursiveMutex object by splitting it into two\nMutex objects, and ensuring they are always acquired in the same order.",
      "tree": {
        "sha": "67b3185d62ee38b1c1310282f24ea1f852523e29",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/67b3185d62ee38b1c1310282f24ea1f852523e29"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/62d41358c1dbe7b2dd94a6ab4206413dbfcbff6b",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE0dvyxLlvLev0wWZUQQEIES5+qB8FAl+pIkQACgkQQQEIES5+\nqB9E/Q/9HOekgosU/3H+2USdbpsIigl5aSWBXK/FAQt2+i0Ha5VnOckWR7AbB9Ul\nSkjrDyqjSo4LEOXsbqeduc3uMyxufeZY9m3jx7DzF7v4agyJLeDUue/ytPFssBZj\nLAAVZZ3D2o1lvj+oqoR6/bL36+RYco6uVFNAvH4ZTFzIu/N3OAAcgGSGoctxZn8V\nS50q5SBMnMPqQ1TX687LMtnzqGZ0pUvYpf9w2tIWaFuYB+XlmbA5h8MAvVoRjvD3\nM1s3V47pwPwSIodCCpL1z+55P36aITB4A2a/Ip8RsmYcXaEg6xjbFrnhevLfJMZx\ndW9BqEE2WHbemu0Z05uTqpfR+9iKXa7peZD37k8h7V0BeZrpU0BogjxMyN0X6+EF\nZQQiHjeJxZ7CmZRXA7nJM18B7MGP8iauO3axID29inXgyuTIQk4zxGlGduCnw47c\nxxezDYCVXuOgnfxDXCihwHmU39iwZFNRDTU+ZMTuq+1kveFazJrcSeXbNTZaYbeu\nmAoD8OpQ+taQzg2NHl84Y/Yi59LKPodHgC6+3seKQoN9LJJh5biGDVp7i9ZsEyvp\nwa3GohcmRqRfjRnh7BQ2hUAeo9iaF1wMUETLIdsxQUT2SSoBilppNCBnb58luUJo\nqAmO+O2Jc961A/T8F7NTtagbsJN7ycYoxdVWdtGsybPxRY2KpmU=\n=QQxG\n-----END PGP SIGNATURE-----",
        "payload": "tree 67b3185d62ee38b1c1310282f24ea1f852523e29\nparent 7e373294a5ae819099c39d9d03d1f5a311d63cfc\nauthor Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1604868030 +0200\ncommitter Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1604919876 +0200\n\nutil: Get rid of RecursiveMutex in Get{Blocks,Data}Dir\n\nThis change removes the RecursiveMutex object by splitting it into two\nMutex objects, and ensuring they are always acquired in the same order.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/62d41358c1dbe7b2dd94a6ab4206413dbfcbff6b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/62d41358c1dbe7b2dd94a6ab4206413dbfcbff6b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/62d41358c1dbe7b2dd94a6ab4206413dbfcbff6b/comments",
    "author": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "7e373294a5ae819099c39d9d03d1f5a311d63cfc",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7e373294a5ae819099c39d9d03d1f5a311d63cfc",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/7e373294a5ae819099c39d9d03d1f5a311d63cfc"
      }
    ],
    "stats": {
      "total": 18,
      "additions": 10,
      "deletions": 8
    },
    "files": [
      {
        "sha": "7ac3aece5b3098bf87533e876ff6e1f908f8f9da",
        "filename": "src/util/system.cpp",
        "status": "modified",
        "additions": 10,
        "deletions": 8,
        "changes": 18,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/62d41358c1dbe7b2dd94a6ab4206413dbfcbff6b/src/util/system.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/62d41358c1dbe7b2dd94a6ab4206413dbfcbff6b/src/util/system.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util/system.cpp?ref=62d41358c1dbe7b2dd94a6ab4206413dbfcbff6b",
        "patch": "@@ -686,14 +686,12 @@ fs::path StripRedundantLastElementsOfPath(const fs::path& path)\n }\n } // namespace\n \n-static fs::path g_blocks_path_cache_net_specific;\n-static fs::path pathCached;\n-static fs::path pathCachedNetSpecific;\n-static RecursiveMutex csPathCached;\n+static Mutex g_blocksdir_path_mutex;\n+static fs::path g_blocks_path_cache_net_specific GUARDED_BY(g_blocksdir_path_mutex);\n \n const fs::path &GetBlocksDir()\n {\n-    LOCK(csPathCached);\n+    LOCK(g_blocksdir_path_mutex);\n     fs::path &path = g_blocks_path_cache_net_specific;\n \n     // Cache the path to avoid calling fs::create_directories on every call of\n@@ -717,9 +715,13 @@ const fs::path &GetBlocksDir()\n     return path;\n }\n \n+static Mutex g_datadir_path_mutex;\n+static fs::path pathCached GUARDED_BY(g_datadir_path_mutex);\n+static fs::path pathCachedNetSpecific GUARDED_BY(g_datadir_path_mutex);\n+\n const fs::path &GetDataDir(bool fNetSpecific)\n {\n-    LOCK(csPathCached);\n+    LOCK(g_datadir_path_mutex);\n     fs::path &path = fNetSpecific ? pathCachedNetSpecific : pathCached;\n \n     // Cache the path to avoid calling fs::create_directories on every call of\n@@ -756,11 +758,11 @@ bool CheckDataDirOption()\n \n void ClearDatadirCache()\n {\n-    LOCK(csPathCached);\n+    WITH_LOCK(g_blocksdir_path_mutex, g_blocks_path_cache_net_specific = fs::path());\n \n+    LOCK(g_datadir_path_mutex);\n     pathCached = fs::path();\n     pathCachedNetSpecific = fs::path();\n-    g_blocks_path_cache_net_specific = fs::path();\n }\n \n fs::path GetConfigFile(const std::string& confPath)"
      }
    ]
  },
  {
    "sha": "7b90f77146d36ef21760f2ce3704e2f2f463b3a2",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3YjkwZjc3MTQ2ZDM2ZWYyMTc2MGYyY2UzNzA0ZTJmMmY0NjNiM2Ey",
    "commit": {
      "author": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2020-11-08T20:51:05Z"
      },
      "committer": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2020-11-09T11:04:36Z"
      },
      "message": "scripted-diff: Rename datadir path variables in util/system.cpp\n\n-BEGIN VERIFY SCRIPT-\nsed -i 's/pathCachedNetSpecific/g_datadir_path_cached_net_specific/' src/util/system.cpp\nsed -i 's/pathCached/g_datadir_path_cached/' src/util/system.cpp\n-END VERIFY SCRIPT-",
      "tree": {
        "sha": "b5d2ce6822b911c15915c23dd6c69da6ee2f0eac",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b5d2ce6822b911c15915c23dd6c69da6ee2f0eac"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7b90f77146d36ef21760f2ce3704e2f2f463b3a2",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE0dvyxLlvLev0wWZUQQEIES5+qB8FAl+pIksACgkQQQEIES5+\nqB9/dA/8Dx+FaGADBeUGCx8YLKyvOqyADJJXuVXnOTXl6MS564A4UhNLQbT6YtiU\niU1+N0Rrc7esq5An0uh2/wZ1nXCVd0V0jZnk2TG/CaoYC+qnMKpF+3Vmv8o0LJFe\nKcsSWb7N2RlzWq658iUE+Guu829lLeAeimgm7fl9TEZa+NqiDN0NSv6XYHx7V7gD\nSqsaBU7ffxTI2jzW9NmYuNbrfvVrCd0mwQYl5uohgYr/c/cQH6hos0/gwDvx1EtK\n6qYB7ZXmKKtPuO/SWJF0qhipOCvzUvsfVz/Za0q9xkxs0aIDp5wP5IVJbEwiCfxj\n9v2IJNwGIPKOEY7d0ziOylWRcA5ZGGlajDkw8scFx8tISZYWhSrQdVWn9ZrWLvAg\nxMBBVI2iyxrNO31GvYR/MmYQUUsVACxR0mEAF+ympOG733NZOTSxKrqzMHJYqdnt\nxe0BPPrH8g8hzZtAv3NIcFfHFuJrMWfeGmX/17sH1BmkCaICXjHNV+XbdHhKsc6H\nMZD2IS+wnJtD2ToYjmLDk4jhdNIZ9XiEDMWMqVdtHyrk+t3E8EL6pQvzCjAOTfWQ\nhLMq+drbufduYMgNjp44jyCSSxqBULcwvSILWc0nWdwpL9Zlk59vzrQHFdNl2SHx\nZg9drIHmK3ktguaQFlhAH8jqgw1pz44pFFdNUi2C54qWXXwcRJo=\n=10zn\n-----END PGP SIGNATURE-----",
        "payload": "tree b5d2ce6822b911c15915c23dd6c69da6ee2f0eac\nparent 62d41358c1dbe7b2dd94a6ab4206413dbfcbff6b\nauthor Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1604868665 +0200\ncommitter Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1604919876 +0200\n\nscripted-diff: Rename datadir path variables in util/system.cpp\n\n-BEGIN VERIFY SCRIPT-\nsed -i 's/pathCachedNetSpecific/g_datadir_path_cached_net_specific/' src/util/system.cpp\nsed -i 's/pathCached/g_datadir_path_cached/' src/util/system.cpp\n-END VERIFY SCRIPT-\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7b90f77146d36ef21760f2ce3704e2f2f463b3a2",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/7b90f77146d36ef21760f2ce3704e2f2f463b3a2",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7b90f77146d36ef21760f2ce3704e2f2f463b3a2/comments",
    "author": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "62d41358c1dbe7b2dd94a6ab4206413dbfcbff6b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/62d41358c1dbe7b2dd94a6ab4206413dbfcbff6b",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/62d41358c1dbe7b2dd94a6ab4206413dbfcbff6b"
      }
    ],
    "stats": {
      "total": 10,
      "additions": 5,
      "deletions": 5
    },
    "files": [
      {
        "sha": "af7141a40153c2d5815843e6765e434226726d1c",
        "filename": "src/util/system.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 5,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7b90f77146d36ef21760f2ce3704e2f2f463b3a2/src/util/system.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7b90f77146d36ef21760f2ce3704e2f2f463b3a2/src/util/system.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util/system.cpp?ref=7b90f77146d36ef21760f2ce3704e2f2f463b3a2",
        "patch": "@@ -716,13 +716,13 @@ const fs::path &GetBlocksDir()\n }\n \n static Mutex g_datadir_path_mutex;\n-static fs::path pathCached GUARDED_BY(g_datadir_path_mutex);\n-static fs::path pathCachedNetSpecific GUARDED_BY(g_datadir_path_mutex);\n+static fs::path g_datadir_path_cached GUARDED_BY(g_datadir_path_mutex);\n+static fs::path g_datadir_path_cached_net_specific GUARDED_BY(g_datadir_path_mutex);\n \n const fs::path &GetDataDir(bool fNetSpecific)\n {\n     LOCK(g_datadir_path_mutex);\n-    fs::path &path = fNetSpecific ? pathCachedNetSpecific : pathCached;\n+    fs::path &path = fNetSpecific ? g_datadir_path_cached_net_specific : g_datadir_path_cached;\n \n     // Cache the path to avoid calling fs::create_directories on every call of\n     // this function\n@@ -761,8 +761,8 @@ void ClearDatadirCache()\n     WITH_LOCK(g_blocksdir_path_mutex, g_blocks_path_cache_net_specific = fs::path());\n \n     LOCK(g_datadir_path_mutex);\n-    pathCached = fs::path();\n-    pathCachedNetSpecific = fs::path();\n+    g_datadir_path_cached = fs::path();\n+    g_datadir_path_cached_net_specific = fs::path();\n }\n \n fs::path GetConfigFile(const std::string& confPath)"
      }
    ]
  }
]