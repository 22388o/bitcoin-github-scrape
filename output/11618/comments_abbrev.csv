practicalswift,2017-11-06T15:22:17Z,@promag Feedback addressed! :-),https://github.com/bitcoin/bitcoin/pull/11618#issuecomment-342181206,342181206,
practicalswift,2017-11-06T20:49:46Z,@TheBlueMatt Good point. Locking now moved down one level into `blockToJSON`/`blockheaderToJSON`. Looks good?,https://github.com/bitcoin/bitcoin/pull/11618#issuecomment-342281803,342281803,
TheBlueMatt,2017-11-06T21:19:49Z,"utACK 758b126897fdc596af70424b6e82cbcda0e3baa3, though the commit message is now somewhat confused (refers to ""rest"" but only touches src/rpc/*).",https://github.com/bitcoin/bitcoin/pull/11618#issuecomment-342290383,342290383,
promag,2017-11-06T21:22:21Z,"@TheBlueMatt the lock scope could be reduced so that WriteHeader/WriteReply wouldn't keep it. The current approach can give inconsistencies: while iterating the chain can change, and the response can have mixed data. Even with RW locks care must be taken to ensure consistency in the responses.\n\nSo, IMO this is the correct implementation:\n```cpp\n    case RF_JSON: {\n        UniValue jsonHe",https://github.com/bitcoin/bitcoin/pull/11618#issuecomment-342291134,342291134,
practicalswift,2017-11-06T21:26:44Z,@TheBlueMatt Commit message and PR title adjusted.,https://github.com/bitcoin/bitcoin/pull/11618#issuecomment-342292483,342292483,
TheBlueMatt,2017-11-06T21:50:13Z,"@promag gah, indeed, missed that its called in a loop there - should indeed lock outside the loop.",https://github.com/bitcoin/bitcoin/pull/11618#issuecomment-342299180,342299180,
practicalswift,2017-11-06T22:29:51Z,@TheBlueMatt @promag Updated! Please re-review :-),https://github.com/bitcoin/bitcoin/pull/11618#issuecomment-342309723,342309723,
practicalswift,2017-11-07T06:18:16Z,Indentation fixed. Please re-review :-),https://github.com/bitcoin/bitcoin/pull/11618#issuecomment-342386796,342386796,
promag,2017-11-07T15:06:50Z,re-utACK a9b6ba0.,https://github.com/bitcoin/bitcoin/pull/11618#issuecomment-342510922,342510922,
MarcoFalke,2017-11-07T16:20:58Z,utACK a9b6ba0b7,https://github.com/bitcoin/bitcoin/pull/11618#issuecomment-342536422,342536422,
promag,2017-11-06T14:53:34Z,"Lock once, before loop?",https://github.com/bitcoin/bitcoin/pull/11618#discussion_r149098979,149098979,src/rest.cpp
TheBlueMatt,2017-11-06T23:41:36Z,nit: bad indentation here.,https://github.com/bitcoin/bitcoin/pull/11618#discussion_r149237091,149237091,src/rest.cpp
