practicalswift,2020-10-28 07:04:36,Concept ACK,https://github.com/bitcoin/bitcoin/pull/20253#issuecomment-717743934,717743934,
fanquake,2020-11-16 06:22:55,"> Note that the functions SetMaxOutbound{Target,Timeframe} are also used in the fuzz test test/fuzz/connman.cpp, hence the uses should also be removed there.\n\nThanks. I've dropped them from the fuzz tests now.",https://github.com/bitcoin/bitcoin/pull/20253#issuecomment-727763350,727763350,
DrahtBot,2020-11-17 14:18:04,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20649 (refactor: Remove nMyStartingHeight from CNode/Connman by MarcoFalke)\n* #20228 (addrman: Make addrman a top-level ",https://github.com/bitcoin/bitcoin/pull/20253#issuecomment-728957715,728957715,
jnewbery,2020-11-18 11:29:16,Concept ACK,https://github.com/bitcoin/bitcoin/pull/20253#issuecomment-729618669,729618669,
DrahtBot,2020-11-18 13:10:44,"<!--cf906140f33d8803c4a75a2196329ecb-->\nüêô This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a ""draft"".</sub>",https://github.com/bitcoin/bitcoin/pull/20253#issuecomment-729666655,729666655,
fanquake,2020-11-18 13:15:47,Rebased for #20408 and fixed an oversight in the fuzz changes.,https://github.com/bitcoin/bitcoin/pull/20253#issuecomment-729669892,729669892,
fanquake,2020-12-09 12:53:20,"I've rebased this, cherry-picked in fa11110bff6288f63e0c487e2e4b4079fb0f4569 from 20602 and updated some std::chrono usage to use literals as suggested.",https://github.com/bitcoin/bitcoin/pull/20253#issuecomment-741751497,741751497,
fanquake,2020-12-13 03:45:24,"Rebased & addressed some comments.\n\n> In case you touch this branch again:\n\nI've fixed the commit message.",https://github.com/bitcoin/bitcoin/pull/20253#issuecomment-743943724,743943724,
jnewbery,2020-12-15 10:04:44,utACK 0475c8ba4d10dce79092361bc4c23c11dadba39a,https://github.com/bitcoin/bitcoin/pull/20253#issuecomment-745185118,745185118,
theStack,2020-11-22 08:50:59,"Could reuse `now` here instead of calling `GetTime()` again:\n```return (cycleEndTime < now) ? std::chrono::seconds::zero() : cycleEndTime - now;```",https://github.com/bitcoin/bitcoin/pull/20253#discussion_r528303503,528303503,src/net.cpp
fanquake,2020-11-23 03:53:35,"Thanks. I was going to leave this as a straight refactor, but have  taken your suggestion.",https://github.com/bitcoin/bitcoin/pull/20253#discussion_r528460875,528460875,src/net.cpp
MarcoFalke,2020-11-23 06:37:26,I think 0 can be written shorter with chrono literals?,https://github.com/bitcoin/bitcoin/pull/20253#discussion_r528493076,528493076,src/net.cpp
jnewbery,2020-11-23 09:45:43,"Perhaps just remove this as an `Options` member entirely. If there's no way to change the value in init.cpp, and its not used in the test, then this is just indirect, obfuscating code. Just use the constant internally in net.",https://github.com/bitcoin/bitcoin/pull/20253#discussion_r528576373,528576373,src/net.h
jnewbery,2020-11-23 10:00:16,"It's a good idea to use `std::chrono` internally in net, but I think you can leave these interface functions `GetMaxOutboundTimeframe()` and `GetMaxOutboundTimeLeftInCycle()` the same and continue to just send a count of seconds to the caller. The only place these are used is in rpc/net, where the count of seconds is returned directly to the user.",https://github.com/bitcoin/bitcoin/pull/20253#discussion_r528585634,528585634,src/net.h
fanquake,2020-12-09 12:53:05,Done,https://github.com/bitcoin/bitcoin/pull/20253#discussion_r539281490,539281490,src/net.cpp
fanquake,2020-12-09 12:53:12,"> The only place these are used is in rpc/net, where the count of seconds is returned directly to the user.\n\n`GetMaxOutboundTimeLeftInCycle` is called in `CConnman::OutboundTargetReached`.",https://github.com/bitcoin/bitcoin/pull/20253#discussion_r539281552,539281552,src/net.h
fanquake,2020-12-09 13:11:30,"I forgot to do this in the last push, but should have addressed it now.",https://github.com/bitcoin/bitcoin/pull/20253#discussion_r539293596,539293596,src/net.h
jonatack,2020-12-09 15:51:06,"832fc10e9e45abf92a perhaps use explicit typing here, const, and universal initialization to check for narrowing\n```diff\n-    std::chrono::seconds cycleEndTime = nMaxOutboundCycleStartTime + MAX_UPLOAD_TIMEFRAME;\n-    auto now = GetTime<std::chrono::seconds>();\n+    const std::chrono::seconds cycleEndTime{nMaxOutboundCycleStartTime + MAX_UPLOAD_TIMEFRAME};\n+    const std::chrono::seconds ",https://github.com/bitcoin/bitcoin/pull/20253#discussion_r539422590,539422590,src/net.cpp
jonatack,2020-12-09 15:55:59,"832fc10e9e45abf92a4f04012c918156 maybe prefer to be explicit about types and narrowing conversions in the net code\n```diff\n-        std::chrono::seconds timeLeftInCycle = GetMaxOutboundTimeLeftInCycle();\n-        uint64_t buffer = timeLeftInCycle / std::chrono::minutes{10} * MAX_BLOCK_SERIALIZED_SIZE;\n+        const std::chrono::seconds timeLeftInCycle{GetMaxOutboundTimeLeftInCycle()};\n+",https://github.com/bitcoin/bitcoin/pull/20253#discussion_r539426909,539426909,src/net.cpp
jonatack,2020-12-09 16:01:36,"832fc10e9e45abf9 const and maybe explicit typing + narrowing check\n```suggestion\n    const std::chrono::seconds now{GetTime<std::chrono::seconds>()};\n```",https://github.com/bitcoin/bitcoin/pull/20253#discussion_r539431808,539431808,src/net.cpp
jnewbery,2020-12-10 10:40:32,"Since this is only used internally in net, it could now be moved to the implementation cpp file to avoid exporting this symbol to other translation units.",https://github.com/bitcoin/bitcoin/pull/20253#discussion_r540061521,540061521,src/net.h
jnewbery,2020-12-10 10:52:11,"Ah, of course.",https://github.com/bitcoin/bitcoin/pull/20253#discussion_r540069388,540069388,src/net.h
fanquake,2020-12-13 03:43:43,Having `std::chrono::seconds` twice on the same line is pretty verbose. I'd like to think we can just use `auto` here because the type is clear from the call to GetTime<>().,https://github.com/bitcoin/bitcoin/pull/20253#discussion_r541835619,541835619,src/net.cpp
fanquake,2020-12-13 03:43:57,Done in the latest push.,https://github.com/bitcoin/bitcoin/pull/20253#discussion_r541835656,541835656,src/net.h
jonatack,2020-12-13 20:57:12,"Yes, the reason for the comment here was constness.",https://github.com/bitcoin/bitcoin/pull/20253#discussion_r542004019,542004019,src/net.cpp
jonatack,2020-12-13 21:05:32,"Note that existing code in the same file specifies the type explicitly, line 1646: `const std::chrono::seconds now = GetTime<std::chrono::seconds>();` introduced in commit b24a17f0398",https://github.com/bitcoin/bitcoin/pull/20253#discussion_r542005456,542005456,src/net.cpp
