[
  {
    "sha": "851296a72fc6930404abb94f4175acc1b1aab859",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4NTEyOTZhNzJmYzY5MzA0MDRhYmI5NGY0MTc1YWNjMWIxYWFiODU5",
    "commit": {
      "author": {
        "name": "Philip Kaufmann",
        "email": "phil.kaufmann@t-online.de",
        "date": "2015-01-10T13:48:55Z"
      },
      "committer": {
        "name": "Philip Kaufmann",
        "email": "phil.kaufmann@t-online.de",
        "date": "2015-01-11T18:16:57Z"
      },
      "message": "[Qt] add option to allow self signed root certs (for testing)\n\n- it is helpful to be able to test and verify payment request processing\n  by allowing self signed root certificates (e.g. generated by Gavins\n  \"certificate authority in a box\")\n- This option is just shown in the UI options, if -help-debug is enabled.",
      "tree": {
        "sha": "e264ef12eb4b0b8991d04f71504df1a11d54bf93",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e264ef12eb4b0b8991d04f71504df1a11d54bf93"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/851296a72fc6930404abb94f4175acc1b1aab859",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/851296a72fc6930404abb94f4175acc1b1aab859",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/851296a72fc6930404abb94f4175acc1b1aab859",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/851296a72fc6930404abb94f4175acc1b1aab859/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "4f73a8f64d1555b4053f2a0a5c79083e50a0ce21",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4f73a8f64d1555b4053f2a0a5c79083e50a0ce21",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/4f73a8f64d1555b4053f2a0a5c79083e50a0ce21"
      }
    ],
    "stats": {
      "total": 17,
      "additions": 16,
      "deletions": 1
    },
    "files": [
      {
        "sha": "39171c89eb5fa2e04afde48ae74acd3d3279a1b7",
        "filename": "src/qt/paymentrequestplus.cpp",
        "status": "modified",
        "additions": 9,
        "deletions": 1,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/851296a72fc6930404abb94f4175acc1b1aab859/src/qt/paymentrequestplus.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/851296a72fc6930404abb94f4175acc1b1aab859/src/qt/paymentrequestplus.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/paymentrequestplus.cpp?ref=851296a72fc6930404abb94f4175acc1b1aab859",
        "patch": "@@ -9,6 +9,8 @@\n \n #include \"paymentrequestplus.h\"\n \n+#include \"util.h\"\n+\n #include <stdexcept>\n \n #include <openssl/x509.h>\n@@ -150,7 +152,13 @@ bool PaymentRequestPlus::getMerchant(X509_STORE* certStore, QString& merchant) c\n         int result = X509_verify_cert(store_ctx);\n         if (result != 1) {\n             int error = X509_STORE_CTX_get_error(store_ctx);\n-            throw SSLVerifyError(X509_verify_cert_error_string(error));\n+            // For testing payment requests, we allow self signed root certs!\n+            // This option is just shown in the UI options, if -help-debug is enabled.\n+            if (!(error == X509_V_ERR_DEPTH_ZERO_SELF_SIGNED_CERT && GetBoolArg(\"-allowselfsignedrootcertificates\", false))) {\n+                throw SSLVerifyError(X509_verify_cert_error_string(error));\n+            } else {\n+               qDebug() << \"PaymentRequestPlus::getMerchant: Allowing self signed root certificate, because -allowselfsignedrootcertificates is true.\";\n+            }\n         }\n         X509_NAME *certname = X509_get_subject_name(signing_cert);\n "
      },
      {
        "sha": "1e1583fb19051855b361b08c30ce54899a16eb24",
        "filename": "src/qt/utilitydialog.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 0,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/851296a72fc6930404abb94f4175acc1b1aab859/src/qt/utilitydialog.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/851296a72fc6930404abb94f4175acc1b1aab859/src/qt/utilitydialog.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/utilitydialog.cpp?ref=851296a72fc6930404abb94f4175acc1b1aab859",
        "patch": "@@ -12,6 +12,7 @@\n \n #include \"clientversion.h\"\n #include \"init.h\"\n+#include \"util.h\"\n \n #include <stdio.h>\n \n@@ -108,6 +109,12 @@ HelpMessageDialog::HelpMessageDialog(QWidget *parent, bool about) :\n         cursor.movePosition(QTextCursor::NextRow);\n         cursor.insertText(tr(\"UI options\") + \":\", bold);\n         cursor.movePosition(QTextCursor::NextRow);\n+        if (GetBoolArg(\"-help-debug\", false)) {\n+            cursor.insertText(\"-allowselfsignedrootcertificates\");\n+            cursor.movePosition(QTextCursor::NextCell);\n+            cursor.insertText(tr(\"Allow self signed root certificates (default: 0)\"));\n+            cursor.movePosition(QTextCursor::NextCell);\n+        }\n         cursor.insertText(\"-choosedatadir\");\n         cursor.movePosition(QTextCursor::NextCell);\n         cursor.insertText(tr(\"Choose data directory on startup (default: 0)\"));"
      }
    ]
  }
]