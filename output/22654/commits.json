[
  {
    "sha": "fb17c99e35e72f3b21ec3b5473e84c21dc964776",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYjE3Yzk5ZTM1ZTcyZjNiMjFlYzNiNTQ3M2U4NGMyMWRjOTY0Nzc2",
    "commit": {
      "author": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2021-08-06T20:11:22Z"
      },
      "committer": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2021-08-19T00:07:32Z"
      },
      "message": "guix: Don't include directory name in SHA256SUMS\n\nThe SHA256SUMS file can be used in a sha256sum -c command to verify\ndownloaded binaries. However users are likely to download just a single\nfile and not place this file in the correct directory relative to the\nSHA256SUMS file for the simple verification command to work. By not\nincluding the directory name in the SHA256SUMS file, it will be easier\nfor users to verify downloaded binaries.\n\nCo-authored-by: Carl Dong <contact@carldong.me>",
      "tree": {
        "sha": "4919f76de844b5704fe7c70a876de81c1d2719ae",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4919f76de844b5704fe7c70a876de81c1d2719ae"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fb17c99e35e72f3b21ec3b5473e84c21dc964776",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fb17c99e35e72f3b21ec3b5473e84c21dc964776",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fb17c99e35e72f3b21ec3b5473e84c21dc964776",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fb17c99e35e72f3b21ec3b5473e84c21dc964776/comments",
    "author": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "8193294caba03b996370873db79cf4fc22a1e95b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/8193294caba03b996370873db79cf4fc22a1e95b",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/8193294caba03b996370873db79cf4fc22a1e95b"
      }
    ],
    "stats": {
      "total": 14,
      "additions": 14,
      "deletions": 0
    },
    "files": [
      {
        "sha": "6e12cbead733ebac6f57244e8dfef602a99b0d27",
        "filename": "contrib/guix/guix-attest",
        "status": "modified",
        "additions": 14,
        "deletions": 0,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fb17c99e35e72f3b21ec3b5473e84c21dc964776/contrib/guix/guix-attest",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fb17c99e35e72f3b21ec3b5473e84c21dc964776/contrib/guix/guix-attest",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/guix/guix-attest?ref=fb17c99e35e72f3b21ec3b5473e84c21dc964776",
        "patch": "@@ -162,6 +162,18 @@ EOF\n echo \"Attesting to build outputs for version: '${VERSION}'\"\n echo \"\"\n \n+# Given a SHA256SUMS file as stdin that has lines like:\n+#     0ba536819b221a91d3d42e978be016aac918f40984754d74058aa0c921cd3ea6  a/b/d/c/d/s/bitcoin-22.0rc2-riscv64-linux-gnu.tar.gz\n+#     ...\n+#\n+# Replace each line's file name with its basename:\n+#     0ba536819b221a91d3d42e978be016aac918f40984754d74058aa0c921cd3ea6  bitcoin-22.0rc2-riscv64-linux-gnu.tar.gz\n+#     ...\n+#\n+basenameify_SHA256SUMS() {\n+    sed -E 's@(^[[:xdigit:]]{64}[[:space:]]+).+/([^/]+$)@\\1\\2@'\n+}\n+\n outsigdir=\"$GUIX_SIGS_REPO/$VERSION/$signer_name\"\n mkdir -p \"$outsigdir\"\n (\n@@ -174,6 +186,7 @@ mkdir -p \"$outsigdir\"\n         cat \"${noncodesigned_fragments[@]}\" \\\n             | sort -u \\\n             | sort -k2 \\\n+            | basenameify_SHA256SUMS \\\n                 > \"$temp_noncodesigned\"\n         if [ -e noncodesigned.SHA256SUMS ]; then\n             # The SHA256SUMS already exists, make sure it's exactly what we\n@@ -201,6 +214,7 @@ mkdir -p \"$outsigdir\"\n         cat \"${sha256sum_fragments[@]}\" \\\n             | sort -u \\\n             | sort -k2 \\\n+            | basenameify_SHA256SUMS \\\n                 > \"$temp_all\"\n         if [ -e all.SHA256SUMS ]; then\n             # The SHA256SUMS already exists, make sure it's exactly what we"
      }
    ]
  },
  {
    "sha": "132cae44f2d031bdaa1e459b92ec89ad585dfc9f",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxMzJjYWU0NGYyZDAzMWJkYWExZTQ1OWI5MmVjODlhZDU4NWRmYzlm",
    "commit": {
      "author": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2021-08-10T19:22:30Z"
      },
      "committer": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2021-08-19T20:48:39Z"
      },
      "message": "doc: Mention the flat directory structure for uploads\n\nThe uploaded binaries need to match the same flat directory structure of\nthe SHA256SUMS file in order for torrent downloaders to be able to\nverify the download without moving files. Mention this in the release\nprocess doc.",
      "tree": {
        "sha": "c052e5183de6a8bcc24f64b4282dd38455e6c58b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c052e5183de6a8bcc24f64b4282dd38455e6c58b"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/132cae44f2d031bdaa1e459b92ec89ad585dfc9f",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/132cae44f2d031bdaa1e459b92ec89ad585dfc9f",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/132cae44f2d031bdaa1e459b92ec89ad585dfc9f",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/132cae44f2d031bdaa1e459b92ec89ad585dfc9f/comments",
    "author": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fb17c99e35e72f3b21ec3b5473e84c21dc964776",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fb17c99e35e72f3b21ec3b5473e84c21dc964776",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fb17c99e35e72f3b21ec3b5473e84c21dc964776"
      }
    ],
    "stats": {
      "total": 13,
      "additions": 11,
      "deletions": 2
    },
    "files": [
      {
        "sha": "3e4748b742135044c73e6d3c426eb2505aa2a35c",
        "filename": "doc/release-process.md",
        "status": "modified",
        "additions": 11,
        "deletions": 2,
        "changes": 13,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/132cae44f2d031bdaa1e459b92ec89ad585dfc9f/doc/release-process.md",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/132cae44f2d031bdaa1e459b92ec89ad585dfc9f/doc/release-process.md",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/doc/release-process.md?ref=132cae44f2d031bdaa1e459b92ec89ad585dfc9f",
        "patch": "@@ -206,17 +206,26 @@ cat \"$VERSION\"/*/all.SHA256SUMS.asc > SHA256SUMS.asc\n ```\n \n \n-- Upload to the bitcoincore.org server (`/var/www/bin/bitcoin-core-${VERSION}`):\n-    1. The contents of `./bitcoin/guix-build-${VERSION}/output`, except for\n+- Upload to the bitcoincore.org server (`/var/www/bin/bitcoin-core-${VERSION}/`):\n+    1. The contents of each `./bitcoin/guix-build-${VERSION}/output/${HOST}/` directory, except for\n        `*-debug*` files.\n \n+       Guix will output all of the results into host subdirectories, but the SHA256SUMS\n+       file does not include these subdirectories. In order for downloads via torrent\n+       to verify without directory structure modification, all of the uploaded files\n+       need to be in the same directory as the SHA256SUMS file.\n+\n        The `*-debug*` files generated by the guix build contain debug symbols\n        for troubleshooting by developers. It is assumed that anyone that is\n        interested in debugging can run guix to generate the files for\n        themselves. To avoid end-user confusion about which file to pick, as well\n        as save storage space *do not upload these to the bitcoincore.org server,\n        nor put them in the torrent*.\n \n+       ```sh\n+       find guix-build-${VERSION}/output/ -maxdepth 2 -type f -not -name \"SHA256SUMS.part\" -and -not -name \"*debug*\" -exec scp {} user@bitcoincore.org:/var/www/bin/bitcoin-core-${VERSION} \\;\n+       ```\n+\n     2. The `SHA256SUMS` file\n \n     3. The `SHA256SUMS.asc` combined signature file you just created"
      }
    ]
  }
]