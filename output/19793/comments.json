[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/682070088",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19793#issuecomment-682070088",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19793",
    "id": 682070088,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY4MjA3MDA4OA==",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?u=9791e96cd4268d48e3517bac41eaf2b1d09759fd&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-27T16:55:42Z",
    "updated_at": "2020-08-27T16:55:42Z",
    "author_association": "MEMBER",
    "body": "ACK c4deddb3c5806d524e71c344be083b8bd6ea50aa",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/682070088/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/931573792",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19793#issuecomment-931573792",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/19793",
    "id": 931573792,
    "node_id": "IC_kwDOABII5843hrAg",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-30T18:44:55Z",
    "updated_at": "2021-09-30T18:44:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Closing this since it's out of date and has some odd behaviors. Things it would be nice to do if someone wants to clean this code up:\r\n> \r\n>1. Replace assert(new_tx) with error handling that triggers the [`CWallet::Create` \"Wallet Corrupted\"](https://github.com/bitcoin/bitcoin/blob/b46f37ba5ec4fbd2e4c82343fc4f353d7f34837a/src/wallet/wallet.cpp#L3824) error\r\n> \r\n>2. Fix the \"This error is recoverable with zapwallettxs\" comment now that zapwallettxs is removed.\r\n> \r\n>3. Make the TOO_NEW error take precedence over the CORRUPT error or enforce some other consistent precedence\r\n> \r\n>4. Replace `SoftSetBoolArg(\"-rescan\", true)` with a `rescan_required` return value so one wallet requiring a rescan doesn't cause other wallets to be rescanned\r\n\r\n1-3 seems to be handled by #23142 and 4 seems to be handled by #23123\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/931573792/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/476279364",
    "pull_request_review_id": 474262517,
    "id": 476279364,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjI3OTM2NA==",
    "diff_hunk": "@@ -286,7 +287,12 @@ ReadKeyValue(CWallet* pwallet, CDataStream& ssKey, CDataStream& ssValue,\n             // LoadToWallet call below creates a new CWalletTx that fill_wtx\n             // callback fills with transaction metadata.\n             auto fill_wtx = [&](CWalletTx& wtx, bool new_tx) {\n-                assert(new_tx);\n+                if (!new_tx) {\n+                    // There's probably some corruption here since the tx we just tried to load was already in the wallet\n+                    // This error is recoverable with zapwallettxs and is not a major failure",
    "path": "src/wallet/walletdb.cpp",
    "position": 15,
    "original_position": 15,
    "commit_id": "c4deddb3c5806d524e71c344be083b8bd6ea50aa",
    "original_commit_id": "8e734a13d8d3f055740826a7c433ab8c988331fc",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Isn't zapwallettxs about to be removed?",
    "created_at": "2020-08-25T08:41:05Z",
    "updated_at": "2020-08-25T18:40:57Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19793#discussion_r476279364",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19793",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/476279364"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19793#discussion_r476279364"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19793"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/476279364/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 292,
    "original_line": 292,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/476548360",
    "pull_request_review_id": 474610928,
    "id": 476548360,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjU0ODM2MA==",
    "diff_hunk": "@@ -286,7 +287,12 @@ ReadKeyValue(CWallet* pwallet, CDataStream& ssKey, CDataStream& ssValue,\n             // LoadToWallet call below creates a new CWalletTx that fill_wtx\n             // callback fills with transaction metadata.\n             auto fill_wtx = [&](CWalletTx& wtx, bool new_tx) {\n-                assert(new_tx);\n+                if (!new_tx) {\n+                    // There's probably some corruption here since the tx we just tried to load was already in the wallet\n+                    // This error is recoverable with zapwallettxs and is not a major failure",
    "path": "src/wallet/walletdb.cpp",
    "position": 15,
    "original_position": 15,
    "commit_id": "c4deddb3c5806d524e71c344be083b8bd6ea50aa",
    "original_commit_id": "8e734a13d8d3f055740826a7c433ab8c988331fc",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I guess here's an argument to keep it.\r\n\r\nThe question is really whether it is possible to hit this error in normal operation.",
    "created_at": "2020-08-25T15:42:19Z",
    "updated_at": "2020-08-25T18:40:57Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19793#discussion_r476548360",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19793",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/476548360"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19793#discussion_r476548360"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19793"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/476548360/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 292,
    "original_line": 292,
    "side": "RIGHT",
    "in_reply_to_id": 476279364
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/476575086",
    "pull_request_review_id": 474646226,
    "id": 476575086,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjU3NTA4Ng==",
    "diff_hunk": "@@ -286,7 +287,12 @@ ReadKeyValue(CWallet* pwallet, CDataStream& ssKey, CDataStream& ssValue,\n             // LoadToWallet call below creates a new CWalletTx that fill_wtx\n             // callback fills with transaction metadata.\n             auto fill_wtx = [&](CWalletTx& wtx, bool new_tx) {\n-                assert(new_tx);\n+                if (!new_tx) {\n+                    // There's probably some corruption here since the tx we just tried to load was already in the wallet\n+                    // This error is recoverable with zapwallettxs and is not a major failure",
    "path": "src/wallet/walletdb.cpp",
    "position": 15,
    "original_position": 15,
    "commit_id": "c4deddb3c5806d524e71c344be083b8bd6ea50aa",
    "original_commit_id": "8e734a13d8d3f055740826a7c433ab8c988331fc",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The test #19078 is hitting it. Does salvagewallet count as \"normal operation\"? If not, it should probably be removed.",
    "created_at": "2020-08-25T16:21:43Z",
    "updated_at": "2020-08-25T18:40:57Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19793#discussion_r476575086",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19793",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/476575086"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19793#discussion_r476575086"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19793"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/476575086/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 292,
    "original_line": 292,
    "side": "RIGHT",
    "in_reply_to_id": 476279364
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/476583114",
    "pull_request_review_id": 474656375,
    "id": 476583114,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjU4MzExNA==",
    "diff_hunk": "@@ -286,7 +287,12 @@ ReadKeyValue(CWallet* pwallet, CDataStream& ssKey, CDataStream& ssValue,\n             // LoadToWallet call below creates a new CWalletTx that fill_wtx\n             // callback fills with transaction metadata.\n             auto fill_wtx = [&](CWalletTx& wtx, bool new_tx) {\n-                assert(new_tx);\n+                if (!new_tx) {\n+                    // There's probably some corruption here since the tx we just tried to load was already in the wallet\n+                    // This error is recoverable with zapwallettxs and is not a major failure",
    "path": "src/wallet/walletdb.cpp",
    "position": 15,
    "original_position": 15,
    "commit_id": "c4deddb3c5806d524e71c344be083b8bd6ea50aa",
    "original_commit_id": "8e734a13d8d3f055740826a7c433ab8c988331fc",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Looking at it further, it is surprising to me that #19078 hits this error because it shouldn't have any transactions left after the salvage. Salvage is supposed to only extract keys. This indicates that salvage has an additional bug somewhere.",
    "created_at": "2020-08-25T16:33:50Z",
    "updated_at": "2020-08-25T18:40:57Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19793#discussion_r476583114",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19793",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/476583114"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19793#discussion_r476583114"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19793"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/476583114/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 292,
    "original_line": 292,
    "side": "RIGHT",
    "in_reply_to_id": 476279364
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/476588885",
    "pull_request_review_id": 474663954,
    "id": 476588885,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjU4ODg4NQ==",
    "diff_hunk": "@@ -286,7 +287,12 @@ ReadKeyValue(CWallet* pwallet, CDataStream& ssKey, CDataStream& ssValue,\n             // LoadToWallet call below creates a new CWalletTx that fill_wtx\n             // callback fills with transaction metadata.\n             auto fill_wtx = [&](CWalletTx& wtx, bool new_tx) {\n-                assert(new_tx);\n+                if (!new_tx) {\n+                    // There's probably some corruption here since the tx we just tried to load was already in the wallet\n+                    // This error is recoverable with zapwallettxs and is not a major failure",
    "path": "src/wallet/walletdb.cpp",
    "position": 15,
    "original_position": 15,
    "commit_id": "c4deddb3c5806d524e71c344be083b8bd6ea50aa",
    "original_commit_id": "8e734a13d8d3f055740826a7c433ab8c988331fc",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Oh, the error is because `ReadKeyValue` is called by salvage so it's happening during the salvage, rather than during the loading of the wallet post-salvage.",
    "created_at": "2020-08-25T16:43:16Z",
    "updated_at": "2020-08-25T18:40:57Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19793#discussion_r476588885",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19793",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/476588885"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19793#discussion_r476588885"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19793"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/476588885/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 292,
    "original_line": 292,
    "side": "RIGHT",
    "in_reply_to_id": 476279364
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/476620525",
    "pull_request_review_id": 474703742,
    "id": 476620525,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjYyMDUyNQ==",
    "diff_hunk": "@@ -286,7 +287,12 @@ ReadKeyValue(CWallet* pwallet, CDataStream& ssKey, CDataStream& ssValue,\n             // LoadToWallet call below creates a new CWalletTx that fill_wtx\n             // callback fills with transaction metadata.\n             auto fill_wtx = [&](CWalletTx& wtx, bool new_tx) {\n-                assert(new_tx);\n+                if (!new_tx) {\n+                    // There's probably some corruption here since the tx we just tried to load was already in the wallet\n+                    // This error is recoverable with zapwallettxs and is not a major failure",
    "path": "src/wallet/walletdb.cpp",
    "position": 15,
    "original_position": 15,
    "commit_id": "c4deddb3c5806d524e71c344be083b8bd6ea50aa",
    "original_commit_id": "8e734a13d8d3f055740826a7c433ab8c988331fc",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "#19805 is a fix to #19078's failure that sidesteps this problem entirely.",
    "created_at": "2020-08-25T17:30:30Z",
    "updated_at": "2020-08-25T18:40:57Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19793#discussion_r476620525",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19793",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/476620525"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19793#discussion_r476620525"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19793"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/476620525/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 292,
    "original_line": 292,
    "side": "RIGHT",
    "in_reply_to_id": 476279364
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/476645340",
    "pull_request_review_id": 474735274,
    "id": 476645340,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ3NjY0NTM0MA==",
    "diff_hunk": "@@ -286,7 +287,12 @@ ReadKeyValue(CWallet* pwallet, CDataStream& ssKey, CDataStream& ssValue,\n             // LoadToWallet call below creates a new CWalletTx that fill_wtx\n             // callback fills with transaction metadata.\n             auto fill_wtx = [&](CWalletTx& wtx, bool new_tx) {\n-                assert(new_tx);\n+                if (!new_tx) {\n+                    // There's probably some corruption here since the tx we just tried to load was already in the wallet\n+                    // This error is recoverable with zapwallettxs and is not a major failure",
    "path": "src/wallet/walletdb.cpp",
    "position": 15,
    "original_position": 15,
    "commit_id": "c4deddb3c5806d524e71c344be083b8bd6ea50aa",
    "original_commit_id": "8e734a13d8d3f055740826a7c433ab8c988331fc",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "re: https://github.com/bitcoin/bitcoin/pull/19793#discussion_r476588885\r\n\r\n> #19805 is a fix to #19078's failure that sidesteps this problem entirely.\r\n\r\n#19805 seems like a better way to fix the test failure. In case we want to merge this PR as well to remove the bad assert https://github.com/bitcoin/bitcoin/pull/19793#pullrequestreview-474262517, I updated the comment, just changing \"There's probably some corruption\" to \"There's some corruption\"",
    "created_at": "2020-08-25T18:14:08Z",
    "updated_at": "2020-08-25T18:53:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19793#discussion_r476645340",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19793",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/476645340"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19793#discussion_r476645340"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19793"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/476645340/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 292,
    "original_line": 292,
    "side": "RIGHT",
    "in_reply_to_id": 476279364
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500937452",
    "pull_request_review_id": 503780457,
    "id": 500937452,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwMDkzNzQ1Mg==",
    "diff_hunk": "@@ -726,7 +732,7 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n             {\n                 // losing keys is considered a catastrophic error, anything else\n                 // we assume the user can live with:\n-                if (IsKeyType(strType) || strType == DBKeys::DEFAULTKEY) {\n+                if (wss.corrupt || IsKeyType(strType) || strType == DBKeys::DEFAULTKEY) {\n                     result = DBErrors::CORRUPT;\n                 } else if (strType == DBKeys::FLAGS) {\n                     // reading the wallet flags can only fail if unknown flags are present",
    "path": "src/wallet/walletdb.cpp",
    "position": 30,
    "original_position": 30,
    "commit_id": "c4deddb3c5806d524e71c344be083b8bd6ea50aa",
    "original_commit_id": "c4deddb3c5806d524e71c344be083b8bd6ea50aa",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "should the other corruption reasons also latch to true?\r\n\r\n`wss.corrupt` would never be set to false, so the error `TOO_NEW` is translated to the error `CORRUPT` (after at least one CORRUPT error).\r\n\r\nWith a lost key this doesn't seem to happen and the error might be rewritten to TOO_NEW.\r\n\r\nProbably doesn't matter in practice, but I wanted to ask to be sure.",
    "created_at": "2020-10-07T11:29:09Z",
    "updated_at": "2020-10-07T11:29:09Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19793#discussion_r500937452",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19793",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500937452"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19793#discussion_r500937452"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19793"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/500937452/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 738,
    "original_line": 738,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/509780060",
    "pull_request_review_id": 514245553,
    "id": 509780060,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUwOTc4MDA2MA==",
    "diff_hunk": "@@ -726,7 +732,7 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n             {\n                 // losing keys is considered a catastrophic error, anything else\n                 // we assume the user can live with:\n-                if (IsKeyType(strType) || strType == DBKeys::DEFAULTKEY) {\n+                if (wss.corrupt || IsKeyType(strType) || strType == DBKeys::DEFAULTKEY) {\n                     result = DBErrors::CORRUPT;\n                 } else if (strType == DBKeys::FLAGS) {\n                     // reading the wallet flags can only fail if unknown flags are present",
    "path": "src/wallet/walletdb.cpp",
    "position": 30,
    "original_position": 30,
    "commit_id": "c4deddb3c5806d524e71c344be083b8bd6ea50aa",
    "original_commit_id": "c4deddb3c5806d524e71c344be083b8bd6ea50aa",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "re: https://github.com/bitcoin/bitcoin/pull/19793#discussion_r500937452\r\n\r\n> should the other corruption reasons also latch to true?\r\n> \r\n> `wss.corrupt` would never be set to false, so the error `TOO_NEW` is translated to the error `CORRUPT` (after at least one CORRUPT error).\r\n> \r\n> With a lost key this doesn't seem to happen and the error might be rewritten to TOO_NEW.\r\n> \r\n> Probably doesn't matter in practice, but I wanted to ask to be sure.\r\n\r\nLooking at the calling code, in practice the wallet will fail to load either way if TOO_NEW or CORRUPT is returned, only the error text will be different. It's not even a new thing for the CORRUPT error to take priority over the TOO_NEW error since it can also happen in other the places `result = DBErrors::CORRUPT` is set below.\r\n\r\nBut one somewhat ugly side effect of this is it can make `gArgs.SoftSetBoolArg(\"-rescan\", true)` line not get called consistency. It would really be better not to do this and for rescan status were passed back more directly, but that requires more changes outside the file.\r\n\r\n",
    "created_at": "2020-10-21T22:53:30Z",
    "updated_at": "2020-10-21T23:04:43Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19793#discussion_r509780060",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19793",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/509780060"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19793#discussion_r509780060"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19793"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/509780060/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 738,
    "original_line": 738,
    "side": "RIGHT",
    "in_reply_to_id": 500937452
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511601374",
    "pull_request_review_id": 516362250,
    "id": 511601374,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUxMTYwMTM3NA==",
    "diff_hunk": "@@ -726,7 +732,7 @@ DBErrors WalletBatch::LoadWallet(CWallet* pwallet)\n             {\n                 // losing keys is considered a catastrophic error, anything else\n                 // we assume the user can live with:\n-                if (IsKeyType(strType) || strType == DBKeys::DEFAULTKEY) {\n+                if (wss.corrupt || IsKeyType(strType) || strType == DBKeys::DEFAULTKEY) {",
    "path": "src/wallet/walletdb.cpp",
    "position": 27,
    "original_position": 27,
    "commit_id": "c4deddb3c5806d524e71c344be083b8bd6ea50aa",
    "original_commit_id": "c4deddb3c5806d524e71c344be083b8bd6ea50aa",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "A corrupt/missing transaction isn't supposed to follow this path, but rather the one below which simply triggers a rescan.",
    "created_at": "2020-10-25T14:04:17Z",
    "updated_at": "2020-10-25T14:04:25Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/19793#discussion_r511601374",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19793",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511601374"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/19793#discussion_r511601374"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/19793"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/511601374/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 735,
    "original_line": 735,
    "side": "RIGHT"
  }
]