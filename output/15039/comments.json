[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/450348299",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15039#issuecomment-450348299",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/15039",
    "id": 450348299,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MDM0ODI5OQ==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-28T11:57:31Z",
    "updated_at": "2018-12-28T11:57:31Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#14711](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14711.html) (Remove uses of chainActive and mapBlockIndex in wallet code by ryanofsky)\n* [#10973](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/10973.html) (Refactor: separate wallet from node by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/450348299/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/450907291",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15039#issuecomment-450907291",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/15039",
    "id": 450907291,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MDkwNzI5MQ==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-02T16:16:45Z",
    "updated_at": "2019-01-02T16:16:45Z",
    "author_association": "MEMBER",
    "body": "Concept ACK\r\n\r\n> This is fine, as long as our node is connected to other nodes. \r\n\r\nI remember this was one of the remarks back then too. Anti-fee sniping only makes sense if it's catched up with the chain.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/450907291/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/452330694",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15039#issuecomment-452330694",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/15039",
    "id": 452330694,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MjMzMDY5NA==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-08T15:05:57Z",
    "updated_at": "2019-01-08T15:05:57Z",
    "author_association": "MEMBER",
    "body": "utACK https://github.com/bitcoin/bitcoin/pull/15039/commits/fa48baf23eb2ec5e9b71e3e07c24432fc1fed39c",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/452330694/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/453255635",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15039#issuecomment-453255635",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/15039",
    "id": 453255635,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1MzI1NTYzNQ==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-10T21:12:43Z",
    "updated_at": "2019-01-10T21:12:43Z",
    "author_association": "MEMBER",
    "body": "Unrelated also the same dataset (blocks 545k-555k (both inclusive), excl. coinbase) in a different representation:\r\n\r\n![distribution of height-based tx locktimes](https://user-images.githubusercontent.com/6399679/50997370-ac959180-1524-11e9-9dc6-584834776628.png)\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/453255635/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/454435629",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15039#issuecomment-454435629",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/15039",
    "id": 454435629,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NDQzNTYyOQ==",
    "user": {
      "login": "keystrike",
      "id": 2402779,
      "node_id": "MDQ6VXNlcjI0MDI3Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2402779?u=87aa6e3b0edceedf875ba928145e60e8a04fe68c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/keystrike",
      "html_url": "https://github.com/keystrike",
      "followers_url": "https://api.github.com/users/keystrike/followers",
      "following_url": "https://api.github.com/users/keystrike/following{/other_user}",
      "gists_url": "https://api.github.com/users/keystrike/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/keystrike/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/keystrike/subscriptions",
      "organizations_url": "https://api.github.com/users/keystrike/orgs",
      "repos_url": "https://api.github.com/users/keystrike/repos",
      "events_url": "https://api.github.com/users/keystrike/events{/privacy}",
      "received_events_url": "https://api.github.com/users/keystrike/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-15T15:35:20Z",
    "updated_at": "2019-01-15T15:35:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for fixing this. My analysis from 2017 is [here](https://github.com/bitcoin/bitcoin/issues/10020#issuecomment-311339203), although the full output text file is no longer online. I had looked at all blocks to mid-2017. At that time there were 33 old locktimes in the blockchain in 94 transactions.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/454435629/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/244057252",
    "pull_request_review_id": 187970555,
    "id": 244057252,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0NDA1NzI1Mg==",
    "diff_hunk": "@@ -2599,8 +2613,15 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n     if (GetRandInt(10) == 0)\n         txNew.nLockTime = std::max(0, (int)txNew.nLockTime - GetRandInt(100));\n \n+    // If our chain is lagging behind, we can't discourage fee sniping nor help\n+    // the privacy of high-latency transactions. To avoid leaking a potentially\n+    // unique \"nLockTime fingerprint\", set nLockTime to a constant.\n+    if (!IsCurrentForAntiFeeSniping()) txNew.nLockTime = 0;",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 35,
    "commit_id": "fa48baf23eb2ec5e9b71e3e07c24432fc1fed39c",
    "original_commit_id": "fa6cb28ff01430e4992d5bfc8c19c782b58adc98",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Why not just skip the above setting it?",
    "created_at": "2018-12-26T22:37:57Z",
    "updated_at": "2018-12-27T12:04:01Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15039#discussion_r244057252",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15039",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/244057252"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15039#discussion_r244057252"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15039"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/244057252/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2619,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/244064206",
    "pull_request_review_id": 187978951,
    "id": 244064206,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0NDA2NDIwNg==",
    "diff_hunk": "@@ -2544,6 +2544,18 @@ OutputType CWallet::TransactionChangeType(OutputType change_type, const std::vec\n     return m_default_address_type;\n }\n \n+static bool IsCurrentForAntiFeeSniping() EXCLUSIVE_LOCKS_REQUIRED(cs_main)\n+{\n+    if (IsInitialBlockDownload()) {\n+        return false;\n+    }\n+    constexpr int64_t MAX_ANTI_FEE_SNIPING_TIP_AGE = 8 * 60 * 60; // in seconds\n+    if (chainActive.Tip()->GetBlockTime() < (GetTime() - MAX_ANTI_FEE_SNIPING_TIP_AGE)) {",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 10,
    "commit_id": "fa48baf23eb2ec5e9b71e3e07c24432fc1fed39c",
    "original_commit_id": "fa7c5c7eefb58208a15dd392d38f773d1b0247e0",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: could return this directly (inverted)",
    "created_at": "2018-12-27T00:27:25Z",
    "updated_at": "2018-12-27T12:04:01Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15039#discussion_r244064206",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15039",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/244064206"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15039#discussion_r244064206"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15039"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/244064206/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2553,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/244962820",
    "pull_request_review_id": 188964501,
    "id": 244962820,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0NDk2MjgyMA==",
    "diff_hunk": "@@ -2516,6 +2516,65 @@ bool CWallet::FundTransaction(CMutableTransaction& tx, CAmount& nFeeRet, int& nC\n     return true;\n }\n \n+static bool IsCurrentForAntiFeeSniping(interfaces::Chain::Lock& locked_chain)\n+{\n+    if (IsInitialBlockDownload()) {\n+        return false;\n+    }\n+    constexpr int64_t MAX_ANTI_FEE_SNIPING_TIP_AGE = 8 * 60 * 60; // in seconds",
    "path": "src/wallet/wallet.cpp",
    "position": 9,
    "original_position": 9,
    "commit_id": "fa48baf23eb2ec5e9b71e3e07c24432fc1fed39c",
    "original_commit_id": "fa48baf23eb2ec5e9b71e3e07c24432fc1fed39c",
    "user": {
      "login": "meshcollider",
      "id": 3211283,
      "node_id": "MDQ6VXNlcjMyMTEyODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3211283?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/meshcollider",
      "html_url": "https://github.com/meshcollider",
      "followers_url": "https://api.github.com/users/meshcollider/followers",
      "following_url": "https://api.github.com/users/meshcollider/following{/other_user}",
      "gists_url": "https://api.github.com/users/meshcollider/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/meshcollider/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/meshcollider/subscriptions",
      "organizations_url": "https://api.github.com/users/meshcollider/orgs",
      "repos_url": "https://api.github.com/users/meshcollider/repos",
      "events_url": "https://api.github.com/users/meshcollider/events{/privacy}",
      "received_events_url": "https://api.github.com/users/meshcollider/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Any rationale on why 8 hours was chosen? Seems sane though",
    "created_at": "2019-01-03T10:45:10Z",
    "updated_at": "2019-01-03T10:45:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15039#discussion_r244962820",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15039",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/244962820"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15039#discussion_r244962820"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15039"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/244962820/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2524,
    "original_line": 2524,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/245236134",
    "pull_request_review_id": 189288772,
    "id": 245236134,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0NTIzNjEzNA==",
    "diff_hunk": "@@ -2516,6 +2516,65 @@ bool CWallet::FundTransaction(CMutableTransaction& tx, CAmount& nFeeRet, int& nC\n     return true;\n }\n \n+static bool IsCurrentForAntiFeeSniping(interfaces::Chain::Lock& locked_chain)\n+{\n+    if (IsInitialBlockDownload()) {\n+        return false;\n+    }\n+    constexpr int64_t MAX_ANTI_FEE_SNIPING_TIP_AGE = 8 * 60 * 60; // in seconds\n+    if (chainActive.Tip()->GetBlockTime() < (GetTime() - MAX_ANTI_FEE_SNIPING_TIP_AGE)) {\n+        return false;\n+    }\n+    return true;\n+}\n+\n+/**\n+ * Return a height-based locktime for new transactions (uses the height of the\n+ * current chain tip unless we are not synced with the current chain\n+ */\n+static uint32_t GetLocktimeForNewTransaction(interfaces::Chain::Lock& locked_chain)\n+{\n+    uint32_t locktime;\n+    // Discourage fee sniping.\n+    //\n+    // For a large miner the value of the transactions in the best block and\n+    // the mempool can exceed the cost of deliberately attempting to mine two\n+    // blocks to orphan the current best block. By setting nLockTime such that\n+    // only the next block can include the transaction, we discourage this\n+    // practice as the height restricted and limited blocksize gives miners\n+    // considering fee sniping fewer options for pulling off this attack.\n+    //\n+    // A simple way to think about this is from the wallet's point of view we\n+    // always want the blockchain to move forward. By setting nLockTime this\n+    // way we're basically making the statement that we only want this\n+    // transaction to appear in the next block; we don't want to potentially\n+    // encourage reorgs by allowing transactions to appear at lower heights\n+    // than the next block in forks of the best chain.\n+    //\n+    // Of course, the subsidy is high enough, and transaction volume low\n+    // enough, that fee sniping isn't a problem yet, but by implementing a fix\n+    // now we ensure code won't be written that makes assumptions about\n+    // nLockTime that preclude a fix later.\n+    if (IsCurrentForAntiFeeSniping(locked_chain)) {\n+        locktime = chainActive.Height();\n+\n+        // Secondly occasionally randomly pick a nLockTime even further back, so\n+        // that transactions that are delayed after signing for whatever reason,\n+        // e.g. high-latency mix networks and some CoinJoin implementations, have\n+        // better privacy.\n+        if (GetRandInt(10) == 0)",
    "path": "src/wallet/wallet.cpp",
    "position": 50,
    "original_position": 50,
    "commit_id": "fa48baf23eb2ec5e9b71e3e07c24432fc1fed39c",
    "original_commit_id": "fa48baf23eb2ec5e9b71e3e07c24432fc1fed39c",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This `if` needs `{}` but I understand if you prefer to keep this move-only.",
    "created_at": "2019-01-04T08:30:29Z",
    "updated_at": "2019-01-04T08:30:29Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15039#discussion_r245236134",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15039",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/245236134"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15039#discussion_r245236134"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15039"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/245236134/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2565,
    "original_line": 2565,
    "side": "RIGHT"
  }
]