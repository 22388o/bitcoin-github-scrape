[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/778494756",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-778494756",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 778494756,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3ODQ5NDc1Ng==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-12T22:39:57Z",
    "updated_at": "2021-11-28T08:29:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#23604](https://github.com/bitcoin/bitcoin/pull/23604) (Use Sock in CNode by vasild)\n* [#23575](https://github.com/bitcoin/bitcoin/pull/23575) (fuzz: Rework FillNode by MarcoFalke)\n* [#23546](https://github.com/bitcoin/bitcoin/pull/23546) (scripted-diff: Use clang-tidy syntax for C++ named arguments (tests only) by MarcoFalke)\n* [#22778](https://github.com/bitcoin/bitcoin/pull/22778) (net processing: Reduce resource usage for inbound block-relay-only connections by jnewbery)\n* [#22777](https://github.com/bitcoin/bitcoin/pull/22777) (net processing: don't request tx relay on feeler connections by jnewbery)\n* [#22053](https://github.com/bitcoin/bitcoin/pull/22053) (refactor: Release cs_main before MaybeSendFeefilter by MarcoFalke)\n* [#21878](https://github.com/bitcoin/bitcoin/pull/21878) (Make all networking code mockable by vasild)\n* [#21515](https://github.com/bitcoin/bitcoin/pull/21515) (Erlay: bandwidth-efficient transaction relay protocol by naumenkogs)\n* [#19499](https://github.com/bitcoin/bitcoin/pull/19499) (p2p: Make timeout mockable and type safe, speed up test by MarcoFalke)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/778494756/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/783204949",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-783204949",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 783204949,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MzIwNDk0OQ==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-22T08:48:27Z",
    "updated_at": "2021-02-22T08:48:27Z",
    "author_association": "MEMBER",
    "body": "Rebased on master to pick up fix for interface_zmq.py in #21008.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/783204949/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/783605323",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-783605323",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 783605323,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MzYwNTMyMw==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-22T19:10:33Z",
    "updated_at": "2021-02-22T19:10:33Z",
    "author_association": "MEMBER",
    "body": "Rebase resulted in silent merge conflict with 9476886353dffb730dcb75799f2bd5e143425795. I'll fix tomorrow.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/783605323/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/801832376",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-801832376",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 801832376,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwMTgzMjM3Ng==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-18T11:06:41Z",
    "updated_at": "2021-03-18T11:06:41Z",
    "author_association": "MEMBER",
    "body": "I've rebased this and moved it out of draft. It's now ready for review.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/801832376/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/803279260",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-803279260",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 803279260,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwMzI3OTI2MA==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-20T09:31:54Z",
    "updated_at": "2021-03-20T09:31:54Z",
    "author_association": "MEMBER",
    "body": "Rebased",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/803279260/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/803869071",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-803869071",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 803869071,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwMzg2OTA3MQ==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-22T08:31:02Z",
    "updated_at": "2021-03-22T08:31:02Z",
    "author_association": "MEMBER",
    "body": "Doesn't compile",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/803869071/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/803914027",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-803914027",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 803914027,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwMzkxNDAyNw==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-22T09:34:55Z",
    "updated_at": "2021-03-22T09:34:55Z",
    "author_association": "MEMBER",
    "body": "Thanks Marco. Bad rebase should be fixed now.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/803914027/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/803929392",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-803929392",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 803929392,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwMzkyOTM5Mg==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-22T09:54:23Z",
    "updated_at": "2021-03-22T09:54:23Z",
    "author_association": "MEMBER",
    "body": "Thanks for the review @vasild! I think I've addressed all of your review comments now.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/803929392/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/803931983",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-803931983",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 803931983,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwMzkzMTk4Mw==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-22T09:57:42Z",
    "updated_at": "2021-03-22T09:57:42Z",
    "author_association": "MEMBER",
    "body": "> It seems sub-optimal that new fields are added - CNode::m_relays_txs and CNode::m_bloom_filter_loaded that are redundant/duplicates of Peer::TxRelay::m_relay_txs and Peer::TxRelay::m_bloom_filter != nullptr. This could be confusing and leaves a chance that in the future they go out of sync. Can the duplicates be avoided somehow?\r\n\r\nThat does seem a bit of a shame, but note that even though the data seems redundant, it's used for different purposes in net_processing and net. TxRelay in net_processing is data that is used in relaying transactions to that peer. `m_relay_txs` and `m_bloom_filter` in net are simply metrics used in the eviction logic. net_processing informs net of any events that might be used in net's eviction logic (e.g. min ping time, last tx received, last block received), and these new metrics (m_relay_txs and m_bloom_filter) are no different from those.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/803931983/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/804745886",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-804745886",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 804745886,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwNDc0NTg4Ng==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-23T09:18:02Z",
    "updated_at": "2021-03-23T09:18:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "Reviewed 66baf28fe2b76d3f214714604e9e24e83f16c20e - the patch looks correct and I do not think it introduces bugs.\r\n\r\nI will try to see when the [UI](https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597831033) and [RPC](https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597832782) fields could become empty/missing when they would have been filled/present before this PR.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/804745886/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/804795139",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-804795139",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 804795139,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwNDc5NTEzOQ==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-23T10:35:10Z",
    "updated_at": "2021-03-23T10:35:18Z",
    "author_association": "MEMBER",
    "body": "Thanks for the re-review @vasild. I've updated the commits to address https://github.com/bitcoin/bitcoin/pull/21160#discussion_r599387582.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/804795139/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/809304938",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-809304938",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 809304938,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwOTMwNDkzOA==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-29T11:30:48Z",
    "updated_at": "2021-03-29T11:30:48Z",
    "author_association": "MEMBER",
    "body": "Rebased",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/809304938/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/810374111",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-810374111",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 810374111,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxMDM3NDExMQ==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-30T15:48:27Z",
    "updated_at": "2021-03-30T15:48:27Z",
    "author_association": "MEMBER",
    "body": "rebased",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/810374111/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/811736077",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-811736077",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 811736077,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxMTczNjA3Nw==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-01T08:16:42Z",
    "updated_at": "2021-04-01T08:16:42Z",
    "author_association": "MEMBER",
    "body": "Rebased",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/811736077/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/829980035",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-829980035",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 829980035,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyOTk4MDAzNQ==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-30T09:50:46Z",
    "updated_at": "2021-04-30T09:50:46Z",
    "author_association": "MEMBER",
    "body": "Thanks for the review @glozow. I've rebased on master and addressed your review comments.\r\n\r\n#21527 moves around the locks in net_processing, which interacts a bit with how this PR moves `m_wtxid_relay` around. I think it makes sense to focus on merging that PR first, since that could simplify the locking here a bit.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/829980035/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/831142707",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-831142707",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 831142707,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgzMTE0MjcwNw==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-03T09:34:05Z",
    "updated_at": "2021-05-03T09:34:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--4a62be1de6b64f3ed646cdc7932c8cf5-->\n\ud83d\udd75\ufe0f @sipa has been requested to review this pull request as specified in the REVIEWERS file.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/831142707/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/831184841",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-831184841",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 831184841,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgzMTE4NDg0MQ==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-03T10:55:48Z",
    "updated_at": "2021-05-03T10:55:48Z",
    "author_association": "MEMBER",
    "body": "I'll rebase this after #21527 is merged",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/831184841/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/850312983",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-850312983",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 850312983,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg1MDMxMjk4Mw==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-28T10:14:57Z",
    "updated_at": "2021-07-28T14:54:54Z",
    "author_association": "MEMBER",
    "body": "I've rebased this on top of the _net_processing: add m_mutex_message_handling_ commit from #21527. I'm leaving as WIP for now, but it's in a state where people can review it. I'll move it out of draft as soon as #21527 or #22053 is merged (should be a trivial rebase).",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/850312983/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/898357737",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-898357737",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 898357737,
    "node_id": "IC_kwDOABII5841i9np",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-13T10:25:16Z",
    "updated_at": "2021-08-13T10:25:16Z",
    "author_association": "MEMBER",
    "body": "I'd rebased this on top of some of the work in #21527, since they conflicted a little. However, it seems that 21527 has now been abandoned, so I've removed that commit and marked this PR ready for review again. If 21527 does get picked up again and merged, then it should be easy enough to rebase this on top of it.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/898357737/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/899514121",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-899514121",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 899514121,
    "node_id": "IC_kwDOABII5841nX8J",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-16T13:32:02Z",
    "updated_at": "2021-08-16T13:32:02Z",
    "author_association": "MEMBER",
    "body": "Rebased on master",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/899514121/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/901924846",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-901924846",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 901924846,
    "node_id": "IC_kwDOABII5841wkfu",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-19T13:40:20Z",
    "updated_at": "2021-08-19T13:40:20Z",
    "author_association": "MEMBER",
    "body": "Thanks for the review @vasild. I understand your arguments about the extra fields in `CNode` and removing the stats from the GUI and RPC when they're not available. I don't have anything to add beyond my responses from the first time you raised those points.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/901924846/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/902052740",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-902052740",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 902052740,
    "node_id": "IC_kwDOABII5841xDuE",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-19T16:22:00Z",
    "updated_at": "2021-08-19T16:22:00Z",
    "author_association": "MEMBER",
    "body": "> Thanks for the review @vasild. I understand your arguments about the extra fields in `CNode` and removing the stats from the GUI and RPC when they're not available.\r\n\r\n(If helpful, mentioning https://github.com/bitcoin/bitcoin/pull/21160#discussion_r692284808 here, as that thread is closed as resolved.)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/902052740/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/903570095",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-903570095",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 903570095,
    "node_id": "IC_kwDOABII584122Kv",
    "user": {
      "login": "glozow",
      "id": 25183001,
      "node_id": "MDQ6VXNlcjI1MTgzMDAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25183001?u=3e27bc6589085f3450be1b0e969d04008cc77565&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/glozow",
      "html_url": "https://github.com/glozow",
      "followers_url": "https://api.github.com/users/glozow/followers",
      "following_url": "https://api.github.com/users/glozow/following{/other_user}",
      "gists_url": "https://api.github.com/users/glozow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/glozow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
      "organizations_url": "https://api.github.com/users/glozow/orgs",
      "repos_url": "https://api.github.com/users/glozow/repos",
      "events_url": "https://api.github.com/users/glozow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/glozow/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-23T08:51:37Z",
    "updated_at": "2021-08-23T08:51:37Z",
    "author_association": "CONTRIBUTOR",
    "body": "re ACK a192c23b2cb45e7c9a06bb00714347ef38df701f via `git range-diff 2533ea5...a192c23`, no overall changes, diff moved between 2 commits.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/903570095/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/903963368",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-903963368",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 903963368,
    "node_id": "IC_kwDOABII58414WLo",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-23T17:18:54Z",
    "updated_at": "2021-08-23T17:18:54Z",
    "author_association": "MEMBER",
    "body": "rebased",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/903963368/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/905784695",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-905784695",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 905784695,
    "node_id": "IC_kwDOABII5841_S13",
    "user": {
      "login": "amitiuttarwar",
      "id": 1500952,
      "node_id": "MDQ6VXNlcjE1MDA5NTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1500952?u=f0ef8142342bcda68fe46c952d3c653456811ed4&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amitiuttarwar",
      "html_url": "https://github.com/amitiuttarwar",
      "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
      "following_url": "https://api.github.com/users/amitiuttarwar/following{/other_user}",
      "gists_url": "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
      "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
      "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
      "events_url": "https://api.github.com/users/amitiuttarwar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-25T18:45:53Z",
    "updated_at": "2021-08-25T18:45:53Z",
    "author_association": "MEMBER",
    "body": "concept ACK ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/905784695/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/907082625",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-907082625",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 907082625,
    "node_id": "IC_kwDOABII5842EPuB",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-27T10:00:14Z",
    "updated_at": "2021-08-27T10:00:14Z",
    "author_association": "MEMBER",
    "body": "rebased",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/907082625/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/910169620",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-910169620",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 910169620,
    "node_id": "IC_kwDOABII5842QBYU",
    "user": {
      "login": "glozow",
      "id": 25183001,
      "node_id": "MDQ6VXNlcjI1MTgzMDAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25183001?u=3e27bc6589085f3450be1b0e969d04008cc77565&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/glozow",
      "html_url": "https://github.com/glozow",
      "followers_url": "https://api.github.com/users/glozow/followers",
      "following_url": "https://api.github.com/users/glozow/following{/other_user}",
      "gists_url": "https://api.github.com/users/glozow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/glozow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
      "organizations_url": "https://api.github.com/users/glozow/orgs",
      "repos_url": "https://api.github.com/users/glozow/repos",
      "events_url": "https://api.github.com/users/glozow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/glozow/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-01T10:58:05Z",
    "updated_at": "2021-09-01T10:58:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "reACK 34bd2711e7ffa0d5a7b563d15d79f8ae1d8cef43 via `git range-diff a192c23...34bd271`",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/910169620/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/910173096",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-910173096",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 910173096,
    "node_id": "IC_kwDOABII5842QCOo",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?u=7297e8aaf9188c0cb98bc549a8a02a1dc8d59e4c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-01T11:02:48Z",
    "updated_at": "2021-09-01T11:02:48Z",
    "author_association": "MEMBER",
    "body": "Concept ACK.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/910173096/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/919127068",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-919127068",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 919127068,
    "node_id": "IC_kwDOABII5842yMQc",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-14T13:01:16Z",
    "updated_at": "2021-09-14T13:01:16Z",
    "author_association": "MEMBER",
    "body": "Are you still working on this?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/919127068/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/919136761",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-919136761",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 919136761,
    "node_id": "IC_kwDOABII5842yOn5",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-14T13:11:49Z",
    "updated_at": "2021-09-14T13:11:49Z",
    "author_association": "MEMBER",
    "body": "> Are you still working on this?\r\n\r\n@MarcoFalke \r\n\r\nYes. Apologies for the delay. I do intend to rebase and address your review comments soon.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/919136761/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/926529232",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-926529232",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 926529232,
    "node_id": "IC_kwDOABII5843ObbQ",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-24T10:45:02Z",
    "updated_at": "2021-09-24T10:45:02Z",
    "author_association": "MEMBER",
    "body": "Thanks for the review @MarcoFalke. I've addressed your review comments and rebased on master.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/926529232/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/930038981",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-930038981",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 930038981,
    "node_id": "IC_kwDOABII5843b0TF",
    "user": {
      "login": "naumenkogs",
      "id": 7975071,
      "node_id": "MDQ6VXNlcjc5NzUwNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7975071?u=06eb9ae4f9b3f954056098860decccbf1340e40f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naumenkogs",
      "html_url": "https://github.com/naumenkogs",
      "followers_url": "https://api.github.com/users/naumenkogs/followers",
      "following_url": "https://api.github.com/users/naumenkogs/following{/other_user}",
      "gists_url": "https://api.github.com/users/naumenkogs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
      "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
      "repos_url": "https://api.github.com/users/naumenkogs/repos",
      "events_url": "https://api.github.com/users/naumenkogs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-29T10:11:55Z",
    "updated_at": "2021-09-29T10:11:55Z",
    "author_association": "MEMBER",
    "body": "ACK ce772d53048a8d0d9934a8310dbedcbdafdc34ec\r\nA good change for better readability with no behavior changes.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/930038981/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/949633464",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-949633464",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 949633464,
    "node_id": "IC_kwDOABII5844mkG4",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-22T13:29:27Z",
    "updated_at": "2021-10-22T13:29:27Z",
    "author_association": "MEMBER",
    "body": "Rebased on master",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/949633464/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/949802862",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-949802862",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 949802862,
    "node_id": "IC_kwDOABII5844nNdu",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-22T16:51:39Z",
    "updated_at": "2021-10-22T16:51:39Z",
    "author_association": "MEMBER",
    "body": "rebased",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/949802862/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/950956810",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-950956810",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 950956810,
    "node_id": "IC_kwDOABII5844rnMK",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-25T13:58:04Z",
    "updated_at": "2021-10-25T13:59:33Z",
    "author_association": "MEMBER",
    "body": "Feedback:\r\n\r\n* https://github.com/bitcoin/bitcoin/pull/21160#discussion_r701114184\r\n* https://github.com/bitcoin/bitcoin/pull/21160#discussion_r701121335\r\n\r\nConcept ACK b0dfefec249302cd9d9f121fe081a9a51294d0ab  \ud83c\udf20\r\n\r\n<details><summary>Show signature and timestamp</summary>\r\n\r\nSignature:\r\n\r\n```\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA512\r\n\r\nConcept ACK b0dfefec249302cd9d9f121fe081a9a51294d0ab  \ud83c\udf20\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYEACgkQzit1aX5p\r\npUhy2QwAgOZpQ3kI/F3nHCLHVgGEA/5M63KOPO69nBlzM7p/gYJFYjqiZjK75dOQ\r\nKpaENaMtNwzsLyJwca+JUpBwLMjStXbP6/tfK/HnwkDMXEv5n1SMyrRs7lI12gKG\r\nIzttDNqQSAc8VeqBa5qUjPclKlrz7BxLQoaZmmhCxpDmEpaqU9YrJMtez3PTYmag\r\ndpfX+Yk57FFwrgUxXI5fnw0zWo4EwH7Xa0oiU8TeiUpd2xR0u3B4kUIL2UiGmPv5\r\nPptowC4ziKcilYu7jBnt0meUEVMnAAG1WoiL2aGnARXWatfSQRHsLqgOjonHzXuE\r\n5s2kC/1LJsWXzlY39LNO/cF0WvXShlpVuZ8V5MpJLG13HV/RhwROYhRJJVTmJeeE\r\nsXlJmWc46VA+9QXqLdNJ08qFCIbHgakHd2F5bHxV+yEtIfcR2xeHfuiVc6vFwyzW\r\nZr/WIsfQGnVagth2H5bJNZVfEavUXPnkZW0xSsTBogwsdBYiue7oqCVsQ0ANzxaf\r\nW4vi+jNl\r\n=GzKO\r\n-----END PGP SIGNATURE-----\r\n```\r\n\r\n\r\n</details>\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/950956810/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/954666132",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-954666132",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 954666132,
    "node_id": "IC_kwDOABII58445wyU",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-29T11:25:44Z",
    "updated_at": "2021-10-29T11:25:44Z",
    "author_association": "MEMBER",
    "body": "Thanks for the reviews @glozow and @theuni! I've resolved @glozow's review comment and rebased on master. I plan to address @theuni's review comments very soon.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/954666132/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/954672180",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-954672180",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 954672180,
    "node_id": "IC_kwDOABII58445yQ0",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-10-29T11:36:30Z",
    "updated_at": "2021-10-29T11:36:30Z",
    "author_association": "MEMBER",
    "body": "There is also this feedback, which you haven't responded to: https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-950956810",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/954672180/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/983659420",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#issuecomment-983659420",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21160",
    "id": 983659420,
    "node_id": "IC_kwDOABII5846oXOc",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-12-01T13:50:03Z",
    "updated_at": "2021-12-01T13:50:03Z",
    "author_association": "MEMBER",
    "body": "rebased. I still intend to address @theuni's comments.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/983659420/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597635838",
    "pull_request_review_id": 616342920,
    "id": 597635838,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzYzNTgzOA==",
    "diff_hunk": "@@ -551,34 +549,14 @@ class CNode\n     std::chrono::microseconds m_next_addr_send GUARDED_BY(cs_sendProcessing){0};\n     std::chrono::microseconds m_next_local_addr_send GUARDED_BY(cs_sendProcessing){0};\n \n-    struct TxRelay {\n-        mutable RecursiveMutex cs_filter;\n-        // We use fRelayTxes for two purposes -\n-        // a) it allows us to not relay tx invs before receiving the peer's version message\n-        // b) the peer may tell us in its version message that we should not relay tx invs\n-        //    unless it loads a bloom filter.\n-        bool fRelayTxes GUARDED_BY(cs_filter){false};\n-        std::unique_ptr<CBloomFilter> pfilter PT_GUARDED_BY(cs_filter) GUARDED_BY(cs_filter){nullptr};\n-\n-        mutable RecursiveMutex cs_tx_inventory;\n-        CRollingBloomFilter filterInventoryKnown GUARDED_BY(cs_tx_inventory){50000, 0.000001};\n-        // Set of transaction ids we still have to announce.\n-        // They are sorted by the mempool before relay, so the order is not important.\n-        std::set<uint256> setInventoryTxToSend;\n-        // Used for BIP35 mempool sending\n-        bool fSendMempool GUARDED_BY(cs_tx_inventory){false};\n-        // Last time a \"MEMPOOL\" request was serviced.\n-        std::atomic<std::chrono::seconds> m_last_mempool_req{0s};\n-        std::chrono::microseconds nNextInvSend{0};\n-\n-        /** Minimum fee rate with which to filter inv's to this node */\n-        std::atomic<CAmount> minFeeFilter{0};\n-        CAmount lastSentFeeFilter{0};\n-        std::chrono::microseconds m_next_send_feefilter{0};\n-    };\n+    /** Whether this peer asked us to relay transactions. This only changes from",
    "path": "src/net.h",
    "position": null,
    "original_position": 45,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "\r\n```suggestion\r\n    /** Whether we should relay transactions to this peer (he asked us to in his version message and this is not a `ConnectionType::BLOCK_RELAY` connection). This only changes from\r\n```",
    "created_at": "2021-03-19T12:23:21Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597635838",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597635838"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597635838"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597635838/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 552,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597653259",
    "pull_request_review_id": 616342920,
    "id": 597653259,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzY1MzI1OQ==",
    "diff_hunk": "@@ -565,12 +565,6 @@ void CNode::copyStats(CNodeStats &stats, const std::vector<bool> &m_asmap)\n     X(addrBind);",
    "path": "src/net.cpp",
    "position": 2,
    "original_position": 1,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "_(comment on irrelevant line)_\r\n\r\nIn the commit message of 465e9da51c56beaa97f5ffcdf2132471b591a8d5 `[net] Add CNode.m_relays_txs and CNode.m_bloom_filter_loaded`:\r\n\r\n```diff\r\n     This is currently redundant information with m_tx_relay->fRelayTxes,\r\n-    but m_tx_relay is moved into net_processing, then we'll need these\r\n+    but when m_tx_relay is moved into net_processing, then we'll need these\r\n     separate fields in CNode.\r\n```",
    "created_at": "2021-03-19T12:52:41Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597653259",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597653259"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597653259"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597653259/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 580,
    "original_line": 580,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597670155",
    "pull_request_review_id": 616342920,
    "id": 597670155,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzY3MDE1NQ==",
    "diff_hunk": "@@ -974,18 +963,11 @@ bool CConnman::AttemptToEvictConnection()\n                 continue;\n             if (node->fDisconnect)\n                 continue;\n-            bool peer_relay_txes = false;\n-            bool peer_filter_not_null = false;\n-            if (node->m_tx_relay != nullptr) {\n-                LOCK(node->m_tx_relay->cs_filter);\n-                peer_relay_txes = node->m_tx_relay->fRelayTxes;\n-                peer_filter_not_null = node->m_tx_relay->pfilter != nullptr;\n-            }\n             NodeEvictionCandidate candidate = {node->GetId(), node->nTimeConnected, node->m_min_ping_time,\n                                                node->nLastBlockTime, node->nLastTXTime,\n                                                HasAllDesirableServiceFlags(node->nServices),\n-                                               peer_relay_txes, peer_filter_not_null, node->nKeyedNetGroup,\n-                                               node->m_prefer_evict, node->addr.IsLocal()};\n+                                               node->m_relays_txs.load(), node->m_bloom_filter_loaded.load(),\n+                                               node->nKeyedNetGroup, node->m_prefer_evict, node->addr.IsLocal()};\n             vEvictionCandidates.push_back(candidate);",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 70,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This can be reduced to just:\r\n```cpp\r\nvEvictionCandidates.push_back(*node);\r\n```\r\nBy using a [conversion function](https://en.cppreference.com/w/cpp/language/cast_operator) from `CNode` to `NodeEvictionCandidate`.\r\n\r\nMaybe out of the scope of this PR.",
    "created_at": "2021-03-19T13:18:41Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597670155",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597670155"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597670155"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597670155/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 966,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 1062,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597701349",
    "pull_request_review_id": 616342920,
    "id": 597701349,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzcwMTM0OQ==",
    "diff_hunk": "@@ -1460,17 +1508,16 @@ void PeerManagerImpl::SendPings()\n \n void PeerManagerImpl::RelayTransaction(const uint256& txid, const uint256& wtxid)\n {\n-    m_connman.ForEachNode([&txid, &wtxid](CNode* pnode) EXCLUSIVE_LOCKS_REQUIRED(::cs_main) {\n-        AssertLockHeld(::cs_main);\n-\n-        CNodeState* state = State(pnode->GetId());\n-        if (state == nullptr) return;\n-        if (state->m_wtxid_relay) {\n-            pnode->PushTxInventory(wtxid);\n-        } else {\n-            pnode->PushTxInventory(txid);\n+    LOCK(m_peer_mutex);\n+    for(auto& it : m_peer_map) {\n+        Peer& peer = *it.second;",
    "path": "src/net_processing.cpp",
    "position": 204,
    "original_position": 184,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "```suggestion\r\n    for (auto& [node_id, peer] : m_peer_map) {\r\n```",
    "created_at": "2021-03-19T14:00:58Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597701349",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597701349"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597701349"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597701349/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 1721,
    "original_start_line": 1512,
    "start_side": "RIGHT",
    "line": 1722,
    "original_line": 1722,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597719018",
    "pull_request_review_id": 616342920,
    "id": 597719018,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzcxOTAxOA==",
    "diff_hunk": "@@ -983,6 +1023,7 @@ void PeerManagerImpl::FinalizeNode(const CNode& node, bool& fUpdateConnectionTim\n         PeerRef peer = RemovePeer(nodeid);\n         assert(peer != nullptr);\n         misbehavior = WITH_LOCK(peer->m_misbehavior_mutex, return peer->m_misbehavior_score);\n+        m_wtxid_relay_peers -= peer->m_wtxid_relay;",
    "path": "src/net_processing.cpp",
    "position": 162,
    "original_position": 142,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This was moved from below without the accompanying assert, better move the assert with it.\r\n```suggestion\r\n        m_wtxid_relay_peers -= peer->m_wtxid_relay;\r\n        assert(m_wtxid_relay_peers >= 0);\r\n```",
    "created_at": "2021-03-19T14:24:01Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597719018",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597719018"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597719018"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597719018/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1244,
    "original_line": 1244,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597719805",
    "pull_request_review_id": 616342920,
    "id": 597719805,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzcxOTgwNQ==",
    "diff_hunk": "@@ -1006,7 +1047,6 @@ void PeerManagerImpl::FinalizeNode(const CNode& node, bool& fUpdateConnectionTim\n     assert(nPeersWithValidatedDownloads >= 0);\n     m_outbound_peers_with_protect_from_disconnect -= state->m_chain_sync.m_protect;\n     assert(m_outbound_peers_with_protect_from_disconnect >= 0);\n-    m_wtxid_relay_peers -= state->m_wtxid_relay;\n     assert(m_wtxid_relay_peers >= 0);",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 151,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This assert can/should be moved up, where the decrement was moved to.",
    "created_at": "2021-03-19T14:25:04Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597719805",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597719805"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597719805"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597719805/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1050,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597787675",
    "pull_request_review_id": 616342920,
    "id": 597787675,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5Nzc4NzY3NQ==",
    "diff_hunk": "@@ -2597,9 +2645,8 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n         if (pfrom.GetCommonVersion() >= WTXID_RELAY_VERSION) {\n-            LOCK(cs_main);\n-            if (!State(pfrom.GetId())->m_wtxid_relay) {\n-                State(pfrom.GetId())->m_wtxid_relay = true;\n+            if (!peer->m_wtxid_relay) {\n+                peer->m_wtxid_relay = true;\n                 m_wtxid_relay_peers++;",
    "path": "src/net_processing.cpp",
    "position": 309,
    "original_position": 271,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Just a note:\r\n\r\nBefore this change both `CNodeState::m_wtxid_relay` and `PeerManagerImpl::m_wtxid_relay_peers` would have been modified under `cs_main`. After this change `Peer::m_wtxid_relay` and `PeerManagerImpl::m_wtxid_relay_peers` are not anymore modified together under `cs_main`.\r\n\r\nThis means that after `peer->m_wtxid_relay = true` and before `m_wtxid_relay_peers++` the system is in an observable state where the sum of all `Peer::m_wtxid_relay` does not equal `PeerManagerImpl::m_wtxid_relay_peers`.\r\n\r\nI think this is ok - couldn't find any code that would be upset by that.",
    "created_at": "2021-03-19T15:49:46Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597787675",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597787675"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597787675"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597787675/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 2787,
    "original_start_line": 2600,
    "start_side": "LEFT",
    "line": 2828,
    "original_line": 2828,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597797245",
    "pull_request_review_id": 616342920,
    "id": 597797245,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5Nzc5NzI0NQ==",
    "diff_hunk": "@@ -217,7 +250,10 @@ struct Peer {\n     /** Work queue of items requested by this peer **/\n     std::deque<CInv> m_getdata_requests GUARDED_BY(m_getdata_requests_mutex);\n \n-    explicit Peer(NodeId id) : m_id(id) {}\n+    explicit Peer(NodeId id, bool blocks_only)",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 45,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`explicit` can be removed because now we have 2 arguments.",
    "created_at": "2021-03-19T16:02:38Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597797245",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597797245"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597797245"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597797245/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 255,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597800447",
    "pull_request_review_id": 616342920,
    "id": 597800447,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzgwMDQ0Nw==",
    "diff_hunk": "@@ -610,6 +643,14 @@ static CNodeState *State(NodeId pnode) EXCLUSIVE_LOCKS_REQUIRED(cs_main) {\n     return &it->second;\n }\n \n+static void AddKnownTx(Peer& peer, const uint256& hash)\n+{\n+    if (peer.m_tx_relay != nullptr) {\n+        LOCK(peer.m_tx_relay->m_tx_inventory_mutex);\n+        peer.m_tx_relay->m_tx_inventory_known_filter.insert(hash);\n+    }\n+}",
    "path": "src/net_processing.cpp",
    "position": 108,
    "original_position": 90,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Why not a `Peer` method?",
    "created_at": "2021-03-19T16:07:01Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597800447",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597800447"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597800447"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597800447/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 837,
    "original_start_line": 646,
    "start_side": "RIGHT",
    "line": 843,
    "original_line": 843,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597817303",
    "pull_request_review_id": 616342920,
    "id": 597817303,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzgxNzMwMw==",
    "diff_hunk": "@@ -1460,17 +1508,16 @@ void PeerManagerImpl::SendPings()\n \n void PeerManagerImpl::RelayTransaction(const uint256& txid, const uint256& wtxid)\n {\n-    m_connman.ForEachNode([&txid, &wtxid](CNode* pnode) EXCLUSIVE_LOCKS_REQUIRED(::cs_main) {\n-        AssertLockHeld(::cs_main);\n-\n-        CNodeState* state = State(pnode->GetId());\n-        if (state == nullptr) return;\n-        if (state->m_wtxid_relay) {\n-            pnode->PushTxInventory(wtxid);\n-        } else {\n-            pnode->PushTxInventory(txid);\n+    LOCK(m_peer_mutex);\n+    for(auto& it : m_peer_map) {\n+        Peer& peer = *it.second;\n+        if (!peer.m_tx_relay) return;",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 185,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: I think the rest of the code around `m_tx_relay` uses `== nullptr` or `!= nullptr`.",
    "created_at": "2021-03-19T16:30:30Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597817303",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597817303"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597817303"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597817303/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1712,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597825250",
    "pull_request_review_id": 616342920,
    "id": 597825250,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzgyNTI1MA==",
    "diff_hunk": "@@ -4443,83 +4492,84 @@ bool PeerManagerImpl::SendMessages(CNode* pto)\n             }\n             peer->m_blocks_for_inv_relay.clear();\n \n-            if (pto->m_tx_relay != nullptr) {\n-                LOCK(pto->m_tx_relay->cs_tx_inventory);\n+            if (peer->m_tx_relay != nullptr) {\n+                LOCK(peer->m_tx_relay->m_tx_inventory_mutex);\n                 // Check whether periodic sends should happen\n                 bool fSendTrickle = pto->HasPermission(PF_NOBAN);\n-                if (pto->m_tx_relay->nNextInvSend < current_time) {\n+                if (peer->m_tx_relay->m_next_inv_send_time < current_time) {\n                     fSendTrickle = true;\n                     if (pto->IsInboundConn()) {\n-                        pto->m_tx_relay->nNextInvSend = m_connman.PoissonNextSendInbound(current_time, INBOUND_INVENTORY_BROADCAST_INTERVAL);\n+                        peer->m_tx_relay->m_next_inv_send_time = m_connman.PoissonNextSendInbound(current_time, INBOUND_INVENTORY_BROADCAST_INTERVAL);\n                     } else {\n-                        pto->m_tx_relay->nNextInvSend = PoissonNextSend(current_time, OUTBOUND_INVENTORY_BROADCAST_INTERVAL);\n+                        // Use half the delay for outbound peers, as there is less privacy concern for them.\n+                        peer->m_tx_relay->m_next_inv_send_time = PoissonNextSend(current_time, OUTBOUND_INVENTORY_BROADCAST_INTERVAL);",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 443,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This comment `// Use half...` was removed from `master` when `{INBOUND,OUTBOUND}_INVENTORY_BROADCAST_INTERVAL` were introduced. I think it better be removed because it implies OUTBOUND is INBOUND/2.",
    "created_at": "2021-03-19T16:42:31Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597825250",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597825250"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597825250"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597825250/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 4455,
    "start_side": "LEFT",
    "line": null,
    "original_line": 4782,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597831033",
    "pull_request_review_id": 616342920,
    "id": 597831033,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzgzMTAzMw==",
    "diff_hunk": "@@ -1114,7 +1114,6 @@ void RPCConsole::updateDetailWidget()\n         peerAddrDetails += \"<br />\" + tr(\"via %1\").arg(QString::fromStdString(stats->nodeStats.addrLocal));\n     ui->peerHeading->setText(peerAddrDetails);\n     ui->peerServices->setText(GUIUtil::formatServicesStr(stats->nodeStats.nServices));\n-    ui->peerRelayTxes->setText(stats->nodeStats.fRelayTxes ? ts.yes : ts.no);",
    "path": "src/qt/rpcconsole.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This change would only set the text if `stats->fNodeStateStatsAvailable` is `true` and will leave it \"uninitialized\" otherwise. What would be displayed in that case? Empty? Should something like `n/a` be displayed?\r\n\r\nThis looks like a regression in the UI - previously that text would always have been set (it was always known) and now - not anymore.",
    "created_at": "2021-03-19T16:50:30Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597831033",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597831033"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597831033"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597831033/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1169,
    "original_line": 1169,
    "side": "LEFT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597832782",
    "pull_request_review_id": 616342920,
    "id": 597832782,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5NzgzMjc4Mg==",
    "diff_hunk": "@@ -193,7 +193,6 @@ static RPCHelpMan getpeerinfo()\n         }\n         obj.pushKV(\"services\", strprintf(\"%016x\", stats.nServices));\n         obj.pushKV(\"servicesnames\", GetServicesNames(stats.nServices));\n-        obj.pushKV(\"relaytxes\", stats.fRelayTxes);",
    "path": "src/rpc/net.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Similarly to the UI - the fields `relaytxes` and `minfeefilter` would have always been present before and now - only if `fStateStats` is `true`.",
    "created_at": "2021-03-19T16:53:06Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597832782",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597832782"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r597832782"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/597832782/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 213,
    "original_line": 213,
    "side": "LEFT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598088245",
    "pull_request_review_id": 616898279,
    "id": 598088245,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODA4ODI0NQ==",
    "diff_hunk": "@@ -1460,17 +1508,16 @@ void PeerManagerImpl::SendPings()\n \n void PeerManagerImpl::RelayTransaction(const uint256& txid, const uint256& wtxid)\n {\n-    m_connman.ForEachNode([&txid, &wtxid](CNode* pnode) EXCLUSIVE_LOCKS_REQUIRED(::cs_main) {\n-        AssertLockHeld(::cs_main);\n-\n-        CNodeState* state = State(pnode->GetId());\n-        if (state == nullptr) return;\n-        if (state->m_wtxid_relay) {\n-            pnode->PushTxInventory(wtxid);\n-        } else {\n-            pnode->PushTxInventory(txid);\n+    LOCK(m_peer_mutex);\n+    for(auto& it : m_peer_map) {\n+        Peer& peer = *it.second;",
    "path": "src/net_processing.cpp",
    "position": 204,
    "original_position": 184,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "That means node_id is unused, which causes warnings depending on your compiler flags.",
    "created_at": "2021-03-20T09:29:33Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598088245",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598088245"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598088245"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598088245/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 1721,
    "original_start_line": 1512,
    "start_side": "RIGHT",
    "line": 1722,
    "original_line": 1722,
    "side": "RIGHT",
    "in_reply_to_id": 597701349
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598088432",
    "pull_request_review_id": 616898381,
    "id": 598088432,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODA4ODQzMg==",
    "diff_hunk": "@@ -1460,17 +1508,16 @@ void PeerManagerImpl::SendPings()\n \n void PeerManagerImpl::RelayTransaction(const uint256& txid, const uint256& wtxid)\n {\n-    m_connman.ForEachNode([&txid, &wtxid](CNode* pnode) EXCLUSIVE_LOCKS_REQUIRED(::cs_main) {\n-        AssertLockHeld(::cs_main);\n-\n-        CNodeState* state = State(pnode->GetId());\n-        if (state == nullptr) return;\n-        if (state->m_wtxid_relay) {\n-            pnode->PushTxInventory(wtxid);\n-        } else {\n-            pnode->PushTxInventory(txid);\n+    LOCK(m_peer_mutex);\n+    for(auto& it : m_peer_map) {\n+        Peer& peer = *it.second;\n+        if (!peer.m_tx_relay) return;",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 185,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "We don't have a project style on whether to compare to `nullptr` or use a pointer's bool conversion. Both are fine.",
    "created_at": "2021-03-20T09:31:42Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598088432",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598088432"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598088432"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598088432/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1712,
    "side": "RIGHT",
    "in_reply_to_id": 597817303
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567367",
    "pull_request_review_id": 617328539,
    "id": 598567367,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODU2NzM2Nw==",
    "diff_hunk": "@@ -193,7 +193,6 @@ static RPCHelpMan getpeerinfo()\n         }\n         obj.pushKV(\"services\", strprintf(\"%016x\", stats.nServices));\n         obj.pushKV(\"servicesnames\", GetServicesNames(stats.nServices));\n-        obj.pushKV(\"relaytxes\", stats.fRelayTxes);",
    "path": "src/rpc/net.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "As above for the gui peer console.",
    "created_at": "2021-03-22T09:54:28Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598567367",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567367"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598567367"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567367/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 213,
    "original_line": 213,
    "side": "LEFT",
    "in_reply_to_id": 597832782
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567395",
    "pull_request_review_id": 617328577,
    "id": 598567395,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODU2NzM5NQ==",
    "diff_hunk": "@@ -1114,7 +1114,6 @@ void RPCConsole::updateDetailWidget()\n         peerAddrDetails += \"<br />\" + tr(\"via %1\").arg(QString::fromStdString(stats->nodeStats.addrLocal));\n     ui->peerHeading->setText(peerAddrDetails);\n     ui->peerServices->setText(GUIUtil::formatServicesStr(stats->nodeStats.nServices));\n-    ui->peerRelayTxes->setText(stats->nodeStats.fRelayTxes ? ts.yes : ts.no);",
    "path": "src/qt/rpcconsole.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In reality, I think `fNodeStateStatsAvailable` will almost always be true, so this isn't a big issue (if it was, then the other stats in `nodeStateStats` not being available would also be an issue).",
    "created_at": "2021-03-22T09:54:29Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598567395",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567395"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598567395"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567395/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1169,
    "original_line": 1169,
    "side": "LEFT",
    "in_reply_to_id": 597831033
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567467",
    "pull_request_review_id": 617328685,
    "id": 598567467,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODU2NzQ2Nw==",
    "diff_hunk": "@@ -4443,83 +4492,84 @@ bool PeerManagerImpl::SendMessages(CNode* pto)\n             }\n             peer->m_blocks_for_inv_relay.clear();\n \n-            if (pto->m_tx_relay != nullptr) {\n-                LOCK(pto->m_tx_relay->cs_tx_inventory);\n+            if (peer->m_tx_relay != nullptr) {\n+                LOCK(peer->m_tx_relay->m_tx_inventory_mutex);\n                 // Check whether periodic sends should happen\n                 bool fSendTrickle = pto->HasPermission(PF_NOBAN);\n-                if (pto->m_tx_relay->nNextInvSend < current_time) {\n+                if (peer->m_tx_relay->m_next_inv_send_time < current_time) {\n                     fSendTrickle = true;\n                     if (pto->IsInboundConn()) {\n-                        pto->m_tx_relay->nNextInvSend = m_connman.PoissonNextSendInbound(current_time, INBOUND_INVENTORY_BROADCAST_INTERVAL);\n+                        peer->m_tx_relay->m_next_inv_send_time = m_connman.PoissonNextSendInbound(current_time, INBOUND_INVENTORY_BROADCAST_INTERVAL);\n                     } else {\n-                        pto->m_tx_relay->nNextInvSend = PoissonNextSend(current_time, OUTBOUND_INVENTORY_BROADCAST_INTERVAL);\n+                        // Use half the delay for outbound peers, as there is less privacy concern for them.\n+                        peer->m_tx_relay->m_next_inv_send_time = PoissonNextSend(current_time, OUTBOUND_INVENTORY_BROADCAST_INTERVAL);",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 443,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Oops! Thank you. Removed.",
    "created_at": "2021-03-22T09:54:35Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598567467",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567467"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598567467"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567467/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 4455,
    "start_side": "LEFT",
    "line": null,
    "original_line": 4782,
    "side": "RIGHT",
    "in_reply_to_id": 597825250
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567518",
    "pull_request_review_id": 617328754,
    "id": 598567518,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODU2NzUxOA==",
    "diff_hunk": "@@ -610,6 +643,14 @@ static CNodeState *State(NodeId pnode) EXCLUSIVE_LOCKS_REQUIRED(cs_main) {\n     return &it->second;\n }\n \n+static void AddKnownTx(Peer& peer, const uint256& hash)\n+{\n+    if (peer.m_tx_relay != nullptr) {\n+        LOCK(peer.m_tx_relay->m_tx_inventory_mutex);\n+        peer.m_tx_relay->m_tx_inventory_known_filter.insert(hash);\n+    }\n+}",
    "path": "src/net_processing.cpp",
    "position": 108,
    "original_position": 90,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I'm trying to keep `Peer` as a data structure without any internal logic.",
    "created_at": "2021-03-22T09:54:39Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598567518",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567518"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598567518"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567518/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 837,
    "original_start_line": 646,
    "start_side": "RIGHT",
    "line": 843,
    "original_line": 843,
    "side": "RIGHT",
    "in_reply_to_id": 597800447
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567565",
    "pull_request_review_id": 617328814,
    "id": 598567565,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODU2NzU2NQ==",
    "diff_hunk": "@@ -217,7 +250,10 @@ struct Peer {\n     /** Work queue of items requested by this peer **/\n     std::deque<CInv> m_getdata_requests GUARDED_BY(m_getdata_requests_mutex);\n \n-    explicit Peer(NodeId id) : m_id(id) {}\n+    explicit Peer(NodeId id, bool blocks_only)",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 45,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Nice! Removed.",
    "created_at": "2021-03-22T09:54:42Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598567565",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567565"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598567565"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567565/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 255,
    "side": "RIGHT",
    "in_reply_to_id": 597797245
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567603",
    "pull_request_review_id": 617328872,
    "id": 598567603,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODU2NzYwMw==",
    "diff_hunk": "@@ -2597,9 +2645,8 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             return;\n         }\n         if (pfrom.GetCommonVersion() >= WTXID_RELAY_VERSION) {\n-            LOCK(cs_main);\n-            if (!State(pfrom.GetId())->m_wtxid_relay) {\n-                State(pfrom.GetId())->m_wtxid_relay = true;\n+            if (!peer->m_wtxid_relay) {\n+                peer->m_wtxid_relay = true;\n                 m_wtxid_relay_peers++;",
    "path": "src/net_processing.cpp",
    "position": 309,
    "original_position": 271,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes, that's a good observation. I agree that this is totally fine, and the fields don't need to be atomically updated under cs_main.",
    "created_at": "2021-03-22T09:54:45Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598567603",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567603"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598567603"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567603/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 2787,
    "original_start_line": 2600,
    "start_side": "LEFT",
    "line": 2828,
    "original_line": 2828,
    "side": "RIGHT",
    "in_reply_to_id": 597787675
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567662",
    "pull_request_review_id": 617328945,
    "id": 598567662,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODU2NzY2Mg==",
    "diff_hunk": "@@ -1006,7 +1047,6 @@ void PeerManagerImpl::FinalizeNode(const CNode& node, bool& fUpdateConnectionTim\n     assert(nPeersWithValidatedDownloads >= 0);\n     m_outbound_peers_with_protect_from_disconnect -= state->m_chain_sync.m_protect;\n     assert(m_outbound_peers_with_protect_from_disconnect >= 0);\n-    m_wtxid_relay_peers -= state->m_wtxid_relay;\n     assert(m_wtxid_relay_peers >= 0);",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 151,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2021-03-22T09:54:49Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598567662",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567662"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598567662"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567662/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1050,
    "side": "RIGHT",
    "in_reply_to_id": 597719805
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567706",
    "pull_request_review_id": 617329003,
    "id": 598567706,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODU2NzcwNg==",
    "diff_hunk": "@@ -983,6 +1023,7 @@ void PeerManagerImpl::FinalizeNode(const CNode& node, bool& fUpdateConnectionTim\n         PeerRef peer = RemovePeer(nodeid);\n         assert(peer != nullptr);\n         misbehavior = WITH_LOCK(peer->m_misbehavior_mutex, return peer->m_misbehavior_score);\n+        m_wtxid_relay_peers -= peer->m_wtxid_relay;",
    "path": "src/net_processing.cpp",
    "position": 162,
    "original_position": 142,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2021-03-22T09:54:52Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598567706",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567706"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598567706"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567706/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1244,
    "original_line": 1244,
    "side": "RIGHT",
    "in_reply_to_id": 597719018
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567747",
    "pull_request_review_id": 617329063,
    "id": 598567747,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODU2Nzc0Nw==",
    "diff_hunk": "@@ -974,18 +963,11 @@ bool CConnman::AttemptToEvictConnection()\n                 continue;\n             if (node->fDisconnect)\n                 continue;\n-            bool peer_relay_txes = false;\n-            bool peer_filter_not_null = false;\n-            if (node->m_tx_relay != nullptr) {\n-                LOCK(node->m_tx_relay->cs_filter);\n-                peer_relay_txes = node->m_tx_relay->fRelayTxes;\n-                peer_filter_not_null = node->m_tx_relay->pfilter != nullptr;\n-            }\n             NodeEvictionCandidate candidate = {node->GetId(), node->nTimeConnected, node->m_min_ping_time,\n                                                node->nLastBlockTime, node->nLastTXTime,\n                                                HasAllDesirableServiceFlags(node->nServices),\n-                                               peer_relay_txes, peer_filter_not_null, node->nKeyedNetGroup,\n-                                               node->m_prefer_evict, node->addr.IsLocal()};\n+                                               node->m_relays_txs.load(), node->m_bloom_filter_loaded.load(),\n+                                               node->nKeyedNetGroup, node->m_prefer_evict, node->addr.IsLocal()};\n             vEvictionCandidates.push_back(candidate);",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 70,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Seems reasonable, but I agree it's out of scope for this PR.",
    "created_at": "2021-03-22T09:54:56Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598567747",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567747"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598567747"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567747/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 966,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 1062,
    "side": "RIGHT",
    "in_reply_to_id": 597670155
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567802",
    "pull_request_review_id": 617329134,
    "id": 598567802,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODU2NzgwMg==",
    "diff_hunk": "@@ -565,12 +565,6 @@ void CNode::copyStats(CNodeStats &stats, const std::vector<bool> &m_asmap)\n     X(addrBind);",
    "path": "src/net.cpp",
    "position": 2,
    "original_position": 1,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Thanks! Fixed.",
    "created_at": "2021-03-22T09:55:00Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598567802",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567802"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598567802"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567802/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 580,
    "original_line": 580,
    "side": "RIGHT",
    "in_reply_to_id": 597653259
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567849",
    "pull_request_review_id": 617329188,
    "id": 598567849,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODU2Nzg0OQ==",
    "diff_hunk": "@@ -551,34 +549,14 @@ class CNode\n     std::chrono::microseconds m_next_addr_send GUARDED_BY(cs_sendProcessing){0};\n     std::chrono::microseconds m_next_local_addr_send GUARDED_BY(cs_sendProcessing){0};\n \n-    struct TxRelay {\n-        mutable RecursiveMutex cs_filter;\n-        // We use fRelayTxes for two purposes -\n-        // a) it allows us to not relay tx invs before receiving the peer's version message\n-        // b) the peer may tell us in its version message that we should not relay tx invs\n-        //    unless it loads a bloom filter.\n-        bool fRelayTxes GUARDED_BY(cs_filter){false};\n-        std::unique_ptr<CBloomFilter> pfilter PT_GUARDED_BY(cs_filter) GUARDED_BY(cs_filter){nullptr};\n-\n-        mutable RecursiveMutex cs_tx_inventory;\n-        CRollingBloomFilter filterInventoryKnown GUARDED_BY(cs_tx_inventory){50000, 0.000001};\n-        // Set of transaction ids we still have to announce.\n-        // They are sorted by the mempool before relay, so the order is not important.\n-        std::set<uint256> setInventoryTxToSend;\n-        // Used for BIP35 mempool sending\n-        bool fSendMempool GUARDED_BY(cs_tx_inventory){false};\n-        // Last time a \"MEMPOOL\" request was serviced.\n-        std::atomic<std::chrono::seconds> m_last_mempool_req{0s};\n-        std::chrono::microseconds nNextInvSend{0};\n-\n-        /** Minimum fee rate with which to filter inv's to this node */\n-        std::atomic<CAmount> minFeeFilter{0};\n-        CAmount lastSentFeeFilter{0};\n-        std::chrono::microseconds m_next_send_feefilter{0};\n-    };\n+    /** Whether this peer asked us to relay transactions. This only changes from",
    "path": "src/net.h",
    "position": null,
    "original_position": 45,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "That's better. I've updated the comment.",
    "created_at": "2021-03-22T09:55:04Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598567849",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567849"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r598567849"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598567849/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 552,
    "side": "RIGHT",
    "in_reply_to_id": 597635838
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599373279",
    "pull_request_review_id": 618332615,
    "id": 599373279,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5OTM3MzI3OQ==",
    "diff_hunk": "@@ -1460,17 +1508,16 @@ void PeerManagerImpl::SendPings()\n \n void PeerManagerImpl::RelayTransaction(const uint256& txid, const uint256& wtxid)\n {\n-    m_connman.ForEachNode([&txid, &wtxid](CNode* pnode) EXCLUSIVE_LOCKS_REQUIRED(::cs_main) {\n-        AssertLockHeld(::cs_main);\n-\n-        CNodeState* state = State(pnode->GetId());\n-        if (state == nullptr) return;\n-        if (state->m_wtxid_relay) {\n-            pnode->PushTxInventory(wtxid);\n-        } else {\n-            pnode->PushTxInventory(txid);\n+    LOCK(m_peer_mutex);\n+    for(auto& it : m_peer_map) {\n+        Peer& peer = *it.second;",
    "path": "src/net_processing.cpp",
    "position": 204,
    "original_position": 184,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Which compiler flags produce a warning? I don't get any with either clang 12 or gcc 10:\r\n```cpp\r\n    std::map<int, int> m;\r\n    for (const auto& [x, y] : m) { // no warning\r\n        std::cout << x;\r\n    } \r\n    for (const auto& [x, y] : m) { // warning: unused structured binding declaration [-Wunused-variable]\r\n    } \r\n```",
    "created_at": "2021-03-23T08:49:31Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r599373279",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599373279"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r599373279"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599373279/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 1721,
    "original_start_line": 1512,
    "start_side": "RIGHT",
    "line": 1722,
    "original_line": 1722,
    "side": "RIGHT",
    "in_reply_to_id": 597701349
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599387582",
    "pull_request_review_id": 618351297,
    "id": 599387582,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5OTM4NzU4Mg==",
    "diff_hunk": "@@ -983,6 +1023,7 @@ void PeerManagerImpl::FinalizeNode(const CNode& node, bool& fUpdateConnectionTim\n         PeerRef peer = RemovePeer(nodeid);\n         assert(peer != nullptr);\n         misbehavior = WITH_LOCK(peer->m_misbehavior_mutex, return peer->m_misbehavior_score);\n+        m_wtxid_relay_peers -= peer->m_wtxid_relay;",
    "path": "src/net_processing.cpp",
    "position": 162,
    "original_position": 142,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Now the move of the decrement happens in commit\r\n`[net processing] Move m_wtxid_relay to Peer`\r\nwhile the move of the assert happens in\r\n`[net processing] Move tx relay data to Peer`.\r\n\r\nI think both moves belong to the first commit.",
    "created_at": "2021-03-23T09:09:31Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r599387582",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599387582"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r599387582"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599387582/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1244,
    "original_line": 1244,
    "side": "RIGHT",
    "in_reply_to_id": 597719018
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599446966",
    "pull_request_review_id": 618428982,
    "id": 599446966,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5OTQ0Njk2Ng==",
    "diff_hunk": "@@ -1460,17 +1508,16 @@ void PeerManagerImpl::SendPings()\n \n void PeerManagerImpl::RelayTransaction(const uint256& txid, const uint256& wtxid)\n {\n-    m_connman.ForEachNode([&txid, &wtxid](CNode* pnode) EXCLUSIVE_LOCKS_REQUIRED(::cs_main) {\n-        AssertLockHeld(::cs_main);\n-\n-        CNodeState* state = State(pnode->GetId());\n-        if (state == nullptr) return;\n-        if (state->m_wtxid_relay) {\n-            pnode->PushTxInventory(wtxid);\n-        } else {\n-            pnode->PushTxInventory(txid);\n+    LOCK(m_peer_mutex);\n+    for(auto& it : m_peer_map) {\n+        Peer& peer = *it.second;",
    "path": "src/net_processing.cpp",
    "position": 204,
    "original_position": 184,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Hmmm, if you search for \"c++ structured binding unused variable\", there do seem to be a lot of people claiming that they've encountered this warning. Like you, I've been unable to reproduce it, either locally or on godbolt.org with various compiler versions.\r\n\r\nIn any case, I'm going to leave this as it is, since it's only one more line and no less clear to explicitly declare the `Peer` object. Thank you for pointing this out though!",
    "created_at": "2021-03-23T10:30:53Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r599446966",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599446966"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r599446966"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599446966/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 1721,
    "original_start_line": 1512,
    "start_side": "RIGHT",
    "line": 1722,
    "original_line": 1722,
    "side": "RIGHT",
    "in_reply_to_id": 597701349
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599449012",
    "pull_request_review_id": 618431751,
    "id": 599449012,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5OTQ0OTAxMg==",
    "diff_hunk": "@@ -983,6 +1023,7 @@ void PeerManagerImpl::FinalizeNode(const CNode& node, bool& fUpdateConnectionTim\n         PeerRef peer = RemovePeer(nodeid);\n         assert(peer != nullptr);\n         misbehavior = WITH_LOCK(peer->m_misbehavior_mutex, return peer->m_misbehavior_score);\n+        m_wtxid_relay_peers -= peer->m_wtxid_relay;",
    "path": "src/net_processing.cpp",
    "position": 162,
    "original_position": 142,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Oops. Now fixed. Thank you!",
    "created_at": "2021-03-23T10:33:53Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r599449012",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599449012"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r599449012"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/599449012/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1244,
    "original_line": 1244,
    "side": "RIGHT",
    "in_reply_to_id": 597719018
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601883666",
    "pull_request_review_id": 621634594,
    "id": 601883666,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMTg4MzY2Ng==",
    "diff_hunk": "@@ -209,6 +209,39 @@ struct Peer {\n     /** Whether a ping has been requested by the user */\n     std::atomic<bool> m_ping_queued{false};\n \n+    /** Whether this peer relays txs via wtxid */\n+    bool m_wtxid_relay{false};",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "72182a950c3bfb83d488f0cf0e4a7df1a663e36a",
    "user": {
      "login": "glozow",
      "id": 25183001,
      "node_id": "MDQ6VXNlcjI1MTgzMDAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/glozow",
      "html_url": "https://github.com/glozow",
      "followers_url": "https://api.github.com/users/glozow/followers",
      "following_url": "https://api.github.com/users/glozow/following{/other_user}",
      "gists_url": "https://api.github.com/users/glozow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/glozow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
      "organizations_url": "https://api.github.com/users/glozow/orgs",
      "repos_url": "https://api.github.com/users/glozow/repos",
      "events_url": "https://api.github.com/users/glozow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/glozow/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I thought this could be `const` because you'd get the info from the `VERSION` and it wouldn't ever change, but then I realized the `Peer` struct is created before then, so it couldn't be const... is that accurate?",
    "created_at": "2021-03-25T22:38:28Z",
    "updated_at": "2021-04-30T09:37:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r601883666",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601883666"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r601883666"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/601883666/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 227,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623300544",
    "pull_request_review_id": 621634594,
    "id": 623300544,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMzMwMDU0NA==",
    "diff_hunk": "@@ -218,7 +251,10 @@ struct Peer {\n     /** Work queue of items requested by this peer **/\n     std::deque<CInv> m_getdata_requests GUARDED_BY(m_getdata_requests_mutex);\n \n-    explicit Peer(NodeId id) : m_id(id) {}\n+    Peer(NodeId id, bool blocks_only)",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 45,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "6976a1c02ad0ea3a5c993b4ae886d4a86d458aa6",
    "user": {
      "login": "glozow",
      "id": 25183001,
      "node_id": "MDQ6VXNlcjI1MTgzMDAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/glozow",
      "html_url": "https://github.com/glozow",
      "followers_url": "https://api.github.com/users/glozow/followers",
      "following_url": "https://api.github.com/users/glozow/following{/other_user}",
      "gists_url": "https://api.github.com/users/glozow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/glozow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
      "organizations_url": "https://api.github.com/users/glozow/orgs",
      "repos_url": "https://api.github.com/users/glozow/repos",
      "events_url": "https://api.github.com/users/glozow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/glozow/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Why'd you delete the `explicit`?",
    "created_at": "2021-04-29T18:39:04Z",
    "updated_at": "2021-04-30T09:37:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r623300544",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623300544"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r623300544"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623300544/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 317,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623305322",
    "pull_request_review_id": 621634594,
    "id": 623305322,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMzMwNTMyMg==",
    "diff_hunk": "@@ -1470,17 +1518,16 @@ void PeerManagerImpl::SendPings()\n \n void PeerManagerImpl::RelayTransaction(const uint256& txid, const uint256& wtxid)\n {\n-    m_connman.ForEachNode([&txid, &wtxid](CNode* pnode) EXCLUSIVE_LOCKS_REQUIRED(::cs_main) {\n-        AssertLockHeld(::cs_main);\n-\n-        CNodeState* state = State(pnode->GetId());\n-        if (state == nullptr) return;\n-        if (state->m_wtxid_relay) {\n-            pnode->PushTxInventory(wtxid);\n-        } else {\n-            pnode->PushTxInventory(txid);\n+    LOCK(m_peer_mutex);\n+    for(auto& it : m_peer_map) {\n+        Peer& peer = *it.second;\n+        if (!peer.m_tx_relay) return;",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 187,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "6976a1c02ad0ea3a5c993b4ae886d4a86d458aa6",
    "user": {
      "login": "glozow",
      "id": 25183001,
      "node_id": "MDQ6VXNlcjI1MTgzMDAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/glozow",
      "html_url": "https://github.com/glozow",
      "followers_url": "https://api.github.com/users/glozow/followers",
      "following_url": "https://api.github.com/users/glozow/following{/other_user}",
      "gists_url": "https://api.github.com/users/glozow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/glozow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
      "organizations_url": "https://api.github.com/users/glozow/orgs",
      "repos_url": "https://api.github.com/users/glozow/repos",
      "events_url": "https://api.github.com/users/glozow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/glozow/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Why is this `return` instead of `break`? Maybe I'm misunderstanding what this is doing, but I thought that we'd continue iterating through the others to relay to them, but returning seems like we're just skipping over the rest?",
    "created_at": "2021-04-29T18:46:46Z",
    "updated_at": "2021-04-30T09:37:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r623305322",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623305322"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r623305322"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623305322/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1712,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623676922",
    "pull_request_review_id": 648957979,
    "id": 623676922,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMzY3NjkyMg==",
    "diff_hunk": "@@ -209,6 +209,39 @@ struct Peer {\n     /** Whether a ping has been requested by the user */\n     std::atomic<bool> m_ping_queued{false};\n \n+    /** Whether this peer relays txs via wtxid */\n+    bool m_wtxid_relay{false};",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "72182a950c3bfb83d488f0cf0e4a7df1a663e36a",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Correct. The `Peer` object is constructed before we receive the `wtxidrelay` message, so we can't make this const.",
    "created_at": "2021-04-30T07:35:55Z",
    "updated_at": "2021-04-30T09:37:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r623676922",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623676922"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r623676922"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623676922/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 227,
    "side": "RIGHT",
    "in_reply_to_id": 601883666
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623748168",
    "pull_request_review_id": 649049041,
    "id": 623748168,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMzc0ODE2OA==",
    "diff_hunk": "@@ -218,7 +251,10 @@ struct Peer {\n     /** Work queue of items requested by this peer **/\n     std::deque<CInv> m_getdata_requests GUARDED_BY(m_getdata_requests_mutex);\n \n-    explicit Peer(NodeId id) : m_id(id) {}\n+    Peer(NodeId id, bool blocks_only)",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 45,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "6976a1c02ad0ea3a5c993b4ae886d4a86d458aa6",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "No good reason. I've put it back.",
    "created_at": "2021-04-30T09:37:42Z",
    "updated_at": "2021-04-30T09:37:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r623748168",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623748168"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r623748168"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623748168/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 317,
    "side": "RIGHT",
    "in_reply_to_id": 623300544
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623748907",
    "pull_request_review_id": 649050014,
    "id": 623748907,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMzc0ODkwNw==",
    "diff_hunk": "@@ -1470,17 +1518,16 @@ void PeerManagerImpl::SendPings()\n \n void PeerManagerImpl::RelayTransaction(const uint256& txid, const uint256& wtxid)\n {\n-    m_connman.ForEachNode([&txid, &wtxid](CNode* pnode) EXCLUSIVE_LOCKS_REQUIRED(::cs_main) {\n-        AssertLockHeld(::cs_main);\n-\n-        CNodeState* state = State(pnode->GetId());\n-        if (state == nullptr) return;\n-        if (state->m_wtxid_relay) {\n-            pnode->PushTxInventory(wtxid);\n-        } else {\n-            pnode->PushTxInventory(txid);\n+    LOCK(m_peer_mutex);\n+    for(auto& it : m_peer_map) {\n+        Peer& peer = *it.second;\n+        if (!peer.m_tx_relay) return;",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 187,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "6976a1c02ad0ea3a5c993b4ae886d4a86d458aa6",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yikes. Good catch. In a previous iteration of this PR, I had a `ForEachPeer()` helper that took a lambda, and this `return` was effectively a `continue` (the lambda would return and then be called for the remaining peers). Now fixed!",
    "created_at": "2021-04-30T09:39:02Z",
    "updated_at": "2021-04-30T09:39:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r623748907",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623748907"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r623748907"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/623748907/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1712,
    "side": "RIGHT",
    "in_reply_to_id": 623305322
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/628113336",
    "pull_request_review_id": 654326462,
    "id": 628113336,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyODExMzMzNg==",
    "diff_hunk": "@@ -218,7 +251,10 @@ struct Peer {\n     /** Work queue of items requested by this peer **/\n     std::deque<CInv> m_getdata_requests GUARDED_BY(m_getdata_requests_mutex);\n \n-    explicit Peer(NodeId id) : m_id(id) {}\n+    Peer(NodeId id, bool blocks_only)",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 45,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "6976a1c02ad0ea3a5c993b4ae886d4a86d458aa6",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`explicit` prevents implicit conversions for _single-argument_ constructors. After the change above, the constructor has 2 arguments. See https://stackoverflow.com/a/121163",
    "created_at": "2021-05-07T10:49:52Z",
    "updated_at": "2021-05-07T10:49:52Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r628113336",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/628113336"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r628113336"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/628113336/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 317,
    "side": "RIGHT",
    "in_reply_to_id": 623300544
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/628132981",
    "pull_request_review_id": 654352154,
    "id": 628132981,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyODEzMjk4MQ==",
    "diff_hunk": "@@ -218,7 +251,10 @@ struct Peer {\n     /** Work queue of items requested by this peer **/\n     std::deque<CInv> m_getdata_requests GUARDED_BY(m_getdata_requests_mutex);\n \n-    explicit Peer(NodeId id) : m_id(id) {}\n+    Peer(NodeId id, bool blocks_only)",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 45,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "6976a1c02ad0ea3a5c993b4ae886d4a86d458aa6",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`explicit` will also prevent implicit conversion for multiple-argument constructors. Is there a reason why {int,bool} should implicitly be converted into Peer?",
    "created_at": "2021-05-07T11:22:14Z",
    "updated_at": "2021-05-07T11:22:15Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r628132981",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/628132981"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r628132981"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/628132981/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 317,
    "side": "RIGHT",
    "in_reply_to_id": 623300544
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/628152277",
    "pull_request_review_id": 654377665,
    "id": 628152277,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyODE1MjI3Nw==",
    "diff_hunk": "@@ -218,7 +251,10 @@ struct Peer {\n     /** Work queue of items requested by this peer **/\n     std::deque<CInv> m_getdata_requests GUARDED_BY(m_getdata_requests_mutex);\n \n-    explicit Peer(NodeId id) : m_id(id) {}\n+    Peer(NodeId id, bool blocks_only)",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 45,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "6976a1c02ad0ea3a5c993b4ae886d4a86d458aa6",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Alright: https://stackoverflow.com/questions/39122101/explicit-constructor-taking-multiple-arguments",
    "created_at": "2021-05-07T11:57:06Z",
    "updated_at": "2021-05-07T11:57:06Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r628152277",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/628152277"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r628152277"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/628152277/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 317,
    "side": "RIGHT",
    "in_reply_to_id": 623300544
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689506531",
    "pull_request_review_id": 730672874,
    "id": 689506531,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4OTUwNjUzMQ==",
    "diff_hunk": "@@ -4710,83 +4745,83 @@ bool PeerManagerImpl::SendMessages(CNode* pto)\n             peer->m_blocks_for_inv_relay.clear();\n         }\n \n-        if (pto->m_tx_relay != nullptr) {\n-                LOCK(pto->m_tx_relay->cs_tx_inventory);\n+        if (peer->m_tx_relay != nullptr) {\n+                LOCK(peer->m_tx_relay->m_tx_inventory_mutex);\n                 // Check whether periodic sends should happen\n                 bool fSendTrickle = pto->HasPermission(NetPermissionFlags::NoBan);\n-                if (pto->m_tx_relay->nNextInvSend < current_time) {\n+                if (peer->m_tx_relay->m_next_inv_send_time < current_time) {\n                     fSendTrickle = true;\n                     if (pto->IsInboundConn()) {\n-                        pto->m_tx_relay->nNextInvSend = m_connman.PoissonNextSendInbound(current_time, INBOUND_INVENTORY_BROADCAST_INTERVAL);\n+                        peer->m_tx_relay->m_next_inv_send_time = m_connman.PoissonNextSendInbound(current_time, INBOUND_INVENTORY_BROADCAST_INTERVAL);\n                     } else {\n-                        pto->m_tx_relay->nNextInvSend = PoissonNextSend(current_time, OUTBOUND_INVENTORY_BROADCAST_INTERVAL);\n+                        peer->m_tx_relay->m_next_inv_send_time = PoissonNextSend(current_time, OUTBOUND_INVENTORY_BROADCAST_INTERVAL);\n                     }\n                 }\n \n                 // Time to send but the peer has requested we not relay transactions.\n                 if (fSendTrickle) {\n-                    LOCK(pto->m_tx_relay->cs_filter);\n-                    if (!pto->m_tx_relay->fRelayTxes) pto->m_tx_relay->setInventoryTxToSend.clear();\n+                    LOCK(peer->m_tx_relay->m_bloom_filter_mutex);\n+                    if (!peer->m_tx_relay->m_relay_txs) peer->m_tx_relay->m_tx_inventory_to_send.clear();",
    "path": "src/net_processing.cpp",
    "position": 560,
    "original_position": 557,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "cef5afc817214aa3f5e60fa1fd4a64872d6ee9a4",
    "user": {
      "login": "glozow",
      "id": 25183001,
      "node_id": "MDQ6VXNlcjI1MTgzMDAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/glozow",
      "html_url": "https://github.com/glozow",
      "followers_url": "https://api.github.com/users/glozow/followers",
      "following_url": "https://api.github.com/users/glozow/following{/other_user}",
      "gists_url": "https://api.github.com/users/glozow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/glozow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
      "organizations_url": "https://api.github.com/users/glozow/orgs",
      "repos_url": "https://api.github.com/users/glozow/repos",
      "events_url": "https://api.github.com/users/glozow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/glozow/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I have a question about this code (not related to this PR though) - why don't we lock `m_tx_inventory_mutex` here?",
    "created_at": "2021-08-16T12:48:58Z",
    "updated_at": "2021-08-16T16:50:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r689506531",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689506531"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r689506531"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689506531/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 4749,
    "original_start_line": 4728,
    "start_side": "LEFT",
    "line": 4789,
    "original_line": 4789,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689641819",
    "pull_request_review_id": 730672874,
    "id": 689641819,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4OTY0MTgxOQ==",
    "diff_hunk": "@@ -3212,6 +3205,8 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             pfrom.AddKnownTx(txid);\n         }\n \n+        LOCK2(cs_main, g_cs_orphans);\n+",
    "path": "src/net_processing.cpp",
    "position": 374,
    "original_position": 155,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "203bfe156b0a25a36c19fba397c8b2577bab1e9b",
    "user": {
      "login": "glozow",
      "id": 25183001,
      "node_id": "MDQ6VXNlcjI1MTgzMDAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/glozow",
      "html_url": "https://github.com/glozow",
      "followers_url": "https://api.github.com/users/glozow/followers",
      "following_url": "https://api.github.com/users/glozow/following{/other_user}",
      "gists_url": "https://api.github.com/users/glozow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/glozow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
      "organizations_url": "https://api.github.com/users/glozow/orgs",
      "repos_url": "https://api.github.com/users/glozow/repos",
      "events_url": "https://api.github.com/users/glozow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/glozow/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In 203bfe156b0a25a36c19fba397c8b2577bab1e9b: Noted that the line `LOCK2(cs_main, g_cs_orphans)` was moved down a few lines, and my reasoning for why this is okay was:\r\n\r\n- Whether a peer does wtxid relay, i.e. the value of `peer->m_wtxid_relay`, wouldn't change, and either way wouldn't require `cs_main` or `g_cs_orphans`\r\n- The peer inventory data is guarded by `cs_tx_inventory` and that's grabbed within `AddKnownTx`",
    "created_at": "2021-08-16T15:32:36Z",
    "updated_at": "2021-08-16T16:50:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r689641819",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689641819"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r689641819"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689641819/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 3270,
    "original_line": 3270,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689646357",
    "pull_request_review_id": 730672874,
    "id": 689646357,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4OTY0NjM1Nw==",
    "diff_hunk": "@@ -1199,6 +1195,8 @@ void PeerManagerImpl::FinalizeNode(const CNode& node)\n         PeerRef peer = RemovePeer(nodeid);\n         assert(peer != nullptr);\n         misbehavior = WITH_LOCK(peer->m_misbehavior_mutex, return peer->m_misbehavior_score);\n+        m_wtxid_relay_peers -= peer->m_wtxid_relay;",
    "path": "src/net_processing.cpp",
    "position": 162,
    "original_position": 53,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "203bfe156b0a25a36c19fba397c8b2577bab1e9b",
    "user": {
      "login": "glozow",
      "id": 25183001,
      "node_id": "MDQ6VXNlcjI1MTgzMDAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/glozow",
      "html_url": "https://github.com/glozow",
      "followers_url": "https://api.github.com/users/glozow/followers",
      "following_url": "https://api.github.com/users/glozow/following{/other_user}",
      "gists_url": "https://api.github.com/users/glozow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/glozow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
      "organizations_url": "https://api.github.com/users/glozow/orgs",
      "repos_url": "https://api.github.com/users/glozow/repos",
      "events_url": "https://api.github.com/users/glozow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/glozow/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In 203bfe156b0a25a36c19fba397c8b2577bab1e9b: not changed in this PR, but it's odd to me that we're subtracting a bool from an int? Why isn't it `if (peer->m_wtxid_relay) m_wtxid_relay_peers -= 1;` ?",
    "created_at": "2021-08-16T15:38:21Z",
    "updated_at": "2021-08-16T16:50:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r689646357",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689646357"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r689646357"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689646357/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1244,
    "original_line": 1244,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689696008",
    "pull_request_review_id": 730672874,
    "id": 689696008,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4OTY5NjAwOA==",
    "diff_hunk": "@@ -227,28 +227,28 @@ struct Peer {\n     bool m_wtxid_relay{false};\n \n     struct TxRelay {\n-        mutable RecursiveMutex cs_filter;\n-        // We use fRelayTxes for two purposes -\n+        mutable RecursiveMutex m_bloom_filter_mutex;\n+        // We use m_relay_txs for two purposes -\n         // a) it allows us to not relay tx invs before receiving the peer's version message\n         // b) the peer may tell us in its version message that we should not relay tx invs\n         //    unless it loads a bloom filter.\n-        bool fRelayTxes GUARDED_BY(cs_filter){false};\n-        std::unique_ptr<CBloomFilter> pfilter PT_GUARDED_BY(cs_filter) GUARDED_BY(cs_filter){nullptr};\n+        bool m_relay_txs GUARDED_BY(m_bloom_filter_mutex){false};",
    "path": "src/net_processing.cpp",
    "position": 13,
    "original_position": 13,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "2533ea5161d2cb15b3a43e0fea9b146f525aea97",
    "user": {
      "login": "glozow",
      "id": 25183001,
      "node_id": "MDQ6VXNlcjI1MTgzMDAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/glozow",
      "html_url": "https://github.com/glozow",
      "followers_url": "https://api.github.com/users/glozow/followers",
      "following_url": "https://api.github.com/users/glozow/following{/other_user}",
      "gists_url": "https://api.github.com/users/glozow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/glozow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
      "organizations_url": "https://api.github.com/users/glozow/orgs",
      "repos_url": "https://api.github.com/users/glozow/repos",
      "events_url": "https://api.github.com/users/glozow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/glozow/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In 2533ea5161d2cb15b3a43e0fea9b146f525aea97\r\n\r\nNoting that we have 3 variables named `m_relay_txs`: in `NodeEvictionCandidate`, `Peer.TxRelay`, and `CNodeStateStats`. And we have a `CNode.m_relays_txs` (very similar but not same name) where `CNode.m_relays_txs == Peer.m_tx_relay.m_relay_txs` always, and they are not the same thing as `Peer.m_tx_relay != nullptr`.",
    "created_at": "2021-08-16T16:44:26Z",
    "updated_at": "2021-08-16T16:50:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r689696008",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689696008"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r689696008"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/689696008/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 236,
    "original_line": 236,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/690220985",
    "pull_request_review_id": 731568701,
    "id": 690220985,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MDIyMDk4NQ==",
    "diff_hunk": "@@ -4710,83 +4745,83 @@ bool PeerManagerImpl::SendMessages(CNode* pto)\n             peer->m_blocks_for_inv_relay.clear();\n         }\n \n-        if (pto->m_tx_relay != nullptr) {\n-                LOCK(pto->m_tx_relay->cs_tx_inventory);\n+        if (peer->m_tx_relay != nullptr) {\n+                LOCK(peer->m_tx_relay->m_tx_inventory_mutex);\n                 // Check whether periodic sends should happen\n                 bool fSendTrickle = pto->HasPermission(NetPermissionFlags::NoBan);\n-                if (pto->m_tx_relay->nNextInvSend < current_time) {\n+                if (peer->m_tx_relay->m_next_inv_send_time < current_time) {\n                     fSendTrickle = true;\n                     if (pto->IsInboundConn()) {\n-                        pto->m_tx_relay->nNextInvSend = m_connman.PoissonNextSendInbound(current_time, INBOUND_INVENTORY_BROADCAST_INTERVAL);\n+                        peer->m_tx_relay->m_next_inv_send_time = m_connman.PoissonNextSendInbound(current_time, INBOUND_INVENTORY_BROADCAST_INTERVAL);\n                     } else {\n-                        pto->m_tx_relay->nNextInvSend = PoissonNextSend(current_time, OUTBOUND_INVENTORY_BROADCAST_INTERVAL);\n+                        peer->m_tx_relay->m_next_inv_send_time = PoissonNextSend(current_time, OUTBOUND_INVENTORY_BROADCAST_INTERVAL);\n                     }\n                 }\n \n                 // Time to send but the peer has requested we not relay transactions.\n                 if (fSendTrickle) {\n-                    LOCK(pto->m_tx_relay->cs_filter);\n-                    if (!pto->m_tx_relay->fRelayTxes) pto->m_tx_relay->setInventoryTxToSend.clear();\n+                    LOCK(peer->m_tx_relay->m_bloom_filter_mutex);\n+                    if (!peer->m_tx_relay->m_relay_txs) peer->m_tx_relay->m_tx_inventory_to_send.clear();",
    "path": "src/net_processing.cpp",
    "position": 560,
    "original_position": 557,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "cef5afc817214aa3f5e60fa1fd4a64872d6ee9a4",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Hmmm, actually `m_tx_inventory_mutex` is held at this point (see line 4747 above):\r\n\r\n```c++\r\n        if (peer->m_tx_relay != nullptr) {\r\n                LOCK(peer->m_tx_relay->m_tx_inventory_mutex);\r\n                ...\r\n```\r\n\r\nIn fact, all access of `m_tx_inventory_to_send` (and `setInventoryTxToSend` in master) is guarded by `m_tx_inventory_mutex` (`cs_tx_inventory` in master). It looks like an oversight in #13123 that a lock annotation wasn't added to `setInventoryTxToSend`. It could also be added to ` m_next_inv_send_time` (`nNextInvSend` in master).\r\n\r\nWe could add those annotations in a follow-up, since this branch is simply moving the data members and not changing any behavior here. I also have a separate follow-up branch that rationalizes these mutexes to a single mutex.",
    "created_at": "2021-08-17T10:00:33Z",
    "updated_at": "2021-08-17T10:00:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r690220985",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/690220985"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r690220985"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/690220985/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 4749,
    "original_start_line": 4728,
    "start_side": "LEFT",
    "line": 4789,
    "original_line": 4789,
    "side": "RIGHT",
    "in_reply_to_id": 689506531
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/690222852",
    "pull_request_review_id": 731571308,
    "id": 690222852,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MDIyMjg1Mg==",
    "diff_hunk": "@@ -3212,6 +3205,8 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n             pfrom.AddKnownTx(txid);\n         }\n \n+        LOCK2(cs_main, g_cs_orphans);\n+",
    "path": "src/net_processing.cpp",
    "position": 374,
    "original_position": 155,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "203bfe156b0a25a36c19fba397c8b2577bab1e9b",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Right. This `LOCK(cs_main)` was required to access the `CNodeState` in the line below. Now that `m_wtxid_relay` is in `Peer`, we don't need to hold `cs_main` until a little bit later (when we access `m_txrequest`).",
    "created_at": "2021-08-17T10:03:11Z",
    "updated_at": "2021-08-17T10:03:11Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r690222852",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/690222852"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r690222852"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/690222852/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 3270,
    "original_line": 3270,
    "side": "RIGHT",
    "in_reply_to_id": 689641819
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/690224534",
    "pull_request_review_id": 731573586,
    "id": 690224534,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MDIyNDUzNA==",
    "diff_hunk": "@@ -1199,6 +1195,8 @@ void PeerManagerImpl::FinalizeNode(const CNode& node)\n         PeerRef peer = RemovePeer(nodeid);\n         assert(peer != nullptr);\n         misbehavior = WITH_LOCK(peer->m_misbehavior_mutex, return peer->m_misbehavior_score);\n+        m_wtxid_relay_peers -= peer->m_wtxid_relay;",
    "path": "src/net_processing.cpp",
    "position": 162,
    "original_position": 53,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "203bfe156b0a25a36c19fba397c8b2577bab1e9b",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I agree that would be clearer.",
    "created_at": "2021-08-17T10:05:30Z",
    "updated_at": "2021-08-17T10:05:30Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r690224534",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/690224534"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r690224534"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/690224534/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1244,
    "original_line": 1244,
    "side": "RIGHT",
    "in_reply_to_id": 689646357
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/690225534",
    "pull_request_review_id": 731575017,
    "id": 690225534,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MDIyNTUzNA==",
    "diff_hunk": "@@ -227,28 +227,28 @@ struct Peer {\n     bool m_wtxid_relay{false};\n \n     struct TxRelay {\n-        mutable RecursiveMutex cs_filter;\n-        // We use fRelayTxes for two purposes -\n+        mutable RecursiveMutex m_bloom_filter_mutex;\n+        // We use m_relay_txs for two purposes -\n         // a) it allows us to not relay tx invs before receiving the peer's version message\n         // b) the peer may tell us in its version message that we should not relay tx invs\n         //    unless it loads a bloom filter.\n-        bool fRelayTxes GUARDED_BY(cs_filter){false};\n-        std::unique_ptr<CBloomFilter> pfilter PT_GUARDED_BY(cs_filter) GUARDED_BY(cs_filter){nullptr};\n+        bool m_relay_txs GUARDED_BY(m_bloom_filter_mutex){false};",
    "path": "src/net_processing.cpp",
    "position": 13,
    "original_position": 13,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "2533ea5161d2cb15b3a43e0fea9b146f525aea97",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes, this is slightly unfortunate. Please let me know if you have suggestions for improving the naming.",
    "created_at": "2021-08-17T10:07:03Z",
    "updated_at": "2021-08-17T10:07:04Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r690225534",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/690225534"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r690225534"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/690225534/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 236,
    "original_line": 236,
    "side": "RIGHT",
    "in_reply_to_id": 689696008
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691926265",
    "pull_request_review_id": 733743042,
    "id": 691926265,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTkyNjI2NQ==",
    "diff_hunk": "@@ -1666,22 +1706,17 @@ void PeerManagerImpl::SendPings()\n \n void PeerManagerImpl::RelayTransaction(const uint256& txid, const uint256& wtxid)\n {\n-    WITH_LOCK(cs_main, _RelayTransaction(txid, wtxid););\n-}\n-\n-void PeerManagerImpl::_RelayTransaction(const uint256& txid, const uint256& wtxid)",
    "path": "src/net_processing.cpp",
    "position": 198,
    "original_position": 195,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "2533ea5161d2cb15b3a43e0fea9b146f525aea97",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Commit 203bfe156b0a25a36c19fba397c8b2577bab1e9b `[net processing] Move m_wtxid_relay to Peer` introduces a usage of `CConnMan::ForEachNode()` with a lambda that returns `true` and `false`, however it should have a return type of `void`.\r\n\r\nThis is later removed in a subsequent commit.",
    "created_at": "2021-08-19T09:03:40Z",
    "updated_at": "2021-08-19T11:57:56Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r691926265",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691926265"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r691926265"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691926265/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1680,
    "original_line": 1680,
    "side": "LEFT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692115126",
    "pull_request_review_id": 733994263,
    "id": 692115126,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MjExNTEyNg==",
    "diff_hunk": "@@ -1666,22 +1706,17 @@ void PeerManagerImpl::SendPings()\n \n void PeerManagerImpl::RelayTransaction(const uint256& txid, const uint256& wtxid)\n {\n-    WITH_LOCK(cs_main, _RelayTransaction(txid, wtxid););\n-}\n-\n-void PeerManagerImpl::_RelayTransaction(const uint256& txid, const uint256& wtxid)",
    "path": "src/net_processing.cpp",
    "position": 198,
    "original_position": 195,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "2533ea5161d2cb15b3a43e0fea9b146f525aea97",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "fixed.",
    "created_at": "2021-08-19T13:33:54Z",
    "updated_at": "2021-08-19T13:33:55Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r692115126",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692115126"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r692115126"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692115126/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1680,
    "original_line": 1680,
    "side": "LEFT",
    "in_reply_to_id": 691926265
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692284808",
    "pull_request_review_id": 734214143,
    "id": 692284808,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MjI4NDgwOA==",
    "diff_hunk": "@@ -1114,7 +1114,6 @@ void RPCConsole::updateDetailWidget()\n         peerAddrDetails += \"<br />\" + tr(\"via %1\").arg(QString::fromStdString(stats->nodeStats.addrLocal));\n     ui->peerHeading->setText(peerAddrDetails);\n     ui->peerServices->setText(GUIUtil::formatServicesStr(stats->nodeStats.nServices));\n-    ui->peerRelayTxes->setText(stats->nodeStats.fRelayTxes ? ts.yes : ts.no);",
    "path": "src/qt/rpcconsole.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "0fb9ffba48215bb8b0ff4a56e253bc7c7678ef85",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Oh, this change is a bit surprising.  FWIW I found that I needed to add null-checking for the new `m_addr_*` statestats in #22501 to avoid parsing errors.",
    "created_at": "2021-08-19T16:18:13Z",
    "updated_at": "2021-08-19T18:31:41Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r692284808",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692284808"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r692284808"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692284808/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1169,
    "original_line": 1169,
    "side": "LEFT",
    "in_reply_to_id": 597831033
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/693531183",
    "pull_request_review_id": 735595446,
    "id": 693531183,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MzUzMTE4Mw==",
    "diff_hunk": "@@ -227,28 +227,28 @@ struct Peer {\n     bool m_wtxid_relay{false};\n \n     struct TxRelay {\n-        mutable RecursiveMutex cs_filter;\n-        // We use fRelayTxes for two purposes -\n+        mutable RecursiveMutex m_bloom_filter_mutex;\n+        // We use m_relay_txs for two purposes -\n         // a) it allows us to not relay tx invs before receiving the peer's version message\n         // b) the peer may tell us in its version message that we should not relay tx invs\n         //    unless it loads a bloom filter.\n-        bool fRelayTxes GUARDED_BY(cs_filter){false};\n-        std::unique_ptr<CBloomFilter> pfilter PT_GUARDED_BY(cs_filter) GUARDED_BY(cs_filter){nullptr};\n+        bool m_relay_txs GUARDED_BY(m_bloom_filter_mutex){false};",
    "path": "src/net_processing.cpp",
    "position": 13,
    "original_position": 13,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "2533ea5161d2cb15b3a43e0fea9b146f525aea97",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Is there a reason for the bool to exist? What would happen if we delayed initialization of the whole txrelay struct to when the version message is received?\r\n\r\nSomething similar is done for address relay, IIRC.",
    "created_at": "2021-08-22T17:15:50Z",
    "updated_at": "2021-08-22T17:16:49Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r693531183",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/693531183"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r693531183"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/693531183/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 236,
    "original_line": 236,
    "side": "RIGHT",
    "in_reply_to_id": 689696008
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/693924430",
    "pull_request_review_id": 736057234,
    "id": 693924430,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MzkyNDQzMA==",
    "diff_hunk": "@@ -227,28 +227,28 @@ struct Peer {\n     bool m_wtxid_relay{false};\n \n     struct TxRelay {\n-        mutable RecursiveMutex cs_filter;\n-        // We use fRelayTxes for two purposes -\n+        mutable RecursiveMutex m_bloom_filter_mutex;\n+        // We use m_relay_txs for two purposes -\n         // a) it allows us to not relay tx invs before receiving the peer's version message\n         // b) the peer may tell us in its version message that we should not relay tx invs\n         //    unless it loads a bloom filter.\n-        bool fRelayTxes GUARDED_BY(cs_filter){false};\n-        std::unique_ptr<CBloomFilter> pfilter PT_GUARDED_BY(cs_filter) GUARDED_BY(cs_filter){nullptr};\n+        bool m_relay_txs GUARDED_BY(m_bloom_filter_mutex){false};",
    "path": "src/net_processing.cpp",
    "position": 13,
    "original_position": 13,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "2533ea5161d2cb15b3a43e0fea9b146f525aea97",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@MarcoFalke yes, that's the plan. This PR is intended to be a simple refactor, and delaying initialization of the `TxRelay` struct requires more focused discussion so should be done in a separate PR.\r\n\r\nI've opened PR #22778, which implements delaying constructing `m_tx_relay` until the `version` message is received. Note however that `m_relay_txs` is still required - a peer that we've offered `NODE_BLOOM` services to may send us a version with `fRelay=0`, but later request that we start announcing transactions by sending `filterload` or `filterclear`, so we need to initialize the `TxRelay` struct during `version` handling but use `m_relay_txs` to gate whether we announce transactions.\r\n\r\nI'm going to mark this conversation as resolved, but please let me know in #22778 if you have any other thoughts/feedback.",
    "created_at": "2021-08-23T12:25:59Z",
    "updated_at": "2021-08-23T12:26:00Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r693924430",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/693924430"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r693924430"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/693924430/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 236,
    "original_line": 236,
    "side": "RIGHT",
    "in_reply_to_id": 689696008
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/701003777",
    "pull_request_review_id": 744953268,
    "id": 701003777,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwMTAwMzc3Nw==",
    "diff_hunk": "@@ -2593,6 +2593,7 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         if (pfrom.m_tx_relay != nullptr) {\n             LOCK(pfrom.m_tx_relay->cs_filter);\n             pfrom.m_tx_relay->fRelayTxes = fRelay; // set to true after we get the first filter* message\n+            if (fRelay) pfrom.m_relays_txs = true;",
    "path": "src/net_processing.cpp",
    "position": 296,
    "original_position": 4,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "bc3bc6ceb7265b8ea9f530066e6b79c75881f2e4",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit bc3bc6ceb7265b8ea9f530066e6b79c75881f2e4: Is there a reason to not use the shorter and more clear version `pfrom.m_relays_txs = fRelay`?",
    "created_at": "2021-09-02T11:44:15Z",
    "updated_at": "2021-09-02T14:29:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r701003777",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/701003777"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r701003777"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/701003777/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2645,
    "original_line": 2645,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/701105613",
    "pull_request_review_id": 744953268,
    "id": 701105613,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwMTEwNTYxMw==",
    "diff_hunk": "@@ -223,6 +223,9 @@ struct Peer {\n     /** Whether a ping has been requested by the user */\n     std::atomic<bool> m_ping_queued{false};\n \n+    /** Whether this peer relays txs via wtxid */\n+    bool m_wtxid_relay{false};",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "c46d1f5eef34ec210a21d4700d6f2d4ca0b6941a",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "c46d1f5eef34ec210a21d4700d6f2d4ca0b6941a: Is there some intuition available why this doesn't need any Mutex or atomic? The other members seem to have one.",
    "created_at": "2021-09-02T13:53:14Z",
    "updated_at": "2021-09-02T14:29:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r701105613",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/701105613"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r701105613"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/701105613/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 227,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/701114184",
    "pull_request_review_id": 744953268,
    "id": 701114184,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwMTExNDE4NA==",
    "diff_hunk": "@@ -204,18 +204,13 @@ void FillNode(FuzzedDataProvider& fuzzed_data_provider, CNode& node, bool init_v\n     const ServiceFlags remote_services = ConsumeWeakEnum(fuzzed_data_provider, ALL_SERVICE_FLAGS);\n     const NetPermissionFlags permission_flags = ConsumeWeakEnum(fuzzed_data_provider, ALL_NET_PERMISSION_FLAGS);\n     const int32_t version = fuzzed_data_provider.ConsumeIntegralInRange<int32_t>(MIN_PEER_PROTO_VERSION, std::numeric_limits<int32_t>::max());\n-    const bool filter_txs = fuzzed_data_provider.ConsumeBool();\n \n     node.nServices = remote_services;\n     node.m_permissionFlags = permission_flags;\n     if (init_version) {\n         node.nVersion = version;\n         node.SetCommonVersion(std::min(version, PROTOCOL_VERSION));\n     }\n-    if (node.m_tx_relay != nullptr) {\n-        LOCK(node.m_tx_relay->cs_filter);\n-        node.m_tx_relay->fRelayTxes = filter_txs;",
    "path": "src/test/fuzz/util.cpp",
    "position": 14,
    "original_position": 14,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "eeb0e84fc5c259dfd00f7673ad4a51582b100282",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "eeb0e84fc5c259dfd00f7673ad4a51582b100282: Would be nice to not break the fuzz test. Maybe a test-only mock method on PeerMan can do this?",
    "created_at": "2021-09-02T14:01:56Z",
    "updated_at": "2021-09-02T14:29:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r701114184",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/701114184"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r701114184"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/701114184/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 218,
    "original_line": 218,
    "side": "LEFT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/701118395",
    "pull_request_review_id": 744953268,
    "id": 701118395,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwMTExODM5NQ==",
    "diff_hunk": "@@ -218,7 +251,10 @@ struct Peer {\n     /** Work queue of items requested by this peer **/\n     std::deque<CInv> m_getdata_requests GUARDED_BY(m_getdata_requests_mutex);\n \n-    explicit Peer(NodeId id) : m_id(id) {}\n+    Peer(NodeId id, bool blocks_only)",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 45,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "6976a1c02ad0ea3a5c993b4ae886d4a86d458aa6",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Was this addressed?",
    "created_at": "2021-09-02T14:06:18Z",
    "updated_at": "2021-09-02T14:29:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r701118395",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/701118395"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r701118395"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/701118395/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 317,
    "side": "RIGHT",
    "in_reply_to_id": 623300544
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/701121335",
    "pull_request_review_id": 744953268,
    "id": 701121335,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwMTEyMTMzNQ==",
    "diff_hunk": "@@ -284,8 +314,9 @@ struct Peer {\n     /** Work queue of items requested by this peer **/\n     std::deque<CInv> m_getdata_requests GUARDED_BY(m_getdata_requests_mutex);\n \n-    explicit Peer(NodeId id)\n+    Peer(NodeId id, bool blocks_only)",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 42,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "eeb0e84fc5c259dfd00f7673ad4a51582b100282",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "eeb0e84fc5c259dfd00f7673ad4a51582b100282: Would be nice to rename this from `blocks_only` to `initialize_tx_relay` (or similar). `blocks_only` is confusingly similar named to the setting `-blocksonly`, but it really means block-relay-only.\r\n\r\nMoreover, the details *why* tx relay isn't initialized here don't matter *here*, so a bool with a more general name seems fine.",
    "created_at": "2021-09-02T14:09:23Z",
    "updated_at": "2021-09-02T14:29:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r701121335",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/701121335"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r701121335"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/701121335/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 317,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/701123514",
    "pull_request_review_id": 744953268,
    "id": 701123514,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwMTEyMzUxNA==",
    "diff_hunk": "@@ -1286,6 +1325,11 @@ bool PeerManagerImpl::GetNodeStateStats(NodeId nodeid, CNodeStateStats& stats) c\n         ping_wait = GetTime<std::chrono::microseconds>() - peer->m_ping_start.load();\n     }\n \n+    if (peer->m_tx_relay != nullptr) {\n+        stats.fRelayTxes = WITH_LOCK(peer->m_tx_relay->cs_filter, return peer->m_tx_relay->fRelayTxes);\n+        stats.minFeeFilter = peer->m_tx_relay->minFeeFilter.load();\n+    }",
    "path": "src/net_processing.cpp",
    "position": 186,
    "original_position": 123,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "eeb0e84fc5c259dfd00f7673ad4a51582b100282",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "eeb0e84fc5c259dfd00f7673ad4a51582b100282: any reason to make this code more fragile by removing the `else` in the move? The `else` used to set those to `false`, and `0`, respectively.",
    "created_at": "2021-09-02T14:11:39Z",
    "updated_at": "2021-09-02T14:29:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r701123514",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/701123514"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r701123514"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/701123514/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1341,
    "original_line": 1341,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/701125057",
    "pull_request_review_id": 744953268,
    "id": 701125057,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcwMTEyNTA1Nw==",
    "diff_hunk": "@@ -29,6 +29,8 @@ struct CNodeStateStats {\n     int m_starting_height = -1;\n     std::chrono::microseconds m_ping_wait;\n     std::vector<int> vHeightInFlight;\n+    bool fRelayTxes{false};\n+    CAmount minFeeFilter{0};",
    "path": "src/net_processing.h",
    "position": null,
    "original_position": 5,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "eeb0e84fc5c259dfd00f7673ad4a51582b100282",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "eeb0e84fc5c259dfd00f7673ad4a51582b100282: Why not `-1` (an impossible number), like the height values above? Or  maybe leave it uninitialized to make memory sanitizers more useful?",
    "created_at": "2021-09-02T14:13:23Z",
    "updated_at": "2021-09-02T14:29:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r701125057",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/701125057"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r701125057"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/701125057/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 33,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715461019",
    "pull_request_review_id": 762875376,
    "id": 715461019,
    "node_id": "PRRC_kwDOABII584qpRGb",
    "diff_hunk": "@@ -218,7 +251,10 @@ struct Peer {\n     /** Work queue of items requested by this peer **/\n     std::deque<CInv> m_getdata_requests GUARDED_BY(m_getdata_requests_mutex);\n \n-    explicit Peer(NodeId id) : m_id(id) {}\n+    Peer(NodeId id, bool blocks_only)",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 45,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "6976a1c02ad0ea3a5c993b4ae886d4a86d458aa6",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "fixed now",
    "created_at": "2021-09-24T09:28:39Z",
    "updated_at": "2021-09-24T09:28:39Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r715461019",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715461019"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r715461019"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715461019/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 317,
    "side": "RIGHT",
    "in_reply_to_id": 623300544
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715462001",
    "pull_request_review_id": 762876628,
    "id": 715462001,
    "node_id": "PRRC_kwDOABII584qpRVx",
    "diff_hunk": "@@ -284,8 +314,9 @@ struct Peer {\n     /** Work queue of items requested by this peer **/\n     std::deque<CInv> m_getdata_requests GUARDED_BY(m_getdata_requests_mutex);\n \n-    explicit Peer(NodeId id)\n+    Peer(NodeId id, bool blocks_only)",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 42,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "eeb0e84fc5c259dfd00f7673ad4a51582b100282",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done",
    "created_at": "2021-09-24T09:30:02Z",
    "updated_at": "2021-09-24T09:30:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r715462001",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715462001"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r715462001"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715462001/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 317,
    "side": "RIGHT",
    "in_reply_to_id": 701121335
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715493509",
    "pull_request_review_id": 762918603,
    "id": 715493509,
    "node_id": "PRRC_kwDOABII584qpZCF",
    "diff_hunk": "@@ -2593,6 +2593,7 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         if (pfrom.m_tx_relay != nullptr) {\n             LOCK(pfrom.m_tx_relay->cs_filter);\n             pfrom.m_tx_relay->fRelayTxes = fRelay; // set to true after we get the first filter* message\n+            if (fRelay) pfrom.m_relays_txs = true;",
    "path": "src/net_processing.cpp",
    "position": 296,
    "original_position": 4,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "bc3bc6ceb7265b8ea9f530066e6b79c75881f2e4",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Because of the comment for m_relay_txs in net.h:\r\n\r\n    /** ... This only changes from false to true. It will never change\r\n     *  back to false. Used only in inbound eviction logic. */\r\n\r\nThis doesn't work:\r\n\r\n```suggestion\r\n            pfrom.m_relays_txs &= fRelay;\r\n```\r\n\r\nsince the `&=` operator isn't defined for `std::atomic<bool>`. I could use:\r\n\r\n```suggestion\r\n            pfrom.m_relays_txs = pfrom.m_relay_txs && fRelay;\r\n```\r\n\r\nbut I don't think that's an improvement.",
    "created_at": "2021-09-24T10:18:18Z",
    "updated_at": "2021-09-24T10:18:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r715493509",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715493509"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r715493509"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715493509/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2645,
    "original_line": 2645,
    "side": "RIGHT",
    "in_reply_to_id": 701003777
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715499602",
    "pull_request_review_id": 762926924,
    "id": 715499602,
    "node_id": "PRRC_kwDOABII584qpahS",
    "diff_hunk": "@@ -223,6 +223,9 @@ struct Peer {\n     /** Whether a ping has been requested by the user */\n     std::atomic<bool> m_ping_queued{false};\n \n+    /** Whether this peer relays txs via wtxid */\n+    bool m_wtxid_relay{false};",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "c46d1f5eef34ec210a21d4700d6f2d4ca0b6941a",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "No reason. I've updated this to be an atomic.",
    "created_at": "2021-09-24T10:28:39Z",
    "updated_at": "2021-09-24T10:28:39Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r715499602",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715499602"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r715499602"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715499602/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 227,
    "side": "RIGHT",
    "in_reply_to_id": 701105613
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715503886",
    "pull_request_review_id": 762932590,
    "id": 715503886,
    "node_id": "PRRC_kwDOABII584qpbkO",
    "diff_hunk": "@@ -204,18 +204,13 @@ void FillNode(FuzzedDataProvider& fuzzed_data_provider, CNode& node, bool init_v\n     const ServiceFlags remote_services = ConsumeWeakEnum(fuzzed_data_provider, ALL_SERVICE_FLAGS);\n     const NetPermissionFlags permission_flags = ConsumeWeakEnum(fuzzed_data_provider, ALL_NET_PERMISSION_FLAGS);\n     const int32_t version = fuzzed_data_provider.ConsumeIntegralInRange<int32_t>(MIN_PEER_PROTO_VERSION, std::numeric_limits<int32_t>::max());\n-    const bool filter_txs = fuzzed_data_provider.ConsumeBool();\n \n     node.nServices = remote_services;\n     node.m_permissionFlags = permission_flags;\n     if (init_version) {\n         node.nVersion = version;\n         node.SetCommonVersion(std::min(version, PROTOCOL_VERSION));\n     }\n-    if (node.m_tx_relay != nullptr) {\n-        LOCK(node.m_tx_relay->cs_filter);\n-        node.m_tx_relay->fRelayTxes = filter_txs;",
    "path": "src/test/fuzz/util.cpp",
    "position": 14,
    "original_position": 14,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "eeb0e84fc5c259dfd00f7673ad4a51582b100282",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Does this break the fuzz test? `fRelayTxes` (`m_relay_txs` after this PR) will get set after the node receives and processes the `version` message. Presumably the fuzzer will be able to set the `fRelay` field on that message to true or false.",
    "created_at": "2021-09-24T10:36:07Z",
    "updated_at": "2021-09-24T10:36:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r715503886",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715503886"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r715503886"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715503886/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 218,
    "original_line": 218,
    "side": "LEFT",
    "in_reply_to_id": 701114184
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715508638",
    "pull_request_review_id": 762938495,
    "id": 715508638,
    "node_id": "PRRC_kwDOABII584qpcue",
    "diff_hunk": "@@ -1286,6 +1325,11 @@ bool PeerManagerImpl::GetNodeStateStats(NodeId nodeid, CNodeStateStats& stats) c\n         ping_wait = GetTime<std::chrono::microseconds>() - peer->m_ping_start.load();\n     }\n \n+    if (peer->m_tx_relay != nullptr) {\n+        stats.fRelayTxes = WITH_LOCK(peer->m_tx_relay->cs_filter, return peer->m_tx_relay->fRelayTxes);\n+        stats.minFeeFilter = peer->m_tx_relay->minFeeFilter.load();\n+    }",
    "path": "src/net_processing.cpp",
    "position": 186,
    "original_position": 123,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "eeb0e84fc5c259dfd00f7673ad4a51582b100282",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I don't think I agree that this is more fragile. The default is that there connection isn't being used to relay transactions, and the feefilter is set to zero. Those stats are only updated if the node is relaying transactions/has set a feefilter.\r\n\r\nI've reverted this to use if/else and remove the default initialization, since that's closer to the current code.",
    "created_at": "2021-09-24T10:43:52Z",
    "updated_at": "2021-09-24T10:43:52Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r715508638",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715508638"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r715508638"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715508638/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1341,
    "original_line": 1341,
    "side": "RIGHT",
    "in_reply_to_id": 701123514
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715508755",
    "pull_request_review_id": 762938647,
    "id": 715508755,
    "node_id": "PRRC_kwDOABII584qpcwT",
    "diff_hunk": "@@ -29,6 +29,8 @@ struct CNodeStateStats {\n     int m_starting_height = -1;\n     std::chrono::microseconds m_ping_wait;\n     std::vector<int> vHeightInFlight;\n+    bool fRelayTxes{false};\n+    CAmount minFeeFilter{0};",
    "path": "src/net_processing.h",
    "position": null,
    "original_position": 5,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "eeb0e84fc5c259dfd00f7673ad4a51582b100282",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "As above (https://github.com/bitcoin/bitcoin/pull/21160#discussion_r715508638)",
    "created_at": "2021-09-24T10:44:04Z",
    "updated_at": "2021-09-24T10:44:04Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r715508755",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715508755"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r715508755"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715508755/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 33,
    "side": "RIGHT",
    "in_reply_to_id": 701125057
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715630337",
    "pull_request_review_id": 763103760,
    "id": 715630337,
    "node_id": "PRRC_kwDOABII584qp6cB",
    "diff_hunk": "@@ -2593,6 +2593,7 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         if (pfrom.m_tx_relay != nullptr) {\n             LOCK(pfrom.m_tx_relay->cs_filter);\n             pfrom.m_tx_relay->fRelayTxes = fRelay; // set to true after we get the first filter* message\n+            if (fRelay) pfrom.m_relays_txs = true;",
    "path": "src/net_processing.cpp",
    "position": 296,
    "original_position": 4,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "bc3bc6ceb7265b8ea9f530066e6b79c75881f2e4",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`pfrom.m_relays_txs = pfrom.m_relay_txs && fRelay;` could change it from `true` to `false`.",
    "created_at": "2021-09-24T13:50:31Z",
    "updated_at": "2021-09-24T13:50:31Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r715630337",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715630337"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r715630337"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/715630337/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2645,
    "original_line": 2645,
    "side": "RIGHT",
    "in_reply_to_id": 701003777
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/718258602",
    "pull_request_review_id": 766339398,
    "id": 718258602,
    "node_id": "PRRC_kwDOABII584qz8Gq",
    "diff_hunk": "@@ -557,6 +557,16 @@ class CNode\n     // m_tx_relay == nullptr if we're not relaying transactions with this peer\n     std::unique_ptr<TxRelay> m_tx_relay;\n \n+    /** Whether we should relay transactions to this peer (their version\n+     *  message did not include fRelay=false and this is not a block-relay-only\n+     *  connection). This only changes from false to true. It will never change",
    "path": "src/net.h",
    "position": 47,
    "original_position": 6,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "ae98de60d4dd54afe2c47b33e9fb53acd0e8492f",
    "user": {
      "login": "naumenkogs",
      "id": 7975071,
      "node_id": "MDQ6VXNlcjc5NzUwNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naumenkogs",
      "html_url": "https://github.com/naumenkogs",
      "followers_url": "https://api.github.com/users/naumenkogs/followers",
      "following_url": "https://api.github.com/users/naumenkogs/following{/other_user}",
      "gists_url": "https://api.github.com/users/naumenkogs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
      "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
      "repos_url": "https://api.github.com/users/naumenkogs/repos",
      "events_url": "https://api.github.com/users/naumenkogs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": ">This only changes from false to true\r\n\r\nCould you mention that this happens only at the beginning of the connection lifetime?",
    "created_at": "2021-09-29T08:07:56Z",
    "updated_at": "2021-09-29T08:07:56Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r718258602",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/718258602"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r718258602"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/718258602/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 531,
    "original_line": 531,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/718350619",
    "pull_request_review_id": 766464202,
    "id": 718350619,
    "node_id": "PRRC_kwDOABII584q0Skb",
    "diff_hunk": "@@ -2593,6 +2593,7 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         if (pfrom.m_tx_relay != nullptr) {\n             LOCK(pfrom.m_tx_relay->cs_filter);\n             pfrom.m_tx_relay->fRelayTxes = fRelay; // set to true after we get the first filter* message\n+            if (fRelay) pfrom.m_relays_txs = true;",
    "path": "src/net_processing.cpp",
    "position": 296,
    "original_position": 4,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "bc3bc6ceb7265b8ea9f530066e6b79c75881f2e4",
    "user": {
      "login": "naumenkogs",
      "id": 7975071,
      "node_id": "MDQ6VXNlcjc5NzUwNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naumenkogs",
      "html_url": "https://github.com/naumenkogs",
      "followers_url": "https://api.github.com/users/naumenkogs/followers",
      "following_url": "https://api.github.com/users/naumenkogs/following{/other_user}",
      "gists_url": "https://api.github.com/users/naumenkogs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
      "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
      "repos_url": "https://api.github.com/users/naumenkogs/repos",
      "events_url": "https://api.github.com/users/naumenkogs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think the comment is a good justification to keeping the code this way.\r\nThe only problem I can see is the temptation of future devs to change this.",
    "created_at": "2021-09-29T09:58:03Z",
    "updated_at": "2021-09-29T09:58:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r718350619",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/718350619"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r718350619"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/718350619/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2645,
    "original_line": 2645,
    "side": "RIGHT",
    "in_reply_to_id": 701003777
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/718686753",
    "pull_request_review_id": 766925720,
    "id": 718686753,
    "node_id": "PRRC_kwDOABII584q1koh",
    "diff_hunk": "@@ -2593,6 +2593,7 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         if (pfrom.m_tx_relay != nullptr) {\n             LOCK(pfrom.m_tx_relay->cs_filter);\n             pfrom.m_tx_relay->fRelayTxes = fRelay; // set to true after we get the first filter* message\n+            if (fRelay) pfrom.m_relays_txs = true;",
    "path": "src/net_processing.cpp",
    "position": 296,
    "original_position": 4,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "bc3bc6ceb7265b8ea9f530066e6b79c75881f2e4",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> pfrom.m_relays_txs = pfrom.m_relay_txs && fRelay; could change it from true to false.\r\n\r\n:man_facepalming: You're right of course. I meant `pfrom.m_relay_txs || fRelay;`",
    "created_at": "2021-09-29T16:22:35Z",
    "updated_at": "2021-09-29T16:22:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r718686753",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/718686753"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r718686753"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/718686753/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2645,
    "original_line": 2645,
    "side": "RIGHT",
    "in_reply_to_id": 701003777
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/718695406",
    "pull_request_review_id": 766937107,
    "id": 718695406,
    "node_id": "PRRC_kwDOABII584q1mvu",
    "diff_hunk": "@@ -557,6 +557,16 @@ class CNode\n     // m_tx_relay == nullptr if we're not relaying transactions with this peer\n     std::unique_ptr<TxRelay> m_tx_relay;\n \n+    /** Whether we should relay transactions to this peer (their version\n+     *  message did not include fRelay=false and this is not a block-relay-only\n+     *  connection). This only changes from false to true. It will never change",
    "path": "src/net.h",
    "position": 47,
    "original_position": 6,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "ae98de60d4dd54afe2c47b33e9fb53acd0e8492f",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`m_relays_txs` can be set to true after initial connection, if the peer sends a `filterload` or `filterclear` message.",
    "created_at": "2021-09-29T16:33:12Z",
    "updated_at": "2021-09-29T16:33:12Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r718695406",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/718695406"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r718695406"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/718695406/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 531,
    "original_line": 531,
    "side": "RIGHT",
    "in_reply_to_id": 718258602
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/719121059",
    "pull_request_review_id": 767475316,
    "id": 719121059,
    "node_id": "PRRC_kwDOABII584q3Oqj",
    "diff_hunk": "@@ -557,6 +557,16 @@ class CNode\n     // m_tx_relay == nullptr if we're not relaying transactions with this peer\n     std::unique_ptr<TxRelay> m_tx_relay;\n \n+    /** Whether we should relay transactions to this peer (their version\n+     *  message did not include fRelay=false and this is not a block-relay-only\n+     *  connection). This only changes from false to true. It will never change",
    "path": "src/net.h",
    "position": 47,
    "original_position": 6,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "ae98de60d4dd54afe2c47b33e9fb53acd0e8492f",
    "user": {
      "login": "naumenkogs",
      "id": 7975071,
      "node_id": "MDQ6VXNlcjc5NzUwNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7975071?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naumenkogs",
      "html_url": "https://github.com/naumenkogs",
      "followers_url": "https://api.github.com/users/naumenkogs/followers",
      "following_url": "https://api.github.com/users/naumenkogs/following{/other_user}",
      "gists_url": "https://api.github.com/users/naumenkogs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
      "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
      "repos_url": "https://api.github.com/users/naumenkogs/repos",
      "events_url": "https://api.github.com/users/naumenkogs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Right, thanks.",
    "created_at": "2021-09-30T07:12:22Z",
    "updated_at": "2021-09-30T07:12:22Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r719121059",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/719121059"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r719121059"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/719121059/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 531,
    "original_line": 531,
    "side": "RIGHT",
    "in_reply_to_id": 718258602
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/735625280",
    "pull_request_review_id": 788156197,
    "id": 735625280,
    "node_id": "PRRC_kwDOABII584r2MBA",
    "diff_hunk": "@@ -204,18 +204,13 @@ void FillNode(FuzzedDataProvider& fuzzed_data_provider, CNode& node, bool init_v\n     const ServiceFlags remote_services = ConsumeWeakEnum(fuzzed_data_provider, ALL_SERVICE_FLAGS);\n     const NetPermissionFlags permission_flags = ConsumeWeakEnum(fuzzed_data_provider, ALL_NET_PERMISSION_FLAGS);\n     const int32_t version = fuzzed_data_provider.ConsumeIntegralInRange<int32_t>(MIN_PEER_PROTO_VERSION, std::numeric_limits<int32_t>::max());\n-    const bool filter_txs = fuzzed_data_provider.ConsumeBool();\n \n     node.nServices = remote_services;\n     node.m_permissionFlags = permission_flags;\n     if (init_version) {\n         node.nVersion = version;\n         node.SetCommonVersion(std::min(version, PROTOCOL_VERSION));\n     }\n-    if (node.m_tx_relay != nullptr) {\n-        LOCK(node.m_tx_relay->cs_filter);\n-        node.m_tx_relay->fRelayTxes = filter_txs;",
    "path": "src/test/fuzz/util.cpp",
    "position": 14,
    "original_position": 14,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "eeb0e84fc5c259dfd00f7673ad4a51582b100282",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "There is only one fuzz test to send more than one message type in one session, so this will break all other fuzz tests that only send one message type.",
    "created_at": "2021-10-25T13:55:30Z",
    "updated_at": "2021-10-25T13:55:30Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r735625280",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/735625280"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r735625280"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/735625280/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 218,
    "original_line": 218,
    "side": "LEFT",
    "in_reply_to_id": 701114184
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/735626454",
    "pull_request_review_id": 788157807,
    "id": 735626454,
    "node_id": "PRRC_kwDOABII584r2MTW",
    "diff_hunk": "@@ -284,8 +314,9 @@ struct Peer {\n     /** Work queue of items requested by this peer **/\n     std::deque<CInv> m_getdata_requests GUARDED_BY(m_getdata_requests_mutex);\n \n-    explicit Peer(NodeId id)\n+    Peer(NodeId id, bool blocks_only)",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 42,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "eeb0e84fc5c259dfd00f7673ad4a51582b100282",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Obviously that means you'll have to toggle the code after renaming the symbol ;)",
    "created_at": "2021-10-25T13:56:39Z",
    "updated_at": "2021-10-25T13:56:39Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r735626454",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/735626454"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r735626454"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/735626454/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 317,
    "side": "RIGHT",
    "in_reply_to_id": 701121335
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/735643977",
    "pull_request_review_id": 788182672,
    "id": 735643977,
    "node_id": "PRRC_kwDOABII584r2QlJ",
    "diff_hunk": "@@ -282,8 +315,9 @@ struct Peer {\n     /** Work queue of items requested by this peer **/\n     std::deque<CInv> m_getdata_requests GUARDED_BY(m_getdata_requests_mutex);\n \n-    explicit Peer(NodeId id)\n+    explicit Peer(NodeId id, bool tx_relay)\n         : m_id(id)\n+        , m_tx_relay(tx_relay ? nullptr : std::make_unique<TxRelay>())",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 47,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "b0dfefec249302cd9d9f121fe081a9a51294d0ab",
    "user": {
      "login": "glozow",
      "id": 25183001,
      "node_id": "MDQ6VXNlcjI1MTgzMDAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/glozow",
      "html_url": "https://github.com/glozow",
      "followers_url": "https://api.github.com/users/glozow/followers",
      "following_url": "https://api.github.com/users/glozow/following{/other_user}",
      "gists_url": "https://api.github.com/users/glozow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/glozow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
      "organizations_url": "https://api.github.com/users/glozow/orgs",
      "repos_url": "https://api.github.com/users/glozow/repos",
      "events_url": "https://api.github.com/users/glozow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/glozow/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I see that this bool was renamed from `blocks_only` to `tx_relay` based on Marco's comment https://github.com/bitcoin/bitcoin/pull/21160#discussion_r701121335. The rename makes sense to me, but it's a little odd that if `tx_relay=true` you make `m_tx_relay` null... I would've expected it to be the other way around? :thinking: ",
    "created_at": "2021-10-25T14:14:51Z",
    "updated_at": "2021-10-25T14:15:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r735643977",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/735643977"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r735643977"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/735643977/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 1
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 320,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736785417",
    "pull_request_review_id": 789732433,
    "id": 736785417,
    "node_id": "PRRC_kwDOABII584r6nQJ",
    "diff_hunk": "@@ -2593,6 +2593,7 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         if (pfrom.m_tx_relay != nullptr) {\n             LOCK(pfrom.m_tx_relay->cs_filter);\n             pfrom.m_tx_relay->fRelayTxes = fRelay; // set to true after we get the first filter* message\n+            if (fRelay) pfrom.m_relays_txs = true;",
    "path": "src/net_processing.cpp",
    "position": 296,
    "original_position": 4,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "bc3bc6ceb7265b8ea9f530066e6b79c75881f2e4",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Setting these values should be fine outside of the lock, right?\r\n\r\nCan you move this out of the lock scope to make that clear?",
    "created_at": "2021-10-26T17:50:17Z",
    "updated_at": "2021-10-26T19:04:06Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r736785417",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736785417"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r736785417"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736785417/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2645,
    "original_line": 2645,
    "side": "RIGHT",
    "in_reply_to_id": 701003777
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736785662",
    "pull_request_review_id": 789732433,
    "id": 736785662,
    "node_id": "PRRC_kwDOABII584r6nT-",
    "diff_hunk": "@@ -3910,7 +3911,9 @@ void PeerManagerImpl::ProcessMessage(CNode& pfrom, const std::string& msg_type,\n         {\n             LOCK(pfrom.m_tx_relay->cs_filter);\n             pfrom.m_tx_relay->pfilter.reset(new CBloomFilter(filter));\n+            pfrom.m_bloom_filter_loaded = true;",
    "path": "src/net_processing.cpp",
    "position": 430,
    "original_position": 12,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "a65a919ad1975932a7aaa2e9b5a27e15bb7e44f0",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Same comment about lock scope here (and the hunk below as well)",
    "created_at": "2021-10-26T17:50:38Z",
    "updated_at": "2021-10-26T19:04:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r736785662",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736785662"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r736785662"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736785662/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 3952,
    "original_line": 3952,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736788800",
    "pull_request_review_id": 789732433,
    "id": 736788800,
    "node_id": "PRRC_kwDOABII584r6oFA",
    "diff_hunk": "@@ -1044,18 +1044,11 @@ bool CConnman::AttemptToEvictConnection()\n                 continue;\n             if (node->fDisconnect)\n                 continue;\n-            bool peer_relay_txes = false;\n-            bool peer_filter_not_null = false;\n-            if (node->m_tx_relay != nullptr) {\n-                LOCK(node->m_tx_relay->cs_filter);\n-                peer_relay_txes = node->m_tx_relay->fRelayTxes;\n-                peer_filter_not_null = node->m_tx_relay->pfilter != nullptr;\n-            }\n             NodeEvictionCandidate candidate = {node->GetId(), node->nTimeConnected, node->m_min_ping_time,\n                                                node->nLastBlockTime, node->nLastTXTime,\n                                                HasAllDesirableServiceFlags(node->nServices),\n-                                               peer_relay_txes, peer_filter_not_null, node->nKeyedNetGroup,\n-                                               node->m_prefer_evict, node->addr.IsLocal(),\n+                                               node->m_relays_txs.load(), node->m_bloom_filter_loaded.load(),",
    "path": "src/net.cpp",
    "position": 68,
    "original_position": 16,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "a65a919ad1975932a7aaa2e9b5a27e15bb7e44f0",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This is the only place where these values are read outside of a lock which keeps their writes in sync.  I suppose these rarely being out of sync is of no consequence?",
    "created_at": "2021-10-26T17:54:49Z",
    "updated_at": "2021-10-26T19:04:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r736788800",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736788800"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r736788800"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736788800/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1059,
    "original_line": 1059,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736814974",
    "pull_request_review_id": 789732433,
    "id": 736814974,
    "node_id": "PRRC_kwDOABII584r6ud-",
    "diff_hunk": "@@ -282,8 +315,9 @@ struct Peer {\n     /** Work queue of items requested by this peer **/\n     std::deque<CInv> m_getdata_requests GUARDED_BY(m_getdata_requests_mutex);\n \n-    explicit Peer(NodeId id)\n+    explicit Peer(NodeId id, bool tx_relay)\n         : m_id(id)\n+        , m_tx_relay(tx_relay ? nullptr : std::make_unique<TxRelay>())",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 47,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "b0dfefec249302cd9d9f121fe081a9a51294d0ab",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Agreed. Can't parse this as-is.",
    "created_at": "2021-10-26T18:30:53Z",
    "updated_at": "2021-10-26T19:04:06Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r736814974",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736814974"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r736814974"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736814974/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 320,
    "side": "RIGHT",
    "in_reply_to_id": 735643977
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736822577",
    "pull_request_review_id": 789732433,
    "id": 736822577,
    "node_id": "PRRC_kwDOABII584r6wUx",
    "diff_hunk": "@@ -385,7 +416,7 @@ class PeerManagerImpl final : public PeerManager\n         EXCLUSIVE_LOCKS_REQUIRED(::cs_main);\n \n     /** Send a version message to a peer */\n-    void PushNodeVersion(CNode& pnode, int64_t nTime);\n+    void PushNodeVersion(CNode& pnode, Peer& peer, int64_t nTime);",
    "path": "src/net_processing.cpp",
    "position": 66,
    "original_position": 53,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "4bd66febf39346ea23551421340dbd70e7e137ca",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Why not `const Peer& peer` here (and for `MaybeSendFeefilter`), since it's used read-only?",
    "created_at": "2021-10-26T18:41:48Z",
    "updated_at": "2021-10-26T19:04:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r736822577",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736822577"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r736822577"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736822577/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 419,
    "original_line": 419,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736823554",
    "pull_request_review_id": 789732433,
    "id": 736823554,
    "node_id": "PRRC_kwDOABII584r6wkC",
    "diff_hunk": "@@ -803,6 +834,14 @@ static void PushAddress(Peer& peer, const CAddress& addr, FastRandomContext& ins\n     }\n }\n \n+static void AddKnownTx(Peer& peer, const uint256& hash)",
    "path": "src/net_processing.cpp",
    "position": 102,
    "original_position": 70,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "4bd66febf39346ea23551421340dbd70e7e137ca",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Why not make this a member function of `Peer` to avoid having to peek at the internal lock?",
    "created_at": "2021-10-26T18:43:12Z",
    "updated_at": "2021-10-26T19:04:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r736823554",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736823554"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r736823554"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736823554/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 837,
    "original_line": 837,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736827240",
    "pull_request_review_id": 789732433,
    "id": 736827240,
    "node_id": "PRRC_kwDOABII584r6xdo",
    "diff_hunk": "@@ -1086,7 +1125,7 @@ void PeerManagerImpl::FindNextBlocksToDownload(NodeId nodeid, unsigned int count\n \n } // namespace\n \n-void PeerManagerImpl::PushNodeVersion(CNode& pnode, int64_t nTime)\n+void PeerManagerImpl::PushNodeVersion(CNode& pnode, Peer& peer, int64_t nTime)",
    "path": "src/net_processing.cpp",
    "position": 118,
    "original_position": 86,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "4bd66febf39346ea23551421340dbd70e7e137ca",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Afaics, all this needs is a bool for `peer.m_tx_relay != nullptr`, otherwise `Peer` is unused here. Maybe just pass the bool instead of requiring all of `Peer`?",
    "created_at": "2021-10-26T18:48:30Z",
    "updated_at": "2021-10-26T19:04:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r736827240",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736827240"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r736827240"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736827240/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1128,
    "original_line": 1128,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736828470",
    "pull_request_review_id": 789732433,
    "id": 736828470,
    "node_id": "PRRC_kwDOABII584r6xw2",
    "diff_hunk": "@@ -4420,12 +4460,12 @@ void PeerManagerImpl::MaybeSendAddr(CNode& node, Peer& peer, std::chrono::micros\n     }\n }\n \n-void PeerManagerImpl::MaybeSendFeefilter(CNode& pto, std::chrono::microseconds current_time)\n+void PeerManagerImpl::MaybeSendFeefilter(CNode& pto, Peer& peer, std::chrono::microseconds current_time)",
    "path": "src/net_processing.cpp",
    "position": 486,
    "original_position": 365,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "4bd66febf39346ea23551421340dbd70e7e137ca",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Likewise, this doesn't need all of `Peer`, only a `Peer::TxRelay`.",
    "created_at": "2021-10-26T18:50:24Z",
    "updated_at": "2021-10-26T19:04:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r736828470",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736828470"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r736828470"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736828470/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 4467,
    "original_line": 4467,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736834651",
    "pull_request_review_id": 789732433,
    "id": 736834651,
    "node_id": "PRRC_kwDOABII584r6zRb",
    "diff_hunk": "@@ -1157,13 +1196,13 @@ void PeerManagerImpl::InitializeNode(CNode *pnode)\n         mapNodeState.emplace_hint(mapNodeState.end(), std::piecewise_construct, std::forward_as_tuple(nodeid), std::forward_as_tuple(pnode->IsInboundConn()));\n         assert(m_txrequest.Count(nodeid) == 0);\n     }\n+    PeerRef peer = std::make_shared<Peer>(nodeid, pnode->IsBlockOnlyConn());\n     {\n-        PeerRef peer = std::make_shared<Peer>(nodeid);\n         LOCK(m_peer_mutex);\n-        m_peer_map.emplace_hint(m_peer_map.end(), nodeid, std::move(peer));\n+        m_peer_map.emplace_hint(m_peer_map.end(), nodeid, peer);\n     }\n     if (!pnode->IsInboundConn()) {\n-        PushNodeVersion(*pnode, GetTime());\n+        PushNodeVersion(*pnode, *peer, GetTime());",
    "path": "src/net_processing.cpp",
    "position": 144,
    "original_position": 112,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "4bd66febf39346ea23551421340dbd70e7e137ca",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "See comment above about changing the `PushNodeVersion` params, which would eliminate the need for the copies here.",
    "created_at": "2021-10-26T18:59:13Z",
    "updated_at": "2021-10-26T19:04:06Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r736834651",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736834651"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r736834651"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/736834651/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1205,
    "original_line": 1205,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739150583",
    "pull_request_review_id": 792921402,
    "id": 739150583,
    "node_id": "PRRC_kwDOABII584sDor3",
    "diff_hunk": "@@ -282,8 +315,9 @@ struct Peer {\n     /** Work queue of items requested by this peer **/\n     std::deque<CInv> m_getdata_requests GUARDED_BY(m_getdata_requests_mutex);\n \n-    explicit Peer(NodeId id)\n+    explicit Peer(NodeId id, bool tx_relay)\n         : m_id(id)\n+        , m_tx_relay(tx_relay ? nullptr : std::make_unique<TxRelay>())",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 47,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "b0dfefec249302cd9d9f121fe081a9a51294d0ab",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Oops. Fixed properly now.",
    "created_at": "2021-10-29T11:23:29Z",
    "updated_at": "2021-10-29T11:23:29Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r739150583",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739150583"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r739150583"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739150583/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 320,
    "side": "RIGHT",
    "in_reply_to_id": 735643977
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739171097",
    "pull_request_review_id": 792948537,
    "id": 739171097,
    "node_id": "PRRC_kwDOABII584sDtsZ",
    "diff_hunk": "@@ -284,8 +314,9 @@ struct Peer {\n     /** Work queue of items requested by this peer **/\n     std::deque<CInv> m_getdata_requests GUARDED_BY(m_getdata_requests_mutex);\n \n-    explicit Peer(NodeId id)\n+    Peer(NodeId id, bool blocks_only)",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 42,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "eeb0e84fc5c259dfd00f7673ad4a51582b100282",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done! (https://github.com/bitcoin/bitcoin/pull/21160#discussion_r739150583)",
    "created_at": "2021-10-29T11:57:50Z",
    "updated_at": "2021-10-29T11:57:50Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r739171097",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739171097"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r739171097"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739171097/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 317,
    "side": "RIGHT",
    "in_reply_to_id": 701121335
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739178813",
    "pull_request_review_id": 792959744,
    "id": 739178813,
    "node_id": "PRRC_kwDOABII584sDvk9",
    "diff_hunk": "@@ -204,18 +204,13 @@ void FillNode(FuzzedDataProvider& fuzzed_data_provider, CNode& node, bool init_v\n     const ServiceFlags remote_services = ConsumeWeakEnum(fuzzed_data_provider, ALL_SERVICE_FLAGS);\n     const NetPermissionFlags permission_flags = ConsumeWeakEnum(fuzzed_data_provider, ALL_NET_PERMISSION_FLAGS);\n     const int32_t version = fuzzed_data_provider.ConsumeIntegralInRange<int32_t>(MIN_PEER_PROTO_VERSION, std::numeric_limits<int32_t>::max());\n-    const bool filter_txs = fuzzed_data_provider.ConsumeBool();\n \n     node.nServices = remote_services;\n     node.m_permissionFlags = permission_flags;\n     if (init_version) {\n         node.nVersion = version;\n         node.SetCommonVersion(std::min(version, PROTOCOL_VERSION));\n     }\n-    if (node.m_tx_relay != nullptr) {\n-        LOCK(node.m_tx_relay->cs_filter);\n-        node.m_tx_relay->fRelayTxes = filter_txs;",
    "path": "src/test/fuzz/util.cpp",
    "position": 14,
    "original_position": 14,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "eeb0e84fc5c259dfd00f7673ad4a51582b100282",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "That seems like a bad approach to me. There's all kinds of logic that happens inside the `version` and `verack` handling. Skipping over that by reaching into `PeerManager` and `CConnman` internals and updating individual fields means that the `CNode`, `CNodeState` and `Peer` objects are only partially initialized when you send in the fuzzed network messages.",
    "created_at": "2021-10-29T12:10:50Z",
    "updated_at": "2021-10-29T12:10:50Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r739178813",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739178813"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r739178813"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739178813/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 218,
    "original_line": 218,
    "side": "LEFT",
    "in_reply_to_id": 701114184
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739198878",
    "pull_request_review_id": 792988806,
    "id": 739198878,
    "node_id": "PRRC_kwDOABII584sD0ee",
    "diff_hunk": "@@ -204,18 +204,13 @@ void FillNode(FuzzedDataProvider& fuzzed_data_provider, CNode& node, bool init_v\n     const ServiceFlags remote_services = ConsumeWeakEnum(fuzzed_data_provider, ALL_SERVICE_FLAGS);\n     const NetPermissionFlags permission_flags = ConsumeWeakEnum(fuzzed_data_provider, ALL_NET_PERMISSION_FLAGS);\n     const int32_t version = fuzzed_data_provider.ConsumeIntegralInRange<int32_t>(MIN_PEER_PROTO_VERSION, std::numeric_limits<int32_t>::max());\n-    const bool filter_txs = fuzzed_data_provider.ConsumeBool();\n \n     node.nServices = remote_services;\n     node.m_permissionFlags = permission_flags;\n     if (init_version) {\n         node.nVersion = version;\n         node.SetCommonVersion(std::min(version, PROTOCOL_VERSION));\n     }\n-    if (node.m_tx_relay != nullptr) {\n-        LOCK(node.m_tx_relay->cs_filter);\n-        node.m_tx_relay->fRelayTxes = filter_txs;",
    "path": "src/test/fuzz/util.cpp",
    "position": 14,
    "original_position": 14,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "eeb0e84fc5c259dfd00f7673ad4a51582b100282",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "There shouldn't be any fields that are left uninitialized or partially initialized.\r\n\r\nIf you don't like reaching into internals, the only alternative I see is sending the fields that are set here in p2p messages.",
    "created_at": "2021-10-29T12:41:00Z",
    "updated_at": "2021-10-29T12:41:00Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r739198878",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739198878"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r739198878"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739198878/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 218,
    "original_line": 218,
    "side": "LEFT",
    "in_reply_to_id": 701114184
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739206139",
    "pull_request_review_id": 792998964,
    "id": 739206139,
    "node_id": "PRRC_kwDOABII584sD2P7",
    "diff_hunk": "@@ -204,18 +204,13 @@ void FillNode(FuzzedDataProvider& fuzzed_data_provider, CNode& node, bool init_v\n     const ServiceFlags remote_services = ConsumeWeakEnum(fuzzed_data_provider, ALL_SERVICE_FLAGS);\n     const NetPermissionFlags permission_flags = ConsumeWeakEnum(fuzzed_data_provider, ALL_NET_PERMISSION_FLAGS);\n     const int32_t version = fuzzed_data_provider.ConsumeIntegralInRange<int32_t>(MIN_PEER_PROTO_VERSION, std::numeric_limits<int32_t>::max());\n-    const bool filter_txs = fuzzed_data_provider.ConsumeBool();\n \n     node.nServices = remote_services;\n     node.m_permissionFlags = permission_flags;\n     if (init_version) {\n         node.nVersion = version;\n         node.SetCommonVersion(std::min(version, PROTOCOL_VERSION));\n     }\n-    if (node.m_tx_relay != nullptr) {\n-        LOCK(node.m_tx_relay->cs_filter);\n-        node.m_tx_relay->fRelayTxes = filter_txs;",
    "path": "src/test/fuzz/util.cpp",
    "position": 14,
    "original_position": 14,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "eeb0e84fc5c259dfd00f7673ad4a51582b100282",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> There shouldn't be any fields that are left uninitialized or partially initialized.\r\n\r\nHere's one example. `CNode.fClient` is set here:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/baa9fc941cac76b35630da16d77fa2a8b0cc1755/src/net_processing.cpp#L2600\r\n\r\ndepending on the `nServices` field in the `version` message. `FillNode()` in fuzz/util.cpp will never set that field to true, even if `(!(nServices & NODE_NETWORK) && !(nServices & NODE_NETWORK_LIMITED))`. That means that the `CNode` object created by the fuzz test setup can be in a state that's impossible for it to be in the running software.",
    "created_at": "2021-10-29T12:51:28Z",
    "updated_at": "2021-10-29T12:51:28Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r739206139",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739206139"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r739206139"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/739206139/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 218,
    "original_line": 218,
    "side": "LEFT",
    "in_reply_to_id": 701114184
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754471117",
    "pull_request_review_id": 812798428,
    "id": 754471117,
    "node_id": "PRRC_kwDOABII584s-FDN",
    "diff_hunk": "@@ -204,18 +204,13 @@ void FillNode(FuzzedDataProvider& fuzzed_data_provider, CNode& node, bool init_v\n     const ServiceFlags remote_services = ConsumeWeakEnum(fuzzed_data_provider, ALL_SERVICE_FLAGS);\n     const NetPermissionFlags permission_flags = ConsumeWeakEnum(fuzzed_data_provider, ALL_NET_PERMISSION_FLAGS);\n     const int32_t version = fuzzed_data_provider.ConsumeIntegralInRange<int32_t>(MIN_PEER_PROTO_VERSION, std::numeric_limits<int32_t>::max());\n-    const bool filter_txs = fuzzed_data_provider.ConsumeBool();\n \n     node.nServices = remote_services;\n     node.m_permissionFlags = permission_flags;\n     if (init_version) {\n         node.nVersion = version;\n         node.SetCommonVersion(std::min(version, PROTOCOL_VERSION));\n     }\n-    if (node.m_tx_relay != nullptr) {\n-        LOCK(node.m_tx_relay->cs_filter);\n-        node.m_tx_relay->fRelayTxes = filter_txs;",
    "path": "src/test/fuzz/util.cpp",
    "position": 14,
    "original_position": 14,
    "commit_id": "1e44f3974f4343ac2d7d6e1aabe81b33133641bf",
    "original_commit_id": "eeb0e84fc5c259dfd00f7673ad4a51582b100282",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Thanks, fixed in https://github.com/bitcoin/bitcoin/pull/23575",
    "created_at": "2021-11-22T17:00:33Z",
    "updated_at": "2021-11-22T17:00:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r754471117",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754471117"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21160#discussion_r754471117"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21160"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754471117/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 218,
    "original_line": 218,
    "side": "LEFT",
    "in_reply_to_id": 701114184
  }
]