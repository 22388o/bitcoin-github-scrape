[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/626069441",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#issuecomment-626069441",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18918",
    "id": 626069441,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNjA2OTQ0MQ==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-09T00:03:27Z",
    "updated_at": "2020-05-09T00:03:27Z",
    "author_association": "MEMBER",
    "body": "Concept ACK",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/626069441/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/626121060",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#issuecomment-626121060",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18918",
    "id": 626121060,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNjEyMTA2MA==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-09T07:22:33Z",
    "updated_at": "2020-05-24T10:04:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #18971 (wallet: Refactor the classes in wallet/db.{cpp/h} by achow101)\n* #18836 (wallet: upgradewallet fixes and additional tests by achow101)\n* #18618 (gui: Drop RecentRequestsTableModel dependency to WalletModel by promag)\n* #18608 (refactor: Remove CAddressBookData::destdata by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/626121060/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628166195",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#issuecomment-628166195",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18918",
    "id": 628166195,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyODE2NjE5NQ==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-13T18:25:16Z",
    "updated_at": "2020-05-13T18:25:36Z",
    "author_association": "MEMBER",
    "body": "Concept ACK. Agree that this belongs in the wallet tool, not bitcoind.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628166195/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628170919",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#issuecomment-628170919",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18918",
    "id": 628170919,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyODE3MDkxOQ==",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?u=eab5d0cdbb6cc25087cb61d4ca4a6f85255f42a7&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-13T18:34:47Z",
    "updated_at": "2020-05-13T18:34:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "Concept ACK, ... finally.\r\nFollows the concept of #8745. There was already an attempt to add salvage to the wallet tool in #15307",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628170919/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/629551855",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#issuecomment-629551855",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18918",
    "id": 629551855,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyOTU1MTg1NQ==",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?u=9791e96cd4268d48e3517bac41eaf2b1d09759fd&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-15T23:49:43Z",
    "updated_at": "2020-05-15T23:49:43Z",
    "author_association": "MEMBER",
    "body": "I've changed the final refactor commit into several smaller moves and changes. The final approach for salvage is also slightly different.\r\n\r\nInstead of having all of the salvage logic `wallettool.cpp`, I've moved instead put it in a `RecoverDatabaseFile` function in new `salvage.{cpp/h}` files. Additionally, instead of copying `ReadKeyValue`, I've exposed it and `CWalletScanState` in `walletdb.h` so that they can be called from `salvage.cpp`. Lastly these changes are done in separate commits to make it easier to review.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/629551855/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/630273946",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#issuecomment-630273946",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18918",
    "id": 630273946,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMDI3Mzk0Ng==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-18T15:53:19Z",
    "updated_at": "2020-05-18T15:53:19Z",
    "author_association": "MEMBER",
    "body": "Concept ACK",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/630273946/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/630344474",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#issuecomment-630344474",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18918",
    "id": 630344474,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMDM0NDQ3NA==",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?u=a1574ca2038ff1dfaa9a7764c59ea5ff4f305b5d&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-18T17:59:32Z",
    "updated_at": "2020-05-18T17:59:32Z",
    "author_association": "MEMBER",
    "body": "Concept ACK",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/630344474/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/630676951",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#issuecomment-630676951",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18918",
    "id": 630676951,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMDY3Njk1MQ==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-19T08:42:29Z",
    "updated_at": "2020-05-19T08:42:29Z",
    "author_association": "MEMBER",
    "body": "```\r\nwallet/walletdb.cpp:594:12: error: calling function 'ReadKeyValue' requires holding mutex 'pwallet->cs_wallet' exclusively [-Werror,-Wthread-safety-analysis]\r\n1647    return ReadKeyValue(pwallet, ssKey, ssValue, dummy_wss, strType, strErr);\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/630676951/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631137009",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#issuecomment-631137009",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18918",
    "id": 631137009,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMTEzNzAwOQ==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-19T23:17:39Z",
    "updated_at": "2020-05-19T23:17:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "To all reviewers who concepted ACKed here, I'd encourage reviewing the code, too. This PR is really well structured and easy to understand and after the first commit is just a series of moves and simplifications with no other changes. Very easy.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631137009/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/632245937",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#issuecomment-632245937",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18918",
    "id": 632245937,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMjI0NTkzNw==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-21T17:40:20Z",
    "updated_at": "2020-05-21T17:40:20Z",
    "author_association": "MEMBER",
    "body": "> To all reviewers who concepted ACKed here\r\n\r\nOk, I hereby commit to reviewing this when the previous review comments have been addressed.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/632245937/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/633659174",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#issuecomment-633659174",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18918",
    "id": 633659174,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMzY1OTE3NA==",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?u=9791e96cd4268d48e3517bac41eaf2b1d09759fd&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-25T17:21:01Z",
    "updated_at": "2020-05-25T17:21:01Z",
    "author_association": "MEMBER",
    "body": "> but attempting to run `bitcoin-wallet -regtest -wallet=test salvage` returns `DB_ENV->dbrename: method not permitted before handle's open method`.\r\n\r\nFixed. Turns out we still have to go through the whole `WalletDatbase::Create` and `VerifyEnvironment` song and dance before recovery can be done.\r\n\r\nAlso added a basic functional test to check that salvage on a new wallet does not have issues. It does not check whether salvaged actually worked or did anything useful.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/633659174/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/633665901",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#issuecomment-633665901",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18918",
    "id": 633665901,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMzY2NTkwMQ==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-25T17:45:48Z",
    "updated_at": "2020-05-25T17:45:48Z",
    "author_association": "MEMBER",
    "body": "Thanks -- at 84ae0578b6c the bitcoin-wallet salvage command now runs and exits. Yay! but it doesn't leave any feedback. A message that the wallet was successfully salvaged might be reassuring?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/633665901/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/633668307",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#issuecomment-633668307",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18918",
    "id": 633668307,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMzY2ODMwNw==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-25T17:54:09Z",
    "updated_at": "2020-05-26T18:59:04Z",
    "author_association": "MEMBER",
    "body": "ACK 84ae0578b6c68dda145ca65fef510ce0fdac0d7b feedback taken, and compared to my previous review, the bitcoin-wallet salvage command now seems to run and it exits without raising. The new test passes at both 9454105 and 84ae057 so as a sanity check I'd agree there is room for improvement, if possible.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/633668307/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/633977107",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#issuecomment-633977107",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18918",
    "id": 633977107,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMzk3NzEwNw==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-26T11:51:35Z",
    "updated_at": "2020-05-26T11:51:35Z",
    "author_association": "MEMBER",
    "body": "re-ACK 84ae0578b6 \ud83c\udfc9\r\n\r\n<details><summary>Show signature and timestamp</summary>\r\n\r\nSignature:\r\n\r\n```\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA512\r\n\r\nre-ACK 84ae0578b6 \ud83c\udfc9\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\r\npUjebwv/XkWDTfbKudR9e0H8atjyYFTG7ra0mC6wBPs6Apbj4CIhGGrrVeT/zEYu\r\nPUPAUO6/RJVD+nBPQTCajQ+/a7kkaRzR9W+Huu+1xXXJEbTzCME7Zld8uMMY750F\r\n9X9VSKOR9JAqmaICejkZ6bk6lMY9HL2+VumYejhYKX0UTYiGAOspBX0hND68EFuR\r\neSh+OF5BnFj0g89kiZpp8QNDZGXAQ94Tl9tOV5SSD8I941Ncwgnt0LG20hTGOZ04\r\nXN19zVW+f27yN/SuHO9powmwwIq/G3urif6eCnRxDHSGkc+9r/xa4SPXnv/SRcxn\r\ni82alb+6+4N0UoNIr3gPtaxZQ/fhGHiWO9Q8s+p+/Tk2gK4ssjobBwrc4uAMhVmN\r\ndmmQSQPmaR5Hi0PLKtiM3z98lXI29kbUxk/51vEhLH4sNs1i0TyEcwLgMcezO5/q\r\nRIYhBStpCVQtJ+LxVUzB0zHK+A/jCM9Q56aw7ZS0ly6LHwmVPD1VvzNDQKhCWUpm\r\nAANRPTgR\r\n=FqzM\r\n-----END PGP SIGNATURE-----\r\n```\r\n\r\n[Timestamp of file with hash `c579e4ed85c7c252470d4ad60a04790a109bf7cc4aabcc2e2094bbf1b5c53880  -`](https://opentimestamps.org/info/?004f70656e54696d657374616d7073000050726f6f6600bf89e2e884e892940108c579e4ed85c7c252470d4ad60a04790a109bf7cc4aabcc2e2094bbf1b5c53880f010098a8b7fe7d98d8b8e106f8d6e137d1708fff01003e2f488e533a9a6605729a725cd86c908f1045ecd02bcf0089fd024852dea29a70083dfe30d2ef90c8e292868747470733a2f2f66696e6e65792e63616c656e6461722e657465726e69747977616c6c2e636f6dfff0101c2b7ee715384a6658739c76fa986b5008f1045ecd02bbf0085f8a136f93760fb80083dfe30d2ef90c8e232268747470733a2f2f6274632e63616c656e6461722e636174616c6c6178792e636f6dfff0103cb2098421d9043bf95353eb0b7888b808f1045ecd02bbf008f47a3709beb4e57b0083dfe30d2ef90c8e2c2b68747470733a2f2f626f622e6274632e63616c656e6461722e6f70656e74696d657374616d70732e6f7267f01068833b45dd652a82f027ec23c86b254708f1045ecd02bbf008a3bafb1dfada5e5f0083dfe30d2ef90c8e2e2d68747470733a2f2f616c6963652e6274632e63616c656e6461722e6f70656e74696d657374616d70732e6f7267)\r\n\r\n</details>",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/633977107/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634190224",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#issuecomment-634190224",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18918",
    "id": 634190224,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNDE5MDIyNA==",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?u=5ff13e375b40ea55ecd3c108337dd6a23f68eddf&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-26T18:12:09Z",
    "updated_at": "2020-05-26T18:12:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "Concept ACK: thanks for doing this! :)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634190224/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634202268",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#issuecomment-634202268",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18918",
    "id": 634202268,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNDIwMjI2OA==",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?u=a1574ca2038ff1dfaa9a7764c59ea5ff4f305b5d&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-26T18:35:05Z",
    "updated_at": "2020-05-26T18:35:05Z",
    "author_association": "MEMBER",
    "body": "Code Review ACK https://github.com/bitcoin/bitcoin/pull/18918/commits/84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634202268/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/422424816",
    "pull_request_review_id": 408584972,
    "id": 422424816,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMjQyNDgxNg==",
    "diff_hunk": "@@ -404,8 +404,6 @@ def run_test(self):\n             '-reindex',\n             '-zapwallettxes=1',\n             '-zapwallettxes=2',\n-            # disabled until issue is fixed: https://github.com/bitcoin/bitcoin/issues/7463\n-            # '-salvagewallet',",
    "path": "test/functional/wallet_basic.py",
    "position": 5,
    "original_position": 5,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "a7274c441ae21ef4b52a258a038d5b28f5469036",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Would be nice to keep this test or at least document that salvagewallet will throw away your keys: #7379 ",
    "created_at": "2020-05-09T00:02:37Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r422424816",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/422424816"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r422424816"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/422424816/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 408,
    "original_line": 408,
    "side": "LEFT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426013039",
    "pull_request_review_id": 412922697,
    "id": 426013039,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjAxMzAzOQ==",
    "diff_hunk": "@@ -404,8 +404,6 @@ def run_test(self):\n             '-reindex',\n             '-zapwallettxes=1',\n             '-zapwallettxes=2',\n-            # disabled until issue is fixed: https://github.com/bitcoin/bitcoin/issues/7463\n-            # '-salvagewallet',",
    "path": "test/functional/wallet_basic.py",
    "position": 5,
    "original_position": 5,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "a7274c441ae21ef4b52a258a038d5b28f5469036",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"wallet: remove -salvagewallet\" (8ef1b45b4d3de71214da1a6bc6e09f6e9a14d7d4)\r\n\r\n> Would be nice to keep this test or at least document that salvagewallet will throw away your keys: #7379\r\n\r\n@MarcoFalke could you describe the test or comment you would add? It sounds there is a good suggestion here, but I don't understand it's asking for",
    "created_at": "2020-05-15T19:46:04Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426013039",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426013039"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426013039"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426013039/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 408,
    "original_line": 408,
    "side": "LEFT",
    "in_reply_to_id": 422424816
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426030169",
    "pull_request_review_id": 412922697,
    "id": 426030169,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjAzMDE2OQ==",
    "diff_hunk": "@@ -103,11 +104,205 @@ static void WalletShowInfo(CWallet* wallet_instance)\n     tfm::format(std::cout, \"Address Book: %zu\\n\", wallet_instance->m_address_book.size());\n }\n \n+/* End of headers, beginning of key/value data */\n+static const char *HEADER_END = \"HEADER=END\";\n+/* End of key/value data */\n+static const char *DATA_END = \"DATA=END\";\n+\n static bool SalvageWallet(fs::path path)",
    "path": "src/wallet/wallettool.cpp",
    "position": null,
    "original_position": 17,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "67e30b2b42b4d710739e6fe303cbca69be68032c",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"walletool: Move salvage wallet implementation into wallettool\" (67e30b2b42b4d710739e6fe303cbca69be68032c)\r\n\r\nWould be nice to move this to src/wallet/salvage.{h,cpp} so wallet tool file does not become monolithic and so salvage functionality can be more easily tested and improved and perhaps accessible to future RPC or GUI recovery features",
    "created_at": "2020-05-15T20:25:24Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426030169",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426030169"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426030169"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426030169/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 112,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426055478",
    "pull_request_review_id": 412978838,
    "id": 426055478,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjA1NTQ3OA==",
    "diff_hunk": "@@ -404,8 +404,6 @@ def run_test(self):\n             '-reindex',\n             '-zapwallettxes=1',\n             '-zapwallettxes=2',\n-            # disabled until issue is fixed: https://github.com/bitcoin/bitcoin/issues/7463\n-            # '-salvagewallet',",
    "path": "test/functional/wallet_basic.py",
    "position": 5,
    "original_position": 5,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "a7274c441ae21ef4b52a258a038d5b28f5469036",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> @MarcoFalke could you describe the test or comment you would add? It sounds there is a good suggestion here, but I don't understand it's asking for\r\n\r\nThe new functionality has zero tests. I was hoping we could call `wallet-tool salvage` instead of `bitcoind -salvagewallet` here. Just because the test is commented out, doesn't mean it should be removed.\r\n\r\nIf the test still fails occasionally with the wallet-tool, then it can be commented out again.",
    "created_at": "2020-05-15T21:28:41Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426055478",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426055478"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426055478"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426055478/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 408,
    "original_line": 408,
    "side": "LEFT",
    "in_reply_to_id": 422424816
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426067115",
    "pull_request_review_id": 412993354,
    "id": 426067115,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjA2NzExNQ==",
    "diff_hunk": "@@ -404,8 +404,6 @@ def run_test(self):\n             '-reindex',\n             '-zapwallettxes=1',\n             '-zapwallettxes=2',\n-            # disabled until issue is fixed: https://github.com/bitcoin/bitcoin/issues/7463\n-            # '-salvagewallet',",
    "path": "test/functional/wallet_basic.py",
    "position": 5,
    "original_position": 5,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "a7274c441ae21ef4b52a258a038d5b28f5469036",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The behavior of salvage shouldn't be any different, so it will probably still fail as the previous `-salvagewallet` did.\r\n\r\nIt's also not clear to me what a salvage test should even look like.",
    "created_at": "2020-05-15T22:05:07Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426067115",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426067115"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426067115"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426067115/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 408,
    "original_line": 408,
    "side": "LEFT",
    "in_reply_to_id": 422424816
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426090798",
    "pull_request_review_id": 413021252,
    "id": 426090798,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjA5MDc5OA==",
    "diff_hunk": "@@ -103,11 +104,205 @@ static void WalletShowInfo(CWallet* wallet_instance)\n     tfm::format(std::cout, \"Address Book: %zu\\n\", wallet_instance->m_address_book.size());\n }\n \n+/* End of headers, beginning of key/value data */\n+static const char *HEADER_END = \"HEADER=END\";\n+/* End of key/value data */\n+static const char *DATA_END = \"DATA=END\";\n+\n static bool SalvageWallet(fs::path path)",
    "path": "src/wallet/wallettool.cpp",
    "position": null,
    "original_position": 17,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "67e30b2b42b4d710739e6fe303cbca69be68032c",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I've added a salvage.{cpp/h} and put the salvage stuff in there.",
    "created_at": "2020-05-15T23:46:53Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426090798",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426090798"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426090798"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426090798/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 112,
    "side": "RIGHT",
    "in_reply_to_id": 426030169
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426092501",
    "pull_request_review_id": 413023069,
    "id": 426092501,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjA5MjUwMQ==",
    "diff_hunk": "@@ -404,8 +404,6 @@ def run_test(self):\n             '-reindex',\n             '-zapwallettxes=1',\n             '-zapwallettxes=2',\n-            # disabled until issue is fixed: https://github.com/bitcoin/bitcoin/issues/7463\n-            # '-salvagewallet',",
    "path": "test/functional/wallet_basic.py",
    "position": 5,
    "original_position": 5,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "a7274c441ae21ef4b52a258a038d5b28f5469036",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I've added a placeholder test with a todo that mentions the issue in `tool_wallet.py`.",
    "created_at": "2020-05-15T23:56:46Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426092501",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426092501"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426092501"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426092501/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 408,
    "original_line": 408,
    "side": "LEFT",
    "in_reply_to_id": 422424816
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426104866",
    "pull_request_review_id": 413035802,
    "id": 426104866,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjEwNDg2Ng==",
    "diff_hunk": "@@ -924,7 +924,7 @@ bool WalletBatch::VerifyEnvironment(const fs::path& wallet_path, bilingual_str&\n \n bool WalletBatch::VerifyDatabaseFile(const fs::path& wallet_path, std::vector<bilingual_str>& warnings, bilingual_str& errorStr)\n {\n-    return BerkeleyBatch::VerifyDatabaseFile(wallet_path, warnings, errorStr, WalletBatch::Recover);",
    "path": "src/wallet/walletdb.cpp",
    "position": 65,
    "original_position": 4,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "1372aba35fa91dd2fb4103ed7081a057f9794564",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`WalletBatch::Recover` two-argument version is unused as of commit: 1372aba35fa91dd2fb4103ed7081a057f9794564",
    "created_at": "2020-05-16T01:38:45Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426104866",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426104866"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426104866"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426104866/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 927,
    "original_line": 927,
    "side": "LEFT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426105502",
    "pull_request_review_id": 413036331,
    "id": 426105502,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjEwNTUwMg==",
    "diff_hunk": "@@ -924,7 +924,7 @@ bool WalletBatch::VerifyEnvironment(const fs::path& wallet_path, bilingual_str&\n \n bool WalletBatch::VerifyDatabaseFile(const fs::path& wallet_path, std::vector<bilingual_str>& warnings, bilingual_str& errorStr)\n {\n-    return BerkeleyBatch::VerifyDatabaseFile(wallet_path, warnings, errorStr, WalletBatch::Recover);",
    "path": "src/wallet/walletdb.cpp",
    "position": 65,
    "original_position": 4,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "1372aba35fa91dd2fb4103ed7081a057f9794564",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Nevermind, I see you got it in 61a1e5702d0dfd3cfb6d4deb28df516a7243e196",
    "created_at": "2020-05-16T01:44:55Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426105502",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426105502"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426105502"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426105502/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 927,
    "original_line": 927,
    "side": "LEFT",
    "in_reply_to_id": 426104866
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426105705",
    "pull_request_review_id": 413036490,
    "id": 426105705,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjEwNTcwNQ==",
    "diff_hunk": "@@ -0,0 +1,146 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <fs.h>\n+#include <streams.h>\n+#include <wallet/salvage.h>\n+#include <wallet/wallet.h>\n+#include <wallet/walletdb.h>\n+\n+/* End of headers, beginning of key/value data */\n+static const char *HEADER_END = \"HEADER=END\";\n+/* End of key/value data */\n+static const char *DATA_END = \"DATA=END\";\n+typedef std::pair<std::vector<unsigned char>, std::vector<unsigned char> > KeyValPair;\n+\n+bool RecoverDatabaseFile(const fs::path& file_path)\n+{\n+    std::string filename;\n+    std::shared_ptr<BerkeleyEnvironment> env = GetWalletEnv(file_path, filename);\n+\n+    // Recovery procedure:\n+    // move wallet file to walletfilename.timestamp.bak\n+    // Call Salvage with fAggressive=true to\n+    // get as much data as possible.\n+    // Rewrite salvaged data to fresh wallet file\n+    // Set -rescan so any missing transactions will be\n+    // found.\n+    int64_t now = GetTime();\n+    std::string newFilename = strprintf(\"%s.%d.bak\", filename, now);\n+\n+    int result = env->dbenv->dbrename(nullptr, filename.c_str(), nullptr,\n+                                       newFilename.c_str(), DB_AUTO_COMMIT);\n+    if (result == 0)\n+        LogPrintf(\"Renamed %s to %s\\n\", filename, newFilename);\n+    else\n+    {\n+        LogPrintf(\"Failed to rename %s to %s\\n\", filename, newFilename);\n+        return false;\n+    }\n+\n+    std::vector<KeyValPair> salvagedData;\n+    bool fSuccess = false; //env->Salvage(newFilename, salvagedData);\n+\n+    std::stringstream strDump;\n+\n+    Db db(env->dbenv.get(), 0);\n+    result = db.verify(newFilename.c_str(), nullptr, &strDump, DB_SALVAGE | DB_AGGRESSIVE);\n+    if (result == DB_VERIFY_BAD) {\n+        LogPrintf(\"Salvage: Database salvage found errors, all data may not be recoverable.\\n\");\n+    }\n+    if (result != 0 && result != DB_VERIFY_BAD) {\n+        LogPrintf(\"Salvage: Database salvage failed with result %d.\\n\", result);\n+        return false;\n+    }\n+\n+    // Format of bdb dump is ascii lines:\n+    // header lines...\n+    // HEADER=END\n+    //  hexadecimal key\n+    //  hexadecimal value\n+    //  ... repeated\n+    // DATA=END\n+\n+    std::string strLine;\n+    while (!strDump.eof() && strLine != HEADER_END)\n+        getline(strDump, strLine); // Skip past header\n+\n+    std::string keyHex, valueHex;\n+    while (!strDump.eof() && keyHex != DATA_END) {\n+        getline(strDump, keyHex);\n+        if (keyHex != DATA_END) {\n+            if (strDump.eof())\n+                break;\n+            getline(strDump, valueHex);\n+            if (valueHex == DATA_END) {\n+                LogPrintf(\"Salvage: WARNING: Number of keys in data does not match number of values.\\n\");\n+                break;\n+            }\n+            salvagedData.push_back(make_pair(ParseHex(keyHex), ParseHex(valueHex)));\n+        }\n+    }\n+\n+    if (keyHex != DATA_END) {\n+        LogPrintf(\"Salvage: WARNING: Unexpected end of file while reading salvage output.\\n\");\n+        fSuccess = false;\n+    } else {\n+        fSuccess = (result == 0);\n+    }\n+\n+    if (salvagedData.empty())\n+    {\n+        LogPrintf(\"Salvage(aggressive) found no records in %s.\\n\", newFilename);\n+        return false;\n+    }\n+    LogPrintf(\"Salvage(aggressive) found %u records\\n\", salvagedData.size());\n+\n+    std::unique_ptr<Db> pdbCopy = MakeUnique<Db>(env->dbenv.get(), 0);\n+    int ret = pdbCopy->open(nullptr,               // Txn pointer\n+                            filename.c_str(),   // Filename\n+                            \"main\",             // Logical db name\n+                            DB_BTREE,           // Database type\n+                            DB_CREATE,          // Flags\n+                            0);\n+    if (ret > 0) {\n+        LogPrintf(\"Cannot create database file %s\\n\", filename);\n+        pdbCopy->close(0);\n+        return false;\n+    }\n+\n+    DbTxn* ptxn = env->TxnBegin();\n+    CWallet dummyWallet(nullptr, WalletLocation(), WalletDatabase::CreateDummy());\n+    CWalletScanState dummyWss;\n+    for (KeyValPair& row : salvagedData)\n+    {\n+        /* Filter for only private key type KV pairs to be added to the salvaged wallet */\n+        CDataStream ssKey(row.first, SER_DISK, CLIENT_VERSION);\n+        CDataStream ssValue(row.second, SER_DISK, CLIENT_VERSION);\n+        std::string strType, strErr;\n+        bool fReadOK;\n+        {\n+            // Required in LoadKeyMetadata():\n+            LOCK(dummyWallet.cs_wallet);\n+            fReadOK = ReadKeyValue(&dummyWallet, ssKey, ssValue,\n+                                   dummyWss, strType, strErr);",
    "path": "src/wallet/salvage.cpp",
    "position": null,
    "original_position": 126,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "2dc91a80b2d674e9bc42f969effbda95163d685a",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Given the `CWalletScanState` isn't used, how about exposing a more limited version of `ReadKeyValue` instead?",
    "created_at": "2020-05-16T01:47:04Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426105705",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426105705"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426105705"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426105705/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 126,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426524966",
    "pull_request_review_id": 413464889,
    "id": 426524966,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjUyNDk2Ng==",
    "diff_hunk": "@@ -419,18 +412,8 @@ bool BerkeleyBatch::VerifyDatabaseFile(const fs::path& file_path, std::vector<bi\n     if (fs::exists(walletDir / walletFile))\n     {\n         std::string backup_filename;\n-        BerkeleyEnvironment::VerifyResult r = env->Verify(walletFile, recoverFunc, backup_filename);\n-        if (r == BerkeleyEnvironment::VerifyResult::RECOVER_OK)\n-        {\n-            warnings.push_back(strprintf(_(\"Warning: Wallet file corrupt, data salvaged!\"\n-                                     \" Original %s saved as %s in %s; if\"\n-                                     \" your balance or transactions are incorrect you should\"\n-                                     \" restore from a backup.\"),\n-                walletFile, backup_filename, walletDir));\n-        }\n-        if (r == BerkeleyEnvironment::VerifyResult::RECOVER_FAIL)\n-        {\n-            errorStr = strprintf(_(\"%s corrupt, salvage failed\"), walletFile);\n+        if (!env->Verify(walletFile)) {\n+            errorStr = strprintf(_(\"%s corrupt. Try using the wallet tool bitcoin-wallet to salvage\"), walletFile);",
    "path": "src/wallet/db.cpp",
    "position": null,
    "original_position": 50,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "1372aba35fa91dd2fb4103ed7081a057f9794564",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In 1372aba35fa91dd2fb4103ed7081a057f9794564: maybe add \"or restore from a backup.\"",
    "created_at": "2020-05-18T10:25:44Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426524966",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426524966"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426524966"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426524966/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 416,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426761634",
    "pull_request_review_id": 413768351,
    "id": 426761634,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjc2MTYzNA==",
    "diff_hunk": "@@ -0,0 +1,146 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <fs.h>\n+#include <streams.h>\n+#include <wallet/salvage.h>\n+#include <wallet/wallet.h>\n+#include <wallet/walletdb.h>\n+\n+/* End of headers, beginning of key/value data */\n+static const char *HEADER_END = \"HEADER=END\";\n+/* End of key/value data */\n+static const char *DATA_END = \"DATA=END\";\n+typedef std::pair<std::vector<unsigned char>, std::vector<unsigned char> > KeyValPair;\n+\n+bool RecoverDatabaseFile(const fs::path& file_path)\n+{\n+    std::string filename;\n+    std::shared_ptr<BerkeleyEnvironment> env = GetWalletEnv(file_path, filename);\n+\n+    // Recovery procedure:\n+    // move wallet file to walletfilename.timestamp.bak\n+    // Call Salvage with fAggressive=true to\n+    // get as much data as possible.\n+    // Rewrite salvaged data to fresh wallet file\n+    // Set -rescan so any missing transactions will be\n+    // found.\n+    int64_t now = GetTime();\n+    std::string newFilename = strprintf(\"%s.%d.bak\", filename, now);\n+\n+    int result = env->dbenv->dbrename(nullptr, filename.c_str(), nullptr,\n+                                       newFilename.c_str(), DB_AUTO_COMMIT);\n+    if (result == 0)\n+        LogPrintf(\"Renamed %s to %s\\n\", filename, newFilename);\n+    else\n+    {\n+        LogPrintf(\"Failed to rename %s to %s\\n\", filename, newFilename);\n+        return false;\n+    }\n+\n+    std::vector<KeyValPair> salvagedData;\n+    bool fSuccess = false; //env->Salvage(newFilename, salvagedData);\n+\n+    std::stringstream strDump;\n+\n+    Db db(env->dbenv.get(), 0);\n+    result = db.verify(newFilename.c_str(), nullptr, &strDump, DB_SALVAGE | DB_AGGRESSIVE);\n+    if (result == DB_VERIFY_BAD) {\n+        LogPrintf(\"Salvage: Database salvage found errors, all data may not be recoverable.\\n\");\n+    }\n+    if (result != 0 && result != DB_VERIFY_BAD) {\n+        LogPrintf(\"Salvage: Database salvage failed with result %d.\\n\", result);\n+        return false;\n+    }\n+\n+    // Format of bdb dump is ascii lines:\n+    // header lines...\n+    // HEADER=END\n+    //  hexadecimal key\n+    //  hexadecimal value\n+    //  ... repeated\n+    // DATA=END\n+\n+    std::string strLine;\n+    while (!strDump.eof() && strLine != HEADER_END)\n+        getline(strDump, strLine); // Skip past header\n+\n+    std::string keyHex, valueHex;\n+    while (!strDump.eof() && keyHex != DATA_END) {\n+        getline(strDump, keyHex);\n+        if (keyHex != DATA_END) {\n+            if (strDump.eof())\n+                break;\n+            getline(strDump, valueHex);\n+            if (valueHex == DATA_END) {\n+                LogPrintf(\"Salvage: WARNING: Number of keys in data does not match number of values.\\n\");\n+                break;\n+            }\n+            salvagedData.push_back(make_pair(ParseHex(keyHex), ParseHex(valueHex)));\n+        }\n+    }\n+\n+    if (keyHex != DATA_END) {\n+        LogPrintf(\"Salvage: WARNING: Unexpected end of file while reading salvage output.\\n\");\n+        fSuccess = false;\n+    } else {\n+        fSuccess = (result == 0);\n+    }\n+\n+    if (salvagedData.empty())\n+    {\n+        LogPrintf(\"Salvage(aggressive) found no records in %s.\\n\", newFilename);\n+        return false;\n+    }\n+    LogPrintf(\"Salvage(aggressive) found %u records\\n\", salvagedData.size());\n+\n+    std::unique_ptr<Db> pdbCopy = MakeUnique<Db>(env->dbenv.get(), 0);\n+    int ret = pdbCopy->open(nullptr,               // Txn pointer\n+                            filename.c_str(),   // Filename\n+                            \"main\",             // Logical db name\n+                            DB_BTREE,           // Database type\n+                            DB_CREATE,          // Flags\n+                            0);\n+    if (ret > 0) {\n+        LogPrintf(\"Cannot create database file %s\\n\", filename);\n+        pdbCopy->close(0);\n+        return false;\n+    }\n+\n+    DbTxn* ptxn = env->TxnBegin();\n+    CWallet dummyWallet(nullptr, WalletLocation(), WalletDatabase::CreateDummy());\n+    CWalletScanState dummyWss;\n+    for (KeyValPair& row : salvagedData)\n+    {\n+        /* Filter for only private key type KV pairs to be added to the salvaged wallet */\n+        CDataStream ssKey(row.first, SER_DISK, CLIENT_VERSION);\n+        CDataStream ssValue(row.second, SER_DISK, CLIENT_VERSION);\n+        std::string strType, strErr;\n+        bool fReadOK;\n+        {\n+            // Required in LoadKeyMetadata():\n+            LOCK(dummyWallet.cs_wallet);\n+            fReadOK = ReadKeyValue(&dummyWallet, ssKey, ssValue,\n+                                   dummyWss, strType, strErr);",
    "path": "src/wallet/salvage.cpp",
    "position": null,
    "original_position": 126,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "2dc91a80b2d674e9bc42f969effbda95163d685a",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I've done that instead.",
    "created_at": "2020-05-18T16:46:12Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426761634",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426761634"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426761634"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426761634/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 126,
    "side": "RIGHT",
    "in_reply_to_id": 426105705
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426762807",
    "pull_request_review_id": 413769830,
    "id": 426762807,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjc2MjgwNw==",
    "diff_hunk": "@@ -419,18 +412,8 @@ bool BerkeleyBatch::VerifyDatabaseFile(const fs::path& file_path, std::vector<bi\n     if (fs::exists(walletDir / walletFile))\n     {\n         std::string backup_filename;\n-        BerkeleyEnvironment::VerifyResult r = env->Verify(walletFile, recoverFunc, backup_filename);\n-        if (r == BerkeleyEnvironment::VerifyResult::RECOVER_OK)\n-        {\n-            warnings.push_back(strprintf(_(\"Warning: Wallet file corrupt, data salvaged!\"\n-                                     \" Original %s saved as %s in %s; if\"\n-                                     \" your balance or transactions are incorrect you should\"\n-                                     \" restore from a backup.\"),\n-                walletFile, backup_filename, walletDir));\n-        }\n-        if (r == BerkeleyEnvironment::VerifyResult::RECOVER_FAIL)\n-        {\n-            errorStr = strprintf(_(\"%s corrupt, salvage failed\"), walletFile);\n+        if (!env->Verify(walletFile)) {\n+            errorStr = strprintf(_(\"%s corrupt. Try using the wallet tool bitcoin-wallet to salvage\"), walletFile);",
    "path": "src/wallet/db.cpp",
    "position": null,
    "original_position": 50,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "1372aba35fa91dd2fb4103ed7081a057f9794564",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done",
    "created_at": "2020-05-18T16:48:16Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426762807",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426762807"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426762807"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426762807/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 416,
    "side": "RIGHT",
    "in_reply_to_id": 426524966
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426788261",
    "pull_request_review_id": 413802074,
    "id": 426788261,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjc4ODI2MQ==",
    "diff_hunk": "@@ -103,6 +104,11 @@ static void WalletShowInfo(CWallet* wallet_instance)\n     tfm::format(std::cout, \"Address Book: %zu\\n\", wallet_instance->m_address_book.size());\n }\n \n+static bool SalvageWallet(const fs::path path)",
    "path": "src/wallet/wallettool.cpp",
    "position": null,
    "original_position": 12,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "e3fe3391482252dc42b2541822b1e4e780540166",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: could pass this through by reference",
    "created_at": "2020-05-18T17:34:20Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426788261",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426788261"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426788261"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426788261/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 107,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426791865",
    "pull_request_review_id": 413806448,
    "id": 426791865,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjc5MTg2NQ==",
    "diff_hunk": "@@ -419,18 +412,8 @@ bool BerkeleyBatch::VerifyDatabaseFile(const fs::path& file_path, std::vector<bi\n     if (fs::exists(walletDir / walletFile))\n     {\n         std::string backup_filename;",
    "path": "src/wallet/db.cpp",
    "position": null,
    "original_position": 36,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "259a7440965be49a6876184b8596422ce61093a9",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: this is no longer used",
    "created_at": "2020-05-18T17:41:16Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426791865",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426791865"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426791865"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426791865/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 414,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426792345",
    "pull_request_review_id": 413807114,
    "id": 426792345,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjc5MjM0NQ==",
    "diff_hunk": "@@ -419,18 +412,8 @@ bool BerkeleyBatch::VerifyDatabaseFile(const fs::path& file_path, std::vector<bi\n     if (fs::exists(walletDir / walletFile))\n     {\n         std::string backup_filename;\n-        BerkeleyEnvironment::VerifyResult r = env->Verify(walletFile, recoverFunc, backup_filename);\n-        if (r == BerkeleyEnvironment::VerifyResult::RECOVER_OK)\n-        {\n-            warnings.push_back(strprintf(_(\"Warning: Wallet file corrupt, data salvaged!\"\n-                                     \" Original %s saved as %s in %s; if\"\n-                                     \" your balance or transactions are incorrect you should\"\n-                                     \" restore from a backup.\"),\n-                walletFile, backup_filename, walletDir));\n-        }\n-        if (r == BerkeleyEnvironment::VerifyResult::RECOVER_FAIL)\n-        {\n-            errorStr = strprintf(_(\"%s corrupt, salvage failed\"), walletFile);\n+        if (!env->Verify(walletFile)) {",
    "path": "src/wallet/db.cpp",
    "position": 126,
    "original_position": 49,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "259a7440965be49a6876184b8596422ce61093a9",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: How about returning the `verify` result so we can log the error:\r\nhttps://docs.oracle.com/cd/E17276_01/html/api_reference/C/dbverify.html",
    "created_at": "2020-05-18T17:42:15Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426792345",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426792345"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426792345"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426792345/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 345,
    "original_line": 345,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426794279",
    "pull_request_review_id": 413809455,
    "id": 426794279,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNjc5NDI3OQ==",
    "diff_hunk": "@@ -342,8 +348,55 @@ bool BerkeleyBatch::Recover(const fs::path& file_path, void *callbackDataIn, boo\n         return false;\n     }\n \n-    std::vector<BerkeleyEnvironment::KeyValPair> salvagedData;\n-    bool fSuccess = env->Salvage(newFilename, salvagedData);\n+    std::vector<KeyValPair> salvagedData;\n+    bool fSuccess = false; //env->Salvage(newFilename, salvagedData);",
    "path": "src/wallet/db.cpp",
    "position": null,
    "original_position": 20,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "dca31bd5bc820da889394d15a9337ef96262ee4c",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: I'm not sure this comment is helpful",
    "created_at": "2020-05-18T17:45:47Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426794279",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426794279"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r426794279"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/426794279/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 352,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427627923",
    "pull_request_review_id": 414857597,
    "id": 427627923,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzYyNzkyMw==",
    "diff_hunk": "@@ -103,6 +103,13 @@ static void WalletShowInfo(CWallet* wallet_instance)\n     tfm::format(std::cout, \"Address Book: %zu\\n\", wallet_instance->m_address_book.size());\n }\n \n+static bool SalvageWallet(const fs::path path)\n+{\n+    CWallet dummy_wallet(nullptr, WalletLocation(), WalletDatabase::CreateDummy());\n+    std::string backup_filename;\n+    return WalletBatch::Recover(path, (void*)&dummy_wallet, WalletBatch::RecoverKeysOnlyFilter, backup_filename);\n+}\n+",
    "path": "src/wallet/wallettool.cpp",
    "position": null,
    "original_position": 10,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "502024795a32c4600a294da10ad908f796e0cdac",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"wallettool: Add a salvage command\" (502024795a32c4600a294da10ad908f796e0cdac)\r\n\r\nNote for reviewers: this is just a copy of existing `CWallet::Verify` code\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/51825aea7fa068877ea77e3121def58005df3510/src/wallet/wallet.cpp#L3697-L3704\r\n\r\nremoved in the next commit \"wallet: remove -salvagewallet\" (7116e0c73514438ba240827aaddf922d0c1c9d84)",
    "created_at": "2020-05-19T22:06:21Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r427627923",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427627923"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r427627923"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427627923/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 106,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 127,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427631232",
    "pull_request_review_id": 414857597,
    "id": 427631232,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzYzMTIzMg==",
    "diff_hunk": "@@ -203,6 +203,10 @@ def test_getwalletinfo_on_different_wallet(self):\n         assert_equal(shasum_after, shasum_before)\n         self.log.debug('Wallet file shasum unchanged\\n')\n \n+    def test_salvage(self):\n+        # TODO: We should implement a test for this. But such a test should be after we fix https://github.com/bitcoin/bitcoin/issues/7463",
    "path": "test/functional/tool_wallet.py",
    "position": null,
    "original_position": 5,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "7116e0c73514438ba240827aaddf922d0c1c9d84",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"wallet: remove -salvagewallet\" (7116e0c73514438ba240827aaddf922d0c1c9d84)\r\n\r\nThis is ok, but it'd be possible (and nice) to have a test that invokes salvagewallet tool doing basic checks like does it exit successfully.",
    "created_at": "2020-05-19T22:14:25Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r427631232",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427631232"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r427631232"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427631232/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 207,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427638507",
    "pull_request_review_id": 414857597,
    "id": 427638507,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzYzODUwNw==",
    "diff_hunk": "@@ -67,15 +67,6 @@ class BerkeleyEnvironment\n     fs::path Directory() const { return strPath; }\n \n     bool Verify(const std::string& strFile);\n-    /**\n-     * Salvage data from a file that Verify says is bad.\n-     * fAggressive sets the DB_AGGRESSIVE flag (see berkeley DB->verify() method documentation).\n-     * Appends binary key/value pairs to vResult, returns true if successful.\n-     * NOTE: reads the entire database into memory, so cannot be used\n-     * for huge databases.",
    "path": "src/wallet/db.h",
    "position": 20,
    "original_position": 9,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "dca31bd5bc820da889394d15a9337ef96262ee4c",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Move BerkeleyEnvironment::Salvage into BerkeleyBatch::Recover\" (dca31bd5bc820da889394d15a9337ef96262ee4c)\r\n\r\nThis comment (especially the part about loading to memory) makes code easier to understand and IMO would be good to move to the new location in the verify function. Skip if it is a pain though",
    "created_at": "2020-05-19T22:34:12Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r427638507",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427638507"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r427638507"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427638507/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 81,
    "original_start_line": 71,
    "start_side": "LEFT",
    "line": 85,
    "original_line": 85,
    "side": "LEFT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428811885",
    "pull_request_review_id": 416359725,
    "id": 428811885,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODgxMTg4NQ==",
    "diff_hunk": "@@ -419,18 +412,8 @@ bool BerkeleyBatch::VerifyDatabaseFile(const fs::path& file_path, std::vector<bi\n     if (fs::exists(walletDir / walletFile))\n     {\n         std::string backup_filename;\n-        BerkeleyEnvironment::VerifyResult r = env->Verify(walletFile, recoverFunc, backup_filename);\n-        if (r == BerkeleyEnvironment::VerifyResult::RECOVER_OK)\n-        {\n-            warnings.push_back(strprintf(_(\"Warning: Wallet file corrupt, data salvaged!\"\n-                                     \" Original %s saved as %s in %s; if\"\n-                                     \" your balance or transactions are incorrect you should\"\n-                                     \" restore from a backup.\"),\n-                walletFile, backup_filename, walletDir));\n-        }\n-        if (r == BerkeleyEnvironment::VerifyResult::RECOVER_FAIL)\n-        {\n-            errorStr = strprintf(_(\"%s corrupt, salvage failed\"), walletFile);\n+        if (!env->Verify(walletFile)) {",
    "path": "src/wallet/db.cpp",
    "position": 126,
    "original_position": 49,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "259a7440965be49a6876184b8596422ce61093a9",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I don't think the results of `verify` are meaningful.",
    "created_at": "2020-05-21T17:46:34Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r428811885",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428811885"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r428811885"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428811885/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 345,
    "original_line": 345,
    "side": "RIGHT",
    "in_reply_to_id": 426792345
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428837781",
    "pull_request_review_id": 416392800,
    "id": 428837781,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODgzNzc4MQ==",
    "diff_hunk": "@@ -103,6 +104,11 @@ static void WalletShowInfo(CWallet* wallet_instance)\n     tfm::format(std::cout, \"Address Book: %zu\\n\", wallet_instance->m_address_book.size());\n }\n \n+static bool SalvageWallet(const fs::path path)",
    "path": "src/wallet/wallettool.cpp",
    "position": null,
    "original_position": 12,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "e3fe3391482252dc42b2541822b1e4e780540166",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done",
    "created_at": "2020-05-21T18:34:15Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r428837781",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428837781"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r428837781"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428837781/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 107,
    "side": "RIGHT",
    "in_reply_to_id": 426788261
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428837845",
    "pull_request_review_id": 416392879,
    "id": 428837845,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODgzNzg0NQ==",
    "diff_hunk": "@@ -419,18 +412,8 @@ bool BerkeleyBatch::VerifyDatabaseFile(const fs::path& file_path, std::vector<bi\n     if (fs::exists(walletDir / walletFile))\n     {\n         std::string backup_filename;",
    "path": "src/wallet/db.cpp",
    "position": null,
    "original_position": 36,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "259a7440965be49a6876184b8596422ce61093a9",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Removed",
    "created_at": "2020-05-21T18:34:23Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r428837845",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428837845"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r428837845"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428837845/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 414,
    "side": "RIGHT",
    "in_reply_to_id": 426791865
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428837898",
    "pull_request_review_id": 416392954,
    "id": 428837898,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODgzNzg5OA==",
    "diff_hunk": "@@ -342,8 +348,55 @@ bool BerkeleyBatch::Recover(const fs::path& file_path, void *callbackDataIn, boo\n         return false;\n     }\n \n-    std::vector<BerkeleyEnvironment::KeyValPair> salvagedData;\n-    bool fSuccess = env->Salvage(newFilename, salvagedData);\n+    std::vector<KeyValPair> salvagedData;\n+    bool fSuccess = false; //env->Salvage(newFilename, salvagedData);",
    "path": "src/wallet/db.cpp",
    "position": null,
    "original_position": 20,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "dca31bd5bc820da889394d15a9337ef96262ee4c",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Removed",
    "created_at": "2020-05-21T18:34:30Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r428837898",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428837898"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r428837898"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428837898/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 352,
    "side": "RIGHT",
    "in_reply_to_id": 426794279
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428840595",
    "pull_request_review_id": 416396375,
    "id": 428840595,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyODg0MDU5NQ==",
    "diff_hunk": "@@ -67,15 +67,6 @@ class BerkeleyEnvironment\n     fs::path Directory() const { return strPath; }\n \n     bool Verify(const std::string& strFile);\n-    /**\n-     * Salvage data from a file that Verify says is bad.\n-     * fAggressive sets the DB_AGGRESSIVE flag (see berkeley DB->verify() method documentation).\n-     * Appends binary key/value pairs to vResult, returns true if successful.\n-     * NOTE: reads the entire database into memory, so cannot be used\n-     * for huge databases.",
    "path": "src/wallet/db.h",
    "position": 20,
    "original_position": 9,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "dca31bd5bc820da889394d15a9337ef96262ee4c",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I've added a rewording of this comment back in.",
    "created_at": "2020-05-21T18:39:35Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r428840595",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428840595"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r428840595"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/428840595/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 81,
    "original_start_line": 71,
    "start_side": "LEFT",
    "line": 85,
    "original_line": 85,
    "side": "LEFT",
    "in_reply_to_id": 427638507
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429224090",
    "pull_request_review_id": 416880835,
    "id": 429224090,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTIyNDA5MA==",
    "diff_hunk": "@@ -123,10 +130,15 @@ bool ExecuteWalletToolFunc(const std::string& command, const std::string& name)\n             tfm::format(std::cerr, \"%s\\nError loading %s. Is wallet being used by other process?\\n\", error.original, name);\n             return false;\n         }\n-        std::shared_ptr<CWallet> wallet_instance = LoadWallet(name, path);\n-        if (!wallet_instance) return false;\n-        WalletShowInfo(wallet_instance.get());\n-        wallet_instance->Flush(true);\n+\n+        if (command == \"info\") {\n+            std::shared_ptr<CWallet> wallet_instance = LoadWallet(name, path);\n+            if (!wallet_instance) return false;\n+            WalletShowInfo(wallet_instance.get());\n+            wallet_instance->Flush(true);\n+        } else if (command == \"salvage\") {\n+            SalvageWallet(path);",
    "path": "src/wallet/wallettool.cpp",
    "position": null,
    "original_position": 38,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "7f6a5f3fff6e71108289ba9c9bfc5a938a081a79",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "in commit 7f6a5f3fff6e71108289ba9c9bfc5a938a081a79:\r\n\r\nWhy ignore the return value?",
    "created_at": "2020-05-22T12:44:33Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429224090",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429224090"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429224090"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429224090/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 140,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429235553",
    "pull_request_review_id": 416880835,
    "id": 429235553,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTIzNTU1Mw==",
    "diff_hunk": "@@ -342,8 +348,61 @@ bool BerkeleyBatch::Recover(const fs::path& file_path, void *callbackDataIn, boo\n         return false;\n     }\n \n-    std::vector<BerkeleyEnvironment::KeyValPair> salvagedData;\n-    bool fSuccess = env->Salvage(newFilename, salvagedData);\n+    /**\n+     * Salvage data from a file. The DB_AGGRESSIVE flag is being used (see berkeley DB->verify() method documentation).\n+     * key/value pairs are appendedto salvagedData which are then written out to a new wallet file.\n+     * NOTE: reads the entire database into memory, so cannot be used\n+     * for huge databases.\n+     */\n+    std::vector<KeyValPair> salvagedData;\n+    bool fSuccess = false;",
    "path": "src/wallet/db.cpp",
    "position": null,
    "original_position": 26,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "6c3afd67d28475ed4e2ee655559503971db7cff7",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "in commit 6c3afd67d2:\r\n\r\nWhy is this set all the way up here? The outcome is only needed to remember whether the end of the stream was reached or not. I think it should be defined after the last write to `keyHex`, but still before this code block:\r\n\r\nAlso, you could leave it uninitialized because every if branch will initialize it. If none does the initialization, at least a sanitizer could yell at us and hint at the bug.\r\n```cpp\r\n    bool fSuccess;\r\n    if (keyHex != DATA_END) {\r\n        LogPrintf(\"Salvage: WARNING: Unexpected end of file while reading salvage output.\\n\");\r\n        fSuccess = false;\r\n    } else {\r\n        fSuccess = (result == 0);\r\n    }",
    "created_at": "2020-05-22T13:08:47Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429235553",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429235553"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429235553"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429235553/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 358,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429237809",
    "pull_request_review_id": 416880835,
    "id": 429237809,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTIzNzgwOQ==",
    "diff_hunk": "@@ -294,4 +294,7 @@ class WalletBatch\n //! Compacts BDB state so that wallet.dat is self-contained (if there are changes)\n void MaybeCompactWalletDB();\n \n+//! Unserialize a give Key-Value pair and load it into the wallet\n+bool ReadKeyValue(CWallet* pwallet, CDataStream& ssKey, CDataStream& ssValue, std::string& strType, std::string& strErr);",
    "path": "src/wallet/walletdb.h",
    "position": 25,
    "original_position": 5,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "6d05dff02be9e113ac6f8356fdcc35c1f45c3aa2",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "in commit 6d05dff02b:\r\n\r\nwallet is a reference to an object (like all other params in this function), so it should probably be passed as one.\r\n\r\nNot sure about the lock annotation, but it is a bit confusing to lock cs_wallet, and then call a function that locks it again immediately after\r\n\r\n```suggestion\r\nbool ReadKeyValue(CWallet& wallet, CDataStream& ssKey, CDataStream& ssValue, std::string& strType, std::string& strErr) EXCLUSIVE_LOCKS_REQUIRED(wallet.cs_wallet);\r\n```",
    "created_at": "2020-05-22T13:13:25Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429237809",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429237809"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429237809"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429237809/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 292,
    "original_line": 292,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429240474",
    "pull_request_review_id": 416880835,
    "id": 429240474,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTI0MDQ3NA==",
    "diff_hunk": "@@ -902,8 +909,7 @@ bool WalletBatch::RecoverKeysOnlyFilter(void *callbackData, CDataStream ssKey, C\n     {",
    "path": "src/wallet/walletdb.cpp",
    "position": null,
    "original_position": 15,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "6d05dff02be9e113ac6f8356fdcc35c1f45c3aa2",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "in commit 6d05dff02be9e113ac6f835:\r\n\r\nThe now unused `CWalletScanState dummyWss;` a few lines up should now be removed.",
    "created_at": "2020-05-22T13:18:49Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429240474",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429240474"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429240474"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429240474/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 909,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429346864",
    "pull_request_review_id": 417043774,
    "id": 429346864,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM0Njg2NA==",
    "diff_hunk": "@@ -342,8 +348,61 @@ bool BerkeleyBatch::Recover(const fs::path& file_path, void *callbackDataIn, boo\n         return false;\n     }\n \n-    std::vector<BerkeleyEnvironment::KeyValPair> salvagedData;\n-    bool fSuccess = env->Salvage(newFilename, salvagedData);\n+    /**\n+     * Salvage data from a file. The DB_AGGRESSIVE flag is being used (see berkeley DB->verify() method documentation).\n+     * key/value pairs are appendedto salvagedData which are then written out to a new wallet file.\n+     * NOTE: reads the entire database into memory, so cannot be used\n+     * for huge databases.\n+     */\n+    std::vector<KeyValPair> salvagedData;\n+    bool fSuccess = false;",
    "path": "src/wallet/db.cpp",
    "position": null,
    "original_position": 26,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "6c3afd67d28475ed4e2ee655559503971db7cff7",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It was to reduce the amount of changes being done in a move commit.",
    "created_at": "2020-05-22T16:39:15Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429346864",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429346864"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429346864"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429346864/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 358,
    "side": "RIGHT",
    "in_reply_to_id": 429235553
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429347520",
    "pull_request_review_id": 417045714,
    "id": 429347520,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM0NzUyMA==",
    "diff_hunk": "@@ -294,4 +294,7 @@ class WalletBatch\n //! Compacts BDB state so that wallet.dat is self-contained (if there are changes)\n void MaybeCompactWalletDB();\n \n+//! Unserialize a give Key-Value pair and load it into the wallet\n+bool ReadKeyValue(CWallet* pwallet, CDataStream& ssKey, CDataStream& ssValue, std::string& strType, std::string& strErr);",
    "path": "src/wallet/walletdb.h",
    "position": 25,
    "original_position": 5,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "6d05dff02be9e113ac6f8356fdcc35c1f45c3aa2",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The annotation causes a compile error as `CWallet` is not yet defined.",
    "created_at": "2020-05-22T16:40:43Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429347520",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429347520"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429347520"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429347520/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 292,
    "original_line": 292,
    "side": "RIGHT",
    "in_reply_to_id": 429237809
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429357280",
    "pull_request_review_id": 417058761,
    "id": 429357280,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM1NzI4MA==",
    "diff_hunk": "@@ -294,4 +294,7 @@ class WalletBatch\n //! Compacts BDB state so that wallet.dat is self-contained (if there are changes)\n void MaybeCompactWalletDB();\n \n+//! Unserialize a give Key-Value pair and load it into the wallet\n+bool ReadKeyValue(CWallet* pwallet, CDataStream& ssKey, CDataStream& ssValue, std::string& strType, std::string& strErr);",
    "path": "src/wallet/walletdb.h",
    "position": 25,
    "original_position": 5,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "6d05dff02be9e113ac6f8356fdcc35c1f45c3aa2",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Fair enough",
    "created_at": "2020-05-22T16:58:51Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429357280",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429357280"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429357280"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429357280/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 292,
    "original_line": 292,
    "side": "RIGHT",
    "in_reply_to_id": 429237809
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429399582",
    "pull_request_review_id": 417114332,
    "id": 429399582,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM5OTU4Mg==",
    "diff_hunk": "@@ -410,100 +334,23 @@ bool BerkeleyBatch::VerifyEnvironment(const fs::path& file_path, bilingual_str&\n     return true;\n }\n \n-bool BerkeleyBatch::VerifyDatabaseFile(const fs::path& file_path, std::vector<bilingual_str>& warnings, bilingual_str& errorStr, BerkeleyEnvironment::recoverFunc_type recoverFunc)\n+bool BerkeleyBatch::VerifyDatabaseFile(const fs::path& file_path, std::vector<bilingual_str>& warnings, bilingual_str& errorStr)",
    "path": "src/wallet/db.cpp",
    "position": null,
    "original_position": 105,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "94541050b84e166b6fcbaf6c30b263903dcc25f5",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This `warnings` argument is now unused.",
    "created_at": "2020-05-22T18:38:40Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429399582",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429399582"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429399582"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429399582/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 337,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429951866",
    "pull_request_review_id": 417731902,
    "id": 429951866,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTk1MTg2Ng==",
    "diff_hunk": "@@ -410,100 +334,23 @@ bool BerkeleyBatch::VerifyEnvironment(const fs::path& file_path, bilingual_str&\n     return true;\n }\n \n-bool BerkeleyBatch::VerifyDatabaseFile(const fs::path& file_path, std::vector<bilingual_str>& warnings, bilingual_str& errorStr, BerkeleyEnvironment::recoverFunc_type recoverFunc)\n+bool BerkeleyBatch::VerifyDatabaseFile(const fs::path& file_path, std::vector<bilingual_str>& warnings, bilingual_str& errorStr)\n {\n     std::string walletFile;\n     std::shared_ptr<BerkeleyEnvironment> env = GetWalletEnv(file_path, walletFile);\n     fs::path walletDir = env->Directory();\n \n     if (fs::exists(walletDir / walletFile))\n     {\n-        std::string backup_filename;\n-        BerkeleyEnvironment::VerifyResult r = env->Verify(walletFile, recoverFunc, backup_filename);\n-        if (r == BerkeleyEnvironment::VerifyResult::RECOVER_OK)\n-        {\n-            warnings.push_back(strprintf(_(\"Warning: Wallet file corrupt, data salvaged!\"\n-                                     \" Original %s saved as %s in %s; if\"\n-                                     \" your balance or transactions are incorrect you should\"\n-                                     \" restore from a backup.\"),\n-                walletFile, backup_filename, walletDir));\n-        }\n-        if (r == BerkeleyEnvironment::VerifyResult::RECOVER_FAIL)\n-        {\n-            errorStr = strprintf(_(\"%s corrupt, salvage failed\"), walletFile);\n+        if (!env->Verify(walletFile)) {\n+            errorStr = strprintf(_(\"%s corrupt. Try using the wallet tool bitcoin-wallet to salvage or restoring a backup\"), walletFile);",
    "path": "src/wallet/db.cpp",
    "position": null,
    "original_position": 127,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "94541050b84e166b6fcbaf6c30b263903dcc25f5",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "521e731 user-facing nit if you retouch: s/backup/backup./",
    "created_at": "2020-05-25T14:03:20Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429951866",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429951866"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429951866"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429951866/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 346,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429957071",
    "pull_request_review_id": 417731902,
    "id": 429957071,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTk1NzA3MQ==",
    "diff_hunk": "@@ -0,0 +1,150 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <fs.h>\n+#include <streams.h>\n+#include <wallet/salvage.h>\n+#include <wallet/wallet.h>\n+#include <wallet/walletdb.h>\n+\n+/* End of headers, beginning of key/value data */\n+static const char *HEADER_END = \"HEADER=END\";\n+/* End of key/value data */\n+static const char *DATA_END = \"DATA=END\";\n+typedef std::pair<std::vector<unsigned char>, std::vector<unsigned char> > KeyValPair;\n+\n+bool RecoverDatabaseFile(const fs::path& file_path)\n+{\n+    std::string filename;\n+    std::shared_ptr<BerkeleyEnvironment> env = GetWalletEnv(file_path, filename);\n+\n+    // Recovery procedure:\n+    // move wallet file to walletfilename.timestamp.bak\n+    // Call Salvage with fAggressive=true to\n+    // get as much data as possible.\n+    // Rewrite salvaged data to fresh wallet file\n+    // Set -rescan so any missing transactions will be\n+    // found.\n+    int64_t now = GetTime();\n+    std::string newFilename = strprintf(\"%s.%d.bak\", filename, now);\n+\n+    int result = env->dbenv->dbrename(nullptr, filename.c_str(), nullptr,\n+                                       newFilename.c_str(), DB_AUTO_COMMIT);\n+    if (result == 0)\n+        LogPrintf(\"Renamed %s to %s\\n\", filename, newFilename);\n+    else\n+    {\n+        LogPrintf(\"Failed to rename %s to %s\\n\", filename, newFilename);\n+        return false;\n+    }\n+\n+    /**\n+     * Salvage data from a file. The DB_AGGRESSIVE flag is being used (see berkeley DB->verify() method documentation).\n+     * key/value pairs are appendedto salvagedData which are then written out to a new wallet file.",
    "path": "src/wallet/salvage.cpp",
    "position": null,
    "original_position": 45,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "94541050b84e166b6fcbaf6c30b263903dcc25f5",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "6c3afd67 nit: s/appendedto/appended to/",
    "created_at": "2020-05-25T14:14:00Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429957071",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429957071"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429957071"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429957071/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 45,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429961257",
    "pull_request_review_id": 417731902,
    "id": 429961257,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTk2MTI1Nw==",
    "diff_hunk": "@@ -294,4 +288,7 @@ class WalletBatch\n //! Compacts BDB state so that wallet.dat is self-contained (if there are changes)\n void MaybeCompactWalletDB();\n \n+//! Unserialize a give Key-Value pair and load it into the wallet",
    "path": "src/wallet/walletdb.h",
    "position": null,
    "original_position": 17,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "94541050b84e166b6fcbaf6c30b263903dcc25f5",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "6d05dff nit: s/give/given/",
    "created_at": "2020-05-25T14:22:41Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429961257",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429961257"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429961257"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429961257/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 291,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429967147",
    "pull_request_review_id": 417731902,
    "id": 429967147,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTk2NzE0Nw==",
    "diff_hunk": "@@ -7,6 +7,7 @@\n #include <util/translation.h>\n #include <wallet/wallet.h>\n #include <wallet/walletutil.h>\n+#include <wallet/salvage.h>",
    "path": "src/wallet/wallettool.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "94541050b84e166b6fcbaf6c30b263903dcc25f5",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "39a82fed nit: sort",
    "created_at": "2020-05-25T14:35:01Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429967147",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429967147"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429967147"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429967147/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 10,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429975677",
    "pull_request_review_id": 417731902,
    "id": 429975677,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTk3NTY3Nw==",
    "diff_hunk": "@@ -410,100 +334,23 @@ bool BerkeleyBatch::VerifyEnvironment(const fs::path& file_path, bilingual_str&\n     return true;\n }\n \n-bool BerkeleyBatch::VerifyDatabaseFile(const fs::path& file_path, std::vector<bilingual_str>& warnings, bilingual_str& errorStr, BerkeleyEnvironment::recoverFunc_type recoverFunc)\n+bool BerkeleyBatch::VerifyDatabaseFile(const fs::path& file_path, std::vector<bilingual_str>& warnings, bilingual_str& errorStr)",
    "path": "src/wallet/db.cpp",
    "position": null,
    "original_position": 105,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "94541050b84e166b6fcbaf6c30b263903dcc25f5",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "521e731e seconding @Empact's observation that `warnings` can be removed with the other changes to `VerifyDatabaseFile` in this commit",
    "created_at": "2020-05-25T14:53:20Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429975677",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429975677"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429975677"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429975677/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 337,
    "side": "RIGHT",
    "in_reply_to_id": 429399582
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429981672",
    "pull_request_review_id": 417731902,
    "id": 429981672,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTk4MTY3Mg==",
    "diff_hunk": "@@ -0,0 +1,150 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <fs.h>\n+#include <streams.h>\n+#include <wallet/salvage.h>\n+#include <wallet/wallet.h>\n+#include <wallet/walletdb.h>\n+\n+/* End of headers, beginning of key/value data */\n+static const char *HEADER_END = \"HEADER=END\";\n+/* End of key/value data */\n+static const char *DATA_END = \"DATA=END\";\n+typedef std::pair<std::vector<unsigned char>, std::vector<unsigned char> > KeyValPair;\n+\n+bool RecoverDatabaseFile(const fs::path& file_path)\n+{\n+    std::string filename;\n+    std::shared_ptr<BerkeleyEnvironment> env = GetWalletEnv(file_path, filename);\n+\n+    // Recovery procedure:\n+    // move wallet file to walletfilename.timestamp.bak\n+    // Call Salvage with fAggressive=true to\n+    // get as much data as possible.\n+    // Rewrite salvaged data to fresh wallet file\n+    // Set -rescan so any missing transactions will be\n+    // found.\n+    int64_t now = GetTime();\n+    std::string newFilename = strprintf(\"%s.%d.bak\", filename, now);\n+\n+    int result = env->dbenv->dbrename(nullptr, filename.c_str(), nullptr,\n+                                       newFilename.c_str(), DB_AUTO_COMMIT);\n+    if (result == 0)\n+        LogPrintf(\"Renamed %s to %s\\n\", filename, newFilename);\n+    else\n+    {\n+        LogPrintf(\"Failed to rename %s to %s\\n\", filename, newFilename);\n+        return false;\n+    }\n+\n+    /**\n+     * Salvage data from a file. The DB_AGGRESSIVE flag is being used (see berkeley DB->verify() method documentation).\n+     * key/value pairs are appendedto salvagedData which are then written out to a new wallet file.\n+     * NOTE: reads the entire database into memory, so cannot be used\n+     * for huge databases.\n+     */\n+    std::vector<KeyValPair> salvagedData;\n+    bool fSuccess = false;\n+\n+    std::stringstream strDump;\n+\n+    Db db(env->dbenv.get(), 0);\n+    result = db.verify(newFilename.c_str(), nullptr, &strDump, DB_SALVAGE | DB_AGGRESSIVE);\n+    if (result == DB_VERIFY_BAD) {\n+        LogPrintf(\"Salvage: Database salvage found errors, all data may not be recoverable.\\n\");\n+    }\n+    if (result != 0 && result != DB_VERIFY_BAD) {\n+        LogPrintf(\"Salvage: Database salvage failed with result %d.\\n\", result);\n+        return false;\n+    }\n+\n+    // Format of bdb dump is ascii lines:\n+    // header lines...\n+    // HEADER=END\n+    //  hexadecimal key\n+    //  hexadecimal value\n+    //  ... repeated\n+    // DATA=END\n+\n+    std::string strLine;\n+    while (!strDump.eof() && strLine != HEADER_END)\n+        getline(strDump, strLine); // Skip past header\n+\n+    std::string keyHex, valueHex;\n+    while (!strDump.eof() && keyHex != DATA_END) {\n+        getline(strDump, keyHex);\n+        if (keyHex != DATA_END) {\n+            if (strDump.eof())\n+                break;\n+            getline(strDump, valueHex);\n+            if (valueHex == DATA_END) {\n+                LogPrintf(\"Salvage: WARNING: Number of keys in data does not match number of values.\\n\");\n+                break;\n+            }\n+            salvagedData.push_back(make_pair(ParseHex(keyHex), ParseHex(valueHex)));\n+        }\n+    }\n+\n+    if (keyHex != DATA_END) {\n+        LogPrintf(\"Salvage: WARNING: Unexpected end of file while reading salvage output.\\n\");\n+        fSuccess = false;\n+    } else {\n+        fSuccess = (result == 0);\n+    }\n+\n+    if (salvagedData.empty())\n+    {\n+        LogPrintf(\"Salvage(aggressive) found no records in %s.\\n\", newFilename);\n+        return false;\n+    }\n+    LogPrintf(\"Salvage(aggressive) found %u records\\n\", salvagedData.size());\n+\n+    std::unique_ptr<Db> pdbCopy = MakeUnique<Db>(env->dbenv.get(), 0);\n+    int ret = pdbCopy->open(nullptr,               // Txn pointer\n+                            filename.c_str(),   // Filename\n+                            \"main\",             // Logical db name\n+                            DB_BTREE,           // Database type\n+                            DB_CREATE,          // Flags\n+                            0);\n+    if (ret > 0) {\n+        LogPrintf(\"Cannot create database file %s\\n\", filename);\n+        pdbCopy->close(0);\n+        return false;\n+    }\n+\n+    DbTxn* ptxn = env->TxnBegin();\n+    CWallet dummyWallet(nullptr, WalletLocation(), WalletDatabase::CreateDummy());\n+    for (KeyValPair& row : salvagedData)\n+    {\n+        /* Filter for only private key type KV pairs to be added to the salvaged wallet */\n+        CDataStream ssKey(row.first, SER_DISK, CLIENT_VERSION);\n+        CDataStream ssValue(row.second, SER_DISK, CLIENT_VERSION);\n+        std::string strType, strErr;\n+        bool fReadOK;\n+        {\n+            // Required in LoadKeyMetadata():\n+            LOCK(dummyWallet.cs_wallet);\n+            fReadOK = ReadKeyValue(&dummyWallet, ssKey, ssValue, strType, strErr);\n+        }\n+        if (!WalletBatch::IsKeyType(strType) && strType != DBKeys::HDCHAIN) {\n+            continue;\n+        }\n+        if (!fReadOK)\n+        {\n+            LogPrintf(\"WARNING: WalletBatch::Recover skipping %s: %s\\n\", strType, strErr);\n+            continue;\n+        }\n+        Dbt datKey(&row.first[0], row.first.size());\n+        Dbt datValue(&row.second[0], row.second.size());\n+        int ret2 = pdbCopy->put(ptxn, &datKey, &datValue, DB_NOOVERWRITE);\n+        if (ret2 > 0)\n+            fSuccess = false;\n+    }\n+    ptxn->commit(0);\n+    pdbCopy->close(0);\n+\n+    return fSuccess;",
    "path": "src/wallet/salvage.cpp",
    "position": 149,
    "original_position": 149,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "94541050b84e166b6fcbaf6c30b263903dcc25f5",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "35a1f948 `RecoverDatabaseFile` contains a fair amount of code to set and return bool `fSuccess`, but the value returned doesn't appear to be used. Is this logic needed?",
    "created_at": "2020-05-25T15:06:53Z",
    "updated_at": "2020-05-25T17:16:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429981672",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429981672"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r429981672"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429981672/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 149,
    "original_line": 149,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024240",
    "pull_request_review_id": 417818462,
    "id": 430024240,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDAyNDI0MA==",
    "diff_hunk": "@@ -203,6 +203,10 @@ def test_getwalletinfo_on_different_wallet(self):\n         assert_equal(shasum_after, shasum_before)\n         self.log.debug('Wallet file shasum unchanged\\n')\n \n+    def test_salvage(self):\n+        # TODO: We should implement a test for this. But such a test should be after we fix https://github.com/bitcoin/bitcoin/issues/7463",
    "path": "test/functional/tool_wallet.py",
    "position": null,
    "original_position": 5,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "7116e0c73514438ba240827aaddf922d0c1c9d84",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I've added a very basic test that  just checks it runs and exits without error on a new wallet.",
    "created_at": "2020-05-25T17:16:36Z",
    "updated_at": "2020-05-25T17:16:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430024240",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024240"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430024240"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024240/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 207,
    "side": "RIGHT",
    "in_reply_to_id": 427631232
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024279",
    "pull_request_review_id": 417818506,
    "id": 430024279,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDAyNDI3OQ==",
    "diff_hunk": "@@ -123,10 +130,15 @@ bool ExecuteWalletToolFunc(const std::string& command, const std::string& name)\n             tfm::format(std::cerr, \"%s\\nError loading %s. Is wallet being used by other process?\\n\", error.original, name);\n             return false;\n         }\n-        std::shared_ptr<CWallet> wallet_instance = LoadWallet(name, path);\n-        if (!wallet_instance) return false;\n-        WalletShowInfo(wallet_instance.get());\n-        wallet_instance->Flush(true);\n+\n+        if (command == \"info\") {\n+            std::shared_ptr<CWallet> wallet_instance = LoadWallet(name, path);\n+            if (!wallet_instance) return false;\n+            WalletShowInfo(wallet_instance.get());\n+            wallet_instance->Flush(true);\n+        } else if (command == \"salvage\") {\n+            SalvageWallet(path);",
    "path": "src/wallet/wallettool.cpp",
    "position": null,
    "original_position": 38,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "7f6a5f3fff6e71108289ba9c9bfc5a938a081a79",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Changed to return it.",
    "created_at": "2020-05-25T17:16:46Z",
    "updated_at": "2020-05-25T17:16:46Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430024279",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024279"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430024279"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024279/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 140,
    "side": "RIGHT",
    "in_reply_to_id": 429224090
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024704",
    "pull_request_review_id": 417818991,
    "id": 430024704,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDAyNDcwNA==",
    "diff_hunk": "@@ -342,8 +348,61 @@ bool BerkeleyBatch::Recover(const fs::path& file_path, void *callbackDataIn, boo\n         return false;\n     }\n \n-    std::vector<BerkeleyEnvironment::KeyValPair> salvagedData;\n-    bool fSuccess = env->Salvage(newFilename, salvagedData);\n+    /**\n+     * Salvage data from a file. The DB_AGGRESSIVE flag is being used (see berkeley DB->verify() method documentation).\n+     * key/value pairs are appendedto salvagedData which are then written out to a new wallet file.\n+     * NOTE: reads the entire database into memory, so cannot be used\n+     * for huge databases.\n+     */\n+    std::vector<KeyValPair> salvagedData;\n+    bool fSuccess = false;",
    "path": "src/wallet/db.cpp",
    "position": null,
    "original_position": 26,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "6c3afd67d28475ed4e2ee655559503971db7cff7",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Changed.",
    "created_at": "2020-05-25T17:18:18Z",
    "updated_at": "2020-05-25T17:18:19Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430024704",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024704"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430024704"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024704/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 358,
    "side": "RIGHT",
    "in_reply_to_id": 429235553
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024803",
    "pull_request_review_id": 417819110,
    "id": 430024803,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDAyNDgwMw==",
    "diff_hunk": "@@ -902,8 +909,7 @@ bool WalletBatch::RecoverKeysOnlyFilter(void *callbackData, CDataStream ssKey, C\n     {",
    "path": "src/wallet/walletdb.cpp",
    "position": null,
    "original_position": 15,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "6d05dff02be9e113ac6f8356fdcc35c1f45c3aa2",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Removed",
    "created_at": "2020-05-25T17:18:41Z",
    "updated_at": "2020-05-25T17:18:42Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430024803",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024803"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430024803"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024803/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 909,
    "side": "RIGHT",
    "in_reply_to_id": 429240474
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024832",
    "pull_request_review_id": 417819145,
    "id": 430024832,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDAyNDgzMg==",
    "diff_hunk": "@@ -410,100 +334,23 @@ bool BerkeleyBatch::VerifyEnvironment(const fs::path& file_path, bilingual_str&\n     return true;\n }\n \n-bool BerkeleyBatch::VerifyDatabaseFile(const fs::path& file_path, std::vector<bilingual_str>& warnings, bilingual_str& errorStr, BerkeleyEnvironment::recoverFunc_type recoverFunc)\n+bool BerkeleyBatch::VerifyDatabaseFile(const fs::path& file_path, std::vector<bilingual_str>& warnings, bilingual_str& errorStr)",
    "path": "src/wallet/db.cpp",
    "position": null,
    "original_position": 105,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "94541050b84e166b6fcbaf6c30b263903dcc25f5",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Removed",
    "created_at": "2020-05-25T17:18:49Z",
    "updated_at": "2020-05-25T17:18:49Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430024832",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024832"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430024832"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024832/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 337,
    "side": "RIGHT",
    "in_reply_to_id": 429399582
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024868",
    "pull_request_review_id": 417819193,
    "id": 430024868,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDAyNDg2OA==",
    "diff_hunk": "@@ -410,100 +334,23 @@ bool BerkeleyBatch::VerifyEnvironment(const fs::path& file_path, bilingual_str&\n     return true;\n }\n \n-bool BerkeleyBatch::VerifyDatabaseFile(const fs::path& file_path, std::vector<bilingual_str>& warnings, bilingual_str& errorStr, BerkeleyEnvironment::recoverFunc_type recoverFunc)\n+bool BerkeleyBatch::VerifyDatabaseFile(const fs::path& file_path, std::vector<bilingual_str>& warnings, bilingual_str& errorStr)\n {\n     std::string walletFile;\n     std::shared_ptr<BerkeleyEnvironment> env = GetWalletEnv(file_path, walletFile);\n     fs::path walletDir = env->Directory();\n \n     if (fs::exists(walletDir / walletFile))\n     {\n-        std::string backup_filename;\n-        BerkeleyEnvironment::VerifyResult r = env->Verify(walletFile, recoverFunc, backup_filename);\n-        if (r == BerkeleyEnvironment::VerifyResult::RECOVER_OK)\n-        {\n-            warnings.push_back(strprintf(_(\"Warning: Wallet file corrupt, data salvaged!\"\n-                                     \" Original %s saved as %s in %s; if\"\n-                                     \" your balance or transactions are incorrect you should\"\n-                                     \" restore from a backup.\"),\n-                walletFile, backup_filename, walletDir));\n-        }\n-        if (r == BerkeleyEnvironment::VerifyResult::RECOVER_FAIL)\n-        {\n-            errorStr = strprintf(_(\"%s corrupt, salvage failed\"), walletFile);\n+        if (!env->Verify(walletFile)) {\n+            errorStr = strprintf(_(\"%s corrupt. Try using the wallet tool bitcoin-wallet to salvage or restoring a backup\"), walletFile);",
    "path": "src/wallet/db.cpp",
    "position": null,
    "original_position": 127,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "94541050b84e166b6fcbaf6c30b263903dcc25f5",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done",
    "created_at": "2020-05-25T17:19:02Z",
    "updated_at": "2020-05-25T17:19:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430024868",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024868"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430024868"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024868/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 346,
    "side": "RIGHT",
    "in_reply_to_id": 429951866
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024890",
    "pull_request_review_id": 417819216,
    "id": 430024890,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDAyNDg5MA==",
    "diff_hunk": "@@ -0,0 +1,150 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <fs.h>\n+#include <streams.h>\n+#include <wallet/salvage.h>\n+#include <wallet/wallet.h>\n+#include <wallet/walletdb.h>\n+\n+/* End of headers, beginning of key/value data */\n+static const char *HEADER_END = \"HEADER=END\";\n+/* End of key/value data */\n+static const char *DATA_END = \"DATA=END\";\n+typedef std::pair<std::vector<unsigned char>, std::vector<unsigned char> > KeyValPair;\n+\n+bool RecoverDatabaseFile(const fs::path& file_path)\n+{\n+    std::string filename;\n+    std::shared_ptr<BerkeleyEnvironment> env = GetWalletEnv(file_path, filename);\n+\n+    // Recovery procedure:\n+    // move wallet file to walletfilename.timestamp.bak\n+    // Call Salvage with fAggressive=true to\n+    // get as much data as possible.\n+    // Rewrite salvaged data to fresh wallet file\n+    // Set -rescan so any missing transactions will be\n+    // found.\n+    int64_t now = GetTime();\n+    std::string newFilename = strprintf(\"%s.%d.bak\", filename, now);\n+\n+    int result = env->dbenv->dbrename(nullptr, filename.c_str(), nullptr,\n+                                       newFilename.c_str(), DB_AUTO_COMMIT);\n+    if (result == 0)\n+        LogPrintf(\"Renamed %s to %s\\n\", filename, newFilename);\n+    else\n+    {\n+        LogPrintf(\"Failed to rename %s to %s\\n\", filename, newFilename);\n+        return false;\n+    }\n+\n+    /**\n+     * Salvage data from a file. The DB_AGGRESSIVE flag is being used (see berkeley DB->verify() method documentation).\n+     * key/value pairs are appendedto salvagedData which are then written out to a new wallet file.",
    "path": "src/wallet/salvage.cpp",
    "position": null,
    "original_position": 45,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "94541050b84e166b6fcbaf6c30b263903dcc25f5",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done",
    "created_at": "2020-05-25T17:19:06Z",
    "updated_at": "2020-05-25T17:19:06Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430024890",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024890"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430024890"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024890/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 45,
    "side": "RIGHT",
    "in_reply_to_id": 429957071
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024907",
    "pull_request_review_id": 417819237,
    "id": 430024907,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDAyNDkwNw==",
    "diff_hunk": "@@ -294,4 +288,7 @@ class WalletBatch\n //! Compacts BDB state so that wallet.dat is self-contained (if there are changes)\n void MaybeCompactWalletDB();\n \n+//! Unserialize a give Key-Value pair and load it into the wallet",
    "path": "src/wallet/walletdb.h",
    "position": null,
    "original_position": 17,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "94541050b84e166b6fcbaf6c30b263903dcc25f5",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done",
    "created_at": "2020-05-25T17:19:11Z",
    "updated_at": "2020-05-25T17:19:12Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430024907",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024907"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430024907"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024907/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 291,
    "side": "RIGHT",
    "in_reply_to_id": 429961257
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024931",
    "pull_request_review_id": 417819269,
    "id": 430024931,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDAyNDkzMQ==",
    "diff_hunk": "@@ -7,6 +7,7 @@\n #include <util/translation.h>\n #include <wallet/wallet.h>\n #include <wallet/walletutil.h>\n+#include <wallet/salvage.h>",
    "path": "src/wallet/wallettool.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "94541050b84e166b6fcbaf6c30b263903dcc25f5",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done",
    "created_at": "2020-05-25T17:19:19Z",
    "updated_at": "2020-05-25T17:19:19Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430024931",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024931"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430024931"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024931/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 10,
    "side": "RIGHT",
    "in_reply_to_id": 429967147
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024967",
    "pull_request_review_id": 417819315,
    "id": 430024967,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDAyNDk2Nw==",
    "diff_hunk": "@@ -0,0 +1,150 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <fs.h>\n+#include <streams.h>\n+#include <wallet/salvage.h>\n+#include <wallet/wallet.h>\n+#include <wallet/walletdb.h>\n+\n+/* End of headers, beginning of key/value data */\n+static const char *HEADER_END = \"HEADER=END\";\n+/* End of key/value data */\n+static const char *DATA_END = \"DATA=END\";\n+typedef std::pair<std::vector<unsigned char>, std::vector<unsigned char> > KeyValPair;\n+\n+bool RecoverDatabaseFile(const fs::path& file_path)\n+{\n+    std::string filename;\n+    std::shared_ptr<BerkeleyEnvironment> env = GetWalletEnv(file_path, filename);\n+\n+    // Recovery procedure:\n+    // move wallet file to walletfilename.timestamp.bak\n+    // Call Salvage with fAggressive=true to\n+    // get as much data as possible.\n+    // Rewrite salvaged data to fresh wallet file\n+    // Set -rescan so any missing transactions will be\n+    // found.\n+    int64_t now = GetTime();\n+    std::string newFilename = strprintf(\"%s.%d.bak\", filename, now);\n+\n+    int result = env->dbenv->dbrename(nullptr, filename.c_str(), nullptr,\n+                                       newFilename.c_str(), DB_AUTO_COMMIT);\n+    if (result == 0)\n+        LogPrintf(\"Renamed %s to %s\\n\", filename, newFilename);\n+    else\n+    {\n+        LogPrintf(\"Failed to rename %s to %s\\n\", filename, newFilename);\n+        return false;\n+    }\n+\n+    /**\n+     * Salvage data from a file. The DB_AGGRESSIVE flag is being used (see berkeley DB->verify() method documentation).\n+     * key/value pairs are appendedto salvagedData which are then written out to a new wallet file.\n+     * NOTE: reads the entire database into memory, so cannot be used\n+     * for huge databases.\n+     */\n+    std::vector<KeyValPair> salvagedData;\n+    bool fSuccess = false;\n+\n+    std::stringstream strDump;\n+\n+    Db db(env->dbenv.get(), 0);\n+    result = db.verify(newFilename.c_str(), nullptr, &strDump, DB_SALVAGE | DB_AGGRESSIVE);\n+    if (result == DB_VERIFY_BAD) {\n+        LogPrintf(\"Salvage: Database salvage found errors, all data may not be recoverable.\\n\");\n+    }\n+    if (result != 0 && result != DB_VERIFY_BAD) {\n+        LogPrintf(\"Salvage: Database salvage failed with result %d.\\n\", result);\n+        return false;\n+    }\n+\n+    // Format of bdb dump is ascii lines:\n+    // header lines...\n+    // HEADER=END\n+    //  hexadecimal key\n+    //  hexadecimal value\n+    //  ... repeated\n+    // DATA=END\n+\n+    std::string strLine;\n+    while (!strDump.eof() && strLine != HEADER_END)\n+        getline(strDump, strLine); // Skip past header\n+\n+    std::string keyHex, valueHex;\n+    while (!strDump.eof() && keyHex != DATA_END) {\n+        getline(strDump, keyHex);\n+        if (keyHex != DATA_END) {\n+            if (strDump.eof())\n+                break;\n+            getline(strDump, valueHex);\n+            if (valueHex == DATA_END) {\n+                LogPrintf(\"Salvage: WARNING: Number of keys in data does not match number of values.\\n\");\n+                break;\n+            }\n+            salvagedData.push_back(make_pair(ParseHex(keyHex), ParseHex(valueHex)));\n+        }\n+    }\n+\n+    if (keyHex != DATA_END) {\n+        LogPrintf(\"Salvage: WARNING: Unexpected end of file while reading salvage output.\\n\");\n+        fSuccess = false;\n+    } else {\n+        fSuccess = (result == 0);\n+    }\n+\n+    if (salvagedData.empty())\n+    {\n+        LogPrintf(\"Salvage(aggressive) found no records in %s.\\n\", newFilename);\n+        return false;\n+    }\n+    LogPrintf(\"Salvage(aggressive) found %u records\\n\", salvagedData.size());\n+\n+    std::unique_ptr<Db> pdbCopy = MakeUnique<Db>(env->dbenv.get(), 0);\n+    int ret = pdbCopy->open(nullptr,               // Txn pointer\n+                            filename.c_str(),   // Filename\n+                            \"main\",             // Logical db name\n+                            DB_BTREE,           // Database type\n+                            DB_CREATE,          // Flags\n+                            0);\n+    if (ret > 0) {\n+        LogPrintf(\"Cannot create database file %s\\n\", filename);\n+        pdbCopy->close(0);\n+        return false;\n+    }\n+\n+    DbTxn* ptxn = env->TxnBegin();\n+    CWallet dummyWallet(nullptr, WalletLocation(), WalletDatabase::CreateDummy());\n+    for (KeyValPair& row : salvagedData)\n+    {\n+        /* Filter for only private key type KV pairs to be added to the salvaged wallet */\n+        CDataStream ssKey(row.first, SER_DISK, CLIENT_VERSION);\n+        CDataStream ssValue(row.second, SER_DISK, CLIENT_VERSION);\n+        std::string strType, strErr;\n+        bool fReadOK;\n+        {\n+            // Required in LoadKeyMetadata():\n+            LOCK(dummyWallet.cs_wallet);\n+            fReadOK = ReadKeyValue(&dummyWallet, ssKey, ssValue, strType, strErr);\n+        }\n+        if (!WalletBatch::IsKeyType(strType) && strType != DBKeys::HDCHAIN) {\n+            continue;\n+        }\n+        if (!fReadOK)\n+        {\n+            LogPrintf(\"WARNING: WalletBatch::Recover skipping %s: %s\\n\", strType, strErr);\n+            continue;\n+        }\n+        Dbt datKey(&row.first[0], row.first.size());\n+        Dbt datValue(&row.second[0], row.second.size());\n+        int ret2 = pdbCopy->put(ptxn, &datKey, &datValue, DB_NOOVERWRITE);\n+        if (ret2 > 0)\n+            fSuccess = false;\n+    }\n+    ptxn->commit(0);\n+    pdbCopy->close(0);\n+\n+    return fSuccess;",
    "path": "src/wallet/salvage.cpp",
    "position": 149,
    "original_position": 149,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "94541050b84e166b6fcbaf6c30b263903dcc25f5",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The return value is being checked now.",
    "created_at": "2020-05-25T17:19:29Z",
    "updated_at": "2020-05-25T17:19:30Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430024967",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024967"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430024967"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430024967/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 149,
    "original_line": 149,
    "side": "RIGHT",
    "in_reply_to_id": 429981672
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430259244",
    "pull_request_review_id": 418100419,
    "id": 430259244,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDI1OTI0NA==",
    "diff_hunk": "@@ -103,6 +104,27 @@ static void WalletShowInfo(CWallet* wallet_instance)\n     tfm::format(std::cout, \"Address Book: %zu\\n\", wallet_instance->m_address_book.size());\n }\n \n+static bool SalvageWallet(const fs::path& path)\n+{\n+    // Create a Database handle to allow for the db to be initialized before recovery\n+    std::unique_ptr<WalletDatabase> database = WalletDatabase::Create(path);\n+\n+    // Initialize the environment before recovery\n+    bilingual_str error_string;\n+    try {\n+        WalletBatch::VerifyEnvironment(path, error_string);\n+    } catch (const fs::filesystem_error& e) {\n+        error_string = Untranslated(strprintf(\"Error loading wallet. %s\", fsbridge::get_filesystem_error_message(e)));\n+    }\n+    if (!error_string.original.empty()) {\n+        tfm::format(std::cerr, \"Failed to open wallet for salvage :%s\\n\", error_string.original);",
    "path": "src/wallet/wallettool.cpp",
    "position": 25,
    "original_position": 25,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Tests for the different exceptions would be great. Not sure on this, or on the need for an EOL `\\n` in line 117 just above.\r\n```suggestion\r\n        tfm::format(std::cerr, \"Failed to open wallet for salvage: %s\\n\", error_string.original);\r\n```",
    "created_at": "2020-05-26T08:56:45Z",
    "updated_at": "2020-05-26T08:59:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430259244",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430259244"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430259244"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430259244/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 120,
    "original_line": 120,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430560436",
    "pull_request_review_id": 418489792,
    "id": 430560436,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMDU2MDQzNg==",
    "diff_hunk": "@@ -103,6 +104,27 @@ static void WalletShowInfo(CWallet* wallet_instance)\n     tfm::format(std::cout, \"Address Book: %zu\\n\", wallet_instance->m_address_book.size());\n }\n \n+static bool SalvageWallet(const fs::path& path)\n+{\n+    // Create a Database handle to allow for the db to be initialized before recovery\n+    std::unique_ptr<WalletDatabase> database = WalletDatabase::Create(path);\n+\n+    // Initialize the environment before recovery\n+    bilingual_str error_string;\n+    try {\n+        WalletBatch::VerifyEnvironment(path, error_string);\n+    } catch (const fs::filesystem_error& e) {\n+        error_string = Untranslated(strprintf(\"Error loading wallet. %s\", fsbridge::get_filesystem_error_message(e)));\n+    }\n+    if (!error_string.original.empty()) {\n+        tfm::format(std::cerr, \"Failed to open wallet for salvage :%s\\n\", error_string.original);",
    "path": "src/wallet/wallettool.cpp",
    "position": 25,
    "original_position": 25,
    "commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "original_commit_id": "84ae0578b6c68dda145ca65fef510ce0fdac0d7b",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Will fix if I have to push another change.",
    "created_at": "2020-05-26T16:47:56Z",
    "updated_at": "2020-05-26T16:47:56Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430560436",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430560436"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18918#discussion_r430560436"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18918"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/430560436/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 120,
    "original_line": 120,
    "side": "RIGHT",
    "in_reply_to_id": 430259244
  }
]