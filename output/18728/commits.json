[
  {
    "sha": "273e57bd4cd91e8399f3567c79241bbc416ea690",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyNzNlNTdiZDRjZDkxZTgzOTlmMzU2N2M3OTI0MWJiYzQxNmVhNjkw",
    "commit": {
      "author": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2020-04-20T14:42:52Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2020-09-11T01:52:01Z"
      },
      "message": "GUI/Intro: Return actual prune setting from showIfNeeded",
      "tree": {
        "sha": "7c67d56ec0bb8d863214d89b62ce6147cb429005",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7c67d56ec0bb8d863214d89b62ce6147cb429005"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/273e57bd4cd91e8399f3567c79241bbc416ea690",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/273e57bd4cd91e8399f3567c79241bbc416ea690",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/273e57bd4cd91e8399f3567c79241bbc416ea690",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/273e57bd4cd91e8399f3567c79241bbc416ea690/comments",
    "author": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "a47e5964861dfb98d61719c9852e12fd6da84c31",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a47e5964861dfb98d61719c9852e12fd6da84c31",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/a47e5964861dfb98d61719c9852e12fd6da84c31"
      }
    ],
    "stats": {
      "total": 18,
      "additions": 8,
      "deletions": 10
    },
    "files": [
      {
        "sha": "19cab64443e41b283152f1b9da0b8394446cf95e",
        "filename": "src/qt/bitcoin.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 6,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/273e57bd4cd91e8399f3567c79241bbc416ea690/src/qt/bitcoin.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/273e57bd4cd91e8399f3567c79241bbc416ea690/src/qt/bitcoin.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoin.cpp?ref=273e57bd4cd91e8399f3567c79241bbc416ea690",
        "patch": "@@ -315,11 +315,9 @@ void BitcoinApplication::parameterSetup()\n     InitParameterInteraction(gArgs);\n }\n \n-void BitcoinApplication::InitializePruneSetting(bool prune)\n+void BitcoinApplication::InitPruneSetting(int64_t prune_opt)\n {\n-    // If prune is set, intentionally override existing prune size with\n-    // the default size since this is called when choosing a new datadir.\n-    optionsModel->SetPruneTargetGB(prune ? DEFAULT_PRUNE_TARGET_GB : 0, true);\n+    optionsModel->SetPruneTargetGB(PruneMiBtoGB(prune_opt), true);\n }\n \n void BitcoinApplication::requestInitialize()\n@@ -508,7 +506,7 @@ int GuiMain(int argc, char* argv[])\n     /// 5. Now that settings and translations are available, ask user for data directory\n     // User language is set up: pick a data directory\n     bool did_show_intro = false;\n-    bool prune = false; // Intro dialog prune check box\n+    int64_t prune = 0;  // Intro dialog prune configuration\n     // Gracefully exit if the user cancels\n     if (!Intro::showIfNeeded(did_show_intro, prune)) return EXIT_SUCCESS;\n \n@@ -594,7 +592,7 @@ int GuiMain(int argc, char* argv[])\n \n     if (did_show_intro) {\n         // Store intro dialog settings other than datadir (network specific)\n-        app.InitializePruneSetting(prune);\n+        app.InitPruneSetting(prune);\n     }\n \n     if (gArgs.GetBoolArg(\"-splash\", DEFAULT_SPLASHSCREEN) && !gArgs.GetBoolArg(\"-min\", false))"
      },
      {
        "sha": "293d8ed8dc0fd40f3b9c946bfce574f87584222c",
        "filename": "src/qt/bitcoin.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/273e57bd4cd91e8399f3567c79241bbc416ea690/src/qt/bitcoin.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/273e57bd4cd91e8399f3567c79241bbc416ea690/src/qt/bitcoin.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoin.h?ref=273e57bd4cd91e8399f3567c79241bbc416ea690",
        "patch": "@@ -68,7 +68,7 @@ class BitcoinApplication: public QApplication\n     /// Create options model\n     void createOptionsModel(bool resetSettings);\n     /// Initialize prune setting\n-    void InitializePruneSetting(bool prune);\n+    void InitPruneSetting(int64_t prune_opt);\n     /// Create main window\n     void createWindow(const NetworkStyle *networkStyle);\n     /// Create splash screen"
      },
      {
        "sha": "d36dd9446d5f648c1c7a900e9bdc1f03dbd03a9a",
        "filename": "src/qt/intro.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/273e57bd4cd91e8399f3567c79241bbc416ea690/src/qt/intro.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/273e57bd4cd91e8399f3567c79241bbc416ea690/src/qt/intro.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/intro.cpp?ref=273e57bd4cd91e8399f3567c79241bbc416ea690",
        "patch": "@@ -182,7 +182,7 @@ void Intro::setDataDirectory(const QString &dataDir)\n     }\n }\n \n-bool Intro::showIfNeeded(bool& did_show_intro, bool& prune)\n+bool Intro::showIfNeeded(bool& did_show_intro, int64_t& prune)\n {\n     did_show_intro = false;\n \n@@ -233,7 +233,7 @@ bool Intro::showIfNeeded(bool& did_show_intro, bool& prune)\n         }\n \n         // Additional preferences:\n-        prune = intro.ui->prune->isChecked();\n+        prune = intro.ui->prune->isChecked() ? PruneGBtoMiB(intro.m_prune_target_gb) : int64_t(0);\n \n         settings.setValue(\"strDataDir\", dataDir);\n         settings.setValue(\"fReset\", false);"
      },
      {
        "sha": "3bccb08f47def42d12a1a52002507455b31a652f",
        "filename": "src/qt/intro.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/273e57bd4cd91e8399f3567c79241bbc416ea690/src/qt/intro.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/273e57bd4cd91e8399f3567c79241bbc416ea690/src/qt/intro.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/intro.h?ref=273e57bd4cd91e8399f3567c79241bbc416ea690",
        "patch": "@@ -47,7 +47,7 @@ class Intro : public QDialog\n      * @note do NOT call global GetDataDir() before calling this function, this\n      * will cause the wrong path to be cached.\n      */\n-    static bool showIfNeeded(bool& did_show_intro, bool& prune);\n+    static bool showIfNeeded(bool& did_show_intro, int64_t& prune);\n \n Q_SIGNALS:\n     void requestCheck();"
      }
    ]
  },
  {
    "sha": "dd50e8a312baba4340bf8854d4e0c96bfadf1763",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkZDUwZThhMzEyYmFiYTQzNDBiZjg4NTRkNGUwYzk2YmZhZGYxNzYz",
    "commit": {
      "author": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2020-04-21T20:30:37Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2020-09-11T04:48:42Z"
      },
      "message": "GUI/Intro: Abstract GUI-to-option into Intro::getPrune",
      "tree": {
        "sha": "4e6b2f110e01d5b01a510133cb8ff80dae7dad90",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4e6b2f110e01d5b01a510133cb8ff80dae7dad90"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dd50e8a312baba4340bf8854d4e0c96bfadf1763",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dd50e8a312baba4340bf8854d4e0c96bfadf1763",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/dd50e8a312baba4340bf8854d4e0c96bfadf1763",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dd50e8a312baba4340bf8854d4e0c96bfadf1763/comments",
    "author": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "273e57bd4cd91e8399f3567c79241bbc416ea690",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/273e57bd4cd91e8399f3567c79241bbc416ea690",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/273e57bd4cd91e8399f3567c79241bbc416ea690"
      }
    ],
    "stats": {
      "total": 13,
      "additions": 12,
      "deletions": 1
    },
    "files": [
      {
        "sha": "cb90dbfcc509ee9f5da7cda2c0bec44c16956565",
        "filename": "src/qt/intro.cpp",
        "status": "modified",
        "additions": 11,
        "deletions": 1,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/dd50e8a312baba4340bf8854d4e0c96bfadf1763/src/qt/intro.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/dd50e8a312baba4340bf8854d4e0c96bfadf1763/src/qt/intro.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/intro.cpp?ref=dd50e8a312baba4340bf8854d4e0c96bfadf1763",
        "patch": "@@ -182,6 +182,16 @@ void Intro::setDataDirectory(const QString &dataDir)\n     }\n }\n \n+int64_t Intro::getPrune() const\n+{\n+    switch (ui->prune->checkState()) {\n+    case Qt::Checked:\n+         return PruneGBtoMiB(m_prune_target_gb);\n+    case Qt::Unchecked: default:\n+        return 0;\n+    }\n+}\n+\n bool Intro::showIfNeeded(bool& did_show_intro, int64_t& prune)\n {\n     did_show_intro = false;\n@@ -233,7 +243,7 @@ bool Intro::showIfNeeded(bool& did_show_intro, int64_t& prune)\n         }\n \n         // Additional preferences:\n-        prune = intro.ui->prune->isChecked() ? PruneGBtoMiB(intro.m_prune_target_gb) : int64_t(0);\n+        prune = intro.getPrune();\n \n         settings.setValue(\"strDataDir\", dataDir);\n         settings.setValue(\"fReset\", false);"
      },
      {
        "sha": "a6873c8f35124a0a4c85d6687b66090d0ec714ab",
        "filename": "src/qt/intro.h",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/dd50e8a312baba4340bf8854d4e0c96bfadf1763/src/qt/intro.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/dd50e8a312baba4340bf8854d4e0c96bfadf1763/src/qt/intro.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/intro.h?ref=dd50e8a312baba4340bf8854d4e0c96bfadf1763",
        "patch": "@@ -36,6 +36,7 @@ class Intro : public QDialog\n \n     QString getDataDirectory();\n     void setDataDirectory(const QString &dataDir);\n+    int64_t getPrune() const;\n \n     /**\n      * Determine data directory. Let the user choose if the current one doesn't exist."
      }
    ]
  },
  {
    "sha": "77f3f2dda6918b0986f785b3061cfb8c97ed2b5c",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3N2YzZjJkZGE2OTE4YjA5ODZmNzg1YjMwNjFjZmI4Yzk3ZWQyYjVj",
    "commit": {
      "author": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2020-04-21T21:14:11Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2020-09-11T04:48:42Z"
      },
      "message": "GUI/Intro: Rework UI flow to let the user set prune size in GBs",
      "tree": {
        "sha": "8087dbea2ae0ec8cc102ab69362813786d873f9c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8087dbea2ae0ec8cc102ab69362813786d873f9c"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/77f3f2dda6918b0986f785b3061cfb8c97ed2b5c",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/77f3f2dda6918b0986f785b3061cfb8c97ed2b5c",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/77f3f2dda6918b0986f785b3061cfb8c97ed2b5c",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/77f3f2dda6918b0986f785b3061cfb8c97ed2b5c/comments",
    "author": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "dd50e8a312baba4340bf8854d4e0c96bfadf1763",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dd50e8a312baba4340bf8854d4e0c96bfadf1763",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/dd50e8a312baba4340bf8854d4e0c96bfadf1763"
      }
    ],
    "stats": {
      "total": 60,
      "additions": 47,
      "deletions": 13
    },
    "files": [
      {
        "sha": "db1b567049d8ab16ba9a5dd6ec6b68c56e62e823",
        "filename": "src/qt/forms/intro.ui",
        "status": "modified",
        "additions": 35,
        "deletions": 11,
        "changes": 46,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/77f3f2dda6918b0986f785b3061cfb8c97ed2b5c/src/qt/forms/intro.ui",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/77f3f2dda6918b0986f785b3061cfb8c97ed2b5c/src/qt/forms/intro.ui",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/forms/intro.ui?ref=77f3f2dda6918b0986f785b3061cfb8c97ed2b5c",
        "patch": "@@ -7,7 +7,7 @@\n     <x>0</x>\n     <y>0</y>\n     <width>674</width>\n-    <height>415</height>\n+    <height>447</height>\n    </rect>\n   </property>\n   <property name=\"windowTitle\">\n@@ -200,6 +200,40 @@\n      </item>\n     </layout>\n    </item>\n+   <item>\n+    <layout class=\"QHBoxLayout\" name=\"pruneOptLayout\">\n+     <item>\n+      <widget class=\"QCheckBox\" name=\"prune\">\n+       <property name=\"text\">\n+        <string>Limit block chain storage to</string>\n+       </property>\n+       <property name=\"toolTip\">\n+        <string>Reverting this setting requires re-downloading the entire blockchain. It is faster to download the full chain first and prune it later. Disables some advanced features.</string>\n+       </property>\n+      </widget>\n+     </item>\n+     <item>\n+      <widget class=\"QSpinBox\" name=\"pruneGB\">\n+       <property name=\"suffix\">\n+        <string> GB</string>\n+       </property>\n+      </widget>\n+     </item>\n+     <item>\n+      <spacer name=\"horizontalSpacer_2\">\n+       <property name=\"orientation\">\n+        <enum>Qt::Horizontal</enum>\n+       </property>\n+       <property name=\"sizeHint\" stdset=\"0\">\n+        <size>\n+         <width>40</width>\n+         <height>20</height>\n+        </size>\n+       </property>\n+      </spacer>\n+     </item>\n+    </layout>\n+   </item>\n    <item>\n     <widget class=\"QLabel\" name=\"lblExplanation1\">\n      <property name=\"text\">\n@@ -210,16 +244,6 @@\n      </property>\n     </widget>\n    </item>\n-   <item>\n-    <widget class=\"QCheckBox\" name=\"prune\">\n-     <property name=\"toolTip\">\n-      <string>Reverting this setting requires re-downloading the entire blockchain. It is faster to download the full chain first and prune it later. Disables some advanced features.</string>\n-     </property>\n-     <property name=\"text\">\n-      <string></string>\n-     </property>\n-    </widget>\n-   </item>\n    <item>\n     <widget class=\"QLabel\" name=\"lblExplanation2\">\n      <property name=\"text\">"
      },
      {
        "sha": "dd027ebaa3f85eea223c795e71de3f2a1967b7ff",
        "filename": "src/qt/intro.cpp",
        "status": "modified",
        "additions": 11,
        "deletions": 1,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/77f3f2dda6918b0986f785b3061cfb8c97ed2b5c/src/qt/intro.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/77f3f2dda6918b0986f785b3061cfb8c97ed2b5c/src/qt/intro.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/intro.cpp?ref=77f3f2dda6918b0986f785b3061cfb8c97ed2b5c",
        "patch": "@@ -17,6 +17,7 @@\n \n #include <interfaces/node.h>\n #include <util/system.h>\n+#include <validation.h>\n \n #include <QFileDialog>\n #include <QSettings>\n@@ -139,17 +140,25 @@ Intro::Intro(QWidget *parent, int64_t blockchain_size_gb, int64_t chain_state_si\n     );\n     ui->lblExplanation2->setText(ui->lblExplanation2->text().arg(PACKAGE_NAME));\n \n+    const int min_prune_target = std::ceil(MIN_DISK_SPACE_FOR_BLOCK_FILES / 1e9);\n+    ui->pruneGB->setRange(min_prune_target, std::numeric_limits<int>::max());\n     if (gArgs.GetArg(\"-prune\", 0) > 1) { // -prune=1 means enabled, above that it's a size in MiB\n         ui->prune->setChecked(true);\n         ui->prune->setEnabled(false);\n     }\n-    ui->prune->setText(tr(\"Discard blocks after verification, except most recent %1 GB (prune)\").arg(m_prune_target_gb));\n+    ui->pruneGB->setValue(m_prune_target_gb);\n+    ui->pruneGB->setToolTip(ui->prune->toolTip());\n     UpdatePruneLabels(ui->prune->isChecked());\n \n     connect(ui->prune, &QCheckBox::toggled, [this](bool prune_checked) {\n         UpdatePruneLabels(prune_checked);\n         UpdateFreeSpaceLabel();\n     });\n+    connect(ui->pruneGB, static_cast<void (QSpinBox::*)(int)>(&QSpinBox::valueChanged), [this](int prune_GB) {\n+        m_prune_target_gb = prune_GB;\n+        UpdatePruneLabels(ui->prune->isChecked());\n+        UpdateFreeSpaceLabel();\n+    });\n \n     startThread();\n }\n@@ -371,6 +380,7 @@ void Intro::UpdatePruneLabels(bool prune_checked)\n         storageRequiresMsg = tr(\"Approximately %1 GB of data will be stored in this directory.\");\n     }\n     ui->lblExplanation3->setVisible(prune_checked);\n+    ui->pruneGB->setEnabled(prune_checked);\n     ui->sizeWarningLabel->setText(\n         tr(\"%1 will download and store a copy of the Bitcoin block chain.\").arg(PACKAGE_NAME) + \" \" +\n         storageRequiresMsg.arg(m_required_space_gb) + \" \" +"
      },
      {
        "sha": "ef9316ebd24db419b8590a01de4f8c9cd1633ccd",
        "filename": "src/qt/intro.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/77f3f2dda6918b0986f785b3061cfb8c97ed2b5c/src/qt/intro.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/77f3f2dda6918b0986f785b3061cfb8c97ed2b5c/src/qt/intro.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/intro.h?ref=77f3f2dda6918b0986f785b3061cfb8c97ed2b5c",
        "patch": "@@ -73,7 +73,7 @@ private Q_SLOTS:\n     //! Total required space (in GB) depending on user choice (prune or not prune).\n     int64_t m_required_space_gb{0};\n     uint64_t m_bytes_available{0};\n-    const int64_t m_prune_target_gb;\n+    int64_t m_prune_target_gb;\n \n     void startThread();\n     void checkPath(const QString &dataDir);"
      }
    ]
  },
  {
    "sha": "7d40a4805229618a364dc53a84cd5af2ac273b7d",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3ZDQwYTQ4MDUyMjk2MThhMzY0ZGM1M2E4NGNkNWFmMmFjMjczYjdk",
    "commit": {
      "author": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2020-04-21T22:02:25Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2020-09-11T04:48:42Z"
      },
      "message": "GUI/Intro: Estimate max age of backups that can be restored with pruning",
      "tree": {
        "sha": "592c8c6efb9ae822c9a8fa1a7dc0e32c0eeed177",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/592c8c6efb9ae822c9a8fa1a7dc0e32c0eeed177"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7d40a4805229618a364dc53a84cd5af2ac273b7d",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7d40a4805229618a364dc53a84cd5af2ac273b7d",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/7d40a4805229618a364dc53a84cd5af2ac273b7d",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7d40a4805229618a364dc53a84cd5af2ac273b7d/comments",
    "author": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "77f3f2dda6918b0986f785b3061cfb8c97ed2b5c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/77f3f2dda6918b0986f785b3061cfb8c97ed2b5c",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/77f3f2dda6918b0986f785b3061cfb8c97ed2b5c"
      }
    ],
    "stats": {
      "total": 11,
      "additions": 11,
      "deletions": 0
    },
    "files": [
      {
        "sha": "ac3b6c73288756a93a38b43d76a6de4a7e95f57d",
        "filename": "src/qt/forms/intro.ui",
        "status": "modified",
        "additions": 7,
        "deletions": 0,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7d40a4805229618a364dc53a84cd5af2ac273b7d/src/qt/forms/intro.ui",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7d40a4805229618a364dc53a84cd5af2ac273b7d/src/qt/forms/intro.ui",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/forms/intro.ui?ref=7d40a4805229618a364dc53a84cd5af2ac273b7d",
        "patch": "@@ -219,6 +219,13 @@\n        </property>\n       </widget>\n      </item>\n+     <item>\n+      <widget class=\"QLabel\" name=\"lblPruneSuffix\">\n+       <property name=\"buddy\">\n+        <cstring>pruneGB</cstring>\n+       </property>\n+      </widget>\n+     </item>\n      <item>\n       <spacer name=\"horizontalSpacer_2\">\n        <property name=\"orientation\">"
      },
      {
        "sha": "394efb88546338edfa869ef06705c87d8f10cf74",
        "filename": "src/qt/intro.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 0,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7d40a4805229618a364dc53a84cd5af2ac273b7d/src/qt/intro.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7d40a4805229618a364dc53a84cd5af2ac273b7d/src/qt/intro.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/intro.cpp?ref=7d40a4805229618a364dc53a84cd5af2ac273b7d",
        "patch": "@@ -148,6 +148,7 @@ Intro::Intro(QWidget *parent, int64_t blockchain_size_gb, int64_t chain_state_si\n     }\n     ui->pruneGB->setValue(m_prune_target_gb);\n     ui->pruneGB->setToolTip(ui->prune->toolTip());\n+    ui->lblPruneSuffix->setToolTip(ui->prune->toolTip());\n     UpdatePruneLabels(ui->prune->isChecked());\n \n     connect(ui->prune, &QCheckBox::toggled, [this](bool prune_checked) {\n@@ -381,6 +382,9 @@ void Intro::UpdatePruneLabels(bool prune_checked)\n     }\n     ui->lblExplanation3->setVisible(prune_checked);\n     ui->pruneGB->setEnabled(prune_checked);\n+    static const uint64_t nPowTargetSpacing = 10 * 60;  // from chainparams, which we don't have at this stage\n+    static const uint32_t expected_block_data_size = 2250000;  // includes undo data\n+    ui->lblPruneSuffix->setText(tr(\"(sufficient to restore backups %n day(s) old)\", \"block chain pruning\", m_prune_target_gb * 1e9 / (uint64_t(expected_block_data_size) * 86400 / nPowTargetSpacing)));\n     ui->sizeWarningLabel->setText(\n         tr(\"%1 will download and store a copy of the Bitcoin block chain.\").arg(PACKAGE_NAME) + \" \" +\n         storageRequiresMsg.arg(m_required_space_gb) + \" \" +"
      }
    ]
  }
]