[
  {
    "sha": "318176aff1ded36d1fbc5977f288ac3bac1d8712",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozMTgxNzZhZmYxZGVkMzZkMWZiYzU5NzdmMjg4YWMzYmFjMWQ4NzEy",
    "commit": {
      "author": {
        "name": "Martin Zumsande",
        "email": "mzumsande@gmail.com",
        "date": "2021-07-28T21:48:34Z"
      },
      "committer": {
        "name": "Martin Zumsande",
        "email": "mzumsande@gmail.com",
        "date": "2021-08-02T19:24:12Z"
      },
      "message": "doc: Update high-level addrman description",
      "tree": {
        "sha": "01a2acbf57d404a868a01afcb9ba62ae8fbed106",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/01a2acbf57d404a868a01afcb9ba62ae8fbed106"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/318176aff1ded36d1fbc5977f288ac3bac1d8712",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/318176aff1ded36d1fbc5977f288ac3bac1d8712",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/318176aff1ded36d1fbc5977f288ac3bac1d8712",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/318176aff1ded36d1fbc5977f288ac3bac1d8712/comments",
    "author": {
      "login": "mzumsande",
      "id": 48763452,
      "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
      "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mzumsande",
      "html_url": "https://github.com/mzumsande",
      "followers_url": "https://api.github.com/users/mzumsande/followers",
      "following_url": "https://api.github.com/users/mzumsande/following{/other_user}",
      "gists_url": "https://api.github.com/users/mzumsande/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
      "organizations_url": "https://api.github.com/users/mzumsande/orgs",
      "repos_url": "https://api.github.com/users/mzumsande/repos",
      "events_url": "https://api.github.com/users/mzumsande/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mzumsande/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "mzumsande",
      "id": 48763452,
      "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
      "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mzumsande",
      "html_url": "https://github.com/mzumsande",
      "followers_url": "https://api.github.com/users/mzumsande/followers",
      "following_url": "https://api.github.com/users/mzumsande/following{/other_user}",
      "gists_url": "https://api.github.com/users/mzumsande/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
      "organizations_url": "https://api.github.com/users/mzumsande/orgs",
      "repos_url": "https://api.github.com/users/mzumsande/repos",
      "events_url": "https://api.github.com/users/mzumsande/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mzumsande/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "4b1fb50def0dea0cd320bc43c12d9a12edde0390",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4b1fb50def0dea0cd320bc43c12d9a12edde0390",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/4b1fb50def0dea0cd320bc43c12d9a12edde0390"
      }
    ],
    "stats": {
      "total": 18,
      "additions": 11,
      "deletions": 7
    },
    "files": [
      {
        "sha": "7e87457a9f4fddc7f1fbaba33a24a261a2fd3d56",
        "filename": "src/addrman.h",
        "status": "modified",
        "additions": 11,
        "deletions": 7,
        "changes": 18,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/318176aff1ded36d1fbc5977f288ac3bac1d8712/src/addrman.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/318176aff1ded36d1fbc5977f288ac3bac1d8712/src/addrman.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/addrman.h?ref=318176aff1ded36d1fbc5977f288ac3bac1d8712",
        "patch": "@@ -104,19 +104,23 @@ class CAddrInfo : public CAddress\n  *  * Make sure no (localized) attacker can fill the entire table with his nodes/addresses.\n  *\n  * To that end:\n- *  * Addresses are organized into buckets.\n- *    * Addresses that have not yet been tried go into 1024 \"new\" buckets.\n- *      * Based on the address range (/16 for IPv4) of the source of information, 64 buckets are selected at random.\n+ *  * Addresses are organized into buckets that can each store up to 64 entries.\n+ *    * Addresses to which our node has not successfully connected go into 1024 \"new\" buckets.\n+ *      * Based on the address range (/16 for IPv4) of the source of information, or if an asmap is provided,\n+ *        the AS it belongs to (for IPv4/IPv6), 64 buckets are selected at random.\n  *      * The actual bucket is chosen from one of these, based on the range in which the address itself is located.\n+ *      * The position in the bucket is chosen based on the full address.\n  *      * One single address can occur in up to 8 different buckets to increase selection chances for addresses that\n  *        are seen frequently. The chance for increasing this multiplicity decreases exponentially.\n- *      * When adding a new address to a full bucket, a randomly chosen entry (with a bias favoring less recently seen\n- *        ones) is removed from it first.\n+ *      * When adding a new address to an occupied position of a bucket, it will not replace the existing entry\n+ *        unless that address is also stored in another bucket or it doesn't meet one of several quality criteria\n+ *        (see IsTerrible for exact criteria).\n  *    * Addresses of nodes that are known to be accessible go into 256 \"tried\" buckets.\n  *      * Each address range selects at random 8 of these buckets.\n  *      * The actual bucket is chosen from one of these, based on the full address.\n- *      * When adding a new good address to a full bucket, a randomly chosen entry (with a bias favoring less recently\n- *        tried ones) is evicted from it, back to the \"new\" buckets.\n+ *      * When adding a new good address to an occupied position of a bucket, a FEELER connection to the\n+ *        old address is attempted. The old entry is only replaced and moved back to the \"new\" buckets if this\n+ *        attempt was unsuccessful.\n  *    * Bucket selection is based on cryptographic hashing, using a randomly-generated 256-bit key, which should not\n  *      be observable by adversaries.\n  *    * Several indexes are kept for high performance. Defining DEBUG_ADDRMAN will introduce frequent (and expensive)"
      }
    ]
  },
  {
    "sha": "036d7eadf5dd0e06e0734a5d78dbe28f4bfaa07f",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzowMzZkN2VhZGY1ZGQwZTA2ZTA3MzRhNWQ3OGRiZTI4ZjRiZmFhMDdm",
    "commit": {
      "author": {
        "name": "Amiti Uttarwar",
        "email": "amiti@uttarwar.org",
        "date": "2021-08-02T20:22:18Z"
      },
      "committer": {
        "name": "Martin Zumsande",
        "email": "mzumsande@gmail.com",
        "date": "2021-08-02T20:34:30Z"
      },
      "message": "doc: Correct description of CAddrMan::Create()\n\nCo-authored-by: Martin Zumsande <mzumsande@gmail.com>",
      "tree": {
        "sha": "580f0f42c32997781ccd22d7a919fea0c02bfa16",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/580f0f42c32997781ccd22d7a919fea0c02bfa16"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/036d7eadf5dd0e06e0734a5d78dbe28f4bfaa07f",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/036d7eadf5dd0e06e0734a5d78dbe28f4bfaa07f",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/036d7eadf5dd0e06e0734a5d78dbe28f4bfaa07f",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/036d7eadf5dd0e06e0734a5d78dbe28f4bfaa07f/comments",
    "author": {
      "login": "amitiuttarwar",
      "id": 1500952,
      "node_id": "MDQ6VXNlcjE1MDA5NTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1500952?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amitiuttarwar",
      "html_url": "https://github.com/amitiuttarwar",
      "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
      "following_url": "https://api.github.com/users/amitiuttarwar/following{/other_user}",
      "gists_url": "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
      "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
      "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
      "events_url": "https://api.github.com/users/amitiuttarwar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "mzumsande",
      "id": 48763452,
      "node_id": "MDQ6VXNlcjQ4NzYzNDUy",
      "avatar_url": "https://avatars.githubusercontent.com/u/48763452?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mzumsande",
      "html_url": "https://github.com/mzumsande",
      "followers_url": "https://api.github.com/users/mzumsande/followers",
      "following_url": "https://api.github.com/users/mzumsande/following{/other_user}",
      "gists_url": "https://api.github.com/users/mzumsande/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mzumsande/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mzumsande/subscriptions",
      "organizations_url": "https://api.github.com/users/mzumsande/orgs",
      "repos_url": "https://api.github.com/users/mzumsande/repos",
      "events_url": "https://api.github.com/users/mzumsande/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mzumsande/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "318176aff1ded36d1fbc5977f288ac3bac1d8712",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/318176aff1ded36d1fbc5977f288ac3bac1d8712",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/318176aff1ded36d1fbc5977f288ac3bac1d8712"
      }
    ],
    "stats": {
      "total": 3,
      "additions": 1,
      "deletions": 2
    },
    "files": [
      {
        "sha": "4f1d5e6bdfd306008a70bbf671da838461fe7877",
        "filename": "src/addrman.h",
        "status": "modified",
        "additions": 1,
        "deletions": 2,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/036d7eadf5dd0e06e0734a5d78dbe28f4bfaa07f/src/addrman.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/036d7eadf5dd0e06e0734a5d78dbe28f4bfaa07f/src/addrman.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/addrman.h?ref=036d7eadf5dd0e06e0734a5d78dbe28f4bfaa07f",
        "patch": "@@ -696,8 +696,7 @@ class CAddrMan\n     //! Find an entry.\n     CAddrInfo* Find(const CNetAddr& addr, int *pnId = nullptr) EXCLUSIVE_LOCKS_REQUIRED(cs);\n \n-    //! find an entry, creating it if necessary.\n-    //! nTime and nServices of the found node are updated, if necessary.\n+    //! Create a new entry and add it to the internal data structures mapInfo, mapAddr and vRandom.\n     CAddrInfo* Create(const CAddress &addr, const CNetAddr &addrSource, int *pnId = nullptr) EXCLUSIVE_LOCKS_REQUIRED(cs);\n \n     //! Swap two elements in vRandom."
      }
    ]
  }
]