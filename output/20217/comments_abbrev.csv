jnewbery,2020-10-22 12:36:06,Thanks for the review @MarcoFalke. I've taken your suggested name change.,https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-714463448,714463448,
practicalswift,2020-10-22 18:53:09,Concept ACK: globals going down is good!,https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-714692988,714692988,
DrahtBot,2020-10-22 22:42:26,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20541 (Move special CAddress-without-nTime logic to net_processing by sipa)\n* #20228 (addrman: Make addrman a top-level ",https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-714802431,714802431,
fanquake,2020-10-23 02:57:41,Concept ACK,https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-714876342,714876342,
jnewbery,2020-11-04 14:51:53,Rebased,https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-721778001,721778001,
sipa,2020-11-05 02:11:56,utACK 179616f8211883739df6e06852bd976dcdd0c3c9,https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-722080461,722080461,
narula,2020-11-14 23:07:31,"code review ACK. \n\nI was confused about the relationship between g_relay_txes (now m_ignore_incoming_txs) and m_tx_relay.  I think it's if m_tx_relay is null, this is a blocks-only peer, and if m_ignore_incoming_txs is true, I am a blocks-only peer. Is that right? I think unifying everything under names with ""blocks-only"" would be clearer but is out of scope for this change.",https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-727278496,727278496,
jnewbery,2020-11-16 10:08:02,"Yes, this has been confusing for people, which is why I think it's important to be precise with terminology:\n\n- a block-relay-only connection is a type of connection to a peer where we only send and process blocks. We do not send or process transactions or addresses to/from that peer. We'll request that the peer not send us transactions by setting `relay` to 0 in the `version` message that we ",https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-727876700,727876700,
narula,2020-11-16 17:09:24,"> * a block-relay-only connection is a type of connection to a peer where we only send and process blocks. We do not send or process transactions or addresses to/from that peer. We'll request that the peer not send us transactions by setting `relay` to 0 in the `version` message that we send to them. We also won't initialize the `m_tx_relay` data structure for that peer, since we're not doing tx r",https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-728197751,728197751,
jnewbery,2020-11-16 17:52:55,"> What is the difference between me being a -blocksonly node and me setting all of my connections to block-relay-only (let's hypothetically say you could)?\n\nSome differences:\n\n- block-relay-only isn't a configuration option. The user has no control over how many block-relay-only connections the node makes, or to which addresses.\n- in `-blocksonly` mode, we still participate in address re",https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-728223762,728223762,
narula,2020-11-16 19:29:07,"> > What is the difference between me being a -blocksonly node and me setting all of my connections to block-relay-only (let's hypothetically say you could)?\n> \n> Some differences:\n> \n> * block-relay-only isn't a configuration option. The user has no control over how many block-relay-only connections the node makes, or to which addresses.\n> * in `-blocksonly` mode, we still participate i",https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-728275457,728275457,
jnewbery,2020-11-19 11:20:10,"> I think I'm confused because the check for block-relay-only connections in the code is sometimes to see if m_tx_relay exists, which is non-intuitive because block-relay-only also implies that addrs are not gossiped with this peer either, not just transactions, and sometimes to call IsBlockOnlyConn().\n\n`IsBlockOnlyConn()` was added later, and I think is much clearer since it's instantly obvio",https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-730305922,730305922,
jnewbery,2020-11-19 14:50:22,Thanks @MarcoFalke. All good suggestions. I'll take them all if I need to rebase this.,https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-730425354,730425354,
jnewbery,2020-12-07 13:55:05,rebased,https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-739932773,739932773,
jnewbery,2020-12-07 18:17:46,@MarcoFalke addressed your review comments. Sorry for dropping them earlier.,https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-740091379,740091379,
MarcoFalke,2020-12-07 18:40:19,"re-ACK a21667ace8 üñ±\n\n<details><summary>Show signature and timestamp</summary>\n\nSignature:\n\n```\n-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA512\n\nre-ACK a21667ace8 üñ±\n-----BEGIN PGP SIGNATURE-----\n\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUhcBAwAqm9wdxwAE32mOhS0kcpLhVxGPmTuZ3Xwxca3DJNo20MX3qzUkmfG+izj\n0it+s6TycxiPR0EXKDutg3qWxUcu0Js2pAcYnYrNAbUx9",https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-740103648,740103648,
jnewbery,2020-12-09 11:37:01,rebased,https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-741716203,741716203,
jnewbery,2020-12-09 11:38:14,"At different times, this PR has had ACKs from @sipa @narula and @MarcoFalke. There have only been minor changes and rebases since those ACKs. Some reACKs at the same commit hash would be very appreciated!",https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-741716729,741716729,
MarcoFalke,2020-12-09 11:50:29,"re-ACK 22d960b124 ü•É\n\n<details><summary>Show signature and timestamp</summary>\n\nSignature:\n\n```\n-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA512\n\nre-ACK 22d960b124 ü•É\n-----BEGIN PGP SIGNATURE-----\n\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUjh9wv9GVZefOvKGq4C4k3P+5QHVrXbC5F9CYF6K/n+QKgIole9iTT5rRNT0C+o\nWHb2Q3I3cdyo8WirtL/pBytgn3wBKu1Ap2v4Wygzb1p9+",https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-741722239,741722239,
MarcoFalke,2020-12-09 14:39:56,needs rebase :dagger: ,https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-741814430,741814430,
jnewbery,2020-12-09 18:23:59,rebased,https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-741961223,741961223,
narula,2020-12-09 19:00:18,utACK 34e33ab8592d757b3acfe812c20d235029bbc319,https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-741981322,741981322,
MarcoFalke,2020-12-10 06:28:25,"re-ACK 34e33ab85 üíê\n\n<details><summary>Show signature and timestamp</summary>\n\nSignature:\n\n```\n-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA512\n\nre-ACK 34e33ab85 üíê\n-----BEGIN PGP SIGNATURE-----\n\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUjrNwwAhgjzJwknztCmt65CG19czsI/ftTRBzjJQ2dkkxI/DpPNtVRdzMyiDX7C\nkG7nZI+4PS2/DmzD46EwllFvndY3vLqVuGvr4I7/JIwAA49",https://github.com/bitcoin/bitcoin/pull/20217#issuecomment-742272409,742272409,
MarcoFalke,2020-10-22 11:53:51,"Any reason to change the name from relay_txes to blocks_only? With block-relay-only connections, I'd prefer to stick to the old name to avoid confusion.\n\nThe purpose is to ignore incoming inv and tx messages, so another name suggestion could be `ignore_incoming_tx_relay`, as outgoing tx relay is unaffected.",https://github.com/bitcoin/bitcoin/pull/20217#discussion_r510099354,510099354,src/init.cpp
MarcoFalke,2020-10-22 12:15:58,"```suggestion\n    /** Whether to ignore incoming tx relay traffic */\n```",https://github.com/bitcoin/bitcoin/pull/20217#discussion_r510111999,510111999,src/net_processing.h
jnewbery,2020-10-22 12:35:31,Done,https://github.com/bitcoin/bitcoin/pull/20217#discussion_r510124282,510124282,src/init.cpp
jnewbery,2020-10-22 12:35:39,Done,https://github.com/bitcoin/bitcoin/pull/20217#discussion_r510124382,510124382,src/net_processing.h
MarcoFalke,2020-11-19 13:06:19,"style-nit in commit 3b81ec59d15c17bb1c39eeb044c113117c41071d:\n\nCould add `{`",https://github.com/bitcoin/bitcoin/pull/20217#discussion_r526865207,526865207,src/net_processing.cpp
MarcoFalke,2020-11-19 13:06:46,style-nit in 2ebb63696b0bac6dd627551d44aa935b769d8bde: double space,https://github.com/bitcoin/bitcoin/pull/20217#discussion_r526865474,526865474,src/net_processing.h
MarcoFalke,2020-11-19 13:07:57,"style nit in 10182aaa5bb2521ef6836d9984806968d3f46b24: When changing this, I'd prefer to use `std::make_unique`, not the deprecated wrapper.",https://github.com/bitcoin/bitcoin/pull/20217#discussion_r526866182,526866182,src/init.cpp
MarcoFalke,2020-12-07 14:51:34,unrelated: Not sure what this comment is trying to say. Could remove in this pull?,https://github.com/bitcoin/bitcoin/pull/20217#discussion_r537567011,537567011,src/init.cpp
MarcoFalke,2020-12-07 14:56:47,has this been addressed?,https://github.com/bitcoin/bitcoin/pull/20217#discussion_r537571406,537571406,src/init.cpp
jnewbery,2020-12-07 14:59:54,done,https://github.com/bitcoin/bitcoin/pull/20217#discussion_r537573982,537573982,src/init.cpp
jnewbery,2020-12-07 18:09:49,I joined the lines since the if block is one line.,https://github.com/bitcoin/bitcoin/pull/20217#discussion_r537718858,537718858,src/net_processing.cpp
jnewbery,2020-12-07 18:11:36,Fixed,https://github.com/bitcoin/bitcoin/pull/20217#discussion_r537720015,537720015,src/net_processing.h
jnewbery,2020-12-07 18:17:15,Done,https://github.com/bitcoin/bitcoin/pull/20217#discussion_r537723706,537723706,src/init.cpp
