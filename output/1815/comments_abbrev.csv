BitcoinPullTester,2012-09-10T15:52:59Z,"Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/f518b2c39868eeacae871dc79a7f270736b984e8 for binaries and test log.\n",https://github.com/bitcoin/bitcoin/pull/1815#issuecomment-8427543,8427543,
laanwj,2012-09-11T05:37:12Z,I think it's best to a OPENBSD=1 option to the makefile for the OpenBSD-specific changes (unless there's a way to detect that automagically...).\n,https://github.com/bitcoin/bitcoin/pull/1815#issuecomment-8447633,8447633,
jrmithdobbs,2012-09-11T05:41:09Z,"They're not openbsd specific, they apply to both (and probably netbsd) platforms. The db thing is weird and can occur on other platforms from what I can tell.\n\nI moved the AI_ADDRCONFIG def into compat.h where it should be. Nice catch.\n",https://github.com/bitcoin/bitcoin/pull/1815#issuecomment-8447674,8447674,
laanwj,2012-09-11T05:42:29Z,BSD=1 then...\n,https://github.com/bitcoin/bitcoin/pull/1815#issuecomment-8447692,8447692,
jrmithdobbs,2012-09-11T05:43:40Z,"BSD is already a reserved define since BSD4.3. (It's a version number, i forget details of parsing it.)\n",https://github.com/bitcoin/bitcoin/pull/1815#issuecomment-8447702,8447702,
jrmithdobbs,2012-09-11T05:47:26Z,"The pthread_np.h header stands for ""non portable,"" I know that function exists on those two platforms in the expected form, I don't know if there's something better to key off of for it.\n",https://github.com/bitcoin/bitcoin/pull/1815#issuecomment-8447760,8447760,
jrmithdobbs,2012-09-11T06:08:22Z,Cleaned up and clarified some comments.\n,https://github.com/bitcoin/bitcoin/pull/1815#issuecomment-8448067,8448067,
laanwj,2012-09-11T06:15:57Z,"I don't really care _what_ specific flag you use, but you should put the OBSD specific changes (especially the -ldl) behind some flag so that build on Linux is unaffected.\n",https://github.com/bitcoin/bitcoin/pull/1815#issuecomment-8448162,8448162,
jrmithdobbs,2012-09-11T06:22:29Z,"The stuff in the makefile doesn't have access to the things that define things like _____FreeBSD_____, etc since they're in included headers is the bigger problem. I'm trying to hack it in as cleanly as possible without resorting to autotools because that's a big change. (and last time that got left to rot when jaromil did it)\n\nTrying to make as few changes as possible to attempt to get this fix",https://github.com/bitcoin/bitcoin/pull/1815#issuecomment-8448266,8448266,
BitcoinPullTester,2012-09-12T03:56:15Z,"Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/e56b181ffc35c6eaf488fd09fc0948c2ea722158 for binaries and test log.\n",https://github.com/bitcoin/bitcoin/pull/1815#issuecomment-8481308,8481308,
jgarzik,2012-11-16T02:40:31Z,"ACK, seems sane, needs rebase.\n\nMaybe HAVE_CXX_STDHEADERS should be conditionalized for the platforms that need it.\n",https://github.com/bitcoin/bitcoin/pull/1815#issuecomment-10434754,10434754,
luke-jr,2013-04-08T05:32:01Z,Needs rebase.\n,https://github.com/bitcoin/bitcoin/pull/1815#issuecomment-16033246,16033246,
jgarzik,2013-05-30T17:05:13Z,"Closing due to inattention.  If you want to rebase, feel free to re-open.\n",https://github.com/bitcoin/bitcoin/pull/1815#issuecomment-18694319,18694319,
luke-jr,2012-09-11T05:27:26Z,Maybe just\n`#define AI_ADDRCONFIG 0`\n?\n,https://github.com/bitcoin/bitcoin/pull/1815#discussion_r1573395,1573395,src/netbase.cpp
laanwj,2012-09-11T05:32:38Z,"You could add (#ifndef AI_ADDRCONFIG #define AI_ADDRCONFIG 0) to compat.h, it has other such special cases.\n",https://github.com/bitcoin/bitcoin/pull/1815#discussion_r1573411,1573411,src/netbase.cpp
laanwj,2012-09-11T05:33:51Z,"Shouldn't we add it only for openbsd, then?\n",https://github.com/bitcoin/bitcoin/pull/1815#discussion_r1573414,1573414,src/makefile.unix
laanwj,2012-09-11T05:34:49Z,"Don't remove this, it's required for static builds !\n",https://github.com/bitcoin/bitcoin/pull/1815#discussion_r1573418,1573418,src/makefile.unix
jrmithdobbs,2012-09-11T05:39:07Z,"If that def isn't valid, bitcoin wont build correctly anyways. It just implies using #include iostream vs #include iostream.h and similar.\n\nGithub wont let me put the angle brackets in the comment for whatever reason, annoying.\n\nThis is more related to us not using autotools than anything.\n",https://github.com/bitcoin/bitcoin/pull/1815#discussion_r1573428,1573428,src/makefile.unix
jrmithdobbs,2012-09-11T05:42:56Z,Suggestions? This breaks all *BSD builds and works on everything for non-static builds.\n,https://github.com/bitcoin/bitcoin/pull/1815#discussion_r1573443,1573443,src/makefile.unix
laanwj,2012-09-11T05:46:22Z,Yes a cmake or autotools build system would be great. Feel free to contribute that instead :)\n,https://github.com/bitcoin/bitcoin/pull/1815#discussion_r1573454,1573454,src/makefile.unix
laanwj,2012-09-11T05:47:39Z,I suppose you could do\n\n```\nifdef STATIC\nLIBS += -l dl\nendif\n```\n,https://github.com/bitcoin/bitcoin/pull/1815#discussion_r1573456,1573456,src/makefile.unix
jrmithdobbs,2012-09-11T05:48:55Z,"No, I mean the db headers seem to assume you're using auto tools. Since that's a (previously un-codified) req for building the rest of bitcoin any how I don't see how it hurts to just define it like we do the boost threading defines.\n",https://github.com/bitcoin/bitcoin/pull/1815#discussion_r1573460,1573460,src/makefile.unix
jrmithdobbs,2012-09-11T05:54:20Z,"I like that better but it actually doesn't work on *BSD at all. -ldl is part of libc. I can successfully build statically on open/freebsd as is without adding it back in.\n\nTo clarify, there _isn't_ an -ldl on these systems at all. That's a linuxism. afaik\n",https://github.com/bitcoin/bitcoin/pull/1815#discussion_r1573473,1573473,src/makefile.unix
laanwj,2012-09-11T06:14:55Z,"Yes, that's a linuxism. That's it's best to add a build flag for BSD-ish systems. Make is not smart enough to auto-detect such details about the system.\n",https://github.com/bitcoin/bitcoin/pull/1815#discussion_r1573521,1573521,src/makefile.unix
jrmithdobbs,2012-09-11T06:17:20Z,"Maybe add a new environment variable for determining if this is necessary?\n\nFor example (above the -l z -l pthread def):\n\nifeq($(LMODE2), dynamic)\n  ifdef NEEDS_DL\n    LIBS += -l dl\n  endif\nendif\n\n...\n\nalternatively that could be ifndef BSD_SOURCE ... but that means you'd have to give the bsd flag when/if anyone ever gets to porting to solaris/aix/ux which seems quite counterintuitive.",https://github.com/bitcoin/bitcoin/pull/1815#discussion_r1573526,1573526,src/makefile.unix
luke-jr,2012-09-11T06:24:30Z,GNU Make at least is smart enough; does BSD Make not have $(shell ...)?\n,https://github.com/bitcoin/bitcoin/pull/1815#discussion_r1573546,1573546,src/makefile.unix
jrmithdobbs,2012-09-11T06:30:26Z,"This requires gmake as is any how, see build examples. :)\n\n$(shell ...) is just .... ugly\n\nI guess\n\nifeq($(LMODE2), dynamic)\n  ifeq($(shell uname -s), Linux)\n.....\n\nWould be another option?\n",https://github.com/bitcoin/bitcoin/pull/1815#discussion_r1573556,1573556,src/makefile.unix
luke-jr,2012-09-11T06:34:50Z,Is libdl really a Linux-specific thing? I'd think if anything it'd be GNU-specific - so still needed on Debian GNU/kFreeBSD?\n,https://github.com/bitcoin/bitcoin/pull/1815#discussion_r1573568,1573568,src/makefile.unix
jrmithdobbs,2012-09-11T06:39:11Z,Good question. I'm not sure. Does anyone actually have a debian bastardized kfreebsd system to test on?\n,https://github.com/bitcoin/bitcoin/pull/1815#discussion_r1573589,1573589,src/makefile.unix
jrmithdobbs,2012-09-11T07:14:51Z,"I did want to note that I discussed removing the -ldl with gmaxwell / sipa and a few others before submitting this pull.\n\nAre static builds still being used? They not for the official binaries, to my understanding at least.\n",https://github.com/bitcoin/bitcoin/pull/1815#discussion_r1573769,1573769,src/makefile.unix
laanwj,2012-09-11T07:39:19Z,"Yes, static builds are being used. And libdl is not only linux. I'm on a solaris system right now that has it.\n",https://github.com/bitcoin/bitcoin/pull/1815#discussion_r1573870,1573870,src/makefile.unix
jrmithdobbs,2013-04-08T07:36:53Z,Does anyone know of a good way to tell whether a platform needs -ldl ? pkg-config maybe?\n,https://github.com/bitcoin/bitcoin/pull/1815#discussion_r3689661,3689661,src/makefile.unix
