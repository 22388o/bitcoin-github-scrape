DrahtBot,2020-06-17 23:18:08,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19335 (wallet: Cleanup and separate BerkeleyDatabase and BerkeleyBatch by achow101)\n* #19334 (wallet: Introduce WalletDa",https://github.com/bitcoin/bitcoin/pull/19308#issuecomment-645675131,645675131,
laanwj,2020-06-18 14:49:25,"This does limit flexibility a bit, though I guess one cursor at a time is enough for all our current and future use cases.",https://github.com/bitcoin/bitcoin/pull/19308#issuecomment-646068957,646068957,
achow101,2020-06-18 14:58:28,"> This does limit flexibility a bit, though I guess one cursor at a time is enough for all our current and future use cases.\n\nIf another cursor was needed, you could use another Batch object. But we barely use cursors, so one is enough for now.",https://github.com/bitcoin/bitcoin/pull/19308#issuecomment-646075489,646075489,
laanwj,2020-06-18 15:03:59,"> If another cursor was needed, you could use another Batch object. But we barely use cursors, so one is enough for now.\n\nOhh! I missed that it's on the batch, not on the database object.",https://github.com/bitcoin/bitcoin/pull/19308#issuecomment-646079286,646079286,
laanwj,2020-06-18 14:48:40,Nit: coding style `} else if (!ret) {`,https://github.com/bitcoin/bitcoin/pull/19308#discussion_r442285323,442285323,src/wallet/walletdb.cpp
laanwj,2020-06-18 14:55:50,"I think `StartCursor` would be a better name, after all, the whole process (including details like whether something is created) is internal.",https://github.com/bitcoin/bitcoin/pull/19308#discussion_r442290726,442290726,src/wallet/bdb.cpp
achow101,2020-06-18 14:57:28,Fixed.,https://github.com/bitcoin/bitcoin/pull/19308#discussion_r442291942,442291942,src/wallet/walletdb.cpp
ryanofsky,2020-06-18 20:49:08,"In commit ""walletdb: Handle cursor internally"" (cda86544ae9de430e4558b87945046d5612202ac)\n\nMinor: I think it'd be a little clearer to keep this close here as m_batch.CloseCursor() so it's more obvious cursor is closed in all cases, and so you don't need to add a new close call in a different place above.",https://github.com/bitcoin/bitcoin/pull/19308#discussion_r442494190,442494190,src/wallet/walletdb.cpp
promag,2020-06-21 22:41:13,"nit, just `return ret == 0`.",https://github.com/bitcoin/bitcoin/pull/19308#discussion_r443263535,443263535,src/wallet/bdb.cpp
promag,2020-06-21 23:12:38,"But above, in https://github.com/bitcoin/bitcoin/pull/19308/files#diff-e506682270036e4c8e0b8159a34b652dR723, it returns so it needs to be closed there, or am I missing something?",https://github.com/bitcoin/bitcoin/pull/19308#discussion_r443265733,443265733,src/wallet/walletdb.cpp
achow101,2020-06-22 19:43:44,Renamed to `StartCursor`.,https://github.com/bitcoin/bitcoin/pull/19308#discussion_r443785276,443785276,src/wallet/bdb.cpp
achow101,2020-06-22 19:45:29,I've moved it to after the `catch` block and removed the ones inside the loop except for the ones right before the early return.,https://github.com/bitcoin/bitcoin/pull/19308#discussion_r443786075,443786075,src/wallet/walletdb.cpp
promag,2020-06-22 21:33:26,`assert(m_cursor)`? There was no check for `pcursor`.,https://github.com/bitcoin/bitcoin/pull/19308#discussion_r443838828,443838828,src/wallet/bdb.cpp
promag,2020-06-22 21:33:43,"nit, move these to header.",https://github.com/bitcoin/bitcoin/pull/19308#discussion_r443838936,443838936,src/wallet/bdb.cpp
achow101,2020-06-22 22:39:52,Done,https://github.com/bitcoin/bitcoin/pull/19308#discussion_r443863984,443863984,src/wallet/bdb.cpp
achow101,2020-06-22 22:40:37,I don't think an assert is necessary.,https://github.com/bitcoin/bitcoin/pull/19308#discussion_r443864251,443864251,src/wallet/bdb.cpp
achow101,2020-06-22 22:42:52,I'm pretty sure that won't compile.,https://github.com/bitcoin/bitcoin/pull/19308#discussion_r443864917,443864917,src/wallet/bdb.cpp
promag,2020-06-22 22:51:34,I mean 04998ef3cb866b2371bb047a5091787f61692588.,https://github.com/bitcoin/bitcoin/pull/19308#discussion_r443867602,443867602,src/wallet/bdb.cpp
achow101,2020-06-22 23:08:16,Ah. Maybe if I have to push again.,https://github.com/bitcoin/bitcoin/pull/19308#discussion_r443872725,443872725,src/wallet/bdb.cpp
promag,2020-06-23 09:31:16,"If it's something that can't happen then an assertion is fine. Also, it means that `StartCursor` must be called before.",https://github.com/bitcoin/bitcoin/pull/19308#discussion_r444090941,444090941,src/wallet/bdb.cpp
achow101,2020-06-23 15:41:51,If I have to push again.,https://github.com/bitcoin/bitcoin/pull/19308#discussion_r444322405,444322405,src/wallet/bdb.cpp
