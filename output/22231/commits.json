[
  {
    "sha": "32aad05fe88f12bf7ff5ce3acb62e6f06d944bac",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozMmFhZDA1ZmU4OGYxMmJmN2ZmNWNlM2FjYjYyZTZmMDZkOTQ0YmFj",
    "commit": {
      "author": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2021-06-12T20:02:49Z"
      },
      "committer": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2021-07-22T17:55:27Z"
      },
      "message": "refactor: Separate AppInitStartClients from AppInitMain\n\nThis change allows to make the GUI startup process more granular, and,\neventually, to move the appInitStartClients call from\nBitcoinCore::initialize into another thread with better user feedback.\n\nNo behavior change.",
      "tree": {
        "sha": "cf661d02482d1da7832155a00d615bca898e3d10",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/cf661d02482d1da7832155a00d615bca898e3d10"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/32aad05fe88f12bf7ff5ce3acb62e6f06d944bac",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE0dvyxLlvLev0wWZUQQEIES5+qB8FAmD5sQ8ACgkQQQEIES5+\nqB+T9g//dcqIUKomYrFFV2iiWnYRIkzF2uHIebwpHHQlOYOVWWdbQYBtVQyrNxxw\nNwkdU5Qy+HEaNCGJ+/af6HdloZpqjj8e3gUmFqlJJY3MEzfK19yMi1h+eJyYOsax\nJcDOtdy9PtJzDPQvXfxyPZiXC2SKkVqPiVJOHNNFYIC3SGWZNOW/HsydSeWfrVv0\n3DK7DZyD5SGfVHEkjbrFlQJnR1bwdESJAJMuiqD5sVD4Dg3BEdaHxJsG2dvMii+i\nvsCg/fCtRIh7ZkkrslC7iRumx/8jde341QxxDFahDseGb4ens7dwlGeLrVuX0c2+\nAdrgAkZ5DHr3PzHA9/xtVzvEMLXVHUrjl5DO2DJVL5xkh9vmC6/YABCX36tSsWVX\nNW8R8X4vDEz6swbGTQdwjprzgmCyG67oaMu5Im2Oz/iJt4/UIWtXk0y9PXunpFdr\nhvZnOYMz3cZ6bNfRvPj1kIx91FrunMcQosIR+RyyyZvF3Wlk42SMbd/P8yriUW3t\nFaDmSGEQvvQasECMuZDiUDaFh+b0utsOT5Nw1oCyty+rawse3Qy34WeJG+RNK05G\nQPd9x0awXnnhhLNoJ5P8kJPJ3yFyww6pR++5lVhcw7XvnI+1gOvBtURikR/07ble\n5kPiMHYQhvscs2oVzj0U/fjMtwO2IVV+Wh7UNY4oOVthW05Ihg0=\n=2YJ0\n-----END PGP SIGNATURE-----",
        "payload": "tree cf661d02482d1da7832155a00d615bca898e3d10\nparent 5d83e7d714e0b7cafeb2f14892184a9607cb55dc\nauthor Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1623528169 +0300\ncommitter Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1626976527 +0300\n\nrefactor: Separate AppInitStartClients from AppInitMain\n\nThis change allows to make the GUI startup process more granular, and,\neventually, to move the appInitStartClients call from\nBitcoinCore::initialize into another thread with better user feedback.\n\nNo behavior change.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/32aad05fe88f12bf7ff5ce3acb62e6f06d944bac",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/32aad05fe88f12bf7ff5ce3acb62e6f06d944bac",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/32aad05fe88f12bf7ff5ce3acb62e6f06d944bac/comments",
    "author": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "5d83e7d714e0b7cafeb2f14892184a9607cb55dc",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/5d83e7d714e0b7cafeb2f14892184a9607cb55dc",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/5d83e7d714e0b7cafeb2f14892184a9607cb55dc"
      }
    ],
    "stats": {
      "total": 31,
      "additions": 27,
      "deletions": 4
    },
    "files": [
      {
        "sha": "f2387ab00f1ac5490dd4b6cc36a7940c7df81475",
        "filename": "src/bitcoind.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/32aad05fe88f12bf7ff5ce3acb62e6f06d944bac/src/bitcoind.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/32aad05fe88f12bf7ff5ce3acb62e6f06d944bac/src/bitcoind.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoind.cpp?ref=32aad05fe88f12bf7ff5ce3acb62e6f06d944bac",
        "patch": "@@ -224,6 +224,9 @@ static bool AppInit(NodeContext& node, int argc, char* argv[])\n             return false;\n         }\n         fRet = AppInitInterfaces(node) && AppInitMain(node);\n+        if (fRet) {\n+            AppInitStartClients(node);\n+        }\n     }\n     catch (const std::exception& e) {\n         PrintExceptionContinue(&e, \"AppInit()\");"
      },
      {
        "sha": "6bf07e82274d48b4e6314a51456dde0cbc98f602",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 4,
        "changes": 11,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/32aad05fe88f12bf7ff5ce3acb62e6f06d944bac/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/32aad05fe88f12bf7ff5ce3acb62e6f06d944bac/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=32aad05fe88f12bf7ff5ce3acb62e6f06d944bac",
        "patch": "@@ -1780,10 +1780,6 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     SetRPCWarmupFinished();\n     uiInterface.InitMessage(_(\"Done loading\").translated);\n \n-    for (const auto& client : node.chain_clients) {\n-        client->start(*node.scheduler);\n-    }\n-\n     BanMan* banman = node.banman.get();\n     node.scheduler->scheduleEvery([banman]{\n         banman->DumpBanlist();\n@@ -1795,3 +1791,10 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n     return true;\n }\n+\n+void AppInitStartClients(NodeContext& node)\n+{\n+    for (const auto& client : node.chain_clients) {\n+        client->start(*node.scheduler);\n+    }\n+}"
      },
      {
        "sha": "c396cd076d023218b34d82fe60ce0a8bb1a8dc7b",
        "filename": "src/init.h",
        "status": "modified",
        "additions": 5,
        "deletions": 0,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/32aad05fe88f12bf7ff5ce3acb62e6f06d944bac/src/init.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/32aad05fe88f12bf7ff5ce3acb62e6f06d944bac/src/init.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.h?ref=32aad05fe88f12bf7ff5ce3acb62e6f06d944bac",
        "patch": "@@ -63,6 +63,11 @@ bool AppInitInterfaces(NodeContext& node);\n  */\n bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info = nullptr);\n \n+/**\n+ * Start execution of chain clients (e.g., wallets).\n+ */\n+void AppInitStartClients(NodeContext& node);\n+\n /**\n  * Register all arguments with the ArgsManager\n  */"
      },
      {
        "sha": "3cc25d751008e78d71058ade1efea1bbbb900d23",
        "filename": "src/interfaces/node.h",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/32aad05fe88f12bf7ff5ce3acb62e6f06d944bac/src/interfaces/node.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/32aad05fe88f12bf7ff5ce3acb62e6f06d944bac/src/interfaces/node.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/interfaces/node.h?ref=32aad05fe88f12bf7ff5ce3acb62e6f06d944bac",
        "patch": "@@ -74,6 +74,9 @@ class Node\n     //! Start node.\n     virtual bool appInitMain(interfaces::BlockAndHeaderTipInfo* tip_info = nullptr) = 0;\n \n+    //! Start execution of chain clients (e.g., wallets).\n+    virtual void appInitStartClients() = 0;\n+\n     //! Stop node.\n     virtual void appShutdown() = 0;\n "
      },
      {
        "sha": "94a7d37e7a24156d75c9c0189e01bd608536aaa8",
        "filename": "src/node/interfaces.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 0,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/32aad05fe88f12bf7ff5ce3acb62e6f06d944bac/src/node/interfaces.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/32aad05fe88f12bf7ff5ce3acb62e6f06d944bac/src/node/interfaces.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/node/interfaces.cpp?ref=32aad05fe88f12bf7ff5ce3acb62e6f06d944bac",
        "patch": "@@ -86,6 +86,12 @@ class NodeImpl : public Node\n     {\n         return AppInitMain(*m_context, tip_info);\n     }\n+\n+    void appInitStartClients() override\n+    {\n+        AppInitStartClients(*m_context);\n+    }\n+\n     void appShutdown() override\n     {\n         Interrupt(*m_context);"
      },
      {
        "sha": "ce416035f829e2ad2da05ff998f03c68896b044e",
        "filename": "src/qt/initexecutor.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/32aad05fe88f12bf7ff5ce3acb62e6f06d944bac/src/qt/initexecutor.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/32aad05fe88f12bf7ff5ce3acb62e6f06d944bac/src/qt/initexecutor.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/initexecutor.cpp?ref=32aad05fe88f12bf7ff5ce3acb62e6f06d944bac",
        "patch": "@@ -43,6 +43,9 @@ void InitExecutor::initialize()\n         qDebug() << __func__ << \": Running initialization in thread\";\n         interfaces::BlockAndHeaderTipInfo tip_info;\n         bool rv = m_node.appInitMain(&tip_info);\n+        if (rv) {\n+            m_node.appInitStartClients();\n+        }\n         Q_EMIT initializeResult(rv, tip_info);\n     } catch (const std::exception& e) {\n         handleRunawayException(&e);"
      }
    ]
  }
]