[
  {
    "sha": "f8ca8c5c28d3050b780e67d47a50ac65fc2dc3ad",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmOGNhOGM1YzI4ZDMwNTBiNzgwZTY3ZDQ3YTUwYWM2NWZjMmRjM2Fk",
    "commit": {
      "author": {
        "name": "Carl Dong",
        "email": "contact@carldong.me",
        "date": "2021-02-04T18:50:47Z"
      },
      "committer": {
        "name": "Carl Dong",
        "email": "contact@carldong.me",
        "date": "2021-02-18T19:29:42Z"
      },
      "message": "guix: Supply --keep-failed for debugging",
      "tree": {
        "sha": "4d5660016b7df0cfaed05e0dce38a621b88208bf",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4d5660016b7df0cfaed05e0dce38a621b88208bf"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f8ca8c5c28d3050b780e67d47a50ac65fc2dc3ad",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f8ca8c5c28d3050b780e67d47a50ac65fc2dc3ad",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/f8ca8c5c28d3050b780e67d47a50ac65fc2dc3ad",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f8ca8c5c28d3050b780e67d47a50ac65fc2dc3ad/comments",
    "author": {
      "login": "dongcarl",
      "id": 3445290,
      "node_id": "MDQ6VXNlcjM0NDUyOTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dongcarl",
      "html_url": "https://github.com/dongcarl",
      "followers_url": "https://api.github.com/users/dongcarl/followers",
      "following_url": "https://api.github.com/users/dongcarl/following{/other_user}",
      "gists_url": "https://api.github.com/users/dongcarl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
      "organizations_url": "https://api.github.com/users/dongcarl/orgs",
      "repos_url": "https://api.github.com/users/dongcarl/repos",
      "events_url": "https://api.github.com/users/dongcarl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dongcarl/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "dongcarl",
      "id": 3445290,
      "node_id": "MDQ6VXNlcjM0NDUyOTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dongcarl",
      "html_url": "https://github.com/dongcarl",
      "followers_url": "https://api.github.com/users/dongcarl/followers",
      "following_url": "https://api.github.com/users/dongcarl/following{/other_user}",
      "gists_url": "https://api.github.com/users/dongcarl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
      "organizations_url": "https://api.github.com/users/dongcarl/orgs",
      "repos_url": "https://api.github.com/users/dongcarl/repos",
      "events_url": "https://api.github.com/users/dongcarl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dongcarl/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "b805dbb0b9c90dadef0424e5b3bf86ac308e103e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b805dbb0b9c90dadef0424e5b3bf86ac308e103e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/b805dbb0b9c90dadef0424e5b3bf86ac308e103e"
      }
    ],
    "stats": {
      "total": 8,
      "additions": 8,
      "deletions": 0
    },
    "files": [
      {
        "sha": "132627a62a47e751a69632ae52ca8c7938a151b2",
        "filename": "contrib/guix/guix-build.sh",
        "status": "modified",
        "additions": 8,
        "deletions": 0,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f8ca8c5c28d3050b780e67d47a50ac65fc2dc3ad/contrib/guix/guix-build.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f8ca8c5c28d3050b780e67d47a50ac65fc2dc3ad/contrib/guix/guix-build.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/guix/guix-build.sh?ref=f8ca8c5c28d3050b780e67d47a50ac65fc2dc3ad",
        "patch": "@@ -150,6 +150,7 @@ time-machine() {\n     guix time-machine --url=https://github.com/dongcarl/guix.git \\\n                       --commit=b066c25026f21fb57677aa34692a5034338e7ee3 \\\n                       --max-jobs=\"$MAX_JOBS\" \\\n+                      --keep-failed \\\n                       ${SUBSTITUTE_URLS:+--substitute-urls=\"$SUBSTITUTE_URLS\"} \\\n                       ${ADDITIONAL_GUIX_COMMON_FLAGS} ${ADDITIONAL_GUIX_TIMEMACHINE_FLAGS} \\\n                       -- \"$@\"\n@@ -259,6 +260,12 @@ EOF\n         #     make the downloaded depends sources available to it. The sources\n         #     should have been downloaded prior to this invocation.\n         #\n+        #   --keep-failed     keep build tree of failed builds\n+        #\n+        #     When builds of the Guix environment itself (not Bitcoin Core)\n+        #     fail, it is useful for the build tree to be kept for debugging\n+        #     purposes.\n+        #\n         #  ${SUBSTITUTE_URLS:+--substitute-urls=\"$SUBSTITUTE_URLS\"}\n         #\n         #                     fetch substitute from SUBSTITUTE_URLS if they are\n@@ -281,6 +288,7 @@ EOF\n                                  ${SOURCES_PATH:+--share=\"$SOURCES_PATH\"} \\\n                                  ${BASE_CACHE:+--share=\"$BASE_CACHE\"} \\\n                                  --max-jobs=\"$MAX_JOBS\" \\\n+                                 --keep-failed \\\n                                  ${SUBSTITUTE_URLS:+--substitute-urls=\"$SUBSTITUTE_URLS\"} \\\n                                  ${ADDITIONAL_GUIX_COMMON_FLAGS} ${ADDITIONAL_GUIX_ENVIRONMENT_FLAGS} \\\n                                  -- env HOST=\"$host\" \\"
      }
    ]
  },
  {
    "sha": "d02076b8852d8faae95cee6e3de434460c07412a",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkMDIwNzZiODg1MmQ4ZmFhZTk1Y2VlNmUzZGU0MzQ0NjBjMDc0MTJh",
    "commit": {
      "author": {
        "name": "Carl Dong",
        "email": "contact@carldong.me",
        "date": "2021-02-04T18:52:51Z"
      },
      "committer": {
        "name": "Carl Dong",
        "email": "contact@carldong.me",
        "date": "2021-02-18T19:29:42Z"
      },
      "message": "guix: Jump forwards in time-machine and adapt\n\nThe new time-machine commit is Guix v1.2.0 with a yet-unupstreamed patch\nfor NSIS.\n\nA few important changes:\n\n1. Guix switched back from using CPATH to C{,PLUS}_INCLUDE_PATH as the\n   way to indicate #include search paths.\n2. GCC's library is now split into a separate output, whereas before it\n   was included in the default output. This means that our gcc toolchain\n   packages need to propagate that output.\n3. A few package versions were bumped",
      "tree": {
        "sha": "19ea33f960a178f9314a1def292edf7affe96f04",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/19ea33f960a178f9314a1def292edf7affe96f04"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d02076b8852d8faae95cee6e3de434460c07412a",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d02076b8852d8faae95cee6e3de434460c07412a",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/d02076b8852d8faae95cee6e3de434460c07412a",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d02076b8852d8faae95cee6e3de434460c07412a/comments",
    "author": {
      "login": "dongcarl",
      "id": 3445290,
      "node_id": "MDQ6VXNlcjM0NDUyOTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dongcarl",
      "html_url": "https://github.com/dongcarl",
      "followers_url": "https://api.github.com/users/dongcarl/followers",
      "following_url": "https://api.github.com/users/dongcarl/following{/other_user}",
      "gists_url": "https://api.github.com/users/dongcarl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
      "organizations_url": "https://api.github.com/users/dongcarl/orgs",
      "repos_url": "https://api.github.com/users/dongcarl/repos",
      "events_url": "https://api.github.com/users/dongcarl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dongcarl/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "dongcarl",
      "id": 3445290,
      "node_id": "MDQ6VXNlcjM0NDUyOTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dongcarl",
      "html_url": "https://github.com/dongcarl",
      "followers_url": "https://api.github.com/users/dongcarl/followers",
      "following_url": "https://api.github.com/users/dongcarl/following{/other_user}",
      "gists_url": "https://api.github.com/users/dongcarl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
      "organizations_url": "https://api.github.com/users/dongcarl/orgs",
      "repos_url": "https://api.github.com/users/dongcarl/repos",
      "events_url": "https://api.github.com/users/dongcarl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dongcarl/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "f8ca8c5c28d3050b780e67d47a50ac65fc2dc3ad",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f8ca8c5c28d3050b780e67d47a50ac65fc2dc3ad",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/f8ca8c5c28d3050b780e67d47a50ac65fc2dc3ad"
      }
    ],
    "stats": {
      "total": 24,
      "additions": 15,
      "deletions": 9
    },
    "files": [
      {
        "sha": "f29ea9b91055b06007a82014cac41f485ab35b52",
        "filename": "contrib/guix/guix-build.sh",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d02076b8852d8faae95cee6e3de434460c07412a/contrib/guix/guix-build.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d02076b8852d8faae95cee6e3de434460c07412a/contrib/guix/guix-build.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/guix/guix-build.sh?ref=d02076b8852d8faae95cee6e3de434460c07412a",
        "patch": "@@ -148,7 +148,7 @@ SOURCE_DATE_EPOCH=\"${SOURCE_DATE_EPOCH:-$(git log --format=%at -1)}\"\n time-machine() {\n     # shellcheck disable=SC2086\n     guix time-machine --url=https://github.com/dongcarl/guix.git \\\n-                      --commit=b066c25026f21fb57677aa34692a5034338e7ee3 \\\n+                      --commit=7d6bd44da57926e0d4af25eba723a61c82beef98 \\\n                       --max-jobs=\"$MAX_JOBS\" \\\n                       --keep-failed \\\n                       ${SUBSTITUTE_URLS:+--substitute-urls=\"$SUBSTITUTE_URLS\"} \\"
      },
      {
        "sha": "24bc30e33081c48cbe48f914ab9e8a921be1aa63",
        "filename": "contrib/guix/libexec/build.sh",
        "status": "modified",
        "additions": 8,
        "deletions": 4,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d02076b8852d8faae95cee6e3de434460c07412a/contrib/guix/libexec/build.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d02076b8852d8faae95cee6e3de434460c07412a/contrib/guix/libexec/build.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/guix/libexec/build.sh?ref=d02076b8852d8faae95cee6e3de434460c07412a",
        "patch": "@@ -44,6 +44,8 @@ store_path() {\n NATIVE_GCC=\"$(store_path gcc-toolchain)\"\n export LIBRARY_PATH=\"${NATIVE_GCC}/lib:${NATIVE_GCC}/lib64\"\n export CPATH=\"${NATIVE_GCC}/include\"\n+unset C_INCLUDE_PATH\n+unset CPLUS_INCLUDE_PATH\n case \"$HOST\" in\n     *darwin*)\n         # When targeting darwin, some native tools built by depends require\n@@ -66,7 +68,8 @@ case \"$HOST\" in\n         # Determine output paths to use in CROSS_* environment variables\n         CROSS_GLIBC=\"$(store_path \"mingw-w64-x86_64-winpthreads\")\"\n         CROSS_GCC=\"$(store_path \"gcc-cross-${HOST}\")\"\n-        CROSS_GCC_LIBS=( \"${CROSS_GCC}/lib/gcc/${HOST}\"/* ) # This expands to an array of directories...\n+        CROSS_GCC_LIB_STORE=\"$(store_path \"gcc-cross-${HOST}\" lib)\"\n+        CROSS_GCC_LIBS=( \"${CROSS_GCC_LIB_STORE}/lib/gcc/${HOST}\"/* ) # This expands to an array of directories...\n         CROSS_GCC_LIB=\"${CROSS_GCC_LIBS[0]}\" # ...we just want the first one (there should only be one)\n \n         # The search path ordering is generally:\n@@ -75,7 +78,7 @@ case \"$HOST\" in\n         #    2. kernel-header-related search paths (not applicable to mingw-w64 hosts)\n         export CROSS_C_INCLUDE_PATH=\"${CROSS_GCC_LIB}/include:${CROSS_GCC_LIB}/include-fixed:${CROSS_GLIBC}/include\"\n         export CROSS_CPLUS_INCLUDE_PATH=\"${CROSS_GCC}/include/c++:${CROSS_GCC}/include/c++/${HOST}:${CROSS_GCC}/include/c++/backward:${CROSS_C_INCLUDE_PATH}\"\n-        export CROSS_LIBRARY_PATH=\"${CROSS_GCC}/lib:${CROSS_GCC}/${HOST}/lib:${CROSS_GCC_LIB}:${CROSS_GLIBC}/lib\"\n+        export CROSS_LIBRARY_PATH=\"${CROSS_GCC_LIB_STORE}/lib:${CROSS_GCC}/${HOST}/lib:${CROSS_GCC_LIB}:${CROSS_GLIBC}/lib\"\n         ;;\n     *darwin*)\n         # The CROSS toolchain for darwin uses the SDK and ignores environment variables.\n@@ -86,12 +89,13 @@ case \"$HOST\" in\n         CROSS_GLIBC_STATIC=\"$(store_path \"glibc-cross-${HOST}\" static)\"\n         CROSS_KERNEL=\"$(store_path \"linux-libre-headers-cross-${HOST}\")\"\n         CROSS_GCC=\"$(store_path \"gcc-cross-${HOST}\")\"\n-        CROSS_GCC_LIBS=( \"${CROSS_GCC}/lib/gcc/${HOST}\"/* ) # This expands to an array of directories...\n+        CROSS_GCC_LIB_STORE=\"$(store_path \"gcc-cross-${HOST}\" lib)\"\n+        CROSS_GCC_LIBS=( \"${CROSS_GCC_LIB_STORE}/lib/gcc/${HOST}\"/* ) # This expands to an array of directories...\n         CROSS_GCC_LIB=\"${CROSS_GCC_LIBS[0]}\" # ...we just want the first one (there should only be one)\n \n         export CROSS_C_INCLUDE_PATH=\"${CROSS_GCC_LIB}/include:${CROSS_GCC_LIB}/include-fixed:${CROSS_GLIBC}/include:${CROSS_KERNEL}/include\"\n         export CROSS_CPLUS_INCLUDE_PATH=\"${CROSS_GCC}/include/c++:${CROSS_GCC}/include/c++/${HOST}:${CROSS_GCC}/include/c++/backward:${CROSS_C_INCLUDE_PATH}\"\n-        export CROSS_LIBRARY_PATH=\"${CROSS_GCC}/lib:${CROSS_GCC}/${HOST}/lib:${CROSS_GCC_LIB}:${CROSS_GLIBC}/lib:${CROSS_GLIBC_STATIC}/lib\"\n+        export CROSS_LIBRARY_PATH=\"${CROSS_GCC_LIB_STORE}/lib:${CROSS_GCC}/${HOST}/lib:${CROSS_GCC_LIB}:${CROSS_GLIBC}/lib:${CROSS_GLIBC_STATIC}/lib\"\n         ;;\n     *)\n         exit 1 ;;"
      },
      {
        "sha": "bf02fbfd1dd02ff8e29c8f33e6b307d00f943b77",
        "filename": "contrib/guix/manifest.scm",
        "status": "modified",
        "additions": 6,
        "deletions": 4,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d02076b8852d8faae95cee6e3de434460c07412a/contrib/guix/manifest.scm",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d02076b8852d8faae95cee6e3de434460c07412a/contrib/guix/manifest.scm",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/guix/manifest.scm?ref=d02076b8852d8faae95cee6e3de434460c07412a",
        "patch": "@@ -115,7 +115,8 @@ http://www.linuxfromscratch.org/hlfs/view/development/chapter05/gcc-pass1.html\"\n        `((\"binutils\" ,xbinutils)\n          (\"libc\" ,xlibc)\n          (\"libc:static\" ,xlibc \"static\")\n-         (\"gcc\" ,xgcc)))\n+         (\"gcc\" ,xgcc)\n+         (\"gcc-lib\" ,xgcc \"lib\")))\n       (synopsis (string-append \"Complete GCC tool chain for \" target))\n       (description (string-append \"This package provides a complete GCC tool\n chain for \" target \" development.\"))\n@@ -159,7 +160,8 @@ desirable for building Bitcoin Core release binaries.\"\n       (propagated-inputs\n        `((\"binutils\" ,xbinutils)\n          (\"libc\" ,pthreads-xlibc)\n-         (\"gcc\" ,pthreads-xgcc)))\n+         (\"gcc\" ,pthreads-xgcc)\n+         (\"gcc-lib\" ,pthreads-xgcc \"lib\")))\n       (synopsis (string-append \"Complete GCC tool chain for \" target))\n       (description (string-append \"This package provides a complete GCC tool\n chain for \" target \" development.\"))\n@@ -219,7 +221,7 @@ chain for \" target \" development.\"))\n         pkg-config\n         ;; Scripting\n         perl\n-        python-3.7\n+        python-3\n         ;; Git\n         git\n         ;; Native gcc 7 toolchain\n@@ -236,5 +238,5 @@ chain for \" target \" development.\"))\n           ((string-contains target \"-linux-\")\n            (list (make-bitcoin-cross-toolchain target)))\n           ((string-contains target \"darwin\")\n-           (list clang-8 libcap binutils imagemagick libtiff librsvg font-tuffy cmake-3.15.5 xorriso))\n+           (list clang-8 libcap binutils imagemagick libtiff librsvg font-tuffy cmake xorriso))\n           (else '())))))"
      }
    ]
  }
]