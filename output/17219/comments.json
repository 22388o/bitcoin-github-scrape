[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/545112411",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-545112411",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
    "id": 545112411,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NTExMjQxMQ==",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-22T19:16:31Z",
    "updated_at": "2019-10-22T19:16:31Z",
    "author_association": "MEMBER",
    "body": "appreciated, will review",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/545112411/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/545179108",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-545179108",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
    "id": 545179108,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NTE3OTEwOA==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-22T22:14:47Z",
    "updated_at": "2020-04-04T03:16:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/545179108/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/545374547",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-545374547",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
    "id": 545374547,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NTM3NDU0Nw==",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?u=4a9af998e1a560b3f49c3827f453e1bcbe6a5cfb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-23T10:18:48Z",
    "updated_at": "2019-10-23T10:19:40Z",
    "author_association": "MEMBER",
    "body": "Looks like you could avoid `failed_to_get_change_address` by applying\r\n```diff\r\n--- a/src/wallet/wallet.cpp\r\n+++ b/src/wallet/wallet.cpp\r\n@@ -2968,7 +2968,7 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\r\n             // TODO: pass in scriptChange instead of reservedest so\r\n             // change transaction isn't always pay-to-bitcoin-address\r\n             CScript scriptChange;\r\n-            bool failed_to_get_change_address{false};\r\n+            assert(scriptChange.empty());\r\n\r\n             // coin control: send change to custom address\r\n             if (!boost::get<CNoDestination>(&coin_control.destChange)) {\r\n@@ -2984,7 +2984,6 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\r\n                 // Reserve a new key pair from key pool. If it fails, provide a dummy\r\n                 // destination in case we don't need change.\r\n                 if (!CanGetAddresses(true)) {\r\n-                    failed_to_get_change_address = true;\r\n                     strFailReason = _(\"Can't generate a change-address key. No keys in the internal keypool and can't generate any keys.\").translated;\r\n                 } else {\r\n                     CTxDestination dest;\r\n@@ -2993,7 +2992,6 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\r\n                     if (ret) {\r\n                         scriptChange = GetScriptForDestination(dest);\r\n                     } else {\r\n-                        failed_to_get_change_address = true;\r\n                         strFailReason = _(\"Keypool ran out, please call keypoolrefill first\").translated;\r\n                     }\r\n\r\n@@ -3210,10 +3208,9 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\r\n             }\r\n\r\n             // Give up if change keypool ran out and we failed to find a solution without change:\r\n-            if (failed_to_get_change_address && nChangePosInOut != -1) {\r\n+            if (scriptChange.empty() && nChangePosInOut != -1) {\r\n                 return false;\r\n             }\r\n-\r\n         }\r\n\r\n         // Shuffle selected coins and fill in final vin\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/545374547/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/545375875",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-545375875",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
    "id": 545375875,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NTM3NTg3NQ==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-23T10:22:16Z",
    "updated_at": "2019-10-23T10:22:16Z",
    "author_association": "MEMBER",
    "body": "Concept ACK",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/545375875/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/545440441",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-545440441",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
    "id": 545440441,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NTQ0MDQ0MQ==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-23T13:21:20Z",
    "updated_at": "2019-10-23T13:21:20Z",
    "author_association": "MEMBER",
    "body": "Updated with @promag's suggestion to avoid `failed_to_get_change_address` and @instagibbs suggestion to simplify the change address check.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/545440441/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/545961422",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-545961422",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
    "id": 545961422,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NTk2MTQyMg==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-24T15:04:03Z",
    "updated_at": "2019-10-24T19:03:47Z",
    "author_association": "MEMBER",
    "body": "@achow101 suggested in https://github.com/bitcoin/bitcoin/pull/16944#discussion_r338308868 to avoid knapsack when there's no change. I added a commit that achieves that, but it's non-trivial.\r\n\r\nIt does this by enabling BnB when subtracting fees from outputs. Gotchas:\r\n1. when coins are pre-selected, it still uses knapsack\r\n2. it still excludes dust inputs based on their value minus the fees needed to spend them, but it does not use their effective value in BnB. I don't think this matters in practice, because `subtractFeesFromOutputs` is generally used to spend either _all_ coins or a selected bunch. But there is an edge case where e.g. it can choose between two 0.01 BTC inputs, one SegWit and one legacy, and it won't care.\r\n\r\nI tested #16944 on top of this, in particular: GUI coin selection still works with a watch-only wallet without keypool.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/545961422/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/546087219",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-546087219",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
    "id": 546087219,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NjA4NzIxOQ==",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?u=9791e96cd4268d48e3517bac41eaf2b1d09759fd&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-24T20:23:10Z",
    "updated_at": "2019-10-24T20:23:10Z",
    "author_association": "MEMBER",
    "body": "> @achow101 suggested in [#16944 (comment)](https://github.com/bitcoin/bitcoin/pull/16944#discussion_r338308868) to avoid knapsack when there's no change. I added a commit that achieves that, but it's non-trivial.\r\n\r\nIn the interest of reducing complexity, I think that change should be done as a separate PR. I do plan on working on the coin selection logic again soon and clean this up as well.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/546087219/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/546258522",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-546258522",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
    "id": 546258522,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU0NjI1ODUyMg==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-10-25T08:32:15Z",
    "updated_at": "2019-10-25T08:32:15Z",
    "author_association": "MEMBER",
    "body": "@achow101 done, I moved that commit into #17246",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/546258522/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/580276061",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-580276061",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
    "id": 580276061,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MDI3NjA2MQ==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-30T14:23:00Z",
    "updated_at": "2020-01-30T14:23:00Z",
    "author_association": "MEMBER",
    "body": "@instagibbs @achow101 @fjahr @luke-jr this should be ready for another review. @gwillen you may also find it useful.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/580276061/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/582350028",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-582350028",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
    "id": 582350028,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MjM1MDAyOA==",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?u=348c27f90b6fff8fd72fa27232272651436a2ff0&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-05T10:49:57Z",
    "updated_at": "2020-02-05T10:49:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "Code review ACK 92bcd70808b9cac56b184903aa6d37baf9641b37",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/582350028/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/614438822",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-614438822",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
    "id": 614438822,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNDQzODgyMg==",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?u=eab5d0cdbb6cc25087cb61d4ca4a6f85255f42a7&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-16T06:19:53Z",
    "updated_at": "2020-04-16T06:19:53Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks @Sjors. Clever way.\r\nutACK 92bcd70808b9cac56b184903aa6d37baf9641b37",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/614438822/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/614439195",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-614439195",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
    "id": 614439195,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNDQzOTE5NQ==",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?u=eab5d0cdbb6cc25087cb61d4ca4a6f85255f42a7&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-16T06:21:01Z",
    "updated_at": "2020-04-16T06:21:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "This should have its release notes part (added label).",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/614439195/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/615345149",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-615345149",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
    "id": 615345149,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNTM0NTE0OQ==",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?u=9791e96cd4268d48e3517bac41eaf2b1d09759fd&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-17T16:34:47Z",
    "updated_at": "2020-04-17T16:34:47Z",
    "author_association": "MEMBER",
    "body": "ACK 92bcd70808b9cac56b184903aa6d37baf9641b37",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/615345149/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/633001089",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-633001089",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
    "id": 633001089,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMzAwMTA4OQ==",
    "user": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?u=a0e0040aacd7d4f0787481e8ac30b494fa429e11&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-23T07:30:12Z",
    "updated_at": "2020-05-23T07:30:12Z",
    "author_association": "MEMBER",
    "body": "@achow101 can you add any relevant release notes to https://github.com/bitcoin-core/bitcoin-devwiki/wiki/0.20.0-Release-Notes-Draft ?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/633001089/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634542910",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#issuecomment-634542910",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17219",
    "id": 634542910,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNDU0MjkxMA==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-27T09:28:33Z",
    "updated_at": "2020-05-27T09:28:33Z",
    "author_association": "MEMBER",
    "body": "@fanquake note that this isn't in 0.20",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/634542910/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/337701626",
    "pull_request_review_id": 305445885,
    "id": 337701626,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzNzcwMTYyNg==",
    "diff_hunk": "@@ -2980,21 +2981,23 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  rediscover unknown transactions that were written with keys of ours to recover\n                 //  post-backup change.\n \n-                // Reserve a new key pair from key pool\n+                // Reserve a new key pair from key pool. If it fails, provide a dummy",
    "path": "src/wallet/wallet.cpp",
    "position": 9,
    "original_position": 13,
    "commit_id": "92bcd70808b9cac56b184903aa6d37baf9641b37",
    "original_commit_id": "b2da2d9e56307f6a32ba6a39c293358580a2a91f",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@instagibbs wrote:\r\n> At the risk of making the error message less precise, I think this whole block is easier to read if it just relies on `GetReservedDestination` to check if `CanGetAddress` is true or not. You also can just not store `ret` and use it directly in the conditional.",
    "created_at": "2019-10-22T19:14:47Z",
    "updated_at": "2020-02-04T10:20:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r337701626",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/337701626"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r337701626"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/337701626/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2632,
    "original_line": 2632,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338072692",
    "pull_request_review_id": 305922931,
    "id": 338072692,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzODA3MjY5Mg==",
    "diff_hunk": "@@ -3200,6 +3201,12 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 coin_selection_params.use_bnb = false;\n                 continue;\n             }\n+\n+            // Give up if change keypool ran out and we failed to find a solution without change:\n+            if (scriptChange.empty() && nChangePosInOut != -1) {\n+                return false;\n+            }\n+",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 34,
    "commit_id": "92bcd70808b9cac56b184903aa6d37baf9641b37",
    "original_commit_id": "3deb73c853ac80cb9028746c5439af68b310678e",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit, remove \ud83c\udfc3.",
    "created_at": "2019-10-23T14:11:47Z",
    "updated_at": "2020-02-04T10:20:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r338072692",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338072692"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r338072692"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338072692/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3209,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338313880",
    "pull_request_review_id": 306235397,
    "id": 338313880,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzODMxMzg4MA==",
    "diff_hunk": "@@ -2980,14 +2981,14 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  rediscover unknown transactions that were written with keys of ours to recover\n                 //  post-backup change.\n \n-                // Reserve a new key pair from key pool\n+                // Reserve a new key pair from key pool. If it fails, provide a dummy\n+                // destination in case we don't need change.\n                 CTxDestination dest;\n                 const OutputType change_type = TransactionChangeType(coin_control.m_change_type ? *coin_control.m_change_type : m_default_change_type, vecSend);\n                 if (reservedest.GetReservedDestination(change_type, dest, true)) {\n                     scriptChange = GetScriptForDestination(dest);",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 18,
    "commit_id": "92bcd70808b9cac56b184903aa6d37baf9641b37",
    "original_commit_id": "db2e40036f5467f266d1e3972b2d0e46988c1ee7",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "To avoid overestimating on fees, maybe move `change_prototype_txout` and `change_output_size` setting into here?. Then set `change_output_size` to 0 below in the else block.",
    "created_at": "2019-10-23T22:48:48Z",
    "updated_at": "2020-02-04T10:20:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r338313880",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338313880"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r338313880"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338313880/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2538,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338623327",
    "pull_request_review_id": 306641955,
    "id": 338623327,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMzODYyMzMyNw==",
    "diff_hunk": "@@ -2980,14 +2981,14 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  rediscover unknown transactions that were written with keys of ours to recover\n                 //  post-backup change.\n \n-                // Reserve a new key pair from key pool\n+                // Reserve a new key pair from key pool. If it fails, provide a dummy\n+                // destination in case we don't need change.\n                 CTxDestination dest;\n                 const OutputType change_type = TransactionChangeType(coin_control.m_change_type ? *coin_control.m_change_type : m_default_change_type, vecSend);\n                 if (reservedest.GetReservedDestination(change_type, dest, true)) {\n                     scriptChange = GetScriptForDestination(dest);",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 18,
    "commit_id": "92bcd70808b9cac56b184903aa6d37baf9641b37",
    "original_commit_id": "db2e40036f5467f266d1e3972b2d0e46988c1ee7",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done, but I wasn't able to write a test that shows a difference. ",
    "created_at": "2019-10-24T14:56:27Z",
    "updated_at": "2020-02-04T10:20:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r338623327",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338623327"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r338623327"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/338623327/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2538,
    "side": "RIGHT",
    "in_reply_to_id": 338313880
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/340615439",
    "pull_request_review_id": 309202786,
    "id": 340615439,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0MDYxNTQzOQ==",
    "diff_hunk": "@@ -2529,20 +2530,15 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  rediscover unknown transactions that were written with keys of ours to recover\n                 //  post-backup change.\n \n-                // Reserve a new key pair from key pool\n-                if (!CanGetAddresses(true)) {\n-                    strFailReason = _(\"Can't generate a change-address key. No keys in the internal keypool and can't generate any keys.\").translated;\n-                    return false;\n-                }\n+                // Reserve a new key pair from key pool. If it fails, provide a dummy\n+                // destination in case we don't need change.\n                 CTxDestination dest;\n                 const OutputType change_type = TransactionChangeType(coin_control.m_change_type ? *coin_control.m_change_type : m_default_change_type, vecSend);\n-                bool ret = reservedest.GetReservedDestination(change_type, dest, true);\n-                if (!ret)\n-                {\n-                    strFailReason = \"Keypool ran out, please call keypoolrefill first\";\n-                    return false;\n+                if (reservedest.GetReservedDestination(change_type, dest, true)) {\n+                    scriptChange = GetScriptForDestination(dest);\n+                } else {\n+                    strFailReason = _(\"Can't generate a transaction without change. Please call keypoolrefill first.\").translated;\n                 }\n-\n                 scriptChange = GetScriptForDestination(dest);",
    "path": "src/wallet/wallet.cpp",
    "position": 21,
    "original_position": 32,
    "commit_id": "92bcd70808b9cac56b184903aa6d37baf9641b37",
    "original_commit_id": "388b153f9ea7ae9cc47e928e08d4f244ee624571",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`GetScriptForDestination(dest)` is called twice here if we can reserve a dest. I would optimize this slightly: \r\n\r\n```suggestion\r\n                if (!reservedest.GetReservedDestination(change_type, dest, true)) {\r\n                    strFailReason = _(\"Can't generate a transaction without change. Please call keypoolrefill first.\").translated;\r\n                }\r\n                scriptChange = GetScriptForDestination(dest);\r\n```\r\n\r\nThe suggestion should replace L2537 - 2542. Seems I can not edit that part of my suggestion.",
    "created_at": "2019-10-30T13:35:48Z",
    "updated_at": "2020-02-04T10:20:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r340615439",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/340615439"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r340615439"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/340615439/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2638,
    "original_line": 2638,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/340618350",
    "pull_request_review_id": 309202786,
    "id": 340618350,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0MDYxODM1MA==",
    "diff_hunk": "@@ -2529,20 +2530,15 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  rediscover unknown transactions that were written with keys of ours to recover\n                 //  post-backup change.\n \n-                // Reserve a new key pair from key pool\n-                if (!CanGetAddresses(true)) {\n-                    strFailReason = _(\"Can't generate a change-address key. No keys in the internal keypool and can't generate any keys.\").translated;\n-                    return false;\n-                }\n+                // Reserve a new key pair from key pool. If it fails, provide a dummy\n+                // destination in case we don't need change.\n                 CTxDestination dest;\n                 const OutputType change_type = TransactionChangeType(coin_control.m_change_type ? *coin_control.m_change_type : m_default_change_type, vecSend);\n-                bool ret = reservedest.GetReservedDestination(change_type, dest, true);\n-                if (!ret)\n-                {\n-                    strFailReason = \"Keypool ran out, please call keypoolrefill first\";\n-                    return false;\n+                if (reservedest.GetReservedDestination(change_type, dest, true)) {\n+                    scriptChange = GetScriptForDestination(dest);\n+                } else {\n+                    strFailReason = _(\"Can't generate a transaction without change. Please call keypoolrefill first.\").translated;",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 29,
    "commit_id": "92bcd70808b9cac56b184903aa6d37baf9641b37",
    "original_commit_id": "388b153f9ea7ae9cc47e928e08d4f244ee624571",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think this error message is ambiguous: It could mean we can't generate a transaction with change without a change address because we can't get the dest. But it could also mean we can not generate a transaction that does not need a change at all. I could see my self thinking here: \"What do you mean? I have change in this tx!\".",
    "created_at": "2019-10-30T13:40:32Z",
    "updated_at": "2020-02-04T10:20:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r340618350",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/340618350"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r340618350"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/340618350/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2540,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/342142258",
    "pull_request_review_id": 311192093,
    "id": 342142258,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0MjE0MjI1OA==",
    "diff_hunk": "@@ -2517,6 +2517,7 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n             // TODO: pass in scriptChange instead of reservedest so\n             // change transaction isn't always pay-to-bitcoin-address\n             CScript scriptChange;\n+            assert(scriptChange.empty());",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "92bcd70808b9cac56b184903aa6d37baf9641b37",
    "original_commit_id": "388b153f9ea7ae9cc47e928e08d4f244ee624571",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This seems unnecessary? How could it ever NOT be empty here?",
    "created_at": "2019-11-04T16:26:40Z",
    "updated_at": "2020-02-04T10:20:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r342142258",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/342142258"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r342142258"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/342142258/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2520,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/342157746",
    "pull_request_review_id": 311212631,
    "id": 342157746,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0MjE1Nzc0Ng==",
    "diff_hunk": "@@ -2517,6 +2517,7 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n             // TODO: pass in scriptChange instead of reservedest so\n             // change transaction isn't always pay-to-bitcoin-address\n             CScript scriptChange;\n+            assert(scriptChange.empty());",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "92bcd70808b9cac56b184903aa6d37baf9641b37",
    "original_commit_id": "388b153f9ea7ae9cc47e928e08d4f244ee624571",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Removed. I added a potentially more useful assert below `scriptChange = GetScriptForDestination(dest);`",
    "created_at": "2019-11-04T16:55:26Z",
    "updated_at": "2020-02-04T10:20:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r342157746",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/342157746"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r342157746"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/342157746/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2520,
    "side": "RIGHT",
    "in_reply_to_id": 342142258
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/342157753",
    "pull_request_review_id": 311212644,
    "id": 342157753,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0MjE1Nzc1Mw==",
    "diff_hunk": "@@ -2529,20 +2530,15 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  rediscover unknown transactions that were written with keys of ours to recover\n                 //  post-backup change.\n \n-                // Reserve a new key pair from key pool\n-                if (!CanGetAddresses(true)) {\n-                    strFailReason = _(\"Can't generate a change-address key. No keys in the internal keypool and can't generate any keys.\").translated;\n-                    return false;\n-                }\n+                // Reserve a new key pair from key pool. If it fails, provide a dummy\n+                // destination in case we don't need change.\n                 CTxDestination dest;\n                 const OutputType change_type = TransactionChangeType(coin_control.m_change_type ? *coin_control.m_change_type : m_default_change_type, vecSend);\n-                bool ret = reservedest.GetReservedDestination(change_type, dest, true);\n-                if (!ret)\n-                {\n-                    strFailReason = \"Keypool ran out, please call keypoolrefill first\";\n-                    return false;\n+                if (reservedest.GetReservedDestination(change_type, dest, true)) {\n+                    scriptChange = GetScriptForDestination(dest);\n+                } else {\n+                    strFailReason = _(\"Can't generate a transaction without change. Please call keypoolrefill first.\").translated;",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 29,
    "commit_id": "92bcd70808b9cac56b184903aa6d37baf9641b37",
    "original_commit_id": "388b153f9ea7ae9cc47e928e08d4f244ee624571",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Changed to: `Transaction needs a change address, but we can't generate it. Please call keypoolrefill first.`",
    "created_at": "2019-11-04T16:55:27Z",
    "updated_at": "2020-02-04T10:20:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r342157753",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/342157753"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r342157753"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/342157753/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2540,
    "side": "RIGHT",
    "in_reply_to_id": 340618350
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/342157780",
    "pull_request_review_id": 311212679,
    "id": 342157780,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0MjE1Nzc4MA==",
    "diff_hunk": "@@ -2529,20 +2530,15 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  rediscover unknown transactions that were written with keys of ours to recover\n                 //  post-backup change.\n \n-                // Reserve a new key pair from key pool\n-                if (!CanGetAddresses(true)) {\n-                    strFailReason = _(\"Can't generate a change-address key. No keys in the internal keypool and can't generate any keys.\").translated;\n-                    return false;\n-                }\n+                // Reserve a new key pair from key pool. If it fails, provide a dummy\n+                // destination in case we don't need change.\n                 CTxDestination dest;\n                 const OutputType change_type = TransactionChangeType(coin_control.m_change_type ? *coin_control.m_change_type : m_default_change_type, vecSend);\n-                bool ret = reservedest.GetReservedDestination(change_type, dest, true);\n-                if (!ret)\n-                {\n-                    strFailReason = \"Keypool ran out, please call keypoolrefill first\";\n-                    return false;\n+                if (reservedest.GetReservedDestination(change_type, dest, true)) {\n+                    scriptChange = GetScriptForDestination(dest);\n+                } else {\n+                    strFailReason = _(\"Can't generate a transaction without change. Please call keypoolrefill first.\").translated;\n                 }\n-\n                 scriptChange = GetScriptForDestination(dest);",
    "path": "src/wallet/wallet.cpp",
    "position": 21,
    "original_position": 32,
    "commit_id": "92bcd70808b9cac56b184903aa6d37baf9641b37",
    "original_commit_id": "388b153f9ea7ae9cc47e928e08d4f244ee624571",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done",
    "created_at": "2019-11-04T16:55:30Z",
    "updated_at": "2020-02-04T10:20:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r342157780",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/342157780"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r342157780"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/342157780/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2638,
    "original_line": 2638,
    "side": "RIGHT",
    "in_reply_to_id": 340615439
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373864657",
    "pull_request_review_id": 351957951,
    "id": 373864657,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3Mzg2NDY1Nw==",
    "diff_hunk": "@@ -2630,18 +2630,13 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  post-backup change.\n \n                 // Reserve a new key pair from key pool\n-                if (!CanGetAddresses(true)) {\n-                    strFailReason = _(\"Can't generate a change-address key. No keys in the internal keypool and can't generate any keys.\").translated;\n-                    return false;\n-                }\n                 CTxDestination dest;\n-                bool ret = reservedest.GetReservedDestination(dest, true);\n-                if (!ret)\n-                {\n-                    strFailReason = _(\"Keypool ran out, please call keypoolrefill first\").translated;\n+                const OutputType change_type = TransactionChangeType(coin_control.m_change_type ? *coin_control.m_change_type : m_default_change_type, vecSend);\n+                ReserveDestination reservedest(this, change_type);",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 14,
    "commit_id": "92bcd70808b9cac56b184903aa6d37baf9641b37",
    "original_commit_id": "c7d433f572088c859b58624e78b79de4aa234bc2",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think L2634-2635 can be removed again. They are already declared in L2578-2579.",
    "created_at": "2020-02-02T18:15:08Z",
    "updated_at": "2020-02-04T10:20:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r373864657",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373864657"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r373864657"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/373864657/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2635,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/374588579",
    "pull_request_review_id": 352867749,
    "id": 374588579,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3NDU4ODU3OQ==",
    "diff_hunk": "@@ -2630,18 +2630,13 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  post-backup change.\n \n                 // Reserve a new key pair from key pool\n-                if (!CanGetAddresses(true)) {\n-                    strFailReason = _(\"Can't generate a change-address key. No keys in the internal keypool and can't generate any keys.\").translated;\n-                    return false;\n-                }\n                 CTxDestination dest;\n-                bool ret = reservedest.GetReservedDestination(dest, true);\n-                if (!ret)\n-                {\n-                    strFailReason = _(\"Keypool ran out, please call keypoolrefill first\").translated;\n+                const OutputType change_type = TransactionChangeType(coin_control.m_change_type ? *coin_control.m_change_type : m_default_change_type, vecSend);\n+                ReserveDestination reservedest(this, change_type);",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 14,
    "commit_id": "92bcd70808b9cac56b184903aa6d37baf9641b37",
    "original_commit_id": "c7d433f572088c859b58624e78b79de4aa234bc2",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Odd, removed again.",
    "created_at": "2020-02-04T10:27:07Z",
    "updated_at": "2020-02-04T10:27:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r374588579",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/374588579"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r374588579"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/374588579/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2635,
    "side": "RIGHT",
    "in_reply_to_id": 373864657
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409683229",
    "pull_request_review_id": 394794219,
    "id": 409683229,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTY4MzIyOQ==",
    "diff_hunk": "@@ -2629,13 +2629,14 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  rediscover unknown transactions that were written with keys of ours to recover\n                 //  post-backup change.\n \n-                // Reserve a new key pair from key pool\n+                // Reserve a new key pair from key pool. If it fails, provide a dummy\n+                // destination in case we don't need change.\n                 CTxDestination dest;\n                 if (!reservedest.GetReservedDestination(dest, true)) {\n-                    strFailReason = _(\"Can't generate a change-address key. Please call keypoolrefill first.\").translated;\n-                    return false;\n+                    strFailReason = _(\"Transaction needs a change address, but we can't generate it. Please call keypoolrefill first.\").translated;\n                 }\n                 scriptChange = GetScriptForDestination(dest);\n+                assert(!dest.empty() || scriptChange.empty());",
    "path": "src/wallet/wallet.cpp",
    "position": 22,
    "original_position": 14,
    "commit_id": "92bcd70808b9cac56b184903aa6d37baf9641b37",
    "original_commit_id": "92bcd70808b9cac56b184903aa6d37baf9641b37",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It's not clear to me what this assert is checking for.\r\n\r\nIf `dest` is not empty, we got a change destination and so `scriptChange` is not empty. If dest is empty, then `scriptChange` will be empty. So this just covers all cases and can't fail?",
    "created_at": "2020-04-16T16:18:17Z",
    "updated_at": "2020-04-16T16:18:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r409683229",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409683229"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r409683229"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409683229/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2639,
    "original_line": 2639,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410073296",
    "pull_request_review_id": 395261757,
    "id": 410073296,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDA3MzI5Ng==",
    "diff_hunk": "@@ -2629,13 +2629,14 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  rediscover unknown transactions that were written with keys of ours to recover\n                 //  post-backup change.\n \n-                // Reserve a new key pair from key pool\n+                // Reserve a new key pair from key pool. If it fails, provide a dummy\n+                // destination in case we don't need change.\n                 CTxDestination dest;\n                 if (!reservedest.GetReservedDestination(dest, true)) {\n-                    strFailReason = _(\"Can't generate a change-address key. Please call keypoolrefill first.\").translated;\n-                    return false;\n+                    strFailReason = _(\"Transaction needs a change address, but we can't generate it. Please call keypoolrefill first.\").translated;\n                 }\n                 scriptChange = GetScriptForDestination(dest);\n+                assert(!dest.empty() || scriptChange.empty());",
    "path": "src/wallet/wallet.cpp",
    "position": 22,
    "original_position": 14,
    "commit_id": "92bcd70808b9cac56b184903aa6d37baf9641b37",
    "original_commit_id": "92bcd70808b9cac56b184903aa6d37baf9641b37",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I can't remember why I wrote this, but I think the idea was to ensure `GetScriptForDestination()` returns an empty script for an empty destination. Perhaps that's overkill; I can drop it if there's any other changes needed in this PR.",
    "created_at": "2020-04-17T08:31:12Z",
    "updated_at": "2020-04-17T08:31:12Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r410073296",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410073296"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r410073296"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410073296/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2639,
    "original_line": 2639,
    "side": "RIGHT",
    "in_reply_to_id": 409683229
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410338333",
    "pull_request_review_id": 395605032,
    "id": 410338333,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDMzODMzMw==",
    "diff_hunk": "@@ -2629,13 +2629,14 @@ bool CWallet::CreateTransaction(interfaces::Chain::Lock& locked_chain, const std\n                 //  rediscover unknown transactions that were written with keys of ours to recover\n                 //  post-backup change.\n \n-                // Reserve a new key pair from key pool\n+                // Reserve a new key pair from key pool. If it fails, provide a dummy\n+                // destination in case we don't need change.\n                 CTxDestination dest;\n                 if (!reservedest.GetReservedDestination(dest, true)) {\n-                    strFailReason = _(\"Can't generate a change-address key. Please call keypoolrefill first.\").translated;\n-                    return false;\n+                    strFailReason = _(\"Transaction needs a change address, but we can't generate it. Please call keypoolrefill first.\").translated;\n                 }\n                 scriptChange = GetScriptForDestination(dest);\n+                assert(!dest.empty() || scriptChange.empty());",
    "path": "src/wallet/wallet.cpp",
    "position": 22,
    "original_position": 14,
    "commit_id": "92bcd70808b9cac56b184903aa6d37baf9641b37",
    "original_commit_id": "92bcd70808b9cac56b184903aa6d37baf9641b37",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I guess it's fine, but it just seems like useless code that might be confusing to future readers. I would suggest that it be removed in a followup that touches this code.",
    "created_at": "2020-04-17T16:34:41Z",
    "updated_at": "2020-04-17T16:34:41Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r410338333",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410338333"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17219#discussion_r410338333"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17219"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410338333/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2639,
    "original_line": 2639,
    "side": "RIGHT",
    "in_reply_to_id": 409683229
  }
]