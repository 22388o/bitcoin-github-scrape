laanwj,2018-06-04T15:28:53Z,"There's a few problems with this:\n- `-sysperms` can no longer be set in the configuration file\n- by moving it to `bitcoind.cpp`, it's no longer heeded for the GUI\n\nTend toward NACK. Better to set the permissions on the data directory once, manually, it's not going to touch them after that.",https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-394396599,394396599,
laanwj,2018-06-04T16:01:32Z,"Or, if this is a big issue, maybe do it in both places?",https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-394408334,394408334,
MarcoFalke,2018-06-04T16:12:56Z,"Would be nice to know when this regression was introduced. If it never did anything, I guess it can be removed?\n\nIf it is not going to be removed, this must come with functional tests that verify the behavior.",https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-394412043,394412043,
n2yen,2018-06-04T20:08:57Z,"Appreciate the feedback, I will look into these later - please let me know if you have any other suggestion as well.  Thank you!",https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-394482224,394482224,
n2yen,2018-06-05T07:39:16Z,"Had a look at the bitcoin-qt as suggested - it looks like if there was a regression it could be because it potentially generates datadir on its own, without calling GetDefaultDataDir(), see comments in the commit above. Tested by running bitcoind, and bitcoin-qt and checking datadir. The existing unit tests, don't appear to rely on either of the above utility function calls - should I still go ahe",https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-394612492,394612492,
ken2812221,2018-06-05T07:49:00Z,"@n2yen You can add a python script into functional test, it allow you to run a node to test this.",https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-394615100,394615100,
laanwj,2018-06-05T13:43:29Z,"> If it is not going to be removed, this must come with functional tests that verify the behavior.\n\nIt definitely works, but not for the initial directory creation. It works for files created after that, and that's what it's intended for (block file data sharing, basically).",https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-394713824,394713824,
n2yen,2018-06-05T15:48:10Z,"@Iaanwj can you clarify if we should also leave the old the old code where it was also (in AppInitBasicSetup )? i'm not sure, thank you for your feedback!",https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-394760814,394760814,
MarcoFalke,2018-06-05T15:52:53Z,"@n2yen I haven't looked, but according to the issue  #13371 the old code is doing nothing. Having useless code is useless, so please remove if it is useless.",https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-394762498,394762498,
laanwj,2018-06-07T06:22:30Z,"Oh I get the problem now, it's not `-sysperms` option that's broken, but the default umask setting. It isn't effective yet when the data directory is created, but is by the time when e.g. the wallet is created (as that's later in the init process). **I strongly disagree that it does nothing, though**.\n\nOK, yes, it should definitely be moved so that the data directory is also created with that ",https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-395306690,395306690,
laanwj,2018-06-07T06:31:37Z,"So to show the current code should not naively be removed (nor applied for `bitcoind` only), this affects wallet default permissions:\n```bash\n$ src/bitcoind -datadir=/tmp/wallet1 -regtest\n$ stat /tmp/wallet1/regtest/wallets/wallet.dat \nAccess: (0600/-rw-------)\n```\nAfter removing the `umask` setting code from `AppInitBasicSetup`:\n```bash\n$ src/bitcoind -datadir=/tmp/wallet2 -regtes",https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-395308501,395308501,
n2yen,2018-06-08T00:07:36Z,"@Iaanwj ok, so we're in agreement, that the umask in AppInitBasicSetup() may not be early enough.  I agree that the umask cannot just be in bitcoind.cpp, but also in bitcoin-qt or some common code that can be called earlier... I will also be adding tests in the way suggested by @ken2812221. ",https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-395604024,395604024,
n2yen,2018-06-09T13:46:54Z,"Updated commit with tests to verify permissions of regtest directory, and umask is set as early as sensible in both bitcoind and bitcoin-qt. @laanwj , @MarcoFalke can I please get your feedback? ",https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-395970736,395970736,
DrahtBot,2018-07-26T05:02:03Z,<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.,https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-407976949,407976949,
DrahtBot,2018-07-29T15:16:03Z,"<!--5d09a71f8925f3f132321140b44b946d-->The last travis run for this pull request was 50 days ago and is thus outdated. To trigger a fresh travis build, this pull request should be closed and re-opened.",https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-408684559,408684559,
n2yen,2018-09-11T07:53:49Z,"Rebased on top of:\neb2f1bd276108e70aff0f582a407e9b702eb4dd1 - Merge #14189: qa: Fix silent merge conflict in wallet_importmulti...\nOn sept 10, 2018\n",https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-420181993,420181993,
ken2812221,2018-09-16T05:06:56Z,"Concept ACK. \nnit: You should skip the test on Windows.",https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-421697180,421697180,
n2yen,2018-09-16T14:54:22Z,"Hi @ken2812221, \nThanks for your feedback. I've made the changes, to skip the test on Windows, however I don't have a windows machine to confirm it skips. Can someone try it? I've confirmed the tests will run on Linux.",https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-421777950,421777950,
ken2812221,2018-09-17T02:25:46Z,"I would prefer to rename to `feature_sysperms.py` and check if `-sysperms` works as expected and no `-sysperms` works as expected. Now you only check for no `sysperms`, missing the test with `-sysperms`.\n\n> I don't have a windows machine to confirm it skips. Can someone try it?\n\n#14007 is about to merge, you can check if it works as expected on Appveyor after then.",https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-421876090,421876090,
n2yen,2018-09-17T16:15:39Z,"Thanks Ken2812221, yup, I'll look into it.",https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-422078043,422078043,
n2yen,2018-09-30T17:24:45Z,"travis-ci appears to have failed due to (from last line in log):\n""The job exceeded the maximum time limit for jobs, and has been terminated.""\n@practicalswift , @ken2812221 - can I get your advise? \nbest regards.  ",https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-425736695,425736695,
practicalswift,2018-09-30T17:53:36Z,@n2yen Job restarted :-),https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-425738655,425738655,
n2yen,2018-09-30T18:49:58Z,@practicalswift thank you!,https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-425742435,425742435,
n2yen,2018-10-01T01:13:45Z,"@practicalswift timed out again, this time, didn't even get a chance to run the feature tests! ",https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-425766987,425766987,
MarcoFalke,2019-05-20T17:54:39Z,Please squash your commits according to https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#squashing-commits,https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-494088311,494088311,
n2yen,2019-07-27T16:01:14Z,rebased!,https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-515694724,515694724,
jonasschnelli,2019-10-09T08:32:29Z,~~utACK 09072f762ae3fe9a746ab447458e95a6fb646ed3~~,https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-539897849,539897849,
laanwj,2019-10-09T08:54:01Z,"I don't think my original comments have been addressed (edit: the GUI one is). This still doesn't allow setting sysperm in the configuration file, only on the command line.\n\nIt also complicates the initialization order.\n\nI'm starting to think it would be better to remove the `sysperm` setting.\n",https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-539906114,539906114,
jonasschnelli,2019-10-09T09:10:12Z,I underestimated the fact that one can no longer use the `sysperm` setting in the config file after this. I just retrieved my ACK.,https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-539912457,539912457,
jonasschnelli,2020-05-29T07:02:15Z,@n2yen: what is the status of this PR? Can you have a look in addressing/commenting @laanwj [comment](https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-539906114)?,https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-635799451,635799451,
n2yen,2020-05-29T20:19:25Z,"ok, will have a look.",https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-636173883,636173883,
jonasschnelli,2020-06-05T07:00:15Z,Closing in favour of #17127 (which is probably superior).,https://github.com/bitcoin/bitcoin/pull/13389#issuecomment-639297176,639297176,
practicalswift,2018-09-14T16:00:21Z,"```\n2018-09-14 14:23:42 flake8(pr=13389): test/functional/feature_nosysperms.py:19:62: E227 missing whitespace around bitwise or shift operator\n```",https://github.com/bitcoin/bitcoin/pull/13389#discussion_r217762272,217762272,test/functional/feature_nosysperms.py
practicalswift,2018-09-14T16:01:01Z,Remove these two comments :-),https://github.com/bitcoin/bitcoin/pull/13389#discussion_r217762445,217762445,test/functional/feature_nosysperms.py
n2yen,2018-09-16T04:54:39Z,Done.,https://github.com/bitcoin/bitcoin/pull/13389#discussion_r217902082,217902082,test/functional/feature_nosysperms.py
n2yen,2018-09-16T04:54:59Z,Done. Thanks for the feedback!,https://github.com/bitcoin/bitcoin/pull/13389#discussion_r217902086,217902086,test/functional/feature_nosysperms.py
practicalswift,2018-09-23T20:22:24Z,"Nit: `for path, _, files in os.walk(regtest_dirpath):`",https://github.com/bitcoin/bitcoin/pull/13389#discussion_r219710243,219710243,test/functional/feature_nosysperms.py
hebasto,2019-04-26T17:05:21Z,`'0o77'` - typo?,https://github.com/bitcoin/bitcoin/pull/13389#discussion_r279030633,279030633,test/functional/feature_sysperms.py
n2yen,2019-04-27T14:25:31Z,"you're right, should be '077'. What did you make of -sysperm option, is it still needed?",https://github.com/bitcoin/bitcoin/pull/13389#discussion_r279156909,279156909,test/functional/feature_sysperms.py
hebasto,2019-04-27T15:04:13Z,"> What did you make of -sysperm option, is it still needed?\n\nMy concerns about `-sysperms` are in the note here #15902.",https://github.com/bitcoin/bitcoin/pull/13389#discussion_r279157956,279157956,test/functional/feature_sysperms.py
n2yen,2019-04-27T16:29:18Z,does it makes sense to close this PR - perhaps replace it with simply removing the option? i suppose the tests might still be useful...,https://github.com/bitcoin/bitcoin/pull/13389#discussion_r279160472,279160472,test/functional/feature_sysperms.py
