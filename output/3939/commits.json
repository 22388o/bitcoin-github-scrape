[
  {
    "sha": "3da434a2ef9ac76a0ad4a33921773a9ac8f10ab7",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozZGE0MzRhMmVmOWFjNzZhMGFkNGEzMzkyMTc3M2E5YWM4ZjEwYWI3",
    "commit": {
      "author": {
        "name": "Jeff Garzik",
        "email": "jgarzik@bitpay.com",
        "date": "2014-07-17T00:04:04Z"
      },
      "committer": {
        "name": "Jeff Garzik",
        "email": "jgarzik@bitpay.com",
        "date": "2014-07-18T14:16:47Z"
      },
      "message": "Introduce option to disable relay/mining of bare multisig scripts in TX outputs\n\nFirst and foremost, this defaults to OFF.\n\nThis option lets a node consider such transactions non-standard,\nmeaning they will not be relayed or mined by default, but other miners\nare free to mine these as usual.",
      "tree": {
        "sha": "960172cd0f5575e45f00134a5a438ba898146641",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/960172cd0f5575e45f00134a5a438ba898146641"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3da434a2ef9ac76a0ad4a33921773a9ac8f10ab7",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3da434a2ef9ac76a0ad4a33921773a9ac8f10ab7",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/3da434a2ef9ac76a0ad4a33921773a9ac8f10ab7",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3da434a2ef9ac76a0ad4a33921773a9ac8f10ab7/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "40d2d6922318957f1784dda735f24690baca027c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/40d2d6922318957f1784dda735f24690baca027c",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/40d2d6922318957f1784dda735f24690baca027c"
      }
    ],
    "stats": {
      "total": 14,
      "additions": 12,
      "deletions": 2
    },
    "files": [
      {
        "sha": "031b9db4804cefd4af4cc43e1c2aead895d9016e",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 1,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/3da434a2ef9ac76a0ad4a33921773a9ac8f10ab7/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/3da434a2ef9ac76a0ad4a33921773a9ac8f10ab7/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=3da434a2ef9ac76a0ad4a33921773a9ac8f10ab7",
        "patch": "@@ -248,6 +248,7 @@ std::string HelpMessage(HelpMessageMode mode)\n     strUsage += \"  -maxsendbuffer=<n>     \" + _(\"Maximum per-connection send buffer, <n>*1000 bytes (default: 1000)\") + \"\\n\";\n     strUsage += \"  -onion=<ip:port>       \" + _(\"Use separate SOCKS5 proxy to reach peers via Tor hidden services (default: -proxy)\") + \"\\n\";\n     strUsage += \"  -onlynet=<net>         \" + _(\"Only connect to nodes in network <net> (IPv4, IPv6 or Tor)\") + \"\\n\";\n+    strUsage += \"  -permitbaremultisig    \" + _(\"Relay non-P2SH multisig (default: 1)\") + \"\\n\";\n     strUsage += \"  -port=<port>           \" + _(\"Listen for connections on <port> (default: 8333 or testnet: 18333)\") + \"\\n\";\n     strUsage += \"  -proxy=<ip:port>       \" + _(\"Connect through SOCKS5 proxy\") + \"\\n\";\n     strUsage += \"  -seednode=<ip>         \" + _(\"Connect to a node to retrieve peer addresses, and disconnect\") + \"\\n\";\n@@ -676,7 +677,10 @@ bool AppInit2(boost::thread_group& threadGroup)\n     bSpendZeroConfChange = GetArg(\"-spendzeroconfchange\", true);\n \n     std::string strWalletFile = GetArg(\"-wallet\", \"wallet.dat\");\n-#endif\n+#endif // ENABLE_WALLET\n+\n+    fIsBareMultisigStd = GetArg(\"-permitbaremultisig\", true);\n+\n     // ********************************************************* Step 4: application initialization: dir lock, daemonize, pidfile, debug log\n     // Sanity check\n     if (!InitSanityCheck())"
      },
      {
        "sha": "dd9e76378e96181385409879e49f41893f18a859",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 1,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/3da434a2ef9ac76a0ad4a33921773a9ac8f10ab7/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/3da434a2ef9ac76a0ad4a33921773a9ac8f10ab7/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=3da434a2ef9ac76a0ad4a33921773a9ac8f10ab7",
        "patch": "@@ -48,6 +48,7 @@ bool fImporting = false;\n bool fReindex = false;\n bool fBenchmark = false;\n bool fTxIndex = false;\n+bool fIsBareMultisigStd = true;\n unsigned int nCoinCacheSize = 5000;\n \n /** Fees smaller than this (in satoshi) are considered zero fee (for relaying and mining) */\n@@ -604,9 +605,13 @@ bool IsStandardTx(const CTransaction& tx, string& reason)\n             reason = \"scriptpubkey\";\n             return false;\n         }\n+\n         if (whichType == TX_NULL_DATA)\n             nDataOut++;\n-        else if (txout.IsDust(::minRelayTxFee)) {\n+        else if ((whichType == TX_MULTISIG) && (!fIsBareMultisigStd)) {\n+            reason = \"bare-multisig\";\n+            return false;\n+        } else if (txout.IsDust(::minRelayTxFee)) {\n             reason = \"dust\";\n             return false;\n         }"
      },
      {
        "sha": "20a83db60519ec38c4fcc6152c63176f2473e123",
        "filename": "src/main.h",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/3da434a2ef9ac76a0ad4a33921773a9ac8f10ab7/src/main.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/3da434a2ef9ac76a0ad4a33921773a9ac8f10ab7/src/main.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.h?ref=3da434a2ef9ac76a0ad4a33921773a9ac8f10ab7",
        "patch": "@@ -94,6 +94,7 @@ extern bool fReindex;\n extern bool fBenchmark;\n extern int nScriptCheckThreads;\n extern bool fTxIndex;\n+extern bool fIsBareMultisigStd;\n extern unsigned int nCoinCacheSize;\n extern CFeeRate minRelayTxFee;\n "
      }
    ]
  }
]