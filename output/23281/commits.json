[
  {
    "sha": "4ac8c89ad96de9ad61cad756b10c9dee2d9e1405",
    "node_id": "C_kwDOABII59oAKDRhYzhjODlhZDk2ZGU5YWQ2MWNhZDc1NmIxMGM5ZGVlMmQ5ZTE0MDU",
    "commit": {
      "author": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2021-10-15T00:18:51Z"
      },
      "committer": {
        "name": "Sebastian Falbesoner",
        "email": "sebastian.falbesoner@gmail.com",
        "date": "2021-10-15T00:38:18Z"
      },
      "message": "test: check that bumpfee RPC fails for txs with descendants in mempool\n\nThis commit adds missing test coverage for the bumpfee RPC\nerror \"Transaction has descendants in the mempool\", which is\nthrown if the bumped tx has descendants in the mempool and is\n_not_ connected to the bitcoin wallet. To achieve that, the\ntest framework's MiniWallet is used.",
      "tree": {
        "sha": "3659113c1709e049076afca9fc0ef6013f6054b2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3659113c1709e049076afca9fc0ef6013f6054b2"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4ac8c89ad96de9ad61cad756b10c9dee2d9e1405",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4ac8c89ad96de9ad61cad756b10c9dee2d9e1405",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/4ac8c89ad96de9ad61cad756b10c9dee2d9e1405",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4ac8c89ad96de9ad61cad756b10c9dee2d9e1405/comments",
    "author": {
      "login": "theStack",
      "id": 91535,
      "node_id": "MDQ6VXNlcjkxNTM1",
      "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theStack",
      "html_url": "https://github.com/theStack",
      "followers_url": "https://api.github.com/users/theStack/followers",
      "following_url": "https://api.github.com/users/theStack/following{/other_user}",
      "gists_url": "https://api.github.com/users/theStack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theStack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
      "organizations_url": "https://api.github.com/users/theStack/orgs",
      "repos_url": "https://api.github.com/users/theStack/repos",
      "events_url": "https://api.github.com/users/theStack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theStack/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "theStack",
      "id": 91535,
      "node_id": "MDQ6VXNlcjkxNTM1",
      "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theStack",
      "html_url": "https://github.com/theStack",
      "followers_url": "https://api.github.com/users/theStack/followers",
      "following_url": "https://api.github.com/users/theStack/following{/other_user}",
      "gists_url": "https://api.github.com/users/theStack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theStack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
      "organizations_url": "https://api.github.com/users/theStack/orgs",
      "repos_url": "https://api.github.com/users/theStack/repos",
      "events_url": "https://api.github.com/users/theStack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theStack/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "6419bdfeb130b20ccfed229d9ba7eca7f385d036",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6419bdfeb130b20ccfed229d9ba7eca7f385d036",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/6419bdfeb130b20ccfed229d9ba7eca7f385d036"
      }
    ],
    "stats": {
      "total": 10,
      "additions": 10,
      "deletions": 0
    },
    "files": [
      {
        "sha": "46a5df4a8e89947e5fea110e8c4e44286d77fb6d",
        "filename": "test/functional/wallet_bumpfee.py",
        "status": "modified",
        "additions": 10,
        "deletions": 0,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4ac8c89ad96de9ad61cad756b10c9dee2d9e1405/test/functional/wallet_bumpfee.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4ac8c89ad96de9ad61cad756b10c9dee2d9e1405/test/functional/wallet_bumpfee.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/wallet_bumpfee.py?ref=4ac8c89ad96de9ad61cad756b10c9dee2d9e1405",
        "patch": "@@ -32,6 +32,8 @@\n     assert_greater_than,\n     assert_raises_rpc_error,\n )\n+from test_framework.wallet import MiniWallet\n+\n \n WALLET_PASSPHRASE = \"test\"\n WALLET_PASSPHRASE_TIMEOUT = 3600\n@@ -265,6 +267,14 @@ def test_bumpfee_with_descendant_fails(self, rbf_node, rbf_node_address, dest_ad\n     tx = rbf_node.signrawtransactionwithwallet(tx)\n     rbf_node.sendrawtransaction(tx[\"hex\"])\n     assert_raises_rpc_error(-8, \"Transaction has descendants in the wallet\", rbf_node.bumpfee, parent_id)\n+\n+    # create tx with descendant in the mempool by using MiniWallet\n+    miniwallet = MiniWallet(rbf_node)\n+    parent_id = spend_one_input(rbf_node, miniwallet.get_address())\n+    tx = rbf_node.gettransaction(txid=parent_id, verbose=True)['decoded']\n+    miniwallet.scan_tx(tx)\n+    miniwallet.send_self_transfer(from_node=rbf_node)\n+    assert_raises_rpc_error(-8, \"Transaction has descendants in the mempool\", rbf_node.bumpfee, parent_id)\n     self.clear_mempool()\n \n "
      }
    ]
  }
]