[
  {
    "sha": "40c58866c7e7af3582cefb9b1810a20902e44167",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0MGM1ODg2NmM3ZTdhZjM1ODJjZWZiOWIxODEwYTIwOTAyZTQ0MTY3",
    "commit": {
      "author": {
        "name": "251",
        "email": "13120787+251Labs@users.noreply.github.com",
        "date": "2018-03-08T19:58:57Z"
      },
      "committer": {
        "name": "251",
        "email": "13120787+251labs@users.noreply.github.com",
        "date": "2018-04-10T20:22:55Z"
      },
      "message": "Fix illegal default `addProxy` and `addrSeparateProxyTor` settings.",
      "tree": {
        "sha": "f7aa8df4b7a236bb1e61034534e2d8948a1a22eb",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f7aa8df4b7a236bb1e61034534e2d8948a1a22eb"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/40c58866c7e7af3582cefb9b1810a20902e44167",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/40c58866c7e7af3582cefb9b1810a20902e44167",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/40c58866c7e7af3582cefb9b1810a20902e44167",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/40c58866c7e7af3582cefb9b1810a20902e44167/comments",
    "author": {
      "login": "l2a5b1",
      "id": 13120787,
      "node_id": "MDQ6VXNlcjEzMTIwNzg3",
      "avatar_url": "https://avatars.githubusercontent.com/u/13120787?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/l2a5b1",
      "html_url": "https://github.com/l2a5b1",
      "followers_url": "https://api.github.com/users/l2a5b1/followers",
      "following_url": "https://api.github.com/users/l2a5b1/following{/other_user}",
      "gists_url": "https://api.github.com/users/l2a5b1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/l2a5b1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/l2a5b1/subscriptions",
      "organizations_url": "https://api.github.com/users/l2a5b1/orgs",
      "repos_url": "https://api.github.com/users/l2a5b1/repos",
      "events_url": "https://api.github.com/users/l2a5b1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/l2a5b1/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "l2a5b1",
      "id": 13120787,
      "node_id": "MDQ6VXNlcjEzMTIwNzg3",
      "avatar_url": "https://avatars.githubusercontent.com/u/13120787?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/l2a5b1",
      "html_url": "https://github.com/l2a5b1",
      "followers_url": "https://api.github.com/users/l2a5b1/followers",
      "following_url": "https://api.github.com/users/l2a5b1/following{/other_user}",
      "gists_url": "https://api.github.com/users/l2a5b1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/l2a5b1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/l2a5b1/subscriptions",
      "organizations_url": "https://api.github.com/users/l2a5b1/orgs",
      "repos_url": "https://api.github.com/users/l2a5b1/repos",
      "events_url": "https://api.github.com/users/l2a5b1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/l2a5b1/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "048ac8326b6952244f6e4453f4f8f6ab423eb926",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/048ac8326b6952244f6e4453f4f8f6ab423eb926",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/048ac8326b6952244f6e4453f4f8f6ab423eb926"
      }
    ],
    "stats": {
      "total": 23,
      "additions": 21,
      "deletions": 2
    },
    "files": [
      {
        "sha": "cae9dace4c329ecdfc59a9901bf79902c24d6497",
        "filename": "src/qt/optionsmodel.cpp",
        "status": "modified",
        "additions": 21,
        "deletions": 2,
        "changes": 23,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/40c58866c7e7af3582cefb9b1810a20902e44167/src/qt/optionsmodel.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/40c58866c7e7af3582cefb9b1810a20902e44167/src/qt/optionsmodel.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/optionsmodel.cpp?ref=40c58866c7e7af3582cefb9b1810a20902e44167",
        "patch": "@@ -24,6 +24,8 @@\n \n const char *DEFAULT_GUI_PROXY_HOST = \"127.0.0.1\";\n \n+static const QString GetDefaultProxyAddress();\n+\n OptionsModel::OptionsModel(interfaces::Node& node, QObject *parent, bool resetSettings) :\n     QAbstractListModel(parent), m_node(node)\n {\n@@ -121,7 +123,7 @@ void OptionsModel::Init(bool resetSettings)\n     if (!settings.contains(\"fUseProxy\"))\n         settings.setValue(\"fUseProxy\", false);\n     if (!settings.contains(\"addrProxy\"))\n-        settings.setValue(\"addrProxy\", QString(\"%1:%2\").arg(DEFAULT_GUI_PROXY_HOST, DEFAULT_GUI_PROXY_PORT));\n+        settings.setValue(\"addrProxy\", GetDefaultProxyAddress());\n     // Only try to set -proxy, if user has enabled fUseProxy\n     if (settings.value(\"fUseProxy\").toBool() && !m_node.softSetArg(\"-proxy\", settings.value(\"addrProxy\").toString().toStdString()))\n         addOverriddenOption(\"-proxy\");\n@@ -131,7 +133,7 @@ void OptionsModel::Init(bool resetSettings)\n     if (!settings.contains(\"fUseSeparateProxyTor\"))\n         settings.setValue(\"fUseSeparateProxyTor\", false);\n     if (!settings.contains(\"addrSeparateProxyTor\"))\n-        settings.setValue(\"addrSeparateProxyTor\", QString(\"%1:%2\").arg(DEFAULT_GUI_PROXY_HOST, DEFAULT_GUI_PROXY_PORT));\n+        settings.setValue(\"addrSeparateProxyTor\", GetDefaultProxyAddress());\n     // Only try to set -onion, if user has enabled fUseSeparateProxyTor\n     if (settings.value(\"fUseSeparateProxyTor\").toBool() && !m_node.softSetArg(\"-onion\", settings.value(\"addrSeparateProxyTor\").toString().toStdString()))\n         addOverriddenOption(\"-onion\");\n@@ -223,6 +225,11 @@ static void SetProxySetting(QSettings &settings, const QString &name, const Prox\n     settings.setValue(name, ip_port.ip + \":\" + ip_port.port);\n }\n \n+static const QString GetDefaultProxyAddress()\n+{\n+    return QString(\"%1:%2\").arg(DEFAULT_GUI_PROXY_HOST).arg(DEFAULT_GUI_PROXY_PORT);\n+}\n+\n // read QSettings values and return them\n QVariant OptionsModel::data(const QModelIndex & index, int role) const\n {\n@@ -485,4 +492,16 @@ void OptionsModel::checkAndMigrate()\n \n         settings.setValue(strSettingsVersionKey, CLIENT_VERSION);\n     }\n+\n+    // Overwrite the 'addrProxy' setting in case it has been set to an illegal\n+    // default value (see issue #12623; PR #12650).\n+    if (settings.contains(\"addrProxy\") && settings.value(\"addrProxy\").toString().endsWith(\"%2\")) {\n+        settings.setValue(\"addrProxy\", GetDefaultProxyAddress());\n+    }\n+\n+    // Overwrite the 'addrSeparateProxyTor' setting in case it has been set to an illegal\n+    // default value (see issue #12623; PR #12650).\n+    if (settings.contains(\"addrSeparateProxyTor\") && settings.value(\"addrSeparateProxyTor\").toString().endsWith(\"%2\")) {\n+        settings.setValue(\"addrSeparateProxyTor\", GetDefaultProxyAddress());\n+    }\n }"
      }
    ]
  }
]