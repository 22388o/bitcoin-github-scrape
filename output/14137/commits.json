[
  {
    "sha": "18eb4dbb8aa06451c84fd178efa040b6b6de24bc",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxOGViNGRiYjhhYTA2NDUxYzg0ZmQxNzhlZmEwNDBiNmI2ZGUyNGJj",
    "commit": {
      "author": {
        "name": "Chun Kuan Lee",
        "email": "ken2812221@gmail.com",
        "date": "2018-09-03T03:14:44Z"
      },
      "committer": {
        "name": "Chun Kuan Lee",
        "email": "ken2812221@gmail.com",
        "date": "2018-11-10T14:24:20Z"
      },
      "message": "gui: Add Windows taskbar progress",
      "tree": {
        "sha": "f58b902adc651ce06d1b78ba84d5f27120999305",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f58b902adc651ce06d1b78ba84d5f27120999305"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/18eb4dbb8aa06451c84fd178efa040b6b6de24bc",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/18eb4dbb8aa06451c84fd178efa040b6b6de24bc",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/18eb4dbb8aa06451c84fd178efa040b6b6de24bc",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/18eb4dbb8aa06451c84fd178efa040b6b6de24bc/comments",
    "author": {
      "login": "ken2812221",
      "id": 11154118,
      "node_id": "MDQ6VXNlcjExMTU0MTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/11154118?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ken2812221",
      "html_url": "https://github.com/ken2812221",
      "followers_url": "https://api.github.com/users/ken2812221/followers",
      "following_url": "https://api.github.com/users/ken2812221/following{/other_user}",
      "gists_url": "https://api.github.com/users/ken2812221/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ken2812221/subscriptions",
      "organizations_url": "https://api.github.com/users/ken2812221/orgs",
      "repos_url": "https://api.github.com/users/ken2812221/repos",
      "events_url": "https://api.github.com/users/ken2812221/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ken2812221/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "ken2812221",
      "id": 11154118,
      "node_id": "MDQ6VXNlcjExMTU0MTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/11154118?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ken2812221",
      "html_url": "https://github.com/ken2812221",
      "followers_url": "https://api.github.com/users/ken2812221/followers",
      "following_url": "https://api.github.com/users/ken2812221/following{/other_user}",
      "gists_url": "https://api.github.com/users/ken2812221/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ken2812221/subscriptions",
      "organizations_url": "https://api.github.com/users/ken2812221/orgs",
      "repos_url": "https://api.github.com/users/ken2812221/repos",
      "events_url": "https://api.github.com/users/ken2812221/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ken2812221/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "edc715240cb6738262ae96dea476544052eb5351",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/edc715240cb6738262ae96dea476544052eb5351",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/edc715240cb6738262ae96dea476544052eb5351"
      }
    ],
    "stats": {
      "total": 46,
      "additions": 42,
      "deletions": 4
    },
    "files": [
      {
        "sha": "73d9b015098f9c13412059cf32db6cc875746f88",
        "filename": "build-aux/m4/bitcoin_qt.m4",
        "status": "modified",
        "additions": 4,
        "deletions": 0,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/18eb4dbb8aa06451c84fd178efa040b6b6de24bc/build-aux/m4/bitcoin_qt.m4",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/18eb4dbb8aa06451c84fd178efa040b6b6de24bc/build-aux/m4/bitcoin_qt.m4",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/build-aux/m4/bitcoin_qt.m4?ref=18eb4dbb8aa06451c84fd178efa040b6b6de24bc",
        "patch": "@@ -410,6 +410,7 @@ AC_DEFUN([_BITCOIN_QT_FIND_STATIC_PLUGINS],[\n              BITCOIN_QT_CHECK(AC_CHECK_LIB([${QT_LIB_PREFIX}FbSupport],[main],,BITCOIN_QT_FAIL(lib$QT_LIB_PREFIXFbSupport not found)))\n              BITCOIN_QT_CHECK(AC_CHECK_LIB([${QT_LIB_PREFIX}DeviceDiscoverySupport],[main],,BITCOIN_QT_FAIL(lib$QT_LIB_PREFIXDeviceDiscoverySupport not found)))\n              BITCOIN_QT_CHECK(AC_CHECK_LIB([${QT_LIB_PREFIX}AccessibilitySupport],[main],,BITCOIN_QT_FAIL(lib$QT_LIB_PREFIXAccessibilitySupport not found)))\n+             BITCOIN_QT_CHECK(AC_CHECK_LIB([${QT_LIB_PREFIX}WinExtras],[main],,BITCOIN_QT_FAIL(lib$QT_LIB_PREFIXWinExtras not found)))\n              QT_LIBS=\"$QT_LIBS -lversion -ldwmapi -luxtheme\"\n            fi\n          fi\n@@ -461,6 +462,9 @@ AC_DEFUN([_BITCOIN_QT_FIND_LIBS_WITHOUT_PKGCONFIG],[\n   BITCOIN_QT_CHECK([\n     if test \"x$qt_include_path\" != x; then\n       QT_INCLUDES=\"-I$qt_include_path -I$qt_include_path/QtCore -I$qt_include_path/QtGui -I$qt_include_path/QtWidgets -I$qt_include_path/QtNetwork -I$qt_include_path/QtTest -I$qt_include_path/QtDBus\"\n+      if test \"x$TARGET_OS\" = xwindows; then\n+        QT_INCLUDES=\"$QT_INCLUDES -I$qt_include_path/QtWinExtras\"\n+      fi\n       CPPFLAGS=\"$QT_INCLUDES $CPPFLAGS\"\n     fi\n   ])"
      },
      {
        "sha": "ac7fc1aa4bb060cbf510970090ffdf3f79dca56a",
        "filename": "configure.ac",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/18eb4dbb8aa06451c84fd178efa040b6b6de24bc/configure.ac",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/18eb4dbb8aa06451c84fd178efa040b6b6de24bc/configure.ac",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/configure.ac?ref=18eb4dbb8aa06451c84fd178efa040b6b6de24bc",
        "patch": "@@ -462,6 +462,7 @@ case $host in\n      AC_CHECK_LIB([shlwapi],      [main],, AC_MSG_ERROR(libshlwapi missing))\n      AC_CHECK_LIB([iphlpapi],      [main],, AC_MSG_ERROR(libiphlpapi missing))\n      AC_CHECK_LIB([crypt32],      [main],, AC_MSG_ERROR(libcrypt32 missing))\n+     AC_CHECK_LIB([dwmapi],      [main],, AC_MSG_ERROR(libdwmapi missing))\n \n      # -static is interpreted by libtool, where it has a different meaning.\n      # In libtool-speak, it's -all-static."
      },
      {
        "sha": "25b52bf585810c5d275e382797f248db41e0a42e",
        "filename": "depends/Makefile",
        "status": "modified",
        "additions": 2,
        "deletions": 1,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/18eb4dbb8aa06451c84fd178efa040b6b6de24bc/depends/Makefile",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/18eb4dbb8aa06451c84fd178efa040b6b6de24bc/depends/Makefile",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/Makefile?ref=18eb4dbb8aa06451c84fd178efa040b6b6de24bc",
        "patch": "@@ -159,7 +159,8 @@ endef\n \n define check_or_remove_sources\n   mkdir -p $($(package)_source_dir); cd $($(package)_source_dir); \\\n-  test -f $($(package)_fetched) && ( $(build_SHA256SUM) -c $($(package)_fetched) >/dev/null 2>/dev/null || \\\n+  test -f $($(package)_fetched) && ( test `cat $($(package)_fetched) | wc -l` -eq $(words $($(package)_all_sources)) && \\\n+    $(build_SHA256SUM) -c $($(package)_fetched) >/dev/null 2>/dev/null || \\\n     ( echo \"Checksum missing or mismatched for $(package) source. Forcing re-download.\"; \\\n       rm -f $($(package)_all_sources) $($(1)_fetched))) || true\n endef"
      },
      {
        "sha": "b699f82737f99f3d83d39549bf45f3b16e60a5a5",
        "filename": "depends/packages/qt.mk",
        "status": "modified",
        "additions": 14,
        "deletions": 3,
        "changes": 17,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/18eb4dbb8aa06451c84fd178efa040b6b6de24bc/depends/packages/qt.mk",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/18eb4dbb8aa06451c84fd178efa040b6b6de24bc/depends/packages/qt.mk",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/packages/qt.mk?ref=18eb4dbb8aa06451c84fd178efa040b6b6de24bc",
        "patch": "@@ -16,8 +16,12 @@ $(package)_qttranslations_sha256_hash=9822084f8e2d2939ba39f4af4c0c2320e45d599676\n $(package)_qttools_file_name=qttools-$($(package)_suffix)\n $(package)_qttools_sha256_hash=50e75417ec0c74bb8b1989d1d8e981ee83690dce7dfc0c2169f7c00f397e5117\n \n+$(package)_qtwinextras_file_name=qtwinextras-$($(package)_suffix)\n+$(package)_qtwinextras_sha256_hash=794090446d33eecf9eb3f3a4f6f13b3e7ab5307936f8d21e4a76e7b6ba79125d\n+\n $(package)_extra_sources  = $($(package)_qttranslations_file_name)\n $(package)_extra_sources += $($(package)_qttools_file_name)\n+$(package)_extra_sources += $($(package)_qtwinextras_file_name)\n \n define $(package)_set_vars\n $(package)_config_opts_release = -release\n@@ -103,21 +107,25 @@ endef\n define $(package)_fetch_cmds\n $(call fetch_file,$(package),$($(package)_download_path),$($(package)_download_file),$($(package)_file_name),$($(package)_sha256_hash)) && \\\n $(call fetch_file,$(package),$($(package)_download_path),$($(package)_qttranslations_file_name),$($(package)_qttranslations_file_name),$($(package)_qttranslations_sha256_hash)) && \\\n-$(call fetch_file,$(package),$($(package)_download_path),$($(package)_qttools_file_name),$($(package)_qttools_file_name),$($(package)_qttools_sha256_hash))\n+$(call fetch_file,$(package),$($(package)_download_path),$($(package)_qttools_file_name),$($(package)_qttools_file_name),$($(package)_qttools_sha256_hash)) && \\\n+$(call fetch_file,$(package),$($(package)_download_path),$($(package)_qtwinextras_file_name),$($(package)_qtwinextras_file_name),$($(package)_qtwinextras_sha256_hash))\n endef\n \n define $(package)_extract_cmds\n   mkdir -p $($(package)_extract_dir) && \\\n   echo \"$($(package)_sha256_hash)  $($(package)_source)\" > $($(package)_extract_dir)/.$($(package)_file_name).hash && \\\n   echo \"$($(package)_qttranslations_sha256_hash)  $($(package)_source_dir)/$($(package)_qttranslations_file_name)\" >> $($(package)_extract_dir)/.$($(package)_file_name).hash && \\\n   echo \"$($(package)_qttools_sha256_hash)  $($(package)_source_dir)/$($(package)_qttools_file_name)\" >> $($(package)_extract_dir)/.$($(package)_file_name).hash && \\\n+  echo \"$($(package)_qtwinextras_sha256_hash)  $($(package)_source_dir)/$($(package)_qtwinextras_file_name)\" >> $($(package)_extract_dir)/.$($(package)_file_name).hash && \\\n   $(build_SHA256SUM) -c $($(package)_extract_dir)/.$($(package)_file_name).hash && \\\n   mkdir qtbase && \\\n   tar --strip-components=1 -xf $($(package)_source) -C qtbase && \\\n   mkdir qttranslations && \\\n   tar --strip-components=1 -xf $($(package)_source_dir)/$($(package)_qttranslations_file_name) -C qttranslations && \\\n   mkdir qttools && \\\n-  tar --strip-components=1 -xf $($(package)_source_dir)/$($(package)_qttools_file_name) -C qttools\n+  tar --strip-components=1 -xf $($(package)_source_dir)/$($(package)_qttools_file_name) -C qttools && \\\n+  mkdir qtwinextras && \\\n+  tar --strip-components=1 -xf $($(package)_source_dir)/$($(package)_qtwinextras_file_name) -C qtwinextras\n endef\n \n define $(package)_preprocess_cmds\n@@ -161,6 +169,7 @@ define $(package)_config_cmds\n   $(MAKE) sub-src-clean && \\\n   cd ../qttranslations && ../qtbase/bin/qmake qttranslations.pro -o Makefile && \\\n   cd translations && ../../qtbase/bin/qmake translations.pro -o Makefile && cd ../.. && \\\n+  cd qtwinextras && ../qtbase/bin/qmake qtwinextras.pro -o Makefile && cd .. && \\\n   cd qttools/src/linguist/lrelease/ && ../../../../qtbase/bin/qmake lrelease.pro -o Makefile && \\\n   cd ../lupdate/ && ../../../../qtbase/bin/qmake lupdate.pro -o Makefile && cd ../../../..\n endef\n@@ -169,14 +178,16 @@ define $(package)_build_cmds\n   $(MAKE) -C src $(addprefix sub-,$($(package)_qt_libs)) && \\\n   $(MAKE) -C ../qttools/src/linguist/lrelease && \\\n   $(MAKE) -C ../qttools/src/linguist/lupdate && \\\n-  $(MAKE) -C ../qttranslations\n+  $(MAKE) -C ../qttranslations && \\\n+  $(MAKE) -C ../qtwinextras\n endef\n \n define $(package)_stage_cmds\n   $(MAKE) -C src INSTALL_ROOT=$($(package)_staging_dir) $(addsuffix -install_subtargets,$(addprefix sub-,$($(package)_qt_libs))) && cd .. && \\\n   $(MAKE) -C qttools/src/linguist/lrelease INSTALL_ROOT=$($(package)_staging_dir) install_target && \\\n   $(MAKE) -C qttools/src/linguist/lupdate INSTALL_ROOT=$($(package)_staging_dir) install_target && \\\n   $(MAKE) -C qttranslations INSTALL_ROOT=$($(package)_staging_dir) install_subtargets && \\\n+  $(MAKE) -C qtwinextras INSTALL_ROOT=$($(package)_staging_dir) install_subtargets && \\\n   if `test -f qtbase/src/plugins/platforms/xcb/xcb-static/libxcb-static.a`; then \\\n     cp qtbase/src/plugins/platforms/xcb/xcb-static/libxcb-static.a $($(package)_staging_prefix_dir)/lib; \\\n   fi"
      },
      {
        "sha": "8818aef7f146d752f38c3aa59569b49ea649c2fe",
        "filename": "src/qt/bitcoingui.cpp",
        "status": "modified",
        "additions": 17,
        "deletions": 0,
        "changes": 17,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/18eb4dbb8aa06451c84fd178efa040b6b6de24bc/src/qt/bitcoingui.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/18eb4dbb8aa06451c84fd178efa040b6b6de24bc/src/qt/bitcoingui.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoingui.cpp?ref=18eb4dbb8aa06451c84fd178efa040b6b6de24bc",
        "patch": "@@ -26,6 +26,9 @@\n \n #ifdef Q_OS_MAC\n #include <qt/macdockiconhandler.h>\n+#elif defined Q_OS_WIN\n+#include <QWinTaskbarButton>\n+#include <QWinTaskbarProgress>\n #endif\n \n #include <chainparams.h>\n@@ -214,6 +217,8 @@ BitcoinGUI::BitcoinGUI(interfaces::Node& node, const PlatformStyle *_platformSty\n \n #ifdef Q_OS_MAC\n     m_app_nap_inhibitor = new CAppNapInhibitor;\n+#elif defined Q_OS_WIN\n+    m_taskbar_button = new QWinTaskbarButton(this);\n #endif\n }\n \n@@ -845,6 +850,11 @@ void BitcoinGUI::setNumBlocks(int count, const QDateTime& blockDate, double nVer\n \n     tooltip = tr(\"Processed %n block(s) of transaction history.\", \"\", count);\n \n+#ifdef Q_OS_WIN\n+    m_taskbar_button->setWindow(windowHandle());\n+    QWinTaskbarProgress* taskbar_progress = m_taskbar_button->progress();\n+#endif\n+\n     // Set icon state: spinning if catching up, tick otherwise\n     if(secs < 90*60)\n     {\n@@ -861,6 +871,9 @@ void BitcoinGUI::setNumBlocks(int count, const QDateTime& blockDate, double nVer\n \n         progressBarLabel->setVisible(false);\n         progressBar->setVisible(false);\n+#ifdef Q_OS_WIN\n+        taskbar_progress->setVisible(false);\n+#endif\n     }\n     else\n     {\n@@ -871,6 +884,10 @@ void BitcoinGUI::setNumBlocks(int count, const QDateTime& blockDate, double nVer\n         progressBar->setMaximum(1000000000);\n         progressBar->setValue(nVerificationProgress * 1000000000.0 + 0.5);\n         progressBar->setVisible(true);\n+#ifdef Q_OS_WIN\n+        taskbar_progress->setValue(nVerificationProgress * 100.0 + 0.5);\n+        taskbar_progress->setVisible(true);\n+#endif\n \n         tooltip = tr(\"Catching up...\") + QString(\"<br>\") + tooltip;\n         if(count != prevBlocks)"
      },
      {
        "sha": "a7292b4409c38d544a10c30fb08583270679e376",
        "filename": "src/qt/bitcoingui.h",
        "status": "modified",
        "additions": 4,
        "deletions": 0,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/18eb4dbb8aa06451c84fd178efa040b6b6de24bc/src/qt/bitcoingui.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/18eb4dbb8aa06451c84fd178efa040b6b6de24bc/src/qt/bitcoingui.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoingui.h?ref=18eb4dbb8aa06451c84fd178efa040b6b6de24bc",
        "patch": "@@ -49,6 +49,7 @@ class QAction;\n class QComboBox;\n class QProgressBar;\n class QProgressDialog;\n+class QWinTaskbarButton;\n QT_END_NAMESPACE\n \n namespace GUIUtil {\n@@ -146,6 +147,9 @@ class BitcoinGUI : public QMainWindow\n     RPCConsole* rpcConsole = nullptr;\n     HelpMessageDialog* helpMessageDialog = nullptr;\n     ModalOverlay* modalOverlay = nullptr;\n+#ifdef Q_OS_WIN\n+    QWinTaskbarButton* m_taskbar_button = nullptr;\n+#endif\n \n #ifdef Q_OS_MAC\n     CAppNapInhibitor* m_app_nap_inhibitor = nullptr;"
      }
    ]
  }
]