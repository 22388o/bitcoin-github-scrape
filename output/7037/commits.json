[
  {
    "sha": "c7121a548b58e3c5b9573f5db62dd35c63bab21f",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpjNzEyMWE1NDhiNThlM2M1Yjk1NzNmNWRiNjJkZDM1YzYzYmFiMjFm",
    "commit": {
      "author": {
        "name": "Gregory Maxwell",
        "email": "greg@xiph.org",
        "date": "2015-11-17T07:03:37Z"
      },
      "committer": {
        "name": "Gregory Maxwell",
        "email": "greg@xiph.org",
        "date": "2015-11-17T07:10:45Z"
      },
      "message": "Move the blocknotify callback ahead of peer announcement.\n\nWizkid057 reported getbestblockhash polling was frequently beating\n blocknotify, sometimes by 2 seconds.  Under the theory that getting\n cs_vNodes and running running PushInventory for all peers was\n sometimes taking a while or UpdatedBlockTip (see below), I\n suggested moving up the notify.  He reported doing so made it\n consistently faster.\n\nI think it's reasonable to signal blocknotify first: All it does\n is fire off a new thread, so it should never block.\n\nThis does not move up GetMainSignals().UpdatedBlockTip() which\n because that signal includes the wallet, and if there is a\n wallet with many keys the wallet processing of a block can\n be quite slow. Unfortunately, it also sends out the ZMQ notify.",
      "tree": {
        "sha": "78441d9b7c10c3c945c3bb03613db58952e6e133",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/78441d9b7c10c3c945c3bb03613db58952e6e133"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c7121a548b58e3c5b9573f5db62dd35c63bab21f",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c7121a548b58e3c5b9573f5db62dd35c63bab21f",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/c7121a548b58e3c5b9573f5db62dd35c63bab21f",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c7121a548b58e3c5b9573f5db62dd35c63bab21f/comments",
    "author": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "87ee0e2dbc1201a5104d524ace32c0134ead019f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/87ee0e2dbc1201a5104d524ace32c0134ead019f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/87ee0e2dbc1201a5104d524ace32c0134ead019f"
      }
    ],
    "stats": {
      "total": 3,
      "additions": 2,
      "deletions": 1
    },
    "files": [
      {
        "sha": "bd08d895129b16cc7144cfb45de46bb202a271f6",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 1,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/c7121a548b58e3c5b9573f5db62dd35c63bab21f/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/c7121a548b58e3c5b9573f5db62dd35c63bab21f/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=c7121a548b58e3c5b9573f5db62dd35c63bab21f",
        "patch": "@@ -2382,6 +2382,8 @@ bool ActivateBestChain(CValidationState &state, const CBlock *pblock) {\n         // Notifications/callbacks that can run without cs_main\n         if (!fInitialDownload) {\n             uint256 hashNewTip = pindexNewTip->GetBlockHash();\n+            // Notify BlockNotify.\n+            uiInterface.NotifyBlockTip(hashNewTip);\n             // Relay inventory, but don't relay old inventory during initial block download.\n             int nBlockEstimate = 0;\n             if (fCheckpointsEnabled)\n@@ -2394,7 +2396,6 @@ bool ActivateBestChain(CValidationState &state, const CBlock *pblock) {\n             }\n             // Notify external listeners about the new tip.\n             GetMainSignals().UpdatedBlockTip(pindexNewTip);\n-            uiInterface.NotifyBlockTip(hashNewTip);\n         }\n     } while(pindexMostWork != chainActive.Tip());\n     CheckBlockIndex(chainparams.GetConsensus());"
      }
    ]
  }
]