dcousens,2015-11-17T07:31:00Z,utACK\n,https://github.com/bitcoin/bitcoin/pull/7037#issuecomment-157298980,157298980,
promag,2015-11-17T11:11:30Z,"It's strange to have the _same_ notification in two different moments.\n\nCan we make the inventory relay asynchronous and as a slot connected to `GetMainSignals().UpdatedBlockTip()`?\n\nIn other words, I don't see these kind of `tweaks` the right way to go, instead a refactor to fix these long operations.\n",https://github.com/bitcoin/bitcoin/pull/7037#issuecomment-157339807,157339807,
sdaftuar,2015-11-17T14:33:38Z,"I agree that it's strange to have notifications effectively three times, but I think we should wait to refactor until after #6494, which is tagged for 0.12.\n\nAlso I'd be surprised if it turns out the p2p block relay operations are slow, but I haven't timed yet; I'll do some analysis.  Anyway what's the reasoning behind having two different notification systems (`UpdatedBlockTip` and `NotifyBlock",https://github.com/bitcoin/bitcoin/pull/7037#issuecomment-157386967,157386967,
sipa,2015-11-17T14:39:19Z,"@sdaftuar One was historically for the wallet and the other for the GUI, but I don't think there is any reason to keep both now.\n",https://github.com/bitcoin/bitcoin/pull/7037#issuecomment-157388231,157388231,
morcos,2015-11-17T14:59:46Z,"Don't forget cvBlockChange which is what lets getblocktemplate know the tip has changed and is called on every block connected or disconnected.  I haven't thought about it until just now, but does it make sense to be calling that inside of ActivateBestChainStep?  I guess it won't be able to do anything until ActivateBestChainStep releases cs_main, at which point it may have received several notifi",https://github.com/bitcoin/bitcoin/pull/7037#issuecomment-157394360,157394360,
promag,2015-11-17T15:16:46Z,"@sdaftuar it would be great to have that analysis. Still, any slot connected to `UpdatedBlockTip` can be blocking causing RPC to wait for the lock.\n",https://github.com/bitcoin/bitcoin/pull/7037#issuecomment-157399957,157399957,
gmaxwell,2015-11-18T04:32:59Z,"@promag They're not in different moments, there is a sequence of things that get notified. And this patch moves the last to the first because when present it's often the most latency critical and it won't block. \n\nThis is sufficient to make blocknotify faster. When the wallet fires is not latency critical.  Fortunately they already use different mechanisms, so it was easy to order them. \n",https://github.com/bitcoin/bitcoin/pull/7037#issuecomment-157602160,157602160,
gmaxwell,2015-11-22T22:44:06Z,"The discussion above leaves me dangling. I think we should do this because its a simple and effectively free performance improvement... that it wouldn't be possible if everything were using the same signals, is IMO just an example of the limitations in that particular approach; but while we do, we should take the benefit available.\n",https://github.com/bitcoin/bitcoin/pull/7037#issuecomment-158815808,158815808,
sipa,2015-11-26T21:28:19Z,utACK. Won't hurt.\n,https://github.com/bitcoin/bitcoin/pull/7037#issuecomment-159995916,159995916,
laanwj,2015-11-27T12:56:03Z,"I don't care about having two signals. \n\nI do think the zmq notify should use this as well. Having the old launch-a-process have less latency than zmq, which we supposedly added to have a lower latency notification mechanism, just isn't acceptable :) (especially if we're talking about seconds here)\n",https://github.com/bitcoin/bitcoin/pull/7037#issuecomment-160133976,160133976,
gmaxwell,2015-11-28T11:28:04Z,"AFAICT ZMQ and the wallet ride on the same notification, and there appears to be no way to control what order they execute in. Suggestions?\n",https://github.com/bitcoin/bitcoin/pull/7037#issuecomment-160278763,160278763,
dcousens,2015-11-30T04:06:44Z,Needs rebase\n,https://github.com/bitcoin/bitcoin/pull/7037#issuecomment-160511591,160511591,
jonasschnelli,2015-11-30T07:20:48Z,IMO we should remove `uiInterface.NotifyBlockTip()` and use `CMainSignals.UpdatedBlockTip()` for the \nblocknotify execution.\n,https://github.com/bitcoin/bitcoin/pull/7037#issuecomment-160542941,160542941,
dcousens,2015-11-30T07:48:30Z,"Agreed with @jonasschnelli, but that will require a larger code change...\n",https://github.com/bitcoin/bitcoin/pull/7037#issuecomment-160546479,160546479,
laanwj,2015-11-30T10:20:36Z,"> IMO we should remove uiInterface.NotifyBlockTip() and use CMainSignals.UpdatedBlockTip() for the \n> blocknotify execution.\n\nFor this to work, no signal handlers should be executing anything expensive. The problem is that the wallet does this, resulting in the problem that this pull tries to mitigate. That should be solved first.\n",https://github.com/bitcoin/bitcoin/pull/7037#issuecomment-160588460,160588460,
sipa,2015-11-30T11:57:51Z,"This is possibly an issue if wallet-based services use this signal to trigger wallet RPCs, as those may complete before the wallet was notified about the change.\n",https://github.com/bitcoin/bitcoin/pull/7037#issuecomment-160609933,160609933,
dcousens,2015-12-01T00:37:46Z,"@sipa then perhaps the wallet should have a 'block' notification of its own,  as,  conceptually, that is what you're saying.  (Users are waiting on both the new block notification AND the wallet notification of having recognised that block, not the wallet 'receiving' the block notification itself)\n",https://github.com/bitcoin/bitcoin/pull/7037#issuecomment-160809335,160809335,
laanwj,2015-12-01T11:25:26Z,"> then perhaps the wallet should have a 'block' notification of its own, as, conceptually, that is what you're saying. \n\nYes, a ProcessedBlock signal on wallet would make sense (if there's any users for that? most wallet users care about transactions, not blocks), as handling becomes more asynchronous it's no longer possible to rely on the fact that core signals mean that anything wallet (or oth",https://github.com/bitcoin/bitcoin/pull/7037#issuecomment-160939609,160939609,
TheBlueMatt,2015-12-02T00:50:21Z,An equivalent change was merged in #7112. This should be closed.\n,https://github.com/bitcoin/bitcoin/pull/7037#issuecomment-161144135,161144135,
dcousens,2015-12-02T03:39:05Z,We should still think about consolidating the signals to avoid these issues in future.  Probably low priority at the moment though.\n,https://github.com/bitcoin/bitcoin/pull/7037#issuecomment-161171369,161171369,
