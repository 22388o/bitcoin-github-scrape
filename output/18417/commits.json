[
  {
    "sha": "a8695db7851dabdda08b2ec9a68d6a27c0e2fdc4",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphODY5NWRiNzg1MWRhYmRkYTA4YjJlYzlhNjhkNmEyN2MwZTJmZGM0",
    "commit": {
      "author": {
        "name": "practicalswift",
        "email": "practicalswift@users.noreply.github.com",
        "date": "2020-03-23T13:55:36Z"
      },
      "committer": {
        "name": "practicalswift",
        "email": "practicalswift@users.noreply.github.com",
        "date": "2020-03-24T14:39:23Z"
      },
      "message": "tests: Add fuzzing harness for functions in addrdb.h",
      "tree": {
        "sha": "b3d8f15b4ef4edeaad668250f7c7a73c08b92c37",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b3d8f15b4ef4edeaad668250f7c7a73c08b92c37"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a8695db7851dabdda08b2ec9a68d6a27c0e2fdc4",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a8695db7851dabdda08b2ec9a68d6a27c0e2fdc4",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/a8695db7851dabdda08b2ec9a68d6a27c0e2fdc4",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a8695db7851dabdda08b2ec9a68d6a27c0e2fdc4/comments",
    "author": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "97b0687501cee77a9170f9e288755a5d268e9bd4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/97b0687501cee77a9170f9e288755a5d268e9bd4",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/97b0687501cee77a9170f9e288755a5d268e9bd4"
      }
    ],
    "stats": {
      "total": 50,
      "additions": 50,
      "deletions": 0
    },
    "files": [
      {
        "sha": "a5b49f6bd7cb2c53a97fba1594f7e1c27fa55648",
        "filename": "src/Makefile.test.include",
        "status": "modified",
        "additions": 7,
        "deletions": 0,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a8695db7851dabdda08b2ec9a68d6a27c0e2fdc4/src/Makefile.test.include",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a8695db7851dabdda08b2ec9a68d6a27c0e2fdc4/src/Makefile.test.include",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.test.include?ref=a8695db7851dabdda08b2ec9a68d6a27c0e2fdc4",
        "patch": "@@ -4,6 +4,7 @@\n \n FUZZ_TARGETS = \\\n   test/fuzz/addr_info_deserialize \\\n+  test/fuzz/addrdb \\\n   test/fuzz/address_deserialize \\\n   test/fuzz/addrman_deserialize \\\n   test/fuzz/asmap \\\n@@ -288,6 +289,12 @@ test_fuzz_addr_info_deserialize_LDADD = $(FUZZ_SUITE_LD_COMMON)\n test_fuzz_addr_info_deserialize_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n test_fuzz_addr_info_deserialize_SOURCES = $(FUZZ_SUITE) test/fuzz/deserialize.cpp\n \n+test_fuzz_addrdb_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES)\n+test_fuzz_addrdb_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n+test_fuzz_addrdb_LDADD = $(FUZZ_SUITE_LD_COMMON)\n+test_fuzz_addrdb_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n+test_fuzz_addrdb_SOURCES = $(FUZZ_SUITE) test/fuzz/addrdb.cpp\n+\n test_fuzz_address_deserialize_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES) -DADDRESS_DESERIALIZE=1\n test_fuzz_address_deserialize_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n test_fuzz_address_deserialize_LDADD = $(FUZZ_SUITE_LD_COMMON)"
      },
      {
        "sha": "f21ff3fac3806edd1ebea931c318cd59960a7d33",
        "filename": "src/test/fuzz/addrdb.cpp",
        "status": "added",
        "additions": 43,
        "deletions": 0,
        "changes": 43,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a8695db7851dabdda08b2ec9a68d6a27c0e2fdc4/src/test/fuzz/addrdb.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a8695db7851dabdda08b2ec9a68d6a27c0e2fdc4/src/test/fuzz/addrdb.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/addrdb.cpp?ref=a8695db7851dabdda08b2ec9a68d6a27c0e2fdc4",
        "patch": "@@ -0,0 +1,43 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <addrdb.h>\n+#include <optional.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+\n+#include <cassert>\n+#include <cstdint>\n+#include <string>\n+#include <vector>\n+\n+void test_one_input(const std::vector<uint8_t>& buffer)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+\n+    const CBanEntry ban_entry = [&] {\n+        switch (fuzzed_data_provider.ConsumeIntegralInRange<int>(0, 3)) {\n+        case 0:\n+            return CBanEntry{fuzzed_data_provider.ConsumeIntegral<int64_t>()};\n+            break;\n+        case 1:\n+            return CBanEntry{fuzzed_data_provider.ConsumeIntegral<int64_t>(), fuzzed_data_provider.PickValueInArray<BanReason>({\n+                                                                                  BanReason::BanReasonUnknown,\n+                                                                                  BanReason::BanReasonNodeMisbehaving,\n+                                                                                  BanReason::BanReasonManuallyAdded,\n+                                                                              })};\n+            break;\n+        case 2: {\n+            const Optional<CBanEntry> ban_entry = ConsumeDeserializable<CBanEntry>(fuzzed_data_provider);\n+            if (ban_entry) {\n+                return *ban_entry;\n+            }\n+            break;\n+        }\n+        }\n+        return CBanEntry{};\n+    }();\n+    assert(!ban_entry.banReasonToString().empty());\n+}"
      }
    ]
  },
  {
    "sha": "43ff0d91f8a4af68e64fd12273133322d44a69ea",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0M2ZmMGQ5MWY4YTRhZjY4ZTY0ZmQxMjI3MzEzMzMyMmQ0NGE2OWVh",
    "commit": {
      "author": {
        "name": "practicalswift",
        "email": "practicalswift@users.noreply.github.com",
        "date": "2020-03-23T14:18:07Z"
      },
      "committer": {
        "name": "practicalswift",
        "email": "practicalswift@users.noreply.github.com",
        "date": "2020-03-24T14:39:23Z"
      },
      "message": "tests: Add fuzzing harness for functions in timedata.h",
      "tree": {
        "sha": "7d25165e870f6314f0a30c8169f101654298fd66",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7d25165e870f6314f0a30c8169f101654298fd66"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/43ff0d91f8a4af68e64fd12273133322d44a69ea",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/43ff0d91f8a4af68e64fd12273133322d44a69ea",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/43ff0d91f8a4af68e64fd12273133322d44a69ea",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/43ff0d91f8a4af68e64fd12273133322d44a69ea/comments",
    "author": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "a8695db7851dabdda08b2ec9a68d6a27c0e2fdc4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a8695db7851dabdda08b2ec9a68d6a27c0e2fdc4",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/a8695db7851dabdda08b2ec9a68d6a27c0e2fdc4"
      }
    ],
    "stats": {
      "total": 36,
      "additions": 36,
      "deletions": 0
    },
    "files": [
      {
        "sha": "3742513cc1b8094613b163b79daf2cf0b9d97c5a",
        "filename": "src/Makefile.test.include",
        "status": "modified",
        "additions": 7,
        "deletions": 0,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/43ff0d91f8a4af68e64fd12273133322d44a69ea/src/Makefile.test.include",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/43ff0d91f8a4af68e64fd12273133322d44a69ea/src/Makefile.test.include",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.test.include?ref=43ff0d91f8a4af68e64fd12273133322d44a69ea",
        "patch": "@@ -98,6 +98,7 @@ FUZZ_TARGETS = \\\n   test/fuzz/string \\\n   test/fuzz/strprintf \\\n   test/fuzz/sub_net_deserialize \\\n+  test/fuzz/timedata \\\n   test/fuzz/transaction \\\n   test/fuzz/tx_in \\\n   test/fuzz/tx_in_deserialize \\\n@@ -853,6 +854,12 @@ test_fuzz_sub_net_deserialize_LDADD = $(FUZZ_SUITE_LD_COMMON)\n test_fuzz_sub_net_deserialize_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n test_fuzz_sub_net_deserialize_SOURCES = $(FUZZ_SUITE) test/fuzz/deserialize.cpp\n \n+test_fuzz_timedata_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES)\n+test_fuzz_timedata_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n+test_fuzz_timedata_LDADD = $(FUZZ_SUITE_LD_COMMON)\n+test_fuzz_timedata_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n+test_fuzz_timedata_SOURCES = $(FUZZ_SUITE) test/fuzz/timedata.cpp\n+\n test_fuzz_transaction_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES)\n test_fuzz_transaction_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n test_fuzz_transaction_LDADD = $(FUZZ_SUITE_LD_COMMON)"
      },
      {
        "sha": "a0e579a88f1c4d0ffe9021f2fe12f16961571a08",
        "filename": "src/test/fuzz/timedata.cpp",
        "status": "added",
        "additions": 29,
        "deletions": 0,
        "changes": 29,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/43ff0d91f8a4af68e64fd12273133322d44a69ea/src/test/fuzz/timedata.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/43ff0d91f8a4af68e64fd12273133322d44a69ea/src/test/fuzz/timedata.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/timedata.cpp?ref=43ff0d91f8a4af68e64fd12273133322d44a69ea",
        "patch": "@@ -0,0 +1,29 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+#include <timedata.h>\n+\n+#include <cstdint>\n+#include <string>\n+#include <vector>\n+\n+void test_one_input(const std::vector<uint8_t>& buffer)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+    const unsigned int max_size = fuzzed_data_provider.ConsumeIntegralInRange<unsigned int>(0, 1000);\n+    // Divide by 2 to avoid signed integer overflow in .median()\n+    const int64_t initial_value = fuzzed_data_provider.ConsumeIntegral<int64_t>() / 2;\n+    CMedianFilter<int64_t> median_filter{max_size, initial_value};\n+    while (fuzzed_data_provider.remaining_bytes() > 0) {\n+        (void)median_filter.median();\n+        assert(median_filter.size() > 0);\n+        assert(static_cast<size_t>(median_filter.size()) == median_filter.sorted().size());\n+        assert(static_cast<unsigned int>(median_filter.size()) <= max_size || max_size == 0);\n+        // Divide by 2 to avoid signed integer overflow in .median()\n+        median_filter.input(fuzzed_data_provider.ConsumeIntegral<int64_t>() / 2);\n+    }\n+}"
      }
    ]
  },
  {
    "sha": "4308aa67e3ea38e3fe5ac84e38a29df36c0d0e10",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0MzA4YWE2N2UzZWEzOGUzZmU1YWM4NGUzOGEyOWRmMzZjMGQwZTEw",
    "commit": {
      "author": {
        "name": "practicalswift",
        "email": "practicalswift@users.noreply.github.com",
        "date": "2020-03-23T15:02:18Z"
      },
      "committer": {
        "name": "practicalswift",
        "email": "practicalswift@users.noreply.github.com",
        "date": "2020-03-24T14:39:23Z"
      },
      "message": "tests: Add fuzzing harness for functions in net_permissions.h",
      "tree": {
        "sha": "b8c543080c83a4a50b1bcb06edb8553f69172d5a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b8c543080c83a4a50b1bcb06edb8553f69172d5a"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4308aa67e3ea38e3fe5ac84e38a29df36c0d0e10",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4308aa67e3ea38e3fe5ac84e38a29df36c0d0e10",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/4308aa67e3ea38e3fe5ac84e38a29df36c0d0e10",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4308aa67e3ea38e3fe5ac84e38a29df36c0d0e10/comments",
    "author": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "43ff0d91f8a4af68e64fd12273133322d44a69ea",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/43ff0d91f8a4af68e64fd12273133322d44a69ea",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/43ff0d91f8a4af68e64fd12273133322d44a69ea"
      }
    ],
    "stats": {
      "total": 58,
      "additions": 58,
      "deletions": 0
    },
    "files": [
      {
        "sha": "e2614578a84e704d2069683e3d00fe8fde17f903",
        "filename": "src/Makefile.test.include",
        "status": "modified",
        "additions": 7,
        "deletions": 0,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4308aa67e3ea38e3fe5ac84e38a29df36c0d0e10/src/Makefile.test.include",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4308aa67e3ea38e3fe5ac84e38a29df36c0d0e10/src/Makefile.test.include",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.test.include?ref=4308aa67e3ea38e3fe5ac84e38a29df36c0d0e10",
        "patch": "@@ -44,6 +44,7 @@ FUZZ_TARGETS = \\\n   test/fuzz/merkle_block_deserialize \\\n   test/fuzz/messageheader_deserialize \\\n   test/fuzz/multiplication_overflow \\\n+  test/fuzz/net_permissions \\\n   test/fuzz/netaddr_deserialize \\\n   test/fuzz/netaddress \\\n   test/fuzz/out_point_deserialize \\\n@@ -530,6 +531,12 @@ test_fuzz_multiplication_overflow_LDADD = $(FUZZ_SUITE_LD_COMMON)\n test_fuzz_multiplication_overflow_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n test_fuzz_multiplication_overflow_SOURCES = $(FUZZ_SUITE) test/fuzz/multiplication_overflow.cpp\n \n+test_fuzz_net_permissions_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES)\n+test_fuzz_net_permissions_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n+test_fuzz_net_permissions_LDADD = $(FUZZ_SUITE_LD_COMMON)\n+test_fuzz_net_permissions_LDFLAGS = $(RELDFLAGS) $(AM_LDFLAGS) $(LIBTOOL_APP_LDFLAGS)\n+test_fuzz_net_permissions_SOURCES = $(FUZZ_SUITE) test/fuzz/net_permissions.cpp\n+\n test_fuzz_netaddr_deserialize_CPPFLAGS = $(AM_CPPFLAGS) $(BITCOIN_INCLUDES) -DNETADDR_DESERIALIZE=1\n test_fuzz_netaddr_deserialize_CXXFLAGS = $(AM_CXXFLAGS) $(PIE_FLAGS)\n test_fuzz_netaddr_deserialize_LDADD = $(FUZZ_SUITE_LD_COMMON)"
      },
      {
        "sha": "bfc5d214278199b12a81040d882d5ebe8a1a6b5b",
        "filename": "src/test/fuzz/net_permissions.cpp",
        "status": "added",
        "additions": 51,
        "deletions": 0,
        "changes": 51,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4308aa67e3ea38e3fe5ac84e38a29df36c0d0e10/src/test/fuzz/net_permissions.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4308aa67e3ea38e3fe5ac84e38a29df36c0d0e10/src/test/fuzz/net_permissions.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/net_permissions.cpp?ref=4308aa67e3ea38e3fe5ac84e38a29df36c0d0e10",
        "patch": "@@ -0,0 +1,51 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <net_permissions.h>\n+#include <optional.h>\n+#include <test/fuzz/FuzzedDataProvider.h>\n+#include <test/fuzz/fuzz.h>\n+#include <test/fuzz/util.h>\n+\n+#include <cassert>\n+#include <cstdint>\n+#include <string>\n+#include <vector>\n+\n+void test_one_input(const std::vector<uint8_t>& buffer)\n+{\n+    FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+    const std::string s = fuzzed_data_provider.ConsumeRandomLengthString(32);\n+    const NetPermissionFlags net_permission_flags = fuzzed_data_provider.ConsumeBool() ? fuzzed_data_provider.PickValueInArray<NetPermissionFlags>({\n+                                                                                             NetPermissionFlags::PF_NONE,\n+                                                                                             NetPermissionFlags::PF_BLOOMFILTER,\n+                                                                                             NetPermissionFlags::PF_RELAY,\n+                                                                                             NetPermissionFlags::PF_FORCERELAY,\n+                                                                                             NetPermissionFlags::PF_NOBAN,\n+                                                                                             NetPermissionFlags::PF_MEMPOOL,\n+                                                                                             NetPermissionFlags::PF_ISIMPLICIT,\n+                                                                                             NetPermissionFlags::PF_ALL,\n+                                                                                         }) :\n+                                                                                         static_cast<NetPermissionFlags>(fuzzed_data_provider.ConsumeIntegral<uint32_t>());\n+\n+    NetWhitebindPermissions net_whitebind_permissions;\n+    std::string error_net_whitebind_permissions;\n+    if (NetWhitebindPermissions::TryParse(s, net_whitebind_permissions, error_net_whitebind_permissions)) {\n+        (void)NetPermissions::ToStrings(net_whitebind_permissions.m_flags);\n+        (void)NetPermissions::AddFlag(net_whitebind_permissions.m_flags, net_permission_flags);\n+        assert(NetPermissions::HasFlag(net_whitebind_permissions.m_flags, net_permission_flags));\n+        (void)NetPermissions::ClearFlag(net_whitebind_permissions.m_flags, net_permission_flags);\n+        (void)NetPermissions::ToStrings(net_whitebind_permissions.m_flags);\n+    }\n+\n+    NetWhitelistPermissions net_whitelist_permissions;\n+    std::string error_net_whitelist_permissions;\n+    if (NetWhitelistPermissions::TryParse(s, net_whitelist_permissions, error_net_whitelist_permissions)) {\n+        (void)NetPermissions::ToStrings(net_whitelist_permissions.m_flags);\n+        (void)NetPermissions::AddFlag(net_whitelist_permissions.m_flags, net_permission_flags);\n+        assert(NetPermissions::HasFlag(net_whitelist_permissions.m_flags, net_permission_flags));\n+        (void)NetPermissions::ClearFlag(net_whitelist_permissions.m_flags, net_permission_flags);\n+        (void)NetPermissions::ToStrings(net_whitelist_permissions.m_flags);\n+    }\n+}"
      }
    ]
  }
]