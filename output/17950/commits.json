[
  {
    "sha": "a5fa23700459144b1eb2a8c138528cb5a6e684a6",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphNWZhMjM3MDA0NTkxNDRiMWViMmE4YzEzODUyOGNiNWE2ZTY4NGE2",
    "commit": {
      "author": {
        "name": "Emil Engler",
        "email": "me@emilengler.com",
        "date": "2020-01-17T16:46:34Z"
      },
      "committer": {
        "name": "Emil Engler",
        "email": "me@emilengler.com",
        "date": "2020-01-20T12:43:35Z"
      },
      "message": "gui: Check the strength of an encryption password",
      "tree": {
        "sha": "f342670ef3573c8dd9ce2d1cb6a08842779086b5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f342670ef3573c8dd9ce2d1cb6a08842779086b5"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a5fa23700459144b1eb2a8c138528cb5a6e684a6",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE82XmVEpcmrEyk0LUL21BRcVfx8cFAl4loHoACgkQL21BRcVf\nx8ekoBAA56SE0+Z1o+jihuehJO8mddPCQFXWGXtjck/NEL/cGtIU65wlQG8Cio99\nwH+SMmUcQxdsuv0GUbFZvh32KOe3s1Nt4wnL/aJ/p2SI1Dj1epC2q9Th9WwI7Thb\nn1s2mqMgsgK4ucYArss0LuuCkwh25XfZdwNahR1ge+K9g2fUFnU93UmsFrX+N166\nebVOWC8M8Q8UzPDuS94HR6538n1ns1+TYmJwktXZUo9EJ8LgxTGldyefPCyt5ksS\nNlS5bRYJDGt1bXrIUWUJr77CTDhOJaho15jC+mD4G38LUnJHZHwd0okni64RkoMF\nlb+QLAMcs22+1uASq3sS5xKza/YO3NTOYavTiW5HPQhOIsEZNunk9hpbgnO7hRby\ny2LmKUsdLif8rWuoVjBWTyxDn7TWB8ejqd+O44MPUB2SYzai9Rj49iOGuetxtDPg\n4NLELIwK7AMmuA3huyXnWBRyF6rTGXRWVpGry7inUKKUdAN99AFLBF6kFJNhkzy9\n4UFtRrWeKC3Ou3fM5M/wclX/gF65YkF2i+UEQhbsLjCzQ0f0/P/HKtQOBkTlG9uE\n8tQlJ4UdVtG8gtHyG9a1Zumd6XhW72yk4SOmvPBAmPfm826K9mjhvtHFpbqmVYNB\nV9xjdZ785FLBZ5AxM6x7VCA8VX/7w972lzTVtXFSpX5a8nF3cq8=\n=HCJB\n-----END PGP SIGNATURE-----",
        "payload": "tree f342670ef3573c8dd9ce2d1cb6a08842779086b5\nparent f018d0c9cd7f408dac016b6bfc873670de713d27\nauthor Emil Engler <me@emilengler.com> 1579279594 +0100\ncommitter Emil Engler <me@emilengler.com> 1579524215 +0100\n\ngui: Check the strength of an encryption password\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a5fa23700459144b1eb2a8c138528cb5a6e684a6",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/a5fa23700459144b1eb2a8c138528cb5a6e684a6",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a5fa23700459144b1eb2a8c138528cb5a6e684a6/comments",
    "author": {
      "login": "emilengler",
      "id": 12272949,
      "node_id": "MDQ6VXNlcjEyMjcyOTQ5",
      "avatar_url": "https://avatars.githubusercontent.com/u/12272949?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emilengler",
      "html_url": "https://github.com/emilengler",
      "followers_url": "https://api.github.com/users/emilengler/followers",
      "following_url": "https://api.github.com/users/emilengler/following{/other_user}",
      "gists_url": "https://api.github.com/users/emilengler/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emilengler/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emilengler/subscriptions",
      "organizations_url": "https://api.github.com/users/emilengler/orgs",
      "repos_url": "https://api.github.com/users/emilengler/repos",
      "events_url": "https://api.github.com/users/emilengler/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emilengler/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "emilengler",
      "id": 12272949,
      "node_id": "MDQ6VXNlcjEyMjcyOTQ5",
      "avatar_url": "https://avatars.githubusercontent.com/u/12272949?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emilengler",
      "html_url": "https://github.com/emilengler",
      "followers_url": "https://api.github.com/users/emilengler/followers",
      "following_url": "https://api.github.com/users/emilengler/following{/other_user}",
      "gists_url": "https://api.github.com/users/emilengler/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emilengler/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emilengler/subscriptions",
      "organizations_url": "https://api.github.com/users/emilengler/orgs",
      "repos_url": "https://api.github.com/users/emilengler/repos",
      "events_url": "https://api.github.com/users/emilengler/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emilengler/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "f018d0c9cd7f408dac016b6bfc873670de713d27",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f018d0c9cd7f408dac016b6bfc873670de713d27",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/f018d0c9cd7f408dac016b6bfc873670de713d27"
      }
    ],
    "stats": {
      "total": 58,
      "additions": 57,
      "deletions": 1
    },
    "files": [
      {
        "sha": "0f5250ee15218ca3bd88711dce64891c0a94659d",
        "filename": "src/qt/askpassphrasedialog.cpp",
        "status": "modified",
        "additions": 41,
        "deletions": 0,
        "changes": 41,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a5fa23700459144b1eb2a8c138528cb5a6e684a6/src/qt/askpassphrasedialog.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a5fa23700459144b1eb2a8c138528cb5a6e684a6/src/qt/askpassphrasedialog.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/askpassphrasedialog.cpp?ref=a5fa23700459144b1eb2a8c138528cb5a6e684a6",
        "patch": "@@ -18,6 +18,8 @@\n #include <QMessageBox>\n #include <QPushButton>\n \n+#include <boost/algorithm/string.hpp>\n+\n AskPassphraseDialog::AskPassphraseDialog(Mode _mode, QWidget *parent, SecureString* passphrase_out) :\n     QDialog(parent),\n     ui(new Ui::AskPassphraseDialog),\n@@ -216,18 +218,57 @@ void AskPassphraseDialog::textChanged()\n     {\n     case Encrypt: // New passphrase x2\n         acceptable = !ui->passEdit2->text().isEmpty() && !ui->passEdit3->text().isEmpty();\n+        updatePasswordStrengthIndicator(ui->passEdit2);\n         break;\n     case Unlock: // Old passphrase x1\n     case Decrypt:\n         acceptable = !ui->passEdit1->text().isEmpty();\n         break;\n     case ChangePass: // Old passphrase x1, new passphrase x2\n         acceptable = !ui->passEdit1->text().isEmpty() && !ui->passEdit2->text().isEmpty() && !ui->passEdit3->text().isEmpty();\n+        updatePasswordStrengthIndicator(ui->passEdit2);\n         break;\n     }\n     ui->buttonBox->button(QDialogButtonBox::Ok)->setEnabled(acceptable);\n }\n \n+void AskPassphraseDialog::updatePasswordStrengthIndicator(QLineEdit* lineedit)\n+{\n+    std::string pass = lineedit->text().toUtf8().constData();\n+    bool mixedcase = (boost::to_upper_copy<std::string>(pass) != pass) && (boost::to_lower_copy<std::string>(pass) != pass);\n+    bool specialChars = pass.find_first_not_of(\"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxzy123456789\") != std::string::npos;\n+    bool digits = pass.find_first_not_of(\"1234567890\") != std::string::npos;\n+    // Do nothing if the PW was empty\n+    if (pass.empty()) {\n+        ui->labelSecurityLevel->setText(\"\");\n+        return;\n+    }\n+    // Passwords smaller than 10 chars are generally very weak\n+    if (pass.size() < RECOMMEND_LENGTH) {\n+        ui->labelSecurityLevel->setText(\"Very weak\");\n+        ui->labelSecurityLevel->setStyleSheet(\"QLabel {color: #ff0000; }\");\n+        return;\n+    }\n+    // Passwords with no mixed case or special characters but >10 are weak\n+    if (pass.size() >= RECOMMEND_LENGTH && !mixedcase && !specialChars) {\n+        ui->labelSecurityLevel->setText(\"Weak\");\n+        ui->labelSecurityLevel->setStyleSheet(\"QLabel {color: #ffa500; }\");\n+        return;\n+    }\n+    // If password contains special chars or mixed case\n+    if (mixedcase || specialChars || digits) {\n+        ui->labelSecurityLevel->setText(\"Normal\");\n+        ui->labelSecurityLevel->setStyleSheet(\"QLabel {color: #cccc00; }\"); // We use a darker yellow because of contrast\n+    }\n+    // The cr\u00e8me de la cr\u00e8me: >10, mixed case, special chars and digits\n+    if (mixedcase && specialChars && digits) {\n+        ui->labelSecurityLevel->setText(\"Strong\");\n+        ui->labelSecurityLevel->setStyleSheet(\"QLabel {color: #00ff00; }\");\n+        return;\n+    }\n+\n+}\n+\n bool AskPassphraseDialog::event(QEvent *event)\n {\n     // Detect Caps Lock key press."
      },
      {
        "sha": "e0f576a1ad748fc0197ba12769a17dbaeb6fe317",
        "filename": "src/qt/askpassphrasedialog.h",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a5fa23700459144b1eb2a8c138528cb5a6e684a6/src/qt/askpassphrasedialog.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a5fa23700459144b1eb2a8c138528cb5a6e684a6/src/qt/askpassphrasedialog.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/askpassphrasedialog.h?ref=a5fa23700459144b1eb2a8c138528cb5a6e684a6",
        "patch": "@@ -6,6 +6,7 @@\n #define BITCOIN_QT_ASKPASSPHRASEDIALOG_H\n \n #include <QDialog>\n+#include <QLineEdit>\n \n #include <support/allocators/secure.h>\n \n@@ -45,6 +46,7 @@ class AskPassphraseDialog : public QDialog\n \n private Q_SLOTS:\n     void textChanged();\n+    void updatePasswordStrengthIndicator(QLineEdit* lineedit);\n     void secureClearPassFields();\n     void toggleShowPassword(bool);\n "
      },
      {
        "sha": "5f0ffc1df79ace98de4e0c70c8b0518188ddfbe9",
        "filename": "src/qt/forms/askpassphrasedialog.ui",
        "status": "modified",
        "additions": 11,
        "deletions": 1,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a5fa23700459144b1eb2a8c138528cb5a6e684a6/src/qt/forms/askpassphrasedialog.ui",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a5fa23700459144b1eb2a8c138528cb5a6e684a6/src/qt/forms/askpassphrasedialog.ui",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/forms/askpassphrasedialog.ui?ref=a5fa23700459144b1eb2a8c138528cb5a6e684a6",
        "patch": "@@ -99,7 +99,7 @@\n        </property>\n       </widget>\n      </item>\n-     <item row=\"4\" column=\"1\">\n+     <item row=\"5\" column=\"1\">\n       <widget class=\"QLabel\" name=\"capsLabel\">\n        <property name=\"font\">\n         <font>\n@@ -115,6 +115,16 @@\n        </property>\n       </widget>\n      </item>\n+     <item row=\"4\" column=\"1\">\n+      <widget class=\"QLabel\" name=\"labelSecurityLevel\">\n+       <property name=\"enabled\">\n+        <bool>true</bool>\n+       </property>\n+       <property name=\"text\">\n+        <string></string>\n+       </property>\n+      </widget>\n+     </item>\n     </layout>\n    </item>\n    <item>"
      },
      {
        "sha": "4a35f9677363c5daf9127df2d67ef25b256804e7",
        "filename": "src/qt/guiconstants.h",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a5fa23700459144b1eb2a8c138528cb5a6e684a6/src/qt/guiconstants.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a5fa23700459144b1eb2a8c138528cb5a6e684a6/src/qt/guiconstants.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/guiconstants.h?ref=a5fa23700459144b1eb2a8c138528cb5a6e684a6",
        "patch": "@@ -18,6 +18,9 @@ static const int STATUSBAR_ICONSIZE = 16;\n \n static const bool DEFAULT_SPLASHSCREEN = true;\n \n+/* Recommend length of a password */\n+static const int RECOMMEND_LENGTH = 10;\n+\n /* Invalid field background style */\n #define STYLE_INVALID \"background:#FF8080\"\n "
      }
    ]
  }
]