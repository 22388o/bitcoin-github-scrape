[
  {
    "sha": "0aad1f13b2430165062bf9436036c1222a8724da",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzowYWFkMWYxM2IyNDMwMTY1MDYyYmY5NDM2MDM2YzEyMjJhODcyNGRh",
    "commit": {
      "author": {
        "name": "zathras-crypto",
        "email": "zathrasc@gmail.com",
        "date": "2015-03-25T09:04:02Z"
      },
      "committer": {
        "name": "dexX7",
        "email": "dexx@bitwatch.co",
        "date": "2015-07-18T15:31:55Z"
      },
      "message": "Exempt unspendable transaction outputs from dust checks\n\nSince unspendable outputs can't be spent, there is no threshold at which it would be uneconomic to spend them.\n\nThis primarily targets transaction outputs with `OP_RETURN`.\n\n---\n\nInitially based on:\n\ncommit 9cf0ae26350033d43d5dd3c95054c0d1b1641eda\nAuthor: zathras-crypto <zathrasc@gmail.com>\nDate:   Wed Mar 25 02:04:02 2015 -0700\n\nChanges:\n\n- cherry-picked on top of bitcoin:master\n- added RPC test for fundrawtransaction",
      "tree": {
        "sha": "6cc83f06f73b18462985b7d90e2cdd563c4708aa",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6cc83f06f73b18462985b7d90e2cdd563c4708aa"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0aad1f13b2430165062bf9436036c1222a8724da",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1\n\niQIcBAABAgAGBQJVqnFsAAoJEHZ14xz1cZgyNWoP/Rgwds+Sj4VcY5CQMch/rqq4\nRmkbTLYZM3GSYhgTCV5FutTKbD6TnrqZ+NsMGJTjD9izveubwNQeLynbmyTHpO4I\npYoF+zDC7yuf/PCDDZsBH3lxOlngANgANkMuS91L9S2Y927Dbl0fD0h/N8ORdQAa\n4SXcYVS818Hb2XRL+C/gj/ZIfsT6lQ0erxEOW4alob7JVX1sTnSJB0UviyvO27TP\nEUmQl9o95fosDbFjChb++Ee+K4t3bNF7MxmJI0SEjROwPaBp/zHA2ZufV0nMvEEz\n9ZCtsAahTP6pn05+aCNdV4DezEnPjBLxzD1WpuFADzWhLW3zdEYxPnFWCjHD+Xiz\nn31M1to9BA2gZr8lA9tj9Wt7ED5rUx4wskWu9EVb4C6H6t5LC5L8qHiyBhcIFhkN\nvHpeezLTyL5TMq2+i2bRyAGWj2VKNqHaoVO5JZXWOfWbFUDg6c7Z9oD0C883lUPd\nONGR0Z5NvaSiUyTJMvePehS3/QI7L8z9cq6G7XitGvzJb+0lJE4TxgHNkuk+Sngw\nX+pJ+5RtRHru02S8YzRGoxZk6fqhSOdYksDv49FxT9JqD2RBkLDa3KYuHLwwhjov\n17Y2b2XA3K2lL2RS6PmkeufNeY3EqLq598feP+q4BCI4EtDP8wH6MtEhJz1fYRfG\nL9rtuIFwc2Fw5lgzfESj\n=A0eY\n-----END PGP SIGNATURE-----",
        "payload": "tree 6cc83f06f73b18462985b7d90e2cdd563c4708aa\nparent ed789ceade71f19f04340a4041d7d3ef43c44086\nauthor zathras-crypto <zathrasc@gmail.com> 1427274242 -0700\ncommitter dexX7 <dexx@bitwatch.co> 1437233515 +0200\n\nExempt unspendable transaction outputs from dust checks\n\nSince unspendable outputs can't be spent, there is no threshold at which it would be uneconomic to spend them.\n\nThis primarily targets transaction outputs with `OP_RETURN`.\n\n---\n\nInitially based on:\n\ncommit 9cf0ae26350033d43d5dd3c95054c0d1b1641eda\nAuthor: zathras-crypto <zathrasc@gmail.com>\nDate:   Wed Mar 25 02:04:02 2015 -0700\n\nChanges:\n\n- cherry-picked on top of bitcoin:master\n- added RPC test for fundrawtransaction\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0aad1f13b2430165062bf9436036c1222a8724da",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/0aad1f13b2430165062bf9436036c1222a8724da",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0aad1f13b2430165062bf9436036c1222a8724da/comments",
    "author": {
      "login": "zathras-crypto",
      "id": 5633351,
      "node_id": "MDQ6VXNlcjU2MzMzNTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5633351?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/zathras-crypto",
      "html_url": "https://github.com/zathras-crypto",
      "followers_url": "https://api.github.com/users/zathras-crypto/followers",
      "following_url": "https://api.github.com/users/zathras-crypto/following{/other_user}",
      "gists_url": "https://api.github.com/users/zathras-crypto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/zathras-crypto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/zathras-crypto/subscriptions",
      "organizations_url": "https://api.github.com/users/zathras-crypto/orgs",
      "repos_url": "https://api.github.com/users/zathras-crypto/repos",
      "events_url": "https://api.github.com/users/zathras-crypto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/zathras-crypto/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "dexX7",
      "id": 5836089,
      "node_id": "MDQ6VXNlcjU4MzYwODk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5836089?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dexX7",
      "html_url": "https://github.com/dexX7",
      "followers_url": "https://api.github.com/users/dexX7/followers",
      "following_url": "https://api.github.com/users/dexX7/following{/other_user}",
      "gists_url": "https://api.github.com/users/dexX7/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dexX7/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dexX7/subscriptions",
      "organizations_url": "https://api.github.com/users/dexX7/orgs",
      "repos_url": "https://api.github.com/users/dexX7/repos",
      "events_url": "https://api.github.com/users/dexX7/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dexX7/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "ed789ceade71f19f04340a4041d7d3ef43c44086",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ed789ceade71f19f04340a4041d7d3ef43c44086",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/ed789ceade71f19f04340a4041d7d3ef43c44086"
      }
    ],
    "stats": {
      "total": 23,
      "additions": 21,
      "deletions": 2
    },
    "files": [
      {
        "sha": "ce52247b2e4b9b08b63846610cd0904ad1188967",
        "filename": "qa/rpc-tests/fundrawtransaction.py",
        "status": "modified",
        "additions": 16,
        "deletions": 0,
        "changes": 16,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/0aad1f13b2430165062bf9436036c1222a8724da/qa/rpc-tests/fundrawtransaction.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/0aad1f13b2430165062bf9436036c1222a8724da/qa/rpc-tests/fundrawtransaction.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/qa/rpc-tests/fundrawtransaction.py?ref=0aad1f13b2430165062bf9436036c1222a8724da",
        "patch": "@@ -524,6 +524,22 @@ def run_test(self):\n         self.sync_all()\n         assert_equal(oldBalance+Decimal('50.19000000'), self.nodes[0].getbalance()) #0.19+block reward\n \n+        #####################################################\n+        # test fundrawtransaction with OP_RETURN and no vin #\n+        #####################################################\n+\n+        rawtx   = \"0100000000010000000000000000066a047465737400000000\"\n+        dec_tx  = self.nodes[2].decoderawtransaction(rawtx)\n+\n+        assert_equal(len(dec_tx['vin']), 0)\n+        assert_equal(len(dec_tx['vout']), 1)\n+\n+        rawtxfund = self.nodes[2].fundrawtransaction(rawtx)\n+        dec_tx  = self.nodes[2].decoderawtransaction(rawtxfund['hex'])\n+\n+        assert_greater_than(len(dec_tx['vin']), 0) # at least one vin\n+        assert_equal(len(dec_tx['vout']), 2) # one change output added\n+\n \n if __name__ == '__main__':\n     RawTransactionsTest().main()"
      },
      {
        "sha": "84f7adddd1ade3726bf69b784cc3e1865fbbe4ae",
        "filename": "src/primitives/transaction.h",
        "status": "modified",
        "additions": 5,
        "deletions": 2,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/0aad1f13b2430165062bf9436036c1222a8724da/src/primitives/transaction.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/0aad1f13b2430165062bf9436036c1222a8724da/src/primitives/transaction.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/primitives/transaction.h?ref=0aad1f13b2430165062bf9436036c1222a8724da",
        "patch": "@@ -146,10 +146,13 @@ class CTxOut\n         // which has units satoshis-per-kilobyte.\n         // If you'd pay more than 1/3 in fees\n         // to spend something, then we consider it dust.\n-        // A typical txout is 34 bytes big, and will\n+        // A typical spendable txout is 34 bytes big, and will\n         // need a CTxIn of at least 148 bytes to spend:\n-        // so dust is a txout less than 546 satoshis \n+        // so dust is a spendable txout less than 546 satoshis\n         // with default minRelayTxFee.\n+        if (scriptPubKey.IsUnspendable())\n+            return 0;\n+\n         size_t nSize = GetSerializeSize(SER_DISK,0)+148u;\n         return 3*minRelayTxFee.GetFee(nSize);\n     }"
      }
    ]
  }
]