practicalswift,2018-05-12T20:31:35Z,Now includes a fix for a missing `cs_args` lock introduced in the recently merged PR #10267.,https://github.com/bitcoin/bitcoin/pull/13126#issuecomment-388581017,388581017,
practicalswift,2018-06-06T06:07:31Z,Rebased!,https://github.com/bitcoin/bitcoin/pull/13126#issuecomment-394951016,394951016,
DrahtBot,2018-07-29T15:16:46Z,"<!--5d09a71f8925f3f132321140b44b946d-->The last travis run for this pull request was 53 days ago and is thus outdated. To trigger a fresh travis build, this pull request should be closed and re-opened.",https://github.com/bitcoin/bitcoin/pull/13126#issuecomment-408684606,408684606,
practicalswift,2018-08-27T16:52:25Z,@MarcoFalke Thanks for reviewing! Feedback addressed. Please re-review :-),https://github.com/bitcoin/bitcoin/pull/13126#issuecomment-416291552,416291552,
practicalswift,2018-08-27T17:09:02Z,Added `GUARDED_BY(cs_args)` to `m_available_args` and `m_network_only_args` too :-),https://github.com/bitcoin/bitcoin/pull/13126#issuecomment-416296628,416296628,
MarcoFalke,2018-08-27T18:52:56Z,"utACK, but could squash into two commits (1) add missing locks and (2) add lock annotations",https://github.com/bitcoin/bitcoin/pull/13126#issuecomment-416329718,416329718,
practicalswift,2018-08-27T21:23:58Z,@MarcoFalke Good points. PR adjusted accordingly. Please re-review :-),https://github.com/bitcoin/bitcoin/pull/13126#issuecomment-416373683,416373683,
MarcoFalke,2018-08-29T18:50:17Z,"<!-- 26add580ac5863a0588ab7f31968305028eb5845 -->\n```\nPOTENTIAL DEADLOCK DETECTED\nPrevious lock order was:\n (1)cs_args  util.cpp:874 (2)csPathCached  util.cpp:767\nCurrent lock order is:\n (2)csPathCached  util.cpp:767 (1)cs_args  util.cpp:508",https://github.com/bitcoin/bitcoin/pull/13126#issuecomment-417064363,417064363,
practicalswift,2018-08-29T18:56:57Z,@MarcoFalke Thanks! I'll investigate immediately!,https://github.com/bitcoin/bitcoin/pull/13126#issuecomment-417066529,417066529,
MarcoFalke,2018-08-29T19:27:42Z,Note that I reproduced this with `--enable-debug` in `./configure`,https://github.com/bitcoin/bitcoin/pull/13126#issuecomment-417075635,417075635,
practicalswift,2018-08-29T19:30:34Z,@MarcoFalke Strange! I always build with `--enable-debug`. Triggered by `make check`?,https://github.com/bitcoin/bitcoin/pull/13126#issuecomment-417076483,417076483,
MarcoFalke,2018-08-29T19:36:36Z,"No, triggered by `bitcoind` or `bitcoin-qt`. It happens early on when the args and data dir are read.",https://github.com/bitcoin/bitcoin/pull/13126#issuecomment-417078281,417078281,
practicalswift,2018-08-29T20:40:38Z,@MarcoFalke Please re-review :-),https://github.com/bitcoin/bitcoin/pull/13126#issuecomment-417098237,417098237,
MarcoFalke,2018-08-29T21:23:27Z,"This still fails travis for the same reason. Sorry, I guess my suggestion doesn't work.",https://github.com/bitcoin/bitcoin/pull/13126#issuecomment-417110596,417110596,
practicalswift,2018-08-30T08:17:43Z,@MarcoFalke Reverted again :-) Travis is now happy. Please re-review!,https://github.com/bitcoin/bitcoin/pull/13126#issuecomment-417231996,417231996,
MarcoFalke,2018-07-29T15:32:52Z,`ReadConfigFiles` is done once on start. Couldn't you just take the lock at the beginning of the method and remove those scoped locks further down in the method?,https://github.com/bitcoin/bitcoin/pull/13126#discussion_r205978207,205978207,src/util.cpp
MarcoFalke,2018-07-29T15:34:45Z,"Just take the lock in the very first line of this method, or is there a specific reason that `m_network` shouldn't be protected?",https://github.com/bitcoin/bitcoin/pull/13126#discussion_r205978246,205978246,src/util.cpp
MarcoFalke,2018-08-27T18:51:01Z,I'd prefer to annotate this function and then take the lock where `GetNetBoolArg` is called (in `GetChainName`),https://github.com/bitcoin/bitcoin/pull/13126#discussion_r213076563,213076563,src/util.cpp
MarcoFalke,2018-08-27T18:52:05Z,Why this change?,https://github.com/bitcoin/bitcoin/pull/13126#discussion_r213076885,213076885,src/util.cpp
practicalswift,2018-08-27T21:21:39Z,"Oh, that was likely a left-over from a previous commit - a separate variable was needed to limit the scope of the lock. When the lock was moved higher up that was no longer needed but the variable was accidentally left around.",https://github.com/bitcoin/bitcoin/pull/13126#discussion_r213119855,213119855,src/util.cpp
practicalswift,2018-08-29T20:16:50Z,This change caused the deadlock. Now reverted to previous version :-),https://github.com/bitcoin/bitcoin/pull/13126#discussion_r213819244,213819244,src/util.cpp
MarcoFalke,2018-08-29T20:20:19Z,Couldn't you just move those two lines after the `GetConfigFile();` call? (And remove all scopes and re-locks?),https://github.com/bitcoin/bitcoin/pull/13126#discussion_r213820306,213820306,src/util.cpp
