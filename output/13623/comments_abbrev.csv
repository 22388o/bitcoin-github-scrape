laanwj,2018-07-10T15:17:14Z,"Thanks // Concept ACK, code looks good to me at first glance but ofcourse needs manual testing (as it's not tested by the test framework).",https://github.com/bitcoin/bitcoin/pull/13623#issuecomment-403860536,403860536,
MarcoFalke,2018-07-10T15:45:07Z,Could remove the bash script in the same commit?,https://github.com/bitcoin/bitcoin/pull/13623#issuecomment-403870751,403870751,
DrahtBot,2018-07-10T16:27:58Z,"<!--e57a25ab6845829454e8d69fc972939a-->Note to reviewers: This pull request conflicts with the following ones:\n\n* #13643 (Switch to NSIS 3.03 to avoid DLL hijacking by h4x3rotab)\n* #13368 (Update gitian-build.sh for docker by achow101)\n* #13171 (Change gitian-descriptors to use bionic instead by ken2812221)\n\nIf you consider this pull request important, please also help to review the conflict",https://github.com/bitcoin/bitcoin/pull/13623#issuecomment-403884743,403884743,
jtimon,2018-07-10T20:18:40Z,Concept ACK,https://github.com/bitcoin/bitcoin/pull/13623#issuecomment-403952339,403952339,
dongcarl,2018-07-10T21:07:15Z,"As `gitian-build.sh` is mostly calling other executables, I think `bash/sh` is still the most sensible/readable/least-dependencies choice. According to https://github.com/bitcoin/bitcoin/issues/13620 there are edge cases to fix, sure, but I'm not convinced that there's a need for a python rewrite.\n\nStatic analysis tools run against shell scripts in the check pipeline can eliminate/mitigate edg",https://github.com/bitcoin/bitcoin/pull/13623#issuecomment-403966145,403966145,
laanwj,2018-07-11T11:34:19Z,"> As gitian-build.sh is mostly calling other executables, I think bash/sh is still the most sensible/readable/least-dependencies choice.\n\nThe point is that most of the developers in this project have a much easier time reviewing and maintaining python code. Shell script has turned out to be a continuous struggle against shell differences, bad performance, bugs and other edge cases due to obscu",https://github.com/bitcoin/bitcoin/pull/13623#issuecomment-404137825,404137825,
MarcoFalke,2018-07-11T11:37:29Z,"Also, the resulting python script is a lot shorter. Means less code weight to maintain in the future :)",https://github.com/bitcoin/bitcoin/pull/13623#issuecomment-404138553,404138553,
ken2812221,2018-07-12T02:45:12Z,Update: exit 1 if signer or version is empty.,https://github.com/bitcoin/bitcoin/pull/13623#issuecomment-404372061,404372061,
fanquake,2018-07-13T09:57:05Z,"Using a67812d  if I pass `--setup` and already have one of the required repos cloned I see:\n```\nProcessing triggers for ureadahead (0.100.0-20) ...\nProcessing triggers for ufw (0.35-5) ...\nfatal: destination path 'gitian.sigs' already exists and is not an empty directory.\nTraceback (most recent call last):\n  File ""./gitian-build.py"", line 188, in <module>\n    main()\n  File ""./gitia",https://github.com/bitcoin/bitcoin/pull/13623#issuecomment-404786692,404786692,
ken2812221,2018-07-13T11:48:03Z,"I don't know how to deal with KVM errors since I haven't used KVM ever, I just follow the same command with the original script. Can anyone give a hint?",https://github.com/bitcoin/bitcoin/pull/13623#issuecomment-404810268,404810268,
fanquake,2018-07-15T23:44:25Z,"@ken2812221 Now that #13368 has been merged, can you update the new Python script to add Docker support. I will retest the changes here shortly.",https://github.com/bitcoin/bitcoin/pull/13623#issuecomment-405127096,405127096,
DrahtBot,2018-07-16T11:16:25Z,<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase,https://github.com/bitcoin/bitcoin/pull/13623#issuecomment-405215696,405215696,
Sjors,2018-07-17T16:17:39Z,"This is great, especially not having to worry about the exact sequence of arguments (the bash script had some quirks).\n\nI'm trying to sign `master` on a Bionic VM (haven't tried a Debian 9 host).\n\n```sh\n# git clone bitcoin, gitian.sigs, etc\ncp bitcoin/contrib/gitian-build.py .\n# add MacOS stuff \npython3 gitian-build.py --setup sjors -c master\npython3 gitian-build.py --detach-sign",https://github.com/bitcoin/bitcoin/pull/13623#issuecomment-405640830,405640830,
ken2812221,2018-07-17T17:37:06Z,">Compiling master Linux\n--- Building for bionic amd64 ---\nStopping target if it is up\nMaking a new image copy\nError: No such container: gitian-target\n\nI believe the docker problem is already exist on gitian-build.sh because I saw the same error trying to use gitian-build.sh to create docker image.\n\n>Can you add make to the dependencies installed during --setup?\n\nWhy?",https://github.com/bitcoin/bitcoin/pull/13623#issuecomment-405664909,405664909,
Sjors,2018-07-17T17:53:37Z,"Correct, it happens both with bash and python.\n\nWithout ""make"" setup throws an error on a fresh Bionic machine (unless you install all dependencies recommended in the docs, which is overkill).",https://github.com/bitcoin/bitcoin/pull/13623#issuecomment-405670021,405670021,
MarcoFalke,2018-07-17T18:02:33Z,utACK 78f06e4af76b6e4550b8eed5a521684140a4,https://github.com/bitcoin/bitcoin/pull/13623#issuecomment-405672988,405672988,
Sjors,2018-07-17T18:35:59Z,"On Debian 9, when trying to `--setup` with `--docker`, I'm getting `Package 'docker.io' has no installation candidate`.\n\nSo I installed Docker [manually](https://linuxconfig.org/package-docker-io-has-no-installation-candidate-debian-jessie), but get the same error. Disabling `programs += ['docker.io']` does the trick.",https://github.com/bitcoin/bitcoin/pull/13623#issuecomment-405684241,405684241,
mcdallas,2018-07-11T16:34:24Z,You can add the parameter nargs=1 to make signer and version mandatory and skip lines 155-162. It will produce a list of one item. See https://docs.python.org/3/library/argparse.html#nargs,https://github.com/bitcoin/bitcoin/pull/13623#discussion_r201760924,201760924,contrib/gitian-build.py
achow101,2018-07-11T21:24:02Z,This isn't necessary since signer and version are positional arguments so if they aren't provided then an error will always be thrown. The checks later are still necessary since you can still pass in the empty string as an argument regardless of nargs.,https://github.com/bitcoin/bitcoin/pull/13623#discussion_r201843933,201843933,contrib/gitian-build.py
mcdallas,2018-07-11T22:00:44Z,Oh I missed the point of the checks. Still if we want to guard against empty string we can use the `type`  argument with a custom callable (saves a few lines),https://github.com/bitcoin/bitcoin/pull/13623#discussion_r201853660,201853660,contrib/gitian-build.py
jb55,2018-07-13T06:05:14Z,"is this option necessary? if there's a v you could just include it in the argument. I found this confusing when I ran the command, it was trying to checkout `vmaster` because I didn't have the `--commit` option.",https://github.com/bitcoin/bitcoin/pull/13623#discussion_r202251072,202251072,contrib/gitian-build.py
jb55,2018-07-13T06:06:16Z,this assumes you would be running the command from outside the bitcoin directory. is this correct? I found I had to cd .. and then run ./bitcoin/contrib/gitian-builder.py to make the command work?,https://github.com/bitcoin/bitcoin/pull/13623#discussion_r202251223,202251223,contrib/gitian-build.py
jb55,2018-07-13T06:11:17Z,perhaps we could default to build? or at least throw an error when all three are not selected?,https://github.com/bitcoin/bitcoin/pull/13623#discussion_r202251915,202251915,contrib/gitian-build.py
ken2812221,2018-07-13T06:28:10Z,"From the instruction from https://github.com/bitcoin-core/docs/blob/master/gitian-building.md , you should copy the script to the same level as bitcoin folder",https://github.com/bitcoin/bitcoin/pull/13623#discussion_r202254416,202254416,contrib/gitian-build.py
ken2812221,2018-07-13T07:07:29Z,The version without 'v' prefix is still used in gsign.,https://github.com/bitcoin/bitcoin/pull/13623#discussion_r202260922,202260922,contrib/gitian-build.py
jb55,2018-07-13T16:59:35Z,ah ok thanks,https://github.com/bitcoin/bitcoin/pull/13623#discussion_r202413597,202413597,contrib/gitian-build.py
