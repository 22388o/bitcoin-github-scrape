[
  {
    "sha": "68e5aafde3e87c16da95410a0474f38f589afb36",
    "node_id": "C_kwDOABII59oAKDY4ZTVhYWZkZTNlODdjMTZkYTk1NDEwYTA0NzRmMzhmNTg5YWZiMzY",
    "commit": {
      "author": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-10-01T04:37:03Z"
      },
      "committer": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-11-16T01:10:48Z"
      },
      "message": "build: add `--enable-lto` configuration option\n\nCo-authored-by: Cory Fields <cory-nospam-@coryfields.com>\nCo-authored-by: Elichai Turkel <elichai.turkel@gmail.com>",
      "tree": {
        "sha": "997458be3d629794c42d74efd1a7bc26881e9ab5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/997458be3d629794c42d74efd1a7bc26881e9ab5"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/68e5aafde3e87c16da95410a0474f38f589afb36",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz7FuIclQ9n+pXlWPLuufXMCVJsEFAmGTBRgACgkQLuufXMCV\nJsESIhAAiO0swuN0gmwx50pM9ELxLUxM/2QU3TTOinztVZ/HP27KW2xOj0f9CSM3\nyBRJ1vla+Ph/X3iIMBKCCDVPvmOGTk247soCrPqUPjDhkdctd4rEPDJMd9qFJ5nr\nM0P5npPL9rxpc5BPTA92qYHdsHR0G858w7IjLrWb84QpJTg32shoWthBODR91sH8\neR6eeYFe+HEk004RswsvpxwB8THb+enUCx7B4J4ZNEMNExcTCfxFNdmmqd1UbqWh\nZPKhry8D6znX7kJnBsoXD6gJ/MTchz+pRkXxyYwB/cPo70LYIi1Iz8Z93otnJlkA\nn3+EZ2RO0oljXsVZX10bI1sWsn1H/fRd+iIoHV6IYRYcKnrNdaGU74/mQordfBLW\nPouSg3ydMlgRcrNlQ8BienM6E1+leoqNHnsWuvIlsFAWOQaqhr0O5ZGWqSB18hu5\nxbFZYCK3H7hKjth853bGFJkCEgb7d5fIlzPQpWQcFRo+hiCR626JtJZ0lnQjmRaE\nacnygF8mTuG3Oooa++e1yVrX9ylvMXSWFV8u5ajHvwcrS6004zwCMkPDShQ+vWse\nRhTuIGBBTwACuKrSJo5OmO2N2YIabpz3S4UxWjezuRSEcaGcwkGXvkmQdZRJRhoQ\n956EJWONzvv7GnkPfkXrDJHn9Mf78pO2X2qkefdZ7ujWKHTNBg0=\n=CDT1\n-----END PGP SIGNATURE-----",
        "payload": "tree 997458be3d629794c42d74efd1a7bc26881e9ab5\nparent 41e6909c073024e774e5f960f00ebd74758e9d2e\nauthor fanquake <fanquake@gmail.com> 1633063023 +0800\ncommitter fanquake <fanquake@gmail.com> 1637025048 +0800\n\nbuild: add `--enable-lto` configuration option\n\nCo-authored-by: Cory Fields <cory-nospam-@coryfields.com>\nCo-authored-by: Elichai Turkel <elichai.turkel@gmail.com>\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/68e5aafde3e87c16da95410a0474f38f589afb36",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/68e5aafde3e87c16da95410a0474f38f589afb36",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/68e5aafde3e87c16da95410a0474f38f589afb36/comments",
    "author": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "41e6909c073024e774e5f960f00ebd74758e9d2e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/41e6909c073024e774e5f960f00ebd74758e9d2e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/41e6909c073024e774e5f960f00ebd74758e9d2e"
      }
    ],
    "stats": {
      "total": 21,
      "additions": 17,
      "deletions": 4
    },
    "files": [
      {
        "sha": "27749e7a8da9f2bac423f82289e355faf36045d6",
        "filename": "configure.ac",
        "status": "modified",
        "additions": 15,
        "deletions": 2,
        "changes": 17,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/68e5aafde3e87c16da95410a0474f38f589afb36/configure.ac",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/68e5aafde3e87c16da95410a0474f38f589afb36/configure.ac",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/configure.ac?ref=68e5aafde3e87c16da95410a0474f38f589afb36",
        "patch": "@@ -323,6 +323,11 @@ AC_ARG_ENABLE([external-signer],\n     [use_external_signer=$enableval],\n     [use_external_signer=yes])\n \n+AC_ARG_ENABLE([lto],\n+    [AS_HELP_STRING([--enable-lto],[build using LTO (default is no)])],\n+    [enable_lto=$enableval],\n+    [enable_lto=no])\n+\n AC_LANG_PUSH([C++])\n \n dnl Check for a flag to turn compiler warnings into errors. This is helpful for checks which may\n@@ -370,6 +375,11 @@ if test \"x$enable_debug\" = xyes; then\n   AX_CHECK_COMPILE_FLAG([-ftrapv], [DEBUG_CXXFLAGS=\"$DEBUG_CXXFLAGS -ftrapv\"], [], [$CXXFLAG_WERROR])\n fi\n \n+if test \"x$enable_lto\" = \"xyes\"; then\n+  AX_CHECK_COMPILE_FLAG([-flto], [LTO_CXXFLAGS=\"$LTO_CXXFLAGS -flto\"], [AC_MSG_ERROR([compile failed with -flto])], [$CXXFLAG_WERROR])\n+  AX_CHECK_LINK_FLAG([-flto], [LTO_LDFLAGS=\"$LTO_LDFLAGS -flto\"], [AC_MSG_ERROR([link failed with -flto])], [$CXXFLAG_WERROR])\n+fi\n+\n if test x$use_sanitizers != x; then\n   dnl First check if the compiler accepts flags. If an incompatible pair like\n   dnl -fsanitize=address,thread is used here, this check will fail. This will also\n@@ -1826,6 +1836,8 @@ AC_SUBST(GPROF_LDFLAGS)\n AC_SUBST(HARDENED_CXXFLAGS)\n AC_SUBST(HARDENED_CPPFLAGS)\n AC_SUBST(HARDENED_LDFLAGS)\n+AC_SUBST(LTO_CXXFLAGS)\n+AC_SUBST(LTO_LDFLAGS)\n AC_SUBST(PIC_FLAGS)\n AC_SUBST(PIE_FLAGS)\n AC_SUBST(SANITIZER_CXXFLAGS)\n@@ -1941,6 +1953,7 @@ echo \"  sanitizers      = $use_sanitizers\"\n echo \"  debug enabled   = $enable_debug\"\n echo \"  gprof enabled   = $enable_gprof\"\n echo \"  werror          = $enable_werror\"\n+echo \"  LTO             = $enable_lto\"\n echo\n echo \"  target os       = $TARGET_OS\"\n echo \"  build os        = $build_os\"\n@@ -1949,7 +1962,7 @@ echo \"  CC              = $CC\"\n echo \"  CFLAGS          = $PTHREAD_CFLAGS $CFLAGS\"\n echo \"  CPPFLAGS        = $DEBUG_CPPFLAGS $HARDENED_CPPFLAGS $CPPFLAGS\"\n echo \"  CXX             = $CXX\"\n-echo \"  CXXFLAGS        = $DEBUG_CXXFLAGS $HARDENED_CXXFLAGS $WARN_CXXFLAGS $NOWARN_CXXFLAGS $ERROR_CXXFLAGS $GPROF_CXXFLAGS $CXXFLAGS\"\n-echo \"  LDFLAGS         = $PTHREAD_LIBS $HARDENED_LDFLAGS $GPROF_LDFLAGS $LDFLAGS\"\n+echo \"  CXXFLAGS        = $LTO_CXXFLAGS $DEBUG_CXXFLAGS $HARDENED_CXXFLAGS $WARN_CXXFLAGS $NOWARN_CXXFLAGS $ERROR_CXXFLAGS $GPROF_CXXFLAGS $CXXFLAGS\"\n+echo \"  LDFLAGS         = $LTO_LDFLAGS $PTHREAD_LIBS $HARDENED_LDFLAGS $GPROF_LDFLAGS $LDFLAGS\"\n echo \"  ARFLAGS         = $ARFLAGS\"\n echo"
      },
      {
        "sha": "35119f391a606a716130e0d80a8c55edce5372c1",
        "filename": "src/Makefile.am",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/68e5aafde3e87c16da95410a0474f38f589afb36/src/Makefile.am",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/68e5aafde3e87c16da95410a0474f38f589afb36/src/Makefile.am",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.am?ref=68e5aafde3e87c16da95410a0474f38f589afb36",
        "patch": "@@ -8,8 +8,8 @@ print-%: FORCE\n \n DIST_SUBDIRS = secp256k1\n \n-AM_LDFLAGS = $(LIBTOOL_LDFLAGS) $(HARDENED_LDFLAGS) $(GPROF_LDFLAGS) $(SANITIZER_LDFLAGS)\n-AM_CXXFLAGS = $(DEBUG_CXXFLAGS) $(HARDENED_CXXFLAGS) $(WARN_CXXFLAGS) $(NOWARN_CXXFLAGS) $(ERROR_CXXFLAGS) $(GPROF_CXXFLAGS) $(SANITIZER_CXXFLAGS)\n+AM_LDFLAGS = $(LIBTOOL_LDFLAGS) $(HARDENED_LDFLAGS) $(GPROF_LDFLAGS) $(SANITIZER_LDFLAGS) $(LTO_LDFLAGS)\n+AM_CXXFLAGS = $(DEBUG_CXXFLAGS) $(HARDENED_CXXFLAGS) $(WARN_CXXFLAGS) $(NOWARN_CXXFLAGS) $(ERROR_CXXFLAGS) $(GPROF_CXXFLAGS) $(SANITIZER_CXXFLAGS) $(LTO_CXXFLAGS)\n AM_CPPFLAGS = $(DEBUG_CPPFLAGS) $(HARDENED_CPPFLAGS)\n AM_LIBTOOLFLAGS = --preserve-dup-deps\n PTHREAD_FLAGS = $(PTHREAD_CFLAGS) $(PTHREAD_LIBS)"
      }
    ]
  }
]