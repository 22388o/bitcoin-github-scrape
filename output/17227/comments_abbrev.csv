DrahtBot,2019-10-23 14:30:24,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #21495 (build, qt: Fix static builds on macOS Big Sur by hebasto)\n* #21478 (guix: Use `pigz` as a faster `gzip` replaceme",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-545472044,545472044,
laanwj,2019-10-24 18:37:51,"Concept ACK, nice !",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-546048506,546048506,
icota,2019-11-04 15:03:08,"Rebased, squashed, added instructions under `doc` and updated the first comment to reflect that #16110 has been merged.",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-549394807,549394807,
luke-jr,2019-11-04 16:30:49,"> This PR is the third and final piece of the basic Android support puzzle\n\nIMO final would be a gitian descriptor ;)",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-549435471,549435471,
adamjonas,2020-05-01 01:01:31,@icota Friendly ping for a rebase.,https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-622197838,622197838,
icota,2020-05-02 10:36:21,Thank you @adamjonas. Rebased.,https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-622932852,622932852,
MarcoFalke,2020-05-02 20:31:33,@icota Could you pull in https://github.com/MarcoFalke/bitcoin-core/commit/a0b441baf9dbb3ce7e332b0a8e0d4d278e73f611 to shave off a few kB off of the compressed images?,https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-623009488,623009488,
icota,2020-05-03 09:15:09,Absolutely. Thanks @MarcoFalke,https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-623079709,623079709,
MarcoFalke,2020-05-03 11:05:50,"Oh, you'll have to squash it. Otherwise git will keep track of both versions, thus doubling the size.",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-623092466,623092466,
icota,2020-05-03 12:24:19,Done.,https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-623102103,623102103,
BlockMechanic,2020-05-18 22:12:26,"Awesome, will test this out. ",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-630461823,630461823,
jonasschnelli,2020-05-29 07:44:47,utACK a818b2c082e257eb67403479df61f1325231c947,https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-635817480,635817480,
MarcoFalke,2020-05-29 16:00:31,Concept ACK. Not sure how this can be tested in ci. I guess it needs the android dev kit?,https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-636052126,636052126,
icota,2020-05-30 00:12:57,Yep it needs the SDK. Travis seems to [support this](https://docs.travis-ci.com/user/languages/android/).,https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-636243748,636243748,
MarcoFalke,2020-05-31 00:35:29,"Unfortunately (or luckily) we can't use travis' packages. We use our own ci setup in `./ci`.\n\nThe sdkmanager is a zip file that can be downloaded, though. And then a one-liner like\n\n```\n$ANDROID_HOME/tools/bin/sdkmanager --sdk_root=$ANDROID_HOME ""platform-tools"" ""platforms;android-28"" ""ndk-bundle""\n``` \n\nshould do the rest.",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-636403308,636403308,
jonasschnelli,2020-06-05 07:47:29,"I'd like to give this a try in the main branch (even without CI support). If it gets unmaintained, a revert is likely.\nAnyone with Android experience willing to test this @Sjors, @hebasto, @promag, @greenaddress?",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-639317050,639317050,
MarcoFalke,2020-06-05 12:22:54,"To clarify. I did try to build this, but the linker step of bitcoind failed, which is why I asked for a `./ci` file or at least some indication that anyone has tried compiling this current version of the pull merged into current master. I am generally not a fan of merging code and build system changes that may or may not compile.\n\nI don't have android experience, so maybe I did something wrong",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-639449392,639449392,
icota,2020-06-09 08:24:46,@MarcoFalke On Linux you might have to pull https://github.com/bitcoin/bitcoin/pull/17396. Specifically I think the linker error is due to an autoconf issue. A fix has since been [merged upstream](https://github.com/autoconf-archive/autoconf-archive/pull/211).,https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-641119577,641119577,
BlockMechanic,2020-06-26 17:40:54,"> To clarify. I did try to build this, but the linker step of bitcoind failed, which is why I asked for a `./ci` file or at least some indication that anyone has tried compiling this current version of the pull merged into current master. I am generally not a fan of merging code and build system changes that may or may not compile.\n> \n> I don't have android experience, so maybe I did something",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-650308763,650308763,
icota,2020-06-30 08:53:39,"> @icota which version of grade is best ? i see you were using 3.2, but the latest is 6.x. Should we have a recommended version ?\n\nI don't think so, we are not using much build system wizardry here anyway... Unless you have a specific reason to bump Gradle, I'd keep it at 3.2",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-651656152,651656152,
MarcoFalke,2020-08-24 13:32:53,Needs rebase?,https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-679128540,679128540,
icota,2020-08-25 07:15:18,Rebased. I'll look into adding this to CI.,https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-679849059,679849059,
icota,2020-08-27 13:15:47,"@MarcoFalke Can you take a look at the CI changes? The general idea is to have the Android CLI tools fetch everything needed to build and having done that we 'iterate' over the 4 supported ABIs so the final APK built will have contained all the binaries.\n\nI haven't actually tested this to completion (it's going to take some time on my machine) but would like some feedback on the direction.",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-681942011,681942011,
icota,2020-08-28 09:56:49,"To build with CI run:\n`FILE_ENV=""./ci/test/00_setup_env_android.sh"" ./ci/test_run_all.sh`\n\nTo install on your (ARM64) device:\n`docker cp ci_android:$PWD/src/qt/android/build/outputs/apk/debug/android-debug.apk .`\n`adb install android-debug.apk`",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-682438929,682438929,
MarcoFalke,2020-08-28 10:03:44,"Could add the ci file to travis.yml or cirrus.yml? If it takes 30-40 minutes, then travis should be sufficient. If it takes longer, then cirrus might be better. If it takes longer than 2h, maybe leave it out for now.",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-682441978,682441978,
icota,2020-08-28 11:18:14,@MarcoFalke It's about 30 mins to build just for ARM64 so I added it to travis.,https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-682470326,682470326,
decryp2kanon,2020-11-04 11:35:14,Concept ACK,https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-721680558,721680558,
icota,2020-11-10 17:03:22,"I'm counting four concept ACKs. For anyone looking to test it's as easy as:\n> To build with CI run:\n> `FILE_ENV=""./ci/test/00_setup_env_android.sh"" ./ci/test_run_all.sh`\n> \n> To install on your (ARM64) device:\n> `docker cp ci_android:$PWD/src/qt/android/build/outputs/apk/debug/android-debug.apk .`\n> `adb install android-debug.apk`\n\n",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-724835816,724835816,
MarcoFalke,2020-11-10 17:06:22,"This hasn't been merged because we are still in feature freeze for 0.21, but this should be good to go into 22.0",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-724837636,724837636,
MarcoFalke,2020-12-10 16:01:37,ACK 11be2d282965759edd87284d111f067168d937c2,https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-742613422,742613422,
BlockMechanic,2020-12-25 04:11:16,"With static depends bui;ds now a thing, i think this one just moved up the list :) Will run tests later today. ",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-751164725,751164725,
prayank23,2021-02-28 22:39:49,"Concept ACK\n\nThis looks interesting. Not sure how did I miss this. Also interested to know difference and trade-offs in this solution compared to [ABCore](https://github.com/greenaddress/abcore) or [NayutaCore](https://github.com/nayutaco/NayutaCore) and if more projects exist to use bitcoin core on Android.",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-787537562,787537562,
laanwj,2021-03-16 14:13:23,"> This looks interesting. Not sure how did I miss this.\n\nHaha I wonder this all the time. So much going on.\n\nLooks like the new APK build is failing on the Qt compile. Maybe the intermediate Qt version bump got in the way?\n```\nERROR: Feature 'precompile_header' was enabled, but the pre-condition 'tests.precompile_header' failed.\nfuncs.mk:273: recipe for target '/tmp/cirrus-ci-build/d",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-800291658,800291658,
icota,2021-03-21 16:23:23,"@laanwj Thanks for the heads up. I rebased on top of 5.12 and tested on an Android 11 device.\n\n@prayank23 I can't comment on other approaches. This PR aims to bring nothing less (and nothing more) than `bitcoin-qt` running on Android. https://github.com/bitcoin/bitcoin/pull/16883 is an attempt to make the GUI a bit more modern and usable but it's parked for now as I can't find the time to work",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-803614945,803614945,
MarcoFalke,2021-03-24 07:33:51,cr ACK 246774e264,https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-805573888,805573888,
laanwj,2021-03-24 18:00:26,Code review ACK 246774e26459cb3652e308880abdd140e8e9d204,https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-806040299,806040299,
prayank23,2021-03-24 18:50:59,"> #16883 is an attempt to make the GUI a bit more modern and usable but it's parked for now as I can't find the time to work on it.\n\n@icota Thanks for working on this. Its merged :) #16883 looks interesting except one comment from @promag , my younger brother is also good with Android development but Kotlin. Will share things with him after testing.",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-806072731,806072731,
ryanofsky,2021-03-24 23:27:32,"Seeing CI failures in ARM64 Android APK [bionic] build that might be related to this:\n\nhttps://cirrus-ci.com/task/5511109198217216?command=ci#L4420\nhttps://cirrus-ci.com/task/5967779246374912?command=ci#L4426\n\n```\nmake[1]: Entering directory '/tmp/cirrus-ci-build/src'\ntar: --exclude=*/*: Cannot open: No such file or directory\ntar: Error is not recoverable: exiting now\ntar: --excl",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-806248409,806248409,
icota,2021-03-25 07:28:22,"@ryanofsky Yes, and this line is the culprit:\nhttps://github.com/bitcoin/bitcoin/blob/9217f9fe7351d9c36803456f88ae561e23f17ac9/src/Makefile.qt.include#L382\n\nIs Cirrus perhaps wiping `depends/sources` from time to time?",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-806427840,806427840,
achow101,2021-03-25 17:20:03,"> Is Cirrus perhaps wiping `depends/sources` from time to time?\n\nI'm able to reproduce a similar error locally so I don't think it is a cirrus issue.",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-807130059,807130059,
icota,2021-03-25 19:56:31,"I can't reproduce locally (unless I manually delete `sources`) but I'm seeing a pattern on the latest runs:\n\nfails when run last:\nhttps://github.com/bitcoin/bitcoin/pull/21392/checks\nhttps://github.com/bitcoin/bitcoin/pull/16545/checks\nhttps://github.com/bitcoin/bitcoin/pull/19460/checks\n\nsucceds otherwise:\nhttps://github.com/bitcoin/bitcoin/pull/21422/checks\nhttps://github.com/b",https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-807377681,807377681,
icota,2021-03-28 08:45:03,Trying to fix the issue in https://github.com/bitcoin/bitcoin/pull/21537,https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-808866730,808866730,
icota,2021-03-28 17:42:57,Fixed by @MarcoFalke in https://github.com/bitcoin/bitcoin/pull/21541,https://github.com/bitcoin/bitcoin/pull/17227#issuecomment-808930667,808930667,
MarcoFalke,2019-11-04 15:08:03,"Should this file be linked to from the doc/Readme?\n\nAlso, should it be named build-android, similar to build-unix and build-bsd?",https://github.com/bitcoin/bitcoin/pull/17227#discussion_r342098033,342098033,doc/package-android.md
icota,2019-11-04 15:31:11,"I thought so but other build files seem to be about building _on_ UNIX, BSD, etc... and this file is mostly about _packaging_ `bitcoin-qt` _for_ Android. I'm open to suggestions and whatever name it ends up being I'll make sure to link from `doc/README.md`",https://github.com/bitcoin/bitcoin/pull/17227#discussion_r342110762,342110762,doc/package-android.md
MarcoFalke,2019-11-04 15:34:10,"Oh, this is for cross-compilation? Well, we have build-win",https://github.com/bitcoin/bitcoin/pull/17227#discussion_r342112418,342112418,doc/package-android.md
icota,2019-11-04 15:46:42,You are right. I will change to build-android and make it a bit more generic (as in not just about packaging),https://github.com/bitcoin/bitcoin/pull/17227#discussion_r342119925,342119925,doc/package-android.md
MarcoFalke,2020-08-27 13:20:37,It is probably enough to keep only the `aarch64-linux-android` build.,https://github.com/bitcoin/bitcoin/pull/17227#discussion_r478413554,478413554,ci/test/06_script_a.sh
icota,2020-08-27 13:32:03,Agreed. Okay to just comment the others out in case somebody wants them?,https://github.com/bitcoin/bitcoin/pull/17227#discussion_r478421387,478421387,ci/test/06_script_a.sh
MarcoFalke,2020-08-27 13:38:30,"I think it would be easy to re-create them by copy-paste and adjusting the name, etc.",https://github.com/bitcoin/bitcoin/pull/17227#discussion_r478425709,478425709,ci/test/06_script_a.sh
luke-jr,2020-10-24 23:46:16,Why not??,https://github.com/bitcoin/bitcoin/pull/17227#discussion_r511526499,511526499,src/qt/bitcoin.cpp
icota,2020-10-26 09:50:36,"![image](https://user-images.githubusercontent.com/762502/97157083-eaa28a80-1777-11eb-8c08-d73e2291bd6b.png)\nNative menus (or Qt's Android native implementation of QMenu) don't support submenus. When you tap on any of the four options nothing happens.\n\nThe other two attributes are there because native dialogs are way too simple to render our modals and to make sure the dialogs don't create a",https://github.com/bitcoin/bitcoin/pull/17227#discussion_r511835170,511835170,src/qt/bitcoin.cpp
MarcoFalke,2020-11-09 14:51:11,"We no longer use travis, so you'll have to move those added lines over to cirrus",https://github.com/bitcoin/bitcoin/pull/17227#discussion_r519870814,519870814,.travis.yml
icota,2020-11-10 16:59:26,Done,https://github.com/bitcoin/bitcoin/pull/17227#discussion_r520720649,520720649,.travis.yml
MarcoFalke,2020-12-04 07:51:54,"```suggestion\n  name: 'ARM64 Android APK [bionic]'\n```\n\nnit: the ""goal"" is no longer part of the task name, but we mention where it was cross-compiled from",https://github.com/bitcoin/bitcoin/pull/17227#discussion_r535900775,535900775,.cirrus.yml
hebasto,2021-05-25 19:20:09,Shouldn't the content of the `qt/android` directory be a subject of the cleanup in `make clean` or `make distclean`?,https://github.com/bitcoin/bitcoin/pull/17227#discussion_r639118424,639118424,src/Makefile.qt.include
icota,2021-05-26 07:53:22,It should :+1: ,https://github.com/bitcoin/bitcoin/pull/17227#discussion_r639485623,639485623,src/Makefile.qt.include
