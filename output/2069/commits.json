[
  {
    "sha": "bf484901c9ab74f4b93f014660728ae63f4a2710",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiZjQ4NDkwMWM5YWI3NGY0YjkzZjAxNDY2MDcyOGFlNjNmNGEyNzEw",
    "commit": {
      "author": {
        "name": "Mike Gogulski",
        "email": "mike@gogulski.com",
        "date": "2012-12-03T13:43:27Z"
      },
      "committer": {
        "name": "Mike Gogulski",
        "email": "mike@gogulski.com",
        "date": "2012-12-03T13:43:27Z"
      },
      "message": "make WalletTxToJSON into a method of CWalletTx",
      "tree": {
        "sha": "2d4dc92a8284933644cbaf3ca954afbcbc7277ac",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2d4dc92a8284933644cbaf3ca954afbcbc7277ac"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bf484901c9ab74f4b93f014660728ae63f4a2710",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bf484901c9ab74f4b93f014660728ae63f4a2710",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/bf484901c9ab74f4b93f014660728ae63f4a2710",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bf484901c9ab74f4b93f014660728ae63f4a2710/comments",
    "author": {
      "login": "mikegogulski",
      "id": 118625,
      "node_id": "MDQ6VXNlcjExODYyNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/118625?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mikegogulski",
      "html_url": "https://github.com/mikegogulski",
      "followers_url": "https://api.github.com/users/mikegogulski/followers",
      "following_url": "https://api.github.com/users/mikegogulski/following{/other_user}",
      "gists_url": "https://api.github.com/users/mikegogulski/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mikegogulski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mikegogulski/subscriptions",
      "organizations_url": "https://api.github.com/users/mikegogulski/orgs",
      "repos_url": "https://api.github.com/users/mikegogulski/repos",
      "events_url": "https://api.github.com/users/mikegogulski/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mikegogulski/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "mikegogulski",
      "id": 118625,
      "node_id": "MDQ6VXNlcjExODYyNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/118625?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mikegogulski",
      "html_url": "https://github.com/mikegogulski",
      "followers_url": "https://api.github.com/users/mikegogulski/followers",
      "following_url": "https://api.github.com/users/mikegogulski/following{/other_user}",
      "gists_url": "https://api.github.com/users/mikegogulski/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mikegogulski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mikegogulski/subscriptions",
      "organizations_url": "https://api.github.com/users/mikegogulski/orgs",
      "repos_url": "https://api.github.com/users/mikegogulski/repos",
      "events_url": "https://api.github.com/users/mikegogulski/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mikegogulski/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "cd7fb7d1deece9da15d7750b3e05f729555a2cbe",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/cd7fb7d1deece9da15d7750b3e05f729555a2cbe",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/cd7fb7d1deece9da15d7750b3e05f729555a2cbe"
      }
    ],
    "stats": {
      "total": 47,
      "additions": 25,
      "deletions": 22
    },
    "files": [
      {
        "sha": "904b71c06d0ec97b9d6f1a4f551f06e46185cbdf",
        "filename": "src/rpcwallet.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 22,
        "changes": 25,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bf484901c9ab74f4b93f014660728ae63f4a2710/src/rpcwallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bf484901c9ab74f4b93f014660728ae63f4a2710/src/rpcwallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpcwallet.cpp?ref=bf484901c9ab74f4b93f014660728ae63f4a2710",
        "patch": "@@ -28,25 +28,6 @@ void EnsureWalletIsUnlocked()\n         throw JSONRPCError(RPC_WALLET_UNLOCK_NEEDED, \"Error: Please enter the wallet passphrase with walletpassphrase first.\");\n }\n \n-void WalletTxToJSON(const CWalletTx& wtx, Object& entry)\n-{\n-    int confirms = wtx.GetDepthInMainChain();\n-    entry.push_back(Pair(\"confirmations\", confirms));\n-    if (wtx.IsCoinBase())\n-        entry.push_back(Pair(\"generated\", true));\n-    if (confirms)\n-    {\n-        entry.push_back(Pair(\"blockhash\", wtx.hashBlock.GetHex()));\n-        entry.push_back(Pair(\"blockindex\", wtx.nIndex));\n-        entry.push_back(Pair(\"blocktime\", (boost::int64_t)(mapBlockIndex[wtx.hashBlock]->nTime)));\n-    }\n-    entry.push_back(Pair(\"txid\", wtx.GetHash().GetHex()));\n-    entry.push_back(Pair(\"time\", (boost::int64_t)wtx.GetTxTime()));\n-    entry.push_back(Pair(\"timereceived\", (boost::int64_t)wtx.nTimeReceived));\n-    BOOST_FOREACH(const PAIRTYPE(string,string)& item, wtx.mapValue)\n-        entry.push_back(Pair(item.first, item.second));\n-}\n-\n string AccountFromValue(const Value& value)\n {\n     string strAccount = value.get_str();\n@@ -960,7 +941,7 @@ void ListTransactions(const CWalletTx& wtx, const string& strAccount, int nMinDe\n             entry.push_back(Pair(\"amount\", ValueFromAmount(-s.second)));\n             entry.push_back(Pair(\"fee\", ValueFromAmount(-nFee)));\n             if (fLong)\n-                WalletTxToJSON(wtx, entry);\n+                wtx.GetJSON(entry);\n             ret.push_back(entry);\n         }\n     }\n@@ -991,7 +972,7 @@ void ListTransactions(const CWalletTx& wtx, const string& strAccount, int nMinDe\n                     entry.push_back(Pair(\"category\", \"receive\"));\n                 entry.push_back(Pair(\"amount\", ValueFromAmount(r.second)));\n                 if (fLong)\n-                    WalletTxToJSON(wtx, entry);\n+                    wtx.GetJSON(entry);\n                 ret.push_back(entry);\n             }\n         }\n@@ -1210,7 +1191,7 @@ Value gettransaction(const Array& params, bool fHelp)\n     if (wtx.IsFromMe())\n         entry.push_back(Pair(\"fee\", ValueFromAmount(nFee)));\n \n-    WalletTxToJSON(wtx, entry);\n+    wtx.GetJSON(entry);\n \n     Array details;\n     ListTransactions(wtx, \"*\", 0, false, details);"
      },
      {
        "sha": "92f09412047e034cceb0942b97e43200e02fda16",
        "filename": "src/wallet.cpp",
        "status": "modified",
        "additions": 20,
        "deletions": 0,
        "changes": 20,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bf484901c9ab74f4b93f014660728ae63f4a2710/src/wallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bf484901c9ab74f4b93f014660728ae63f4a2710/src/wallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet.cpp?ref=bf484901c9ab74f4b93f014660728ae63f4a2710",
        "patch": "@@ -9,6 +9,7 @@\n #include \"ui_interface.h\"\n #include \"base58.h\"\n \n+using namespace json_spirit;\n using namespace std;\n \n \n@@ -841,6 +842,25 @@ void CWalletTx::RelayWalletTransaction()\n     }\n }\n \n+void CWalletTx::GetJSON(Object& entry) const\n+{\n+    int confirms = GetDepthInMainChain();\n+    entry.push_back(Pair(\"confirmations\", confirms));\n+    if (IsCoinBase())\n+        entry.push_back(Pair(\"generated\", true));\n+    if (confirms)\n+    {\n+        entry.push_back(Pair(\"blockhash\", hashBlock.GetHex()));\n+        entry.push_back(Pair(\"blockindex\", nIndex));\n+        entry.push_back(Pair(\"blocktime\", (boost::int64_t)(mapBlockIndex[hashBlock]->nTime)));\n+    }\n+    entry.push_back(Pair(\"txid\", GetHash().GetHex()));\n+    entry.push_back(Pair(\"time\", (boost::int64_t)GetTxTime()));\n+    entry.push_back(Pair(\"timereceived\", (boost::int64_t)nTimeReceived));\n+    BOOST_FOREACH(const PAIRTYPE(string,string)& item, mapValue)\n+        entry.push_back(Pair(item.first, item.second));\n+}\n+\n void CWallet::ResendWalletTransactions()\n {\n     // Do this infrequently and randomly to avoid giving away"
      },
      {
        "sha": "c33d6e139ff8ade5e0d2da6d2031b85254ba8c19",
        "filename": "src/wallet.h",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bf484901c9ab74f4b93f014660728ae63f4a2710/src/wallet.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bf484901c9ab74f4b93f014660728ae63f4a2710/src/wallet.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet.h?ref=bf484901c9ab74f4b93f014660728ae63f4a2710",
        "patch": "@@ -17,6 +17,7 @@\n #include \"ui_interface.h\"\n #include \"util.h\"\n #include \"walletdb.h\"\n+#include \"json/json_spirit_value.h\"\n \n class CAccountingEntry;\n class CWalletTx;\n@@ -679,6 +680,7 @@ class CWalletTx : public CMerkleTx\n     void AddSupportingTransactions();\n     bool AcceptWalletTransaction(bool fCheckInputs=true);\n     void RelayWalletTransaction();\n+    void GetJSON(json_spirit::Object& entry) const;\n };\n \n "
      }
    ]
  }
]