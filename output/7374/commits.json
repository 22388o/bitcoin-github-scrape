[
  {
    "sha": "36d1823b559a35af539753463f5250f07fcdf3fb",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozNmQxODIzYjU1OWEzNWFmNTM5NzUzNDYzZjUyNTBmMDdmY2RmM2Zi",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2016-01-19T16:42:33Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2016-01-19T16:44:19Z"
      },
      "message": "[tests] Extend util_ParseMoney test case",
      "tree": {
        "sha": "18e5fec6e253892a3349f87a41d41269d746a908",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/18e5fec6e253892a3349f87a41d41269d746a908"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/36d1823b559a35af539753463f5250f07fcdf3fb",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/36d1823b559a35af539753463f5250f07fcdf3fb",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/36d1823b559a35af539753463f5250f07fcdf3fb",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/36d1823b559a35af539753463f5250f07fcdf3fb/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "21376af183ffd1a9b4a16610ec53e3d4d258dbc2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/21376af183ffd1a9b4a16610ec53e3d4d258dbc2",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/21376af183ffd1a9b4a16610ec53e3d4d258dbc2"
      }
    ],
    "stats": {
      "total": 5,
      "additions": 5,
      "deletions": 0
    },
    "files": [
      {
        "sha": "517e6945cf9bc02a38287a791eb826f7908e86da",
        "filename": "src/test/util_tests.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 0,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/36d1823b559a35af539753463f5250f07fcdf3fb/src/test/util_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/36d1823b559a35af539753463f5250f07fcdf3fb/src/test/util_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/util_tests.cpp?ref=36d1823b559a35af539753463f5250f07fcdf3fb",
        "patch": "@@ -196,6 +196,8 @@ BOOST_AUTO_TEST_CASE(util_ParseMoney)\n     BOOST_CHECK_EQUAL(ret, COIN*10);\n     BOOST_CHECK(ParseMoney(\"1.00\", ret));\n     BOOST_CHECK_EQUAL(ret, COIN);\n+    BOOST_CHECK(ParseMoney(\"1\", ret));\n+    BOOST_CHECK_EQUAL(ret, COIN);\n     BOOST_CHECK(ParseMoney(\"0.1\", ret));\n     BOOST_CHECK_EQUAL(ret, COIN/10);\n     BOOST_CHECK(ParseMoney(\"0.01\", ret));\n@@ -215,6 +217,9 @@ BOOST_AUTO_TEST_CASE(util_ParseMoney)\n \n     // Attempted 63 bit overflow should fail\n     BOOST_CHECK(!ParseMoney(\"92233720368.54775808\", ret));\n+\n+    // Parsing negative amounts must fail\n+    BOOST_CHECK(!ParseMoney(\"-1\", ret));\n }\n \n BOOST_AUTO_TEST_CASE(util_IsHex)"
      }
    ]
  },
  {
    "sha": "fa69058bef8b11b62679e0ab3a4681745a1028a4",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYTY5MDU4YmVmOGIxMWI2MjY3OWUwYWIzYTQ2ODE3NDVhMTAyOGE0",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2016-01-07T23:38:32Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2016-01-20T13:45:51Z"
      },
      "message": "[init] Rework transaction fee warnings",
      "tree": {
        "sha": "f2047688d6ca3ad729fc9d3205fc57545d114730",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f2047688d6ca3ad729fc9d3205fc57545d114730"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa69058bef8b11b62679e0ab3a4681745a1028a4",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa69058bef8b11b62679e0ab3a4681745a1028a4",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fa69058bef8b11b62679e0ab3a4681745a1028a4",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa69058bef8b11b62679e0ab3a4681745a1028a4/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "36d1823b559a35af539753463f5250f07fcdf3fb",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/36d1823b559a35af539753463f5250f07fcdf3fb",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/36d1823b559a35af539753463f5250f07fcdf3fb"
      }
    ],
    "stats": {
      "total": 44,
      "additions": 30,
      "deletions": 14
    },
    "files": [
      {
        "sha": "a0ee063b85ee3432826e58d4c9c8d09876e3f733",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 26,
        "deletions": 10,
        "changes": 36,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa69058bef8b11b62679e0ab3a4681745a1028a4/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa69058bef8b11b62679e0ab3a4681745a1028a4/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=fa69058bef8b11b62679e0ab3a4681745a1028a4",
        "patch": "@@ -767,7 +767,7 @@ static std::string ResolveErrMsg(const char * const optname, const std::string&\n \n static std::string AmountErrMsg(const char * const optname, const std::string& strValue)\n {\n-    return strprintf(_(\"Invalid amount for -%s=<amount>: '%s'\"), optname, strValue);\n+    return strprintf(_(\"Invalid amount for -%s=<amount>: '%s'.\"), optname, strValue);\n }\n \n void InitLogging()\n@@ -941,6 +941,11 @@ bool AppInit2(boost::thread_group& threadGroup, CScheduler& scheduler)\n     if (nConnectTimeout <= 0)\n         nConnectTimeout = DEFAULT_CONNECT_TIMEOUT;\n \n+    const std::string HIGH_AMOUNT_WARN_MSG = _(\"%s is set very high!\");\n+    const std::string LOW_AMOUNT_WARN_MSG =\n+        _(\"%s is set very low!\") + \" \" + _(\"Transactions you create may take a long time to confirm when you set \"\n+                                           \"%s lower than the default relay fee.\");\n+\n     // Fee-per-kilobyte amount considered the same as \"free\"\n     // If you are mining, be careful setting this:\n     // if you set it to zero then\n@@ -950,10 +955,12 @@ bool AppInit2(boost::thread_group& threadGroup, CScheduler& scheduler)\n     if (mapArgs.count(\"-minrelaytxfee\"))\n     {\n         CAmount n = 0;\n-        if (ParseMoney(mapArgs[\"-minrelaytxfee\"], n) && n > 0)\n-            ::minRelayTxFee = CFeeRate(n);\n-        else\n+        if (!ParseMoney(mapArgs[\"-minrelaytxfee\"], n))\n             return InitError(AmountErrMsg(\"minrelaytxfee\", mapArgs[\"-minrelaytxfee\"]));\n+        if (n > HIGH_TX_FEE_PER_KB)\n+            InitWarning(strprintf(HIGH_AMOUNT_WARN_MSG, \"-minrelaytxfee\") + \" \" +\n+                        _(\"This is the minimum transaction fee you pay on every transaction.\"));\n+        ::minRelayTxFee = CFeeRate(n);\n     }\n \n     fRequireStandard = !GetBoolArg(\"-acceptnonstdtxn\", !Params().RequireStandard());\n@@ -965,27 +972,36 @@ bool AppInit2(boost::thread_group& threadGroup, CScheduler& scheduler)\n     if (mapArgs.count(\"-mintxfee\"))\n     {\n         CAmount n = 0;\n-        if (ParseMoney(mapArgs[\"-mintxfee\"], n) && n > 0)\n-            CWallet::minTxFee = CFeeRate(n);\n-        else\n+        if (!ParseMoney(mapArgs[\"-mintxfee\"], n))\n             return InitError(AmountErrMsg(\"mintxfee\", mapArgs[\"-mintxfee\"]));\n+        if (n > HIGH_TX_FEE_PER_KB)\n+            InitWarning(strprintf(HIGH_AMOUNT_WARN_MSG, \"-mintxfee\") + \" \" +\n+                        _(\"This is the minimum transaction fee you pay on every transaction.\"));\n+        if (n < DEFAULT_MIN_RELAY_TX_FEE)\n+            InitWarning(strprintf(LOW_AMOUNT_WARN_MSG, \"-mintxfee\", \"-mintxfee\"));\n+        CWallet::minTxFee = CFeeRate(n);\n     }\n     if (mapArgs.count(\"-fallbackfee\"))\n     {\n         CAmount nFeePerK = 0;\n         if (!ParseMoney(mapArgs[\"-fallbackfee\"], nFeePerK))\n             return InitError(strprintf(_(\"Invalid amount for -fallbackfee=<amount>: '%s'\"), mapArgs[\"-fallbackfee\"]));\n-        if (nFeePerK > nHighTransactionFeeWarning)\n+        if (nFeePerK > HIGH_TX_FEE_PER_KB)\n             InitWarning(_(\"-fallbackfee is set very high! This is the transaction fee you may pay when fee estimates are not available.\"));\n+        if (nFeePerK < DEFAULT_MIN_RELAY_TX_FEE)\n+            InitWarning(strprintf(LOW_AMOUNT_WARN_MSG, \"-fallbackfee\", \"-fallbackfee\"));\n         CWallet::fallbackFee = CFeeRate(nFeePerK);\n     }\n     if (mapArgs.count(\"-paytxfee\"))\n     {\n         CAmount nFeePerK = 0;\n         if (!ParseMoney(mapArgs[\"-paytxfee\"], nFeePerK))\n             return InitError(AmountErrMsg(\"paytxfee\", mapArgs[\"-paytxfee\"]));\n-        if (nFeePerK > nHighTransactionFeeWarning)\n+        if (nFeePerK > HIGH_TX_FEE_PER_KB)\n             InitWarning(_(\"-paytxfee is set very high! This is the transaction fee you will pay if you send a transaction.\"));\n+        if (nFeePerK < DEFAULT_MIN_RELAY_TX_FEE)\n+            InitWarning(strprintf(LOW_AMOUNT_WARN_MSG, \"-paytxfee\", \"-paytxfee\"));\n+\n         payTxFee = CFeeRate(nFeePerK, 1000);\n         if (payTxFee < ::minRelayTxFee)\n         {\n@@ -998,7 +1014,7 @@ bool AppInit2(boost::thread_group& threadGroup, CScheduler& scheduler)\n         CAmount nMaxFee = 0;\n         if (!ParseMoney(mapArgs[\"-maxtxfee\"], nMaxFee))\n             return InitError(AmountErrMsg(\"maxtxfee\", mapArgs[\"-maxtxfee\"]));\n-        if (nMaxFee > nHighTransactionMaxFeeWarning)\n+        if (nMaxFee > HIGH_MAX_TX_FEE)\n             InitWarning(_(\"-maxtxfee is set very high! Fees this large could be paid on a single transaction.\"));\n         maxTxFee = nMaxFee;\n         if (CFeeRate(maxTxFee, 1000) < ::minRelayTxFee)"
      },
      {
        "sha": "3a9d1f3cee0fe8627b047430ab1c2e9e3657b5eb",
        "filename": "src/main.h",
        "status": "modified",
        "additions": 4,
        "deletions": 0,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa69058bef8b11b62679e0ab3a4681745a1028a4/src/main.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa69058bef8b11b62679e0ab3a4681745a1028a4/src/main.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.h?ref=fa69058bef8b11b62679e0ab3a4681745a1028a4",
        "patch": "@@ -44,6 +44,10 @@ struct CNodeStateStats;\n static const bool DEFAULT_ALERTS = true;\n /** Default for DEFAULT_WHITELISTALWAYSRELAY. */\n static const bool DEFAULT_WHITELISTALWAYSRELAY = true;\n+//! Discourage users to set fees higher than this amount (in satoshis) per kB\n+static const CAmount HIGH_TX_FEE_PER_KB = 0.01 * COIN;\n+//! -maxtxfee will warn if called with a higher fee than this amount (in satoshis)\n+static const CAmount HIGH_MAX_TX_FEE = 100 * HIGH_TX_FEE_PER_KB;\n /** Default for -minrelaytxfee, minimum relay fee for transactions */\n static const unsigned int DEFAULT_MIN_RELAY_TX_FEE = 1000;\n /** Default for -maxorphantx, maximum number of orphan transactions kept in memory */"
      },
      {
        "sha": "fe5306e7a8b5a767aaeb933951abb851e7163e03",
        "filename": "src/wallet/wallet.h",
        "status": "modified",
        "additions": 0,
        "deletions": 4,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa69058bef8b11b62679e0ab3a4681745a1028a4/src/wallet/wallet.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa69058bef8b11b62679e0ab3a4681745a1028a4/src/wallet/wallet.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/wallet.h?ref=fa69058bef8b11b62679e0ab3a4681745a1028a4",
        "patch": "@@ -39,8 +39,6 @@ extern bool fSendFreeTransactions;\n static const unsigned int DEFAULT_KEYPOOL_SIZE = 100;\n //! -paytxfee default\n static const CAmount DEFAULT_TRANSACTION_FEE = 0;\n-//! -paytxfee will warn if called with a higher fee than this amount (in satoshis) per KB\n-static const CAmount nHighTransactionFeeWarning = 0.01 * COIN;\n //! -fallbackfee default\n static const CAmount DEFAULT_FALLBACK_FEE = 20000;\n //! -mintxfee default\n@@ -55,8 +53,6 @@ static const bool DEFAULT_SPEND_ZEROCONF_CHANGE = true;\n static const bool DEFAULT_SEND_FREE_TRANSACTIONS = false;\n //! -txconfirmtarget default\n static const unsigned int DEFAULT_TX_CONFIRM_TARGET = 2;\n-//! -maxtxfee will warn if called with a higher fee than this amount (in satoshis)\n-static const CAmount nHighTransactionMaxFeeWarning = 100 * nHighTransactionFeeWarning;\n //! Largest (in bytes) free transaction we're willing to create\n static const unsigned int MAX_FREE_TRANSACTION_CREATE_SIZE = 1000;\n static const bool DEFAULT_WALLETBROADCAST = true;"
      }
    ]
  }
]