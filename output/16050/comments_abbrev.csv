DrahtBot,2019-05-19 22:44:12,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#14942](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14942.html) (wallet: Make scan / abort status private to",https://github.com/bitcoin/bitcoin/pull/16050#issuecomment-493798405,493798405,
promag,2019-05-20 13:27:46,"@jonatack thanks for the review, followed some of your suggestions.",https://github.com/bitcoin/bitcoin/pull/16050#issuecomment-493987069,493987069,
jb55,2019-05-20 17:20:36,"Concept ACK. It's not really clear what ""update"" means in this context. Should it be called notify_existing?",https://github.com/bitcoin/bitcoin/pull/16050#issuecomment-494076791,494076791,
promag,2019-05-21 10:04:09,Updated OP from original by @pedrobranco.,https://github.com/bitcoin/bitcoin/pull/16050#issuecomment-494326740,494326740,
jonasschnelli,2019-05-22 10:21:32,Looks good. The release notes text may need to a bit more precise (fUpdate is not only about calling the wallet notify endpoint?!).,https://github.com/bitcoin/bitcoin/pull/16050#issuecomment-494744179,494744179,
promag,2019-05-22 10:25:32,"@jonasschnelli right, that's why the RPC option isn't  `notify_existing`. Alternatively we could split `fUpdate` in order to control only the notification.",https://github.com/bitcoin/bitcoin/pull/16050#issuecomment-494745412,494745412,
sipa,2019-05-22 18:39:40,"I have a feeling this is a bit of a hack (or at least an ""expert option"" that shouldn't be needed for normal operation), to work around the fact that we always rescan for all addresses.\n\nIn a more optimal implementation (which I hope we'll more easily have with a native descriptor design), importing a new (set of) addresses/descriptors/scripts should only scan for transactions interacting with",https://github.com/bitcoin/bitcoin/pull/16050#issuecomment-494916473,494916473,
promag,2019-05-22 18:49:59,"@sipa agree, always thought rescan could take into account a ""wallet subset"". I'm still going to leave this open while I look into that.",https://github.com/bitcoin/bitcoin/pull/16050#issuecomment-494920664,494920664,
luke-jr,2019-08-19 22:11:59,I agree this is a kind of ugly hack. Maybe we should just never update existing on rescans? Would that break any use case?,https://github.com/bitcoin/bitcoin/pull/16050#issuecomment-522773834,522773834,
promag,2019-08-25 10:20:49,"> Would that break any use case?\n\n@luke-jr safe bet is yes.",https://github.com/bitcoin/bitcoin/pull/16050#issuecomment-524618188,524618188,
promag,2019-09-15 09:45:02,Let's revisit this issue later then.,https://github.com/bitcoin/bitcoin/pull/16050#issuecomment-531550932,531550932,
jonatack,2019-05-20 11:19:09,"suggested clarification\n```diff\n-            self.test_importmulti(updateexisting=True, count=11)\n+            self.test_importmulti(updateexisting=True, count=block_count+1)\n```",https://github.com/bitcoin/bitcoin/pull/16050#discussion_r285541385,285541385,test/functional/feature_notifications.py
jonatack,2019-05-20 11:22:45,"logging suggestion\n```diff\n         self.nodes[0].generatetoaddress(1, addr)\n\n+        self.log.info('test -walletnotify with importmulti ""updateexisting"": {}'.format(updateexisting))\n         self.nodes[1].importmulti([{""scriptPubKey"": {""address"": addr}, ""timestamp"": ""now""}], {""updateexisting"": updateexisting})\n\n             assert_equal(sorted(txids_rpc), sorted(os.listdir(self.wal",https://github.com/bitcoin/bitcoin/pull/16050#discussion_r285542417,285542417,test/functional/feature_notifications.py
jonatack,2019-05-20 11:36:57,and maybe the 1 in each `self.test_importmulti` call and inside the function with a `NEW_ADDRESSES_COUNT` constant. Ideally the number could vary randomly with each test run.,https://github.com/bitcoin/bitcoin/pull/16050#discussion_r285547015,285547015,test/functional/feature_notifications.py
jonatack,2019-05-20 11:51:50,"nits: comma after false and ""the"" after ""notified to""",https://github.com/bitcoin/bitcoin/pull/16050#discussion_r285552432,285552432,doc/release-notes-16050.md
jonatack,2019-05-20 11:52:46,"Comment suggestion\n```diff\n+        # Wait at most 10 seconds for expected number of files predicate to be true.\n         wait_until(lambda: len(os.listdir(self.walletnotify_dir)) == count, timeout=10)\n```",https://github.com/bitcoin/bitcoin/pull/16050#discussion_r285552732,285552732,test/functional/feature_notifications.py
promag,2019-05-20 13:13:32,I don't think it has to be so verbose.,https://github.com/bitcoin/bitcoin/pull/16050#discussion_r285585223,285585223,test/functional/feature_notifications.py
promag,2019-05-20 13:14:54,Code is pretty much self explanatory?,https://github.com/bitcoin/bitcoin/pull/16050#discussion_r285585779,285585779,test/functional/feature_notifications.py
promag,2019-05-20 13:21:49,Let's keep this simple for now.,https://github.com/bitcoin/bitcoin/pull/16050#discussion_r285588651,285588651,test/functional/feature_notifications.py
jonatack,2019-05-20 13:38:22,True. My thought was to highlight for reviewers unfamiliar with `wait_until` that it can be a form of test assertion but it's definitely optional.,https://github.com/bitcoin/bitcoin/pull/16050#discussion_r285596668,285596668,test/functional/feature_notifications.py
jonatack,2019-05-20 13:41:16,`expected_notifications`: good idea :+1: ,https://github.com/bitcoin/bitcoin/pull/16050#discussion_r285598057,285598057,test/functional/feature_notifications.py
