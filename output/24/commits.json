[
  {
    "sha": "80be6e69a92130175da623fbb75552a04d3ff4f8",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4MGJlNmU2OWE5MjEzMDE3NWRhNjIzZmJiNzU1NTJhMDRkM2ZmNGY4",
    "commit": {
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-01-07T19:10:08Z"
      },
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2011-01-07T19:10:08Z"
      },
      "message": "Add account/address details to gettransaction output",
      "tree": {
        "sha": "5c51e2a83f44cfc06c2f6da372af9c32a8488b54",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5c51e2a83f44cfc06c2f6da372af9c32a8488b54"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/80be6e69a92130175da623fbb75552a04d3ff4f8",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/80be6e69a92130175da623fbb75552a04d3ff4f8",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/80be6e69a92130175da623fbb75552a04d3ff4f8",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/80be6e69a92130175da623fbb75552a04d3ff4f8/comments",
    "author": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "009d5fb41f3aa39baeeb3f72454cdc14459fc67e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/009d5fb41f3aa39baeeb3f72454cdc14459fc67e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/009d5fb41f3aa39baeeb3f72454cdc14459fc67e"
      }
    ],
    "stats": {
      "total": 20,
      "additions": 14,
      "deletions": 6
    },
    "files": [
      {
        "sha": "fa9bda773cfcca4069dac253cca8e3cde8396739",
        "filename": "rpc.cpp",
        "status": "modified",
        "additions": 14,
        "deletions": 6,
        "changes": 20,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/80be6e69a92130175da623fbb75552a04d3ff4f8/rpc.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/80be6e69a92130175da623fbb75552a04d3ff4f8/rpc.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/rpc.cpp?ref=80be6e69a92130175da623fbb75552a04d3ff4f8",
        "patch": "@@ -857,7 +857,7 @@ Value listreceivedbyaccount(const Array& params, bool fHelp)\n     return ListReceived(params, true);\n }\n \n-void ListTransactions(const CWalletTx& wtx, const string& strAccount, int nMinDepth, Array& ret)\n+void ListTransactions(const CWalletTx& wtx, const string& strAccount, int nMinDepth, bool fLong, Array& ret)\n {\n     int64 nGenerated, nFee;\n     string strSentAccount;\n@@ -874,7 +874,8 @@ void ListTransactions(const CWalletTx& wtx, const string& strAccount, int nMinDe\n         entry.push_back(Pair(\"account\", string(\"\")));\n         entry.push_back(Pair(\"category\", \"generate\"));\n         entry.push_back(Pair(\"amount\", ValueFromAmount(nGenerated)));\n-        WalletTxToJSON(wtx, entry);\n+        if (fLong)\n+            WalletTxToJSON(wtx, entry);\n         ret.push_back(entry);\n     }\n \n@@ -889,7 +890,8 @@ void ListTransactions(const CWalletTx& wtx, const string& strAccount, int nMinDe\n             entry.push_back(Pair(\"category\", \"send\"));\n             entry.push_back(Pair(\"amount\", ValueFromAmount(-s.second)));\n             entry.push_back(Pair(\"fee\", ValueFromAmount(-nFee)));\n-            WalletTxToJSON(wtx, entry);\n+            if (fLong)\n+                WalletTxToJSON(wtx, entry);\n             ret.push_back(entry);\n         }\n     }\n@@ -910,7 +912,8 @@ void ListTransactions(const CWalletTx& wtx, const string& strAccount, int nMinDe\n                     entry.push_back(Pair(\"address\", r.first));\n                     entry.push_back(Pair(\"category\", \"receive\"));\n                     entry.push_back(Pair(\"amount\", ValueFromAmount(r.second)));\n-                    WalletTxToJSON(wtx, entry);\n+                    if (fLong)\n+                        WalletTxToJSON(wtx, entry);\n                     ret.push_back(entry);\n                 }\n             }\n@@ -976,7 +979,7 @@ Value listtransactions(const Array& params, bool fHelp)\n         {\n             CWalletTx *const pwtx = (*it).second.first;\n             if (pwtx != 0)\n-                ListTransactions(*pwtx, strAccount, 0, ret);\n+                ListTransactions(*pwtx, strAccount, 0, true, ret);\n             CAccountingEntry *const pacentry = (*it).second.second;\n             if (pacentry != 0)\n                 AcentryToJSON(*pacentry, strAccount, ret);\n@@ -1063,7 +1066,7 @@ Value gettransaction(const Array& params, bool fHelp)\n     CRITICAL_BLOCK(cs_mapWallet)\n     {\n         if (!mapWallet.count(hash))\n-            throw JSONRPCError(-5, \"Invalid transaction id\");\n+            throw JSONRPCError(-5, \"Invalid or non-wallet transaction id\");\n         const CWalletTx& wtx = mapWallet[hash];\n \n         int64 nCredit = wtx.GetCredit();\n@@ -1074,7 +1077,12 @@ Value gettransaction(const Array& params, bool fHelp)\n         entry.push_back(Pair(\"amount\", ValueFromAmount(nNet - nFee)));\n         if (wtx.IsFromMe())\n             entry.push_back(Pair(\"fee\", ValueFromAmount(nFee)));\n+\n         WalletTxToJSON(mapWallet[hash], entry);\n+\n+        Array details;\n+        ListTransactions(mapWallet[hash], \"*\", 0, false, details);\n+        entry.push_back(Pair(\"details\", details));\n     }\n \n     return entry;"
      }
    ]
  }
]