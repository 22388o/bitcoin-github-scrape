[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/745444518",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20661#issuecomment-745444518",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20661",
    "id": 745444518,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0NTQ0NDUxOA==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-15T17:30:03Z",
    "updated_at": "2020-12-15T17:30:03Z",
    "author_association": "MEMBER",
    "body": "Assuming backport to 0.21.1",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/745444518/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/745445742",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20661#issuecomment-745445742",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20661",
    "id": 745445742,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0NTQ0NTc0Mg==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-15T17:32:07Z",
    "updated_at": "2020-12-15T17:32:07Z",
    "author_association": "MEMBER",
    "body": "Concept ACK",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/745445742/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/745494611",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20661#issuecomment-745494611",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20661",
    "id": 745494611,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0NTQ5NDYxMQ==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-15T18:53:41Z",
    "updated_at": "2020-12-15T18:53:41Z",
    "author_association": "MEMBER",
    "body": "ACK 794ae71701f3766a86fd61044368d36004d5687f",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/745494611/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/745596760",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20661#issuecomment-745596760",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20661",
    "id": 745596760,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0NTU5Njc2MA==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-15T22:04:45Z",
    "updated_at": "2020-12-15T22:04:45Z",
    "author_association": "MEMBER",
    "body": "ACK 37fe80e6267094f6051ccf9bec0c7f1a6b9e15da\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/745596760/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/543549612",
    "pull_request_review_id": 552707173,
    "id": 543549612,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzU0OTYxMg==",
    "diff_hunk": "@@ -1443,8 +1443,8 @@ static void RelayAddress(const CNode& originator,\n     std::array<std::pair<uint64_t, CNode*>,2> best{{{0, nullptr}, {0, nullptr}}};\n     assert(nRelayNodes <= best.size());\n \n-    auto sortfunc = [&best, &hasher, nRelayNodes, &originator](CNode* pnode) {\n-        if (pnode->RelayAddrsWithConn() && pnode != &originator) {\n+    auto sortfunc = [&best, &hasher, nRelayNodes, &originator, &addr](CNode* pnode) {\n+        if (pnode->RelayAddrsWithConn() && pnode != &originator && (addr.IsAddrV1Compatible() || pnode->m_wants_addrv2)) {",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 7,
    "commit_id": "37fe80e6267094f6051ccf9bec0c7f1a6b9e15da",
    "original_commit_id": "0048b841a2c4b854607a6de8c02a808152510457",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Does it make sense to add a new method `CNode::SupportsAddress(const CAddress&)` and do here: `pnode->SupportsAddress(addr)` and in `CNode::PushAddress()` instead of the variable `addr_format_supported`?",
    "created_at": "2020-12-15T17:39:02Z",
    "updated_at": "2020-12-15T20:46:31Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20661#discussion_r543549612",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20661",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/543549612"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20661#discussion_r543549612"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20661"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/543549612/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1447,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/543559613",
    "pull_request_review_id": 552718787,
    "id": 543559613,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzU1OTYxMw==",
    "diff_hunk": "@@ -1443,8 +1443,8 @@ static void RelayAddress(const CNode& originator,\n     std::array<std::pair<uint64_t, CNode*>,2> best{{{0, nullptr}, {0, nullptr}}};\n     assert(nRelayNodes <= best.size());\n \n-    auto sortfunc = [&best, &hasher, nRelayNodes, &originator](CNode* pnode) {\n-        if (pnode->RelayAddrsWithConn() && pnode != &originator) {\n+    auto sortfunc = [&best, &hasher, nRelayNodes, &originator, &addr](CNode* pnode) {\n+        if (pnode->RelayAddrsWithConn() && pnode != &originator && (addr.IsAddrV1Compatible() || pnode->m_wants_addrv2)) {",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 7,
    "commit_id": "37fe80e6267094f6051ccf9bec0c7f1a6b9e15da",
    "original_commit_id": "0048b841a2c4b854607a6de8c02a808152510457",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "~~That makes sense, but if m_wants_addrv2 is going to move to net_processing's data structures (where it IMO belongs) it's perhaps wasteful to push more into net now?~~\r\n\r\nEDIT: oh, i see, that logic already exists in net. Yeah, fixing.",
    "created_at": "2020-12-15T17:52:44Z",
    "updated_at": "2020-12-15T20:46:31Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20661#discussion_r543559613",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20661",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/543559613"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20661#discussion_r543559613"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20661"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/543559613/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1447,
    "side": "RIGHT",
    "in_reply_to_id": 543549612
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/543563599",
    "pull_request_review_id": 552723392,
    "id": 543563599,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzU2MzU5OQ==",
    "diff_hunk": "@@ -1443,8 +1443,8 @@ static void RelayAddress(const CNode& originator,\n     std::array<std::pair<uint64_t, CNode*>,2> best{{{0, nullptr}, {0, nullptr}}};\n     assert(nRelayNodes <= best.size());\n \n-    auto sortfunc = [&best, &hasher, nRelayNodes, &originator](CNode* pnode) {\n-        if (pnode->RelayAddrsWithConn() && pnode != &originator) {\n+    auto sortfunc = [&best, &hasher, nRelayNodes, &originator, &addr](CNode* pnode) {\n+        if (pnode->RelayAddrsWithConn() && pnode != &originator && (addr.IsAddrV1Compatible() || pnode->m_wants_addrv2)) {",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 7,
    "commit_id": "37fe80e6267094f6051ccf9bec0c7f1a6b9e15da",
    "original_commit_id": "0048b841a2c4b854607a6de8c02a808152510457",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2020-12-15T17:58:11Z",
    "updated_at": "2020-12-15T20:46:31Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20661#discussion_r543563599",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20661",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/543563599"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20661#discussion_r543563599"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20661"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/543563599/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1447,
    "side": "RIGHT",
    "in_reply_to_id": 543549612
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/543583446",
    "pull_request_review_id": 552746864,
    "id": 543583446,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzU4MzQ0Ng==",
    "diff_hunk": "@@ -1176,12 +1176,17 @@ class CNode\n         m_addr_known->insert(_addr.GetKey());\n     }\n \n+    bool IsAddrCompatible(const CAddress& addr) const\n+    {\n+        return m_wants_addrv2 || addr.IsAddrV1Compatible();\n+    }\n+\n     void PushAddress(const CAddress& _addr, FastRandomContext &insecure_rand)\n     {\n         // Whether the peer supports the address in `_addr`. For example,\n         // nodes that do not implement BIP155 cannot receive Tor v3 addresses\n         // because they require ADDRv2 (BIP155) encoding.\n-        const bool addr_format_supported = m_wants_addrv2 || _addr.IsAddrV1Compatible();\n+        const bool addr_format_supported = IsAddrCompatible(_addr);",
    "path": "src/net.h",
    "position": null,
    "original_position": 15,
    "commit_id": "37fe80e6267094f6051ccf9bec0c7f1a6b9e15da",
    "original_commit_id": "a29892429388a10e1cab9a69c3013a537410a20d",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "perhaps hoist the documentation too (rewritten slightly here)\r\n```diff\r\n+    /**\r\n+     * Whether the peer supports the address. For example, a peer that does not\r\n+     * implement BIP155 cannot receive Tor v3 addresses because it requires\r\n+     * ADDRv2 (BIP155) encoding.\r\n+     */\r\n     bool IsAddrCompatible(const CAddress& addr) const\r\n     {\r\n         return m_wants_addrv2 || addr.IsAddrV1Compatible();\r\n@@ -1183,9 +1188,6 @@ public:\r\n \r\n     void PushAddress(const CAddress& _addr, FastRandomContext &insecure_rand)\r\n     {\r\n-        // Whether the peer supports the address in `_addr`. For example,\r\n-        // nodes that do not implement BIP155 cannot receive Tor v3 addresses\r\n-        // because they require ADDRv2 (BIP155) encoding.\r\n         const bool addr_format_supported = IsAddrCompatible(_addr);\r\n```\r\n",
    "created_at": "2020-12-15T18:27:11Z",
    "updated_at": "2020-12-15T20:46:31Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20661#discussion_r543583446",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20661",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/543583446"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20661#discussion_r543583446"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20661"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/543583446/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1191,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/543598619",
    "pull_request_review_id": 552765844,
    "id": 543598619,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzU5ODYxOQ==",
    "diff_hunk": "@@ -1176,12 +1176,17 @@ class CNode\n         m_addr_known->insert(_addr.GetKey());\n     }\n \n+    bool IsAddrCompatible(const CAddress& addr) const\n+    {\n+        return m_wants_addrv2 || addr.IsAddrV1Compatible();\n+    }\n+\n     void PushAddress(const CAddress& _addr, FastRandomContext &insecure_rand)\n     {\n         // Whether the peer supports the address in `_addr`. For example,\n         // nodes that do not implement BIP155 cannot receive Tor v3 addresses\n         // because they require ADDRv2 (BIP155) encoding.\n-        const bool addr_format_supported = m_wants_addrv2 || _addr.IsAddrV1Compatible();\n+        const bool addr_format_supported = IsAddrCompatible(_addr);",
    "path": "src/net.h",
    "position": null,
    "original_position": 15,
    "commit_id": "37fe80e6267094f6051ccf9bec0c7f1a6b9e15da",
    "original_commit_id": "a29892429388a10e1cab9a69c3013a537410a20d",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Good idea, done.",
    "created_at": "2020-12-15T18:49:20Z",
    "updated_at": "2020-12-15T20:46:31Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20661#discussion_r543598619",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20661",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/543598619"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20661#discussion_r543598619"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20661"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/543598619/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1191,
    "side": "RIGHT",
    "in_reply_to_id": 543583446
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/543670294",
    "pull_request_review_id": 552849445,
    "id": 543670294,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzY3MDI5NA==",
    "diff_hunk": "@@ -1176,12 +1176,19 @@ class CNode\n         m_addr_known->insert(_addr.GetKey());\n     }\n \n+    /**\n+     * Whether the peer supports the address. For example, a peer that does not\n+     * implement BIP155 cannot receive Tor v3 addresses because it requires\n+     * ADDRv2 (BIP155) encoding.\n+     */\n+    bool IsAddrCompatible(const CAddress& addr) const\n+    {\n+        return m_wants_addrv2 || addr.IsAddrV1Compatible();\n+    }\n+\n     void PushAddress(const CAddress& _addr, FastRandomContext &insecure_rand)\n     {\n-        // Whether the peer supports the address in `_addr`. For example,\n-        // nodes that do not implement BIP155 cannot receive Tor v3 addresses\n-        // because they require ADDRv2 (BIP155) encoding.\n-        const bool addr_format_supported = m_wants_addrv2 || _addr.IsAddrV1Compatible();\n+        const bool addr_format_supported = IsAddrCompatible(_addr);",
    "path": "src/net.h",
    "position": null,
    "original_position": 20,
    "commit_id": "37fe80e6267094f6051ccf9bec0c7f1a6b9e15da",
    "original_commit_id": "794ae71701f3766a86fd61044368d36004d5687f",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: I think the variable name is as readable as the function call and it is used in just one place, so it may as well be ditched:\r\n\r\n```diff\r\n-if (_addr.IsValid() && !m_addr_known->contains(_addr.GetKey()) && addr_format_supported) {\r\n+if (_addr.IsValid() && !m_addr_known->contains(_addr.GetKey()) && IsAddrCompatible(_addr)) {\r\n```",
    "created_at": "2020-12-15T20:39:27Z",
    "updated_at": "2020-12-15T20:46:31Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20661#discussion_r543670294",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20661",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/543670294"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20661#discussion_r543670294"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20661"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/543670294/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1191,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/543674369",
    "pull_request_review_id": 552854368,
    "id": 543674369,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU0MzY3NDM2OQ==",
    "diff_hunk": "@@ -1176,12 +1176,19 @@ class CNode\n         m_addr_known->insert(_addr.GetKey());\n     }\n \n+    /**\n+     * Whether the peer supports the address. For example, a peer that does not\n+     * implement BIP155 cannot receive Tor v3 addresses because it requires\n+     * ADDRv2 (BIP155) encoding.\n+     */\n+    bool IsAddrCompatible(const CAddress& addr) const\n+    {\n+        return m_wants_addrv2 || addr.IsAddrV1Compatible();\n+    }\n+\n     void PushAddress(const CAddress& _addr, FastRandomContext &insecure_rand)\n     {\n-        // Whether the peer supports the address in `_addr`. For example,\n-        // nodes that do not implement BIP155 cannot receive Tor v3 addresses\n-        // because they require ADDRv2 (BIP155) encoding.\n-        const bool addr_format_supported = m_wants_addrv2 || _addr.IsAddrV1Compatible();\n+        const bool addr_format_supported = IsAddrCompatible(_addr);",
    "path": "src/net.h",
    "position": null,
    "original_position": 20,
    "commit_id": "37fe80e6267094f6051ccf9bec0c7f1a6b9e15da",
    "original_commit_id": "794ae71701f3766a86fd61044368d36004d5687f",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2020-12-15T20:46:31Z",
    "updated_at": "2020-12-15T20:46:31Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20661#discussion_r543674369",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20661",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/543674369"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20661#discussion_r543674369"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20661"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/543674369/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1191,
    "side": "RIGHT",
    "in_reply_to_id": 543670294
  }
]