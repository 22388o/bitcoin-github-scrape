[
  {
    "sha": "a164cd3ba694ffeba03b2887a411b7f82f6c087e",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphMTY0Y2QzYmE2OTRmZmViYTAzYjI4ODdhNDExYjdmODJmNmMwODdl",
    "commit": {
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2021-06-04T14:09:25Z"
      },
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2021-06-04T14:09:25Z"
      },
      "message": "net: simplify CNetAddr::IsRoutable()\n\nReduce the condition `IsRFC4193() && !IsTor()` to `IsRFC4193()`. We know\nthat if `IsRFC4193()` is `true` then, for sure, the address is not Tor,\nso `!IsTor()` is also `true`.",
      "tree": {
        "sha": "22ba6a8cb31b3cce82adad6c71541fda499985e6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/22ba6a8cb31b3cce82adad6c71541fda499985e6"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a164cd3ba694ffeba03b2887a411b7f82f6c087e",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmC6NJgACgkQVN8G9ktV\ny783ph/9F9VjFdjquNfP5ro99mkOmz1ChIoAEVmR2tI7X1Gwtsa0KPXKyUjI6IFt\nxNJjZ25QBXxXo9m1NN/dmcWumlsoR22fgbRDx/MaA0dT95/6LLXwh0rhGGMQYl2Z\nAEt8CsUBhm46pQ9Wa+dIQk67DiEOoSt9JUplTfp2QoTA8khoQFRIg7QuFMUa1zYP\nIB9vU9bPjt0oNmz0XQdmAVHos0jROVogSkN4JEJtsRXXr78vpvRXfgrc8mPrNHov\nmWzXZMlo7Wp61wXY3tjO4Dl9g7p7DjNC5FZ5Dxr1baBwVmAF1NhPU12sS2qebCto\nFIRVQwgq9G24O3Jh99YMMHUiUbm/Sv/u0A5F+EH9+cJe1foUoaCxkMn8LgfCIdwz\nHC08YKOtEZbJ+Od4znhjgo4xB9BPPZUtA26R/Cas10nzEzM04j+wlZt/Icls/z1p\nlRnEDV3vD3HDddbcQtFFHF+dEEvobxvTc4cAZ3MqrAkI3N8Y3mKNmQ7PzwTc+SAZ\nZd6Ta8ekeDYItWZRRr1AR5O0TyOOmIdQAsx7u7KHULktyFcbR+/B6lBsg7PvIe9t\nb0HkSIOChl9Ev9xVh+bG/BUMPO1+UlHSS5T9SzOG0tuQXmDMavdzNFi35R/FwWyP\n0gHajk1aMLUO9OXEThjpgLPgzgyxzuq499LQPCzLEVgyxfW5RGOIg8yeAkzfApRL\njgj2EwVmalD63CtIETJl7kSmB6gnE5XJhIoUBXCdmfZmpKJmK8ehdC3VCTsLAf9A\nsnb+OAtZhhW5ENI6zMFkMA9qTcX1KVNLuSTU5LfzD1geZAc2gX9zk75rDZTjHr2H\nXDpBNMaVNpj18Rgn0sXQdwAgkH+VYhdpZq2Z+IA/3Og865msfQcT0fgrW1k9z0yt\n4O+8YUXsuZIIhf4f+HcAR5NeMN7BTIzZyt5udAtf/zjF0xCHXGNJtOhe+NZH9dYd\nDP9TXFe5dnyzzGYDPQklv34gxcMzYWIfv7zm7jp3vstReDfbvaZya/jbOcHKvSmZ\nLT+oz/b1EtGPCjr6/JN1Od9ioXV3pI20t1REGp4BNogihiN18IAWKpPinpUDu5oo\nDdWs1IaDGc7BuMYVd85kjkfpKl56y0OHvO+4IcfcXF1TDl68bt2p5sE7CsSkC9Xi\nnps+hfBg1FmvNQIWCu0M0Vd91KIhoGsJAZCNBlgrDRJfgsjBuTi/eZPYLvkp5Nh7\nun9Iqu9W5j/unR6GXRh2Ie/S+ihxYS4JFYQMrWx+jv1BXuM/BBibRVKKdvccrSd/\nBZkuCxs7ftn6/ruiS/22ou0q6RXG8dIajI3IPSeMBkVTTdb3DJa4mV6miUE08w/1\nKBGo77stPQPjKB/XteS4d8kPM7OsKg==\n=kIVI\n-----END PGP SIGNATURE-----",
        "payload": "tree 22ba6a8cb31b3cce82adad6c71541fda499985e6\nparent a748782a11f0b23f8dcdf167f45d68c863524887\nauthor Vasil Dimov <vd@FreeBSD.org> 1622815765 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1622815765 +0200\n\nnet: simplify CNetAddr::IsRoutable()\n\nReduce the condition `IsRFC4193() && !IsTor()` to `IsRFC4193()`. We know\nthat if `IsRFC4193()` is `true` then, for sure, the address is not Tor,\nso `!IsTor()` is also `true`.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a164cd3ba694ffeba03b2887a411b7f82f6c087e",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/a164cd3ba694ffeba03b2887a411b7f82f6c087e",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a164cd3ba694ffeba03b2887a411b7f82f6c087e/comments",
    "author": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "a748782a11f0b23f8dcdf167f45d68c863524887",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a748782a11f0b23f8dcdf167f45d68c863524887",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/a748782a11f0b23f8dcdf167f45d68c863524887"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 1,
      "deletions": 1
    },
    "files": [
      {
        "sha": "a358f0db0c98728c8a6a064f96417939927d87a0",
        "filename": "src/netaddress.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a164cd3ba694ffeba03b2887a411b7f82f6c087e/src/netaddress.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a164cd3ba694ffeba03b2887a411b7f82f6c087e/src/netaddress.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/netaddress.cpp?ref=a164cd3ba694ffeba03b2887a411b7f82f6c087e",
        "patch": "@@ -489,7 +489,7 @@ bool CNetAddr::IsValid() const\n  */\n bool CNetAddr::IsRoutable() const\n {\n-    return IsValid() && !(IsRFC1918() || IsRFC2544() || IsRFC3927() || IsRFC4862() || IsRFC6598() || IsRFC5737() || (IsRFC4193() && !IsTor()) || IsRFC4843() || IsRFC7343() || IsLocal() || IsInternal());\n+    return IsValid() && !(IsRFC1918() || IsRFC2544() || IsRFC3927() || IsRFC4862() || IsRFC6598() || IsRFC5737() || IsRFC4193() || IsRFC4843() || IsRFC7343() || IsLocal() || IsInternal());\n }\n \n /**"
      }
    ]
  },
  {
    "sha": "bdb62096f0109b2ec76849d33d6cf7187dea299f",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiZGI2MjA5NmYwMTA5YjJlYzc2ODQ5ZDMzZDZjZjcxODdkZWEyOTlm",
    "commit": {
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2021-06-04T14:12:04Z"
      },
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2021-06-04T14:12:04Z"
      },
      "message": "fuzz: reduce possible networks check\n\nIf an address classifies as `IsRFC4193()`, then it cannot be\n`NET_ONION` (Tor v3), thus remove that condition from the assert.",
      "tree": {
        "sha": "0ba41ca245019c1123fdccf4a860ff1b9b974087",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0ba41ca245019c1123fdccf4a860ff1b9b974087"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bdb62096f0109b2ec76849d33d6cf7187dea299f",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmC6NTUACgkQVN8G9ktV\ny792Wx/+PIB731hk5VMG1pBiLRaVB7oy+okFZl8zMwGlExWCDz8cMZFmVUDnX9If\nFe9qm2Mpx9ZfnVM5y1rDY9oF7srmNnw6ARrMU7tBkafhreoGLZiLlPfccBKAa1/3\nHP4pW3QLtYsxH7XZs+MxQ4TkiyO+FTNnWAVvMsqpUdWYv5r1k+vn0Gb42CwAoeGL\n3yGE39sV8trh3sr1QCihmaac7b8Bo/C8erj5Pz7EuUePjAvs+nCco1KfdV7jTaXm\n3JEgYwckJb1w6exkYIewSgTn1tH3E1F/5lGOByx7XJ14ir1qQLU+TVexYVEhzkcX\nH0PrR/u4xeIZEZmeRfyVc0pKqt0/xS8Yx7x0Hk6aETanSRJaOTq5e8RWVFEtr8y0\nRnuo4BlnSqsPTrCtcv7Rhp3Kydix2UZL1uFwWtyXjTbdLJMQUzK0uKB4KMYye6w2\nzNSpiSRmw3jWYA+TgPCPRhng2/TFMdTI3/iWRF0tKKxPmxK6lcpFHalH/0zkWGkp\n8ZwHOlsZV6tX401yHo+wGtIYCaH/MW4rxvn14c0O7vOsom4l7xaZlucEGgi/vkT+\nUniSDF9J1UuL4qd46tZucpRRNStJP1lnu0Dq6YdN2Q/g805iVuZqYS4OcDQaOriT\nanp/V6ckpUQ2PDqzoRhnHf212FFjhZfcqpSHOx96UG4H/GBE020bqQt063EpuMqa\nCXOH3r1N4Z4OXWneTbqmTtKlk+vFkUWLKmY7qREKajJYmhF5Xx+MsFpqOQEGTKMo\nL8HnuPEyUSQL3yNpOuXunv6Gd8fg/kFgZrfM8cyRCI0DkkNT8JYSTr3d2YK5rmyS\nfvcMToJVtzchAU9qSe8Qi1SuxP3k5PGB5yvBs/KDumAr7wv1Lv3vSs0PnWkPe8Pg\najrBclYZiJvU2Hf06B2BkpPXulD1bQECKNi+4tfJwJxuFvmzkaMzTg0mDo0IChEC\nsoTYJU2eZRiFk1200zvZ2cFbb4uqsnAzxXEVYhnZptZdCJJM5/eEys31zbzmxf+2\nsS+j8kfL96pNO1r/h5IesgaJl+rtok2lwbM+sGjbw+Ky+0NDYGpTZ+29A9+RYgJV\nN4r7kPScwcfH4XRwrV4ApeOGzX1B87pQZm7XNEm5AiVi4b3+RAUIZ8/M8G0rtPeK\nqykJVMNLh/cg4gjw6WetWfPnd4crNF6uBQer9Zr7ayUf4qAAmcMJk8EfW7dVoGCn\nQ9ssGICnebNjrq+1jM0o8PTKSRQra+g1VNPSKTfRTu7AhA0tjd5SrVHGQeJvI456\nK8EwMLtlrEW35a5GjOsSKpn0xVEHK6oHUN90KPqYUiQq9/BcSkXnXhYPOJ5VMHWV\nXwN/f2EF2tPDQasJTDmwVLGdqhJ66A==\n=loEU\n-----END PGP SIGNATURE-----",
        "payload": "tree 0ba41ca245019c1123fdccf4a860ff1b9b974087\nparent a164cd3ba694ffeba03b2887a411b7f82f6c087e\nauthor Vasil Dimov <vd@FreeBSD.org> 1622815924 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1622815924 +0200\n\nfuzz: reduce possible networks check\n\nIf an address classifies as `IsRFC4193()`, then it cannot be\n`NET_ONION` (Tor v3), thus remove that condition from the assert.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bdb62096f0109b2ec76849d33d6cf7187dea299f",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/bdb62096f0109b2ec76849d33d6cf7187dea299f",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bdb62096f0109b2ec76849d33d6cf7187dea299f/comments",
    "author": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "a164cd3ba694ffeba03b2887a411b7f82f6c087e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a164cd3ba694ffeba03b2887a411b7f82f6c087e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/a164cd3ba694ffeba03b2887a411b7f82f6c087e"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 1,
      "deletions": 1
    },
    "files": [
      {
        "sha": "6cb81901cb34a45552db9322fed0e9987046a0b7",
        "filename": "src/test/fuzz/netaddress.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bdb62096f0109b2ec76849d33d6cf7187dea299f/src/test/fuzz/netaddress.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bdb62096f0109b2ec76849d33d6cf7187dea299f/src/test/fuzz/netaddress.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/netaddress.cpp?ref=bdb62096f0109b2ec76849d33d6cf7187dea299f",
        "patch": "@@ -54,7 +54,7 @@ FUZZ_TARGET(netaddress)\n     (void)net_addr.IsRFC3927();\n     (void)net_addr.IsRFC3964();\n     if (net_addr.IsRFC4193()) {\n-        assert(net_addr.GetNetwork() == Network::NET_ONION || net_addr.GetNetwork() == Network::NET_INTERNAL || net_addr.GetNetwork() == Network::NET_UNROUTABLE);\n+        assert(net_addr.GetNetwork() == Network::NET_INTERNAL || net_addr.GetNetwork() == Network::NET_UNROUTABLE);\n     }\n     (void)net_addr.IsRFC4380();\n     (void)net_addr.IsRFC4843();"
      }
    ]
  },
  {
    "sha": "00b875ba9414463d0041da6924fd9b54d6a06dee",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzowMGI4NzViYTk0MTQ0NjNkMDA0MWRhNjkyNGZkOWI1NGQ2YTA2ZGVl",
    "commit": {
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2021-06-07T10:45:35Z"
      },
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2021-06-07T12:42:11Z"
      },
      "message": "addrman: remove invalid addresses when unserializing\n\nThe Tor v2 addresses, left over from when Tor v2 was supported will be\nunserialized as a dummy, invalid `::` (all zeros) IPv6 address. Remove\nthem so that they do not take up space in addrman.",
      "tree": {
        "sha": "76c98674e9d4881ef66da84d107aa05dd1a9f7c1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/76c98674e9d4881ef66da84d107aa05dd1a9f7c1"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/00b875ba9414463d0041da6924fd9b54d6a06dee",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAmC+FCQACgkQVN8G9ktV\ny79ZDx/9HVPk8JfnXOMTeuMRfppffAMOPuYdg4MtXQMepJq+dTnyb1l5Gribx7Uc\ncZ7AJJY7KIfB8Omfu7zWnFPhvbiTEjR0Nzrh2Efi3mCjLhPbzeE+j6953J+n6+17\n1ESzAVIZkT2pcWWR7rpHSTQJX97MSP69z458o+VBig29hz53OEJXzd68bbB/QXCB\noZrDNDCRjmAMkyETzTx31hq0VJRabpe4pgj7i5QwV+3w4NEmKGfw4i0cfG8/2vjB\nC8Eu3ds+I+eCi5lI9t6yyuLCQqgxrrs2tVWOC4+eyL7NTz/klk+HOQqhpXcwl3sd\nKEQONG0Z4paNs+R7HNzAy0FRSQ6C6PaYXmt6M2QZRDZW50dawOlj3Yd8tocpR79L\n2USoim7YliUv+rwxN/gPyuN+/Bs+JDTUllIzxAfiRJGwx7TnjVVedi2csvbDw/IZ\nepoar+D3xBaF1grVvF5YuZ2apMcZrQ0o7dMw0ohvn5kTED9cztaILT/kAOUvufTu\nbwKsRbLNjNf99coaDHBHyOy+pI9oym/Ixua+6DdtjrkIXzwqrkEam03xN3+YOej0\n6/pnwZiRez0ABhc6glfXgLkCJ9f6bh640BVX0aSHA8dmEDty8RWIB6EylBQlJsDO\nzkcTAp5ntpMCSUFkymSI2g5giUG+ZNpju8TCVBwGmxIJSYilsOx9O4zwCZulChGY\nL7DZGkEQt+id9mtSgJ0DoLmF8YBUPbqWTPVlIQvf4NGaOiY+ArwsBH0rIv2XY/Ch\nWJQhnR7FQmv9BnxBx3ruEspkz3oMwejKnmF+sgwVWBZer6Wo7fQDYUAXEqLjAZEE\nauPZwiDlv+NulUn48RgxFIfP9B1KTA9wTHHnkgHTjQyorHNBgjSqPwqbFr8ch+Cu\n3s8L+5oZqpf1Geu/n30hc8y23zuEMP+cfL8L11u7404kuY0pynGcWZFKuPdTPJsz\naTF7Hw/isxvML8ML0gKlM/2f1w8WWfQoB5BvshwuMZTLITp1Th5O+XrAnZIHcA/e\nmBGioDpOJy0myhhcZdcFQqnVgAjZkrikMY2mmExog235l/U9RO9HwboTxPTC+KrQ\nVWb+6QRR+dfiRDy+ldHdAxOaONFWt5g4TgzI5xvi9uoaPIG/c1kelZbplBHN5Dr7\nxeQ7kLxPImtbu0n2gBj+RDDoETE89KJNcbe0GNn8EI8vBpMeXzZB31K5VfbtuqFN\nvv6B6ORUT68ccs2Ozjz+Bebvr1xtj0WS2FtRzzeUCZpUnS8y4qDbkkcbjT70wa55\np6zXyG9iEBQOTTdVJbwEDHTvyiLFq7hczFi5abMcRqvSH7e0dRAZR+S6n5Ij6Ri9\n3KUmNslcFZoaM6qai/nob0RNJ9CPew==\n=/lu9\n-----END PGP SIGNATURE-----",
        "payload": "tree 76c98674e9d4881ef66da84d107aa05dd1a9f7c1\nparent bdb62096f0109b2ec76849d33d6cf7187dea299f\nauthor Vasil Dimov <vd@FreeBSD.org> 1623062735 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1623069731 +0200\n\naddrman: remove invalid addresses when unserializing\n\nThe Tor v2 addresses, left over from when Tor v2 was supported will be\nunserialized as a dummy, invalid `::` (all zeros) IPv6 address. Remove\nthem so that they do not take up space in addrman.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/00b875ba9414463d0041da6924fd9b54d6a06dee",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/00b875ba9414463d0041da6924fd9b54d6a06dee",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/00b875ba9414463d0041da6924fd9b54d6a06dee/comments",
    "author": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "bdb62096f0109b2ec76849d33d6cf7187dea299f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bdb62096f0109b2ec76849d33d6cf7187dea299f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/bdb62096f0109b2ec76849d33d6cf7187dea299f"
      }
    ],
    "stats": {
      "total": 77,
      "additions": 77,
      "deletions": 0
    },
    "files": [
      {
        "sha": "24531e8a6f4c0033e362e92d7f86f1a8c51a76c0",
        "filename": "src/addrman.cpp",
        "status": "modified",
        "additions": 32,
        "deletions": 0,
        "changes": 32,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/00b875ba9414463d0041da6924fd9b54d6a06dee/src/addrman.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/00b875ba9414463d0041da6924fd9b54d6a06dee/src/addrman.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/addrman.cpp?ref=00b875ba9414463d0041da6924fd9b54d6a06dee",
        "patch": "@@ -75,6 +75,38 @@ double CAddrInfo::GetChance(int64_t nNow) const\n     return fChance;\n }\n \n+void CAddrMan::RemoveInvalid()\n+{\n+    for (size_t bucket = 0; bucket < ADDRMAN_NEW_BUCKET_COUNT; ++bucket) {\n+        for (size_t i = 0; i < ADDRMAN_BUCKET_SIZE; ++i) {\n+            const auto id = vvNew[bucket][i];\n+            if (id != -1 && !mapInfo[id].IsValid()) {\n+                ClearNew(bucket, i);\n+            }\n+        }\n+    }\n+\n+    for (size_t bucket = 0; bucket < ADDRMAN_TRIED_BUCKET_COUNT; ++bucket) {\n+        for (size_t i = 0; i < ADDRMAN_BUCKET_SIZE; ++i) {\n+            const auto id = vvTried[bucket][i];\n+            if (id == -1) {\n+                continue;\n+            }\n+            const auto& addr_info = mapInfo[id];\n+            if (addr_info.IsValid()) {\n+                continue;\n+            }\n+            vvTried[bucket][i] = -1;\n+            --nTried;\n+            SwapRandom(addr_info.nRandomPos, vRandom.size() - 1);\n+            vRandom.pop_back();\n+            mapAddr.erase(addr_info);\n+            mapInfo.erase(id);\n+            m_tried_collisions.erase(id);\n+        }\n+    }\n+}\n+\n CAddrInfo* CAddrMan::Find(const CNetAddr& addr, int* pnId)\n {\n     std::map<CNetAddr, int>::iterator it = mapAddr.find(addr);"
      },
      {
        "sha": "54ccd5f8f2929b980d48722fbd3d2924c188b008",
        "filename": "src/addrman.h",
        "status": "modified",
        "additions": 5,
        "deletions": 0,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/00b875ba9414463d0041da6924fd9b54d6a06dee/src/addrman.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/00b875ba9414463d0041da6924fd9b54d6a06dee/src/addrman.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/addrman.h?ref=00b875ba9414463d0041da6924fd9b54d6a06dee",
        "patch": "@@ -448,6 +448,8 @@ class CAddrMan\n             LogPrint(BCLog::ADDRMAN, \"addrman lost %i new and %i tried addresses due to collisions\\n\", nLostUnk, nLost);\n         }\n \n+        RemoveInvalid();\n+\n         Check();\n     }\n \n@@ -756,6 +758,9 @@ class CAddrMan\n     //! Update an entry's service bits.\n     void SetServices_(const CService &addr, ServiceFlags nServices) EXCLUSIVE_LOCKS_REQUIRED(cs);\n \n+    //! Remove invalid addresses.\n+    void RemoveInvalid() EXCLUSIVE_LOCKS_REQUIRED(cs);\n+\n     friend class CAddrManTest;\n };\n "
      },
      {
        "sha": "6683065bb3175d3cf7ebe902b52a97deb79021c0",
        "filename": "src/test/addrman_tests.cpp",
        "status": "modified",
        "additions": 40,
        "deletions": 0,
        "changes": 40,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/00b875ba9414463d0041da6924fd9b54d6a06dee/src/test/addrman_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/00b875ba9414463d0041da6924fd9b54d6a06dee/src/test/addrman_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/addrman_tests.cpp?ref=00b875ba9414463d0041da6924fd9b54d6a06dee",
        "patch": "@@ -783,6 +783,46 @@ BOOST_AUTO_TEST_CASE(addrman_serialization)\n     BOOST_CHECK(bucketAndEntry_asmap1_deser_addr1.second != bucketAndEntry_asmap1_deser_addr2.second);\n }\n \n+BOOST_AUTO_TEST_CASE(remove_invalid)\n+{\n+    // Confirm that invalid addresses are ignored in unserialization.\n+\n+    CAddrManTest addrman;\n+    CDataStream stream(SER_NETWORK, PROTOCOL_VERSION);\n+\n+    const CAddress new1{ResolveService(\"5.5.5.5\"), NODE_NONE};\n+    const CAddress new2{ResolveService(\"6.6.6.6\"), NODE_NONE};\n+    const CAddress tried1{ResolveService(\"7.7.7.7\"), NODE_NONE};\n+    const CAddress tried2{ResolveService(\"8.8.8.8\"), NODE_NONE};\n+\n+    addrman.Add({new1, tried1, new2, tried2}, CNetAddr{});\n+    addrman.Good(tried1);\n+    addrman.Good(tried2);\n+    BOOST_REQUIRE_EQUAL(addrman.size(), 4);\n+\n+    stream << addrman;\n+\n+    const std::string str{stream.str()};\n+    size_t pos;\n+\n+    const char new2_raw[]{6, 6, 6, 6};\n+    const uint8_t new2_raw_replacement[]{0, 0, 0, 0}; // 0.0.0.0 is !IsValid()\n+    pos = str.find(new2_raw, 0, sizeof(new2_raw));\n+    BOOST_REQUIRE(pos != std::string::npos);\n+    BOOST_REQUIRE(pos + sizeof(new2_raw_replacement) <= stream.size());\n+    memcpy(stream.data() + pos, new2_raw_replacement, sizeof(new2_raw_replacement));\n+\n+    const char tried2_raw[]{8, 8, 8, 8};\n+    const uint8_t tried2_raw_replacement[]{255, 255, 255, 255}; // 255.255.255.255 is !IsValid()\n+    pos = str.find(tried2_raw, 0, sizeof(tried2_raw));\n+    BOOST_REQUIRE(pos != std::string::npos);\n+    BOOST_REQUIRE(pos + sizeof(tried2_raw_replacement) <= stream.size());\n+    memcpy(stream.data() + pos, tried2_raw_replacement, sizeof(tried2_raw_replacement));\n+\n+    addrman.Clear();\n+    stream >> addrman;\n+    BOOST_CHECK_EQUAL(addrman.size(), 2);\n+}\n \n BOOST_AUTO_TEST_CASE(addrman_selecttriedcollision)\n {"
      }
    ]
  }
]