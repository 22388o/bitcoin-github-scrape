[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748203792",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#issuecomment-748203792",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20715",
    "id": 748203792,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0ODIwMzc5Mg==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-18T16:57:11Z",
    "updated_at": "2021-02-02T10:17:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #21052 (refactor: Replace fs::unique_path with GetUniquePath(path) calls by kiminuo)\n* #19460 (multiprocess: Add bitcoin-wallet -ipcconnect option by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748203792/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748448430",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#issuecomment-748448430",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20715",
    "id": 748448430,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc0ODQ0ODQzMA==",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?u=5ff13e375b40ea55ecd3c108337dd6a23f68eddf&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-12-19T09:30:27Z",
    "updated_at": "2020-12-19T09:30:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "Concept ACK",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/748448430/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/759396625",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#issuecomment-759396625",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20715",
    "id": 759396625,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1OTM5NjYyNQ==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-13T11:46:31Z",
    "updated_at": "2021-01-13T11:46:31Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--4a62be1de6b64f3ed646cdc7932c8cf5-->\n\ud83d\udd75\ufe0f @jonatack has been requested to review this pull request as specified in the REVIEWERS file.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/759396625/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/763586853",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#issuecomment-763586853",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20715",
    "id": 763586853,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MzU4Njg1Mw==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-20T12:53:31Z",
    "updated_at": "2021-01-20T12:53:31Z",
    "author_association": "MEMBER",
    "body": "Concept ACK",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/763586853/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/773039739",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#issuecomment-773039739",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20715",
    "id": 773039739,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3MzAzOTczOQ==",
    "user": {
      "login": "ajtowns",
      "id": 127186,
      "node_id": "MDQ6VXNlcjEyNzE4Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajtowns",
      "html_url": "https://github.com/ajtowns",
      "followers_url": "https://api.github.com/users/ajtowns/followers",
      "following_url": "https://api.github.com/users/ajtowns/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajtowns/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
      "organizations_url": "https://api.github.com/users/ajtowns/orgs",
      "repos_url": "https://api.github.com/users/ajtowns/repos",
      "events_url": "https://api.github.com/users/ajtowns/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajtowns/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-04T05:27:04Z",
    "updated_at": "2021-02-04T05:27:04Z",
    "author_association": "CONTRIBUTOR",
    "body": "ACK fa61b9d1a68820758f9540653920deaeae6abe79\r\n\r\nLooks good to me, though the third commit has a typo in the description: \"dependend\". Updated https://github.com/ajtowns/bitcoin/commits/202101-util-addcmd ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/773039739/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/773118858",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#issuecomment-773118858",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20715",
    "id": 773118858,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3MzExODg1OA==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-04T08:13:56Z",
    "updated_at": "2021-02-04T08:13:56Z",
    "author_association": "MEMBER",
    "body": "> third commit has a typo in the description: \"dependend\".\r\n\r\nGood catch. Though, I'll leave this as-is to minimize the re-review backlog.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/773118858/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/555515823",
    "pull_request_review_id": 565941201,
    "id": 555515823,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTUxNTgyMw==",
    "diff_hunk": "@@ -518,6 +533,11 @@ void ArgsManager::AddArg(const std::string& name, const std::string& help, unsig\n     auto ret = arg_map.emplace(arg_name, Arg{name.substr(eq_index, name.size() - eq_index), help, flags});\n     assert(ret.second); // Make sure an insertion actually happened\n \n+    if (flags & ArgsManager::COMMAND) {\n+        Assert(flags == ArgsManager::COMMAND); // Combination not allowed\n+        Assert(name.find('=') == std::string::npos);\n+        Assert(name.find('-') == std::string::npos);",
    "path": "src/util/system.cpp",
    "position": null,
    "original_position": 65,
    "commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "original_commit_id": "faaf1b26c1abf768a3b36c0fb8c5ba814b6f24c1",
    "user": {
      "login": "ajtowns",
      "id": 127186,
      "node_id": "MDQ6VXNlcjEyNzE4Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajtowns",
      "html_url": "https://github.com/ajtowns",
      "followers_url": "https://api.github.com/users/ajtowns/followers",
      "following_url": "https://api.github.com/users/ajtowns/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajtowns/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
      "organizations_url": "https://api.github.com/users/ajtowns/orgs",
      "repos_url": "https://api.github.com/users/ajtowns/repos",
      "events_url": "https://api.github.com/users/ajtowns/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajtowns/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Why ban a dash anywhere in the command, rather than just at the start?",
    "created_at": "2021-01-12T05:04:40Z",
    "updated_at": "2021-01-21T18:31:55Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r555515823",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/555515823"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r555515823"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/555515823/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 539,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/555571079",
    "pull_request_review_id": 565941201,
    "id": 555571079,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTU3MTA3OQ==",
    "diff_hunk": "@@ -310,8 +311,16 @@ bool ArgsManager::ParseParameters(int argc, const char* const argv[], std::strin\n             key[0] = '-';\n #endif\n \n-        if (key[0] != '-')\n-            break;\n+        if (key[0] != '-') {\n+            if (accept_any_command) break;\n+            Optional<unsigned int> flags = GetArgFlags(key);\n+            if (!flags || !(*flags & ArgsManager::COMMAND)) {\n+                error = strprintf(\"Invalid command '%s'\", argv[i]);\n+                return false;\n+            }\n+            m_commands.push_back(key);\n+            continue;",
    "path": "src/util/system.cpp",
    "position": null,
    "original_position": 40,
    "commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "original_commit_id": "faaf1b26c1abf768a3b36c0fb8c5ba814b6f24c1",
    "user": {
      "login": "ajtowns",
      "id": 127186,
      "node_id": "MDQ6VXNlcjEyNzE4Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajtowns",
      "html_url": "https://github.com/ajtowns",
      "followers_url": "https://api.github.com/users/ajtowns/followers",
      "following_url": "https://api.github.com/users/ajtowns/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajtowns/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
      "organizations_url": "https://api.github.com/users/ajtowns/orgs",
      "repos_url": "https://api.github.com/users/ajtowns/repos",
      "events_url": "https://api.github.com/users/ajtowns/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajtowns/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I'm not sure multiple (sub)commands makes sense for us. At present, I think we have:\r\n\r\n * bitcoind - doesn't take subcommands\r\n * bitcoin-wallet - wants a single subcommand\r\n * bitcoin-tx - wants multiple instructions with parameters\r\n * bitcoin-cli - wants to do its own parsing of stuff after the options\r\n * bitcoin-qt - does its own parsing of stuff after the options for payment server support\r\n \r\nFor bitcoin-util, I think we want it to be more like bitcoin-wallet, and if we were to do a psbt version of bitcoin-tx's multiple commands in order to construct a psbt, I think that would look like `bitcoin-util psbt <subsubcmd> <subsubcmd> ..`.\r\n\r\nSo I don't think it makes much sense to support multiple subcommands, particularly without letting them have their own params. Which I think means you could have a nicer implementation with something like https://github.com/ajtowns/bitcoin/commits/202101-getcommand which lets you just say `AddCmd(...)` to start introducing new commands, don't have to explicitly set `accept_any_command` when parsing, and can just invoke `GetCommand()` and `GetArguments()` to get the pre-parsed results. Thoughts?\r\n\r\nI've added a second commit on that branch that allows the ArgsManager options to come after the command, which is the same as this PR, but differs from current master (which leaves later options up to the command -- so bitcoin-cli treats them as rpc args, while bitcoin-wallet currently just silently ignores them).",
    "created_at": "2021-01-12T07:50:34Z",
    "updated_at": "2021-01-21T18:31:55Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r555571079",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/555571079"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r555571079"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/555571079/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 322,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/555574662",
    "pull_request_review_id": 565941201,
    "id": 555574662,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTU3NDY2Mg==",
    "diff_hunk": "@@ -33,59 +33,60 @@ static void SetupWalletToolArgs(ArgsManager& argsman)\n     argsman.AddArg(\"-format=<format>\", \"The format of the wallet file to create. Either \\\"bdb\\\" or \\\"sqlite\\\". Only used with 'createfromdump'\", ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n     argsman.AddArg(\"-printtoconsole\", \"Send trace/debug info to console (default: 1 when no -debug is true, 0 otherwise).\", ArgsManager::ALLOW_ANY, OptionsCategory::DEBUG_TEST);\n \n-    argsman.AddArg(\"info\", \"Get wallet info\", ArgsManager::ALLOW_ANY, OptionsCategory::COMMANDS);\n-    argsman.AddArg(\"create\", \"Create new wallet file\", ArgsManager::ALLOW_ANY, OptionsCategory::COMMANDS);\n-    argsman.AddArg(\"salvage\", \"Attempt to recover private keys from a corrupt wallet. Warning: 'salvage' is experimental.\", ArgsManager::ALLOW_ANY, OptionsCategory::COMMANDS);\n-    argsman.AddArg(\"dump\", \"Print out all of the wallet key-value records\", ArgsManager::ALLOW_ANY, OptionsCategory::COMMANDS);\n-    argsman.AddArg(\"createfromdump\", \"Create new wallet file from dumped records\", ArgsManager::ALLOW_ANY, OptionsCategory::COMMANDS);\n+    argsman.AddArg(\"info\", \"Get wallet info\", ArgsManager::COMMAND, OptionsCategory::COMMANDS);\n+    argsman.AddArg(\"create\", \"Create new wallet file\", ArgsManager::COMMAND, OptionsCategory::COMMANDS);\n+    argsman.AddArg(\"salvage\", \"Attempt to recover private keys from a corrupt wallet. Warning: 'salvage' is experimental.\", ArgsManager::COMMAND, OptionsCategory::COMMANDS);\n+    argsman.AddArg(\"dump\", \"Print out all of the wallet key-value records\", ArgsManager::COMMAND, OptionsCategory::COMMANDS);\n+    argsman.AddArg(\"createfromdump\", \"Create new wallet file from dumped records\", ArgsManager::COMMAND, OptionsCategory::COMMANDS);",
    "path": "src/bitcoin-wallet.cpp",
    "position": null,
    "original_position": 13,
    "commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "original_commit_id": "faaf1b26c1abf768a3b36c0fb8c5ba814b6f24c1",
    "user": {
      "login": "ajtowns",
      "id": 127186,
      "node_id": "MDQ6VXNlcjEyNzE4Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajtowns",
      "html_url": "https://github.com/ajtowns",
      "followers_url": "https://api.github.com/users/ajtowns/followers",
      "following_url": "https://api.github.com/users/ajtowns/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajtowns/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
      "organizations_url": "https://api.github.com/users/ajtowns/orgs",
      "repos_url": "https://api.github.com/users/ajtowns/repos",
      "events_url": "https://api.github.com/users/ajtowns/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajtowns/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think this would be a lot better if we could link options to commands (so `-format` could be tied to `createfromdump` directly rather than having it hidden in the help text and having a special cased if statement). Some options would need to be available for multiple (but not all) commands (`-dumpfile` for `dump` and `createfromdump` eg).\r\n\r\nThis seems like a bit more of an intrusive change to make, and probably doesn't have to be done immediately though.\r\n",
    "created_at": "2021-01-12T07:57:48Z",
    "updated_at": "2021-01-21T18:31:55Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r555574662",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/555574662"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r555574662"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/555574662/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 40,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/555582290",
    "pull_request_review_id": 566023116,
    "id": 555582290,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTU4MjI5MA==",
    "diff_hunk": "@@ -33,59 +33,60 @@ static void SetupWalletToolArgs(ArgsManager& argsman)\n     argsman.AddArg(\"-format=<format>\", \"The format of the wallet file to create. Either \\\"bdb\\\" or \\\"sqlite\\\". Only used with 'createfromdump'\", ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n     argsman.AddArg(\"-printtoconsole\", \"Send trace/debug info to console (default: 1 when no -debug is true, 0 otherwise).\", ArgsManager::ALLOW_ANY, OptionsCategory::DEBUG_TEST);\n \n-    argsman.AddArg(\"info\", \"Get wallet info\", ArgsManager::ALLOW_ANY, OptionsCategory::COMMANDS);\n-    argsman.AddArg(\"create\", \"Create new wallet file\", ArgsManager::ALLOW_ANY, OptionsCategory::COMMANDS);\n-    argsman.AddArg(\"salvage\", \"Attempt to recover private keys from a corrupt wallet. Warning: 'salvage' is experimental.\", ArgsManager::ALLOW_ANY, OptionsCategory::COMMANDS);\n-    argsman.AddArg(\"dump\", \"Print out all of the wallet key-value records\", ArgsManager::ALLOW_ANY, OptionsCategory::COMMANDS);\n-    argsman.AddArg(\"createfromdump\", \"Create new wallet file from dumped records\", ArgsManager::ALLOW_ANY, OptionsCategory::COMMANDS);\n+    argsman.AddArg(\"info\", \"Get wallet info\", ArgsManager::COMMAND, OptionsCategory::COMMANDS);\n+    argsman.AddArg(\"create\", \"Create new wallet file\", ArgsManager::COMMAND, OptionsCategory::COMMANDS);\n+    argsman.AddArg(\"salvage\", \"Attempt to recover private keys from a corrupt wallet. Warning: 'salvage' is experimental.\", ArgsManager::COMMAND, OptionsCategory::COMMANDS);\n+    argsman.AddArg(\"dump\", \"Print out all of the wallet key-value records\", ArgsManager::COMMAND, OptionsCategory::COMMANDS);\n+    argsman.AddArg(\"createfromdump\", \"Create new wallet file from dumped records\", ArgsManager::COMMAND, OptionsCategory::COMMANDS);",
    "path": "src/bitcoin-wallet.cpp",
    "position": null,
    "original_position": 13,
    "commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "original_commit_id": "faaf1b26c1abf768a3b36c0fb8c5ba814b6f24c1",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> This seems like a bit more of an intrusive change to make, and probably doesn't have to be done immediately though.\r\n\r\nIndeed. Will leave this for a follow-up. This should be a minimal bugfix/feature commit.",
    "created_at": "2021-01-12T08:13:50Z",
    "updated_at": "2021-01-21T18:31:55Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r555582290",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/555582290"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r555582290"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/555582290/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 40,
    "side": "RIGHT",
    "in_reply_to_id": 555574662
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/556369068",
    "pull_request_review_id": 567022546,
    "id": 556369068,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NjM2OTA2OA==",
    "diff_hunk": "@@ -518,6 +533,11 @@ void ArgsManager::AddArg(const std::string& name, const std::string& help, unsig\n     auto ret = arg_map.emplace(arg_name, Arg{name.substr(eq_index, name.size() - eq_index), help, flags});\n     assert(ret.second); // Make sure an insertion actually happened\n \n+    if (flags & ArgsManager::COMMAND) {\n+        Assert(flags == ArgsManager::COMMAND); // Combination not allowed\n+        Assert(name.find('=') == std::string::npos);\n+        Assert(name.find('-') == std::string::npos);",
    "path": "src/util/system.cpp",
    "position": null,
    "original_position": 65,
    "commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "original_commit_id": "faaf1b26c1abf768a3b36c0fb8c5ba814b6f24c1",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Thanks, fixed",
    "created_at": "2021-01-13T09:14:16Z",
    "updated_at": "2021-01-21T18:31:55Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r556369068",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/556369068"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r556369068"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/556369068/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 539,
    "side": "RIGHT",
    "in_reply_to_id": 555515823
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/556369445",
    "pull_request_review_id": 567023069,
    "id": 556369445,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NjM2OTQ0NQ==",
    "diff_hunk": "@@ -310,8 +311,16 @@ bool ArgsManager::ParseParameters(int argc, const char* const argv[], std::strin\n             key[0] = '-';\n #endif\n \n-        if (key[0] != '-')\n-            break;\n+        if (key[0] != '-') {\n+            if (accept_any_command) break;\n+            Optional<unsigned int> flags = GetArgFlags(key);\n+            if (!flags || !(*flags & ArgsManager::COMMAND)) {\n+                error = strprintf(\"Invalid command '%s'\", argv[i]);\n+                return false;\n+            }\n+            m_commands.push_back(key);\n+            continue;",
    "path": "src/util/system.cpp",
    "position": null,
    "original_position": 40,
    "commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "original_commit_id": "faaf1b26c1abf768a3b36c0fb8c5ba814b6f24c1",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Thanks, took most of your changes",
    "created_at": "2021-01-13T09:14:52Z",
    "updated_at": "2021-01-21T18:31:55Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r556369445",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/556369445"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r556369445"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/556369445/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 322,
    "side": "RIGHT",
    "in_reply_to_id": 555571079
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557883567",
    "pull_request_review_id": 568878130,
    "id": 557883567,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1Nzg4MzU2Nw==",
    "diff_hunk": "@@ -359,6 +374,19 @@ Optional<unsigned int> ArgsManager::GetArgFlags(const std::string& name) const\n     return nullopt;\n }\n \n+bool ArgsManager::GetCommand(std::string& cmd, std::vector<std::string>& args) const",
    "path": "src/util/system.cpp",
    "position": null,
    "original_position": 45,
    "commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "original_commit_id": "fad369f04361e2e3a834589b63fab160b9b4e1b2",
    "user": {
      "login": "ajtowns",
      "id": 127186,
      "node_id": "MDQ6VXNlcjEyNzE4Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajtowns",
      "html_url": "https://github.com/ajtowns",
      "followers_url": "https://api.github.com/users/ajtowns/followers",
      "following_url": "https://api.github.com/users/ajtowns/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajtowns/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
      "organizations_url": "https://api.github.com/users/ajtowns/orgs",
      "repos_url": "https://api.github.com/users/ajtowns/repos",
      "events_url": "https://api.github.com/users/ajtowns/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajtowns/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Might be good to call it `AddCommand` and `GetCommand` for consistency?",
    "created_at": "2021-01-15T06:11:15Z",
    "updated_at": "2021-01-21T18:31:55Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r557883567",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557883567"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r557883567"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557883567/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 377,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557884197",
    "pull_request_review_id": 568878130,
    "id": 557884197,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1Nzg4NDE5Nw==",
    "diff_hunk": "@@ -359,6 +374,19 @@ Optional<unsigned int> ArgsManager::GetArgFlags(const std::string& name) const\n     return nullopt;\n }\n \n+bool ArgsManager::GetCommand(std::string& cmd, std::vector<std::string>& args) const\n+{\n+    LOCK(cs_args);\n+    assert(!m_accept_any_command); // AddCmd must have been called before this",
    "path": "src/util/system.cpp",
    "position": null,
    "original_position": 48,
    "commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "original_commit_id": "fad369f04361e2e3a834589b63fab160b9b4e1b2",
    "user": {
      "login": "ajtowns",
      "id": 127186,
      "node_id": "MDQ6VXNlcjEyNzE4Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajtowns",
      "html_url": "https://github.com/ajtowns",
      "followers_url": "https://api.github.com/users/ajtowns/followers",
      "following_url": "https://api.github.com/users/ajtowns/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajtowns/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
      "organizations_url": "https://api.github.com/users/ajtowns/orgs",
      "repos_url": "https://api.github.com/users/ajtowns/repos",
      "events_url": "https://api.github.com/users/ajtowns/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajtowns/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I wonder if it wouldn't be better to always copy the remaining args into `m_command` and have the only difference be that you get an \"unknown command\" when `m_accept_any_command` is set",
    "created_at": "2021-01-15T06:12:09Z",
    "updated_at": "2021-01-21T18:31:55Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r557884197",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557884197"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r557884197"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557884197/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 380,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557886983",
    "pull_request_review_id": 568878130,
    "id": 557886983,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1Nzg4Njk4Mw==",
    "diff_hunk": "@@ -94,33 +95,28 @@ int main(int argc, char* argv[])\n         return EXIT_FAILURE;\n     }\n \n-    std::string method {};\n-    for(int i = 1; i < argc; ++i) {\n-        if (!IsSwitchChar(argv[i][0])) {\n-            if (!method.empty()) {\n-                tfm::format(std::cerr, \"Error: two methods provided (%s and %s). Only one method should be provided.\\n\", method, argv[i]);\n-                return EXIT_FAILURE;\n-            }\n-            method = argv[i];\n-        }\n-    }\n-\n-    if (method.empty()) {\n+    std::string method;\n+    std::vector<std::string> cmdargs;\n+    if (!args.GetCommand(method, cmdargs)) {",
    "path": "src/bitcoin-wallet.cpp",
    "position": null,
    "original_position": 101,
    "commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "original_commit_id": "fad369f04361e2e3a834589b63fab160b9b4e1b2",
    "user": {
      "login": "ajtowns",
      "id": 127186,
      "node_id": "MDQ6VXNlcjEyNzE4Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajtowns",
      "html_url": "https://github.com/ajtowns",
      "followers_url": "https://api.github.com/users/ajtowns/followers",
      "following_url": "https://api.github.com/users/ajtowns/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajtowns/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
      "organizations_url": "https://api.github.com/users/ajtowns/orgs",
      "repos_url": "https://api.github.com/users/ajtowns/repos",
      "events_url": "https://api.github.com/users/ajtowns/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajtowns/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This feels a bit messy; when trying this for bitcoin-util, I added a `struct CmdArg { string cmd; vector<string> args; };` to track them both.",
    "created_at": "2021-01-15T06:15:48Z",
    "updated_at": "2021-01-21T18:31:55Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r557886983",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557886983"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r557886983"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557886983/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 100,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559034972",
    "pull_request_review_id": 569964967,
    "id": 559034972,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1OTAzNDk3Mg==",
    "diff_hunk": "@@ -95,21 +95,16 @@ int main(int argc, char* argv[])\n         return EXIT_FAILURE;\n     }\n \n-    std::string method {};\n-    for(int i = 1; i < argc; ++i) {\n-        if (!IsSwitchChar(argv[i][0])) {\n-            if (!method.empty()) {\n-                tfm::format(std::cerr, \"Error: two methods provided (%s and %s). Only one method should be provided.\\n\", method, argv[i]);\n-                return EXIT_FAILURE;\n-            }\n-            method = argv[i];\n-        }\n-    }\n-\n-    if (method.empty()) {\n+    std::string method;\n+    std::vector<std::string> cmdargs;\n+    if (!args.GetCommand(method, cmdargs)) {\n         tfm::format(std::cerr, \"No method provided. Run `bitcoin-wallet -help` for valid methods.\\n\");\n         return EXIT_FAILURE;\n     }\n+    if (cmdargs.size() != 0) {\n+        tfm::format(std::cerr, \"Error: Additional arguments provided (%s). Please refer to `-help`. Commands do not take arguments.\\n\", Join(cmdargs, \", \"));",
    "path": "src/bitcoin-wallet.cpp",
    "position": null,
    "original_position": 40,
    "commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "original_commit_id": "fad369f04361e2e3a834589b63fab160b9b4e1b2",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: I would slightly prefer it this way around:\r\n```\r\ntfm::format(std::cerr, \"Error: Additional arguments provided (%s). Commands do not take arguments. Please refer to `-help`. \\n\", Join(cmdargs, \", \"));\r\n```",
    "created_at": "2021-01-16T20:20:43Z",
    "updated_at": "2021-01-21T18:31:55Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r559034972",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559034972"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r559034972"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559034972/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 105,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559035239",
    "pull_request_review_id": 569964967,
    "id": 559035239,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1OTAzNTIzOQ==",
    "diff_hunk": "@@ -95,21 +95,16 @@ int main(int argc, char* argv[])\n         return EXIT_FAILURE;\n     }\n \n-    std::string method {};\n-    for(int i = 1; i < argc; ++i) {\n-        if (!IsSwitchChar(argv[i][0])) {\n-            if (!method.empty()) {\n-                tfm::format(std::cerr, \"Error: two methods provided (%s and %s). Only one method should be provided.\\n\", method, argv[i]);\n-                return EXIT_FAILURE;\n-            }\n-            method = argv[i];\n-        }\n-    }\n-\n-    if (method.empty()) {\n+    std::string method;",
    "path": "src/bitcoin-wallet.cpp",
    "position": null,
    "original_position": 33,
    "commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "original_commit_id": "fad369f04361e2e3a834589b63fab160b9b4e1b2",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: Rename to `command`?",
    "created_at": "2021-01-16T20:21:33Z",
    "updated_at": "2021-01-21T18:31:55Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r559035239",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559035239"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r559035239"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559035239/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 98,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559035644",
    "pull_request_review_id": 569964967,
    "id": 559035644,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1OTAzNTY0NA==",
    "diff_hunk": "@@ -95,21 +95,16 @@ int main(int argc, char* argv[])\n         return EXIT_FAILURE;\n     }\n \n-    std::string method {};\n-    for(int i = 1; i < argc; ++i) {\n-        if (!IsSwitchChar(argv[i][0])) {\n-            if (!method.empty()) {\n-                tfm::format(std::cerr, \"Error: two methods provided (%s and %s). Only one method should be provided.\\n\", method, argv[i]);\n-                return EXIT_FAILURE;\n-            }\n-            method = argv[i];\n-        }\n-    }\n-\n-    if (method.empty()) {\n+    std::string method;\n+    std::vector<std::string> cmdargs;\n+    if (!args.GetCommand(method, cmdargs)) {\n         tfm::format(std::cerr, \"No method provided. Run `bitcoin-wallet -help` for valid methods.\\n\");",
    "path": "src/bitcoin-wallet.cpp",
    "position": 101,
    "original_position": 36,
    "commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "original_commit_id": "fad369f04361e2e3a834589b63fab160b9b4e1b2",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "maybe also rename \"method\" to \"command\" here? ",
    "created_at": "2021-01-16T20:22:47Z",
    "updated_at": "2021-01-21T18:31:55Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r559035644",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559035644"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r559035644"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/559035644/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 100,
    "original_line": 100,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/561859423",
    "pull_request_review_id": 573300797,
    "id": 561859423,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTg1OTQyMw==",
    "diff_hunk": "@@ -359,6 +374,19 @@ Optional<unsigned int> ArgsManager::GetArgFlags(const std::string& name) const\n     return nullopt;\n }\n \n+bool ArgsManager::GetCommand(std::string& cmd, std::vector<std::string>& args) const",
    "path": "src/util/system.cpp",
    "position": null,
    "original_position": 45,
    "commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "original_commit_id": "fad369f04361e2e3a834589b63fab160b9b4e1b2",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I took the naming from https://github.com/ajtowns/bitcoin/commit/ff48eb93bd485fb5e722d47690508f2a3506d30c. Nonetheless, changed in the latest force push.",
    "created_at": "2021-01-21T12:57:33Z",
    "updated_at": "2021-01-21T18:31:56Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r561859423",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/561859423"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r561859423"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/561859423/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 377,
    "side": "RIGHT",
    "in_reply_to_id": 557883567
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/561859610",
    "pull_request_review_id": 573300980,
    "id": 561859610,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTg1OTYxMA==",
    "diff_hunk": "@@ -359,6 +374,19 @@ Optional<unsigned int> ArgsManager::GetArgFlags(const std::string& name) const\n     return nullopt;\n }\n \n+bool ArgsManager::GetCommand(std::string& cmd, std::vector<std::string>& args) const\n+{\n+    LOCK(cs_args);\n+    assert(!m_accept_any_command); // AddCmd must have been called before this",
    "path": "src/util/system.cpp",
    "position": null,
    "original_position": 48,
    "commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "original_commit_id": "fad369f04361e2e3a834589b63fab160b9b4e1b2",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Thanks. Fixed, I think",
    "created_at": "2021-01-21T12:57:46Z",
    "updated_at": "2021-01-21T18:31:56Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r561859610",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/561859610"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r561859610"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/561859610/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 380,
    "side": "RIGHT",
    "in_reply_to_id": 557884197
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/561859772",
    "pull_request_review_id": 573301123,
    "id": 561859772,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTg1OTc3Mg==",
    "diff_hunk": "@@ -94,33 +95,28 @@ int main(int argc, char* argv[])\n         return EXIT_FAILURE;\n     }\n \n-    std::string method {};\n-    for(int i = 1; i < argc; ++i) {\n-        if (!IsSwitchChar(argv[i][0])) {\n-            if (!method.empty()) {\n-                tfm::format(std::cerr, \"Error: two methods provided (%s and %s). Only one method should be provided.\\n\", method, argv[i]);\n-                return EXIT_FAILURE;\n-            }\n-            method = argv[i];\n-        }\n-    }\n-\n-    if (method.empty()) {\n+    std::string method;\n+    std::vector<std::string> cmdargs;\n+    if (!args.GetCommand(method, cmdargs)) {",
    "path": "src/bitcoin-wallet.cpp",
    "position": null,
    "original_position": 101,
    "commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "original_commit_id": "fad369f04361e2e3a834589b63fab160b9b4e1b2",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Thanks. Fixed, I think",
    "created_at": "2021-01-21T12:57:57Z",
    "updated_at": "2021-01-21T18:31:56Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r561859772",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/561859772"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r561859772"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/561859772/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 100,
    "side": "RIGHT",
    "in_reply_to_id": 557886983
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/561859916",
    "pull_request_review_id": 573301279,
    "id": 561859916,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTg1OTkxNg==",
    "diff_hunk": "@@ -95,21 +95,16 @@ int main(int argc, char* argv[])\n         return EXIT_FAILURE;\n     }\n \n-    std::string method {};\n-    for(int i = 1; i < argc; ++i) {\n-        if (!IsSwitchChar(argv[i][0])) {\n-            if (!method.empty()) {\n-                tfm::format(std::cerr, \"Error: two methods provided (%s and %s). Only one method should be provided.\\n\", method, argv[i]);\n-                return EXIT_FAILURE;\n-            }\n-            method = argv[i];\n-        }\n-    }\n-\n-    if (method.empty()) {\n+    std::string method;\n+    std::vector<std::string> cmdargs;\n+    if (!args.GetCommand(method, cmdargs)) {\n         tfm::format(std::cerr, \"No method provided. Run `bitcoin-wallet -help` for valid methods.\\n\");\n         return EXIT_FAILURE;\n     }\n+    if (cmdargs.size() != 0) {\n+        tfm::format(std::cerr, \"Error: Additional arguments provided (%s). Please refer to `-help`. Commands do not take arguments.\\n\", Join(cmdargs, \", \"));",
    "path": "src/bitcoin-wallet.cpp",
    "position": null,
    "original_position": 40,
    "commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "original_commit_id": "fad369f04361e2e3a834589b63fab160b9b4e1b2",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Thanks, fixed",
    "created_at": "2021-01-21T12:58:08Z",
    "updated_at": "2021-01-21T18:31:56Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r561859916",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/561859916"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r561859916"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/561859916/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 105,
    "side": "RIGHT",
    "in_reply_to_id": 559034972
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/561860250",
    "pull_request_review_id": 573301593,
    "id": 561860250,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTg2MDI1MA==",
    "diff_hunk": "@@ -95,21 +95,16 @@ int main(int argc, char* argv[])\n         return EXIT_FAILURE;\n     }\n \n-    std::string method {};\n-    for(int i = 1; i < argc; ++i) {\n-        if (!IsSwitchChar(argv[i][0])) {\n-            if (!method.empty()) {\n-                tfm::format(std::cerr, \"Error: two methods provided (%s and %s). Only one method should be provided.\\n\", method, argv[i]);\n-                return EXIT_FAILURE;\n-            }\n-            method = argv[i];\n-        }\n-    }\n-\n-    if (method.empty()) {\n+    std::string method;",
    "path": "src/bitcoin-wallet.cpp",
    "position": null,
    "original_position": 33,
    "commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "original_commit_id": "fad369f04361e2e3a834589b63fab160b9b4e1b2",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Thanks, fixed",
    "created_at": "2021-01-21T12:58:33Z",
    "updated_at": "2021-01-21T18:31:56Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r561860250",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/561860250"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r561860250"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/561860250/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 98,
    "side": "RIGHT",
    "in_reply_to_id": 559035239
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/561860449",
    "pull_request_review_id": 573301846,
    "id": 561860449,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MTg2MDQ0OQ==",
    "diff_hunk": "@@ -95,21 +95,16 @@ int main(int argc, char* argv[])\n         return EXIT_FAILURE;\n     }\n \n-    std::string method {};\n-    for(int i = 1; i < argc; ++i) {\n-        if (!IsSwitchChar(argv[i][0])) {\n-            if (!method.empty()) {\n-                tfm::format(std::cerr, \"Error: two methods provided (%s and %s). Only one method should be provided.\\n\", method, argv[i]);\n-                return EXIT_FAILURE;\n-            }\n-            method = argv[i];\n-        }\n-    }\n-\n-    if (method.empty()) {\n+    std::string method;\n+    std::vector<std::string> cmdargs;\n+    if (!args.GetCommand(method, cmdargs)) {\n         tfm::format(std::cerr, \"No method provided. Run `bitcoin-wallet -help` for valid methods.\\n\");",
    "path": "src/bitcoin-wallet.cpp",
    "position": 101,
    "original_position": 36,
    "commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "original_commit_id": "fad369f04361e2e3a834589b63fab160b9b4e1b2",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Seems unrelated, so I am going to leave as is for now to minimize the diff",
    "created_at": "2021-01-21T12:58:52Z",
    "updated_at": "2021-01-21T18:31:56Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r561860449",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/561860449"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r561860449"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/561860449/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 100,
    "original_line": 100,
    "side": "RIGHT",
    "in_reply_to_id": 559035644
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563212541",
    "pull_request_review_id": 574884010,
    "id": 563212541,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MzIxMjU0MQ==",
    "diff_hunk": "@@ -188,6 +188,8 @@ def test_invalid_tool_commands_and_args(self):\n         self.assert_raises_tool_error('Invalid command: help', 'help')\n         self.assert_raises_tool_error('Error: two methods provided (info and create). Only one method should be provided.', 'info', 'create')\n         self.assert_raises_tool_error('Error parsing command line arguments: Invalid parameter -foo', '-foo')\n+        self.assert_raises_tool_error('No method provided. Run `bitcoin-wallet -help` for valid methods.')",
    "path": "test/functional/tool_wallet.py",
    "position": 12,
    "original_position": 4,
    "commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "original_commit_id": "fa06bce4ac17f93decd4ee38c956e7aa55983f0d",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "in fa06bce4ac17f93decd4ee38c956e7aa55983f0d:\r\n\r\nnit: Commit message could have been a bit more descriptive ;)",
    "created_at": "2021-01-23T23:29:49Z",
    "updated_at": "2021-01-23T23:41:50Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r563212541",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563212541"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r563212541"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563212541/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 191,
    "original_line": 191,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563213370",
    "pull_request_review_id": 574884010,
    "id": 563213370,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MzIxMzM3MA==",
    "diff_hunk": "@@ -248,6 +251,20 @@ class ArgsManager\n      */\n     const std::list<SectionInfo> GetUnrecognizedSections() const;\n \n+    struct Command {",
    "path": "src/util/system.h",
    "position": 24,
    "original_position": 24,
    "commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "original_commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "in fa61b9d1a68820758f9540653920deaeae6abe79:\r\n\r\nnit: seeing this now I think I would have named it `CommandCall` or something similar to express that it's command + args. But feel free to ignore my name bikeshedding.",
    "created_at": "2021-01-23T23:38:52Z",
    "updated_at": "2021-01-23T23:41:50Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r563213370",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563213370"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r563213370"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563213370/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 254,
    "original_line": 254,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563255808",
    "pull_request_review_id": 574905864,
    "id": 563255808,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MzI1NTgwOA==",
    "diff_hunk": "@@ -248,6 +251,20 @@ class ArgsManager\n      */\n     const std::list<SectionInfo> GetUnrecognizedSections() const;\n \n+    struct Command {",
    "path": "src/util/system.h",
    "position": 24,
    "original_position": 24,
    "commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "original_commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r557886983 names it `CmdArg`. So I could call it `CommandArg` or `CommandArgs` (because there might be multiple args to the command). Not sure what to do here, but I think I'll leave this as is for now and let the naming committee determine a suitable name and let them change it after merge.",
    "created_at": "2021-01-24T08:16:00Z",
    "updated_at": "2021-01-24T08:16:01Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r563255808",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563255808"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r563255808"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563255808/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 254,
    "original_line": 254,
    "side": "RIGHT",
    "in_reply_to_id": 563213370
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563255841",
    "pull_request_review_id": 574905888,
    "id": 563255841,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MzI1NTg0MQ==",
    "diff_hunk": "@@ -188,6 +188,8 @@ def test_invalid_tool_commands_and_args(self):\n         self.assert_raises_tool_error('Invalid command: help', 'help')\n         self.assert_raises_tool_error('Error: two methods provided (info and create). Only one method should be provided.', 'info', 'create')\n         self.assert_raises_tool_error('Error parsing command line arguments: Invalid parameter -foo', '-foo')\n+        self.assert_raises_tool_error('No method provided. Run `bitcoin-wallet -help` for valid methods.')",
    "path": "test/functional/tool_wallet.py",
    "position": 12,
    "original_position": 4,
    "commit_id": "fa61b9d1a68820758f9540653920deaeae6abe79",
    "original_commit_id": "fa06bce4ac17f93decd4ee38c956e7aa55983f0d",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Thanks, will change on the next push",
    "created_at": "2021-01-24T08:16:23Z",
    "updated_at": "2021-01-24T08:16:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r563255841",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563255841"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20715#discussion_r563255841"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20715"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/563255841/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 191,
    "original_line": 191,
    "side": "RIGHT",
    "in_reply_to_id": 563212541
  }
]