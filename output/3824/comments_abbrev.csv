laanwj,2014-03-08T07:18:01Z,@jtimon You're creating a lot of minor pulls that depend on each other.\nSubmitting it as one pull grouping multiple git commits would make it easier to review and generates less clutter.\n,https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-37091373,37091373,
jtimon,2014-03-08T15:06:51Z,"@laanwj only this one is dependent on the others. The rest are valid independently, just related.\nWell, by depedent you may mean that since they change common files they need to be rebased on top of each other.\nI thought this would increase the chances each of them would have to be accepted.\nMy reasoning was more or less like ""if the commit at #3819 is not accepted for some reason, the other co",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-37099640,37099640,
laanwj,2014-03-08T15:54:23Z,"Well people's opinion may vary but I generally like 'one pull request solves one issue'. Too granular makes indeed it hard to merge (especially if they're 'change the world' commits), but too fine and everyone loses track of the larger view of what you're trying to do.\n\nThis may be just right, I just noticed a flood of pulls and thought I'd warn you :-)\n\nIt does make sense to split up GUI and ",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-37101188,37101188,
jtimon,2014-03-08T16:39:32Z,"Thanks again for the feedback, much appreciated.\nSo I guess the optimal approach would have been to request pulling the gui change first (#3823) and then the rest together warning that they're dependent on that one.\nI'll leave them as they are for now since, as said, I'm concerned about people having issues with one of them individually (and honestly, also due to laziness: I don't want to work m",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-37102362,37102362,
jtimon,2014-03-10T02:01:57Z,I've putted them all together except the GUI change.\nSo now this is only dependent on #3823 (The test won't pass until that's merged).\n,https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-37148023,37148023,
mikehearn,2014-03-10T18:13:51Z,"Does this actually make the code clearer, though?\n\nNow when checking the various places regtest mode was special cased, you can see that a special case exists but you have no idea without rummaging through chainparams.cpp (reading all of it) when it will actually happen.\n\nWas this change motivated by some other work or do you think it's just clearer this way?\n",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-37215096,37215096,
gavinandresen,2014-03-10T18:49:13Z,"I prefer the old code, NACK from me on this change.\n",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-37219343,37219343,
sipa,2014-03-10T19:01:11Z,"I really hate how we're assigning weird properties to regtest, and making them only accessible under IsRegTest(). Imho, these should just be separate command-line options or separate RPCs, instead of overloading their meaning for regtest.\n",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-37220742,37220742,
sipa,2014-03-10T19:02:08Z,"So to be clear: I consider this pullreq a step towards making special behaviour not hardcoded to regtest, but it's not enough.\n",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-37220853,37220853,
jtimon,2014-03-10T19:03:13Z,"The motivation is to make it easier to create new modes. Particularly, I plan to create a mode where proof of work is completely replaced by signatures of a ""centralized miner"". Other full nodes can connect and validate, but only whoever can provide a valid scriptSig can produce new blocks.\n\nAlso RegTest() global-like function feels a bit ugly to me, which brings me to some related questions I h",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-37220969,37220969,
sipa,2014-03-10T19:04:52Z,"Meh, all the same. I dislike explicit tests for particular modes. The high-level code should not need to know nor care about which mode is active. It should just care about its properties.\n",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-37221186,37221186,
sipa,2014-03-10T19:05:26Z,"Apart from the boost:hardware_concurrence call, ACK from me.\n",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-37221245,37221245,
mikehearn,2014-03-10T19:06:04Z,"Leaving aside the style issues for a moment - such a ""centralised miner"" mode seems pointless. You could just as well have a regular SQL database and dispose with the block chain algorithm entirely at that point?\n\nsipa: as I said, I feel like that's applying style theory over practice here. In practice, just testing properties of the mode simply makes the code harder to understand without improv",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-37221326,37221326,
sipa,2014-03-10T19:10:29Z,I think reading:\n\n  if (Params().MineBlocksOnDemand())\n    weird special-case code\n\nis just as obvious as\n\n  if (RegTest())\n    weird special-case code\n\nThough the question should really be: why is this behaviour specific to regtest at all?\n,https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-37221825,37221825,
mikehearn,2014-03-10T19:28:12Z,"The former simply repeats logic redundantly:\n\nif (Params().MineBlocksOnDemand()) {\n   // Mine some blocks, because the user demanded it.\n}\n\nThe conditional tells you nothing beyond ""this behaviour is network mode specific"" and requires you to go hunting in order to find out more. \n\nif (RegTest()) {\n   // Mine blocks on demand\n}\n\nis much more informative - it tells you when that code pa",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-37223669,37223669,
jtimon,2014-03-10T20:07:55Z,"How is any of this different from RequireRPCPassword() ?\n\nIt is true that the private chain is ""non-bitcoinish"" (related to off-chain transactions) and it's probably only useful with more changes that won't possibly get into bitcoin. I would just like to minimize the divergence from bitcoin's codebase. But still, this makes it easier to create more testing modes I honestly haven't thought about ",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-37227857,37227857,
jtimon,2014-03-10T22:48:52Z,"@mikehearn we can also change the comment to be non-redundant and avoid you to ""hunt on chainparams.cpp"" if that's the problem.\n\nif (Params().MineBlocksOnDemand()) {\n// Used on regtest mode\n}\nvs\nif (RegTest()) {\n// Mine blocks on demand\n}\n",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-37244478,37244478,
maaku,2014-03-11T21:38:23Z,I'm not sure how `RegTest()` is in any way descriptive of what what is going on unless you happen to already know that the bitcoin pull-tester uses a regression testing mode to mine blocks on demand. `Params().MineBlocksOnDemand()` clearly says what is being tested for.\n,https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-37352617,37352617,
laanwj,2014-03-12T07:31:35Z,As I understood it (and explained to @jtimon) the idea of ChainParams is to contain\n- properties of the chain itself and (like `genesis`)\n- environmental properties that define how bitcoind handles this chain (like `RequireRPCPassword`)\n\nEspecially the second set of properties could made data-driven (moved to a configuration file) to make it possible to define your own testing modes.\n\nUsing ,https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-37381961,37381961,
jtimon,2014-03-15T00:56:03Z,Updates:\n\n-Non-constant value for default threads removed as suggested by @sipa \n-References to regtest added/restored and redundancies removed on comments as suggested by @mikehearn \n-New methods documented in the interface as suggested by @laanwj \n,https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-37710955,37710955,
sipa,2014-03-15T01:26:48Z,ACK.\n\nEnough bikeshedding.\n,https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-37711787,37711787,
jtimon,2014-03-15T01:30:12Z,"Fixed typo ""doesn't requires"" -> ""doesn't require"" \n",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-37711883,37711883,
jtimon,2014-03-22T19:35:14Z,"Also stop using TestNet(), now Params.NetworkID() is only called from 3 places:\n\nhttps://github.com/bitcoin/bitcoin/blob/master/src/qt/bitcoin.cpp#L526\nhttps://github.com/bitcoin/bitcoin/blob/master/src/checkpoints.cpp#L86\nhttps://github.com/bitcoin/bitcoin/blob/master/src/util.cpp#L998\n\nI would say the latest changes complete the pull request which almost achieves the goal of chain modes ""q",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-38361782,38361782,
jtimon,2014-04-05T18:04:30Z,"Thanks @laanwj, corrected.\nAlso getmininginfo and getinfo will cointain ""testnet"": True for regtest, so this is a change in behavior but I think it's more appropriate (as regtest is also for testing). Ultimately I would add a new field ""network"" or ""mode"" to replace ""testnet"", although it may be still needed for backwards compatibility.\nIf people believe it should return False for regtest I can ",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-39645948,39645948,
laanwj,2014-04-07T06:04:53Z,"~~I'm all in favor of adding a 'network' ID to 'getinfo' output. The GUI uses CChainParams::DataDir() to get a network identifier for display in the debug window (and replaces it with 'mainnet' if empty). But let's add method to CChainParams that returns a canonical network ID string, and use the in the GUI as well. In any case, that's something for another pull. ~~ (edit: this was added to `getne",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-39698559,39698559,
maaku,2014-04-07T14:57:45Z,"Although not as human friendly, the magic byte string serves this purpose.\nOn Apr 6, 2014 11:05 PM, ""Wladimir J. van der Laan"" <\nnotifications@github.com> wrote:\n\n> I'm all in favor of adding a 'network' ID to 'getinfo' output. The GUI\n> uses CChainParams::DataDir() to get a network identifier for display in the\n> debug window (and replaces it with 'mainnet' if empty). But let's add\n> metho",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-39740578,39740578,
jtimon,2014-05-21T11:18:57Z,"I'm confused. Why did this PR got closed?\nShould I rebase it on top of the latest changes?\nIs there anything else I can do to get it accepted?\nIs there any reason why these (in my opinion, pretty harmless) refactoring changes will never make it  into bitcoind?\n",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-43742189,43742189,
laanwj,2014-05-21T12:25:07Z,Huh?!?!\n\nI don't remember closing this. I must have misclicked. Sorry!\n,https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-43747331,43747331,
sipa,2014-06-01T11:27:56Z,Rebase please?\n,https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-44775339,44775339,
jtimon,2014-06-01T14:24:31Z,Rebased\n,https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-44778967,44778967,
sipa,2014-06-02T08:34:08Z,ACK\n,https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-44813188,44813188,
jtimon,2014-06-04T11:03:08Z,"Virtual methods removed. In the process chainparams.h had to include protocol.h and a constant (MESSAGE_START_SIZE) was moved to protocol.h to avoid including chainparams.h from there.\nOn net.h a line used map instead of std::map, which didn't previously fail because net.h included protocol.h which included chainparams.h\nThose problems are solved. Now chainparams.h is only included from .cpp fil",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-45077462,45077462,
jtimon,2014-06-04T11:28:10Z,"It works locally, I guess I need to rebase again?\n",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-45079407,45079407,
sipa,2014-06-04T11:38:25Z,"paymentserver.cpp:502: error: ""TestNet"" was not declared in this scope\n",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-45080160,45080160,
jtimon,2014-06-04T12:15:32Z,"This is the commit and line that breaks the PR: https://github.com/bitcoin/bitcoin/commit/bdc83e8f450456c9f547f1c4eab43571bac631c2#diff-7823229685ea2f6633c45d94ebab1aa9R502\n\nFeedback by @Diapolo welcomed.\nRight now it doesn't fail if the network in the details is ""regtest"".\nIf that is never expected, \n\n```\n    if ((details.network() == ""main"" && TestNet()) ||\n        (details.network() == ",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-45082887,45082887,
jtimon,2014-06-04T13:28:36Z,I created a mapping networkID -> Payment Protocol network name method as suggested by @wumpus on IRC instead of creating a new field in chainparams for that.\n,https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-45089933,45089933,
BitcoinPullTester,2014-06-04T14:10:10Z,"Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/f0a83fc256023f68cc046bd096de69f16ce9d394 for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/cu",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-45094989,45094989,
sipa,2014-06-08T23:09:16Z,ACK\n,https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-45451375,45451375,
laanwj,2014-06-09T08:24:11Z,ACK\n,https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-45470351,45470351,
ghost,2014-06-09T09:08:35Z,ACK\n,https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-45473134,45473134,
wumpus,2014-06-11T17:23:35Z,"@jtimon, please stop mixing irc and github. I'm not the guy you're talking to on irc.\n",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-45772334,45772334,
jtimon,2014-06-11T17:52:18Z,"I'm sorry, my mistake, I believe wumpus on irc is @laanwj here.\n",https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-45775971,45775971,
Michagogo,2014-06-11T19:04:00Z,@jtimon That's correct.\n,https://github.com/bitcoin/bitcoin/pull/3824#issuecomment-45785147,45785147,
sipa,2014-03-10T15:51:19Z,"I don't like chainparams accessing the OS, makes it an ugly dependency for people who want to use this module in other code. I prefer it to just contain constants.\n",https://github.com/bitcoin/bitcoin/pull/3824#discussion_r10435149,10435149,src/chainparams.cpp
laanwj,2014-04-04T07:50:50Z,Shouldn't `ToCkeck` be `ToCheck` ?\n,https://github.com/bitcoin/bitcoin/pull/3824#discussion_r11285546,11285546,src/chainparams.h
sipa,2014-06-02T08:30:01Z,"Not: maybe ""DefaultCheckMemPool"", as to not confuse people that this is the actual setting for checking the mempool or not?\n",https://github.com/bitcoin/bitcoin/pull/3824#discussion_r13274818,13274818,src/chainparams.h
sipa,2014-06-02T08:33:23Z,"Nit: for these simple booleans, don't use a virtual method, but a local field and an implementation in the base class that returns it. That means less indirection at runtime.\n",https://github.com/bitcoin/bitcoin/pull/3824#discussion_r13274914,13274914,src/chainparams.h
jtimon,2014-06-02T09:12:06Z,I was just copying the other booleans. Should I change only the newly introduced booleans or all of them?\n,https://github.com/bitcoin/bitcoin/pull/3824#discussion_r13275957,13275957,src/chainparams.h
laanwj,2014-06-02T09:19:39Z,"@jtimon I think it makes sense for all the simple values, not just for booleans.\n",https://github.com/bitcoin/bitcoin/pull/3824#discussion_r13276210,13276210,src/chainparams.h
jtimon,2014-06-02T09:38:34Z,"including networkID? The rest are all booleans I think. I was just being consistent with what was there, but I have no problem changing that and have them in variables just as the other types.\n\nBy the way, is there a reason why FixedSeeds is declared as pure virtual but then only defined for mainparams? \n",https://github.com/bitcoin/bitcoin/pull/3824#discussion_r13276711,13276711,src/chainparams.h
laanwj,2014-06-02T10:59:28Z,"Maybe I'm missing something, I don't see the reason why virtuals are used here at all. All the methods of CChainsParams and subclasses simply return [references to] properties of the object (no input arguments or state). They could be moved to the superclass, and the only difference between the classes would be the constructor. Then one wouldn't even need a subclass per network at all. They could ",https://github.com/bitcoin/bitcoin/pull/3824#discussion_r13279156,13279156,src/chainparams.h
sipa,2014-06-02T11:16:41Z,"Virtual methods really only make sense when there's methods that take arguments, and the computation depends on them. Until we have such cases (which perhaps wouldn't fit in the name ""parameters"" anymore), I think we can drop all the virtuals.\n",https://github.com/bitcoin/bitcoin/pull/3824#discussion_r13279635,13279635,src/chainparams.h
jtimon,2014-06-02T11:30:20Z,"With only constant values, maybe a reason the keep the subclasses is to use Inheriting constructors, but they're not being used. \nIf in the future there's methods with inputs that may behave differently on each class, so maybe we should maintain them just in case. Otherwise we could just have a factory that takes the network id as parameter and returns an instance, reusing the same parametrized c",https://github.com/bitcoin/bitcoin/pull/3824#discussion_r13279996,13279996,src/chainparams.h
sipa,2014-06-02T11:31:24Z,+1\n,https://github.com/bitcoin/bitcoin/pull/3824#discussion_r13280017,13280017,src/chainparams.h
jtimon,2014-06-02T11:50:35Z,Should the boolean variables start with b? Is there a style guide?\n,https://github.com/bitcoin/bitcoin/pull/3824#discussion_r13280427,13280427,src/chainparams.h
sipa,2014-06-02T11:55:13Z,"If you want to follow Satoshi's style (which a lot of the code does, even new code, but we don't really bother enforcing it anymore), boolean variables should start with an 'f' (from flag), and floating point ones with a 'd' (double).\n",https://github.com/bitcoin/bitcoin/pull/3824#discussion_r13280567,13280567,src/chainparams.h
laanwj,2014-06-02T12:34:56Z,"With a factory function you could even load the network settings from a json file. But agreed, no need to do so in this pull. Let's just get rid of the virtuals and get this merged.\n\nThere is a style guide in doc/coding.md. That said, it really needs expanding, it doesn't even mention how much to indent and when to use a new line after {} etc. And I think satoshi's style with type prefixes on va",https://github.com/bitcoin/bitcoin/pull/3824#discussion_r13281649,13281649,src/chainparams.h
jtimon,2014-06-02T13:30:50Z,"Ok, even if I don't specially like the type prefix convention I think I should follow it.\nRemoval of virtual methods it is.\n",https://github.com/bitcoin/bitcoin/pull/3824#discussion_r13283845,13283845,src/chainparams.h
Diapolo,2014-06-10T17:02:52Z,"@jtimon Are you sure this check is correct? Seems like a hack to use the 0 in `DefaultMinerThreads()` to query for regtest mode, no?\n",https://github.com/bitcoin/bitcoin/pull/3824#discussion_r13605690,13605690,src/miner.cpp
Diapolo,2014-06-10T17:06:06Z,"@jtimon Can you take a look a few lines below at `GenerateBitcoins(fGenerate, pwalletMain, 1);`. We use the supplied 1 as thread-number, so `Params().DefaultMinerThreads()` seems totally unused at all.\n",https://github.com/bitcoin/bitcoin/pull/3824#discussion_r13605866,13605866,src/rpcmining.cpp
jtimon,2014-06-11T10:56:08Z,"That's the point of this PR, not to have to check for regtest at all.\nRight now the default is 0 for main and testnet, and 1 for regtest. But now you can create a testnet2 or regtest2 which defaults at 5, for example.\n",https://github.com/bitcoin/bitcoin/pull/3824#discussion_r13643244,13643244,src/miner.cpp
sipa,2014-06-11T10:58:18Z,Perhaps the comment shouldn't explicitly refer to regtest anymore either :)\n,https://github.com/bitcoin/bitcoin/pull/3824#discussion_r13643312,13643312,src/miner.cpp
jtimon,2014-06-11T11:15:44Z,"It is functionally equivalent to what was previously doing, so if the check is unused it was unused before.\n\nRight now MineBlocksOnDemand set to true (only used by regtest), makes the number of threds default to 1, overwritting the defaultThreads variable (again, only regtest has a non-zero value here).\nSo this whole check in miner.cpp seems meaninless unless you're using miner.cpp without usin",https://github.com/bitcoin/bitcoin/pull/3824#discussion_r13643745,13643745,src/rpcmining.cpp
jtimon,2014-06-11T11:21:14Z,"@mikehearn suggested that is was clearer since otherwise you need to go to chainparams to know if it's regtest behaviour, that's why I restored the old comments or added comments referencing regtest or testnet in some places.\n",https://github.com/bitcoin/bitcoin/pull/3824#discussion_r13643893,13643893,src/miner.cpp
laanwj,2014-06-11T12:18:44Z,"In principle a boolean 'MineWithMultipleThreads' would have been good enough here, as I don't see a realistic reason why a network would want '5 mining threads!'. Then again, that seems like bikeshed painting, this is fine.\n",https://github.com/bitcoin/bitcoin/pull/3824#discussion_r13645622,13645622,src/miner.cpp
Diapolo,2014-06-11T12:50:45Z,I think it's too much logic for too litle that comes out here...\n,https://github.com/bitcoin/bitcoin/pull/3824#discussion_r13646637,13646637,src/rpcmining.cpp
jtimon,2014-06-11T13:37:56Z,"yes, since it's only regtest what uses 1 as default, a boolean would have served as well. an int seemed more generic, but it is true that the chances of it being used at all are almost null.\n",https://github.com/bitcoin/bitcoin/pull/3824#discussion_r13648739,13648739,src/miner.cpp
jtimon,2014-06-11T13:38:11Z,"I agree that this can probably be simplified and maybe some of the parameters I have created can be eliminated some time in the future, but I didn't want to alter the behaviour in this PR, just refactor. Now that the different special cases don't depend on testnet or regtest, it should be easier to think about them and simplify the code around the usage of the parameters.\n",https://github.com/bitcoin/bitcoin/pull/3824#discussion_r13648753,13648753,src/rpcmining.cpp
