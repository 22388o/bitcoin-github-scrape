[
  {
    "sha": "4d17a1b0c29e8fd8510c75db1efb203b9b4f9eb0",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0ZDE3YTFiMGMyOWU4ZmQ4NTEwYzc1ZGIxZWZiMjAzYjliNGY5ZWIw",
    "commit": {
      "author": {
        "name": "Jonas Schnelli",
        "email": "jonasschnelli@Jonass-MacBook-Pro.local",
        "date": "2013-04-14T20:11:55Z"
      },
      "committer": {
        "name": "Jonas Schnelli",
        "email": "jonas.schnelli@include7.ch",
        "date": "2013-04-15T10:02:01Z"
      },
      "message": "fix: GUI Disappearing #1522 (Mac OSX)\n\n- this solution works stable on mac and ensures that the window get's reopened when the user clicks the dock icon .\n- tested on 10.8 with Qt4.8.4 and Qt5.0.1\n\nSigned-off-by: Jonas Schnelli <jonas.schnelli@include7.ch>",
      "tree": {
        "sha": "927cce25f832d04b6ff229d91c4da5bed63437c9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/927cce25f832d04b6ff229d91c4da5bed63437c9"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4d17a1b0c29e8fd8510c75db1efb203b9b4f9eb0",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4d17a1b0c29e8fd8510c75db1efb203b9b4f9eb0",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/4d17a1b0c29e8fd8510c75db1efb203b9b4f9eb0",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4d17a1b0c29e8fd8510c75db1efb203b9b4f9eb0/comments",
    "author": null,
    "committer": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "463a58ae75c817a1f81d439167d1ec9229263312",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/463a58ae75c817a1f81d439167d1ec9229263312",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/463a58ae75c817a1f81d439167d1ec9229263312"
      }
    ],
    "stats": {
      "total": 17,
      "additions": 15,
      "deletions": 2
    },
    "files": [
      {
        "sha": "f6ea945c79b21a39f40db1ef3a29afa873d70ad8",
        "filename": "src/qt/bitcoingui.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4d17a1b0c29e8fd8510c75db1efb203b9b4f9eb0/src/qt/bitcoingui.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4d17a1b0c29e8fd8510c75db1efb203b9b4f9eb0/src/qt/bitcoingui.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoingui.cpp?ref=4d17a1b0c29e8fd8510c75db1efb203b9b4f9eb0",
        "patch": "@@ -155,6 +155,7 @@ BitcoinGUI::~BitcoinGUI()\n         trayIcon->hide();\n #ifdef Q_OS_MAC\n     delete appMenuBar;\n+    MacDockIconHandler::instance()->setMainWindow(NULL);\n #endif\n }\n \n@@ -382,6 +383,7 @@ void BitcoinGUI::createTrayIconMenu()\n #else\n     // Note: On Mac, the dock icon is used to provide the tray's functionality.\n     MacDockIconHandler *dockIconHandler = MacDockIconHandler::instance();\n+    dockIconHandler->setMainWindow((QMainWindow *)this);\n     trayIconMenu = dockIconHandler->dockMenu();\n #endif\n "
      },
      {
        "sha": "765b0047507ecaac45a063ae9907363dc2062548",
        "filename": "src/qt/macdockiconhandler.h",
        "status": "modified",
        "additions": 3,
        "deletions": 1,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4d17a1b0c29e8fd8510c75db1efb203b9b4f9eb0/src/qt/macdockiconhandler.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4d17a1b0c29e8fd8510c75db1efb203b9b4f9eb0/src/qt/macdockiconhandler.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/macdockiconhandler.h?ref=4d17a1b0c29e8fd8510c75db1efb203b9b4f9eb0",
        "patch": "@@ -2,6 +2,7 @@\n #define MACDOCKICONHANDLER_H\n \n #include <QObject>\n+#include <QMainWindow>\n \n QT_BEGIN_NAMESPACE\n class QMenu;\n@@ -26,7 +27,7 @@ class MacDockIconHandler : public QObject\n \n     QMenu *dockMenu();\n     void setIcon(const QIcon &icon);\n-\n+    void setMainWindow(QMainWindow *window);\n     static MacDockIconHandler *instance();\n \n     void handleDockIconClickEvent();\n@@ -40,6 +41,7 @@ class MacDockIconHandler : public QObject\n     DockIconClickEventHandler *m_dockIconClickEventHandler;\n     QWidget *m_dummyWidget;\n     QMenu *m_dockMenu;\n+    QMainWindow *mainWindow;\n };\n \n #endif // MACDOCKICONCLICKHANDLER_H"
      },
      {
        "sha": "b6ea8e1d03dce4d1add2333e1feb9543f5b797d2",
        "filename": "src/qt/macdockiconhandler.mm",
        "status": "modified",
        "additions": 10,
        "deletions": 1,
        "changes": 11,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4d17a1b0c29e8fd8510c75db1efb203b9b4f9eb0/src/qt/macdockiconhandler.mm",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4d17a1b0c29e8fd8510c75db1efb203b9b4f9eb0/src/qt/macdockiconhandler.mm",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/macdockiconhandler.mm?ref=4d17a1b0c29e8fd8510c75db1efb203b9b4f9eb0",
        "patch": "@@ -37,8 +37,9 @@ - (void)handleDockClickEvent:(NSAppleEventDescriptor*)event withReplyEvent:(NSAp\n     Q_UNUSED(event)\n     Q_UNUSED(replyEvent)\n \n-    if (dockIconHandler)\n+    if (dockIconHandler) {\n         dockIconHandler->handleDockIconClickEvent();\n+    }\n }\n \n @end\n@@ -54,10 +55,15 @@ - (void)handleDockClickEvent:(NSAppleEventDescriptor*)event withReplyEvent:(NSAp\n     [pool release];\n }\n \n+void MacDockIconHandler::setMainWindow(QMainWindow *window) {\n+    this->mainWindow = window;\n+}\n+\n MacDockIconHandler::~MacDockIconHandler()\n {\n     [this->m_dockIconClickEventHandler release];\n     delete this->m_dummyWidget;\n+    this->setMainWindow(NULL);\n }\n \n QMenu *MacDockIconHandler::dockMenu()\n@@ -94,5 +100,8 @@ - (void)handleDockClickEvent:(NSAppleEventDescriptor*)event withReplyEvent:(NSAp\n \n void MacDockIconHandler::handleDockIconClickEvent()\n {\n+    this->mainWindow->activateWindow();\n+    this->mainWindow->show();\n+\n     emit this->dockIconClicked();\n }"
      }
    ]
  }
]