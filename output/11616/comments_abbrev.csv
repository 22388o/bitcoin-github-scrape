wodry,2017-11-06T03:14:37Z,"Great! Just a nit: According to the [Developer Notes](https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md)\n\n> If an `if` only has a single-statement `then`-clause, it can appear\n    on the same line as the `if`, without braces. In every other case,\n    braces are required, and the `then` and `else` clauses must appear\n    correctly indented on a new line.\n\nshouldn't",https://github.com/bitcoin/bitcoin/pull/11616#issuecomment-342035907,342035907,
jonasschnelli,2017-11-09T19:08:13Z,Moved the signal call to `SweepBanned()`.,https://github.com/bitcoin/bitcoin/pull/11616#issuecomment-343258729,343258729,
jonasschnelli,2017-11-15T20:52:47Z,Travis is passing now (random issue),https://github.com/bitcoin/bitcoin/pull/11616#issuecomment-344724680,344724680,
theuni,2017-11-15T23:19:28Z,looks good after scoping to avoid holding the lock during the callback.,https://github.com/bitcoin/bitcoin/pull/11616#issuecomment-344762139,344762139,
jonasschnelli,2017-11-19T07:41:28Z,"Thanks @theuni for the review.\nlock-de-scoped the signal call part, switched `setBannedIsDirty` to an atomic.\nBest reviewed with ?w=1",https://github.com/bitcoin/bitcoin/pull/11616#issuecomment-345498234,345498234,
theuni,2017-11-19T15:39:35Z,"@jonasschnelli making setBannedIsDirty atomic doesn't work, i'm afraid, as setBanned/setBannedIsDirty must remain in sync. See CConnman::Unban for an example of where an atomic setBannedIsDirty could go out of sync with setBanned if it's unset elsewhere without cs_setBanned.",https://github.com/bitcoin/bitcoin/pull/11616#issuecomment-345525793,345525793,
jonasschnelli,2017-11-19T22:52:59Z,@theuni. Thanks. Your right. Just change the approach.,https://github.com/bitcoin/bitcoin/pull/11616#issuecomment-345557104,345557104,
laanwj,2017-12-15T09:43:29Z,utACK 57ac471,https://github.com/bitcoin/bitcoin/pull/11616#issuecomment-351960613,351960613,
laanwj,2017-11-06T09:22:54Z,"I think an appropriate place for this would be in `SweepBanned()` itself (at the end, if anything changed), as the list is changed there. It just happens to be called from here, but there are other places.",https://github.com/bitcoin/bitcoin/pull/11616#discussion_r149026519,149026519,src/net.cpp
theuni,2017-11-07T19:03:09Z,Agree.,https://github.com/bitcoin/bitcoin/pull/11616#discussion_r149471007,149471007,src/net.cpp
theuni,2017-11-15T23:17:28Z,This needs to be called without cs_setBanned.,https://github.com/bitcoin/bitcoin/pull/11616#discussion_r151281067,151281067,src/net.cpp
