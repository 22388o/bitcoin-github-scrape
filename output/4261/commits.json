[
  {
    "sha": "09a54a65c0d05fe93c4a31603eca8a9a76ff6526",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzowOWE1NGE2NWMwZDA1ZmU5M2M0YTMxNjAzZWNhOGE5YTc2ZmY2NTI2",
    "commit": {
      "author": {
        "name": "Huang Le",
        "email": "4tarhl@gmail.com",
        "date": "2014-05-30T15:44:44Z"
      },
      "committer": {
        "name": "Huang Le",
        "email": "4tarhl@gmail.com",
        "date": "2014-05-30T15:44:44Z"
      },
      "message": "Use pnode->nLastRecv as sync score directly\n\nNodeSyncScore() should find the node which we recv data most recently, so put a negative sign to pnode->nLastRecv is indeed wrong.\n\nAlso change the return value type to int64_t.\n\nSigned-off-by: Huang Le <4tarhl@gmail.com>",
      "tree": {
        "sha": "e21ed038f6d9b37541290cc100b0f693de08a9d5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e21ed038f6d9b37541290cc100b0f693de08a9d5"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/09a54a65c0d05fe93c4a31603eca8a9a76ff6526",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/09a54a65c0d05fe93c4a31603eca8a9a76ff6526",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/09a54a65c0d05fe93c4a31603eca8a9a76ff6526",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/09a54a65c0d05fe93c4a31603eca8a9a76ff6526/comments",
    "author": {
      "login": "4tar",
      "id": 882771,
      "node_id": "MDQ6VXNlcjg4Mjc3MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/882771?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/4tar",
      "html_url": "https://github.com/4tar",
      "followers_url": "https://api.github.com/users/4tar/followers",
      "following_url": "https://api.github.com/users/4tar/following{/other_user}",
      "gists_url": "https://api.github.com/users/4tar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/4tar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/4tar/subscriptions",
      "organizations_url": "https://api.github.com/users/4tar/orgs",
      "repos_url": "https://api.github.com/users/4tar/repos",
      "events_url": "https://api.github.com/users/4tar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/4tar/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "4tar",
      "id": 882771,
      "node_id": "MDQ6VXNlcjg4Mjc3MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/882771?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/4tar",
      "html_url": "https://github.com/4tar",
      "followers_url": "https://api.github.com/users/4tar/followers",
      "following_url": "https://api.github.com/users/4tar/following{/other_user}",
      "gists_url": "https://api.github.com/users/4tar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/4tar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/4tar/subscriptions",
      "organizations_url": "https://api.github.com/users/4tar/orgs",
      "repos_url": "https://api.github.com/users/4tar/repos",
      "events_url": "https://api.github.com/users/4tar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/4tar/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "97ab93f50b6f35bc362990e9dd665b90ca4132df",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/97ab93f50b6f35bc362990e9dd665b90ca4132df",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/97ab93f50b6f35bc362990e9dd665b90ca4132df"
      }
    ],
    "stats": {
      "total": 12,
      "additions": 6,
      "deletions": 6
    },
    "files": [
      {
        "sha": "b0e6699ed21e8bd95518200ab11311350e27b86e",
        "filename": "src/net.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 6,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/09a54a65c0d05fe93c4a31603eca8a9a76ff6526/src/net.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/09a54a65c0d05fe93c4a31603eca8a9a76ff6526/src/net.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.cpp?ref=09a54a65c0d05fe93c4a31603eca8a9a76ff6526",
        "patch": "@@ -1455,13 +1455,13 @@ bool OpenNetworkConnection(const CAddress& addrConnect, CSemaphoreGrant *grantOu\n \n // for now, use a very simple selection metric: the node from which we received\n // most recently\n-double static NodeSyncScore(const CNode *pnode) {\n-    return -pnode->nLastRecv;\n+static int64_t NodeSyncScore(const CNode *pnode) {\n+    return pnode->nLastRecv;\n }\n \n void static StartSync(const vector<CNode*> &vNodes) {\n     CNode *pnodeNewSync = NULL;\n-    double dBestScore = 0;\n+    int64_t nBestScore = 0;\n \n     int nBestHeight = g_signals.GetHeight().get_value_or(0);\n \n@@ -1473,10 +1473,10 @@ void static StartSync(const vector<CNode*> &vNodes) {\n             (pnode->nStartingHeight > (nBestHeight - 144)) &&\n             (pnode->nVersion < NOBLKS_VERSION_START || pnode->nVersion >= NOBLKS_VERSION_END)) {\n             // if ok, compare node's score with the best so far\n-            double dScore = NodeSyncScore(pnode);\n-            if (pnodeNewSync == NULL || dScore > dBestScore) {\n+            int64_t nScore = NodeSyncScore(pnode);\n+            if (pnodeNewSync == NULL || nScore > nBestScore) {\n                 pnodeNewSync = pnode;\n-                dBestScore = dScore;\n+                nBestScore = nScore;\n             }\n         }\n     }"
      }
    ]
  }
]