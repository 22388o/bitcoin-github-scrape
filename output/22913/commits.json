[
  {
    "sha": "241b2cedb1e06bf46857735116c7bc9def2c516d",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyNDFiMmNlZGIxZTA2YmY0Njg1NzczNTExNmM3YmM5ZGVmMmM1MTZk",
    "commit": {
      "author": {
        "name": "motty",
        "email": "fujicoin@yahoo.com",
        "date": "2021-09-08T06:24:30Z"
      },
      "committer": {
        "name": "motty",
        "email": "fujicoin@yahoo.com",
        "date": "2021-09-08T06:24:30Z"
      },
      "message": "fix the case where the peer status is not updated",
      "tree": {
        "sha": "5f46a356e4eb01cc2b4e850e0f25272bdddff5f1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5f46a356e4eb01cc2b4e850e0f25272bdddff5f1"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/241b2cedb1e06bf46857735116c7bc9def2c516d",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/241b2cedb1e06bf46857735116c7bc9def2c516d",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/241b2cedb1e06bf46857735116c7bc9def2c516d",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/241b2cedb1e06bf46857735116c7bc9def2c516d/comments",
    "author": {
      "login": "fujicoin",
      "id": 7656623,
      "node_id": "MDQ6VXNlcjc2NTY2MjM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7656623?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fujicoin",
      "html_url": "https://github.com/fujicoin",
      "followers_url": "https://api.github.com/users/fujicoin/followers",
      "following_url": "https://api.github.com/users/fujicoin/following{/other_user}",
      "gists_url": "https://api.github.com/users/fujicoin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fujicoin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fujicoin/subscriptions",
      "organizations_url": "https://api.github.com/users/fujicoin/orgs",
      "repos_url": "https://api.github.com/users/fujicoin/repos",
      "events_url": "https://api.github.com/users/fujicoin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fujicoin/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fujicoin",
      "id": 7656623,
      "node_id": "MDQ6VXNlcjc2NTY2MjM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7656623?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fujicoin",
      "html_url": "https://github.com/fujicoin",
      "followers_url": "https://api.github.com/users/fujicoin/followers",
      "following_url": "https://api.github.com/users/fujicoin/following{/other_user}",
      "gists_url": "https://api.github.com/users/fujicoin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fujicoin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fujicoin/subscriptions",
      "organizations_url": "https://api.github.com/users/fujicoin/orgs",
      "repos_url": "https://api.github.com/users/fujicoin/repos",
      "events_url": "https://api.github.com/users/fujicoin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fujicoin/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "ecf580e40f607091a5e5d5fff9865237e037ea7f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ecf580e40f607091a5e5d5fff9865237e037ea7f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/ecf580e40f607091a5e5d5fff9865237e037ea7f"
      }
    ],
    "stats": {
      "total": 6,
      "additions": 5,
      "deletions": 1
    },
    "files": [
      {
        "sha": "b4e7b62da47e86e47bcb7cae2d4c2e4ecdd4adaf",
        "filename": "src/net_processing.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 1,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/241b2cedb1e06bf46857735116c7bc9def2c516d/src/net_processing.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/241b2cedb1e06bf46857735116c7bc9def2c516d/src/net_processing.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net_processing.cpp?ref=241b2cedb1e06bf46857735116c7bc9def2c516d",
        "patch": "@@ -4578,6 +4578,8 @@ bool PeerManagerImpl::SendMessages(CNode* pto)\n                 // Try to find first header that our peer doesn't have, and\n                 // then send all headers past that one.  If we come across any\n                 // headers that aren't on m_chainman.ActiveChain(), give up.\n+                bool fForceSendHeaders = false;\n+\n                 for (const uint256& hash : peer->m_blocks_for_headers_relay) {\n                     const CBlockIndex* pindex = m_chainman.m_blockman.LookupBlockIndex(hash);\n                     assert(pindex);\n@@ -4601,8 +4603,10 @@ bool PeerManagerImpl::SendMessages(CNode* pto)\n                         fRevertToInv = true;\n                         break;\n                     }\n+                    if (state.pindexBestHeaderSent == pindex->pprev)\n+                        fForceSendHeaders = true;\n                     pBestIndex = pindex;\n-                    if (fFoundStartingHeader) {\n+                    if (fForceSendHeaders) {\n                         // add this to the headers message\n                         vHeaders.push_back(pindex->GetBlockHeader());\n                     } else if (PeerHasHeader(&state, pindex)) {"
      }
    ]
  },
  {
    "sha": "609b2cc80e3766888c06be1570dfeef1effb2597",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2MDliMmNjODBlMzc2Njg4OGMwNmJlMTU3MGRmZWVmMWVmZmIyNTk3",
    "commit": {
      "author": {
        "name": "motty",
        "email": "fujicoin@yahoo.com",
        "date": "2021-09-08T10:24:44Z"
      },
      "committer": {
        "name": "motty",
        "email": "fujicoin@yahoo.com",
        "date": "2021-09-08T10:24:44Z"
      },
      "message": "revert fFoundStartingHeader",
      "tree": {
        "sha": "e8fc80bb0bee1594c42f6f600144e2269080b67f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e8fc80bb0bee1594c42f6f600144e2269080b67f"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/609b2cc80e3766888c06be1570dfeef1effb2597",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/609b2cc80e3766888c06be1570dfeef1effb2597",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/609b2cc80e3766888c06be1570dfeef1effb2597",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/609b2cc80e3766888c06be1570dfeef1effb2597/comments",
    "author": {
      "login": "fujicoin",
      "id": 7656623,
      "node_id": "MDQ6VXNlcjc2NTY2MjM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7656623?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fujicoin",
      "html_url": "https://github.com/fujicoin",
      "followers_url": "https://api.github.com/users/fujicoin/followers",
      "following_url": "https://api.github.com/users/fujicoin/following{/other_user}",
      "gists_url": "https://api.github.com/users/fujicoin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fujicoin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fujicoin/subscriptions",
      "organizations_url": "https://api.github.com/users/fujicoin/orgs",
      "repos_url": "https://api.github.com/users/fujicoin/repos",
      "events_url": "https://api.github.com/users/fujicoin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fujicoin/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fujicoin",
      "id": 7656623,
      "node_id": "MDQ6VXNlcjc2NTY2MjM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7656623?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fujicoin",
      "html_url": "https://github.com/fujicoin",
      "followers_url": "https://api.github.com/users/fujicoin/followers",
      "following_url": "https://api.github.com/users/fujicoin/following{/other_user}",
      "gists_url": "https://api.github.com/users/fujicoin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fujicoin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fujicoin/subscriptions",
      "organizations_url": "https://api.github.com/users/fujicoin/orgs",
      "repos_url": "https://api.github.com/users/fujicoin/repos",
      "events_url": "https://api.github.com/users/fujicoin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fujicoin/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "241b2cedb1e06bf46857735116c7bc9def2c516d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/241b2cedb1e06bf46857735116c7bc9def2c516d",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/241b2cedb1e06bf46857735116c7bc9def2c516d"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 2,
      "deletions": 0
    },
    "files": [
      {
        "sha": "907e034e62018fa8527969269997c85d237e62ea",
        "filename": "src/net_processing.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/609b2cc80e3766888c06be1570dfeef1effb2597/src/net_processing.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/609b2cc80e3766888c06be1570dfeef1effb2597/src/net_processing.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net_processing.cpp?ref=609b2cc80e3766888c06be1570dfeef1effb2597",
        "patch": "@@ -4607,6 +4607,8 @@ bool PeerManagerImpl::SendMessages(CNode* pto)\n                         fForceSendHeaders = true;\n                     pBestIndex = pindex;\n                     if (fForceSendHeaders) {\n+                        vHeaders.push_back(pindex->GetBlockHeader());\n+                    } else if (fFoundStartingHeader) {\n                         // add this to the headers message\n                         vHeaders.push_back(pindex->GetBlockHeader());\n                     } else if (PeerHasHeader(&state, pindex)) {"
      }
    ]
  }
]