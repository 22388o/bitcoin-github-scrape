[
  {
    "sha": "09d29b52c836a409b19c38be7f8f34b1bac95c91",
    "node_id": "C_kwDOABII59oAKDA5ZDI5YjUyYzgzNmE0MDliMTljMzhiZTdmOGYzNGIxYmFjOTVjOTE",
    "commit": {
      "author": {
        "name": "Michael Dietz",
        "email": "michael.dietz@waya.ai",
        "date": "2021-09-25T14:15:12Z"
      },
      "committer": {
        "name": "Michael Dietz",
        "email": "michael.dietz@waya.ai",
        "date": "2021-09-25T14:15:12Z"
      },
      "message": "fuzz: fix checks on number of required sigs and keys in multisig scripts\n\nFuzz test coverage was added around the ExtractDestination(s) functions in\na29f522ba4aa71582b54025c5682b4c1687ae9f3. This commit contained an incorrect\nassertion that the number of required signatures in a multisig script was equal\nto the number of addresses. This is incorrect, as for an m-of-n multisig, m <= n.\n\na29f522ba4aa71582b54025c5682b4c1687ae9f3 also had an incorrect assertion on\nthe maximum number of public keys per multisig. It checked that the number of\nkeys was less than or equal to 16. This is incorrect, as it should be <= 20\n(see MAX_PUBKEYS_PER_MULTISIG).\n\nBoth of these incorrect assertions are fixed in this commit accordingly.\n\nNote: this is sort of moot because this behavior is deprecated and these\nfuzz tests are slated for removal in v23 when the deprecation period for\n-deprecatedrpc=addresses ends. However, for correctness and just in case,\nit's fixed here.",
      "tree": {
        "sha": "00aa6fe65cc3d97cd78d6805be558b711a76e9b9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/00aa6fe65cc3d97cd78d6805be558b711a76e9b9"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/09d29b52c836a409b19c38be7f8f34b1bac95c91",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEENKwpEUV32QrrIOeYc3/VzfHRRrkFAmFPLvgACgkQc3/VzfHR\nRrltpw/+KaYVWiJCirz7KEzFnE89gvvVyuV6VGgik+ut4ksz+fTlK5i7Gl7d7M3j\nSi8HYAYbuZPM3qgREq5dkdNs/XP13/7YOfhrU82w+a9EalNLjp2qZ97HoXmmUxCG\nEE4kjI5uv3ZODLLZEi6i61HVJAGlDe2kZaALLKkXlvgHJSzZgX1TvQr3uhEpQBiw\nvOS7v9BEMOPqxlsJXLP+jS+To9KB+w9UNf34g99c+bdUFoy9Ts/THpeZM61IQMFw\nmE3ER6fDDAuVILsnfygzg89G6e1kgbXLdWf9yyKWF3mXqywd1eK+ml8tYODPMFCQ\nAz/NIaJisJK1wQFel+ODZaoZ/bUVOStX8Lzg7yFALRx/HG0kap7M7JrTDp46s3tp\n/sooILYzg1iV6u9y5F6mKD9+ZWv4nK/lS4EuM7tk2oeFf/czepOGtJXR0M1/fKHk\nY7sk+YXB12yLJO8oQ1fWukQUDBzszPo+Jg1riWUpWIjSE/t+sohTF/c7A7bujpip\nzogi2HSxGTcV0u54d7E7jxG6kfr0xep7MI6yznPlNSvKS5A32H9rEoSUKMx6Do8v\nGZ6Qv9Nsp8WBaa4yQgz8rQ8xIUylLM3mzzHR0VONaiCX9ivXHhlgESH+q3X3+9c4\nJuXEbZA5cuhc5MtpYwxAkz+WtJrs8OVAjkqFLloON1KReZG4bnk=\n=5vkD\n-----END PGP SIGNATURE-----",
        "payload": "tree 00aa6fe65cc3d97cd78d6805be558b711a76e9b9\nparent 03cb2b480bd5e35cd6bafbca3ff6adcba52dab8b\nauthor Michael Dietz <michael.dietz@waya.ai> 1632579312 -0500\ncommitter Michael Dietz <michael.dietz@waya.ai> 1632579312 -0500\n\nfuzz: fix checks on number of required sigs and keys in multisig scripts\n\nFuzz test coverage was added around the ExtractDestination(s) functions in\na29f522ba4aa71582b54025c5682b4c1687ae9f3. This commit contained an incorrect\nassertion that the number of required signatures in a multisig script was equal\nto the number of addresses. This is incorrect, as for an m-of-n multisig, m <= n.\n\na29f522ba4aa71582b54025c5682b4c1687ae9f3 also had an incorrect assertion on\nthe maximum number of public keys per multisig. It checked that the number of\nkeys was less than or equal to 16. This is incorrect, as it should be <= 20\n(see MAX_PUBKEYS_PER_MULTISIG).\n\nBoth of these incorrect assertions are fixed in this commit accordingly.\n\nNote: this is sort of moot because this behavior is deprecated and these\nfuzz tests are slated for removal in v23 when the deprecation period for\n-deprecatedrpc=addresses ends. However, for correctness and just in case,\nit's fixed here.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/09d29b52c836a409b19c38be7f8f34b1bac95c91",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/09d29b52c836a409b19c38be7f8f34b1bac95c91",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/09d29b52c836a409b19c38be7f8f34b1bac95c91/comments",
    "author": {
      "login": "mjdietzx",
      "id": 7217256,
      "node_id": "MDQ6VXNlcjcyMTcyNTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7217256?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mjdietzx",
      "html_url": "https://github.com/mjdietzx",
      "followers_url": "https://api.github.com/users/mjdietzx/followers",
      "following_url": "https://api.github.com/users/mjdietzx/following{/other_user}",
      "gists_url": "https://api.github.com/users/mjdietzx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mjdietzx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mjdietzx/subscriptions",
      "organizations_url": "https://api.github.com/users/mjdietzx/orgs",
      "repos_url": "https://api.github.com/users/mjdietzx/repos",
      "events_url": "https://api.github.com/users/mjdietzx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mjdietzx/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "mjdietzx",
      "id": 7217256,
      "node_id": "MDQ6VXNlcjcyMTcyNTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7217256?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mjdietzx",
      "html_url": "https://github.com/mjdietzx",
      "followers_url": "https://api.github.com/users/mjdietzx/followers",
      "following_url": "https://api.github.com/users/mjdietzx/following{/other_user}",
      "gists_url": "https://api.github.com/users/mjdietzx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mjdietzx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mjdietzx/subscriptions",
      "organizations_url": "https://api.github.com/users/mjdietzx/orgs",
      "repos_url": "https://api.github.com/users/mjdietzx/repos",
      "events_url": "https://api.github.com/users/mjdietzx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mjdietzx/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "03cb2b480bd5e35cd6bafbca3ff6adcba52dab8b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/03cb2b480bd5e35cd6bafbca3ff6adcba52dab8b",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/03cb2b480bd5e35cd6bafbca3ff6adcba52dab8b"
      }
    ],
    "stats": {
      "total": 4,
      "additions": 2,
      "deletions": 2
    },
    "files": [
      {
        "sha": "6ca27193dbc00f2b9a7b0bfc8940429c94c8c697",
        "filename": "src/test/fuzz/script.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/09d29b52c836a409b19c38be7f8f34b1bac95c91/src/test/fuzz/script.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/09d29b52c836a409b19c38be7f8f34b1bac95c91/src/test/fuzz/script.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/script.cpp?ref=09d29b52c836a409b19c38be7f8f34b1bac95c91",
        "patch": "@@ -72,8 +72,8 @@ FUZZ_TARGET_INIT(script, initialize_script)\n                    type_ret == TxoutType::NULL_DATA);\n         }\n     } else {\n-        assert(required_ret >= 1 && required_ret <= 16);\n-        assert((unsigned long)required_ret == addresses.size());\n+        assert(required_ret >= 1 && required_ret <= 20);\n+        assert((unsigned long)required_ret <= addresses.size());\n         assert(type_ret == TxoutType::MULTISIG || required_ret == 1);\n     }\n     if (type_ret == TxoutType::NONSTANDARD || type_ret == TxoutType::NULL_DATA) {"
      }
    ]
  }
]