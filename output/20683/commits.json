[
  {
    "sha": "fab46b34f4b13abbb0af276c3fb548f25ccc28bd",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYWI0NmIzNGY0YjEzYWJiYjBhZjI3NmMzZmI1NDhmMjVjY2MyOGJk",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-12-17T12:39:03Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-12-17T14:06:31Z"
      },
      "message": "test: Fix restart node race",
      "tree": {
        "sha": "c1b89d98be6c1b0e99271756811695255947b45f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c1b89d98be6c1b0e99271756811695255947b45f"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fab46b34f4b13abbb0af276c3fb548f25ccc28bd",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUgrywwAk5Mn9P77MaulVJEMqLpg2lpjF4iTCXdWZXpdKYuOtyWQifclT8qjCBRX\nOOwfEdpHO+AudVBU72PVFbQZPTQg46y/kLbYnstw5OeHzVrUQ/wIinuAT+NgvshY\nXIcCwZhaNkct7kb04mvEBWnf1VIc6P6Rumw4RnxCb7DZxfoV2l7xFFLEdMKuc6A7\nj4j4p3NVby6+Tnend6r/4x0cS8ffQAXw20B7WymZ8ArCMmjWg0wPELq0Q9xQprAC\nssHBbfNujMcyKcZ2fSRJXbhy8+9S4rwa+Nwx9jmRVTKSWQsKyxAM2Ic42OYyHkaI\n9WJwD5ruE5DvL4Q8lsXZ+R/JKYtdgYkMuqSZkUoKPQ4dFVBJu+eeY0+5AsKTKaZt\nzELeK00b0R25F44DwBAtuMhWU42POZ/2iolwKqVgQTE2rJxx3GQv2RqTTjzmlzud\ngzLQvHNYYfFjJrGqqXPa5YpVy78EJEsXUB6JtuGl4qYG/n2s4T526N8iGzfcuTBP\nlslNQrP9\n=IA3F\n-----END PGP SIGNATURE-----",
        "payload": "tree c1b89d98be6c1b0e99271756811695255947b45f\nparent f0913f2f950c7a3e0a14d32216bd6ce4e19d85df\nauthor MarcoFalke <falke.marco@gmail.com> 1608208743 +0100\ncommitter MarcoFalke <falke.marco@gmail.com> 1608213991 +0100\n\ntest: Fix restart node race\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fab46b34f4b13abbb0af276c3fb548f25ccc28bd",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fab46b34f4b13abbb0af276c3fb548f25ccc28bd",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fab46b34f4b13abbb0af276c3fb548f25ccc28bd/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "f0913f2f950c7a3e0a14d32216bd6ce4e19d85df",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f0913f2f950c7a3e0a14d32216bd6ce4e19d85df",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/f0913f2f950c7a3e0a14d32216bd6ce4e19d85df"
      }
    ],
    "stats": {
      "total": 8,
      "additions": 5,
      "deletions": 3
    },
    "files": [
      {
        "sha": "85d448b2e8d857f13ca02470268c1620251e175c",
        "filename": "test/functional/test_framework/test_framework.py",
        "status": "modified",
        "additions": 1,
        "deletions": 2,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fab46b34f4b13abbb0af276c3fb548f25ccc28bd/test/functional/test_framework/test_framework.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fab46b34f4b13abbb0af276c3fb548f25ccc28bd/test/functional/test_framework/test_framework.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/test_framework/test_framework.py?ref=fab46b34f4b13abbb0af276c3fb548f25ccc28bd",
        "patch": "@@ -517,13 +517,12 @@ def start_nodes(self, extra_args=None, *args, **kwargs):\n     def stop_node(self, i, expected_stderr='', wait=0):\n         \"\"\"Stop a bitcoind test node\"\"\"\n         self.nodes[i].stop_node(expected_stderr, wait=wait)\n-        self.nodes[i].wait_until_stopped()\n \n     def stop_nodes(self, wait=0):\n         \"\"\"Stop multiple bitcoind test nodes\"\"\"\n         for node in self.nodes:\n             # Issue RPC to stop nodes\n-            node.stop_node(wait=wait)\n+            node.stop_node(wait=wait, wait_until_stopped=False)\n \n         for node in self.nodes:\n             # Wait for nodes to stop"
      },
      {
        "sha": "e10ec1328b28a8f9441b56435a715d80a56947e8",
        "filename": "test/functional/test_framework/test_node.py",
        "status": "modified",
        "additions": 4,
        "deletions": 1,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fab46b34f4b13abbb0af276c3fb548f25ccc28bd/test/functional/test_framework/test_node.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fab46b34f4b13abbb0af276c3fb548f25ccc28bd/test/functional/test_framework/test_node.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/test_framework/test_node.py?ref=fab46b34f4b13abbb0af276c3fb548f25ccc28bd",
        "patch": "@@ -308,7 +308,7 @@ def get_wallet_rpc(self, wallet_name):\n     def version_is_at_least(self, ver):\n         return self.version is None or self.version >= ver\n \n-    def stop_node(self, expected_stderr='', wait=0):\n+    def stop_node(self, expected_stderr='', *, wait=0, wait_until_stopped=True):\n         \"\"\"Stop the node.\"\"\"\n         if not self.running:\n             return\n@@ -337,6 +337,9 @@ def stop_node(self, expected_stderr='', wait=0):\n \n         del self.p2ps[:]\n \n+        if wait_until_stopped:\n+            self.wait_until_stopped()\n+\n     def is_node_stopped(self):\n         \"\"\"Checks whether the node has stopped.\n "
      }
    ]
  }
]