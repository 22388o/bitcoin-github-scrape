MarcoFalke,2020-04-27 13:16:14,"Conceptual suggestion by @amitiuttarwar https://github.com/bitcoin/bitcoin/pull/18038#discussion_r413994990\nApproach suggestion by @promag https://github.com/bitcoin/bitcoin/pull/18751#pullrequestreview-400510676\nImplementation by @sipa https://github.com/bitcoin/bitcoin/pull/18751#issuecomment-619635073",https://github.com/bitcoin/bitcoin/pull/18781#issuecomment-619979122,619979122,
MarcoFalke,2020-04-27 13:16:55,"Appears to be working for me:\n\n```\nerror: no matching function for call to 'GetRandDur'\n    GetRandDur(std::chrono::hours{1});\n    ^~~~~~~~~~\n./random.h:74:3: note: candidate template ignored: couldn't infer template argument 'D'\nD GetRandDur(typename std::common_type<D>::type max) noexcept\n  ^\n1 error generated.\n",https://github.com/bitcoin/bitcoin/pull/18781#issuecomment-619979497,619979497,
MarcoFalke,2020-04-27 13:40:17,"Force pushed to\n* Make diff smaller by 2 lines, but at the same time introduce a new `GetRandMillis`\n* Address feedback by @jonatack to clarify the function name",https://github.com/bitcoin/bitcoin/pull/18781#issuecomment-619993132,619993132,
jonatack,2020-04-27 15:08:10,"ACK, could add unit tests to `util_tests` or `random_tests`? Only GetRand and GetRandInt seem to have coverage.",https://github.com/bitcoin/bitcoin/pull/18781#issuecomment-620045930,620045930,
MarcoFalke,2020-04-27 15:46:13,Done,https://github.com/bitcoin/bitcoin/pull/18781#issuecomment-620068646,620068646,
DrahtBot,2020-04-27 17:49:00,<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.,https://github.com/bitcoin/bitcoin/pull/18781#issuecomment-620135594,620135594,
promag,2020-04-27 22:07:43,ACK faf2e857790182a5f192cd59c5a46c5310bf9cd0.,https://github.com/bitcoin/bitcoin/pull/18781#issuecomment-620261404,620261404,
laanwj,2020-04-30 13:27:42,Code review ACK 0000ea32656833efa3d2ffd9bab66c88c83334f0,https://github.com/bitcoin/bitcoin/pull/18781#issuecomment-621836427,621836427,
promag,2020-04-30 14:42:22,Code review ACK 0000ea32656833efa3d2ffd9bab66c88c83334f0.,https://github.com/bitcoin/bitcoin/pull/18781#issuecomment-621897625,621897625,
jonatack,2020-04-30 14:53:42,"ACK 0000ea3 thanks for the improved documentation. Code review, built, ran `src/test/test_bitcoin -t random_tests -l test_suite` for the new unit tests, `git diff fa05a4c 0000ea3` since previous review:\n```diff\ndiff --git a/src/random.h b/src/random.h\nindex bb9b8c2a2a..0c6dc24983 100644\n--- a/src/random.h\n+++ b/src/random.h\n@@ -67,9 +67,9 @@\n  * Thread-safe.\n  */\n void GetRandByt",https://github.com/bitcoin/bitcoin/pull/18781#issuecomment-621905096,621905096,
MarcoFalke,2020-04-30 22:37:19,Open-Close to re-run ci. See https://github.com/bitcoin/bitcoin/issues/15847#issuecomment-487591130,https://github.com/bitcoin/bitcoin/pull/18781#issuecomment-622154154,622154154,
promag,2020-05-05 21:35:00,Merge?,https://github.com/bitcoin/bitcoin/pull/18781#issuecomment-624319040,624319040,
jonatack,2020-04-27 13:36:04,"Would `GetRandDuration` or `GetRandomDuration` be too long? It would be clearer (and fwiw ""Dur"" means ""hard"" in French :smile:)",https://github.com/bitcoin/bitcoin/pull/18781#discussion_r415818005,415818005,src/random.h
MarcoFalke,2020-04-27 13:39:04,Thanks. Fixed,https://github.com/bitcoin/bitcoin/pull/18781#discussion_r415820308,415820308,src/random.h
jonatack,2020-04-27 13:41:47,Thanks :),https://github.com/bitcoin/bitcoin/pull/18781#discussion_r415822539,415822539,src/random.h
sipa,2020-04-27 17:31:54,Perhaps add a comment here to explain why the `std::common_type` construction is used here.,https://github.com/bitcoin/bitcoin/pull/18781#discussion_r416009719,416009719,src/random.h
sipa,2020-04-27 17:32:34,"The idea came from here, btw: https://stackoverflow.com/a/37737627/8342274",https://github.com/bitcoin/bitcoin/pull/18781#discussion_r416010186,416010186,src/random.h
MarcoFalke,2020-04-27 18:36:11,Done,https://github.com/bitcoin/bitcoin/pull/18781#discussion_r416055098,416055098,src/random.h
laanwj,2020-04-30 13:10:23,"When you're changing these comments anyway, you might want to add that the random number comes from a uniform distribution (especially for durations this is not obvious).",https://github.com/bitcoin/bitcoin/pull/18781#discussion_r417996912,417996912,src/random.h
MarcoFalke,2020-04-30 13:20:50,"Thanks, fixed",https://github.com/bitcoin/bitcoin/pull/18781#discussion_r418003753,418003753,src/random.h
jonatack,2020-04-30 14:59:49,fa0e5b89cf7 should these be moved to `random.h`?,https://github.com/bitcoin/bitcoin/pull/18781#discussion_r418076150,418076150,src/random.cpp
MarcoFalke,2020-04-30 15:14:56,Why?,https://github.com/bitcoin/bitcoin/pull/18781#discussion_r418086897,418086897,src/random.cpp
jonatack,2020-04-30 15:25:23,Because that is where `GenRandMicros` and `GetRandMillis` have been moved?,https://github.com/bitcoin/bitcoin/pull/18781#discussion_r418094260,418094260,src/random.cpp
jonatack,2020-04-30 15:27:07,(or perhaps those are unrelated cleanups and I'm confused),https://github.com/bitcoin/bitcoin/pull/18781#discussion_r418095486,418095486,src/random.cpp
MarcoFalke,2020-04-30 15:28:49,"The secure allocator is only needed for `g_rng`, which is in the cpp file. The lines are simply moved up a few lines. They have been sorted because I touched this file with my editor for other reasons.",https://github.com/bitcoin/bitcoin/pull/18781#discussion_r418096636,418096636,src/random.cpp
jonatack,2020-04-30 15:30:44,"Gotcha, thanks",https://github.com/bitcoin/bitcoin/pull/18781#discussion_r418098083,418098083,src/random.cpp
hebasto,2020-05-14 07:27:03,"```suggestion\n/** Generate a uniform random integer in the range [0..nMax). Precondition: nMax > 0 */\nuint64_t GetRand(uint64_t nMax) noexcept;\n```",https://github.com/bitcoin/bitcoin/pull/18781#discussion_r424924671,424924671,src/random.h
MarcoFalke,2020-05-14 09:56:27,"Thanks. To not invalidate all the ACKs, I am going to leave this for now.",https://github.com/bitcoin/bitcoin/pull/18781#discussion_r425015773,425015773,src/random.h
