[
  {
    "sha": "02ce2a3ca773e2d10ff37ecf50d15c71113f3335",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzowMmNlMmEzY2E3NzNlMmQxMGZmMzdlY2Y1MGQxNWM3MTExM2YzMzM1",
    "commit": {
      "author": {
        "name": "Pavel Vasin",
        "email": "pavel@vasin.nl",
        "date": "2015-08-03T00:03:14Z"
      },
      "committer": {
        "name": "Pavel Vasin",
        "email": "pavel@vasin.nl",
        "date": "2016-05-19T11:52:08Z"
      },
      "message": "qt: askpassphrasedialog: Clear pass fields on accept\n\nThis is usability improvement in a case if user gets re-asked\npassphrase. (e.g. made a typo)",
      "tree": {
        "sha": "a8cb0bb6087c502d51f6d4f62c33b302318129cd",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a8cb0bb6087c502d51f6d4f62c33b302318129cd"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/02ce2a3ca773e2d10ff37ecf50d15c71113f3335",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/02ce2a3ca773e2d10ff37ecf50d15c71113f3335",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/02ce2a3ca773e2d10ff37ecf50d15c71113f3335",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/02ce2a3ca773e2d10ff37ecf50d15c71113f3335/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "7771aa57bdd606a3b9b9020b59da9ff8832860b6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7771aa57bdd606a3b9b9020b59da9ff8832860b6",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/7771aa57bdd606a3b9b9020b59da9ff8832860b6"
      }
    ],
    "stats": {
      "total": 22,
      "additions": 18,
      "deletions": 4
    },
    "files": [
      {
        "sha": "e8aa79679c04a2866a427f0ac0eb1d54d802ae67",
        "filename": "src/qt/askpassphrasedialog.cpp",
        "status": "modified",
        "additions": 17,
        "deletions": 4,
        "changes": 21,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/02ce2a3ca773e2d10ff37ecf50d15c71113f3335/src/qt/askpassphrasedialog.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/02ce2a3ca773e2d10ff37ecf50d15c71113f3335/src/qt/askpassphrasedialog.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/askpassphrasedialog.cpp?ref=02ce2a3ca773e2d10ff37ecf50d15c71113f3335",
        "patch": "@@ -77,10 +77,7 @@ AskPassphraseDialog::AskPassphraseDialog(Mode mode, QWidget *parent) :\n \n AskPassphraseDialog::~AskPassphraseDialog()\n {\n-    // Attempt to overwrite text so that they do not linger around in memory\n-    ui->passEdit1->setText(QString(\" \").repeated(ui->passEdit1->text().size()));\n-    ui->passEdit2->setText(QString(\" \").repeated(ui->passEdit2->text().size()));\n-    ui->passEdit3->setText(QString(\" \").repeated(ui->passEdit3->text().size()));\n+    secureClearPassFields();\n     delete ui;\n }\n \n@@ -103,6 +100,8 @@ void AskPassphraseDialog::accept()\n     newpass1.assign(ui->passEdit2->text().toStdString().c_str());\n     newpass2.assign(ui->passEdit3->text().toStdString().c_str());\n \n+    secureClearPassFields();\n+\n     switch(mode)\n     {\n     case Encrypt: {\n@@ -260,3 +259,17 @@ bool AskPassphraseDialog::eventFilter(QObject *object, QEvent *event)\n     }\n     return QDialog::eventFilter(object, event);\n }\n+\n+static void SecureClearQLineEdit(QLineEdit* edit)\n+{\n+    // Attempt to overwrite text so that they do not linger around in memory\n+    edit->setText(QString(\" \").repeated(edit->text().size()));\n+    edit->clear();\n+}\n+\n+void AskPassphraseDialog::secureClearPassFields()\n+{\n+    SecureClearQLineEdit(ui->passEdit1);\n+    SecureClearQLineEdit(ui->passEdit2);\n+    SecureClearQLineEdit(ui->passEdit3);\n+}"
      },
      {
        "sha": "34bf7ccb31f6fb215506182bee4401fd79a1fc42",
        "filename": "src/qt/askpassphrasedialog.h",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/02ce2a3ca773e2d10ff37ecf50d15c71113f3335/src/qt/askpassphrasedialog.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/02ce2a3ca773e2d10ff37ecf50d15c71113f3335/src/qt/askpassphrasedialog.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/askpassphrasedialog.h?ref=02ce2a3ca773e2d10ff37ecf50d15c71113f3335",
        "patch": "@@ -42,6 +42,7 @@ class AskPassphraseDialog : public QDialog\n \n private Q_SLOTS:\n     void textChanged();\n+    void secureClearPassFields();\n \n protected:\n     bool event(QEvent *event);"
      }
    ]
  }
]