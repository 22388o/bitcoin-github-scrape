[
  {
    "sha": "9479f8dfcf0533366ba81d191b507a0326df66db",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo5NDc5ZjhkZmNmMDUzMzM2NmJhODFkMTkxYjUwN2EwMzI2ZGY2NmRi",
    "commit": {
      "author": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2016-12-22T19:11:26Z"
      },
      "committer": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2016-12-23T13:19:38Z"
      },
      "message": "Allow shutdown during LoadMempool, dump only when necessary",
      "tree": {
        "sha": "2b7515f830f6f8765a40ab31f7a032ecfe0e68f4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2b7515f830f6f8765a40ab31f7a032ecfe0e68f4"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9479f8dfcf0533366ba81d191b507a0326df66db",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "expired_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v2\n\niQIcBAABCAAGBQJYXSRsAAoJECnUvLZBb1PsscIP/3T1PO2Xbb2WcKDBmjTwZq4+\n/Wx1pscQ0RqDfFvD6Awli6WZqjeqR1tvdUVmg20cLG1QxCbAHXHmnD73AxA67q43\nR5vmdQKSWC+kpAC3Fx1KrWHPPL01PsgUPyZhn3EBzqcrUur2Z0XcP273WkvKSStu\nci5UniOiYqYU+6NBV0EStAXf7CEI8ztCyJbF7wINBXenqPkqXuJgUpx1Lts/dk7n\nUr8jHlcTVrXRgiljH/udKJvk3IQS8HKQ/rakW0n0Q1H2jmAYiR3WcARGl6gXzmbq\ncBbp52ewnYhQgn7s1u981mAe/Zk3Q7ffeZdj4hTK1qm0EpaDODtcxqWuImHpZizw\nv1jqcjfc/HdfDcFWFLhDcvX6CAW8Mmov/rGe3tsZdbSQwo1/YfZsOTqr9h4I9UTn\n/6CzNa/+kdaVWZnaJdd6waCFvVwQ8/f8ZsDsu1QiDFEuZWWsu2hqOlAo+4etS5ef\ngwv8X9jlmEl99GnG58s4KLz1qfuwCIVq78D1lvrFm6aMS5/3d6pqZsKIWrD/3y3G\n8ADJprdj9eD+V7ZaOI5GmVbZQQDM50pe34g5qtz5GE1uUYXyDC7PxuTQ74SVHMye\nvLaxOsIUTZXi6qLbJhuMwB7WdXIjUV68jrwYemvqo/G+TIcqs2R/uN6tsgHYjT8e\nezHkiXAKMz6qth+TxHfD\n=+4yH\n-----END PGP SIGNATURE-----",
        "payload": "tree 2b7515f830f6f8765a40ab31f7a032ecfe0e68f4\nparent 041331e1da23e4136fd046ed870cdcc177464176\nauthor Jonas Schnelli <dev@jonasschnelli.ch> 1482433886 +0100\ncommitter Jonas Schnelli <dev@jonasschnelli.ch> 1482499178 +0100\n\nAllow shutdown during LoadMempool, dump only when necessary\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9479f8dfcf0533366ba81d191b507a0326df66db",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/9479f8dfcf0533366ba81d191b507a0326df66db",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9479f8dfcf0533366ba81d191b507a0326df66db/comments",
    "author": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "041331e1da23e4136fd046ed870cdcc177464176",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/041331e1da23e4136fd046ed870cdcc177464176",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/041331e1da23e4136fd046ed870cdcc177464176"
      }
    ],
    "stats": {
      "total": 7,
      "additions": 6,
      "deletions": 1
    },
    "files": [
      {
        "sha": "e239e0d305107c182d6ce02f935916ac3f516904",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 1,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/9479f8dfcf0533366ba81d191b507a0326df66db/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/9479f8dfcf0533366ba81d191b507a0326df66db/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=9479f8dfcf0533366ba81d191b507a0326df66db",
        "patch": "@@ -130,6 +130,7 @@ static const char* FEE_ESTIMATES_FILENAME=\"fee_estimates.dat\";\n //\n \n std::atomic<bool> fRequestShutdown(false);\n+std::atomic<bool> fDumpMempoolLater(false);\n \n void StartShutdown()\n {\n@@ -209,7 +210,8 @@ void Shutdown()\n \n     StopTorControl();\n     UnregisterNodeSignals(GetNodeSignals());\n-    DumpMempool();\n+    if (fDumpMempoolLater)\n+        DumpMempool();\n \n     if (fFeeEstimatesInitialized)\n     {\n@@ -667,6 +669,7 @@ void ThreadImport(std::vector<boost::filesystem::path> vImportFiles)\n     }\n     } // End scope of CImportingNow\n     LoadMempool();\n+    fDumpMempoolLater = !fRequestShutdown;\n }\n \n /** Sanity checks"
      },
      {
        "sha": "b36e90112188f71fe3fb6ceece7847beda2ec955",
        "filename": "src/validation.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/9479f8dfcf0533366ba81d191b507a0326df66db/src/validation.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/9479f8dfcf0533366ba81d191b507a0326df66db/src/validation.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/validation.cpp?ref=9479f8dfcf0533366ba81d191b507a0326df66db",
        "patch": "@@ -4076,6 +4076,8 @@ bool LoadMempool(void)\n             } else {\n                 ++skipped;\n             }\n+            if (ShutdownRequested())\n+                return false;\n         }\n         std::map<uint256, CAmount> mapDeltas;\n         file >> mapDeltas;"
      }
    ]
  },
  {
    "sha": "325e400f9ba89c6f5501c6cedd4dee979a3912b2",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozMjVlNDAwZjliYTg5YzZmNTUwMWM2Y2VkZDRkZWU5NzlhMzkxMmIy",
    "commit": {
      "author": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2017-01-05T11:40:10Z"
      },
      "committer": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2017-01-05T11:40:10Z"
      },
      "message": "[Qt] Do proper shutdown",
      "tree": {
        "sha": "7a3e225a694c1acea48466f2ebb45d63d07e0d07",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7a3e225a694c1acea48466f2ebb45d63d07e0d07"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/325e400f9ba89c6f5501c6cedd4dee979a3912b2",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "expired_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEMu5cTD+hXMrbRqvlKdS8tkFvU+wFAlhuMLIACgkQKdS8tkFv\nU+wp2A//ShLK7I/hni5mYtfqRfadRQyX4PAjOMalOB353R2OtP7NDtswDI3FNP8M\nBec8PWxhKqYPiJLQb8EXAcKhfHNUU/DJi/u/OD+qCkBoEkZBWrmgscO23x8AlSFT\n7g6g/g4BbED4KIIyTtJmtrGJXi+RXDpRD+ZbHJQPf86Pg53TOQIrGaiJD61LEgsE\nL3dnKn5Ezb1XvT3fe23lgNyYM7NA/39cbAz6tSWXKo99kBNv+VC9we0JfbmeqxC7\ne/sZEYpsLVd0oJLpDnnkXlVzPLbiD+83ko5hLTV7DXrT2oMCAdNCA/G44QrwCZok\noNVa4UjNcwqLf8h3M4s7fWDFWWfilzKdcadFI/wVYLs/E9+sCw4Ev9wz2VIQxxJR\nJXscRbf3/msyNyDrkdrdQt2N20hT93B6yZWNlxMBI2KaTxE10yUJ1HfMVrY9epvs\nCqN9nvx46olTfe/Jl86cX8W5rw5kXX1wu3NRPqEvJUv4v7KvXfeePheItlJFDtAS\nl06A6MTl8fExTj9v26NjZ/peB4qhiPtsp+0jZgQOUNG1Bqa4/chmrzFSFjuaeH4I\nCp3Hmj2ss3OEPc9+fBioXKzAmQyXfzLQSChIVAB2ps3ECIR4ZpydZrNPr/dqq+yc\n+vetQQ5vOeRs7Sd67RQhrjTo+UotW3CMoW/XJ/haBasFdbDLwM8=\n=glTD\n-----END PGP SIGNATURE-----",
        "payload": "tree 7a3e225a694c1acea48466f2ebb45d63d07e0d07\nparent 9479f8dfcf0533366ba81d191b507a0326df66db\nauthor Jonas Schnelli <dev@jonasschnelli.ch> 1483616410 +0100\ncommitter Jonas Schnelli <dev@jonasschnelli.ch> 1483616410 +0100\n\n[Qt] Do proper shutdown\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/325e400f9ba89c6f5501c6cedd4dee979a3912b2",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/325e400f9ba89c6f5501c6cedd4dee979a3912b2",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/325e400f9ba89c6f5501c6cedd4dee979a3912b2/comments",
    "author": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "9479f8dfcf0533366ba81d191b507a0326df66db",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9479f8dfcf0533366ba81d191b507a0326df66db",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/9479f8dfcf0533366ba81d191b507a0326df66db"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 2,
      "deletions": 0
    },
    "files": [
      {
        "sha": "66bc5dced67319b64c4c674cf1116c1880c18c17",
        "filename": "src/qt/bitcoin.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/325e400f9ba89c6f5501c6cedd4dee979a3912b2/src/qt/bitcoin.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/325e400f9ba89c6f5501c6cedd4dee979a3912b2/src/qt/bitcoin.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoin.cpp?ref=325e400f9ba89c6f5501c6cedd4dee979a3912b2",
        "patch": "@@ -444,6 +444,8 @@ void BitcoinApplication::requestShutdown()\n     delete clientModel;\n     clientModel = 0;\n \n+    StartShutdown();\n+\n     // Request shutdown from core thread\n     Q_EMIT requestedShutdown();\n }"
      }
    ]
  }
]