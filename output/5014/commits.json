[
  {
    "sha": "41d67c78bf66c8c171947148e18b9ec01768ba65",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0MWQ2N2M3OGJmNjZjOGMxNzE5NDcxNDhlMThiOWVjMDE3NjhiYTY1",
    "commit": {
      "author": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2014-09-30T20:05:27Z"
      },
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2014-09-30T20:26:22Z"
      },
      "message": "tests: fix python test-runner for windows\n\nWindows needed a few fixups to get the tests running:\n1. bitcoin-tx needs a file extension in Windows. Take this opportunity to\n   add an env file, which pulls variables out of our build config. This can\n   be extended as needed, for now it's very simple.\n2. After #1, split the args out of the exec key in the test data.\n3. Correct the line-endings from windows stdout",
      "tree": {
        "sha": "24f9b9fa21f92eb8df80c6343498016cc3688589",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/24f9b9fa21f92eb8df80c6343498016cc3688589"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/41d67c78bf66c8c171947148e18b9ec01768ba65",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/41d67c78bf66c8c171947148e18b9ec01768ba65",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/41d67c78bf66c8c171947148e18b9ec01768ba65",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/41d67c78bf66c8c171947148e18b9ec01768ba65/comments",
    "author": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "4b2b78b9f2bd339cc4505996258e00c186e91792",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4b2b78b9f2bd339cc4505996258e00c186e91792",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/4b2b78b9f2bd339cc4505996258e00c186e91792"
      }
    ],
    "stats": {
      "total": 51,
      "additions": 32,
      "deletions": 19
    },
    "files": [
      {
        "sha": "7025249abab061b0621f4ef714654a64816e7877",
        "filename": "configure.ac",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/41d67c78bf66c8c171947148e18b9ec01768ba65/configure.ac",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/41d67c78bf66c8c171947148e18b9ec01768ba65/configure.ac",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/configure.ac?ref=41d67c78bf66c8c171947148e18b9ec01768ba65",
        "patch": "@@ -793,7 +793,7 @@ AC_SUBST(BUILD_TEST)\n AC_SUBST(BUILD_QT)\n AC_SUBST(BUILD_TEST_QT)\n AC_SUBST(MINIUPNPC_CPPFLAGS)\n-AC_CONFIG_FILES([Makefile src/Makefile share/setup.nsi share/qt/Info.plist])\n+AC_CONFIG_FILES([Makefile src/Makefile share/setup.nsi share/qt/Info.plist src/test/buildenv.py])\n AC_CONFIG_FILES([qa/pull-tester/run-bitcoind-for-test.sh],[chmod +x qa/pull-tester/run-bitcoind-for-test.sh])\n AC_CONFIG_FILES([qa/pull-tester/build-tests.sh],[chmod +x qa/pull-tester/build-tests.sh])\n AC_OUTPUT"
      },
      {
        "sha": "ef461014eab1c342ee006ebfb4fb5599a762a0ec",
        "filename": "src/test/bctest.py",
        "status": "modified",
        "additions": 8,
        "deletions": 7,
        "changes": 15,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/41d67c78bf66c8c171947148e18b9ec01768ba65/src/test/bctest.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/41d67c78bf66c8c171947148e18b9ec01768ba65/src/test/bctest.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/bctest.py?ref=41d67c78bf66c8c171947148e18b9ec01768ba65",
        "patch": "@@ -7,9 +7,11 @@\n import json\n import sys\n \n-def bctest(testDir, testObj):\n-\texecargs = testObj['exec']\n+def bctest(testDir, testObj, exeext):\n \n+\texecprog = testObj['exec'] + exeext\n+\texecargs = testObj['args']\n+\texecrun = [execprog] + execargs\n \tstdinCfg = None\n \tinputData = None\n \tif \"input\" in testObj:\n@@ -22,12 +24,11 @@ def bctest(testDir, testObj):\n \tif \"output_cmp\" in testObj:\n \t\toutputFn = testObj['output_cmp']\n \t\toutputData = open(testDir + \"/\" + outputFn).read()\n-\n-\tproc = subprocess.Popen(execargs, stdin=stdinCfg, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n+\tproc = subprocess.Popen(execrun, stdin=stdinCfg, stdout=subprocess.PIPE, stderr=subprocess.PIPE,universal_newlines=True)\n \ttry:\n \t\touts = proc.communicate(input=inputData)\n \texcept OSError:\n-\t\tprint(\"OSError, Failed to execute \" + execargs[0])\n+\t\tprint(\"OSError, Failed to execute \" + execprog)\n \t\tsys.exit(1)\n \n \tif outputData and (outs[0] != outputData):\n@@ -41,13 +42,13 @@ def bctest(testDir, testObj):\n \t\tprint(\"Return code mismatch for \" + outputFn)\n \t\tsys.exit(1)\n \n-def bctester(testDir, input_basename):\n+def bctester(testDir, input_basename, buildenv):\n \tinput_filename = testDir + \"/\" + input_basename\n \traw_data = open(input_filename).read()\n \tinput_data = json.loads(raw_data)\n \n \tfor testObj in input_data:\n-\t\tbctest(testDir, testObj)\n+\t\tbctest(testDir, testObj, buildenv.exeext)\n \n \tsys.exit(0)\n "
      },
      {
        "sha": "0eece14cfe3a3e57ef2085dbe93b01494bf3ac74",
        "filename": "src/test/bitcoin-util-test.py",
        "status": "modified",
        "additions": 2,
        "deletions": 1,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/41d67c78bf66c8c171947148e18b9ec01768ba65/src/test/bitcoin-util-test.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/41d67c78bf66c8c171947148e18b9ec01768ba65/src/test/bitcoin-util-test.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/bitcoin-util-test.py?ref=41d67c78bf66c8c171947148e18b9ec01768ba65",
        "patch": "@@ -5,8 +5,9 @@\n \n import os\n import bctest\n+import buildenv\n \n if __name__ == '__main__':\n \tbctest.bctester(os.environ[\"srcdir\"] + \"/test/data\",\n-\t\t\t\"bitcoin-util-test.json\")\n+\t\t\t\"bitcoin-util-test.json\",buildenv)\n "
      },
      {
        "sha": "1618bdeb764b8513fa64d1eefe3f41dcf728c5b5",
        "filename": "src/test/buildenv.py.in",
        "status": "added",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/41d67c78bf66c8c171947148e18b9ec01768ba65/src/test/buildenv.py.in",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/41d67c78bf66c8c171947148e18b9ec01768ba65/src/test/buildenv.py.in",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/buildenv.py.in?ref=41d67c78bf66c8c171947148e18b9ec01768ba65",
        "patch": "@@ -0,0 +1,2 @@\n+#!/usr/bin/python\n+exeext=\"@EXEEXT@\""
      },
      {
        "sha": "f8424b72a34c03c8f3eb50a4d888de9949bf9db8",
        "filename": "src/test/data/bitcoin-util-test.json",
        "status": "modified",
        "additions": 19,
        "deletions": 10,
        "changes": 29,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/41d67c78bf66c8c171947148e18b9ec01768ba65/src/test/data/bitcoin-util-test.json",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/41d67c78bf66c8c171947148e18b9ec01768ba65/src/test/data/bitcoin-util-test.json",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/data/bitcoin-util-test.json?ref=41d67c78bf66c8c171947148e18b9ec01768ba65",
        "patch": "@@ -1,41 +1,50 @@\n [\n-  { \"exec\": [\"./bitcoin-tx\", \"-create\"],\n+  { \"exec\": \"././bitcoin-tx\",\n+    \"args\": [\"-create\"],\n     \"output_cmp\": \"blanktx.hex\"\n   },\n-  { \"exec\": [\"./bitcoin-tx\", \"-\"],\n+  { \"exec\": \"./bitcoin-tx\",\n+    \"args\": [\"-\"],\n     \"input\": \"blanktx.hex\",\n     \"output_cmp\": \"blanktx.hex\"\n   },\n-  { \"exec\": [\"./bitcoin-tx\", \"-\", \"delin=1\"],\n+  { \"exec\": \"./bitcoin-tx\",\n+    \"args\": [\"-\", \"delin=1\"],\n     \"input\": \"tx394b54bb.hex\",\n     \"output_cmp\": \"tt-delin1-out.hex\"\n   },\n-  { \"exec\": [\"./bitcoin-tx\", \"-\", \"delin=31\"],\n+  { \"exec\": \"./bitcoin-tx\",\n+    \"args\": [\"-\", \"delin=31\"],\n     \"input\": \"tx394b54bb.hex\",\n     \"return_code\": 1\n   },\n-  { \"exec\": [\"./bitcoin-tx\", \"-\", \"delout=1\"],\n+  { \"exec\": \"./bitcoin-tx\",\n+    \"args\": [\"-\", \"delout=1\"],\n     \"input\": \"tx394b54bb.hex\",\n     \"output_cmp\": \"tt-delout1-out.hex\"\n   },\n-  { \"exec\": [\"./bitcoin-tx\", \"-\", \"delout=2\"],\n+  { \"exec\": \"./bitcoin-tx\",\n+    \"args\": [\"-\", \"delout=2\"],\n     \"input\": \"tx394b54bb.hex\",\n     \"return_code\": 1\n   },\n-  { \"exec\": [\"./bitcoin-tx\", \"-\", \"locktime=317000\"],\n+  { \"exec\": \"./bitcoin-tx\",\n+    \"args\": [\"-\", \"locktime=317000\"],\n     \"input\": \"tx394b54bb.hex\",\n     \"output_cmp\": \"tt-locktime317000-out.hex\"\n   },\n-  { \"exec\":\n-    [\"./bitcoin-tx\", \"-create\",\n+  { \"exec\": \"./bitcoin-tx\",\n+    \"args\":\n+    [\"-create\",\n      \"in=5897de6bd6027a475eadd57019d4e6872c396d0716c4875a5f1a6fcfdf385c1f:0\",\n      \"in=bf829c6bcf84579331337659d31f89dfd138f7f7785802d5501c92333145ca7c:18\",\n      \"in=22a6f904655d53ae2ff70e701a0bbd90aa3975c0f40bfc6cc996a9049e31cdfc:1\",\n      \"outaddr=0.18:13tuJJDR2RgArmgfv6JScSdreahzgc4T6o\",\n      \"outaddr=4:1P8yWvZW8jVihP1bzHeqfE4aoXNX8AVa46\"],\n     \"output_cmp\": \"txcreate1.hex\"\n   },\n-  { \"exec\": [\"./bitcoin-tx\", \"-create\", \"outscript=0:\"],\n+  { \"exec\": \"./bitcoin-tx\",\n+    \"args\": [\"-create\", \"outscript=0:\"],\n     \"output_cmp\": \"txcreate2.hex\"\n   }\n ]"
      }
    ]
  }
]