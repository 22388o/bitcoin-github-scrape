achow101,2017-12-05T16:21:17Z,"I don't think the datadir should ever be specified in the bitcoin.conf file. That would imply that the conf file is in one place (the original datadir) and the actual data is elsewhere. This splits up the contents of the datadir which I don't think we should allow.\n\nI think it would be better to throw an error if it sees the datadir option there or ignore it.",https://github.com/bitcoin/bitcoin/pull/11829#issuecomment-349356525,349356525,
promag,2017-12-05T16:25:42Z,"Agree with @achow101, in that case we should fail if `datadir` is specified in .conf file?\n\n> throw an error if it sees the datadir option there\n\nEdit: ☝️ 👍 @achow101 ",https://github.com/bitcoin/bitcoin/pull/11829#issuecomment-349357973,349357973,
meshcollider,2017-12-05T23:35:02Z,@achow101 it's already possible to split up the datadir in the same way by specifying `-conf` isn't it?,https://github.com/bitcoin/bitcoin/pull/11829#issuecomment-349477571,349477571,
sipa,2017-12-06T06:44:21Z,"@achow101 It's more complicated, as it is possible to specify the config file on the command line too (which then on its turn can set the datadir). This will get even harder once we add network-specific config (#10996). I'd suggest merging this as is, and then separately thinking hard about what configurations should be supported.",https://github.com/bitcoin/bitcoin/pull/11829#issuecomment-349550441,349550441,
meshcollider,2017-12-06T11:21:23Z,"Yeah I've wanted to have a proper think about the config file stuff for a while, since https://github.com/bitcoin/bitcoin/pull/10996 and https://github.com/bitcoin/bitcoin/pull/10267, and suggestions like whether -conf argument should be repeatable, whether there should be a separate -netconf argument, etc. otherwise it's going to get out of hand with conf, netconf, datadir, includeconf, etc.\nPe",https://github.com/bitcoin/bitcoin/pull/11829#issuecomment-349610380,349610380,
promag,2017-12-06T11:32:29Z,"> If a custom data directory is specified using -datadir argument, its existence is checked before the conf file is loaded. But if the conf file then specifies a different non-existent datadir, that isn't tested, and results in esoteric errors like:\n\nIf `-datadir` is specified in the command line, the .conf value should be ignored, because command line arguments should have precedence over .co",https://github.com/bitcoin/bitcoin/pull/11829#issuecomment-349612827,349612827,
meshcollider,2017-12-06T12:09:53Z,"@promag I believe what would happen is that the `-datadir` argument would cause bitcoin to look for the conf file in that specified datadir, and then if that conf file specified a different datadir, then the one in the conf file would override the command line one",https://github.com/bitcoin/bitcoin/pull/11829#issuecomment-349621169,349621169,
promag,2017-12-06T12:13:55Z,I always thought that command line args take precedence over .conf args.,https://github.com/bitcoin/bitcoin/pull/11829#issuecomment-349621952,349621952,
meshcollider,2017-12-06T12:26:22Z,That would maybe be nice in theory but in the code it only matters in which order they are read :) I think after we discuss it in the meeting I might try and rework some of this,https://github.com/bitcoin/bitcoin/pull/11829#issuecomment-349624594,349624594,
promag,2017-12-07T00:51:01Z,"@MeshCollider see above https://github.com/bitcoin/bitcoin/blob/497d0e014cc79d46531d570e74e4aeae72db602d/src/util.cpp#L631\n\nAnyway, utACK 529b866.",https://github.com/bitcoin/bitcoin/pull/11829#issuecomment-349825011,349825011,
laanwj,2017-12-07T12:22:59Z,"> I don't think the datadir should ever be specified in the bitcoin.conf file. \n\nWhy not? Mind you ,the conf is not bound to the data directory.\n\nI've seen setups such as\n`bitcoind -conf=/etc/bitcoin.conf`\nwith `/etc/bitcoin.conf` having the `datadir=...` directory.\n",https://github.com/bitcoin/bitcoin/pull/11829#issuecomment-349952032,349952032,
laanwj,2017-12-07T13:06:35Z,"```\n(11829)$ src/bitcoind -datadir=/tmp/testsfdsdf\nError: Specified data directory ""/tmp/testsfdsdf"" does not exist.\n(11829)$ echo ""datadir=/tmp/testsfdsdf"" > /tmp/bitcoin.conf\n(11829)$ src/bitcoind -conf=/tmp/bitcoin.conf\nError reading configuration file: specified data directory ""/tmp/skflaskjafslkj"" does not exist.\n```\nTested ACK 529b866 (though we really need automated tests for ",https://github.com/bitcoin/bitcoin/pull/11829#issuecomment-349961515,349961515,
promag,2017-12-07T13:26:25Z,"> though we really need automated tests for this!\n\nAgree.",https://github.com/bitcoin/bitcoin/pull/11829#issuecomment-349966237,349966237,
meshcollider,2017-12-07T17:23:59Z,"> though we really need automated tests for this!\n\nWill write some soon :)",https://github.com/bitcoin/bitcoin/pull/11829#issuecomment-350036688,350036688,
sipa,2017-12-06T05:30:45Z,"Any reason why you're once using `GetDataDir(false)` and once `gArgs.GetArg(""-datadir"", """")`? It's a bit confusing if they can ever differ, and if so, why they're used here.",https://github.com/bitcoin/bitcoin/pull/11829#discussion_r155149625,155149625,src/util.cpp
meshcollider,2017-12-06T11:15:15Z,"If the datadir doesn't exist, GetDataDir returns an empty string so the argument needs to be accessed directly in that case",https://github.com/bitcoin/bitcoin/pull/11829#discussion_r155208064,155208064,src/util.cpp
