luke-jr,2021-08-13 15:05:40,"This is not a security issue in Bitcoin Core, and there is nothing Bitcoin Core can do to fix it.\n\nFixing this bug is fine, but please don't misrepresent it.",https://github.com/bitcoin/bitcoin/pull/22698#issuecomment-898521895,898521895,
mjdietzx,2021-08-13 15:11:17,"@luke-jr \n\n> This is not a security issue in Bitcoin Core, and there is nothing Bitcoin Core can do to fix it.\nFixing this bug is fine, but please don't misrepresent it.\n\nI don't think its a security issue in Bitcoin Core. Did I imply that somehow? I basically view this as minor bug fixes, and making bitcoin core adhere to BIP 125 plus getting rid of some inconsistencies ",https://github.com/bitcoin/bitcoin/pull/22698#issuecomment-898532055,898532055,
luke-jr,2021-08-13 15:13:50,"Specifically, ""It fixes bug CVE-2021-31876"" is incorrect. The CVE does not affect Bitcoin Core, and cannot be fixed by changing Core's default policies.",https://github.com/bitcoin/bitcoin/pull/22698#issuecomment-898533860,898533860,
mjdietzx,2021-08-13 15:15:04,"> Specifically, ""It fixes bug CVE-2021-31876"" is incorrect. The CVE does not affect Bitcoin Core, and cannot be fixed by changing Core's default policies.\n\nAny suggestions on how I should better word this? I'll edit",https://github.com/bitcoin/bitcoin/pull/22698#issuecomment-898534739,898534739,
luke-jr,2021-08-13 15:24:22,Just don't mention the CVE at all?,https://github.com/bitcoin/bitcoin/pull/22698#issuecomment-898540867,898540867,
prayank23,2021-08-13 15:24:37,"> Any suggestions on how I should better word this? I'll edit\n\n```diff\n-It fixes bug CVE-2021-31876\n+re: CVE-2021-31876\n```\n\n```diff\n-Fix CVE-2021-31876 RBF inherited signaling and fixes getmempoolentry returned bip125-replaceable status \n+Implement RBF inherited signaling and fix getmempoolentry returned bip125-replaceable status \n```\nAlso Bitcoin Core's RBF implementation r",https://github.com/bitcoin/bitcoin/pull/22698#issuecomment-898541048,898541048,
mjdietzx,2021-08-13 18:41:05,"~~I made this PR a draft for now. Seeing a performance degradation in functional test `mempool_updatefromblock.py`: ```Create an acyclic tournament (a type of directed graph) of transactions and use it for testing.```~~\n\n~~This is along the lines of what @ariard said in #21946~~\n> IMO, main motivation to not fix it is avoiding increasing the DoS surface of the mempool\n\n~~I'm gonna dig in",https://github.com/bitcoin/bitcoin/pull/22698#issuecomment-898651432,898651432,
luke-jr,2021-08-13 19:16:20,">+re: CVE-2021-31876\n\nBut it isn't related to the CVE at all. The security issue is that some software assumes the network has a consistent and firm policy as if it were a consensus rule. That's an issue regardless of what policy Bitcoin Core implements.",https://github.com/bitcoin/bitcoin/pull/22698#issuecomment-898669607,898669607,
DrahtBot,2021-08-14 00:15:35,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#23319](https://github.com/bitcoin/bitcoin/pull/23319) (rpc: Return fee and prevout (utxos) to getrawtransaction by dougE",https://github.com/bitcoin/bitcoin/pull/22698#issuecomment-898778097,898778097,
mjdietzx,2021-08-15 16:24:58,"Marked this as ready for review. I think I just got too fancy with my initial implementation of `isRBFOptIn` - turns out I didn't have to change the original src code very much at all, and once I minimized my changes the performance degradation I was seeing (`test/functional/mempool_updatefromblock.py`'s runtime) resolved itself. Runtime of this test seems to be identical to what it was before thi",https://github.com/bitcoin/bitcoin/pull/22698#issuecomment-899077554,899077554,
mjdietzx,2021-08-16 06:12:42,"Take it w/ a grain of salt, but as a sanity check I ran some mempool related benchmarks before/after this PR. Not very scientific in how I ran these (on my laptop, similar conditions for both runs but I have other stuff running in the background etc.. there was also a lot of variance between multiple runs to the point where I'm not sure we can tell much from these results), but providing the resul",https://github.com/bitcoin/bitcoin/pull/22698#issuecomment-899250792,899250792,
ariard,2021-08-16 23:40:06,"Concept ACK,\n\nEven if I'm still planning to propose opt-in removal in 0.24, this change might reveal as too contentious and it might never lands. Considering this scenario, we're better off fixing the defect and the code matching the spec.\n\nI don't have yet look on implementation details, though we'll look on it soon + #22707 to check we don't downgrade `PreChecks()` perf and as such incre",https://github.com/bitcoin/bitcoin/pull/22698#issuecomment-899886907,899886907,
ariard,2021-08-17 00:17:22,"@luke-jr\n\n> But it isn't related to the CVE at all. The security issue is that some software assumes the network has a consistent and firm policy as if it were a consensus rule. That's an issue regardless of what policy Bitcoin Core implements.\n\nI think the security issue is qualified in the consequences for downstream Bitcoin users of the code defect _compared_  to the standard. Such stan",https://github.com/bitcoin/bitcoin/pull/22698#issuecomment-899900493,899900493,
mjdietzx,2021-08-17 10:04:29,"Thanks @ariard !\n\n> Even if I'm still planning to propose opt-in removal in 0.24, this change might reveal as too contentious and it might never lands. Considering this scenario, we're better off fixing the defect and the code matching the spec.\n\nI came to the same conclusion (had been following the issues/PRs around this topic), and I thought this was a good next step regardless so throug",https://github.com/bitcoin/bitcoin/pull/22698#issuecomment-900163700,900163700,
michaelfolkson,2021-08-30 10:50:04,"> This PR sort of opposes #22665 - I think they are two different approaches to solving some of the confusing behavior we currently have with BIP 125 / RBF. And they should both be considered, although I think it's one or the other.\n\nI disagree that it is one or the other (at least assuming this PR can be rebased on top of a future merged #22665 reversing some changes). I think #22665 addresse",https://github.com/bitcoin/bitcoin/pull/22698#issuecomment-908241259,908241259,
mjdietzx,2021-08-30 14:17:50,"Good point @michaelfolkson, I'll be sure to rebase this PR when #22665 is merged so that this PR can be considered 👍",https://github.com/bitcoin/bitcoin/pull/22698#issuecomment-908382661,908382661,
mjdietzx,2021-09-02 16:09:53,"I am converting this to a draft for now. There are a few related PRs that need to be merged before I can rebase this PR. And I'm also expecting some non-negliglbe changes based on these.\n\nIn the meantime I am planning on splitting out the test coverage added in this PR into its own PR. Once everything is in a steady state I will rebase this PR and re-open for review",https://github.com/bitcoin/bitcoin/pull/22698#issuecomment-911843408,911843408,
glozow,2021-11-20 18:04:03,Are you still working on this?,https://github.com/bitcoin/bitcoin/pull/22698#issuecomment-974688365,974688365,
mjdietzx,2021-11-20 18:38:25,"Yeah, I am planning on rebasing this and re-opening it. Do you think now is a good time to do that?\n\nWhen I marked this as a draft I realized there was a lot of ongoing mempool policy work and that this would need to be re-worked after those changes were merged. At that time I also broke out the tests from this PR into #22867 demonstrating some of the inconsistencies that this PR will resolve,",https://github.com/bitcoin/bitcoin/pull/22698#issuecomment-974693214,974693214,
glozow,2021-11-22 19:27:14,"> Yeah, I am planning on rebasing this and re-opening it. Do you think now is a good time to do that?\n\nYes, I think so. Thank you for your consideration :)\n\n> Do you have any thoughts or suggestions about next steps here @glozow ? Are you a concept ack on this in general?\n\nYes, Concept ACK. I was hesitant before because I think adherence to this interpretation of BIP125#1 (which was wr",https://github.com/bitcoin/bitcoin/pull/22698#issuecomment-975848860,975848860,
mjdietzx,2021-11-29 00:56:38,I rebased and simplified this PR. It is now ready for review. I also re-worked the PR description as things have changed a lot (this is just simpler than before),https://github.com/bitcoin/bitcoin/pull/22698#issuecomment-981201302,981201302,
