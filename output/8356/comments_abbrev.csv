MarcoFalke,2016-07-18T07:27:58Z,"I could imagine this will confuse users ""Why can't I send this transaction? It has the same sized outputs as the transaction I send just 2 hours earlier...""\n\nBut thanks for working on this. @Xekyo is working on improving the coin selection so make sure to discuss any conflicts with his work.\n",https://github.com/bitcoin/bitcoin/pull/8356#issuecomment-233253822,233253822,
NicolasDorier,2016-07-18T07:50:59Z,"@MarcoFalke oh that's cool, the coin selection code is very convoluted, I'm happy someone working on it.\n\n> I could imagine this will confuse users ""Why can't I send this transaction? It has the same sized outputs as the transaction I send just 2 hours earlier...""\n\nThe code impact only the wallet, not the relay policy. Thus, for such thing to happen, you would need a sudden big fee variation A",https://github.com/bitcoin/bitcoin/pull/8356#issuecomment-233257123,233257123,
morcos,2016-07-18T13:22:55Z,"I agree with @NicolasDorier that we need to do something to prevent what happened last time we raised the min relay fee.\n\nI would suggest at least two things.\n1) The actual isDust check for policy should be separated from the minRelayFee.  We want to change this number as infrequently as possible.   It doesn't need to change from it's current value right now I don't think, but we don't want it ",https://github.com/bitcoin/bitcoin/pull/8356#issuecomment-233326624,233326624,
NicolasDorier,2016-07-18T14:39:32Z,"> The actual isDust check for policy should be separated from the minRelayFee.\n\nYou mean changing the relay policy ? I think it should be eventually done, but in a separate PR.\nI remember trying to do it long time ago, and for some reason it was harder than I expected. (I don't remember why though)\n\n>  I would suggest using some maximum of say 2x or 4x the isDust check\n\n@morcos the last bum",https://github.com/bitcoin/bitcoin/pull/8356#issuecomment-233348189,233348189,
NicolasDorier,2016-07-18T14:44:46Z,Ah and just remembered https://github.com/bitcoin/bitcoin/blob/d612837814020ae832499d18e6ee5eb919a87907/src/qt/coincontroldialog.cpp#L454 need to be modified as well... \n,https://github.com/bitcoin/bitcoin/pull/8356#issuecomment-233349811,233349811,
NicolasDorier,2016-07-21T09:51:15Z,"Updated: \n- Introduce `CWallet::GetDustRate` \n- Use of `mempool.GetMinFee(GetArg(""-maxmempool"", DEFAULT_MAX_MEMPOOL_SIZE) * 1000000)` instead of `estimateFee`\n- `CoinControlDialog::updateLabels` also using `CWallet::GetDustRate`\n",https://github.com/bitcoin/bitcoin/pull/8356#issuecomment-234208305,234208305,
morcos,2016-07-21T15:04:32Z,"@NicolasDorier What I meant by separating the min relay fee from isDust, is that I think the next time we adjust minRelayFee or if anyone adjusts it locally, it should not automatically change isDust.  They should be separate limits.  So if we do bump minRelayFee by 5x, isDust doesn't actually change at all, unless we intentionally change it.  And we can intentionally make sure it stays below what",https://github.com/bitcoin/bitcoin/pull/8356#issuecomment-234282535,234282535,
sipa,2016-07-21T15:09:55Z,"@morcos I disagree here. Even without any IsDust rule implemented on the network, wallets should (purely for their own sake) avoid creating change outputs whose value is so low that it is anywhere near close to uneconomical to spend. Sure, we don't have an accurate long-term prediction of fee rates on the network, but our best guess is close enough - even if it easily fluctuates by some constant f",https://github.com/bitcoin/bitcoin/pull/8356#issuecomment-234284161,234284161,
NicolasDorier,2016-07-21T15:28:24Z,"@morcos I agree that minRelayFee should be completely separate from IsDust definition to prevent this problem. However, the best we have now is estimatefee and the mempool.minRelayFee.\n\nKnowing whether an output is economical depends on 1. knowing when it will be spent, 2. how much the fees will be at this time. Both are unknown and can't be predicted in any way.\n\nWhat I want to do in this PR ",https://github.com/bitcoin/bitcoin/pull/8356#issuecomment-234289875,234289875,
morcos,2016-07-21T15:41:56Z,@NicolasDorier Sure or we could talk at a different time.\nAll I'm suggesting is that I think a fixed value is better (at least for now).   Use 5 satoshi per byte or something for GetDustRate  (5 times the current minRelayFee but fixed)\n,https://github.com/bitcoin/bitcoin/pull/8356#issuecomment-234294190,234294190,
NicolasDorier,2016-07-26T12:46:46Z,"I am closing it for now. It seems that coin selection prevent change below 0.01 BTC. \nTo be sure about that I would need to test current behavior in more details, but I don't really have time for now. I may reopen after I tested the current behavior better.\n",https://github.com/bitcoin/bitcoin/pull/8356#issuecomment-235256379,235256379,
MarcoFalke,2016-07-18T07:24:58Z,Why 6?\n,https://github.com/bitcoin/bitcoin/pull/8356#discussion_r71107244,71107244,src/wallet/wallet.cpp
sipa,2016-07-18T07:27:56Z,"It's better to use the mempool relay fee here, I think. Estimatefee is\nabout getting into a block and depends on the speed. The relay fee is just\nabout being relayed.\n",https://github.com/bitcoin/bitcoin/pull/8356#discussion_r71107487,71107487,src/wallet/wallet.cpp
NicolasDorier,2016-07-18T07:46:26Z,"As explained, the problem with relay fee (txMinRelayFee right ?) is that when we bump it as we did on #6793, then old wallet starts to send unrelayable  transaction which cause perturbations to users.\n\n6 is arbitrary, the goal is to not create output which would cost more than their value to redeem in 6 block.\nI'm open to any other number, I just wanted it to be a bit higher than txMinRelayFee ",https://github.com/bitcoin/bitcoin/pull/8356#discussion_r71109165,71109165,src/wallet/wallet.cpp
MarcoFalke,2016-07-18T07:50:42Z,"@NicolasDorier Please note that 6793 has been reverted in the meantime while adding the size limit to the mempool. What @sipa meant, is to use the minimum relay fee of your current mempool and not the minimum relay fee of the node (hardcoded) nor the expected transaction fee to confirm within 6 blocks.\n",https://github.com/bitcoin/bitcoin/pull/8356#discussion_r71109552,71109552,src/wallet/wallet.cpp
NicolasDorier,2016-07-18T14:35:38Z,ohh I did not know that the mempool also had its own minimum relay fee.\n,https://github.com/bitcoin/bitcoin/pull/8356#discussion_r71158270,71158270,src/wallet/wallet.cpp
