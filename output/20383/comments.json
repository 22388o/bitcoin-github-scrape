[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/727007724",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20383#issuecomment-727007724",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20383",
    "id": 727007724,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyNzAwNzcyNA==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-13T20:11:47Z",
    "updated_at": "2021-02-19T22:41:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #21007 (bitcoind: Add -daemonwait option to wait for initialization by laanwj)\n* #20406 (util: Avoid invalid integer negation in FormatMoney and ValueFromAmount by practicalswift)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/727007724/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/727784758",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20383#issuecomment-727784758",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20383",
    "id": 727784758,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcyNzc4NDc1OA==",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?u=5ff13e375b40ea55ecd3c108337dd6a23f68eddf&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-11-16T07:13:35Z",
    "updated_at": "2020-11-16T07:13:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "@promag A fuzz test is added in #19259 (\"tests: Add fuzzing harness for LoadMempool(...) and DumpMempool(...)\"). Review welcome! :)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/727784758/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/760961178",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20383#issuecomment-760961178",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20383",
    "id": 760961178,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MDk2MTE3OA==",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?u=5ff13e375b40ea55ecd3c108337dd6a23f68eddf&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-15T14:06:19Z",
    "updated_at": "2021-01-15T14:09:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Maybe a note \"pls don't fuzz your rpc interface in production\" is good enough?\r\n\r\nI think we should try to make all our interfaces robust against crazy inputs. That includes our RPC interface :)\r\n\r\nWhere \"robustness\" includes being able to handle crazy inputs without triggering ASAN, MSAN, TSAN or UBSAN warnings.\r\n\r\nIn other words I think we should strive for handling crazy user input (UI robustness), crazy programmatic input (RPC robustness) and crazy network input (P2P robustness) without triggering sanitizer warnings.\r\n\r\nNote that even if we didn't care _at all_ about robustness against crazy inputs in our RPC interface it is still makes perfect sense to fuzz the RPC interface since it is the broadest possible general \"entry point\" in to our application. By fuzzing the RPC interface we can reach large parts of our code base and uncover also non-RPC specific bugs.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/760961178/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/760966729",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20383#issuecomment-760966729",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20383",
    "id": 760966729,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MDk2NjcyOQ==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-15T14:16:18Z",
    "updated_at": "2021-01-15T14:16:18Z",
    "author_association": "MEMBER",
    "body": "Sure, when it is possible to add a simple check if the input is invalid, but here it requires changing the whole mempool package tracking code",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/760966729/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523154287",
    "pull_request_review_id": 530317492,
    "id": 523154287,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzE1NDI4Nw==",
    "diff_hunk": "@@ -831,11 +832,17 @@ TxMempoolInfo CTxMemPool::info(const GenTxid& gtxid) const\n \n TxMempoolInfo CTxMemPool::info(const uint256& txid) const { return info(GenTxid{false, txid}); }\n \n-void CTxMemPool::PrioritiseTransaction(const uint256& hash, const CAmount& nFeeDelta)\n+bool CTxMemPool::PrioritiseTransaction(const uint256& hash, const CAmount& nFeeDelta)\n {\n+    if (nFeeDelta == std::numeric_limits<CAmount>::min()) {\n+        return false;\n+    }",
    "path": "src/txmempool.cpp",
    "position": 17,
    "original_position": 20,
    "commit_id": "7244d852d21d4aab149ec68165007836ccf298c7",
    "original_commit_id": "38c331b124329a7fa08ac8d53adfc29a0d1d4ccf",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Why?",
    "created_at": "2020-11-13T18:42:39Z",
    "updated_at": "2021-02-11T08:44:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523154287",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523154287"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523154287"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523154287/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 839,
    "original_start_line": 837,
    "start_side": "RIGHT",
    "line": 841,
    "original_line": 841,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523248706",
    "pull_request_review_id": 530435531,
    "id": 523248706,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzI0ODcwNg==",
    "diff_hunk": "@@ -25,6 +25,7 @@\n #include <test/util/setup_common.h>\n #include <txmempool.h>\n #include <uint256.h>\n+#include <util/overflow.h>",
    "path": "src/test/fuzz/util.h",
    "position": 4,
    "original_position": 4,
    "commit_id": "7244d852d21d4aab149ec68165007836ccf298c7",
    "original_commit_id": "6ab2080bd83479d40c55e0d872e6336d479ad80f",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This needs to be in the parent commit",
    "created_at": "2020-11-13T21:45:30Z",
    "updated_at": "2021-02-11T08:44:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523248706",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523248706"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523248706"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523248706/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 29,
    "original_line": 29,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523250052",
    "pull_request_review_id": 530437253,
    "id": 523250052,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzI1MDA1Mg==",
    "diff_hunk": "@@ -472,7 +472,9 @@ static RPCHelpMan prioritisetransaction()\n         throw JSONRPCError(RPC_INVALID_PARAMETER, \"Priority is no longer supported, dummy argument to prioritisetransaction must be 0.\");\n     }\n \n-    EnsureMemPool(request.context).PrioritiseTransaction(hash, nAmount);\n+    if (!EnsureMemPool(request.context).PrioritiseTransaction(hash, nAmount)) {\n+        throw JSONRPCError(RPC_MISC_ERROR, \"PrioritiseTransaction failed.\");",
    "path": "src/rpc/mining.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "7244d852d21d4aab149ec68165007836ccf298c7",
    "original_commit_id": "38c331b124329a7fa08ac8d53adfc29a0d1d4ccf",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Maybe a bit more verbosity here would be good.",
    "created_at": "2020-11-13T21:48:52Z",
    "updated_at": "2021-02-11T08:44:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523250052",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523250052"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523250052"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523250052/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 476,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523250885",
    "pull_request_review_id": 530438308,
    "id": 523250885,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzI1MDg4NQ==",
    "diff_hunk": "@@ -5081,7 +5081,9 @@ bool LoadMempool(CTxMemPool& pool)\n \n             CAmount amountdelta = nFeeDelta;\n             if (amountdelta) {\n-                pool.PrioritiseTransaction(tx->GetHash(), amountdelta);\n+                if (!pool.PrioritiseTransaction(tx->GetHash(), amountdelta)) {\n+                    LogPrintf(\"PrioritiseTransaction(...) failed. Invalid fee delta?\\n\");",
    "path": "src/validation.cpp",
    "position": 6,
    "original_position": 6,
    "commit_id": "7244d852d21d4aab149ec68165007836ccf298c7",
    "original_commit_id": "38c331b124329a7fa08ac8d53adfc29a0d1d4ccf",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This should be literally impossible to hit based on invalid data...?\r\n\r\nAFAICT, the only possibility is if the user manages to call `prioritisetransaction` RPC before it's loaded the transaction in question",
    "created_at": "2020-11-13T21:50:55Z",
    "updated_at": "2021-02-11T08:44:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523250885",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523250885"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523250885"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523250885/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 5031,
    "original_line": 5031,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523250890",
    "pull_request_review_id": 530438319,
    "id": 523250890,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzI1MDg5MA==",
    "diff_hunk": "@@ -831,11 +832,17 @@ TxMempoolInfo CTxMemPool::info(const GenTxid& gtxid) const\n \n TxMempoolInfo CTxMemPool::info(const uint256& txid) const { return info(GenTxid{false, txid}); }\n \n-void CTxMemPool::PrioritiseTransaction(const uint256& hash, const CAmount& nFeeDelta)\n+bool CTxMemPool::PrioritiseTransaction(const uint256& hash, const CAmount& nFeeDelta)\n {\n+    if (nFeeDelta == std::numeric_limits<CAmount>::min()) {\n+        return false;\n+    }",
    "path": "src/txmempool.cpp",
    "position": 17,
    "original_position": 20,
    "commit_id": "7244d852d21d4aab149ec68165007836ccf298c7",
    "original_commit_id": "38c331b124329a7fa08ac8d53adfc29a0d1d4ccf",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Otherwise the following invalid integer negation will take place:\r\n\r\n```\r\nutil/moneystr.cpp:16:34: runtime error: negation of -9223372036854775808 cannot be represented in type 'CAmount' (aka 'long'); cast to an unsigned type to negate this value to itself\r\n    #0 0x55b386a14eac in FormatMoney[abi:cxx11](long const&) src/util/moneystr.cpp:16:34\r\n    #1 0x55b3861962f3 in CTxMemPool::PrioritiseTransaction(uint256 const&, long const&) src/txmempool.cpp:861:77\r\n```\r\n\r\n`FormatMoney(CAmount n)` is not defined for `n == std::numeric_limits<CAmount>::min()`.\r\n\r\nThe negation of `std::numeric_limits<CAmount>::min()` (-9223372036854775808) cannot be represented in the type `CAmount (int64_t)`.\r\n\r\nTo reproduce:\r\n\r\n```\r\n$ git checkout master\r\n$ make -C src/ bitcoind\r\n$ xxd -p -r > mempool-invalid-negation.dat << \"EOF\"\r\n0100000000000000002e000000005d2d000d020000000000000000000000\r\n200000000000000000000080fc0000002d\r\nEOF\r\n$ cp mempool-invalid-negation.dat ~/.bitcoin/regtest/mempool.dat\r\n$ UBSAN_OPTIONS=\"print_stacktrace=1:halt_on_error=1:report_error_type=1\" src/bitcoind -regtest\r\n\u2026\r\nutil/moneystr.cpp:16:34: runtime error: negation of -9223372036854775808 cannot be represented in type 'CAmount' (aka 'long'); cast to an unsigned type to negate this value to itself\r\n\u2026\r\n```",
    "created_at": "2020-11-13T21:50:56Z",
    "updated_at": "2021-02-11T08:44:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523250890",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523250890"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523250890"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523250890/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 839,
    "original_start_line": 837,
    "start_side": "RIGHT",
    "line": 841,
    "original_line": 841,
    "side": "RIGHT",
    "in_reply_to_id": 523154287
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523260712",
    "pull_request_review_id": 530450582,
    "id": 523260712,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzI2MDcxMg==",
    "diff_hunk": "@@ -5081,7 +5081,9 @@ bool LoadMempool(CTxMemPool& pool)\n \n             CAmount amountdelta = nFeeDelta;\n             if (amountdelta) {\n-                pool.PrioritiseTransaction(tx->GetHash(), amountdelta);\n+                if (!pool.PrioritiseTransaction(tx->GetHash(), amountdelta)) {\n+                    LogPrintf(\"PrioritiseTransaction(...) failed. Invalid fee delta?\\n\");",
    "path": "src/validation.cpp",
    "position": 6,
    "original_position": 6,
    "commit_id": "7244d852d21d4aab149ec68165007836ccf298c7",
    "original_commit_id": "38c331b124329a7fa08ac8d53adfc29a0d1d4ccf",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It is possible, but don't take my word for it. Take my PoC for it! :)\r\n\r\nProof of concept:\r\n\r\n```\r\n$ git checkout master\r\n$ make -C src/ bitcoind\r\n$ xxd -p -r > mempool-signed-integer-overflow.dat << \"EOF\"\r\n01000000000000003f2d3f3f21f800000000000000000000000000000000\r\n6d697464657363656e64616e00000001000000ec000000003d6a6c000000\r\n000000000000ec9bf601000000000000000000ec9b0001000000000001ff\r\nfffef900000001000000ec0000000000ec9b000001000000000101000100\r\n00000001000000ec000000003d6a6a000000000000000020ec9b000000fa\r\n00\r\nEOF\r\n$ cp mempool-signed-integer-overflow.dat ~/.bitcoin/regtest/mempool.dat\r\n$ UBSAN_OPTIONS=\"print_stacktrace=1:halt_on_error=1:report_error_type=1\" src/bitcoind -regtest\r\n\u2026\r\ntxmempool.cpp:839:15: runtime error: signed integer overflow: -7211388903327006720 + -7211353718954917888 cannot be represented in type 'long'\r\n    #0 0x556807f763ec in CTxMemPool::PrioritiseTransaction(uint256 const&, long const&) src/txmempool.cpp:839:15\r\n    #1 0x556807ff3c61 in LoadMempool(CTxMemPool&) src/validation.cpp:5084:22\r\n\u2026\r\n```",
    "created_at": "2020-11-13T22:12:01Z",
    "updated_at": "2021-02-11T08:44:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523260712",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523260712"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523260712"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523260712/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 5031,
    "original_line": 5031,
    "side": "RIGHT",
    "in_reply_to_id": 523250885
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523261363",
    "pull_request_review_id": 530451439,
    "id": 523261363,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzI2MTM2Mw==",
    "diff_hunk": "@@ -25,6 +25,7 @@\n #include <test/util/setup_common.h>\n #include <txmempool.h>\n #include <uint256.h>\n+#include <util/overflow.h>",
    "path": "src/test/fuzz/util.h",
    "position": 4,
    "original_position": 4,
    "commit_id": "7244d852d21d4aab149ec68165007836ccf298c7",
    "original_commit_id": "6ab2080bd83479d40c55e0d872e6336d479ad80f",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Good point. Now fixed.",
    "created_at": "2020-11-13T22:14:03Z",
    "updated_at": "2021-02-11T08:44:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523261363",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523261363"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523261363"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523261363/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 29,
    "original_line": 29,
    "side": "RIGHT",
    "in_reply_to_id": 523248706
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523264921",
    "pull_request_review_id": 530455923,
    "id": 523264921,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzI2NDkyMQ==",
    "diff_hunk": "@@ -472,7 +472,9 @@ static RPCHelpMan prioritisetransaction()\n         throw JSONRPCError(RPC_INVALID_PARAMETER, \"Priority is no longer supported, dummy argument to prioritisetransaction must be 0.\");\n     }\n \n-    EnsureMemPool(request.context).PrioritiseTransaction(hash, nAmount);\n+    if (!EnsureMemPool(request.context).PrioritiseTransaction(hash, nAmount)) {\n+        throw JSONRPCError(RPC_MISC_ERROR, \"PrioritiseTransaction failed.\");",
    "path": "src/rpc/mining.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "7244d852d21d4aab149ec68165007836ccf298c7",
    "original_commit_id": "38c331b124329a7fa08ac8d53adfc29a0d1d4ccf",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Now using a slightly more verbose error message which hints that an invalid `fee_delta` argument is the most likely cause. Let me know if you have any other suggestion on wording.",
    "created_at": "2020-11-13T22:24:28Z",
    "updated_at": "2021-02-11T08:44:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523264921",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523264921"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523264921"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523264921/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 476,
    "side": "RIGHT",
    "in_reply_to_id": 523250052
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523426834",
    "pull_request_review_id": 530582399,
    "id": 523426834,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzQyNjgzNA==",
    "diff_hunk": "@@ -5112,7 +5114,9 @@ bool LoadMempool(CTxMemPool& pool)\n         file >> mapDeltas;\n \n         for (const auto& i : mapDeltas) {\n-            pool.PrioritiseTransaction(i.first, i.second);\n+            if (!pool.PrioritiseTransaction(i.first, i.second)) {\n+                LogPrintf(\"PrioritiseTransaction(...) failed. Invalid fee delta?\\n\");",
    "path": "src/validation.cpp",
    "position": 17,
    "original_position": 17,
    "commit_id": "7244d852d21d4aab149ec68165007836ccf298c7",
    "original_commit_id": "bde46e38fd4fca9dbef4baad1500dedf387d563e",
    "user": {
      "login": "Crypt-iQ",
      "id": 15145615,
      "node_id": "MDQ6VXNlcjE1MTQ1NjE1",
      "avatar_url": "https://avatars.githubusercontent.com/u/15145615?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Crypt-iQ",
      "html_url": "https://github.com/Crypt-iQ",
      "followers_url": "https://api.github.com/users/Crypt-iQ/followers",
      "following_url": "https://api.github.com/users/Crypt-iQ/following{/other_user}",
      "gists_url": "https://api.github.com/users/Crypt-iQ/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Crypt-iQ/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Crypt-iQ/subscriptions",
      "organizations_url": "https://api.github.com/users/Crypt-iQ/orgs",
      "repos_url": "https://api.github.com/users/Crypt-iQ/repos",
      "events_url": "https://api.github.com/users/Crypt-iQ/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Crypt-iQ/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@practicalswift do you have a PoC for this one too? Just curious what the input looks like.",
    "created_at": "2020-11-14T14:46:24Z",
    "updated_at": "2021-02-11T08:44:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523426834",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523426834"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523426834"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523426834/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 5064,
    "original_line": 5064,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523747142",
    "pull_request_review_id": 530790741,
    "id": 523747142,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzc0NzE0Mg==",
    "diff_hunk": "@@ -5112,7 +5114,9 @@ bool LoadMempool(CTxMemPool& pool)\n         file >> mapDeltas;\n \n         for (const auto& i : mapDeltas) {\n-            pool.PrioritiseTransaction(i.first, i.second);\n+            if (!pool.PrioritiseTransaction(i.first, i.second)) {\n+                LogPrintf(\"PrioritiseTransaction(...) failed. Invalid fee delta?\\n\");",
    "path": "src/validation.cpp",
    "position": 17,
    "original_position": 17,
    "commit_id": "7244d852d21d4aab149ec68165007836ccf298c7",
    "original_commit_id": "bde46e38fd4fca9dbef4baad1500dedf387d563e",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@Crypt-iQ Absolutely, your wish is my command: here you go! :)\r\n\r\nProof of concept:\r\n\r\n```\r\n$ git checkout master\r\n$ make -C src/ bitcoind\r\n$ xxd -p -r > mempool-poc-for-second-case-on-line-5115.dat << EOF\r\n0100000000000000010000000000000000000000000000003f0020202020\r\n202020202020202020ff20ff016e2682a8e0af181ae4ffa4ce2fc42b1e3d\r\n8ce88019b194a45cd7c476b88ef1e220202020202020802020ff2020\r\nEOF\r\n$ cp mempool-poc-for-second-case-on-line-5115.dat ~/.bitcoin/regtest/mempool.dat\r\n$ UBSAN_OPTIONS=\"print_stacktrace=1:halt_on_error=1:report_error_type=1\" src/bitcoind -regtest\r\n\u2026\r\ntxmempool.cpp:839:15: runtime error: signed integer overflow: -62769881340174304 + -9214329515250016224 cannot be represented in type 'long'\r\n    #0 0x5652ab2203ec in CTxMemPool::PrioritiseTransaction(uint256 const&, long const&) src/txmempool.cpp:839:15\r\n    #1 0x5652ab29e1ad in LoadMempool(CTxMemPool&) src/validation.cpp:5115:18\r\n\u2026\r\n```\r\n\r\n:)",
    "created_at": "2020-11-15T11:43:20Z",
    "updated_at": "2021-02-11T08:44:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523747142",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523747142"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523747142"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523747142/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 5064,
    "original_line": 5064,
    "side": "RIGHT",
    "in_reply_to_id": 523426834
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523828685",
    "pull_request_review_id": 530846628,
    "id": 523828685,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzgyODY4NQ==",
    "diff_hunk": "@@ -5112,7 +5114,9 @@ bool LoadMempool(CTxMemPool& pool)\n         file >> mapDeltas;\n \n         for (const auto& i : mapDeltas) {\n-            pool.PrioritiseTransaction(i.first, i.second);\n+            if (!pool.PrioritiseTransaction(i.first, i.second)) {\n+                LogPrintf(\"PrioritiseTransaction(...) failed. Invalid fee delta?\\n\");",
    "path": "src/validation.cpp",
    "position": 17,
    "original_position": 17,
    "commit_id": "7244d852d21d4aab149ec68165007836ccf298c7",
    "original_commit_id": "bde46e38fd4fca9dbef4baad1500dedf387d563e",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Add as a test?",
    "created_at": "2020-11-15T23:11:45Z",
    "updated_at": "2021-02-11T08:44:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523828685",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523828685"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523828685"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523828685/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 5064,
    "original_line": 5064,
    "side": "RIGHT",
    "in_reply_to_id": 523426834
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523934241",
    "pull_request_review_id": 530958767,
    "id": 523934241,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyMzkzNDI0MQ==",
    "diff_hunk": "@@ -5112,7 +5114,9 @@ bool LoadMempool(CTxMemPool& pool)\n         file >> mapDeltas;\n \n         for (const auto& i : mapDeltas) {\n-            pool.PrioritiseTransaction(i.first, i.second);\n+            if (!pool.PrioritiseTransaction(i.first, i.second)) {\n+                LogPrintf(\"PrioritiseTransaction(...) failed. Invalid fee delta?\\n\");",
    "path": "src/validation.cpp",
    "position": 17,
    "original_position": 17,
    "commit_id": "7244d852d21d4aab149ec68165007836ccf298c7",
    "original_commit_id": "bde46e38fd4fca9dbef4baad1500dedf387d563e",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@promag A fuzz test is added in #19259 (\"tests: Add fuzzing harness for LoadMempool(...) and DumpMempool(...)\"). Review welcome! :)",
    "created_at": "2020-11-16T07:12:47Z",
    "updated_at": "2021-02-11T08:44:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523934241",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523934241"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r523934241"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/523934241/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 5064,
    "original_line": 5064,
    "side": "RIGHT",
    "in_reply_to_id": 523426834
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/527009032",
    "pull_request_review_id": 534606242,
    "id": 527009032,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDUyNzAwOTAzMg==",
    "diff_hunk": "@@ -831,11 +832,17 @@ TxMempoolInfo CTxMemPool::info(const GenTxid& gtxid) const\n \n TxMempoolInfo CTxMemPool::info(const uint256& txid) const { return info(GenTxid{false, txid}); }\n \n-void CTxMemPool::PrioritiseTransaction(const uint256& hash, const CAmount& nFeeDelta)\n+bool CTxMemPool::PrioritiseTransaction(const uint256& hash, const CAmount& nFeeDelta)\n {\n+    if (nFeeDelta == std::numeric_limits<CAmount>::min()) {\n+        return false;\n+    }",
    "path": "src/txmempool.cpp",
    "position": 17,
    "original_position": 20,
    "commit_id": "7244d852d21d4aab149ec68165007836ccf298c7",
    "original_commit_id": "38c331b124329a7fa08ac8d53adfc29a0d1d4ccf",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "If the fix to `FormayMoney` in #20406 is applied we don't have to have the restriction. I think that would be even better :)",
    "created_at": "2020-11-19T16:09:00Z",
    "updated_at": "2021-02-11T08:44:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r527009032",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/527009032"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r527009032"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/527009032/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 839,
    "original_start_line": 837,
    "start_side": "RIGHT",
    "line": 841,
    "original_line": 841,
    "side": "RIGHT",
    "in_reply_to_id": 523154287
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557250615",
    "pull_request_review_id": 568048834,
    "id": 557250615,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NzI1MDYxNQ==",
    "diff_hunk": "@@ -831,11 +832,17 @@ TxMempoolInfo CTxMemPool::info(const GenTxid& gtxid) const\n \n TxMempoolInfo CTxMemPool::info(const uint256& txid) const { return info(GenTxid{false, txid}); }\n \n-void CTxMemPool::PrioritiseTransaction(const uint256& hash, const CAmount& nFeeDelta)\n+bool CTxMemPool::PrioritiseTransaction(const uint256& hash, const CAmount& nFeeDelta)\n {\n+    if (nFeeDelta == std::numeric_limits<CAmount>::min()) {\n+        return false;\n+    }\n     {\n         LOCK(cs);\n         CAmount &delta = mapDeltas[hash];\n+        if (AdditionOverflow(delta, nFeeDelta)) {",
    "path": "src/txmempool.cpp",
    "position": 21,
    "original_position": 24,
    "commit_id": "7244d852d21d4aab149ec68165007836ccf298c7",
    "original_commit_id": "1977f9d9465156483ecfcd6f5a37dc3f8d3f29cb",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This check isn't complete. You'd have to check all ancestors and descandants as well. Also, I don't understand why this can't be `FeeDeltaRange` https://github.com/bitcoin/bitcoin/pull/20089/files#r557249710",
    "created_at": "2021-01-14T09:22:45Z",
    "updated_at": "2021-02-11T08:44:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r557250615",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557250615"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r557250615"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557250615/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 845,
    "original_line": 845,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557252571",
    "pull_request_review_id": 568048834,
    "id": 557252571,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NzI1MjU3MQ==",
    "diff_hunk": "@@ -467,7 +467,9 @@ static RPCHelpMan prioritisetransaction()\n         throw JSONRPCError(RPC_INVALID_PARAMETER, \"Priority is no longer supported, dummy argument to prioritisetransaction must be 0.\");\n     }\n \n-    EnsureMemPool(request.context).PrioritiseTransaction(hash, nAmount);\n+    if (!EnsureMemPool(request.context).PrioritiseTransaction(hash, nAmount)) {\n+        throw JSONRPCError(RPC_MISC_ERROR, \"PrioritiseTransaction(...) failed. Invalid fee_delta argument?\");",
    "path": "src/rpc/mining.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "7244d852d21d4aab149ec68165007836ccf298c7",
    "original_commit_id": "1977f9d9465156483ecfcd6f5a37dc3f8d3f29cb",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "might be good to update the docs and release notes. Something like\r\n\r\n\r\n```diff\r\ndiff --git a/src/amount.h b/src/amount.h\r\nindex 47968e80b1..9c770a8fe3 100644\r\n--- a/src/amount.h\r\n+++ b/src/amount.h\r\n@@ -24,5 +24,6 @@ static const CAmount COIN = 100000000;\r\n  * */\r\n static const CAmount MAX_MONEY = 21000000 * COIN;\r\n inline bool MoneyRange(const CAmount& nValue) { return (nValue >= 0 && nValue <= MAX_MONEY); }\r\n+inline bool FeeDeltaRange(const CAmount& fee_delta) { return -MAX_MONEY <= fee_delta && fee_delta <= MAX_MONEY; }\r\n \r\n #endif //  BITCOIN_AMOUNT_H\r\ndiff --git a/src/rpc/mining.cpp b/src/rpc/mining.cpp\r\nindex 0e96beb6db..181570807c 100644\r\n--- a/src/rpc/mining.cpp\r\n+++ b/src/rpc/mining.cpp\r\n@@ -444,14 +444,14 @@ static RPCHelpMan prioritisetransaction()\r\n                 {\r\n                     {\"txid\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"The transaction id.\"},\r\n                     {\"dummy\", RPCArg::Type::NUM, RPCArg::Optional::OMITTED_NAMED_ARG, \"API-Compatibility for previous API. Must be zero or null.\\n\"\r\n-            \"                  DEPRECATED. For forward compatibility use named arguments and omit this parameter.\"},\r\n-                    {\"fee_delta\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The fee value (in satoshis) to add (or subtract, if negative).\\n\"\r\n-            \"                  Note, that this value is not a fee rate. It is a value to modify absolute fee of the TX.\\n\"\r\n-            \"                  The fee is not actually paid, only the algorithm for selecting transactions into a block\\n\"\r\n-            \"                  considers the transaction as it would have paid a higher (or lower) fee.\"},\r\n+                              \"DEPRECATED. For forward compatibility use named arguments and omit this parameter.\"},\r\n+                    {\"fee_delta\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The fee value (in satoshis) to add (or subtract, if negative). Must be in the range +-\" + ToString(MAX_MONEY) + \" sat.\\n\"\r\n+                              \"Note, that this value is not a fee rate. It is a value to modify absolute fee of the TX.\\n\"\r\n+                              \"The fee is not actually paid, only the algorithm for selecting transactions into a block\\n\"\r\n+                              \"considers the transaction as it would have paid a higher (or lower) fee.\"},\r\n                 },\r\n                 RPCResult{\r\n-                    RPCResult::Type::BOOL, \"\", \"Returns true\"},\r\n+                    RPCResult::Type::BOOL, \"\", \"Returns true or throws on error\"},\r\n                 RPCExamples{\r\n                     HelpExampleCli(\"prioritisetransaction\", \"\\\"txid\\\" 0.0 10000\")\r\n             + HelpExampleRpc(\"prioritisetransaction\", \"\\\"txid\\\", 0.0, 10000\")\r\n@@ -460,14 +460,17 @@ static RPCHelpMan prioritisetransaction()\r\n {\r\n     LOCK(cs_main);\r\n \r\n-    uint256 hash(ParseHashV(request.params[0], \"txid\"));\r\n-    CAmount nAmount = request.params[2].get_int64();\r\n+    const uint256 hash(ParseHashV(request.params[0], \"txid\"));\r\n+    const CAmount nAmount = request.params[2].get_int64();\r\n \r\n     if (!(request.params[1].isNull() || request.params[1].get_real() == 0)) {\r\n         throw JSONRPCError(RPC_INVALID_PARAMETER, \"Priority is no longer supported, dummy argument to prioritisetransaction must be 0.\");\r\n     }\r\n \r\n-    EnsureMemPool(request.context).PrioritiseTransaction(hash, nAmount);\r\n+    CTxMemPool& mempool = EnsureMemPool(request.context);\r\n+    if (!mempool.PrioritiseTransaction(hash, nAmount)) {\r\n+        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid fee_delta passed\");\r\n+    }\r\n     return true;\r\n },\r\n     };\r\n",
    "created_at": "2021-01-14T09:25:45Z",
    "updated_at": "2021-02-11T08:44:03Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r557252571",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557252571"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r557252571"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/557252571/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 471,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/584325323",
    "pull_request_review_id": 600279144,
    "id": 584325323,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NDMyNTMyMw==",
    "diff_hunk": "@@ -24,5 +24,6 @@ static const CAmount COIN = 100000000;\n  * */\n static const CAmount MAX_MONEY = 21000000 * COIN;\n inline bool MoneyRange(const CAmount& nValue) { return (nValue >= 0 && nValue <= MAX_MONEY); }\n+inline bool FeeDeltaRange(const CAmount& fee_delta) { return -MAX_MONEY <= fee_delta && fee_delta <= MAX_MONEY; }",
    "path": "src/amount.h",
    "position": 4,
    "original_position": 4,
    "commit_id": "7244d852d21d4aab149ec68165007836ccf298c7",
    "original_commit_id": "7244d852d21d4aab149ec68165007836ccf298c7",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Fee deltas have no such range limit.",
    "created_at": "2021-02-28T16:56:26Z",
    "updated_at": "2021-02-28T16:56:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r584325323",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/584325323"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r584325323"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/584325323/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 27,
    "original_line": 27,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/584335817",
    "pull_request_review_id": 600287214,
    "id": 584335817,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4NDMzNTgxNw==",
    "diff_hunk": "@@ -24,5 +24,6 @@ static const CAmount COIN = 100000000;\n  * */\n static const CAmount MAX_MONEY = 21000000 * COIN;\n inline bool MoneyRange(const CAmount& nValue) { return (nValue >= 0 && nValue <= MAX_MONEY); }\n+inline bool FeeDeltaRange(const CAmount& fee_delta) { return -MAX_MONEY <= fee_delta && fee_delta <= MAX_MONEY; }",
    "path": "src/amount.h",
    "position": 4,
    "original_position": 4,
    "commit_id": "7244d852d21d4aab149ec68165007836ccf298c7",
    "original_commit_id": "7244d852d21d4aab149ec68165007836ccf298c7",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Context: https://github.com/bitcoin/bitcoin/pull/20089#discussion_r557249710 + https://github.com/bitcoin/bitcoin/pull/20383#discussion_r557252571",
    "created_at": "2021-02-28T18:15:30Z",
    "updated_at": "2021-02-28T18:15:30Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r584335817",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/584335817"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r584335817"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/584335817/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 27,
    "original_line": 27,
    "side": "RIGHT",
    "in_reply_to_id": 584325323
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/741416636",
    "pull_request_review_id": 795854940,
    "id": 741416636,
    "node_id": "PRRC_kwDOABII584sMR68",
    "diff_hunk": "@@ -831,11 +832,17 @@ TxMempoolInfo CTxMemPool::info(const GenTxid& gtxid) const\n \n TxMempoolInfo CTxMemPool::info(const uint256& txid) const { return info(GenTxid{false, txid}); }\n \n-void CTxMemPool::PrioritiseTransaction(const uint256& hash, const CAmount& nFeeDelta)\n+bool CTxMemPool::PrioritiseTransaction(const uint256& hash, const CAmount& nFeeDelta)\n {\n+    if (nFeeDelta == std::numeric_limits<CAmount>::min()) {\n+        return false;\n+    }\n     {\n         LOCK(cs);\n         CAmount &delta = mapDeltas[hash];\n+        if (AdditionOverflow(delta, nFeeDelta)) {",
    "path": "src/txmempool.cpp",
    "position": 21,
    "original_position": 24,
    "commit_id": "7244d852d21d4aab149ec68165007836ccf298c7",
    "original_commit_id": "1977f9d9465156483ecfcd6f5a37dc3f8d3f29cb",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Implemented an alternative that also checks all ancestors and descendants here: #23418 ",
    "created_at": "2021-11-02T19:52:19Z",
    "updated_at": "2021-11-02T19:52:20Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r741416636",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/741416636"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20383#discussion_r741416636"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20383"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/741416636/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 845,
    "original_line": 845,
    "side": "RIGHT",
    "in_reply_to_id": 557250615
  }
]