[
  {
    "sha": "faf13e272cad44917c4e5516172617fe8d68c00a",
    "node_id": "C_kwDOABII59oAKGZhZjEzZTI3MmNhZDQ0OTE3YzRlNTUxNjE3MjYxN2ZlOGQ2OGMwMGE",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-10-18T09:51:08Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-10-19T10:28:13Z"
      },
      "message": "Add missing gettimeofday to syscall sandbox\n\nAlso, sort entries. Can be reviewed with: --color-moved=dimmed-zebra",
      "tree": {
        "sha": "c9525ad03b8c5543ac1b0d7868161c19f9ad1ba7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c9525ad03b8c5543ac1b0d7868161c19f9ad1ba7"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/faf13e272cad44917c4e5516172617fe8d68c00a",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUhA+gwAhvhL5EcvGMORvYPsiQ51TP235pk1M+4U88H0qaJLSWDKbggcuX+kJeQ+\n2jyJbMa7s86uQ3jbDgDVTFFvl+75v6DX+uVQY6oeXaSZrb2QTIobgljEE61TO5HF\nJmWgQDaaHaHw8KbXmvn+LTCIjA7/xcQGdTsWy70OnRnk6WU1zxIpP1E/g7ObpgAn\noz7vN2Y/yYEigWd5H2OVaJydcPIo6C8TtgAUhD/lgXQESjREEbEAo+Fg5ytcTsBQ\nT3Ser8byzBbPN6u7UAoY2PJ7Fv48+PXRXj1jQ5iWllmGVe1P90illGo7RZmnoGn7\ngUGbAxqqgjp6OhI4HWxo5s1iW0wtZpQK3Koql25oj5vhkiVi803MyygxR8JyqIXy\nPe3h1dN/cM0ZpkZEVsjhEFUxR1Sx2zDTmkA4VD/nUGL6qXgOn5ZnSulwZ8eDjUWV\n5XqITuGIU2c9ycnP0sSs/CTOqNFcNDR3JEUSzjaKdbHms1S4R0EMuxSZAvh4Z46h\nhaxG4VZz\n=f10z\n-----END PGP SIGNATURE-----",
        "payload": "tree c9525ad03b8c5543ac1b0d7868161c19f9ad1ba7\nparent 077e98c6c20609bff7ecf1c7c9cdb3f4b31bc139\nauthor MarcoFalke <falke.marco@gmail.com> 1634550668 +0200\ncommitter MarcoFalke <falke.marco@gmail.com> 1634639293 +0200\n\nAdd missing gettimeofday to syscall sandbox\n\nAlso, sort entries. Can be reviewed with: --color-moved=dimmed-zebra\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faf13e272cad44917c4e5516172617fe8d68c00a",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/faf13e272cad44917c4e5516172617fe8d68c00a",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faf13e272cad44917c4e5516172617fe8d68c00a/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "077e98c6c20609bff7ecf1c7c9cdb3f4b31bc139",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/077e98c6c20609bff7ecf1c7c9cdb3f4b31bc139",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/077e98c6c20609bff7ecf1c7c9cdb3f4b31bc139"
      }
    ],
    "stats": {
      "total": 37,
      "additions": 19,
      "deletions": 18
    },
    "files": [
      {
        "sha": "bc69df44f4778e13446e040f866797bbb96d7120",
        "filename": "src/util/syscall_sandbox.cpp",
        "status": "modified",
        "additions": 19,
        "deletions": 18,
        "changes": 37,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faf13e272cad44917c4e5516172617fe8d68c00a/src/util/syscall_sandbox.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faf13e272cad44917c4e5516172617fe8d68c00a/src/util/syscall_sandbox.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util/syscall_sandbox.cpp?ref=faf13e272cad44917c4e5516172617fe8d68c00a",
        "patch": "@@ -169,6 +169,10 @@ const std::map<uint32_t, std::string> LINUX_SYSCALLS{\n     {__NR_ftruncate, \"ftruncate\"},\n     {__NR_futex, \"futex\"},\n     {__NR_futimesat, \"futimesat\"},\n+    {__NR_get_kernel_syms, \"get_kernel_syms\"},\n+    {__NR_get_mempolicy, \"get_mempolicy\"},\n+    {__NR_get_robust_list, \"get_robust_list\"},\n+    {__NR_get_thread_area, \"get_thread_area\"},\n     {__NR_getcpu, \"getcpu\"},\n     {__NR_getcwd, \"getcwd\"},\n     {__NR_getdents, \"getdents\"},\n@@ -178,8 +182,6 @@ const std::map<uint32_t, std::string> LINUX_SYSCALLS{\n     {__NR_getgid, \"getgid\"},\n     {__NR_getgroups, \"getgroups\"},\n     {__NR_getitimer, \"getitimer\"},\n-    {__NR_get_kernel_syms, \"get_kernel_syms\"},\n-    {__NR_get_mempolicy, \"get_mempolicy\"},\n     {__NR_getpeername, \"getpeername\"},\n     {__NR_getpgid, \"getpgid\"},\n     {__NR_getpgrp, \"getpgrp\"},\n@@ -191,12 +193,10 @@ const std::map<uint32_t, std::string> LINUX_SYSCALLS{\n     {__NR_getresgid, \"getresgid\"},\n     {__NR_getresuid, \"getresuid\"},\n     {__NR_getrlimit, \"getrlimit\"},\n-    {__NR_get_robust_list, \"get_robust_list\"},\n     {__NR_getrusage, \"getrusage\"},\n     {__NR_getsid, \"getsid\"},\n     {__NR_getsockname, \"getsockname\"},\n     {__NR_getsockopt, \"getsockopt\"},\n-    {__NR_get_thread_area, \"get_thread_area\"},\n     {__NR_gettid, \"gettid\"},\n     {__NR_gettimeofday, \"gettimeofday\"},\n     {__NR_getuid, \"getuid\"},\n@@ -207,15 +207,15 @@ const std::map<uint32_t, std::string> LINUX_SYSCALLS{\n     {__NR_inotify_init1, \"inotify_init1\"},\n     {__NR_inotify_rm_watch, \"inotify_rm_watch\"},\n     {__NR_io_cancel, \"io_cancel\"},\n-    {__NR_ioctl, \"ioctl\"},\n     {__NR_io_destroy, \"io_destroy\"},\n     {__NR_io_getevents, \"io_getevents\"},\n+    {__NR_io_setup, \"io_setup\"},\n+    {__NR_io_submit, \"io_submit\"},\n+    {__NR_ioctl, \"ioctl\"},\n     {__NR_ioperm, \"ioperm\"},\n     {__NR_iopl, \"iopl\"},\n     {__NR_ioprio_get, \"ioprio_get\"},\n     {__NR_ioprio_set, \"ioprio_set\"},\n-    {__NR_io_setup, \"io_setup\"},\n-    {__NR_io_submit, \"io_submit\"},\n     {__NR_kcmp, \"kcmp\"},\n     {__NR_kexec_file_load, \"kexec_file_load\"},\n     {__NR_kexec_load, \"kexec_load\"},\n@@ -271,8 +271,8 @@ const std::map<uint32_t, std::string> LINUX_SYSCALLS{\n     {__NR_newfstatat, \"newfstatat\"},\n     {__NR_nfsservctl, \"nfsservctl\"},\n     {__NR_open, \"open\"},\n-    {__NR_openat, \"openat\"},\n     {__NR_open_by_handle_at, \"open_by_handle_at\"},\n+    {__NR_openat, \"openat\"},\n     {__NR_pause, \"pause\"},\n     {__NR_perf_event_open, \"perf_event_open\"},\n     {__NR_personality, \"personality\"},\n@@ -307,6 +307,7 @@ const std::map<uint32_t, std::string> LINUX_SYSCALLS{\n #ifdef __NR_pwritev2\n     {__NR_pwritev2, \"pwritev2\"},\n #endif\n+    {__NR__sysctl, \"_sysctl\"},\n     {__NR_query_module, \"query_module\"},\n     {__NR_quotactl, \"quotactl\"},\n     {__NR_read, \"read\"},\n@@ -334,11 +335,11 @@ const std::map<uint32_t, std::string> LINUX_SYSCALLS{\n     {__NR_rt_sigsuspend, \"rt_sigsuspend\"},\n     {__NR_rt_sigtimedwait, \"rt_sigtimedwait\"},\n     {__NR_rt_tgsigqueueinfo, \"rt_tgsigqueueinfo\"},\n+    {__NR_sched_get_priority_max, \"sched_get_priority_max\"},\n+    {__NR_sched_get_priority_min, \"sched_get_priority_min\"},\n     {__NR_sched_getaffinity, \"sched_getaffinity\"},\n     {__NR_sched_getattr, \"sched_getattr\"},\n     {__NR_sched_getparam, \"sched_getparam\"},\n-    {__NR_sched_get_priority_max, \"sched_get_priority_max\"},\n-    {__NR_sched_get_priority_min, \"sched_get_priority_min\"},\n     {__NR_sched_getscheduler, \"sched_getscheduler\"},\n     {__NR_sched_rr_get_interval, \"sched_rr_get_interval\"},\n     {__NR_sched_setaffinity, \"sched_setaffinity\"},\n@@ -357,14 +358,17 @@ const std::map<uint32_t, std::string> LINUX_SYSCALLS{\n     {__NR_sendmmsg, \"sendmmsg\"},\n     {__NR_sendmsg, \"sendmsg\"},\n     {__NR_sendto, \"sendto\"},\n+    {__NR_set_mempolicy, \"set_mempolicy\"},\n+    {__NR_set_robust_list, \"set_robust_list\"},\n+    {__NR_set_thread_area, \"set_thread_area\"},\n+    {__NR_set_tid_address, \"set_tid_address\"},\n     {__NR_setdomainname, \"setdomainname\"},\n     {__NR_setfsgid, \"setfsgid\"},\n     {__NR_setfsuid, \"setfsuid\"},\n     {__NR_setgid, \"setgid\"},\n     {__NR_setgroups, \"setgroups\"},\n     {__NR_sethostname, \"sethostname\"},\n     {__NR_setitimer, \"setitimer\"},\n-    {__NR_set_mempolicy, \"set_mempolicy\"},\n     {__NR_setns, \"setns\"},\n     {__NR_setpgid, \"setpgid\"},\n     {__NR_setpriority, \"setpriority\"},\n@@ -373,11 +377,8 @@ const std::map<uint32_t, std::string> LINUX_SYSCALLS{\n     {__NR_setresuid, \"setresuid\"},\n     {__NR_setreuid, \"setreuid\"},\n     {__NR_setrlimit, \"setrlimit\"},\n-    {__NR_set_robust_list, \"set_robust_list\"},\n     {__NR_setsid, \"setsid\"},\n     {__NR_setsockopt, \"setsockopt\"},\n-    {__NR_set_thread_area, \"set_thread_area\"},\n-    {__NR_set_tid_address, \"set_tid_address\"},\n     {__NR_settimeofday, \"settimeofday\"},\n     {__NR_setuid, \"setuid\"},\n     {__NR_setxattr, \"setxattr\"},\n@@ -402,7 +403,6 @@ const std::map<uint32_t, std::string> LINUX_SYSCALLS{\n     {__NR_sync, \"sync\"},\n     {__NR_sync_file_range, \"sync_file_range\"},\n     {__NR_syncfs, \"syncfs\"},\n-    {__NR__sysctl, \"_sysctl\"},\n     {__NR_sysfs, \"sysfs\"},\n     {__NR_sysinfo, \"sysinfo\"},\n     {__NR_syslog, \"syslog\"},\n@@ -411,12 +411,12 @@ const std::map<uint32_t, std::string> LINUX_SYSCALLS{\n     {__NR_time, \"time\"},\n     {__NR_timer_create, \"timer_create\"},\n     {__NR_timer_delete, \"timer_delete\"},\n-    {__NR_timerfd_create, \"timerfd_create\"},\n-    {__NR_timerfd_gettime, \"timerfd_gettime\"},\n-    {__NR_timerfd_settime, \"timerfd_settime\"},\n     {__NR_timer_getoverrun, \"timer_getoverrun\"},\n     {__NR_timer_gettime, \"timer_gettime\"},\n     {__NR_timer_settime, \"timer_settime\"},\n+    {__NR_timerfd_create, \"timerfd_create\"},\n+    {__NR_timerfd_gettime, \"timerfd_gettime\"},\n+    {__NR_timerfd_settime, \"timerfd_settime\"},\n     {__NR_times, \"times\"},\n     {__NR_tkill, \"tkill\"},\n     {__NR_truncate, \"truncate\"},\n@@ -650,6 +650,7 @@ class SeccompPolicyBuilder\n     {\n         allowed_syscalls.insert(__NR_clock_getres);  // find the resolution (precision) of the specified clock\n         allowed_syscalls.insert(__NR_clock_gettime); // retrieve the time of the specified clock\n+        allowed_syscalls.insert(__NR_gettimeofday);  // get timeval\n     }\n \n     void AllowGlobalProcessEnvironment()"
      }
    ]
  }
]