[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/233123072",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8344#issuecomment-233123072",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8344",
    "id": 233123072,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzMzEyMzA3Mg==",
    "user": {
      "login": "paveljanik",
      "id": 6848764,
      "node_id": "MDQ6VXNlcjY4NDg3NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6848764?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paveljanik",
      "html_url": "https://github.com/paveljanik",
      "followers_url": "https://api.github.com/users/paveljanik/followers",
      "following_url": "https://api.github.com/users/paveljanik/following{/other_user}",
      "gists_url": "https://api.github.com/users/paveljanik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paveljanik/subscriptions",
      "organizations_url": "https://api.github.com/users/paveljanik/orgs",
      "repos_url": "https://api.github.com/users/paveljanik/repos",
      "events_url": "https://api.github.com/users/paveljanik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paveljanik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-07-16T09:58:27Z",
    "updated_at": "2016-07-16T09:58:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "Travis fails with:\n\n```\nstderr:\n bitcoind: ../../src/main.cpp:3529: bool ContextualCheckBlock(const CBlock&, CValidationState&, CBlockIndex*): Assertion `pindexPrev' failed.\n```\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/233123072/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/233123113",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8344#issuecomment-233123113",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8344",
    "id": 233123113,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzMzEyMzExMw==",
    "user": {
      "login": "NicolasDorier",
      "id": 3020646,
      "node_id": "MDQ6VXNlcjMwMjA2NDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3020646?u=256d78207f88d303d61b62060a309657276cf6cb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NicolasDorier",
      "html_url": "https://github.com/NicolasDorier",
      "followers_url": "https://api.github.com/users/NicolasDorier/followers",
      "following_url": "https://api.github.com/users/NicolasDorier/following{/other_user}",
      "gists_url": "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NicolasDorier/subscriptions",
      "organizations_url": "https://api.github.com/users/NicolasDorier/orgs",
      "repos_url": "https://api.github.com/users/NicolasDorier/repos",
      "events_url": "https://api.github.com/users/NicolasDorier/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NicolasDorier/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-07-16T09:59:40Z",
    "updated_at": "2016-07-16T09:59:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "yes, it seems that prevIndex can be NULL, hopefully MTP can't be activated at height 0.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/233123113/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/233123872",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8344#issuecomment-233123872",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8344",
    "id": 233123872,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzMzEyMzg3Mg==",
    "user": {
      "login": "NicolasDorier",
      "id": 3020646,
      "node_id": "MDQ6VXNlcjMwMjA2NDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3020646?u=256d78207f88d303d61b62060a309657276cf6cb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NicolasDorier",
      "html_url": "https://github.com/NicolasDorier",
      "followers_url": "https://api.github.com/users/NicolasDorier/followers",
      "following_url": "https://api.github.com/users/NicolasDorier/following{/other_user}",
      "gists_url": "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NicolasDorier/subscriptions",
      "organizations_url": "https://api.github.com/users/NicolasDorier/orgs",
      "repos_url": "https://api.github.com/users/NicolasDorier/repos",
      "events_url": "https://api.github.com/users/NicolasDorier/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NicolasDorier/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-07-16T10:23:16Z",
    "updated_at": "2016-07-16T10:35:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "@paveljanik fixed the nit and the travis now should pass. I added https://github.com/bitcoin/bitcoin/pull/8344/files#diff-7ec3c68a81efff79b6ca22ac1f1eabbaR3540 .\n\nEven if `(nLockTimeFlags & LOCKTIME_MEDIAN_TIME_PAST) && !pindexPrev` is impossible right now, because MTP can't possibly be activated at block height = 0.\nHowever, in consensus lib, the user will be able to verify a block of height 0 with the MTP rule activated, so better we don't crash in this case.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/233123872/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/233132116",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8344#issuecomment-233132116",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8344",
    "id": 233132116,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzMzEzMjExNg==",
    "user": {
      "login": "jtimon",
      "id": 1008458,
      "node_id": "MDQ6VXNlcjEwMDg0NTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1008458?u=636a89c913ac407f52bb8d57c4fff384b98f421f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtimon",
      "html_url": "https://github.com/jtimon",
      "followers_url": "https://api.github.com/users/jtimon/followers",
      "following_url": "https://api.github.com/users/jtimon/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtimon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtimon/subscriptions",
      "organizations_url": "https://api.github.com/users/jtimon/orgs",
      "repos_url": "https://api.github.com/users/jtimon/repos",
      "events_url": "https://api.github.com/users/jtimon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtimon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-07-16T14:10:28Z",
    "updated_at": "2016-07-16T14:10:28Z",
    "author_association": "MEMBER",
    "body": "Just created #8345 related to this one. I guess with this the interface for Consensus::GetFlags() becomes cleaner, but I don't think this is strictly necessary or a priority for consensus encapsulation.\nConcept ACK.\n\nRegarding not calculating the flags within libconsensus, I strongly disagree. I don't think users of libconsensus should be expected to reimplement everything in https://github.com/bitcoin/bitcoin/pull/8345/files#diff-d6954440f0346f8e42dcd669dd4aeafaR173 correctly. I want to expose GetFlags in the C API so users can just call that before calling VerifyTx and/or VerifyScript. \nMy thought was that VerifyBlock would call GetFlags internally, but I guess it can take a flags parameter instead.\nI also don't see that as a solution to avoid having to create a C API-compatible for CBlockIndex, since you will still need to have it for the pow checks in VerifyHeader() and VerifyBlock().\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/233132116/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/233132750",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8344#issuecomment-233132750",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8344",
    "id": 233132750,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzMzEzMjc1MA==",
    "user": {
      "login": "NicolasDorier",
      "id": 3020646,
      "node_id": "MDQ6VXNlcjMwMjA2NDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3020646?u=256d78207f88d303d61b62060a309657276cf6cb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NicolasDorier",
      "html_url": "https://github.com/NicolasDorier",
      "followers_url": "https://api.github.com/users/NicolasDorier/followers",
      "following_url": "https://api.github.com/users/NicolasDorier/following{/other_user}",
      "gists_url": "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NicolasDorier/subscriptions",
      "organizations_url": "https://api.github.com/users/NicolasDorier/orgs",
      "repos_url": "https://api.github.com/users/NicolasDorier/repos",
      "events_url": "https://api.github.com/users/NicolasDorier/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NicolasDorier/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-07-16T14:25:02Z",
    "updated_at": "2016-07-16T14:25:02Z",
    "author_association": "CONTRIBUTOR",
    "body": "Related to your PR, this commit only allows you to call GetFlags without passing a CBlock to it.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/233132750/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/233140380",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8344#issuecomment-233140380",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8344",
    "id": 233140380,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzMzE0MDM4MA==",
    "user": {
      "login": "jtimon",
      "id": 1008458,
      "node_id": "MDQ6VXNlcjEwMDg0NTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1008458?u=636a89c913ac407f52bb8d57c4fff384b98f421f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtimon",
      "html_url": "https://github.com/jtimon",
      "followers_url": "https://api.github.com/users/jtimon/followers",
      "following_url": "https://api.github.com/users/jtimon/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtimon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtimon/subscriptions",
      "organizations_url": "https://api.github.com/users/jtimon/orgs",
      "repos_url": "https://api.github.com/users/jtimon/repos",
      "events_url": "https://api.github.com/users/jtimon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtimon/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-07-16T17:07:51Z",
    "updated_at": "2016-07-16T17:07:51Z",
    "author_association": "MEMBER",
    "body": "Yes, another option would be to pass an nBlockVersion to GetFlags like in https://github.com/bitcoin/bitcoin/pull/8345/commits/8c893cfcb949ffd03d8951f8ae916e7a0a2293ed#diff-7ec3c68a81efff79b6ca22ac1f1eabbaR3450 I guess your version is cleaner because it has one parameter less but seems more disruptive. Certainly passing the whole CBlock is unnecessary.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/233140380/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/234243835",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8344#issuecomment-234243835",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8344",
    "id": 234243835,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzNDI0MzgzNQ==",
    "user": {
      "login": "NicolasDorier",
      "id": 3020646,
      "node_id": "MDQ6VXNlcjMwMjA2NDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3020646?u=256d78207f88d303d61b62060a309657276cf6cb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NicolasDorier",
      "html_url": "https://github.com/NicolasDorier",
      "followers_url": "https://api.github.com/users/NicolasDorier/followers",
      "following_url": "https://api.github.com/users/NicolasDorier/following{/other_user}",
      "gists_url": "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NicolasDorier/subscriptions",
      "organizations_url": "https://api.github.com/users/NicolasDorier/orgs",
      "repos_url": "https://api.github.com/users/NicolasDorier/repos",
      "events_url": "https://api.github.com/users/NicolasDorier/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NicolasDorier/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-07-21T12:51:57Z",
    "updated_at": "2016-07-21T12:51:57Z",
    "author_association": "CONTRIBUTOR",
    "body": "@gmaxwell seems to be working on removing ISM completely, making this PR useless.\n https://botbot.me/freenode/bitcoin-core-dev/2016-07-17/?msg=69776851&page=1\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/234243835/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/71063958",
    "pull_request_review_id": null,
    "id": 71063958,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcxMDYzOTU4",
    "diff_hunk": "@@ -2293,10 +2293,11 @@ static int64_t nTimeIndex = 0;\n static int64_t nTimeCallbacks = 0;\n static int64_t nTimeTotal = 0;\n \n-bool ConnectBlock(const CBlock& block, CValidationState& state, CBlockIndex* pindex,\n+bool ConnectBlock(const CBlock& block, CValidationState& state, CBlockIndex* const pindex,\n                   CCoinsViewCache& view, const CChainParams& chainparams, bool fJustCheck)\n {\n     AssertLockHeld(cs_main);\n+    assert(pindex->nVersion == block.nVersion);",
    "path": "src/main.cpp",
    "position": 9,
    "original_position": 9,
    "commit_id": "01d903d5643239b740cb38c5eda7c70cc420331a",
    "original_commit_id": "f59137427a8423e747a71c37332b88eed3e3c5d0",
    "user": {
      "login": "paveljanik",
      "id": 6848764,
      "node_id": "MDQ6VXNlcjY4NDg3NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6848764?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paveljanik",
      "html_url": "https://github.com/paveljanik",
      "followers_url": "https://api.github.com/users/paveljanik/followers",
      "following_url": "https://api.github.com/users/paveljanik/following{/other_user}",
      "gists_url": "https://api.github.com/users/paveljanik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paveljanik/subscriptions",
      "organizations_url": "https://api.github.com/users/paveljanik/orgs",
      "repos_url": "https://api.github.com/users/paveljanik/repos",
      "events_url": "https://api.github.com/users/paveljanik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paveljanik/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Does this apply every time?\n",
    "created_at": "2016-07-16T09:49:22Z",
    "updated_at": "2016-07-16T10:39:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8344#discussion_r71063958",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8344",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/71063958"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8344#discussion_r71063958"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8344"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/71063958/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2300,
    "original_line": 2300,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/71063972",
    "pull_request_review_id": null,
    "id": 71063972,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcxMDYzOTcy",
    "diff_hunk": "@@ -3522,9 +3523,12 @@ bool ContextualCheckBlockHeader(const CBlockHeader& block, CValidationState& sta\n     return true;\n }\n \n-bool ContextualCheckBlock(const CBlock& block, CValidationState& state, CBlockIndex * const pindexPrev)\n+bool ContextualCheckBlock(const CBlock& block, CValidationState& state, CBlockIndex * const pindex)\n {\n-    const int nHeight = pindexPrev == NULL ? 0 : pindexPrev->nHeight + 1;\n+    CBlockIndex * const pindexPrev = pindex->pprev;",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 41,
    "commit_id": "01d903d5643239b740cb38c5eda7c70cc420331a",
    "original_commit_id": "f59137427a8423e747a71c37332b88eed3e3c5d0",
    "user": {
      "login": "paveljanik",
      "id": 6848764,
      "node_id": "MDQ6VXNlcjY4NDg3NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6848764?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paveljanik",
      "html_url": "https://github.com/paveljanik",
      "followers_url": "https://api.github.com/users/paveljanik/followers",
      "following_url": "https://api.github.com/users/paveljanik/following{/other_user}",
      "gists_url": "https://api.github.com/users/paveljanik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paveljanik/subscriptions",
      "organizations_url": "https://api.github.com/users/paveljanik/orgs",
      "repos_url": "https://api.github.com/users/paveljanik/repos",
      "events_url": "https://api.github.com/users/paveljanik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paveljanik/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "assert(pindex) first?\n",
    "created_at": "2016-07-16T09:50:21Z",
    "updated_at": "2016-07-16T10:39:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8344#discussion_r71063972",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8344",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/71063972"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8344#discussion_r71063972"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8344"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/71063972/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3528,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/71063977",
    "pull_request_review_id": null,
    "id": 71063977,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcxMDYzOTc3",
    "diff_hunk": "@@ -3544,9 +3548,9 @@ bool ContextualCheckBlock(const CBlock& block, CValidationState& state, CBlockIn\n         }\n     }\n \n-    // Enforce block.nVersion=2 rule that the coinbase starts with serialized block height\n+    // Enforce pindex->nVersion =2 rule that the coinbase starts with serialized block height",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 53,
    "commit_id": "01d903d5643239b740cb38c5eda7c70cc420331a",
    "original_commit_id": "f59137427a8423e747a71c37332b88eed3e3c5d0",
    "user": {
      "login": "paveljanik",
      "id": 6848764,
      "node_id": "MDQ6VXNlcjY4NDg3NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6848764?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paveljanik",
      "html_url": "https://github.com/paveljanik",
      "followers_url": "https://api.github.com/users/paveljanik/followers",
      "following_url": "https://api.github.com/users/paveljanik/following{/other_user}",
      "gists_url": "https://api.github.com/users/paveljanik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paveljanik/subscriptions",
      "organizations_url": "https://api.github.com/users/paveljanik/orgs",
      "repos_url": "https://api.github.com/users/paveljanik/repos",
      "events_url": "https://api.github.com/users/paveljanik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paveljanik/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "super minor nit: added SPC before `=2`\n",
    "created_at": "2016-07-16T09:50:49Z",
    "updated_at": "2016-07-16T10:39:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8344#discussion_r71063977",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8344",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/71063977"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8344#discussion_r71063977"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8344"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/71063977/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3551,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/71064028",
    "pull_request_review_id": null,
    "id": 71064028,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcxMDY0MDI4",
    "diff_hunk": "@@ -450,7 +450,7 @@ bool ContextualCheckBlock(const CBlock& block, CValidationState& state, CBlockIn\n /** Apply the effects of this block (with given index) on the UTXO set represented by coins.\n  *  Validity checks that depend on the UTXO set are also done; ConnectBlock()\n  *  can fail if those validity checks fail (among other reasons). */\n-bool ConnectBlock(const CBlock& block, CValidationState& state, CBlockIndex* pindex, CCoinsViewCache& coins,\n+bool ConnectBlock(const CBlock& block, CValidationState& state, CBlockIndex* const pindex, CCoinsViewCache& coins,",
    "path": "src/main.h",
    "position": 11,
    "original_position": 5,
    "commit_id": "01d903d5643239b740cb38c5eda7c70cc420331a",
    "original_commit_id": "f59137427a8423e747a71c37332b88eed3e3c5d0",
    "user": {
      "login": "paveljanik",
      "id": 6848764,
      "node_id": "MDQ6VXNlcjY4NDg3NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6848764?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paveljanik",
      "html_url": "https://github.com/paveljanik",
      "followers_url": "https://api.github.com/users/paveljanik/followers",
      "following_url": "https://api.github.com/users/paveljanik/following{/other_user}",
      "gists_url": "https://api.github.com/users/paveljanik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paveljanik/subscriptions",
      "organizations_url": "https://api.github.com/users/paveljanik/orgs",
      "repos_url": "https://api.github.com/users/paveljanik/repos",
      "events_url": "https://api.github.com/users/paveljanik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paveljanik/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Hmm, compare the prototype of `ContextualCheckBlock` and `ConnectBlock`: `pindexPrev` vs. `pindex`. I think this calls for oversights.\n",
    "created_at": "2016-07-16T09:57:05Z",
    "updated_at": "2016-07-16T10:39:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8344#discussion_r71064028",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8344",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/71064028"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8344#discussion_r71064028"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8344"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/71064028/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 453,
    "original_line": 453,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/71064134",
    "pull_request_review_id": null,
    "id": 71064134,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDcxMDY0MTM0",
    "diff_hunk": "@@ -2293,10 +2293,11 @@ static int64_t nTimeIndex = 0;\n static int64_t nTimeCallbacks = 0;\n static int64_t nTimeTotal = 0;\n \n-bool ConnectBlock(const CBlock& block, CValidationState& state, CBlockIndex* pindex,\n+bool ConnectBlock(const CBlock& block, CValidationState& state, CBlockIndex* const pindex,\n                   CCoinsViewCache& view, const CChainParams& chainparams, bool fJustCheck)\n {\n     AssertLockHeld(cs_main);\n+    assert(pindex->nVersion == block.nVersion);",
    "path": "src/main.cpp",
    "position": 9,
    "original_position": 9,
    "commit_id": "01d903d5643239b740cb38c5eda7c70cc420331a",
    "original_commit_id": "f59137427a8423e747a71c37332b88eed3e3c5d0",
    "user": {
      "login": "NicolasDorier",
      "id": 3020646,
      "node_id": "MDQ6VXNlcjMwMjA2NDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3020646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NicolasDorier",
      "html_url": "https://github.com/NicolasDorier",
      "followers_url": "https://api.github.com/users/NicolasDorier/followers",
      "following_url": "https://api.github.com/users/NicolasDorier/following{/other_user}",
      "gists_url": "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NicolasDorier/subscriptions",
      "organizations_url": "https://api.github.com/users/NicolasDorier/orgs",
      "repos_url": "https://api.github.com/users/NicolasDorier/repos",
      "events_url": "https://api.github.com/users/NicolasDorier/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NicolasDorier/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I added the assert, because if that's not the case, then my change is not without side effect. I reviewed the caller, and it seems that pindex always point to block's CBlockIndex.\n",
    "created_at": "2016-07-16T10:08:31Z",
    "updated_at": "2016-07-16T10:39:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8344#discussion_r71064134",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8344",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/71064134"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8344#discussion_r71064134"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8344"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/71064134/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2300,
    "original_line": 2300,
    "side": "RIGHT"
  }
]