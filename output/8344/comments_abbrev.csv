paveljanik,2016-07-16T09:58:27Z,"Travis fails with:\n\n```\nstderr:\n bitcoind: ../../src/main.cpp:3529: bool ContextualCheckBlock(const CBlock&, CValidationState&, CBlockIndex*): Assertion `pindexPrev' failed.\n```\n",https://github.com/bitcoin/bitcoin/pull/8344#issuecomment-233123072,233123072,
NicolasDorier,2016-07-16T09:59:40Z,"yes, it seems that prevIndex can be NULL, hopefully MTP can't be activated at height 0.\n",https://github.com/bitcoin/bitcoin/pull/8344#issuecomment-233123113,233123113,
NicolasDorier,2016-07-16T10:23:16Z,"@paveljanik fixed the nit and the travis now should pass. I added https://github.com/bitcoin/bitcoin/pull/8344/files#diff-7ec3c68a81efff79b6ca22ac1f1eabbaR3540 .\n\nEven if `(nLockTimeFlags & LOCKTIME_MEDIAN_TIME_PAST) && !pindexPrev` is impossible right now, because MTP can't possibly be activated at block height = 0.\nHowever, in consensus lib, the user will be able to verify a block of height 0",https://github.com/bitcoin/bitcoin/pull/8344#issuecomment-233123872,233123872,
jtimon,2016-07-16T14:10:28Z,"Just created #8345 related to this one. I guess with this the interface for Consensus::GetFlags() becomes cleaner, but I don't think this is strictly necessary or a priority for consensus encapsulation.\nConcept ACK.\n\nRegarding not calculating the flags within libconsensus, I strongly disagree. I don't think users of libconsensus should be expected to reimplement everything in https://github.com",https://github.com/bitcoin/bitcoin/pull/8344#issuecomment-233132116,233132116,
NicolasDorier,2016-07-16T14:25:02Z,"Related to your PR, this commit only allows you to call GetFlags without passing a CBlock to it.\n",https://github.com/bitcoin/bitcoin/pull/8344#issuecomment-233132750,233132750,
jtimon,2016-07-16T17:07:51Z,"Yes, another option would be to pass an nBlockVersion to GetFlags like in https://github.com/bitcoin/bitcoin/pull/8345/commits/8c893cfcb949ffd03d8951f8ae916e7a0a2293ed#diff-7ec3c68a81efff79b6ca22ac1f1eabbaR3450 I guess your version is cleaner because it has one parameter less but seems more disruptive. Certainly passing the whole CBlock is unnecessary.\n",https://github.com/bitcoin/bitcoin/pull/8344#issuecomment-233140380,233140380,
NicolasDorier,2016-07-21T12:51:57Z,"@gmaxwell seems to be working on removing ISM completely, making this PR useless.\n https://botbot.me/freenode/bitcoin-core-dev/2016-07-17/?msg=69776851&page=1\n",https://github.com/bitcoin/bitcoin/pull/8344#issuecomment-234243835,234243835,
paveljanik,2016-07-16T09:49:22Z,Does this apply every time?\n,https://github.com/bitcoin/bitcoin/pull/8344#discussion_r71063958,71063958,src/main.cpp
paveljanik,2016-07-16T09:50:21Z,assert(pindex) first?\n,https://github.com/bitcoin/bitcoin/pull/8344#discussion_r71063972,71063972,src/main.cpp
paveljanik,2016-07-16T09:50:49Z,super minor nit: added SPC before `=2`\n,https://github.com/bitcoin/bitcoin/pull/8344#discussion_r71063977,71063977,src/main.cpp
paveljanik,2016-07-16T09:57:05Z,"Hmm, compare the prototype of `ContextualCheckBlock` and `ConnectBlock`: `pindexPrev` vs. `pindex`. I think this calls for oversights.\n",https://github.com/bitcoin/bitcoin/pull/8344#discussion_r71064028,71064028,src/main.h
NicolasDorier,2016-07-16T10:08:31Z,"I added the assert, because if that's not the case, then my change is not without side effect. I reviewed the caller, and it seems that pindex always point to block's CBlockIndex.\n",https://github.com/bitcoin/bitcoin/pull/8344#discussion_r71064134,71064134,src/main.cpp
