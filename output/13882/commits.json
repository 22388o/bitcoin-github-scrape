[
  {
    "sha": "fa860c4fcc7c6364c82e9e843960ca912462a404",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYTg2MGM0ZmNjN2M2MzY0YzgyZTllODQzOTYwY2E5MTI0NjJhNDA0",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2018-08-05T15:31:59Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2018-08-05T15:18:09Z"
      },
      "message": "txindex: Stop thread before calling base destructor",
      "tree": {
        "sha": "f2a6340a111ac221b649067c48e1638d029de21c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f2a6340a111ac221b649067c48e1638d029de21c"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa860c4fcc7c6364c82e9e843960ca912462a404",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGcBAABCgAGBQJbZxUxAAoJEM4rdWl+aaVIRCYMAIDnwZq3CkLvxy2lfkqigmXt\nzPr+AVzBgYqpmc2NeDaIri5Zr9vhgS50hgp9s/8nGmu7vGb9M7A+IPGYKSTRzxnD\nwwGzSW6Doylulhpu4FUtLXEF45M3J9M4IpqPFK+HecgE4BPz7KPwSZXbNZiSoAHI\nZrFz7lt9KuKJouQAYCde749DR3Af2AKWD7uDGoVUMq7QqU6p4apoWBAgzCPC8Tlp\nWQEa0BhwMkqMORTENdVyviDWoN9u9S4HPRfdwebwIZeOgZAWzY1gEjMFBkZInXNe\n74TsTWiSDDQw97m5ETpWxJK7S015rdUrATSwIuWsBfAOz/Uh0uDwF9gO+g6nCb5i\nwpyCZ9IFrQtZ2DdWl1zHdbVa2bUUtaKR9TFpn+IypAt7hL2w3v0dABv6gNnUtXis\ntdsUfebYWynCHx1J+OqPX9DgSOWWKhrQdPOQUP24sS9Y2Ef94lILroNBu7iCpsn8\nnUESgiAag4+PWJtfXzrHKwJwv87h7/ZjBqOOBCoZYw==\n=SWva\n-----END PGP SIGNATURE-----",
        "payload": "tree f2a6340a111ac221b649067c48e1638d029de21c\nparent 1ef57a96b8b7255bd1f1ea0583846f18305419bf\nauthor MarcoFalke <falke.marco@gmail.com> 1533483119 -0400\ncommitter MarcoFalke <falke.marco@gmail.com> 1533482289 -0400\n\ntxindex: Stop thread before calling base destructor\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa860c4fcc7c6364c82e9e843960ca912462a404",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fa860c4fcc7c6364c82e9e843960ca912462a404",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa860c4fcc7c6364c82e9e843960ca912462a404/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "1ef57a96b8b7255bd1f1ea0583846f18305419bf",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1ef57a96b8b7255bd1f1ea0583846f18305419bf",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/1ef57a96b8b7255bd1f1ea0583846f18305419bf"
      }
    ],
    "stats": {
      "total": 16,
      "additions": 8,
      "deletions": 8
    },
    "files": [
      {
        "sha": "3fba164f71d7062eefc96bf0532444951d6c66c9",
        "filename": "src/index/base.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 2,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa860c4fcc7c6364c82e9e843960ca912462a404/src/index/base.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa860c4fcc7c6364c82e9e843960ca912462a404/src/index/base.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/index/base.cpp?ref=fa860c4fcc7c6364c82e9e843960ca912462a404",
        "patch": "@@ -48,8 +48,6 @@ bool BaseIndex::DB::WriteBestBlock(const CBlockLocator& locator)\n \n BaseIndex::~BaseIndex()\n {\n-    Interrupt();\n-    Stop();\n }\n \n bool BaseIndex::Init()"
      },
      {
        "sha": "470a207343265c48e40d72a8baea9d81373ab554",
        "filename": "src/index/base.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa860c4fcc7c6364c82e9e843960ca912462a404/src/index/base.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa860c4fcc7c6364c82e9e843960ca912462a404/src/index/base.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/index/base.h?ref=fa860c4fcc7c6364c82e9e843960ca912462a404",
        "patch": "@@ -75,7 +75,7 @@ class BaseIndex : public CValidationInterface\n     virtual const char* GetName() const = 0;\n \n public:\n-    /// Destructor interrupts sync thread if running and blocks until it exits.\n+    /// Derived destructor must interrupt sync thread if running and block until it exits.\n     virtual ~BaseIndex();\n \n     /// Blocks the current thread until the index is caught up to the current"
      },
      {
        "sha": "cfb0c90c6f692253aba81affb8d2684af7f47cd1",
        "filename": "src/index/txindex.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 1,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa860c4fcc7c6364c82e9e843960ca912462a404/src/index/txindex.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa860c4fcc7c6364c82e9e843960ca912462a404/src/index/txindex.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/index/txindex.cpp?ref=fa860c4fcc7c6364c82e9e843960ca912462a404",
        "patch": "@@ -227,7 +227,11 @@ TxIndex::TxIndex(size_t n_cache_size, bool f_memory, bool f_wipe)\n     : m_db(MakeUnique<TxIndex::DB>(n_cache_size, f_memory, f_wipe))\n {}\n \n-TxIndex::~TxIndex() {}\n+TxIndex::~TxIndex()\n+{\n+    Interrupt();\n+    Stop();\n+}\n \n bool TxIndex::Init()\n {"
      },
      {
        "sha": "63a17795f47e770ec274467b11a75a8a00e80ee6",
        "filename": "src/index/txindex.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa860c4fcc7c6364c82e9e843960ca912462a404/src/index/txindex.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa860c4fcc7c6364c82e9e843960ca912462a404/src/index/txindex.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/index/txindex.h?ref=fa860c4fcc7c6364c82e9e843960ca912462a404",
        "patch": "@@ -36,7 +36,7 @@ class TxIndex final : public BaseIndex\n     /// Constructs the index, which becomes available to be queried.\n     explicit TxIndex(size_t n_cache_size, bool f_memory = false, bool f_wipe = false);\n \n-    // Destructor is declared because this class contains a unique_ptr to an incomplete type.\n+    /// Destructor interrupts sync thread if running and blocks until it exits.\n     virtual ~TxIndex() override;\n \n     /// Look up a transaction by hash."
      },
      {
        "sha": "3cd231df2bb5fa55ac1dce16cfe824fe2c3ac506",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 3,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa860c4fcc7c6364c82e9e843960ca912462a404/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa860c4fcc7c6364c82e9e843960ca912462a404/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=fa860c4fcc7c6364c82e9e843960ca912462a404",
        "patch": "@@ -211,9 +211,7 @@ void Shutdown()\n     if (g_connman) g_connman->Stop();\n     peerLogic.reset();\n     g_connman.reset();\n-    if (g_txindex) {\n-        g_txindex.reset();\n-    }\n+    g_txindex.reset();\n \n     StopTorControl();\n "
      }
    ]
  }
]