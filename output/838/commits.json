[
  {
    "sha": "1df182ff886817cc8b85990aff9b0e1102c97be7",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxZGYxODJmZjg4NjgxN2NjOGI4NTk5MGFmZjliMGUxMTAyYzk3YmU3",
    "commit": {
      "author": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2012-02-15T12:14:16Z"
      },
      "committer": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2012-02-15T12:14:16Z"
      },
      "message": "(trivial) regularize coding style",
      "tree": {
        "sha": "9dcd4a10c27c7d71489fec64580bc8183eac29f0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9dcd4a10c27c7d71489fec64580bc8183eac29f0"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1df182ff886817cc8b85990aff9b0e1102c97be7",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1df182ff886817cc8b85990aff9b0e1102c97be7",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/1df182ff886817cc8b85990aff9b0e1102c97be7",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1df182ff886817cc8b85990aff9b0e1102c97be7/comments",
    "author": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "15b87b2ec40bdcbc7e8173c79b829fc0f550909e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/15b87b2ec40bdcbc7e8173c79b829fc0f550909e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/15b87b2ec40bdcbc7e8173c79b829fc0f550909e"
      }
    ],
    "stats": {
      "total": 16,
      "additions": 10,
      "deletions": 6
    },
    "files": [
      {
        "sha": "754e0bdcb276502dccca55cc00b309915131a3a3",
        "filename": "src/qt/qrcodedialog.cpp",
        "status": "modified",
        "additions": 10,
        "deletions": 6,
        "changes": 16,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1df182ff886817cc8b85990aff9b0e1102c97be7/src/qt/qrcodedialog.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1df182ff886817cc8b85990aff9b0e1102c97be7/src/qt/qrcodedialog.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/qrcodedialog.cpp?ref=1df182ff886817cc8b85990aff9b0e1102c97be7",
        "patch": "@@ -34,8 +34,8 @@ QRCodeDialog::~QRCodeDialog()\n     delete ui;\n }\n \n-void QRCodeDialog::genCode() {\n-\n+void QRCodeDialog::genCode()\n+{\n     QString uri = getURI();\n     //qDebug() << \"Encoding:\" << uri.toUtf8().constData();\n     QRcode *code = QRcode_encodeString(uri.toUtf8().constData(), 0, QR_ECLEVEL_L, QR_MODE_8, 1);\n@@ -52,7 +52,8 @@ void QRCodeDialog::genCode() {\n     ui->lblQRCode->setPixmap(QPixmap::fromImage(myImage).scaled(300, 300));\n }\n \n-QString QRCodeDialog::getURI() {\n+QString QRCodeDialog::getURI()\n+{\n     QString ret = QString(\"bitcoin:%1\").arg(address);\n \n     int paramCount = 0;\n@@ -80,15 +81,18 @@ QString QRCodeDialog::getURI() {\n     return ret;\n }\n \n-void QRCodeDialog::on_lnReqAmount_textChanged(const QString &) {\n+void QRCodeDialog::on_lnReqAmount_textChanged(const QString &)\n+{\n     genCode();\n }\n \n-void QRCodeDialog::on_lnLabel_textChanged(const QString &) {\n+void QRCodeDialog::on_lnLabel_textChanged(const QString &)\n+{\n     genCode();\n }\n \n-void QRCodeDialog::on_lnMessage_textChanged(const QString &) {\n+void QRCodeDialog::on_lnMessage_textChanged(const QString &)\n+{\n     genCode();\n }\n "
      }
    ]
  },
  {
    "sha": "303a47c09592c33aa84e2264e69643ef2570fa76",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozMDNhNDdjMDk1OTJjMzNhYTg0ZTIyNjRlNjk2NDNlZjI1NzBmYTc2",
    "commit": {
      "author": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2012-02-15T13:47:08Z"
      },
      "committer": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2012-02-15T16:22:00Z"
      },
      "message": "fix default suffixes in save dialog in GNOME, make it more clear that PNG is used (solves #833)",
      "tree": {
        "sha": "c24139670ca4af1fda9355dc7239cce4a0dfa852",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c24139670ca4af1fda9355dc7239cce4a0dfa852"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/303a47c09592c33aa84e2264e69643ef2570fa76",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/303a47c09592c33aa84e2264e69643ef2570fa76",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/303a47c09592c33aa84e2264e69643ef2570fa76",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/303a47c09592c33aa84e2264e69643ef2570fa76/comments",
    "author": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "1df182ff886817cc8b85990aff9b0e1102c97be7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1df182ff886817cc8b85990aff9b0e1102c97be7",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/1df182ff886817cc8b85990aff9b0e1102c97be7"
      }
    ],
    "stats": {
      "total": 81,
      "additions": 70,
      "deletions": 11
    },
    "files": [
      {
        "sha": "76aa87b134f820b7003b464c0910a4f511aeff87",
        "filename": "src/qt/addressbookpage.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 4,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/303a47c09592c33aa84e2264e69643ef2570fa76/src/qt/addressbookpage.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/303a47c09592c33aa84e2264e69643ef2570fa76/src/qt/addressbookpage.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/addressbookpage.cpp?ref=303a47c09592c33aa84e2264e69643ef2570fa76",
        "patch": "@@ -9,7 +9,6 @@\n \n #include <QSortFilterProxyModel>\n #include <QClipboard>\n-#include <QFileDialog>\n #include <QMessageBox>\n #include <QMenu>\n \n@@ -277,10 +276,9 @@ void AddressBookPage::done(int retval)\n void AddressBookPage::exportClicked()\n {\n     // CSV is currently the only supported format\n-    QString filename = QFileDialog::getSaveFileName(\n+    QString filename = GUIUtil::getSaveFileName(\n             this,\n-            tr(\"Export Address Book Data\"),\n-            QDir::currentPath(),\n+            tr(\"Export Address Book Data\"), QString(),\n             tr(\"Comma separated file (*.csv)\"));\n \n     if (filename.isNull()) return;"
      },
      {
        "sha": "b8e74203b9520396e05017eec006d6e8c3785568",
        "filename": "src/qt/guiutil.cpp",
        "status": "modified",
        "additions": 49,
        "deletions": 0,
        "changes": 49,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/303a47c09592c33aa84e2264e69643ef2570fa76/src/qt/guiutil.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/303a47c09592c33aa84e2264e69643ef2570fa76/src/qt/guiutil.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/guiutil.cpp?ref=303a47c09592c33aa84e2264e69643ef2570fa76",
        "patch": "@@ -15,6 +15,8 @@\n #include <QAbstractItemView>\n #include <QApplication>\n #include <QClipboard>\n+#include <QFileDialog>\n+#include <QDesktopServices>\n \n QString GUIUtil::dateTimeStr(qint64 nTime)\n {\n@@ -121,3 +123,50 @@ void GUIUtil::copyEntryData(QAbstractItemView *view, int column, int role)\n         QApplication::clipboard()->setText(selection.at(0).data(role).toString());\n     }\n }\n+\n+QString GUIUtil::getSaveFileName(QWidget *parent, const QString &caption,\n+                                 const QString &dir,\n+                                 const QString &filter,\n+                                 QString *selectedSuffixOut)\n+{\n+    QString selectedFilter;\n+    QString myDir;\n+    if(dir.isEmpty()) // Default to user documents location\n+    {\n+        myDir = QDesktopServices::storageLocation(QDesktopServices::DocumentsLocation);\n+    }\n+    else\n+    {\n+        myDir = dir;\n+    }\n+    QString result = QFileDialog::getSaveFileName(parent, caption, myDir, filter, &selectedFilter);\n+\n+    /* Extract first suffix from filter pattern \"Description (*.foo)\" or \"Description (*.foo *.bar ...) */\n+    QRegExp filter_re(\".* \\\\(\\\\*\\\\.(.*)[ \\\\)]\");\n+    QString selectedSuffix;\n+    if(filter_re.exactMatch(selectedFilter))\n+    {\n+        selectedSuffix = filter_re.cap(1);\n+    }\n+\n+    /* Add suffix if needed */\n+    QFileInfo info(result);\n+    if(!result.isEmpty())\n+    {\n+        if(info.suffix().isEmpty() && !selectedSuffix.isEmpty())\n+        {\n+            /* No suffix specified, add selected suffix */\n+            if(!result.endsWith(\".\"))\n+                result.append(\".\");\n+            result.append(selectedSuffix);\n+        }\n+    }\n+\n+    /* Return selected suffix if asked to */\n+    if(selectedSuffixOut)\n+    {\n+        *selectedSuffixOut = selectedSuffix;\n+    }\n+    return result;\n+}\n+"
      },
      {
        "sha": "8c8566846583c818c98a9ff850f15982cc8b8697",
        "filename": "src/qt/guiutil.h",
        "status": "modified",
        "additions": 14,
        "deletions": 0,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/303a47c09592c33aa84e2264e69643ef2570fa76/src/qt/guiutil.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/303a47c09592c33aa84e2264e69643ef2570fa76/src/qt/guiutil.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/guiutil.h?ref=303a47c09592c33aa84e2264e69643ef2570fa76",
        "patch": "@@ -45,6 +45,20 @@ class GUIUtil\n      */\n     static void copyEntryData(QAbstractItemView *view, int column, int role=Qt::EditRole);\n \n+    /** Get save file name, mimics QFileDialog::getSaveFileName, except that it appends a default suffix\n+        when no suffix is provided by the user.\n+\n+      @param[in] parent  Parent window (or 0)\n+      @param[in] caption Window caption (or empty, for default)\n+      @param[in] dir     Starting directory (or empty, to default to documents directory)\n+      @param[in] filter  Filter specification such as \"Comma Separated Files (*.csv)\"\n+      @param[out] selectedSuffixOut  Pointer to return the suffix (file type) that was selected (or 0).\n+                  Can be useful when choosing the save file format based on suffix.\n+     */\n+    static QString getSaveFileName(QWidget *parent=0, const QString &caption=QString(),\n+                                   const QString &dir=QString(), const QString &filter=QString(),\n+                                   QString *selectedSuffixOut=0);\n+\n };\n \n #endif // GUIUTIL_H"
      },
      {
        "sha": "82959831decb99941bc1ed8e9d76ad6daf356858",
        "filename": "src/qt/qrcodedialog.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 3,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/303a47c09592c33aa84e2264e69643ef2570fa76/src/qt/qrcodedialog.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/303a47c09592c33aa84e2264e69643ef2570fa76/src/qt/qrcodedialog.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/qrcodedialog.cpp?ref=303a47c09592c33aa84e2264e69643ef2570fa76",
        "patch": "@@ -1,9 +1,9 @@\n #include \"qrcodedialog.h\"\n #include \"ui_qrcodedialog.h\"\n+#include \"guiutil.h\"\n+\n #include <QPixmap>\n #include <QUrl>\n-#include <QFileDialog>\n-#include <QDesktopServices>\n #include <QDebug>\n \n #include <qrencode.h>\n@@ -98,7 +98,7 @@ void QRCodeDialog::on_lnMessage_textChanged(const QString &)\n \n void QRCodeDialog::on_btnSaveAs_clicked()\n {\n-    QString fn = QFileDialog::getSaveFileName(this, \"Save Image...\", QDesktopServices::storageLocation(QDesktopServices::DocumentsLocation), \"Images (*.png)\");\n+    QString fn = GUIUtil::getSaveFileName(this, tr(\"Save Image...\"), QString(), tr(\"PNG Images (*.png)\"));\n     if(!fn.isEmpty()) {\n         myImage.scaled(EXPORT_IMAGE_SIZE, EXPORT_IMAGE_SIZE).save(fn);\n     }"
      },
      {
        "sha": "eaed48bfdf41c53826653d8ed0976e8e622930ec",
        "filename": "src/qt/transactionview.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 4,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/303a47c09592c33aa84e2264e69643ef2570fa76/src/qt/transactionview.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/303a47c09592c33aa84e2264e69643ef2570fa76/src/qt/transactionview.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/transactionview.cpp?ref=303a47c09592c33aa84e2264e69643ef2570fa76",
        "patch": "@@ -21,7 +21,6 @@\n #include <QTableView>\n #include <QHeaderView>\n #include <QPushButton>\n-#include <QFileDialog>\n #include <QMessageBox>\n #include <QPoint>\n #include <QMenu>\n@@ -264,10 +263,9 @@ void TransactionView::changedAmount(const QString &amount)\n void TransactionView::exportClicked()\n {\n     // CSV is currently the only supported format\n-    QString filename = QFileDialog::getSaveFileName(\n+    QString filename = GUIUtil::getSaveFileName(\n             this,\n-            tr(\"Export Transaction Data\"),\n-            QDir::currentPath(),\n+            tr(\"Export Transaction Data\"), QString(),\n             tr(\"Comma separated file (*.csv)\"));\n \n     if (filename.isNull()) return;"
      }
    ]
  }
]