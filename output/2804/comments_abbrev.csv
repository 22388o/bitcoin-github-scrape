sipa,2013-06-29T14:43:18Z,"Tested that an (Ubuntu) build of the resulting tar's content works, and results in a meaningful version being reported.\n",https://github.com/bitcoin/bitcoin/pull/2804#issuecomment-20230949,20230949,
johndillon,2013-06-29T16:30:56Z,Will the resulting tarballs be generated deterministically by the gitian build process as well so we can get signatures that the tarball matches the git tag?\n,https://github.com/bitcoin/bitcoin/pull/2804#issuecomment-20232809,20232809,
sipa,2013-06-29T17:22:29Z,"@johndillon The tar file is generated by git, and there's no source of randomness (the owner is set to root, the timestamps are equal to that of the last commit, and files are sorted alphabetically) as far as I can see - though this can obviously change in newer git versions. So it could be done inside gitian, I suppose, as that guarantees a consistent version of git to generate it.\n",https://github.com/bitcoin/bitcoin/pull/2804#issuecomment-20233639,20233639,
johndillon,2013-06-29T17:55:03Z,"@sipa Provided that is true I'll ACK this patch.\n\nIn some ways making it easier for distribution managers to distribute Bitcoin anything bothers me in that they represent a very real risk of compromise with very high rewards, but if they are going to do so this is a reasonable thing to provide.\n",https://github.com/bitcoin/bitcoin/pull/2804#issuecomment-20234132,20234132,
sipa,2013-06-30T12:15:12Z,"Ok, I've moved the construction of the tar file inside gitian, so hopefully it is deterministic now.\n\nA few notes:\n- Currently, the gitian build script doesn't know the ""name"" of the version being built, so the tarball uses a subdir bitcoin/ rather than bitcoin-$VERSION/; I don't know how much that is uncommon/unexpected.\n- I've put it inside the Windows build, as I didn't want to create a ful",https://github.com/bitcoin/bitcoin/pull/2804#issuecomment-20246227,20246227,
robbak,2013-06-30T12:38:49Z,"Thanks for taking this on.\n\nIt would be best for a number of reasons if the sourceforge download was\nidentical to the github generated file, at least at the time of release. We\ncan then use github as a backup to sourceforge, or vice versa. If the files\nare different, then we have to choose between the two. Sourceforge is\nfaster and way more reliable, with their endless array of mirrors.\n\nM",https://github.com/bitcoin/bitcoin/pull/2804#issuecomment-20246542,20246542,
sipa,2013-06-30T12:48:12Z,"With the current pullreq, there is no way that the hash will match what github builds. They have the tag name in the directory, and their compression seems worse (even for .tar.gz). However, you do get signed hashes of the tarball from every gitian builder.\n",https://github.com/bitcoin/bitcoin/pull/2804#issuecomment-20246651,20246651,
luke-jr,2013-06-30T13:43:13Z,"Currently, even our binary tarballs and ZIPs are outside the signature mechanism, so I don't know how important doing a source tarball deterministically is. The end-user can always compare with the signed git tag, after all.\n\nIn any case, I think deterministically having gitian generate the same tar.gz as github is possible anyway.\n",https://github.com/bitcoin/bitcoin/pull/2804#issuecomment-20247302,20247302,
sipa,2013-06-30T15:49:14Z,"@luke-jr But the released .zip and .tar.gz files have hashes signed by gitian. True, the entire source tree is signed as well, but being able to just compare the hash on a single .tar.xz is certainly easier.\n",https://github.com/bitcoin/bitcoin/pull/2804#issuecomment-20249229,20249229,
sipa,2013-06-30T17:16:42Z,"Updated again. The created tarballs should now be identical to github's at the tar level. I'm not able to produce a binary identically .gz file, however.\n",https://github.com/bitcoin/bitcoin/pull/2804#issuecomment-20250732,20250732,
sipa,2013-06-30T17:23:19Z,"Got it, added -cn to gzip, and now they match the github .tar.gz files.\n",https://github.com/bitcoin/bitcoin/pull/2804#issuecomment-20250837,20250837,
theuni,2013-07-02T17:53:33Z,"Note that https://github.com/bitcoin/bitcoin/pull/2805 handles bootstrapping and tarball generation, which I believe should make this PR unnecessary. Instead, gitian would have a separate descriptor for source generation (running 'make dist') which is then fed into the other builds.\n",https://github.com/bitcoin/bitcoin/pull/2804#issuecomment-20363222,20363222,
sipa,2013-07-02T22:32:02Z,"Closing in favor of #2805 or its successor, as the plan seems to be to generate a source tarball through make dist running in gitian.\n",https://github.com/bitcoin/bitcoin/pull/2804#issuecomment-20383697,20383697,
luke-jr,2013-06-29T16:35:32Z,git archive --format=tar --prefix=bitcoin-${VERSION}/ v${VERSION} | xz > bitcoin-${VERSION}-src.tar.xz\n,https://github.com/bitcoin/bitcoin/pull/2804#discussion_r4952429,4952429,doc/release-process.md
sipa,2013-06-29T17:16:46Z,"If you only want an .xz distribution, sure. I assumed a ""legacy"" tar.gz might be useful too.\n",https://github.com/bitcoin/bitcoin/pull/2804#discussion_r4952510,4952510,doc/release-process.md
