Sjors,2020-01-30 18:32:59,Alternatively we could remove the use of `static const Coin coinEmpty` and disable the empty `Coin` constructor. ,https://github.com/bitcoin/bitcoin/pull/18030#issuecomment-580391515,580391515,
jnewbery,2020-01-31 15:47:39,"I think I prefer the second option (remove the use of `static const Coin coinEmpty`). I think the only time that we can get a never-existing coin from the cache is with `AccessCoin()`. We could change that to return a const pointer instead of a const reference and return `nullptr` if the coin doesn't exist. That's what `AccessCoins()` did before we changed to per-txout coinsdb.\n\nPerhaps @sipa ",https://github.com/bitcoin/bitcoin/pull/18030#issuecomment-580787170,580787170,
promag,2020-02-03 00:41:32,How about rename to `IsNull()`?,https://github.com/bitcoin/bitcoin/pull/18030#issuecomment-581196616,581196616,
fjahr,2020-06-10 14:13:38,"> How about rename to `IsNull()`?\n\nI think this is a more accurate name and just renaming is the smaller change, so I think this could be a good middle-ground solution. The downside of this name specifically is that this makes it harder to grep for this function. Maybe `IsSpentOrEmpty()` would be even a little bit better.  ",https://github.com/bitcoin/bitcoin/pull/18030#issuecomment-642037969,642037969,
flack,2020-06-10 14:16:46,or maybe turn it around and call the function `isSpendable` or something? Because it's kind of intuitive that a coin that doesn't exist can't be spent,https://github.com/bitcoin/bitcoin/pull/18030#issuecomment-642039896,642039896,
practicalswift,2021-03-20 21:59:58,ACK 1404c574037da331c233317618b9b90d3329ed33,https://github.com/bitcoin/bitcoin/pull/18030#issuecomment-803469461,803469461,
MarcoFalke,2021-03-21 07:18:16,"> I think I prefer the second option (remove the use of `static const Coin coinEmpty`). I think the only time that we can get a never-existing coin from the cache is with `AccessCoin()`. We could change that to return a const pointer instead of a const reference and return `nullptr` if the coin doesn't exist. That's what `AccessCoins()` did before we changed to per-txout coinsdb.\n> \n> Perhaps ",https://github.com/bitcoin/bitcoin/pull/18030#issuecomment-803524627,803524627,
MarcoFalke,2021-03-21 07:18:31,ACK 1404c574037da331c233317618b9b90d3329ed33,https://github.com/bitcoin/bitcoin/pull/18030#issuecomment-803524645,803524645,
jnewbery,2021-03-21 19:55:26,"utACK 1404c574037da331c233317618b9b90d3329ed33\n\nIt's a much bigger change, but how about replacing `IsSpent()` with the bool operator, and using that everywhere? If we're using a `Coin` in the null state to indicate ""no UTXO"", then it seems natural to define truthiness on the `Coin` object where false indicates no UTXO and true indicates UTXO.\n\nEven after this PR, there are still places wh",https://github.com/bitcoin/bitcoin/pull/18030#issuecomment-803649737,803649737,
JeremyRubin,2021-03-22 03:14:45,"I think an optional API sounds nice, not a huge fan of making coin itself a\nbool operator since I don't think there's a straightforward ""truthiness""\nthat a coin would have in all contexts.\n",https://github.com/bitcoin/bitcoin/pull/18030#issuecomment-803732380,803732380,
sipa,2021-03-22 03:33:25,"If you're going to consider an std::optional based interface, please benchmark it very well - this code is very performance critical.\n\nI don't think there is a need; Coin has a well-defined ""empty"" state on its own (the current IsSpent; a name that's indeed outdated and confusing), so I don't think there is a need for a way to signal failure separately.\n\n> since I don't think there's a straigh",https://github.com/bitcoin/bitcoin/pull/18030#issuecomment-803737209,803737209,
laanwj,2020-06-10 14:57:45,Please use doxygen function description syntax: `/**  ... */`,https://github.com/bitcoin/bitcoin/pull/18030#discussion_r438189804,438189804,src/coins.h
Sjors,2020-06-10 15:47:11,Done,https://github.com/bitcoin/bitcoin/pull/18030#discussion_r438226836,438226836,src/coins.h
