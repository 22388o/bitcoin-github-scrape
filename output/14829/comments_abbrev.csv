DrahtBot,2018-11-28T23:21:38Z,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#14841](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14841.html) (consensus: Move CheckBlock() call to critic",https://github.com/bitcoin/bitcoin/pull/14829#issuecomment-442644148,442644148,
practicalswift,2018-12-03T13:41:49Z,"@MarcoFalke Please review the latest version.\n\nI've now re-introduced `CPPFLAGS=-DDEBUG_LOCKORDER`.\n\nHowever, I've been unable to make the Travis build pass without `FUNCTIONAL_TESTS_CONFIG=""--exclude feature_block.py,p2p_invalid_messages.py""` and `--disable-wallet`.",https://github.com/bitcoin/bitcoin/pull/14829#issuecomment-443713587,443713587,
practicalswift,2018-12-15T15:25:48Z,@MarcoFalke @ken2812221 Updated. Please re-review :-),https://github.com/bitcoin/bitcoin/pull/14829#issuecomment-447576164,447576164,
MarcoFalke,2018-12-17T22:04:46Z,utACK 5e5138a721738f47053d915e4c65f925838ad5b4,https://github.com/bitcoin/bitcoin/pull/14829#issuecomment-448015995,448015995,
practicalswift,2018-12-18T09:19:18Z,"@MarcoFalke Added suppression (`race:InterruptRPC`, fix in #14993). Please re-review :-)",https://github.com/bitcoin/bitcoin/pull/14829#issuecomment-448151666,448151666,
MarcoFalke,2018-11-29T20:19:52Z,Why are they excluded?,https://github.com/bitcoin/bitcoin/pull/14829#discussion_r237644125,237644125,.travis.yml
MarcoFalke,2018-11-29T20:20:09Z,Why is the wallet and DEBUG_LOCKORDER disabled?,https://github.com/bitcoin/bitcoin/pull/14829#discussion_r237644202,237644202,.travis.yml
MarcoFalke,2018-11-29T20:22:07Z,"This seems like a lot, what about something like this instead:\n\n```diff\ndiff --git a/test/sanitizer_suppressions/tsan b/test/sanitizer_suppressions/tsan\nindex 209c46f..4edf68c 100644\n--- a/test/sanitizer_suppressions/tsan\n+++ b/test/sanitizer_suppressions/tsan\n@@ -14,9 +14,10 @@ deadlock:TestPotentialDeadLockDetected\n race:src/qt/test/*\n deadlock:src/qt/test/*\n \n-# WIP: Unide",https://github.com/bitcoin/bitcoin/pull/14829#discussion_r237644798,237644798,test/sanitizer_suppressions/tsan
practicalswift,2018-12-03T08:10:26Z,Fixed!,https://github.com/bitcoin/bitcoin/pull/14829#discussion_r238171917,238171917,test/sanitizer_suppressions/tsan
practicalswift,2018-12-03T10:29:16Z,"For some strange reasons all functional wallets tests fail under Travis (`wallet_basic`, `wallet_dump`, etc.). The failure reason is not clear from the logging so I haven't been able to solve this yet.",https://github.com/bitcoin/bitcoin/pull/14829#discussion_r238213779,238213779,.travis.yml
practicalswift,2018-12-03T10:31:58Z,`feature_block.py` and `p2p_invalid_message.py` fail for some unknown reason. Unfortunately the error log is not very informative so I haven't figured out why or what suppression (if any) would solve it.,https://github.com/bitcoin/bitcoin/pull/14829#discussion_r238214716,238214716,.travis.yml
practicalswift,2018-12-03T13:40:54Z,I've now re-added `CPPFLAGS=-DDEBUG_LOCKORDER` since it doesn't seem to cause any problems.,https://github.com/bitcoin/bitcoin/pull/14829#discussion_r238271174,238271174,.travis.yml
ken2812221,2018-12-03T14:01:09Z,Could these commands be run in `after_failure` step? Then you don't have to copy-paste these code in three different places.,https://github.com/bitcoin/bitcoin/pull/14829#discussion_r238278124,238278124,.travis/test_06_script.sh
MarcoFalke,2018-12-03T18:06:34Z,They are timing out because the tsan slows down bitcoind so much. You'd probably have to up all the various timeouts (rpcwait and the timeout for polling loops),https://github.com/bitcoin/bitcoin/pull/14829#discussion_r238376520,238376520,.travis.yml
MarcoFalke,2018-12-03T18:07:08Z,At least that is what I assume based on my tsan runs a few days ago,https://github.com/bitcoin/bitcoin/pull/14829#discussion_r238376675,238376675,.travis.yml
practicalswift,2018-12-03T19:07:30Z,"@MarcoFalke Ah, I see. What do you think about doing that in a follow-up PR once this is merged? It would be nice to keep this initial PR minimal to get basic functional testing under Travis. Debugging Travis is quite time consuming so I'd rather split the task in two if possible.",https://github.com/bitcoin/bitcoin/pull/14829#discussion_r238398034,238398034,.travis.yml
practicalswift,2018-12-03T19:14:00Z,"@ken2812221 I haven't tried `after_failure` before, but let me try to summarise: the suggestion is to add script say `.travis/test_XX_after_failure.sh` containing ...\n\n```\n#!/bin/bash\n\nDOCKER_EXEC ""cat ${TRAVIS_BUILD_DIR}/sanitizer-output/* 2> /dev/null""\n```\n\n.. that would be referenced using ...\n\n```\nafter_failure:\n  - set -o errexit; source .travis/test_XX_after_failure.s",https://github.com/bitcoin/bitcoin/pull/14829#discussion_r238400331,238400331,.travis/test_06_script.sh
MarcoFalke,2018-12-03T20:25:17Z,"Looks like they time out with\n\n`No output has been received in the last 10m0s, this potentially indicates a stalled build or something wrong with the build itself.`\n\nhttps://travis-ci.org/MarcoFalke/bitcoin/jobs/462970867\n\nwhich shouldn't happen, since we should be printing dots all the time. Not sure what is going on :(",https://github.com/bitcoin/bitcoin/pull/14829#discussion_r238423901,238423901,.travis.yml
practicalswift,2018-12-14T15:13:35Z,@ken2812221 Friendly ping :-),https://github.com/bitcoin/bitcoin/pull/14829#discussion_r241786416,241786416,.travis/test_06_script.sh
MarcoFalke,2018-12-14T22:51:52Z,Could just test it?,https://github.com/bitcoin/bitcoin/pull/14829#discussion_r241914047,241914047,.travis/test_06_script.sh
MarcoFalke,2018-12-14T22:55:22Z,"Ah, I guess it wouldn't work because we exit ""hard"" as opposed to just return a non-zero exit code.",https://github.com/bitcoin/bitcoin/pull/14829#discussion_r241914699,241914699,.travis/test_06_script.sh
ken2812221,2018-12-15T02:42:43Z,"The trap way seems to work. 8d78bb9536e44e6b79532f539b1dd0066ce7ee6c\n\n https://travis-ci.org/ken2812221/bitcoin/jobs/468068901\n\n",https://github.com/bitcoin/bitcoin/pull/14829#discussion_r241935212,241935212,.travis/test_06_script.sh
