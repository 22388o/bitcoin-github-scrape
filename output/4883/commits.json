[
  {
    "sha": "391f0c06606aa48b3bd097ce156614efaacfeeae",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozOTFmMGMwNjYwNmFhNDhiM2JkMDk3Y2UxNTY2MTRlZmFhY2ZlZWFl",
    "commit": {
      "author": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2014-09-09T11:08:47Z"
      },
      "committer": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2014-09-09T11:34:35Z"
      },
      "message": "Add bitcoin-genalertkey utility",
      "tree": {
        "sha": "0705b1b547dfa81dc01b767e9744d370f6925529",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0705b1b547dfa81dc01b767e9744d370f6925529"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/391f0c06606aa48b3bd097ce156614efaacfeeae",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/391f0c06606aa48b3bd097ce156614efaacfeeae",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/391f0c06606aa48b3bd097ce156614efaacfeeae",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/391f0c06606aa48b3bd097ce156614efaacfeeae/comments",
    "author": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "8bc0a0173e885a5b60e12d3769604236967c262e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/8bc0a0173e885a5b60e12d3769604236967c262e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/8bc0a0173e885a5b60e12d3769604236967c262e"
      }
    ],
    "stats": {
      "total": 175,
      "additions": 174,
      "deletions": 1
    },
    "files": [
      {
        "sha": "3df3d797bd1cf87bd4665cab02bf99f993e9782a",
        "filename": ".gitignore",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/391f0c06606aa48b3bd097ce156614efaacfeeae/.gitignore",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/391f0c06606aa48b3bd097ce156614efaacfeeae/.gitignore",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/.gitignore?ref=391f0c06606aa48b3bd097ce156614efaacfeeae",
        "patch": "@@ -5,6 +5,7 @@ src/bitcoin\n src/bitcoind\n src/bitcoin-cli\n src/bitcoin-tx\n+src/bitcoin-genalertkey\n src/test/test_bitcoin\n src/qt/test/test_bitcoin-qt\n "
      },
      {
        "sha": "047674023e22463d00a54fdb7b1ee03ea4dd4688",
        "filename": "src/Makefile.am",
        "status": "modified",
        "additions": 25,
        "deletions": 1,
        "changes": 26,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/391f0c06606aa48b3bd097ce156614efaacfeeae/src/Makefile.am",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/391f0c06606aa48b3bd097ce156614efaacfeeae/src/Makefile.am",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.am?ref=391f0c06606aa48b3bd097ce156614efaacfeeae",
        "patch": "@@ -56,7 +56,7 @@ if BUILD_BITCOIND\n endif\n \n if BUILD_BITCOIN_UTILS\n-  bin_PROGRAMS += bitcoin-cli bitcoin-tx\n+  bin_PROGRAMS += bitcoin-cli bitcoin-tx bitcoin-genalertkey\n endif\n \n .PHONY: FORCE\n@@ -298,6 +298,30 @@ if USE_LIBSECP256K1\n endif\n bitcoin_cli_CPPFLAGS = $(BITCOIN_INCLUDES)\n #\n+#\n+## bitcoin-genalertkey binary #\n+bitcoin_genalertkey_LDADD = \\\n+  $(LIBBITCOIN_SERVER) \\\n+  $(LIBBITCOIN_COMMON) \\\n+  $(LIBBITCOIN_UNIVALUE) \\\n+  $(LIBBITCOIN_UTIL) \\\n+  $(LIBBITCOIN_CRYPTO) \\\n+  $(BOOST_LIBS) \\\n+  $(SSL_LIBS) \\\n+  $(CRYPTO_LIBS) \\\n+  $(LIBLEVELDB) \\\n+  $(LIBMEMENV)\n+if ENABLE_WALLET\n+bitcoin_genalertkey_LDADD += libbitcoin_wallet.a $(BDB_LIBS)\n+endif\n+\n+bitcoin_genalertkey_SOURCES = \\\n+  bitcoin-genalertkey.cpp\n+\n+if USE_LIBSECP256K1\n+  bitcoin_genalertkey_LDADD += secp256k1/libsecp256k1.la\n+endif\n+bitcoin_genalertkey_CPPFLAGS = $(BITCOIN_INCLUDES)\n \n # bitcoin-tx binary #\n bitcoin_tx_LDADD = \\"
      },
      {
        "sha": "79b5d09733a1b3a3fac64ee79fcdc5abe6494447",
        "filename": "src/bitcoin-genalertkey.cpp",
        "status": "added",
        "additions": 148,
        "deletions": 0,
        "changes": 148,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/391f0c06606aa48b3bd097ce156614efaacfeeae/src/bitcoin-genalertkey.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/391f0c06606aa48b3bd097ce156614efaacfeeae/src/bitcoin-genalertkey.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoin-genalertkey.cpp?ref=391f0c06606aa48b3bd097ce156614efaacfeeae",
        "patch": "@@ -0,0 +1,148 @@\n+#include \"main.h\"\n+#include \"net.h\"\n+#include \"alert.h\"\n+#include \"util.h\"\n+#include \"key.h\"\n+\n+//\n+// alertTests contains 7 alerts, generated with this code:\n+//\n+std::vector<CAlert> GenAlertTests()\n+{\n+    std::vector<CAlert> alerts;\n+    CAlert alert;\n+    alert.nRelayUntil   = 60;\n+    alert.nExpiration   = 24 * 60 * 60;\n+    alert.nID           = 1;\n+    alert.nCancel       = 0;   // cancels previous messages up to this ID number\n+    alert.nMinVer       = 0;  // These versions are protocol versions\n+    alert.nMaxVer       = 999001;\n+    alert.nPriority     = 1;\n+    alert.strComment    = \"Alert comment\";\n+    alert.strStatusBar  = \"Alert 1\";\n+\n+    alerts.push_back(alert);\n+\n+    alert.setSubVer.insert(std::string(\"/Satoshi:0.1.0/\"));\n+    alert.strStatusBar  = \"Alert 1 for Satoshi 0.1.0\";\n+    alerts.push_back(alert);\n+\n+    alert.setSubVer.insert(std::string(\"/Satoshi:0.2.0/\"));\n+    alert.strStatusBar  = \"Alert 1 for Satoshi 0.1.0, 0.2.0\";\n+    alerts.push_back(alert);\n+\n+    alert.setSubVer.clear();\n+    ++alert.nID;\n+    alert.nCancel = 1;\n+    alert.nPriority = 100;\n+    alert.strStatusBar  = \"Alert 2, cancels 1\";\n+    alerts.push_back(alert);\n+\n+    alert.nExpiration += 60;\n+    ++alert.nID;\n+    alerts.push_back(alert);\n+\n+    ++alert.nID;\n+    alert.nMinVer = 11;\n+    alert.nMaxVer = 22;\n+    alerts.push_back(alert);\n+\n+    ++alert.nID;\n+    alert.strStatusBar  = \"Alert 2 for Satoshi 0.1.0\";\n+    alert.setSubVer.insert(std::string(\"/Satoshi:0.1.0/\"));\n+    alerts.push_back(alert);\n+\n+    ++alert.nID;\n+    alert.nMinVer = 0;\n+    alert.nMaxVer = 999999;\n+    alert.strStatusBar  = \"Evil Alert'; /bin/ls; echo '\";\n+    alert.setSubVer.clear();\n+    alerts.push_back(alert);\n+\n+    return alerts;\n+}\n+\n+void SignAlert(CAlert &alert, const CKey &key, const CPubKey &pubkey)\n+{\n+    CDataStream sMsg(SER_NETWORK, CLIENT_VERSION);\n+    sMsg << *(CUnsignedAlert*)&alert;\n+    alert.vchMsg = std::vector<unsigned char>(sMsg.begin(), sMsg.end());\n+    if (!key.Sign(Hash(alert.vchMsg.begin(), alert.vchMsg.end()), alert.vchSig))\n+    {\n+        fprintf(stderr, \"%s: Signing failed\\n\", __func__);\n+        exit(1);\n+    }\n+    if (!pubkey.Verify(Hash(alert.vchMsg.begin(), alert.vchMsg.end()), alert.vchSig))\n+    {\n+        fprintf(stderr, \"%s: Verification failed\\n\", __func__);\n+        exit(1);\n+    }\n+}\n+\n+std::vector<CAlert> GenKey(std::string &outPriv, const std::string &networkName)\n+{\n+    CKey key;\n+    key.MakeNewKey(true);\n+\n+    CPrivKey privkey = key.GetPrivKey();\n+    CPubKey pubkey = key.GetPubKey();\n+\n+    outPriv += \"const char* psz\" + networkName + \"PrivKey = \\\"\";\n+    outPriv += HexStr(privkey);\n+    outPriv += \"\\\";\\n\";\n+\n+    outPriv += \"// Add the following to chainparams.cpp constructor for \" + networkName + \"\\n\";\n+    outPriv += \"// vAlertPubKey = ParseHex(\\\"\";\n+    outPriv += HexStr(pubkey);\n+    outPriv += \"\\\");\\n\";\n+\n+    /// Generate and sign test vectors\n+    std::vector<CAlert> alerts = GenAlertTests();\n+    BOOST_FOREACH(CAlert &alert, alerts)\n+        SignAlert(alert, key, pubkey);\n+\n+    return alerts;\n+}\n+\n+void WriteTests(const std::string &testsFileName, const std::vector<CAlert> &alerts)\n+{\n+    CAutoFile est_fileout(fopen(testsFileName.c_str(), \"wb\"), SER_DISK, CLIENT_VERSION);\n+    est_fileout << alerts;\n+}\n+\n+int GenAlertKey(int argc, char *argv[])\n+{\n+    ParseParameters(argc, argv);\n+\n+    // Generate alertKeys.h\n+    std::string outPriv;\n+\n+    outPriv = \"// Private alert key header - CONFIDENTIAL\\n\\n\";\n+    std::vector<CAlert> testsMainNet = GenKey(outPriv, \"MainNet\");\n+    outPriv += \"\\n\";\n+    std::vector<CAlert> testsTestNet = GenKey(outPriv, \"TestNet\");\n+\n+    printf(\"%s\\n\", outPriv.c_str());\n+\n+    WriteTests(\"test/data/alertTestsMainNet.raw\", testsMainNet);\n+    WriteTests(\"test/data/alertTestsTestNet.raw\", testsTestNet);\n+\n+    return 0;\n+}\n+\n+int main(int argc, char* argv[])\n+{\n+    SetupEnvironment();\n+    int ret = EXIT_FAILURE;\n+    try {\n+        ret = GenAlertKey(argc, argv);\n+    }\n+    catch (std::exception& e) {\n+        PrintExceptionContinue(&e, \"CommandLineRPC()\");\n+    } catch (...) {\n+        PrintExceptionContinue(NULL, \"CommandLineRPC()\");\n+    }\n+    return ret;\n+}\n+\n+"
      }
    ]
  },
  {
    "sha": "9f9ef10ec313830028908910ab05f15a8599a8d5",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo5ZjllZjEwZWMzMTM4MzAwMjg5MDg5MTBhYjA1ZjE1YTg1OTlhOGQ1",
    "commit": {
      "author": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2014-09-09T11:10:39Z"
      },
      "committer": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2014-09-09T11:34:35Z"
      },
      "message": "test: Test alerts for both testnet and mainnet",
      "tree": {
        "sha": "207d06d0a361dd8b0269963d8284edab2c6a3a1c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/207d06d0a361dd8b0269963d8284edab2c6a3a1c"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9f9ef10ec313830028908910ab05f15a8599a8d5",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9f9ef10ec313830028908910ab05f15a8599a8d5",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/9f9ef10ec313830028908910ab05f15a8599a8d5",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9f9ef10ec313830028908910ab05f15a8599a8d5/comments",
    "author": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "391f0c06606aa48b3bd097ce156614efaacfeeae",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/391f0c06606aa48b3bd097ce156614efaacfeeae",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/391f0c06606aa48b3bd097ce156614efaacfeeae"
      }
    ],
    "stats": {
      "total": 84,
      "additions": 45,
      "deletions": 39
    },
    "files": [
      {
        "sha": "701da193542a7b0454681b9b4e403ce94a217f14",
        "filename": "src/Makefile.test.include",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/9f9ef10ec313830028908910ab05f15a8599a8d5/src/Makefile.test.include",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/9f9ef10ec313830028908910ab05f15a8599a8d5/src/Makefile.test.include",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.test.include?ref=9f9ef10ec313830028908910ab05f15a8599a8d5",
        "patch": "@@ -27,7 +27,7 @@ JSON_TEST_FILES = \\\n   test/data/tx_valid.json \\\n   test/data/sighash.json\n \n-RAW_TEST_FILES = test/data/alertTests.raw\n+RAW_TEST_FILES = test/data/alertTestsMainNet.raw test/data/alertTestsTestNet.raw\n \n GENERATED_TEST_FILES = $(JSON_TEST_FILES:.json=.json.h) $(RAW_TEST_FILES:.raw=.raw.h)\n "
      },
      {
        "sha": "4025cb59762b5f367443e3af7e80f7ee301ebb0a",
        "filename": "src/chainparams.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/9f9ef10ec313830028908910ab05f15a8599a8d5/src/chainparams.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/9f9ef10ec313830028908910ab05f15a8599a8d5/src/chainparams.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/chainparams.cpp?ref=9f9ef10ec313830028908910ab05f15a8599a8d5",
        "patch": "@@ -56,7 +56,7 @@ class CMainParams : public CChainParams {\n         pchMessageStart[1] = 0xbe;\n         pchMessageStart[2] = 0xb4;\n         pchMessageStart[3] = 0xd9;\n-        vAlertPubKey = ParseHex(\"04fc9702847840aaf195de8442ebecedf5b095cdbb9bc716bda9110971b28a49e0ead8564ff0db22209e0374782c093bb899692d524e9d6a6956e7c5ecbcd68284\");\n+        vAlertPubKey = ParseHex(\"020eac7fb3e193f2c30feddce9969d252d19a1e827e7a45167f3e87cced70eaa6d\");\n         nDefaultPort = 8333;\n         bnProofOfWorkLimit = ~uint256(0) >> 32;\n         nSubsidyHalvingInterval = 210000;\n@@ -135,7 +135,7 @@ class CTestNetParams : public CMainParams {\n         pchMessageStart[1] = 0x11;\n         pchMessageStart[2] = 0x09;\n         pchMessageStart[3] = 0x07;\n-        vAlertPubKey = ParseHex(\"04302390343f91cc401d56d68b123028bf52e5fca1939df127f63c6467cdf9c8e2c14b61104cf817d0b780da337893ecc4aaff1309e536162dabbdb45200ca2b0a\");\n+        vAlertPubKey = ParseHex(\"032ee803e12ecefdfcfe0990dbcb33c2081930f92b80d935ced5aedff904bd500a\");\n         nDefaultPort = 18333;\n         nEnforceBlockUpgradeMajority = 51;\n         nRejectBlockOutdatedMajority = 75;"
      },
      {
        "sha": "d38ca0594f0e4499e0ff7ab2dd7db6d4a9f78c20",
        "filename": "src/test/alert_tests.cpp",
        "status": "modified",
        "additions": 42,
        "deletions": 36,
        "changes": 78,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/9f9ef10ec313830028908910ab05f15a8599a8d5/src/test/alert_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/9f9ef10ec313830028908910ab05f15a8599a8d5/src/test/alert_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/alert_tests.cpp?ref=9f9ef10ec313830028908910ab05f15a8599a8d5",
        "patch": "@@ -7,8 +7,11 @@\n //\n \n #include \"alert.h\"\n-#include \"data/alertTests.raw.h\"\n+#include \"data/alertTestsMainNet.raw.h\"\n+#include \"data/alertTestsTestNet.raw.h\"\n \n+#include \"chainparams.h\"\n+#include \"chainparamsbase.h\"\n #include \"serialize.h\"\n #include \"util.h\"\n #include \"utilstrencodings.h\"\n@@ -81,17 +84,11 @@ struct ReadAlerts\n {\n     ReadAlerts()\n     {\n-        std::vector<unsigned char> vch(alert_tests::alertTests, alert_tests::alertTests + sizeof(alert_tests::alertTests));\n-        CDataStream stream(vch, SER_DISK, CLIENT_VERSION);\n-        try {\n-            while (!stream.eof())\n-            {\n-                CAlert alert;\n-                stream >> alert;\n-                alerts.push_back(alert);\n-            }\n-        }\n-        catch (std::exception) { }\n+        std::vector<unsigned char> vch1(alert_tests::alertTestsMainNet, alert_tests::alertTestsMainNet + sizeof(alert_tests::alertTestsMainNet));\n+        CDataStream(vch1, SER_DISK, CLIENT_VERSION) >> allAlerts[CBaseChainParams::MAIN];\n+\n+        std::vector<unsigned char> vch2(alert_tests::alertTestsTestNet, alert_tests::alertTestsTestNet + sizeof(alert_tests::alertTestsTestNet));\n+        CDataStream(vch2, SER_DISK, CLIENT_VERSION) >> allAlerts[CBaseChainParams::TESTNET];\n     }\n     ~ReadAlerts() { }\n \n@@ -107,7 +104,7 @@ struct ReadAlerts\n         return result;\n     }\n \n-    std::vector<CAlert> alerts;\n+    std::map<CBaseChainParams::Network, std::vector<CAlert> > allAlerts;\n };\n \n BOOST_FIXTURE_TEST_SUITE(Alert_tests, ReadAlerts)\n@@ -117,39 +114,46 @@ BOOST_AUTO_TEST_CASE(AlertApplies)\n {\n     SetMockTime(11);\n \n-    BOOST_FOREACH(const CAlert& alert, alerts)\n+    BOOST_FOREACH(const PAIRTYPE(CBaseChainParams::Network, std::vector<CAlert>) &net, allAlerts)\n     {\n-        BOOST_CHECK(alert.CheckSignature());\n-    }\n+        SelectParams(net.first);\n+        const std::vector<CAlert> &alerts = net.second;\n \n-    BOOST_CHECK(alerts.size() >= 3);\n+        BOOST_FOREACH(const CAlert& alert, alerts)\n+        {\n+            BOOST_CHECK(alert.CheckSignature());\n+        }\n \n-    // Matches:\n-    BOOST_CHECK(alerts[0].AppliesTo(1, \"\"));\n-    BOOST_CHECK(alerts[0].AppliesTo(999001, \"\"));\n-    BOOST_CHECK(alerts[0].AppliesTo(1, \"/Satoshi:11.11.11/\"));\n+        BOOST_CHECK(alerts.size() >= 3);\n \n-    BOOST_CHECK(alerts[1].AppliesTo(1, \"/Satoshi:0.1.0/\"));\n-    BOOST_CHECK(alerts[1].AppliesTo(999001, \"/Satoshi:0.1.0/\"));\n+        // Matches:\n+        BOOST_CHECK(alerts[0].AppliesTo(1, \"\"));\n+        BOOST_CHECK(alerts[0].AppliesTo(999001, \"\"));\n+        BOOST_CHECK(alerts[0].AppliesTo(1, \"/Satoshi:11.11.11/\"));\n \n-    BOOST_CHECK(alerts[2].AppliesTo(1, \"/Satoshi:0.1.0/\"));\n-    BOOST_CHECK(alerts[2].AppliesTo(1, \"/Satoshi:0.2.0/\"));\n+        BOOST_CHECK(alerts[1].AppliesTo(1, \"/Satoshi:0.1.0/\"));\n+        BOOST_CHECK(alerts[1].AppliesTo(999001, \"/Satoshi:0.1.0/\"));\n \n-    // Don't match:\n-    BOOST_CHECK(!alerts[0].AppliesTo(-1, \"\"));\n-    BOOST_CHECK(!alerts[0].AppliesTo(999002, \"\"));\n+        BOOST_CHECK(alerts[2].AppliesTo(1, \"/Satoshi:0.1.0/\"));\n+        BOOST_CHECK(alerts[2].AppliesTo(1, \"/Satoshi:0.2.0/\"));\n \n-    BOOST_CHECK(!alerts[1].AppliesTo(1, \"\"));\n-    BOOST_CHECK(!alerts[1].AppliesTo(1, \"Satoshi:0.1.0\"));\n-    BOOST_CHECK(!alerts[1].AppliesTo(1, \"/Satoshi:0.1.0\"));\n-    BOOST_CHECK(!alerts[1].AppliesTo(1, \"Satoshi:0.1.0/\"));\n-    BOOST_CHECK(!alerts[1].AppliesTo(-1, \"/Satoshi:0.1.0/\"));\n-    BOOST_CHECK(!alerts[1].AppliesTo(999002, \"/Satoshi:0.1.0/\"));\n-    BOOST_CHECK(!alerts[1].AppliesTo(1, \"/Satoshi:0.2.0/\"));\n+        // Don't match:\n+        BOOST_CHECK(!alerts[0].AppliesTo(-1, \"\"));\n+        BOOST_CHECK(!alerts[0].AppliesTo(999002, \"\"));\n \n-    BOOST_CHECK(!alerts[2].AppliesTo(1, \"/Satoshi:0.3.0/\"));\n+        BOOST_CHECK(!alerts[1].AppliesTo(1, \"\"));\n+        BOOST_CHECK(!alerts[1].AppliesTo(1, \"Satoshi:0.1.0\"));\n+        BOOST_CHECK(!alerts[1].AppliesTo(1, \"/Satoshi:0.1.0\"));\n+        BOOST_CHECK(!alerts[1].AppliesTo(1, \"Satoshi:0.1.0/\"));\n+        BOOST_CHECK(!alerts[1].AppliesTo(-1, \"/Satoshi:0.1.0/\"));\n+        BOOST_CHECK(!alerts[1].AppliesTo(999002, \"/Satoshi:0.1.0/\"));\n+        BOOST_CHECK(!alerts[1].AppliesTo(1, \"/Satoshi:0.2.0/\"));\n+\n+        BOOST_CHECK(!alerts[2].AppliesTo(1, \"/Satoshi:0.3.0/\"));\n+    }\n \n     SetMockTime(0);\n+    SelectParams(CBaseChainParams::MAIN);\n }\n \n \n@@ -160,6 +164,8 @@ BOOST_AUTO_TEST_CASE(AlertNotify)\n {\n     SetMockTime(11);\n \n+    const std::vector<CAlert> &alerts = allAlerts.find(CBaseChainParams::MAIN)->second;\n+\n     boost::filesystem::path temp = GetTempPath() / \"alertnotify.txt\";\n     boost::filesystem::remove(temp);\n "
      },
      {
        "sha": "01f50680b95aa307a1a013b643ded4ae0bc47162",
        "filename": "src/test/data/alertTests.raw",
        "status": "removed",
        "additions": 0,
        "deletions": 0,
        "changes": 0,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/391f0c06606aa48b3bd097ce156614efaacfeeae/src/test/data/alertTests.raw",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/391f0c06606aa48b3bd097ce156614efaacfeeae/src/test/data/alertTests.raw",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/data/alertTests.raw?ref=391f0c06606aa48b3bd097ce156614efaacfeeae"
      },
      {
        "sha": "889e7c4bdf02da28bd883aee2f1d4763da5f3dd7",
        "filename": "src/test/data/alertTestsMainNet.raw",
        "status": "added",
        "additions": 0,
        "deletions": 0,
        "changes": 0,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/9f9ef10ec313830028908910ab05f15a8599a8d5/src/test/data/alertTestsMainNet.raw",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/9f9ef10ec313830028908910ab05f15a8599a8d5/src/test/data/alertTestsMainNet.raw",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/data/alertTestsMainNet.raw?ref=9f9ef10ec313830028908910ab05f15a8599a8d5"
      },
      {
        "sha": "741338d3556c76e3116ebcd62796f23d91159895",
        "filename": "src/test/data/alertTestsTestNet.raw",
        "status": "added",
        "additions": 0,
        "deletions": 0,
        "changes": 0,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/9f9ef10ec313830028908910ab05f15a8599a8d5/src/test/data/alertTestsTestNet.raw",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/9f9ef10ec313830028908910ab05f15a8599a8d5/src/test/data/alertTestsTestNet.raw",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/data/alertTestsTestNet.raw?ref=9f9ef10ec313830028908910ab05f15a8599a8d5"
      }
    ]
  },
  {
    "sha": "ea58720ff9df90c9d713e218e5751173011c7bd6",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplYTU4NzIwZmY5ZGY5MGM5ZDcxM2UyMThlNTc1MTE3MzAxMWM3YmQ2",
    "commit": {
      "author": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2014-09-09T11:50:00Z"
      },
      "committer": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2014-09-09T11:50:00Z"
      },
      "message": "squashme",
      "tree": {
        "sha": "891b72611d8c2c4712e62d61ed58b1b12f1c6f31",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/891b72611d8c2c4712e62d61ed58b1b12f1c6f31"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ea58720ff9df90c9d713e218e5751173011c7bd6",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ea58720ff9df90c9d713e218e5751173011c7bd6",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/ea58720ff9df90c9d713e218e5751173011c7bd6",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ea58720ff9df90c9d713e218e5751173011c7bd6/comments",
    "author": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "9f9ef10ec313830028908910ab05f15a8599a8d5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9f9ef10ec313830028908910ab05f15a8599a8d5",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/9f9ef10ec313830028908910ab05f15a8599a8d5"
      }
    ],
    "stats": {
      "total": 22,
      "additions": 14,
      "deletions": 8
    },
    "files": [
      {
        "sha": "3ddceb2499adbb0b3f62cc6f8512f4009367a824",
        "filename": "src/bitcoin-genalertkey.cpp",
        "status": "modified",
        "additions": 14,
        "deletions": 8,
        "changes": 22,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ea58720ff9df90c9d713e218e5751173011c7bd6/src/bitcoin-genalertkey.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ea58720ff9df90c9d713e218e5751173011c7bd6/src/bitcoin-genalertkey.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoin-genalertkey.cpp?ref=ea58720ff9df90c9d713e218e5751173011c7bd6",
        "patch": "@@ -104,10 +104,15 @@ std::vector<CAlert> GenKey(std::string &outPriv, const std::string &networkName)\n     return alerts;\n }\n \n-void WriteTests(const std::string &testsFileName, const std::vector<CAlert> &alerts)\n+void WriteTests(const boost::filesystem::path &testsFileName, const std::vector<CAlert> &alerts)\n {\n-    CAutoFile est_fileout(fopen(testsFileName.c_str(), \"wb\"), SER_DISK, CLIENT_VERSION);\n-    est_fileout << alerts;\n+    CAutoFile fileout(fopen(testsFileName.string().c_str(), \"wb\"), SER_DISK, CLIENT_VERSION);\n+    if (!fileout)\n+    {\n+        fprintf(stderr, \"Could not write test data to %s, provide valid -testoutdir\\n\", testsFileName.string().c_str());\n+        exit(1);\n+    }\n+    fileout << alerts;\n }\n \n int GenAlertKey(int argc, char *argv[])\n@@ -122,11 +127,12 @@ int GenAlertKey(int argc, char *argv[])\n     outPriv += \"\\n\";\n     std::vector<CAlert> testsTestNet = GenKey(outPriv, \"TestNet\");\n \n-    printf(\"%s\\n\", outPriv.c_str());\n+    boost::filesystem::path testoutdir = GetArg(\"-testoutdir\", \"test/data\");\n \n-    WriteTests(\"test/data/alertTestsMainNet.raw\", testsMainNet);\n-    WriteTests(\"test/data/alertTestsTestNet.raw\", testsTestNet);\n+    WriteTests(testoutdir / \"alertTestsMainNet.raw\", testsMainNet);\n+    WriteTests(testoutdir / \"alertTestsTestNet.raw\", testsTestNet);\n \n+    printf(\"%s\\n\", outPriv.c_str());\n     return 0;\n }\n \n@@ -138,9 +144,9 @@ int main(int argc, char* argv[])\n         ret = GenAlertKey(argc, argv);\n     }\n     catch (std::exception& e) {\n-        PrintExceptionContinue(&e, \"CommandLineRPC()\");\n+        PrintExceptionContinue(&e, \"GenAlertKey()\");\n     } catch (...) {\n-        PrintExceptionContinue(NULL, \"CommandLineRPC()\");\n+        PrintExceptionContinue(NULL, \"GenAlertKey()\");\n     }\n     return ret;\n }"
      }
    ]
  },
  {
    "sha": "7ebfa0bd25422b1632e472af77d19f4a89ecce10",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3ZWJmYTBiZDI1NDIyYjE2MzJlNDcyYWY3N2QxOWY0YTg5ZWNjZTEw",
    "commit": {
      "author": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2014-09-09T11:52:33Z"
      },
      "committer": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2014-09-09T11:52:33Z"
      },
      "message": "squashme",
      "tree": {
        "sha": "af04c14fa541c6cd759156fa6c23a020b7174231",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/af04c14fa541c6cd759156fa6c23a020b7174231"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7ebfa0bd25422b1632e472af77d19f4a89ecce10",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7ebfa0bd25422b1632e472af77d19f4a89ecce10",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/7ebfa0bd25422b1632e472af77d19f4a89ecce10",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7ebfa0bd25422b1632e472af77d19f4a89ecce10/comments",
    "author": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "ea58720ff9df90c9d713e218e5751173011c7bd6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ea58720ff9df90c9d713e218e5751173011c7bd6",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/ea58720ff9df90c9d713e218e5751173011c7bd6"
      }
    ],
    "stats": {
      "total": 9,
      "additions": 7,
      "deletions": 2
    },
    "files": [
      {
        "sha": "170ffdd1bfa7ff075dc830c558f01f92a3ab3e0f",
        "filename": "src/bitcoin-genalertkey.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 2,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7ebfa0bd25422b1632e472af77d19f4a89ecce10/src/bitcoin-genalertkey.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7ebfa0bd25422b1632e472af77d19f4a89ecce10/src/bitcoin-genalertkey.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoin-genalertkey.cpp?ref=7ebfa0bd25422b1632e472af77d19f4a89ecce10",
        "patch": "@@ -1,9 +1,14 @@\n-#include \"main.h\"\n-#include \"net.h\"\n+// Copyright (c) 2014 The Bitcoin developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n #include \"alert.h\"\n #include \"util.h\"\n+#include \"utilstrencodings.h\"\n #include \"key.h\"\n \n+#include <boost/foreach.hpp>\n+\n //\n // alertTests contains 7 alerts, generated with this code:\n //"
      }
    ]
  }
]