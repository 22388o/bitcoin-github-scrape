[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/408890930",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13793#issuecomment-408890930",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13793",
    "id": 408890930,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwODg5MDkzMA==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-30T14:50:58Z",
    "updated_at": "2018-09-07T18:31:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->Note to reviewers: This pull request conflicts with the following ones:\n\n* #13804 (Transaction Pool Layer by MarcoFalke)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/408890930/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/416971497",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13793#issuecomment-416971497",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13793",
    "id": 416971497,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNjk3MTQ5Nw==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-29T14:21:16Z",
    "updated_at": "2018-08-29T14:21:16Z",
    "author_association": "MEMBER",
    "body": "utACK fa7b11eca5858d3c253dc12d146c50cde5763797",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/416971497/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/416985447",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13793#issuecomment-416985447",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13793",
    "id": 416985447,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQxNjk4NTQ0Nw==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-08-29T14:59:01Z",
    "updated_at": "2018-08-29T14:59:01Z",
    "author_association": "MEMBER",
    "body": "Rebased",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/416985447/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/205990912",
    "pull_request_review_id": 141363874,
    "id": 205990912,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwNTk5MDkxMg==",
    "diff_hunk": "@@ -370,12 +370,10 @@ void CTxMemPool::addUnchecked(const uint256& hash, const CTxMemPoolEntry &entry,\n     // Update transaction for any feeDelta created by PrioritiseTransaction\n     // TODO: refactor so that the fee delta is calculated before inserting\n     // into mapTx.\n-    std::map<uint256, CAmount>::const_iterator pos = mapDeltas.find(hash);\n-    if (pos != mapDeltas.end()) {\n-        const CAmount &delta = pos->second;\n-        if (delta) {\n+    CAmount delta{0};\n+    ApplyDelta(hash, delta);\n+    if (delta) {\n             mapTx.modify(newit, update_fee_delta(delta));",
    "path": "src/txmempool.cpp",
    "position": null,
    "original_position": 11,
    "commit_id": "faa1a749428a195af784633eb78e1df5d6a0e875",
    "original_commit_id": "fa752b748058a0b48b151d2d3016dcfed2629087",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: whitespace",
    "created_at": "2018-07-29T23:17:44Z",
    "updated_at": "2018-09-07T17:04:19Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13793#discussion_r205990912",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13793",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/205990912"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13793#discussion_r205990912"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13793"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/205990912/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 370,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/205991038",
    "pull_request_review_id": 141363974,
    "id": 205991038,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwNTk5MTAzOA==",
    "diff_hunk": "@@ -397,11 +395,8 @@ void CTxMemPool::addUnchecked(const uint256& hash, const CTxMemPoolEntry &entry,\n     // to clean up the mess we're leaving here.\n \n     // Update ancestors with information about this tx\n-    for (const uint256 &phash : setParentTransactions) {\n-        txiter pit = mapTx.find(phash);\n-        if (pit != mapTx.end()) {\n+    for (const auto& pit : GetSetIter(setParentTransactions)) {\n             UpdateParent(newit, pit, true);",
    "path": "src/txmempool.cpp",
    "position": null,
    "original_position": 24,
    "commit_id": "faa1a749428a195af784633eb78e1df5d6a0e875",
    "original_commit_id": "fa752b748058a0b48b151d2d3016dcfed2629087",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: whitespace",
    "created_at": "2018-07-29T23:20:42Z",
    "updated_at": "2018-09-07T17:04:19Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13793#discussion_r205991038",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13793",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/205991038"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13793#discussion_r205991038"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13793"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/205991038/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 393,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/205991222",
    "pull_request_review_id": 141364164,
    "id": 205991222,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwNTk5MTIyMg==",
    "diff_hunk": "@@ -397,11 +395,8 @@ void CTxMemPool::addUnchecked(const uint256& hash, const CTxMemPoolEntry &entry,\n     // to clean up the mess we're leaving here.\n \n     // Update ancestors with information about this tx\n-    for (const uint256 &phash : setParentTransactions) {\n-        txiter pit = mapTx.find(phash);\n-        if (pit != mapTx.end()) {\n+    for (const auto& pit : GetSetIter(setParentTransactions)) {",
    "path": "src/txmempool.cpp",
    "position": null,
    "original_position": 23,
    "commit_id": "faa1a749428a195af784633eb78e1df5d6a0e875",
    "original_commit_id": "fa752b748058a0b48b151d2d3016dcfed2629087",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: `txiter` instead of `auto`?",
    "created_at": "2018-07-29T23:25:22Z",
    "updated_at": "2018-09-07T17:04:19Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13793#discussion_r205991222",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13793",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/205991222"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13793#discussion_r205991222"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13793"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/205991222/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 398,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/206281479",
    "pull_request_review_id": 141667152,
    "id": 206281479,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwNjI4MTQ3OQ==",
    "diff_hunk": "@@ -565,7 +565,12 @@ class CTxMemPool\n     void ApplyDelta(const uint256 hash, CAmount &nFeeDelta) const;\n     void ClearPrioritisation(const uint256 hash);\n \n-public:\n+    /** Get the transaction in the pool that spends the same prevout */\n+    const CTransaction* GetConflictTx(const COutPoint& prevout) const EXCLUSIVE_LOCKS_REQUIRED(cs);\n+\n+    /** Translate a set of hashes into a set of pool iterators to avoid repeated lookups */\n+    setEntries GetSetIter(const std::set<uint256>& hashes) const EXCLUSIVE_LOCKS_REQUIRED(cs);",
    "path": "src/txmempool.h",
    "position": null,
    "original_position": 9,
    "commit_id": "faa1a749428a195af784633eb78e1df5d6a0e875",
    "original_commit_id": "fa752b748058a0b48b151d2d3016dcfed2629087",
    "user": {
      "login": "kallewoof",
      "id": 250224,
      "node_id": "MDQ6VXNlcjI1MDIyNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/250224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kallewoof",
      "html_url": "https://github.com/kallewoof",
      "followers_url": "https://api.github.com/users/kallewoof/followers",
      "following_url": "https://api.github.com/users/kallewoof/following{/other_user}",
      "gists_url": "https://api.github.com/users/kallewoof/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kallewoof/subscriptions",
      "organizations_url": "https://api.github.com/users/kallewoof/orgs",
      "repos_url": "https://api.github.com/users/kallewoof/repos",
      "events_url": "https://api.github.com/users/kallewoof/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kallewoof/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Nit: the name sounds like it's a getter + setter operator. Maybe call it `GetIterSet`?",
    "created_at": "2018-07-30T18:47:42Z",
    "updated_at": "2018-09-07T17:04:19Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13793#discussion_r206281479",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13793",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/206281479"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13793#discussion_r206281479"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13793"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/206281479/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 572,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/206281850",
    "pull_request_review_id": 141667152,
    "id": 206281850,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwNjI4MTg1MA==",
    "diff_hunk": "@@ -602,10 +602,8 @@ static bool AcceptToMemoryPoolWorker(const CChainParams& chainparams, CTxMemPool\n     std::set<uint256> setConflicts;\n     for (const CTxIn &txin : tx.vin)\n     {\n-        auto itConflicting = pool.mapNextTx.find(txin.prevout);\n-        if (itConflicting != pool.mapNextTx.end())\n-        {\n-            const CTransaction *ptxConflicting = itConflicting->second;\n+        const CTransaction* ptxConflicting = pool.GetConflictTx(txin.prevout);",
    "path": "src/validation.cpp",
    "position": 8,
    "original_position": 8,
    "commit_id": "faa1a749428a195af784633eb78e1df5d6a0e875",
    "original_commit_id": "fa752b748058a0b48b151d2d3016dcfed2629087",
    "user": {
      "login": "kallewoof",
      "id": 250224,
      "node_id": "MDQ6VXNlcjI1MDIyNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/250224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kallewoof",
      "html_url": "https://github.com/kallewoof",
      "followers_url": "https://api.github.com/users/kallewoof/followers",
      "following_url": "https://api.github.com/users/kallewoof/following{/other_user}",
      "gists_url": "https://api.github.com/users/kallewoof/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kallewoof/subscriptions",
      "organizations_url": "https://api.github.com/users/kallewoof/orgs",
      "repos_url": "https://api.github.com/users/kallewoof/repos",
      "events_url": "https://api.github.com/users/kallewoof/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kallewoof/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Nit: I think the convention is to not prefix variables with types anymore and to use `snake_case`.",
    "created_at": "2018-07-30T18:48:57Z",
    "updated_at": "2018-09-07T17:04:19Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13793#discussion_r206281850",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13793",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/206281850"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13793#discussion_r206281850"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13793"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/206281850/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 605,
    "original_line": 605,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/206284389",
    "pull_request_review_id": 141670932,
    "id": 206284389,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwNjI4NDM4OQ==",
    "diff_hunk": "@@ -602,10 +602,8 @@ static bool AcceptToMemoryPoolWorker(const CChainParams& chainparams, CTxMemPool\n     std::set<uint256> setConflicts;\n     for (const CTxIn &txin : tx.vin)\n     {\n-        auto itConflicting = pool.mapNextTx.find(txin.prevout);\n-        if (itConflicting != pool.mapNextTx.end())\n-        {\n-            const CTransaction *ptxConflicting = itConflicting->second;\n+        const CTransaction* ptxConflicting = pool.GetConflictTx(txin.prevout);",
    "path": "src/validation.cpp",
    "position": 8,
    "original_position": 8,
    "commit_id": "faa1a749428a195af784633eb78e1df5d6a0e875",
    "original_commit_id": "fa752b748058a0b48b151d2d3016dcfed2629087",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It is used in a couple of places further down, so I will keep the name for now.",
    "created_at": "2018-07-30T18:57:19Z",
    "updated_at": "2018-09-07T17:04:19Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13793#discussion_r206284389",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13793",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/206284389"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13793#discussion_r206284389"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13793"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/206284389/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 605,
    "original_line": 605,
    "side": "RIGHT",
    "in_reply_to_id": 206281850
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/206286165",
    "pull_request_review_id": 141673221,
    "id": 206286165,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwNjI4NjE2NQ==",
    "diff_hunk": "@@ -602,10 +602,8 @@ static bool AcceptToMemoryPoolWorker(const CChainParams& chainparams, CTxMemPool\n     std::set<uint256> setConflicts;\n     for (const CTxIn &txin : tx.vin)\n     {\n-        auto itConflicting = pool.mapNextTx.find(txin.prevout);\n-        if (itConflicting != pool.mapNextTx.end())\n-        {\n-            const CTransaction *ptxConflicting = itConflicting->second;\n+        const CTransaction* ptxConflicting = pool.GetConflictTx(txin.prevout);",
    "path": "src/validation.cpp",
    "position": 8,
    "original_position": 8,
    "commit_id": "faa1a749428a195af784633eb78e1df5d6a0e875",
    "original_commit_id": "fa752b748058a0b48b151d2d3016dcfed2629087",
    "user": {
      "login": "kallewoof",
      "id": 250224,
      "node_id": "MDQ6VXNlcjI1MDIyNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/250224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kallewoof",
      "html_url": "https://github.com/kallewoof",
      "followers_url": "https://api.github.com/users/kallewoof/followers",
      "following_url": "https://api.github.com/users/kallewoof/following{/other_user}",
      "gists_url": "https://api.github.com/users/kallewoof/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kallewoof/subscriptions",
      "organizations_url": "https://api.github.com/users/kallewoof/orgs",
      "repos_url": "https://api.github.com/users/kallewoof/repos",
      "events_url": "https://api.github.com/users/kallewoof/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kallewoof/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Weird, it looked like you renamed `itConflicting` to `ptxConflicting`, but `ptxConflicting` existed already. My bad.",
    "created_at": "2018-07-30T19:03:04Z",
    "updated_at": "2018-09-07T17:04:19Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13793#discussion_r206286165",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13793",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/206286165"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13793#discussion_r206286165"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13793"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/206286165/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 605,
    "original_line": 605,
    "side": "RIGHT",
    "in_reply_to_id": 206281850
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/206303557",
    "pull_request_review_id": 141695107,
    "id": 206303557,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIwNjMwMzU1Nw==",
    "diff_hunk": "@@ -565,7 +565,12 @@ class CTxMemPool\n     void ApplyDelta(const uint256 hash, CAmount &nFeeDelta) const;\n     void ClearPrioritisation(const uint256 hash);\n \n-public:\n+    /** Get the transaction in the pool that spends the same prevout */\n+    const CTransaction* GetConflictTx(const COutPoint& prevout) const EXCLUSIVE_LOCKS_REQUIRED(cs);\n+\n+    /** Translate a set of hashes into a set of pool iterators to avoid repeated lookups */\n+    setEntries GetSetIter(const std::set<uint256>& hashes) const EXCLUSIVE_LOCKS_REQUIRED(cs);",
    "path": "src/txmempool.h",
    "position": null,
    "original_position": 9,
    "commit_id": "faa1a749428a195af784633eb78e1df5d6a0e875",
    "original_commit_id": "fa752b748058a0b48b151d2d3016dcfed2629087",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Renamed to `GetIterSet` according to your feedback",
    "created_at": "2018-07-30T20:07:04Z",
    "updated_at": "2018-09-07T17:04:19Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13793#discussion_r206303557",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13793",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/206303557"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13793#discussion_r206303557"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13793"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/206303557/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 572,
    "side": "RIGHT",
    "in_reply_to_id": 206281479
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/213687775",
    "pull_request_review_id": 150573846,
    "id": 213687775,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMzY4Nzc3NQ==",
    "diff_hunk": "@@ -875,6 +870,22 @@ void CTxMemPool::ClearPrioritisation(const uint256 hash)\n     mapDeltas.erase(hash);\n }\n \n+const CTransaction* CTxMemPool::GetConflictTx(const COutPoint& prevout) const\n+{\n+    const auto it = mapNextTx.find(prevout);\n+    return it == mapNextTx.end() ? nullptr : it->second;\n+}\n+\n+CTxMemPool::setEntries CTxMemPool::GetIterSet(const std::set<uint256>& hashes) const\n+{\n+    CTxMemPool::setEntries ret;",
    "path": "src/txmempool.cpp",
    "position": 61,
    "original_position": 41,
    "commit_id": "faa1a749428a195af784633eb78e1df5d6a0e875",
    "original_commit_id": "fa7b11eca5858d3c253dc12d146c50cde5763797",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "as the result is only ever used to iterate over, and the input is already unique, does this need to return a set? I guess a std::list would be a better match\r\n",
    "created_at": "2018-08-29T13:57:28Z",
    "updated_at": "2018-09-07T17:04:19Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13793#discussion_r213687775",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13793",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/213687775"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13793#discussion_r213687775"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13793"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/213687775/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 877,
    "original_line": 877,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/213689984",
    "pull_request_review_id": 150576766,
    "id": 213689984,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxMzY4OTk4NA==",
    "diff_hunk": "@@ -875,6 +870,22 @@ void CTxMemPool::ClearPrioritisation(const uint256 hash)\n     mapDeltas.erase(hash);\n }\n \n+const CTransaction* CTxMemPool::GetConflictTx(const COutPoint& prevout) const\n+{\n+    const auto it = mapNextTx.find(prevout);\n+    return it == mapNextTx.end() ? nullptr : it->second;\n+}\n+\n+CTxMemPool::setEntries CTxMemPool::GetIterSet(const std::set<uint256>& hashes) const\n+{\n+    CTxMemPool::setEntries ret;",
    "path": "src/txmempool.cpp",
    "position": 61,
    "original_position": 41,
    "commit_id": "faa1a749428a195af784633eb78e1df5d6a0e875",
    "original_commit_id": "fa7b11eca5858d3c253dc12d146c50cde5763797",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "OK I guess I'm wrong, there might be duplicate parents",
    "created_at": "2018-08-29T14:03:05Z",
    "updated_at": "2018-09-07T17:04:19Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13793#discussion_r213689984",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13793",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/213689984"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13793#discussion_r213689984"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13793"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/213689984/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 877,
    "original_line": 877,
    "side": "RIGHT",
    "in_reply_to_id": 213687775
  }
]