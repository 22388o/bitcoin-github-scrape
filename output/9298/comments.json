[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/265449802",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9298#issuecomment-265449802",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9298",
    "id": 265449802,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTQ0OTgwMg==",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-07T13:42:26Z",
    "updated_at": "2016-12-07T13:42:26Z",
    "author_association": "MEMBER",
    "body": "Can you explain a bit of motivation for this?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/265449802/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/265455890",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9298#issuecomment-265455890",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9298",
    "id": 265455890,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTQ1NTg5MA==",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?u=eab5d0cdbb6cc25087cb61d4ca4a6f85255f42a7&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-07T14:09:16Z",
    "updated_at": "2016-12-07T14:09:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Can you explain a bit of motivation for this?\r\n\r\nSure. Sorry for leaving that out in the main description.\r\n\r\n1.) Reduce amount of stored data in wallet.dat\r\n2.) Don't expose each child private key in wallet.dat\r\n3.) Lays groundwork for public key derivation in conjunction with a signing device.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/265455890/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/265749903",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9298#issuecomment-265749903",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9298",
    "id": 265749903,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTc0OTkwMw==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-08T14:17:20Z",
    "updated_at": "2016-12-08T14:17:20Z",
    "author_association": "MEMBER",
    "body": "> 2.) Don't expose each child private key in wallet.dat\n\n\nI think this means salvagewallet no longer works for hd wallets as it\npreviously did. This could potentially lead to loss of coins for\ninexperienced users, because it is currently not easily possible to\nrecover the HD wallet after salvagewallet, nor is is possible to\nrecover the child keys, if they are not saved...\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/265749903/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/265784179",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9298#issuecomment-265784179",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9298",
    "id": 265784179,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2NTc4NDE3OQ==",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?u=eab5d0cdbb6cc25087cb61d4ca4a6f85255f42a7&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-08T16:27:21Z",
    "updated_at": "2016-12-08T16:27:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "> I think this means salvagewallet no longer works for hd wallets as it\r\npreviously did. \r\n\r\nRight. This is a good point.\r\nHowever, I think we should do the following also for \"normal\" wallets.\r\n\r\n1. We already recover the hdchain (child key counter, private key id thats used for the HD master key).\r\n2. Don't abort if a privat-key is corrupted, instead...\r\n3. Recreate all keys up to the child-key-counter (CHDChain object)\r\n\r\nBefore implementing this, I think some Concept ACKs/NACKs would be required.\r\n@sipa, @gmaxwell: thoughts?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/265784179/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/370860024",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9298#issuecomment-370860024",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9298",
    "id": 370860024,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MDg2MDAyNA==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-06T17:25:17Z",
    "updated_at": "2018-03-06T17:25:17Z",
    "author_association": "MEMBER",
    "body": "@jonasschnelli I think this is generally the direction to go in, and it's also part of what my idea for refactoring accomplishes in a different way (https://gist.github.com/sipa/125cfa1615946d0c3f3eec2ad7f250a2). Do you think this is worth pursuing on its own?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/370860024/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/437192719",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9298#issuecomment-437192719",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9298",
    "id": 437192719,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNzE5MjcxOQ==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-08T23:20:49Z",
    "updated_at": "2018-11-08T23:20:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--5fd3d806e98f4a0ca80977bb178665a0-->There hasn't been much activity lately and the patch still needs rebase, so I am closing this for now. Please let me know when you want to continue working on this, so the pull request can be re-opened.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/437192719/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/91512529",
    "pull_request_review_id": 12020854,
    "id": 91512529,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDkxNTEyNTI5",
    "diff_hunk": "@@ -83,6 +83,7 @@ enum WalletFeature\n     FEATURE_COMPRPUBKEY = 60000, // compressed public keys\n \n     FEATURE_HD = 130000, // Hierarchical key derivation after BIP32 (HD Wallet)\n+    FEATURE_WITH_HD_PUBKEY = 139900, // Hierarchical key derivation after BIP32 (HD Wallet)",
    "path": "src/wallet/wallet.h",
    "position": null,
    "original_position": 4,
    "commit_id": "3fd850ae5e5f0e167e63782501886d7e114482e0",
    "original_commit_id": "2b61ef8d2aeb6143c6bc04311a3a4089d38bd19e",
    "user": {
      "login": "paveljanik",
      "id": 6848764,
      "node_id": "MDQ6VXNlcjY4NDg3NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6848764?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paveljanik",
      "html_url": "https://github.com/paveljanik",
      "followers_url": "https://api.github.com/users/paveljanik/followers",
      "following_url": "https://api.github.com/users/paveljanik/following{/other_user}",
      "gists_url": "https://api.github.com/users/paveljanik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paveljanik/subscriptions",
      "organizations_url": "https://api.github.com/users/paveljanik/orgs",
      "repos_url": "https://api.github.com/users/paveljanik/repos",
      "events_url": "https://api.github.com/users/paveljanik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paveljanik/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The comment here should be different compared to the `FEATURE_HD`.",
    "created_at": "2016-12-08T13:27:43Z",
    "updated_at": "2017-02-16T11:39:00Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9298#discussion_r91512529",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9298",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/91512529"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9298#discussion_r91512529"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9298"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/91512529/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 86,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/91512721",
    "pull_request_review_id": 12021059,
    "id": 91512721,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDkxNTEyNzIx",
    "diff_hunk": "@@ -2475,7 +2583,7 @@ bool CWallet::CreateTransaction(const vector<CRecipient>& vecSend, CWalletTx& wt\n \n                     if (!signSuccess)\n                     {\n-                        strFailReason = _(\"Signing transaction failed\");\n+                        strFailReason = _(\"Signing transaction failed \")+(sign ? std::string(\"yes\"): std::string(\"no\"));",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 172,
    "commit_id": "3fd850ae5e5f0e167e63782501886d7e114482e0",
    "original_commit_id": "2b61ef8d2aeb6143c6bc04311a3a4089d38bd19e",
    "user": {
      "login": "paveljanik",
      "id": 6848764,
      "node_id": "MDQ6VXNlcjY4NDg3NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6848764?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paveljanik",
      "html_url": "https://github.com/paveljanik",
      "followers_url": "https://api.github.com/users/paveljanik/followers",
      "following_url": "https://api.github.com/users/paveljanik/following{/other_user}",
      "gists_url": "https://api.github.com/users/paveljanik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paveljanik/subscriptions",
      "organizations_url": "https://api.github.com/users/paveljanik/orgs",
      "repos_url": "https://api.github.com/users/paveljanik/repos",
      "events_url": "https://api.github.com/users/paveljanik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paveljanik/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "SPC added to the already translated string? Yes/No here?",
    "created_at": "2016-12-08T13:28:58Z",
    "updated_at": "2017-02-16T11:39:00Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9298#discussion_r91512721",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9298",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/91512721"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9298#discussion_r91512721"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9298"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/91512721/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2586,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143737699",
    "pull_request_review_id": 68292394,
    "id": 143737699,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE0MzczNzY5OQ==",
    "diff_hunk": "@@ -154,11 +157,116 @@ void CWallet::DeriveNewChildKey(CKeyMetadata& metadata, CKey& secret)\n         // increment childkey index\n         hdChain.nExternalChainCounter++;\n     } while (HaveKey(childKey.key.GetPubKey().GetID()));\n+\n     secret = childKey.key;\n \n+    CPubKey pubkey = secret.GetPubKey();\n+    assert(secret.VerifyPubKey(pubkey));\n+\n+    // store metadata\n+    mapKeyMetadata[pubkey.GetID()] = metadata;",
    "path": "src/wallet/wallet.cpp",
    "position": 52,
    "original_position": 52,
    "commit_id": "3fd850ae5e5f0e167e63782501886d7e114482e0",
    "original_commit_id": "3fd850ae5e5f0e167e63782501886d7e114482e0",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This could stay in `GenerateNewKey`?",
    "created_at": "2017-10-10T14:05:41Z",
    "updated_at": "2017-10-10T14:15:14Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9298#discussion_r143737699",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9298",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143737699"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9298#discussion_r143737699"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9298"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143737699/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 167,
    "original_line": 167,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143737850",
    "pull_request_review_id": 68292394,
    "id": 143737850,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE0MzczNzg1MA==",
    "diff_hunk": "@@ -154,11 +157,116 @@ void CWallet::DeriveNewChildKey(CKeyMetadata& metadata, CKey& secret)\n         // increment childkey index\n         hdChain.nExternalChainCounter++;\n     } while (HaveKey(childKey.key.GetPubKey().GetID()));\n+\n     secret = childKey.key;\n \n+    CPubKey pubkey = secret.GetPubKey();\n+    assert(secret.VerifyPubKey(pubkey));\n+\n+    // store metadata\n+    mapKeyMetadata[pubkey.GetID()] = metadata;\n+    if (!nTimeFirstKey || metadata.nCreateTime < nTimeFirstKey)",
    "path": "src/wallet/wallet.cpp",
    "position": 53,
    "original_position": 53,
    "commit_id": "3fd850ae5e5f0e167e63782501886d7e114482e0",
    "original_commit_id": "3fd850ae5e5f0e167e63782501886d7e114482e0",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "After rebase use `UpdateTimeFirstKey()`. Also could stay in `GenerateNewKey`?",
    "created_at": "2017-10-10T14:06:11Z",
    "updated_at": "2017-10-10T14:15:14Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9298#discussion_r143737850",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9298",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143737850"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9298#discussion_r143737850"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9298"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143737850/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 168,
    "original_line": 168,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143740223",
    "pull_request_review_id": 68292394,
    "id": 143740223,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE0Mzc0MDIyMw==",
    "diff_hunk": "@@ -154,11 +157,116 @@ void CWallet::DeriveNewChildKey(CKeyMetadata& metadata, CKey& secret)\n         // increment childkey index\n         hdChain.nExternalChainCounter++;\n     } while (HaveKey(childKey.key.GetPubKey().GetID()));\n+\n     secret = childKey.key;\n \n+    CPubKey pubkey = secret.GetPubKey();\n+    assert(secret.VerifyPubKey(pubkey));\n+\n+    // store metadata\n+    mapKeyMetadata[pubkey.GetID()] = metadata;\n+    if (!nTimeFirstKey || metadata.nCreateTime < nTimeFirstKey)\n+        nTimeFirstKey = metadata.nCreateTime;\n+\n     // update the chain model in the database\n     if (!CWalletDB(strWalletFile).WriteHDChain(hdChain))\n         throw std::runtime_error(std::string(__func__) + \": Writing HD chain model failed\");\n+\n+    if (CanSupportFeature(FEATURE_WITH_HD_PUBKEY))\n+    {\n+        if (!AddHDPubKey(childKey.Neuter()))\n+            throw std::runtime_error(std::string(__func__) + \": AddKey failed\");\n+    }\n+    else\n+    {\n+        if (!AddKeyPubKey(secret, pubkey))\n+            throw std::runtime_error(std::string(__func__) + \": AddKey failed\");\n+    }\n+}\n+\n+bool CWallet::GetPubKey(const CKeyID &address, CPubKey& vchPubKeyOut) const\n+{\n+    LOCK(cs_wallet);\n+    std::map<CKeyID, CHDPubKey>::const_iterator mi = mapHdPubKeys.find(address);\n+    if (mi != mapHdPubKeys.end())\n+    {\n+        const CHDPubKey &hdPubKey = (*mi).second;\n+        vchPubKeyOut = hdPubKey.extPubKey.pubkey;\n+        return true;\n+    }\n+    else\n+        return CCryptoKeyStore::GetPubKey(address, vchPubKeyOut);\n+}\n+\n+bool CWallet::GetKey(const CKeyID &address, CKey& keyOut) const\n+{\n+    LOCK(cs_wallet);\n+    std::map<CKeyID, CHDPubKey>::const_iterator mi = mapHdPubKeys.find(address);\n+    if (mi != mapHdPubKeys.end())\n+    {\n+        // if the key has been found in mapHdPubKeys, derive it on the fly\n+        const CHDPubKey &hdPubKey = (*mi).second;\n+\n+        // TODO: refactor with DeriveNewChildKey\n+        CKey key;                      //master key seed (256bit)\n+        CExtKey masterKey;             //hd master key\n+        CExtKey accountKey;            //key at m/0'\n+        CExtKey externalChainChildKey; //key at m/0'/0'\n+        CExtKey childKey;              //key at m/0'/0'/<n>'\n+\n+        // try to get the master key\n+        if (!GetKey(hdPubKey.masterKeyID, key))\n+            return false;\n+\n+        masterKey.SetMaster(key.begin(), key.size());\n+        masterKey.Derive(accountKey, BIP32_HARDENED_KEY_LIMIT);\n+        accountKey.Derive(externalChainChildKey, BIP32_HARDENED_KEY_LIMIT);\n+        externalChainChildKey.Derive(childKey, hdPubKey.extPubKey.nChild);\n+        keyOut = childKey.key;\n+        return true;\n+    }\n+    else\n+        return CCryptoKeyStore::GetKey(address, keyOut);\n+}\n+\n+bool CWallet::HaveKey(const CKeyID &address) const\n+{\n+    LOCK(cs_wallet);\n+    if (mapHdPubKeys.count(address) > 0)\n+        return true;\n+    return CCryptoKeyStore::HaveKey(address);\n+}\n+\n+bool CWallet::LoadHDPubKey(const CHDPubKey &hdPubKey)\n+{\n+    AssertLockHeld(cs_wallet); // mapKeyMetadata",
    "path": "src/wallet/wallet.cpp",
    "position": 127,
    "original_position": 127,
    "commit_id": "3fd850ae5e5f0e167e63782501886d7e114482e0",
    "original_commit_id": "3fd850ae5e5f0e167e63782501886d7e114482e0",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Wrong comment.",
    "created_at": "2017-10-10T14:14:09Z",
    "updated_at": "2017-10-10T14:15:14Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9298#discussion_r143740223",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9298",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143740223"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9298#discussion_r143740223"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9298"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143740223/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 242,
    "original_line": 242,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143740258",
    "pull_request_review_id": 68292394,
    "id": 143740258,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE0Mzc0MDI1OA==",
    "diff_hunk": "@@ -154,11 +157,116 @@ void CWallet::DeriveNewChildKey(CKeyMetadata& metadata, CKey& secret)\n         // increment childkey index\n         hdChain.nExternalChainCounter++;\n     } while (HaveKey(childKey.key.GetPubKey().GetID()));\n+\n     secret = childKey.key;\n \n+    CPubKey pubkey = secret.GetPubKey();\n+    assert(secret.VerifyPubKey(pubkey));\n+\n+    // store metadata\n+    mapKeyMetadata[pubkey.GetID()] = metadata;\n+    if (!nTimeFirstKey || metadata.nCreateTime < nTimeFirstKey)\n+        nTimeFirstKey = metadata.nCreateTime;\n+\n     // update the chain model in the database\n     if (!CWalletDB(strWalletFile).WriteHDChain(hdChain))\n         throw std::runtime_error(std::string(__func__) + \": Writing HD chain model failed\");\n+\n+    if (CanSupportFeature(FEATURE_WITH_HD_PUBKEY))\n+    {\n+        if (!AddHDPubKey(childKey.Neuter()))\n+            throw std::runtime_error(std::string(__func__) + \": AddKey failed\");\n+    }\n+    else\n+    {\n+        if (!AddKeyPubKey(secret, pubkey))\n+            throw std::runtime_error(std::string(__func__) + \": AddKey failed\");\n+    }\n+}\n+\n+bool CWallet::GetPubKey(const CKeyID &address, CPubKey& vchPubKeyOut) const\n+{\n+    LOCK(cs_wallet);\n+    std::map<CKeyID, CHDPubKey>::const_iterator mi = mapHdPubKeys.find(address);\n+    if (mi != mapHdPubKeys.end())\n+    {\n+        const CHDPubKey &hdPubKey = (*mi).second;\n+        vchPubKeyOut = hdPubKey.extPubKey.pubkey;\n+        return true;\n+    }\n+    else\n+        return CCryptoKeyStore::GetPubKey(address, vchPubKeyOut);\n+}\n+\n+bool CWallet::GetKey(const CKeyID &address, CKey& keyOut) const\n+{\n+    LOCK(cs_wallet);\n+    std::map<CKeyID, CHDPubKey>::const_iterator mi = mapHdPubKeys.find(address);\n+    if (mi != mapHdPubKeys.end())\n+    {\n+        // if the key has been found in mapHdPubKeys, derive it on the fly\n+        const CHDPubKey &hdPubKey = (*mi).second;\n+\n+        // TODO: refactor with DeriveNewChildKey\n+        CKey key;                      //master key seed (256bit)\n+        CExtKey masterKey;             //hd master key\n+        CExtKey accountKey;            //key at m/0'\n+        CExtKey externalChainChildKey; //key at m/0'/0'\n+        CExtKey childKey;              //key at m/0'/0'/<n>'\n+\n+        // try to get the master key\n+        if (!GetKey(hdPubKey.masterKeyID, key))\n+            return false;\n+\n+        masterKey.SetMaster(key.begin(), key.size());\n+        masterKey.Derive(accountKey, BIP32_HARDENED_KEY_LIMIT);\n+        accountKey.Derive(externalChainChildKey, BIP32_HARDENED_KEY_LIMIT);\n+        externalChainChildKey.Derive(childKey, hdPubKey.extPubKey.nChild);\n+        keyOut = childKey.key;\n+        return true;\n+    }\n+    else\n+        return CCryptoKeyStore::GetKey(address, keyOut);\n+}\n+\n+bool CWallet::HaveKey(const CKeyID &address) const\n+{\n+    LOCK(cs_wallet);\n+    if (mapHdPubKeys.count(address) > 0)\n+        return true;\n+    return CCryptoKeyStore::HaveKey(address);\n+}\n+\n+bool CWallet::LoadHDPubKey(const CHDPubKey &hdPubKey)\n+{\n+    AssertLockHeld(cs_wallet); // mapKeyMetadata\n+\n+    mapHdPubKeys[hdPubKey.extPubKey.pubkey.GetID()] = hdPubKey;\n+    return true;\n+}\n+\n+bool CWallet::AddHDPubKey(const CExtPubKey &extPubKey)\n+{\n+    AssertLockHeld(cs_wallet); // mapKeyMetadata",
    "path": "src/wallet/wallet.cpp",
    "position": 135,
    "original_position": 135,
    "commit_id": "3fd850ae5e5f0e167e63782501886d7e114482e0",
    "original_commit_id": "3fd850ae5e5f0e167e63782501886d7e114482e0",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Wrong comment.",
    "created_at": "2017-10-10T14:14:18Z",
    "updated_at": "2017-10-10T14:15:14Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9298#discussion_r143740258",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9298",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143740258"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9298#discussion_r143740258"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9298"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/143740258/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 250,
    "original_line": 250,
    "side": "RIGHT"
  }
]