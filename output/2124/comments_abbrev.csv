CodeShark,2012-12-23T13:39:54Z,"It's a work in progress and can certainly be improved. I welcome all comments, suggestions, criticisms, and witty insults.\n",https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-11646195,11646195,
Diapolo,2012-12-23T13:59:48Z,Would it be better or possible to use references instead of pointers in your code?\n,https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-11646362,11646362,
CodeShark,2012-12-23T14:41:11Z,"Possible, sure. Better, why?\n",https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-11646657,11646657,
CodeShark,2012-12-23T14:44:13Z,The sanity test failed because the test suite uses the old RPC function prototype. I was still able to build and run using\n- make -f makefile.unix bitcoind\n,https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-11646687,11646687,
rebroad,2012-12-23T14:52:25Z,"This may be an opportunity to move away from the wallets being called ""wallet.dat"", which makes it all the more easier for malware to steal the contents.\n",https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-11646770,11646770,
CodeShark,2012-12-24T03:48:35Z,"You can now specify additional wallets in the config file or via command line arguments:\n\n```\nusewallet=foo\n```\n\nor\n\n```\nbitcoind -usewallet=foo\n```\n\nA default wallet called """" in the RPC and using file ""wallet.dat"" is always loaded, as to not break compatibility with the master branch. Therefore, additional wallets should neither be called ""default"" nor ""wallet"".\n\nThe wallet will be",https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-11653964,11653964,
CodeShark,2012-12-24T17:14:20Z,"The getinfo RPC method now returns an array of wallets each with wallet-specific information. This change is, unfortunately, not backwards compatible. However, it doesn't really seem to make sense to make this call wallet-specific. And returning an array of wallets seems to be a very useful feature.\n",https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-11663549,11663549,
gmaxwell,2012-12-24T19:13:47Z,"An alternative would be to move that data out of getinfo and into a getwallet info. Part of the reason to do that is that the wallet outputs in getinfo can be rather slow already, and doing them for N wallets won't help matters.  (Though lets see if anyone else has an opinion, I could be on drugs here)\n",https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-11664914,11664914,
CodeShark,2012-12-24T19:20:31Z,"I was thinking listwallets should maybe show all this information with a verbose option. Without the verbose option, it would just give a list of the wallet names.\n",https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-11664968,11664968,
gmaxwell,2012-12-24T20:03:50Z,Hm. From the perspective of the RPC as a CLI the use of verbose flags isn't especially discoverableâ€” for something basic like 'get your balances' that is probably worth exposing at the top level. ::shrugs::\n,https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-11665363,11665363,
CodeShark,2012-12-24T20:10:08Z,What about making the full info the default and having an option to shorten it? That way interactive users get relevant information while application developers seeking to improve performance have an option to do so if they don't need all that information. Of course we can just have two distinct RPC methods...but I'd rather avoid having too many RPC calls when the semantics are similar.\n,https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-11665402,11665402,
CodeShark,2012-12-24T20:14:45Z,"I do think that the wallet information should be completely removed from getinfo, though.\n\nAnyhow, this is the kind of stuff that's really easy to implement and change up front but becomes a serious problem to change once people start using it to build applications. I'd also like to hear several more opinions on this before committing to anything specific.\n",https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-11665446,11665446,
CodeShark,2012-12-24T20:38:31Z,Another issue I'm wondering about is programmatic access to the config file. We could just append the new wallets to the end of the file whenever they are created - but it would be nice to be able to have tags for sections. Presumably whenever a user creates a new wallet they want it to be loaded at next startup unless they explicitly remove it from the config file.\n,https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-11665629,11665629,
mikegogulski,2012-12-25T00:14:00Z,Multiple wallet support came into my head as I was doing https://github.com/bitcoin/bitcoin/pull/2075 but I left it aside in favor of trying to move the code in the direction of further modularization improvements between the RPC interface and the wallet and the wallet database as a prerequisite. I put off coding there since I expected something like this to come along and because commentary on th,https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-11667374,11667374,
CodeShark,2012-12-25T05:36:35Z,"As for the OO stuff, I would like to abstract things further and define a listener interface, a transaction store interface, and a key store interface. Technically speaking, a signing agent doesn't even need to store complete transactions. Private keys and unspent outpoints are all it needs. Furthermore, a listening agent could send alerts to other components without the need to store any transact",https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-11669414,11669414,
sipa,2012-12-25T17:48:00Z,"In general: I'm very much in favor of having native support for multiple wallets. Wallet stuff hasn't been a priority for some time, but if necessary I'd like to help to get this working.\n\nRegarding the idea of separating wallets for block chain processing: sure, that's definitely where we need to go in the future. Ideally, I think the code evolves to separate wallet and the rest along a clean i",https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-11674953,11674953,
mikegogulski,2012-12-25T21:14:26Z,"On the wallet site of things, IMHO, we could think about switching the interface to JSON-RPC for all interaction with the wallet object(s) and database(s), which would eventually enable bitcoin-qt to talk to wallets on report machines over SSL/TLS. That's painful to tackle all at once, though, since there's plenty of code outside the RPC bundle right now that depends on wallet internals and a whil",https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-11676540,11676540,
rebroad,2012-12-25T22:03:28Z,"This pull request is confusing me as it's raised by a different user to the user making the commits.. (or maybe I don't understand github correctly). Also, I'm wondering if such a thing as a ""roadmap"" exists for bitcoind/bitcoin-qt. I'm thinking that perhaps the project could be split into two binaries, one that deals with the P2P stuff and sending/receiving tx/blocks, and the other that deals wit",https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-11678261,11678261,
CodeShark,2012-12-25T22:09:47Z,"Both users are me. I don't use my CodeShark identity for pushes, though. CodeShark is reserved for github.\n",https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-11678294,11678294,
CodeShark,2012-12-27T16:54:15Z,"Dynamic wallet loading is essentially complete. An important issue that needs to be resolved prior to any integration is making sure its use of LOCKs on threads is ok. Error handling on initialization is also not super smooth, but that's more an issue with AppInit2 generally. At this point I mostly just want to polish up what's there, fix any potential bugs or serious issues, leave this branch alo",https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-11712207,11712207,
CodeShark,2013-01-14T06:53:13Z,"Hmm, still having some issues with the default wallet not unloading at shutdown. Will need to go over the shutdown sequence to make sure all threads relinquish their pointers to it.\n",https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-12208298,12208298,
gavinandresen,2013-01-14T16:08:21Z,"Just to set expectations:\n\nThis big a change, in this critical a part of the codebase, will need:\n- A comprehensive test plan, that exercises all the things that have changed.\n- Testing by at least two different people who aren't developers, on Windows and either Linux or Mac\n\nSee https://github.com/bitcoin/QA  for the lastest QA process.\n",https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-12225200,12225200,
BitcoinPullTester,2013-01-24T05:56:56Z,"Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/1c45edce2fbe76f7e146ee12c1df80c66c5fa8f9 for binaries and test log.\n",https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-12638631,12638631,
BitcoinPullTester,2013-09-16T21:58:54Z,"Automatic sanity-testing: FAILED MERGE, see http://jenkins.bluematt.me/pull-tester/6c7f86ae371f955371fba05c7f747e4659cd39c8 for test log.\n\nThis pull does not merge cleanly onto current master\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is mo",https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-24548265,24548265,
MrLei,2013-10-04T17:02:19Z,How i can install bitcoind whit Dynamically Loadable Multiple Wallet ?\n,https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-25714323,25714323,
gavinandresen,2013-10-21T01:10:26Z,Rebase needed.\n,https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-26687961,26687961,
Tranz5,2013-11-13T04:02:38Z,This is awesome work. I hope it makes it way to BTC soon.   I've been playing with it for a bit now. Here are the issues I am working through. \n1) Export doesn't work. ( Tried making BitCoinGui exportAction public and referencing it in WalletView::gotoHistoryPage but that only gives me default wallet) Still working on different methods to fix this.\n2) The RPC commands loadwallet and unloadwallet,https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-28362140,28362140,
Tranz5,2013-12-01T05:33:48Z,"I also found that sign message didn't work with other wallets. \n\nI have found a solution to all of these. \n\nI can do a pull request to this version, if this actually has a chance to be part of btc.  I don't have time to rebase though. \n\nThanks!\n",https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-29567817,29567817,
bananas2,2014-03-24T02:39:05Z,Is it already implemented?\n,https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-38408151,38408151,
laanwj,2014-03-24T07:12:29Z,"No, the pull request was not kept up to date. I needs a lot of rebasing to apply to 0.9.x, which Gavin already noted 5 months ago.\n",https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-38416964,38416964,
laanwj,2014-04-03T12:16:20Z,"I'm going to close this. It has diverged too much from the current code base and no one seems to be interested in rebasing it.\n\nIn case anyone ever wants to have a shot at implementing multi-wallet I'll refer to to these code changes, as in principle they are good but they just arrived at the wrong time and were not kept in sync long enough to be tested properly and merged.\n",https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-39443830,39443830,
6coind,2015-12-19T22:09:15Z,Noone can re-base this ? Amazing that this did not become the standard \n,https://github.com/bitcoin/bitcoin/pull/2124#issuecomment-166030187,166030187,
sipa,2012-12-25T17:34:10Z,"This will need to lock the appropriate wallet (if any), not pwalletMain.\n",https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2501045,2501045,src/bitcoinrpc.cpp
sipa,2012-12-25T17:35:25Z,"pWalletMap can be allocated statically, I believe.\n",https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2501046,2501046,src/init.cpp
sipa,2012-12-25T17:36:52Z,You may want to use an auto_ptr to make this cleanup happen automatically.\n,https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2501049,2501049,src/wallet.h
CodeShark,2012-12-25T21:37:10Z,"A problem is that it is declared in both init.cpp and test_bitcoin.cpp - and these globals must be accessible from rpcwallet.cpp as well, which includes init.h for the externs. I would prefer the wallet RPC calls to be placed in an RPC class which takes a wallet map in its constructor - and then we could remove any dependencies on these externs entirely and restrict the variable scope to init.cpp ",https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2501250,2501250,src/init.cpp
CodeShark,2012-12-25T21:41:35Z,I was thinking to expand this class to also handle loading of wallets from config parameters.\n\nPerhaps init.cpp could pass io context stuff to the loader method so that the loader method needn't call printf directly.\n,https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2501256,2501256,src/wallet.h
CodeShark,2012-12-29T21:19:36Z,Probably should use pWalletMap->GetDefaultWallet() wherever pwalletMain appears anywhere in the application.\n,https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2520521,2520521,src/bitcoinrpc.cpp
CodeShark,2012-12-29T21:44:34Z,Should use pWalletMap->GetWallet(strWalletMap);\n,https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2520539,2520539,src/rpcwallet.cpp
CodeShark,2012-12-29T22:22:37Z,I would prefer not to have to access pWalletMap->wallets directly...but using BOOST_FOREACH like this is quite convenient.\n,https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2520581,2520581,src/rpcwallet.cpp
sipa,2013-01-06T00:55:55Z,I don't think you want to keep the walletmap locked during the actual RPC execution.\n,https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2559184,2559184,src/bitcoinrpc.cpp
sipa,2013-01-06T00:56:31Z,Doesn't RPCConvertValues need some magic to deal with usewallet?\n,https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2559186,2559186,src/bitcoinrpc.cpp
sipa,2013-01-06T00:59:42Z,What is this? Seems unrelated to the pull request...\n,https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2559188,2559188,src/keystore.cpp
sipa,2013-01-06T01:02:30Z,"You can implement an iterator for CWalletMap, if you really want BOOST_FOREACH.\n",https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2559193,2559193,src/rpcwallet.cpp
sipa,2013-01-06T01:04:39Z,Just use _path.string(). \n,https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2559195,2559195,src/util.cpp
sipa,2013-01-06T01:08:19Z,"Is there an actual need for this critsect to be exposed publically? Ideally (and I know a lot of old code offends against this horribly), critical sections are private and only taken by class methods itself.\n",https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2559197,2559197,src/wallet.h
CodeShark,2013-01-07T07:50:45Z,Totally agreed - this was just me being extra cautious until the locking issues can be further looked into.\n,https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2562028,2562028,src/bitcoinrpc.cpp
CodeShark,2013-01-07T07:55:03Z,usewallet used to call RPCConvertValues on the parameters and pass it to CRPCTable::execute.\n\nNow RPCConvertValues does the magic.\n,https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2562045,2562045,src/bitcoinrpc.cpp
CodeShark,2013-01-07T07:56:05Z,Won't that return the complete path including directories? I just want the filenames.\n,https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2562049,2562049,src/util.cpp
sipa,2013-01-07T12:12:09Z,"Oh, yes - you'll need compatibility with boost filesystem v2 though... for now\n",https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2563520,2563520,src/util.cpp
CodeShark,2013-01-10T07:30:15Z,so the preferred style would be something like a lock method containing LOCK(cs_WalletMap)? I guess that wouldn't work because it would go out of scope when the method returns.\n\nSo could you give a quick example of the style?\n,https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2601773,2601773,src/wallet.h
CodeShark,2013-01-10T07:36:44Z,"Actually, the only locking really needed is when unloading wallets. The rest of the wallet locking could be handled by the wallet class itself. So it seems an even better solution is to just lock on the wallet inside the UnloadWallet method. I'm wondering whether we should be locking on the UnregisterWallet method in main...Btw, is the std::map class thread-safe? Are inserts, deletes, and searches",https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2601804,2601804,src/wallet.h
CodeShark,2013-01-10T09:47:03Z,"The reason this was added was because we need to be able to unlock each wallet individually. The RPC methods shouldn't have to be keeping track of when it's time to lock the wallet again, so the options seem to be to either move the timer to within the CCryptoKeyStore class itself - or to write a helper class that manages this.\n",https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2602602,2602602,src/keystore.cpp
CodeShark,2013-01-10T11:55:07Z,This is what's causing BitcoinPullTester to fail. Could we add this library?\n,https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2603682,2603682,src/makefile.unix
Diapolo,2013-01-10T12:55:06Z,Is Boost Regex a compiled lib or does it consist only of a .hpp file? If you need it for this pull to work you will also need to add it to bitcoin-qt.pro for the Qt client to work.\n,https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2604189,2604189,src/makefile.unix
gavinandresen,2013-01-10T15:42:20Z,"If I recall correctly, boost::regex can be used either as headers-only OR requires-linking. Downside of headers-only is it increases compile times and uses a lot more memory when compiling.\n\nIt seems odd that the build testing machine would have boost built without the regex library, I thought the regexp library was built by default when you built boost.\n",https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2606054,2606054,src/makefile.unix
CodeShark,2013-01-10T17:32:11Z,@Diapolo indeed. I got this branch to build the Qt client on Mac OS 10.8. I'm still having some problems with std::basic_ostream and QtCore/qglobal.h when I use -mmacosx-version-min=10.5. Using -mmacosx-version-min=10.7 seems to make the first problem go away. The second problem is just a warning.\n,https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2607653,2607653,src/makefile.unix
CodeShark,2013-01-10T18:50:00Z,"-mmacosx-version-min=10.6 even works. But 10.5, no way.\n",https://github.com/bitcoin/bitcoin/pull/2124#discussion_r2608985,2608985,src/makefile.unix
