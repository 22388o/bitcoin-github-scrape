[
  {
    "sha": "a41149426168b8ea96099f10576022c6a09033d1",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphNDExNDk0MjYxNjhiOGVhOTYwOTlmMTA1NzYwMjJjNmEwOTAzM2Qx",
    "commit": {
      "author": {
        "name": "klementtan",
        "email": "klement.tan@ninjavan.co",
        "date": "2021-04-17T11:08:47Z"
      },
      "committer": {
        "name": "klementtan",
        "email": "klement.tan@ninjavan.co",
        "date": "2021-04-18T04:30:58Z"
      },
      "message": "rpc: Improve getblock error message for invalid data type.",
      "tree": {
        "sha": "ff652240d9992f138c94afad7af40ffe65f84fc9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ff652240d9992f138c94afad7af40ffe65f84fc9"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a41149426168b8ea96099f10576022c6a09033d1",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a41149426168b8ea96099f10576022c6a09033d1",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/a41149426168b8ea96099f10576022c6a09033d1",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a41149426168b8ea96099f10576022c6a09033d1/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "f5e8bcf985df212c901b1e3e1ed0b68933c321f6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f5e8bcf985df212c901b1e3e1ed0b68933c321f6",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/f5e8bcf985df212c901b1e3e1ed0b68933c321f6"
      }
    ],
    "stats": {
      "total": 10,
      "additions": 7,
      "deletions": 3
    },
    "files": [
      {
        "sha": "d88e75891d184383f3540099b99796648afa9850",
        "filename": "src/rpc/blockchain.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 3,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a41149426168b8ea96099f10576022c6a09033d1/src/rpc/blockchain.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a41149426168b8ea96099f10576022c6a09033d1/src/rpc/blockchain.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/blockchain.cpp?ref=a41149426168b8ea96099f10576022c6a09033d1",
        "patch": "@@ -936,10 +936,11 @@ static RPCHelpMan getblock()\n \n     int verbosity = 1;\n     if (!request.params[1].isNull()) {\n-        if(request.params[1].isNum())\n-            verbosity = request.params[1].get_int();\n-        else\n+        if (request.params[1].isBool()) {\n             verbosity = request.params[1].get_bool() ? 1 : 0;\n+        } else {\n+            verbosity = request.params[1].get_int();\n+        }\n     }\n \n     CBlock block;"
      },
      {
        "sha": "ac53a280b4a41853f63d8db9e686dc2bad36a5e7",
        "filename": "test/functional/rpc_blockchain.py",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a41149426168b8ea96099f10576022c6a09033d1/test/functional/rpc_blockchain.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a41149426168b8ea96099f10576022c6a09033d1/test/functional/rpc_blockchain.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/rpc_blockchain.py?ref=a41149426168b8ea96099f10576022c6a09033d1",
        "patch": "@@ -410,6 +410,9 @@ def _test_getblock(self):\n         self.log.info(\"Test that getblock with verbosity 2 still works with pruned Undo data\")\n         datadir = get_datadir_path(self.options.tmpdir, 0)\n \n+        self.log.info(\"Test that getblock with invalid verbosity type returns proper error message\")\n+        assert_raises_rpc_error(-1, \"JSON value is not an integer as expected\", node.getblock, blockhash, \"2\")\n+\n         def move_block_file(old, new):\n             old_path = os.path.join(datadir, self.chain, 'blocks', old)\n             new_path = os.path.join(datadir, self.chain, 'blocks', new)"
      }
    ]
  }
]