[
  {
    "sha": "06d81ad516f1d136da9f03ca2ae823211c0f6988",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzowNmQ4MWFkNTE2ZjFkMTM2ZGE5ZjAzY2EyYWU4MjMyMTFjMGY2OTg4",
    "commit": {
      "author": {
        "name": "Alex Morcos",
        "email": "morcos@chaincode.com",
        "date": "2015-11-02T21:10:57Z"
      },
      "committer": {
        "name": "Alex Morcos",
        "email": "morcos@chaincode.com",
        "date": "2015-11-03T01:10:24Z"
      },
      "message": "Skip BIP30 check after BIP34 activation",
      "tree": {
        "sha": "b8e854ae27aa93329f59ce7e798e45fa0a9c2a01",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b8e854ae27aa93329f59ce7e798e45fa0a9c2a01"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/06d81ad516f1d136da9f03ca2ae823211c0f6988",
      "comment_count": 1,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/06d81ad516f1d136da9f03ca2ae823211c0f6988",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/06d81ad516f1d136da9f03ca2ae823211c0f6988",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/06d81ad516f1d136da9f03ca2ae823211c0f6988/comments",
    "author": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "8fe30fb4d130532d4a0e4c9d143f03e1b85a749e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/8fe30fb4d130532d4a0e4c9d143f03e1b85a749e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/8fe30fb4d130532d4a0e4c9d143f03e1b85a749e"
      }
    ],
    "stats": {
      "total": 11,
      "additions": 11,
      "deletions": 0
    },
    "files": [
      {
        "sha": "159f6f644c04bb588ae744a1b28bba1f21907d3e",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 11,
        "deletions": 0,
        "changes": 11,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/06d81ad516f1d136da9f03ca2ae823211c0f6988/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/06d81ad516f1d136da9f03ca2ae823211c0f6988/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=06d81ad516f1d136da9f03ca2ae823211c0f6988",
        "patch": "@@ -1736,6 +1736,17 @@ bool ConnectBlock(const CBlock& block, CValidationState& state, CBlockIndex* pin\n     bool fEnforceBIP30 = (!pindex->phashBlock) || // Enforce on CreateNewBlock invocations which don't have a hash.\n                           !((pindex->nHeight==91842 && pindex->GetBlockHash() == uint256S(\"0x00000000000a4d0a398161ffc163c503763b1f4360639393e0e4c8e300e0caec\")) ||\n                            (pindex->nHeight==91880 && pindex->GetBlockHash() == uint256S(\"0x00000000000743f190a18c5577a3c2d2a1f610ae9601ac046a38084ccb7cd721\")));\n+\n+    // Once BIP34 activated it was not possible to create new duplicate coinbases and thus other than starting\n+    // with the 2 existing duplicate coinbase pairs, not possible to create overwriting txs.  But by the\n+    // time BIP34 activated, in each of the existing pairs the duplicate coinbase had overwritten the first\n+    // before the first had been spent.  Since those coinbases are sufficiently buried its no longer possible to create further\n+    // duplicate transactions descending from the known pairs either.\n+    // If we're on the known chain at height greater than 227931 where BIP34 activated, we can save the db accesses needed for the BIP30 check.\n+    CBlockIndex *pindexBIP34height = pindex->pprev->GetAncestor(227931);\n+    //Only continue to enforce if we're below height 227931 or the block hash at that height doesn't correspond.\n+    fEnforceBIP30 = fEnforceBIP30 && (!pindexBIP34height || !(pindexBIP34height->GetBlockHash() == uint256S(\"0x000000000000024b89b42a942fe0d9fea3bb44ab7bd1b19115dd6a759c0808b8\")));\n+\n     if (fEnforceBIP30) {\n         BOOST_FOREACH(const CTransaction& tx, block.vtx) {\n             const CCoins* coins = view.AccessCoins(tx.GetHash());"
      }
    ]
  },
  {
    "sha": "33c90cf197223fb95f858db80d090d570d70498a",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozM2M5MGNmMTk3MjIzZmI5NWY4NThkYjgwZDA5MGQ1NzBkNzA0OThh",
    "commit": {
      "author": {
        "name": "Alex Morcos",
        "email": "morcos@chaincode.com",
        "date": "2015-11-02T21:41:55Z"
      },
      "committer": {
        "name": "Alex Morcos",
        "email": "morcos@chaincode.com",
        "date": "2015-11-03T01:11:55Z"
      },
      "message": "Make skipping BIP30 check chain agnostic",
      "tree": {
        "sha": "07c236112b37b67a337aa8b9b10a4bf9fbe0e815",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/07c236112b37b67a337aa8b9b10a4bf9fbe0e815"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/33c90cf197223fb95f858db80d090d570d70498a",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/33c90cf197223fb95f858db80d090d570d70498a",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/33c90cf197223fb95f858db80d090d570d70498a",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/33c90cf197223fb95f858db80d090d570d70498a/comments",
    "author": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "06d81ad516f1d136da9f03ca2ae823211c0f6988",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/06d81ad516f1d136da9f03ca2ae823211c0f6988",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/06d81ad516f1d136da9f03ca2ae823211c0f6988"
      }
    ],
    "stats": {
      "total": 17,
      "additions": 13,
      "deletions": 4
    },
    "files": [
      {
        "sha": "5d6d1ef9d8f7d28a8381cf010ec667c951de9403",
        "filename": "src/chainparams.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 0,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/33c90cf197223fb95f858db80d090d570d70498a/src/chainparams.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/33c90cf197223fb95f858db80d090d570d70498a/src/chainparams.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/chainparams.cpp?ref=33c90cf197223fb95f858db80d090d570d70498a",
        "patch": "@@ -73,6 +73,8 @@ class CMainParams : public CChainParams {\n         consensus.nMajorityEnforceBlockUpgrade = 750;\n         consensus.nMajorityRejectBlockOutdated = 950;\n         consensus.nMajorityWindow = 1000;\n+        consensus.BIP34Height = 227931;\n+        consensus.BIP34Hash = uint256S(\"0x000000000000024b89b42a942fe0d9fea3bb44ab7bd1b19115dd6a759c0808b8\");\n         consensus.powLimit = uint256S(\"00000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffff\");\n         consensus.nPowTargetTimespan = 14 * 24 * 60 * 60; // two weeks\n         consensus.nPowTargetSpacing = 10 * 60;\n@@ -153,6 +155,8 @@ class CTestNetParams : public CChainParams {\n         consensus.nMajorityEnforceBlockUpgrade = 51;\n         consensus.nMajorityRejectBlockOutdated = 75;\n         consensus.nMajorityWindow = 100;\n+        consensus.BIP34Height = 21111;\n+        consensus.BIP34Hash = uint256S(\"0x0000000023b3a96d3484e5abb3755c413e7d41500f8e2a5c3f0dd01299cd8ef8\");\n         consensus.powLimit = uint256S(\"00000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffff\");\n         consensus.nPowTargetTimespan = 14 * 24 * 60 * 60; // two weeks\n         consensus.nPowTargetSpacing = 10 * 60;\n@@ -216,6 +220,8 @@ class CRegTestParams : public CChainParams {\n         consensus.nMajorityEnforceBlockUpgrade = 750;\n         consensus.nMajorityRejectBlockOutdated = 950;\n         consensus.nMajorityWindow = 1000;\n+        consensus.BIP34Height = -1; // BIP34 has not necessarily activated on regtest\n+        consensus.BIP34Hash = uint256();\n         consensus.powLimit = uint256S(\"7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff\");\n         consensus.nPowTargetTimespan = 14 * 24 * 60 * 60; // two weeks\n         consensus.nPowTargetSpacing = 10 * 60;"
      },
      {
        "sha": "5ebc48a8df9d35049755ab26a4b7d8e0c4cb4e42",
        "filename": "src/consensus/params.h",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/33c90cf197223fb95f858db80d090d570d70498a/src/consensus/params.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/33c90cf197223fb95f858db80d090d570d70498a/src/consensus/params.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/consensus/params.h?ref=33c90cf197223fb95f858db80d090d570d70498a",
        "patch": "@@ -19,6 +19,9 @@ struct Params {\n     int nMajorityEnforceBlockUpgrade;\n     int nMajorityRejectBlockOutdated;\n     int nMajorityWindow;\n+    /** Block height and hash at which BIP34 becomes active */\n+    int BIP34Height;\n+    uint256 BIP34Hash;\n     /** Proof of work parameters */\n     uint256 powLimit;\n     bool fPowAllowMinDifficultyBlocks;"
      },
      {
        "sha": "a4c9de185db5893ee11ffeae2107385e73851efc",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 4,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/33c90cf197223fb95f858db80d090d570d70498a/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/33c90cf197223fb95f858db80d090d570d70498a/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=33c90cf197223fb95f858db80d090d570d70498a",
        "patch": "@@ -1742,10 +1742,10 @@ bool ConnectBlock(const CBlock& block, CValidationState& state, CBlockIndex* pin\n     // time BIP34 activated, in each of the existing pairs the duplicate coinbase had overwritten the first\n     // before the first had been spent.  Since those coinbases are sufficiently buried its no longer possible to create further\n     // duplicate transactions descending from the known pairs either.\n-    // If we're on the known chain at height greater than 227931 where BIP34 activated, we can save the db accesses needed for the BIP30 check.\n-    CBlockIndex *pindexBIP34height = pindex->pprev->GetAncestor(227931);\n-    //Only continue to enforce if we're below height 227931 or the block hash at that height doesn't correspond.\n-    fEnforceBIP30 = fEnforceBIP30 && (!pindexBIP34height || !(pindexBIP34height->GetBlockHash() == uint256S(\"0x000000000000024b89b42a942fe0d9fea3bb44ab7bd1b19115dd6a759c0808b8\")));\n+    // If we're on the known chain at height greater than where BIP34 activated, we can save the db accesses needed for the BIP30 check.\n+    CBlockIndex *pindexBIP34height = pindex->pprev->GetAncestor(chainparams.GetConsensus().BIP34Height);\n+    //Only continue to enforce if we're below BIP34 activation height or the block hash at that height doesn't correspond.\n+    fEnforceBIP30 = fEnforceBIP30 && (!pindexBIP34height || !(pindexBIP34height->GetBlockHash() == chainparams.GetConsensus().BIP34Hash));\n \n     if (fEnforceBIP30) {\n         BOOST_FOREACH(const CTransaction& tx, block.vtx) {"
      }
    ]
  }
]