[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/782685008",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-782685008",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21244",
    "id": 782685008,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4MjY4NTAwOA==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-20T14:25:31Z",
    "updated_at": "2021-04-19T13:29:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #21727 (refactor: Move more stuff to blockstorage by MarcoFalke)\n* #20966 (banman: save the banlist in a JSON format on disk by vasild)\n* #19213 (util: Get rid of RecursiveMutex in Get{Blocks,Data}Dir by hebasto)\n* #16545 (refactor: Implement missing error checking for ArgsManager flags by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/782685008/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/784208608",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-784208608",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21244",
    "id": 784208608,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4NDIwODYwOA==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-23T13:37:38Z",
    "updated_at": "2021-02-23T13:37:38Z",
    "author_association": "MEMBER",
    "body": "Concept ACK",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/784208608/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/784521153",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-784521153",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21244",
    "id": 784521153,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4NDUyMTE1Mw==",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?u=7297e8aaf9188c0cb98bc549a8a02a1dc8d59e4c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-23T21:21:27Z",
    "updated_at": "2021-02-23T21:21:27Z",
    "author_association": "MEMBER",
    "body": "Concept ACK.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/784521153/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/784834198",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-784834198",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21244",
    "id": 784834198,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4NDgzNDE5OA==",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?u=b48a1208deda9bd1756f21a35341ce98265355c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-24T06:46:45Z",
    "updated_at": "2021-02-24T06:46:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "@sipa Yes, you are right. I have modified that.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/784834198/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/788806534",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-788806534",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21244",
    "id": 788806534,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4ODgwNjUzNA==",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?u=b48a1208deda9bd1756f21a35341ce98265355c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-02T10:34:31Z",
    "updated_at": "2021-03-02T13:01:48Z",
    "author_association": "CONTRIBUTOR",
    "body": "@laanwj @hebasto @MarcoFalke @jonatack @jnewbery Friendly ping: Could anyone please tell me if you find the approach to be correct or not?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/788806534/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/788819469",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-788819469",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21244",
    "id": 788819469,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc4ODgxOTQ2OQ==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-02T10:56:02Z",
    "updated_at": "2021-03-02T10:56:02Z",
    "author_association": "MEMBER",
    "body": "It seems fine to remove a global from a function that should be a pure utility helper",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/788819469/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/793092835",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-793092835",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21244",
    "id": 793092835,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5MzA5MjgzNQ==",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?u=b48a1208deda9bd1756f21a35341ce98265355c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-08T21:29:21Z",
    "updated_at": "2021-03-08T21:29:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "@MarcoFalke So are you saying that my actual approach is good or not? I honestly can't say.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/793092835/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/793471203",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-793471203",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21244",
    "id": 793471203,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5MzQ3MTIwMw==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-09T07:07:39Z",
    "updated_at": "2021-03-09T07:07:39Z",
    "author_association": "MEMBER",
    "body": "Concept ACK, haven't reviewed in detail",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/793471203/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/799574408",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-799574408",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21244",
    "id": 799574408,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5OTU3NDQwOA==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-15T16:49:45Z",
    "updated_at": "2021-03-15T16:49:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--4a62be1de6b64f3ed646cdc7932c8cf5-->\n\ud83d\udd75\ufe0f @sipa @jamesob have been requested to review this pull request as specified in the REVIEWERS file.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/799574408/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/816026224",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-816026224",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21244",
    "id": 816026224,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxNjAyNjIyNA==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-08T18:01:16Z",
    "updated_at": "2021-04-08T18:01:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "The new `BasicTestingSetup` args manager instance doesn't seem to be used very much right now. I'd think here or at some point in the future it'd make sense for `BasicTestingSetup::m_node.args` to be a pointer to the local test args manager instead of to `gArgs`. Maybe a change like the following would make sense:\r\n\r\n```diff\r\ndiff --git a/src/bitcoind.cpp b/src/bitcoind.cpp\r\nindex 80ab69c131e..6fddb469e56 100644\r\n--- a/src/bitcoind.cpp\r\n+++ b/src/bitcoind.cpp\r\n@@ -113,8 +113,8 @@ static bool AppInit(int argc, char* argv[])\r\n     util::ThreadSetInternalName(\"init\");\r\n \r\n     // If Qt is used, parameters/bitcoin.conf are parsed in qt/bitcoin.cpp's main()\r\n-    SetupServerArgs(node);\r\n     ArgsManager& args = *Assert(node.args);\r\n+    SetupServerArgs(args);\r\n     std::string error;\r\n     if (!args.ParseParameters(argc, argv, error)) {\r\n         return InitError(Untranslated(strprintf(\"Error parsing command line arguments: %s\\n\", error)));\r\ndiff --git a/src/init.cpp b/src/init.cpp\r\nindex 0d44b75b727..7b024e14686 100644\r\n--- a/src/init.cpp\r\n+++ b/src/init.cpp\r\n@@ -358,12 +358,8 @@ static void OnRPCStopped()\r\n     LogPrint(BCLog::RPC, \"RPC stopped.\\n\");\r\n }\r\n \r\n-void SetupServerArgs(NodeContext& node)\r\n+void SetupServerArgs(ArgsManager& argsman)\r\n {\r\n-    assert(!node.args);\r\n-    node.args = &gArgs;\r\n-    ArgsManager& argsman = *node.args;\r\n-\r\n     SetupHelpOptions(argsman);\r\n     argsman.AddArg(\"-help-debug\", \"Print help message with debugging options and exit\", ArgsManager::ALLOW_ANY, OptionsCategory::DEBUG_TEST); // server-only for now\r\n \r\ndiff --git a/src/init.h b/src/init.h\r\nindex 5d01d4c1ac3..98b83f0cf7f 100644\r\n--- a/src/init.h\r\n+++ b/src/init.h\r\n@@ -69,7 +69,7 @@ bool AppInitMain(const std::any& context, NodeContext& node, interfaces::BlockAn\r\n /**\r\n  * Register all arguments with the ArgsManager\r\n  */\r\n-void SetupServerArgs(NodeContext& node);\r\n+void SetupServerArgs(ArgsManager& argsman);\r\n \r\n /** Returns licensing information (for -version) */\r\n std::string LicenseInfo();\r\ndiff --git a/src/qt/bitcoin.cpp b/src/qt/bitcoin.cpp\r\nindex fc6d0febc2d..7eeeb3c1155 100644\r\n--- a/src/qt/bitcoin.cpp\r\n+++ b/src/qt/bitcoin.cpp\r\n@@ -477,7 +477,7 @@ int GuiMain(int argc, char* argv[])\r\n \r\n     /// 2. Parse command-line options. We do this after qt in order to show an error if there are problems parsing these\r\n     // Command-line options take precedence:\r\n-    SetupServerArgs(node_context);\r\n+    SetupServerArgs(gArgs);\r\n     SetupUIArgs(gArgs);\r\n     std::string error;\r\n     if (!gArgs.ParseParameters(argc, argv, error)) {\r\ndiff --git a/src/test/util/setup_common.cpp b/src/test/util/setup_common.cpp\r\nindex 1c961be419d..a460eab906d 100644\r\n--- a/src/test/util/setup_common.cpp\r\n+++ b/src/test/util/setup_common.cpp\r\n@@ -74,6 +74,7 @@ BasicTestingSetup::BasicTestingSetup(const std::string& chainName, const std::ve\r\n     : m_path_root{fs::temp_directory_path() / \"test_common_\" PACKAGE_NAME / g_insecure_rand_ctx_temp_path.rand256().ToString()},\r\n       m_args_manager{}\r\n {\r\n+    m_node.args = &m_args_manager;\r\n     const std::vector<const char*> arguments = Cat(\r\n         {\r\n             \"dummy\",\r\n@@ -92,7 +93,7 @@ BasicTestingSetup::BasicTestingSetup(const std::string& chainName, const std::ve\r\n     gArgs.ForceSetArg(\"-datadir\", m_path_root.string());\r\n     gArgs.ClearPathCache();\r\n     {\r\n-        SetupServerArgs(m_node);\r\n+        SetupServerArgs(*m_node.args);\r\n         std::string error;\r\n         const bool success{m_node.args->ParseParameters(arguments.size(), arguments.data(), error)};\r\n         assert(success);\r\n```\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/816026224/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/816167212",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-816167212",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21244",
    "id": 816167212,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxNjE2NzIxMg==",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?u=b48a1208deda9bd1756f21a35341ce98265355c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-08T20:35:19Z",
    "updated_at": "2021-04-08T20:40:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ryanofsky Thank you for the review! I will try to address it soon.\r\n\r\n> Other reviewers might be hesitant about this PR adding many new `gArgs` references when it claims to help \"Remove gArgs\".\r\n\r\nI was not sure about the scope of the PR, I started small but it did not feel compelling enough. My inspiration was #20158.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/816167212/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/816613578",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-816613578",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21244",
    "id": 816613578,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxNjYxMzU3OA==",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?u=b48a1208deda9bd1756f21a35341ce98265355c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-09T11:21:42Z",
    "updated_at": "2021-04-09T11:21:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "> The new `BasicTestingSetup` args manager instance doesn't seem to be used very much right now. I'd think here or at some point in the future it'd make sense for `BasicTestingSetup::m_node.args` to be a pointer to the local test args manager instead of to `gArgs`. Maybe a change like the following would make sense:\r\n\r\nI would like to reserve this for a follow-up PR. Other than that, I have attempted to address all your suggestions. Notably, I tried to run `make check` for each commit of this PR. I can try that again in the evening with clear head.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/816613578/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/817086352",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-817086352",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21244",
    "id": 817086352,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxNzA4NjM1Mg==",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?u=b48a1208deda9bd1756f21a35341ce98265355c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-10T06:14:00Z",
    "updated_at": "2021-04-10T06:14:00Z",
    "author_association": "CONTRIBUTOR",
    "body": "\"Cirrus CI / [depends, sanitizers: thread (TSan), no gui] [focal]\" seems to be flaky lately.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/817086352/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/817093926",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-817093926",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21244",
    "id": 817093926,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxNzA5MzkyNg==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-10T07:31:21Z",
    "updated_at": "2021-04-10T07:31:21Z",
    "author_association": "MEMBER",
    "body": "> \"Cirrus CI / [depends, sanitizers: thread (TSan), no gui] [focal]\" seems to be flaky lately.\n\nIf you rebase on latest master I think that solves it.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/817093926/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/817100456",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-817100456",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21244",
    "id": 817100456,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxNzEwMDQ1Ng==",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?u=b48a1208deda9bd1756f21a35341ce98265355c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-10T08:29:43Z",
    "updated_at": "2021-04-10T10:46:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "> If you rebase on latest master I think that solves it.\r\n\r\nLet's try it :)\r\n\r\nedit: It helped!",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/817100456/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/818542501",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-818542501",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21244",
    "id": 818542501,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxODU0MjUwMQ==",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?u=b48a1208deda9bd1756f21a35341ce98265355c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-13T08:15:44Z",
    "updated_at": "2021-04-13T08:15:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Code review almost-ACK [92b1890](https://github.com/bitcoin/bitcoin/commit/92b1890c9eeeecf9cf7325ef3dc1d2c44a588b87), modulo the `util_datadir` commit [8584666](https://github.com/bitcoin/bitcoin/commit/8584666393255a7ce62d741ddd8d994c486423c6), which I think breaks that test in a way where it still passes but no longer meaningfully checks things (see suggestion below).\r\n\r\nI have put `ClearDatadirCache` calls back. This was an unintended change I missed.\r\n\r\n> I would also consider dropping the [6e7e67f](https://github.com/bitcoin/bitcoin/commit/6e7e67f855282ae4baa3756f2e95aee12de13f91) commit from this PR because I think it makes the PR a lot bigger, causes code churn, and doesn't add as much value as the other changes here. [6e7e67f](https://github.com/bitcoin/bitcoin/commit/6e7e67f855282ae4baa3756f2e95aee12de13f91) could be its own separate followup PR. (@dongcarl could be good person to ask about it, too.)\r\n\r\nYou are right, the commit makes the PR too large probably. I have dropped the 6e7e67f (Change GetDataDir() calls to gArgs.GetDataDirPath() calls.) commit.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/818542501/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821180662",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-821180662",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21244",
    "id": 821180662,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMTE4MDY2Mg==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-16T13:32:14Z",
    "updated_at": "2021-04-16T13:32:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "Noticed this in IRC:\r\n\r\n> \\<Kiminuo> Hi guys, a quick question: I have this PR https://github.com/bitcoin/bitcoin/pull/21244 and it got one ACK. Now, should I just wait patiently until somebody else will review the PR? Or am I supposed to do something else to increase the chance of merging it? I'm not in hurry. I would just like to understand the review process better.\r\n\r\nThis is an easy review that mostly affects tests so I'd encourage anybody who cares about c++ unit tests to look at this PR.\r\n\r\nAlso for Kiminuo, I think a good way to get other people to review your PRs is to review their PRs. Progress on bitcoin is limited more by lack of review than lack of code contributions, and reviews that are substantive and show thought & understanding are encouraged even if you don't have prior experience reviewing bitcoin PRs (https://bitcoincore.reviews/ is a good resource for this).",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821180662/reactions",
      "total_count": 2,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 1,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821187622",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-821187622",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21244",
    "id": 821187622,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMTE4NzYyMg==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-16T13:43:44Z",
    "updated_at": "2021-04-16T13:43:44Z",
    "author_association": "MEMBER",
    "body": "> I think a good way to get other people to review your PRs is to review their PRs. Progress on bitcoin is limited more by lack of review than lack of code contributions, and reviews that are substantive and show thought & understanding are encouraged even if you don't have prior experience reviewing bitcoin PRs (https://bitcoincore.reviews/ is a good resource for this).\n\nAgree! suggested a similar approach to Kiminuo yesterday via IRC DM.\n\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821187622/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821868314",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-821868314",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21244",
    "id": 821868314,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMTg2ODMxNA==",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?u=b48a1208deda9bd1756f21a35341ce98265355c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-17T18:39:12Z",
    "updated_at": "2021-04-17T18:39:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "> I see no reasons to guard new data members `m_cached_*_path` with `RecursiveMutex cs_args`. It tangles recursive locking of `cs_args` more and more. We should move from `RecursiveMutex` to `Mutex` (#19303, #19213). To not deteriorate status quo, maybe just use a new specific mutex?\r\n\r\nWould it be better to do this in a follow-up PR?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821868314/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821870547",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-821870547",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21244",
    "id": 821870547,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMTg3MDU0Nw==",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?u=7297e8aaf9188c0cb98bc549a8a02a1dc8d59e4c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-17T18:55:19Z",
    "updated_at": "2021-04-17T18:55:19Z",
    "author_association": "MEMBER",
    "body": "> > I see no reasons to guard new data members `m_cached_*_path` with `RecursiveMutex cs_args`. It tangles recursive locking of `cs_args` more and more. We should move from `RecursiveMutex` to `Mutex` (#19303, #19213). To not deteriorate status quo, maybe just use a new specific mutex?\r\n> \r\n> Would it be better to do this in a follow-up PR?\r\n\r\nNot sure if it is better, but it won't stop me from ACKing :)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821870547/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821872237",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-821872237",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21244",
    "id": 821872237,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMTg3MjIzNw==",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?u=7297e8aaf9188c0cb98bc549a8a02a1dc8d59e4c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-17T19:07:12Z",
    "updated_at": "2021-04-17T19:47:29Z",
    "author_association": "MEMBER",
    "body": "- [x] 70cdf679f8e665dbdc3301873a0267fe9faa72cd - \"Move StripRedundantLastElementsOfPath before ArgsManager class.\"\r\n- [x] 1add318704108faa98f5b1b8e9c96d960e9d23a8 - \"Move GetDataDir(fNetSpecific) implementation to ArgsManager.\"\r\n- [x] 5441bd3f54e675445f5a9c10462c24fbba721243 - \"Modify \"util_datadir\" unit test to not use gArgs.\"\r\n- [x] ea70f2266b4329cce75ccb8db73e426055f345a8 - \"BasicTestingSetup: Add ArgsManager.\"\r\n- [x] 46c8546e4d42b4825b82adf3fd1ff42591850530 - \"Modify unit tests to use the ArgsManager in the BasicTestingSetup class instead of implicitly relying on gArgs.\"\r\n- [x] 3cf594e1dc1131f6e39911e8ddc5721f310e5aeb - \"Change GetBlocksDir() to ArgsManager.GetBlocksDirPath().\"\r\n- [x] 69b8c4ad40185862fe199005c81a75d582053bd4 - \"Change ClearDataDirPathCache() to ArgsManager.ClearPathCache().\"",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821872237/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821878378",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-821878378",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21244",
    "id": 821878378,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMTg3ODM3OA==",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?u=b48a1208deda9bd1756f21a35341ce98265355c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-17T19:53:05Z",
    "updated_at": "2021-04-17T19:53:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Please next time do not rebase without necessity :)\r\n\r\nInteresting point, it did not occur to me that it's better. Thank you for pointing it out.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821878378/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821967487",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-821967487",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/21244",
    "id": 821967487,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMTk2NzQ4Nw==",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?u=b48a1208deda9bd1756f21a35341ce98265355c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-18T10:09:05Z",
    "updated_at": "2021-04-18T10:09:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "I addessed outstanding suggestions. Diff since 69b8c4ad is minimal.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/821967487/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580961423",
    "pull_request_review_id": 596237611,
    "id": 580961423,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MDk2MTQyMw==",
    "diff_hunk": "@@ -767,34 +768,40 @@ const fs::path &GetBlocksDir()\n     return path;\n }\n \n-const fs::path &GetDataDir(bool fNetSpecific)\n+void GetDataDir(ArgsManager& argsManager, bool fNetSpecific, fs::path* path)",
    "path": "src/util/system.cpp",
    "position": null,
    "original_position": 13,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "3544cd27b4ea651d7958bcfe02bddb54e63f5fcf",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "note: `std::string datadir` can be passed instead of `ArgsManager` instance.",
    "created_at": "2021-02-23T11:30:48Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r580961423",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580961423"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r580961423"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580961423/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 770,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580961753",
    "pull_request_review_id": 596237952,
    "id": 580961753,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MDk2MTc1Mw==",
    "diff_hunk": "@@ -767,34 +768,40 @@ const fs::path &GetBlocksDir()\n     return path;\n }\n \n-const fs::path &GetDataDir(bool fNetSpecific)\n+void GetDataDir(ArgsManager& argsManager, bool fNetSpecific, fs::path* path)\n {\n-    LOCK(csPathCached);\n-    fs::path &path = fNetSpecific ? pathCachedNetSpecific : pathCached;\n-\n-    // Cache the path to avoid calling fs::create_directories on every call of\n-    // this function\n-    if (!path.empty()) return path;\n-\n-    std::string datadir = gArgs.GetArg(\"-datadir\", \"\");\n+    LOCK(g_datadir_mutex);\n+    std::string datadir = argsManager.GetArg(\"-datadir\", \"\");\n     if (!datadir.empty()) {\n-        path = fs::system_complete(datadir);\n-        if (!fs::is_directory(path)) {\n-            path = \"\";\n-            return path;\n+        *path = fs::system_complete(datadir);",
    "path": "src/util/system.cpp",
    "position": null,
    "original_position": 30,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "3544cd27b4ea651d7958bcfe02bddb54e63f5fcf",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Should I get rid of pointers?",
    "created_at": "2021-02-23T11:31:17Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r580961753",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580961753"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r580961753"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580961753/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 774,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580962300",
    "pull_request_review_id": 596238692,
    "id": 580962300,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MDk2MjMwMA==",
    "diff_hunk": "@@ -94,6 +95,15 @@ fs::path GetDefaultDataDir();\n // The blocks directory is always net specific.\n const fs::path &GetBlocksDir();\n const fs::path &GetDataDir(bool fNetSpecific = true);\n+\n+/**\n+ * Get data directory path.",
    "path": "src/util/system.h",
    "position": null,
    "original_position": 14,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "3544cd27b4ea651d7958bcfe02bddb54e63f5fcf",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "note: Maybe mention that empty datadir leads to default datadir?",
    "created_at": "2021-02-23T11:32:18Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r580962300",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580962300"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r580962300"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580962300/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 100,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580963531",
    "pull_request_review_id": 596240293,
    "id": 580963531,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MDk2MzUzMQ==",
    "diff_hunk": "@@ -94,6 +95,15 @@ fs::path GetDefaultDataDir();\n // The blocks directory is always net specific.\n const fs::path &GetBlocksDir();\n const fs::path &GetDataDir(bool fNetSpecific = true);\n+\n+/**\n+ * Get data directory path.\n+ *\n+ * @param      argsManager Arguments manager instance.\n+ * @param      fnetSpecific Append network identifier to the path.\n+ * @param[out] data Directory path.\n+ */\n+void GetDataDir(ArgsManager& argsManager, bool fNetSpecific, fs::path* path);",
    "path": "src/util/system.h",
    "position": null,
    "original_position": 20,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "3544cd27b4ea651d7958bcfe02bddb54e63f5fcf",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Note: Is signature in form: `void GetDataDir(fs::path* path, ArgsManager& argsManager, bool fNetSpecific = true);` preferred?",
    "created_at": "2021-02-23T11:34:29Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r580963531",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580963531"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r580963531"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580963531/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 106,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580963943",
    "pull_request_review_id": 596240825,
    "id": 580963943,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MDk2Mzk0Mw==",
    "diff_hunk": "@@ -48,24 +48,40 @@ BOOST_FIXTURE_TEST_SUITE(util_tests, BasicTestingSetup)\n \n BOOST_AUTO_TEST_CASE(util_datadir)\n {\n-    ClearDatadirCache();\n-    const fs::path dd_norm = GetDataDir();\n+    FastRandomContext insecure_rand_ctx;\n+    const fs::path datadir_path = fs::temp_directory_path() / \"test_common_\" PACKAGE_NAME / insecure_rand_ctx.rand256().ToString();",
    "path": "src/test/util_tests.cpp",
    "position": null,
    "original_position": 7,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "3544cd27b4ea651d7958bcfe02bddb54e63f5fcf",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "note: Would be nice to wrap this in a helper function.",
    "created_at": "2021-02-23T11:35:12Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r580963943",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580963943"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r580963943"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580963943/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 51,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 52,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580964302",
    "pull_request_review_id": 596241235,
    "id": 580964302,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MDk2NDMwMg==",
    "diff_hunk": "@@ -48,24 +48,40 @@ BOOST_FIXTURE_TEST_SUITE(util_tests, BasicTestingSetup)\n \n BOOST_AUTO_TEST_CASE(util_datadir)\n {\n-    ClearDatadirCache();",
    "path": "src/test/util_tests.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "3544cd27b4ea651d7958bcfe02bddb54e63f5fcf",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Should the original test be preserved?",
    "created_at": "2021-02-23T11:35:45Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r580964302",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580964302"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r580964302"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/580964302/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 52,
    "original_line": 52,
    "side": "LEFT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/583466303",
    "pull_request_review_id": 599352034,
    "id": 583466303,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MzQ2NjMwMw==",
    "diff_hunk": "@@ -94,6 +95,7 @@ fs::path GetDefaultDataDir();\n // The blocks directory is always net specific.\n const fs::path &GetBlocksDir();\n const fs::path &GetDataDir(bool fNetSpecific = true);\n+",
    "path": "src/util/system.h",
    "position": null,
    "original_position": 12,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "82b811973376bfcbdcf01caa4b0b32303d163628",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Will remove.",
    "created_at": "2021-02-26T08:32:52Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r583466303",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/583466303"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r583466303"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/583466303/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 98,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/583466676",
    "pull_request_review_id": 599352524,
    "id": 583466676,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MzQ2NjY3Ng==",
    "diff_hunk": "@@ -1139,21 +1145,23 @@ BOOST_AUTO_TEST_CASE(util_ReadWriteSettings)\n {\n     // Test writing setting.\n     TestArgsManager args1;\n-    args1.LockSettings([&](util::Settings& settings) { settings.rw_settings[\"name\"] = \"value\"; });\n+    args1.ForceSetArg(\"-datadir\", m_path_root.string());\n+    args1.LockSettings([&](util::Settings& settings) { settings.rw_settings[\"name\"] = \"value\"; });    ",
    "path": "src/test/util_tests.cpp",
    "position": null,
    "original_position": 52,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "82b811973376bfcbdcf01caa4b0b32303d163628",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "```suggestion\r\n    args1.LockSettings([&](util::Settings& settings) { settings.rw_settings[\"name\"] = \"value\"; });\r\n```",
    "created_at": "2021-02-26T08:33:36Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r583466676",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/583466676"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r583466676"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/583466676/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1149,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/583466757",
    "pull_request_review_id": 599352641,
    "id": 583466757,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MzQ2Njc1Nw==",
    "diff_hunk": "@@ -1139,21 +1145,23 @@ BOOST_AUTO_TEST_CASE(util_ReadWriteSettings)\n {\n     // Test writing setting.\n     TestArgsManager args1;\n-    args1.LockSettings([&](util::Settings& settings) { settings.rw_settings[\"name\"] = \"value\"; });\n+    args1.ForceSetArg(\"-datadir\", m_path_root.string());\n+    args1.LockSettings([&](util::Settings& settings) { settings.rw_settings[\"name\"] = \"value\"; });    ",
    "path": "src/test/util_tests.cpp",
    "position": null,
    "original_position": 52,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "82b811973376bfcbdcf01caa4b0b32303d163628",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Will remove to fix linter.",
    "created_at": "2021-02-26T08:33:46Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r583466757",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/583466757"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r583466757"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/583466757/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1149,
    "side": "RIGHT",
    "in_reply_to_id": 583466676
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/583576324",
    "pull_request_review_id": 599492131,
    "id": 583576324,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU4MzU3NjMyNA==",
    "diff_hunk": "@@ -806,10 +817,7 @@ bool CheckDataDirOption()\n \n void ClearDatadirCache()\n {\n-    LOCK(csPathCached);\n-\n-    pathCached = fs::path();\n-    pathCachedNetSpecific = fs::path();\n+    gArgs.ClearDatadirPathCache();",
    "path": "src/util/system.cpp",
    "position": null,
    "original_position": 158,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "3aa33265a221c5337db8838149d337bf45f3508c",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "bug: `LOCK(csPathCached);` should be here.",
    "created_at": "2021-02-26T11:34:31Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r583576324",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/583576324"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r583576324"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/583576324/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 820,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/609904991",
    "pull_request_review_id": 631631456,
    "id": 609904991,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwOTkwNDk5MQ==",
    "diff_hunk": "@@ -200,6 +200,8 @@ class ArgsManager\n     std::map<OptionsCategory, std::map<std::string, Arg>> m_available_args GUARDED_BY(cs_args);\n     bool m_accept_any_command GUARDED_BY(cs_args){true};\n     std::list<SectionInfo> m_config_sections GUARDED_BY(cs_args);\n+    fs::path datadirPathCached GUARDED_BY(cs_args);\n+    fs::path datadirPathCachedNetSpecific GUARDED_BY(cs_args);",
    "path": "src/util/system.h",
    "position": null,
    "original_position": 5,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "839324993aeb8448af5a811b7323fa460ac9eac7",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Move GetDataDir(fNetSpecific) implementation to ArgsManager.\" (839324993aeb8448af5a811b7323fa460ac9eac7)\r\n\r\nSee symbol naming conventions https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md, but would suggest `m_cached_datadir_path`, `m_cached_network_datadir_path`",
    "created_at": "2021-04-08T16:56:48Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r609904991",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/609904991"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r609904991"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/609904991/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 203,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 204,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/609908281",
    "pull_request_review_id": 631631456,
    "id": 609908281,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwOTkwODI4MQ==",
    "diff_hunk": "@@ -49,24 +49,27 @@ BOOST_FIXTURE_TEST_SUITE(util_tests, BasicTestingSetup)\n \n BOOST_AUTO_TEST_CASE(util_datadir)\n {\n-    ClearDatadirCache();\n-    const fs::path dd_norm = GetDataDir();\n+    ArgsManager argsManager;",
    "path": "src/test/util_tests.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "ec7769315f5ed62e6145492977226925e122292c",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Modify \"util_datadir\" unit test to not use gArgs.\" (ec7769315f5ed62e6145492977226925e122292c)\r\n\r\nIt seems unnecessary to add another argsmanager for this test, with 3 side-by-side argsmanagers:\r\n\r\n1. gArgs\r\n2. BasicTestingSetup::m_args_manager added in d4f86a3f608c98365b537d78d7ef1693463d7b9b\r\n3. This local argsManager variable.\r\n\r\nMaybe it could just use the basictesting member. If not though, it'd be helpful to have a comment explaining its purpose.\r\n\r\nAlso see naming in https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md but camelCase should not be used for variable names. If there needs to be a variable would suggest just calling it `args` which is convention for other ArgsManager instances.",
    "created_at": "2021-04-08T17:00:19Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r609908281",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/609908281"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r609908281"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/609908281/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 52,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/609913613",
    "pull_request_review_id": 631631456,
    "id": 609913613,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwOTkxMzYxMw==",
    "diff_hunk": "@@ -195,6 +195,7 @@ class ArgsManager\n     std::map<OptionsCategory, std::map<std::string, Arg>> m_available_args GUARDED_BY(cs_args);\n     bool m_accept_any_command GUARDED_BY(cs_args){true};\n     std::list<SectionInfo> m_config_sections GUARDED_BY(cs_args);\n+    fs::path blocksPathCachedNetSpecific GUARDED_BY(cs_args);",
    "path": "src/util/system.h",
    "position": null,
    "original_position": 4,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "fa0b2291aa84fe372bb37a9fcbf1ad3165f7daea",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Change GetBlocksDir() to ArgsManager.GetBlocksDirPath().\" (fa0b2291aa84fe372bb37a9fcbf1ad3165f7daea)\r\n\r\nAgain should follow naming convention, would suggest `m_cached_blocks_path`. See naming in  https://github.com/bitcoin/bitcoin/blob/master/doc/developer-notes.md",
    "created_at": "2021-04-08T17:06:17Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r609913613",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/609913613"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r609913613"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/609913613/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 198,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/609922475",
    "pull_request_review_id": 631631456,
    "id": 609922475,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwOTkyMjQ3NQ==",
    "diff_hunk": "@@ -723,22 +736,7 @@ fs::path GetDefaultDataDir()\n #endif\n }\n \n-namespace {\n-fs::path StripRedundantLastElementsOfPath(const fs::path& path)\n-{\n-    auto result = path;\n-    while (result.filename().string() == \".\") {\n-        result = result.parent_path();\n-    }\n-\n-    assert(fs::equivalent(result, path));\n-    return result;\n-}\n-} // namespace\n-\n static fs::path g_blocks_path_cache_net_specific;\n-static fs::path pathCached;\n-static fs::path pathCachedNetSpecific;",
    "path": "src/util/system.cpp",
    "position": 121,
    "original_position": 39,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "c44993ad96d649be48c94d4ae38d354d609a7282",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Move StripRedundantLastElementsOfPath before ArgsManager class.\" (c44993ad96d649be48c94d4ae38d354d609a7282)\r\n\r\nThis commit seems not to compile because these variables are removed\r\n\r\n```\r\n  CXX      libbitcoin_server_a-net.o\r\nutil/system.cpp:771:37: error: use of undeclared identifier 'pathCachedNetSpecific'\r\n    fs::path &path = fNetSpecific ? pathCachedNetSpecific : pathCached;\r\n                                    ^\r\nutil/system.cpp:771:61: error: use of undeclared identifier 'pathCached'\r\n    fs::path &path = fNetSpecific ? pathCachedNetSpecific : pathCached;\r\n                                                            ^\r\nutil/system.cpp:809:5: error: use of undeclared identifier 'pathCached'; did you mean 'csPathCached'?\r\n    pathCached = fs::path();\r\n    ^~~~~~~~~~\r\n    csPathCached\r\nutil/system.cpp:740:23: note: 'csPathCached' declared here\r\nstatic RecursiveMutex csPathCached;\r\n                      ^\r\nutil/system.cpp:809:16: error: no viable overloaded '='\r\n    pathCached = fs::path();\r\n    ~~~~~~~~~~ ^ ~~~~~~~~~~\r\n./sync.h:89:16: note: candidate function (the implicit copy assignment operator) not viable: no known conversion from 'fs::path' to 'const AnnotatedMixin<std::recursive_mutex>' for 1st argument\r\nclass LOCKABLE AnnotatedMixin : public PARENT\r\n               ^\r\nutil/system.cpp:810:5: error: use of undeclared identifier 'pathCachedNetSpecific'\r\n    pathCachedNetSpecific = fs::path();\r\n    ^\r\n```",
    "created_at": "2021-04-08T17:15:45Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r609922475",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/609922475"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r609922475"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/609922475/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 740,
    "original_start_line": 740,
    "start_side": "LEFT",
    "line": 741,
    "original_line": 741,
    "side": "LEFT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/609924623",
    "pull_request_review_id": 631631456,
    "id": 609924623,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwOTkyNDYyMw==",
    "diff_hunk": "@@ -388,6 +388,45 @@ std::optional<unsigned int> ArgsManager::GetArgFlags(const std::string& name) co\n     return std::nullopt;\n }\n \n+const fs::path& ArgsManager::GetDataDirPath(bool fNetSpecific)\n+{\n+    LOCK(cs_args);\n+    fs::path &path = fNetSpecific ? datadirPathCachedNetSpecific : datadirPathCached;\n+\n+    // Cache the path to avoid calling fs::create_directories on every call of\n+    // this function\n+    if (!path.empty()) return path;\n+\n+    std::string datadir = GetArg(\"-datadir\", \"\");\n+    if (!datadir.empty()) {\n+        path = fs::system_complete(datadir);\n+        if (!fs::is_directory(path)) {\n+            path = \"\";\n+            return path;\n+        }\n+    } else {\n+        path = GetDefaultDataDir();\n+    }\n+    if (fNetSpecific)\n+        path /= BaseParams().DataDir();\n+\n+    if (fs::create_directories(path)) {\n+        // This is the first run, create wallets subdirectory too\n+        fs::create_directories(path / \"wallets\");\n+    }\n+\n+    path = StripRedundantLastElementsOfPath(path);\n+    return path;\n+}\n+\n+void ArgsManager::ClearDatadirPathCache()",
    "path": "src/util/system.cpp",
    "position": null,
    "original_position": 35,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "839324993aeb8448af5a811b7323fa460ac9eac7",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Move GetDataDir(fNetSpecific) implementation to ArgsManager.\" (839324993aeb8448af5a811b7323fa460ac9eac7)\r\n\r\nThis commit seems not to compile\r\n\r\n```\r\nutil/system.cpp:422:19: error: out-of-line definition of 'ClearDatadirPathCache' does not match any declaration in 'ArgsManager'; did you mean 'ClearPathCache'?\r\nvoid ArgsManager::ClearDatadirPathCache()\r\n                  ^~~~~~~~~~~~~~~~~~~~~\r\n                  ClearPathCache                                                                                                                                          \r\n./util/system.h:280:10: note: 'ClearPathCache' declared here\r\n    void ClearPathCache();\r\n         ^\r\nutil/system.cpp:820:11: error: no member named 'ClearDatadirPathCache' in 'ArgsManager'\r\n    gArgs.ClearDatadirPathCache();\r\n    ~~~~~ ^\r\n2 errors generated.\r\n```",
    "created_at": "2021-04-08T17:18:19Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r609924623",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/609924623"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r609924623"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/609924623/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 422,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/609930822",
    "pull_request_review_id": 631631456,
    "id": 609930822,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwOTkzMDgyMg==",
    "diff_hunk": "@@ -80,6 +81,7 @@ struct BasicTestingSetup {\n     ~BasicTestingSetup();\n \n     const fs::path m_path_root;\n+    ArgsManager m_args_manager;",
    "path": "src/test/util/setup_common.h",
    "position": null,
    "original_position": 12,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "d4f86a3f608c98365b537d78d7ef1693463d7b9b",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"BasicTestingSetup: Add ArgsManager.\" (d4f86a3f608c98365b537d78d7ef1693463d7b9b)\r\n\r\nConvention other places is to call `ArgsManager` instances `args`, suggest naming this `m_args`",
    "created_at": "2021-04-08T17:25:17Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r609930822",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/609930822"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r609930822"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/609930822/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 84,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/610080299",
    "pull_request_review_id": 631809493,
    "id": 610080299,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMDA4MDI5OQ==",
    "diff_hunk": "@@ -49,24 +49,27 @@ BOOST_FIXTURE_TEST_SUITE(util_tests, BasicTestingSetup)\n \n BOOST_AUTO_TEST_CASE(util_datadir)\n {\n-    ClearDatadirCache();\n-    const fs::path dd_norm = GetDataDir();\n+    ArgsManager argsManager;",
    "path": "src/test/util_tests.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "ec7769315f5ed62e6145492977226925e122292c",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The main reason I did it this way was/is that I persuades me that it does what one expects and there is no possible confusion. When I put `gArgs` (or `BasicTestingSetup::m_args_manager`) there, it forces to me wonder: How is `gArgs` actually initialized and where it is? Can some later refactoring affect the test silently? \r\n\r\nMaybe I see it this way because I don't read Bitcoin Core source code for years as other people here. Anyway, I'm open to suggestions, if you still find it better to change the code, I can do it.\r\n\r\n_______\r\nNote: An alternative would be to move the test somewhere where there is no `BasicTestingSetup` and no `gArgs` but I'm not sure if there are such tests.",
    "created_at": "2021-04-08T20:34:27Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r610080299",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/610080299"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r610080299"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/610080299/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 52,
    "side": "RIGHT",
    "in_reply_to_id": 609908281
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/610129582",
    "pull_request_review_id": 631861574,
    "id": 610129582,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMDEyOTU4Mg==",
    "diff_hunk": "@@ -49,24 +49,27 @@ BOOST_FIXTURE_TEST_SUITE(util_tests, BasicTestingSetup)\n \n BOOST_AUTO_TEST_CASE(util_datadir)\n {\n-    ClearDatadirCache();\n-    const fs::path dd_norm = GetDataDir();\n+    ArgsManager argsManager;",
    "path": "src/test/util_tests.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "ec7769315f5ed62e6145492977226925e122292c",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "That's reasonable, I would maybe add a commment like /* Use local args variable instead of m_args to avoid making assumptions about test setup. */, but feel free to keep the variable.",
    "created_at": "2021-04-08T21:37:59Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r610129582",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/610129582"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r610129582"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/610129582/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 52,
    "side": "RIGHT",
    "in_reply_to_id": 609908281
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611002666",
    "pull_request_review_id": 632893355,
    "id": 611002666,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMTAwMjY2Ng==",
    "diff_hunk": "@@ -80,6 +81,7 @@ struct BasicTestingSetup {\n     ~BasicTestingSetup();\n \n     const fs::path m_path_root;\n+    ArgsManager m_args_manager;",
    "path": "src/test/util/setup_common.h",
    "position": null,
    "original_position": 12,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "d4f86a3f608c98365b537d78d7ef1693463d7b9b",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Applied, thanks.",
    "created_at": "2021-04-10T06:03:59Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r611002666",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611002666"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r611002666"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611002666/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 84,
    "side": "RIGHT",
    "in_reply_to_id": 609930822
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611002731",
    "pull_request_review_id": 632893411,
    "id": 611002731,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMTAwMjczMQ==",
    "diff_hunk": "@@ -195,6 +195,7 @@ class ArgsManager\n     std::map<OptionsCategory, std::map<std::string, Arg>> m_available_args GUARDED_BY(cs_args);\n     bool m_accept_any_command GUARDED_BY(cs_args){true};\n     std::list<SectionInfo> m_config_sections GUARDED_BY(cs_args);\n+    fs::path blocksPathCachedNetSpecific GUARDED_BY(cs_args);",
    "path": "src/util/system.h",
    "position": null,
    "original_position": 4,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "fa0b2291aa84fe372bb37a9fcbf1ad3165f7daea",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Applied, thanks.",
    "created_at": "2021-04-10T06:05:03Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r611002731",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611002731"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r611002731"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611002731/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 198,
    "side": "RIGHT",
    "in_reply_to_id": 609913613
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611002743",
    "pull_request_review_id": 632893427,
    "id": 611002743,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMTAwMjc0Mw==",
    "diff_hunk": "@@ -49,24 +49,27 @@ BOOST_FIXTURE_TEST_SUITE(util_tests, BasicTestingSetup)\n \n BOOST_AUTO_TEST_CASE(util_datadir)\n {\n-    ClearDatadirCache();\n-    const fs::path dd_norm = GetDataDir();\n+    ArgsManager argsManager;",
    "path": "src/test/util_tests.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "ec7769315f5ed62e6145492977226925e122292c",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Added comment, thanks.",
    "created_at": "2021-04-10T06:05:24Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r611002743",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611002743"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r611002743"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611002743/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 52,
    "side": "RIGHT",
    "in_reply_to_id": 609908281
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611003251",
    "pull_request_review_id": 632893677,
    "id": 611003251,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMTAwMzI1MQ==",
    "diff_hunk": "@@ -388,6 +388,45 @@ std::optional<unsigned int> ArgsManager::GetArgFlags(const std::string& name) co\n     return std::nullopt;\n }\n \n+const fs::path& ArgsManager::GetDataDirPath(bool fNetSpecific)\n+{\n+    LOCK(cs_args);\n+    fs::path &path = fNetSpecific ? datadirPathCachedNetSpecific : datadirPathCached;\n+\n+    // Cache the path to avoid calling fs::create_directories on every call of\n+    // this function\n+    if (!path.empty()) return path;\n+\n+    std::string datadir = GetArg(\"-datadir\", \"\");\n+    if (!datadir.empty()) {\n+        path = fs::system_complete(datadir);\n+        if (!fs::is_directory(path)) {\n+            path = \"\";\n+            return path;\n+        }\n+    } else {\n+        path = GetDefaultDataDir();\n+    }\n+    if (fNetSpecific)\n+        path /= BaseParams().DataDir();\n+\n+    if (fs::create_directories(path)) {\n+        // This is the first run, create wallets subdirectory too\n+        fs::create_directories(path / \"wallets\");\n+    }\n+\n+    path = StripRedundantLastElementsOfPath(path);\n+    return path;\n+}\n+\n+void ArgsManager::ClearDatadirPathCache()",
    "path": "src/util/system.cpp",
    "position": null,
    "original_position": 35,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "839324993aeb8448af5a811b7323fa460ac9eac7",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This is fixed on my system now. Thanks.",
    "created_at": "2021-04-10T06:09:39Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r611003251",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611003251"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r611003251"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611003251/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 422,
    "side": "RIGHT",
    "in_reply_to_id": 609924623
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611003318",
    "pull_request_review_id": 632893712,
    "id": 611003318,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMTAwMzMxOA==",
    "diff_hunk": "@@ -723,22 +736,7 @@ fs::path GetDefaultDataDir()\n #endif\n }\n \n-namespace {\n-fs::path StripRedundantLastElementsOfPath(const fs::path& path)\n-{\n-    auto result = path;\n-    while (result.filename().string() == \".\") {\n-        result = result.parent_path();\n-    }\n-\n-    assert(fs::equivalent(result, path));\n-    return result;\n-}\n-} // namespace\n-\n static fs::path g_blocks_path_cache_net_specific;\n-static fs::path pathCached;\n-static fs::path pathCachedNetSpecific;",
    "path": "src/util/system.cpp",
    "position": 121,
    "original_position": 39,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "c44993ad96d649be48c94d4ae38d354d609a7282",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Fixed, thanks.",
    "created_at": "2021-04-10T06:10:17Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r611003318",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611003318"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r611003318"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611003318/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 740,
    "original_start_line": 740,
    "start_side": "LEFT",
    "line": 741,
    "original_line": 741,
    "side": "LEFT",
    "in_reply_to_id": 609922475
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611003367",
    "pull_request_review_id": 632893743,
    "id": 611003367,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMTAwMzM2Nw==",
    "diff_hunk": "@@ -200,6 +200,8 @@ class ArgsManager\n     std::map<OptionsCategory, std::map<std::string, Arg>> m_available_args GUARDED_BY(cs_args);\n     bool m_accept_any_command GUARDED_BY(cs_args){true};\n     std::list<SectionInfo> m_config_sections GUARDED_BY(cs_args);\n+    fs::path datadirPathCached GUARDED_BY(cs_args);\n+    fs::path datadirPathCachedNetSpecific GUARDED_BY(cs_args);",
    "path": "src/util/system.h",
    "position": null,
    "original_position": 5,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "839324993aeb8448af5a811b7323fa460ac9eac7",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Applied, thanks.",
    "created_at": "2021-04-10T06:10:49Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r611003367",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611003367"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r611003367"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611003367/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 203,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 204,
    "side": "RIGHT",
    "in_reply_to_id": 609904991
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611808883",
    "pull_request_review_id": 633779754,
    "id": 611808883,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMTgwODg4Mw==",
    "diff_hunk": "@@ -737,8 +776,6 @@ fs::path GetDefaultDataDir()\n }\n \n static fs::path g_blocks_path_cache_net_specific;\n-static fs::path pathCached;\n-static fs::path pathCachedNetSpecific;",
    "path": "src/util/system.cpp",
    "position": null,
    "original_position": 77,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "fac964698fab1b269d4414dc54560b29a3eccd18",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Move GetDataDir(fNetSpecific) implementation to ArgsManager.\" (fac964698fab1b269d4414dc54560b29a3eccd18)\r\n\r\nNote (no change suggested): I was initially confused why `pathCached` and `pathCachedNetSpecific` were being removed in this commit without also removing `g_blocks_path_cache_net_specific`. But it's removed in a later commit, and the reason for treating it differently just seems to be that it's needed many fewer places, so the `::GetBlocksDir` wrapper function can be dropped right away, unlike `::GetDataDir`\r\n",
    "created_at": "2021-04-12T17:09:56Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r611808883",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611808883"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r611808883"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611808883/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 778,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 741,
    "side": "LEFT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611817653",
    "pull_request_review_id": 633779754,
    "id": 611817653,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMTgxNzY1Mw==",
    "diff_hunk": "@@ -49,24 +49,28 @@ BOOST_FIXTURE_TEST_SUITE(util_tests, BasicTestingSetup)\n \n BOOST_AUTO_TEST_CASE(util_datadir)\n {\n-    ClearDatadirCache();\n-    const fs::path dd_norm = GetDataDir();\n+    // Use local args variable instead of m_args to avoid making assumptions about test setup\n+    ArgsManager args;\n+    args.ForceSetArg(\"-datadir\", m_path_root.string());\n \n-    gArgs.ForceSetArg(\"-datadir\", dd_norm.string() + \"/\");\n-    ClearDatadirCache();\n-    BOOST_CHECK_EQUAL(dd_norm, GetDataDir());\n+    fs::path dd_norm = args.GetDataDirPath();\n \n-    gArgs.ForceSetArg(\"-datadir\", dd_norm.string() + \"/.\");\n-    ClearDatadirCache();\n-    BOOST_CHECK_EQUAL(dd_norm, GetDataDir());\n-\n-    gArgs.ForceSetArg(\"-datadir\", dd_norm.string() + \"/./\");\n-    ClearDatadirCache();\n-    BOOST_CHECK_EQUAL(dd_norm, GetDataDir());\n-\n-    gArgs.ForceSetArg(\"-datadir\", dd_norm.string() + \"/.//\");\n-    ClearDatadirCache();",
    "path": "src/test/util_tests.cpp",
    "position": 30,
    "original_position": 24,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "8584666393255a7ce62d741ddd8d994c486423c6",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Modify \"util_datadir\" unit test to not use gArgs.\" (8584666393255a7ce62d741ddd8d994c486423c6)\r\n\r\nIt seems like the checks in this test might be meaningless now that the ClearDatadirCache calls are dropped, because the repeated `BOOST_CHECK_EQUAL(dd_norm, args.GetDataDirPath());` checks will keep passing no matter what value `-datadir` is force set to.\r\n\r\nI think it would be best for this commit to either keep the Clear calls so the test is changed as little as possible. Or the test could be rewritten to use different expected values or different args objects.",
    "created_at": "2021-04-12T17:23:28Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r611817653",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611817653"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r611817653"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/611817653/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 68,
    "original_line": 68,
    "side": "LEFT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/612452863",
    "pull_request_review_id": 634597651,
    "id": 612452863,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMjQ1Mjg2Mw==",
    "diff_hunk": "@@ -49,24 +49,28 @@ BOOST_FIXTURE_TEST_SUITE(util_tests, BasicTestingSetup)\n \n BOOST_AUTO_TEST_CASE(util_datadir)\n {\n-    ClearDatadirCache();\n-    const fs::path dd_norm = GetDataDir();\n+    // Use local args variable instead of m_args to avoid making assumptions about test setup\n+    ArgsManager args;\n+    args.ForceSetArg(\"-datadir\", m_path_root.string());\n \n-    gArgs.ForceSetArg(\"-datadir\", dd_norm.string() + \"/\");\n-    ClearDatadirCache();\n-    BOOST_CHECK_EQUAL(dd_norm, GetDataDir());\n+    fs::path dd_norm = args.GetDataDirPath();\n \n-    gArgs.ForceSetArg(\"-datadir\", dd_norm.string() + \"/.\");\n-    ClearDatadirCache();\n-    BOOST_CHECK_EQUAL(dd_norm, GetDataDir());\n-\n-    gArgs.ForceSetArg(\"-datadir\", dd_norm.string() + \"/./\");\n-    ClearDatadirCache();\n-    BOOST_CHECK_EQUAL(dd_norm, GetDataDir());\n-\n-    gArgs.ForceSetArg(\"-datadir\", dd_norm.string() + \"/.//\");\n-    ClearDatadirCache();",
    "path": "src/test/util_tests.cpp",
    "position": 30,
    "original_position": 24,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "8584666393255a7ce62d741ddd8d994c486423c6",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "You are right. I have put those commands back.",
    "created_at": "2021-04-13T13:35:38Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r612452863",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/612452863"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r612452863"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/612452863/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 68,
    "original_line": 68,
    "side": "LEFT",
    "in_reply_to_id": 611817653
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/612455831",
    "pull_request_review_id": 634601604,
    "id": 612455831,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxMjQ1NTgzMQ==",
    "diff_hunk": "@@ -737,8 +776,6 @@ fs::path GetDefaultDataDir()\n }\n \n static fs::path g_blocks_path_cache_net_specific;\n-static fs::path pathCached;\n-static fs::path pathCachedNetSpecific;",
    "path": "src/util/system.cpp",
    "position": null,
    "original_position": 77,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "fac964698fab1b269d4414dc54560b29a3eccd18",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "My primary objective was to tackle `::GetDataDir` but then it led me to handle `::GetBlocksDir` too. I did not want to modify those two at the same time.",
    "created_at": "2021-04-13T13:38:58Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r612455831",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/612455831"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r612455831"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/612455831/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 778,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 741,
    "side": "LEFT",
    "in_reply_to_id": 611808883
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615274095",
    "pull_request_review_id": 638239882,
    "id": 615274095,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTI3NDA5NQ==",
    "diff_hunk": "@@ -200,6 +196,9 @@ class ArgsManager\n     std::map<OptionsCategory, std::map<std::string, Arg>> m_available_args GUARDED_BY(cs_args);\n     bool m_accept_any_command GUARDED_BY(cs_args){true};\n     std::list<SectionInfo> m_config_sections GUARDED_BY(cs_args);\n+    fs::path m_cached_blocks_path GUARDED_BY(cs_args);\n+    fs::path m_cached_datadir_path GUARDED_BY(cs_args);\n+    fs::path m_cached_network_datadir_path GUARDED_BY(cs_args);",
    "path": "src/util/system.h",
    "position": null,
    "original_position": 20,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "834b971bff371951e3e63617d0a3fb9b3ad79c62",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "As these data members are cache, why do not declare them `mutable`?\r\nIt will allow to keep `const`ness of the `GetSettingsPath` and `WriteSettingsFile`.",
    "created_at": "2021-04-17T16:25:59Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615274095",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615274095"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615274095"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615274095/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 199,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 201,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615275565",
    "pull_request_review_id": 638239882,
    "id": 615275565,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTI3NTU2NQ==",
    "diff_hunk": "@@ -263,6 +262,27 @@ class ArgsManager\n      */\n     std::optional<const Command> GetCommand() const;\n \n+    /**\n+     * Get blocks directory path\n+     *\n+     * @return Blocks path which is network specific\n+     */\n+    const fs::path& GetBlocksDirPath();\n+\n+    /**\n+     * Get data directory path\n+     *\n+     * @param fNetSpecific Append network identifier to the returned path\n+     * @return Absolute path on success, otherwise an empty path when a non-directory path would be returned\n+     * @post Returned directory path is created unless it is empty\n+     */\n+    const fs::path &GetDataDirPath(bool fNetSpecific = true);\n+\n+    /**\n+     * For testing\n+     */\n+    void ClearPathCache();",
    "path": "src/util/system.h",
    "position": null,
    "original_position": 47,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "834b971bff371951e3e63617d0a3fb9b3ad79c62",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The description of this function is not true: https://github.com/bitcoin/bitcoin/blob/834b971bff371951e3e63617d0a3fb9b3ad79c62/src/util/system.cpp#L974",
    "created_at": "2021-04-17T16:37:31Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615275565",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615275565"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615275565"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615275565/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 281,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 284,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615275684",
    "pull_request_review_id": 638239882,
    "id": 615275684,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTI3NTY4NA==",
    "diff_hunk": "@@ -263,6 +262,27 @@ class ArgsManager\n      */\n     std::optional<const Command> GetCommand() const;\n \n+    /**\n+     * Get blocks directory path\n+     *\n+     * @return Blocks path which is network specific\n+     */\n+    const fs::path& GetBlocksDirPath();\n+\n+    /**\n+     * Get data directory path\n+     *\n+     * @param fNetSpecific Append network identifier to the returned path\n+     * @return Absolute path on success, otherwise an empty path when a non-directory path would be returned\n+     * @post Returned directory path is created unless it is empty\n+     */\n+    const fs::path &GetDataDirPath(bool fNetSpecific = true);",
    "path": "src/util/system.h",
    "position": null,
    "original_position": 42,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "834b971bff371951e3e63617d0a3fb9b3ad79c62",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "```suggestion\r\n    const fs::path& GetDataDirPath(bool net_specific = true);\r\n```",
    "created_at": "2021-04-17T16:38:31Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615275684",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615275684"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615275684"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615275684/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 279,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615275948",
    "pull_request_review_id": 638239882,
    "id": 615275948,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTI3NTk0OA==",
    "diff_hunk": "@@ -375,6 +388,72 @@ std::optional<unsigned int> ArgsManager::GetArgFlags(const std::string& name) co\n     return std::nullopt;\n }\n \n+const fs::path& ArgsManager::GetBlocksDirPath()\n+{\n+    LOCK(cs_args);\n+    fs::path &path = m_cached_blocks_path;\n+\n+    // Cache the path to avoid calling fs::create_directories on every call of\n+    // this function\n+    if (!path.empty()) return path;\n+\n+    if (IsArgSet(\"-blocksdir\")) {\n+        path = fs::system_complete(GetArg(\"-blocksdir\", \"\"));\n+        if (!fs::is_directory(path)) {\n+            path = \"\";\n+            return path;\n+        }\n+    } else {\n+        path = GetDataDirPath(false);\n+    }\n+\n+    path /= BaseParams().DataDir();\n+    path /= \"blocks\";\n+    fs::create_directories(path);\n+    path = StripRedundantLastElementsOfPath(path);\n+    return path;\n+}\n+\n+const fs::path& ArgsManager::GetDataDirPath(bool fNetSpecific)\n+{\n+    LOCK(cs_args);\n+    fs::path &path = fNetSpecific ? m_cached_network_datadir_path : m_cached_datadir_path;",
    "path": "src/util/system.cpp",
    "position": null,
    "original_position": 53,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "834b971bff371951e3e63617d0a3fb9b3ad79c62",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "style nit:\r\n```suggestion\r\n    fs::path& path = fNetSpecific ? m_cached_network_datadir_path : m_cached_datadir_path;\r\n```",
    "created_at": "2021-04-17T16:40:49Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615275948",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615275948"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615275948"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615275948/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 420,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615275994",
    "pull_request_review_id": 638239882,
    "id": 615275994,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTI3NTk5NA==",
    "diff_hunk": "@@ -375,6 +388,72 @@ std::optional<unsigned int> ArgsManager::GetArgFlags(const std::string& name) co\n     return std::nullopt;\n }\n \n+const fs::path& ArgsManager::GetBlocksDirPath()\n+{\n+    LOCK(cs_args);\n+    fs::path &path = m_cached_blocks_path;",
    "path": "src/util/system.cpp",
    "position": null,
    "original_position": 27,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "834b971bff371951e3e63617d0a3fb9b3ad79c62",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "style nit:\r\n```suggestion\r\n    fs::path& path = m_cached_blocks_path;\r\n```",
    "created_at": "2021-04-17T16:41:15Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615275994",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615275994"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615275994"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615275994/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 394,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615281482",
    "pull_request_review_id": 638245317,
    "id": 615281482,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTI4MTQ4Mg==",
    "diff_hunk": "@@ -263,6 +262,27 @@ class ArgsManager\n      */\n     std::optional<const Command> GetCommand() const;\n \n+    /**\n+     * Get blocks directory path\n+     *\n+     * @return Blocks path which is network specific\n+     */\n+    const fs::path& GetBlocksDirPath();\n+\n+    /**\n+     * Get data directory path\n+     *\n+     * @param fNetSpecific Append network identifier to the returned path\n+     * @return Absolute path on success, otherwise an empty path when a non-directory path would be returned\n+     * @post Returned directory path is created unless it is empty\n+     */\n+    const fs::path &GetDataDirPath(bool fNetSpecific = true);\n+\n+    /**\n+     * For testing\n+     */\n+    void ClearPathCache();",
    "path": "src/util/system.h",
    "position": null,
    "original_position": 47,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "834b971bff371951e3e63617d0a3fb9b3ad79c62",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Do you have a suggestion for the description?\r\n\r\nI think the comment is mostly unhelpful as it is too generic anyway. I would write something like that it's useful to propagate changes in args. I'm not sure about proper English wording though.",
    "created_at": "2021-04-17T17:33:18Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615281482",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615281482"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615281482"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615281482/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 281,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 284,
    "side": "RIGHT",
    "in_reply_to_id": 615275565
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615281490",
    "pull_request_review_id": 638245738,
    "id": 615281490,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTI4MTQ5MA==",
    "diff_hunk": "@@ -263,6 +262,27 @@ class ArgsManager\n      */\n     std::optional<const Command> GetCommand() const;\n \n+    /**\n+     * Get blocks directory path\n+     *\n+     * @return Blocks path which is network specific\n+     */\n+    const fs::path& GetBlocksDirPath();\n+\n+    /**\n+     * Get data directory path\n+     *\n+     * @param fNetSpecific Append network identifier to the returned path\n+     * @return Absolute path on success, otherwise an empty path when a non-directory path would be returned\n+     * @post Returned directory path is created unless it is empty\n+     */\n+    const fs::path &GetDataDirPath(bool fNetSpecific = true);",
    "path": "src/util/system.h",
    "position": null,
    "original_position": 42,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "834b971bff371951e3e63617d0a3fb9b3ad79c62",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes, thank you.",
    "created_at": "2021-04-17T17:33:34Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615281490",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615281490"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615281490"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615281490/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 279,
    "side": "RIGHT",
    "in_reply_to_id": 615275684
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615281499",
    "pull_request_review_id": 638245900,
    "id": 615281499,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTI4MTQ5OQ==",
    "diff_hunk": "@@ -375,6 +388,72 @@ std::optional<unsigned int> ArgsManager::GetArgFlags(const std::string& name) co\n     return std::nullopt;\n }\n \n+const fs::path& ArgsManager::GetBlocksDirPath()\n+{\n+    LOCK(cs_args);\n+    fs::path &path = m_cached_blocks_path;\n+\n+    // Cache the path to avoid calling fs::create_directories on every call of\n+    // this function\n+    if (!path.empty()) return path;\n+\n+    if (IsArgSet(\"-blocksdir\")) {\n+        path = fs::system_complete(GetArg(\"-blocksdir\", \"\"));\n+        if (!fs::is_directory(path)) {\n+            path = \"\";\n+            return path;\n+        }\n+    } else {\n+        path = GetDataDirPath(false);\n+    }\n+\n+    path /= BaseParams().DataDir();\n+    path /= \"blocks\";\n+    fs::create_directories(path);\n+    path = StripRedundantLastElementsOfPath(path);\n+    return path;\n+}\n+\n+const fs::path& ArgsManager::GetDataDirPath(bool fNetSpecific)\n+{\n+    LOCK(cs_args);\n+    fs::path &path = fNetSpecific ? m_cached_network_datadir_path : m_cached_datadir_path;",
    "path": "src/util/system.cpp",
    "position": null,
    "original_position": 53,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "834b971bff371951e3e63617d0a3fb9b3ad79c62",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes, thank you.",
    "created_at": "2021-04-17T17:33:41Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615281499",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615281499"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615281499"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615281499/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 420,
    "side": "RIGHT",
    "in_reply_to_id": 615275948
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615282423",
    "pull_request_review_id": 638258898,
    "id": 615282423,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTI4MjQyMw==",
    "diff_hunk": "@@ -263,6 +262,27 @@ class ArgsManager\n      */\n     std::optional<const Command> GetCommand() const;\n \n+    /**\n+     * Get blocks directory path\n+     *\n+     * @return Blocks path which is network specific\n+     */\n+    const fs::path& GetBlocksDirPath();\n+\n+    /**\n+     * Get data directory path\n+     *\n+     * @param fNetSpecific Append network identifier to the returned path\n+     * @return Absolute path on success, otherwise an empty path when a non-directory path would be returned\n+     * @post Returned directory path is created unless it is empty\n+     */\n+    const fs::path &GetDataDirPath(bool fNetSpecific = true);\n+\n+    /**\n+     * For testing\n+     */\n+    void ClearPathCache();",
    "path": "src/util/system.h",
    "position": null,
    "original_position": 47,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "834b971bff371951e3e63617d0a3fb9b3ad79c62",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Obviously, I'm not an [Official Namer Of Stuff](https://github.com/bitcoin/bitcoin/pull/20861#discussion_r596389178) :)\r\n\r\nMaybe \"Clear cached directory paths\"?",
    "created_at": "2021-04-17T17:42:06Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615282423",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615282423"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615282423"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615282423/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 1,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 281,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 284,
    "side": "RIGHT",
    "in_reply_to_id": 615275565
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615290028",
    "pull_request_review_id": 638266526,
    "id": 615290028,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTI5MDAyOA==",
    "diff_hunk": "@@ -200,6 +196,9 @@ class ArgsManager\n     std::map<OptionsCategory, std::map<std::string, Arg>> m_available_args GUARDED_BY(cs_args);\n     bool m_accept_any_command GUARDED_BY(cs_args){true};\n     std::list<SectionInfo> m_config_sections GUARDED_BY(cs_args);\n+    fs::path m_cached_blocks_path GUARDED_BY(cs_args);\n+    fs::path m_cached_datadir_path GUARDED_BY(cs_args);\n+    fs::path m_cached_network_datadir_path GUARDED_BY(cs_args);",
    "path": "src/util/system.h",
    "position": null,
    "original_position": 20,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "834b971bff371951e3e63617d0a3fb9b3ad79c62",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I have modified this.",
    "created_at": "2021-04-17T18:34:32Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615290028",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615290028"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615290028"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615290028/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 199,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 201,
    "side": "RIGHT",
    "in_reply_to_id": 615274095
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615296625",
    "pull_request_review_id": 638270583,
    "id": 615296625,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTI5NjYyNQ==",
    "diff_hunk": "@@ -49,24 +49,27 @@ BOOST_FIXTURE_TEST_SUITE(util_tests, BasicTestingSetup)\n \n BOOST_AUTO_TEST_CASE(util_datadir)\n {\n-    ClearDatadirCache();\n-    const fs::path dd_norm = GetDataDir();\n+    // Use local args variable instead of m_args to avoid making assumptions about test setup\n+    ArgsManager args;\n+    args.ForceSetArg(\"-datadir\", m_path_root.string());\n \n-    gArgs.ForceSetArg(\"-datadir\", dd_norm.string() + \"/\");\n-    ClearDatadirCache();\n-    BOOST_CHECK_EQUAL(dd_norm, GetDataDir());\n+    fs::path dd_norm = args.GetDataDirPath();",
    "path": "src/test/util_tests.cpp",
    "position": null,
    "original_position": 13,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "69b8c4ad40185862fe199005c81a75d582053bd4",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Why `const` removed?",
    "created_at": "2021-04-17T19:43:16Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615296625",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615296625"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615296625"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615296625/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 56,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615301304",
    "pull_request_review_id": 638273371,
    "id": 615301304,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTMwMTMwNA==",
    "diff_hunk": "@@ -87,6 +88,7 @@ BasicTestingSetup::BasicTestingSetup(const std::string& chainName, const std::ve\n         extra_args);\n     util::ThreadRename(\"test\");\n     fs::create_directories(m_path_root);\n+    m_args.ForceSetArg(\"-datadir\", m_path_root.string());",
    "path": "src/test/util/setup_common.cpp",
    "position": 14,
    "original_position": 14,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "ea70f2266b4329cce75ccb8db73e426055f345a8",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "There is already m_node.args. Any reason to avoid using that?",
    "created_at": "2021-04-17T20:32:56Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615301304",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615301304"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615301304"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615301304/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 91,
    "original_line": 91,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615302205",
    "pull_request_review_id": 638273889,
    "id": 615302205,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTMwMjIwNQ==",
    "diff_hunk": "@@ -87,6 +88,7 @@ BasicTestingSetup::BasicTestingSetup(const std::string& chainName, const std::ve\n         extra_args);\n     util::ThreadRename(\"test\");\n     fs::create_directories(m_path_root);\n+    m_args.ForceSetArg(\"-datadir\", m_path_root.string());",
    "path": "src/test/util/setup_common.cpp",
    "position": 14,
    "original_position": 14,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "ea70f2266b4329cce75ccb8db73e426055f345a8",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> There is already m_node.args. Any reason to avoid using that?\r\n\r\nI suggested this for a followup (It would be a bigger change involving init and might also require updating more tests). Diff was here: https://github.com/bitcoin/bitcoin/pull/21244#issuecomment-816026224",
    "created_at": "2021-04-17T20:42:16Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615302205",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615302205"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615302205"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615302205/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 91,
    "original_line": 91,
    "side": "RIGHT",
    "in_reply_to_id": 615301304
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615303576",
    "pull_request_review_id": 638274624,
    "id": 615303576,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTMwMzU3Ng==",
    "diff_hunk": "@@ -87,6 +88,7 @@ BasicTestingSetup::BasicTestingSetup(const std::string& chainName, const std::ve\n         extra_args);\n     util::ThreadRename(\"test\");\n     fs::create_directories(m_path_root);\n+    m_args.ForceSetArg(\"-datadir\", m_path_root.string());",
    "path": "src/test/util/setup_common.cpp",
    "position": 14,
    "original_position": 14,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "ea70f2266b4329cce75ccb8db73e426055f345a8",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Until then I'd prefer to use `m_node.args->` (or `gArgs.` if that is too much typing). It will be a trivial scripted diff to change that to `m_args.`. But having three argsman in the tests (two of which are the same and one that is different) will just cause confusion and makes review harder/code more fragile. How would you protect against their state diverging?",
    "created_at": "2021-04-17T20:57:29Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615303576",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615303576"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615303576"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615303576/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 91,
    "original_line": 91,
    "side": "RIGHT",
    "in_reply_to_id": 615301304
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615307465",
    "pull_request_review_id": 638276806,
    "id": 615307465,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTMwNzQ2NQ==",
    "diff_hunk": "@@ -87,6 +88,7 @@ BasicTestingSetup::BasicTestingSetup(const std::string& chainName, const std::ve\n         extra_args);\n     util::ThreadRename(\"test\");\n     fs::create_directories(m_path_root);\n+    m_args.ForceSetArg(\"-datadir\", m_path_root.string());",
    "path": "src/test/util/setup_common.cpp",
    "position": 14,
    "original_position": 14,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "ea70f2266b4329cce75ccb8db73e426055f345a8",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I'm happy with any intermediate state. Here's what I think the ultimate goal should be:\r\n\r\n- Tests should have an `ArgsManager m_args` member that is newly initialized before each test and completely destroyed after each test.\r\n- Where possible, tests should pass `m_args` references directly to functions that are being tested and need to read options.\r\n- Tests can pass `m_args` pointers indirectly through `NodeContext` when they are calling node RPC methods, or through `WalletContext` when they are calling wallet RPC methods.\r\n- Unless tests are calling RPC methods or init code, they probably don't need `NodeContext` and `WalletContext` instances and it would be nice to drop `NodeContext` from the base test class.\r\n- `gArgs` should go away in node and wallet code. It might be useful to keep `gArgs` in test code to read test options (random seeds, timeouts, log options, debug options). It might make sense to keep `gArgs` in GUI code since GUI code relies on other global singletons like `QApplications` and `QSettings` and trying to get rid of it might just add extra complexity.\r\n\r\nThe current PR seems just like a good a first step in this direction to me since it adds local test `ArgsManager` instances and starts to use them minimally.\r\n\r\nThese are just my thoughts though. I think any approach you want to take here is probably reasonable.",
    "created_at": "2021-04-17T21:40:13Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615307465",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615307465"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615307465"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615307465/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 91,
    "original_line": 91,
    "side": "RIGHT",
    "in_reply_to_id": 615301304
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615362236",
    "pull_request_review_id": 638305381,
    "id": 615362236,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTM2MjIzNg==",
    "diff_hunk": "@@ -172,24 +172,24 @@ BOOST_AUTO_TEST_CASE(boolargno)\n     const auto bar = std::make_pair(\"-bar\", ArgsManager::ALLOW_ANY);\n     SetupArgs({foo, bar});\n     ResetArgs(\"-nofoo\");\n-    BOOST_CHECK(!m_args.GetBoolArg(\"-foo\", true));\n-    BOOST_CHECK(!m_args.GetBoolArg(\"-foo\", false));\n+    BOOST_CHECK(!m_local_args.GetBoolArg(\"-foo\", true));\n+    BOOST_CHECK(!m_local_args.GetBoolArg(\"-foo\", false));\n \n     ResetArgs(\"-nofoo=1\");\n-    BOOST_CHECK(!m_args.GetBoolArg(\"-foo\", true));\n-    BOOST_CHECK(!m_args.GetBoolArg(\"-foo\", false));\n+    BOOST_CHECK(!m_local_args.GetBoolArg(\"-foo\", true));\n+    BOOST_CHECK(!m_local_args.GetBoolArg(\"-foo\", false));\n \n     ResetArgs(\"-nofoo=0\");\n-    BOOST_CHECK(m_args.GetBoolArg(\"-foo\", true));\n-    BOOST_CHECK(m_args.GetBoolArg(\"-foo\", false));\n+    BOOST_CHECK(m_local_args.GetBoolArg(\"-foo\", true));\n+    BOOST_CHECK(m_local_args.GetBoolArg(\"-foo\", false));\n \n     ResetArgs(\"-foo --nofoo\"); // --nofoo should win\n-    BOOST_CHECK(!m_args.GetBoolArg(\"-foo\", true));\n-    BOOST_CHECK(!m_args.GetBoolArg(\"-foo\", false));\n+    BOOST_CHECK(!m_local_args.GetBoolArg(\"-foo\", true));\n+    BOOST_CHECK(!m_local_args.GetBoolArg(\"-foo\", false));\n \n     ResetArgs(\"-nofoo -foo\"); // foo always wins:\n-    BOOST_CHECK(m_args.GetBoolArg(\"-foo\", true));\n-    BOOST_CHECK(m_args.GetBoolArg(\"-foo\", false));\n+    BOOST_CHECK(m_local_args.GetBoolArg(\"-foo\", true));\n+    BOOST_CHECK(m_local_args.GetBoolArg(\"-foo\", false));",
    "path": "src/test/getarg_tests.cpp",
    "position": 214,
    "original_position": 214,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "ea70f2266b4329cce75ccb8db73e426055f345a8",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This diff could be a scripted-diff in a separate commit?",
    "created_at": "2021-04-18T08:20:50Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615362236",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615362236"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615362236"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615362236/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 192,
    "original_line": 192,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615362285",
    "pull_request_review_id": 638305412,
    "id": 615362285,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTM2MjI4NQ==",
    "diff_hunk": "@@ -87,6 +88,7 @@ BasicTestingSetup::BasicTestingSetup(const std::string& chainName, const std::ve\n         extra_args);\n     util::ThreadRename(\"test\");\n     fs::create_directories(m_path_root);\n+    m_args.ForceSetArg(\"-datadir\", m_path_root.string());",
    "path": "src/test/util/setup_common.cpp",
    "position": 14,
    "original_position": 14,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "ea70f2266b4329cce75ccb8db73e426055f345a8",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Fair enough, any approach fine by me, too",
    "created_at": "2021-04-18T08:21:08Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615362285",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615362285"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615362285"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615362285/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 91,
    "original_line": 91,
    "side": "RIGHT",
    "in_reply_to_id": 615301304
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615374776",
    "pull_request_review_id": 638313754,
    "id": 615374776,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTM3NDc3Ng==",
    "diff_hunk": "@@ -49,24 +49,27 @@ BOOST_FIXTURE_TEST_SUITE(util_tests, BasicTestingSetup)\n \n BOOST_AUTO_TEST_CASE(util_datadir)\n {\n-    ClearDatadirCache();\n-    const fs::path dd_norm = GetDataDir();\n+    // Use local args variable instead of m_args to avoid making assumptions about test setup\n+    ArgsManager args;\n+    args.ForceSetArg(\"-datadir\", m_path_root.string());\n \n-    gArgs.ForceSetArg(\"-datadir\", dd_norm.string() + \"/\");\n-    ClearDatadirCache();\n-    BOOST_CHECK_EQUAL(dd_norm, GetDataDir());\n+    fs::path dd_norm = args.GetDataDirPath();",
    "path": "src/test/util_tests.cpp",
    "position": null,
    "original_position": 13,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "69b8c4ad40185862fe199005c81a75d582053bd4",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Will be addressed in the next push. Thanks.",
    "created_at": "2021-04-18T10:04:36Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615374776",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615374776"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615374776"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615374776/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 56,
    "side": "RIGHT",
    "in_reply_to_id": 615296625
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615374809",
    "pull_request_review_id": 638313776,
    "id": 615374809,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTM3NDgwOQ==",
    "diff_hunk": "@@ -172,24 +172,24 @@ BOOST_AUTO_TEST_CASE(boolargno)\n     const auto bar = std::make_pair(\"-bar\", ArgsManager::ALLOW_ANY);\n     SetupArgs({foo, bar});\n     ResetArgs(\"-nofoo\");\n-    BOOST_CHECK(!m_args.GetBoolArg(\"-foo\", true));\n-    BOOST_CHECK(!m_args.GetBoolArg(\"-foo\", false));\n+    BOOST_CHECK(!m_local_args.GetBoolArg(\"-foo\", true));\n+    BOOST_CHECK(!m_local_args.GetBoolArg(\"-foo\", false));\n \n     ResetArgs(\"-nofoo=1\");\n-    BOOST_CHECK(!m_args.GetBoolArg(\"-foo\", true));\n-    BOOST_CHECK(!m_args.GetBoolArg(\"-foo\", false));\n+    BOOST_CHECK(!m_local_args.GetBoolArg(\"-foo\", true));\n+    BOOST_CHECK(!m_local_args.GetBoolArg(\"-foo\", false));\n \n     ResetArgs(\"-nofoo=0\");\n-    BOOST_CHECK(m_args.GetBoolArg(\"-foo\", true));\n-    BOOST_CHECK(m_args.GetBoolArg(\"-foo\", false));\n+    BOOST_CHECK(m_local_args.GetBoolArg(\"-foo\", true));\n+    BOOST_CHECK(m_local_args.GetBoolArg(\"-foo\", false));\n \n     ResetArgs(\"-foo --nofoo\"); // --nofoo should win\n-    BOOST_CHECK(!m_args.GetBoolArg(\"-foo\", true));\n-    BOOST_CHECK(!m_args.GetBoolArg(\"-foo\", false));\n+    BOOST_CHECK(!m_local_args.GetBoolArg(\"-foo\", true));\n+    BOOST_CHECK(!m_local_args.GetBoolArg(\"-foo\", false));\n \n     ResetArgs(\"-nofoo -foo\"); // foo always wins:\n-    BOOST_CHECK(m_args.GetBoolArg(\"-foo\", true));\n-    BOOST_CHECK(m_args.GetBoolArg(\"-foo\", false));\n+    BOOST_CHECK(m_local_args.GetBoolArg(\"-foo\", true));\n+    BOOST_CHECK(m_local_args.GetBoolArg(\"-foo\", false));",
    "path": "src/test/getarg_tests.cpp",
    "position": 214,
    "original_position": 214,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "ea70f2266b4329cce75ccb8db73e426055f345a8",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes, will be addressed in the next push.",
    "created_at": "2021-04-18T10:04:54Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615374809",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615374809"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615374809"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615374809/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 192,
    "original_line": 192,
    "side": "RIGHT",
    "in_reply_to_id": 615362236
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615375149",
    "pull_request_review_id": 638313985,
    "id": 615375149,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTM3NTE0OQ==",
    "diff_hunk": "@@ -263,6 +262,27 @@ class ArgsManager\n      */\n     std::optional<const Command> GetCommand() const;\n \n+    /**\n+     * Get blocks directory path\n+     *\n+     * @return Blocks path which is network specific\n+     */\n+    const fs::path& GetBlocksDirPath();\n+\n+    /**\n+     * Get data directory path\n+     *\n+     * @param fNetSpecific Append network identifier to the returned path\n+     * @return Absolute path on success, otherwise an empty path when a non-directory path would be returned\n+     * @post Returned directory path is created unless it is empty\n+     */\n+    const fs::path &GetDataDirPath(bool fNetSpecific = true);\n+\n+    /**\n+     * For testing\n+     */\n+    void ClearPathCache();",
    "path": "src/util/system.h",
    "position": null,
    "original_position": 47,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "834b971bff371951e3e63617d0a3fb9b3ad79c62",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Will be addressed in the next push.",
    "created_at": "2021-04-18T10:07:21Z",
    "updated_at": "2021-04-18T10:09:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615375149",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615375149"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615375149"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615375149/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 281,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 284,
    "side": "RIGHT",
    "in_reply_to_id": 615275565
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615380853",
    "pull_request_review_id": 638318006,
    "id": 615380853,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTM4MDg1Mw==",
    "diff_hunk": "@@ -87,6 +88,7 @@ BasicTestingSetup::BasicTestingSetup(const std::string& chainName, const std::ve\n         extra_args);\n     util::ThreadRename(\"test\");\n     fs::create_directories(m_path_root);\n+    m_args.ForceSetArg(\"-datadir\", m_path_root.string());",
    "path": "src/test/util/setup_common.cpp",
    "position": 14,
    "original_position": 14,
    "commit_id": "bb8d1c6e029a2fd01387599d2ff3bfc879a8ada5",
    "original_commit_id": "ea70f2266b4329cce75ccb8db73e426055f345a8",
    "user": {
      "login": "kiminuo",
      "id": 58662979,
      "node_id": "MDQ6VXNlcjU4NjYyOTc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/58662979?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kiminuo",
      "html_url": "https://github.com/kiminuo",
      "followers_url": "https://api.github.com/users/kiminuo/followers",
      "following_url": "https://api.github.com/users/kiminuo/following{/other_user}",
      "gists_url": "https://api.github.com/users/kiminuo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kiminuo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kiminuo/subscriptions",
      "organizations_url": "https://api.github.com/users/kiminuo/orgs",
      "repos_url": "https://api.github.com/users/kiminuo/repos",
      "events_url": "https://api.github.com/users/kiminuo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kiminuo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think Russell summarized it very nicely. \r\n\r\nMy approach with this PR is to use `m_args` wrt `GetDataDir()` functionality for tests. Yes, it is somewhat fragile at this point. If you are too concerned about this, I can revert that change in `BasicTestingSetup` and leave it for some follow-up PR. \r\n\r\nnote: There are tests that just need `GetDataDir()` function and not anything else from `ArgsManager`, these tests benefit from using `m_args` (instead of `gArgs`).\r\n\r\nnote 2: Originally, https://github.com/bitcoin/bitcoin/commit/6e7e67f855282ae4baa3756f2e95aee12de13f91 was a part of this PR and with this, one can see quite nicely where `gArgs` is used and that's one step closer to remove it from those places and make some more tests to be true unit tests.",
    "created_at": "2021-04-18T10:56:32Z",
    "updated_at": "2021-04-18T10:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615380853",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615380853"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/21244#discussion_r615380853"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/21244"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615380853/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 91,
    "original_line": 91,
    "side": "RIGHT",
    "in_reply_to_id": 615301304
  }
]