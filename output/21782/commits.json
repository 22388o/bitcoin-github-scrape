[
  {
    "sha": "d7c83cb067992f38d0b6f6d3a7896f971718e24b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkN2M4M2NiMDY3OTkyZjM4ZDBiNmY2ZDNhNzg5NmY5NzE3MThlMjRi",
    "commit": {
      "author": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2021-04-26T20:32:12Z"
      },
      "committer": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2021-04-27T11:30:49Z"
      },
      "message": "build: Fix static Darwin builds\n\nWhen doing static builds, for some reasons, SDK version is not handled\ncorrectly when Darwin Driver passes it to a linker via the\n-platform_version option.\n\nThis change makes passing the -platform_version option to a linker\nexplicit.",
      "tree": {
        "sha": "3e7d330234ec67fe7acbc322b2a7ffa57601ecdf",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3e7d330234ec67fe7acbc322b2a7ffa57601ecdf"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d7c83cb067992f38d0b6f6d3a7896f971718e24b",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE0dvyxLlvLev0wWZUQQEIES5+qB8FAmCH9ekACgkQQQEIES5+\nqB8NUA//dE5EJ8FQLLNiIcQI+UmmZUIBHZA+Lmc3Z9Q3pRf1IjJUYTdpXWcj+ov/\nlGXRr28DPdZp5CdvvkWW/Z9qIPz/nMPXIq7PcawdCAFk8W9RRSD9/UrINVyYmXWb\neccOwFyp2EYdEufuxY87RSwuT9gIeYjL1t1J8SWEJFkN0Iw78xqwenedrH8NCvtl\nalb3dVZff7cl+IWb42AdE/KMz3rrKWKCsnZ+EetEo6XxBXqy8ZcXiUV954Ma7hVK\nu3yNY0xrMOmlXBH/cQ5sgdQZluxLc61F9fietQkFyw6N3zZ+5U3IvPOrNBcezumb\nkAXtvelkkHYQwf1BdXbOG7o3Vweb+Hrtxhl1rMLjU7lGTZx3/bdKphNIUfls23Ls\n4uZa21DD+DHalMbm3gftGQiRri49aFRSVMlKvSHFLZAZdLtDhEcS1ZJJLcOE8UA0\nrei5UxIZbh7TntqplEVgYU0OZLAxRCdKjmZtN7uv5/8+M/Yoy0oFu+XvlPVzqZ8I\n7qR/l6NX5HS1iO+QlliTUsOkouDtbfwsBlaveBtM8Of8IaScjb02sL0KntehGg5j\ndi6ecaDdN07JUPjZADv++5hlVLQWSIkVzqAORNgOIg0pBL8+Ok/obhQ7X7oxPRWA\nT8lneP7ZhYq11moN4QqL+RorRB5JP7ZBUpVDpC/H2yoaCdauCFg=\n=4AzC\n-----END PGP SIGNATURE-----",
        "payload": "tree 3e7d330234ec67fe7acbc322b2a7ffa57601ecdf\nparent 683dda2a70e7a210996fa34be23bd0c563971ba9\nauthor Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1619469132 +0300\ncommitter Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1619523049 +0300\n\nbuild: Fix static Darwin builds\n\nWhen doing static builds, for some reasons, SDK version is not handled\ncorrectly when Darwin Driver passes it to a linker via the\n-platform_version option.\n\nThis change makes passing the -platform_version option to a linker\nexplicit.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d7c83cb067992f38d0b6f6d3a7896f971718e24b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/d7c83cb067992f38d0b6f6d3a7896f971718e24b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d7c83cb067992f38d0b6f6d3a7896f971718e24b/comments",
    "author": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "683dda2a70e7a210996fa34be23bd0c563971ba9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/683dda2a70e7a210996fa34be23bd0c563971ba9",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/683dda2a70e7a210996fa34be23bd0c563971ba9"
      }
    ],
    "stats": {
      "total": 17,
      "additions": 16,
      "deletions": 1
    },
    "files": [
      {
        "sha": "f809c34d06b53a98eb65d1b6a0fdaa6e10aa3599",
        "filename": "configure.ac",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d7c83cb067992f38d0b6f6d3a7896f971718e24b/configure.ac",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d7c83cb067992f38d0b6f6d3a7896f971718e24b/configure.ac",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/configure.ac?ref=d7c83cb067992f38d0b6f6d3a7896f971718e24b",
        "patch": "@@ -734,6 +734,9 @@ case $host in\n        esac\n      fi\n \n+     if test \"x$DARWIN_FLAGS\" != x; then\n+       AX_CHECK_LINK_FLAG([$DARWIN_FLAGS], [LDFLAGS=\"$LDFLAGS $DARWIN_FLAGS\"])\n+     fi\n      AX_CHECK_LINK_FLAG([[-Wl,-headerpad_max_install_names]], [LDFLAGS=\"$LDFLAGS -Wl,-headerpad_max_install_names\"],, [[$LDFLAG_WERROR]])\n      CPPFLAGS=\"$CPPFLAGS -DMAC_OSX -DOBJC_OLD_DISPATCH_PROTOTYPES=0\"\n      OBJCXXFLAGS=\"$CXXFLAGS\""
      },
      {
        "sha": "c90715edbc3372133de6ba2e7011a60c7bb093d4",
        "filename": "depends/Makefile",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d7c83cb067992f38d0b6f6d3a7896f971718e24b/depends/Makefile",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d7c83cb067992f38d0b6f6d3a7896f971718e24b/depends/Makefile",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/Makefile?ref=d7c83cb067992f38d0b6f6d3a7896f971718e24b",
        "patch": "@@ -228,6 +228,7 @@ $(host_prefix)/share/config.site : config.site.in $(host_prefix)/.stamp_$(final_\n             -e 's|@CXXFLAGS@|$(strip $(host_CXXFLAGS) $(host_$(release_type)_CXXFLAGS))|' \\\n             -e 's|@CPPFLAGS@|$(strip $(host_CPPFLAGS) $(host_$(release_type)_CPPFLAGS))|' \\\n             -e 's|@LDFLAGS@|$(strip $(host_LDFLAGS) $(host_$(release_type)_LDFLAGS))|' \\\n+            -e 's|@DARWIN_FLAGS@|$(darwin_FLAGS)|' \\\n             -e 's|@allow_host_packages@|$(ALLOW_HOST_PACKAGES)|' \\\n             -e 's|@no_qt@|$(NO_QT)|' \\\n             -e 's|@no_qr@|$(NO_QR)|' \\"
      },
      {
        "sha": "3c69a833fb9f17b12e75655f3b571d4c2f06ec4b",
        "filename": "depends/config.site.in",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d7c83cb067992f38d0b6f6d3a7896f971718e24b/depends/config.site.in",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d7c83cb067992f38d0b6f6d3a7896f971718e24b/depends/config.site.in",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/config.site.in?ref=d7c83cb067992f38d0b6f6d3a7896f971718e24b",
        "patch": "@@ -120,3 +120,6 @@ fi\n if test -n \"@LDFLAGS@\"; then\n   LDFLAGS=\"@LDFLAGS@ ${LDFLAGS}\"\n fi\n+if test -n \"@DARWIN_FLAGS@\"; then\n+  DARWIN_FLAGS=\"@DARWIN_FLAGS@\"\n+fi"
      },
      {
        "sha": "7e6846358e6973117c38bce7a966b165bd45c717",
        "filename": "depends/hosts/darwin.mk",
        "status": "modified",
        "additions": 9,
        "deletions": 1,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d7c83cb067992f38d0b6f6d3a7896f971718e24b/depends/hosts/darwin.mk",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d7c83cb067992f38d0b6f6d3a7896f971718e24b/depends/hosts/darwin.mk",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/hosts/darwin.mk?ref=d7c83cb067992f38d0b6f6d3a7896f971718e24b",
        "patch": "@@ -1,5 +1,11 @@\n OSX_MIN_VERSION=10.14\n-OSX_SDK_VERSION=10.15.1\n+\n+ifeq ($(build_os),darwin)\n+OSX_SDK_VERSION := $(shell xcrun --show-sdk-version)\n+else\n+OSX_SDK_VERSION := 10.15.1\n+endif\n+\n XCODE_VERSION=11.3.1\n XCODE_BUILD_ID=11C505\n LD64_VERSION=530\n@@ -123,4 +129,6 @@ darwin_release_CXXFLAGS=$(darwin_release_CFLAGS)\n darwin_debug_CFLAGS=-O1\n darwin_debug_CXXFLAGS=$(darwin_debug_CFLAGS)\n \n+darwin_FLAGS := -Wl,-platform_version -Wl,macos -Wl,$(OSX_MIN_VERSION) -Wl,$(OSX_SDK_VERSION)\n+\n darwin_cmake_system=Darwin"
      }
    ]
  }
]