[
  {
    "sha": "6b6b8e7edeba3360738fb40ebc12872a81089967",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2YjZiOGU3ZWRlYmEzMzYwNzM4ZmI0MGViYzEyODcyYTgxMDg5OTY3",
    "commit": {
      "author": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2021-08-11T01:23:38Z"
      },
      "committer": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2021-08-11T01:23:38Z"
      },
      "message": "build: Allow GIT_TAG and GIT_COMMIT to be specified to genbuild.sh\n\ngenbuild.sh figures out GIT_TAG and GIT_COMMIT by checking with git, but\nif git is not available, it generates a blank build.h file. However\nsometimes we will know the tag or commit and want to provide it to\ngenbuild.sh even when git is not available. Now GIT_TAG and GIT_COMMIT\ncan be set as environment variables, and if genbuild.sh cannot ask git\nfor this information, it will fallback to what was provided.",
      "tree": {
        "sha": "8c93ad6745d3563c2f2a5085e37e32a0cdd91601",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8c93ad6745d3563c2f2a5085e37e32a0cdd91601"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6b6b8e7edeba3360738fb40ebc12872a81089967",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6b6b8e7edeba3360738fb40ebc12872a81089967",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/6b6b8e7edeba3360738fb40ebc12872a81089967",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6b6b8e7edeba3360738fb40ebc12872a81089967/comments",
    "author": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "0b5344b0d18788e011f2d4a279c8c12a29f1428a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0b5344b0d18788e011f2d4a279c8c12a29f1428a",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/0b5344b0d18788e011f2d4a279c8c12a29f1428a"
      }
    ],
    "stats": {
      "total": 9,
      "additions": 3,
      "deletions": 6
    },
    "files": [
      {
        "sha": "e32ce830c7737629ac38f80f01834264a2331934",
        "filename": "share/genbuild.sh",
        "status": "modified",
        "additions": 3,
        "deletions": 6,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6b6b8e7edeba3360738fb40ebc12872a81089967/share/genbuild.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6b6b8e7edeba3360738fb40ebc12872a81089967/share/genbuild.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/share/genbuild.sh?ref=6b6b8e7edeba3360738fb40ebc12872a81089967",
        "patch": "@@ -18,17 +18,14 @@ else\n     exit 1\n fi\n \n-GIT_TAG=\"\"\n-GIT_COMMIT=\"\"\n+GIT_TAG=\"${GIT_TAG:-}\"\n+GIT_COMMIT=\"${GIT_COMMIT:-}\"\n if [ \"${BITCOIN_GENBUILD_NO_GIT}\" != \"1\" ] && [ -e \"$(command -v git)\" ] && [ \"$(git rev-parse --is-inside-work-tree 2>/dev/null)\" = \"true\" ]; then\n     # clean 'dirty' status of touched files that haven't been modified\n     git diff >/dev/null 2>/dev/null\n \n     # if latest commit is tagged and not dirty, then override using the tag name\n-    RAWDESC=$(git describe --abbrev=0 2>/dev/null)\n-    if [ \"$(git rev-parse HEAD)\" = \"$(git rev-list -1 $RAWDESC 2>/dev/null)\" ]; then\n-        git diff-index --quiet HEAD -- && GIT_TAG=$RAWDESC\n-    fi\n+    git diff-index --quiet HEAD -- && GIT_TAG=$(git describe --exact-match 2>/dev/null)\n \n     # otherwise generate suffix from git, i.e. string like \"59887e8-dirty\"\n     GIT_COMMIT=$(git rev-parse --short=12 HEAD)"
      }
    ]
  },
  {
    "sha": "cb4b1906bfbd636df8e7dd7fedee5d0951d2e3b1",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpjYjRiMTkwNmJmYmQ2MzZkZjhlN2RkN2ZlZGVlNWQwOTUxZDJlM2Ix",
    "commit": {
      "author": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2021-08-11T01:29:08Z"
      },
      "committer": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2021-08-11T02:05:44Z"
      },
      "message": "guix: set GIT_TAG and GIT_COMMIT before building\n\nThe environemnet variables GIT_TAG and GIT_COMMIT allow\nshare/genbuild.sh know what the git tag and commit are so the version\nstring can be correctly set. This is needed because the build will occur\noutside of the git tree, so genbuild.sh will be unable to determine this\ninformation itself.",
      "tree": {
        "sha": "fbda65d0c97022988c40f931b90f27e06ae92050",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fbda65d0c97022988c40f931b90f27e06ae92050"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cb4b1906bfbd636df8e7dd7fedee5d0951d2e3b1",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/cb4b1906bfbd636df8e7dd7fedee5d0951d2e3b1",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/cb4b1906bfbd636df8e7dd7fedee5d0951d2e3b1",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/cb4b1906bfbd636df8e7dd7fedee5d0951d2e3b1/comments",
    "author": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "6b6b8e7edeba3360738fb40ebc12872a81089967",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6b6b8e7edeba3360738fb40ebc12872a81089967",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/6b6b8e7edeba3360738fb40ebc12872a81089967"
      }
    ],
    "stats": {
      "total": 10,
      "additions": 10,
      "deletions": 0
    },
    "files": [
      {
        "sha": "615736dec27504689e9b082841052f95652d2dc0",
        "filename": "contrib/guix/libexec/build.sh",
        "status": "modified",
        "additions": 10,
        "deletions": 0,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/cb4b1906bfbd636df8e7dd7fedee5d0951d2e3b1/contrib/guix/libexec/build.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/cb4b1906bfbd636df8e7dd7fedee5d0951d2e3b1/contrib/guix/libexec/build.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/guix/libexec/build.sh?ref=cb4b1906bfbd636df8e7dd7fedee5d0951d2e3b1",
        "patch": "@@ -236,6 +236,16 @@ mkdir -p \"$OUTDIR\"\n # Binary Tarball Building #\n ###########################\n \n+# The build will use the extracted git archive in a build directory not under the git work tree.\n+# This will result in genbuild.sh being unable to determine the actual git tag for the version\n+# string reported by the binary. By exporting GIT_TAG and GIT_COMMIT now, genbuild.sh will know\n+# what tag and commit to use.\n+# We want \"git describe\" to not cause an exit on failure and just be set to \"\"\n+# shellcheck disable=SC2155\n+export GIT_TAG=$(git describe --exact-match 2> /dev/null)\n+git_commit=$(git rev-parse --short=12 HEAD)\n+export GIT_COMMIT=${git_commit}\n+\n # CONFIGFLAGS\n CONFIGFLAGS=\"--enable-reduce-exports --disable-bench --disable-gui-tests --disable-fuzz-binary\"\n case \"$HOST\" in"
      }
    ]
  }
]