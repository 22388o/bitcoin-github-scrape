[
  {
    "sha": "4fad8e6d831729efa1965fa2034e7e51d3d0a1be",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0ZmFkOGU2ZDgzMTcyOWVmYTE5NjVmYTIwMzRlN2U1MWQzZDBhMWJl",
    "commit": {
      "author": {
        "name": "Peter Todd",
        "email": "pete@petertodd.org",
        "date": "2014-05-08T04:18:57Z"
      },
      "committer": {
        "name": "Peter Todd",
        "email": "pete@petertodd.org",
        "date": "2014-07-13T14:12:49Z"
      },
      "message": "Reject transactions with excessive numbers of sigops",
      "tree": {
        "sha": "a1f919267c7bd9e3806ef63058cd1068f2f82021",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a1f919267c7bd9e3806ef63058cd1068f2f82021"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4fad8e6d831729efa1965fa2034e7e51d3d0a1be",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.4.14 (GNU/Linux)\n\niQGrBAABCACVBQJTwpPkXhSAAAAAABUAQGJsb2NraGFzaEBiaXRjb2luLm9yZzAw\nMDAwMDAwMDAwMDAwMDAyMzg2NjU0YjRkZjJlOTA2NDM3OWUzZjhlNGNiZmRhOGRk\nNzM4NmUyNDcwODk3NmUvFIAAAAAAFQARcGthLWFkZHJlc3NAZ251cGcub3JncGV0\nZUBwZXRlcnRvZC5vcmcACgkQJIFAPaXwkfuvIAgAkKoN1hx9pPlUQnql5cJkNEcs\nIRSj6ctplxy69ULKCkbLY00piehYk+v8eh+VeJKlBrQf02yN/VwRCOqdiR+dAhGJ\n3/g3J4TepRegW5rINYPaT9REoV+WPknN8VtCU5fGjaqnW1vQFLktrSg4JwWU7jSR\nAAZkHvcsKUDBxbsaxiHNHI/rOV7KNsWAQdW02FeYSiR/SoznbmlV28K7pD3WZjOV\nZ8RYoq9J3mj9juR8mWH6qFdE/qjIk7HDTwsgw8wKu3ZbQe9/106Oj3Fa5gNmgaYo\ngWeRucsO73AcWoEilMFyHVEoyYHGwt91vnGqosmLGhbdVzrO6r3GLOyFETDq3A==\n=mgCW\n-----END PGP SIGNATURE-----",
        "payload": "tree a1f919267c7bd9e3806ef63058cd1068f2f82021\nparent 29ef38951431fcce4a8692a652e99325d2a3795c\nauthor Peter Todd <pete@petertodd.org> 1399522737 -0400\ncommitter Peter Todd <pete@petertodd.org> 1405260769 -0400\n\nReject transactions with excessive numbers of sigops\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4fad8e6d831729efa1965fa2034e7e51d3d0a1be",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/4fad8e6d831729efa1965fa2034e7e51d3d0a1be",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4fad8e6d831729efa1965fa2034e7e51d3d0a1be/comments",
    "author": {
      "login": "petertodd",
      "id": 7042,
      "node_id": "MDQ6VXNlcjcwNDI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7042?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/petertodd",
      "html_url": "https://github.com/petertodd",
      "followers_url": "https://api.github.com/users/petertodd/followers",
      "following_url": "https://api.github.com/users/petertodd/following{/other_user}",
      "gists_url": "https://api.github.com/users/petertodd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/petertodd/subscriptions",
      "organizations_url": "https://api.github.com/users/petertodd/orgs",
      "repos_url": "https://api.github.com/users/petertodd/repos",
      "events_url": "https://api.github.com/users/petertodd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/petertodd/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "petertodd",
      "id": 7042,
      "node_id": "MDQ6VXNlcjcwNDI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7042?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/petertodd",
      "html_url": "https://github.com/petertodd",
      "followers_url": "https://api.github.com/users/petertodd/followers",
      "following_url": "https://api.github.com/users/petertodd/following{/other_user}",
      "gists_url": "https://api.github.com/users/petertodd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/petertodd/subscriptions",
      "organizations_url": "https://api.github.com/users/petertodd/orgs",
      "repos_url": "https://api.github.com/users/petertodd/repos",
      "events_url": "https://api.github.com/users/petertodd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/petertodd/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "29ef38951431fcce4a8692a652e99325d2a3795c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/29ef38951431fcce4a8692a652e99325d2a3795c",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/29ef38951431fcce4a8692a652e99325d2a3795c"
      }
    ],
    "stats": {
      "total": 17,
      "additions": 14,
      "deletions": 3
    },
    "files": [
      {
        "sha": "490b7f56feb46684586ce9ea58208a5fe10ae89c",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 12,
        "deletions": 3,
        "changes": 15,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4fad8e6d831729efa1965fa2034e7e51d3d0a1be/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4fad8e6d831729efa1965fa2034e7e51d3d0a1be/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=4fad8e6d831729efa1965fa2034e7e51d3d0a1be",
        "patch": "@@ -1016,9 +1016,18 @@ bool AcceptToMemoryPool(CTxMemPool& pool, CValidationState &state, const CTransa\n         if (Params().RequireStandard() && !AreInputsStandard(tx, view))\n             return error(\"AcceptToMemoryPool: : nonstandard transaction input\");\n \n-        // Note: if you modify this code to accept non-standard transactions, then\n-        // you should add code here to check that the transaction does a\n-        // reasonable number of ECDSA signature verifications.\n+        // Check that the transaction doesn't have an excessive number of\n+        // sigops, making it impossible to mine. Since the coinbase transaction\n+        // itself can contain sigops MAX_TX_SIGOPS is less than\n+        // MAX_BLOCK_SIGOPS; we still consider this an invalid rather than\n+        // merely non-standard transaction.\n+        unsigned int nSigOps = GetLegacySigOpCount(tx);\n+        nSigOps += GetP2SHSigOpCount(tx, view);\n+        if (nSigOps > MAX_TX_SIGOPS)\n+            return state.DoS(0,\n+                             error(\"AcceptToMemoryPool : too many sigops %s, %d > %d\",\n+                                   hash.ToString(), nSigOps, MAX_TX_SIGOPS),\n+                             REJECT_NONSTANDARD, \"bad-txns-too-many-sigops\");\n \n         int64_t nValueOut = tx.GetValueOut();\n         int64_t nFees = nValueIn-nValueOut;"
      },
      {
        "sha": "547e7305eadbb42510be99eec057fc6ed34c5d98",
        "filename": "src/main.h",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4fad8e6d831729efa1965fa2034e7e51d3d0a1be/src/main.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4fad8e6d831729efa1965fa2034e7e51d3d0a1be/src/main.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.h?ref=4fad8e6d831729efa1965fa2034e7e51d3d0a1be",
        "patch": "@@ -45,6 +45,8 @@ static const unsigned int MAX_STANDARD_TX_SIZE = 100000;\n static const unsigned int MAX_BLOCK_SIGOPS = MAX_BLOCK_SIZE/50;\n /** Maxiumum number of signature check operations in an IsStandard() P2SH script */\n static const unsigned int MAX_P2SH_SIGOPS = 15;\n+/** The maximum number of sigops we're willing to relay/mine in a single tx */\n+static const unsigned int MAX_TX_SIGOPS = MAX_BLOCK_SIGOPS/5;\n /** The maximum number of orphan transactions kept in memory */\n static const unsigned int MAX_ORPHAN_TRANSACTIONS = MAX_BLOCK_SIZE/100;\n /** Default for -maxorphanblocks, maximum number of orphan blocks kept in memory */"
      }
    ]
  }
]