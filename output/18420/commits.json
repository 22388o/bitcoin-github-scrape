[
  {
    "sha": "83e1d92413e262e6a876336ec433a6fbc335223a",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4M2UxZDkyNDEzZTI2MmU2YTg3NjMzNmVjNDMzYTZmYmMzMzUyMjNh",
    "commit": {
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2019-11-20T15:20:33Z"
      },
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2020-03-24T15:44:26Z"
      },
      "message": "test: listsinceblock block height checks",
      "tree": {
        "sha": "7cea99db67c2803e9ff5b59ac48e3c00758c9ebf",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7cea99db67c2803e9ff5b59ac48e3c00758c9ebf"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/83e1d92413e262e6a876336ec433a6fbc335223a",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEd6u7+MhX7zEv6RP5T1chs9Djkh0FAl56KuUACgkQT1chs9Dj\nkh0AUQ/+MOf449EY5cWGdovRS5910ku6EuqeSmwiSxE4FduY9WvztP8uEjIxaUw/\njQ94Il7pduXkiJH9u6QU+0RmzRItJKsNipJh4W1Z3w6zyUBkfWYofwjqviXjDcX1\nZXxeWfjpjeu3DCr0TJO39y8qvp+jb0heulFauk3f5i1hxQiNZs+7GqEGlMqPUd3L\nUyGRJyY6+QbMzPPb8ut6SdtSalWgh1rTpIjbuHHGWvZCTdoi30oy02+PAXCN2eLH\nDDW+AdDiOvlzfuqm0DQAXN6fHnytENYNlcO9IBXO2ae42wDJltybnbUZVeAZJAYC\nLm4ybbjiQ22P3cO2IJfx8pJmJep2BsdECQ3FM18uruwmPaDywtfiC6tiqOQZmP75\n0CZvxOC3r9FlkZwmtXyzsmircj0Qsm8poEfIxQaBp2qDHjXWZPpcouBGYKkAnGKd\ndFJ+oWV1QucxVNFDV4sDEKb+ZFMm9vAl+ZSer+E+1pkdaGq9ndwdy4nIaqmGC1DF\nGe4+hd/bV15kDDSVbTmgiSMo8zkWzNcOZFjgCSeW+Owbco55IhKJk2tBFStr3fbm\n5JQUrCkjqzcLBA0j5X3eqxX8F7aBvXl3vmO6+opDX68xJ1NxA1RkI6wK4mtR2GzK\niryM+Z9G6zoED/Y/0wYeaC3p7Fm8CbpRrka+g46FVlIJFh6+3Uo=\n=nHVb\n-----END PGP SIGNATURE-----\n-----BEGIN OPENTIMESTAMPS GIT TIMESTAMP-----\n\nAQHwIG36mU7n/4xqO5w/g444tsfIyXsD/bGTSRhRhK97kmwbCP/wEAlU6ysyubgd\n8f2wNwIIKpoI8CCRoQ9WcdrcBg36GQ1LMjaqrjsLJM5IJnZhS/Vq7GWXRAjxBF56\nKufwCAo9BQQY2YeeAIPf4w0u+QyOIyJodHRwczovL2J0Yy5jYWxlbmRhci5jYXRh\nbGxheHkuY29t//AQKo1Q1WEZAe6s2L35wAS6awjwINc0SQPwzwt3pji+a3MZGPip\ngvRUWGJ1S6TE6TRbT9D+CPAggFxIZNnmaeMB7be9XI1U1tKvvQfWBMvXCVyKljBL\nXqcI8QReeirm8Ai6nYqaws54QQCD3+MNLvkMjikoaHR0cHM6Ly9maW5uZXkuY2Fs\nZW5kYXIuZXRlcm5pdHl3YWxsLmNvbf/wEC9FOS++Uv0tEfom1zWEGTYI8CCQjPJJ\nv1Ex1mkvVDs78IvKGLoJmmqxDXnbm0EuxC9xZAjxBF56KubwCBtE+IndX8B9AIPf\n4w0u+QyOLCtodHRwczovL2JvYi5idGMuY2FsZW5kYXIub3BlbnRpbWVzdGFtcHMu\nb3Jn8BCDd9chhyfZA5EnqBgyoFOeCPAgWWlGEC9i0/yoxphD27/5yDrUjKaM7JZw\nMTMhD006ovEI8QReeirm8AiCpkBNQahcLwCD3+MNLvkMji4taHR0cHM6Ly9hbGlj\nZS5idGMuY2FsZW5kYXIub3BlbnRpbWVzdGFtcHMub3Jn\n-----END OPENTIMESTAMPS GIT TIMESTAMP-----",
        "payload": "tree 7cea99db67c2803e9ff5b59ac48e3c00758c9ebf\nparent ac579ada7e83a1b8100d611412f9ede885a4e522\nauthor Jon Atack <jon@atack.com> 1574263233 +0100\ncommitter Jon Atack <jon@atack.com> 1585064666 +0100\n\ntest: listsinceblock block height checks\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/83e1d92413e262e6a876336ec433a6fbc335223a",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/83e1d92413e262e6a876336ec433a6fbc335223a",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/83e1d92413e262e6a876336ec433a6fbc335223a/comments",
    "author": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "ac579ada7e83a1b8100d611412f9ede885a4e522",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ac579ada7e83a1b8100d611412f9ede885a4e522",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/ac579ada7e83a1b8100d611412f9ede885a4e522"
      }
    ],
    "stats": {
      "total": 20,
      "additions": 9,
      "deletions": 11
    },
    "files": [
      {
        "sha": "6d51ca6c9344978df1f40a2161ffe2ab933d7abd",
        "filename": "test/functional/wallet_listsinceblock.py",
        "status": "modified",
        "additions": 9,
        "deletions": 11,
        "changes": 20,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/83e1d92413e262e6a876336ec433a6fbc335223a/test/functional/wallet_listsinceblock.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/83e1d92413e262e6a876336ec433a6fbc335223a/test/functional/wallet_listsinceblock.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/wallet_listsinceblock.py?ref=83e1d92413e262e6a876336ec433a6fbc335223a",
        "patch": "@@ -111,23 +111,21 @@ def test_reorg(self):\n         senttx = self.nodes[2].sendtoaddress(self.nodes[0].getnewaddress(), 1)\n \n         # generate on both sides\n-        lastblockhash = self.nodes[1].generate(6)[5]\n-        self.nodes[2].generate(7)\n-        self.log.debug('lastblockhash={}'.format(lastblockhash))\n+        nodes1_last_blockhash = self.nodes[1].generate(6)[-1]\n+        nodes2_first_blockhash = self.nodes[2].generate(7)[0]\n+        self.log.debug(\"nodes[1] last blockhash = {}\".format(nodes1_last_blockhash))\n+        self.log.debug(\"nodes[2] first blockhash = {}\".format(nodes2_first_blockhash))\n \n         self.sync_all(self.nodes[:2])\n         self.sync_all(self.nodes[2:])\n \n         self.join_network()\n \n-        # listsinceblock(lastblockhash) should now include tx, as seen from nodes[0]\n-        lsbres = self.nodes[0].listsinceblock(lastblockhash)\n-        found = False\n-        for tx in lsbres['transactions']:\n-            if tx['txid'] == senttx:\n-                found = True\n-                break\n-        assert found\n+        # listsinceblock(nodes1_last_blockhash) should now include tx as seen from nodes[0]\n+        # and return the block height which listsinceblock now exposes since a5e7795.\n+        transactions = self.nodes[0].listsinceblock(nodes1_last_blockhash)['transactions']\n+        found = next(tx for tx in transactions if tx['txid'] == senttx)\n+        assert_equal(found['blockheight'], self.nodes[0].getblockheader(nodes2_first_blockhash)['height'])\n \n     def test_double_spend(self):\n         '''"
      }
    ]
  }
]