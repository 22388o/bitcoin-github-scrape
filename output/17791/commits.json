[
  {
    "sha": "52a45c393c7cf4309b754d42c240e9652f825bbe",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo1MmE0NWMzOTNjN2NmNDMwOWI3NTRkNDJjMjQwZTk2NTJmODI1YmJl",
    "commit": {
      "author": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2019-12-22T19:22:38Z"
      },
      "committer": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2019-12-22T23:23:12Z"
      },
      "message": "Remove UBSan suppressions for CTxMemPool*",
      "tree": {
        "sha": "e2313b4bc587df7a659988860bebd219db9fd2a5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e2313b4bc587df7a659988860bebd219db9fd2a5"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/52a45c393c7cf4309b754d42c240e9652f825bbe",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE0dvyxLlvLev0wWZUQQEIES5+qB8FAl3/+v4ACgkQQQEIES5+\nqB8oKQ//bXyUQKRVxpNYPdZx/O1MdWKQQlMu2hxrfhwX33vwGlHfYhF4vKvJbNxT\ncnixPeZfUPZviU6J35gGKzQFR8AHZDg2C4XyLChFZkk7UyYR56zXm5/iTwY75A4s\nDm5Kes1x0tAC0y98/TRuif2VstQ/kPxSMV7vYPwjy18varzx2R19DwryNDYQXS12\nEX0Kr8NzakDTHLeZ49TeDlSDd6sGfu6Ffv6SX+s6TSUzzb7kpVSzNFE4MIHMwURM\neQIuvJq2F9HLpFKTHb6cL832n4UUV3HUdqHg6nEuKVBhi1AHM4/+cstTIGH1dpNR\nxaatpT7sWQymYaxt5KNRs1nalXY/ZOZ2gfa4mktFSauhOSgaALH5Y5PxMUTgE5wU\n4xdzvrzEVfL05lHKrtWsagHeeK+gvwmF+Cn/X+5qBvmLMqGalAoI3FLcT09LCiCj\nk8AilTUobrehIlb5jzRdWmOW02+1TnLRD3sSFMjXVRA3yeeRiFBSnFbmgbjEH+U/\nw7f0LGh9sSHIbpTUimGv6/35AgSTZkUP/Cyi9nPWD/eM2+h8gSAxj27w0z0jC3Ls\nx+s1r0v9rz82p3sZjm8kWM/pECpHTLf7O9AzadskkuID59m5VuUUno2ZRdjCksNX\nTHlHPMdtr+itYBVnsXw2wXT6jlrQZizuJegA5q4h8QSBP4mMFGY=\n=6iE9\n-----END PGP SIGNATURE-----",
        "payload": "tree e2313b4bc587df7a659988860bebd219db9fd2a5\nparent 0cda5573405d75d695aba417e8f22f1301ded001\nauthor Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1577042558 +0200\ncommitter Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1577056992 +0200\n\nRemove UBSan suppressions for CTxMemPool*\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/52a45c393c7cf4309b754d42c240e9652f825bbe",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/52a45c393c7cf4309b754d42c240e9652f825bbe",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/52a45c393c7cf4309b754d42c240e9652f825bbe/comments",
    "author": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "0cda5573405d75d695aba417e8f22f1301ded001",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0cda5573405d75d695aba417e8f22f1301ded001",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/0cda5573405d75d695aba417e8f22f1301ded001"
      }
    ],
    "stats": {
      "total": 23,
      "additions": 11,
      "deletions": 12
    },
    "files": [
      {
        "sha": "ad83241773fc1b32c7dce3a19026c97f188c892e",
        "filename": "src/txmempool.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 6,
        "changes": 13,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/52a45c393c7cf4309b754d42c240e9652f825bbe/src/txmempool.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/52a45c393c7cf4309b754d42c240e9652f825bbe/src/txmempool.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/txmempool.cpp?ref=52a45c393c7cf4309b754d42c240e9652f825bbe",
        "patch": "@@ -217,10 +217,11 @@ void CTxMemPool::UpdateAncestorsOf(bool add, txiter it, setEntries &setAncestors\n         UpdateChild(piter, it, add);\n     }\n     const int64_t updateCount = (add ? 1 : -1);\n-    const int64_t updateSize = updateCount * it->GetTxSize();\n+    const int64_t updateSize = it->GetTxSize();\n+    assert(updateSize >= 0);\n     const CAmount updateFee = updateCount * it->GetModifiedFee();\n     for (txiter ancestorIt : setAncestors) {\n-        mapTx.modify(ancestorIt, update_descendant_state(updateSize, updateFee, updateCount));\n+        mapTx.modify(ancestorIt, update_descendant_state(updateCount * updateSize, updateFee, updateCount));\n     }\n }\n \n@@ -307,19 +308,19 @@ void CTxMemPool::UpdateForRemoveFromMempool(const setEntries &entriesToRemove, b\n void CTxMemPoolEntry::UpdateDescendantState(int64_t modifySize, CAmount modifyFee, int64_t modifyCount)\n {\n     nSizeWithDescendants += modifySize;\n-    assert(int64_t(nSizeWithDescendants) > 0);\n+    assert(nSizeWithDescendants > 0);\n     nModFeesWithDescendants += modifyFee;\n     nCountWithDescendants += modifyCount;\n-    assert(int64_t(nCountWithDescendants) > 0);\n+    assert(nCountWithDescendants > 0);\n }\n \n void CTxMemPoolEntry::UpdateAncestorState(int64_t modifySize, CAmount modifyFee, int64_t modifyCount, int64_t modifySigOps)\n {\n     nSizeWithAncestors += modifySize;\n-    assert(int64_t(nSizeWithAncestors) > 0);\n+    assert(nSizeWithAncestors > 0);\n     nModFeesWithAncestors += modifyFee;\n     nCountWithAncestors += modifyCount;\n-    assert(int64_t(nCountWithAncestors) > 0);\n+    assert(nCountWithAncestors > 0);\n     nSigOpCostWithAncestors += modifySigOps;\n     assert(int(nSigOpCostWithAncestors) >= 0);\n }"
      },
      {
        "sha": "9b44f147d296d7ffb9d0f39bdcea52303377603a",
        "filename": "src/txmempool.h",
        "status": "modified",
        "additions": 4,
        "deletions": 4,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/52a45c393c7cf4309b754d42c240e9652f825bbe/src/txmempool.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/52a45c393c7cf4309b754d42c240e9652f825bbe/src/txmempool.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/txmempool.h?ref=52a45c393c7cf4309b754d42c240e9652f825bbe",
        "patch": "@@ -79,13 +79,13 @@ class CTxMemPoolEntry\n     // Information about descendants of this transaction that are in the\n     // mempool; if we remove this transaction we must remove all of these\n     // descendants as well.\n-    uint64_t nCountWithDescendants;  //!< number of descendant transactions\n-    uint64_t nSizeWithDescendants;   //!< ... and size\n+    int64_t nCountWithDescendants;   //!< number of descendant transactions\n+    int64_t nSizeWithDescendants;    //!< ... and size\n     CAmount nModFeesWithDescendants; //!< ... and total fees (all including us)\n \n     // Analogous statistics for ancestor transactions\n-    uint64_t nCountWithAncestors;\n-    uint64_t nSizeWithAncestors;\n+    int64_t nCountWithAncestors;\n+    int64_t nSizeWithAncestors;\n     CAmount nModFeesWithAncestors;\n     int64_t nSigOpCostWithAncestors;\n "
      },
      {
        "sha": "8958a5a2d3461a3793f40071d36eeaf005915657",
        "filename": "test/sanitizer_suppressions/ubsan",
        "status": "modified",
        "additions": 0,
        "deletions": 2,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/52a45c393c7cf4309b754d42c240e9652f825bbe/test/sanitizer_suppressions/ubsan",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/52a45c393c7cf4309b754d42c240e9652f825bbe/test/sanitizer_suppressions/ubsan",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/sanitizer_suppressions/ubsan?ref=52a45c393c7cf4309b754d42c240e9652f825bbe",
        "patch": "@@ -39,7 +39,6 @@ unsigned-integer-overflow:policy/fees.cpp\n unsigned-integer-overflow:prevector.h\n unsigned-integer-overflow:script/interpreter.cpp\n unsigned-integer-overflow:stl_bvector.h\n-unsigned-integer-overflow:txmempool.cpp\n unsigned-integer-overflow:util/strencodings.cpp\n unsigned-integer-overflow:validation.cpp\n \n@@ -68,7 +67,6 @@ implicit-integer-sign-change:test/prevector_tests.cpp\n implicit-integer-sign-change:test/sighash_tests.cpp\n implicit-integer-sign-change:test/streams_tests.cpp\n implicit-integer-sign-change:test/transaction_tests.cpp\n-implicit-integer-sign-change:txmempool.cpp\n implicit-integer-sign-change:util/strencodings.*\n implicit-integer-sign-change:validation.cpp\n implicit-integer-sign-change:zmq/zmqpublishnotifier.cpp"
      }
    ]
  }
]