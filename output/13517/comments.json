[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/399106520",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13517#issuecomment-399106520",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13517",
    "id": 399106520,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5OTEwNjUyMA==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-21T13:38:26Z",
    "updated_at": "2018-06-21T13:38:26Z",
    "author_association": "MEMBER",
    "body": "Please review the refactoring in #13512 first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/399106520/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/399130180",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13517#issuecomment-399130180",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13517",
    "id": 399130180,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5OTEzMDE4MA==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-21T14:47:35Z",
    "updated_at": "2018-06-21T14:47:35Z",
    "author_association": "MEMBER",
    "body": "Big concept ACK!\r\n\r\n`feature_block.py` currently failing on Travis.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/399130180/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/399777162",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13517#issuecomment-399777162",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13517",
    "id": 399777162,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5OTc3NzE2Mg==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-24T18:30:28Z",
    "updated_at": "2018-06-24T18:30:28Z",
    "author_association": "MEMBER",
    "body": "aaaaddressed @jnewbery feedback in aaaa4a4b17506f526bebee65b0ea930289f79016",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/399777162/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/400045797",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13517#issuecomment-400045797",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13517",
    "id": 400045797,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDA0NTc5Nw==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-25T18:14:43Z",
    "updated_at": "2018-06-25T18:14:43Z",
    "author_association": "MEMBER",
    "body": "Force pushed to address feedback",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/400045797/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/400055754",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13517#issuecomment-400055754",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13517",
    "id": 400055754,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDA1NTc1NA==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-25T18:47:29Z",
    "updated_at": "2018-06-25T18:47:29Z",
    "author_association": "MEMBER",
    "body": "Tested ACK fa87da2f172ae2e6dc15e9ed156a3564a8ecfbdd",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/400055754/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/400272043",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13517#issuecomment-400272043",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13517",
    "id": 400272043,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMDI3MjA0Mw==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-26T11:19:58Z",
    "updated_at": "2018-06-28T09:34:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->Note to reviewers: This pull request conflicts with the following ones:\n\n* #13467 ([Tests] Make p2p_segwit easier to debug by jnewbery)\n* #13054 (tests: Enable automatic detection of undefined names in Python tests scripts. Remove wildcard imports. by practicalswift)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/400272043/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/401401304",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13517#issuecomment-401401304",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13517",
    "id": 401401304,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwMTQwMTMwNA==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-06-29T16:10:04Z",
    "updated_at": "2018-06-29T16:10:04Z",
    "author_association": "MEMBER",
    "body": "utACK fa87da2f172ae2e6dc15e9ed156a3564a8ecfbdd",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/401401304/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197457162",
    "pull_request_review_id": 131208708,
    "id": 197457162,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NzQ1NzE2Mg==",
    "diff_hunk": "@@ -71,23 +71,23 @@ P2P messages. These can be found in the following source files:\n \n #### Using the P2P interface\n \n+- Set `setup_mininode_event_loop = True` in `set_test_params()` to spawn a thread",
    "path": "test/functional/README.md",
    "position": null,
    "original_position": 4,
    "commit_id": "fa87da2f172ae2e6dc15e9ed156a3564a8ecfbdd",
    "original_commit_id": "563faf7d500bb67c4ad34865832bfe09c5df4076",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Would it be possible to start the network thread for all tests, so it's not necessary for the test writer to even perform this step?",
    "created_at": "2018-06-22T14:10:15Z",
    "updated_at": "2018-06-25T18:08:28Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197457162",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197457162"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197457162"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197457162/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 74,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197457211",
    "pull_request_review_id": 131208708,
    "id": 197457211,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NzQ1NzIxMQ==",
    "diff_hunk": "@@ -71,23 +71,23 @@ P2P messages. These can be found in the following source files:\n \n #### Using the P2P interface\n \n+- Set `setup_mininode_event_loop = True` in `set_test_params()` to spawn a thread\n+that runs a callback-based event loop to communicate on the P2P interface with a\n+node.\n+\n - `mininode.py` contains all the definitions for objects that pass\n over the network (`CBlock`, `CTransaction`, etc, along with the network-level\n wrappers for them, `msg_block`, `msg_tx`, etc).\n \n - P2P tests have two threads. One thread handles all network communication\n-with the bitcoind(s) being tested (using python's asyncore package); the other\n+with the bitcoind(s) being tested; the other",
    "path": "test/functional/README.md",
    "position": null,
    "original_position": 14,
    "commit_id": "fa87da2f172ae2e6dc15e9ed156a3564a8ecfbdd",
    "original_commit_id": "563faf7d500bb67c4ad34865832bfe09c5df4076",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: Join lines",
    "created_at": "2018-06-22T14:10:23Z",
    "updated_at": "2018-06-25T18:08:28Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197457211",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197457211"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197457211"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197457211/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 83,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197457490",
    "pull_request_review_id": 131208708,
    "id": 197457490,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NzQ1NzQ5MA==",
    "diff_hunk": "@@ -15,7 +15,7 @@\n \n from test_framework.test_framework import BitcoinTestFramework\n from test_framework.util import *\n-from test_framework.mininode import CTransaction, network_thread_start\n+from test_framework.mininode import CTransaction",
    "path": "test/functional/feature_nulldummy.py",
    "position": null,
    "original_position": 5,
    "commit_id": "fa87da2f172ae2e6dc15e9ed156a3564a8ecfbdd",
    "original_commit_id": "563faf7d500bb67c4ad34865832bfe09c5df4076",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Can be changed to `from test_framework.messages import CTransaction` :)",
    "created_at": "2018-06-22T14:11:17Z",
    "updated_at": "2018-06-25T18:08:28Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197457490",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197457490"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197457490"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197457490/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 18,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197457825",
    "pull_request_review_id": 131208708,
    "id": 197457825,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NzQ1NzgyNQ==",
    "diff_hunk": "@@ -13,11 +13,10 @@\n P2PInterface: A high-level interface object for communicating to a node over P2P\n P2PDataStore: A p2p interface class that keeps a store of transactions and blocks\n               and can respond correctly to getdata and getheaders messages\"\"\"\n-import asyncore\n+import asyncio",
    "path": "test/functional/test_framework/mininode.py",
    "position": 5,
    "original_position": 5,
    "commit_id": "fa87da2f172ae2e6dc15e9ed156a3564a8ecfbdd",
    "original_commit_id": "563faf7d500bb67c4ad34865832bfe09c5df4076",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": ":tada: ",
    "created_at": "2018-06-22T14:12:26Z",
    "updated_at": "2018-06-25T18:08:28Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197457825",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197457825"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197457825"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197457825/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 16,
    "original_line": 16,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197458057",
    "pull_request_review_id": 131208708,
    "id": 197458057,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NzQ1ODA1Nw==",
    "diff_hunk": "@@ -41,14 +41,14 @@\n )\n from test_framework.mininode import (\n     P2PInterface,",
    "path": "test/functional/rpc_blockchain.py",
    "position": 3,
    "original_position": 3,
    "commit_id": "fa87da2f172ae2e6dc15e9ed156a3564a8ecfbdd",
    "original_commit_id": "563faf7d500bb67c4ad34865832bfe09c5df4076",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: Can join to a single line",
    "created_at": "2018-06-22T14:13:07Z",
    "updated_at": "2018-06-25T18:08:28Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197458057",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197458057"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197458057"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197458057/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 43,
    "original_line": 43,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197459152",
    "pull_request_review_id": 131211201,
    "id": 197459152,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NzQ1OTE1Mg==",
    "diff_hunk": "@@ -71,23 +71,23 @@ P2P messages. These can be found in the following source files:\n \n #### Using the P2P interface\n \n+- Set `setup_mininode_event_loop = True` in `set_test_params()` to spawn a thread",
    "path": "test/functional/README.md",
    "position": null,
    "original_position": 4,
    "commit_id": "fa87da2f172ae2e6dc15e9ed156a3564a8ecfbdd",
    "original_commit_id": "563faf7d500bb67c4ad34865832bfe09c5df4076",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Good point. I guess there is no overhead in running an event loop with no events.",
    "created_at": "2018-06-22T14:16:27Z",
    "updated_at": "2018-06-25T18:08:28Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197459152",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197459152"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197459152"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197459152/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 74,
    "side": "RIGHT",
    "in_reply_to_id": 197457162
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197459259",
    "pull_request_review_id": 131211355,
    "id": 197459259,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NzQ1OTI1OQ==",
    "diff_hunk": "@@ -15,7 +15,7 @@\n \n from test_framework.test_framework import BitcoinTestFramework\n from test_framework.util import *\n-from test_framework.mininode import CTransaction, network_thread_start\n+from test_framework.mininode import CTransaction",
    "path": "test/functional/feature_nulldummy.py",
    "position": null,
    "original_position": 5,
    "commit_id": "fa87da2f172ae2e6dc15e9ed156a3564a8ecfbdd",
    "original_commit_id": "563faf7d500bb67c4ad34865832bfe09c5df4076",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": ";)",
    "created_at": "2018-06-22T14:16:45Z",
    "updated_at": "2018-06-25T18:08:28Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197459259",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197459259"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197459259"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197459259/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 18,
    "side": "RIGHT",
    "in_reply_to_id": 197457490
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197459371",
    "pull_request_review_id": 131211504,
    "id": 197459371,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5NzQ1OTM3MQ==",
    "diff_hunk": "@@ -71,23 +71,23 @@ P2P messages. These can be found in the following source files:\n \n #### Using the P2P interface\n \n+- Set `setup_mininode_event_loop = True` in `set_test_params()` to spawn a thread\n+that runs a callback-based event loop to communicate on the P2P interface with a\n+node.\n+\n - `mininode.py` contains all the definitions for objects that pass\n over the network (`CBlock`, `CTransaction`, etc, along with the network-level\n wrappers for them, `msg_block`, `msg_tx`, etc).\n \n - P2P tests have two threads. One thread handles all network communication\n-with the bitcoind(s) being tested (using python's asyncore package); the other\n+with the bitcoind(s) being tested; the other",
    "path": "test/functional/README.md",
    "position": null,
    "original_position": 14,
    "commit_id": "fa87da2f172ae2e6dc15e9ed156a3564a8ecfbdd",
    "original_commit_id": "563faf7d500bb67c4ad34865832bfe09c5df4076",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "md renderer will take care of this ;)",
    "created_at": "2018-06-22T14:17:05Z",
    "updated_at": "2018-06-25T18:08:28Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197459371",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197459371"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197459371"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197459371/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 83,
    "side": "RIGHT",
    "in_reply_to_id": 197457211
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197854344",
    "pull_request_review_id": 131679630,
    "id": 197854344,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5Nzg1NDM0NA==",
    "diff_hunk": "@@ -160,9 +158,8 @@ def run_test(self):\n             self.block_time += 1\n             height += 1\n \n-        # We're adding new connections so terminate the network thread\n+        # We're adding new connections and terminate the old ones",
    "path": "test/functional/feature_assumevalid.py",
    "position": null,
    "original_position": 41,
    "commit_id": "fa87da2f172ae2e6dc15e9ed156a3564a8ecfbdd",
    "original_commit_id": "aaaa4a4b17506f526bebee65b0ea930289f79016",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: just remove this comment entirely. It adds no information to the code.",
    "created_at": "2018-06-25T16:11:43Z",
    "updated_at": "2018-06-25T18:08:28Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197854344",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197854344"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197854344"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197854344/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 161,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197854740",
    "pull_request_review_id": 131679630,
    "id": 197854740,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5Nzg1NDc0MA==",
    "diff_hunk": "@@ -71,68 +71,58 @@ class P2PConnection(asyncore.dispatcher):\n     sub-classed and the on_message() callback overridden.\"\"\"\n \n     def __init__(self):\n-        # All P2PConnections must be created before starting the NetworkThread.\n-        # assert that the network thread is not running.\n-        assert not network_thread_running()\n-\n-        super().__init__(map=mininode_socket_map)\n-\n-        self._conn_open = False\n+        # The underlying transport of the connection.\n+        # Should only call methods on this from the NetworkThread, c.f. call_soon_threadsafe\n+        self._transport = None\n \n     @property\n     def is_connected(self):\n-        return self._conn_open\n+        return bool(self._transport)",
    "path": "test/functional/test_framework/mininode.py",
    "position": null,
    "original_position": 41,
    "commit_id": "fa87da2f172ae2e6dc15e9ed156a3564a8ecfbdd",
    "original_commit_id": "aaaa4a4b17506f526bebee65b0ea930289f79016",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: I think `return self._transport is not None` is preferable ",
    "created_at": "2018-06-25T16:13:11Z",
    "updated_at": "2018-06-25T18:08:28Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197854740",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197854740"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197854740"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197854740/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 80,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197855002",
    "pull_request_review_id": 131679630,
    "id": 197855002,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5Nzg1NTAwMg==",
    "diff_hunk": "@@ -408,56 +368,35 @@ def sync_with_ping(self, timeout=60):\n         self.ping_counter += 1\n \n \n-# Keep our own socket map for asyncore, so that we can track disconnects\n-# ourselves (to work around an issue with closing an asyncore socket when\n-# using select)\n-mininode_socket_map = dict()\n-\n-# One lock for synchronizing all data access between the networking thread (see\n+# One lock for synchronizing all data access between the network event loop (see\n # NetworkThread below) and the thread running the test logic.  For simplicity,\n-# P2PConnection acquires this lock whenever delivering a message to a P2PInterface,\n-# and whenever adding anything to the send buffer (in send_message()).  This\n-# lock should be acquired in the thread running the test logic to synchronize\n+# P2PConnection acquires this lock whenever delivering a message to a P2PInterface.\n+# This lock should be acquired in the thread running the test logic to synchronize\n # access to any data shared with the P2PInterface or P2PConnection.\n mininode_lock = threading.RLock()\n \n+\n class NetworkThread(threading.Thread):\n+    _network_event_loop = None\n+\n     def __init__(self):\n         super().__init__(name=\"NetworkThread\")\n+        # There is only one event loop and no more than one thread must be created\n+        assert not self._network_event_loop\n+\n+        NetworkThread._network_event_loop = asyncio.new_event_loop()",
    "path": "test/functional/test_framework/mininode.py",
    "position": null,
    "original_position": 218,
    "commit_id": "fa87da2f172ae2e6dc15e9ed156a3564a8ecfbdd",
    "original_commit_id": "aaaa4a4b17506f526bebee65b0ea930289f79016",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This is accessed outside the class, so it shouldn't be marked as private. Prefer `network_event_loop`",
    "created_at": "2018-06-25T16:14:07Z",
    "updated_at": "2018-06-25T18:08:28Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197855002",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197855002"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197855002"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197855002/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 387,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197855424",
    "pull_request_review_id": 131679630,
    "id": 197855424,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5Nzg1NTQyNA==",
    "diff_hunk": "@@ -71,68 +71,58 @@ class P2PConnection(asyncore.dispatcher):\n     sub-classed and the on_message() callback overridden.\"\"\"\n \n     def __init__(self):\n-        # All P2PConnections must be created before starting the NetworkThread.\n-        # assert that the network thread is not running.\n-        assert not network_thread_running()\n-\n-        super().__init__(map=mininode_socket_map)\n-\n-        self._conn_open = False\n+        # The underlying transport of the connection.\n+        # Should only call methods on this from the NetworkThread, c.f. call_soon_threadsafe\n+        self._transport = None\n \n     @property\n     def is_connected(self):\n-        return self._conn_open\n+        return bool(self._transport)\n \n     def peer_connect(self, dstaddr, dstport, net=\"regtest\"):\n+        assert not self.is_connected\n         self.dstaddr = dstaddr\n         self.dstport = dstport\n-        self.create_socket(socket.AF_INET, socket.SOCK_STREAM)\n-        self.socket.setsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)\n-        self.sendbuf = b\"\"\n+        # The initial message to send after the connection was made:\n+        self.on_connection_send_msg = None\n         self.recvbuf = b\"\"\n-        self._asyncore_pre_connection = True\n         self.network = net\n-        self.disconnect = False\n-\n         logger.debug('Connecting to Bitcoin Node: %s:%d' % (self.dstaddr, self.dstport))\n \n-        try:\n-            self.connect((dstaddr, dstport))\n-        except:\n-            self.handle_close()\n+        loop = NetworkThread._network_event_loop\n+        conn_gen_unsafe = loop.create_connection(lambda: self, host=self.dstaddr, port=self.dstport)\n+        conn_gen = lambda: loop.call_soon_threadsafe(loop.create_task, conn_gen_unsafe)\n+        return conn_gen\n \n     def peer_disconnect(self):\n         # Connection could have already been closed by other end.\n-        if self.is_connected:\n-            self.disconnect = True  # Signal asyncore to disconnect\n+        NetworkThread._network_event_loop.call_soon_threadsafe(lambda: self._transport and self._transport.abort())\n \n     # Connection and disconnection methods\n \n-    def handle_connect(self):\n-        \"\"\"asyncore callback when a connection is opened.\"\"\"\n-        if not self.is_connected:\n-            logger.debug(\"Connected & Listening: %s:%d\" % (self.dstaddr, self.dstport))\n-            self._conn_open = True\n-            self._asyncore_pre_connection = False\n-            self.on_open()\n-\n-    def handle_close(self):\n-        \"\"\"asyncore callback when a connection is closed.\"\"\"\n+    def connection_made(self, _transport):",
    "path": "test/functional/test_framework/mininode.py",
    "position": null,
    "original_position": 86,
    "commit_id": "fa87da2f172ae2e6dc15e9ed156a3564a8ecfbdd",
    "original_commit_id": "aaaa4a4b17506f526bebee65b0ea930289f79016",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: prefer `transport` as the argument name",
    "created_at": "2018-06-25T16:15:32Z",
    "updated_at": "2018-06-25T18:08:28Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197855424",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197855424"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197855424"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197855424/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 103,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197855610",
    "pull_request_review_id": 131679630,
    "id": 197855610,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5Nzg1NTYxMA==",
    "diff_hunk": "@@ -71,68 +71,58 @@ class P2PConnection(asyncore.dispatcher):\n     sub-classed and the on_message() callback overridden.\"\"\"\n \n     def __init__(self):\n-        # All P2PConnections must be created before starting the NetworkThread.\n-        # assert that the network thread is not running.\n-        assert not network_thread_running()\n-\n-        super().__init__(map=mininode_socket_map)\n-\n-        self._conn_open = False\n+        # The underlying transport of the connection.\n+        # Should only call methods on this from the NetworkThread, c.f. call_soon_threadsafe\n+        self._transport = None\n \n     @property\n     def is_connected(self):\n-        return self._conn_open\n+        return bool(self._transport)\n \n     def peer_connect(self, dstaddr, dstport, net=\"regtest\"):\n+        assert not self.is_connected\n         self.dstaddr = dstaddr\n         self.dstport = dstport\n-        self.create_socket(socket.AF_INET, socket.SOCK_STREAM)\n-        self.socket.setsockopt(socket.IPPROTO_TCP, socket.TCP_NODELAY, 1)\n-        self.sendbuf = b\"\"\n+        # The initial message to send after the connection was made:\n+        self.on_connection_send_msg = None\n         self.recvbuf = b\"\"\n-        self._asyncore_pre_connection = True\n         self.network = net\n-        self.disconnect = False\n-\n         logger.debug('Connecting to Bitcoin Node: %s:%d' % (self.dstaddr, self.dstport))\n \n-        try:\n-            self.connect((dstaddr, dstport))\n-        except:\n-            self.handle_close()\n+        loop = NetworkThread._network_event_loop\n+        conn_gen_unsafe = loop.create_connection(lambda: self, host=self.dstaddr, port=self.dstport)\n+        conn_gen = lambda: loop.call_soon_threadsafe(loop.create_task, conn_gen_unsafe)\n+        return conn_gen\n \n     def peer_disconnect(self):\n         # Connection could have already been closed by other end.\n-        if self.is_connected:\n-            self.disconnect = True  # Signal asyncore to disconnect\n+        NetworkThread._network_event_loop.call_soon_threadsafe(lambda: self._transport and self._transport.abort())\n \n     # Connection and disconnection methods\n \n-    def handle_connect(self):\n-        \"\"\"asyncore callback when a connection is opened.\"\"\"\n-        if not self.is_connected:\n-            logger.debug(\"Connected & Listening: %s:%d\" % (self.dstaddr, self.dstport))\n-            self._conn_open = True\n-            self._asyncore_pre_connection = False\n-            self.on_open()\n-\n-    def handle_close(self):\n-        \"\"\"asyncore callback when a connection is closed.\"\"\"\n+    def connection_made(self, _transport):\n+        \"\"\"asyncio callback when a connection is opened.\"\"\"\n+        assert not self._transport\n+        logger.debug(\"Connected & Listening: %s:%d\" % (self.dstaddr, self.dstport))\n+        self._transport = _transport\n+        if self.on_connection_send_msg:\n+            self.send_message(self.on_connection_send_msg)\n+            self.on_connection_send_msg = None  # Never used again\n+        self.on_open()\n+\n+    def connection_lost(self, exc):\n+        \"\"\"asyncio callback when a connection is closed.\"\"\"\n+        if exc:\n+            logger.warning(\"Connection lost to {}:{} due to {}\".format(self.dstaddr, self.dstport, exc))\n         logger.debug(\"Closing connection to: %s:%d\" % (self.dstaddr, self.dstport))",
    "path": "test/functional/test_framework/mininode.py",
    "position": null,
    "original_position": 100,
    "commit_id": "fa87da2f172ae2e6dc15e9ed156a3564a8ecfbdd",
    "original_commit_id": "aaaa4a4b17506f526bebee65b0ea930289f79016",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: this should be in an else branch to avoid log repetition",
    "created_at": "2018-06-25T16:16:07Z",
    "updated_at": "2018-06-25T18:08:28Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197855610",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197855610"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197855610"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197855610/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 117,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197856757",
    "pull_request_review_id": 131679630,
    "id": 197856757,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE5Nzg1Njc1Nw==",
    "diff_hunk": "@@ -32,6 +32,8 @@\n     sync_blocks,\n     sync_mempools,\n )\n+from .mininode import NetworkThread",
    "path": "test/functional/test_framework/test_framework.py",
    "position": null,
    "original_position": 4,
    "commit_id": "fa87da2f172ae2e6dc15e9ed156a3564a8ecfbdd",
    "original_commit_id": "aaaa4a4b17506f526bebee65b0ea930289f79016",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: sort imports",
    "created_at": "2018-06-25T16:20:06Z",
    "updated_at": "2018-06-25T18:08:28Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197856757",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197856757"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13517#discussion_r197856757"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13517"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/197856757/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 35,
    "side": "RIGHT"
  }
]