[
  {
    "sha": "6581b893af9e8aed9aeabae87041aaf0faccd49b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2NTgxYjg5M2FmOWU4YWVkOWFlYWJhZTg3MDQxYWFmMGZhY2NkNDli",
    "commit": {
      "author": {
        "name": "Philip Kaufmann",
        "email": "phil.kaufmann@t-online.de",
        "date": "2013-09-14T08:58:49Z"
      },
      "committer": {
        "name": "Philip Kaufmann",
        "email": "phil.kaufmann@t-online.de",
        "date": "2013-10-15T13:35:30Z"
      },
      "message": "Bitcoin-Qt: show address labels when using bitcoin: URIs\n\n- ensure that user-defined address labels are shown in the sendcoins\n  dialog, when using bitcoin: URIs or insecure payments (no changes to the\n  secure payments UI)\n- favors supplied labels over user-defined ones from addressbook",
      "tree": {
        "sha": "72e612eb0750f224c7402aa71c74b172206539a3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/72e612eb0750f224c7402aa71c74b172206539a3"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6581b893af9e8aed9aeabae87041aaf0faccd49b",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6581b893af9e8aed9aeabae87041aaf0faccd49b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/6581b893af9e8aed9aeabae87041aaf0faccd49b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6581b893af9e8aed9aeabae87041aaf0faccd49b/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "38d15d8b427904a936a4fb4b8ac390bd637e1638",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/38d15d8b427904a936a4fb4b8ac390bd637e1638",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/38d15d8b427904a936a4fb4b8ac390bd637e1638"
      }
    ],
    "stats": {
      "total": 31,
      "additions": 24,
      "deletions": 7
    },
    "files": [
      {
        "sha": "6fcd3a558bea8878f9b19e002a7eecd00f210eb7",
        "filename": "src/qt/sendcoinsentry.cpp",
        "status": "modified",
        "additions": 22,
        "deletions": 7,
        "changes": 29,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6581b893af9e8aed9aeabae87041aaf0faccd49b/src/qt/sendcoinsentry.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6581b893af9e8aed9aeabae87041aaf0faccd49b/src/qt/sendcoinsentry.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/sendcoinsentry.cpp?ref=6581b893af9e8aed9aeabae87041aaf0faccd49b",
        "patch": "@@ -60,12 +60,7 @@ void SendCoinsEntry::on_addressBookButton_clicked()\n \n void SendCoinsEntry::on_payTo_textChanged(const QString &address)\n {\n-    if(!model)\n-        return;\n-    // Fill in label from address book, if address has an associated label\n-    QString associatedLabel = model->getAddressTableModel()->labelForAddress(address);\n-    if(!associatedLabel.isEmpty())\n-        ui->addAsLabel->setText(associatedLabel);\n+    updateLabel(address);\n }\n \n void SendCoinsEntry::setModel(WalletModel *model)\n@@ -164,7 +159,11 @@ void SendCoinsEntry::setValue(const SendCoinsRecipient &value)\n     if (recipient.authenticatedMerchant.isEmpty())\n     {\n         ui->payTo->setText(recipient.address);\n-        ui->addAsLabel->setText(recipient.label);\n+        // if no label is set, query users address book for current user-defined label\n+        if (recipient.label.isEmpty())\n+            updateLabel(recipient.address);\n+        else\n+            ui->addAsLabel->setText(recipient.label);\n         ui->payAmount->setValue(recipient.amount);\n     }\n     else\n@@ -203,3 +202,19 @@ void SendCoinsEntry::updateDisplayUnit()\n         ui->payAmount_s->setDisplayUnit(model->getOptionsModel()->getDisplayUnit());\n     }\n }\n+\n+bool SendCoinsEntry::updateLabel(const QString &address)\n+{\n+    if(!model)\n+        return false;\n+\n+    // Fill in label from address book, if address has an associated label\n+    QString associatedLabel = model->getAddressTableModel()->labelForAddress(address);\n+    if(!associatedLabel.isEmpty())\n+    {\n+        ui->addAsLabel->setText(associatedLabel);\n+        return true;\n+    }\n+\n+    return false;\n+}"
      },
      {
        "sha": "66d97529095125f1aa8a400819ba814e74c4d4e0",
        "filename": "src/qt/sendcoinsentry.h",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6581b893af9e8aed9aeabae87041aaf0faccd49b/src/qt/sendcoinsentry.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6581b893af9e8aed9aeabae87041aaf0faccd49b/src/qt/sendcoinsentry.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/sendcoinsentry.h?ref=6581b893af9e8aed9aeabae87041aaf0faccd49b",
        "patch": "@@ -58,6 +58,8 @@ private slots:\n     SendCoinsRecipient recipient;\n     Ui::SendCoinsEntry *ui;\n     WalletModel *model;\n+\n+    bool updateLabel(const QString &address);\n };\n \n #endif // SENDCOINSENTRY_H"
      }
    ]
  }
]