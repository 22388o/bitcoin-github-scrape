[
  {
    "sha": "f6122abe03699423faca29035f16f3afc527f4d3",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmNjEyMmFiZTAzNjk5NDIzZmFjYTI5MDM1ZjE2ZjNhZmM1MjdmNGQz",
    "commit": {
      "author": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2019-01-17T17:37:46Z"
      },
      "committer": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2019-02-12T22:07:45Z"
      },
      "message": "interfaces: Add remove to Wallet",
      "tree": {
        "sha": "a71d1af59576a741a86f52b94bde5a9550aea674",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a71d1af59576a741a86f52b94bde5a9550aea674"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f6122abe03699423faca29035f16f3afc527f4d3",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f6122abe03699423faca29035f16f3afc527f4d3",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/f6122abe03699423faca29035f16f3afc527f4d3",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f6122abe03699423faca29035f16f3afc527f4d3/comments",
    "author": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "029d28a7aa5619973eb59fe445b9a4186c0c2a58",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/029d28a7aa5619973eb59fe445b9a4186c0c2a58",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/029d28a7aa5619973eb59fe445b9a4186c0c2a58"
      }
    ],
    "stats": {
      "total": 7,
      "additions": 7,
      "deletions": 0
    },
    "files": [
      {
        "sha": "5b5430037cc52beaaf1beb2c563854f7b10e60f9",
        "filename": "src/interfaces/wallet.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 0,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f6122abe03699423faca29035f16f3afc527f4d3/src/interfaces/wallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f6122abe03699423faca29035f16f3afc527f4d3/src/interfaces/wallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/interfaces/wallet.cpp?ref=f6122abe03699423faca29035f16f3afc527f4d3",
        "patch": "@@ -468,6 +468,10 @@ class WalletImpl : public Wallet\n     bool IsWalletFlagSet(uint64_t flag) override { return m_wallet.IsWalletFlagSet(flag); }\n     OutputType getDefaultAddressType() override { return m_wallet.m_default_address_type; }\n     OutputType getDefaultChangeType() override { return m_wallet.m_default_change_type; }\n+    void remove() override\n+    {\n+        RemoveWallet(m_shared_wallet);\n+    }\n     std::unique_ptr<Handler> handleUnload(UnloadFn fn) override\n     {\n         return MakeHandler(m_wallet.NotifyUnload.connect(fn));"
      },
      {
        "sha": "a931e5fafb7023a28c30984e2b52a3665811a647",
        "filename": "src/interfaces/wallet.h",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f6122abe03699423faca29035f16f3afc527f4d3/src/interfaces/wallet.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f6122abe03699423faca29035f16f3afc527f4d3/src/interfaces/wallet.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/interfaces/wallet.h?ref=f6122abe03699423faca29035f16f3afc527f4d3",
        "patch": "@@ -247,6 +247,9 @@ class Wallet\n     // Get default change type.\n     virtual OutputType getDefaultChangeType() = 0;\n \n+    // Remove wallet.\n+    virtual void remove() = 0;\n+\n     //! Register handler for unload message.\n     using UnloadFn = std::function<void()>;\n     virtual std::unique_ptr<Handler> handleUnload(UnloadFn fn) = 0;"
      }
    ]
  },
  {
    "sha": "f77ba34313768fde9b813243dcd408f9755b0418",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmNzdiYTM0MzEzNzY4ZmRlOWI4MTMyNDNkY2Q0MDhmOTc1NWIwNDE4",
    "commit": {
      "author": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2019-01-18T00:21:36Z"
      },
      "committer": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2019-02-12T22:07:45Z"
      },
      "message": "gui: Add closeWallet to WalletController",
      "tree": {
        "sha": "f82671faace45374c31cdde667123dd2594b012b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f82671faace45374c31cdde667123dd2594b012b"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f77ba34313768fde9b813243dcd408f9755b0418",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f77ba34313768fde9b813243dcd408f9755b0418",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/f77ba34313768fde9b813243dcd408f9755b0418",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f77ba34313768fde9b813243dcd408f9755b0418/comments",
    "author": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "f6122abe03699423faca29035f16f3afc527f4d3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f6122abe03699423faca29035f16f3afc527f4d3",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/f6122abe03699423faca29035f16f3afc527f4d3"
      }
    ],
    "stats": {
      "total": 17,
      "additions": 17,
      "deletions": 0
    },
    "files": [
      {
        "sha": "c532ffbbfe51a8193d01cd45d85109e6b5f7a60f",
        "filename": "src/qt/walletcontroller.cpp",
        "status": "modified",
        "additions": 16,
        "deletions": 0,
        "changes": 16,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f77ba34313768fde9b813243dcd408f9755b0418/src/qt/walletcontroller.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f77ba34313768fde9b813243dcd408f9755b0418/src/qt/walletcontroller.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/walletcontroller.cpp?ref=f77ba34313768fde9b813243dcd408f9755b0418",
        "patch": "@@ -63,6 +63,22 @@ OpenWalletActivity* WalletController::openWallet(const std::string& name, QWidge\n     return activity;\n }\n \n+void WalletController::closeWallet(WalletModel* wallet_model, QWidget* parent)\n+{\n+    QMessageBox box(parent);\n+    box.setWindowTitle(tr(\"Close wallet\"));\n+    box.setText(tr(\"Are you sure you wish to close wallet <i>%1</i>?\").arg(wallet_model->getDisplayName()));\n+    box.setInformativeText(tr(\"Closing the wallet for too long can result in having to resync the entire chain if pruning is enabled.\"));\n+    box.setStandardButtons(QMessageBox::Yes|QMessageBox::Cancel);\n+    box.setDefaultButton(QMessageBox::Yes);\n+    if (box.exec() != QMessageBox::Yes) return;\n+\n+    // First remove wallet from node.\n+    wallet_model->wallet().remove();\n+    // Now release the model.\n+    removeAndDeleteWallet(wallet_model);\n+}\n+\n WalletModel* WalletController::getOrCreateWallet(std::unique_ptr<interfaces::Wallet> wallet)\n {\n     QMutexLocker locker(&m_mutex);"
      },
      {
        "sha": "19b3a82253154352dbc08ece7cd84a89ec75c965",
        "filename": "src/qt/walletcontroller.h",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f77ba34313768fde9b813243dcd408f9755b0418/src/qt/walletcontroller.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f77ba34313768fde9b813243dcd408f9755b0418/src/qt/walletcontroller.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/walletcontroller.h?ref=f77ba34313768fde9b813243dcd408f9755b0418",
        "patch": "@@ -44,6 +44,7 @@ class WalletController : public QObject\n     std::vector<std::string> getWalletsAvailableToOpen() const;\n \n     OpenWalletActivity* openWallet(const std::string& name, QWidget* parent = nullptr);\n+    void closeWallet(WalletModel* wallet_model, QWidget* parent = nullptr);\n \n private Q_SLOTS:\n     void addWallet(WalletModel* wallet_model);"
      }
    ]
  },
  {
    "sha": "94086fb59d1a05eb9a2960c2aae242e49c0a9103",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo5NDA4NmZiNTlkMWEwNWViOWEyOTYwYzJhYWUyNDJlNDljMGE5MTAz",
    "commit": {
      "author": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2019-01-18T00:22:32Z"
      },
      "committer": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2019-02-12T22:07:45Z"
      },
      "message": "gui: Add close wallet action",
      "tree": {
        "sha": "3f57c497829ac5cc393552c357df6dccd7013015",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3f57c497829ac5cc393552c357df6dccd7013015"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/94086fb59d1a05eb9a2960c2aae242e49c0a9103",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/94086fb59d1a05eb9a2960c2aae242e49c0a9103",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/94086fb59d1a05eb9a2960c2aae242e49c0a9103",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/94086fb59d1a05eb9a2960c2aae242e49c0a9103/comments",
    "author": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "f77ba34313768fde9b813243dcd408f9755b0418",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f77ba34313768fde9b813243dcd408f9755b0418",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/f77ba34313768fde9b813243dcd408f9755b0418"
      }
    ],
    "stats": {
      "total": 9,
      "additions": 9,
      "deletions": 0
    },
    "files": [
      {
        "sha": "bc88dd5e0a1743373fb26eb87b9a344c80d30442",
        "filename": "src/qt/bitcoingui.cpp",
        "status": "modified",
        "additions": 8,
        "deletions": 0,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/94086fb59d1a05eb9a2960c2aae242e49c0a9103/src/qt/bitcoingui.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/94086fb59d1a05eb9a2960c2aae242e49c0a9103/src/qt/bitcoingui.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoingui.cpp?ref=94086fb59d1a05eb9a2960c2aae242e49c0a9103",
        "patch": "@@ -338,6 +338,9 @@ void BitcoinGUI::createActions()\n     m_open_wallet_action->setMenu(new QMenu(this));\n     m_open_wallet_action->setStatusTip(tr(\"Open a wallet\"));\n \n+    m_close_wallet_action = new QAction(tr(\"Close Wallet...\"), this);\n+    m_close_wallet_action->setStatusTip(tr(\"Close wallet\"));\n+\n     showHelpMessageAction = new QAction(platformStyle->TextColorIcon(\":/icons/info\"), tr(\"&Command-line options\"), this);\n     showHelpMessageAction->setMenuRole(QAction::NoRole);\n     showHelpMessageAction->setStatusTip(tr(\"Show the %1 help message to get a list with possible Bitcoin command-line options\").arg(tr(PACKAGE_NAME)));\n@@ -396,6 +399,9 @@ void BitcoinGUI::createActions()\n                 });\n             }\n         });\n+        connect(m_close_wallet_action, &QAction::triggered, [this] {\n+            m_wallet_controller->closeWallet(walletFrame->currentWalletModel(), this);\n+        });\n     }\n #endif // ENABLE_WALLET\n \n@@ -418,6 +424,7 @@ void BitcoinGUI::createMenuBar()\n     if(walletFrame)\n     {\n         file->addAction(m_open_wallet_action);\n+        file->addAction(m_close_wallet_action);\n         file->addSeparator();\n         file->addAction(openAction);\n         file->addAction(backupWalletAction);\n@@ -693,6 +700,7 @@ void BitcoinGUI::setWalletActionsEnabled(bool enabled)\n     usedSendingAddressesAction->setEnabled(enabled);\n     usedReceivingAddressesAction->setEnabled(enabled);\n     openAction->setEnabled(enabled);\n+    m_close_wallet_action->setEnabled(enabled);\n }\n \n void BitcoinGUI::createTrayIcon()"
      },
      {
        "sha": "b58ccbb4552f0cf52412ebbcdc5189b7e4fd1538",
        "filename": "src/qt/bitcoingui.h",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/94086fb59d1a05eb9a2960c2aae242e49c0a9103/src/qt/bitcoingui.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/94086fb59d1a05eb9a2960c2aae242e49c0a9103/src/qt/bitcoingui.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoingui.h?ref=94086fb59d1a05eb9a2960c2aae242e49c0a9103",
        "patch": "@@ -148,6 +148,7 @@ class BitcoinGUI : public QMainWindow\n     QAction* openAction = nullptr;\n     QAction* showHelpMessageAction = nullptr;\n     QAction* m_open_wallet_action{nullptr};\n+    QAction* m_close_wallet_action{nullptr};\n     QAction* m_wallet_selector_label_action = nullptr;\n     QAction* m_wallet_selector_action = nullptr;\n "
      }
    ]
  }
]