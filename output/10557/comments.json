[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/307227595",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10557#issuecomment-307227595",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10557",
    "id": 307227595,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNzIyNzU5NQ==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-08T21:06:46Z",
    "updated_at": "2017-06-08T21:06:46Z",
    "author_association": "MEMBER",
    "body": "utACK 301566d1cb49e7ef78d91e0eb86783deee1885db",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/307227595/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/310545793",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10557#issuecomment-310545793",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10557",
    "id": 310545793,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxMDU0NTc5Mw==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-23T01:29:18Z",
    "updated_at": "2017-06-23T01:29:18Z",
    "author_association": "MEMBER",
    "body": "Needs rebase.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/310545793/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/311441500",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10557#issuecomment-311441500",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10557",
    "id": 311441500,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxMTQ0MTUwMA==",
    "user": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?u=b7dd63827227d69794b5fe28797b1bd107b930dd&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-27T18:16:14Z",
    "updated_at": "2017-06-27T18:16:14Z",
    "author_association": "MEMBER",
    "body": "Simple rebase due to #10503 ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/311441500/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/311517771",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10557#issuecomment-311517771",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10557",
    "id": 311517771,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxMTUxNzc3MQ==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-27T23:52:47Z",
    "updated_at": "2017-06-27T23:52:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "utACK 18bacec6c2c8493fd6b7011778446b3c7473bb25",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/311517771/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/313568939",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10557#issuecomment-313568939",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10557",
    "id": 313568939,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxMzU2ODkzOQ==",
    "user": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?u=b7dd63827227d69794b5fe28797b1bd107b930dd&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-07-07T02:15:37Z",
    "updated_at": "2017-07-07T02:15:37Z",
    "author_association": "MEMBER",
    "body": "Please tag for 0.15 ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/313568939/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315233569",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10557#issuecomment-315233569",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10557",
    "id": 315233569,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxNTIzMzU2OQ==",
    "user": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?u=63e5c438c242094837a9deeda775d77988b508bf&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-07-14T00:00:50Z",
    "updated_at": "2017-07-14T00:00:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "This will spam the orphan map somewhat after flushing, unfortunately-- but we can fix this by making flushing less hard in the future... and the orphan map is much less important than it used to be already.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315233569/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315435434",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10557#issuecomment-315435434",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10557",
    "id": 315435434,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMxNTQzNTQzNA==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-07-14T18:39:03Z",
    "updated_at": "2017-07-14T18:39:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "I still think we should take this for 15, but another thing to consider is to add a rolling bloom filter in net_processing ala https://github.com/TheBlueMatt/bitcoin/commit/316516cfd872a812f9672834c857bd084c5a877a (which is based on a big pile of changes, but could be pulled out separately), on top of this change.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/315435434/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120961377",
    "pull_request_review_id": 42971799,
    "id": 120961377,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMDk2MTM3Nw==",
    "diff_hunk": "@@ -489,24 +489,20 @@ static bool AcceptToMemoryPoolWorker(const CChainParams& chainparams, CTxMemPool\n         CCoinsViewMemPool viewMemPool(pcoinsTip, pool);\n         view.SetBackend(viewMemPool);\n \n-        // do we already have it?\n-        for (size_t out = 0; out < tx.vout.size(); out++) {\n-            COutPoint outpoint(hash, out);\n-            bool had_coin_in_cache = pcoinsTip->HaveCoinInCache(outpoint);\n-            if (view.HaveCoin(outpoint)) {\n-                if (!had_coin_in_cache) {\n-                    coins_to_uncache.push_back(outpoint);\n-                }\n-                return state.Invalid(false, REJECT_ALREADY_KNOWN, \"txn-already-known\");\n-            }\n-        }\n-\n         // do all inputs exist?\n         BOOST_FOREACH(const CTxIn txin, tx.vin) {\n             if (!pcoinsTip->HaveCoinInCache(txin.prevout)) {\n                 coins_to_uncache.push_back(txin.prevout);\n             }\n             if (!view.HaveCoin(txin.prevout)) {\n+                // Are inputs missing because we already have the tx?\n+                for (size_t out = 0; out < tx.vout.size(); out++) {\n+                    // Optimistically just do efficient check of cache for outputs\n+                    if (pcoinsTip->HaveCoinInCache(COutPoint(hash, out))) {",
    "path": "src/validation.cpp",
    "position": 25,
    "original_position": 25,
    "commit_id": "18bacec6c2c8493fd6b7011778446b3c7473bb25",
    "original_commit_id": "301566d1cb49e7ef78d91e0eb86783deee1885db",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I believe this risks resulting in `true` for transactions that are in fact not yet confirmed and not in the mempool, but were just disconnected in a reorg. Is that something we care about? If not, perhaps add a comment to explain.",
    "created_at": "2017-06-08T18:17:23Z",
    "updated_at": "2017-06-27T18:15:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10557#discussion_r120961377",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10557",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120961377"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/10557#discussion_r120961377"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10557"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120961377/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 503,
    "original_line": 503,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120965053",
    "pull_request_review_id": 42975847,
    "id": 120965053,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMDk2NTA1Mw==",
    "diff_hunk": "@@ -489,24 +489,20 @@ static bool AcceptToMemoryPoolWorker(const CChainParams& chainparams, CTxMemPool\n         CCoinsViewMemPool viewMemPool(pcoinsTip, pool);\n         view.SetBackend(viewMemPool);\n \n-        // do we already have it?\n-        for (size_t out = 0; out < tx.vout.size(); out++) {\n-            COutPoint outpoint(hash, out);\n-            bool had_coin_in_cache = pcoinsTip->HaveCoinInCache(outpoint);\n-            if (view.HaveCoin(outpoint)) {\n-                if (!had_coin_in_cache) {\n-                    coins_to_uncache.push_back(outpoint);\n-                }\n-                return state.Invalid(false, REJECT_ALREADY_KNOWN, \"txn-already-known\");\n-            }\n-        }\n-\n         // do all inputs exist?\n         BOOST_FOREACH(const CTxIn txin, tx.vin) {\n             if (!pcoinsTip->HaveCoinInCache(txin.prevout)) {\n                 coins_to_uncache.push_back(txin.prevout);\n             }\n             if (!view.HaveCoin(txin.prevout)) {\n+                // Are inputs missing because we already have the tx?\n+                for (size_t out = 0; out < tx.vout.size(); out++) {\n+                    // Optimistically just do efficient check of cache for outputs\n+                    if (pcoinsTip->HaveCoinInCache(COutPoint(hash, out))) {",
    "path": "src/validation.cpp",
    "position": 25,
    "original_position": 25,
    "commit_id": "18bacec6c2c8493fd6b7011778446b3c7473bb25",
    "original_commit_id": "301566d1cb49e7ef78d91e0eb86783deee1885db",
    "user": {
      "login": "sdaftuar",
      "id": 7463573,
      "node_id": "MDQ6VXNlcjc0NjM1NzM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sdaftuar",
      "html_url": "https://github.com/sdaftuar",
      "followers_url": "https://api.github.com/users/sdaftuar/followers",
      "following_url": "https://api.github.com/users/sdaftuar/following{/other_user}",
      "gists_url": "https://api.github.com/users/sdaftuar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
      "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
      "repos_url": "https://api.github.com/users/sdaftuar/repos",
      "events_url": "https://api.github.com/users/sdaftuar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Can we just change `HaveCoinInCache()` to have the same semantics as `HaveCoin()`, and only return true if the coin is unspent?  Seems confusing that their semantics aren't the same.\r\n\r\nFor many of the existing usages of `HaveCoinInCache()`, we store the result to potentially `Uncache()` later -- but I don't think it's possible to ever have a spent coin in your cache that is able to be uncached (ie not marked DIRTY)?\r\n\r\nThis issue affects the existing usage of `HaveCoinInCache()` in `AlreadyHave()`, I think.",
    "created_at": "2017-06-08T18:31:51Z",
    "updated_at": "2017-06-27T18:15:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10557#discussion_r120965053",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10557",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120965053"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/10557#discussion_r120965053"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10557"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120965053/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 503,
    "original_line": 503,
    "side": "RIGHT",
    "in_reply_to_id": 120961377
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120971512",
    "pull_request_review_id": 42982580,
    "id": 120971512,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMDk3MTUxMg==",
    "diff_hunk": "@@ -489,24 +489,20 @@ static bool AcceptToMemoryPoolWorker(const CChainParams& chainparams, CTxMemPool\n         CCoinsViewMemPool viewMemPool(pcoinsTip, pool);\n         view.SetBackend(viewMemPool);\n \n-        // do we already have it?\n-        for (size_t out = 0; out < tx.vout.size(); out++) {\n-            COutPoint outpoint(hash, out);\n-            bool had_coin_in_cache = pcoinsTip->HaveCoinInCache(outpoint);\n-            if (view.HaveCoin(outpoint)) {\n-                if (!had_coin_in_cache) {\n-                    coins_to_uncache.push_back(outpoint);\n-                }\n-                return state.Invalid(false, REJECT_ALREADY_KNOWN, \"txn-already-known\");\n-            }\n-        }\n-\n         // do all inputs exist?\n         BOOST_FOREACH(const CTxIn txin, tx.vin) {\n             if (!pcoinsTip->HaveCoinInCache(txin.prevout)) {\n                 coins_to_uncache.push_back(txin.prevout);\n             }\n             if (!view.HaveCoin(txin.prevout)) {\n+                // Are inputs missing because we already have the tx?\n+                for (size_t out = 0; out < tx.vout.size(); out++) {\n+                    // Optimistically just do efficient check of cache for outputs\n+                    if (pcoinsTip->HaveCoinInCache(COutPoint(hash, out))) {",
    "path": "src/validation.cpp",
    "position": 25,
    "original_position": 25,
    "commit_id": "18bacec6c2c8493fd6b7011778446b3c7473bb25",
    "original_commit_id": "301566d1cb49e7ef78d91e0eb86783deee1885db",
    "user": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@sipa I actually think that's likely a better outcome, but it may be too confusing.  If a tx was just disconnected in a reorg, and no longer has one of its inputs available, it means it or its parent was probably double spent and so it shouldn't be in the orphan map anyway. \r\n",
    "created_at": "2017-06-08T18:57:46Z",
    "updated_at": "2017-06-27T18:15:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10557#discussion_r120971512",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10557",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120971512"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/10557#discussion_r120971512"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10557"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120971512/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 503,
    "original_line": 503,
    "side": "RIGHT",
    "in_reply_to_id": 120961377
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120985013",
    "pull_request_review_id": 42998084,
    "id": 120985013,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMDk4NTAxMw==",
    "diff_hunk": "@@ -489,24 +489,20 @@ static bool AcceptToMemoryPoolWorker(const CChainParams& chainparams, CTxMemPool\n         CCoinsViewMemPool viewMemPool(pcoinsTip, pool);\n         view.SetBackend(viewMemPool);\n \n-        // do we already have it?\n-        for (size_t out = 0; out < tx.vout.size(); out++) {\n-            COutPoint outpoint(hash, out);\n-            bool had_coin_in_cache = pcoinsTip->HaveCoinInCache(outpoint);\n-            if (view.HaveCoin(outpoint)) {\n-                if (!had_coin_in_cache) {\n-                    coins_to_uncache.push_back(outpoint);\n-                }\n-                return state.Invalid(false, REJECT_ALREADY_KNOWN, \"txn-already-known\");\n-            }\n-        }\n-\n         // do all inputs exist?\n         BOOST_FOREACH(const CTxIn txin, tx.vin) {\n             if (!pcoinsTip->HaveCoinInCache(txin.prevout)) {\n                 coins_to_uncache.push_back(txin.prevout);\n             }\n             if (!view.HaveCoin(txin.prevout)) {\n+                // Are inputs missing because we already have the tx?\n+                for (size_t out = 0; out < tx.vout.size(); out++) {\n+                    // Optimistically just do efficient check of cache for outputs\n+                    if (pcoinsTip->HaveCoinInCache(COutPoint(hash, out))) {",
    "path": "src/validation.cpp",
    "position": 25,
    "original_position": 25,
    "commit_id": "18bacec6c2c8493fd6b7011778446b3c7473bb25",
    "original_commit_id": "301566d1cb49e7ef78d91e0eb86783deee1885db",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@morcos Do you think it's worth the complexity? I like @sdaftuar's suggestion.",
    "created_at": "2017-06-08T20:03:27Z",
    "updated_at": "2017-06-27T18:15:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10557#discussion_r120985013",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10557",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120985013"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/10557#discussion_r120985013"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10557"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120985013/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 503,
    "original_line": 503,
    "side": "RIGHT",
    "in_reply_to_id": 120961377
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120996492",
    "pull_request_review_id": 43010984,
    "id": 120996492,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMDk5NjQ5Mg==",
    "diff_hunk": "@@ -489,24 +489,20 @@ static bool AcceptToMemoryPoolWorker(const CChainParams& chainparams, CTxMemPool\n         CCoinsViewMemPool viewMemPool(pcoinsTip, pool);\n         view.SetBackend(viewMemPool);\n \n-        // do we already have it?\n-        for (size_t out = 0; out < tx.vout.size(); out++) {\n-            COutPoint outpoint(hash, out);\n-            bool had_coin_in_cache = pcoinsTip->HaveCoinInCache(outpoint);\n-            if (view.HaveCoin(outpoint)) {\n-                if (!had_coin_in_cache) {\n-                    coins_to_uncache.push_back(outpoint);\n-                }\n-                return state.Invalid(false, REJECT_ALREADY_KNOWN, \"txn-already-known\");\n-            }\n-        }\n-\n         // do all inputs exist?\n         BOOST_FOREACH(const CTxIn txin, tx.vin) {\n             if (!pcoinsTip->HaveCoinInCache(txin.prevout)) {\n                 coins_to_uncache.push_back(txin.prevout);\n             }\n             if (!view.HaveCoin(txin.prevout)) {\n+                // Are inputs missing because we already have the tx?\n+                for (size_t out = 0; out < tx.vout.size(); out++) {\n+                    // Optimistically just do efficient check of cache for outputs\n+                    if (pcoinsTip->HaveCoinInCache(COutPoint(hash, out))) {",
    "path": "src/validation.cpp",
    "position": 25,
    "original_position": 25,
    "commit_id": "18bacec6c2c8493fd6b7011778446b3c7473bb25",
    "original_commit_id": "301566d1cb49e7ef78d91e0eb86783deee1885db",
    "user": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes I like his suggestion as well.\r\nI think this PR is \"correct\" as is, and I will make that change in a separate PR as a fix to HaveCoinsInCache?",
    "created_at": "2017-06-08T20:54:54Z",
    "updated_at": "2017-06-27T18:15:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10557#discussion_r120996492",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10557",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120996492"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/10557#discussion_r120996492"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10557"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120996492/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 503,
    "original_line": 503,
    "side": "RIGHT",
    "in_reply_to_id": 120961377
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120997495",
    "pull_request_review_id": 43012083,
    "id": 120997495,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMDk5NzQ5NQ==",
    "diff_hunk": "@@ -489,24 +489,20 @@ static bool AcceptToMemoryPoolWorker(const CChainParams& chainparams, CTxMemPool\n         CCoinsViewMemPool viewMemPool(pcoinsTip, pool);\n         view.SetBackend(viewMemPool);\n \n-        // do we already have it?\n-        for (size_t out = 0; out < tx.vout.size(); out++) {\n-            COutPoint outpoint(hash, out);\n-            bool had_coin_in_cache = pcoinsTip->HaveCoinInCache(outpoint);\n-            if (view.HaveCoin(outpoint)) {\n-                if (!had_coin_in_cache) {\n-                    coins_to_uncache.push_back(outpoint);\n-                }\n-                return state.Invalid(false, REJECT_ALREADY_KNOWN, \"txn-already-known\");\n-            }\n-        }\n-\n         // do all inputs exist?\n         BOOST_FOREACH(const CTxIn txin, tx.vin) {\n             if (!pcoinsTip->HaveCoinInCache(txin.prevout)) {\n                 coins_to_uncache.push_back(txin.prevout);\n             }\n             if (!view.HaveCoin(txin.prevout)) {\n+                // Are inputs missing because we already have the tx?\n+                for (size_t out = 0; out < tx.vout.size(); out++) {\n+                    // Optimistically just do efficient check of cache for outputs\n+                    if (pcoinsTip->HaveCoinInCache(COutPoint(hash, out))) {",
    "path": "src/validation.cpp",
    "position": 25,
    "original_position": 25,
    "commit_id": "18bacec6c2c8493fd6b7011778446b3c7473bb25",
    "original_commit_id": "301566d1cb49e7ef78d91e0eb86783deee1885db",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Ok.",
    "created_at": "2017-06-08T20:59:11Z",
    "updated_at": "2017-06-27T18:15:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10557#discussion_r120997495",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10557",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120997495"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/10557#discussion_r120997495"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10557"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120997495/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 503,
    "original_line": 503,
    "side": "RIGHT",
    "in_reply_to_id": 120961377
  }
]