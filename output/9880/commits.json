[
  {
    "sha": "be908a69bf74a74a263bde14c310b397abe6776f",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiZTkwOGE2OWJmNzRhNzRhMjYzYmRlMTRjMzEwYjM5N2FiZTY3NzZm",
    "commit": {
      "author": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2017-03-01T15:35:27Z"
      },
      "committer": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2017-03-01T16:22:06Z"
      },
      "message": "Fail merge if there are any symlinks",
      "tree": {
        "sha": "1e42fb9c8436f6c7ee5c4ccd31d4785f798ee669",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1e42fb9c8436f6c7ee5c4ccd31d4785f798ee669"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/be908a69bf74a74a263bde14c310b397abe6776f",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/be908a69bf74a74a263bde14c310b397abe6776f",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/be908a69bf74a74a263bde14c310b397abe6776f",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/be908a69bf74a74a263bde14c310b397abe6776f/comments",
    "author": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "d19d45a1e6a4345a57d5983d466b16dadbec0da9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d19d45a1e6a4345a57d5983d466b16dadbec0da9",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/d19d45a1e6a4345a57d5983d466b16dadbec0da9"
      }
    ],
    "stats": {
      "total": 14,
      "additions": 14,
      "deletions": 0
    },
    "files": [
      {
        "sha": "eedb485a3b2bd6f97c3a93b0a17791b0294db34a",
        "filename": "contrib/devtools/github-merge.py",
        "status": "modified",
        "additions": 14,
        "deletions": 0,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/be908a69bf74a74a263bde14c310b397abe6776f/contrib/devtools/github-merge.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/be908a69bf74a74a263bde14c310b397abe6776f/contrib/devtools/github-merge.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/devtools/github-merge.py?ref=be908a69bf74a74a263bde14c310b397abe6776f",
        "patch": "@@ -70,6 +70,14 @@ def ask_prompt(text):\n     print(\"\",file=stderr)\n     return reply\n \n+def get_symlink_files():\n+    files = sorted(subprocess.check_output([GIT, 'ls-tree', '--full-tree', '-r', 'HEAD']).splitlines())\n+    ret = []\n+    for f in files:\n+        if (int(f.decode('utf-8').split(\" \")[0], 8) & 0o170000) == 0o120000:\n+            ret.append(f.decode('utf-8').split(\"\\t\")[1])\n+    return ret\n+\n def tree_sha512sum():\n     files = sorted(subprocess.check_output([GIT, 'ls-tree', '--full-tree', '-r', '--name-only', 'HEAD']).splitlines())\n     overall = hashlib.sha512()\n@@ -200,6 +208,12 @@ def main():\n             print(\"ERROR: Creating merge failed (already merged?).\",file=stderr)\n             exit(4)\n \n+        symlink_files = get_symlink_files()\n+        for f in symlink_files;\n+            print(\"ERROR: File %s was a symlink\" % f)\n+        if len(symlink_files) > 0:\n+            exit(4)\n+\n         # Put tree SHA512 into the message\n         try:\n             first_sha512 = tree_sha512sum()"
      }
    ]
  },
  {
    "sha": "d9c450ffb2a5a619ce11304f31427af9c9bf7a92",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkOWM0NTBmZmIyYTVhNjE5Y2UxMTMwNGYzMTQyN2FmOWM5YmY3YTky",
    "commit": {
      "author": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2017-02-27T19:13:39Z"
      },
      "committer": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2017-03-04T14:41:15Z"
      },
      "message": "Verify Tree-SHA512s in merge commits, enforce sigs are not SHA1",
      "tree": {
        "sha": "5cd7cef12b36729e9061bdcca0fc8d30e5fb84af",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5cd7cef12b36729e9061bdcca0fc8d30e5fb84af"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d9c450ffb2a5a619ce11304f31427af9c9bf7a92",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d9c450ffb2a5a619ce11304f31427af9c9bf7a92",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/d9c450ffb2a5a619ce11304f31427af9c9bf7a92",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d9c450ffb2a5a619ce11304f31427af9c9bf7a92/comments",
    "author": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "be908a69bf74a74a263bde14c310b397abe6776f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/be908a69bf74a74a263bde14c310b397abe6776f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/be908a69bf74a74a263bde14c310b397abe6776f"
      }
    ],
    "stats": {
      "total": 76,
      "additions": 73,
      "deletions": 3
    },
    "files": [
      {
        "sha": "4df8bee3b32e1abace08d1b7511ac0c450981b88",
        "filename": "contrib/verify-commits/gpg.sh",
        "status": "modified",
        "additions": 6,
        "deletions": 1,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d9c450ffb2a5a619ce11304f31427af9c9bf7a92/contrib/verify-commits/gpg.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d9c450ffb2a5a619ce11304f31427af9c9bf7a92/contrib/verify-commits/gpg.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/verify-commits/gpg.sh?ref=d9c450ffb2a5a619ce11304f31427af9c9bf7a92",
        "patch": "@@ -8,7 +8,12 @@ VALID=false\n REVSIG=false\n IFS='\n '\n-for LINE in $(echo \"$INPUT\" | gpg --trust-model always \"$@\" 2>/dev/null); do\n+if [ \"$BITCOIN_VERIFY_COMMITS_ALLOW_SHA1\" = 1 ]; then\n+\tGPG_RES=\"$(echo \"$INPUT\" | gpg --trust-model always \"$@\" 2>/dev/null)\"\n+else\n+\tGPG_RES=\"$(echo \"$INPUT\" | gpg --trust-model always --weak-digest sha1 \"$@\" 2>/dev/null)\"\n+fi\n+for LINE in $(echo \"$GPG_RES\"); do\n \tcase \"$LINE\" in\n \t\"[GNUPG:] VALIDSIG \"*)\n \t\twhile read KEY; do"
      },
      {
        "sha": "189dc215e3902390b450ae26f3b524137439776d",
        "filename": "contrib/verify-commits/trusted-sha512-root-commit",
        "status": "added",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d9c450ffb2a5a619ce11304f31427af9c9bf7a92/contrib/verify-commits/trusted-sha512-root-commit",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d9c450ffb2a5a619ce11304f31427af9c9bf7a92/contrib/verify-commits/trusted-sha512-root-commit",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/verify-commits/trusted-sha512-root-commit?ref=d9c450ffb2a5a619ce11304f31427af9c9bf7a92",
        "patch": "@@ -0,0 +1 @@\n+b00ba6251f71fa1edaabdf809514e1bc3c67862e"
      },
      {
        "sha": "55eccf588a50b73277a4496104ced4aa455cada7",
        "filename": "contrib/verify-commits/verify-commits.sh",
        "status": "modified",
        "additions": 66,
        "deletions": 2,
        "changes": 68,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d9c450ffb2a5a619ce11304f31427af9c9bf7a92/contrib/verify-commits/verify-commits.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d9c450ffb2a5a619ce11304f31427af9c9bf7a92/contrib/verify-commits/verify-commits.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/verify-commits/verify-commits.sh?ref=d9c450ffb2a5a619ce11304f31427af9c9bf7a92",
        "patch": "@@ -9,26 +9,84 @@\n DIR=$(dirname \"$0\")\n [ \"/${DIR#/}\" != \"$DIR\" ] && DIR=$(dirname \"$(pwd)/$0\")\n \n+echo \"Using verify-commits data from ${DIR}\"\n+\n VERIFIED_ROOT=$(cat \"${DIR}/trusted-git-root\")\n+VERIFIED_SHA512_ROOT=$(cat \"${DIR}/trusted-sha512-root-commit\")\n REVSIG_ALLOWED=$(cat \"${DIR}/allow-revsig-commits\")\n \n HAVE_FAILED=false\n IS_SIGNED () {\n \tif [ $1 = $VERIFIED_ROOT ]; then\n \t\treturn 0;\n \tfi\n+\n+\tVERIFY_TREE=$2\n+\tNO_SHA1=$3\n+\tif [ $1 = $VERIFIED_SHA512_ROOT ]; then\n+\t\tif [ \"$VERIFY_TREE\" = \"1\" ]; then\n+\t\t\techo \"All Tree-SHA512s matched up to $VERIFIED_SHA512_ROOT\" > /dev/stderr\n+\t\tfi\n+\t\tVERIFY_TREE=0\n+\t\tNO_SHA1=0\n+\tfi\n+\n+\tif [ \"$NO_SHA1\" = \"1\" ]; then\n+\t\texport BITCOIN_VERIFY_COMMITS_ALLOW_SHA1=0\n+\telse\n+\t\texport BITCOIN_VERIFY_COMMITS_ALLOW_SHA1=1\n+\tfi\n+\n \tif [ \"${REVSIG_ALLOWED#*$1}\" != \"$REVSIG_ALLOWED\" ]; then\n \t\texport BITCOIN_VERIFY_COMMITS_ALLOW_REVSIG=1\n \telse\n \t\texport BITCOIN_VERIFY_COMMITS_ALLOW_REVSIG=0\n \tfi\n+\n \tif ! git -c \"gpg.program=${DIR}/gpg.sh\" verify-commit $1 > /dev/null 2>&1; then\n \t\treturn 1;\n \tfi\n+\n+\tif [ \"$VERIFY_TREE\" = 1 ]; then\n+\t\tIFS_CACHE=\"$IFS\"\n+\t\tIFS='\n+'\n+\t\tfor LINE in $(git ls-tree --full-tree -r $1); do\n+\t\t\tcase \"$LINE\" in\n+\t\t\t\t\"12\"*)\n+\t\t\t\t\techo \"Repo contains symlinks\" > /dev/stderr\n+\t\t\t\t\tIFS=\"$IFS_CACHE\"\n+\t\t\t\t\treturn 1\n+\t\t\t\t\t;;\n+\t\t\tesac\n+\t\tdone\n+\t\tIFS=\"$IFS_CACHE\"\n+\n+\t\tFILE_HASHES=\"\"\n+\t\tfor FILE in $(git ls-tree --full-tree -r --name-only $1 | LANG=C sort); do\n+\t\t\tHASH=$(git cat-file blob $1:\"$FILE\" | sha512sum | { read FIRST OTHER; echo $FIRST; } )\n+\t\t\t[ \"$FILE_HASHES\" != \"\" ] && FILE_HASHES=\"$FILE_HASHES\"$'\\n'\n+\t\t\tFILE_HASHES=\"$FILE_HASHES$HASH  $FILE\"\n+\t\tdone\n+\t\tHASH_MATCHES=0\n+\t\tMSG=\"$(git show -s --format=format:%B $1 | tail -n1)\"\n+\n+\t\tcase \"$MSG  -\" in\n+\t\t\t\"Tree-SHA512: $(echo \"$FILE_HASHES\" | sha512sum)\")\n+\t\t\t\tHASH_MATCHES=1;;\n+\t\tesac\n+\n+\t\tif [ \"$HASH_MATCHES\" = \"0\" ]; then\n+\t\t\techo \"Tree-SHA512 did not match for commit $1\" > /dev/stderr\n+\t\t\tHAVE_FAILED=true\n+\t\t\treturn 1\n+\t\tfi\n+\tfi\n+\n \tlocal PARENTS\n \tPARENTS=$(git show -s --format=format:%P $1)\n \tfor PARENT in $PARENTS; do\n-\t\tif IS_SIGNED $PARENT; then\n+\t\tif IS_SIGNED $PARENT $VERIFY_TREE $NO_SHA1; then\n \t\t\treturn 0;\n \t\tfi\n \t\tbreak\n@@ -50,7 +108,13 @@ else\n \tTEST_COMMIT=\"$1\"\n fi\n \n-IS_SIGNED \"$TEST_COMMIT\"\n+DO_CHECKOUT_TEST=0\n+if [ x\"$2\" = \"x--tree-checks\" ]; then\n+\tDO_CHECKOUT_TEST=1\n+\n+fi\n+\n+IS_SIGNED \"$TEST_COMMIT\" \"$DO_CHECKOUT_TEST\" 1\n RES=$?\n if [ \"$RES\" = 1 ]; then\n \tif ! \"$HAVE_FAILED\"; then"
      }
    ]
  },
  {
    "sha": "eddc77a1b1a59df4c7ba1a0705d684529b2205a1",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplZGRjNzdhMWIxYTU5ZGY0YzdiYTFhMDcwNWQ2ODQ1MjliMjIwNWEx",
    "commit": {
      "author": {
        "name": "Peter Todd",
        "email": "pete@petertodd.org",
        "date": "2017-03-01T15:58:14Z"
      },
      "committer": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2017-03-04T14:41:16Z"
      },
      "message": "Add comment re: why SHA1 is disabled",
      "tree": {
        "sha": "5daf250a6afba939c4007f87319cd305f72ea0cf",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5daf250a6afba939c4007f87319cd305f72ea0cf"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/eddc77a1b1a59df4c7ba1a0705d684529b2205a1",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/eddc77a1b1a59df4c7ba1a0705d684529b2205a1",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/eddc77a1b1a59df4c7ba1a0705d684529b2205a1",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/eddc77a1b1a59df4c7ba1a0705d684529b2205a1/comments",
    "author": {
      "login": "petertodd",
      "id": 7042,
      "node_id": "MDQ6VXNlcjcwNDI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7042?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/petertodd",
      "html_url": "https://github.com/petertodd",
      "followers_url": "https://api.github.com/users/petertodd/followers",
      "following_url": "https://api.github.com/users/petertodd/following{/other_user}",
      "gists_url": "https://api.github.com/users/petertodd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/petertodd/subscriptions",
      "organizations_url": "https://api.github.com/users/petertodd/orgs",
      "repos_url": "https://api.github.com/users/petertodd/repos",
      "events_url": "https://api.github.com/users/petertodd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/petertodd/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "d9c450ffb2a5a619ce11304f31427af9c9bf7a92",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d9c450ffb2a5a619ce11304f31427af9c9bf7a92",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/d9c450ffb2a5a619ce11304f31427af9c9bf7a92"
      }
    ],
    "stats": {
      "total": 9,
      "additions": 9,
      "deletions": 0
    },
    "files": [
      {
        "sha": "61e755286399b4d54832de6f63f336c44f6cdef9",
        "filename": "contrib/verify-commits/gpg.sh",
        "status": "modified",
        "additions": 9,
        "deletions": 0,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/eddc77a1b1a59df4c7ba1a0705d684529b2205a1/contrib/verify-commits/gpg.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/eddc77a1b1a59df4c7ba1a0705d684529b2205a1/contrib/verify-commits/gpg.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/verify-commits/gpg.sh?ref=eddc77a1b1a59df4c7ba1a0705d684529b2205a1",
        "patch": "@@ -11,6 +11,15 @@ IFS='\n if [ \"$BITCOIN_VERIFY_COMMITS_ALLOW_SHA1\" = 1 ]; then\n \tGPG_RES=\"$(echo \"$INPUT\" | gpg --trust-model always \"$@\" 2>/dev/null)\"\n else\n+\t# Note how we've disabled SHA1 with the --weak-digest option, disabling\n+\t# signatures - including selfsigs - that use SHA1. While you might think that\n+\t# collision attacks shouldn't be an issue as they'd be an attack on yourself,\n+\t# in fact because what's being signed is a commit object that's\n+\t# semi-deterministically generated by untrusted input (the pull-req) in theory\n+\t# an attacker could construct a pull-req that results in a commit object that\n+\t# they've created a collision for. Not the most likely attack, but preventing\n+\t# it is pretty easy so we do so as a \"belt-and-suspenders\" measure.\n+\n \tGPG_RES=\"$(echo \"$INPUT\" | gpg --trust-model always --weak-digest sha1 \"$@\" 2>/dev/null)\"\n fi\n for LINE in $(echo \"$GPG_RES\"); do"
      }
    ]
  },
  {
    "sha": "d025bc79644f230d26e3cb02d11c0b360d129946",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkMDI1YmM3OTY0NGYyMzBkMjZlM2NiMDJkMTFjMGIzNjBkMTI5OTQ2",
    "commit": {
      "author": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2017-03-04T00:02:23Z"
      },
      "committer": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2017-03-04T14:41:16Z"
      },
      "message": "Allow any subkey in verify-commits",
      "tree": {
        "sha": "6498e7ce248806cce6676f18db4edd3d3d2d62b9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6498e7ce248806cce6676f18db4edd3d3d2d62b9"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d025bc79644f230d26e3cb02d11c0b360d129946",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d025bc79644f230d26e3cb02d11c0b360d129946",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/d025bc79644f230d26e3cb02d11c0b360d129946",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d025bc79644f230d26e3cb02d11c0b360d129946/comments",
    "author": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "eddc77a1b1a59df4c7ba1a0705d684529b2205a1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/eddc77a1b1a59df4c7ba1a0705d684529b2205a1",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/eddc77a1b1a59df4c7ba1a0705d684529b2205a1"
      }
    ],
    "stats": {
      "total": 6,
      "additions": 3,
      "deletions": 3
    },
    "files": [
      {
        "sha": "38ce817b94a1b1fee432f89aaa63539fe18511ce",
        "filename": "contrib/verify-commits/gpg.sh",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d025bc79644f230d26e3cb02d11c0b360d129946/contrib/verify-commits/gpg.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d025bc79644f230d26e3cb02d11c0b360d129946/contrib/verify-commits/gpg.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/verify-commits/gpg.sh?ref=d025bc79644f230d26e3cb02d11c0b360d129946",
        "patch": "@@ -26,7 +26,7 @@ for LINE in $(echo \"$GPG_RES\"); do\n \tcase \"$LINE\" in\n \t\"[GNUPG:] VALIDSIG \"*)\n \t\twhile read KEY; do\n-\t\t\tcase \"$LINE\" in \"[GNUPG:] VALIDSIG $KEY \"*) VALID=true;; esac\n+\t\t\t[ \"${LINE#?GNUPG:? VALIDSIG * * * * * * * * * }\" = \"$KEY\" ] && VALID=true\n \t\tdone < ./contrib/verify-commits/trusted-keys\n \t\t;;\n \t\"[GNUPG:] REVKEYSIG \"*)"
      },
      {
        "sha": "5610692616e1dd228252f4abc58f3d1a66cefaa0",
        "filename": "contrib/verify-commits/trusted-keys",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d025bc79644f230d26e3cb02d11c0b360d129946/contrib/verify-commits/trusted-keys",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d025bc79644f230d26e3cb02d11c0b360d129946/contrib/verify-commits/trusted-keys",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/verify-commits/trusted-keys?ref=d025bc79644f230d26e3cb02d11c0b360d129946",
        "patch": "@@ -1,4 +1,4 @@\n 71A3B16735405025D447E8F274810B012346C9A6\n-3F1888C6DCA92A6499C4911FDBA1A67379A1A931\n+133EAC179436F14A5CF1B794860FEB804E669320\n 32EE5C4C3FA15CCADB46ABE529D4BCB6416F53EC\n-FE09B823E6D83A3BC7983EAA2D7F2372E50FE137\n+B8B3F1C0E58C15DB6A81D30C3648A882F4316B9B"
      }
    ]
  },
  {
    "sha": "bbd757940bcb0628df6f7a5bd1fb348cf2290502",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiYmQ3NTc5NDBiY2IwNjI4ZGY2ZjdhNWJkMWZiMzQ4Y2YyMjkwNTAy",
    "commit": {
      "author": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2017-03-05T16:19:17Z"
      },
      "committer": {
        "name": "Matt Corallo",
        "email": "git@bluematt.me",
        "date": "2017-03-05T16:21:52Z"
      },
      "message": "Fix regsig checking for subkey sigs in verify-commits",
      "tree": {
        "sha": "3608a017c6193b6b7abc88650993cbb07595120e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3608a017c6193b6b7abc88650993cbb07595120e"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bbd757940bcb0628df6f7a5bd1fb348cf2290502",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bbd757940bcb0628df6f7a5bd1fb348cf2290502",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/bbd757940bcb0628df6f7a5bd1fb348cf2290502",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bbd757940bcb0628df6f7a5bd1fb348cf2290502/comments",
    "author": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "d025bc79644f230d26e3cb02d11c0b360d129946",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d025bc79644f230d26e3cb02d11c0b360d129946",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/d025bc79644f230d26e3cb02d11c0b360d129946"
      }
    ],
    "stats": {
      "total": 8,
      "additions": 2,
      "deletions": 6
    },
    "files": [
      {
        "sha": "4342d7bd0f6ec89114be93007fe2bb0e23758927",
        "filename": "contrib/verify-commits/gpg.sh",
        "status": "modified",
        "additions": 2,
        "deletions": 6,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bbd757940bcb0628df6f7a5bd1fb348cf2290502/contrib/verify-commits/gpg.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bbd757940bcb0628df6f7a5bd1fb348cf2290502/contrib/verify-commits/gpg.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/verify-commits/gpg.sh?ref=bbd757940bcb0628df6f7a5bd1fb348cf2290502",
        "patch": "@@ -31,12 +31,8 @@ for LINE in $(echo \"$GPG_RES\"); do\n \t\t;;\n \t\"[GNUPG:] REVKEYSIG \"*)\n \t\t[ \"$BITCOIN_VERIFY_COMMITS_ALLOW_REVSIG\" != 1 ] && exit 1\n-\t\twhile read KEY; do\n-\t\t\tcase \"$LINE\" in \"[GNUPG:] REVKEYSIG ${KEY#????????????????????????} \"*)\n-\t\t\t\tREVSIG=true\n-\t\t\t\tGOODREVSIG=\"[GNUPG:] GOODSIG ${KEY#????????????????????????} \"\n-\t\t\tesac\n-\t\tdone < ./contrib/verify-commits/trusted-keys\n+\t\tREVSIG=true\n+\t\tGOODREVSIG=\"[GNUPG:] GOODSIG ${LINE#* * *}\"\n \t\t;;\n \tesac\n done"
      }
    ]
  }
]