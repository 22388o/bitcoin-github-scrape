jonasschnelli,2017-10-09T19:55:20Z,"I haven't looked at the code, but how is this interacting with the multi-wallet-mode?\nDoes it allow a directory per wallet?",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-335268764,335268764,
meshcollider,2017-10-09T20:51:17Z,"@jonasschnelli no, all wallets would be inside the walletdir specified",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-335283556,335283556,
meshcollider,2017-10-10T06:12:08Z,"Addressed @promag nits, will work on the directory creation stuff as soon as I can",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-335371134,335371134,
meshcollider,2017-10-11T11:15:49Z,"I've split the `listwallets` RPC changes out into #11485. Squashed nit-fix commits, reworked the datadir caching stuff. Needs some careful testing and review now but I think its ready for proper review, let's see how travis goes. Will fix stuff in the morning. ",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-335777141,335777141,
jnewbery,2017-10-11T14:23:25Z,"It might eventually make sense to have each wallet in each own directory, ie the structure would be:\n\n```\n/<dataDir>\n  .\n  .-/wallets\n      .\n      .-/wallet1\n      .   .\n      .   .-wallet1.dat\n      .   .-db.log\n      .   ./database\n      .\n      .-/wallet2\n      .   ....\n      ....\n ```\n\nThat way, every wallet has its own bdb environment and we avoid nasty su",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-335827526,335827526,
promag,2017-10-11T14:34:28Z,Since we are relying on filesystem then :+1: to @jnewbery suggestion.,https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-335831332,335831332,
meshcollider,2017-10-13T22:47:31Z,Rebased,https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-336584862,336584862,
meshcollider,2017-10-27T02:25:10Z,Fixed @jnewbery's nits and squashed as suggested. Thanks :),https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-339854612,339854612,
MarcoFalke,2017-10-28T18:22:01Z,Concept ACK c36cb54711fe7677db6efc4db00a6e7d42e62f8d,https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-340210315,340210315,
ryanofsky,2017-10-31T18:20:06Z,"Adding a -walletdir option seems more cumbersome than just tweaking the existing -wallet option to allow directory separator characters (\\/).\n\nAdvantages of allowing -wallet directory paths instead of adding -walletdir option:\n- Simpler for users: they don't need to look at 3 different options (-wallet, -walletdir, -datadir) to figure out where wallet will be stored. They just need to look ",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-340855947,340855947,
sipa,2017-10-31T18:22:10Z,"Supporting multiple wallet directories also requires support for multiple BDB environments first, which would be extra code complication.",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-340856546,340856546,
ryanofsky,2017-10-31T18:54:42Z,"> Supporting multiple wallet directories also requires support for multiple BDB environments first, which would be extra code complication.\n\nOh right, that is the thing I forgot. Allowing -wallet paths would be a little more complicated to implement than I was suggesting, but not much more. And this by itself doesn't seem like a good enough reason to make user experience worse and add complexi",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-340871087,340871087,
meshcollider,2017-11-01T09:07:00Z,"> @ryanofsky 100% backwards compatible. New bitcoin releases continue to store wallet.dat in same places releases.\n\nNote that this PR doesn't rely on moving the default directory location, that was just suggested as a good idea in https://github.com/bitcoin/bitcoin/issues/11348 (that was the main point of that issue). So that point is orthogonal to `-walletdir` or a relative `-wallet`, and pro",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-341043294,341043294,
MarcoFalke,2017-11-01T15:12:20Z,"> ... or a relative -wallet, and probably should still be done\n\nI don't see how we could reasonably test behavior when `-datadir`, `-walletdir` and `-wallet` support directories as paths. Extending `-wallet` to accept file names, relative paths (to the datadir) or absolute paths should make the need to specify a `-walletdir` obsolete.",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-341135554,341135554,
meshcollider,2017-11-01T18:28:32Z,@MarcoFalke sorry I meant the moving of default walletdir to datadir/wallets/ not making it accept relative paths :),https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-341196791,341196791,
MarcoFalke,2017-11-01T18:32:59Z,"Yeah, right. Why would you change the default wallet dir when already could specify a path through `-wallet`?",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-341198108,341198108,
meshcollider,2017-11-01T21:24:18Z,"Just to keep the wallets and their BDB environments contained in their own subdirectory, a cleanup and bit more separation. Would make it clearer to users what they should back up, for example, in the case of multiwallet. That's what #11348 was discussing",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-341247521,341247521,
sipa,2017-11-02T00:25:21Z,"An alternative idea would be to not have a `-walletdir` option, but have it be implied from the `-wallet` arguments. In a first version, a requirement could exist that all wallet files are in the same directory (which would then become the db env directory).",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-341282591,341282591,
luke-jr,2017-11-10T14:42:58Z,"IMO it's a bad idea to infer the wallet dir from the wallet filename. This would encourage confusion among users with regard to the db.log file and database directory - they'll wonder why they exist, possibly delete them, and/or not notice and neglect to back them up (although backups ought to always be made using Core, some users still don't know that).",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-343491005,343491005,
luke-jr,2017-11-10T14:47:55Z,"Perhaps another option would be to allow specifying a directory (ending in a `/`) for `-wallet`, and treat the entire directory as dedicated to that wallet, including naming the file itself `wallet.dat` unconditionally...?",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-343492375,343492375,
laanwj,2017-11-17T09:47:38Z,"I think we should go forward with this, instead of turning this into a big argument. `walletdir` might not be the perfect solution for everything (e.g. it cannot handle multiple wallets in different places), but for people storing their wallets on a different filesystem this is enough, and much safer than the dangerous symlink tricks they're using currently.\n\nAnd after @sipa's idea, or #11687,",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-345195563,345195563,
meshcollider,2017-11-17T09:57:25Z,Rebased,https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-345198025,345198025,
meshcollider,2017-11-17T10:57:58Z,"@laanwj nit addressed, and travis is passing, so shall I squash the last two commits now?",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-345212827,345212827,
laanwj,2017-11-17T11:31:17Z,"Manually tested:\n- Current datadir (testnet) - ok, still uses existing wallet\n- Create new datadir (testnet) - ok, `wallets` is created and wallet.dat is there\n- Create new datadir (testnet), different `-wallet=test.dat` name - ok, `wallets` is created and `test.dat` is there\n- `-choosedatadir` with GUI, new datadir - ok, `wallets` is created and wallet.dat is there\n- `-choosedatadir` wi",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-345220006,345220006,
meshcollider,2017-11-17T11:52:35Z,Squashed fixup commits,https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-345224218,345224218,
laanwj,2017-11-17T11:52:57Z,Tested ACK c1e5d40,https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-345224284,345224284,
laanwj,2017-11-17T14:48:58Z,"There's a small thing I'm unsure about here, which just came to me, which only affects testnet and regtest: do we want to subdir the `-walletdir` with the chain name (like done with datadir?)? I think this would make sense, because currently it's impossible to specify `walletdir` in bitcoin.conf without running into conflicts.\n(this can be skipped if the `wallets` directory in the data directory",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-345263672,345263672,
promag,2017-11-17T15:08:57Z,"Tested ACK c1e5d40.\n\nNits and improvements to regtest and testnet can be left for followups?",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-345269204,345269204,
ryanofsky,2017-11-17T15:19:38Z,"You guys should look at #11687, too. It works standalone, but combined with this PR, it basically implements what john suggested here: https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-335827526\n\nIt also has a number of other improvements. I'm currently fixing a crazy problem with the tests (they were only failing on travis and I spent hours yesterday trying to reproduce them locally ",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-345272167,345272167,
laanwj,2017-11-17T15:35:48Z,"@ryanofsky will look at that one next\n\n> Nits and improvements to regtest and testnet can be left for followups?\n\nYes, fine with me, will leave it up to @MeshCollider .",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-345276749,345276749,
meshcollider,2017-11-17T17:26:55Z,"> Yes, fine with me, will leave it up to @MeshCollider .\n\nYep I'm happy to open a follow-up PR",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-345308862,345308862,
meshcollider,2017-11-18T00:45:30Z,"Nit cleanup and regtest/testnet change on new branch here: https://github.com/MeshCollider/bitcoin/tree/201711_walletdir\nThe second commit requires more testing so best if I leave them both for a new PR, approach can be discussed there too\n",https://github.com/bitcoin/bitcoin/pull/11466#issuecomment-345403368,345403368,
promag,2017-10-09T10:06:50Z,"In commit *Default wallet directory is wallets/ if it exists*, missing test?",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143427433,143427433,src/util.cpp
promag,2017-10-09T10:12:32Z,"This is breaking change. Also, this is not so relevant to this PR? I suggest to create a PR with this to separate discussions.",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143428584,143428584,src/wallet/rpcwallet.cpp
promag,2017-10-09T10:12:57Z,`++it`.,https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143428650,143428650,src/wallet/rpcwallet.cpp
promag,2017-10-09T10:14:57Z,When is this directory created? ,https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143429029,143429029,src/util.cpp
promag,2017-10-09T10:15:53Z,"At the moment `GetWalletDir` is used in the startup and in runtime.\n\nIMO, in runtime, this should not be possible. Create a `bool IsValidWalletDir()` (or whatever) to use in startup and here assert `is_directory`?",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143429197,143429197,src/util.cpp
promag,2017-10-09T10:16:23Z,`{` in this line.,https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143429280,143429280,src/qt/bitcoin.cpp
promag,2017-10-09T10:18:50Z,"Another interface is:\n```json\n{\n  ""wallets"": [\n    { ""name"": ""foo"", ""loaded"": true },\n    { ""name"": ""bar"", ""loaded"": false }\n  ]\n}\n```\nWhich has the advantage of allowing to add new attributes later.",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143429735,143429735,src/wallet/rpcwallet.cpp
promag,2017-10-09T10:19:25Z,This is kind of hard to read. Care to simplify?,https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143429837,143429837,src/wallet/rpcwallet.cpp
promag,2017-10-09T10:20:39Z,👏 to release notes.,https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143430048,143430048,doc/release-notes.md
promag,2017-10-09T10:21:07Z,Missing `datadir/wallets` case?,https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143430120,143430120,doc/release-notes.md
promag,2017-10-09T10:28:02Z,Specify directory to hold wallets?,https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143431510,143431510,src/init.cpp
promag,2017-10-09T10:28:29Z,"Nit, should be `-walletsdir` (plural)?",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143431659,143431659,doc/release-notes.md
meshcollider,2017-10-09T10:48:18Z,"This is part of the WIP, I'll add a test for that when I make it actually initialise the directory :)",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143435117,143435117,src/util.cpp
meshcollider,2017-10-09T10:49:51Z,"Yep I'll include something similar when reworking the directory caching stuff I think, datadir and walletdir shouldn't change throughout execution so no point rechecking every time",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143435389,143435389,src/util.cpp
meshcollider,2017-10-09T10:50:21Z,"It's not yet, it's on the to-do list ;)",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143435523,143435523,src/util.cpp
meshcollider,2017-10-09T10:52:35Z,"I prefer walletdir, no real difference though imo",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143435897,143435897,doc/release-notes.md
meshcollider,2017-10-09T10:54:04Z,"Re: breaking change, I believe it was only added in 0.15 anyway so its expected to be more unstable. Can separate into a new PR if desired, but I think its only really a useful change in this context, so I'll wait to see what others think",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143436129,143436129,src/wallet/rpcwallet.cpp
meshcollider,2017-10-09T10:54:35Z,Will add when implemented :+1:,https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143436257,143436257,doc/release-notes.md
meshcollider,2017-10-10T06:16:34Z,"Also re: interface, that idea is nice but it doesn't work well with the current logic of looking for `*.dat` files imo, `available` is slightly less suggestive that they *are* actually wallets than putting them all in a `wallets` list, you'd end up with `{ ""name"": ""peers.dat"", ""loaded"": false}` if you were using the datadir. If you or anyone has a better idea for finding wallets then that would be",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143637425,143637425,src/wallet/rpcwallet.cpp
ryanofsky,2017-10-10T13:43:04Z,"> If you or anyone has a better idea for finding wallets then that would be ok\n\nYou could look for berkeleydb magic bytes to at least filter out files which can't be bdb databases:\n\nhttps://github.com/file/file/blob/master/magic/Magdir/database",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143730935,143730935,src/wallet/rpcwallet.cpp
promag,2017-10-10T13:52:25Z,"What is the goal? Why anyone wants to list available wallets? I guess that whoever wants multiwallet keeps a record of the wallets externally? ~~Anyway, I strongly suggest to move that discussion to a new PR.~~",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143733780,143733780,src/wallet/rpcwallet.cpp
jnewbery,2017-10-10T17:04:24Z,"This change may have been influenced by my comment here: https://github.com/bitcoin/bitcoin/issues/11348#issuecomment-330234723. See the original post in that issue for motivation.\n\nMy view is that `listwallets` was announced as experimental in v0.15 (along with all the other multiwallet RPCs) so we have a bit more licence to make breaking changes than normal. I think this change should stay, ",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143791327,143791327,src/wallet/rpcwallet.cpp
jnewbery,2017-10-10T17:07:36Z,I think this help text should go in `GetWalletHelpString()` in `src/wallet/init.cpp`,https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143792101,143792101,src/init.cpp
jnewbery,2017-10-10T17:09:29Z,"Again, I think this log should go in the wallet module rather than server.",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143792569,143792569,src/init.cpp
jnewbery,2017-10-10T17:14:43Z,"I don't love this. At the moment you're using `path = """"` to essentially return an error to the caller (since on start-up, the calling function checks that the returned `fs::path` is a directory). That's not at all clear from reading just this function.\n\nCan you be more explicit about how the error is returned, either by explicitly returning bool or at the least by adding a comment here?",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143793979,143793979,src/util.cpp
jnewbery,2017-10-10T17:19:13Z,Is this necessary? Where is the wallet name used in `bitcoin-cli.cpp`?,https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143795233,143795233,src/bitcoin-cli.cpp
jnewbery,2017-10-10T17:40:42Z,"Wallet names are currently allowed to not end with `.dat`. This test verified that we don't regress that support.\n\nI'm not sure if we should go on supporting that, but we should discuss that before removing support.",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143801037,143801037,test/functional/multiwallet.py
jnewbery,2017-10-10T17:42:52Z,"This test should also test having multiple wallets in the walletdir, and issuing an RPC command to one of them.",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143801619,143801619,test/functional/multiwallet.py
jnewbery,2017-10-10T17:51:40Z,`relative to this wallet directory` or `must be in this wallet directory`,https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143804114,143804114,doc/release-notes.md
jnewbery,2017-10-10T17:53:37Z,"I'm not sure, but perhaps we should add a warning that `-walletdir` must refer to a reliable directory in the filesystem. For example, I think we want to discourage people using ephemeral, removable storage for their `-walletdir` since if the directory becomes unavailable during operation, funds may be lost.",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143804646,143804646,doc/release-notes.md
jnewbery,2017-10-10T17:55:19Z,The arguments in the declaration and definition for `VerifyEnvironment()` and `VerifyDatabaseFile()` are still `dataDir`. Those should be updated to indicate that they're now refering to the wallet directory.,https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143805092,143805092,src/wallet/init.cpp
meshcollider,2017-10-11T04:48:56Z,Fixed,https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143911688,143911688,src/wallet/init.cpp
meshcollider,2017-10-11T05:03:22Z,"Agreed, I'm unsure if there are any real benefits of adding an `available` list to the listwallets RPC after all, or if it just complicates the PR. Will discuss on IRC and then remove if not.",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r143912995,143912995,test/functional/multiwallet.py
jnewbery,2017-10-24T14:58:17Z,"This error message still says 'data directory'. The whole error message is a bit confusing, and I think it's rendered obsolete by the additional error checking at https://github.com/bitcoin/bitcoin/blob/57ee73990f1ce29916adfd99f93eae1ccea1a43b/src/wallet/init.cpp#L193 . Perhaps @jonasschnelli can confirm?",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r146588801,146588801,src/wallet/db.cpp
jnewbery,2017-10-24T15:21:05Z,"Perhaps make some local variables here rather than repeating the same calls to `os.path.join()`:\n\n```python\nwallet_dir = os.path.join(self.options.tmpdir, 'node0', 'regtest', 'wallets')\n...\nwallet_dir2 = os.path.join(self.options.tmpdir, 'node0', 'regtest', 'walletdir')\n```\n\nor whatever",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r146596435,146596435,test/functional/multiwallet.py
jnewbery,2017-10-24T15:23:48Z,"Are you Satoshi? :slightly_smiling_face: If not, I guess you can remove this copyright line (and the same from `walletutil.h`)",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r146597354,146597354,src/wallet/walletutil.cpp
luke-jr,2017-11-10T14:45:34Z,"Here and above: We should never create the wallets directory if wallet support is disabled. Additionally, if we're going to default to a wallet subdir, we should create it when there is no wallet yet, regardless of whether the datadir exists or not (eg, if datadir exists, but wallet.dat does not, make and use the wallet subdir).",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r150251905,150251905,src/util.cpp
jnewbery,2017-11-10T17:39:14Z,"I had the same reaction when I first saw this, but I don't think it's a problem. If wallet support is disabled, we'll just have an empty wallet directory in the datadir.",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r150296291,150296291,src/util.cpp
laanwj,2017-11-17T10:39:58Z,u-nit: space after `if`,https://github.com/bitcoin/bitcoin/pull/11466#discussion_r151653578,151653578,src/qt/intro.cpp
laanwj,2017-11-17T10:46:44Z,"I think it's fine to create an empty wallets directory, no matter if wallets are enabled or not (either at build or runtime). Aesthetically it would be better otherwise but practically it makes sense:\n\nAs the presence of this directory is used as signal where to put wallets, transitioning to it for an existing data directory is non-trivial. How would it even know if a legacy datadir has no wal",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r151655245,151655245,src/util.cpp
laanwj,2017-11-17T11:07:00Z,"`walletsdir` seems like something I'd fat finger into `walletdir` every time, prefer to leave out the extra letter :)",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r151659576,151659576,doc/release-notes.md
laanwj,2017-11-17T11:09:26Z,"Agree on creating a separate walletutil, this avoids picking up #ifdef WALLET_ENABLE logic in util.cpp.",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r151660024,151660024,src/wallet/walletutil.cpp
laanwj,2017-11-17T11:14:28Z,"Need information about the default here: `<datadir>/wallets if it exists, otherwise <datadir>`",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r151661051,151661051,src/wallet/init.cpp
laanwj,2017-11-17T11:21:19Z,"Seems overkill to call GetWalletDir() so many times in this function (`VerifyWallets()`), we could just call and store it once. But no, no need to fix in this PR, this is easier to review.",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r151662297,151662297,src/wallet/init.cpp
laanwj,2017-11-17T11:22:47Z,"You already have walletDir here, just log that?",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r151662500,151662500,src/wallet/db.cpp
laanwj,2017-11-17T11:24:35Z,"I think this is a very important change from the viewpoint of users (""where's my wallet.dat?! all wiki articles say it's in the data directory!""), and probably warrants its own section.",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r151662796,151662796,doc/release-notes.md
meshcollider,2017-11-17T11:30:50Z,"Agreed, although I would hope most users would be able to work out what the new ""wallets/"" directory was for ;)",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r151663963,151663963,doc/release-notes.md
promag,2017-11-17T14:18:56Z,"The logic data_dir + ""/wallets"" exists in a couple of places. Doesn't this also ignores -walletdir?",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r151694618,151694618,src/qt/intro.cpp
promag,2017-11-17T14:21:17Z,Why? Couldn't create it? Is it bad setting?,https://github.com/bitcoin/bitcoin/pull/11466#discussion_r151695181,151695181,src/wallet/walletutil.cpp
laanwj,2017-11-17T14:44:56Z,"This is just for creating the initial wallets directory. If it's not used it will stay empty.\n\nIt always creates a wallets directory under the data directory to make sure it isn't recognized as a legacy data directory (with wallets at the top level) in case any wallets are ever added to it.",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r151701021,151701021,src/qt/intro.cpp
laanwj,2017-11-17T14:45:57Z,"Unlike the datadir, `walletdir` is not created if it doesn't exist. This throws an error in init:\n```\n$ src/bitcoind -regtest -walletdir=/tmp/walletsdf\nError: Error: Specified wallet directory ""/tmp/walletsdf"" does not exist.\n```\nThat's the right behavior, IMO.\n(nit: doubled **Error:**)",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r151701304,151701304,src/wallet/walletutil.cpp
promag,2017-11-17T15:06:28Z,"Nit, if `/tmp/walletsdf` is non-directory then the error could be different.",https://github.com/bitcoin/bitcoin/pull/11466#discussion_r151706393,151706393,src/wallet/walletutil.cpp
jonasschnelli,2017-11-17T18:41:19Z,nit: double space (`if  it`).,https://github.com/bitcoin/bitcoin/pull/11466#discussion_r151759307,151759307,doc/release-notes.md
