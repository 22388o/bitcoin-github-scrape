sipa,2021-03-19 01:18:15,This was tried very recently already: #21445,https://github.com/bitcoin/bitcoin/pull/21473#issuecomment-802437836,802437836,
fanquake,2021-03-19 01:18:17,"We tested this in #21445, but didn't seem to see any advantage, potentially the builds were even [being under resourced](https://github.com/bitcoin/bitcoin/pull/21445#issuecomment-800039758):\n> It seems this will result in a slow-down. E.g. https://cirrus-ci.com/task/6631575736549376?command=ci#L5821 vs https://cirrus-ci.com/task/5477946514210816?command=ci#L5513\n\n> Looks like it is only usi",https://github.com/bitcoin/bitcoin/pull/21473#issuecomment-802437851,802437851,
fkorotkov,2021-03-19 01:30:49,"Didn't know you already tried it. Seem weird since the new cluster is using much faster CPUs (they have better single core performance 3.1 GHz vs 2.6 GHz). Let's see how this run will perform.\n\nBTW how does your build system detect how many cores available? Could it be that it detect wrongly and tries to use 32 cores of the host VM which causes the actual 2 cores being overwhelmed. 🤔 ",https://github.com/bitcoin/bitcoin/pull/21473#issuecomment-802444607,802444607,
MarcoFalke,2021-03-19 06:37:13,"Our ci scripts use `MAKEJOBS` to pass down to `make` and the python tests. It is set to `""-j4""`, so that the 2 CPU we requested are filled most of the time.\n\nI believe the difference between the regular containers and the kvm cluster is that the kvm will spin up a ""private"" vm with the requested CPUs, whereas the regular cluster will use a large shared vm. So if 20 Cirrus users compete for the",https://github.com/bitcoin/bitcoin/pull/21473#issuecomment-802594219,802594219,
hebasto,2021-03-19 10:46:04,Still takes more time than the master branch.,https://github.com/bitcoin/bitcoin/pull/21473#issuecomment-802733237,802733237,
fkorotkov,2021-03-19 11:18:57,"> Still takes more time than the master branch.\n\nIndeed. This is very surprising for me since the local SSD on the VMs are 24 times faster than an HHD and the CPUs are faster. On paper everything is faster and indeed a few tasks were faster:\n\n<img width=""1555"" alt=""Screen Shot 2021-03-19 at 7 06 44 AM"" src=""https://user-images.githubusercontent.com/989066/111772318-1a674180-8883-11eb-8f91-",https://github.com/bitcoin/bitcoin/pull/21473#issuecomment-802759504,802759504,
fkorotkov,2021-03-19 12:45:24,"I think my initial feeling was right. If I understood the code of tests correctly, they are like integration tests where you have bunch of the nodes running and you verify the results in the end. I think the C++ code [here](https://github.com/bitcoin/bitcoin/blob/05757aa860215a8fd5002d99b6ec653175c6b734/src/util/system.cpp#L1336-L1339) gets the CPU count wrong in case of running in a container. In",https://github.com/bitcoin/bitcoin/pull/21473#issuecomment-802808158,802808158,
fkorotkov,2021-03-19 18:07:47,"I've tried to hardcode the CPU amount but still got slower performance for `multiprocess`. I'm a bit confused how it can be slower given that on paper everything should be faster. 🤷‍♂️\n\nI don't have any other ideas to try so will close the PR. Sorry for the noise.",https://github.com/bitcoin/bitcoin/pull/21473#issuecomment-803016623,803016623,
MarcoFalke,2021-04-09 11:25:07,(This has been merged in https://github.com/bitcoin/bitcoin/pull/21445#issuecomment-815853987),https://github.com/bitcoin/bitcoin/pull/21473#issuecomment-816615236,816615236,
