jonatack,2020-12-19 18:59:11,Concept ACK,https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-748511940,748511940,
ajtowns,2020-12-19 19:17:39,"Having run this patch on a node that does tor and accepts incoming connections for a couple of days, with debug logging disabled, my logs have:\n\n * 248x UpdateTip: new best=... \n * 160x New outbound peer connected: ... (block-relay)\n * 15x New outbound peer connected: ... (full-relay)\n * 7x Potential stale tip detected, will try using extra outbound peer (last tip update: 1805 seconds ag",https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-748513919,748513919,
practicalswift,2020-12-19 19:26:04,"Very strong Concept ACK: this is a great signal-to-noise improvement!\n\n> Having run this patch on a node that does tor and accepts incoming connections for a couple of days, with debug logging disabled, my logs have:\n> \n> * 248x UpdateTip: new best=...\n> * 160x New outbound peer connected: ... (block-relay)\n> * 15x New outbound peer connected: ... (full-relay)\n> * 7x Potential stale ",https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-748514827,748514827,
jonatack,2020-12-19 19:29:33,"Yeah, I've resigned myself to always running nodes with net logging on now and grepping for things.",https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-748515179,748515179,
DrahtBot,2020-12-20 00:27:55,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20942 ([refactor] Move some net_processing globals into PeerManagerImpl by ajtowns)\n* #20721 (Net: Move ping data to net",https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-748544260,748544260,
jnewbery,2020-12-29 16:02:57,"Concept ACK. I have a draft branch that makes `fDisconnect` private and adds a `CNode::Disconncect()`, which net processing has to call if it wants to disconnect a peer. That function takes a required  `message` argument which gets logged to the `NET` category. That'd fix all instances of net_processing not logging disconnections, and ensure that none are introduced in future.\n\nThe branch is h",https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-752136426,752136426,
Sjors,2020-12-30 14:33:24,Concept ACK,https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-752641953,752641953,
ajtowns,2021-01-06 07:46:03,"Removed dep on #20646 since it's no longer changing late sendaddrv2 from a disconnect, and marked as ready for review.",https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-755141551,755141551,
ajtowns,2021-01-06 07:48:30,"@jnewbery Didn't like the change to always evaluating the args to the LogPrint format that comes with a `CNode::Disconnect(args...)` method, or any of the ideas I had to prevent it, so have left it as is for this PR.",https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-755142550,755142550,
jnewbery,2021-01-06 10:50:00,"> Didn't like the change to always evaluating the args to the LogPrint format that comes with a CNode::Disconnect(args...) method, or any of the ideas I had to prevent it, so have left it as is for this PR.\n\nGood point about always evaluating the LogPrint args. In practice, I don't think it matters very much here. These logs are infrequent, only happen once per connection, and none of them hav",https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-755228905,755228905,
jnewbery,2021-01-07 09:15:34,utACK e28d7405c11d407b4665a378ad17bc3e9b81c4f0,https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-755989482,755989482,
jnewbery,2021-01-10 10:02:01,"utACK b0070717b4fe33f21d6d0d15bc30a26473f06a90\n\nChecked range-diff. Only conflict was change from `CNode* pnode` to `CNode& node` in `SocketSendData()`.",https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-757448947,757448947,
practicalswift,2021-01-10 15:53:16,"ACK b0070717b4fe33f21d6d0d15bc30a26473f06a90\n\nVery nice to see so many ""attacker log spam"" vectors (or worst-case: attacker disk fill vectors) be removed in one go.\n\nLooking forward to seeing this merged!",https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-757498169,757498169,
DrahtBot,2021-01-13 11:46:27,<!--4a62be1de6b64f3ed646cdc7932c8cf5-->\nüïµÔ∏è @sipa has been requested to review this pull request as specified in the REVIEWERS file.,https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-759396596,759396596,
ajtowns,2021-01-14 13:44:02,Addressed marco's comments,https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-760204933,760204933,
practicalswift,2021-01-14 13:52:43,cr ACK 4424d136c45b6b078afd58d5e8fc609ec7e047eb,https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-760209882,760209882,
MarcoFalke,2021-01-14 14:08:49,"re-ACK 4424d136c45b6b078afd58d5e8fc609ec7e047eb only change is fLogIPs fixup in first commit ü§∫\n\n<details><summary>Show signature and timestamp</summary>\n\nSignature:\n\n```\n-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA512\n\nre-ACK 4424d136c45b6b078afd58d5e8fc609ec7e047eb only change is fLogIPs fixup in first commit ü§∫\n-----BEGIN PGP SIGNATURE-----\n\niQGzBAEBCgAdFiEE+rVPoUahrI9sL",https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-760219279,760219279,
decryp2kanon,2021-01-19 18:36:52,Concept ACK. I really wanted this!,https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-763040913,763040913,
jnewbery,2021-01-22 14:42:56,"My PR being merged made this one conflict with master. I've rebased it here: https://github.com/jnewbery/bitcoin/tree/pr20724.1. Feel free to take that if it helps.\n\nutACK dd0aeacd1892d225bf24402fe8f1f73b829d1293 if you take it.",https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-765449680,765449680,
ajtowns,2021-01-28 08:07:46,"> My PR being merged made this one conflict with master. I've rebased it here: https://github.com/jnewbery/bitcoin/tree/pr20724.1. Feel free to take that if it helps.\n\nI manually rebased it onto master in order to include #21000, but I think I got the same changes as your rebase anyway.\n",https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-768876333,768876333,
jnewbery,2021-01-28 08:47:04,"ACK 48c8a9b96453ca429b38fc5d5181a310ae5a93bf\n\nConfirmed I got the same rebase.",https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-768896742,768896742,
MarcoFalke,2021-01-28 13:12:14,"re-ACK 48c8a9b96453ca429b38fc5d5181a310ae5a93bf only change is rebase üöì\n\n<details><summary>Show signature and timestamp</summary>\n\nSignature:\n\n```\n-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA512\n\nre-ACK 48c8a9b96453ca429b38fc5d5181a310ae5a93bf only change is rebase üöì\n-----BEGIN PGP SIGNATURE-----\n\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUgnVwwA",https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-769043015,769043015,
practicalswift,2021-01-28 21:07:37,re-ACK 48c8a9b96453ca429b38fc5d5181a310ae5a93bf,https://github.com/bitcoin/bitcoin/pull/20724#issuecomment-769395022,769395022,
jnewbery,2021-01-06 10:59:38,"This should be in the next scope out, ie:\n\n```\nif (pfrom.GetCommonVersion() >= WTXID_RELAY_VERSION) {\n    ...\n} else {\n    LogPrint(BCLog::NET, ""ignoring wtxidrelay..."");\n}",https://github.com/bitcoin/bitcoin/pull/20724#discussion_r552507704,552507704,src/net_processing.cpp
ajtowns,2021-01-07 00:44:54,"@jnewbery\n\n(Attaching to an edit to make this a thread instead of top-level comments)\n\n> Good point about always evaluating the LogPrint args. In practice, I don't think it matters very much here.\n\nYeah, I kind-of agree, just didn't feel comfortable about it. I suspect:\n\n```c++\n    pnode->Disconnect(strprintf(""socket send error: %s"", NetworkErrorString(nErr));\n```\n\nand\n\",https://github.com/bitcoin/bitcoin/pull/20724#discussion_r553046139,553046139,src/net.cpp
ajtowns,2021-01-07 00:46:22,fixed,https://github.com/bitcoin/bitcoin/pull/20724#discussion_r553046585,553046585,src/net_processing.cpp
jnewbery,2021-01-07 09:07:21,I agree! Could be done in a follow up.,https://github.com/bitcoin/bitcoin/pull/20724#discussion_r553195531,553195531,src/net.cpp
MarcoFalke,2021-01-13 15:54:39,"in commit 9c247a74f0e6b448f9c879c41956e318c753783a:\n\nnit, since `%s` is a connection type:\n\n```suggestion\n            LogPrint(BCLog::NET, ""selected %s connection for eviction peer=%d; disconnecting\n"", pnode->ConnectionTypeAsString(), pnode->GetId());\n```",https://github.com/bitcoin/bitcoin/pull/20724#discussion_r556632033,556632033,src/net.cpp
MarcoFalke,2021-01-13 15:58:00,"in commit 9c247a74f0e6b448f9c879c41956e318c753783a:\n\nNot sure if it makes sense to mention the function name. This will be duplicate if #19809 and force a break anyway on rename. Maybe something like ""disconnect {strNode} matches peer={id}"" is better?",https://github.com/bitcoin/bitcoin/pull/20724#discussion_r556636453,556636453,src/net.cpp
MarcoFalke,2021-01-13 15:58:06,same,https://github.com/bitcoin/bitcoin/pull/20724#discussion_r556636541,556636541,src/net.cpp
MarcoFalke,2021-01-13 15:58:12,same,https://github.com/bitcoin/bitcoin/pull/20724#discussion_r556636652,556636652,src/net.cpp
MarcoFalke,2021-01-13 16:00:33,"in commit 9c247a74f0e6b448f9c879c41956e318c753783a:\n\nCould use the helper to avoid having to change the string here if feeler connections get renamed in any way? (E.g. see https://github.com/bitcoin/bitcoin/pull/20729/files#diff-00021eed586a482abdb09d6cdada1d90115abe988a91421851960e26658bed02L513 which changes a connection type string)\n\n```suggestion\n            LogPrint(BCLog::NET, ""%s ",https://github.com/bitcoin/bitcoin/pull/20724#discussion_r556638362,556638362,src/net_processing.cpp
MarcoFalke,2021-01-13 16:01:03,same,https://github.com/bitcoin/bitcoin/pull/20724#discussion_r556638729,556638729,src/net_processing.cpp
ajtowns,2021-01-14 09:34:35,"It's being disconnected because it matches `IsFeelerConn`, which is ""hardcoded"" above -- matching that seems right to me",https://github.com/bitcoin/bitcoin/pull/20724#discussion_r557258663,557258663,src/net_processing.cpp
ajtowns,2021-01-14 09:34:45,same :),https://github.com/bitcoin/bitcoin/pull/20724#discussion_r557258762,557258762,src/net_processing.cpp
ajtowns,2021-01-14 10:37:57,"Actually, I guess this logging leaks IP info even with `-nologips`. Maybe\n\n```c++\nLogPrint(BCLog::NET, ""disconnect by address%s matched peer=%d"",\n     (fLogIPs ? strprintf(""=%s"", strNode) : """"),\n     pnode->GetId());\n```",https://github.com/bitcoin/bitcoin/pull/20724#discussion_r557298966,557298966,src/net.cpp
ajtowns,2021-01-14 13:42:34,done,https://github.com/bitcoin/bitcoin/pull/20724#discussion_r557402889,557402889,src/net.cpp
ajtowns,2021-01-14 13:42:43,done,https://github.com/bitcoin/bitcoin/pull/20724#discussion_r557402967,557402967,src/net.cpp
