[
  {
    "sha": "5d3228217c6d2159b2155ef1d17e9462e651c497",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo1ZDMyMjgyMTdjNmQyMTU5YjIxNTVlZjFkMTdlOTQ2MmU2NTFjNDk3",
    "commit": {
      "author": {
        "name": "grayleonard",
        "email": "gl7039a@american.edu",
        "date": "2013-07-23T00:39:17Z"
      },
      "committer": {
        "name": "grayleonard",
        "email": "gl7039a@american.edu",
        "date": "2013-07-23T00:39:17Z"
      },
      "message": "Mitigate Timing Attacks On Basic RPC Authorization\n\nAs per #2838 . Eliminates the possibility of timing attacks by changing the way the two passwords are compared. See http://rdist.root.org/2010/01/07/timing-independent-array-comparison/ for reference.\r\n\r\nIt iterates through each char in the strings, and if the two chars it is comparing aren't the same, then it adds 1 to nReturn and the function returns false. Previously, the function would return false on the first char that didn't match, allowing a possible attacker to run a timing attack.",
      "tree": {
        "sha": "cfdf1499e48ff83a4046da666dac22718164f0c4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/cfdf1499e48ff83a4046da666dac22718164f0c4"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5d3228217c6d2159b2155ef1d17e9462e651c497",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/5d3228217c6d2159b2155ef1d17e9462e651c497",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/5d3228217c6d2159b2155ef1d17e9462e651c497",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/5d3228217c6d2159b2155ef1d17e9462e651c497/comments",
    "author": {
      "login": "grayleonard",
      "id": 3433280,
      "node_id": "MDQ6VXNlcjM0MzMyODA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3433280?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/grayleonard",
      "html_url": "https://github.com/grayleonard",
      "followers_url": "https://api.github.com/users/grayleonard/followers",
      "following_url": "https://api.github.com/users/grayleonard/following{/other_user}",
      "gists_url": "https://api.github.com/users/grayleonard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/grayleonard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/grayleonard/subscriptions",
      "organizations_url": "https://api.github.com/users/grayleonard/orgs",
      "repos_url": "https://api.github.com/users/grayleonard/repos",
      "events_url": "https://api.github.com/users/grayleonard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/grayleonard/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "grayleonard",
      "id": 3433280,
      "node_id": "MDQ6VXNlcjM0MzMyODA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3433280?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/grayleonard",
      "html_url": "https://github.com/grayleonard",
      "followers_url": "https://api.github.com/users/grayleonard/followers",
      "following_url": "https://api.github.com/users/grayleonard/following{/other_user}",
      "gists_url": "https://api.github.com/users/grayleonard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/grayleonard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/grayleonard/subscriptions",
      "organizations_url": "https://api.github.com/users/grayleonard/orgs",
      "repos_url": "https://api.github.com/users/grayleonard/repos",
      "events_url": "https://api.github.com/users/grayleonard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/grayleonard/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "0a740650a52a21b7d82b43524017c87643af3224",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0a740650a52a21b7d82b43524017c87643af3224",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/0a740650a52a21b7d82b43524017c87643af3224"
      }
    ],
    "stats": {
      "total": 13,
      "additions": 12,
      "deletions": 1
    },
    "files": [
      {
        "sha": "000c70db99f0227888b2cfabedbf87dae551dc57",
        "filename": "src/bitcoinrpc.cpp",
        "status": "modified",
        "additions": 12,
        "deletions": 1,
        "changes": 13,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/5d3228217c6d2159b2155ef1d17e9462e651c497/src/bitcoinrpc.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/5d3228217c6d2159b2155ef1d17e9462e651c497/src/bitcoinrpc.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoinrpc.cpp?ref=5d3228217c6d2159b2155ef1d17e9462e651c497",
        "patch": "@@ -471,12 +471,23 @@ int ReadHTTPMessage(std::basic_istream<char>& stream, map<string,\n \n bool HTTPAuthorized(map<string, string>& mapHeaders)\n {\n+    int nResult = 0;\n     string strAuth = mapHeaders[\"authorization\"];\n     if (strAuth.substr(0,6) != \"Basic \")\n         return false;\n     string strUserPass64 = strAuth.substr(6); boost::trim(strUserPass64);\n     string strUserPass = DecodeBase64(strUserPass64);\n-    return strUserPass == strRPCUserColonPass;\n+\n+    //Begin constant-time comparison\n+    if (strUserPass.length() != strRPCUserColonPass.length())\n+        return false;\n+\n+    //XOR's chars in each password together, and then adds either 0 or 1 (0 if the chars match) to nResult\n+    for (size_t i = 0; i < strUserPass.length(); i++)\n+    { \n+        nResult |= strUserPass.at(i) ^ strRPCUserColonPass.at(i); \n+    }\n+    return nResult == 0;\n }\n \n //"
      }
    ]
  },
  {
    "sha": "bd8420dda743c36940d3986fb7e81a2f195495f8",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiZDg0MjBkZGE3NDNjMzY5NDBkMzk4NmZiN2U4MWEyZjE5NTQ5NWY4",
    "commit": {
      "author": {
        "name": "grayleonard",
        "email": "gl7039a@american.edu",
        "date": "2013-07-23T01:15:23Z"
      },
      "committer": {
        "name": "grayleonard",
        "email": "gl7039a@american.edu",
        "date": "2013-07-23T01:15:23Z"
      },
      "message": "Updated pull\n\nFix to the timing-leak for the length of the password.",
      "tree": {
        "sha": "8c94d24835099b956f962fcd23656d9fc71935a7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8c94d24835099b956f962fcd23656d9fc71935a7"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bd8420dda743c36940d3986fb7e81a2f195495f8",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bd8420dda743c36940d3986fb7e81a2f195495f8",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/bd8420dda743c36940d3986fb7e81a2f195495f8",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bd8420dda743c36940d3986fb7e81a2f195495f8/comments",
    "author": {
      "login": "grayleonard",
      "id": 3433280,
      "node_id": "MDQ6VXNlcjM0MzMyODA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3433280?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/grayleonard",
      "html_url": "https://github.com/grayleonard",
      "followers_url": "https://api.github.com/users/grayleonard/followers",
      "following_url": "https://api.github.com/users/grayleonard/following{/other_user}",
      "gists_url": "https://api.github.com/users/grayleonard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/grayleonard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/grayleonard/subscriptions",
      "organizations_url": "https://api.github.com/users/grayleonard/orgs",
      "repos_url": "https://api.github.com/users/grayleonard/repos",
      "events_url": "https://api.github.com/users/grayleonard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/grayleonard/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "grayleonard",
      "id": 3433280,
      "node_id": "MDQ6VXNlcjM0MzMyODA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3433280?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/grayleonard",
      "html_url": "https://github.com/grayleonard",
      "followers_url": "https://api.github.com/users/grayleonard/followers",
      "following_url": "https://api.github.com/users/grayleonard/following{/other_user}",
      "gists_url": "https://api.github.com/users/grayleonard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/grayleonard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/grayleonard/subscriptions",
      "organizations_url": "https://api.github.com/users/grayleonard/orgs",
      "repos_url": "https://api.github.com/users/grayleonard/repos",
      "events_url": "https://api.github.com/users/grayleonard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/grayleonard/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "5d3228217c6d2159b2155ef1d17e9462e651c497",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/5d3228217c6d2159b2155ef1d17e9462e651c497",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/5d3228217c6d2159b2155ef1d17e9462e651c497"
      }
    ],
    "stats": {
      "total": 10,
      "additions": 8,
      "deletions": 2
    },
    "files": [
      {
        "sha": "c038e60d516a3d17406afd34459b418c63405e68",
        "filename": "src/bitcoinrpc.cpp",
        "status": "modified",
        "additions": 8,
        "deletions": 2,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bd8420dda743c36940d3986fb7e81a2f195495f8/src/bitcoinrpc.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bd8420dda743c36940d3986fb7e81a2f195495f8/src/bitcoinrpc.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoinrpc.cpp?ref=bd8420dda743c36940d3986fb7e81a2f195495f8",
        "patch": "@@ -479,8 +479,14 @@ bool HTTPAuthorized(map<string, string>& mapHeaders)\n     string strUserPass = DecodeBase64(strUserPass64);\n \n     //Begin constant-time comparison\n-    if (strUserPass.length() != strRPCUserColonPass.length())\n-        return false;\n+    if (strUserPass.length() != strRPCUserColonPass.length()) \n+    {\n+        for (size_t i = 0; i < strUserPass.length(); i++) //Stops timing-leaks for the length of the password\n+        { \n+            nResult |= strUserPass.at(i) ^ strUserPass.at(i); \n+        }\n+        return ++nResult == 0;\n+    }\n \n     //XOR's chars in each password together, and then adds either 0 or 1 (0 if the chars match) to nResult\n     for (size_t i = 0; i < strUserPass.length(); i++)"
      }
    ]
  },
  {
    "sha": "351229cfc0d0f6c54af8e4d7ac7426c16e776fb1",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozNTEyMjljZmMwZDBmNmM1NGFmOGU0ZDdhYzc0MjZjMTZlNzc2ZmIx",
    "commit": {
      "author": {
        "name": "grayleonard",
        "email": "gl7039a@american.edu",
        "date": "2013-07-23T14:38:02Z"
      },
      "committer": {
        "name": "grayleonard",
        "email": "gl7039a@american.edu",
        "date": "2013-07-23T14:38:02Z"
      },
      "message": "(Hopefully) the last update to this pull request\n\nSimplified time-leaking solution, using min() to make sure only valid indexes are called.",
      "tree": {
        "sha": "6f5d23775cc697cb1f35005bd399bd1c9181e685",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6f5d23775cc697cb1f35005bd399bd1c9181e685"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/351229cfc0d0f6c54af8e4d7ac7426c16e776fb1",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/351229cfc0d0f6c54af8e4d7ac7426c16e776fb1",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/351229cfc0d0f6c54af8e4d7ac7426c16e776fb1",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/351229cfc0d0f6c54af8e4d7ac7426c16e776fb1/comments",
    "author": {
      "login": "grayleonard",
      "id": 3433280,
      "node_id": "MDQ6VXNlcjM0MzMyODA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3433280?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/grayleonard",
      "html_url": "https://github.com/grayleonard",
      "followers_url": "https://api.github.com/users/grayleonard/followers",
      "following_url": "https://api.github.com/users/grayleonard/following{/other_user}",
      "gists_url": "https://api.github.com/users/grayleonard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/grayleonard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/grayleonard/subscriptions",
      "organizations_url": "https://api.github.com/users/grayleonard/orgs",
      "repos_url": "https://api.github.com/users/grayleonard/repos",
      "events_url": "https://api.github.com/users/grayleonard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/grayleonard/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "grayleonard",
      "id": 3433280,
      "node_id": "MDQ6VXNlcjM0MzMyODA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3433280?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/grayleonard",
      "html_url": "https://github.com/grayleonard",
      "followers_url": "https://api.github.com/users/grayleonard/followers",
      "following_url": "https://api.github.com/users/grayleonard/following{/other_user}",
      "gists_url": "https://api.github.com/users/grayleonard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/grayleonard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/grayleonard/subscriptions",
      "organizations_url": "https://api.github.com/users/grayleonard/orgs",
      "repos_url": "https://api.github.com/users/grayleonard/repos",
      "events_url": "https://api.github.com/users/grayleonard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/grayleonard/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "bd8420dda743c36940d3986fb7e81a2f195495f8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bd8420dda743c36940d3986fb7e81a2f195495f8",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/bd8420dda743c36940d3986fb7e81a2f195495f8"
      }
    ],
    "stats": {
      "total": 17,
      "additions": 6,
      "deletions": 11
    },
    "files": [
      {
        "sha": "67d7d43abb6cc07d2d60f47e10b4ffab3d56bd38",
        "filename": "src/bitcoinrpc.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 11,
        "changes": 17,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/351229cfc0d0f6c54af8e4d7ac7426c16e776fb1/src/bitcoinrpc.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/351229cfc0d0f6c54af8e4d7ac7426c16e776fb1/src/bitcoinrpc.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoinrpc.cpp?ref=351229cfc0d0f6c54af8e4d7ac7426c16e776fb1",
        "patch": "@@ -479,20 +479,15 @@ bool HTTPAuthorized(map<string, string>& mapHeaders)\n     string strUserPass = DecodeBase64(strUserPass64);\n \n     //Begin constant-time comparison\n-    if (strUserPass.length() != strRPCUserColonPass.length()) \n-    {\n-        for (size_t i = 0; i < strUserPass.length(); i++) //Stops timing-leaks for the length of the password\n-        { \n-            nResult |= strUserPass.at(i) ^ strUserPass.at(i); \n-        }\n-        return ++nResult == 0;\n-    }\n-\n-    //XOR's chars in each password together, and then adds either 0 or 1 (0 if the chars match) to nResult\n-    for (size_t i = 0; i < strUserPass.length(); i++)\n+    //XOR chars in each password together, and then adds either 0 or 1 (0 if they match) to nResult\n+    for(size_t i = 0; i < min(strUserPass.length(), strRPCUserColonPass.length()); i++)\n     { \n         nResult |= strUserPass.at(i) ^ strRPCUserColonPass.at(i); \n     }\n+\n+    if(strUserPass.length() != strRPCUserColonPass.length())\n+        nResult++;\n+\n     return nResult == 0;\n }\n "
      }
    ]
  }
]