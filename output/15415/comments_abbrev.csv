Sjors,2019-02-15T12:03:13Z,"I use this in #14912 in order to mock a hardware wallet. The functional first generates a signed PSBT which it writes to a file. The test node then calls a mock signer python script, which reads that file. The latter scripts gets it `cwd` from `bitcoind`. \n\nPerhaps the tmp root dir of the functional tests runner is a better choice? cc @jnewbery",https://github.com/bitcoin/bitcoin/pull/15415#issuecomment-464023512,464023512,
MarcoFalke,2019-02-15T12:14:28Z,Why would you want to do this? Imo you can't rely a user is doing the same. I'd prefer to pass in the absulute paths from outside or specify with a flag that it should be run from relative to the datadir,https://github.com/bitcoin/bitcoin/pull/15415#issuecomment-464027198,464027198,
Sjors,2019-02-15T12:26:40Z,"@MarcoFalke this only affects the test suite. The [mock signer](https://github.com/bitcoin/bitcoin/pull/14912/files#diff-58488d934fee5d1c533904561dbc2040) script I created isn't itself part of the test suite, so it has no idea where everything lives on the system.\n\nNote that the real thing (HWI) doesn't care where it's called from. It doesn't need to know where Bitcoin Core lives.",https://github.com/bitcoin/bitcoin/pull/15415#issuecomment-464031094,464031094,
promag,2019-02-15T13:30:25Z,"> The latter scripts gets it cwd from bitcoind.\n\nWhy? Is that a requirement?",https://github.com/bitcoin/bitcoin/pull/15415#issuecomment-464051160,464051160,
MarcoFalke,2019-02-15T13:56:06Z,"If you call that script from bitcoind, you might as well pass the datadir to the script?",https://github.com/bitcoin/bitcoin/pull/15415#issuecomment-464058590,464058590,
Sjors,2019-02-15T14:45:49Z,"@MarcoFalke that would involve something like this:\n\n```\nbitcoind -signer=""/.../mock.py --mock_cwd=/tmp/.../node1/.."".\n```\n\nThat `--mock_cwd=/.../` argument would then be passed along to all calls to mock.py and concatenated with the other arguments. That would probably work, but then it deviates from the way `-signer` should normally be used.",https://github.com/bitcoin/bitcoin/pull/15415#issuecomment-464074946,464074946,
MarcoFalke,2019-02-15T15:09:27Z,You can pass the `boost::process::start_dir` as datadir  in `runCommandParseJSON`?,https://github.com/bitcoin/bitcoin/pull/15415#issuecomment-464083500,464083500,
Sjors,2019-02-15T15:25:06Z,"> You can pass the `boost::process::start_dir` as datadir in `runCommandParseJSON`?\n\nI don't want to modify the real world behaviour of `runCommandParseJSON()`. That should just use the `cwd` of however `bitcoind` was started, and that generally shouldn't be the datadir.",https://github.com/bitcoin/bitcoin/pull/15415#issuecomment-464089209,464089209,
DrahtBot,2019-02-15T15:48:04Z,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#15419](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15419.html) (qa: Always refresh rotten cache to be out o",https://github.com/bitcoin/bitcoin/pull/15415#issuecomment-464097537,464097537,
Sjors,2019-02-15T16:54:43Z,"I simplified it: it now merely sets the default `cwd` to the temp dir. Tests that need to override this can pass `cwd=` via `args*` to `node.start()`, which `wallet_multiwallet.py` already does.\n\nIt's now actually a bug fix: try creating a directory `wallets` in master and then run `wallet_multiwallet.py`; it will fail.",https://github.com/bitcoin/bitcoin/pull/15415#issuecomment-464121264,464121264,
MarcoFalke,2019-02-15T17:02:19Z,"> It's now actually a bug fix: try creating a directory `wallets` in master and then run `wallet_multiwallet.py`; it will fail.\n\nPlease elaborate. this should not happen",https://github.com/bitcoin/bitcoin/pull/15415#issuecomment-464123758,464123758,
Sjors,2019-02-15T17:07:12Z,"Before this PR the test suite would launch nodes with the `cwd` set to wherever you're launching the test suite from.  `wallet_multiwallet.py` then does the following:\n\n```py\nself.nodes[0].assert_start_raises_init_error(['-walletdir=wallets'], 'Error: Specified -walletdir ""wallets"" does not exist')\nself.nodes[0].assert_start_raises_init_error(['-walletdir=wallets'], 'Error: Specified -wall",https://github.com/bitcoin/bitcoin/pull/15415#issuecomment-464125369,464125369,
meshcollider,2019-02-16T19:55:45Z,utACK https://github.com/bitcoin/bitcoin/commit/2cb2f546ee5efac8bb27a628ffa4bcfe5a7c99de,https://github.com/bitcoin/bitcoin/pull/15415#issuecomment-464378425,464378425,
laanwj,2019-02-19T15:06:04Z,@MarcoFalke I suppose you've retracted your NACK above?,https://github.com/bitcoin/bitcoin/pull/15415#issuecomment-465166512,465166512,
MarcoFalke,2019-02-19T15:12:03Z,utACK e3e1a5631e,https://github.com/bitcoin/bitcoin/pull/15415#issuecomment-465169269,465169269,
MarcoFalke,2019-02-19T15:13:37Z,"> @MarcoFalke I suppose you've retracted your NACK above?\n\nYes, this is a bugfix as pointed out by @Sjors in an earlier comment",https://github.com/bitcoin/bitcoin/pull/15415#issuecomment-465170001,465170001,
jnewbery,2019-02-19T15:33:07Z,"utACK e3e1a5631e2456bb40844862ef35c07c1d1c47b0\n\n",https://github.com/bitcoin/bitcoin/pull/15415#issuecomment-465179127,465179127,
MarcoFalke,2019-02-15T15:21:32Z,"NACK, this should be added to the specific test that needs it, not globally",https://github.com/bitcoin/bitcoin/pull/15415#discussion_r257275189,257275189,test/functional/test_framework/test_framework.py
MarcoFalke,2019-02-15T17:51:47Z,"style-nit: Please move this to after the `, *, `, otherwise it will be possible to supply this as non-named arg",https://github.com/bitcoin/bitcoin/pull/15415#discussion_r257331643,257331643,test/functional/test_framework/test_node.py
MarcoFalke,2019-02-15T17:52:04Z,"style-nit: Please add a trailing comma, otherwise formatters such as https://github.com/MarcoFalke/yapf-diff will grind on this",https://github.com/bitcoin/bitcoin/pull/15415#discussion_r257331728,257331728,test/functional/test_framework/test_framework.py
MarcoFalke,2019-02-18T14:15:08Z,"```suggestion\n    def start(self, extra_args=None, *, cwd=None, stdout=None, stderr=None, **kwargs):\n```\n\nAny reason why you removed the star? It should stay there",https://github.com/bitcoin/bitcoin/pull/15415#discussion_r257711737,257711737,test/functional/test_framework/test_node.py
Sjors,2019-02-19T07:53:05Z,"Oops, I misread your original comment.",https://github.com/bitcoin/bitcoin/pull/15415#discussion_r257921949,257921949,test/functional/test_framework/test_node.py
