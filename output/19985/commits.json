[
  {
    "sha": "c4ba79b7f7bdf32bbfb6bd9ba57be5e8045fabbd",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpjNGJhNzliN2Y3YmRmMzJiYmZiNmJkOWJhNTdiZTVlODA0NWZhYmJk",
    "commit": {
      "author": {
        "name": "nthumann",
        "email": "me@n-thumann.de",
        "date": "2020-09-20T16:38:28Z"
      },
      "committer": {
        "name": "nthumann",
        "email": "me@n-thumann.de",
        "date": "2020-09-25T15:41:27Z"
      },
      "message": "net: Prevent routing of deprecated Site Local IPv6",
      "tree": {
        "sha": "c7e0868648b58311ea566f2288ed51841f665bfa",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c7e0868648b58311ea566f2288ed51841f665bfa"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c4ba79b7f7bdf32bbfb6bd9ba57be5e8045fabbd",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEECpbFYxDyKGvEvGXoka4m9S3lS3YFAl9uD6cACgkQka4m9S3l\nS3boWg/+JwJtrz+/JucwBJhF2BkKcoT+5qo+MIVqbjthPfMv/UP+7JdxFt4deD1o\nnzg/R+K6Gu4Pw9WL4n7vP9I0AKsJAxxmDrMaW9agAJT2tlAjiHpNP63jG4baTdMb\nU0BtteHixGMLJiXWb4tSP+q0ugJsvckvvelR2nMqAhye5JoBIYhLxZxDNL5Aa6uu\nZQDrYgTGaMow0wHwsrUnO3I8Xhlr1rE/vjjjyX34kDlmng34yIH9tgkVvQib5nID\nUf5ZKf51YBMe6NV7X8KYnkNIE6EmpV+Tv4jX2nra8WORvL/0qOYpB+strvljRYgh\npYwmyNUpW7KKDuzy9l3YQx3edwXCtxZIyr8n3mfd8L6hQWil1JE4QFMuV3cIROWj\nxh5K4EapLEnAFc0U70q/j47OMNbx8vbgFVkJ8FNYwG8qx7GMiuReq6p/kb1ov38h\nQeMwOT4fS0AZUFwoGD47QjHcGqt3hKq6avWJiLxlzLDpREAuq8S5zaVK3BrDZ9bW\nk2bkpMQwFl3OZwin6K10M9dolY/8VlNohpz7ZhxM9fd/4nrnfgcaLNb85v6MpiOV\nxorz9G94tyZeQc2O5AVBH66E7DvaCKkDNS+DUNryLdBf9VJ/OKRLt1TzhOy5VinR\nnDawCRWg5dlY92dHE34OYYEqviAizbyxZCB8mDmzQwYjCbMJHD8=\n=YPBY\n-----END PGP SIGNATURE-----",
        "payload": "tree c7e0868648b58311ea566f2288ed51841f665bfa\nparent b99a1633b270e0e89479b2bb2ae19a8a8dc0fa05\nauthor nthumann <me@n-thumann.de> 1600619908 +0200\ncommitter nthumann <me@n-thumann.de> 1601048487 +0200\n\nnet: Prevent routing of deprecated Site Local IPv6\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c4ba79b7f7bdf32bbfb6bd9ba57be5e8045fabbd",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/c4ba79b7f7bdf32bbfb6bd9ba57be5e8045fabbd",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c4ba79b7f7bdf32bbfb6bd9ba57be5e8045fabbd/comments",
    "author": {
      "login": "n-thumann",
      "id": 46975855,
      "node_id": "MDQ6VXNlcjQ2OTc1ODU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/46975855?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/n-thumann",
      "html_url": "https://github.com/n-thumann",
      "followers_url": "https://api.github.com/users/n-thumann/followers",
      "following_url": "https://api.github.com/users/n-thumann/following{/other_user}",
      "gists_url": "https://api.github.com/users/n-thumann/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/n-thumann/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/n-thumann/subscriptions",
      "organizations_url": "https://api.github.com/users/n-thumann/orgs",
      "repos_url": "https://api.github.com/users/n-thumann/repos",
      "events_url": "https://api.github.com/users/n-thumann/events{/privacy}",
      "received_events_url": "https://api.github.com/users/n-thumann/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "n-thumann",
      "id": 46975855,
      "node_id": "MDQ6VXNlcjQ2OTc1ODU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/46975855?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/n-thumann",
      "html_url": "https://github.com/n-thumann",
      "followers_url": "https://api.github.com/users/n-thumann/followers",
      "following_url": "https://api.github.com/users/n-thumann/following{/other_user}",
      "gists_url": "https://api.github.com/users/n-thumann/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/n-thumann/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/n-thumann/subscriptions",
      "organizations_url": "https://api.github.com/users/n-thumann/orgs",
      "repos_url": "https://api.github.com/users/n-thumann/repos",
      "events_url": "https://api.github.com/users/n-thumann/events{/privacy}",
      "received_events_url": "https://api.github.com/users/n-thumann/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "b99a1633b270e0e89479b2bb2ae19a8a8dc0fa05",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b99a1633b270e0e89479b2bb2ae19a8a8dc0fa05",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/b99a1633b270e0e89479b2bb2ae19a8a8dc0fa05"
      }
    ],
    "stats": {
      "total": 10,
      "additions": 9,
      "deletions": 1
    },
    "files": [
      {
        "sha": "4a38cb9e497a3e7319a6da89553b2a1a35f4a3d0",
        "filename": "src/netaddress.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 1,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/c4ba79b7f7bdf32bbfb6bd9ba57be5e8045fabbd/src/netaddress.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/c4ba79b7f7bdf32bbfb6bd9ba57be5e8045fabbd/src/netaddress.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/netaddress.cpp?ref=c4ba79b7f7bdf32bbfb6bd9ba57be5e8045fabbd",
        "patch": "@@ -229,6 +229,11 @@ bool CNetAddr::IsRFC7343() const\n            (m_addr[3] & 0xF0) == 0x20;\n }\n \n+bool CNetAddr::IsRFC3897() const\n+{\n+    return IsIPv6() && m_addr[0] == 0xFE && (m_addr[1] & 0xC0) == 0xC0;\n+}\n+\n bool CNetAddr::IsHeNet() const\n {\n     return IsIPv6() && HasPrefix(m_addr, std::array<uint8_t, 4>{0x20, 0x01, 0x04, 0x70});\n@@ -304,7 +309,7 @@ bool CNetAddr::IsValid() const\n  */\n bool CNetAddr::IsRoutable() const\n {\n-    return IsValid() && !(IsRFC1918() || IsRFC2544() || IsRFC3927() || IsRFC4862() || IsRFC6598() || IsRFC5737() || (IsRFC4193() && !IsTor()) || IsRFC4843() || IsRFC7343() || IsLocal() || IsInternal());\n+    return IsValid() && !(IsRFC1918() || IsRFC2544() || IsRFC3927() || IsRFC4862() || IsRFC6598() || IsRFC5737() || (IsRFC4193() && !IsTor()) || IsRFC4843() || IsRFC7343() || IsRFC3897() || IsLocal() || IsInternal());\n }\n \n /**"
      },
      {
        "sha": "241aeff5404ddf5a6587265a92361925cf103260",
        "filename": "src/netaddress.h",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/c4ba79b7f7bdf32bbfb6bd9ba57be5e8045fabbd/src/netaddress.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/c4ba79b7f7bdf32bbfb6bd9ba57be5e8045fabbd/src/netaddress.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/netaddress.h?ref=c4ba79b7f7bdf32bbfb6bd9ba57be5e8045fabbd",
        "patch": "@@ -137,6 +137,7 @@ class CNetAddr\n         bool IsRFC4862() const; // IPv6 autoconfig (FE80::/64)\n         bool IsRFC6052() const; // IPv6 well-known prefix for IPv4-embedded address (64:FF9B::/96)\n         bool IsRFC6145() const; // IPv6 IPv4-translated address (::FFFF:0:0:0/96) (actually defined in RFC2765)\n+        bool IsRFC3897() const; // IPv6 Site Local Addresses (deprecated) (FEC0::/10)\n         bool IsHeNet() const;   // IPv6 Hurricane Electric - https://he.net (2001:0470::/36)\n         bool IsTor() const;\n         bool IsLocal() const;"
      },
      {
        "sha": "a125c8cbf225436a241d76f73eecf7bb1d1096dc",
        "filename": "src/test/netbase_tests.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/c4ba79b7f7bdf32bbfb6bd9ba57be5e8045fabbd/src/test/netbase_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/c4ba79b7f7bdf32bbfb6bd9ba57be5e8045fabbd/src/test/netbase_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/netbase_tests.cpp?ref=c4ba79b7f7bdf32bbfb6bd9ba57be5e8045fabbd",
        "patch": "@@ -65,12 +65,14 @@ BOOST_AUTO_TEST_CASE(netbase_properties)\n     BOOST_CHECK(ResolveIP(\"2001:10::\").IsRFC4843());\n     BOOST_CHECK(ResolveIP(\"2001:20::\").IsRFC7343());\n     BOOST_CHECK(ResolveIP(\"FE80::\").IsRFC4862());\n+    BOOST_CHECK(ResolveIP(\"FEC0::\").IsRFC3897());\n     BOOST_CHECK(ResolveIP(\"64:FF9B::\").IsRFC6052());\n     BOOST_CHECK(ResolveIP(\"FD87:D87E:EB43:edb1:8e4:3588:e546:35ca\").IsTor());\n     BOOST_CHECK(ResolveIP(\"127.0.0.1\").IsLocal());\n     BOOST_CHECK(ResolveIP(\"::1\").IsLocal());\n     BOOST_CHECK(ResolveIP(\"8.8.8.8\").IsRoutable());\n     BOOST_CHECK(ResolveIP(\"2001::1\").IsRoutable());\n+    BOOST_CHECK(!ResolveIP(\"FEC0::\").IsRoutable());\n     BOOST_CHECK(ResolveIP(\"127.0.0.1\").IsValid());\n     BOOST_CHECK(CreateInternal(\"FD6B:88C0:8724:edb1:8e4:3588:e546:35ca\").IsInternal());\n     BOOST_CHECK(CreateInternal(\"bar.com\").IsInternal());"
      }
    ]
  }
]