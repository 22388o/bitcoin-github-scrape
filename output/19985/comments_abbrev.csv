naumenkogs,2020-09-21 06:52:04,"I'd say our code doesn't have to implement the full spec, unless it's beneficial for Bitcoin.\nNot sure we get any practical benefit from this change:\n- if someone wants to spam us with fake ipv6 addresses, there's a plenty other ways to do so :)\n- the probability of an old/buggy node relaying these specific unroutable addresses is very low, and the harm is very little\n\nOn the other hand:",https://github.com/bitcoin/bitcoin/pull/19985#issuecomment-695935187,695935187,
laanwj,2020-09-21 14:57:30,"I think it makes sense to consistently reject all local networks here, even the deprecated one. It's a small straightforward code change too.\nCode review ACK  fbab5ed98fc936fe0904b05c1ebefcf8beb30ef6",https://github.com/bitcoin/bitcoin/pull/19985#issuecomment-696170209,696170209,
Saibato,2020-09-21 18:23:20,"Tyi. Not waving in here for now, if that makes sense or not.\n\nBut since [rfc5000](https://tools.ietf.org/html/rfc5000) is not longer the STD1 RFC and deprecated in [rfc7100](https://tools.ietf.org/html/rfc7100 )\n\nI can only recommend to grep and use for standard advice in https://www.rfc-editor.org/standards \n\nThere are only few binding Standad's defined in regard to ipv6,\n\nAFAICS ",https://github.com/bitcoin/bitcoin/pull/19985#issuecomment-696287926,696287926,
practicalswift,2020-09-21 18:52:25,"Concept ACK\n\nRationale:\n* We want to have the same definition of what constitutes a local network as Tor: connecting to `fec0::` is disallowed via Tor due to being a local address\n* We don't want to run the risk of leaking users' local addresses to peers: could theoretically be used for fingerprinting or network reconnaissance?\n* We don't want our peers to be able to feed us addresses th",https://github.com/bitcoin/bitcoin/pull/19985#issuecomment-696303874,696303874,
Saibato,2020-09-21 21:02:56,"We definitely should not use **Link-Local** addresses \n\n```\n   |   10     |\n   |  bits    |         54 bits         |          64 bits           |\n   +----------+-------------------------+----------------------------+\n   |1111111010|           0             |       interface ID         |\n   +----------+-------------------------+----------------------------+\n```\nBut digging furthe",https://github.com/bitcoin/bitcoin/pull/19985#issuecomment-696374835,696374835,
practicalswift,2020-09-22 05:14:25,"@Saibato \n\nOh, TIL! Thanks a lot!\n\n**I was wrong about the current routability status of `fce0::/10` per the current standard.**\n\nTurns out this prefix has had a bumpy road:\n* It was non-routable as of [RFC 3513 (2003)](https://tools.ietf.org/html/rfc3513): ""Routers must not forward any packets with site-local source or destination addresses outside of the site.""\n* It was non-routa",https://github.com/bitcoin/bitcoin/pull/19985#issuecomment-696511911,696511911,
practicalswift,2020-09-22 14:46:23,"It should be noted that `fec0::/10` has always been reserved by the IETF and has thus never been in active Internet use. Any use of `fec0::` in a non-site local context (such as in `ADDR` messages) is thus likely accidental. I think it makes sense to have the same definition as Tor on what constitutes a local address to rule out potential issues such as IP address leaks and node fingerprinting.\n",https://github.com/bitcoin/bitcoin/pull/19985#issuecomment-696769866,696769866,
Saibato,2020-09-22 16:07:54,"@practicalswift\nTime to make some internet history, I find the IETF in contrast to IANA approach always a bit more in favor of an open internet, those address blocking's where more like proposal rfc spam than ever be a standard or close to that\nIn my view the ... attempt to get blocking list into routers and to fragment the internet.\n\nIn roundabout 2007 those source code lines to follow bl",https://github.com/bitcoin/bitcoin/pull/19985#issuecomment-696820428,696820428,
practicalswift,2020-09-22 18:38:29,"> I tend to file a bug trac issue on Tor to decide whom they want to follow, but since u noticed first that we did never blocked those ip ranges. please outpace me in that.\n\nFeel free to open such an issue if you want their position clarified.\n\nPersonally I think Tor is intentionally erring on the side of caution here, and I think we should do that too :)\n\nFWIW you'll occasionally see ",https://github.com/bitcoin/bitcoin/pull/19985#issuecomment-696906123,696906123,
practicalswift,2020-10-11 19:49:11,"An example from mainnet where Bitcoin Core tries to connect to a `fec0::/10` address learned from a mainnet peer.\n\nThe connections is blocked by Tor:\n\n```\nOct 10 12:34:56.000 [warn] Rejecting SOCKS request for anonymous connection to private address fec0::5b4f:fa94:a34b:1731.\n```",https://github.com/bitcoin/bitcoin/pull/19985#issuecomment-706758557,706758557,
fanquake,2020-10-15 03:48:02,@gmaxwell do you have any thoughts/insight here?,https://github.com/bitcoin/bitcoin/pull/19985#issuecomment-708878612,708878612,
laanwj,2020-11-20 04:58:36,"We should either merge this or close #19978 as ""not an issue"". I'd personally err on the side of merging this, though I also get the point that it makes very little difference and we can't and shouldn't maintain a global IPv6 blacklist as part of bitcoin core and make a dayjob out of rule-lawyering IETF specs.",https://github.com/bitcoin/bitcoin/pull/19985#issuecomment-730850861,730850861,
practicalswift,2020-11-20 08:04:06,Agree with @laanwj. FWIW I think this is the only divergence between what we consider to be the public Internet and what Tor considers to be the public Internet :),https://github.com/bitcoin/bitcoin/pull/19985#issuecomment-731006441,731006441,
Saibato,2020-11-20 09:40:03,"> shouldn't maintain a global IPv6 blacklist as part of bitcoin core and make a dayjob out of rule-lawyering IETF specs.\n\nAgree, I also think we can now close #19978,  since Tor will move from 0.4.6.x there codebase in favor of also not exempt those addresses any more and follow the advance of the Internet standardization process.\n\n\nTyi:  https://gitlab.torproject.org/tpo/core/tor/-/mile",https://github.com/bitcoin/bitcoin/pull/19985#issuecomment-731059552,731059552,
Saibato,2020-11-20 17:02:18,"@jonatack  tyi.\n> if it should be done. ???\n\nConcept NACK Bcs. Tor made to _**not block those any longer*_*  a milestone for next releases and probably even backport's, since to block them even in the first place is technical debt on Tor side to not keep it since it was never a standard but just on the wish list of early drafts of censors that was reverted by the standard process.",https://github.com/bitcoin/bitcoin/pull/19985#issuecomment-731287344,731287344,
sipa,2020-11-20 23:08:05,"Should we just implement https://www.iana.org/assignments/ipv6-address-space/ipv6-address-space.xhtml? Only `2000::/3` is global unicast. Other ranges may be allocated in the future of course, but given that only 1.39% of `2000::/3` is even assigned to RIRs, I don't expect that to change any time soon. And the current blacklisted ranges can change too... so perhaps it's easier to just have 1 white",https://github.com/bitcoin/bitcoin/pull/19985#issuecomment-731452926,731452926,
Saibato,2020-11-21 09:04:56,"> Only 2000::/3 is global unicast \n\n@sipa That is what IANA defines, suppose they assign port 8333 solely for router internal use after 2020? Will we then follow that Whitelist too, when RFC's track say;s otherwise?\nWhat IANA assigned or assigns is imo irrelevant to the Internet Standard process and Bitcoin the Internet Money is good advised to only follow the RFC's. \n\nThere is and will ",https://github.com/bitcoin/bitcoin/pull/19985#issuecomment-731551555,731551555,
laanwj,2020-12-21 11:01:57,"> so perhaps it's easier to just have 1 whitelisted range rather than dozens of individually blacklisted ranges.\n\nI really like this idea from a simplicity point of view. I sometimes wonder what other P2P software does with regard to whitelisting/blacklisting subnet ranges for relayed addresses.\nBy the definition it is only relevant to relay *globally routable unicast addresses*, not local o",https://github.com/bitcoin/bitcoin/pull/19985#issuecomment-748913505,748913505,
DrahtBot,2021-06-07 18:11:14,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #22179 by vasild\n\nIf you consider this pull request important, please also help to review the conflicting pull requests.",https://github.com/bitcoin/bitcoin/pull/19985#issuecomment-856152627,856152627,
DrahtBot,2021-07-08 15:40:21,"<!--cf906140f33d8803c4a75a2196329ecb-->\nüêô This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a ""draft"".</sub>",https://github.com/bitcoin/bitcoin/pull/19985#issuecomment-876543728,876543728,
practicalswift,2020-09-21 18:57:55,"Could add `BOOST_CHECK(!ResolveIP(""FEC0::"").IsRoutable());` too? :)",https://github.com/bitcoin/bitcoin/pull/19985#discussion_r492278994,492278994,src/test/netbase_tests.cpp
n-thumann,2020-09-25 15:38:45,"Sure, added ‚úåÔ∏è ",https://github.com/bitcoin/bitcoin/pull/19985#discussion_r495071685,495071685,src/test/netbase_tests.cpp
