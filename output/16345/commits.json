[
  {
    "sha": "a23fe8cf8ab4d58aea29db34329573bdb9741aca",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphMjNmZThjZjhhYjRkNThhZWEyOWRiMzQzMjk1NzNiZGI5NzQxYWNh",
    "commit": {
      "author": {
        "name": "Emil Engler",
        "email": "me@emilengler.com",
        "date": "2019-07-05T16:50:36Z"
      },
      "committer": {
        "name": "Emil Engler",
        "email": "me@emilengler.com",
        "date": "2019-07-10T18:19:47Z"
      },
      "message": "rpc: Add getblockbyheight",
      "tree": {
        "sha": "2486bd5b5f3c1854cf84f54aede92f24e0e45488",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2486bd5b5f3c1854cf84f54aede92f24e0e45488"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a23fe8cf8ab4d58aea29db34329573bdb9741aca",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a23fe8cf8ab4d58aea29db34329573bdb9741aca",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/a23fe8cf8ab4d58aea29db34329573bdb9741aca",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a23fe8cf8ab4d58aea29db34329573bdb9741aca/comments",
    "author": {
      "login": "emilengler",
      "id": 12272949,
      "node_id": "MDQ6VXNlcjEyMjcyOTQ5",
      "avatar_url": "https://avatars.githubusercontent.com/u/12272949?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emilengler",
      "html_url": "https://github.com/emilengler",
      "followers_url": "https://api.github.com/users/emilengler/followers",
      "following_url": "https://api.github.com/users/emilengler/following{/other_user}",
      "gists_url": "https://api.github.com/users/emilengler/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emilengler/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emilengler/subscriptions",
      "organizations_url": "https://api.github.com/users/emilengler/orgs",
      "repos_url": "https://api.github.com/users/emilengler/repos",
      "events_url": "https://api.github.com/users/emilengler/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emilengler/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "emilengler",
      "id": 12272949,
      "node_id": "MDQ6VXNlcjEyMjcyOTQ5",
      "avatar_url": "https://avatars.githubusercontent.com/u/12272949?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emilengler",
      "html_url": "https://github.com/emilengler",
      "followers_url": "https://api.github.com/users/emilengler/followers",
      "following_url": "https://api.github.com/users/emilengler/following{/other_user}",
      "gists_url": "https://api.github.com/users/emilengler/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emilengler/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emilengler/subscriptions",
      "organizations_url": "https://api.github.com/users/emilengler/orgs",
      "repos_url": "https://api.github.com/users/emilengler/repos",
      "events_url": "https://api.github.com/users/emilengler/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emilengler/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "4f378ac30cf66178564620b4a8ca9cad7f031cc3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4f378ac30cf66178564620b4a8ca9cad7f031cc3",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/4f378ac30cf66178564620b4a8ca9cad7f031cc3"
      }
    ],
    "stats": {
      "total": 100,
      "additions": 100,
      "deletions": 0
    },
    "files": [
      {
        "sha": "1d90a49f1d9034c19b0bf08a7f3bafa976305fc9",
        "filename": "src/rpc/blockchain.cpp",
        "status": "modified",
        "additions": 97,
        "deletions": 0,
        "changes": 97,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a23fe8cf8ab4d58aea29db34329573bdb9741aca/src/rpc/blockchain.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a23fe8cf8ab4d58aea29db34329573bdb9741aca/src/rpc/blockchain.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/blockchain.cpp?ref=a23fe8cf8ab4d58aea29db34329573bdb9741aca",
        "patch": "@@ -940,6 +940,102 @@ static UniValue getblock(const JSONRPCRequest& request)\n     return blockToJSON(block, tip, pblockindex, verbosity >= 2);\n }\n \n+static UniValue getblockbyheight(const JSONRPCRequest& request)\n+{\n+    const RPCHelpMan help{\"getblockbyheight\",\n+                \"\\nIf verbosity is 0, returns a string that is serialized, hex-encoded data for block 'height'.\\n\"\n+                \"If verbosity is 1, returns an Object with information about block <height>.\\n\"\n+                \"If verbosity is 2, returns an Object with information about block <height> and information about each transaction. \\n\",\n+                {\n+                    {\"blockheight\", RPCArg::Type::NUM, RPCArg::Optional::NO, \"The block height\"},\n+                    {\"verbosity\", RPCArg::Type::NUM, /* default */ \"1\", \"0 for hex-encoded data, 1 for a json object, and 2 for json object with transaction data\"},\n+                },\n+                {\n+                    RPCResult{\"for verbosity = 0\",\n+            \"\\\"data\\\"             (string) A string that is serialized, hex-encoded data for block 'height'.\\n\"\n+                    },\n+                    RPCResult{\"for verbosity = 1\",\n+            \"{\\n\"\n+            \"  \\\"hash\\\" : \\\"hash\\\",     (string) the block hash (same as provided)\\n\"\n+            \"  \\\"confirmations\\\" : n,   (numeric) The number of confirmations, or -1 if the block is not on the main chain\\n\"\n+            \"  \\\"size\\\" : n,            (numeric) The block size\\n\"\n+            \"  \\\"strippedsize\\\" : n,    (numeric) The block size excluding witness data\\n\"\n+            \"  \\\"weight\\\" : n           (numeric) The block weight as defined in BIP 141\\n\"\n+            \"  \\\"height\\\" : n,          (numeric) The block height or index\\n\"\n+            \"  \\\"version\\\" : n,         (numeric) The block version\\n\"\n+            \"  \\\"versionHex\\\" : \\\"00000000\\\", (string) The block version formatted in hexadecimal\\n\"\n+            \"  \\\"merkleroot\\\" : \\\"xxxx\\\", (string) The merkle root\\n\"\n+            \"  \\\"tx\\\" : [               (array of string) The transaction ids\\n\"\n+            \"     \\\"transactionid\\\"     (string) The transaction id\\n\"\n+            \"     ,...\\n\"\n+            \"  ],\\n\"\n+            \"  \\\"time\\\" : ttt,          (numeric) The block time in seconds since epoch (Jan 1 1970 GMT)\\n\"\n+            \"  \\\"mediantime\\\" : ttt,    (numeric) The median block time in seconds since epoch (Jan 1 1970 GMT)\\n\"\n+            \"  \\\"nonce\\\" : n,           (numeric) The nonce\\n\"\n+            \"  \\\"bits\\\" : \\\"1d00ffff\\\", (string) The bits\\n\"\n+            \"  \\\"difficulty\\\" : x.xxx,  (numeric) The difficulty\\n\"\n+            \"  \\\"chainwork\\\" : \\\"xxxx\\\",  (string) Expected number of hashes required to produce the chain up to this block (in hex)\\n\"\n+            \"  \\\"nTx\\\" : n,             (numeric) The number of transactions in the block.\\n\"\n+            \"  \\\"previousblockhash\\\" : \\\"hash\\\",  (string) The hash of the previous block\\n\"\n+            \"  \\\"nextblockhash\\\" : \\\"hash\\\"       (string) The hash of the next block\\n\"\n+            \"}\\n\"\n+                    },\n+                    RPCResult{\"for verbosity = 2\",\n+            \"{\\n\"\n+            \"  ...,                     Same output as verbosity = 1.\\n\"\n+            \"  \\\"tx\\\" : [               (array of Objects) The transactions in the format of the getrawtransaction RPC. Different from verbosity = 1 \\\"tx\\\" result.\\n\"\n+            \"         ,...\\n\"\n+            \"  ],\\n\"\n+            \"  ,...                     Same output as verbosity = 1.\\n\"\n+            \"}\\n\"\n+                    },\n+                },\n+                RPCExamples{\n+                    HelpExampleCli(\"getblockbyheight\", \"0\")\n+            + HelpExampleRpc(\"getblockbyheight\", \"42\")\n+                },\n+    };\n+\n+    if (request.fHelp || !help.IsValidNumArgs(request.params.size()))\n+        throw std::runtime_error(help.ToString());\n+\n+    int verbosity = 1;\n+    if (!request.params[1].isNull()) {\n+        if(request.params[1].isNum())\n+            verbosity = request.params[1].get_int();\n+        else\n+            verbosity = request.params[1].get_bool() ? 1 : 0;\n+    }\n+\n+    // Check if block exists or is negative\n+    if(::ChainActive().Height() < request.params[0].get_int() || request.params[0].get_int() <= -1)\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Block \" + std::to_string(request.params[0].get_int()) + \" not found\");\n+\n+    CBlock block;\n+    CBlockIndex* pblockindex = ::ChainActive()[request.params[0].get_int()];\n+    uint256 hash(pblockindex->GetBlockHash());\n+    const CBlockIndex* tip;\n+\n+    if (!pblockindex)\n+        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid key\");\n+\n+    {\n+        LOCK(cs_main);\n+        tip = ::ChainActive().Tip();\n+        block = GetBlockChecked(pblockindex);\n+    }\n+\n+    if (verbosity <= 0)\n+    {\n+        CDataStream ssBlock(SER_NETWORK, PROTOCOL_VERSION | RPCSerializationFlags());\n+        ssBlock << block;\n+        std::string strHex = HexStr(ssBlock.begin(), ssBlock.end());\n+        return strHex;\n+    }\n+\n+    return blockToJSON(block, tip, pblockindex, verbosity >= 2);\n+}\n+\n struct CCoinsStats\n {\n     int nHeight;\n@@ -2388,6 +2484,7 @@ static const CRPCCommand commands[] =\n     { \"blockchain\",         \"getbestblockhash\",       &getbestblockhash,       {} },\n     { \"blockchain\",         \"getblockcount\",          &getblockcount,          {} },\n     { \"blockchain\",         \"getblock\",               &getblock,               {\"blockhash\",\"verbosity|verbose\"} },\n+    { \"blockchain\",         \"getblockbyheight\",       &getblockbyheight,       {\"blockheight\",\"verbosity|verbose\"} },\n     { \"blockchain\",         \"getblockhash\",           &getblockhash,           {\"height\"} },\n     { \"blockchain\",         \"getblockheader\",         &getblockheader,         {\"blockhash\",\"verbose\"} },\n     { \"blockchain\",         \"getchaintips\",           &getchaintips,           {} },"
      },
      {
        "sha": "2680a26e6bf321ccceda71e24112650cf528d093",
        "filename": "src/rpc/client.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a23fe8cf8ab4d58aea29db34329573bdb9741aca/src/rpc/client.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a23fe8cf8ab4d58aea29db34329573bdb9741aca/src/rpc/client.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/client.cpp?ref=a23fe8cf8ab4d58aea29db34329573bdb9741aca",
        "patch": "@@ -81,6 +81,9 @@ static const CRPCConvertParam vRPCConvertParams[] =\n     { \"listunspent\", 4, \"query_options\" },\n     { \"getblock\", 1, \"verbosity\" },\n     { \"getblock\", 1, \"verbose\" },\n+    { \"getblockbyheight\", 0, \"blockheight\" },\n+    { \"getblockbyheight\", 1, \"verbosity\" },\n+    { \"getblockbyheight\", 1, \"verbose\" },\n     { \"getblockheader\", 1, \"verbose\" },\n     { \"getchaintxstats\", 0, \"nblocks\" },\n     { \"gettransaction\", 1, \"include_watchonly\" },"
      }
    ]
  },
  {
    "sha": "ac13a74c6e35acfca3906e0856a8f7f5e23a3230",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphYzEzYTc0YzZlMzVhY2ZjYTM5MDZlMDg1NmE4ZjdmNWUyM2EzMjMw",
    "commit": {
      "author": {
        "name": "Emil Engler",
        "email": "me@emilengler.com",
        "date": "2019-07-10T18:17:10Z"
      },
      "committer": {
        "name": "Emil Engler",
        "email": "me@emilengler.com",
        "date": "2019-07-10T18:19:47Z"
      },
      "message": "rpc: Add test for getblockbyheight",
      "tree": {
        "sha": "7e1b820591ead83e5365cd066e0cbbc29b20a7fa",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7e1b820591ead83e5365cd066e0cbbc29b20a7fa"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ac13a74c6e35acfca3906e0856a8f7f5e23a3230",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ac13a74c6e35acfca3906e0856a8f7f5e23a3230",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/ac13a74c6e35acfca3906e0856a8f7f5e23a3230",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ac13a74c6e35acfca3906e0856a8f7f5e23a3230/comments",
    "author": {
      "login": "emilengler",
      "id": 12272949,
      "node_id": "MDQ6VXNlcjEyMjcyOTQ5",
      "avatar_url": "https://avatars.githubusercontent.com/u/12272949?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emilengler",
      "html_url": "https://github.com/emilengler",
      "followers_url": "https://api.github.com/users/emilengler/followers",
      "following_url": "https://api.github.com/users/emilengler/following{/other_user}",
      "gists_url": "https://api.github.com/users/emilengler/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emilengler/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emilengler/subscriptions",
      "organizations_url": "https://api.github.com/users/emilengler/orgs",
      "repos_url": "https://api.github.com/users/emilengler/repos",
      "events_url": "https://api.github.com/users/emilengler/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emilengler/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "emilengler",
      "id": 12272949,
      "node_id": "MDQ6VXNlcjEyMjcyOTQ5",
      "avatar_url": "https://avatars.githubusercontent.com/u/12272949?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emilengler",
      "html_url": "https://github.com/emilengler",
      "followers_url": "https://api.github.com/users/emilengler/followers",
      "following_url": "https://api.github.com/users/emilengler/following{/other_user}",
      "gists_url": "https://api.github.com/users/emilengler/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emilengler/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emilengler/subscriptions",
      "organizations_url": "https://api.github.com/users/emilengler/orgs",
      "repos_url": "https://api.github.com/users/emilengler/repos",
      "events_url": "https://api.github.com/users/emilengler/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emilengler/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "a23fe8cf8ab4d58aea29db34329573bdb9741aca",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a23fe8cf8ab4d58aea29db34329573bdb9741aca",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/a23fe8cf8ab4d58aea29db34329573bdb9741aca"
      }
    ],
    "stats": {
      "total": 9,
      "additions": 9,
      "deletions": 0
    },
    "files": [
      {
        "sha": "e32b5714e372f33f3e95c2ab12b8008e3e85d04c",
        "filename": "test/functional/rpc_blockchain.py",
        "status": "modified",
        "additions": 9,
        "deletions": 0,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ac13a74c6e35acfca3906e0856a8f7f5e23a3230/test/functional/rpc_blockchain.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ac13a74c6e35acfca3906e0856a8f7f5e23a3230/test/functional/rpc_blockchain.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/rpc_blockchain.py?ref=ac13a74c6e35acfca3906e0856a8f7f5e23a3230",
        "patch": "@@ -14,6 +14,7 @@\n     - getchaintxstats\n     - getnetworkhashps\n     - verifychain\n+    - getblockbyheight\n \n Tests correspond to code in rpc/blockchain.cpp.\n \"\"\"\n@@ -62,6 +63,7 @@ def run_test(self):\n         self._test_getnetworkhashps()\n         self._test_stopatheight()\n         self._test_waitforblockheight()\n+        self._test_getblockbyheight()\n         assert self.nodes[0].verifychain(4, 0)\n \n     def mine_chain(self):\n@@ -307,6 +309,13 @@ def assert_waitforheight(height, timeout=2):\n         assert_waitforheight(current_height)\n         assert_waitforheight(current_height + 1)\n \n+    def _test_getblockbyheight(self):\n+        self.log.info(\"Test getblockbyheight\")\n+        node = self.nodes[0]\n+        node.add_p2p_connection(P2PInterface())\n+        assert_equal(node.getblock(node.getblockhash(20)), node.getblockbyheight(20))\n+\n+\n \n if __name__ == '__main__':\n     BlockchainTest().main()"
      }
    ]
  },
  {
    "sha": "373401fa81e43886d43696d1a59cdd933a882b0d",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozNzM0MDFmYTgxZTQzODg2ZDQzNjk2ZDFhNTljZGQ5MzNhODgyYjBk",
    "commit": {
      "author": {
        "name": "Emil Engler",
        "email": "me@emilengler.com",
        "date": "2019-07-12T21:52:51Z"
      },
      "committer": {
        "name": "Emil Engler",
        "email": "me@emilengler.com",
        "date": "2019-07-22T18:59:19Z"
      },
      "message": "rpc: Code Improvement in getblockbyheight\n\nrpc: Fix whitespace in rpc/blockchain.cpp\n\nrpc: getblockbyheight: Remove hash",
      "tree": {
        "sha": "8ceee535a9a2f375b72616c4051429415b56983e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8ceee535a9a2f375b72616c4051429415b56983e"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/373401fa81e43886d43696d1a59cdd933a882b0d",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/373401fa81e43886d43696d1a59cdd933a882b0d",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/373401fa81e43886d43696d1a59cdd933a882b0d",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/373401fa81e43886d43696d1a59cdd933a882b0d/comments",
    "author": {
      "login": "emilengler",
      "id": 12272949,
      "node_id": "MDQ6VXNlcjEyMjcyOTQ5",
      "avatar_url": "https://avatars.githubusercontent.com/u/12272949?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emilengler",
      "html_url": "https://github.com/emilengler",
      "followers_url": "https://api.github.com/users/emilengler/followers",
      "following_url": "https://api.github.com/users/emilengler/following{/other_user}",
      "gists_url": "https://api.github.com/users/emilengler/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emilengler/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emilengler/subscriptions",
      "organizations_url": "https://api.github.com/users/emilengler/orgs",
      "repos_url": "https://api.github.com/users/emilengler/repos",
      "events_url": "https://api.github.com/users/emilengler/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emilengler/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "emilengler",
      "id": 12272949,
      "node_id": "MDQ6VXNlcjEyMjcyOTQ5",
      "avatar_url": "https://avatars.githubusercontent.com/u/12272949?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/emilengler",
      "html_url": "https://github.com/emilengler",
      "followers_url": "https://api.github.com/users/emilengler/followers",
      "following_url": "https://api.github.com/users/emilengler/following{/other_user}",
      "gists_url": "https://api.github.com/users/emilengler/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/emilengler/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/emilengler/subscriptions",
      "organizations_url": "https://api.github.com/users/emilengler/orgs",
      "repos_url": "https://api.github.com/users/emilengler/repos",
      "events_url": "https://api.github.com/users/emilengler/events{/privacy}",
      "received_events_url": "https://api.github.com/users/emilengler/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "ac13a74c6e35acfca3906e0856a8f7f5e23a3230",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ac13a74c6e35acfca3906e0856a8f7f5e23a3230",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/ac13a74c6e35acfca3906e0856a8f7f5e23a3230"
      }
    ],
    "stats": {
      "total": 17,
      "additions": 9,
      "deletions": 8
    },
    "files": [
      {
        "sha": "5e7e0be5ed9085bdb1e60a866c05104743aee68e",
        "filename": "src/rpc/blockchain.cpp",
        "status": "modified",
        "additions": 9,
        "deletions": 8,
        "changes": 17,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/373401fa81e43886d43696d1a59cdd933a882b0d/src/rpc/blockchain.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/373401fa81e43886d43696d1a59cdd933a882b0d/src/rpc/blockchain.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/blockchain.cpp?ref=373401fa81e43886d43696d1a59cdd933a882b0d",
        "patch": "@@ -1008,19 +1008,20 @@ static UniValue getblockbyheight(const JSONRPCRequest& request)\n     }\n \n     // Check if block exists or is negative\n-    if(::ChainActive().Height() < request.params[0].get_int() || request.params[0].get_int() <= -1)\n-        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Block \" + std::to_string(request.params[0].get_int()) + \" not found\");\n+    if(::ChainActive().Height() < request.params[0].get_int() || request.params[0].get_int() <= -1) {\n+        throw JSONRPCError(RPC_INVALID_PARAMETER, \"Block \" + std::to_string(request.params[0].get_int()) + \" not found\");\n+    }\n \n     CBlock block;\n-    CBlockIndex* pblockindex = ::ChainActive()[request.params[0].get_int()];\n-    uint256 hash(pblockindex->GetBlockHash());\n+    CBlockIndex* pblockindex;\n     const CBlockIndex* tip;\n-\n-    if (!pblockindex)\n-        throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid key\");\n-\n     {\n         LOCK(cs_main);\n+        // Get index and hash\n+        pblockindex = ::ChainActive()[request.params[0].get_int()];\n+        if(!pblockindex)\n+            throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid key\");\n+\n         tip = ::ChainActive().Tip();\n         block = GetBlockChecked(pblockindex);\n     }"
      }
    ]
  }
]