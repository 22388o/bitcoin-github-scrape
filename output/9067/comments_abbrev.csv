laanwj,2016-11-04T14:21:36Z,"Looks good to me now, please squash your commits\n",https://github.com/bitcoin/bitcoin/pull/9067#issuecomment-258444056,258444056,
UdjinM6,2016-11-04T15:48:53Z,Squashed into bd0de13\n,https://github.com/bitcoin/bitcoin/pull/9067#issuecomment-258468746,258468746,
laanwj,2016-11-02T19:31:47Z,Please don't combine return and exit here.\n,https://github.com/bitcoin/bitcoin/pull/9067#discussion_r86224503,86224503,src/bitcoin-cli.cpp
UdjinM6,2016-11-02T19:55:51Z,I don't like that kind of code mix either but returning true here instead of exiting early fails with `too few parameters (need at least command)` at `CommandLineRPC` later.\n\n```\n> ./src/bitcoin-cli --version; echo $?\nBitcoin Core RPC client version v0.13.99.0-e6d8192\nerror: too few parameters (need at least command)\n1\n```\n,https://github.com/bitcoin/bitcoin/pull/9067#discussion_r86228889,86228889,src/bitcoin-cli.cpp
laanwj,2016-11-02T19:59:21Z,"I'm sure there's other solutions though. You just need more return values and handle them at the  call site. What about returning a `pair<bool,int>`?\n- `<false, 1>` to exit error\n- `<false, 0>` to exit success\n- `<true,X>` to continue\n",https://github.com/bitcoin/bitcoin/pull/9067#discussion_r86229599,86229599,src/bitcoin-cli.cpp
MarcoFalke,2016-11-02T21:48:30Z,"Also, don't combine 4 separate lines into one with no braces and nothing. Not only does it violate our coding guideline aesthetically; it also introduced really nasty bugs in the past.\n",https://github.com/bitcoin/bitcoin/pull/9067#discussion_r86250326,86250326,src/bitcoin-cli.cpp
UdjinM6,2016-11-02T22:27:24Z,@laanwj I'm not sure if refactoring all nearby code would worth it. Wouldn't it be better to just `exit(0);` here then i.e. to show help by default when no command was provided without any error at all?\n,https://github.com/bitcoin/bitcoin/pull/9067#discussion_r86256809,86256809,src/bitcoin-cli.cpp
laanwj,2016-11-03T08:51:14Z,"Well that's a bit of ""broken window fallacy"" right there. Yes, the current code is a mess, but you're changing it, please leave it in a better state than it is :)\nI certainly think the code is ""worth refactoring"" but that may be more work than you bargained for. \nIn any case I don't like your code change as it looks right now. Exit()-ing in a sub function should be left for urgent shutdown cases",https://github.com/bitcoin/bitcoin/pull/9067#discussion_r86302082,86302082,src/bitcoin-cli.cpp
UdjinM6,2016-11-03T11:48:57Z,"Ok, that makes sense. How about simply returning `int` instead of `bool` from `AppInit*`?\nAnd then\n\n```\n        int ret = AppInitRPC(argc, argv);\n        if (ret != -1)\n            return ret;\n```\n\nThis option seems a bit cleaner to me and should do the trick, see 0f9d7b6.\n",https://github.com/bitcoin/bitcoin/pull/9067#discussion_r86326604,86326604,src/bitcoin-cli.cpp
laanwj,2016-11-04T06:47:49Z,"I don't think the code is very readable this way, there is nothing else that uses `-1` as a success value.\n\nYou could improve it by defining a constant for success value (that happens to be -1, or whatever else), and document that the function returns either a process return code or this magic return success code. \n",https://github.com/bitcoin/bitcoin/pull/9067#discussion_r86495447,86495447,src/bitcoin-cli.cpp
laanwj,2016-11-07T12:01:06Z,EXIT_SUCCESS?\n,https://github.com/bitcoin/bitcoin/pull/9067#discussion_r86761952,86761952,src/qt/bitcoin.cpp
laanwj,2016-11-07T12:01:19Z,EXIT_FAILURE?\n,https://github.com/bitcoin/bitcoin/pull/9067#discussion_r86761983,86761983,src/qt/bitcoin.cpp
UdjinM6,2016-11-07T12:34:53Z,"Technically, yes, but there are few other `return`s/`exit`s in `main()` in src/qt/bitcoin.cpp (not to mention other places) and originally I tried to be consistent with the surrounding code, just fixing some parts to return correct value. Shall we replace all such magic numbers (here?) with constants then?\n",https://github.com/bitcoin/bitcoin/pull/9067#discussion_r86766457,86766457,src/qt/bitcoin.cpp
laanwj,2016-11-07T14:02:16Z,"Dunno, it would make some sense to be consistent, but I don't care deeply. But if you feel like changing it, this PR would be the chance to do it.\n",https://github.com/bitcoin/bitcoin/pull/9067#discussion_r86780201,86780201,src/qt/bitcoin.cpp
UdjinM6,2016-11-07T18:36:49Z,"done, see 4441018\n",https://github.com/bitcoin/bitcoin/pull/9067#discussion_r86838453,86838453,src/qt/bitcoin.cpp
