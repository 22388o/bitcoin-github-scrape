[
  {
    "sha": "1630219d906f592c9258bfe2a0e0c4923df35782",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxNjMwMjE5ZDkwNmY1OTJjOTI1OGJmZTJhMGUwYzQ5MjNkZjM1Nzgy",
    "commit": {
      "author": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2015-01-21T00:23:25Z"
      },
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2015-02-15T16:34:02Z"
      },
      "message": "openssl: abstract out OPENSSL_cleanse\n\nThis makes it easier for us to replace it if desired, since it's now only in\none spot. Also, it avoids the openssl include from allocators.h, which\nessentially forced openssl to be included from every compilation unit.",
      "tree": {
        "sha": "02b0ed9574290873f88bd0ebc1bd0a224c98e5b1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/02b0ed9574290873f88bd0ebc1bd0a224c98e5b1"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1630219d906f592c9258bfe2a0e0c4923df35782",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1630219d906f592c9258bfe2a0e0c4923df35782",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/1630219d906f592c9258bfe2a0e0c4923df35782",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1630219d906f592c9258bfe2a0e0c4923df35782/comments",
    "author": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "a9565863e09a32729bd6ce33f31889099b3d75cb",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a9565863e09a32729bd6ce33f31889099b3d75cb",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/a9565863e09a32729bd6ce33f31889099b3d75cb"
      }
    ],
    "stats": {
      "total": 61,
      "additions": 44,
      "deletions": 17
    },
    "files": [
      {
        "sha": "7644f6b325bf1170cc6b794909a8485a0384c924",
        "filename": "src/Makefile.am",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1630219d906f592c9258bfe2a0e0c4923df35782/src/Makefile.am",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1630219d906f592c9258bfe2a0e0c4923df35782/src/Makefile.am",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.am?ref=1630219d906f592c9258bfe2a0e0c4923df35782",
        "patch": "@@ -123,6 +123,7 @@ BITCOIN_CORE_H = \\\n   script/standard.h \\\n   serialize.h \\\n   streams.h \\\n+  support/cleanse.h \\\n   sync.h \\\n   threadsafety.h \\\n   timedata.h \\\n@@ -268,6 +269,7 @@ libbitcoin_util_a_SOURCES = \\\n   compat/strnlen.cpp \\\n   random.cpp \\\n   rpcprotocol.cpp \\\n+  support/cleanse.cpp \\\n   sync.cpp \\\n   uint256.cpp \\\n   util.cpp \\"
      },
      {
        "sha": "8ffe015b9e5fb1c930d72e0938418220a0914349",
        "filename": "src/allocators.h",
        "status": "modified",
        "additions": 5,
        "deletions": 5,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1630219d906f592c9258bfe2a0e0c4923df35782/src/allocators.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1630219d906f592c9258bfe2a0e0c4923df35782/src/allocators.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/allocators.h?ref=1630219d906f592c9258bfe2a0e0c4923df35782",
        "patch": "@@ -6,6 +6,8 @@\n #ifndef BITCOIN_ALLOCATORS_H\n #define BITCOIN_ALLOCATORS_H\n \n+#include \"support/cleanse.h\"\n+\n #include <map>\n #include <string>\n #include <string.h>\n@@ -14,8 +16,6 @@\n #include <boost/thread/mutex.hpp>\n #include <boost/thread/once.hpp>\n \n-#include <openssl/crypto.h> // for OPENSSL_cleanse()\n-\n /**\n  * Thread-safe class to keep track of locked (ie, non-swappable) memory pages.\n  *\n@@ -174,7 +174,7 @@ void LockObject(const T& t)\n template <typename T>\n void UnlockObject(const T& t)\n {\n-    OPENSSL_cleanse((void*)(&t), sizeof(T));\n+    memory_cleanse((void*)(&t), sizeof(T));\n     LockedPageManager::Instance().UnlockRange((void*)(&t), sizeof(T));\n }\n \n@@ -217,7 +217,7 @@ struct secure_allocator : public std::allocator<T> {\n     void deallocate(T* p, std::size_t n)\n     {\n         if (p != NULL) {\n-            OPENSSL_cleanse(p, sizeof(T) * n);\n+            memory_cleanse(p, sizeof(T) * n);\n             LockedPageManager::Instance().UnlockRange(p, sizeof(T) * n);\n         }\n         std::allocator<T>::deallocate(p, n);\n@@ -254,7 +254,7 @@ struct zero_after_free_allocator : public std::allocator<T> {\n     void deallocate(T* p, std::size_t n)\n     {\n         if (p != NULL)\n-            OPENSSL_cleanse(p, sizeof(T) * n);\n+            memory_cleanse(p, sizeof(T) * n);\n         std::allocator<T>::deallocate(p, n);\n     }\n };"
      },
      {
        "sha": "c8091850560a73065d48d52466199f5c9f0c6acf",
        "filename": "src/base58.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1630219d906f592c9258bfe2a0e0c4923df35782/src/base58.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1630219d906f592c9258bfe2a0e0c4923df35782/src/base58.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/base58.cpp?ref=1630219d906f592c9258bfe2a0e0c4923df35782",
        "patch": "@@ -172,7 +172,7 @@ bool CBase58Data::SetString(const char* psz, unsigned int nVersionBytes)\n     vchData.resize(vchTemp.size() - nVersionBytes);\n     if (!vchData.empty())\n         memcpy(&vchData[0], &vchTemp[nVersionBytes], vchData.size());\n-    OPENSSL_cleanse(&vchTemp[0], vchData.size());\n+    memory_cleanse(&vchTemp[0], vchData.size());\n     return true;\n }\n "
      },
      {
        "sha": "c7f7e2167904ea1ee89704fe58e754cf10ed871c",
        "filename": "src/crypter.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1630219d906f592c9258bfe2a0e0c4923df35782/src/crypter.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1630219d906f592c9258bfe2a0e0c4923df35782/src/crypter.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/crypter.cpp?ref=1630219d906f592c9258bfe2a0e0c4923df35782",
        "patch": "@@ -26,8 +26,8 @@ bool CCrypter::SetKeyFromPassphrase(const SecureString& strKeyData, const std::v\n \n     if (i != (int)WALLET_CRYPTO_KEY_SIZE)\n     {\n-        OPENSSL_cleanse(chKey, sizeof(chKey));\n-        OPENSSL_cleanse(chIV, sizeof(chIV));\n+        memory_cleanse(chKey, sizeof(chKey));\n+        memory_cleanse(chIV, sizeof(chIV));\n         return false;\n     }\n "
      },
      {
        "sha": "8a91498e2e82d2fa94474adc951907412b3beade",
        "filename": "src/crypter.h",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1630219d906f592c9258bfe2a0e0c4923df35782/src/crypter.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1630219d906f592c9258bfe2a0e0c4923df35782/src/crypter.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/crypter.h?ref=1630219d906f592c9258bfe2a0e0c4923df35782",
        "patch": "@@ -82,8 +82,8 @@ class CCrypter\n \n     void CleanKey()\n     {\n-        OPENSSL_cleanse(chKey, sizeof(chKey));\n-        OPENSSL_cleanse(chIV, sizeof(chIV));\n+        memory_cleanse(chKey, sizeof(chKey));\n+        memory_cleanse(chIV, sizeof(chIV));\n         fKeySet = false;\n     }\n "
      },
      {
        "sha": "3246e4b67a1c0def79c64f428390a2e51fca6807",
        "filename": "src/db.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 2,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1630219d906f592c9258bfe2a0e0c4923df35782/src/db.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1630219d906f592c9258bfe2a0e0c4923df35782/src/db.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/db.cpp?ref=1630219d906f592c9258bfe2a0e0c4923df35782",
        "patch": "@@ -21,8 +21,6 @@\n #include <boost/thread.hpp>\n #include <boost/version.hpp>\n \n-#include <openssl/rand.h>\n-\n using namespace std;\n \n "
      },
      {
        "sha": "b69461ad9edbca93a6c11f6e6aa5ecb7d77944dd",
        "filename": "src/qt/paymentrequestplus.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1630219d906f592c9258bfe2a0e0c4923df35782/src/qt/paymentrequestplus.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1630219d906f592c9258bfe2a0e0c4923df35782/src/qt/paymentrequestplus.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/paymentrequestplus.cpp?ref=1630219d906f592c9258bfe2a0e0c4923df35782",
        "patch": "@@ -13,7 +13,6 @@\n \n #include <stdexcept>\n \n-#include <openssl/x509.h>\n #include <openssl/x509_vfy.h>\n \n #include <QDateTime>"
      },
      {
        "sha": "61f8a3415decf682ef56a31c00a90a9e8dd8f7bd",
        "filename": "src/qt/paymentrequestplus.h",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1630219d906f592c9258bfe2a0e0c4923df35782/src/qt/paymentrequestplus.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1630219d906f592c9258bfe2a0e0c4923df35782/src/qt/paymentrequestplus.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/paymentrequestplus.h?ref=1630219d906f592c9258bfe2a0e0c4923df35782",
        "patch": "@@ -9,6 +9,8 @@\n \n #include \"base58.h\"\n \n+#include <openssl/x509.h>\n+\n #include <QByteArray>\n #include <QList>\n #include <QString>"
      },
      {
        "sha": "96ceeb18a4b98c560320dd3260dbea834b20a27e",
        "filename": "src/qt/paymentserver.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1630219d906f592c9258bfe2a0e0c4923df35782/src/qt/paymentserver.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1630219d906f592c9258bfe2a0e0c4923df35782/src/qt/paymentserver.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/paymentserver.cpp?ref=1630219d906f592c9258bfe2a0e0c4923df35782",
        "patch": "@@ -16,7 +16,6 @@\n \n #include <cstdlib>\n \n-#include <openssl/x509.h>\n #include <openssl/x509_vfy.h>\n \n #include <QApplication>"
      },
      {
        "sha": "ae25bee1b71c8cd280d2eb13e1968d079594d45a",
        "filename": "src/random.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 3,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1630219d906f592c9258bfe2a0e0c4923df35782/src/random.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1630219d906f592c9258bfe2a0e0c4923df35782/src/random.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/random.cpp?ref=1630219d906f592c9258bfe2a0e0c4923df35782",
        "patch": "@@ -5,6 +5,7 @@\n \n #include \"random.h\"\n \n+#include \"support/cleanse.h\"\n #ifdef WIN32\n #include \"compat.h\" // for Windows API\n #endif\n@@ -18,7 +19,6 @@\n #include <sys/time.h>\n #endif\n \n-#include <openssl/crypto.h>\n #include <openssl/err.h>\n #include <openssl/rand.h>\n \n@@ -40,7 +40,7 @@ void RandAddSeed()\n     // Seed with CPU performance counter\n     int64_t nCounter = GetPerformanceCounter();\n     RAND_add(&nCounter, sizeof(nCounter), 1.5);\n-    OPENSSL_cleanse((void*)&nCounter, sizeof(nCounter));\n+    memory_cleanse((void*)&nCounter, sizeof(nCounter));\n }\n \n void RandAddSeedPerfmon()\n@@ -70,7 +70,7 @@ void RandAddSeedPerfmon()\n     RegCloseKey(HKEY_PERFORMANCE_DATA);\n     if (ret == ERROR_SUCCESS) {\n         RAND_add(begin_ptr(vData), nSize, nSize / 100.0);\n-        OPENSSL_cleanse(begin_ptr(vData), nSize);\n+        memory_cleanse(begin_ptr(vData), nSize);\n         LogPrint(\"rand\", \"%s: %lu bytes\\n\", __func__, nSize);\n     } else {\n         static bool warned = false; // Warn only once"
      },
      {
        "sha": "9999c2341f78d8f9b0dc0801fea7b4916aca1046",
        "filename": "src/streams.h",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1630219d906f592c9258bfe2a0e0c4923df35782/src/streams.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1630219d906f592c9258bfe2a0e0c4923df35782/src/streams.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/streams.h?ref=1630219d906f592c9258bfe2a0e0c4923df35782",
        "patch": "@@ -16,6 +16,7 @@\n #include <map>\n #include <set>\n #include <stdint.h>\n+#include <stdio.h>\n #include <string>\n #include <string.h>\n #include <utility>"
      },
      {
        "sha": "a2141b244980399ab4d91b351ff809dd43f4efab",
        "filename": "src/support/cleanse.cpp",
        "status": "added",
        "additions": 13,
        "deletions": 0,
        "changes": 13,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1630219d906f592c9258bfe2a0e0c4923df35782/src/support/cleanse.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1630219d906f592c9258bfe2a0e0c4923df35782/src/support/cleanse.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/support/cleanse.cpp?ref=1630219d906f592c9258bfe2a0e0c4923df35782",
        "patch": "@@ -0,0 +1,13 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2015 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"cleanse.h\"\n+\n+#include <openssl/crypto.h>\n+\n+void memory_cleanse(void *ptr, size_t len)\n+{\n+    OPENSSL_cleanse(ptr, len);\n+}"
      },
      {
        "sha": "3e02aa8fd1fe59b7283730635d0774f3119fa0c5",
        "filename": "src/support/cleanse.h",
        "status": "added",
        "additions": 13,
        "deletions": 0,
        "changes": 13,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1630219d906f592c9258bfe2a0e0c4923df35782/src/support/cleanse.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1630219d906f592c9258bfe2a0e0c4923df35782/src/support/cleanse.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/support/cleanse.h?ref=1630219d906f592c9258bfe2a0e0c4923df35782",
        "patch": "@@ -0,0 +1,13 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2015 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_SUPPORT_CLEANSE_H\n+#define BITCOIN_SUPPORT_CLEANSE_H\n+\n+#include <stdlib.h>\n+\n+void memory_cleanse(void *ptr, size_t len);\n+\n+#endif // BITCOIN_SUPPORT_CLEANSE_H"
      }
    ]
  }
]