[
  {
    "sha": "2e7009d67b862cf822a1c70e181de6af659a3096",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyZTcwMDlkNjdiODYyY2Y4MjJhMWM3MGUxODFkZTZhZjY1OWEzMDk2",
    "commit": {
      "author": {
        "name": "Jeff Garzik",
        "email": "jgarzik@bitpay.com",
        "date": "2014-07-29T15:04:46Z"
      },
      "committer": {
        "name": "Jeff Garzik",
        "email": "jgarzik@bitpay.com",
        "date": "2014-07-29T15:04:46Z"
      },
      "message": "Avoid querying DNS seeds, if we have open connections.\n\nThe goal is to increase independence and privacy.",
      "tree": {
        "sha": "602ae29c65803e3658664e43bcefd41b118fa14d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/602ae29c65803e3658664e43bcefd41b118fa14d"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2e7009d67b862cf822a1c70e181de6af659a3096",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2e7009d67b862cf822a1c70e181de6af659a3096",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/2e7009d67b862cf822a1c70e181de6af659a3096",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2e7009d67b862cf822a1c70e181de6af659a3096/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "29203228710de3e180914c1d66f48dd7e41270a0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/29203228710de3e180914c1d66f48dd7e41270a0",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/29203228710de3e180914c1d66f48dd7e41270a0"
      }
    ],
    "stats": {
      "total": 15,
      "additions": 14,
      "deletions": 1
    },
    "files": [
      {
        "sha": "14816f50162004b456127e8c0a4c14e5c692125c",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 1,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/2e7009d67b862cf822a1c70e181de6af659a3096/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/2e7009d67b862cf822a1c70e181de6af659a3096/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=2e7009d67b862cf822a1c70e181de6af659a3096",
        "patch": "@@ -240,7 +240,8 @@ std::string HelpMessage(HelpMessageMode mode)\n     strUsage += \"  -connect=<ip>          \" + _(\"Connect only to the specified node(s)\") + \"\\n\";\n     strUsage += \"  -discover              \" + _(\"Discover own IP address (default: 1 when listening and no -externalip)\") + \"\\n\";\n     strUsage += \"  -dns                   \" + _(\"Allow DNS lookups for -addnode, -seednode and -connect\") + \" \" + _(\"(default: 1)\") + \"\\n\";\n-    strUsage += \"  -dnsseed               \" + _(\"Find peers using DNS lookup (default: 1 unless -connect)\") + \"\\n\";\n+    strUsage += \"  -dnsseed               \" + _(\"Query for peer addresses via DNS lookup, if low on addresses (default: 1 unless -connect)\") + \"\\n\";\n+    strUsage += \"  -forcednsseed          \" + _(\"Always query for peer addresses via DNS lookup (default: 0)\") + \"\\n\";\n     strUsage += \"  -externalip=<ip>       \" + _(\"Specify your own public address\") + \"\\n\";\n     strUsage += \"  -listen                \" + _(\"Accept connections from outside (default: 1 if no -proxy or -connect)\") + \"\\n\";\n     strUsage += \"  -maxconnections=<n>    \" + _(\"Maintain at most <n> connections to peers (default: 125)\") + \"\\n\";"
      },
      {
        "sha": "62124514c8d331f4e2269d7d0269563af093a213",
        "filename": "src/net.cpp",
        "status": "modified",
        "additions": 12,
        "deletions": 0,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/2e7009d67b862cf822a1c70e181de6af659a3096/src/net.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/2e7009d67b862cf822a1c70e181de6af659a3096/src/net.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.cpp?ref=2e7009d67b862cf822a1c70e181de6af659a3096",
        "patch": "@@ -1221,6 +1221,18 @@ void MapPort(bool)\n \n void ThreadDNSAddressSeed()\n {\n+    // goal: only query DNS seeds if address need is acute\n+    if ((addrman.size() > 0) &&\n+        (!GetBoolArg(\"-forcednsseed\", false))) {\n+        MilliSleep(11 * 1000);\n+\n+        LOCK(cs_vNodes);\n+        if (vNodes.size() >= 2) {\n+            LogPrintf(\"P2P peers available. Skipped DNS seeding.\\n\");\n+            return;\n+        }\n+    }\n+\n     const vector<CDNSSeedData> &vSeeds = Params().DNSSeeds();\n     int found = 0;\n "
      }
    ]
  }
]