[
  {
    "sha": "01c28073ba2cae5a53124c7dc7123240b98513ce",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzowMWMyODA3M2JhMmNhZTVhNTMxMjRjN2RjNzEyMzI0MGI5ODUxM2Nl",
    "commit": {
      "author": {
        "name": "Peter Todd",
        "email": "pete@petertodd.org",
        "date": "2014-09-20T16:32:42Z"
      },
      "committer": {
        "name": "Peter Todd",
        "email": "pete@petertodd.org",
        "date": "2014-09-20T17:23:44Z"
      },
      "message": "Add warning about the merkle-tree algorithm duplicate txid flaw\n\nLots of people read the Bitcoin Core codebase to learn more about\ncrypto; better to warn about flaws explicitly so they don't blindly copy\nthe code for other uses and create broken systems.",
      "tree": {
        "sha": "331e58ff43d1736966e21aca2b08c5d4bdc0c081",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/331e58ff43d1736966e21aca2b08c5d4bdc0c081"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/01c28073ba2cae5a53124c7dc7123240b98513ce",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGrBAABCACVBQJUHbghXhSAAAAAABUAQGJsb2NraGFzaEBiaXRjb2luLm9yZzAw\nMDAwMDAwMDAwMDAwMDAxMjM2N2QzODVhZDExMzU4YTRhMWVlZTg2Y2Y4ZWJlMDZh\nNzZhZGQzNmRmYjQ2MjIvFIAAAAAAFQARcGthLWFkZHJlc3NAZ251cGcub3JncGV0\nZUBwZXRlcnRvZC5vcmcACgkQJIFAPaXwkfvgdQf+KYcS4SS0fPlzHCEOU0d95e8b\nTd/aoMNXYvTiZZIZncC2D0PwZEcxmEyM55q9+6YWhPEgLlcfMqOwr4jT0A7Lq+j5\nQZ6rwp+Ya7PjxOeoleH3gXZA3ejO/8WOJHeZNt1TTiB7LhF9wrWZ4ByM7kIMxqLu\nrs/nO8nykouQtN6Jajrt8OqCl3Y1hd41pRjWxEcBJQw2GU+wTewfssXv6ha111LT\nESunMVpWtbmkxrp+YiJ80NHshCNmrcZmTtMQvaCYYlNsFAE7Eh9A60fA4hddANFq\n2RuQc+CfT6F8exbwSZxMftwYchqDA9lv0p+HV5yLIGa8raN4Md16ls3BwM7UCw==\n=xy+C\n-----END PGP SIGNATURE-----",
        "payload": "tree 331e58ff43d1736966e21aca2b08c5d4bdc0c081\nparent 25308337d659108e3320257fb6c1c16d5fe24aa9\nauthor Peter Todd <pete@petertodd.org> 1411230762 -0400\ncommitter Peter Todd <pete@petertodd.org> 1411233824 -0400\n\nAdd warning about the merkle-tree algorithm duplicate txid flaw\n\nLots of people read the Bitcoin Core codebase to learn more about\ncrypto; better to warn about flaws explicitly so they don't blindly copy\nthe code for other uses and create broken systems.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/01c28073ba2cae5a53124c7dc7123240b98513ce",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/01c28073ba2cae5a53124c7dc7123240b98513ce",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/01c28073ba2cae5a53124c7dc7123240b98513ce/comments",
    "author": {
      "login": "petertodd",
      "id": 7042,
      "node_id": "MDQ6VXNlcjcwNDI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7042?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/petertodd",
      "html_url": "https://github.com/petertodd",
      "followers_url": "https://api.github.com/users/petertodd/followers",
      "following_url": "https://api.github.com/users/petertodd/following{/other_user}",
      "gists_url": "https://api.github.com/users/petertodd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/petertodd/subscriptions",
      "organizations_url": "https://api.github.com/users/petertodd/orgs",
      "repos_url": "https://api.github.com/users/petertodd/repos",
      "events_url": "https://api.github.com/users/petertodd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/petertodd/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "petertodd",
      "id": 7042,
      "node_id": "MDQ6VXNlcjcwNDI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7042?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/petertodd",
      "html_url": "https://github.com/petertodd",
      "followers_url": "https://api.github.com/users/petertodd/followers",
      "following_url": "https://api.github.com/users/petertodd/following{/other_user}",
      "gists_url": "https://api.github.com/users/petertodd/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/petertodd/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/petertodd/subscriptions",
      "organizations_url": "https://api.github.com/users/petertodd/orgs",
      "repos_url": "https://api.github.com/users/petertodd/repos",
      "events_url": "https://api.github.com/users/petertodd/events{/privacy}",
      "received_events_url": "https://api.github.com/users/petertodd/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "25308337d659108e3320257fb6c1c16d5fe24aa9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/25308337d659108e3320257fb6c1c16d5fe24aa9",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/25308337d659108e3320257fb6c1c16d5fe24aa9"
      }
    ],
    "stats": {
      "total": 7,
      "additions": 7,
      "deletions": 0
    },
    "files": [
      {
        "sha": "e52327ba8e7d453b83bc4320ff5bb7cee5af33c5",
        "filename": "src/core.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 0,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/01c28073ba2cae5a53124c7dc7123240b98513ce/src/core.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/01c28073ba2cae5a53124c7dc7123240b98513ce/src/core.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/core.cpp?ref=01c28073ba2cae5a53124c7dc7123240b98513ce",
        "patch": "@@ -226,6 +226,13 @@ uint256 CBlockHeader::GetHash() const\n \n uint256 CBlock::BuildMerkleTree() const\n {\n+    // WARNING! If you're reading this because you're learning about crypto\n+    // and/or designing a new system that will use merkle trees, keep in mind\n+    // that the following merkle tree algorithm has a serious flaw related to\n+    // duplicate txids, resulting in a vulnerability. (CVE-2012-2459) Bitcoin\n+    // has since worked around the flaw, but for new applications you should\n+    // use something different; don't just copy-and-paste this code without\n+    // understanding the problem first.\n     vMerkleTree.clear();\n     BOOST_FOREACH(const CTransaction& tx, vtx)\n         vMerkleTree.push_back(tx.GetHash());"
      }
    ]
  }
]