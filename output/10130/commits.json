[
  {
    "sha": "eb66bf9bdd5ae20c546314eb2c494ac09929970f",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplYjY2YmY5YmRkNWFlMjBjNTQ2MzE0ZWIyYzQ5NGFjMDk5Mjk5NzBm",
    "commit": {
      "author": {
        "name": "Awemany",
        "email": "awemany@protonmail.com",
        "date": "2017-03-28T12:52:59Z"
      },
      "committer": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2017-03-30T19:35:24Z"
      },
      "message": "bitcoin-tx: Fix missing range check\n\nThe number of arguments is not checked MutateTxAddOutAddr(..), meaning\nthat\n\n> ./bitcoin-tx -create outaddr=\n\naccessed the vStrInputParts vector beyond its bounds.\n\nThis also includes work by jnewbery to check the inputs for\nMutateTxAddPubKey()",
      "tree": {
        "sha": "81cd3c48c008fffb42e3722e79ccb7668fb9aea4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/81cd3c48c008fffb42e3722e79ccb7668fb9aea4"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/eb66bf9bdd5ae20c546314eb2c494ac09929970f",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/eb66bf9bdd5ae20c546314eb2c494ac09929970f",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/eb66bf9bdd5ae20c546314eb2c494ac09929970f",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/eb66bf9bdd5ae20c546314eb2c494ac09929970f/comments",
    "author": {
      "login": "awemany",
      "id": 13838274,
      "node_id": "MDQ6VXNlcjEzODM4Mjc0",
      "avatar_url": "https://avatars.githubusercontent.com/u/13838274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/awemany",
      "html_url": "https://github.com/awemany",
      "followers_url": "https://api.github.com/users/awemany/followers",
      "following_url": "https://api.github.com/users/awemany/following{/other_user}",
      "gists_url": "https://api.github.com/users/awemany/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/awemany/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/awemany/subscriptions",
      "organizations_url": "https://api.github.com/users/awemany/orgs",
      "repos_url": "https://api.github.com/users/awemany/repos",
      "events_url": "https://api.github.com/users/awemany/events{/privacy}",
      "received_events_url": "https://api.github.com/users/awemany/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "0b9fb682890b8fe10cec54072b809a5efe57d33d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0b9fb682890b8fe10cec54072b809a5efe57d33d",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/0b9fb682890b8fe10cec54072b809a5efe57d33d"
      }
    ],
    "stats": {
      "total": 6,
      "additions": 6,
      "deletions": 0
    },
    "files": [
      {
        "sha": "83b855cbcfdc9fcd0722bfb939936c6aadd396d5",
        "filename": "src/bitcoin-tx.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 0,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/eb66bf9bdd5ae20c546314eb2c494ac09929970f/src/bitcoin-tx.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/eb66bf9bdd5ae20c546314eb2c494ac09929970f/src/bitcoin-tx.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoin-tx.cpp?ref=eb66bf9bdd5ae20c546314eb2c494ac09929970f",
        "patch": "@@ -242,6 +242,9 @@ static void MutateTxAddOutAddr(CMutableTransaction& tx, const std::string& strIn\n     std::vector<std::string> vStrInputParts;\n     boost::split(vStrInputParts, strInput, boost::is_any_of(\":\"));\n \n+    if (vStrInputParts.size() != 2)\n+        throw std::runtime_error(\"TX output missing or too many separators\");\n+\n     // Extract and validate VALUE\n     CAmount value = ExtractAndValidateValue(vStrInputParts[0]);\n \n@@ -264,6 +267,9 @@ static void MutateTxAddOutPubKey(CMutableTransaction& tx, const std::string& str\n     std::vector<std::string> vStrInputParts;\n     boost::split(vStrInputParts, strInput, boost::is_any_of(\":\"));\n \n+    if (vStrInputParts.size() < 2 || vStrInputParts.size() > 3)\n+        throw std::runtime_error(\"TX output missing or too many separators\");\n+\n     // Extract and validate VALUE\n     CAmount value = ExtractAndValidateValue(vStrInputParts[0]);\n "
      }
    ]
  },
  {
    "sha": "21704f6334d2a4bd140c6e3260c4bfa3f3157bad",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyMTcwNGY2MzM0ZDJhNGJkMTQwYzZlMzI2MGM0YmZhM2YzMTU3YmFk",
    "commit": {
      "author": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2017-03-29T14:20:10Z"
      },
      "committer": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2017-03-30T20:37:53Z"
      },
      "message": "Check stderr when testing bitcoin-tx",
      "tree": {
        "sha": "b77e55009e0e648b16c007fb077250088886777b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b77e55009e0e648b16c007fb077250088886777b"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/21704f6334d2a4bd140c6e3260c4bfa3f3157bad",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/21704f6334d2a4bd140c6e3260c4bfa3f3157bad",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/21704f6334d2a4bd140c6e3260c4bfa3f3157bad",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/21704f6334d2a4bd140c6e3260c4bfa3f3157bad/comments",
    "author": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "eb66bf9bdd5ae20c546314eb2c494ac09929970f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/eb66bf9bdd5ae20c546314eb2c494ac09929970f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/eb66bf9bdd5ae20c546314eb2c494ac09929970f"
      }
    ],
    "stats": {
      "total": 16,
      "additions": 16,
      "deletions": 0
    },
    "files": [
      {
        "sha": "b17cf77ae312c434ca84a732d2bd8923ee03c223",
        "filename": "test/util/bctest.py",
        "status": "modified",
        "additions": 12,
        "deletions": 0,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/21704f6334d2a4bd140c6e3260c4bfa3f3157bad/test/util/bctest.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/21704f6334d2a4bd140c6e3260c4bfa3f3157bad/test/util/bctest.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/util/bctest.py?ref=21704f6334d2a4bd140c6e3260c4bfa3f3157bad",
        "patch": "@@ -102,6 +102,18 @@ def bctest(testDir, testObj, buildenv):\n         logging.error(\"Return code mismatch for \" + outputFn)\n         raise Exception\n \n+    if \"error_txt\" in testObj:\n+        want_error = testObj[\"error_txt\"]\n+        # Compare error text\n+        # TODO: ideally, we'd compare the strings exactly and also assert\n+        # That stderr is empty if no errors are expected. However, bitcoin-tx\n+        # emits DISPLAY errors when running as a windows application on\n+        # linux through wine. Just assert that the expected error text appears\n+        # somewhere in stderr.\n+        if want_error not in outs[1]:\n+            logging.error(\"Error mismatch:\\n\" + \"Expected: \" + want_error + \"\\nReceived: \" + outs[1].rstrip())\n+            raise Exception\n+\n def bctester(testDir, input_basename, buildenv):\n     \"\"\" Loads and parses the input file, runs all tests and reports results\"\"\"\n     input_filename = testDir + \"/\" + input_basename"
      },
      {
        "sha": "2a0a8f1a99d8338977709e84e1cb0ca84b00a465",
        "filename": "test/util/data/bitcoin-util-test.json",
        "status": "modified",
        "additions": 4,
        "deletions": 0,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/21704f6334d2a4bd140c6e3260c4bfa3f3157bad/test/util/data/bitcoin-util-test.json",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/21704f6334d2a4bd140c6e3260c4bfa3f3157bad/test/util/data/bitcoin-util-test.json",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/util/data/bitcoin-util-test.json?ref=21704f6334d2a4bd140c6e3260c4bfa3f3157bad",
        "patch": "@@ -42,6 +42,7 @@\n     \"args\": [\"-\", \"delin=31\"],\n     \"input\": \"tx394b54bb.hex\",\n     \"return_code\": 1,\n+    \"error_txt\": \"error: Invalid TX input index '31'\",\n     \"description\": \"Attempts to delete an input with a bad index from a transaction. Expected to fail.\"\n   },\n   { \"exec\": \"./bitcoin-tx\",\n@@ -60,6 +61,7 @@\n     \"args\": [\"-\", \"delout=2\"],\n     \"input\": \"tx394b54bb.hex\",\n     \"return_code\": 1,\n+    \"error_txt\": \"error: Invalid TX output index '2'\",\n     \"description\": \"Attempts to delete an output with a bad index from a transaction. Expected to fail.\"\n   },\n   { \"exec\": \"./bitcoin-tx\",\n@@ -233,6 +235,7 @@\n      \"in=5897de6bd6027a475eadd57019d4e6872c396d0716c4875a5f1a6fcfdf385c1f:0\",\n      \"outdata=4:badhexdata\"],\n     \"return_code\": 1,\n+    \"error_txt\": \"error: invalid TX output data\",\n     \"description\": \"Attempts to create a new transaction with one input and an output with malformed hex data. Expected to fail\"\n   },\n   { \"exec\": \"./bitcoin-tx\",\n@@ -241,6 +244,7 @@\n      \"in=5897de6bd6027a475eadd57019d4e6872c396d0716c4875a5f1a6fcfdf385c1f:0\",\n      \"outdata=badhexdata\"],\n     \"return_code\": 1,\n+    \"error_txt\": \"error: invalid TX output data\",\n     \"description\": \"Attempts to create a new transaction with one input and an output with no value and malformed hex data. Expected to fail\"\n   },\n   { \"exec\": \"./bitcoin-tx\","
      }
    ]
  },
  {
    "sha": "19ecd1e2e13514c8a92a2a4337c2568c3d5d13e5",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxOWVjZDFlMmUxMzUxNGM4YTkyYTJhNDMzN2MyNTY4YzNkNWQxM2U1",
    "commit": {
      "author": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2017-03-29T14:53:11Z"
      },
      "committer": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2017-03-30T20:37:53Z"
      },
      "message": "Add tests for bitcoin-tx input checking",
      "tree": {
        "sha": "2fb293d4a6732d783a9ffc08b11f079d5a0ac59e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2fb293d4a6732d783a9ffc08b11f079d5a0ac59e"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/19ecd1e2e13514c8a92a2a4337c2568c3d5d13e5",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/19ecd1e2e13514c8a92a2a4337c2568c3d5d13e5",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/19ecd1e2e13514c8a92a2a4337c2568c3d5d13e5",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/19ecd1e2e13514c8a92a2a4337c2568c3d5d13e5/comments",
    "author": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "21704f6334d2a4bd140c6e3260c4bfa3f3157bad",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/21704f6334d2a4bd140c6e3260c4bfa3f3157bad",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/21704f6334d2a4bd140c6e3260c4bfa3f3157bad"
      }
    ],
    "stats": {
      "total": 32,
      "additions": 32,
      "deletions": 0
    },
    "files": [
      {
        "sha": "b61a4f7f8f9469d1c32c2a4fdfadd5012d3a8f01",
        "filename": "test/util/data/bitcoin-util-test.json",
        "status": "modified",
        "additions": 32,
        "deletions": 0,
        "changes": 32,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/19ecd1e2e13514c8a92a2a4337c2568c3d5d13e5/test/util/data/bitcoin-util-test.json",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/19ecd1e2e13514c8a92a2a4337c2568c3d5d13e5/test/util/data/bitcoin-util-test.json",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/util/data/bitcoin-util-test.json?ref=19ecd1e2e13514c8a92a2a4337c2568c3d5d13e5",
        "patch": "@@ -76,6 +76,38 @@\n     \"output_cmp\": \"tt-locktime317000-out.json\",\n     \"description\": \"Adds an nlocktime to a transaction (output in json)\"\n   },\n+  { \"exec\": \"./bitcoin-tx\",\n+    \"args\":\n+    [\"-create\",\n+     \"outaddr=1\"],\n+    \"return_code\": 1,\n+    \"error_txt\": \"error: TX output missing or too many separators\",\n+    \"description\": \"Malformed outaddr argument (no address specified). Expected to fail.\"\n+  },\n+  { \"exec\": \"./bitcoin-tx\",\n+    \"args\":\n+    [\"-create\",\n+     \"outaddr=1:13tuJJDR2RgArmgfv6JScSdreahzgc4T6o:garbage\"],\n+    \"return_code\": 1,\n+    \"error_txt\": \"error: TX output missing or too many separators\",\n+    \"description\": \"Malformed outaddr argument (too many separators). Expected to fail.\"\n+  },\n+  { \"exec\": \"./bitcoin-tx\",\n+    \"args\":\n+    [\"-create\",\n+     \"outpubkey=0\"],\n+    \"return_code\": 1,\n+    \"error_txt\": \"error: TX output missing or too many separators\",\n+    \"description\": \"Malformed outpubkey argument (no pubkey specified). Expected to fail.\"\n+  },\n+  { \"exec\": \"./bitcoin-tx\",\n+    \"args\":\n+    [\"-create\",\n+     \"outpubkey=0:02a5613bd857b7048924264d1e70e08fb2a7e6527d32b7ab1bb993ac59964ff397:W:non53nse\"],\n+    \"return_code\": 1,\n+    \"error_txt\": \"error: TX output missing or too many separators\",\n+    \"description\": \"Malformed outpubkey argument (too many separators). Expected to fail.\"\n+  },\n   { \"exec\": \"./bitcoin-tx\",\n     \"args\":\n     [\"-create\","
      }
    ]
  }
]