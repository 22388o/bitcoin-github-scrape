[
  {
    "sha": "13292884f2f971f4279833d39dd7b7144bb2d265",
    "node_id": "C_kwDOABII59oAKDEzMjkyODg0ZjJmOTcxZjQyNzk4MzNkMzlkZDdiNzE0NGJiMmQyNjU",
    "commit": {
      "author": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-11-16T02:01:38Z"
      },
      "committer": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-11-27T01:56:04Z"
      },
      "message": "build: support LTO in depends",
      "tree": {
        "sha": "7751e436d75d950ee4bfb4a02b46a2f3efa958e7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7751e436d75d950ee4bfb4a02b46a2f3efa958e7"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/13292884f2f971f4279833d39dd7b7144bb2d265",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz7FuIclQ9n+pXlWPLuufXMCVJsEFAmGhkDYACgkQLuufXMCV\nJsFelRAAhOxBkvkmru3/lF6k7oE0OBFtCz/bFK2fu9LdGJfFy4knfgzTjayOo1xE\n7twv0C0db0vviDrKVz4sfzFsvbCGL5frujTY4aXcuII3DkPub3wTKz3HcYzw9s1P\n1MUo4038vR33jD7cpxbv+WuEpe5H/g7HxyCbwkSH3gsDZzSycKgGdq6Tbe7wGGSr\nYfThbASwno3iIcxN4PBj7LbU28GPgE8qM70Prn/arAlL5nxlYIcgk4JyEgeFC3C0\nfzxMIwZUzo5RXKWp8owpb8y2X6JpUu1asgx6fWNr8d4fcxPS4KxEsNfugc6S4TR6\nNvH6q/VKucI4LeUbPO5nE58BERmMoIuSmzqWG1asMDlBrqAULKjqsoPyOUbrrBUu\npXZIaF77CBmxmcB7M8a2B6hIOv3TDJG/g9tmJ/pbJiBiLe+BkhsusJKLVF4GpfiF\no6v0rq8asa2Vd2eJmCLg0KwQ19+DsGgCKSKo/LMrnnqd9+rv9ysamgdlnmFzbeFG\nsJEUiR0CDYBJX8ZH9kwuGrwk36UtAlpjIXt8KNY2+hd86UC2bC869fLvCSPV9OFq\nwu+sWGvWkg5M9KZWGB5wdEsLlLmxXNJEdPu+7BULts6klgTAJWMRejLc6orPpwX4\nagwTc99MKSMkP8+zWe9vCE5Wp0htEwRlAqEclKk1fPGnvemecL4=\n=AlET\n-----END PGP SIGNATURE-----",
        "payload": "tree 7751e436d75d950ee4bfb4a02b46a2f3efa958e7\nparent 111c3e06b35b7867f2e0f740e988f648ac6c325d\nauthor fanquake <fanquake@gmail.com> 1637028098 +0800\ncommitter fanquake <fanquake@gmail.com> 1637978164 +0800\n\nbuild: support LTO in depends\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/13292884f2f971f4279833d39dd7b7144bb2d265",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/13292884f2f971f4279833d39dd7b7144bb2d265",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/13292884f2f971f4279833d39dd7b7144bb2d265/comments",
    "author": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "111c3e06b35b7867f2e0f740e988f648ac6c325d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/111c3e06b35b7867f2e0f740e988f648ac6c325d",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/111c3e06b35b7867f2e0f740e988f648ac6c325d"
      }
    ],
    "stats": {
      "total": 35,
      "additions": 35,
      "deletions": 0
    },
    "files": [
      {
        "sha": "c0f88289272638594b02cfecb1442919905fbd63",
        "filename": "depends/Makefile",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/13292884f2f971f4279833d39dd7b7144bb2d265/depends/Makefile",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/13292884f2f971f4279833d39dd7b7144bb2d265/depends/Makefile",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/Makefile?ref=13292884f2f971f4279833d39dd7b7144bb2d265",
        "patch": "@@ -41,6 +41,7 @@ NO_ZMQ ?=\n NO_UPNP ?=\n NO_NATPMP ?=\n MULTIPROCESS ?=\n+LTO ?=\n FALLBACK_DOWNLOAD_PATH ?= https://bitcoincore.org/depends-sources\n \n BUILD = $(shell ./config.guess)\n@@ -234,6 +235,7 @@ $(host_prefix)/share/config.site : config.site.in $(host_prefix)/.stamp_$(final_\n             -e 's|@no_upnp@|$(NO_UPNP)|' \\\n             -e 's|@no_natpmp@|$(NO_NATPMP)|' \\\n             -e 's|@multiprocess@|$(MULTIPROCESS)|' \\\n+            -e 's|@lto@|$(LTO)|' \\\n             -e 's|@debug@|$(DEBUG)|' \\\n             $< > $@\n \t$(AT)touch $@"
      },
      {
        "sha": "30cfb162d278fd3a6666a9d8ad0812dc4ba5e471",
        "filename": "depends/README.md",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/13292884f2f971f4279833d39dd7b7144bb2d265/depends/README.md",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/13292884f2f971f4279833d39dd7b7144bb2d265/depends/README.md",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/README.md?ref=13292884f2f971f4279833d39dd7b7144bb2d265",
        "patch": "@@ -113,6 +113,7 @@ The following can be set when running make: `make FOO=bar`\n - `FORCE_USE_SYSTEM_CLANG`: (EXPERTS ONLY) When cross-compiling for macOS, use Clang found in the\n   system's `$PATH` rather than the default prebuilt release of Clang\n   from llvm.org. Clang 8 or later is required.\n+- `LTO`: Use LTO when building packages.\n \n If some packages are not built, for example `make NO_WALLET=1`, the appropriate\n options will be passed to bitcoin's configure. In this case, `--disable-wallet`."
      },
      {
        "sha": "d223a691703afc8dd2b593d2df36aa27ed3716cb",
        "filename": "depends/config.site.in",
        "status": "modified",
        "additions": 4,
        "deletions": 0,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/13292884f2f971f4279833d39dd7b7144bb2d265/depends/config.site.in",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/13292884f2f971f4279833d39dd7b7144bb2d265/depends/config.site.in",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/config.site.in?ref=13292884f2f971f4279833d39dd7b7144bb2d265",
        "patch": "@@ -74,6 +74,10 @@ if test \"@host_os@\" = darwin; then\n   BREW=no\n fi\n \n+if test -z \"$enable_lto\" && test -n \"@lto@\"; then\n+  enable_lto=yes\n+fi\n+\n PATH=\"${depends_prefix}/native/bin:${PATH}\"\n PKG_CONFIG=\"$(which pkg-config) --static\"\n "
      },
      {
        "sha": "9029355460794c255a8647a2513e85673bfad3f8",
        "filename": "depends/hosts/android.mk",
        "status": "modified",
        "additions": 6,
        "deletions": 0,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/13292884f2f971f4279833d39dd7b7144bb2d265/depends/hosts/android.mk",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/13292884f2f971f4279833d39dd7b7144bb2d265/depends/hosts/android.mk",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/hosts/android.mk?ref=13292884f2f971f4279833d39dd7b7144bb2d265",
        "patch": "@@ -5,6 +5,12 @@ else\n android_CXX=$(ANDROID_TOOLCHAIN_BIN)/$(HOST)$(ANDROID_API_LEVEL)-clang++\n android_CC=$(ANDROID_TOOLCHAIN_BIN)/$(HOST)$(ANDROID_API_LEVEL)-clang\n endif\n+\n+ifneq ($(LTO),)\n+android_CFLAGS += -flto\n+android_LDFLAGS += -flto\n+endif\n+\n android_AR=$(ANDROID_TOOLCHAIN_BIN)/llvm-ar\n android_RANLIB=$(ANDROID_TOOLCHAIN_BIN)/llvm-ranlib\n "
      },
      {
        "sha": "074da26795278dde2a8af143fe4cc853394113e2",
        "filename": "depends/hosts/darwin.mk",
        "status": "modified",
        "additions": 6,
        "deletions": 0,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/13292884f2f971f4279833d39dd7b7144bb2d265/depends/hosts/darwin.mk",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/13292884f2f971f4279833d39dd7b7144bb2d265/depends/hosts/darwin.mk",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/hosts/darwin.mk?ref=13292884f2f971f4279833d39dd7b7144bb2d265",
        "patch": "@@ -110,6 +110,12 @@ darwin_CXX=env -u C_INCLUDE_PATH -u CPLUS_INCLUDE_PATH \\\n                -Xclang -internal-externc-isystem$(OSX_SDK)/usr/include\n \n darwin_CFLAGS=-pipe\n+\n+ifneq ($(LTO),)\n+darwin_CFLAGS += -flto\n+darwin_LDFLAGS += -flto\n+endif\n+\n darwin_CXXFLAGS=$(darwin_CFLAGS)\n \n darwin_release_CFLAGS=-O2"
      },
      {
        "sha": "5322520e6f605dcdd14adf97caa7bfa08417dc5c",
        "filename": "depends/hosts/linux.mk",
        "status": "modified",
        "additions": 6,
        "deletions": 0,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/13292884f2f971f4279833d39dd7b7144bb2d265/depends/hosts/linux.mk",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/13292884f2f971f4279833d39dd7b7144bb2d265/depends/hosts/linux.mk",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/hosts/linux.mk?ref=13292884f2f971f4279833d39dd7b7144bb2d265",
        "patch": "@@ -1,4 +1,10 @@\n linux_CFLAGS=-pipe\n+\n+ifneq ($(LTO),)\n+linux_CFLAGS += -flto\n+linux_LDFLAGS += -flto\n+endif\n+\n linux_CXXFLAGS=$(linux_CFLAGS)\n \n linux_release_CFLAGS=-O2"
      },
      {
        "sha": "454b6f48dd6a5745ede40c5155c300d91b2302ee",
        "filename": "depends/hosts/mingw32.mk",
        "status": "modified",
        "additions": 6,
        "deletions": 0,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/13292884f2f971f4279833d39dd7b7144bb2d265/depends/hosts/mingw32.mk",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/13292884f2f971f4279833d39dd7b7144bb2d265/depends/hosts/mingw32.mk",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/hosts/mingw32.mk?ref=13292884f2f971f4279833d39dd7b7144bb2d265",
        "patch": "@@ -1,4 +1,10 @@\n mingw32_CFLAGS=-pipe\n+\n+ifneq ($(LTO),)\n+mingw32_CFLAGS += -flto\n+mingw32_LDFLAGS += -flto\n+endif\n+\n mingw32_CXXFLAGS=$(mingw32_CFLAGS)\n \n mingw32_release_CFLAGS=-O2"
      },
      {
        "sha": "2919375adc1ccefd0f890a078ec512f7452a4a04",
        "filename": "depends/packages/qt.mk",
        "status": "modified",
        "additions": 4,
        "deletions": 0,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/13292884f2f971f4279833d39dd7b7144bb2d265/depends/packages/qt.mk",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/13292884f2f971f4279833d39dd7b7144bb2d265/depends/packages/qt.mk",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/packages/qt.mk?ref=13292884f2f971f4279833d39dd7b7144bb2d265",
        "patch": "@@ -113,6 +113,10 @@ $(package)_config_opts += -no-feature-vnc\n $(package)_config_opts += -no-feature-wizard\n $(package)_config_opts += -no-feature-xml\n \n+ifneq ($(LTO),)\n+$(package)_config_opts += -ltcg\n+endif\n+\n $(package)_config_opts_darwin = -no-dbus\n $(package)_config_opts_darwin += -no-opengl\n $(package)_config_opts_darwin += -pch"
      }
    ]
  }
]