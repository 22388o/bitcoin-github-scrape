[
  {
    "sha": "6666c828e072a5e99ea0c16394ca3e5b9de07409",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2NjY2YzgyOGUwNzJhNWU5OWVhMGMxNjM5NGNhM2U1YjlkZTA3NDA5",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-05-11T00:12:25Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-05-11T18:36:06Z"
      },
      "message": "fuzz: Give CNode ownership to ConnmanTestMsg in process_message fuzz harness",
      "tree": {
        "sha": "edb53f6b4bb1559f6b13682edce9ff3e264fcadd",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/edb53f6b4bb1559f6b13682edce9ff3e264fcadd"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6666c828e072a5e99ea0c16394ca3e5b9de07409",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUhQvAv/d65Nz/vWy8AyLlhfYtWgXmx83V5kLvIzOiGkDYN+XJuu7b5cUbfA0GYk\nH+1MhTGCzxKn//GPoCtUjgvmfnq+KKviuYla7eRxUen+R99M2Z3cKq/wmjQehp22\nmIl9g3vRe2vIfE2gqmnqfLNZWva0qf1jEsmIVuqX0DN8DJattgROjq1jym7XJmQb\n+WoRnWsrVLEdlIPSrupRUqv9bIrHJMHJ0WtUy/qU9fhvCljjA8YCvG6aNOvQ2xrq\nabiGkP0Q/ZqVi+YcHuyvs4aRveuqOjf52IRKxDgZL/yM6JhiYiSwwkuU6ypge0ee\nbu+x1iqbXDi1IwbyQ0Kdox2wEaGF7tADIgW5nYukCmv1ugCwg6oJldnd29nZRwSh\nldWkGycT7lh22QcLArdjzqEGYMVo3qKxwFgaVPv4qQJ9CHCmMq5wX5TNIsWyeDOn\nRhYlC+9pVS2t0JKx4pTNba8lGw3PbALrQtYbYRsE330iAZD5YneUywpU+Llqtwuy\nb7pwy+pe\n=e7VP\n-----END PGP SIGNATURE-----",
        "payload": "tree edb53f6b4bb1559f6b13682edce9ff3e264fcadd\nparent 88d8b4e182bfc75e8496f7046af7aab93307b9d0\nauthor MarcoFalke <falke.marco@gmail.com> 1589155945 -0400\ncommitter MarcoFalke <falke.marco@gmail.com> 1589222166 -0400\n\nfuzz: Give CNode ownership to ConnmanTestMsg in process_message fuzz harness\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6666c828e072a5e99ea0c16394ca3e5b9de07409",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/6666c828e072a5e99ea0c16394ca3e5b9de07409",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6666c828e072a5e99ea0c16394ca3e5b9de07409/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "88d8b4e182bfc75e8496f7046af7aab93307b9d0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/88d8b4e182bfc75e8496f7046af7aab93307b9d0",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/88d8b4e182bfc75e8496f7046af7aab93307b9d0"
      }
    ],
    "stats": {
      "total": 5,
      "additions": 4,
      "deletions": 1
    },
    "files": [
      {
        "sha": "38c0748c71cbf71896fa810720af24912dbc1fca",
        "filename": "src/test/fuzz/process_message.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 1,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6666c828e072a5e99ea0c16394ca3e5b9de07409/src/test/fuzz/process_message.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6666c828e072a5e99ea0c16394ca3e5b9de07409/src/test/fuzz/process_message.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/process_message.cpp?ref=6666c828e072a5e99ea0c16394ca3e5b9de07409",
        "patch": "@@ -14,6 +14,7 @@\n #include <test/fuzz/FuzzedDataProvider.h>\n #include <test/fuzz/fuzz.h>\n #include <test/util/mining.h>\n+#include <test/util/net.h>\n #include <test/util/setup_common.h>\n #include <util/memory.h>\n #include <validationinterface.h>\n@@ -63,15 +64,17 @@ void initialize()\n void test_one_input(const std::vector<uint8_t>& buffer)\n {\n     FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n+    ConnmanTestMsg& connman = *(ConnmanTestMsg*)g_setup->m_node.connman.get();\n     const std::string random_message_type{fuzzed_data_provider.ConsumeBytesAsString(CMessageHeader::COMMAND_SIZE).c_str()};\n     if (!LIMIT_TO_MESSAGE_TYPE.empty() && random_message_type != LIMIT_TO_MESSAGE_TYPE) {\n         return;\n     }\n     CDataStream random_bytes_data_stream{fuzzed_data_provider.ConsumeRemainingBytes<unsigned char>(), SER_NETWORK, PROTOCOL_VERSION};\n-    CNode p2p_node{0, ServiceFlags(NODE_NETWORK | NODE_WITNESS | NODE_BLOOM), 0, INVALID_SOCKET, CAddress{CService{in_addr{0x0100007f}, 7777}, NODE_NETWORK}, 0, 0, CAddress{}, std::string{}, false};\n+    CNode& p2p_node = *MakeUnique<CNode>(0, ServiceFlags(NODE_NETWORK | NODE_WITNESS | NODE_BLOOM), 0, INVALID_SOCKET, CAddress{CService{in_addr{0x0100007f}, 7777}, NODE_NETWORK}, 0, 0, CAddress{}, std::string{}, false).release();\n     p2p_node.fSuccessfullyConnected = true;\n     p2p_node.nVersion = PROTOCOL_VERSION;\n     p2p_node.SetSendVersion(PROTOCOL_VERSION);\n+    connman.AddTestNode(p2p_node);\n     g_setup->m_node.peer_logic->InitializeNode(&p2p_node);\n     try {\n         (void)ProcessMessage(&p2p_node, random_message_type, random_bytes_data_stream, GetTimeMillis(), Params(), *g_setup->m_node.mempool, g_setup->m_node.connman.get(), g_setup->m_node.banman.get(), std::atomic<bool>{false});"
      }
    ]
  },
  {
    "sha": "fab860aed4878b831dae463e1ee68029b66210f5",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYWI4NjBhZWQ0ODc4YjgzMWRhZTQ2M2UxZWU2ODAyOWI2NjIxMGY1",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-05-05T00:16:22Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-05-12T11:28:12Z"
      },
      "message": "fuzz: Stop nodes in process_message* fuzzers",
      "tree": {
        "sha": "fb9294cbf92cb1945da56a149935015dc2bd2675",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fb9294cbf92cb1945da56a149935015dc2bd2675"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fab860aed4878b831dae463e1ee68029b66210f5",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUi/Sgv/X3SwdLzCqJc87pqBAJH5XKGOl2SyHFl8MoXKZoK8WavWNHVMDsHjuYxB\nyyg+maZzRM+JIJZBkNkUcsLrp2yalMLJGemkSzD0orVm+RmPe8wv+J/zjUyafSbm\nYoVFfBo1g0CXC97StQBswBOtV2gUT7pUuYwigTB9BNWszj6B9mTkAGHBT8AjcSFQ\nyg2sX43B5lvly4z1r44g/c3SXgmM9pUP3ux44HH1Cvj+ctdYDsUrbcILBpLx0rrt\nkFMP4qC7VfW9RR1yThlyPimp38V7x1Q1wbXwSnlq6/mdi4xRzoKZWLB3C0JhV/PI\nySTgewm9nuaxIH8DymaRRb5sqjnxpLjaajGojLJV0kmIjV+14Dw8jtuTGc+ark/N\nixbJiPoLOJ14y2vzXmNjpembq3/ZWr4xPPe5GkKoAv1GeUPPD6YQRhLbKu7vCw0u\nlsDCvqTL22GKDUMPt/6PCup8I6WkhjXviesVYwcodAQVAwOo90v6i3JLg+U0JO4d\nOOWS1ayP\n=4PoG\n-----END PGP SIGNATURE-----",
        "payload": "tree fb9294cbf92cb1945da56a149935015dc2bd2675\nparent 6666c828e072a5e99ea0c16394ca3e5b9de07409\nauthor MarcoFalke <falke.marco@gmail.com> 1588637782 -0400\ncommitter MarcoFalke <falke.marco@gmail.com> 1589282892 -0400\n\nfuzz: Stop nodes in process_message* fuzzers\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fab860aed4878b831dae463e1ee68029b66210f5",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fab860aed4878b831dae463e1ee68029b66210f5",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fab860aed4878b831dae463e1ee68029b66210f5/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "6666c828e072a5e99ea0c16394ca3e5b9de07409",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6666c828e072a5e99ea0c16394ca3e5b9de07409",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/6666c828e072a5e99ea0c16394ca3e5b9de07409"
      }
    ],
    "stats": {
      "total": 5,
      "additions": 4,
      "deletions": 1
    },
    "files": [
      {
        "sha": "eae62c7329db0a0eb23d6d7febc0d4ad43317a6c",
        "filename": "src/test/fuzz/process_message.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fab860aed4878b831dae463e1ee68029b66210f5/src/test/fuzz/process_message.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fab860aed4878b831dae463e1ee68029b66210f5/src/test/fuzz/process_message.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/process_message.cpp?ref=fab860aed4878b831dae463e1ee68029b66210f5",
        "patch": "@@ -81,4 +81,6 @@ void test_one_input(const std::vector<uint8_t>& buffer)\n     } catch (const std::ios_base::failure&) {\n     }\n     SyncWithValidationInterfaceQueue();\n+    LOCK2(::cs_main, g_cs_orphans); // See init.cpp for rationale for implicit locking order requirement\n+    g_setup->m_node.connman->StopNodes();\n }"
      },
      {
        "sha": "ad6c115a49c49954160ee0762422a03c26efe171",
        "filename": "src/test/fuzz/process_messages.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 1,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fab860aed4878b831dae463e1ee68029b66210f5/src/test/fuzz/process_messages.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fab860aed4878b831dae463e1ee68029b66210f5/src/test/fuzz/process_messages.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/process_messages.cpp?ref=fab860aed4878b831dae463e1ee68029b66210f5",
        "patch": "@@ -75,6 +75,7 @@ void test_one_input(const std::vector<uint8_t>& buffer)\n         } catch (const std::ios_base::failure&) {\n         }\n     }\n-    connman.ClearTestNodes();\n     SyncWithValidationInterfaceQueue();\n+    LOCK2(::cs_main, g_cs_orphans); // See init.cpp for rationale for implicit locking order requirement\n+    g_setup->m_node.connman->StopNodes();\n }"
      }
    ]
  }
]