[
  {
    "sha": "3a53f19718a2207f0d74c32a611ae91703d9da8d",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozYTUzZjE5NzE4YTIyMDdmMGQ3NGMzMmE2MTFhZTkxNzAzZDlkYThk",
    "commit": {
      "author": {
        "name": "Gregory Maxwell",
        "email": "greg@xiph.org",
        "date": "2017-07-14T22:36:58Z"
      },
      "committer": {
        "name": "Gregory Maxwell",
        "email": "greg@xiph.org",
        "date": "2017-07-16T00:11:31Z"
      },
      "message": "Pushdown walletdb object through GenerateNewKey/DeriveNewChildKey.\n\nThis is needed but not sufficient for batching the wallet flushing\n when topping up the keypool.",
      "tree": {
        "sha": "5c4ceaa486b6fa63f1960d32c50c0fa5fcbb1e9d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5c4ceaa486b6fa63f1960d32c50c0fa5fcbb1e9d"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3a53f19718a2207f0d74c32a611ae91703d9da8d",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3a53f19718a2207f0d74c32a611ae91703d9da8d",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/3a53f19718a2207f0d74c32a611ae91703d9da8d",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3a53f19718a2207f0d74c32a611ae91703d9da8d/comments",
    "author": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "5cfdda2503c995cdd563b1a2a29162ac298d173d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/5cfdda2503c995cdd563b1a2a29162ac298d173d",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/5cfdda2503c995cdd563b1a2a29162ac298d173d"
      }
    ],
    "stats": {
      "total": 18,
      "additions": 10,
      "deletions": 8
    },
    "files": [
      {
        "sha": "b3b3c1c10a318710328fa9b1e2488d0688f3a942",
        "filename": "src/wallet/wallet.cpp",
        "status": "modified",
        "additions": 8,
        "deletions": 6,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/3a53f19718a2207f0d74c32a611ae91703d9da8d/src/wallet/wallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/3a53f19718a2207f0d74c32a611ae91703d9da8d/src/wallet/wallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/wallet.cpp?ref=3a53f19718a2207f0d74c32a611ae91703d9da8d",
        "patch": "@@ -87,7 +87,7 @@ const CWalletTx* CWallet::GetWalletTx(const uint256& hash) const\n     return &(it->second);\n }\n \n-CPubKey CWallet::GenerateNewKey(bool internal)\n+CPubKey CWallet::GenerateNewKey(CWalletDB &walletdb, bool internal)\n {\n     AssertLockHeld(cs_wallet); // mapKeyMetadata\n     bool fCompressed = CanSupportFeature(FEATURE_COMPRPUBKEY); // default to compressed public keys if we want 0.6.0 wallets\n@@ -100,7 +100,7 @@ CPubKey CWallet::GenerateNewKey(bool internal)\n \n     // use HD key derivation if HD was enabled during wallet creation\n     if (IsHDEnabled()) {\n-        DeriveNewChildKey(metadata, secret, (CanSupportFeature(FEATURE_HD_SPLIT) ? internal : false));\n+        DeriveNewChildKey(walletdb, metadata, secret, (CanSupportFeature(FEATURE_HD_SPLIT) ? internal : false));\n     } else {\n         secret.MakeNewKey(fCompressed);\n     }\n@@ -120,7 +120,7 @@ CPubKey CWallet::GenerateNewKey(bool internal)\n     return pubkey;\n }\n \n-void CWallet::DeriveNewChildKey(CKeyMetadata& metadata, CKey& secret, bool internal)\n+void CWallet::DeriveNewChildKey(CWalletDB &walletdb, CKeyMetadata& metadata, CKey& secret, bool internal)\n {\n     // for now we use a fixed keypath scheme of m/0'/0'/k\n     CKey key;                      //master key seed (256bit)\n@@ -162,7 +162,7 @@ void CWallet::DeriveNewChildKey(CKeyMetadata& metadata, CKey& secret, bool inter\n     secret = childKey.key;\n     metadata.hdMasterKeyID = hdChain.masterKeyID;\n     // update the chain model in the database\n-    if (!CWalletDB(*dbw).WriteHDChain(hdChain))\n+    if (!walletdb.WriteHDChain(hdChain))\n         throw std::runtime_error(std::string(__func__) + \": Writing HD chain model failed\");\n }\n \n@@ -3183,8 +3183,9 @@ bool CWallet::TopUpKeyPool(unsigned int kpSize)\n                 nEnd = std::max(nEnd, *(setExternalKeyPool.rbegin()) + 1);\n             }\n \n-            if (!walletdb.WritePool(nEnd, CKeyPool(GenerateNewKey(internal), internal)))\n+            if (!walletdb.WritePool(nEnd, CKeyPool(GenerateNewKey(walletdb, internal), internal))) {\n                 throw std::runtime_error(std::string(__func__) + \": writing generated key failed\");\n+            }\n \n             if (internal) {\n                 setInternalKeyPool.insert(nEnd);\n@@ -3266,7 +3267,8 @@ bool CWallet::GetKeyFromPool(CPubKey& result, bool internal)\n         if (nIndex == -1)\n         {\n             if (IsLocked()) return false;\n-            result = GenerateNewKey(internal);\n+            CWalletDB walletdb(*dbw);\n+            result = GenerateNewKey(walletdb, internal);\n             return true;\n         }\n         KeepKey(nIndex);"
      },
      {
        "sha": "e91a6effd3cd9852208faea2804755b79b2fb07c",
        "filename": "src/wallet/wallet.h",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/3a53f19718a2207f0d74c32a611ae91703d9da8d/src/wallet/wallet.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/3a53f19718a2207f0d74c32a611ae91703d9da8d/src/wallet/wallet.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/wallet.h?ref=3a53f19718a2207f0d74c32a611ae91703d9da8d",
        "patch": "@@ -697,7 +697,7 @@ class CWallet : public CCryptoKeyStore, public CValidationInterface\n     CHDChain hdChain;\n \n     /* HD derive new child key (on internal or external chain) */\n-    void DeriveNewChildKey(CKeyMetadata& metadata, CKey& secret, bool internal = false);\n+    void DeriveNewChildKey(CWalletDB &walletdb, CKeyMetadata& metadata, CKey& secret, bool internal = false);\n \n     std::set<int64_t> setInternalKeyPool;\n     std::set<int64_t> setExternalKeyPool;\n@@ -866,7 +866,7 @@ class CWallet : public CCryptoKeyStore, public CValidationInterface\n      * keystore implementation\n      * Generate a new key\n      */\n-    CPubKey GenerateNewKey(bool internal = false);\n+    CPubKey GenerateNewKey(CWalletDB& walletdb, bool internal = false);\n     //! Adds a key to the store, and saves it to disk.\n     bool AddKeyPubKey(const CKey& key, const CPubKey &pubkey) override;\n     //! Adds a key to the store, without saving it to disk (used by LoadWallet)"
      }
    ]
  },
  {
    "sha": "30d8f3a18e7d927459e409a38ee1c0d1ddf054ad",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozMGQ4ZjNhMThlN2Q5Mjc0NTllNDA5YTM4ZWUxYzBkMWRkZjA1NGFk",
    "commit": {
      "author": {
        "name": "Gregory Maxwell",
        "email": "greg@xiph.org",
        "date": "2017-07-15T01:00:30Z"
      },
      "committer": {
        "name": "Gregory Maxwell",
        "email": "greg@xiph.org",
        "date": "2017-07-17T13:46:07Z"
      },
      "message": "Pushdown walletdb though CWallet::AddKeyPubKey to avoid flushes.\n\nThis prevents the wallet from being flushed between each and\n every key during top-up.  This results in a >10x speed-up\n for the top-up.",
      "tree": {
        "sha": "82256aa871d5204c641b624703674bac6cda7a21",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/82256aa871d5204c641b624703674bac6cda7a21"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/30d8f3a18e7d927459e409a38ee1c0d1ddf054ad",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/30d8f3a18e7d927459e409a38ee1c0d1ddf054ad",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/30d8f3a18e7d927459e409a38ee1c0d1ddf054ad",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/30d8f3a18e7d927459e409a38ee1c0d1ddf054ad/comments",
    "author": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "3a53f19718a2207f0d74c32a611ae91703d9da8d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3a53f19718a2207f0d74c32a611ae91703d9da8d",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/3a53f19718a2207f0d74c32a611ae91703d9da8d"
      }
    ],
    "stats": {
      "total": 36,
      "additions": 29,
      "deletions": 7
    },
    "files": [
      {
        "sha": "d8c1dd94fcb9c2441d2895e7e5ffb8b9c91f4a88",
        "filename": "src/wallet/wallet.cpp",
        "status": "modified",
        "additions": 28,
        "deletions": 7,
        "changes": 35,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/30d8f3a18e7d927459e409a38ee1c0d1ddf054ad/src/wallet/wallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/30d8f3a18e7d927459e409a38ee1c0d1ddf054ad/src/wallet/wallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/wallet.cpp?ref=30d8f3a18e7d927459e409a38ee1c0d1ddf054ad",
        "patch": "@@ -106,17 +106,19 @@ CPubKey CWallet::GenerateNewKey(CWalletDB &walletdb, bool internal)\n     }\n \n     // Compressed public keys were introduced in version 0.6.0\n-    if (fCompressed)\n+    if (fCompressed) {\n         SetMinVersion(FEATURE_COMPRPUBKEY);\n+    }\n \n     CPubKey pubkey = secret.GetPubKey();\n     assert(secret.VerifyPubKey(pubkey));\n \n     mapKeyMetadata[pubkey.GetID()] = metadata;\n     UpdateTimeFirstKey(nCreationTime);\n \n-    if (!AddKeyPubKey(secret, pubkey))\n+    if (!AddKeyPubKeyWithDB(walletdb, secret, pubkey)) {\n         throw std::runtime_error(std::string(__func__) + \": AddKey failed\");\n+    }\n     return pubkey;\n }\n \n@@ -166,29 +168,48 @@ void CWallet::DeriveNewChildKey(CWalletDB &walletdb, CKeyMetadata& metadata, CKe\n         throw std::runtime_error(std::string(__func__) + \": Writing HD chain model failed\");\n }\n \n-bool CWallet::AddKeyPubKey(const CKey& secret, const CPubKey &pubkey)\n+bool CWallet::AddKeyPubKeyWithDB(CWalletDB &walletdb, const CKey& secret, const CPubKey &pubkey)\n {\n     AssertLockHeld(cs_wallet); // mapKeyMetadata\n-    if (!CCryptoKeyStore::AddKeyPubKey(secret, pubkey))\n+\n+    // CCryptoKeyStore has no concept of wallet databases, but calls AddCryptedKey\n+    // which is overridden below.  To avoid flushes, the database handle is\n+    // tunneled through to it.\n+    bool needsDB = !pwalletdbEncryption;\n+    if (needsDB) {\n+        pwalletdbEncryption = &walletdb;\n+    }\n+    if (!CCryptoKeyStore::AddKeyPubKey(secret, pubkey)) {\n+        if (needsDB) pwalletdbEncryption = NULL;\n         return false;\n+    }\n+    if (needsDB) pwalletdbEncryption = NULL;\n \n     // check if we need to remove from watch-only\n     CScript script;\n     script = GetScriptForDestination(pubkey.GetID());\n-    if (HaveWatchOnly(script))\n+    if (HaveWatchOnly(script)) {\n         RemoveWatchOnly(script);\n+    }\n     script = GetScriptForRawPubKey(pubkey);\n-    if (HaveWatchOnly(script))\n+    if (HaveWatchOnly(script)) {\n         RemoveWatchOnly(script);\n+    }\n \n     if (!IsCrypted()) {\n-        return CWalletDB(*dbw).WriteKey(pubkey,\n+        return walletdb.WriteKey(pubkey,\n                                                  secret.GetPrivKey(),\n                                                  mapKeyMetadata[pubkey.GetID()]);\n     }\n     return true;\n }\n \n+bool CWallet::AddKeyPubKey(const CKey& secret, const CPubKey &pubkey)\n+{\n+    CWalletDB walletdb(*dbw);\n+    return CWallet::AddKeyPubKeyWithDB(walletdb, secret, pubkey);\n+}\n+\n bool CWallet::AddCryptedKey(const CPubKey &vchPubKey,\n                             const std::vector<unsigned char> &vchCryptedSecret)\n {"
      },
      {
        "sha": "0bf6ccf722ec7291e3b263390795b75105a7e23e",
        "filename": "src/wallet/wallet.h",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/30d8f3a18e7d927459e409a38ee1c0d1ddf054ad/src/wallet/wallet.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/30d8f3a18e7d927459e409a38ee1c0d1ddf054ad/src/wallet/wallet.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/wallet.h?ref=30d8f3a18e7d927459e409a38ee1c0d1ddf054ad",
        "patch": "@@ -869,6 +869,7 @@ class CWallet : public CCryptoKeyStore, public CValidationInterface\n     CPubKey GenerateNewKey(CWalletDB& walletdb, bool internal = false);\n     //! Adds a key to the store, and saves it to disk.\n     bool AddKeyPubKey(const CKey& key, const CPubKey &pubkey) override;\n+    bool AddKeyPubKeyWithDB(CWalletDB &walletdb,const CKey& key, const CPubKey &pubkey);\n     //! Adds a key to the store, without saving it to disk (used by LoadWallet)\n     bool LoadKey(const CKey& key, const CPubKey &pubkey) { return CCryptoKeyStore::AddKeyPubKey(key, pubkey); }\n     //! Load metadata (used by LoadWallet)"
      }
    ]
  },
  {
    "sha": "41dc1635878766e4a810e6a7c57637d079fced64",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0MWRjMTYzNTg3ODc2NmU0YTgxMGU2YTdjNTc2MzdkMDc5ZmNlZDY0",
    "commit": {
      "author": {
        "name": "Gregory Maxwell",
        "email": "greg@xiph.org",
        "date": "2017-07-15T01:09:10Z"
      },
      "committer": {
        "name": "Gregory Maxwell",
        "email": "greg@xiph.org",
        "date": "2017-07-17T13:46:14Z"
      },
      "message": "Increase wallet default keypool size to 1000.",
      "tree": {
        "sha": "88803993152289beabd6b7c5904434d4e4afd6d5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/88803993152289beabd6b7c5904434d4e4afd6d5"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/41dc1635878766e4a810e6a7c57637d079fced64",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/41dc1635878766e4a810e6a7c57637d079fced64",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/41dc1635878766e4a810e6a7c57637d079fced64",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/41dc1635878766e4a810e6a7c57637d079fced64/comments",
    "author": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "30d8f3a18e7d927459e409a38ee1c0d1ddf054ad",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/30d8f3a18e7d927459e409a38ee1c0d1ddf054ad",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/30d8f3a18e7d927459e409a38ee1c0d1ddf054ad"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 1,
      "deletions": 1
    },
    "files": [
      {
        "sha": "9e687c4bfd065777736bee12af8a8b9ef6d387ef",
        "filename": "src/wallet/wallet.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/41dc1635878766e4a810e6a7c57637d079fced64/src/wallet/wallet.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/41dc1635878766e4a810e6a7c57637d079fced64/src/wallet/wallet.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/wallet.h?ref=41dc1635878766e4a810e6a7c57637d079fced64",
        "patch": "@@ -40,7 +40,7 @@ extern unsigned int nTxConfirmTarget;\n extern bool bSpendZeroConfChange;\n extern bool fWalletRbf;\n \n-static const unsigned int DEFAULT_KEYPOOL_SIZE = 100;\n+static const unsigned int DEFAULT_KEYPOOL_SIZE = 1000;\n //! -paytxfee default\n static const CAmount DEFAULT_TRANSACTION_FEE = 0;\n //! -fallbackfee default"
      }
    ]
  },
  {
    "sha": "b0e8e2de8408cbaed9d70914c67b4c9f11397cb7",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiMGU4ZTJkZTg0MDhjYmFlZDlkNzA5MTRjNjdiNGM5ZjExMzk3Y2I3",
    "commit": {
      "author": {
        "name": "Gregory Maxwell",
        "email": "greg@xiph.org",
        "date": "2017-07-17T08:16:36Z"
      },
      "committer": {
        "name": "Gregory Maxwell",
        "email": "greg@xiph.org",
        "date": "2017-07-17T13:46:15Z"
      },
      "message": "Print one log message per keypool top-up, not one per key.",
      "tree": {
        "sha": "47397eb7104b1408d27baa3631123ea1eb5d7828",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/47397eb7104b1408d27baa3631123ea1eb5d7828"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b0e8e2de8408cbaed9d70914c67b4c9f11397cb7",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b0e8e2de8408cbaed9d70914c67b4c9f11397cb7",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/b0e8e2de8408cbaed9d70914c67b4c9f11397cb7",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b0e8e2de8408cbaed9d70914c67b4c9f11397cb7/comments",
    "author": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "41dc1635878766e4a810e6a7c57637d079fced64",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/41dc1635878766e4a810e6a7c57637d079fced64",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/41dc1635878766e4a810e6a7c57637d079fced64"
      }
    ],
    "stats": {
      "total": 4,
      "additions": 3,
      "deletions": 1
    },
    "files": [
      {
        "sha": "5db13ef02ff3701d237f701ff845f82ba0b796fc",
        "filename": "src/wallet/wallet.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 1,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b0e8e2de8408cbaed9d70914c67b4c9f11397cb7/src/wallet/wallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b0e8e2de8408cbaed9d70914c67b4c9f11397cb7/src/wallet/wallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/wallet.cpp?ref=b0e8e2de8408cbaed9d70914c67b4c9f11397cb7",
        "patch": "@@ -3213,7 +3213,9 @@ bool CWallet::TopUpKeyPool(unsigned int kpSize)\n             } else {\n                 setExternalKeyPool.insert(nEnd);\n             }\n-            LogPrintf(\"keypool added key %d, size=%u (%u internal), new key is %s\\n\", nEnd, setInternalKeyPool.size() + setExternalKeyPool.size(), setInternalKeyPool.size(), internal ? \"internal\" : \"external\");\n+        }\n+        if (missingInternal + missingExternal > 0) {\n+            LogPrintf(\"keypool added %d keys (%d internal), size=%u (%u internal)\\n\", missingInternal + missingExternal, missingInternal, setInternalKeyPool.size() + setExternalKeyPool.size(), setInternalKeyPool.size());\n         }\n     }\n     return true;"
      }
    ]
  }
]