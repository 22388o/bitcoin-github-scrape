[
  {
    "sha": "d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkNGNkYmQ2ZmI2YWMzNjYzZDA2OTMwN2M0ZmQwMDc4ZjRlY2YwMjQ1",
    "commit": {
      "author": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2017-08-11T15:25:06Z"
      },
      "committer": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2017-09-26T16:17:19Z"
      },
      "message": "[rpc] Deprecate estimatefee RPC\n\nDeprecate estimatefee in v0.16, for final removal in v0.17.\n\nThis commit introduces a phased removal of RPC methods. RPC method is\ndisabled by default in version x, but can be enabled by using the\n`-deprecatedrpc=<method>` argument. RPC method is removed entirely in\nversion (x+1).",
      "tree": {
        "sha": "2a3e1a54e474e79ab491c46205ca26fd84f91da4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2a3e1a54e474e79ab491c46205ca26fd84f91da4"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245/comments",
    "author": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "86700d3d056caf54b091a6673dd6dabb65fac1f2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/86700d3d056caf54b091a6673dd6dabb65fac1f2",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/86700d3d056caf54b091a6673dd6dabb65fac1f2"
      }
    ],
    "stats": {
      "total": 19,
      "additions": 18,
      "deletions": 1
    },
    "files": [
      {
        "sha": "a1c49a0992b48b94790a93712839dcdab40301c0",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245",
        "patch": "@@ -430,6 +430,7 @@ std::string HelpMessage(HelpMessageMode mode)\n         strUsage += HelpMessageOpt(\"-checkmempool=<n>\", strprintf(\"Run checks every <n> transactions (default: %u)\", defaultChainParams->DefaultConsistencyChecks()));\n         strUsage += HelpMessageOpt(\"-checkpoints\", strprintf(\"Disable expensive verification for known chain history (default: %u)\", DEFAULT_CHECKPOINTS_ENABLED));\n         strUsage += HelpMessageOpt(\"-disablesafemode\", strprintf(\"Disable safemode, override a real safe mode event (default: %u)\", DEFAULT_DISABLE_SAFEMODE));\n+        strUsage += HelpMessageOpt(\"-deprecatedrpc=<method>\", \"Allows deprecated RPC method(s) to be used\");\n         strUsage += HelpMessageOpt(\"-testsafemode\", strprintf(\"Force safe mode (default: %u)\", DEFAULT_TESTSAFEMODE));\n         strUsage += HelpMessageOpt(\"-dropmessagestest=<n>\", \"Randomly drop 1 of every <n> network messages\");\n         strUsage += HelpMessageOpt(\"-fuzzmessagestest=<n>\", \"Randomly fuzz 1 of every <n> network messages\");"
      },
      {
        "sha": "5ac32dc9742a5338ba5310855b879fa032aeccea",
        "filename": "src/rpc/mining.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 0,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245/src/rpc/mining.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245/src/rpc/mining.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/mining.cpp?ref=d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245",
        "patch": "@@ -789,6 +789,12 @@ UniValue estimatefee(const JSONRPCRequest& request)\n             + HelpExampleCli(\"estimatefee\", \"6\")\n             );\n \n+    if (!IsDeprecatedRPCEnabled(\"estimatefee\")) {\n+        throw JSONRPCError(RPC_METHOD_DEPRECATED, \"estimatefee is deprecated and will be fully removed in v0.17. \"\n+            \"To use estimatefee in v0.16, restart bitcoind with -deprecatedrpc=estimatefee.\\n\"\n+            \"Projects should transition to using estimatesmartfee before upgrading to v0.17\");\n+    }\n+\n     RPCTypeCheck(request.params, {UniValue::VNUM});\n \n     int nBlocks = request.params[0].get_int();"
      },
      {
        "sha": "056f93e7dbaa6cc33e6eac6fc05c0596f4d74b87",
        "filename": "src/rpc/protocol.h",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245/src/rpc/protocol.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245/src/rpc/protocol.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/protocol.h?ref=d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245",
        "patch": "@@ -57,6 +57,7 @@ enum RPCErrorCode\n     RPC_VERIFY_REJECTED             = -26, //!< Transaction or block was rejected by network rules\n     RPC_VERIFY_ALREADY_IN_CHAIN     = -27, //!< Transaction already in chain\n     RPC_IN_WARMUP                   = -28, //!< Client still warming up\n+    RPC_METHOD_DEPRECATED           = -32, //!< RPC method is deprecated\n \n     //! Aliases for backward compatibility\n     RPC_TRANSACTION_ERROR           = RPC_VERIFY_ERROR,"
      },
      {
        "sha": "a73b697e01e0b87cb96816cfed26c5dc898f8d15",
        "filename": "src/rpc/server.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 0,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245/src/rpc/server.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245/src/rpc/server.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/server.cpp?ref=d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245",
        "patch": "@@ -382,6 +382,13 @@ void JSONRPCRequest::parse(const UniValue& valRequest)\n         throw JSONRPCError(RPC_INVALID_REQUEST, \"Params must be an array or object\");\n }\n \n+bool IsDeprecatedRPCEnabled(const std::string& method)\n+{\n+    const std::vector<std::string> enabled_methods = gArgs.GetArgs(\"-deprecatedrpc\");\n+\n+    return find(enabled_methods.begin(), enabled_methods.end(), method) != enabled_methods.end();\n+}\n+\n static UniValue JSONRPCExecOne(const UniValue& req)\n {\n     UniValue rpc_result(UniValue::VOBJ);"
      },
      {
        "sha": "31d630427104b2843c90bbf8db9d2ddee1a291a2",
        "filename": "src/rpc/server.h",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245/src/rpc/server.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245/src/rpc/server.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/server.h?ref=d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245",
        "patch": "@@ -171,6 +171,8 @@ class CRPCTable\n     bool appendCommand(const std::string& name, const CRPCCommand* pcmd);\n };\n \n+bool IsDeprecatedRPCEnabled(const std::string& method);\n+\n extern CRPCTable tableRPC;\n \n /**"
      },
      {
        "sha": "986f4546a8b75a044ba0fef3f3c7842b6a57c5d7",
        "filename": "test/functional/smartfees.py",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245/test/functional/smartfees.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245/test/functional/smartfees.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/smartfees.py?ref=d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245",
        "patch": "@@ -151,7 +151,7 @@ def setup_network(self):\n         which we will use to generate our transactions.\n         \"\"\"\n         self.add_nodes(3, extra_args=[[\"-maxorphantx=1000\", \"-whitelist=127.0.0.1\"],\n-                                      [\"-blockmaxsize=17000\", \"-maxorphantx=1000\"],\n+                                      [\"-blockmaxsize=17000\", \"-maxorphantx=1000\", \"-deprecatedrpc=estimatefee\"],\n                                       [\"-blockmaxsize=8000\", \"-maxorphantx=1000\"]])\n         # Use node0 to mine blocks for input splitting\n         # Node1 mines small blocks but that are bigger than the expected transaction rate."
      }
    ]
  },
  {
    "sha": "048e0c3e26051e66e027a84128923ea341d5337b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzowNDhlMGMzZTI2MDUxZTY2ZTAyN2E4NDEyODkyM2VhMzQxZDUzMzdi",
    "commit": {
      "author": {
        "name": "Cristian Mircea Messel",
        "email": "mess110@gmail.com",
        "date": "2017-08-23T14:58:59Z"
      },
      "committer": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2017-09-26T16:17:41Z"
      },
      "message": "[rpc] [tests] Add deprecated RPC test",
      "tree": {
        "sha": "c3cacc882f0b86b050360ff79873e67aee87cf1f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c3cacc882f0b86b050360ff79873e67aee87cf1f"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/048e0c3e26051e66e027a84128923ea341d5337b",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/048e0c3e26051e66e027a84128923ea341d5337b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/048e0c3e26051e66e027a84128923ea341d5337b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/048e0c3e26051e66e027a84128923ea341d5337b/comments",
    "author": {
      "login": "mess110",
      "id": 226170,
      "node_id": "MDQ6VXNlcjIyNjE3MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/226170?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mess110",
      "html_url": "https://github.com/mess110",
      "followers_url": "https://api.github.com/users/mess110/followers",
      "following_url": "https://api.github.com/users/mess110/following{/other_user}",
      "gists_url": "https://api.github.com/users/mess110/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mess110/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mess110/subscriptions",
      "organizations_url": "https://api.github.com/users/mess110/orgs",
      "repos_url": "https://api.github.com/users/mess110/repos",
      "events_url": "https://api.github.com/users/mess110/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mess110/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/d4cdbd6fb6ac3663d069307c4fd0078f4ecf0245"
      }
    ],
    "stats": {
      "total": 24,
      "additions": 24,
      "deletions": 0
    },
    "files": [
      {
        "sha": "ec500ccbf967333c783b492dbf4f677acb88e5c1",
        "filename": "test/functional/deprecated_rpc.py",
        "status": "added",
        "additions": 23,
        "deletions": 0,
        "changes": 23,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/048e0c3e26051e66e027a84128923ea341d5337b/test/functional/deprecated_rpc.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/048e0c3e26051e66e027a84128923ea341d5337b/test/functional/deprecated_rpc.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/deprecated_rpc.py?ref=048e0c3e26051e66e027a84128923ea341d5337b",
        "patch": "@@ -0,0 +1,23 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test deprecation of RPC calls.\"\"\"\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_raises_jsonrpc\n+\n+class DeprecatedRpcTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.num_nodes = 2\n+        self.setup_clean_chain = True\n+        self.extra_args = [[], [\"-deprecatedrpc=estimatefee\"]]\n+\n+    def run_test(self):\n+        self.log.info(\"estimatefee: Shows deprecated message\")\n+        assert_raises_jsonrpc(-32, 'estimatefee is deprecated', self.nodes[0].estimatefee, 1)\n+\n+        self.log.info(\"Using -deprecatedrpc=estimatefee bypasses the error\")\n+        self.nodes[1].estimatefee(1)\n+\n+if __name__ == '__main__':\n+    DeprecatedRpcTest().main()"
      },
      {
        "sha": "5c8740d7cdc39df6b7dc5f2ef5bb9190602541b7",
        "filename": "test/functional/test_runner.py",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/048e0c3e26051e66e027a84128923ea341d5337b/test/functional/test_runner.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/048e0c3e26051e66e027a84128923ea341d5337b/test/functional/test_runner.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/test_runner.py?ref=048e0c3e26051e66e027a84128923ea341d5337b",
        "patch": "@@ -98,6 +98,7 @@\n     'disconnect_ban.py',\n     'decodescript.py',\n     'blockchain.py',\n+    'deprecated_rpc.py',\n     'disablewallet.py',\n     'net.py',\n     'keypool.py',"
      }
    ]
  }
]