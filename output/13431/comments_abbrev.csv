Empact,2018-06-11T07:34:29Z,"I think you can move the assignment to the for loop increment statement, because `pindex` isn't assigned anywhere else within the loop, and it's irrelevant if the `ShutdownRequested` early return occurs. This assumes the coin check is irrelevant to the update.",https://github.com/bitcoin/bitcoin/pull/13431#issuecomment-396149574,396149574,
kallewoof,2018-06-11T07:41:16Z,"~~What about `(fPruneMode && !(pindex->nStatus & BLOCK_HAVE_DATA)` case? It would be incorrectly set to the wrong value if this occurred. Also~~ would have to make `pindex` available outside the for loop.\n\nEdit: First statement is not right, second is. I guess it's okay to make `pindex` available, though.\n\nEdit: Done.",https://github.com/bitcoin/bitcoin/pull/13431#issuecomment-396151216,396151216,
Empact,2018-06-11T07:48:09Z,Check out the shadowing on 4056.,https://github.com/bitcoin/bitcoin/pull/13431#issuecomment-396152852,396152852,
kallewoof,2018-06-11T07:56:38Z,"Good catch. Shouldn't affect the outcome, but bad for readability. Fixing.",https://github.com/bitcoin/bitcoin/pull/13431#issuecomment-396155092,396155092,
MarcoFalke,2018-06-13T14:33:04Z,"utACK c995014f492bc9e2d8273b10a19659f9dfc4b182. Feel free to ignore the style-nit. (Though, if you fix it, you might as well do a rebase on your other fix, which was already merged.)",https://github.com/bitcoin/bitcoin/pull/13431#issuecomment-396959398,396959398,
kallewoof,2018-06-15T02:21:39Z,"@MarcoFalke Sorry for delay. Good point. I removed `pindexState`. I had to add a block counter as the check level >= 4 case would move pindex, but I think it makes sense.\n\nAlso rebased on master.",https://github.com/bitcoin/bitcoin/pull/13431#issuecomment-397494070,397494070,
MarcoFalke,2018-06-15T13:33:50Z,utACK f618ebc4e40f32e5aa6a8afe3de76a47f811c562,https://github.com/bitcoin/bitcoin/pull/13431#issuecomment-397621492,397621492,
Empact,2018-06-15T21:44:05Z,utACK f618ebc,https://github.com/bitcoin/bitcoin/pull/13431#issuecomment-397750189,397750189,
sipa,2018-06-30T01:03:26Z,utACK f618ebc4e40f32e5aa6a8afe3de76a47f811c562,https://github.com/bitcoin/bitcoin/pull/13431#issuecomment-401506843,401506843,
fanquake,2018-07-01T08:52:30Z,"Quickly tested using `src/bitcoind -checkblocks=3 -checklevel=1`\nmaster (10ffca7429326c6cc3c428d7a34eb4a195eb727e):\n```\n2018-07-01T08:40:22Z init message: Verifying blocks...\n2018-07-01T08:40:22Z Verifying last 3 blocks at level 1\n2018-07-01T08:40:22Z [0%]...[33%]...[66%]...[99%]...[DONE].\n2018-07-01T08:40:22Z No coin database inconsistencies in last 0 blocks (0 transactions)\n2018-07",https://github.com/bitcoin/bitcoin/pull/13431#issuecomment-401593475,401593475,
MarcoFalke,2018-06-13T14:31:00Z,"Since you moved `pindex` to the outer scope and made it visible here, they are already the same (both of them are set to pindex->pprev at the end of the previous for loop)\n\nAt this point pindexState is only used to calculate the number of blocks, so it could make sense to just remove it altogether and calculate the number of blocks through a index_lowest or num_blocks.",https://github.com/bitcoin/bitcoin/pull/13431#discussion_r195105273,195105273,src/validation.cpp
