theStack,2020-04-16 15:25:20,"Hint for reviewers: there are seemingly `reset()` method calls on `CBloomFilter` instances, e.g.:\nhttps://github.com/bitcoin/bitcoin/blob/661e8df1b63b213d2d5b0d7cba0733869b508af9/src/net_processing.cpp#L3164\nbut those refer to `std::unique_ptr::reset()`, not to `CBloomFilter::reset()`!",https://github.com/bitcoin/bitcoin/pull/18670#issuecomment-614722164,614722164,
MarcoFalke,2020-04-16 15:39:34,"ACK. Please also remove `clear`. `clear` is unused outside of tests and the bip explicitly states that the filter should be discarded completely instead of cleared when a `filterclear` message is sent. I don't understand why we implement features in Bitcoin Core that are unused outside of tests.\n\n```diff\ndiff --git a/src/test/bloom_tests.cpp b/src/test/bloom_tests.cpp\nindex 4a7ad9b38b..bcf",https://github.com/bitcoin/bitcoin/pull/18670#issuecomment-614730237,614730237,
theStack,2020-04-16 15:53:59,"Updated commit, PR title and description to reflect the change of also removing `CBloomFilter::clear()`.",https://github.com/bitcoin/bitcoin/pull/18670#issuecomment-614738451,614738451,
MarcoFalke,2020-04-16 16:10:16,ACK 9b95bdc89f57bbd6681e66668357edccfba68cdf,https://github.com/bitcoin/bitcoin/pull/18670#issuecomment-614747687,614747687,
laanwj,2020-04-16 16:16:46,ACK 9b95bdc89f57bbd6681e66668357edccfba68cdf,https://github.com/bitcoin/bitcoin/pull/18670#issuecomment-614751338,614751338,
jonatack,2020-04-16 18:57:43,ACK 9b95bdc,https://github.com/bitcoin/bitcoin/pull/18670#issuecomment-614836508,614836508,
MarcoFalke,2020-04-16 22:47:56,"```\ntest/fuzz/bloom_filter.cpp:60:26: error: no member named 'clear' in 'CBloomFilter'\n\n            bloom_filter.clear();\n\n            ~~~~~~~~~~~~ ^\n\ntest/fuzz/bloom_filter.cpp:63:26: error: no member named 'reset' in 'CBloomFilter'\n\n            bloom_filter.reset(fuzzed_data_provider.ConsumeIntegral<unsigned int>());\n\n            ~~~~~~~~~~~~ ^\n\n2 errors generated.",https://github.com/bitcoin/bitcoin/pull/18670#issuecomment-614935392,614935392,
theStack,2020-04-16 23:14:58,"Force-pushed commit, now also removes the two methods from the bloom filter fuzz test.",https://github.com/bitcoin/bitcoin/pull/18670#issuecomment-614943779,614943779,
MarcoFalke,2020-04-16 23:20:22,re-ACK 69ffddc83e0f3e265bf6cf7ae31489ae629fe6be,https://github.com/bitcoin/bitcoin/pull/18670#issuecomment-614945542,614945542,
jonatack,2020-04-16 23:21:04,"ACK 69ffddc83e0f3e2, code review, compiled a fuzz build and started the bloom_filter fuzz test as a sanity check.",https://github.com/bitcoin/bitcoin/pull/18670#issuecomment-614945733,614945733,
promag,2020-04-17 08:52:45,ACK 69ffddc83e0f3e265bf6cf7ae31489ae629fe6be.,https://github.com/bitcoin/bitcoin/pull/18670#issuecomment-615127832,615127832,
practicalswift,2020-04-20 09:21:28,"Post-merge ACK 69ffddc\n\n@theStack \n\nThanks for removing `CBloomFilter::reset()/clear()`.\n\nIf you want to look at adding tests for unused functions (or remove unused functions that are unlikely to be used in the near future) then this list might be helpful:\n\n```\nUnused: bitcoinconsensus_version\nUnused: BlockFilter::BlockFilter(BlockFilterType, uint256 const&, std::vector<unsigne",https://github.com/bitcoin/bitcoin/pull/18670#issuecomment-616422799,616422799,
theStack,2020-04-20 15:55:14,"@practicalswift: Thanks for your valuable input, this wanders directly onto my Bitcoin Core TODO list. For some functions, e.g. the constructors of CBloomFilter() and BlockFilter() it can be quite confusing to the reader that they are never actually used anywhere in bitcoind, only for test purposes. For those cases it would make sense to add a comment like ""only for testing"".",https://github.com/bitcoin/bitcoin/pull/18670#issuecomment-616644400,616644400,
