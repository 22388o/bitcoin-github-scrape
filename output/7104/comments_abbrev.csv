petertodd,2015-11-26T22:24:21Z,"We're still building on a fully validated chainTip right?\n\nPersonally I'd even go as far as saying we should explicitly support SPV mining, so this is definitely a Concept ACK for me.\n",https://github.com/bitcoin/bitcoin/pull/7104#issuecomment-159999739,159999739,
pstratem,2015-11-26T22:40:28Z,@petertodd That's correct.\n,https://github.com/bitcoin/bitcoin/pull/7104#issuecomment-160000777,160000777,
jameshilliard,2015-11-27T06:30:31Z,"@pstratem This should probably be a configurable option. I'm also not entirely sure how this would affect block notifys, maybe one way to handle this would be to have two notify triggers, one for when the empty template is ready and one when the full is so that the stratum server can push out full templates as soon as they are ready.\n@petertodd I'm not sure how one could properly implement SPV mi",https://github.com/bitcoin/bitcoin/pull/7104#issuecomment-160052337,160052337,
pstratem,2015-11-27T06:51:21Z,"@jameshilliard I don't see the point of it being a configurable option.\n\nUsing blocknotify only is dangerous, you can and will miss notifications.  Because of this the only wy to get a truly low latency pool is to run multiple bitcoind nodes and merge the result of getblocktemplate at the pool level.\n",https://github.com/bitcoin/bitcoin/pull/7104#issuecomment-160054496,160054496,
jameshilliard,2015-11-27T07:01:53Z,@pstratem The point for having it configurable would be in cases where this makes a minimal difference in GBT times while at the same having higher costs for sending stratum updates(I could potentially see this as an issue for some pools with very large amounts of connections).\n\nThe current behavior with ckpool for is that a notify immediately triggers a GBT call and template update in addition ,https://github.com/bitcoin/bitcoin/pull/7104#issuecomment-160055831,160055831,
dcousens,2015-11-27T07:09:40Z,"> Using blocknotify only is dangerous, you can and will miss notifications.\n\nThat sounds like the bigger problem here?\n",https://github.com/bitcoin/bitcoin/pull/7104#issuecomment-160056744,160056744,
pstratem,2015-11-27T07:11:12Z,@dcousens There isn't a reasonable way to ensure that the notifications are delivered and correctly processed.\n\nIt's a byzantine consensus problem all by itself.\n,https://github.com/bitcoin/bitcoin/pull/7104#issuecomment-160056916,160056916,
pstratem,2015-11-27T07:13:42Z,@jameshilliard And what happens when the notify triggers during the middle of a getblocktemplate scheduled poll?  It stalls for the full interval of a getblocktemplate call.\n\nThat's the last piece of optimization advice I'm ever giving to anybody concerning ckpool.\n,https://github.com/bitcoin/bitcoin/pull/7104#issuecomment-160057188,160057188,
dcousens,2015-11-27T07:24:27Z,"> It's a byzantine consensus problem all by itself.\n\nThat should only be the case in terms of the network consistently receiving the same notifications, not whether our software **processes** notifications or not.\nIf a block notification happens [locally],  it should be processed deterministically?\n",https://github.com/bitcoin/bitcoin/pull/7104#issuecomment-160058131,160058131,
jameshilliard,2015-11-27T07:30:34Z,"@pstratem what's the best way to handle this situation? If the getblocktemplate call from the scheduled poll returns an updated template it will get pushed out to miners anyways(shouldn't bitcoind be interrupting CNB and rerunning it if a new block comes in?), I thought CNB is single threaded and that doing simultaneous getblocktemplate calls would not make the second return any faster.\n",https://github.com/bitcoin/bitcoin/pull/7104#issuecomment-160058799,160058799,
pstratem,2015-11-27T07:33:39Z,@dcousens blocknotify can fail in a bunch of ways that getblocktemplate calls cannot.\n\nRelying on it for low latency operation is a Bad Idea (tm).\n,https://github.com/bitcoin/bitcoin/pull/7104#issuecomment-160059097,160059097,
gmaxwell,2015-11-27T19:36:12Z,"@jameshilliard In any case, in the example that you gave you'll pick up the new work at the 30 second poll; which isn't so unreasonable (it's a 5% capacity loss); especially compared to avoiding parties mining without validation which radically undermines the security assumptions of lite wallets.\n\nA simple heuristic would be to decrease the poll interval to 2 seconds when the current template is",https://github.com/bitcoin/bitcoin/pull/7104#issuecomment-160194307,160194307,
jameshilliard,2015-11-27T22:32:24Z,"@gmaxwell Current behavior is to queue the notify and issue another GBT request right after the scheduled one finishes, this usually results in two quick stratum updates one right after the other. I think it would be ideal if core would make sure the first one always return updated work that way updates can be pushed out faster since you wouldn't have to wait for the second to return.\n\n> but I e",https://github.com/bitcoin/bitcoin/pull/7104#issuecomment-160222433,160222433,
pstratem,2015-11-29T10:21:36Z,@gmaxwell it cant be based on a parameter since you dont know whether you want a fast call until you've already made the call\n,https://github.com/bitcoin/bitcoin/pull/7104#issuecomment-160397353,160397353,
pstratem,2015-12-01T10:41:36Z,Modified to interact with the long polling code.\n\nNow we will return an empty block only to longpoll callers.\n\nThis has the advantage of supporting multiple callers that want an empty template.\n,https://github.com/bitcoin/bitcoin/pull/7104#issuecomment-160930589,160930589,
