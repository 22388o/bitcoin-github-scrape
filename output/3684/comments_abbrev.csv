Diapolo,2014-02-16T21:40:11Z,"Can please somone update @BitcoinPullTester to use current libs?\n\n<pre>\npaymentrequestplus.cpp: In member function â€˜bool PaymentRequestPlus::getMerchant(X509_STORE*, QString&, QString&) constâ€™:\npaymentrequestplus.cpp:105: error: â€˜class QSslCertificateâ€™ has no member named â€˜toTextâ€™\n</pre>\n\nWill rework to be compatible with Qt 4...\n",https://github.com/bitcoin/bitcoin/pull/3684#issuecomment-35214704,35214704,
cozz,2014-02-16T22:05:34Z,"So we do not allow Insecure payment requests in general anymore?\nrecipient.authenticatedMerchant is empty in this case, we show a yellow instead of green background there. Maybe handling this like the webbrowsers do?: \nShow a big fat warning (just a yellow background is too nice for an invalid certificate), but you can still send the transaction if you want to. But strongly recommended to not co",https://github.com/bitcoin/bitcoin/pull/3684#issuecomment-35217232,35217232,
Diapolo,2014-02-16T22:26:53Z,"My fault, I didn't want to block insecure payment requests... I was aiming for a quick fix for 0.9, as @laanwj sais, GUI can be improved in a later pull ;).\n",https://github.com/bitcoin/bitcoin/pull/3684#issuecomment-35218299,35218299,
cozz,2014-02-16T22:40:56Z,"Yes, I was wondering about issue #3628 too. But as far as I have tested this, there is no bug.\nThe return value of getMerchant() is ignored, this is confusing, but QString& merchant is passed by reference, so recipient.authenticatedMerchant. This string is empty or not whether the certificate is valid or not. So thats our ""bool"" return value.\nSo if the string is empty we show a yellow background",https://github.com/bitcoin/bitcoin/pull/3684#issuecomment-35218718,35218718,
Diapolo,2014-02-17T07:14:34Z,"@cozz Can you take another look, now insecure payment requests are possible, but errors are shown to user (not final but just to see I'm on track).\n",https://github.com/bitcoin/bitcoin/pull/3684#issuecomment-35233297,35233297,
cozz,2014-02-17T07:46:47Z,"Yes, I would say on track :)\nSo pki == ""none"" ends up with the yellow background now.\n\nTo be honest I am not sure by myself what the expected behavior should be for an invalid certificate. There could be a temporary issue with the certificate. To not drive a store out of business in this case, maybe give the user an option to make an insecure payment request instead. But I can not judge, if thi",https://github.com/bitcoin/bitcoin/pull/3684#issuecomment-35234696,35234696,
laanwj,2014-02-17T08:00:13Z,"@cozz I think invalid certificates should be treated like missing certificates but there should be a warning that the certificate is invalid (to aid people building sites that issue them).\n(as it just as easy for an attacker to strip the signature than corrupt it, it makes no sense to distinguish them in 'severenes' - IMO)\n",https://github.com/bitcoin/bitcoin/pull/3684#issuecomment-35235368,35235368,
ryanxcharles,2014-02-17T17:37:53Z,"I get this error trying to build this pull request:\n\nUndefined symbols for architecture x86_64:\n  ""PaymentRequestPlus::getMerchant(x509_store_st*, QString&, QString&) const"", referenced from:\n      PaymentServerTests::paymentServerTests() in test_bitcoin_qt-paymentservertests.o\nld: symbol(s) not found for architecture x86_64\n",https://github.com/bitcoin/bitcoin/pull/3684#issuecomment-35306037,35306037,
luke-jr,2014-02-21T03:24:49Z,@Diapolo Please stop trying to force dependency upgrades without discussion. We should remain compatible with the versions packaged by major stable distros. That currently means Qt 4.6.2 (limited by RedHat). I'm pretty sure PullTester's is not older than that...\n,https://github.com/bitcoin/bitcoin/pull/3684#issuecomment-35695898,35695898,
Diapolo,2014-02-21T08:09:32Z,To quote myself:\n`Will rework to be compatible with Qt 4...`\n,https://github.com/bitcoin/bitcoin/pull/3684#issuecomment-35706925,35706925,
laanwj,2014-02-21T08:46:21Z,In a way it's good that pulltester tests with old libraries. My gut feeling is that none of the devs builds regularly against Qt4 (certainly not pre-4.8) anymore.\n,https://github.com/bitcoin/bitcoin/pull/3684#issuecomment-35708871,35708871,
mikehearn,2014-02-27T11:48:00Z,"Sorry to weigh in late but I was away and am still catching up.\n\nPlease don't expose validation errors to users. Just silently fall back to treating them as if they were unsigned (and print errors to the logs). That way we can extend with new features later and even if they aren't fully backwards compatible, the worst that happens is some users see unverified requests instead of errors they almo",https://github.com/bitcoin/bitcoin/pull/3684#issuecomment-36234113,36234113,
laanwj,2014-07-01T08:38:11Z,"OK, won't show it to users. But better logging to the debug log is welcome.\n\nBtw, we should change the Qt logging around a bit. Currently _all_ log messages from the GUI are ignored unless `-debug=qt` is provided. IMO this should only apply to QtDebugMsg. QtWarningMsg/QtCriticalMsg/QtFatalMsg/QtSystemMsg should always be LogPrintf'ed.\n\nProblems with Payment requests should at least have level ",https://github.com/bitcoin/bitcoin/pull/3684#issuecomment-47630869,47630869,
Diapolo,2014-07-01T08:44:20Z,"Agreed on the logging change for Qt, even if this not the scope of this request.\nWe still have the serious problem that we don't check `request.getMerchant()` for success, which means current implementation of PRs is potential ""unsafe"". Will update this pull so that we log errors and don't allow `request.getMerchant()` to fail, but don't show the actual errors to users.\n",https://github.com/bitcoin/bitcoin/pull/3684#issuecomment-47631410,47631410,
Diapolo,2014-07-01T09:03:36Z,"Damn, there is a problem with my assumption! Look at `request.getMerchant(PaymentServer::certStore, recipient.authenticatedMerchant` for insecure payment requests this call is allowed to fail, but for secure payment requests this should not be allowed to fail. An insecure PR has `pki_type == none`. @mikehearn Can you shed some light on this?\n",https://github.com/bitcoin/bitcoin/pull/3684#issuecomment-47633036,47633036,
BitcoinPullTester,2014-07-01T09:32:08Z,"Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/p3684_114c38c09a913749c4bdf9d125a944c5024fad58/ for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-te",https://github.com/bitcoin/bitcoin/pull/3684#issuecomment-47635596,47635596,
Diapolo,2014-07-01T09:42:06Z,What about making `getMerchant()` return true `if (pki_type == none)` and reworking the comment on what `getMerchant()` returns true for insecure payment requests (that set `pki_type = none`) and true for secure payment requests only if no cert errors occur?\n,https://github.com/bitcoin/bitcoin/pull/3684#issuecomment-47636477,47636477,
laanwj,2014-07-01T13:32:31Z,"@diapolo Re: logging see #4448 \n\nAs for 'secure' and 'insecure' payment requests, `getMerchant` must return false when no authenticated merchant could be extracted from the request. This can be either due to an error or due to the request not being signed at all. These cases don't need to be distinguished. \n\nAlso, the output argument **QString merchant** must be empty after the call _unless_ t",https://github.com/bitcoin/bitcoin/pull/3684#issuecomment-47655920,47655920,
laanwj,2014-07-09T14:55:55Z,"Closing this pull, as we don't want to show these problems to the user, but just want to log them (which already happens).\nIf you want you can move the unrelated message change in `src/qt/transactiondesc.cpp` to a new pull.\n",https://github.com/bitcoin/bitcoin/pull/3684#issuecomment-48483643,48483643,
