[
  {
    "sha": "63f21d27ee463dafc32982d1ac50a1032449dd36",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2M2YyMWQyN2VlNDYzZGFmYzMyOTgyZDFhYzUwYTEwMzI0NDlkZDM2",
    "commit": {
      "author": {
        "name": "practicalswift",
        "email": "practicalswift@users.noreply.github.com",
        "date": "2017-11-21T17:02:57Z"
      },
      "committer": {
        "name": "practicalswift",
        "email": "practicalswift@users.noreply.github.com",
        "date": "2017-11-21T17:02:57Z"
      },
      "message": "net: Add missing locks in net.{cpp,h}\n\n* writing variable 'nTotalBytesRecv' requires holding mutex 'cs_totalBytesRecv' exclusively\n* writing variables 'nTotalBytesSent'/'nMaxOutboundTotalBytesSentInCycle'/'nMaxOutboundCycleStartTime' require holding mutex 'cs_totalBytesSent' exclusively\n* writing variable 'nMaxOutboundTimeframe'/'nMaxOutboundLimit' require holding mutex 'cs_totalBytesSent' exclusively\n* writing variable 'vAddedNodes' requires holding mutex 'cs_vAddedNodes' exclusively",
      "tree": {
        "sha": "9dcc4df50457b1ce4bbd2a80baa69c8e068245cd",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9dcc4df50457b1ce4bbd2a80baa69c8e068245cd"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/63f21d27ee463dafc32982d1ac50a1032449dd36",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/63f21d27ee463dafc32982d1ac50a1032449dd36",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/63f21d27ee463dafc32982d1ac50a1032449dd36",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/63f21d27ee463dafc32982d1ac50a1032449dd36/comments",
    "author": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "d4267a3ab271d9affd3c1b0c2e30062490af804e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d4267a3ab271d9affd3c1b0c2e30062490af804e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/d4267a3ab271d9affd3c1b0c2e30062490af804e"
      }
    ],
    "stats": {
      "total": 26,
      "additions": 19,
      "deletions": 7
    },
    "files": [
      {
        "sha": "12a0820a492fb025b1e8e261f397712e5e2ae6b7",
        "filename": "src/net.cpp",
        "status": "modified",
        "additions": 10,
        "deletions": 4,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/63f21d27ee463dafc32982d1ac50a1032449dd36/src/net.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/63f21d27ee463dafc32982d1ac50a1032449dd36/src/net.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.cpp?ref=63f21d27ee463dafc32982d1ac50a1032449dd36",
        "patch": "@@ -2269,10 +2269,16 @@ bool CConnman::Start(CScheduler& scheduler, const Options& connOptions)\n {\n     Init(connOptions);\n \n-    nTotalBytesRecv = 0;\n-    nTotalBytesSent = 0;\n-    nMaxOutboundTotalBytesSentInCycle = 0;\n-    nMaxOutboundCycleStartTime = 0;\n+    {\n+        LOCK(cs_totalBytesRecv);\n+        nTotalBytesRecv = 0;\n+    }\n+    {\n+        LOCK(cs_totalBytesSent);\n+        nTotalBytesSent = 0;\n+        nMaxOutboundTotalBytesSentInCycle = 0;\n+        nMaxOutboundCycleStartTime = 0;\n+    }\n \n     if (fListen && !InitBinds(connOptions.vBinds, connOptions.vWhiteBinds)) {\n         if (clientInterface) {"
      },
      {
        "sha": "ffe33ea6acbac8616e136924d93b1f6abe1cec2b",
        "filename": "src/net.h",
        "status": "modified",
        "additions": 9,
        "deletions": 3,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/63f21d27ee463dafc32982d1ac50a1032449dd36/src/net.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/63f21d27ee463dafc32982d1ac50a1032449dd36/src/net.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.h?ref=63f21d27ee463dafc32982d1ac50a1032449dd36",
        "patch": "@@ -158,10 +158,16 @@ class CConnman\n         m_msgproc = connOptions.m_msgproc;\n         nSendBufferMaxSize = connOptions.nSendBufferMaxSize;\n         nReceiveFloodSize = connOptions.nReceiveFloodSize;\n-        nMaxOutboundTimeframe = connOptions.nMaxOutboundTimeframe;\n-        nMaxOutboundLimit = connOptions.nMaxOutboundLimit;\n+        {\n+            LOCK(cs_totalBytesSent);\n+            nMaxOutboundTimeframe = connOptions.nMaxOutboundTimeframe;\n+            nMaxOutboundLimit = connOptions.nMaxOutboundLimit;\n+        }\n         vWhitelistedRange = connOptions.vWhitelistedRange;\n-        vAddedNodes = connOptions.m_added_nodes;\n+        {\n+            LOCK(cs_vAddedNodes);\n+            vAddedNodes = connOptions.m_added_nodes;\n+        }\n     }\n \n     CConnman(uint64_t seed0, uint64_t seed1);"
      }
    ]
  },
  {
    "sha": "bfb0c0a5b75da43d6aa829ef5d632fa9c56c51e7",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiZmIwYzBhNWI3NWRhNDNkNmFhODI5ZWY1ZDYzMmZhOWM1NmM1MWU3",
    "commit": {
      "author": {
        "name": "practicalswift",
        "email": "practicalswift@users.noreply.github.com",
        "date": "2017-11-23T06:55:45Z"
      },
      "committer": {
        "name": "practicalswift",
        "email": "practicalswift@users.noreply.github.com",
        "date": "2017-11-23T06:59:58Z"
      },
      "message": "Add Clang thread safety analysis annotations",
      "tree": {
        "sha": "fb0e222c5de264bf782d33c848be81a2025ef8b2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fb0e222c5de264bf782d33c848be81a2025ef8b2"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bfb0c0a5b75da43d6aa829ef5d632fa9c56c51e7",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bfb0c0a5b75da43d6aa829ef5d632fa9c56c51e7",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/bfb0c0a5b75da43d6aa829ef5d632fa9c56c51e7",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bfb0c0a5b75da43d6aa829ef5d632fa9c56c51e7/comments",
    "author": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "63f21d27ee463dafc32982d1ac50a1032449dd36",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/63f21d27ee463dafc32982d1ac50a1032449dd36",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/63f21d27ee463dafc32982d1ac50a1032449dd36"
      }
    ],
    "stats": {
      "total": 14,
      "additions": 7,
      "deletions": 7
    },
    "files": [
      {
        "sha": "d0fd05097017a258091199cf610e07f5375e6a6c",
        "filename": "src/net.h",
        "status": "modified",
        "additions": 7,
        "deletions": 7,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bfb0c0a5b75da43d6aa829ef5d632fa9c56c51e7/src/net.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bfb0c0a5b75da43d6aa829ef5d632fa9c56c51e7/src/net.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.h?ref=bfb0c0a5b75da43d6aa829ef5d632fa9c56c51e7",
        "patch": "@@ -370,14 +370,14 @@ class CConnman\n     // Network usage totals\n     CCriticalSection cs_totalBytesRecv;\n     CCriticalSection cs_totalBytesSent;\n-    uint64_t nTotalBytesRecv;\n-    uint64_t nTotalBytesSent;\n+    uint64_t nTotalBytesRecv GUARDED_BY(cs_totalBytesRecv);\n+    uint64_t nTotalBytesSent GUARDED_BY(cs_totalBytesSent);\n \n     // outbound limit & stats\n-    uint64_t nMaxOutboundTotalBytesSentInCycle;\n-    uint64_t nMaxOutboundCycleStartTime;\n-    uint64_t nMaxOutboundLimit;\n-    uint64_t nMaxOutboundTimeframe;\n+    uint64_t nMaxOutboundTotalBytesSentInCycle GUARDED_BY(cs_totalBytesSent);\n+    uint64_t nMaxOutboundCycleStartTime GUARDED_BY(cs_totalBytesSent);\n+    uint64_t nMaxOutboundLimit GUARDED_BY(cs_totalBytesSent);\n+    uint64_t nMaxOutboundTimeframe GUARDED_BY(cs_totalBytesSent);\n \n     // Whitelisted ranges. Any node connecting from these is automatically\n     // whitelisted (as well as those connecting to whitelisted binds).\n@@ -395,7 +395,7 @@ class CConnman\n     CAddrMan addrman;\n     std::deque<std::string> vOneShots;\n     CCriticalSection cs_vOneShots;\n-    std::vector<std::string> vAddedNodes;\n+    std::vector<std::string> vAddedNodes GUARDED_BY(cs_vAddedNodes);\n     CCriticalSection cs_vAddedNodes;\n     std::vector<CNode*> vNodes;\n     std::list<CNode*> vNodesDisconnected;"
      }
    ]
  }
]