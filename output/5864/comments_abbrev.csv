sipa,2015-03-07T12:11:28Z,"Seems very reasonable to me. Even if this doesn't fix anything, it should be safe.\n",https://github.com/bitcoin/bitcoin/pull/5864#issuecomment-77686809,77686809,
pstratem,2015-03-09T05:37:32Z,I ran into this issue today.\n\nPower failured during IBD.\n\nRestarted with -reindex=1\n\nWaited for IBD to finish and then called getblock RPC call for all blocks and got about a dozen ReadBlockFromDisk\n,https://github.com/bitcoin/bitcoin/pull/5864#issuecomment-77802807,77802807,
morcos,2015-03-09T18:54:25Z,"I tested this in the this little RPC test, https://gist.github.com/morcos/ae506817284cd776d5b2.\nWarning it does some raw file IO to munge your block files.\nTested and works with and without the suggested change, but fails on master.\n",https://github.com/bitcoin/bitcoin/pull/5864#issuecomment-77918362,77918362,
theuni,2015-03-09T19:55:07Z,"Updated for @laanwj's suggestion.\n\n@morcos Big thanks for that, much nicer than my manual testnet dd+hexedit hackery :)\n",https://github.com/bitcoin/bitcoin/pull/5864#issuecomment-77929068,77929068,
laanwj,2015-03-11T07:48:09Z,Cherry-picked to 0.10 as 002c8a24119d205b09ee10484097a4b18f4a17a9\n,https://github.com/bitcoin/bitcoin/pull/5864#issuecomment-78218305,78218305,
laanwj,2015-03-09T08:26:57Z,"Looks good to me, although I'm not sure about the `fKnown && vinfoBlockFile[nFile].nSize >= (pos.nPos + nAddSize)` case. Would we want to increase nSize at all? Or is this better:\n\n``` c++\nif (fKnown)\n    vinfoBlockFile[nFile].nSize = std::max(pos.nPos + nAddSize, vinfoBlockFile[nFile].nSize);\nelse\n    vinfoBlockFile[nFile].nSize += nAddSize;\n```\n",https://github.com/bitcoin/bitcoin/pull/5864#discussion_r26020106,26020106,src/main.cpp
sipa,2015-03-09T10:05:24Z,ACK this suggested change.\n,https://github.com/bitcoin/bitcoin/pull/5864#discussion_r26024283,26024283,src/main.cpp
jgarzik,2015-03-09T12:00:39Z,+1\n,https://github.com/bitcoin/bitcoin/pull/5864#discussion_r26029884,26029884,src/main.cpp
eN0Rm,2015-03-09T14:02:13Z,"When can I fetch latest source code, compile and test?\n\nOn Mon, Mar 9, 2015 at 1:01 PM, Jeff Garzik notifications@github.com\nwrote:\n\n> In src/main.cpp\n> https://github.com/bitcoin/bitcoin/pull/5864#discussion_r26029884:\n> \n> > ```\n> >  vinfoBlockFile[nFile].AddBlock(nHeight, nTime);\n> > ```\n> > -    if (fKnown && vinfoBlockFile[nFile].nSize < (pos.nPos + nAddSize))\n> > -        vinfoBl",https://github.com/bitcoin/bitcoin/pull/5864#discussion_r26037016,26037016,src/main.cpp
theuni,2015-03-09T18:40:47Z,"@laanwj Yes, thanks for catching that.\n",https://github.com/bitcoin/bitcoin/pull/5864#discussion_r26062658,26062658,src/main.cpp
