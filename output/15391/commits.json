[
  {
    "sha": "7cee85807c4db679003c6659d247a2fe74c2464a",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3Y2VlODU4MDdjNGRiNjc5MDAzYzY2NTlkMjQ3YTJmZTc0YzI0NjRh",
    "commit": {
      "author": {
        "name": "practicalswift",
        "email": "practicalswift@users.noreply.github.com",
        "date": "2019-02-11T22:52:59Z"
      },
      "committer": {
        "name": "practicalswift",
        "email": "practicalswift@users.noreply.github.com",
        "date": "2019-02-14T15:10:02Z"
      },
      "message": "Add compile time verification of assumptions we're currently making implicitly/tacitly",
      "tree": {
        "sha": "5d4c1c0c326b096b2e4adce6ec630f256bc12b08",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5d4c1c0c326b096b2e4adce6ec630f256bc12b08"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7cee85807c4db679003c6659d247a2fe74c2464a",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7cee85807c4db679003c6659d247a2fe74c2464a",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/7cee85807c4db679003c6659d247a2fe74c2464a",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7cee85807c4db679003c6659d247a2fe74c2464a/comments",
    "author": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "1bc149d05b09d716723d2f091250fab38fd70fc2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1bc149d05b09d716723d2f091250fab38fd70fc2",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/1bc149d05b09d716723d2f091250fab38fd70fc2"
      }
    ],
    "stats": {
      "total": 51,
      "additions": 51,
      "deletions": 0
    },
    "files": [
      {
        "sha": "a08e7fa4656b9a3ac1f3c801e32d3a480f9b4740",
        "filename": "src/Makefile.am",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7cee85807c4db679003c6659d247a2fe74c2464a/src/Makefile.am",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7cee85807c4db679003c6659d247a2fe74c2464a/src/Makefile.am",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.am?ref=7cee85807c4db679003c6659d247a2fe74c2464a",
        "patch": "@@ -118,6 +118,7 @@ BITCOIN_CORE_H = \\\n   clientversion.h \\\n   coins.h \\\n   compat.h \\\n+  compat/assumptions.h \\\n   compat/byteswap.h \\\n   compat/endian.h \\\n   compat/sanity.h \\"
      },
      {
        "sha": "820c9b93d912b33bb04775afc5455154c60244d7",
        "filename": "src/compat/assumptions.h",
        "status": "added",
        "additions": 49,
        "deletions": 0,
        "changes": 49,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7cee85807c4db679003c6659d247a2fe74c2464a/src/compat/assumptions.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7cee85807c4db679003c6659d247a2fe74c2464a/src/compat/assumptions.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/compat/assumptions.h?ref=7cee85807c4db679003c6659d247a2fe74c2464a",
        "patch": "@@ -0,0 +1,49 @@\n+// Copyright (c) 2009-2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2019 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+// Compile-time verification of assumptions we make.\n+\n+#ifndef BITCOIN_COMPAT_ASSUMPTIONS_H\n+#define BITCOIN_COMPAT_ASSUMPTIONS_H\n+\n+#include <limits>\n+\n+// Assumption: We assume that the macro NDEBUG is not defined.\n+// Example(s): We use assert(...) extensively with the assumption of it never\n+//             being a noop at runtime.\n+#if defined(NDEBUG)\n+# error \"Bitcoin cannot be compiled without assertions.\"\n+#endif\n+\n+// Assumption: We assume the floating-point types to fulfill the requirements of\n+//             IEC 559 (IEEE 754) standard.\n+// Example(s): Floating-point division by zero in ConnectBlock, CreateTransaction\n+//             and EstimateMedianVal.\n+static_assert(std::numeric_limits<float>::is_iec559, \"IEEE 754 float assumed\");\n+static_assert(std::numeric_limits<double>::is_iec559, \"IEEE 754 double assumed\");\n+\n+// Assumption: We assume eight bits per byte (obviously, but remember: don't\n+//             trust -- verify!).\n+// Example(s): Everywhere :-)\n+static_assert(std::numeric_limits<unsigned char>::digits == 8, \"8-bit byte assumed\");\n+\n+// Assumption: We assume floating-point widths.\n+// Example(s): Type punning in serialization code (ser_{float,double}_to_uint{32,64}).\n+static_assert(sizeof(float) == 4, \"32-bit float assumed\");\n+static_assert(sizeof(double) == 8, \"64-bit double assumed\");\n+\n+// Assumption: We assume integer widths.\n+// Example(s): GetSizeOfCompactSize and WriteCompactSize in the serialization\n+//             code.\n+static_assert(sizeof(short) == 2, \"16-bit short assumed\");\n+static_assert(sizeof(int) == 4, \"32-bit int assumed\");\n+\n+// Some important things we are NOT assuming (non-exhaustive list):\n+// * We are NOT assuming a specific value for sizeof(std::size_t).\n+// * We are NOT assuming a specific value for std::endian::native.\n+// * We are NOT assuming a specific value for std::locale(\"\").name().\n+// * We are NOT assuming a specific value for std::numeric_limits<char>::is_signed.\n+\n+#endif // BITCOIN_COMPAT_ASSUMPTIONS_H"
      },
      {
        "sha": "36c13ada1d6931a6421a932364b2d734b1586c32",
        "filename": "src/util/system.h",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7cee85807c4db679003c6659d247a2fe74c2464a/src/util/system.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7cee85807c4db679003c6659d247a2fe74c2464a/src/util/system.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util/system.h?ref=7cee85807c4db679003c6659d247a2fe74c2464a",
        "patch": "@@ -16,6 +16,7 @@\n \n #include <attributes.h>\n #include <compat.h>\n+#include <compat/assumptions.h>\n #include <fs.h>\n #include <logging.h>\n #include <sync.h>"
      }
    ]
  }
]