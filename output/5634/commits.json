[
  {
    "sha": "488ed32f2ada1d1dd108fc245d025c4d5f252783",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0ODhlZDMyZjJhZGExZDFkZDEwOGZjMjQ1ZDAyNWM0ZDVmMjUyNzgz",
    "commit": {
      "author": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2015-01-09T21:39:12Z"
      },
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2015-01-10T02:31:31Z"
      },
      "message": "consensus: guard against openssl's new strict DER checks\n\nNew versions of OpenSSL will reject non-canonical DER signatures. However,\nit'll happily decode them. Decode then re-encode before verification in order\nto ensure that it is properly consumed.",
      "tree": {
        "sha": "8fa890506b4568b7a5d25f3117cbdb7d6d6517ad",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8fa890506b4568b7a5d25f3117cbdb7d6d6517ad"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/488ed32f2ada1d1dd108fc245d025c4d5f252783",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/488ed32f2ada1d1dd108fc245d025c4d5f252783",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/488ed32f2ada1d1dd108fc245d025c4d5f252783",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/488ed32f2ada1d1dd108fc245d025c4d5f252783/comments",
    "author": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "d0c97bbe70a6876dadedfbf672387371c9c849d1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d0c97bbe70a6876dadedfbf672387371c9c849d1",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/d0c97bbe70a6876dadedfbf672387371c9c849d1"
      }
    ],
    "stats": {
      "total": 16,
      "additions": 13,
      "deletions": 3
    },
    "files": [
      {
        "sha": "33dd9a9a2939a325fbac4859170043587027b761",
        "filename": "src/ecwrapper.cpp",
        "status": "modified",
        "additions": 13,
        "deletions": 3,
        "changes": 16,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/488ed32f2ada1d1dd108fc245d025c4d5f252783/src/ecwrapper.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/488ed32f2ada1d1dd108fc245d025c4d5f252783/src/ecwrapper.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/ecwrapper.cpp?ref=488ed32f2ada1d1dd108fc245d025c4d5f252783",
        "patch": "@@ -117,10 +117,20 @@ bool CECKey::SetPubKey(const unsigned char* pubkey, size_t size) {\n }\n \n bool CECKey::Verify(const uint256 &hash, const std::vector<unsigned char>& vchSig) {\n-    // -1 = error, 0 = bad sig, 1 = good\n-    if (ECDSA_verify(0, (unsigned char*)&hash, sizeof(hash), &vchSig[0], vchSig.size(), pkey) != 1)\n+    // New versions of OpenSSL will reject non-canonical DER signatures. de/re-serialize first.\n+    unsigned char *norm_der = NULL;\n+    ECDSA_SIG *norm_sig = ECDSA_SIG_new();\n+    const unsigned char* sigptr = &vchSig[0];\n+    d2i_ECDSA_SIG(&norm_sig, &sigptr, vchSig.size());\n+    int derlen = i2d_ECDSA_SIG(norm_sig, &norm_der);\n+    ECDSA_SIG_free(norm_sig);\n+    if (derlen <= 0)\n         return false;\n-    return true;\n+\n+    // -1 = error, 0 = bad sig, 1 = good\n+    bool ret = ECDSA_verify(0, (unsigned char*)&hash, sizeof(hash), norm_der, derlen, pkey) == 1;\n+    OPENSSL_free(norm_der);\n+    return ret;\n }\n \n bool CECKey::Recover(const uint256 &hash, const unsigned char *p64, int rec)"
      }
    ]
  },
  {
    "sha": "dad7764a9dedb1143b6ea8bfd37f71f7ff72f518",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkYWQ3NzY0YTlkZWRiMTE0M2I2ZWE4YmZkMzdmNzFmN2ZmNzJmNTE4",
    "commit": {
      "author": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2015-01-10T01:52:55Z"
      },
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2015-01-10T02:31:38Z"
      },
      "message": "depends: bump openssl to 1.0.1k",
      "tree": {
        "sha": "cfbb28ebbf1fd6069db0c4c1eabef8a8ea40c116",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/cfbb28ebbf1fd6069db0c4c1eabef8a8ea40c116"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dad7764a9dedb1143b6ea8bfd37f71f7ff72f518",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dad7764a9dedb1143b6ea8bfd37f71f7ff72f518",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/dad7764a9dedb1143b6ea8bfd37f71f7ff72f518",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dad7764a9dedb1143b6ea8bfd37f71f7ff72f518/comments",
    "author": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "488ed32f2ada1d1dd108fc245d025c4d5f252783",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/488ed32f2ada1d1dd108fc245d025c4d5f252783",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/488ed32f2ada1d1dd108fc245d025c4d5f252783"
      }
    ],
    "stats": {
      "total": 4,
      "additions": 2,
      "deletions": 2
    },
    "files": [
      {
        "sha": "32eb1e65395d1f0df3951df0501044d2c605f68c",
        "filename": "depends/packages/openssl.mk",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/dad7764a9dedb1143b6ea8bfd37f71f7ff72f518/depends/packages/openssl.mk",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/dad7764a9dedb1143b6ea8bfd37f71f7ff72f518/depends/packages/openssl.mk",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/packages/openssl.mk?ref=dad7764a9dedb1143b6ea8bfd37f71f7ff72f518",
        "patch": "@@ -1,8 +1,8 @@\n package=openssl\n-$(package)_version=1.0.1j\n+$(package)_version=1.0.1k\n $(package)_download_path=https://www.openssl.org/source\n $(package)_file_name=$(package)-$($(package)_version).tar.gz\n-$(package)_sha256_hash=1b60ca8789ba6f03e8ef20da2293b8dc131c39d83814e775069f02d26354edf3\n+$(package)_sha256_hash=8f9faeaebad088e772f4ef5e38252d472be4d878c6b3a2718c10a4fcebe7a41c\n \n define $(package)_set_vars\n $(package)_config_env=AR=\"$($(package)_ar)\" RANLIB=\"$($(package)_ranlib)\" CC=\"$($(package)_cc)\""
      }
    ]
  },
  {
    "sha": "8dccba6a45db0466370726ed462b9da2eae43bce",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4ZGNjYmE2YTQ1ZGIwNDY2MzcwNzI2ZWQ0NjJiOWRhMmVhZTQzYmNl",
    "commit": {
      "author": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2015-01-10T03:06:08Z"
      },
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2015-01-10T03:06:55Z"
      },
      "message": "fail immediately on an empty signature",
      "tree": {
        "sha": "44083128b139ad0171401972140430fd99cb4d32",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/44083128b139ad0171401972140430fd99cb4d32"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8dccba6a45db0466370726ed462b9da2eae43bce",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/8dccba6a45db0466370726ed462b9da2eae43bce",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/8dccba6a45db0466370726ed462b9da2eae43bce",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/8dccba6a45db0466370726ed462b9da2eae43bce/comments",
    "author": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "dad7764a9dedb1143b6ea8bfd37f71f7ff72f518",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dad7764a9dedb1143b6ea8bfd37f71f7ff72f518",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/dad7764a9dedb1143b6ea8bfd37f71f7ff72f518"
      }
    ],
    "stats": {
      "total": 3,
      "additions": 3,
      "deletions": 0
    },
    "files": [
      {
        "sha": "0236e90c166e6c57f45b419f1051d6b00bc02b47",
        "filename": "src/ecwrapper.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/8dccba6a45db0466370726ed462b9da2eae43bce/src/ecwrapper.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/8dccba6a45db0466370726ed462b9da2eae43bce/src/ecwrapper.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/ecwrapper.cpp?ref=8dccba6a45db0466370726ed462b9da2eae43bce",
        "patch": "@@ -117,6 +117,9 @@ bool CECKey::SetPubKey(const unsigned char* pubkey, size_t size) {\n }\n \n bool CECKey::Verify(const uint256 &hash, const std::vector<unsigned char>& vchSig) {\n+    if (vchSig.empty())\n+        return false;\n+\n     // New versions of OpenSSL will reject non-canonical DER signatures. de/re-serialize first.\n     unsigned char *norm_der = NULL;\n     ECDSA_SIG *norm_sig = ECDSA_SIG_new();"
      }
    ]
  }
]