BitcoinPullTester,2014-02-11T15:47:05Z,"Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/1bbca249b202c4802cc2c4d4de4a26e6392b4d92 for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/cu",https://github.com/bitcoin/bitcoin/pull/3651#issuecomment-34766933,34766933,
petertodd,2014-02-11T16:31:35Z,Might make sense to make it -minconfstospend so you can ask for more than one confirmation for those who can wait. (reorgs)\n,https://github.com/bitcoin/bitcoin/pull/3651#issuecomment-34772077,34772077,
gavinandresen,2014-02-11T16:40:46Z,ACK code changes.\n,https://github.com/bitcoin/bitcoin/pull/3651#issuecomment-34773112,34773112,
laanwj,2014-02-11T16:59:36Z,"Note that getbalance will still be counting unconfirmed change after this patch. GetBalance doesn't use AvailableCoins.\n\nAnother option that _would_ affect the balance computation as well as coin selection may be to put the condition in CWalletTx::IsConfirmed instead (here https://github.com/bitcoin/bitcoin/blob/master/src/wallet.h#L707).\n\nThis would change the functionality from ""don't spend ",https://github.com/bitcoin/bitcoin/pull/3651#issuecomment-34775226,34775226,
sipa,2014-02-11T17:06:19Z,Setting minconf=1 on send\* RPCs should have the same effect.\n,https://github.com/bitcoin/bitcoin/pull/3651#issuecomment-34775943,34775943,
petertodd,2014-02-11T17:07:08Z,The impression I get is the getbalance issue is less important than ensuring unconfirmed tx's don't get spent; I'd get this patch done and do something more complex with getbalance later.\n\n@sipa Good point!\n,https://github.com/bitcoin/bitcoin/pull/3651#issuecomment-34776050,34776050,
petertodd,2014-02-11T17:07:26Z,This patch is useful for all users too after all.\n,https://github.com/bitcoin/bitcoin/pull/3651#issuecomment-34776086,34776086,
sipa,2014-02-11T17:09:07Z,"An alternative to this is just checking whether unconfirmed coins are in the mempool, before considering them available. That will be more transparent, should always be right, and less restrictive.\n",https://github.com/bitcoin/bitcoin/pull/3651#issuecomment-34776346,34776346,
petertodd,2014-02-11T17:10:26Z,@sipa That doesn't fix the issue; they could be mutated in a mempool elsewhere.\n,https://github.com/bitcoin/bitcoin/pull/3651#issuecomment-34776531,34776531,
laanwj,2014-02-11T17:11:18Z,"@sipa I thought minconf wouldn't have effect on your own unconfirmed change, but that would be great, in that case no patch is needed at all.\n\nRe: checking mempool as I asked through mail would that solve all the issues? What if another transaction variant gets mined than is in the (local) mempool?\n",https://github.com/bitcoin/bitcoin/pull/3651#issuecomment-34776626,34776626,
petertodd,2014-02-11T17:12:24Z,"I mean, specifically the problem is when I tell bitcoind to make a payment, I want that payment to go through. If I spend confirmed inputs the transaction making the payment might get mutated, but it will get mined eventually and the payment will happen without any further intervention. Spending unconfirmed in a mempool doesn't have that guarantee, and similarly there's the edge case of a reorgani",https://github.com/bitcoin/bitcoin/pull/3651#issuecomment-34776759,34776759,
sipa,2014-02-11T17:13:11Z,"@laanwj When searching for coins to spend, we always consider just the confirmed ones first (and the >=6 confirmed ones before that), so preventing payments in case not enough balance exists in confirmed coins should be enough to prevent unconfirmed change from being used.\n\n@petertodd @laanwj You're right, ignore my suggestion.\n",https://github.com/bitcoin/bitcoin/pull/3651#issuecomment-34776839,34776839,
laanwj,2014-02-11T17:24:16Z,@sipa But minconf already defaults to 1 on sendfrom/sendmany. And it still spends unconfirmed change.\n,https://github.com/bitcoin/bitcoin/pull/3651#issuecomment-34778938,34778938,
sipa,2014-02-11T18:34:46Z,@laanwj In that case something is going on that I'm missing.\n,https://github.com/bitcoin/bitcoin/pull/3651#issuecomment-34788752,34788752,
gmaxwell,2014-02-11T19:09:58Z,"@laanwj All minconf does on those rpcs is changes what it checks for deciding the account has enough balance, it has no influence on coin-selection.\n",https://github.com/bitcoin/bitcoin/pull/3651#issuecomment-34792837,34792837,
gmaxwell,2014-02-11T19:18:43Z,"ACK this change, it improves a minor privacy leak too (when you spend unconfirmed change it was very very likely change, and not a third party payment). It's too disruptive to turn on by default, alas.\n",https://github.com/bitcoin/bitcoin/pull/3651#issuecomment-34794194,34794194,
petertodd,2014-02-11T19:47:06Z,"@gmaxwell Right now the alternative is more disruptive; turn it on by default. Other wallets already work that way with user acceptance, and users can easily turn it off again once malleability becomes less of a issue.\n",https://github.com/bitcoin/bitcoin/pull/3651#issuecomment-34797477,34797477,
jgarzik,2014-02-11T21:07:37Z,"Bleh, nobody will ever use this, defaulted off.\n\nACK, merge it, then let's create a new PR immediately, to discuss changing the default!  :)\n",https://github.com/bitcoin/bitcoin/pull/3651#issuecomment-34806975,34806975,
laanwj,2014-02-11T21:19:55Z,See #3654 \n,https://github.com/bitcoin/bitcoin/pull/3651#issuecomment-34808215,34808215,
dooglus,2014-02-12T01:27:00Z,"@sipa > In that case something is going on that I'm missing.\n\nI guess what's happening is that we have enough confirmed coins to make up the amount being sent, but not enough to include the required fee.  So we end up using unconfirmed change.\n",https://github.com/bitcoin/bitcoin/pull/3651#issuecomment-34829402,34829402,
sipa,2014-02-12T01:39:16Z,"That would be one hell of a coincidence, and there many people reporting failed transactions being created.\n",https://github.com/bitcoin/bitcoin/pull/3651#issuecomment-34830089,34830089,
dooglus,2014-02-12T01:55:56Z,"Maybe most of those failed transactions are created using sendtoaddress, which doesn't have a minconf argument.\n",https://github.com/bitcoin/bitcoin/pull/3651#issuecomment-34831038,34831038,
sipa,2014-02-12T02:05:51Z,"Oh, then I misread @laanwj's comment. Yeah, that would explain it...\n",https://github.com/bitcoin/bitcoin/pull/3651#issuecomment-34831590,34831590,
