[
  {
    "sha": "faacb7eadb04a8af666e7bb59bcd79915fe3a80a",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYWFjYjdlYWRiMDRhOGFmNjY2ZTdiYjU5YmNkNzk5MTVmZTNhODBh",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-05-17T08:12:36Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-05-17T08:04:53Z"
      },
      "message": "fuzz: Sanity check result of CheckTransaction",
      "tree": {
        "sha": "89a9240a618825e5c019f2bf10c03682e7d11929",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/89a9240a618825e5c019f2bf10c03682e7d11929"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/faacb7eadb04a8af666e7bb59bcd79915fe3a80a",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUh+FQv/QhxURrtbNmV54bpgo/69CL7bauTUaKbR21CSqTY3dmpjoVYwlL2HsFT5\n4I0wMNEOT65eDyTwSui1t+sBfG2FSSDB6cRuIdI/lDaAQrU9br6Ti+WtM8VLpB3M\nFUhGMrHvUFBBLUXGktOv1B3utNPAE8ndRFaab+HqJZ4VXCEGm34xmBLYUDjOqa7a\neukokf9txEKDualixQP99EZY/RhVC/yenaRWubHlDBzp4Pied31c39VlVrQOo8do\ndrV3TZL12ezMZ5tfLU8OWiEftCiiXS29H4/jxAl/eEs0mkLMtCP7FY1QBvLpq+Qr\nGfCPZ9qnYULojJGdf2iLk42BhSkKIvgfwc5XzaqPBHJxedyUe2WQpxpRcAiyF/q6\nzbHUhblenqbf3r8DjHwKlbfmLqPFIfSkdVh00fpEE+0spoi6coI/Imqo+9KruNXo\nxXJjfJqM6pJX8gbxS/2m5MB2Q70KlqciBZxWOmDQBIrzROSpKWjfn0Q1OnaFh5us\nc5AN3ymr\n=45Ez\n-----END PGP SIGNATURE-----",
        "payload": "tree 89a9240a618825e5c019f2bf10c03682e7d11929\nparent c8571486364d6e9ca8c86bd1c81e230ca64f8904\nauthor MarcoFalke <falke.marco@gmail.com> 1621239156 +0200\ncommitter MarcoFalke <falke.marco@gmail.com> 1621238693 +0200\n\nfuzz: Sanity check result of CheckTransaction\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faacb7eadb04a8af666e7bb59bcd79915fe3a80a",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/faacb7eadb04a8af666e7bb59bcd79915fe3a80a",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faacb7eadb04a8af666e7bb59bcd79915fe3a80a/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "c8571486364d6e9ca8c86bd1c81e230ca64f8904",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c8571486364d6e9ca8c86bd1c81e230ca64f8904",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/c8571486364d6e9ca8c86bd1c81e230ca64f8904"
      }
    ],
    "stats": {
      "total": 7,
      "additions": 5,
      "deletions": 2
    },
    "files": [
      {
        "sha": "797b9cea3e2fe908b6861936b1a98cdce296ca5c",
        "filename": "src/test/fuzz/transaction.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 2,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faacb7eadb04a8af666e7bb59bcd79915fe3a80a/src/test/fuzz/transaction.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faacb7eadb04a8af666e7bb59bcd79915fe3a80a/src/test/fuzz/transaction.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/transaction.cpp?ref=faacb7eadb04a8af666e7bb59bcd79915fe3a80a",
        "patch": "@@ -61,8 +61,11 @@ FUZZ_TARGET_INIT(transaction, initialize_transaction)\n         return;\n     }\n \n-    TxValidationState state_with_dupe_check;\n-    (void)CheckTransaction(tx, state_with_dupe_check);\n+    {\n+        TxValidationState state_with_dupe_check;\n+        const bool res{CheckTransaction(tx, state_with_dupe_check)};\n+        Assert(res == state_with_dupe_check.IsValid());\n+    }\n \n     const CFeeRate dust_relay_fee{DUST_RELAY_TX_FEE};\n     std::string reason;"
      }
    ]
  },
  {
    "sha": "fae4ee545a652cc2934773b0e1fdb9004b0c5ba6",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYWU0ZWU1NDVhNjUyY2MyOTM0NzczYjBlMWZkYjkwMDRiMGM1YmE2",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-05-17T08:05:06Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-05-17T08:04:57Z"
      },
      "message": "fuzz: Add missing CheckTransaction before CheckTxInputs",
      "tree": {
        "sha": "3bb7fea2599f753a9eb122fa024598110ff23d55",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3bb7fea2599f753a9eb122fa024598110ff23d55"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fae4ee545a652cc2934773b0e1fdb9004b0c5ba6",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUgS+Av/U/0+6ZUivYjLg3q1KuitxUbXV8DHhHZBZtQB1XgSEqBJy3oTP6tZaqE4\na02O3PTGvpzMTenWLYRXX0qD7Jv1KPpXoqUlSiczDwKB9gXZvhacndAf6+e+OPPB\nr/CvcsnoKsRZ6dBPfjbfC/enjYrjfAG3ok2jA2zGhNo4Qwuc5n3wXIh5K5MFLznk\nXZL9N17J+a5lH5gcGA5T1SXJ8IIpseHPWk+wpIOP9b8T/phzxKmMCNjDo4p7AodA\nrKIxMNOUSXmFoYfWTPYmnXGnuGs22a8fRoxRFOCYgXe/3ns70ykZxjjuEFKTPuTA\nIF1aLIcTKWXn25pphmaGc+4qnws4dhzOdfVdwtlCWCzU9hCUwRgoTpEGFPQ9VInx\nPwThzkgk91YAevYXIn11qq9gDol5XnDVr1k2auGZDSWW0Qvkrjg3cbNLD5kY2rR4\nF2ayYnJmTIOqNsLq7318kifsPFJ3dGD68EL3yZuB5p01a6qH5rf7UNVxgJOBx0V0\nfRPPxhA9\n=DFiK\n-----END PGP SIGNATURE-----",
        "payload": "tree 3bb7fea2599f753a9eb122fa024598110ff23d55\nparent faacb7eadb04a8af666e7bb59bcd79915fe3a80a\nauthor MarcoFalke <falke.marco@gmail.com> 1621238706 +0200\ncommitter MarcoFalke <falke.marco@gmail.com> 1621238697 +0200\n\nfuzz: Add missing CheckTransaction before CheckTxInputs\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fae4ee545a652cc2934773b0e1fdb9004b0c5ba6",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fae4ee545a652cc2934773b0e1fdb9004b0c5ba6",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fae4ee545a652cc2934773b0e1fdb9004b0c5ba6/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "faacb7eadb04a8af666e7bb59bcd79915fe3a80a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faacb7eadb04a8af666e7bb59bcd79915fe3a80a",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/faacb7eadb04a8af666e7bb59bcd79915fe3a80a"
      }
    ],
    "stats": {
      "total": 6,
      "additions": 6,
      "deletions": 0
    },
    "files": [
      {
        "sha": "878b5a27dada893c8cf101022911f951b2b3031c",
        "filename": "src/test/fuzz/coins_view.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 0,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fae4ee545a652cc2934773b0e1fdb9004b0c5ba6/src/test/fuzz/coins_view.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fae4ee545a652cc2934773b0e1fdb9004b0c5ba6/src/test/fuzz/coins_view.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/coins_view.cpp?ref=fae4ee545a652cc2934773b0e1fdb9004b0c5ba6",
        "patch": "@@ -6,6 +6,7 @@\n #include <chainparams.h>\n #include <chainparamsbase.h>\n #include <coins.h>\n+#include <consensus/tx_check.h>\n #include <consensus/tx_verify.h>\n #include <consensus/validation.h>\n #include <key.h>\n@@ -230,6 +231,11 @@ FUZZ_TARGET_INIT(coins_view, initialize_coins_view)\n                     // consensus/tx_verify.cpp:171: bool Consensus::CheckTxInputs(const CTransaction &, TxValidationState &, const CCoinsViewCache &, int, CAmount &): Assertion `!coin.IsSpent()' failed.\n                     return;\n                 }\n+                TxValidationState dummy;\n+                if (!CheckTransaction(transaction, dummy)) {\n+                    // It is not allowed to call CheckTxInputs if CheckTransaction failed\n+                    return;\n+                }\n                 (void)Consensus::CheckTxInputs(transaction, state, coins_view_cache, fuzzed_data_provider.ConsumeIntegralInRange<int>(0, std::numeric_limits<int>::max()), tx_fee_out);\n                 assert(MoneyRange(tx_fee_out));\n             },"
      }
    ]
  }
]