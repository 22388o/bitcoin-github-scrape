luke-jr,2012-03-21T05:18:03Z,"Don't ask me how, but this makes bitcoind and Bitcoin-Qt both segfault at startup (after "" wallet                 9172ms"")... (I didn't try to interrupt anything)\n",https://github.com/bitcoin/bitcoin/pull/959#issuecomment-4611125,4611125,
laanwj,2012-03-21T06:05:07Z,"Returning true from AppInit2 implies that initialization succeeded, it should return false when interrupted.\n",https://github.com/bitcoin/bitcoin/pull/959#issuecomment-4611487,4611487,
rebroad,2012-03-21T07:33:42Z,"@luke-jr - I'll assume you mean every time. Have you compared with the version my changes were based on? What does gdb show? My changes are so few, and especially if you're not exiting during the load, I struggle to believe it would be due to this change.\n",https://github.com/bitcoin/bitcoin/pull/959#issuecomment-4612156,4612156,
rebroad,2012-03-21T07:44:19Z,"@laanwj I initially coded it to return false but changed it to true as 1) it made the code smaller, 2) it's not failing, 3) would you normally expect a return code of false from any program that exited only because the user requested it?\n\nIn answer to 3, the answer is no, and so I believe and function should follow that logic. \n\nReturning true doesn't go against and C standards that I know of ",https://github.com/bitcoin/bitcoin/pull/959#issuecomment-4612252,4612252,
luke-jr,2012-03-21T07:54:45Z,"I couldn't get a useful backtrace out of gdb. git bisect blames this change, and indeed removing it fixes the problem.\n",https://github.com/bitcoin/bitcoin/pull/959#issuecomment-4612359,4612359,
laanwj,2012-03-21T08:03:52Z,"How does this ""make the code smaller"" if you return true? The UI code will assume that initialization was successful and display the main window, right?\n\nEdit: and yes, many programs return non-zero return status when forced to terminate by a signal.\n",https://github.com/bitcoin/bitcoin/pull/959#issuecomment-4612479,4612479,
rebroad,2012-03-21T08:03:59Z,@luke-jr What OS are you using?\n\nP.S. @luke-jr  are you sure you're not some Manchurian candidate or perhaps a cylon without knowing it?!\n,https://github.com/bitcoin/bitcoin/pull/959#issuecomment-4612480,4612480,
luke-jr,2012-03-21T08:06:52Z,Gentoo GNU/Linux (32-bit x86 stable)\n,https://github.com/bitcoin/bitcoin/pull/959#issuecomment-4612496,4612496,
rebroad,2012-03-21T08:12:01Z,@laanwj No. But if LoadBlockIndex returns false then AppInit2 will display an error without additional code.\n,https://github.com/bitcoin/bitcoin/pull/959#issuecomment-4612535,4612535,
rebroad,2012-03-21T08:13:28Z,"@luke-jr Ok, so how would you code it to allow it to be killed during the block index load?\n",https://github.com/bitcoin/bitcoin/pull/959#issuecomment-4612540,4612540,
luke-jr,2012-03-21T08:14:22Z,I don't see anything wrong with the way you did it. Maybe when I'm more awake I can be of more help tracking down the segfault.\n,https://github.com/bitcoin/bitcoin/pull/959#issuecomment-4612547,4612547,
laanwj,2012-03-21T08:16:22Z,"I'm not saying that LoadBlockIndex should return false in this case, but AppInit2 should. \n\nSee `src/qt/bitcoin.cpp`. If AppInit2 returns true, it will spin up the UI.\n",https://github.com/bitcoin/bitcoin/pull/959#issuecomment-4612561,4612561,
laanwj,2012-03-21T08:21:27Z,Though this shows the limitations of using boolean return values to signify conditions more than anything else :-)\n,https://github.com/bitcoin/bitcoin/pull/959#issuecomment-4612615,4612615,
rebroad,2012-03-21T19:52:28Z,"@laanwj - ah, so it does. Thanks, I will change this. I'm currently debugging to find the cause of the SIGSEGV @luke-jr mentioned.\n",https://github.com/bitcoin/bitcoin/pull/959#issuecomment-4625693,4625693,
rebroad,2012-03-21T23:31:05Z,"ok. There was a bug, which I've fixed with the fixup. This was also the cause of the SEGV initially reported by @luke-jr. Thanks Luke!\n",https://github.com/bitcoin/bitcoin/pull/959#issuecomment-4629590,4629590,
rebroad,2012-03-26T20:55:46Z,"Hi @luke-jr, would you be willing to ACK this please to confirm that the issue you found has been resolved please?\n",https://github.com/bitcoin/bitcoin/pull/959#issuecomment-4704027,4704027,
sipa,2012-04-04T10:42:53Z,"ACK on the changes. The direct ""return true"" from AppInit worried me, but the only thing necessary is shutting down the database environment, which happens automatically anyway.\n\nCan you rebase this into one commit though?\n",https://github.com/bitcoin/bitcoin/pull/959#issuecomment-4950953,4950953,
gavinandresen,2012-04-17T17:54:13Z,ACK assuming luke's issue isn't an issue.\n,https://github.com/bitcoin/bitcoin/pull/959#issuecomment-5181524,5181524,
jgarzik,2012-04-17T20:47:53Z,"Seems sane, though it would be nice if the two commits were combined into a single one, before it hits upstream.\n",https://github.com/bitcoin/bitcoin/pull/959#issuecomment-5185544,5185544,
luke-jr,2012-04-17T20:48:13Z,"It seems to be in the next-test that I've been using regularly for a week now, so it's probably safe.\n\nI'd want to test it out specifically before I give it an ""ACK"" myself, but don't wait on me.\n",https://github.com/bitcoin/bitcoin/pull/959#issuecomment-5185549,5185549,
rebroad,2012-04-17T23:01:43Z,"sorry I've not combined these two changes into one. If someone can tell me the git commands to do it, I'd be happy to oblige. :-s\n",https://github.com/bitcoin/bitcoin/pull/959#issuecomment-5188125,5188125,
sipa,2012-04-17T23:31:39Z,"go to your working directory, checkout this branch (""git checkout LoadBlockIndexKillable""), fetch upstream (""git fetch upstream""), rebase against master (""git rebase -i upstream/master""), you should see an editor now with two commits listed, change the ""pick"" of the second on to ""fixup"" (meaning that it needs to me combined with the previous one), save and exit the editor. You should now have a re",https://github.com/bitcoin/bitcoin/pull/959#issuecomment-5188550,5188550,
sipa,2012-04-18T11:36:30Z,"Do a ""git reset --hard"" in advance. This will throw away any local changes you may have made in the current branch. If you don't want that, commit them first. If you want to chat about it, come to #bitcoin-dev on irc.freenode.org (using an IRC client, or on http://webchat.freenode.net/?channels=bitcoin-dev)\n",https://github.com/bitcoin/bitcoin/pull/959#issuecomment-5196553,5196553,
rebroad,2012-04-18T11:37:59Z,"ok, that worked.. (except I had to do a ""git stash"" before the rebase - I'm not sure why it said there were other changes...)\n",https://github.com/bitcoin/bitcoin/pull/959#issuecomment-5196573,5196573,
sipa,2012-04-18T20:05:52Z,ACK\n,https://github.com/bitcoin/bitcoin/pull/959#issuecomment-5207437,5207437,
laanwj,2012-04-19T06:10:52Z,ACK\n,https://github.com/bitcoin/bitcoin/pull/959#issuecomment-5215546,5215546,
