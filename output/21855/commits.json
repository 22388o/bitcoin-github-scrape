[
  {
    "sha": "26e30b8dd2a96ad7c53180095e9a30a07288b45f",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyNmUzMGI4ZGQyYTk2YWQ3YzUzMTgwMDk1ZTlhMzBhMDcyODhiNDVm",
    "commit": {
      "author": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-05-04T16:57:59Z"
      },
      "committer": {
        "name": "Jon Atack",
        "email": "jon@atack.com",
        "date": "2021-05-04T16:57:59Z"
      },
      "message": "fuzz: enable passing a max value to FuzzedDataProvider::ConsumeEnum()",
      "tree": {
        "sha": "94977a0a4f65ae3568d337944c1fec364f08b9a9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/94977a0a4f65ae3568d337944c1fec364f08b9a9"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/26e30b8dd2a96ad7c53180095e9a30a07288b45f",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEd6u7+MhX7zEv6RP5T1chs9Djkh0FAmCRfRgACgkQT1chs9Dj\nkh0C3w//Zyr9HpfvyBmO1P0iT5RgVgCuWCKO+0h4orbURynTU1RkjAKlZO8UXtnG\nnhRtikp9i7G9Ll5/CndGlHMgr779ohP0TzgjJ8boMRlCtXoCZmxUGOnpKrXuebFl\nc2qumBAb7T1v6tRd6/aPMP8eHB19AJ+Z/4K97P6zq/oyEBgMcHr4p0N5mGP+vmmL\nXlw5HFiCkZPZz/qm/38Pd/QC+9uHQ3E4WfQGGqNLhSOXG5Ip+PuTTb+BdGklAKrL\nbutuiQLdzrO1qQikqEU6j8Q7FFDAga/fI5g2wRMJYkj3O7DG4nDdpb7LMju5ItsX\nNS3Prqk7njeq2J+WoRXMI2lZKiXNgfTEUc6Lx6ujnNFC+e9kO+THHt8k+XG5mNWn\nDoPqSn6HTyPFbXjIuPkPyxWRGwo4Be/yCUztAE44XQ4w+pAolJZNGIqKhI6eDV79\nN/NtiFlUQGIPdxC103kwRZ2Tzv5eptYTWaVcMscAIfErfCmg3/p8bj6N5cdMdjwS\n4TOdMbFpCJ1IRQQIRpHEjpFHYtMDOXAItrCl2bvR3PmJPE7LMDem4AOFbGNkA0Gv\ncQOzx0UWdtSkx8hKRGmluQVp2+p2ExSTHCav0gTDYXfudVz9a/kxE86zDENiY3z3\ndtzirZAMUhPRc9Kx0jxhwRKInb8Z4NOoPrOYyFJ2TBRblbWBKVU=\n=QhG+\n-----END PGP SIGNATURE-----\n-----BEGIN OPENTIMESTAMPS GIT TIMESTAMP-----\n\nAQHwIJrpUSsRMVKx31yvdiXczCnSgDFncn/NEzEfIQmKptJrCP/wEFg4JykckZ43\nRnhT8PC9Uw8I8QRgkX0Z8AgbqTUJIV2yNwCD3+MNLvkMjiMiaHR0cHM6Ly9idGMu\nY2FsZW5kYXIuY2F0YWxsYXh5LmNvbf/wEHXFWv6t42ZrcA5SfjOsPLAI8QRgkX0a\n8AiznH1KSbrMmACD3+MNLvkMjiwraHR0cHM6Ly9ib2IuYnRjLmNhbGVuZGFyLm9w\nZW50aW1lc3RhbXBzLm9yZ/AQuig1tMnoAhqE8GS3+rANvwjxBGCRfRrwCOZkmM/0\nbd6zAIPf4w0u+QyOLi1odHRwczovL2FsaWNlLmJ0Yy5jYWxlbmRhci5vcGVudGlt\nZXN0YW1wcy5vcmc=\n-----END OPENTIMESTAMPS GIT TIMESTAMP-----",
        "payload": "tree 94977a0a4f65ae3568d337944c1fec364f08b9a9\nparent 3f8f238deb5a72db04d29c899cea11df14cd984c\nauthor Jon Atack <jon@atack.com> 1620147479 +0200\ncommitter Jon Atack <jon@atack.com> 1620147479 +0200\n\nfuzz: enable passing a max value to FuzzedDataProvider::ConsumeEnum()\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/26e30b8dd2a96ad7c53180095e9a30a07288b45f",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/26e30b8dd2a96ad7c53180095e9a30a07288b45f",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/26e30b8dd2a96ad7c53180095e9a30a07288b45f/comments",
    "author": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "3f8f238deb5a72db04d29c899cea11df14cd984c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3f8f238deb5a72db04d29c899cea11df14cd984c",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/3f8f238deb5a72db04d29c899cea11df14cd984c"
      }
    ],
    "stats": {
      "total": 11,
      "additions": 5,
      "deletions": 6
    },
    "files": [
      {
        "sha": "7281f5cba61de26c66d6085f15b6e438d94fed68",
        "filename": "src/test/fuzz/FuzzedDataProvider.h",
        "status": "modified",
        "additions": 5,
        "deletions": 6,
        "changes": 11,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/26e30b8dd2a96ad7c53180095e9a30a07288b45f/src/test/fuzz/FuzzedDataProvider.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/26e30b8dd2a96ad7c53180095e9a30a07288b45f/src/test/fuzz/FuzzedDataProvider.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/FuzzedDataProvider.h?ref=26e30b8dd2a96ad7c53180095e9a30a07288b45f",
        "patch": "@@ -69,7 +69,7 @@ class FuzzedDataProvider {\n   bool ConsumeBool();\n \n   // Returns a value chosen from the given enum.\n-  template <typename T> T ConsumeEnum();\n+  template <typename T> T ConsumeEnum(T max_value);\n \n   // Returns a value from the given array.\n   template <typename T, size_t size> T PickValueInArray(const T (&array)[size]);\n@@ -289,13 +289,12 @@ inline bool FuzzedDataProvider::ConsumeBool() {\n   return 1 & ConsumeIntegral<uint8_t>();\n }\n \n-// Returns an enum value. The enum must start at 0 and be contiguous. It must\n-// also contain |kMaxValue| aliased to its largest (inclusive) value. Such as:\n-// enum class Foo { SomeValue, OtherValue, kMaxValue = OtherValue };\n-template <typename T> T FuzzedDataProvider::ConsumeEnum() {\n+// Returns an enum value. The enum must start at 0 and be contiguous up to\n+// max_value.\n+template <typename T> T FuzzedDataProvider::ConsumeEnum(T max_value) {\n   static_assert(std::is_enum<T>::value, \"|T| must be an enum type.\");\n   return static_cast<T>(\n-      ConsumeIntegralInRange<uint32_t>(0, static_cast<uint32_t>(T::kMaxValue)));\n+      ConsumeIntegralInRange<uint32_t>(0, static_cast<uint32_t>(max_value)));\n }\n \n // Returns a copy of the value selected from the given fixed-size |array|."
      }
    ]
  }
]