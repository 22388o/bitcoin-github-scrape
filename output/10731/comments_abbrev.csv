jgarzik,2017-07-03T10:03:15Z,It seems risky to put quote chars in there.,https://github.com/bitcoin/bitcoin/pull/10731#issuecomment-312604511,312604511,
luke-jr,2017-07-03T10:18:12Z,"Hmm, you mean in case someone is reading the log and inserting it into a SQL database or something?",https://github.com/bitcoin/bitcoin/pull/10731#issuecomment-312607741,312607741,
jgarzik,2017-07-03T10:25:44Z,"@luke-jr Yep.  Or it makes its way to the command line, and someone is lazy and fails to quote.  We've seen this movie before :)",https://github.com/bitcoin/bitcoin/pull/10731#issuecomment-312609473,312609473,
luke-jr,2017-07-03T21:52:56Z,"Reduced the subset to avoid quotes and other possibly dangerous characters, and just made it the default (which is only used for logging).",https://github.com/bitcoin/bitcoin/pull/10731#issuecomment-312739776,312739776,
luke-jr,2017-07-04T07:49:58Z,"I can remove `%` and `&` (although IMO this is a bit too much nannying), but `!` is needed to properly log existing UAs...",https://github.com/bitcoin/bitcoin/pull/10731#issuecomment-312806424,312806424,
MarcoFalke,2017-07-04T08:23:52Z,Concept NACK per @gmaxwell. The existing safe chars should be enough to generate any ua comment that might render useful.,https://github.com/bitcoin/bitcoin/pull/10731#issuecomment-312813953,312813953,
luke-jr,2017-07-04T08:30:18Z,"@MarcoFalke I'm not talking about a speculative scenario. UAs using `!`, `+`, and `=` are already live on the network. This only fixes the display and logging of these.\n\nAnd the existing safe chars uses the same limits for both `-uacomment` options as well as the log filtering. That particular combination makes it impossible to have code-only UA comments, hence why the usage of `!`, `+`, and `",https://github.com/bitcoin/bitcoin/pull/10731#issuecomment-312815482,312815482,
luke-jr,2017-07-04T08:50:00Z,"(Also, the super-nanny approach of not allowing any possible ""needs escaping"" characters already sailed a long time ago: `;` is one of the most dangerous such characters, and has been allowed from the start.)",https://github.com/bitcoin/bitcoin/pull/10731#issuecomment-312820181,312820181,
promag,2017-07-04T09:53:45Z,"> `;` is one of the most dangerous such characters, and has been allowed from the start.)\n\n@luke-jr that doesn't sound a good argument :smile:.",https://github.com/bitcoin/bitcoin/pull/10731#issuecomment-312836390,312836390,
laanwj,2017-07-06T18:00:36Z,"> Do we really need to do things like this? Reviewing these sorts of things take time an effort that could better be spent elsewhere.\n\nI agree, I'd rather not make this change.",https://github.com/bitcoin/bitcoin/pull/10731#issuecomment-313473040,313473040,
luke-jr,2017-07-06T20:39:59Z,"@laanwj You yourself added shell characters in #4983 ...\n\nHow do we get this fixed? Would it help to reduce it to just `!`, `+`, and `=` so it only addresses the real-world issue?",https://github.com/bitcoin/bitcoin/pull/10731#issuecomment-313512962,313512962,
gmaxwell,2017-07-06T22:43:24Z,! is shell problematic,https://github.com/bitcoin/bitcoin/pull/10731#issuecomment-313539245,313539245,
jonasschnelli,2017-07-13T07:27:08Z,Closing because seems not something we should do.,https://github.com/bitcoin/bitcoin/pull/10731#issuecomment-314995401,314995401,
luke-jr,2017-07-13T07:35:17Z,"Please reopen. This is a bug fix for a present issue, for which no alternate solutions have been proposed.\n\nWe already use/allow ""shell-problematic"" characters (such as parenthesis and semicolon), and worrying about them in log files is pretty absurd anyway. My bitcoin logs *already* have `!` from other sources anyway.",https://github.com/bitcoin/bitcoin/pull/10731#issuecomment-314997081,314997081,
jonasschnelli,2017-07-13T07:46:17Z,"But @luke-jr: your changing the default charset for the general function `SanitizeString()` where you break the assumption that this function produces a sanitized/safe string?\nIf you wan't to fix a bug, I think you should find a ways that doesn't break that – reasonable – assumption.\nExample: there are open pull requests who want to use SanitizeString for user feedback (via CLI, RPC). Not sure",https://github.com/bitcoin/bitcoin/pull/10731#issuecomment-314999285,314999285,
jonasschnelli,2017-07-13T07:46:24Z,reopening,https://github.com/bitcoin/bitcoin/pull/10731#issuecomment-314999316,314999316,
luke-jr,2017-07-13T08:29:25Z,"Rewrote this to only allow the full set of printable characters in the GUI where it should be harmless, and to escape them in %XX format when printing to the log.",https://github.com/bitcoin/bitcoin/pull/10731#issuecomment-315009322,315009322,
TheBlueMatt,2017-07-14T19:31:43Z,"Can we instead remove exposing of subver entirely? I'm really tired of people ""voting"" by spinning up sybil attacks, its just not in any way useful.",https://github.com/bitcoin/bitcoin/pull/10731#issuecomment-315447753,315447753,
luke-jr,2017-07-17T06:26:35Z,"@TheBlueMatt Whether we do or don't, it's outside the scope of this PR.",https://github.com/bitcoin/bitcoin/pull/10731#issuecomment-315676199,315676199,
luke-jr,2017-07-27T04:51:00Z,@ryanofsky (addressed your nits btw),https://github.com/bitcoin/bitcoin/pull/10731#issuecomment-318257879,318257879,
MarcoFalke,2017-09-07T15:58:29Z,There seems to be no conceptual acknowledgment to do this. Closing for now.,https://github.com/bitcoin/bitcoin/pull/10731#issuecomment-327844248,327844248,
ryanofsky,2017-07-13T10:41:42Z,"This isn't really escaping, because the output is ambiguous (there no way to detect escape sequences and recover the original string). Probably would be better to change to something like `strprintf(""%%%02X"", str[i])` or `strprintf(""\\x%02X"", str[i])` to use a more standard url-style or c-style escape format.\n\nAlso, if you do url-style or c-style escaping you should make sure the `%` or `\` es",https://github.com/bitcoin/bitcoin/pull/10731#discussion_r127184282,127184282,src/utilstrencodings.cpp
luke-jr,2017-07-13T10:44:51Z,"Indeed, it was supposed to be `%%%02x`\n\nFixed",https://github.com/bitcoin/bitcoin/pull/10731#discussion_r127184825,127184825,src/utilstrencodings.cpp
ryanofsky,2017-07-13T10:53:25Z,"You will also want to remove the `%` character from `SAFE_CHARS_PRINTABLE` so it will be escaped itself, or alternately add a `&& (!escape || str[i] != '%')` clause to the find check above.",https://github.com/bitcoin/bitcoin/pull/10731#discussion_r127186242,127186242,src/utilstrencodings.cpp
ryanofsky,2017-07-13T10:56:11Z,"Maybe use `%02X` instead of `%02x` since it helps escape sequences stand out a little more, and is the more common way you see percent encoding done.",https://github.com/bitcoin/bitcoin/pull/10731#discussion_r127186728,127186728,src/utilstrencodings.cpp
luke-jr,2017-07-17T06:34:32Z,Done,https://github.com/bitcoin/bitcoin/pull/10731#discussion_r127639234,127639234,src/utilstrencodings.cpp
