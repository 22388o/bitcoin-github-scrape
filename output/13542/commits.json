[
  {
    "sha": "d33e48e7d1e7b7889edd7e4f4351fc1ee5f28469",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkMzNlNDhlN2QxZTdiNzg4OWVkZDdlNGY0MzUxZmMxZWU1ZjI4NDY5",
    "commit": {
      "author": {
        "name": "Paulius Stakauskas",
        "email": "paulius@commerceblock.com",
        "date": "2018-06-27T10:27:20Z"
      },
      "committer": {
        "name": "Paulius Stakauskas",
        "email": "paulius@commerceblock.com",
        "date": "2018-06-27T10:27:20Z"
      },
      "message": "Adding Docker/docker-compose files",
      "tree": {
        "sha": "db027e3bd520b11004f5b39e66280b5c8bf85ae8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/db027e3bd520b11004f5b39e66280b5c8bf85ae8"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d33e48e7d1e7b7889edd7e4f4351fc1ee5f28469",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d33e48e7d1e7b7889edd7e4f4351fc1ee5f28469",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/d33e48e7d1e7b7889edd7e4f4351fc1ee5f28469",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d33e48e7d1e7b7889edd7e4f4351fc1ee5f28469/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "c655b2c2df15ef2c9f8235dc92174f2db6521463",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c655b2c2df15ef2c9f8235dc92174f2db6521463",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/c655b2c2df15ef2c9f8235dc92174f2db6521463"
      }
    ],
    "stats": {
      "total": 255,
      "additions": 255,
      "deletions": 0
    },
    "files": [
      {
        "sha": "cf43d5993a5b433ca20ec3350cc0ea2dfba02725",
        "filename": "Dockerfile",
        "status": "added",
        "additions": 102,
        "deletions": 0,
        "changes": 102,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d33e48e7d1e7b7889edd7e4f4351fc1ee5f28469/Dockerfile",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d33e48e7d1e7b7889edd7e4f4351fc1ee5f28469/Dockerfile",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/Dockerfile?ref=d33e48e7d1e7b7889edd7e4f4351fc1ee5f28469",
        "patch": "@@ -0,0 +1,102 @@\n+FROM centos:centos7.4.1708\n+\n+ENV GOSU_VERSION 1.10\n+ENV GOSU_ARCH amd64\n+ENV GOSU_URL https://github.com/tianon/gosu/releases/download\n+ENV GOSU_APP ${GOSU_URL}/${GOSU_VERSION}/gosu-${GOSU_ARCH}\n+ENV GOSU_ASC ${GOSU_URL}/${GOSU_VERSION}/gosu-${GOSU_ARCH}.asc\n+ENV DB4_VERSION 4.8.30.NC\n+ENV DB4_HASH 12edc0df75bf9abd7f82f821795bcee50f42cb2e5f76a6a281b85732798364ef\n+ENV DB4_URL http://download.oracle.com/berkeley-db/db-${DB4_VERSION}.tar.gz\n+\n+COPY . /usr/src/bitcoin\n+\n+# Add epel repo\n+RUN set -x \\\n+    && yum install -y epel-release \\\n+    && yum clean all \\\n+    && rm -rf /var/cache/yum\n+\n+# Setup system packages\n+RUN set -x \\\n+    && yum install -y \\\n+        gcc \\\n+        gcc-c++ \\\n+        make \\\n+        curl-devel \\\n+        libevent-devel \\\n+        tcl-devel \\\n+        tk-devel \\\n+        zlib-devel \\\n+        bzip2-devel \\\n+        openssl-devel \\\n+        ncurses-devel \\\n+        readline-devel \\\n+        gdbm-devel \\\n+        file \\\n+        libpcap-devel \\\n+        xz-devel \\\n+        expat-devel \\\n+        snappy-devel \\\n+        libevent-devel \\\n+        libdb4-devel \\\n+        libdb4-cxx-devel \\\n+        zeromq-devel \\\n+        gmp-devel \\\n+        mpfr-devel \\\n+        libmpc-devel \\\n+        which \\\n+        autoconf \\\n+        automake \\\n+        libtool \\\n+        boost-devel \\\n+        iproute \\\n+        jq \\\n+        python36 \\\n+    && yum clean all \\\n+    && rm -rf /var/cache/yum\n+\n+# gosu\n+RUN set -x \\\n+    && adduser -m -s /sbin/nologin bitcoin \\\n+    && chown bitcoin:bitcoin /home/bitcoin \\\n+    && curl -o /usr/local/bin/gosu -SL ${GOSU_APP} \\\n+    && curl -o /usr/local/bin/gosu.asc -SL ${GOSU_ASC} \\\n+    && export GNUPGHOME=\"$(mktemp -d)\" \\\n+    && gpg --keyserver ha.pool.sks-keyservers.net --recv-keys \\\n+        B42F6819007F00F88E364FD4036A9C25BF357DD4 \\\n+    && gpg --batch --verify /usr/local/bin/gosu.asc /usr/local/bin/gosu \\\n+    && rm -rf \"$GNUPGHOME\" /usr/local/bin/gosu.asc \\\n+    && chmod +x /usr/local/bin/gosu \\\n+    && gosu nobody true\n+\n+# Build Berkeley DB\n+RUN set -x \\\n+    && cd /usr/src \\\n+    && curl ${DB4_URL} -o db-${DB4_VERSION} \\\n+    && echo \"${DB4_HASH} db-${DB4_VERSION}\" | sha256sum -c || exit 1 \\\n+    && tar zxvf db-${DB4_VERSION} \\\n+    && cd db-${DB4_VERSION}/build_unix \\\n+    && ../dist/configure --prefix=/usr --enable-cxx \\\n+        --disable-shared --with-pic \\\n+    && make -j$(nproc) \\\n+    && make install \\\n+    && make clean \\\n+    && cd /usr/src \\\n+    && rm -rf /usr/src/db-${DB4_VERSION}\n+\n+# Build\n+RUN set -x \\\n+    && cd /usr/src/bitcoin \\\n+    && ./autogen.sh \\\n+    && ./configure --with-gui=no \\\n+    && make -j$(nproc) \\\n+    && make install \\\n+    && make clean \\\n+    && cd /usr/src \\\n+    && rm -rf /usr/src/bitcoin\n+\n+COPY contrib/docker/docker-entrypoint.sh /docker-entrypoint.sh\n+\n+ENTRYPOINT [\"/docker-entrypoint.sh\"]\n+CMD [\"bitcoind\"]"
      },
      {
        "sha": "b6e0e995273b4ecf46194727a02b014f46cadfdf",
        "filename": "contrib/docker/README.md",
        "status": "added",
        "additions": 119,
        "deletions": 0,
        "changes": 119,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d33e48e7d1e7b7889edd7e4f4351fc1ee5f28469/contrib/docker/README.md",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d33e48e7d1e7b7889edd7e4f4351fc1ee5f28469/contrib/docker/README.md",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/docker/README.md?ref=d33e48e7d1e7b7889edd7e4f4351fc1ee5f28469",
        "patch": "@@ -0,0 +1,119 @@\n+Docker setup\n+-------------------\n+\n+## Requirements\n+\n+Docker engine release: 18.02.0+\n+docker-compose: 1.20.0+\n+\n+## Build and start\n+\n+`docker-compose -p bitcoin up -d`\n+\n+## Check status\n+\n+`docker-compose -p bitcoin ps`\n+\n+### Output\n+```\n+     Name                   Command               State                                                  Ports                                                \n+--------------------------------------------------------------------------------------------------------------------------------------------------------------\n+bitcoin_node_1   /docker-entrypoint.sh bitc ...   Up      0.0.0.0:32833->18332/tcp, 0.0.0.0:32832->18333/tcp, 0.0.0.0:32835->8332/tcp, 0.0.0.0:32834->8333/tcp\n+```\n+\n+## Jump into container\n+\n+As root\n+`docker-compose -p bitcoin exec node bash`\n+As bitcoin\n+`docker-compose -p bitcoin exec -u bitcoin node bash`\n+Then: bitcoin-cli / bitcoin-tx available from within inside of container.\n+\n+Note: if running as root, need to specify: -datadir=/home/bitcoin/.bitcoin\n+\n+## Execute shell commands\n+\n+`docker-compose -p bitcoin exec node ip a`\n+\n+## Use bitcoin CLI from outside container\n+\n+```\n+docker-compose -p bitcoin exec -u bitcoin node bitcoin-cli -rpcport=18332 \\\n+    -rpcuser=username -rpcpassword=password getblockchaininfo\n+docker-compose -p bitcoin exec -u bitcoin node bitcoin-cli -rpcport=18332 \\\n+    -rpcuser=username -rpcpassword=password getnetworkinfo\n+docker-compose -p bitcoin exec -u bitcoin node bitcoin-cli -rpcport=18332 \\\n+    -rpcuser=username -rpcpassword=password getwalletinfo\n+```\n+\n+## Stop\n+\n+`docker-compose -p bitcoin stop`\n+\n+## Start\n+\n+`docker-compose -p bitcoin start`\n+\n+## Remove stack\n+\n+`docker-compose -p bitcoin rm -f`\n+\n+## Modify startup parameters\n+\n+### Edit: docker-compose.yml file\n+\n+```\n+      bitcoind\n+        -printtoconsole\n+        -rpcuser=${BITCOIN_RPC_USER:-username}\n+        -rpcpassword=${BITCOIN_RPC_PASSWORD:-password}\n+        -testnet\n+```\n+\n+## Use your configuration file\n+\n+### Create bitcoin.conf\n+```\n+testnet=0\n+daemon=0\n+txindex=1\n+```\n+\n+### Modify docker-compose.yml to\n+```\n+    volumes:\n+      - /home/bitcoin\n+      - ./bitcoin.conf:/bitcoin.conf\n+    command: >\n+      bitcoind\n+        -printtoconsole\n+        -rpcuser=${BITCOIN_RPC_USER:-username}\n+        -rpcpassword=${BITCOIN_RPC_PASSWORD:-password}\n+        -conf=/bitcoin.conf\n+```\n+\n+### Start with\n+\n+`docker-compose -p bitcoin up -d`\n+\n+## Check container logs\n+\n+```\n+docker-compose -p bitcoin logs\n+\n+docker-compose -p bitcoin exec -u bitcoin node \\\n+    tail -f /home/bitcoin/.bitcoin/testnet3/debug.log\n+```\n+\n+## Scale containers\n+\n+`docker-compose -p bitcoin scale node=2`\n+\n+### Output\n+```\n+docker-compose -p bitcoin ps\n+     Name                   Command               State                                                  Ports                                                \n+--------------------------------------------------------------------------------------------------------------------------------------------------------------\n+bitcoin_node_1   /docker-entrypoint.sh bitc ...   Up      0.0.0.0:32833->18332/tcp, 0.0.0.0:32832->18333/tcp, 0.0.0.0:32835->8332/tcp, 0.0.0.0:32834->8333/tcp\n+bitcoin_node_2   /docker-entrypoint.sh bitc ...   Up      0.0.0.0:32837->18332/tcp, 0.0.0.0:32836->18333/tcp, 0.0.0.0:32839->8332/tcp, 0.0.0.0:32838->8333/tcp\n+```"
      },
      {
        "sha": "eff204a8d9c08d18134c2851d632db1f5230f7af",
        "filename": "contrib/docker/bitcoin.conf",
        "status": "added",
        "additions": 4,
        "deletions": 0,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d33e48e7d1e7b7889edd7e4f4351fc1ee5f28469/contrib/docker/bitcoin.conf",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d33e48e7d1e7b7889edd7e4f4351fc1ee5f28469/contrib/docker/bitcoin.conf",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/docker/bitcoin.conf?ref=d33e48e7d1e7b7889edd7e4f4351fc1ee5f28469",
        "patch": "@@ -0,0 +1,4 @@\n+testnet=1\n+daemon=0\n+server=1\n+txindex=1"
      },
      {
        "sha": "634967f37bfcbc962dab0f062a56d4631aaa3d06",
        "filename": "contrib/docker/docker-compose.yml",
        "status": "added",
        "additions": 18,
        "deletions": 0,
        "changes": 18,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d33e48e7d1e7b7889edd7e4f4351fc1ee5f28469/contrib/docker/docker-compose.yml",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d33e48e7d1e7b7889edd7e4f4351fc1ee5f28469/contrib/docker/docker-compose.yml",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/docker/docker-compose.yml?ref=d33e48e7d1e7b7889edd7e4f4351fc1ee5f28469",
        "patch": "@@ -0,0 +1,18 @@\n+version: '3.6'\n+services:\n+  node:\n+    build: ../../.\n+    ports:\n+      - \"8333\"\n+      - \"18333\"\n+      - \"8332\"\n+      - \"18332\"\n+    volumes:\n+      - /home/bitcoin\n+      - ./bitcoin.conf:/bitcoin.conf\n+    command: >\n+      bitcoind\n+        -printtoconsole\n+        -rpcuser=${BITCOIN_RPC_USER:-username}\n+        -rpcpassword=${BITCOIN_RPC_PASSWORD:-password}\n+        -testnet"
      },
      {
        "sha": "81188ace57df857cf2f15c4550cc6a20d598db81",
        "filename": "contrib/docker/docker-entrypoint.sh",
        "status": "added",
        "additions": 12,
        "deletions": 0,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d33e48e7d1e7b7889edd7e4f4351fc1ee5f28469/contrib/docker/docker-entrypoint.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d33e48e7d1e7b7889edd7e4f4351fc1ee5f28469/contrib/docker/docker-entrypoint.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/docker/docker-entrypoint.sh?ref=d33e48e7d1e7b7889edd7e4f4351fc1ee5f28469",
        "patch": "@@ -0,0 +1,12 @@\n+#!/bin/bash\n+set -e\n+\n+if [[ \"$1\" = \"bitcoind\" ]]; then\n+    exec gosu bitcoin bitcoind ${*:2}\n+elif [[ \"$1\" == \"bitcoin-cli\" ]]; then\n+    exec gosu bitcoin bitcoin-cli ${*:2}\n+elif [[ \"$1\" == \"bitcoin-tx\" ]]; then\n+    exec gosu bitcoin bitcoin-tx ${*:2}\n+else\n+    exec \"$@\"\n+fi"
      }
    ]
  }
]