[
  {
    "sha": "5f5c4b5f92ddfc528b97901da1fdff0334a8ed27",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo1ZjVjNGI1ZjkyZGRmYzUyOGI5NzkwMWRhMWZkZmYwMzM0YThlZDI3",
    "commit": {
      "author": {
        "name": "Andy Alness",
        "email": "andy@coinbase.com",
        "date": "2014-05-02T21:24:51Z"
      },
      "committer": {
        "name": "Andy Alness",
        "email": "andy@coinbase.com",
        "date": "2014-05-02T21:24:51Z"
      },
      "message": "[Qt] Payment request expiration bug fix\n\nCurrently a payment request is only checked for expiration upon receipt.\nIt should be checked again immediately before sending coins to prevent\nthe user from paying to an expired invoice which would then require a\ncustomer service interaction.",
      "tree": {
        "sha": "3cd296be6a037e755865ac9bfb22f2584ba2da42",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3cd296be6a037e755865ac9bfb22f2584ba2da42"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5f5c4b5f92ddfc528b97901da1fdff0334a8ed27",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/5f5c4b5f92ddfc528b97901da1fdff0334a8ed27",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/5f5c4b5f92ddfc528b97901da1fdff0334a8ed27",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/5f5c4b5f92ddfc528b97901da1fdff0334a8ed27/comments",
    "author": {
      "login": "aalness",
      "id": 4391003,
      "node_id": "MDQ6VXNlcjQzOTEwMDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4391003?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aalness",
      "html_url": "https://github.com/aalness",
      "followers_url": "https://api.github.com/users/aalness/followers",
      "following_url": "https://api.github.com/users/aalness/following{/other_user}",
      "gists_url": "https://api.github.com/users/aalness/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aalness/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aalness/subscriptions",
      "organizations_url": "https://api.github.com/users/aalness/orgs",
      "repos_url": "https://api.github.com/users/aalness/repos",
      "events_url": "https://api.github.com/users/aalness/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aalness/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "aalness",
      "id": 4391003,
      "node_id": "MDQ6VXNlcjQzOTEwMDM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4391003?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aalness",
      "html_url": "https://github.com/aalness",
      "followers_url": "https://api.github.com/users/aalness/followers",
      "following_url": "https://api.github.com/users/aalness/following{/other_user}",
      "gists_url": "https://api.github.com/users/aalness/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aalness/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aalness/subscriptions",
      "organizations_url": "https://api.github.com/users/aalness/orgs",
      "repos_url": "https://api.github.com/users/aalness/repos",
      "events_url": "https://api.github.com/users/aalness/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aalness/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "ab4bd3bdbb96e64451a38085dd42984ba444033e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ab4bd3bdbb96e64451a38085dd42984ba444033e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/ab4bd3bdbb96e64451a38085dd42984ba444033e"
      }
    ],
    "stats": {
      "total": 14,
      "additions": 14,
      "deletions": 0
    },
    "files": [
      {
        "sha": "381598188469e7e1c212223747ac9800409768f4",
        "filename": "src/qt/sendcoinsdialog.cpp",
        "status": "modified",
        "additions": 14,
        "deletions": 0,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/5f5c4b5f92ddfc528b97901da1fdff0334a8ed27/src/qt/sendcoinsdialog.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/5f5c4b5f92ddfc528b97901da1fdff0334a8ed27/src/qt/sendcoinsdialog.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/sendcoinsdialog.cpp?ref=5f5c4b5f92ddfc528b97901da1fdff0334a8ed27",
        "patch": "@@ -239,6 +239,20 @@ void SendCoinsDialog::on_sendButton_clicked()\n         return;\n     }\n \n+    // make sure any payment requests involved are still valid.\n+    foreach(const SendCoinsRecipient &rcp, recipients)\n+    {\n+        if (rcp.paymentRequest.IsInitialized())\n+        {\n+            const payments::PaymentDetails& details = rcp.paymentRequest.getDetails();\n+            if (details.has_expires() && (int64_t)details.expires() < GetTime())\n+            {\n+                emit message(tr(\"Payment request error\"), tr(\"Payment request expired\"), CClientUIInterface::MSG_ERROR);\n+                return;\n+            }\n+        }\n+    }\n+\n     // now send the prepared transaction\n     WalletModel::SendCoinsReturn sendStatus = model->sendCoins(currentTransaction);\n     // process sendStatus and on error generate message shown to user"
      }
    ]
  }
]