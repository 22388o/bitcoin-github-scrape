dgenr8,2014-04-10T19:13:40Z,"Should CWallet::ReacceptWalletTransactions() add unconfirmed watch-only transactions to the mempool?\n\n#3883 (dyslexia alert, not 3383) adds an IsMine check to prevent this for tracked doublespends.  It looks that should be IsMine==MINE_SPENDABLE if watches are not to be broadcast.\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-40126156,40126156,
sipa,2014-04-10T19:19:56Z,"IMHO, watches should be broadcast.\n\nI like the idea that the receiver of a transaction is responsible for broadcasting it, and for watched wallets, the spending key is unlikely to be online.\n\nThere are potentially privacy concerns with broadcasting transactions in general, but I think that's an independent issue.\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-40126787,40126787,
laanwj,2014-04-16T07:19:34Z,Added milestone 0.10.0. It's too risky for 0.9.2 but should definitely be in the next major release.\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-40570042,40570042,
luke-jr,2014-04-16T09:11:10Z,This seems to still have the bug where transactions unrelated to the address are added to the wallet.\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-40578310,40578310,
sipa,2014-04-16T10:46:34Z,"@luke-jr That's not a bug but a feature.\n\nThis patch allows manually constructing a wallet, and observing its wallet balance, and the transactions that affect it. Just like importprivkey/importwallet allow manual construction of a wallet.\n\nIt's a low-level, micro-management feature, and yes, it allows observing transactions that spend coins assigned to one particular address. That's not what I",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-40585640,40585640,
luke-jr,2014-04-16T11:11:45Z,"@sipa Then it should be ""importscriptpubkey"" instead of ""importaddress"" (and take a script as an argument), since it's working with scriptpubkeys, not addresses... This makes it more flexible too.\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-40587262,40587262,
sipa,2014-04-16T11:16:47Z,"@luke-jr All that matters to a pubkey is how it can be used to receive coins. As we're not caring about how they need to be spent, it doesn't matter.\n\nThis is more flexible, as it also means support for P2SH and multisig.\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-40587590,40587590,
luke-jr,2014-04-16T11:18:39Z,"@sipa Using a scriptpubkey would do everything an address does here (including P2SH and multisig), but it ALSO allows me to add a custom scriptpubkey that I might want to monitor (such as a BC Script puzzle).\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-40587700,40587700,
sipa,2014-04-16T11:30:03Z,"@luke-jr You can. Add its p2sh hash, and it will watch for raw scriptpubkeys that match it.\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-40588481,40588481,
luke-jr,2014-04-16T11:38:17Z,That's ugly... :/\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-40589019,40589019,
sipa,2014-04-16T11:52:50Z,"I think you just convinced me that this indeed confuses the concepts of script hash and address.\n\nHere's what I suggest (it should be a small change, I'll try to do that this evening):\n- CKeyStore still maintains a list of ScriptID's (=160-bit hashes of scripts to watch for), but to match, hash(scriptPubKey) must match that ScriptID exactly (instead of trying to ""guess"" the destination and use ",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-40590028,40590028,
gavinandresen,2014-04-16T14:16:10Z,"@sipa : I think we want this to continue to work:\n\n```\n1) Mine a block, payment to <pubkey> CHECKSIG\n2) Somebody else sends to <pubkey> CHECKSIG\n  EXPECT: coins show up in listtransactions/getbalance/etc.\n\nFor backwards compatibility I think we need:\n3)  Somebody else sends via p2pubkeyhash(pubkey)\n  ??EXPECT?? : coins show up in listtransactions/getbalance/etc.  (current behavior, I thin",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-40603602,40603602,
sipa,2014-04-16T14:30:30Z,"@gavinandresen What I suggest is that if you want to see transactions paying to a raw pubkey, you can always use importpubkeyscript [pay to pubkey script]. Similarly, if you want to see payments to some raw multisig script, add that multisig script directly.\n\nReasoning: when receiving a payment, you expect it to go to exactly the script you told someone it should go it. An address is a shorthand",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-40605391,40605391,
gavinandresen,2014-04-16T14:39:37Z,RE: talking about watch-only:  ok. I was just worried (maybe unnecessarily) that changes to support watch-only could have unintended consequences for the 'key is in my wallet' cases. I think regression tests to make sure old behavior doesn't change are needed here.\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-40606585,40606585,
tuttleorbuttle,2014-04-18T20:56:11Z,If you watch a multisig address of which you have all keys it doesn't change anything i think.\nThe coins will only show up as Pending like they always did (no duplication in the Watchonly column).\nI'm gonna do some testing with this next week to see if I can find any bugs.\n\nThe only minor glitch i noticed is that validateaddress will always show watchonly: false for multisig addresses added wi,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-40843728,40843728,
laanwj,2014-04-29T11:17:53Z,"GUI changes look good. I like the extra column, although it appears that the alignment of the header is slightly wrong:\n![alignment](https://cloud.githubusercontent.com/assets/126646/2828181/cb142dcc-cf8f-11e3-804e-69b39092981e.png)\n\nApart from this it appears to work fine in my (limited) testing. Great work!\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-41664342,41664342,
tuttleorbuttle,2014-04-29T20:02:38Z,"woops. how to proceed from here?\nshould i rebase my commits onto the latest bitcoin commit and create a new pull request or just merge bitcoin master into my watchonly branch, fix the conflicts and push that?\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-41724918,41724918,
wtogami,2014-04-29T20:20:59Z,Rebase all of your commits on top of master and git push --force to your topic branch.  Doing so will automatically update the commits here with a cleaner commit history.\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-41726945,41726945,
tuttleorbuttle,2014-04-30T05:35:45Z,"that sanity test is wrong, it fast-forward merges perfectly fine :/\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-41762419,41762419,
leofidus,2014-04-30T11:46:42Z,"Looking at the test log, it merged and built, but a test failed.\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-41787300,41787300,
laanwj,2014-04-30T15:00:46Z,Don't worry. It appears that there's something wrong with the pulltester at the moment.\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-41807005,41807005,
laanwj,2014-05-08T08:38:37Z,"If you do a rebase+repush, that will trigger the pulltester. It should be fixed now.\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-42525385,42525385,
tuttleorbuttle,2014-05-15T13:32:35Z,hm it failed again.\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-43209222,43209222,
masterbitcoin,2014-05-16T05:02:17Z,this change is based on bitcoin master? why not base on bitcoin 0.9.2?\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-43297612,43297612,
masterbitcoin,2014-05-16T05:10:50Z,"@tuttleorbuttle @laanwj  with this patch, ./bitcoind listtransactions doesn't list watchonly address's received and sent transactions, however the bitcoin-qt gui does show all received and sent transactions of the watchonly address, why?\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-43297954,43297954,
ghost,2014-05-16T08:10:27Z,"@masterbitcoin Actually it does work you need to use the `includeWatchonly` flag, For example\n\n`listtransactions """" 100 0 true`\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-43307162,43307162,
ghost,2014-05-16T08:14:01Z,"@tuttleorbuttle should `listreceivedbyaddress` also include a watch only filter flag at the moment? It currently includes watchonly by default and there is no way to turn that off. I dont have a problem with that, but just wondering that was intended.\n\nOtherwise ACK from me. I tested things and it works like a dream.\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-43307392,43307392,
wtogami,2014-05-16T08:36:01Z,> this change is based on bitcoin master? why not base on bitcoin 0.9.2?\n\nThis change is too invasive for 0.9.2.  It is aimed for 0.10\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-43309014,43309014,
ghost,2014-05-16T08:38:33Z,Also the merge strategy used here is to merge everything into master and cherry-pick out bug fixes for maintenance branch rather than commit to lowest branch and merge up. \n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-43309200,43309200,
tuttleorbuttle,2014-05-16T11:33:56Z,@masterbitcoin i added the includeWatchonly flag for api functions in commit c6d8337 just in case someone might prefer it that way and i guess i simply forgot to add it for listreceivedbyaddress.\nlistunspent also includes watchonly transactions by default so there's some inconsistency here.\n\nSince watchonly outputs/transactions are marked in the API responses as 'spendable=false' or 'involvesWa,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-43321815,43321815,
laanwj,2014-05-16T12:37:07Z,@tuttleorbuttle Having an includewatchonly flag is important for the api\ncalls where it isn't possible to distinguish them in the result. For\nexample in getbalance. For listtransactions and such it's less important.\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-43326149,43326149,
masterbitcoin,2014-05-16T15:42:27Z,"@drak @wtogami great, thanks a lot, i will test these apis and see if everything goes smooth. one more question, does master-bitcoin only mean 0.10? what does it mean after we reach/beyond 0.10 version?\n\nbeside, when i complied a 0.9.2 bitcoin-qt with this patch, i got a warning ""warning:  Clock skew detected.  Your build may be incomplete."", the bitcoin-qt was still built and looks like working",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-43346404,43346404,
leofidus,2014-05-17T11:09:31Z,"@masterbitcoin master always contains always all approved new code. Some of it will be cherry-picked for the next bugfix release (e.g. 0.9.2), and as a general rule all of it will be included in the next minor release (e.g. 0.10).\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-43404112,43404112,
masterbitcoin,2014-05-17T16:13:06Z,"@leofidus great answer, thx, any idea about the ""warning: Clock skew detected"" problem?\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-43411607,43411607,
tuttleorbuttle,2014-05-18T11:34:25Z,"@laanwj e035837 and a31d01b add the includeWatchonly flag for getbalance and listaccounts, c6d8337 does it for listunspent.\n\n@masterbitcoin maybe this helps: https://stackoverflow.com/questions/13745645/makefile-clock-skew-detected\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-43437572,43437572,
nickkhan,2014-05-23T18:22:04Z,when should we expect this to make in to master ? how much time is needed?\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-44044001,44044001,
laanwj,2014-05-25T12:36:11Z,@nickkhan have you tested it? Does it do what you expect it to? Any\nglitches?\n\nFor a large wallet change like this we want to see a larger number of\nreviews and test reports than for a simple UI change. There is a lot of\nvalue at risk.\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-44129874,44129874,
nickkhan,2014-05-25T13:50:21Z,"OK I be happy to test it.\n\nOn May 25, 2014 8:36 AM, ""Wladimir J. van der Laan"" notifications@github.com wrote:\n@nickkhan have you tested it? Does it do what you expect it to? Any\nglitches?\n\nFor a large wallet change like this we want to see a larger number of\nreviews and test reports than for a simple UI change. There is a lot of\nvalue at risk.\n\n---\n\nReply to this email directly or vie",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-44133642,44133642,
laanwj,2014-05-28T10:57:46Z,"@tuttleorbuttle Are there still things that you need to fix here, or do you consider this ready to be merged?\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-44390792,44390792,
sipa,2014-05-28T11:49:17Z,"Can you wait a few days? I'd like to have a look, and suggest some changes (to make the RPC interface not confuse scripts with addresses).\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-44396336,44396336,
laanwj,2014-05-28T13:06:54Z,"There is not really a hurry, more testing is always good, I just wanted to know what his own assessment of the status of this pull was.\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-44403492,44403492,
nickkhan,2014-05-28T14:09:38Z,"Hi laanwj, I have a silly question. I have got the pull request checked out and I am running the client now but i dont see any watchonly wallet gui? Is there a test harness available to test against? or maybe you walk me through on how to test it ? \n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-44411035,44411035,
laanwj,2014-05-28T14:43:19Z,"@nickkhan To test, go to the debug window, type `importaddress <address>` to import an address. If you want to import multiple addresses pass 'false' as second argument to avoid automatic rescanning to save time. You should really be asking the developer of the patch, not me, though.\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-44415587,44415587,
tuttleorbuttle,2014-05-31T14:44:27Z,"@laanwj I need to fix a few more things first, there are still some glitches i think.\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-44750042,44750042,
tuttleorbuttle,2014-06-01T10:49:08Z,"I think all serious issues are solved so whoever wants to test it, please go ahead. I'm going to test it over the next few days.\n\nWhat's left to code:\n- remove default argument values from getdebit(), getcredit(),.. functions\n- add MINE_ALL = MINE_SPENDABLE | MINE_WATCHONLY\n- rename MINE_ prefix to ADDRESS_ or similar because it makes more sense\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-44774644,44774644,
nickkhan,2014-06-08T03:24:08Z,@tuttleorbuttle i dont see a debug window in bitcoin core wallet\n![image](https://cloud.githubusercontent.com/assets/5621663/3210403/413f54b8-eebc-11e3-8b21-e445938db063.png)\nAlso I noticed there is no watchonly section. \n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-45427403,45427403,
leofidus,2014-06-08T16:19:35Z,"@nickkhan For the debug window, move your mouse to the upper screen border. That makes the menus `File`, `Settings` and `Help` appear. Within the Help menu, there is an item `Debug Window`\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-45441016,45441016,
nickkhan,2014-06-08T16:53:18Z,oh ok i see it now! I created a receive request from the client and send myself some btc to myself. then ran importaddress mywatchonlyaddres. the command ran ok. But I still dont see watchnoly gui section.\n![image](https://cloud.githubusercontent.com/assets/5621663/3211733/33a89dca-ef2d-11e3-9b83-25e986fcfcb1.png)\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-45441816,45441816,
ghost,2014-06-08T17:16:22Z,@nickkhan did you wait for it to rescan? It takes time to scan the database to get the balance of that address.\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-45442427,45442427,
nickkhan,2014-06-08T17:21:22Z,Yes it rescanned. Took sometime to rescan.is the build version correct ? \n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-45442590,45442590,
nickkhan,2014-06-08T20:23:04Z,"@tuttleorbuttle I tried sending some more test coins, and i  cant get the watchonly section to show. \n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-45447399,45447399,
sipa,2014-06-09T19:19:47Z,I have a suggested patch at sipa/bitcoin@watchonly. See the commit message for more information.\n\nLink: sipa/bitcoin@19e72bc6db5947d7db5714cfe2fa21eed89bdfb9\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-45532135,45532135,
nickkhan,2014-06-10T00:42:46Z,@sipa does your patch relate to my comment? just wanted to be sure!\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-45562048,45562048,
laanwj,2014-06-10T07:54:01Z,"@nickkhan Not really -- it just proposes a more flexible way of doing watchonly internally, based on output scripts instead of (derived) destinations. This allows watching even scripts that bitcoind doesn't know itself.\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-45583809,45583809,
sipa,2014-06-10T08:31:35Z,@nickkhan @laanwj Maybe it is. I noticed that the current PR's code does not consider watch-only addresses as change. That may interact badly with some wallet code for detecting payments.\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-45587086,45587086,
nickkhan,2014-06-11T17:54:58Z,ok I am not sure why i don't see the watchonly gui. importaddress worked though and it performed a rescan as well. any ideas?\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-45776333,45776333,
tuttleorbuttle,2014-06-13T08:19:44Z,"@nickhan sorry, i don't know why this would be.\nthere might still be some glitches in the transaction history and transaction detail display but the balance and watchonly section should get displayed correctly.\n\ndid you use two different clients to send yourself the coins? doesn't look like it on the screenshot.\nit doesn't work if you import addresses to which you have the private key or somet",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-45986685,45986685,
nickkhan,2014-06-13T12:50:13Z,@tuttleorbuttle OK I can try two different clients. Although I think the watch only GUI should show regardless. \n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-46007060,46007060,
tuttleorbuttle,2014-06-13T17:32:07Z,"@nickkhan but then you would count the same transaction twice, once towards spendable and once towards watchonly balance :s\nedit: or do you mean show the watchonly gui even if balance is zero?\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-46038335,46038335,
laanwj,2014-06-18T07:47:11Z,@tuttleorbuttle Right. A transaction/balance is either watchonly or normal. It should not be possible to have it in both. That would complicate things enormously with no gain.\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-46405243,46405243,
nickkhan,2014-06-18T07:59:15Z,@tuttleorbuttle my point is to show the watch only GUI section with a zero balance if the transaction is normal and of course like laanwj mentioned the balance is either watch only or normal. The watch only GUI would only account for watch only addresses. Yes I meant to show the GUI even if the balance is zero. Also the normal addressee are spendable where as watch only are receive only so I'm not,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-46406209,46406209,
laanwj,2014-06-18T08:05:44Z,The watch-only GUI is intentionally hidden when there is no watch-only balance. This is common sense GUI development where you don't want to burden the user with details about functionality they aren't using.\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-46406710,46406710,
nickkhan,2014-06-18T08:16:39Z,I think it would add more readability if the watch only sectioned showed for zero balance because after getting this patch I could not tell if watch only addresses were there/implemented even though the command worked. If the section shows with 0 balance then that tells the user the watch only section is there and will get updated when coins are received. Its like when you login your bank account ,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-46407644,46407644,
nickkhan,2014-06-18T08:19:22Z,Or check if the user has atleast one watch only address and then show the watch only GUI. \n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-46407908,46407908,
tuttleorbuttle,2014-06-18T13:54:18Z,"i see what you mean.\nI'm currently not sure how failure is handled in the importaddress rpc function but generally if after entering a command you don't get an error returned it means it worked.\nyou can also call 'validateaddress' and it will show 'iswatchonly=true"" or something, as long as it's not a multisig address created with addmultisigaddress and you don't own all keys i think.\n\nimplyin",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-46438076,46438076,
sipa,2014-06-18T14:08:47Z,Do you mind including the patch I linked to earlier? I feel the API and\nimplementation are far cleaner that way.\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-46439942,46439942,
tuttleorbuttle,2014-06-18T17:35:03Z,"yes, sorry, I'll do that.\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-46467548,46467548,
nickkhan,2014-06-18T18:10:30Z,"well is it easy to at least show an imported watchonly address in the gui once it's imported? If the importaddress returns no error, it would make life for the user easier to see what address they imported in the gui.\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-46472220,46472220,
tuttleorbuttle,2014-06-19T00:41:37Z,@nickhan i might look into this sometime but not yet for this pull request. \nmaybe someone else will do it?\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-46511977,46511977,
tuttleorbuttle,2014-06-19T01:00:40Z,"eh, just noticed the amounts in TransactionDesc aren't always right. nNet is wrong or something.\n\nedit: I'll do the outstanding tasks now and see where the error is.\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-46513051,46513051,
tuttleorbuttle,2014-06-20T14:03:54Z,"oops. well, it should work now.\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-46681195,46681195,
tuttleorbuttle,2014-06-22T23:05:30Z,"@sipa not sure whose fault it is but I just noticed that 'validateaddress' now returns ismine=false and isWatchonly=true for multisig, which is great, but it does not return redeemScript and the addresses it is made from anymore.\nany idea what might be causing this?\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-46795741,46795741,
sipa,2014-06-22T23:11:29Z,"@tuttleorbuttle For a multisig address where you own all the keys (which would make it ismine=true even before this patch), or not?\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-46795888,46795888,
tuttleorbuttle,2014-06-22T23:26:19Z,"okay, I can rename it again.\nthe problem is that when you don't have all the keys then validateaddress only returns\n    {\n    ""isvalid"" : true,\n    ""address"" : ""2NBXfVTLJTfM3JN5hArWDTg9PdqJLiAjf2H"",\n    ""ismine"" : false,\n    ""iswatchonly"" : true\n    ""account"" : ""multitest""\n    }\nwhereas it always used to also return redeemScript and addresses[] whether you had all the keys or not.\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-46796210,46796210,
sipa,2014-06-22T23:51:58Z,Well the block for adding the addresses in computing the details is now guarded by a == ADDRESS_SPENDABLE test. That won't do much for non-spendable ones :)\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-46796731,46796731,
tuttleorbuttle,2014-06-23T08:57:09Z,"Ah found it, thanks!\n\nSomeone must have fixed the issue where multisig addresses are considered _SPENDABLE and now all those details don't get returned anymore.\nWill fix that in a minute.\n\nWhat prefix would you prefer instead of ADDRESS_ btw?\nRevert it to MINE_ or maybe SCRIPT_?\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-46820194,46820194,
laanwj,2014-06-29T07:32:22Z,What about ISMINE_\* instead of MINE_*? It removes the association with mining.\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-47447887,47447887,
ghost,2014-06-29T07:50:39Z,Or use the word OWN\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-47448156,47448156,
laanwj,2014-06-29T08:01:44Z,"Could be but well it's an IsMineType and the function is called IsMine, I don't think OWN fits into there very well :)\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-47448305,47448305,
tuttleorbuttle,2014-07-02T13:57:24Z,i think everything is fine now.\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-47778846,47778846,
BitcoinPullTester,2014-07-02T14:04:59Z,"Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/p4045_a3e192a3274817517671f624d5744297905e20d2/ for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-te",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-47779765,47779765,
laanwj,2014-07-07T12:29:11Z,Ok. I'm going to merge this.\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-48171970,48171970,
ghost,2014-07-07T13:03:01Z,ACK again.\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-48174977,48174977,
jgarzik,2014-07-07T13:48:02Z,general ACK\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-48179908,48179908,
nickkhan,2014-07-07T14:12:58Z,Yay!\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-48183063,48183063,
ghost,2014-07-07T14:14:21Z,@tuttleorbuttle Thank you for your diligence with this PR and thanks for everyone who participated and tested. I think this is an awesome feature and will be really appreciated by users.\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-48183256,48183256,
ocZio,2014-07-07T17:07:54Z,Can't wait!\n,https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-48207189,48207189,
xor-freenet,2014-07-07T17:59:21Z,"Thanks for this.\nThere are two features which I think must also be implemented to make this useful:\n1. Dump all public keys (= your own Bitcoin addresses), in a wallet, including ones without coins, to JSON.\n2. Batch-import such a JSON as watchonly addresses.\n\nReasons:\n- This is useful if you have several cold storage wallets whose addresses you want to watch with an online wallet.\n- As add",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-48214691,48214691,
laanwj,2014-07-08T07:36:39Z,"1) This is already possible, with `dumpwallet`. It doesn't output to JSON, but the wallet interchange format contains the address and is easy to parse and convert. It does contain the private key too, though. Maybe a function that gives only public keys would be useful.\n2) This is already possible with JSON-RPC batch processing, you can submit an array of importaddress requests with rescan=false\",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-48280945,48280945,
xor-freenet,2014-07-08T08:07:36Z,"@laanwj\n\n> 1) This is already possible, with dumpwallet. It doesn't output to JSON, but the wallet interchange format contains the address and is easy to parse and convert. It does contain the private key too, though. Maybe a function that gives only public keys would be useful.\n\nFor the paranoid it is a must have to be absolutely sure that the data does not contain any private keys. Therefore",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-48283236,48283236,
laanwj,2014-07-08T10:06:13Z,"There _is_ an importwallet command, actually. And WIF is not a non-standard format, the idea is that different wallets use the same format. The format could be extended with address-only entries (or maybe that already exists) which should then also be imported/exported.\n\nAdding a parameter to dumpwallet to just export addresses could make sense, although if it is just a boolean it makes it less ",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-48303087,48303087,
tuttleorbuttle,2014-07-09T13:32:13Z,"thank you for merging it and thanks to sipa and laanwj for doing the complicated work.\n\nI just noticed that 'getbalance' seems to be somewhat broken now, if I try to exclude watchonly transactions I get a higher balance than I should have. I'll have a look at d4640d7 later today or tomorrow and create a PR as soon as I have a solution.\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-48469577,48469577,
tuttleorbuttle,2014-07-14T10:37:15Z,"Solution is in #4525. That was a ridiculously small mistake.\nSorry for not pushing the fix sooner, was having trouble with my local testnet.\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-48885765,48885765,
jessepeterson,2014-08-08T17:16:05Z,"I've got some questions on scalability of watch-only addresses.\n\nI'm a little hazy on the difference between accounts and address groupings and how they relate to watch-only addresses. But I noticed [here](https://en.bitcoin.it/wiki/Accounts_explained) that it says:\n\n> The accounts code does not scale up to thousands of accounts with tens of thousands of transactions, because by-account (and b",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-51631165,51631165,
jgarzik,2014-08-08T17:35:47Z,"The limiting factor is really the wallet scalability, and that has little to do with watch-only addresses.\n\n10,000 addresses is a tiny amount, but you run into memory use and other issues once you are managing million+ keys.\n",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-51633428,51633428,
laanwj,2014-08-09T06:06:46Z,"@jessepeterson Watch-only would be something that is trivial to scale. Just run multiple servers w/bitcoind, set a maximum of addresses per server (depending on the memory available on the server - you'd have to profile what is a sane value), and once a server is full, add a next server.\n\nDon't confuse scalablity with efficiency. Scalability just means that it's possible to add more hardware to ",https://github.com/bitcoin/bitcoin/pull/4045#issuecomment-51678415,51678415,
laanwj,2014-04-29T11:21:56Z,"There is no use in passing a dynamically-generated string to tr. Qt's translation tools scan the source code looking for tr(""...string...""). If you want a dynamic label, put the tr(...) above, so \n\n```\nQString addressOwned = wallet->IsMine(txout) == MINE_SPENDABLE ? tr(""own address"") : tr(""watch-only"");\n...\nstrHTML += ... + addressOwned + ...\n```\n",https://github.com/bitcoin/bitcoin/pull/4045#discussion_r12088317,12088317,src/qt/transactiondesc.cpp
laanwj,2014-04-29T11:26:21Z,"Nit: for readability I'd prefer this to be linear, instead of a nested 'pyramid', ie\n\n```\nif (params.size() > 0)\n{\n    strAccount = params[0].get_str();\n}\nif (params.size() > 1)\n{\n    nCount = params[1].get_int();\n}\n...\n```\n\nAfter all, params.size()>2 implies params.size()>1 ... and so on.\n",https://github.com/bitcoin/bitcoin/pull/4045#discussion_r12088437,12088437,src/rpcwallet.cpp
laanwj,2014-04-29T11:33:08Z,"Do you need to create this include-dependency on keystore.h?\n(if you need this for CTxDestination, I'd suggest doing a forward declaration)\n\nEdit: Hm that may not work as CTxDestination is defined using a template.\n",https://github.com/bitcoin/bitcoin/pull/4045#discussion_r12088639,12088639,src/walletdb.h
laanwj,2014-04-29T11:50:57Z,"You could move the \n\n```\nfIsMine = (pwallet->IsMine(txout) & filter);\n```\n\nto before and outside the if statement (for example to the instantiation of the variable on line 767). This avoids repeating it twice here, and removes the need for the hard-to-read 'assignment in if() clause' below.\n",https://github.com/bitcoin/bitcoin/pull/4045#discussion_r12089063,12089063,src/wallet.cpp
laanwj,2014-04-29T11:56:24Z,In many other places (at least in the rpcwallet) you default the filter to only MINE_SPENDABLE. Do you have a specific reason for doing (MINE_SPENDABLE|MINE_WATCH_ONLY) here? [may be a potential source of bugs]\n,https://github.com/bitcoin/bitcoin/pull/4045#discussion_r12089200,12089200,src/wallet.h
tuttleorbuttle,2014-04-29T15:18:17Z,that one is not from me but I can have a look at it.\n,https://github.com/bitcoin/bitcoin/pull/4045#discussion_r12098461,12098461,src/walletdb.h
tuttleorbuttle,2014-04-29T15:18:28Z,"okay, will change the string thing.\n\nabout the GUI: yeah i know it's not perfect. if that's a dealbreaker I'll change it sometime but I'll be glad if someone else fixes it instead.\nand yes, it's like bitcoin-qt was made to have an extra column there :D\n",https://github.com/bitcoin/bitcoin/pull/4045#discussion_r12098473,12098473,src/qt/transactiondesc.cpp
tuttleorbuttle,2014-04-29T15:19:07Z,"hm you are right, it looks better in linear form.\n",https://github.com/bitcoin/bitcoin/pull/4045#discussion_r12098509,12098509,src/rpcwallet.cpp
tuttleorbuttle,2014-04-29T15:39:12Z,iirc the reason for this is that i started with the GUI related code and did the rpcwallet code at the very end.\n\nIn most places I found it useful to include watchonly addresses in Debit/Credit calculations.\ne.g to find out if a transaction is relevant to you:\n    bool IsFromMe(const CTransaction& tx) const\n    {\n        return (GetDebit(tx) > 0);\n    }\n\nIn the rpcwallet i would actually ,https://github.com/bitcoin/bitcoin/pull/4045#discussion_r12099631,12099631,src/wallet.h
tuttleorbuttle,2014-04-29T15:41:27Z,"heh, silly me. you are right of course. it's a leftover from some experiment.\n",https://github.com/bitcoin/bitcoin/pull/4045#discussion_r12099748,12099748,src/wallet.cpp
laanwj,2014-04-29T15:53:25Z,Thanks for the explanation. Another option would be not to include a default argument at all. Let all caller sites explicitly specify what they want.\n\nBTW: how about a MINE_ALL constant that is defined as `(MINE_SPENDABLE|MINE_WATCH_ONLY)`? Beats repeating it everywhere :)\n,https://github.com/bitcoin/bitcoin/pull/4045#discussion_r12100435,12100435,src/wallet.h
tuttleorbuttle,2014-04-29T15:55:53Z,"I changed this to ""Total credit"" because i found it irritating, it was somewhat like:\nDebit: X\nCredit: Y\nCredit: Z\nIt's not really related to watchonly addresses though so i can revert it if someone is unhappy with this.\n",https://github.com/bitcoin/bitcoin/pull/4045#discussion_r12100573,12100573,src/qt/transactiondesc.cpp
tuttleorbuttle,2014-04-29T16:02:15Z,"MINE_ALL sounds like a good idea.\nI don't care if we include a default argument or not, will do whatever you think is best :p\n",https://github.com/bitcoin/bitcoin/pull/4045#discussion_r12101015,12101015,src/wallet.h
laanwj,2014-04-29T16:07:18Z,"I prefer explicit. That's easier for reviewing, as we can check each caller site and see if the right argument was passed. And it makes it harder to introduce bugs by thinking that the default is something else than what it is.\n",https://github.com/bitcoin/bitcoin/pull/4045#discussion_r12101352,12101352,src/wallet.h
,2014-04-29T16:16:54Z,"I'm not sure I like the use of ""mine"" here in the API and constants. `IsOwner`, `ADDRESS_SPENDABLE`, `ADDRESS_WATCH_ONLY` (or `KEY_*`) and so on.\n",https://github.com/bitcoin/bitcoin/pull/4045#discussion_r12101964,12101964,src/wallet.h
tuttleorbuttle,2014-04-29T17:21:58Z,forward declaring it as class CTxDestination didn't work. there are probably other ways but I'm not so well versed in template techniques.\n,https://github.com/bitcoin/bitcoin/pull/4045#discussion_r12105296,12105296,src/walletdb.h
laanwj,2014-04-29T18:15:19Z,"OK just leave it be, then.\n",https://github.com/bitcoin/bitcoin/pull/4045#discussion_r12108361,12108361,src/walletdb.h
tuttleorbuttle,2014-05-16T12:04:57Z,"okay, so i will\n- add MINE_ALL\n- remove default values from getdebit, getcredit,..\n- rename MINE_ to ADDRESS_\n",https://github.com/bitcoin/bitcoin/pull/4045#discussion_r12734894,12734894,src/wallet.h
