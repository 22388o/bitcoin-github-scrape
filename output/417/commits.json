[
  {
    "sha": "1ba78c60d127bff22f644e3254a7a181fbc98370",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxYmE3OGM2MGQxMjdiZmYyMmY2NDRlMzI1NGE3YTE4MWZiYzk4Mzcw",
    "commit": {
      "author": {
        "name": "Chris Howie",
        "email": "me@chrishowie.com",
        "date": "2011-07-14T20:22:00Z"
      },
      "committer": {
        "name": "Chris Howie",
        "email": "me@chrishowie.com",
        "date": "2011-07-15T16:15:41Z"
      },
      "message": "Show the receiving address for generation transactions",
      "tree": {
        "sha": "e5369f61afae0770c5a091ffc7a899018514bb9b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e5369f61afae0770c5a091ffc7a899018514bb9b"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1ba78c60d127bff22f644e3254a7a181fbc98370",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1ba78c60d127bff22f644e3254a7a181fbc98370",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/1ba78c60d127bff22f644e3254a7a181fbc98370",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1ba78c60d127bff22f644e3254a7a181fbc98370/comments",
    "author": {
      "login": "cdhowie",
      "id": 354641,
      "node_id": "MDQ6VXNlcjM1NDY0MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/354641?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cdhowie",
      "html_url": "https://github.com/cdhowie",
      "followers_url": "https://api.github.com/users/cdhowie/followers",
      "following_url": "https://api.github.com/users/cdhowie/following{/other_user}",
      "gists_url": "https://api.github.com/users/cdhowie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cdhowie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cdhowie/subscriptions",
      "organizations_url": "https://api.github.com/users/cdhowie/orgs",
      "repos_url": "https://api.github.com/users/cdhowie/repos",
      "events_url": "https://api.github.com/users/cdhowie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cdhowie/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "cdhowie",
      "id": 354641,
      "node_id": "MDQ6VXNlcjM1NDY0MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/354641?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cdhowie",
      "html_url": "https://github.com/cdhowie",
      "followers_url": "https://api.github.com/users/cdhowie/followers",
      "following_url": "https://api.github.com/users/cdhowie/following{/other_user}",
      "gists_url": "https://api.github.com/users/cdhowie/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cdhowie/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cdhowie/subscriptions",
      "organizations_url": "https://api.github.com/users/cdhowie/orgs",
      "repos_url": "https://api.github.com/users/cdhowie/repos",
      "events_url": "https://api.github.com/users/cdhowie/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cdhowie/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "f08736405e98d0f16ec294606dda782043d5ab3d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f08736405e98d0f16ec294606dda782043d5ab3d",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/f08736405e98d0f16ec294606dda782043d5ab3d"
      }
    ],
    "stats": {
      "total": 34,
      "additions": 23,
      "deletions": 11
    },
    "files": [
      {
        "sha": "40d0c6af6ffbd6ca3981a1b813ae4e09a254e549",
        "filename": "src/rpc.cpp",
        "status": "modified",
        "additions": 21,
        "deletions": 10,
        "changes": 31,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1ba78c60d127bff22f644e3254a7a181fbc98370/src/rpc.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1ba78c60d127bff22f644e3254a7a181fbc98370/src/rpc.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc.cpp?ref=1ba78c60d127bff22f644e3254a7a181fbc98370",
        "patch": "@@ -704,11 +704,15 @@ Value getbalance(const Array& params, bool fHelp)\n             list<pair<string, int64> > listReceived;\n             list<pair<string, int64> > listSent;\n             wtx.GetAmounts(allGeneratedImmature, allGeneratedMature, listReceived, listSent, allFee, strSentAccount);\n-            if (wtx.GetDepthInMainChain() >= nMinDepth)\n-                BOOST_FOREACH(const PAIRTYPE(string,int64)& r, listReceived)\n-                    nBalance += r.second;\n-            BOOST_FOREACH(const PAIRTYPE(string,int64)& r, listSent)\n-                nBalance -= r.second;\n+            if (!wtx.IsCoinBase())\n+            {\n+                if (wtx.GetDepthInMainChain() >= nMinDepth)\n+                    BOOST_FOREACH(const PAIRTYPE(string,int64)& r, listReceived)\n+                        nBalance += r.second;\n+                BOOST_FOREACH(const PAIRTYPE(string,int64)& r, listSent)\n+                    nBalance -= r.second;\n+            }\n+\n             nBalance -= allFee;\n             nBalance += allGeneratedMature;\n         }\n@@ -1033,6 +1037,7 @@ void ListTransactions(const CWalletTx& wtx, const string& strAccount, int nMinDe\n     {\n         Object entry;\n         entry.push_back(Pair(\"account\", string(\"\")));\n+        entry.push_back(Pair(\"address\", listReceived.front().first));\n         if (nGeneratedImmature)\n         {\n             entry.push_back(Pair(\"category\", wtx.GetDepthInMainChain() ? \"immature\" : \"orphan\"));\n@@ -1046,6 +1051,8 @@ void ListTransactions(const CWalletTx& wtx, const string& strAccount, int nMinDe\n         if (fLong)\n             WalletTxToJSON(wtx, entry);\n         ret.push_back(entry);\n+\n+        return;\n     }\n \n     // Sent\n@@ -1209,11 +1216,15 @@ Value listaccounts(const Array& params, bool fHelp)\n             if (wtx.GetDepthInMainChain() >= nMinDepth)\n             {\n                 mapAccountBalances[\"\"] += nGeneratedMature;\n-                BOOST_FOREACH(const PAIRTYPE(string, int64)& r, listReceived)\n-                    if (pwalletMain->mapAddressBook.count(r.first))\n-                        mapAccountBalances[pwalletMain->mapAddressBook[r.first]] += r.second;\n-                    else\n-                        mapAccountBalances[\"\"] += r.second;\n+\n+                if (!wtx.IsCoinBase())\n+                {\n+                    BOOST_FOREACH(const PAIRTYPE(string, int64)& r, listReceived)\n+                        if (pwalletMain->mapAddressBook.count(r.first))\n+                            mapAccountBalances[pwalletMain->mapAddressBook[r.first]] += r.second;\n+                        else\n+                            mapAccountBalances[\"\"] += r.second;\n+                }\n             }\n         }\n     }"
      },
      {
        "sha": "899f7830df3fc1022b48e8580dc03bb3f232380c",
        "filename": "src/wallet.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 1,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1ba78c60d127bff22f644e3254a7a181fbc98370/src/wallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1ba78c60d127bff22f644e3254a7a181fbc98370/src/wallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet.cpp?ref=1ba78c60d127bff22f644e3254a7a181fbc98370",
        "patch": "@@ -247,7 +247,6 @@ void CWalletTx::GetAmounts(int64& nGeneratedImmature, int64& nGeneratedMature, l\n             nGeneratedImmature = pwallet->GetCredit(*this);\n         else\n             nGeneratedMature = GetCredit();\n-        return;\n     }\n \n     // Compute fee:\n@@ -309,6 +308,8 @@ void CWalletTx::GetAccountAmounts(const string& strAccount, int64& nGenerated, i\n             nSent += s.second;\n         nFee = allFee;\n     }\n+\n+    if (!IsCoinBase())\n     CRITICAL_BLOCK(pwallet->cs_mapAddressBook)\n     {\n         BOOST_FOREACH(const PAIRTYPE(string,int64)& r, listReceived)"
      }
    ]
  }
]