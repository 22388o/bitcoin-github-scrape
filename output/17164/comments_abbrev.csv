naumenkogs,2019-10-16 18:06:41,">This is only relevant for nodes that accept incoming connections?\n\nNot really. To all the nodes with block-relay-only peers.",https://github.com/bitcoin/bitcoin/pull/17164#issuecomment-542823714,542823714,
GChuf,2019-10-16 18:51:17,"Concept ACK.\nRespectfully, assuming nodes have a ton of resources is dangerous - every optimization is potentially important (talking as a multiple nodes operator here).",https://github.com/bitcoin/bitcoin/pull/17164#issuecomment-542841335,542841335,
MarcoFalke,2019-10-16 19:47:01,"I did some testing with massif, and this saves about 263.3 KiB for 10 peers that connect, but don't have address relay enabled. Note that the tx relay rolling bloom filter takes up 5.1 MB, which sort of dwarfs the gains here.\n\nACK 90407e6fab74cd849d474f0c5dea19b9954d4196\n\n<details><summary>Show signature and timestamp</summary>\n\nSignature:\n\n```\n-----BEGIN PGP SIGNED MESSAGE-----",https://github.com/bitcoin/bitcoin/pull/17164#issuecomment-542862195,542862195,
GChuf,2019-10-16 20:28:39,"@MarcoFalke so, the result is actually ... an extra ~4.8 MB RAM usage?",https://github.com/bitcoin/bitcoin/pull/17164#issuecomment-542877883,542877883,
naumenkogs,2019-10-16 20:42:39,"@GChuf no, Marco's just saying that this update probably saves only 5% of the overall memory we dedicate per peer (or maybe even a bit less due to other stuff).\n\nMy code *does not* introduce any extra overhead.",https://github.com/bitcoin/bitcoin/pull/17164#issuecomment-542883057,542883057,
GChuf,2019-10-16 21:24:38,"@naumenkogs thanks for clarifying. Just had to ask because I wasn't sure I understand.\nAnyway like I said, I think every improvement is important, no matter how small.",https://github.com/bitcoin/bitcoin/pull/17164#issuecomment-542897947,542897947,
MarcoFalke,2019-10-17 17:58:08,"re-ACK 090b75c14be6b9ba2efe38a17d141c6e6af575cb\n\n<details><summary>Show signature and timestamp</summary>\n\nSignature:\n\n```\n-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA512\n\nre-ACK 090b75c14be6b9ba2efe38a17d141c6e6af575cb\n-----BEGIN PGP SIGNATURE-----\n\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUjXJgwAqkfJNeBc+WA9VZaMmaiR1ZLmyt/oKW8fcehMV1FS0Vf0sm32",https://github.com/bitcoin/bitcoin/pull/17164#issuecomment-543291089,543291089,
DrahtBot,2019-10-17 18:53:00,<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.,https://github.com/bitcoin/bitcoin/pull/17164#issuecomment-543312992,543312992,
laanwj,2019-10-24 18:15:24,"I think there should be NULL pointer checks or assertions at the locations that now use `m_addr_known`, just in case.",https://github.com/bitcoin/bitcoin/pull/17164#issuecomment-546039371,546039371,
laanwj,2019-10-28 15:49:32,ACK a552e8477c5bcd22a5457f4f73a2fd6db8acd2c2,https://github.com/bitcoin/bitcoin/pull/17164#issuecomment-547011170,547011170,
MarcoFalke,2019-10-28 20:37:58,"re-ACK a552e8477c5bcd22a5457f4f73a2fd6db8acd2c2\n\n<details><summary>Show signature and timestamp</summary>\n\nSignature:\n\n```\n-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA512\n\nre-ACK a552e8477c5bcd22a5457f4f73a2fd6db8acd2c2\n-----BEGIN PGP SIGNATURE-----\n\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUibEQwAr22ss9KohgyamVhNe0/FeIO1vHR9dSdSknvqKD6DoGkCzgct",https://github.com/bitcoin/bitcoin/pull/17164#issuecomment-547135246,547135246,
dongcarl,2019-10-30 16:55:14,"ACK a552e8477c5bcd22a5457f4f73a2fd6db8acd2c2\n\n-----\n\n### Potential Followups\n\n- Add comments to these functions that describe their assumptions about preconditions (`pto->IsAddrRelayPeer()`)\n- Perhaps tweak the API so that there doesn't need to be preconditions like this (no idea how to do)\n\n### Review Notes\n\nLooked through to see that the new asserts won't crash the daemon w",https://github.com/bitcoin/bitcoin/pull/17164#issuecomment-548006901,548006901,
naumenkogs,2019-10-30 20:21:58,"I agree. At least right now ``m_addr_known`` strongly correlates with ``m_addr_relay_peer.`` We can merge 2 variables.\nIt's also very unlikely that these 2 variables would ever mean different things.",https://github.com/bitcoin/bitcoin/pull/17164#issuecomment-548095426,548095426,
luke-jr,2019-11-04 16:02:53,">This is only relevant for nodes that accept incoming connections? And those nodes are assumed to have a ton of resources. \n\nWhat? No. All nodes ideally should accept incoming connections, it doesn't imply ""a ton of resources""!",https://github.com/bitcoin/bitcoin/pull/17164#issuecomment-549422051,549422051,
laanwj,2020-05-25 16:18:59,"@naumenkogs Please set a different name than `User` in your commits if you want to be credited correctly in the future (I'll fix it up manually for 0.20). \n```\ncommit b6d2183858975abc961207c125c15791e531edcc\nAuthor:     User <n…@gmail.com>\nAuthorDate: Thu Oct 31 13:42:02 2019 -0400\nCommit:     User <n…@gmail.com>\nCommitDate: Thu Oct 31 13:42:02 2019 -0400\n\n    Minor refactoring to ",https://github.com/bitcoin/bitcoin/pull/17164#issuecomment-633640631,633640631,
MarcoFalke,2019-10-16 17:53:18,"why is this needed?\n\nI removed it and I can still compile.",https://github.com/bitcoin/bitcoin/pull/17164#discussion_r335623372,335623372,src/bloom.h
MarcoFalke,2019-10-16 17:53:40,"This comment no longer applies and can be removed\n\nRandomness is initialized on first use",https://github.com/bitcoin/bitcoin/pull/17164#discussion_r335623562,335623562,src/bloom.h
dongcarl,2019-10-16 19:01:33,Is there a particular reason this comment was removed?,https://github.com/bitcoin/bitcoin/pull/17164#discussion_r335655473,335655473,src/bloom.h
naumenkogs,2019-10-16 19:04:05,@MarcoFalke says it doesn't apply anymore.,https://github.com/bitcoin/bitcoin/pull/17164#discussion_r335656489,335656489,src/bloom.h
dongcarl,2019-10-16 19:08:31,"Ah sorry, didn't see!",https://github.com/bitcoin/bitcoin/pull/17164#discussion_r335658313,335658313,src/bloom.h
MarcoFalke,2019-10-16 19:28:10,note to other reviewers: The comment no longer applies after 05fde14e3afe6f7156ebb6df6cd0e3ae12635b89,https://github.com/bitcoin/bitcoin/pull/17164#discussion_r335666526,335666526,src/bloom.h
MarcoFalke,2019-10-16 19:47:36,"```suggestion\n    std::unique_ptr<CRollingBloomFilter> m_addr_known;\n```\n\nstyle-nit: Should use new style for new members",https://github.com/bitcoin/bitcoin/pull/17164#discussion_r335674889,335674889,src/net.h
MarcoFalke,2019-10-30 19:27:18,"```suggestion\n    const std::unique_ptr<CRollingBloomFilter> m_addr_known;\n```\n\nin the first commit:\n\nOn a second thought, this should be made `const` and `m_addr_relay_peer` should be removed:\n\n* Slightly less code\n* Easier to review, because equivalence of `m_addr_relay_peer == bool{m_addr_known}` is obviously true\n* 4 bytes less memory per peer",https://github.com/bitcoin/bitcoin/pull/17164#discussion_r340815678,340815678,src/net.h
MarcoFalke,2019-10-30 19:27:36,"For the full proposed diff:\n\n```diff\ndiff --git a/src/net.cpp b/src/net.cpp\nindex 3cea184ac3..84692d2a79 100644\n--- a/src/net.cpp\n+++ b/src/net.cpp\n@@ -2669,7 +2669,7 @@ CNode::CNode(NodeId idIn, ServiceFlags nLocalServicesIn, int nMyStartingHeightIn\n     // Don't relay addr messages to peers that we connect to as block-relay-only\n     // peers (to prevent adversaries from inferr",https://github.com/bitcoin/bitcoin/pull/17164#discussion_r340815819,340815819,src/net.h
