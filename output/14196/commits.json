[
  {
    "sha": "fcdea8ad2ac1f4f55133fdf9047410631e9cc21f",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmY2RlYThhZDJhYzFmNGY1NTEzM2ZkZjkwNDc0MTA2MzFlOWNjMjFm",
    "commit": {
      "author": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2018-09-11T04:09:57Z"
      },
      "committer": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2018-09-11T04:09:57Z"
      },
      "message": "Drop the unnecessary UTXO based on the UTXOs present, not on earlier wallet things\n\nInstead of dropping the unnecessary UTXO based on whether the wallet did something,\ndo it based on whether two UTXOs are there.",
      "tree": {
        "sha": "9dda42817177ed32c05127e5b7632b614cf2317d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9dda42817177ed32c05127e5b7632b614cf2317d"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fcdea8ad2ac1f4f55133fdf9047410631e9cc21f",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fcdea8ad2ac1f4f55133fdf9047410631e9cc21f",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fcdea8ad2ac1f4f55133fdf9047410631e9cc21f",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fcdea8ad2ac1f4f55133fdf9047410631e9cc21f/comments",
    "author": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "465a583f9dcc2383eb20bbb98bffa66fe82f2cde",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/465a583f9dcc2383eb20bbb98bffa66fe82f2cde",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/465a583f9dcc2383eb20bbb98bffa66fe82f2cde"
      }
    ],
    "stats": {
      "total": 4,
      "additions": 2,
      "deletions": 2
    },
    "files": [
      {
        "sha": "96e63dac230e0be1e5aa6c46cb95c594d56b04e4",
        "filename": "src/wallet/rpcwallet.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fcdea8ad2ac1f4f55133fdf9047410631e9cc21f/src/wallet/rpcwallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fcdea8ad2ac1f4f55133fdf9047410631e9cc21f/src/wallet/rpcwallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/rpcwallet.cpp?ref=fcdea8ad2ac1f4f55133fdf9047410631e9cc21f",
        "patch": "@@ -4525,8 +4525,8 @@ bool FillPSBT(const CWallet* pwallet, PartiallySignedTransaction& psbtx, const C\n             complete &= SignPSBTInput(PublicOnlySigningProvider(pwallet), *psbtx.tx, input, sigdata, i, sighash_type);\n         }\n \n-        if (it != pwallet->mapWallet.end()) {\n-            // Drop the unnecessary UTXO if we added both from the wallet.\n+        // If both UTXO types are present, drop the unnecessary one.\n+        if (input.non_witness_utxo && !input.witness_utxo.IsNull()) {\n             if (sigdata.witness) {\n                 input.non_witness_utxo = nullptr;\n             } else {"
      }
    ]
  },
  {
    "sha": "fcefc6851a624b59bd1bb42d211ce69f85969880",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmY2VmYzY4NTFhNjI0YjU5YmQxYmI0MmQyMTFjZTY5Zjg1OTY5ODgw",
    "commit": {
      "author": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2018-09-11T04:11:00Z"
      },
      "committer": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2018-09-11T04:11:00Z"
      },
      "message": "Convert non-witness UTXOs to witness if witness sig created\n\nIf a witness signature was created when a non-witness UTXO is used,\nconvert the non-witness UTXO to a witness one.",
      "tree": {
        "sha": "bba1b914079964cb51a1dbbba653202910978917",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bba1b914079964cb51a1dbbba653202910978917"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fcefc6851a624b59bd1bb42d211ce69f85969880",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fcefc6851a624b59bd1bb42d211ce69f85969880",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fcefc6851a624b59bd1bb42d211ce69f85969880",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fcefc6851a624b59bd1bb42d211ce69f85969880/comments",
    "author": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fcdea8ad2ac1f4f55133fdf9047410631e9cc21f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fcdea8ad2ac1f4f55133fdf9047410631e9cc21f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fcdea8ad2ac1f4f55133fdf9047410631e9cc21f"
      }
    ],
    "stats": {
      "total": 7,
      "additions": 7,
      "deletions": 0
    },
    "files": [
      {
        "sha": "b268e9a877c8145e7713b60915fcb7d130eed7ce",
        "filename": "src/wallet/rpcwallet.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 0,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fcefc6851a624b59bd1bb42d211ce69f85969880/src/wallet/rpcwallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fcefc6851a624b59bd1bb42d211ce69f85969880/src/wallet/rpcwallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/rpcwallet.cpp?ref=fcefc6851a624b59bd1bb42d211ce69f85969880",
        "patch": "@@ -4525,6 +4525,13 @@ bool FillPSBT(const CWallet* pwallet, PartiallySignedTransaction& psbtx, const C\n             complete &= SignPSBTInput(PublicOnlySigningProvider(pwallet), *psbtx.tx, input, sigdata, i, sighash_type);\n         }\n \n+        if (sigdata.witness) {\n+            // Convert the non-witness utxo to witness\n+            if (input.witness_utxo.IsNull() && input.non_witness_utxo) {\n+                input.witness_utxo = input.non_witness_utxo->vout[txin.prevout.n];\n+            }\n+        }\n+\n         // If both UTXO types are present, drop the unnecessary one.\n         if (input.non_witness_utxo && !input.witness_utxo.IsNull()) {\n             if (sigdata.witness) {"
      }
    ]
  }
]