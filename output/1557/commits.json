[
  {
    "sha": "defcb24795187c389845d53b6e0ea83d8262c006",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkZWZjYjI0Nzk1MTg3YzM4OTg0NWQ1M2I2ZTBlYTgzZDgyNjJjMDA2",
    "commit": {
      "author": {
        "name": "Giel van Schijndel",
        "email": "me@mortis.eu",
        "date": "2012-06-24T12:02:14Z"
      },
      "committer": {
        "name": "Matt Corallo",
        "email": "matt@bluematt.me",
        "date": "2012-07-04T18:05:53Z"
      },
      "message": "Use linker-arguments only when linking\n\nPassing linker-arguments when only compiling will cause warnings with\nClang. This change fixes those.\n\nSigned-off-by: Giel van Schijndel <me@mortis.eu>",
      "tree": {
        "sha": "e58cedf48676a07ca76734271d58d27adf611421",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e58cedf48676a07ca76734271d58d27adf611421"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/defcb24795187c389845d53b6e0ea83d8262c006",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/defcb24795187c389845d53b6e0ea83d8262c006",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/defcb24795187c389845d53b6e0ea83d8262c006",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/defcb24795187c389845d53b6e0ea83d8262c006/comments",
    "author": {
      "login": "muggenhor",
      "id": 484066,
      "node_id": "MDQ6VXNlcjQ4NDA2Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/484066?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/muggenhor",
      "html_url": "https://github.com/muggenhor",
      "followers_url": "https://api.github.com/users/muggenhor/followers",
      "following_url": "https://api.github.com/users/muggenhor/following{/other_user}",
      "gists_url": "https://api.github.com/users/muggenhor/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/muggenhor/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/muggenhor/subscriptions",
      "organizations_url": "https://api.github.com/users/muggenhor/orgs",
      "repos_url": "https://api.github.com/users/muggenhor/repos",
      "events_url": "https://api.github.com/users/muggenhor/events{/privacy}",
      "received_events_url": "https://api.github.com/users/muggenhor/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": null,
    "parents": [
      {
        "sha": "fe70b09c428585166f1040e9023251c9c250e894",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fe70b09c428585166f1040e9023251c9c250e894",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fe70b09c428585166f1040e9023251c9c250e894"
      }
    ],
    "stats": {
      "total": 13,
      "additions": 9,
      "deletions": 4
    },
    "files": [
      {
        "sha": "8bd990e132cfc7ab20c7a61d474eb9c7d252504a",
        "filename": "src/makefile.unix",
        "status": "modified",
        "additions": 9,
        "deletions": 4,
        "changes": 13,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/defcb24795187c389845d53b6e0ea83d8262c006/src/makefile.unix",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/defcb24795187c389845d53b6e0ea83d8262c006/src/makefile.unix",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/makefile.unix?ref=defcb24795187c389845d53b6e0ea83d8262c006",
        "patch": "@@ -66,13 +66,14 @@ LIBS+= \\\n     # Make some important things such as the global offset table read only as soon as\n     # the dynamic linker is finished building it. This will prevent overwriting of addresses\n     # which would later be jumped to.\n-    HARDENING+=-Wl,-z,relro -Wl,-z,now\n+    LDHARDENING+=-Wl,-z,relro -Wl,-z,now\n \n     # Build position independent code to take advantage of Address Space Layout Randomization\n     # offered by some kernels.\n     # see doc/build-unix.txt for more information.\n     ifdef PIE\n-        HARDENING+=-fPIE -pie\n+        HARDENING+=-fPIE\n+        LDHARDENING+=-pie\n     endif\n \n     # -D_FORTIFY_SOURCE=2 does some checking for potentially exploitable code patterns in\n@@ -88,6 +89,10 @@ DEBUGFLAGS=-g\n xCXXFLAGS=-O2 -pthread -Wall -Wextra -Wformat -Wformat-security -Wno-unused-parameter \\\n     $(DEBUGFLAGS) $(DEFS) $(HARDENING) $(CXXFLAGS)\n \n+# LDFLAGS can be specified on the make command line, so we use xLDFLAGS that only\n+# adds some defaults in front. Unfortunately, LDFLAGS=... $(LDFLAGS) does not work.\n+xLDFLAGS=$(LDHARDENING) $(LDFLAGS)\n+\n OBJS= \\\n     obj/version.o \\\n     obj/checkpoints.o \\\n@@ -132,7 +137,7 @@ obj/%.o: %.cpp\n \t  rm -f $(@:%.o=%.d)\n \n bitcoind: $(OBJS:obj/%=obj/%)\n-\t$(CXX) $(xCXXFLAGS) -o $@ $^ $(LDFLAGS) $(LIBS)\n+\t$(CXX) $(xCXXFLAGS) -o $@ $^ $(xLDFLAGS) $(LIBS)\n \n TESTOBJS := $(patsubst test/%.cpp,obj-test/%.o,$(wildcard test/*.cpp))\n \n@@ -144,7 +149,7 @@ obj-test/%.o: test/%.cpp\n \t  rm -f $(@:%.o=%.d)\n \n test_bitcoin: $(TESTOBJS) $(filter-out obj/init.o,$(OBJS:obj/%=obj/%))\n-\t$(CXX) $(xCXXFLAGS) -o $@ $(LIBPATHS) $^ -Wl,-B$(LMODE) -lboost_unit_test_framework $(LDFLAGS) $(LIBS)\n+\t$(CXX) $(xCXXFLAGS) -o $@ $(LIBPATHS) $^ -Wl,-B$(LMODE) -lboost_unit_test_framework $(xLDFLAGS) $(LIBS)\n \n clean:\n \t-rm -f bitcoind test_bitcoin"
      }
    ]
  },
  {
    "sha": "dbce4de42644ffabc33eb4abe53ebee15fbd8dcc",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkYmNlNGRlNDI2NDRmZmFiYzMzZWI0YWJlNTNlYmVlMTVmYmQ4ZGNj",
    "commit": {
      "author": {
        "name": "Matt Corallo",
        "email": "matt@bluematt.me",
        "date": "2012-07-04T18:01:44Z"
      },
      "committer": {
        "name": "Matt Corallo",
        "email": "matt@bluematt.me",
        "date": "2012-07-04T19:26:21Z"
      },
      "message": "Make compiling using clang possible without editing makefiles.",
      "tree": {
        "sha": "0a9bc134eb1c24f92ce7ad6e396b175fc1151eb5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0a9bc134eb1c24f92ce7ad6e396b175fc1151eb5"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dbce4de42644ffabc33eb4abe53ebee15fbd8dcc",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dbce4de42644ffabc33eb4abe53ebee15fbd8dcc",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/dbce4de42644ffabc33eb4abe53ebee15fbd8dcc",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dbce4de42644ffabc33eb4abe53ebee15fbd8dcc/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "defcb24795187c389845d53b6e0ea83d8262c006",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/defcb24795187c389845d53b6e0ea83d8262c006",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/defcb24795187c389845d53b6e0ea83d8262c006"
      }
    ],
    "stats": {
      "total": 24,
      "additions": 23,
      "deletions": 1
    },
    "files": [
      {
        "sha": "e0b72d6d8b0b41766ae60271f5c47c11f71abd1a",
        "filename": "bitcoin-qt.pro",
        "status": "modified",
        "additions": 23,
        "deletions": 1,
        "changes": 24,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/dbce4de42644ffabc33eb4abe53ebee15fbd8dcc/bitcoin-qt.pro",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/dbce4de42644ffabc33eb4abe53ebee15fbd8dcc/bitcoin-qt.pro",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/bitcoin-qt.pro?ref=dbce4de42644ffabc33eb4abe53ebee15fbd8dcc",
        "patch": "@@ -76,10 +76,32 @@ contains(BITCOIN_NEED_QT_PLUGINS, 1) {\n !windows {\n     # for extra security against potential buffer overflows\n     QMAKE_CXXFLAGS += -fstack-protector\n-    QMAKE_LFLAGS += -fstack-protector\n+    !contains(USE_CLANG, 1) {\n+        # llvm-ld doesn't have a -fstack-protector\n+        QMAKE_LFLAGS += -fstack-protector\n+    }\n     # do not enable this on windows, as it will result in a non-working executable!\n }\n \n+contains(USE_CLANG, 1) {\n+    QMAKE_CC = clang\n+    QMAKE_CXX = clang++\n+    QMAKE_LINK = llvm-ld\n+    QMAKE_LFLAGS = -native\n+    QMAKE_LFLAGS_RELEASE =\n+}\n+\n+contains(USE_LTO, 1) {\n+    contains(USE_CLANG, 1) {\n+        QMAKE_CFLAGS += -emit-llvm\n+        QMAKE_CXXFLAGS += -emit-llvm\n+    } else {\n+        QMAKE_CFLAGS += -flto\n+        QMAKE_CXXFLAGS += -flto\n+        QMAKE_LFLAGS += -flto\n+    }\n+}\n+\n # regenerate src/build.h\n !windows || contains(USE_BUILD_INFO, 1) {\n     genbuild.depends = FORCE"
      }
    ]
  }
]