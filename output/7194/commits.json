[
  {
    "sha": "16d4fce0b203bdaa679ad5b3f1e6b6f46880d5d2",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxNmQ0ZmNlMGIyMDNiZGFhNjc5YWQ1YjNmMWU2YjZmNDY4ODBkNWQy",
    "commit": {
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@gmail.com",
        "date": "2015-12-09T17:01:34Z"
      },
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@gmail.com",
        "date": "2015-12-14T18:40:11Z"
      },
      "message": "Add assert_is_hex_string and assert_is_hash_string to RPC test utils.",
      "tree": {
        "sha": "2640e393f7dfd7da38e704cf7d115dbf25e93e09",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2640e393f7dfd7da38e704cf7d115dbf25e93e09"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/16d4fce0b203bdaa679ad5b3f1e6b6f46880d5d2",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/16d4fce0b203bdaa679ad5b3f1e6b6f46880d5d2",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/16d4fce0b203bdaa679ad5b3f1e6b6f46880d5d2",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/16d4fce0b203bdaa679ad5b3f1e6b6f46880d5d2/comments",
    "author": {
      "login": "jamesob",
      "id": 73197,
      "node_id": "MDQ6VXNlcjczMTk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jamesob",
      "html_url": "https://github.com/jamesob",
      "followers_url": "https://api.github.com/users/jamesob/followers",
      "following_url": "https://api.github.com/users/jamesob/following{/other_user}",
      "gists_url": "https://api.github.com/users/jamesob/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
      "organizations_url": "https://api.github.com/users/jamesob/orgs",
      "repos_url": "https://api.github.com/users/jamesob/repos",
      "events_url": "https://api.github.com/users/jamesob/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jamesob/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jamesob",
      "id": 73197,
      "node_id": "MDQ6VXNlcjczMTk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jamesob",
      "html_url": "https://github.com/jamesob",
      "followers_url": "https://api.github.com/users/jamesob/followers",
      "following_url": "https://api.github.com/users/jamesob/following{/other_user}",
      "gists_url": "https://api.github.com/users/jamesob/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
      "organizations_url": "https://api.github.com/users/jamesob/orgs",
      "repos_url": "https://api.github.com/users/jamesob/repos",
      "events_url": "https://api.github.com/users/jamesob/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jamesob/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "9ee02cf564d1ce79d2981899cb4d38c914210dc7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9ee02cf564d1ce79d2981899cb4d38c914210dc7",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/9ee02cf564d1ce79d2981899cb4d38c914210dc7"
      }
    ],
    "stats": {
      "total": 17,
      "additions": 17,
      "deletions": 0
    },
    "files": [
      {
        "sha": "a0f5b1afde9ff09aeda117fa3a5abe66e72e3476",
        "filename": "qa/rpc-tests/test_framework/util.py",
        "status": "modified",
        "additions": 17,
        "deletions": 0,
        "changes": 17,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/16d4fce0b203bdaa679ad5b3f1e6b6f46880d5d2/qa/rpc-tests/test_framework/util.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/16d4fce0b203bdaa679ad5b3f1e6b6f46880d5d2/qa/rpc-tests/test_framework/util.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/qa/rpc-tests/test_framework/util.py?ref=16d4fce0b203bdaa679ad5b3f1e6b6f46880d5d2",
        "patch": "@@ -407,5 +407,22 @@ def assert_raises(exc, fun, *args, **kwds):\n     else:\n         raise AssertionError(\"No exception raised\")\n \n+def assert_is_hex_string(string):\n+    try:\n+        int(string, 16)\n+    except Exception as e:\n+        raise AssertionError(\n+            \"Couldn't interpret %r as hexadecimal; raised: %s\" % (string, e))\n+\n+def assert_is_hash_string(string, length=64):\n+    if not isinstance(string, basestring):\n+        raise AssertionError(\"Expected a string, got type %r\" % type(string))\n+    elif length and len(string) != length:\n+        raise AssertionError(\n+            \"String of length %d expected; got %d\" % (length, len(string)))\n+    elif not re.match('[abcdef0-9]+$', string):\n+        raise AssertionError(\n+            \"String %r contains invalid characters for a hash.\" % string)\n+\n def satoshi_round(amount):\n     return  Decimal(amount).quantize(Decimal('0.00000001'), rounding=ROUND_DOWN)"
      }
    ]
  },
  {
    "sha": "4745636126d9a4f28f701f701be392779815a7bf",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0NzQ1NjM2MTI2ZDlhNGYyOGY3MDFmNzAxYmUzOTI3Nzk4MTVhN2Jm",
    "commit": {
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@gmail.com",
        "date": "2015-12-09T17:02:19Z"
      },
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@gmail.com",
        "date": "2015-12-14T18:40:15Z"
      },
      "message": "Add RPC documentation for getblockheader[chainwork].",
      "tree": {
        "sha": "7075f9d3fc16e3dd959fd356ad3f3fbf439fc64c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7075f9d3fc16e3dd959fd356ad3f3fbf439fc64c"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4745636126d9a4f28f701f701be392779815a7bf",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4745636126d9a4f28f701f701be392779815a7bf",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/4745636126d9a4f28f701f701be392779815a7bf",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4745636126d9a4f28f701f701be392779815a7bf/comments",
    "author": {
      "login": "jamesob",
      "id": 73197,
      "node_id": "MDQ6VXNlcjczMTk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jamesob",
      "html_url": "https://github.com/jamesob",
      "followers_url": "https://api.github.com/users/jamesob/followers",
      "following_url": "https://api.github.com/users/jamesob/following{/other_user}",
      "gists_url": "https://api.github.com/users/jamesob/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
      "organizations_url": "https://api.github.com/users/jamesob/orgs",
      "repos_url": "https://api.github.com/users/jamesob/repos",
      "events_url": "https://api.github.com/users/jamesob/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jamesob/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jamesob",
      "id": 73197,
      "node_id": "MDQ6VXNlcjczMTk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jamesob",
      "html_url": "https://github.com/jamesob",
      "followers_url": "https://api.github.com/users/jamesob/followers",
      "following_url": "https://api.github.com/users/jamesob/following{/other_user}",
      "gists_url": "https://api.github.com/users/jamesob/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
      "organizations_url": "https://api.github.com/users/jamesob/orgs",
      "repos_url": "https://api.github.com/users/jamesob/repos",
      "events_url": "https://api.github.com/users/jamesob/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jamesob/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "16d4fce0b203bdaa679ad5b3f1e6b6f46880d5d2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/16d4fce0b203bdaa679ad5b3f1e6b6f46880d5d2",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/16d4fce0b203bdaa679ad5b3f1e6b6f46880d5d2"
      }
    ],
    "stats": {
      "total": 3,
      "additions": 2,
      "deletions": 1
    },
    "files": [
      {
        "sha": "28c2db4501d3695cc3cd07abd87ea905aed0b213",
        "filename": "src/rpcblockchain.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 1,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4745636126d9a4f28f701f701be392779815a7bf/src/rpcblockchain.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4745636126d9a4f28f701f701be392779815a7bf/src/rpcblockchain.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpcblockchain.cpp?ref=4745636126d9a4f28f701f701be392779815a7bf",
        "patch": "@@ -323,7 +323,8 @@ UniValue getblockheader(const UniValue& params, bool fHelp)\n             \"  \\\"bits\\\" : \\\"1d00ffff\\\", (string) The bits\\n\"\n             \"  \\\"difficulty\\\" : x.xxx,  (numeric) The difficulty\\n\"\n             \"  \\\"previousblockhash\\\" : \\\"hash\\\",  (string) The hash of the previous block\\n\"\n-            \"  \\\"nextblockhash\\\" : \\\"hash\\\"       (string) The hash of the next block\\n\"\n+            \"  \\\"nextblockhash\\\" : \\\"hash\\\",      (string) The hash of the next block\\n\"\n+            \"  \\\"chainwork\\\" : \\\"0000...1f3\\\"     (string) Expected number of hashes required to produce the current chain (in hex)\\n\"\n             \"}\\n\"\n             \"\\nResult (for verbose=false):\\n\"\n             \"\\\"data\\\"             (string) A string that is serialized, hex-encoded data for block 'hash'.\\n\""
      }
    ]
  },
  {
    "sha": "135d6ec8cedc83ad800da45080c16d49e9182e80",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxMzVkNmVjOGNlZGM4M2FkODAwZGE0NTA4MGMxNmQ0OWU5MTgyZTgw",
    "commit": {
      "author": {
        "name": "James O'Beirne",
        "email": "james.obeirne@gmail.com",
        "date": "2015-12-09T17:02:59Z"
      },
      "committer": {
        "name": "James O'Beirne",
        "email": "james.obeirne@gmail.com",
        "date": "2015-12-14T18:40:15Z"
      },
      "message": "Add RPC tests for getblockheader.",
      "tree": {
        "sha": "7f02cb847a0074472978698cc146df6617b3493f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7f02cb847a0074472978698cc146df6617b3493f"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/135d6ec8cedc83ad800da45080c16d49e9182e80",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/135d6ec8cedc83ad800da45080c16d49e9182e80",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/135d6ec8cedc83ad800da45080c16d49e9182e80",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/135d6ec8cedc83ad800da45080c16d49e9182e80/comments",
    "author": {
      "login": "jamesob",
      "id": 73197,
      "node_id": "MDQ6VXNlcjczMTk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jamesob",
      "html_url": "https://github.com/jamesob",
      "followers_url": "https://api.github.com/users/jamesob/followers",
      "following_url": "https://api.github.com/users/jamesob/following{/other_user}",
      "gists_url": "https://api.github.com/users/jamesob/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
      "organizations_url": "https://api.github.com/users/jamesob/orgs",
      "repos_url": "https://api.github.com/users/jamesob/repos",
      "events_url": "https://api.github.com/users/jamesob/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jamesob/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jamesob",
      "id": 73197,
      "node_id": "MDQ6VXNlcjczMTk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jamesob",
      "html_url": "https://github.com/jamesob",
      "followers_url": "https://api.github.com/users/jamesob/followers",
      "following_url": "https://api.github.com/users/jamesob/following{/other_user}",
      "gists_url": "https://api.github.com/users/jamesob/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
      "organizations_url": "https://api.github.com/users/jamesob/orgs",
      "repos_url": "https://api.github.com/users/jamesob/repos",
      "events_url": "https://api.github.com/users/jamesob/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jamesob/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "4745636126d9a4f28f701f701be392779815a7bf",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4745636126d9a4f28f701f701be392779815a7bf",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/4745636126d9a4f28f701f701be392779815a7bf"
      }
    ],
    "stats": {
      "total": 36,
      "additions": 35,
      "deletions": 1
    },
    "files": [
      {
        "sha": "81deab89005c6f926837bfdb275a0fe7fe536852",
        "filename": "qa/rpc-tests/blockchain.py",
        "status": "modified",
        "additions": 35,
        "deletions": 1,
        "changes": 36,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/135d6ec8cedc83ad800da45080c16d49e9182e80/qa/rpc-tests/blockchain.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/135d6ec8cedc83ad800da45080c16d49e9182e80/qa/rpc-tests/blockchain.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/qa/rpc-tests/blockchain.py?ref=135d6ec8cedc83ad800da45080c16d49e9182e80",
        "patch": "@@ -4,19 +4,25 @@\n # file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #\n-# Test RPC calls related to blockchain state.\n+# Test RPC calls related to blockchain state. Tests correspond to code in\n+# rpcblockchain.cpp.\n #\n \n import decimal\n \n from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.authproxy import JSONRPCException\n from test_framework.util import (\n     initialize_chain,\n     assert_equal,\n+    assert_raises,\n+    assert_is_hex_string,\n+    assert_is_hash_string,\n     start_nodes,\n     connect_nodes_bi,\n )\n \n+\n class BlockchainTest(BitcoinTestFramework):\n     \"\"\"\n     Test blockchain-related RPC calls:\n@@ -36,6 +42,10 @@ def setup_network(self, split=False):\n         self.sync_all()\n \n     def run_test(self):\n+        self._test_gettxoutsetinfo()\n+        self._test_getblockheader()\n+\n+    def _test_gettxoutsetinfo(self):\n         node = self.nodes[0]\n         res = node.gettxoutsetinfo()\n \n@@ -47,6 +57,30 @@ def run_test(self):\n         assert_equal(len(res[u'bestblock']), 64)\n         assert_equal(len(res[u'hash_serialized']), 64)\n \n+    def _test_getblockheader(self):\n+        node = self.nodes[0]\n+\n+        assert_raises(\n+            JSONRPCException, lambda: node.getblockheader('nonsense'))\n+\n+        besthash = node.getbestblockhash()\n+        secondbesthash = node.getblockhash(199)\n+        header = node.getblockheader(besthash)\n+\n+        assert_equal(header['hash'], besthash)\n+        assert_equal(header['height'], 200)\n+        assert_equal(header['confirmations'], 1)\n+        assert_equal(header['previousblockhash'], secondbesthash)\n+        assert_is_hex_string(header['chainwork'])\n+        assert_is_hash_string(header['hash'])\n+        assert_is_hash_string(header['previousblockhash'])\n+        assert_is_hash_string(header['merkleroot'])\n+        assert_is_hash_string(header['bits'], length=None)\n+        assert isinstance(header['time'], int)\n+        assert isinstance(header['mediantime'], int)\n+        assert isinstance(header['nonce'], int)\n+        assert isinstance(header['version'], int)\n+        assert isinstance(header['difficulty'], decimal.Decimal)\n \n if __name__ == '__main__':\n     BlockchainTest().main()"
      }
    ]
  }
]