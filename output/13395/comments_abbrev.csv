DrahtBot,2018-06-05T00:45:06Z,"<!--e57a25ab6845829454e8d69fc972939a-->Note to reviewers: This pull request conflicts with the following ones:\n\n* #13413 ([net,mempool] Call AcceptToMemoryPool() asynchronously in p2p by skeees)\n* #13399 (rpc: Add submitblockheader by MarcoFalke)\n* #12934 ([net] [validation] Call ProcessNewBlock() asynchronously by skeees)\n\nIf you consider this pull request important, please also help to rev",https://github.com/bitcoin/bitcoin/pull/13395#issuecomment-394544497,394544497,
practicalswift,2018-06-05T07:10:02Z,Is @DrahtBot a new addition to the project? Who is the bot owner? :-),https://github.com/bitcoin/bitcoin/pull/13395#issuecomment-394604964,394604964,
laanwj,2018-06-05T13:39:08Z,"An evil paperclip robot, I don't know whose it is. But it seems useful.\n\nutACK fa4125621554f2f94fded1896ba7eae10ef954da",https://github.com/bitcoin/bitcoin/pull/13395#issuecomment-394712392,394712392,
promag,2018-06-05T16:00:14Z,"utACK fa41256. Nit, `Result: ` help could be improved.",https://github.com/bitcoin/bitcoin/pull/13395#issuecomment-394765148,394765148,
TheBlueMatt,2018-06-06T17:18:28Z,"This breaks having two submitblocks in paralell. Now instead of one returning true and the other duplicate, you might have one return true and one simply return ""inconclusive"". I think the correct fix is to just set fBlockPresent to pindex->nStatus & HAVE_DATA.",https://github.com/bitcoin/bitcoin/pull/13395#issuecomment-395146705,395146705,
MarcoFalke,2018-06-06T17:30:41Z,"@TheBlueMatt I don't see how this fixes the race. The only other option I see is to partially revert the commit that introduced the bug (eb63bf86cf6dc99f150574463df6ffb013a34493), i.e. read from mapBlockIndex *after* `ProcessNewBlock`.",https://github.com/bitcoin/bitcoin/pull/13395#issuecomment-395150444,395150444,
TheBlueMatt,2018-06-06T17:32:27Z,"Ah, indeed, must have been introduced on master when ProcessNewBlock lost its cs_main at call-time. Obvious fix would be to duplicate the fBlockPresent check after PNB by re-acquiring cs_main.",https://github.com/bitcoin/bitcoin/pull/13395#issuecomment-395150992,395150992,
skeees,2018-06-06T18:36:29Z,"utACK\n\nMaybe DrahtBot can rebase my PR for me once this is merged ;-)",https://github.com/bitcoin/bitcoin/pull/13395#issuecomment-395170716,395170716,
MarcoFalke,2018-06-06T18:49:16Z,"I force pushed the commit with two changes:\n\n* `return ""duplicate""` when `fNewBlock` is given as false from PNB\n* Add a TODO to properly set fNewBlock when a new invalid block is sent, that fails ABH. (I am not going to touch that code in this pull request, since my main goal is to fix invalid return for the rpc)\n\nShould be easy to re-ACK",https://github.com/bitcoin/bitcoin/pull/13395#issuecomment-395174689,395174689,
jnewbery,2018-06-06T21:17:03Z,utACK fa08ebd7f24fc911b1af14644e4e235b6f3f9316,https://github.com/bitcoin/bitcoin/pull/13395#issuecomment-395216681,395216681,
promag,2018-06-10T21:48:16Z,re-utACK fa08ebd.,https://github.com/bitcoin/bitcoin/pull/13395#issuecomment-396084558,396084558,
jnewbery,2018-06-11T19:25:22Z,Why close?,https://github.com/bitcoin/bitcoin/pull/13395#issuecomment-396357672,396357672,
MarcoFalke,2018-06-11T19:39:44Z,"> Why close?\n\nTo indicate that it was up for grabs.",https://github.com/bitcoin/bitcoin/pull/13395#issuecomment-396361702,396361702,
jnewbery,2018-06-11T20:09:22Z,"> To indicate that it was up for grabs.\n\nI don't get it. If this is up for grabs you think it should be merged, but you don't want to maintain it? It's currently mergeable and has ACKs. Why not just leave it open?",https://github.com/bitcoin/bitcoin/pull/13395#issuecomment-396370271,396370271,
TheBlueMatt,2018-06-11T20:14:15Z,"Please see #13439. The changes here weren't sufficient, needed one more commit to actually fix the issue mentioned.",https://github.com/bitcoin/bitcoin/pull/13395#issuecomment-396371739,396371739,
jnewbery,2018-06-11T20:31:15Z,Got it. Good to know. Thanks Matt!,https://github.com/bitcoin/bitcoin/pull/13395#issuecomment-396376874,396376874,
