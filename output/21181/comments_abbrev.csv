hebasto,2021-02-15 07:41:51,"Concept ACK. Absence of `anchors.dat` is not an error.\n\n> To not needlessly alarm users upgrading from v0.20 and earlier...\n\nThe `anchors.dat` also could be absent after unclean shut down.",https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-779019407,779019407,
naumenkogs,2021-02-15 07:48:19,Concept ACK,https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-779023147,779023147,
MarcoFalke,2021-02-15 08:12:28,Shouldn't this be done for all files? I am pretty sure it will still print that error for all other files on a fresh start.,https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-779037529,779037529,
jonatack,2021-02-15 08:40:56,"For example, this check is done for the asmap file since #17812 (src/init.cpp::1512) but prints an error, as in this case the user may have provided an incorrect filename or path.",https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-779057646,779057646,
MarcoFalke,2021-02-15 09:14:06,"Maybe it would help to simply remove the screaming `ERROR` in all uppercase. It is not really a fatal error (if it was, the program should stop), but more like a debug statement.\n\n```\n2021-02-15T09:14:40Z ERROR: DeserializeFileDB: Failed to open file /tmp/new_datadir/a/regtest/banlist.dat\n2021-02-15T09:14:40Z Failed to read fee estimates from /tmp/new_datadir/a/regtest/fee_estimates.dat. C",https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-779078612,779078612,
practicalswift,2021-02-15 10:43:51,"Concept ACK\n\nThanks for removing unnecessary (and thus spammy) logging.",https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-779133582,779133582,
jonatack,2021-02-15 11:51:43,"> Maybe it would help to simply remove the screaming `ERROR` in all uppercase.\n\n1. that would not resolve the issue\n\n- @hebasto https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-779019407, ""Absence of anchors.dat is not an error.""\n- @jnewbery http://www.erisian.com.au/bitcoin-core-dev/log-2021-02-14.html#l-116, ""It shouldn't ever be an error condition to not have an anchors.dat ",https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-779171585,779171585,
laanwj,2021-02-15 11:51:49,"Concept and Code review ACK 8f51826d3391ed78dc6f2428d9c556929687d7ea\n\n> Maybe it would help to simply remove the screaming ERROR in all uppercase.\n\nYes screaming is generally bad but apart from that I think it makes sense to have multiple severities in logging.\nE.g. other types of error that happen in `DeserializeFileDB` (say, specific de-serialization errors) might not be fatal but woul",https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-779171632,779171632,
jonatack,2021-02-15 11:54:14,"> I think it makes sense to have multiple severities in logging.\n\nI would like this indeed (and mention it in https://github.com/bitcoin/bitcoin/issues/20576).",https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-779172713,779172713,
jnewbery,2021-02-15 11:58:54,"Concept ACK.\n\n> Maybe it would help to simply remove the screaming ERROR in all uppercase. It is not really a fatal error (if it was, the program should stop), but more like a debug statement.\n\nAgree. It's not an error condition to start without peers.dat, anchors.dat or banlist.dat. I think we could probably resolve all three by just changing the log message?",https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-779175074,779175074,
MarcoFalke,2021-02-15 12:01:59,"I think we should be consistent in the way this is treated. Someone will create a pull in x months to fix this for `banlist.dat`, then for `peers.dat` in y months. So finally we have 5 different error messages for the same condition.\n\n* Failed to read fee estimates from {}. Continue anyway.\n* Failed to open mempool file from disk. Continuing anyway.\n* Could not find anchors file {}\n* Cou",https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-779176888,779176888,
jonatack,2021-02-15 12:03:15,Then perhaps move this change into `DeserializeFileDB()`?,https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-779177600,779177600,
jonatack,2021-02-15 12:05:12,"> I think we should be consistent in the way this is treated. Someone will create a pull in x months to fix this for `banlist.dat`, then for `peers.dat` in y months. \n\nISTM this is what has been happening with moving the logging from debug to NET, one by one, and no one minded. Maybe I should stay away from logging :smile: ",https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-779178617,779178617,
jonatack,2021-02-15 12:08:41,"To my surprise, this is controversial. I think it will have more success if someone else proposes it.",https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-779180567,779180567,
MarcoFalke,2021-02-15 12:11:46,"This has 4 Concept ACK and no NACK, so I don't think anyone sees this as controversial",https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-779182329,779182329,
jnewbery,2021-02-15 12:14:02,This is not at all controversial. I don't understand why this has been closed?,https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-779183546,779183546,
michaelfolkson,2021-02-15 12:20:50,Concept ACK too,https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-779187441,779187441,
jonatack,2021-02-15 12:27:26,"I don't understand the suggested changes. We can't fix this by updating the message in `ReadAnchors()`, it's in `DeserializeFileDB()`. We can't update that message without affecting the other callers. And suddenly we're talking about gathering consensus on aligning unrelated file messages that were never aligned before AFAIK, so a small fix turns into a wide change. I don't know why is that sudden",https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-779190938,779190938,
michaelfolkson,2021-02-15 12:30:17,"Keep the scope as limited as you want and provide some direction for others who might want to open additional PRs on top of this one?\n\nIt is ok (imo) to say ""I see merit in that idea but I want to keep the scope of this PR limited. You are free to open PRs on top of this one if you want to widen the scope"" or ""I think what you are suggesting is too complicated. I would prefer to keep the scope",https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-779192418,779192418,
jonatack,2021-02-15 12:41:08,Updated #20576 to be a general RFC on logging improvements and linked to some of the comments/ideas here.,https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-779198470,779198470,
laanwj,2021-02-15 13:35:57,To be clear I'm completely okay with this specific change my comment was only about possible future direction.,https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-779228805,779228805,
jonatack,2021-02-15 15:07:34,That is how I read it (thank you). Re-opening to respect the time people spent reviewing.,https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-779280920,779280920,
MarcoFalke,2021-02-18 13:17:32,"Obviously this pull is a fine improvement over master, but I am still not convinced that we need to create several back-and-forth patches to fix a trivial logging issue. Created #21222 as an alternative.",https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-781336970,781336970,
jonatack,2021-02-18 15:00:58,"#21222 seems less helpful to users, but you're not happy with this and I'm not keen on having a competition. I was just trying to improve things for our users.",https://github.com/bitcoin/bitcoin/pull/21181#issuecomment-781404155,781404155,
vasild,2021-02-18 10:59:56,"There is a race here - the file may exist during the `fs::exists` check and be deleted after that and before `DeserializeFileDB()`. Of course this is irrelevant and ok in this case. I just can't stop myself from mentioning it. Apparently not everything I do is in my control, sorry.",https://github.com/bitcoin/bitcoin/pull/21181#discussion_r578323229,578323229,src/addrdb.cpp
laanwj,2021-02-18 11:50:07,"I had also noticed this but thought it wise not to comment :smile: (because the race doesn't affect anything but how the error is reported)\nBut yes if you want to be pedantic about it, it would be to make `DeserializeFileDB` return a distinguishable error condition when it could not find the anchors file and then log this message, instead of doing a separate check.",https://github.com/bitcoin/bitcoin/pull/21181#discussion_r578354297,578354297,src/addrdb.cpp
