[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583204148",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583204148",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
    "id": 583204148,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MzIwNDE0OA==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-07T02:23:43Z",
    "updated_at": "2020-02-07T02:23:54Z",
    "author_association": "MEMBER",
    "body": "@sdaftuar You may be interested in this for #18044 - it should be easy to use this to determine how much an extra index adds.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583204148/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583213275",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583213275",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
    "id": 583213275,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MzIxMzI3NQ==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-07T03:07:56Z",
    "updated_at": "2020-07-20T20:36:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19478 (Remove CTxMempool::mapLinks data structure member by JeremyRubin)\n* #19306 (refactor: Replace RecursiveMutex with Mutex in CTxMemPool by hebasto)\n* #18191 (Change UpdateForDescendants to use Epochs by JeremyRubin)\n* #18044 (Use wtxid for transaction relay by sdaftuar)\n* #18017 (txmempool: split epoch logic into class by ajtowns)\n* #10443 (Add fee_est tool for debugging fee estimation code by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583213275/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583217146",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583217146",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
    "id": 583217146,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MzIxNzE0Ng==",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?u=8cdd8653982252593843d7369ecfebe432b89768&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-07T03:26:27Z",
    "updated_at": "2020-02-07T03:26:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "@sipa can you take a look at https://github.com/JeremyRubin/bitcoin/pull/7?\r\n\r\nIt looks like when we get rid of mapTxLinks we'd then want to use an accounting allocator on the new child sets and get some DynamicMemoryUsage added to the cached inner usage?\r\n\r\nAt some point I also want to better break down the cachedInnerUsage tracking into buckets as it makes it easier to trace bugs.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583217146/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583220934",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583220934",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
    "id": 583220934,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MzIyMDkzNA==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-07T03:45:14Z",
    "updated_at": "2020-02-07T03:45:14Z",
    "author_association": "MEMBER",
    "body": "I'm happy to rebase this on top of a removal of mapLinks, if that'd go in first. It looks pretty like I'd just need to remove mapLinks from this as well.\r\n\r\nI don't know if breaking down cachedInnerUsage is all that meaningful, as the Check() function can verify its correctness in aggregate.\r\n\r\nThere are plenty more options of shuffling things with AccountingAllocators... I don't have any particular preference apart from minimizing code changes.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583220934/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583222441",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583222441",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
    "id": 583222441,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MzIyMjQ0MQ==",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?u=8cdd8653982252593843d7369ecfebe432b89768&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-07T03:53:01Z",
    "updated_at": "2020-02-07T03:53:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "Don't you need to make TxLinks sets use accounting allocators in this patch too?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583222441/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583224572",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583224572",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
    "id": 583224572,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MzIyNDU3Mg==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-07T04:04:40Z",
    "updated_at": "2020-02-07T04:04:40Z",
    "author_association": "MEMBER",
    "body": "@JeremyRubin Ah, that seems reasonable. My priority was the things that use a boost multiindex as guessing memory usage there is very hard, but no reason why it can't be extended to also the sets there.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583224572/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583231821",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583231821",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
    "id": 583231821,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MzIzMTgyMQ==",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?u=8cdd8653982252593843d7369ecfebe432b89768&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-07T04:45:05Z",
    "updated_at": "2020-02-07T04:45:05Z",
    "author_association": "CONTRIBUTOR",
    "body": "Do you know if we were over or underestimating before?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583231821/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583232326",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583232326",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
    "id": 583232326,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MzIzMjMyNg==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-07T04:47:46Z",
    "updated_at": "2020-02-07T04:47:46Z",
    "author_association": "MEMBER",
    "body": "In mapTx we were overestimating slightly for realistic mempool size, but underestimating for near-empty ones.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583232326/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583238193",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583238193",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
    "id": 583238193,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MzIzODE5Mw==",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?u=8cdd8653982252593843d7369ecfebe432b89768&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-07T05:16:09Z",
    "updated_at": "2020-02-07T05:16:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "Ok the near empty case doesn't really matter... w.r.t. the realistic size one, here's a question just to be detailed/pedantic with what this change does:\r\n\r\nGiven that we were previously overestimating, if I set my mempool to 100MB then I actually was getting (let's say) 99 MB, if the \"slightly\" was by 1%. If *after* this change, I am now actually using a little bit more memory is this enough to be concerned? E.g., are we going to see a bunch of raspberry pi users complaining of OOMs?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583238193/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583241485",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583241485",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
    "id": 583241485,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MzI0MTQ4NQ==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-07T05:33:13Z",
    "updated_at": "2020-02-07T05:33:13Z",
    "author_association": "MEMBER",
    "body": "Our memory accounting has never been more accurate than in the orders of 10s of MBs. A tiny change like this shouldn't matter.\n\nAnd probably on the long term, it helps: it's likely the case that in some scenarios we were off more than others (e.g. many tiny transactions vs a few big ones) - better estimations means that experimentally-determined max memory limits need less margin.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583241485/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583246497",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583246497",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
    "id": 583246497,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MzI0NjQ5Nw==",
    "user": {
      "login": "JeremyRubin",
      "id": 886523,
      "node_id": "MDQ6VXNlcjg4NjUyMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/886523?u=8cdd8653982252593843d7369ecfebe432b89768&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/JeremyRubin",
      "html_url": "https://github.com/JeremyRubin",
      "followers_url": "https://api.github.com/users/JeremyRubin/followers",
      "following_url": "https://api.github.com/users/JeremyRubin/following{/other_user}",
      "gists_url": "https://api.github.com/users/JeremyRubin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/JeremyRubin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/JeremyRubin/subscriptions",
      "organizations_url": "https://api.github.com/users/JeremyRubin/orgs",
      "repos_url": "https://api.github.com/users/JeremyRubin/repos",
      "events_url": "https://api.github.com/users/JeremyRubin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/JeremyRubin/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-07T05:57:34Z",
    "updated_at": "2020-02-07T05:57:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "The mempool tests happen to be very fragile -- I've noticed that sometimes when I made the mempool more memory efficient (e.g., in removing mapLinks) there are a bunch of failures because the tests depend on evictions happening because it's out of space.\r\n\r\nI'm not positive that's why your tests are failing, but it could be related.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583246497/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583247641",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-583247641",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
    "id": 583247641,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4MzI0NzY0MQ==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-07T06:02:29Z",
    "updated_at": "2020-02-07T06:02:29Z",
    "author_association": "MEMBER",
    "body": "Yes, they're failing because the mempool limits now work slightly differently. The test makes rather silly assumptions on the menory usage of transaction entries.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/583247641/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/605065055",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-605065055",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
    "id": 605065055,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYwNTA2NTA1NQ==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-03-27T15:33:42Z",
    "updated_at": "2020-03-27T15:33:42Z",
    "author_association": "MEMBER",
    "body": "Concept ACK, I think this is an elegant way to track accurate usage.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/605065055/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/623057883",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-623057883",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
    "id": 623057883,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMzA1Nzg4Mw==",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?u=7297e8aaf9188c0cb98bc549a8a02a1dc8d59e4c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-03T05:40:22Z",
    "updated_at": "2020-05-03T05:40:22Z",
    "author_association": "MEMBER",
    "body": "Concept ACK.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/623057883/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628788590",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-628788590",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
    "id": 628788590,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyODc4ODU5MA==",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?u=7297e8aaf9188c0cb98bc549a8a02a1dc8d59e4c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-14T17:46:11Z",
    "updated_at": "2020-05-14T17:46:11Z",
    "author_association": "MEMBER",
    "body": "> In mapTx we were overestimating slightly for realistic mempool size, but underestimating for near-empty ones.\r\n\r\nAs unit tests are based on \"near-empty\" containers the difference of estimations seems broke them.\r\n\r\nTesting ed1c5b1b98a19b6751d739f86cdc305bb3cff283 with `mempool_tests/MempoolSizeLimitTest`: the difference in `CTxMemPool::DynamicMemoryUsage()` is ~700 bytes.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/628788590/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/629281995",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-629281995",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
    "id": 629281995,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyOTI4MTk5NQ==",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?u=7297e8aaf9188c0cb98bc549a8a02a1dc8d59e4c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-15T14:59:02Z",
    "updated_at": "2020-05-15T14:59:02Z",
    "author_association": "MEMBER",
    "body": "Mind looking into https://github.com/hebasto/bitcoin/commits/test18086 ?\r\nIn that branch the first two commits eliminate the influence of memory allocated amount for the empty memory pool in unit tests.\r\nThen all the unit and functional tests passed.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/629281995/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/655803148",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-655803148",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
    "id": 655803148,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NTgwMzE0OA==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-08T23:08:07Z",
    "updated_at": "2020-07-08T23:08:07Z",
    "author_association": "MEMBER",
    "body": "@hebasto That looks great. I've included your test/annotation improvements.\r\n\r\nI also added some comments, and made a change so that when a copy of a container is made, that copy is unaccounted. I think this makes sense conceptually (copies tend to be short-lived and not account for permanent storage), as well as reduce locking issues (otherwise you'd always need a lock on the original accounting variable when modifying the copy...).",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/655803148/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/656491893",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-656491893",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
    "id": 656491893,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NjQ5MTg5Mw==",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?u=7297e8aaf9188c0cb98bc549a8a02a1dc8d59e4c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-10T05:32:38Z",
    "updated_at": "2020-07-10T05:32:38Z",
    "author_association": "MEMBER",
    "body": "From the [IRC discussion](http://www.erisian.com.au/bitcoin-core-dev/log-2020-07-09.html):\r\n> \\<cfields\\> sipa: I suppose the old gcc issue is that the propagate_on_container_* aren't respected ?\r\n> \\<sipa\\> cfields: possibly\r\n> \\<sipa\\> but it looks like that\r\n> \\<cfields\\> sipa: from libstdc++ 4.8 release docs \"23.2.1\tGeneral container requirements\tPartial\tOnly vector and forward_list meet the requirements relating to allocator use and propagation.\"\r\n> \\<sipa\\> cfields: ah\r\n> \\<cfields\\> sipa: if it makes you feel any better, looks like support for all standard containers didn't exist until 6.x.\r\n> \\<sipa\\> cfields: seems i may just need to give up on the no-propagate-on-copy, and add a big disclaimer",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/656491893/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/656494251",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-656494251",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
    "id": 656494251,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1NjQ5NDI1MQ==",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?u=7297e8aaf9188c0cb98bc549a8a02a1dc8d59e4c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-10T05:41:46Z",
    "updated_at": "2020-07-10T05:41:46Z",
    "author_association": "MEMBER",
    "body": "[Bug 96074 - Associative containers never propagate allocator on copy assignment](https://gcc.gnu.org/bugzilla/show_bug.cgi?id=96074)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/656494251/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/662673758",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-662673758",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
    "id": 662673758,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2MjY3Mzc1OA==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-22T20:16:29Z",
    "updated_at": "2020-07-22T20:16:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--cf906140f33d8803c4a75a2196329ecb-->\n\ud83d\udc19 This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/662673758/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/674076114",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-674076114",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
    "id": 674076114,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY3NDA3NjExNA==",
    "user": {
      "login": "adamjonas",
      "id": 755825,
      "node_id": "MDQ6VXNlcjc1NTgyNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/755825?u=fc2e6f106f98731d49e9787f9cbfe86a17447c23&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/adamjonas",
      "html_url": "https://github.com/adamjonas",
      "followers_url": "https://api.github.com/users/adamjonas/followers",
      "following_url": "https://api.github.com/users/adamjonas/following{/other_user}",
      "gists_url": "https://api.github.com/users/adamjonas/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/adamjonas/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/adamjonas/subscriptions",
      "organizations_url": "https://api.github.com/users/adamjonas/orgs",
      "repos_url": "https://api.github.com/users/adamjonas/repos",
      "events_url": "https://api.github.com/users/adamjonas/events{/privacy}",
      "received_events_url": "https://api.github.com/users/adamjonas/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-08-14T13:31:26Z",
    "updated_at": "2020-08-14T13:34:44Z",
    "author_association": "MEMBER",
    "body": "It looks like this will need a rebase anyway, but I'm having issues compiling eace374a0, which looks consistent with the CI.\r\n\r\n<details><summary>Error</summary>\r\n\r\n```\r\n./memusage.h:92:64: error: cannot initialize a parameter of type 'std::__1::allocator<std::__1::__hash_node<int, void *> >::pointer' (aka 'std::__1::__hash_node<int, void *> *') with an lvalue of type 'int *'\r\n    template<typename P> void destroy(P* ptr) { m_base.destroy(ptr); }\r\n                                                               ^~~\r\n/Library/Developer/CommandLineTools/usr/include/c++/v1/memory:1742:18: note: in instantiation of function template specialization 'memusage::AccountingAllocator<std::__1::__hash_node<int, void *> >::destroy<int>' requested here\r\n            {__a.destroy(__p);}\r\n                 ^\r\n/Library/Developer/CommandLineTools/usr/include/c++/v1/memory:1595:14: note: in instantiation of function template specialization 'std::__1::allocator_traits<memusage::AccountingAllocator<std::__1::__hash_node<int, void *> > >::__destroy<int>' requested here\r\n            {__destroy(__has_destroy<allocator_type, _Tp*>(), __a, __p);}\r\n             ^\r\n/Library/Developer/CommandLineTools/usr/include/c++/v1/__hash_table:845:29: note: in instantiation of function template specialization 'std::__1::allocator_traits<memusage::AccountingAllocator<std::__1::__hash_node<int, void *> > >::destroy<int>' requested here\r\n            __alloc_traits::destroy(__na_, _NodeTypes::__get_ptr(__p->__value_));\r\n                            ^\r\n/Library/Developer/CommandLineTools/usr/include/c++/v1/memory:2648:7: note: in instantiation of member function 'std::__1::__hash_node_destructor<memusage::AccountingAllocator<std::__1::__hash_node<int, void *> > >::operator()' requested here\r\n      __ptr_.second()(__tmp);\r\n      ^\r\n/Library/Developer/CommandLineTools/usr/include/c++/v1/memory:2602:19: note: in instantiation of member function 'std::__1::unique_ptr<std::__1::__hash_node<int, void *>, std::__1::__hash_node_destructor<memusage::AccountingAllocator<std::__1::__hash_node<int, void *> > > >::reset' requested here\r\n  ~unique_ptr() { reset(); }\r\n                  ^\r\n/Library/Developer/CommandLineTools/usr/include/c++/v1/__hash_table:2034:29: note: in instantiation of member function 'std::__1::unique_ptr<std::__1::__hash_node<int, void *>, std::__1::__hash_node_destructor<memusage::AccountingAllocator<std::__1::__hash_node<int, void *> > > >::~unique_ptr' requested here\r\n        __node_holder __h = __construct_node_hash(__hash, _VSTD::forward<_Args>(__args)...);\r\n                            ^\r\n/Library/Developer/CommandLineTools/usr/include/c++/v1/__hash_table:1146:16: note: in instantiation of function template specialization 'std::__1::__hash_table<int, std::__1::hash<int>, std::__1::equal_to<int>, memusage::AccountingAllocator<int> >::__emplace_unique_key_args<int, const int &>' requested here\r\n        return __emplace_unique_key_args(_NodeTypes::__get_key(__x), __x);\r\n               ^\r\n/Library/Developer/CommandLineTools/usr/include/c++/v1/unordered_set:864:18: note: in instantiation of member function 'std::__1::__hash_table<int, std::__1::hash<int>, std::__1::equal_to<int>, memusage::AccountingAllocator<int> >::__insert_unique' requested here\r\n        __table_.__insert_unique(*__first);\r\n                 ^\r\n/Library/Developer/CommandLineTools/usr/include/c++/v1/unordered_set:831:5: note: in instantiation of function template specialization 'std::__1::unordered_set<int, std::__1::hash<int>, std::__1::equal_to<int>, memusage::AccountingAllocator<int> >::insert<const int *>' requested here\r\n    insert(__il.begin(), __il.end());\r\n    ^\r\ntest/allocator_tests.cpp:245:24: note: in instantiation of member function 'std::__1::unordered_set<int, std::__1::hash<int>, std::__1::equal_to<int>, memusage::AccountingAllocator<int> >::unordered_set' requested here\r\n        container_type container1({}, 2, std::hash<int>(), std::equal_to<int>(), memusage::AccountingAllocator<int>(dummy)); // container1 is accounted for in 'dummy'\r\n                       ^\r\n/Library/Developer/CommandLineTools/usr/include/c++/v1/memory:1880:52: note: passing argument to parameter '__p' here\r\n    _LIBCPP_INLINE_VISIBILITY void destroy(pointer __p) {__p->~_Tp();}\r\n                                                   ^\r\n1 error generated.\r\n```\r\n</details>",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/674076114/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/707924249",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-707924249",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
    "id": 707924249,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNzkyNDI0OQ==",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?u=7297e8aaf9188c0cb98bc549a8a02a1dc8d59e4c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-13T18:20:33Z",
    "updated_at": "2020-10-13T20:06:17Z",
    "author_association": "MEMBER",
    "body": "@sipa @adamjonas \r\nMind looking into https://github.com/hebasto/bitcoin/commits/201013-build18086 ?\r\n\r\nThat branch is rebased and:\r\n- dropped \"Make AccountingAllocator not inherent from std::allocator\" commit\r\n- integrated [my suggestion](https://github.com/bitcoin/bitcoin/pull/18086#discussion_r452654297)\r\n- improved tests: s/`BOOST_CHECK`/`BOOST_CHECK_EQUAL`/ (was very useful for me during debugging)\r\n- added a commit with the test for `std::map` as it is the container we actually use with the `AccountingAllocator` (among `std::vector` and `boost::multi_index_container`)\r\n\r\nCI CentOS build fails due to the old GCC 4.8 which, I think, just lacks support of the [`std::allocator_traits<Alloc>::select_on_container_copy_construction`](https://en.cppreference.com/w/cpp/memory/allocator_traits/select_on_container_copy_construction). It even lacks [`map( const Allocator& alloc )`](https://en.cppreference.com/w/cpp/container/map/map) constructor.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/707924249/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/707960448",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#issuecomment-707960448",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18086",
    "id": 707960448,
    "node_id": "MDEyOklzc3VlQ29tbWVudDcwNzk2MDQ0OA==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-10-13T19:30:08Z",
    "updated_at": "2020-10-13T19:30:08Z",
    "author_association": "MEMBER",
    "body": "I'll get back to this after the 0.21 branching.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/707960448/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425275498",
    "pull_request_review_id": 411984475,
    "id": 425275498,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNTI3NTQ5OA==",
    "diff_hunk": "@@ -16,13 +16,59 @@\n #include <unordered_map>\n #include <unordered_set>\n \n-\n namespace memusage\n {\n \n /** Compute the total memory used by allocating alloc bytes. */\n static size_t MallocUsage(size_t alloc);\n \n+/** Wrapping allocator that accounts accurately.\n+ *\n+ * To use accounting, the AccountAllocator(size_t&) constructor must be used.\n+ * Any containers using such an allocator, and containers copied/moved from such\n+ * containers will then increment/decrement size_t when allocating/deallocating\n+ * memory.\n+ */\n+template<typename T>\n+class AccountingAllocator : public std::allocator<T>\n+{\n+    size_t* m_allocated; //!< Pointer to accounting variable, cannot be nullptr",
    "path": "src/memusage.h",
    "position": null,
    "original_position": 21,
    "commit_id": "6ad6e54541c81537bb7ac5c962710cb087259893",
    "original_commit_id": "77637b8d1e11d7adbda88337f4fdc711241f857e",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Shouldn't be documented here that the accounting variable must be atomic or protected by mutex?",
    "created_at": "2020-05-14T16:34:15Z",
    "updated_at": "2020-07-21T05:18:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#discussion_r425275498",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18086",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425275498"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18086#discussion_r425275498"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18086"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/425275498/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 35,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/451872142",
    "pull_request_review_id": 445185938,
    "id": 451872142,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MTg3MjE0Mg==",
    "diff_hunk": "@@ -16,13 +16,59 @@\n #include <unordered_map>\n #include <unordered_set>\n \n-\n namespace memusage\n {\n \n /** Compute the total memory used by allocating alloc bytes. */\n static size_t MallocUsage(size_t alloc);\n \n+/** Wrapping allocator that accounts accurately.\n+ *\n+ * To use accounting, the AccountAllocator(size_t&) constructor must be used.\n+ * Any containers using such an allocator, and containers copied/moved from such\n+ * containers will then increment/decrement size_t when allocating/deallocating\n+ * memory.\n+ */\n+template<typename T>\n+class AccountingAllocator : public std::allocator<T>\n+{\n+    size_t* m_allocated; //!< Pointer to accounting variable, cannot be nullptr",
    "path": "src/memusage.h",
    "position": null,
    "original_position": 21,
    "commit_id": "6ad6e54541c81537bb7ac5c962710cb087259893",
    "original_commit_id": "77637b8d1e11d7adbda88337f4fdc711241f857e",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I've added a bunch of comments.",
    "created_at": "2020-07-08T23:04:30Z",
    "updated_at": "2020-07-21T05:18:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#discussion_r451872142",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18086",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/451872142"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18086#discussion_r451872142"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18086"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/451872142/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 35,
    "side": "RIGHT",
    "in_reply_to_id": 425275498
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452058748",
    "pull_request_review_id": 445408045,
    "id": 452058748,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjA1ODc0OA==",
    "diff_hunk": "@@ -25,6 +25,64 @@ namespace memusage\n /** Compute the total memory used by allocating alloc bytes. */\n static size_t MallocUsage(size_t alloc);\n \n+/** Wrapping allocator that accounts accurately.\n+ *\n+ * To use accounting, the AccountAllocator(size_t&) constructor must be used.\n+ * Any containers using such an allocator, and containers moved constructed or\n+ * assigned from such containers will then increment/decrement size_t when\n+ * allocating/deallocating memory.\n+ */\n+template<typename T>\n+class AccountingAllocator : public std::allocator<T>\n+{\n+    //! Pointer to accounting variable, if any.\n+    size_t* m_allocated;\n+\n+    template<typename U> friend class AccountingAllocator;\n+    typedef std::allocator<T> base;\n+\n+public:\n+    //! Default constructor constructs a non-accounting allocator.\n+    AccountingAllocator() noexcept : m_allocated(nullptr) {}\n+\n+    /** Construct an allocator that increments/decrements 'allocated' on allocate/free.\n+     *\n+     * In a multithreaded environment, the variable needs to be protected by the same",
    "path": "src/memusage.h",
    "position": 38,
    "original_position": 26,
    "commit_id": "6ad6e54541c81537bb7ac5c962710cb087259893",
    "original_commit_id": "65fc229fabbc7889baca9c50ee35507543a6682e",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "65fc229fabbc7889baca9c50ee35507543a6682e\r\n```suggestion\r\n     * In a multithreaded environment, the accounting variable needs to be protected by the same\r\n```",
    "created_at": "2020-07-09T08:41:32Z",
    "updated_at": "2020-07-21T05:18:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#discussion_r452058748",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18086",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452058748"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18086#discussion_r452058748"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18086"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452058748/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 62,
    "original_line": 62,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452060890",
    "pull_request_review_id": 445410823,
    "id": 452060890,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjA2MDg5MA==",
    "diff_hunk": "@@ -25,6 +25,64 @@ namespace memusage\n /** Compute the total memory used by allocating alloc bytes. */\n static size_t MallocUsage(size_t alloc);\n \n+/** Wrapping allocator that accounts accurately.\n+ *\n+ * To use accounting, the AccountAllocator(size_t&) constructor must be used.\n+ * Any containers using such an allocator, and containers moved constructed or\n+ * assigned from such containers will then increment/decrement size_t when",
    "path": "src/memusage.h",
    "position": 8,
    "original_position": 8,
    "commit_id": "6ad6e54541c81537bb7ac5c962710cb087259893",
    "original_commit_id": "65fc229fabbc7889baca9c50ee35507543a6682e",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "65fc229fabbc7889baca9c50ee35507543a6682e\r\nnit:\r\n```suggestion\r\n * Any containers using such an allocator, and containers move constructed or\r\n * move assigned from such containers will then increment/decrement size_t when\r\n```",
    "created_at": "2020-07-09T08:45:08Z",
    "updated_at": "2020-07-21T05:18:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#discussion_r452060890",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18086",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452060890"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18086#discussion_r452060890"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18086"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452060890/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 31,
    "original_start_line": 31,
    "start_side": "RIGHT",
    "line": 32,
    "original_line": 32,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452189214",
    "pull_request_review_id": 445578629,
    "id": 452189214,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE4OTIxNA==",
    "diff_hunk": "@@ -233,4 +235,41 @@ BOOST_AUTO_TEST_CASE(lockedpool_tests_live)\n     BOOST_CHECK(pool.stats().used == initial.used);\n }\n \n+BOOST_AUTO_TEST_CASE(accounting_allocation_test)\n+{\n+    size_t total = 0;\n+    size_t dummy = 0;\n+\n+    {\n+        typedef std::unordered_set<int, std::hash<int>, std::equal_to<int>, memusage::AccountingAllocator<int>> container_type;\n+        container_type container1({}, 2, std::hash<int>(), std::equal_to<int>(), memusage::AccountingAllocator<int>(dummy)); // container1 is accounted for in 'dummy'\n+        container1.insert(6);\n+        {\n+            container_type container2(1, std::hash<int>(), std::equal_to<int>(), memusage::AccountingAllocator<int>(total)); // container2 is accounted for in 'total'\n+            container2.insert(5);\n+            container2.insert(2);\n+            container2.insert(3);\n+            container2.erase(2);\n+            BOOST_CHECK(total > 0);\n+            size_t old = total;\n+            container1 = std::move(container2); // container1 is now accounted for in 'total'\n+            BOOST_CHECK(total >= old);",
    "path": "src/test/allocator_tests.cpp",
    "position": 31,
    "original_position": 31,
    "commit_id": "6ad6e54541c81537bb7ac5c962710cb087259893",
    "original_commit_id": "65fc229fabbc7889baca9c50ee35507543a6682e",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "65fc229fabbc7889baca9c50ee35507543a6682e\r\n```suggestion\r\n            BOOST_CHECK(total == old);\r\n```",
    "created_at": "2020-07-09T12:44:14Z",
    "updated_at": "2020-07-21T05:18:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#discussion_r452189214",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18086",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452189214"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18086#discussion_r452189214"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18086"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452189214/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 256,
    "original_line": 256,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452190692",
    "pull_request_review_id": 445578629,
    "id": 452190692,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjE5MDY5Mg==",
    "diff_hunk": "@@ -233,4 +235,41 @@ BOOST_AUTO_TEST_CASE(lockedpool_tests_live)\n     BOOST_CHECK(pool.stats().used == initial.used);\n }\n \n+BOOST_AUTO_TEST_CASE(accounting_allocation_test)\n+{\n+    size_t total = 0;\n+    size_t dummy = 0;\n+\n+    {\n+        typedef std::unordered_set<int, std::hash<int>, std::equal_to<int>, memusage::AccountingAllocator<int>> container_type;\n+        container_type container1({}, 2, std::hash<int>(), std::equal_to<int>(), memusage::AccountingAllocator<int>(dummy)); // container1 is accounted for in 'dummy'\n+        container1.insert(6);\n+        {\n+            container_type container2(1, std::hash<int>(), std::equal_to<int>(), memusage::AccountingAllocator<int>(total)); // container2 is accounted for in 'total'",
    "path": "src/test/allocator_tests.cpp",
    "position": 23,
    "original_position": 23,
    "commit_id": "6ad6e54541c81537bb7ac5c962710cb087259893",
    "original_commit_id": "65fc229fabbc7889baca9c50ee35507543a6682e",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "65fc229fabbc7889baca9c50ee35507543a6682e\r\n~nit - dedicated constructors could be used:~",
    "created_at": "2020-07-09T12:46:51Z",
    "updated_at": "2020-07-21T05:18:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#discussion_r452190692",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18086",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452190692"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18086#discussion_r452190692"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18086"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452190692/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 245,
    "original_start_line": 245,
    "start_side": "RIGHT",
    "line": 248,
    "original_line": 248,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452654297",
    "pull_request_review_id": 446159613,
    "id": 452654297,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ1MjY1NDI5Nw==",
    "diff_hunk": "@@ -25,6 +25,64 @@ namespace memusage\n /** Compute the total memory used by allocating alloc bytes. */\n static size_t MallocUsage(size_t alloc);\n \n+/** Wrapping allocator that accounts accurately.\n+ *\n+ * To use accounting, the AccountAllocator(size_t&) constructor must be used.\n+ * Any containers using such an allocator, and containers moved constructed or\n+ * assigned from such containers will then increment/decrement size_t when\n+ * allocating/deallocating memory.\n+ */\n+template<typename T>\n+class AccountingAllocator : public std::allocator<T>\n+{\n+    //! Pointer to accounting variable, if any.\n+    size_t* m_allocated;\n+\n+    template<typename U> friend class AccountingAllocator;\n+    typedef std::allocator<T> base;\n+\n+public:\n+    //! Default constructor constructs a non-accounting allocator.\n+    AccountingAllocator() noexcept : m_allocated(nullptr) {}\n+\n+    /** Construct an allocator that increments/decrements 'allocated' on allocate/free.\n+     *\n+     * In a multithreaded environment, the variable needs to be protected by the same\n+     * lock as the container(s) that use this allocator. */\n+    explicit AccountingAllocator(size_t& allocated) noexcept : m_allocated(&allocated) {}\n+\n+    //! A copy-constructed container will be non-accounting.\n+    static AccountingAllocator select_on_container_copy_construction() { return AccountingAllocator(); }",
    "path": "src/memusage.h",
    "position": 43,
    "original_position": 31,
    "commit_id": "6ad6e54541c81537bb7ac5c962710cb087259893",
    "original_commit_id": "fc0ba65125ccc0fe8bf7e897c6f928ae5ae565e7",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "fc0ba65125ccc0fe8bf7e897c6f928ae5ae565e7\r\nFrom the [docs](https://en.cppreference.com/w/cpp/named_req/Allocator) it follows that:\r\n```suggestion\r\n    AccountingAllocator select_on_container_copy_construction() const { return AccountingAllocator(); }\r\n```",
    "created_at": "2020-07-10T06:50:24Z",
    "updated_at": "2020-07-21T05:18:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18086#discussion_r452654297",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18086",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452654297"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18086#discussion_r452654297"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18086"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/452654297/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 67,
    "original_line": 67,
    "side": "RIGHT"
  }
]