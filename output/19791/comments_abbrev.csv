theStack,2020-08-24 17:41:44,"The PR title only addresses one of the many commits (the last one), I assume you either wanted to only include this commit or change the title to be more general to also include all other changes.",https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-679269747,679269747,
jnewbery,2020-08-24 17:48:46,"> The PR title only addresses one of the many commits (the last one), I assume you either wanted to only include this commit or change the title to be more general to also include all other changes.\n\nThe object of this PR is to move Misbehaving to PeerLogicValidation. The other commits are necessary to do that because they all eventually call in to Misbehaving: https://doxygen.bitcoincore.org/",https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-679273193,679273193,
theStack,2020-08-24 17:55:10,"> > The PR title only addresses one of the many commits (the last one), I assume you either wanted to only include this commit or change the title to be more general to also include all other changes.\n> \n> The object of this PR is to move Misbehaving to PeerLogicValidation. The other commits are necessary to do that because they all eventually call in to Misbehaving: https://doxygen.bitcoincor",https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-679276170,679276170,
DrahtBot,2020-08-24 21:27:21,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19872 (Avoid locking CTxMemPool::cs recursively in some cases by hebasto)\n* #19858 (Periodically make block-relay connec",https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-679375573,679375573,
MarcoFalke,2020-08-25 07:39:56,Concept ACK,https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-679860040,679860040,
MarcoFalke,2020-08-26 05:33:39,( Note to myself: commit eb170099f3ea91555b56fdaaae89a64fe04b93be with this diff https://github.com/bitcoin/bitcoin/pull/19704#discussion_r474475437 should pass the unit tests again ),https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-680665762,680665762,
jnewbery,2020-08-28 17:12:04,"> ( Note to myself: commit eb17009 with this diff #19704 (comment) should pass the unit tests again )\n\nThanks @MarcoFalke . I've cherrypicked that commit into this branch, which reduced further the number of parameters in some of these moved functions.",https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-682942492,682942492,
jnewbery,2020-08-28 19:26:05,Rebased,https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-683101426,683101426,
practicalswift,2020-08-29 01:04:59,Concept ACK,https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-683209077,683209077,
MarcoFalke,2020-08-29 07:07:24,"Almost ACK. Please use a scripted diff where appropriate:\n\n```\n 7:  534b4a2d86 !  7:  fffffffffff [net processing] Rename PeerLogicValidation to PeerManager\n    @@ Metadata\n     Author: John Newbery <john@johnnewbery.com>\n     \n      ## Commit message ##\n    -    [net processing] Rename PeerLogicValidation to PeerManager\n    +    scripted-diff: [net processing] Rename PeerLogicVa",https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-683248553,683248553,
jnewbery,2020-08-29 09:34:57,Thanks for the review @MarcoFalke ! I've taken your suggestion of making the rename a scripted diff (and added a follow-up commit that fixes the indentation).,https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-683265179,683265179,
MarcoFalke,2020-08-29 10:16:48,"re-ACK ab9e416812 ðŸ”‹\n\n<details><summary>Show signature and timestamp</summary>\n\nSignature:\n\n```\n-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA512\n\nre-ACK ab9e416812 ðŸ”‹\n-----BEGIN PGP SIGNATURE-----\n\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUgOmAv/XiLCgaJ+N1uXLqQGle28I8T65NwC7lN8op1+AcF0HdvG4P/nr9XAKJGO\nHGutxFBbwYhY0gdFiShEKPI/LdTIPF+HEARqQ3bt4HCM1",https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-683269755,683269755,
hebasto,2020-09-04 17:07:52,Concept ACK.,https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-687274062,687274062,
jnewbery,2020-09-05 09:33:37,"Please see https://github.com/bitcoin/bitcoin/pull/19607#discussion_r462032894 for motivation. The idea is to move the `g_peer_map` to be a member of `PeerLogicValidation`. To do that, we need to move these functions into `PeerLogicValidation` since they need to access that data.",https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-687579315,687579315,
hebasto,2020-09-05 14:16:17,"> In commit [30dbd28](https://github.com/bitcoin/bitcoin/commit/30dbd283cc3c4bcc55cefe5925581dbf9da78c2d) ""scripted-diff: [net processing] Rename PeerLogicValidation to PeerManager"" the commit message is incomplete.\n\nI meant that before the latest push the commit message was\n```\nscripted-diff: [net processing] Rename PeerLogicValidation to PeerManager\n\n-BEGIN VERIFY SCRIPT-\nsed -i 's",https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-687617280,687617280,
hebasto,2020-09-05 14:21:52,"> The idea is to move the `g_peer_map` to be a member of `PeerLogicValidation`. To do that, we need to move these functions into `PeerLogicValidation` since they need to access that data.\n\nBut `MaybePunishNodeForBlock()`, `MaybePunishNodeForTx()` and `Misbehaving()` do not access to `g_peer_map`, no?\n\n",https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-687618033,687618033,
MarcoFalke,2020-09-05 14:31:54,"> But MaybePunishNodeForBlock(), MaybePunishNodeForTx() and Misbehaving() do not access to g_peer_map, no?\n\nMisbehaving calls `GetPeerRef`",https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-687619282,687619282,
hebasto,2020-09-05 14:39:35,"> > But MaybePunishNodeForBlock(), MaybePunishNodeForTx() and Misbehaving() do not access to g_peer_map, no?\n> \n> Misbehaving calls `GetPeerRef`\n\nCorrect. But it seems that `MaybePunishNodeForBlock()` and `MaybePunishNodeForTx()` have neither direct nor indirect access to `g_peer_map`.",https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-687620132,687620132,
MarcoFalke,2020-09-05 14:41:44,"They call `Misbehaving`, which calls `GetPeerRef`, which accesses `g_peer_map`",https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-687620367,687620367,
hebasto,2020-09-05 14:58:10,"> They call `Misbehaving`, which calls `GetPeerRef`, which accesses `g_peer_map`\n\nIndeed. Sorry for noise.",https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-687622313,687622313,
jnewbery,2020-09-05 19:05:47,"> I didn't mean to drop the scripted-diff part. Sorry.\n\nOops. I didn't mean to do that. Restored the scripted-diff and fixed the commit log.\n\n> > They call Misbehaving, which calls GetPeerRef, which accesses g_peer_map\n\n> Indeed. Sorry for noise.\n\nNo problem. Thanks for reviewing!",https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-687649549,687649549,
MarcoFalke,2020-09-06 07:24:17,"re-ACK 7ed1612715 only change is in commit message ðŸ’®\n\n<details><summary>Show signature and timestamp</summary>\n\nSignature:\n\n```\n-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA512\n\nre-ACK 7ed1612715 only change is in commit message ðŸ’®\n-----BEGIN PGP SIGNATURE-----\n\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUjjSAv/eL83MPVWHHsG87sMVTjfZH87F5ioMxNs/Rj/Zw",https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-687715474,687715474,
jnewbery,2020-09-07 10:22:10,"rebased on master.\n\nAlso updated `NodeContext.peer_logic` to `NodeContext.peerman` to be consistent with the new class name.",https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-688228976,688228976,
MarcoFalke,2020-09-07 15:23:14,"re-ACK bb6a32ce99 only change is rebase due to conflict in struct NodeContext and variable rename ðŸ¤¸\n\n<details><summary>Show signature and timestamp</summary>\n\nSignature:\n\n```\n-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA512\n\nre-ACK bb6a32ce99 only change is rebase due to conflict in struct NodeContext and variable rename ðŸ¤¸\n-----BEGIN PGP SIGNATURE-----\n\niQGzBAEBCgAdFiEE+rV",https://github.com/bitcoin/bitcoin/pull/19791#issuecomment-688391036,688391036,
hebasto,2020-09-05 06:37:08,"4ca3570c4a6a1332dbfc1f97eda6b717b21df468, nit:\n```suggestion\n    void ProcessOrphanTx(std::set<uint256>& orphan_work_set, std::list<CTransactionRef>& removed_txn)\n        EXCLUSIVE_LOCKS_REQUIRED(::cs_main, g_cs_orphans);\n```",https://github.com/bitcoin/bitcoin/pull/19791#discussion_r483918512,483918512,src/net_processing.h
jnewbery,2020-09-05 10:05:57,Done!,https://github.com/bitcoin/bitcoin/pull/19791#discussion_r483935319,483935319,src/net_processing.h
