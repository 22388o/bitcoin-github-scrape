rebroad,2014-07-17T10:47:05Z,Nice catch\n,https://github.com/bitcoin/bitcoin/pull/4547#issuecomment-49291348,49291348,
BitcoinPullTester,2014-07-20T07:56:15Z,"Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/p4547_dcd7ef782bd8105c3427f932206e33fa07ddeded/ for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-te",https://github.com/bitcoin/bitcoin/pull/4547#issuecomment-49539880,49539880,
kazcw,2014-07-26T17:57:21Z,"This partially mitigates #1157, by at least limiting the time each transaction can be delayed to 2 minutes per peer.\n",https://github.com/bitcoin/bitcoin/pull/4547#issuecomment-50243433,50243433,
sipa,2014-07-27T14:46:15Z,Untested ACK.\n,https://github.com/bitcoin/bitcoin/pull/4547#issuecomment-50266195,50266195,
jgarzik,2014-07-29T16:47:46Z,ut ACK\n,https://github.com/bitcoin/bitcoin/pull/4547#issuecomment-50503923,50503923,
TheBlueMatt,2014-09-02T06:18:27Z,"Indeed it likely should be an mruset, however it should grow with mapAskFor, which should be a lrumultimap...so maybe that can be a separate pull.\n",https://github.com/bitcoin/bitcoin/pull/4547#issuecomment-54113349,54113349,
TheBlueMatt,2014-09-02T06:20:06Z,ut ACK.\n,https://github.com/bitcoin/bitcoin/pull/4547#issuecomment-54113430,54113430,
laanwj,2014-09-02T08:02:48Z,"> Indeed it likely should be an mruset, however it should grow with mapAskFor, which should be a lrumultimap...so maybe that can be a separate pull.\n\n~~Does it need to be a multimap at all? We already make sure that the key (time) is monotonically increasing in AskFor.~~ (edit: yes, it does, nNow is monotonically increasing but nRequestTime doesn't need to be)\n\nACK after limiting the size of t",https://github.com/bitcoin/bitcoin/pull/4547#issuecomment-54120364,54120364,
laanwj,2014-09-02T08:10:53Z,"I'm not sure how much this will really help though. It avoids 'inv with duplicates' from one node but It's easy to pretend to be multiple nodes by reconnecting, or having multiple connections open even from the same host. I think we need a global limit as well, something like\n\n```\n    // Don't plan too far into the future\n    if (nRequestTime > nNow + 10 * 60 * 1000000)\n        return;\n```\n",https://github.com/bitcoin/bitcoin/pull/4547#issuecomment-54120950,54120950,
rebroad,2014-09-03T02:39:40Z,"@laanwj I agree, but also, perhaps the 2 minutes is a little high? If we change this to 1 minute this might also help.\n\nOr better still, why not make the node determine the ideal number instead of hardcoding it?\n",https://github.com/bitcoin/bitcoin/pull/4547#issuecomment-54245379,54245379,
laanwj,2014-09-04T10:09:21Z,"See also #4831.\n\nNot sure if the 2 minutes is too much, if you have a way to better determine the timeout that is welcome, but there is not really a hurry to have a transaction quickly. The smaller the timeout, the larger the chance that the first node isn't really defunct but just having lag, and that we'll receive it from two peers.\n",https://github.com/bitcoin/bitcoin/pull/4547#issuecomment-54445748,54445748,
rebroad,2014-09-04T10:37:29Z,"@laanwj How about keeping track of the average delay that each node takes when serving txs, and then when a tx comes in, as well as requesting it immediately from the first node to advertise it, it also deduces how long it will take to arrive from that node. After 10 seconds, it assesses which nodes also can provide it, and if any can provide it significantly sooner than the first node that advert",https://github.com/bitcoin/bitcoin/pull/4547#issuecomment-54449934,54449934,
laanwj,2014-09-04T11:13:55Z,"@rebroad Possible, but I don't want to make this overly complex. Mind that retries are _extremely_ rare at 2 minutes. I've only had a few in a day on a normal node. By far most nodes simply send the tx when requested, even if sometimes they take their time.\n\nI've also tried with a timeout of 30 seconds for a while, and retries were much more numerous. In general, the first node would still send ",https://github.com/bitcoin/bitcoin/pull/4547#issuecomment-54454801,54454801,
rebroad,2014-09-04T15:27:50Z,"@laanwj No, I meant 10 seconds before assessing which would be the best node to request it from, not to perform the actual request (unless the currently requested node is known to take on average longer than the time it would take to request it from a different node).\n",https://github.com/bitcoin/bitcoin/pull/4547#issuecomment-54494663,54494663,
jgarzik,2014-09-04T16:59:43Z,"Meta:  The following note was actually intended for another @rebroad PR, to which @gmaxwell replied, where there was another ""10 sec vs. 2 min"" debate.  I forgot the PR number.\n\n_Speaking generally_, this debate sometimes seems to illustrate linear thinking with regards to peer interactions.  In particular, I think two techniques are useful in byzantine networks:\n1. Get impatient.  When a local",https://github.com/bitcoin/bitcoin/pull/4547#issuecomment-54509956,54509956,
rebroad,2014-09-05T02:18:38Z,"@jgarzik By waiting only 10 seconds, in my experience, you'll have received an inv from >50% of currently connected nodes. This is surely more than enough time to select the fastest peer to send the getdata request to; and certainly an improvement on the current implentation (i.e. added benefit with no disadvantages). \n\nI.e. the ""10 seconds"" refers to the ""short while"" you mention. It's not the ",https://github.com/bitcoin/bitcoin/pull/4547#issuecomment-54574200,54574200,
jgarzik,2014-09-05T03:49:50Z,When reasoning about this problem you cannot rely solely on today's current average behavior.\n,https://github.com/bitcoin/bitcoin/pull/4547#issuecomment-54582088,54582088,
rebroad,2014-09-05T04:15:10Z,"@jgarzik Yes, I agree that the 10 seconds would ideally not be hardcoded either. But it is a better hardcoding than the current hardcoding, but as a continuous improvement, this hardcoding would also be removed. What would you recommend replacing the hardcoded 10 second wait with?\n",https://github.com/bitcoin/bitcoin/pull/4547#issuecomment-54583231,54583231,
laanwj,2014-09-18T10:11:06Z,Closing in favor of #4831.\n,https://github.com/bitcoin/bitcoin/pull/4547#issuecomment-56019582,56019582,
