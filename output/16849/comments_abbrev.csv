sdaftuar,2019-09-10 18:30:21,See https://github.com/bitcoin/bitcoin/issues/16444#issuecomment-514801708 for additional background.,https://github.com/bitcoin/bitcoin/pull/16849#issuecomment-530063558,530063558,
sdaftuar,2019-09-10 18:56:51,"The only remaining case I've thought of that is unaddressed is if a new block were to arrive while InvalidateBlock() is running that (a) builds off a chain tip that is not being invalidated and (b) has less work than the current tip at the time the block is received, then we might still end up in a state that is temporarily inconsistent.  I left in the old code that cleans up before returning as a",https://github.com/bitcoin/bitcoin/pull/16849#issuecomment-530073757,530073757,
TheBlueMatt,2019-09-11 21:16:00,"utACK 2a4e60b48261d3f0ec3d85f97af998ef989134e0. I also discovered another issue in InvalidateBlock while reviewing, see #16856.",https://github.com/bitcoin/bitcoin/pull/16849#issuecomment-530569201,530569201,
Sjors,2019-09-30 13:19:03,"ACK 2a4e60b. Tested on top of #16899. Also tested `invalidateblock` with `-checkblockindex=1`.\n\nThe changed code is only called by the `invalidateblock` RPC.\n\nNit: maybe mention `InvalidateBlock()` as well in validation.h comment for `CCriticalSection m_cs_chainstate`.",https://github.com/bitcoin/bitcoin/pull/16849#issuecomment-536556779,536556779,
fjahr,2019-10-01 17:06:45,"ACK 2a4e60b. Ran tests, reviewed code, inspected behavior while manually testing `invalidateblock`.",https://github.com/bitcoin/bitcoin/pull/16849#issuecomment-537132729,537132729,
jamesob,2019-09-10 18:41:50,Won't this potentially omit `candidate`s with equal work as `pindex->pprev` (depending on nSequenceId/pointer address)? ,https://github.com/bitcoin/bitcoin/pull/16849#discussion_r322902722,322902722,src/validation.cpp
sdaftuar,2019-09-10 19:00:15,I believe this exactly matches the test in `CheckBlockIndex()`: https://github.com/bitcoin/bitcoin/blob/1985c4efda56b48f6f9c04f39d69268ee8f0b40a/src/validation.cpp#L4604,https://github.com/bitcoin/bitcoin/pull/16849#discussion_r322910475,322910475,src/validation.cpp
