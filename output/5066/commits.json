[
  {
    "sha": "99a814342bd13757e6bba92cfff134eddb5d29cc",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo5OWE4MTQzNDJiZDEzNzU3ZTZiYmE5MmNmZmYxMzRlZGRiNWQyOWNj",
    "commit": {
      "author": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2014-10-09T09:04:49Z"
      },
      "committer": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2014-10-09T11:59:30Z"
      },
      "message": "qt: add network-specific style object\n\nMainly cleanups: Gets rid of isTestNet everywhere, by keeping track\nof network-specific theming in a central place.\n\nAlso makes GUI no longer dependent on the network ID enumeration, which\nalleviates concerns about #4802.",
      "tree": {
        "sha": "b566c93fd88500869c097d31b85c49ac2c0f4bdb",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b566c93fd88500869c097d31b85c49ac2c0f4bdb"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/99a814342bd13757e6bba92cfff134eddb5d29cc",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/99a814342bd13757e6bba92cfff134eddb5d29cc",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/99a814342bd13757e6bba92cfff134eddb5d29cc",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/99a814342bd13757e6bba92cfff134eddb5d29cc/comments",
    "author": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "dec58922d07241f0b502c96f8e5131abccbd5dc1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dec58922d07241f0b502c96f8e5131abccbd5dc1",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/dec58922d07241f0b502c96f8e5131abccbd5dc1"
      }
    ],
    "stats": {
      "total": 202,
      "additions": 127,
      "deletions": 75
    },
    "files": [
      {
        "sha": "872a0cf1c5358c9ac8d9d7cc4c4195be3c8b6eae",
        "filename": "src/Makefile.qt.include",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/99a814342bd13757e6bba92cfff134eddb5d29cc/src/Makefile.qt.include",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/99a814342bd13757e6bba92cfff134eddb5d29cc/src/Makefile.qt.include",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.qt.include?ref=99a814342bd13757e6bba92cfff134eddb5d29cc",
        "patch": "@@ -178,6 +178,7 @@ BITCOIN_QT_H = \\\n   qt/macdockiconhandler.h \\\n   qt/macnotificationhandler.h \\\n   qt/monitoreddatamapper.h \\\n+  qt/networkstyle.h \\\n   qt/notificator.h \\\n   qt/openuridialog.h \\\n   qt/optionsdialog.h \\\n@@ -269,6 +270,7 @@ BITCOIN_QT_CPP = \\\n   qt/guiutil.cpp \\\n   qt/intro.cpp \\\n   qt/monitoreddatamapper.cpp \\\n+  qt/networkstyle.cpp \\\n   qt/notificator.cpp \\\n   qt/optionsdialog.cpp \\\n   qt/optionsmodel.cpp \\"
      },
      {
        "sha": "c39cb7506f1d366c2b90bf0d8d2e7a819e670862",
        "filename": "src/qt/bitcoin.cpp",
        "status": "modified",
        "additions": 14,
        "deletions": 13,
        "changes": 27,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/99a814342bd13757e6bba92cfff134eddb5d29cc/src/qt/bitcoin.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/99a814342bd13757e6bba92cfff134eddb5d29cc/src/qt/bitcoin.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoin.cpp?ref=99a814342bd13757e6bba92cfff134eddb5d29cc",
        "patch": "@@ -12,6 +12,7 @@\n #include \"guiconstants.h\"\n #include \"guiutil.h\"\n #include \"intro.h\"\n+#include \"networkstyle.h\"\n #include \"optionsmodel.h\"\n #include \"splashscreen.h\"\n #include \"utilitydialog.h\"\n@@ -190,9 +191,9 @@ class BitcoinApplication: public QApplication\n     /// Create options model\n     void createOptionsModel();\n     /// Create main window\n-    void createWindow(bool isaTestNet);\n+    void createWindow(const NetworkStyle *networkStyle);\n     /// Create splash screen\n-    void createSplashScreen(bool isaTestNet);\n+    void createSplashScreen(const NetworkStyle *networkStyle);\n \n     /// Request core initialization\n     void requestInitialize();\n@@ -331,18 +332,18 @@ void BitcoinApplication::createOptionsModel()\n     optionsModel = new OptionsModel();\n }\n \n-void BitcoinApplication::createWindow(bool isaTestNet)\n+void BitcoinApplication::createWindow(const NetworkStyle *networkStyle)\n {\n-    window = new BitcoinGUI(isaTestNet, 0);\n+    window = new BitcoinGUI(networkStyle, 0);\n \n     pollShutdownTimer = new QTimer(window);\n     connect(pollShutdownTimer, SIGNAL(timeout()), window, SLOT(detectShutdown()));\n     pollShutdownTimer->start(200);\n }\n \n-void BitcoinApplication::createSplashScreen(bool isaTestNet)\n+void BitcoinApplication::createSplashScreen(const NetworkStyle *networkStyle)\n {\n-    SplashScreen *splash = new SplashScreen(0, isaTestNet);\n+    SplashScreen *splash = new SplashScreen(0, networkStyle);\n     // We don't hold a direct pointer to the splash screen after creation, so use\n     // Qt::WA_DeleteOnClose to make sure that the window will be deleted eventually.\n     splash->setAttribute(Qt::WA_DeleteOnClose);\n@@ -572,12 +573,10 @@ int main(int argc, char *argv[])\n     if (!PaymentServer::ipcParseCommandLine(argc, argv))\n         exit(0);\n #endif\n-    bool isaTestNet = Params().NetworkID() != CBaseChainParams::MAIN;\n+    const NetworkStyle *networkStyle = NetworkStyle::instantiate(QString::fromStdString(Params().NetworkIDString()));\n+    assert(networkStyle);\n     // Allow for separate UI settings for testnets\n-    if (isaTestNet)\n-        QApplication::setApplicationName(QAPP_APP_NAME_TESTNET);\n-    else\n-        QApplication::setApplicationName(QAPP_APP_NAME_DEFAULT);\n+    QApplication::setApplicationName(networkStyle->getAppName());\n     // Re-initialize translations after changing application name (language in network-specific settings can be different)\n     initTranslations(qtTranslatorBase, qtTranslator, translatorBase, translator);\n \n@@ -617,11 +616,11 @@ int main(int argc, char *argv[])\n     uiInterface.InitMessage.connect(InitMessage);\n \n     if (GetBoolArg(\"-splash\", true) && !GetBoolArg(\"-min\", false))\n-        app.createSplashScreen(isaTestNet);\n+        app.createSplashScreen(networkStyle);\n \n     try\n     {\n-        app.createWindow(isaTestNet);\n+        app.createWindow(networkStyle);\n         app.requestInitialize();\n #if defined(Q_OS_WIN) && QT_VERSION >= 0x050000\n         WinShutdownMonitor::registerShutdownBlockReason(QObject::tr(\"Bitcoin Core didn't yet exit safely...\"), (HWND)app.getMainWinId());\n@@ -636,6 +635,8 @@ int main(int argc, char *argv[])\n         PrintExceptionContinue(NULL, \"Runaway exception\");\n         app.handleRunawayException(QString::fromStdString(strMiscWarning));\n     }\n+    delete networkStyle;\n+    networkStyle = 0;\n     return app.getReturnValue();\n }\n #endif // BITCOIN_QT_TEST"
      },
      {
        "sha": "8a945606dcd000af14f1e91ba7c506bbb52c99d3",
        "filename": "src/qt/bitcoingui.cpp",
        "status": "modified",
        "additions": 15,
        "deletions": 42,
        "changes": 57,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/99a814342bd13757e6bba92cfff134eddb5d29cc/src/qt/bitcoingui.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/99a814342bd13757e6bba92cfff134eddb5d29cc/src/qt/bitcoingui.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoingui.cpp?ref=99a814342bd13757e6bba92cfff134eddb5d29cc",
        "patch": "@@ -8,6 +8,7 @@\n #include \"clientmodel.h\"\n #include \"guiconstants.h\"\n #include \"guiutil.h\"\n+#include \"networkstyle.h\"\n #include \"notificator.h\"\n #include \"openuridialog.h\"\n #include \"optionsdialog.h\"\n@@ -59,7 +60,7 @@\n \n const QString BitcoinGUI::DEFAULT_WALLET = \"~Default\";\n \n-BitcoinGUI::BitcoinGUI(bool fIsTestnet, QWidget *parent) :\n+BitcoinGUI::BitcoinGUI(const NetworkStyle *networkStyle, QWidget *parent) :\n     QMainWindow(parent),\n     clientModel(0),\n     walletFrame(0),\n@@ -112,26 +113,13 @@ BitcoinGUI::BitcoinGUI(bool fIsTestnet, QWidget *parent) :\n     } else {\n         windowTitle += tr(\"Node\");\n     }\n-\n-    if (!fIsTestnet)\n-    {\n+    windowTitle += \" \" + networkStyle->getTitleAddText();\n #ifndef Q_OS_MAC\n-        QApplication::setWindowIcon(QIcon(\":icons/bitcoin\"));\n-        setWindowIcon(QIcon(\":icons/bitcoin\"));\n+    QApplication::setWindowIcon(networkStyle->getAppIcon());\n+    setWindowIcon(networkStyle->getAppIcon());\n #else\n-        MacDockIconHandler::instance()->setIcon(QIcon(\":icons/bitcoin\"));\n+    MacDockIconHandler::instance()->setIcon(networkStyle->getAppIcon());\n #endif\n-    }\n-    else\n-    {\n-        windowTitle += \" \" + tr(\"[testnet]\");\n-#ifndef Q_OS_MAC\n-        QApplication::setWindowIcon(QIcon(\":icons/bitcoin_testnet\"));\n-        setWindowIcon(QIcon(\":icons/bitcoin_testnet\"));\n-#else\n-        MacDockIconHandler::instance()->setIcon(QIcon(\":icons/bitcoin_testnet\"));\n-#endif\n-    }\n     setWindowTitle(windowTitle);\n \n #if defined(Q_OS_MAC) && QT_VERSION < 0x050000\n@@ -161,7 +149,7 @@ BitcoinGUI::BitcoinGUI(bool fIsTestnet, QWidget *parent) :\n \n     // Create actions for the toolbar, menu bar and tray/dock icon\n     // Needs walletFrame to be initialized\n-    createActions(fIsTestnet);\n+    createActions(networkStyle);\n \n     // Create application menu bar\n     createMenuBar();\n@@ -170,7 +158,7 @@ BitcoinGUI::BitcoinGUI(bool fIsTestnet, QWidget *parent) :\n     createToolBars();\n \n     // Create system tray icon and notification\n-    createTrayIcon(fIsTestnet);\n+    createTrayIcon(networkStyle);\n \n     // Create status bar\n     statusBar();\n@@ -248,7 +236,7 @@ BitcoinGUI::~BitcoinGUI()\n #endif\n }\n \n-void BitcoinGUI::createActions(bool fIsTestnet)\n+void BitcoinGUI::createActions(const NetworkStyle *networkStyle)\n {\n     QActionGroup *tabGroup = new QActionGroup(this);\n \n@@ -295,10 +283,7 @@ void BitcoinGUI::createActions(bool fIsTestnet)\n     quitAction->setStatusTip(tr(\"Quit application\"));\n     quitAction->setShortcut(QKeySequence(Qt::CTRL + Qt::Key_Q));\n     quitAction->setMenuRole(QAction::QuitRole);\n-    if (!fIsTestnet)\n-        aboutAction = new QAction(QIcon(\":/icons/bitcoin\"), tr(\"&About Bitcoin Core\"), this);\n-    else\n-        aboutAction = new QAction(QIcon(\":/icons/bitcoin_testnet\"), tr(\"&About Bitcoin Core\"), this);\n+    aboutAction = new QAction(networkStyle->getAppIcon(), tr(\"&About Bitcoin Core\"), this);\n     aboutAction->setStatusTip(tr(\"Show information about Bitcoin Core\"));\n     aboutAction->setMenuRole(QAction::AboutRole);\n #if QT_VERSION < 0x050000\n@@ -311,10 +296,7 @@ void BitcoinGUI::createActions(bool fIsTestnet)\n     optionsAction = new QAction(QIcon(\":/icons/options\"), tr(\"&Options...\"), this);\n     optionsAction->setStatusTip(tr(\"Modify configuration options for Bitcoin\"));\n     optionsAction->setMenuRole(QAction::PreferencesRole);\n-    if (!fIsTestnet)\n-        toggleHideAction = new QAction(QIcon(\":/icons/bitcoin\"), tr(\"&Show / Hide\"), this);\n-    else\n-        toggleHideAction = new QAction(QIcon(\":/icons/bitcoin_testnet\"), tr(\"&Show / Hide\"), this);\n+    toggleHideAction = new QAction(networkStyle->getAppIcon(), tr(\"&Show / Hide\"), this);\n     toggleHideAction->setStatusTip(tr(\"Show or hide the main Window\"));\n \n     encryptWalletAction = new QAction(QIcon(\":/icons/lock_closed\"), tr(\"&Encrypt Wallet...\"), this);\n@@ -505,22 +487,13 @@ void BitcoinGUI::setWalletActionsEnabled(bool enabled)\n     openAction->setEnabled(enabled);\n }\n \n-void BitcoinGUI::createTrayIcon(bool fIsTestnet)\n+void BitcoinGUI::createTrayIcon(const NetworkStyle *networkStyle)\n {\n #ifndef Q_OS_MAC\n     trayIcon = new QSystemTrayIcon(this);\n-\n-    if (!fIsTestnet)\n-    {\n-        trayIcon->setToolTip(tr(\"Bitcoin Core client\"));\n-        trayIcon->setIcon(QIcon(\":/icons/bitcoin\"));\n-    }\n-    else\n-    {\n-        trayIcon->setToolTip(tr(\"Bitcoin Core client\") + \" \" + tr(\"[testnet]\"));\n-        trayIcon->setIcon(QIcon(\":/icons/bitcoin_testnet\"));\n-    }\n-\n+    QString toolTip = tr(\"Bitcoin Core client\") + \" \" + networkStyle->getTitleAddText();\n+    trayIcon->setToolTip(toolTip);\n+    trayIcon->setIcon(networkStyle->getAppIcon());\n     trayIcon->show();\n #endif\n "
      },
      {
        "sha": "f65f0e91379d93f3c0ee0e88da101ab747ce198e",
        "filename": "src/qt/bitcoingui.h",
        "status": "modified",
        "additions": 4,
        "deletions": 3,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/99a814342bd13757e6bba92cfff134eddb5d29cc/src/qt/bitcoingui.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/99a814342bd13757e6bba92cfff134eddb5d29cc/src/qt/bitcoingui.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoingui.h?ref=99a814342bd13757e6bba92cfff134eddb5d29cc",
        "patch": "@@ -19,6 +19,7 @@\n #include <QSystemTrayIcon>\n \n class ClientModel;\n+class NetworkStyle;\n class Notificator;\n class OptionsModel;\n class RPCConsole;\n@@ -46,7 +47,7 @@ class BitcoinGUI : public QMainWindow\n public:\n     static const QString DEFAULT_WALLET;\n \n-    explicit BitcoinGUI(bool fIsTestnet = false, QWidget *parent = 0);\n+    explicit BitcoinGUI(const NetworkStyle *networkStyle, QWidget *parent = 0);\n     ~BitcoinGUI();\n \n     /** Set the client model.\n@@ -114,13 +115,13 @@ class BitcoinGUI : public QMainWindow\n     int spinnerFrame;\n \n     /** Create the main UI actions. */\n-    void createActions(bool fIsTestnet);\n+    void createActions(const NetworkStyle *networkStyle);\n     /** Create the menu bar and sub-menus. */\n     void createMenuBar();\n     /** Create the toolbars */\n     void createToolBars();\n     /** Create system tray icon and notification */\n-    void createTrayIcon(bool fIsTestnet);\n+    void createTrayIcon(const NetworkStyle *networkStyle);\n     /** Create system tray menu (or setup the dock menu) */\n     void createTrayIconMenu();\n "
      },
      {
        "sha": "62c44703f470c2c76955694a01d382d74e23eb37",
        "filename": "src/qt/networkstyle.cpp",
        "status": "added",
        "additions": 47,
        "deletions": 0,
        "changes": 47,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/99a814342bd13757e6bba92cfff134eddb5d29cc/src/qt/networkstyle.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/99a814342bd13757e6bba92cfff134eddb5d29cc/src/qt/networkstyle.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/networkstyle.cpp?ref=99a814342bd13757e6bba92cfff134eddb5d29cc",
        "patch": "@@ -0,0 +1,47 @@\n+// Copyright (c) 2014 The Bitcoin developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"networkstyle.h\"\n+\n+#include \"guiconstants.h\"\n+\n+#include <QApplication>\n+\n+static const struct {\n+    const char *networkId;\n+    const char *appName;\n+    const char *appIcon;\n+    const char *titleAddText;\n+    const char *splashImage;\n+} network_styles[] = {\n+    {\"main\", QAPP_APP_NAME_DEFAULT, \":/icons/bitcoin\", \"\", \":/images/splash\"},\n+    {\"test\", QAPP_APP_NAME_TESTNET, \":/icons/bitcoin_testnet\", QT_TRANSLATE_NOOP(\"SplashScreen\", \"[testnet]\"), \":/images/splash_testnet\"},\n+    {\"regtest\", QAPP_APP_NAME_TESTNET, \":/icons/bitcoin_testnet\", \"[regtest]\", \":/images/splash_testnet\"}\n+};\n+static const unsigned network_styles_count = sizeof(network_styles)/sizeof(*network_styles);\n+\n+// titleAddText needs to be const char* for tr()\n+NetworkStyle::NetworkStyle(const QString &appName, const QString &appIcon, const char *titleAddText, const QString &splashImage):\n+    appName(appName),\n+    appIcon(appIcon),\n+    titleAddText(qApp->translate(\"SplashScreen\", titleAddText)),\n+    splashImage(splashImage)\n+{\n+}\n+\n+const NetworkStyle *NetworkStyle::instantiate(const QString &networkId)\n+{\n+    for (unsigned x=0; x<network_styles_count; ++x)\n+    {\n+        if (networkId == network_styles[x].networkId)\n+        {\n+            return new NetworkStyle(\n+                    network_styles[x].appName,\n+                    network_styles[x].appIcon,\n+                    network_styles[x].titleAddText,\n+                    network_styles[x].splashImage);\n+        }\n+    }\n+    return 0;\n+}"
      },
      {
        "sha": "99304d61a3abe20babc7945d355ed25f2a3e7850",
        "filename": "src/qt/networkstyle.h",
        "status": "added",
        "additions": 33,
        "deletions": 0,
        "changes": 33,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/99a814342bd13757e6bba92cfff134eddb5d29cc/src/qt/networkstyle.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/99a814342bd13757e6bba92cfff134eddb5d29cc/src/qt/networkstyle.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/networkstyle.h?ref=99a814342bd13757e6bba92cfff134eddb5d29cc",
        "patch": "@@ -0,0 +1,33 @@\n+// Copyright (c) 2014 The Bitcoin developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef H_NETWORKSTYLE\n+#define H_NETWORKSTYLE\n+\n+#include <QIcon>\n+#include <QPixmap>\n+#include <QString>\n+\n+/* Coin network-specific GUI style information */\n+class NetworkStyle\n+{\n+public:\n+    /** Get style associated with provided BIP70 network id, or 0 if not known */\n+    static const NetworkStyle *instantiate(const QString &networkId);\n+\n+    const QString &getAppName() const { return appName; }\n+    const QIcon &getAppIcon() const { return appIcon; }\n+    const QString &getTitleAddText() const { return titleAddText; }\n+    const QPixmap &getSplashImage() const { return splashImage; }\n+\n+private:\n+    NetworkStyle(const QString &appName, const QString &appIcon, const char *titleAddText, const QString &splashImage);\n+\n+    QString appName;\n+    QIcon appIcon;\n+    QString titleAddText;\n+    QPixmap splashImage;\n+};\n+\n+#endif // H_NETWORKSTYLE"
      },
      {
        "sha": "360008ea8336f076b224fa467fd7927d9873c23f",
        "filename": "src/qt/splashscreen.cpp",
        "status": "modified",
        "additions": 9,
        "deletions": 16,
        "changes": 25,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/99a814342bd13757e6bba92cfff134eddb5d29cc/src/qt/splashscreen.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/99a814342bd13757e6bba92cfff134eddb5d29cc/src/qt/splashscreen.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/splashscreen.cpp?ref=99a814342bd13757e6bba92cfff134eddb5d29cc",
        "patch": "@@ -6,6 +6,7 @@\n \n #include \"clientversion.h\"\n #include \"init.h\"\n+#include \"networkstyle.h\"\n #include \"ui_interface.h\"\n #include \"util.h\"\n #include \"version.h\"\n@@ -19,7 +20,7 @@\n #include <QDesktopWidget>\n #include <QPainter>\n \n-SplashScreen::SplashScreen(Qt::WindowFlags f, bool isTestNet) :\n+SplashScreen::SplashScreen(Qt::WindowFlags f, const NetworkStyle *networkStyle) :\n     QWidget(0, f), curAlignment(0)\n {\n     // set reference point, paddings\n@@ -34,17 +35,12 @@ SplashScreen::SplashScreen(Qt::WindowFlags f, bool isTestNet) :\n     QString titleText       = tr(\"Bitcoin Core\");\n     QString versionText     = QString(\"Version %1\").arg(QString::fromStdString(FormatFullVersion()));\n     QString copyrightText   = QChar(0xA9)+QString(\" 2009-%1 \").arg(COPYRIGHT_YEAR) + QString(tr(\"The Bitcoin Core developers\"));\n-    QString testnetAddText  = QString(tr(\"[testnet]\")); // define text to place as single text object\n+    QString titleAddText    = networkStyle->getTitleAddText();\n \n     QString font            = \"Arial\";\n \n     // load the bitmap for writing some text over it\n-    if(isTestNet) {\n-        pixmap     = QPixmap(\":/images/splash_testnet\");\n-    }\n-    else {\n-        pixmap     = QPixmap(\":/images/splash\");\n-    }\n+    pixmap     = networkStyle->getSplashImage();\n \n     QPainter pixPaint(&pixmap);\n     pixPaint.setPen(QColor(100,100,100));\n@@ -78,23 +74,20 @@ SplashScreen::SplashScreen(Qt::WindowFlags f, bool isTestNet) :\n     pixPaint.setFont(QFont(font, 10*fontFactor));\n     pixPaint.drawText(pixmap.width()-titleTextWidth-paddingRight,paddingTop+titleCopyrightVSpace,copyrightText);\n \n-    // draw testnet string if testnet is on\n-    if(isTestNet) {\n+    // draw additional text if special network\n+    if(!titleAddText.isEmpty()) {\n         QFont boldFont = QFont(font, 10*fontFactor);\n         boldFont.setWeight(QFont::Bold);\n         pixPaint.setFont(boldFont);\n         fm = pixPaint.fontMetrics();\n-        int testnetAddTextWidth  = fm.width(testnetAddText);\n-        pixPaint.drawText(pixmap.width()-testnetAddTextWidth-10,15,testnetAddText);\n+        int titleAddTextWidth  = fm.width(titleAddText);\n+        pixPaint.drawText(pixmap.width()-titleAddTextWidth-10,15,titleAddText);\n     }\n \n     pixPaint.end();\n \n     // Set window title\n-    if(isTestNet)\n-        setWindowTitle(titleText + \" \" + testnetAddText);\n-    else\n-        setWindowTitle(titleText);\n+    setWindowTitle(titleText + \" \" + titleAddText);\n \n     // Resize window and move to center of desktop, disallow resizing\n     QRect r(QPoint(), pixmap.size());"
      },
      {
        "sha": "128edadbee40bd96ad23c4e089e33b759664f994",
        "filename": "src/qt/splashscreen.h",
        "status": "modified",
        "additions": 3,
        "deletions": 1,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/99a814342bd13757e6bba92cfff134eddb5d29cc/src/qt/splashscreen.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/99a814342bd13757e6bba92cfff134eddb5d29cc/src/qt/splashscreen.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/splashscreen.h?ref=99a814342bd13757e6bba92cfff134eddb5d29cc",
        "patch": "@@ -7,6 +7,8 @@\n \n #include <QSplashScreen>\n \n+class NetworkStyle;\n+\n /** Class for the splashscreen with information of the running client.\n  *\n  * @note this is intentionally not a QSplashScreen. Bitcoin Core initialization\n@@ -18,7 +20,7 @@ class SplashScreen : public QWidget\n     Q_OBJECT\n \n public:\n-    explicit SplashScreen(Qt::WindowFlags f, bool isTestNet);\n+    explicit SplashScreen(Qt::WindowFlags f, const NetworkStyle *networkStyle);\n     ~SplashScreen();\n \n protected:"
      }
    ]
  },
  {
    "sha": "afd2a6bbfc40b68c7124d1e9ee5935ef1526bb4c",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphZmQyYTZiYmZjNDBiNjhjNzEyNGQxZTllZTU5MzVlZjE1MjZiYjRj",
    "commit": {
      "author": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2014-10-10T06:39:57Z"
      },
      "committer": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2014-10-10T06:40:19Z"
      },
      "message": "squashme: Use a scoped pointer for the style instead of an explicit delete",
      "tree": {
        "sha": "cf708c7b5b7800b295aeb5bcdb3d742f79b6a31b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/cf708c7b5b7800b295aeb5bcdb3d742f79b6a31b"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/afd2a6bbfc40b68c7124d1e9ee5935ef1526bb4c",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/afd2a6bbfc40b68c7124d1e9ee5935ef1526bb4c",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/afd2a6bbfc40b68c7124d1e9ee5935ef1526bb4c",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/afd2a6bbfc40b68c7124d1e9ee5935ef1526bb4c/comments",
    "author": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "99a814342bd13757e6bba92cfff134eddb5d29cc",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/99a814342bd13757e6bba92cfff134eddb5d29cc",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/99a814342bd13757e6bba92cfff134eddb5d29cc"
      }
    ],
    "stats": {
      "total": 10,
      "additions": 4,
      "deletions": 6
    },
    "files": [
      {
        "sha": "9872ebc1f640ea632d72985d908838eba202d4bd",
        "filename": "src/qt/bitcoin.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 6,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/afd2a6bbfc40b68c7124d1e9ee5935ef1526bb4c/src/qt/bitcoin.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/afd2a6bbfc40b68c7124d1e9ee5935ef1526bb4c/src/qt/bitcoin.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoin.cpp?ref=afd2a6bbfc40b68c7124d1e9ee5935ef1526bb4c",
        "patch": "@@ -573,8 +573,8 @@ int main(int argc, char *argv[])\n     if (!PaymentServer::ipcParseCommandLine(argc, argv))\n         exit(0);\n #endif\n-    const NetworkStyle *networkStyle = NetworkStyle::instantiate(QString::fromStdString(Params().NetworkIDString()));\n-    assert(networkStyle);\n+    QScopedPointer<const NetworkStyle> networkStyle(NetworkStyle::instantiate(QString::fromStdString(Params().NetworkIDString())));\n+    assert(!networkStyle.isNull());\n     // Allow for separate UI settings for testnets\n     QApplication::setApplicationName(networkStyle->getAppName());\n     // Re-initialize translations after changing application name (language in network-specific settings can be different)\n@@ -616,11 +616,11 @@ int main(int argc, char *argv[])\n     uiInterface.InitMessage.connect(InitMessage);\n \n     if (GetBoolArg(\"-splash\", true) && !GetBoolArg(\"-min\", false))\n-        app.createSplashScreen(networkStyle);\n+        app.createSplashScreen(networkStyle.data());\n \n     try\n     {\n-        app.createWindow(networkStyle);\n+        app.createWindow(networkStyle.data());\n         app.requestInitialize();\n #if defined(Q_OS_WIN) && QT_VERSION >= 0x050000\n         WinShutdownMonitor::registerShutdownBlockReason(QObject::tr(\"Bitcoin Core didn't yet exit safely...\"), (HWND)app.getMainWinId());\n@@ -635,8 +635,6 @@ int main(int argc, char *argv[])\n         PrintExceptionContinue(NULL, \"Runaway exception\");\n         app.handleRunawayException(QString::fromStdString(strMiscWarning));\n     }\n-    delete networkStyle;\n-    networkStyle = 0;\n     return app.getReturnValue();\n }\n #endif // BITCOIN_QT_TEST"
      }
    ]
  }
]