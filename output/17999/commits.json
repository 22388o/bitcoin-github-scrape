[
  {
    "sha": "1dde238f2c21a0cc9bada10a2449cf9c6b2178ad",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxZGRlMjM4ZjJjMjFhMGNjOWJhZGExMGEyNDQ5Y2Y5YzZiMjE3OGFk",
    "commit": {
      "author": {
        "name": "Russell Yanofsky",
        "email": "russ@yanofsky.org",
        "date": "2017-12-05T20:57:12Z"
      },
      "committer": {
        "name": "Russell Yanofsky",
        "email": "russ@yanofsky.org",
        "date": "2020-02-25T10:50:39Z"
      },
      "message": "Add ChainClient setMockTime, getWallets methods\n\nNeeded to set mock times, and get wallet interface pointers correctly when\nwallet code is running in a different process from node code.",
      "tree": {
        "sha": "26269cc1ac164d0ef0ebc442b334ad58fe7a2119",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/26269cc1ac164d0ef0ebc442b334ad58fe7a2119"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1dde238f2c21a0cc9bada10a2449cf9c6b2178ad",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1dde238f2c21a0cc9bada10a2449cf9c6b2178ad",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/1dde238f2c21a0cc9bada10a2449cf9c6b2178ad",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1dde238f2c21a0cc9bada10a2449cf9c6b2178ad/comments",
    "author": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "31c0006a6cd5ecbabd119eaf9dae6978aa54f150",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/31c0006a6cd5ecbabd119eaf9dae6978aa54f150",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/31c0006a6cd5ecbabd119eaf9dae6978aa54f150"
      }
    ],
    "stats": {
      "total": 29,
      "additions": 26,
      "deletions": 3
    },
    "files": [
      {
        "sha": "846966705389a1dd0ee8303d8c54633fd873c1a6",
        "filename": "src/interfaces/chain.h",
        "status": "modified",
        "additions": 6,
        "deletions": 0,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1dde238f2c21a0cc9bada10a2449cf9c6b2178ad/src/interfaces/chain.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1dde238f2c21a0cc9bada10a2449cf9c6b2178ad/src/interfaces/chain.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/interfaces/chain.h?ref=1dde238f2c21a0cc9bada10a2449cf9c6b2178ad",
        "patch": "@@ -280,6 +280,12 @@ class ChainClient\n \n     //! Shut down client.\n     virtual void stop() = 0;\n+\n+    //! Set mock time.\n+    virtual void setMockTime(int64_t time) = 0;\n+\n+    //! Return interfaces for accessing wallets (if any).\n+    virtual std::vector<std::unique_ptr<Wallet>> getWallets() = 0;\n };\n \n //! Return implementation of Chain interface."
      },
      {
        "sha": "c3cfc713183146090b8a42f240d5e75a5c8795b0",
        "filename": "src/interfaces/node.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 2,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1dde238f2c21a0cc9bada10a2449cf9c6b2178ad/src/interfaces/node.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1dde238f2c21a0cc9bada10a2449cf9c6b2178ad/src/interfaces/node.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/interfaces/node.cpp?ref=1dde238f2c21a0cc9bada10a2449cf9c6b2178ad",
        "patch": "@@ -251,8 +251,9 @@ class NodeImpl : public Node\n     std::vector<std::unique_ptr<Wallet>> getWallets() override\n     {\n         std::vector<std::unique_ptr<Wallet>> wallets;\n-        for (const std::shared_ptr<CWallet>& wallet : GetWallets()) {\n-            wallets.emplace_back(MakeWallet(wallet));\n+        for (auto& client : m_context.chain_clients) {\n+            auto client_wallets = client->getWallets();\n+            std::move(client_wallets.begin(), client_wallets.end(), std::back_inserter(wallets));\n         }\n         return wallets;\n     }"
      },
      {
        "sha": "bec203b6382fff17185fb05b245286539e3a4661",
        "filename": "src/interfaces/wallet.cpp",
        "status": "modified",
        "additions": 9,
        "deletions": 0,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1dde238f2c21a0cc9bada10a2449cf9c6b2178ad/src/interfaces/wallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1dde238f2c21a0cc9bada10a2449cf9c6b2178ad/src/interfaces/wallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/interfaces/wallet.cpp?ref=1dde238f2c21a0cc9bada10a2449cf9c6b2178ad",
        "patch": "@@ -529,6 +529,15 @@ class WalletClientImpl : public ChainClient\n     void start(CScheduler& scheduler) override { return StartWallets(scheduler); }\n     void flush() override { return FlushWallets(); }\n     void stop() override { return StopWallets(); }\n+    void setMockTime(int64_t time) override { return SetMockTime(time); }\n+    std::vector<std::unique_ptr<Wallet>> getWallets() override\n+    {\n+        std::vector<std::unique_ptr<Wallet>> wallets;\n+        for (const auto& wallet : GetWallets()) {\n+            wallets.emplace_back(MakeWallet(wallet));\n+        }\n+        return wallets;\n+    }\n     ~WalletClientImpl() override { UnloadWallets(); }\n \n     Chain& m_chain;"
      },
      {
        "sha": "778bd05dad5a6710b9ed1d4b1610df93ead57d22",
        "filename": "src/rpc/misc.cpp",
        "status": "modified",
        "additions": 8,
        "deletions": 1,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1dde238f2c21a0cc9bada10a2449cf9c6b2178ad/src/rpc/misc.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1dde238f2c21a0cc9bada10a2449cf9c6b2178ad/src/rpc/misc.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/misc.cpp?ref=1dde238f2c21a0cc9bada10a2449cf9c6b2178ad",
        "patch": "@@ -4,6 +4,7 @@\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #include <httpserver.h>\n+#include <interfaces/chain.h>\n #include <key_io.h>\n #include <node/context.h>\n #include <outputtype.h>\n@@ -356,7 +357,13 @@ static UniValue setmocktime(const JSONRPCRequest& request)\n     LOCK(cs_main);\n \n     RPCTypeCheck(request.params, {UniValue::VNUM});\n-    SetMockTime(request.params[0].get_int64());\n+    int64_t time = request.params[0].get_int64();\n+    SetMockTime(time);\n+    if (g_rpc_node) {\n+        for (const auto& chain_client : g_rpc_node->chain_clients) {\n+            chain_client->setMockTime(time);\n+        }\n+    }\n \n     return NullUniValue;\n }"
      }
    ]
  },
  {
    "sha": "3ce16ad2f91d1e2edc7e7bdc5a19f72aa8c3e739",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozY2UxNmFkMmY5MWQxZTJlZGM3ZTdiZGM1YTE5ZjcyYWE4YzNlNzM5",
    "commit": {
      "author": {
        "name": "Russell Yanofsky",
        "email": "russ@yanofsky.org",
        "date": "2020-01-24T22:02:41Z"
      },
      "committer": {
        "name": "Russell Yanofsky",
        "email": "russ@yanofsky.org",
        "date": "2020-02-25T10:50:39Z"
      },
      "message": "refactor: Use psbt forward declaration\n\nAlso clean up forward other forward declarations in interfaces/wallet.h with !sort\n\nOriginal motivation for this change was to fix a circular dependencies lint\nerror: \"interfaces/chain.h -> interfaces/wallet.h -> psbt -> node/transaction\n-> node/context -> interfaces/chain.h\" from an earlier commit in this PR adding\na \"interfaces/chain.h -> interfaces/wallet.h\" include. Now, the wallet include\nis no longer added, but it is still good to clean up the psbt include for\nefficiency, and to sort the forward declarations.",
      "tree": {
        "sha": "147d4587a7dec7f33e11802ecdaf7c940339d147",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/147d4587a7dec7f33e11802ecdaf7c940339d147"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3ce16ad2f91d1e2edc7e7bdc5a19f72aa8c3e739",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3ce16ad2f91d1e2edc7e7bdc5a19f72aa8c3e739",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/3ce16ad2f91d1e2edc7e7bdc5a19f72aa8c3e739",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3ce16ad2f91d1e2edc7e7bdc5a19f72aa8c3e739/comments",
    "author": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "1dde238f2c21a0cc9bada10a2449cf9c6b2178ad",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1dde238f2c21a0cc9bada10a2449cf9c6b2178ad",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/1dde238f2c21a0cc9bada10a2449cf9c6b2178ad"
      }
    ],
    "stats": {
      "total": 9,
      "additions": 5,
      "deletions": 4
    },
    "files": [
      {
        "sha": "935fc6992e023a09abb94f651d9449b49c86d4cb",
        "filename": "src/interfaces/wallet.h",
        "status": "modified",
        "additions": 4,
        "deletions": 4,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/3ce16ad2f91d1e2edc7e7bdc5a19f72aa8c3e739/src/interfaces/wallet.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/3ce16ad2f91d1e2edc7e7bdc5a19f72aa8c3e739/src/interfaces/wallet.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/interfaces/wallet.h?ref=3ce16ad2f91d1e2edc7e7bdc5a19f72aa8c3e739",
        "patch": "@@ -14,7 +14,6 @@\n #include <functional>\n #include <map>\n #include <memory>\n-#include <psbt.h>\n #include <stdint.h>\n #include <string>\n #include <tuple>\n@@ -25,12 +24,13 @@ class CCoinControl;\n class CFeeRate;\n class CKey;\n class CWallet;\n-enum isminetype : unsigned int;\n enum class FeeReason;\n-typedef uint8_t isminefilter;\n-\n enum class OutputType;\n+enum class TransactionError;\n+enum isminetype : unsigned int;\n struct CRecipient;\n+struct PartiallySignedTransaction;\n+typedef uint8_t isminefilter;\n \n namespace interfaces {\n "
      },
      {
        "sha": "83796c384076b135da346149875188742890276e",
        "filename": "src/qt/walletmodel.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/3ce16ad2f91d1e2edc7e7bdc5a19f72aa8c3e739/src/qt/walletmodel.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/3ce16ad2f91d1e2edc7e7bdc5a19f72aa8c3e739/src/qt/walletmodel.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/walletmodel.cpp?ref=3ce16ad2f91d1e2edc7e7bdc5a19f72aa8c3e739",
        "patch": "@@ -20,6 +20,7 @@\n #include <interfaces/handler.h>\n #include <interfaces/node.h>\n #include <key_io.h>\n+#include <psbt.h>\n #include <ui_interface.h>\n #include <util/system.h> // for GetBoolArg\n #include <wallet/coincontrol.h>"
      }
    ]
  }
]