[
  {
    "sha": "e6050884fdabfa6e51e6afce2041d91e60a5adec",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplNjA1MDg4NGZkYWJmYTZlNTFlNmFmY2UyMDQxZDkxZTYwYTVhZGVj",
    "commit": {
      "author": {
        "name": "Carl Dong",
        "email": "contact@carldong.me",
        "date": "2020-01-15T17:16:08Z"
      },
      "committer": {
        "name": "Carl Dong",
        "email": "contact@carldong.me",
        "date": "2020-01-27T21:38:07Z"
      },
      "message": "guix: Pin Guix using `guix time-machine`",
      "tree": {
        "sha": "fef52ed67ec9fa53680c01588333acbd6e739ade",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fef52ed67ec9fa53680c01588333acbd6e739ade"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e6050884fdabfa6e51e6afce2041d91e60a5adec",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEECc3SW1JEo3Z49u6oDMUhUxl5kaUFAl4vWEIACgkQDMUhUxl5\nkaXQuw//WeXOketUThmYOJp8MLzI5iUEasEVXVGehR0Eblwwy1hydiFkXCp0D3s6\nqJ7Fe3cH66sQ5FaBbvESQpOTRVdSDeq8EOKW6bhO7YrhyBinQkEmTA6z25HoQx7G\n4C6upEQ4eq5evGMmWJ2sFW2qy7cAWowSpcDYlkfHNxhMvSLYYDYRJatLIYqOZDux\nr2fr1eBO2sysyy+5t15WIfqGCteaPCA+WlFEKwuAndSxz2rgxwUexR6ALZ5xZkl5\nl3yqc+hDeNk+LhetlTmzzYc+Jn3Ls5gdDIxUfQMbLfpO6/FO0udlyUnqeII54WZp\nVfqkCxwppe/ldAivCzpP/dV1Dj6tEJjPyGbJZMJw6WjePb20YCNLRdwkpIiWhu15\neoDiuBQA1aULXdRrNPRhiWuHoZ0uk3SMDGxYXTOpOq8QamD7FkGp25JTxmqt8e3n\nrJr3e/UWB14IAK/8iMOYcFIwkw1ZjG2SChX/0/3Pmr9Nv1PQFoWXbtkUHnMllhmr\nK/RCXh54myybR/ak5dEe+zozLs4j3FD1bLXoaQ10CDYZnX/kNEej0A8pkSklvP9Z\nsactSSwA4cxDipnELQAvXmD/iIBJuBHjirVlxQKD+sj7xsrEPeh1T7Xo9XflF5Qx\nFHonFHjbS9QETX9Ym1ZDM9cHrK1HxNiygB/Z7qil5lzxeJRr0Yc=\n=MmS+\n-----END PGP SIGNATURE-----",
        "payload": "tree fef52ed67ec9fa53680c01588333acbd6e739ade\nparent ceb789cf3a9075729efa07f5114ce0369d8606c3\nauthor Carl Dong <contact@carldong.me> 1579108568 -0500\ncommitter Carl Dong <contact@carldong.me> 1580161087 -0500\n\nguix: Pin Guix using `guix time-machine`\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e6050884fdabfa6e51e6afce2041d91e60a5adec",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/e6050884fdabfa6e51e6afce2041d91e60a5adec",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e6050884fdabfa6e51e6afce2041d91e60a5adec/comments",
    "author": {
      "login": "dongcarl",
      "id": 3445290,
      "node_id": "MDQ6VXNlcjM0NDUyOTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dongcarl",
      "html_url": "https://github.com/dongcarl",
      "followers_url": "https://api.github.com/users/dongcarl/followers",
      "following_url": "https://api.github.com/users/dongcarl/following{/other_user}",
      "gists_url": "https://api.github.com/users/dongcarl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
      "organizations_url": "https://api.github.com/users/dongcarl/orgs",
      "repos_url": "https://api.github.com/users/dongcarl/repos",
      "events_url": "https://api.github.com/users/dongcarl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dongcarl/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "dongcarl",
      "id": 3445290,
      "node_id": "MDQ6VXNlcjM0NDUyOTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dongcarl",
      "html_url": "https://github.com/dongcarl",
      "followers_url": "https://api.github.com/users/dongcarl/followers",
      "following_url": "https://api.github.com/users/dongcarl/following{/other_user}",
      "gists_url": "https://api.github.com/users/dongcarl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
      "organizations_url": "https://api.github.com/users/dongcarl/orgs",
      "repos_url": "https://api.github.com/users/dongcarl/repos",
      "events_url": "https://api.github.com/users/dongcarl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dongcarl/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "ceb789cf3a9075729efa07f5114ce0369d8606c3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ceb789cf3a9075729efa07f5114ce0369d8606c3",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/ceb789cf3a9075729efa07f5114ce0369d8606c3"
      }
    ],
    "stats": {
      "total": 32,
      "additions": 19,
      "deletions": 13
    },
    "files": [
      {
        "sha": "5e0c681f29bda2af4a1f92504cfd2abee2ed8376",
        "filename": "contrib/guix/guix-build.sh",
        "status": "modified",
        "additions": 19,
        "deletions": 13,
        "changes": 32,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e6050884fdabfa6e51e6afce2041d91e60a5adec/contrib/guix/guix-build.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e6050884fdabfa6e51e6afce2041d91e60a5adec/contrib/guix/guix-build.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/guix/guix-build.sh?ref=e6050884fdabfa6e51e6afce2041d91e60a5adec",
        "patch": "@@ -13,6 +13,12 @@ make -C \"${PWD}/depends\" -j\"$MAX_JOBS\" download ${V:+V=1} ${SOURCES_PATH:+SOURCE\n # Determine the reference time used for determinism (overridable by environment)\n SOURCE_DATE_EPOCH=\"${SOURCE_DATE_EPOCH:-$(git log --format=%at -1)}\"\n \n+time-machine() {\n+    guix time-machine --url=https://github.com/dongcarl/guix.git \\\n+                      --commit=b3a7c72c8b2425f8ddb0fc6e3b1caeed40f86dee \\\n+                      -- \"$@\"\n+}\n+\n # Deterministically build Bitcoin Core for HOSTs (overriable by environment)\n for host in ${HOSTS=i686-linux-gnu x86_64-linux-gnu arm-linux-gnueabihf aarch64-linux-gnu riscv64-linux-gnu}; do\n \n@@ -22,18 +28,18 @@ for host in ${HOSTS=i686-linux-gnu x86_64-linux-gnu arm-linux-gnueabihf aarch64-\n     # Run the build script 'contrib/guix/libexec/build.sh' in the build\n     # container specified by 'contrib/guix/manifest.scm'\n     # shellcheck disable=SC2086\n-    guix environment --manifest=\"${PWD}/contrib/guix/manifest.scm\" \\\n-                     --container \\\n-                     --pure \\\n-                     --no-cwd \\\n-                     --share=\"$PWD\"=/bitcoin \\\n-                     ${SOURCES_PATH:+--share=\"$SOURCES_PATH\"} \\\n-                     ${ADDITIONAL_GUIX_ENVIRONMENT_FLAGS} \\\n-                     -- env HOST=\"$host\" \\\n-                            MAX_JOBS=\"$MAX_JOBS\" \\\n-                            SOURCE_DATE_EPOCH=\"${SOURCE_DATE_EPOCH:?unable to determine value}\" \\\n-                            ${V:+V=1} \\\n-                            ${SOURCES_PATH:+SOURCES_PATH=\"$SOURCES_PATH\"} \\\n-                          bash -c \"cd /bitcoin && bash contrib/guix/libexec/build.sh\"\n+    time-machine environment --manifest=\"${PWD}/contrib/guix/manifest.scm\" \\\n+                             --container \\\n+                             --pure \\\n+                             --no-cwd \\\n+                             --share=\"$PWD\"=/bitcoin \\\n+                             ${SOURCES_PATH:+--share=\"$SOURCES_PATH\"} \\\n+                             ${ADDITIONAL_GUIX_ENVIRONMENT_FLAGS} \\\n+                             -- env HOST=\"$host\" \\\n+                                    MAX_JOBS=\"$MAX_JOBS\" \\\n+                                    SOURCE_DATE_EPOCH=\"${SOURCE_DATE_EPOCH:?unable to determine value}\" \\\n+                                    ${V:+V=1} \\\n+                                    ${SOURCES_PATH:+SOURCES_PATH=\"$SOURCES_PATH\"} \\\n+                                  bash -c \"cd /bitcoin && bash contrib/guix/libexec/build.sh\"\n \n done"
      }
    ]
  },
  {
    "sha": "88c83636d5a56bd9551577139786bdd3e74852c2",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4OGM4MzYzNmQ1YTU2YmQ5NTUxNTc3MTM5Nzg2YmRkM2U3NDg1MmMy",
    "commit": {
      "author": {
        "name": "Carl Dong",
        "email": "contact@carldong.me",
        "date": "2020-01-27T21:38:34Z"
      },
      "committer": {
        "name": "Carl Dong",
        "email": "contact@carldong.me",
        "date": "2020-01-27T21:41:20Z"
      },
      "message": "guix: Update documentation for time-machine\n\nWait a minute, doc. Are you telling me you built a time machine... Out\nof a functional package manager?",
      "tree": {
        "sha": "d78f066f9e6830d9070e3c934aec060d453d4180",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d78f066f9e6830d9070e3c934aec060d453d4180"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/88c83636d5a56bd9551577139786bdd3e74852c2",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEECc3SW1JEo3Z49u6oDMUhUxl5kaUFAl4vWQIACgkQDMUhUxl5\nkaWNABAA3Z1R7xMt+jQCCoZPaIbVPNF5B3eL4UPkfhUuSNEKrTDdcgSfKXjlUqPj\niGRgaZVCQaNjKVUR5yuT2rHKSd+bwJIP6/RGXrA/5kArHS9Djtw28sJAPI+Pwz0j\n3zQ//yhnjTMShicTBG9FZDm2pC5H6HZtooYvThGX2Eqp86CIQ2fn8+FEI/0YlZzc\nP1eMic+hB92wv4CK/B1Zg5bHnp5fDgkFfJcmxNViEZI0bzLFoptM5Tbx3OEKu2xm\nylFSgVrOUvgkK2Niuz4UYPp8S544YEU75ekuJ3/ys4URKFMgceIz0y0EzWxLRgdI\npxDbrxkVZN/Ev05slItDD9YZfaVORXypx4wD7CwVlSeyf1Y7nQwse737LONNF4z/\nnHmBNrXFILmGk9ZB3WkMuS6u56G2Dh0LmI1f30OeYJNvpKDj08QWsMWABSYy0Ksq\n1VuscsFXDCalXfGZDizM/3tTAf19c/i5L3pF+kC26UePq0cRm7ozfcpsRhDDoDxz\nY5ojCeNtiIonTD5UwatQ9H5mqOd/rJh5k1D+WBDArA5vfWIHATOKoGwSYyyg8QDL\nOn9fpHOswk2tQqldi2lz91WJqm/sEyOdSCdmOMGQd56E1LxUsOSkC9JjtCgSXmRs\nl+APZyobphJ2kUDDJ71h+tfEoPcqkAKmzREEKY3GpEs8Zy/Xlzw=\n=8rpj\n-----END PGP SIGNATURE-----",
        "payload": "tree d78f066f9e6830d9070e3c934aec060d453d4180\nparent e6050884fdabfa6e51e6afce2041d91e60a5adec\nauthor Carl Dong <contact@carldong.me> 1580161114 -0500\ncommitter Carl Dong <contact@carldong.me> 1580161280 -0500\n\nguix: Update documentation for time-machine\n\nWait a minute, doc. Are you telling me you built a time machine... Out\nof a functional package manager?\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/88c83636d5a56bd9551577139786bdd3e74852c2",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/88c83636d5a56bd9551577139786bdd3e74852c2",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/88c83636d5a56bd9551577139786bdd3e74852c2/comments",
    "author": {
      "login": "dongcarl",
      "id": 3445290,
      "node_id": "MDQ6VXNlcjM0NDUyOTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dongcarl",
      "html_url": "https://github.com/dongcarl",
      "followers_url": "https://api.github.com/users/dongcarl/followers",
      "following_url": "https://api.github.com/users/dongcarl/following{/other_user}",
      "gists_url": "https://api.github.com/users/dongcarl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
      "organizations_url": "https://api.github.com/users/dongcarl/orgs",
      "repos_url": "https://api.github.com/users/dongcarl/repos",
      "events_url": "https://api.github.com/users/dongcarl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dongcarl/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "dongcarl",
      "id": 3445290,
      "node_id": "MDQ6VXNlcjM0NDUyOTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dongcarl",
      "html_url": "https://github.com/dongcarl",
      "followers_url": "https://api.github.com/users/dongcarl/followers",
      "following_url": "https://api.github.com/users/dongcarl/following{/other_user}",
      "gists_url": "https://api.github.com/users/dongcarl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
      "organizations_url": "https://api.github.com/users/dongcarl/orgs",
      "repos_url": "https://api.github.com/users/dongcarl/repos",
      "events_url": "https://api.github.com/users/dongcarl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dongcarl/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "e6050884fdabfa6e51e6afce2041d91e60a5adec",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e6050884fdabfa6e51e6afce2041d91e60a5adec",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/e6050884fdabfa6e51e6afce2041d91e60a5adec"
      }
    ],
    "stats": {
      "total": 17,
      "additions": 8,
      "deletions": 9
    },
    "files": [
      {
        "sha": "46d755886c0de0afc3d244c6999abb09d588838e",
        "filename": "contrib/guix/README.md",
        "status": "modified",
        "additions": 8,
        "deletions": 9,
        "changes": 17,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/88c83636d5a56bd9551577139786bdd3e74852c2/contrib/guix/README.md",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/88c83636d5a56bd9551577139786bdd3e74852c2/contrib/guix/README.md",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/guix/README.md?ref=88c83636d5a56bd9551577139786bdd3e74852c2",
        "patch": "@@ -62,15 +62,16 @@ Likewise, to perform a bootstrapped build (takes even longer):\n export ADDITIONAL_GUIX_ENVIRONMENT_FLAGS='--bootstrap --no-substitutes'\n ```\n \n-### Using the right Guix\n+### Using a version of Guix with `guix time-machine` capabilities\n \n-Once Guix is installed, deploy our patched version into your current Guix\n-profile. The changes there are slowly being upstreamed.\n+> Note: This entire section can be skipped if you are already using a version of\n+> Guix that has [the `guix time-machine` command][guix/time-machine].\n+\n+Once Guix is installed, if it doesn't have the `guix time-machine` command, pull\n+the latest `guix`.\n \n ```sh\n-guix pull --url=https://github.com/dongcarl/guix.git \\\n-          --commit=82c77e52b8b46e0a3aad2cb12307c2e30547deec \\\n-          --max-jobs=4 # change accordingly\n+guix pull --max-jobs=4 # change number of jobs accordingly\n ```\n \n Make sure that you are using your current profile. (You are prompted to do this\n@@ -80,9 +81,6 @@ at the end of the `guix pull`)\n export PATH=\"${HOME}/.config/guix/current/bin${PATH:+:}$PATH\"\n ```\n \n-> Note: There is ongoing work to eliminate this entire section using Guix\n-> [inferiors][guix/inferiors] and [channels][guix/channels].\n-\n ## Usage\n \n ### As a Development Environment\n@@ -224,6 +222,7 @@ repository and will likely put one up soon.\n [guix/substitute-server-auth]: https://www.gnu.org/software/guix/manual/en/html_node/Substitute-Server-Authorization.html\n [guix/inferiors]: https://www.gnu.org/software/guix/manual/en/html_node/Inferiors.html\n [guix/channels]: https://www.gnu.org/software/guix/manual/en/html_node/Channels.html\n+[guix/time-machine]: https://guix.gnu.org/manual/en/html_node/Invoking-guix-time_002dmachine.html\n \n [debian/guix-package]: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=850644\n [fanquake/guix-docker]: https://github.com/fanquake/core-review/tree/master/guix"
      }
    ]
  }
]