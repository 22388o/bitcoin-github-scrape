[
  {
    "sha": "53bb6be3f8a50ee9e5c4d7e9155236152e7c4b7c",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo1M2JiNmJlM2Y4YTUwZWU5ZTVjNGQ3ZTkxNTUyMzYxNTJlN2M0Yjdj",
    "commit": {
      "author": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2018-10-31T18:04:05Z"
      },
      "committer": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2018-10-31T18:29:08Z"
      },
      "message": "Remove obj_c for macOS Dock icon setting\n\nQt `setWindowIcon()` does this work.",
      "tree": {
        "sha": "2a83aac8f756be10530d156f6603fe2d2323a93a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2a83aac8f756be10530d156f6603fe2d2323a93a"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/53bb6be3f8a50ee9e5c4d7e9155236152e7c4b7c",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE0dvyxLlvLev0wWZUQQEIES5+qB8FAlvZ9HQACgkQQQEIES5+\nqB/Veg/9GMD1Ya30W/PVexfVj735G+Ago/uQ0X0/Y8Fun2jdaylLWTgJhUZ6IHy5\n274oXGH64CCz9DZ4lILcs3KIjmczyg86UqyELm3U36Gyxeo6vKsKO2wktVoyccyy\nihjger/+5Nm7oSHAX8cMUWqt/sjZmErs2J0WrmeFE3zVadAjKrtCObNWlbPrrX1Z\n4RmFSu/fbX4ATvHXnzr93BTBfDSj6g5pLGP21GHCqQBnWRN7BBUTtFrVvCZ5e8Cr\nqACQoTm6b2mJW7FgqZcaWagd7yn9Vr4PvddUjkVUvqAeR+1JgrvWIKG2sghF5Ioq\nUnVvo9dzpMR/aRuXPj7OHBdEHH30mX7nZO2QH+8BTM/WE6/gat/uuuIuqE05xoXg\ni6+3fzLYiMlI0KwvD3loKVGOQEYD6NHLEZ2as+b+vDNEe7EMhHg+EOV0NH+LOh6F\nwxk2jpVEgOZ2awBHkzajyf2LaoaB2KbGhEjO33g3tx25ZDBfImRRR3bl35+jvqyJ\noyUmstx7JHzIUEHv/bjW1C1WkBq3jy0w4FG05lDmFkEACR960ApAzz+Sfqc6pIy/\nxEQ8xQfP8dXF6qWwCAToRskZBdVDY5PUfzqYikaTIM19BFxq8tyQ5jbn+LHhmwQF\nUeFix0L2HeGCaZNjpe3Jd8CLXw+vNTp0WS5JCHuCVSYugxNOQ/Y=\n=EnNO\n-----END PGP SIGNATURE-----",
        "payload": "tree 2a83aac8f756be10530d156f6603fe2d2323a93a\nparent f1e2f2a85962c1664e4e55471061af0eaa798d40\nauthor Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1541009045 +0200\ncommitter Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1541010548 +0200\n\nRemove obj_c for macOS Dock icon setting\n\nQt `setWindowIcon()` does this work.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/53bb6be3f8a50ee9e5c4d7e9155236152e7c4b7c",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/53bb6be3f8a50ee9e5c4d7e9155236152e7c4b7c",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/53bb6be3f8a50ee9e5c4d7e9155236152e7c4b7c/comments",
    "author": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "f1e2f2a85962c1664e4e55471061af0eaa798d40",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f1e2f2a85962c1664e4e55471061af0eaa798d40",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/f1e2f2a85962c1664e4e55471061af0eaa798d40"
      }
    ],
    "stats": {
      "total": 41,
      "additions": 0,
      "deletions": 41
    },
    "files": [
      {
        "sha": "5d34b8c7b05ba40f254eea6054f2d8eedd7267a8",
        "filename": "src/qt/bitcoingui.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 4,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/53bb6be3f8a50ee9e5c4d7e9155236152e7c4b7c/src/qt/bitcoingui.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/53bb6be3f8a50ee9e5c4d7e9155236152e7c4b7c/src/qt/bitcoingui.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoingui.cpp?ref=53bb6be3f8a50ee9e5c4d7e9155236152e7c4b7c",
        "patch": "@@ -92,12 +92,8 @@ BitcoinGUI::BitcoinGUI(interfaces::Node& node, const PlatformStyle *_platformSty\n         windowTitle += tr(\"Node\");\n     }\n     windowTitle += \" \" + networkStyle->getTitleAddText();\n-#ifndef Q_OS_MAC\n     QApplication::setWindowIcon(networkStyle->getTrayAndWindowIcon());\n     setWindowIcon(networkStyle->getTrayAndWindowIcon());\n-#else\n-    MacDockIconHandler::instance()->setIcon(networkStyle->getAppIcon());\n-#endif\n     setWindowTitle(windowTitle);\n \n     rpcConsole = new RPCConsole(node, _platformStyle, 0);"
      },
      {
        "sha": "34095ce073866b248963295895b6869c8257369b",
        "filename": "src/qt/macdockiconhandler.h",
        "status": "modified",
        "additions": 0,
        "deletions": 2,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/53bb6be3f8a50ee9e5c4d7e9155236152e7c4b7c/src/qt/macdockiconhandler.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/53bb6be3f8a50ee9e5c4d7e9155236152e7c4b7c/src/qt/macdockiconhandler.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/macdockiconhandler.h?ref=53bb6be3f8a50ee9e5c4d7e9155236152e7c4b7c",
        "patch": "@@ -9,7 +9,6 @@\n #include <QObject>\n \n QT_BEGIN_NAMESPACE\n-class QIcon;\n class QMenu;\n class QWidget;\n QT_END_NAMESPACE\n@@ -24,7 +23,6 @@ class MacDockIconHandler : public QObject\n     ~MacDockIconHandler();\n \n     QMenu *dockMenu();\n-    void setIcon(const QIcon &icon);\n     void setMainWindow(QMainWindow *window);\n     static MacDockIconHandler *instance();\n     static void cleanup();"
      },
      {
        "sha": "7c174be617165faa59cdc697312281fe3dcf76e6",
        "filename": "src/qt/macdockiconhandler.mm",
        "status": "modified",
        "additions": 0,
        "deletions": 35,
        "changes": 35,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/53bb6be3f8a50ee9e5c4d7e9155236152e7c4b7c/src/qt/macdockiconhandler.mm",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/53bb6be3f8a50ee9e5c4d7e9155236152e7c4b7c/src/qt/macdockiconhandler.mm",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/macdockiconhandler.mm?ref=53bb6be3f8a50ee9e5c4d7e9155236152e7c4b7c",
        "patch": "@@ -4,9 +4,7 @@\n \n #include \"macdockiconhandler.h\"\n \n-#include <QImageWriter>\n #include <QMenu>\n-#include <QBuffer>\n #include <QWidget>\n \n #undef slots\n@@ -71,39 +69,6 @@ void setupDockClickHandler() {\n     return this->m_dockMenu;\n }\n \n-void MacDockIconHandler::setIcon(const QIcon &icon)\n-{\n-    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];\n-    NSImage *image = nil;\n-    if (icon.isNull())\n-        image = [[NSImage imageNamed:@\"NSApplicationIcon\"] retain];\n-    else {\n-        // generate NSImage from QIcon and use this as dock icon.\n-        QSize size = icon.actualSize(QSize(128, 128));\n-        QPixmap pixmap = icon.pixmap(size);\n-\n-        // Write image into a R/W buffer from raw pixmap, then save the image.\n-        QBuffer notificationBuffer;\n-        if (!pixmap.isNull() && notificationBuffer.open(QIODevice::ReadWrite)) {\n-            QImageWriter writer(&notificationBuffer, \"PNG\");\n-            if (writer.write(pixmap.toImage())) {\n-                NSData* macImgData = [NSData dataWithBytes:notificationBuffer.buffer().data()\n-                                             length:notificationBuffer.buffer().size()];\n-                image =  [[NSImage alloc] initWithData:macImgData];\n-            }\n-        }\n-\n-        if(!image) {\n-            // if testnet image could not be created, load std. app icon\n-            image = [[NSImage imageNamed:@\"NSApplicationIcon\"] retain];\n-        }\n-    }\n-\n-    [NSApp setApplicationIconImage:image];\n-    [image release];\n-    [pool release];\n-}\n-\n MacDockIconHandler *MacDockIconHandler::instance()\n {\n     if (!s_instance)"
      }
    ]
  },
  {
    "sha": "2464925e7be832d4926b6204169bbbc1646c6368",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyNDY0OTI1ZTdiZTgzMmQ0OTI2YjYyMDQxNjliYmJjMTY0NmM2MzY4",
    "commit": {
      "author": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2018-10-31T19:15:31Z"
      },
      "committer": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2018-11-04T00:37:28Z"
      },
      "message": "Use Qt signal for macOS Dock icon click event\n\nThis moves the Dock icon click reaction code to the common place and\nallows some cleanup in obj_c code.\n\nAccording to the Apple's docs `class_replaceMethod` behaves as\n`class_addMethod`, if the method identified by name does not yet exist;\nor as `method_setImplementation`, if it does exist.",
      "tree": {
        "sha": "5c31a922f2eddbe60de8622cd012c85eb15868d3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5c31a922f2eddbe60de8622cd012c85eb15868d3"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2464925e7be832d4926b6204169bbbc1646c6368",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE0dvyxLlvLev0wWZUQQEIES5+qB8FAlveP0gACgkQQQEIES5+\nqB/3MRAAhidc7GudsXTONW+UkDF0Pjadvr09bGM+I7V0ahRd1NO5Y42jPDFzmqwl\nuGr5wzI+wR3qDE1In/k1GXIa/YNWXeSW/w3FdIbqHNxAdf88MGj8YarXJKOIpgai\n9p0fnTAHo7f59UdEzDmTlW0gCIUlvQo8tJJpbw3TancXsvV0IS9TkLwdvE9HsYbt\nKFWOU/Ey4nkMd9R2Mk4T0riR9juJV9wm95uk5XuXhOt8E+zTM2P74KK4F3zG4IpM\nJty8MpZneU3ONfu+NwjZeePbr1V21YN6ruiP60jI7E7sjvdO4wvhMTOHU0EoqJ63\n6GFRMoStgFv9WVsI6WUDRLVzuq5zWC1LIhXXs6XDNP5Qyh1GGPFUNVJCTmt6Op7s\nsAG2uQDYs5DesQ90dfPByYLK0cFoHh6AJ9hiW+daWa0/whm2qo6GFtLEPMqBYKlY\n4JhD8jVSxu1XF5Ka0LIykQNSKbWCWHoTDwWoEW3C1CUy0a2W+Fy49V3qXojwuNvf\nhAWTPc2vK7CZwrVbhIDIDtUBl38eZGaOOwtpQkiKRqtSz53iqidralVV1NZ2HOsh\nDqt7kRFSeeLshnKHxQx8wwWT4rgzvkN8YGW6xXD07yjvmP5ni4vzrwJCnjyUGD8q\nKRIH5eg/MYWqhd93Zh7VUup26kjXD49H4Tzi3pmCskBXjubIo9k=\n=EE4w\n-----END PGP SIGNATURE-----",
        "payload": "tree 5c31a922f2eddbe60de8622cd012c85eb15868d3\nparent 53bb6be3f8a50ee9e5c4d7e9155236152e7c4b7c\nauthor Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1541013331 +0200\ncommitter Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1541291848 +0200\n\nUse Qt signal for macOS Dock icon click event\n\nThis moves the Dock icon click reaction code to the common place and\nallows some cleanup in obj_c code.\n\nAccording to the Apple's docs `class_replaceMethod` behaves as\n`class_addMethod`, if the method identified by name does not yet exist;\nor as `method_setImplementation`, if it does exist.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2464925e7be832d4926b6204169bbbc1646c6368",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/2464925e7be832d4926b6204169bbbc1646c6368",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2464925e7be832d4926b6204169bbbc1646c6368/comments",
    "author": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "53bb6be3f8a50ee9e5c4d7e9155236152e7c4b7c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/53bb6be3f8a50ee9e5c4d7e9155236152e7c4b7c",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/53bb6be3f8a50ee9e5c4d7e9155236152e7c4b7c"
      }
    ],
    "stats": {
      "total": 69,
      "additions": 25,
      "deletions": 44
    },
    "files": [
      {
        "sha": "8817f93b79b115a12186171c75071c2cef08b3dd",
        "filename": "src/qt/bitcoingui.cpp",
        "status": "modified",
        "additions": 12,
        "deletions": 6,
        "changes": 18,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/2464925e7be832d4926b6204169bbbc1646c6368/src/qt/bitcoingui.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/2464925e7be832d4926b6204169bbbc1646c6368/src/qt/bitcoingui.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoingui.cpp?ref=2464925e7be832d4926b6204169bbbc1646c6368",
        "patch": "@@ -595,7 +595,7 @@ void BitcoinGUI::createTrayIcon(const NetworkStyle *networkStyle)\n void BitcoinGUI::createTrayIconMenu()\n {\n #ifndef Q_OS_MAC\n-    // return if trayIcon is unset (only on non-Mac OSes)\n+    // return if trayIcon is unset (only on non-macOSes)\n     if (!trayIcon)\n         return;\n \n@@ -604,15 +604,15 @@ void BitcoinGUI::createTrayIconMenu()\n \n     connect(trayIcon, &QSystemTrayIcon::activated, this, &BitcoinGUI::trayIconActivated);\n #else\n-    // Note: On Mac, the dock icon is used to provide the tray's functionality.\n+    // Note: On macOS, the Dock icon is used to provide the tray's functionality.\n     MacDockIconHandler *dockIconHandler = MacDockIconHandler::instance();\n-    dockIconHandler->setMainWindow(static_cast<QMainWindow*>(this));\n+    connect(dockIconHandler, &MacDockIconHandler::dockIconClicked, this, &BitcoinGUI::macosDockIconActivated);\n     trayIconMenu = dockIconHandler->dockMenu();\n #endif\n \n-    // Configuration of the tray icon (or dock icon) icon menu\n+    // Configuration of the tray icon (or Dock icon) menu\n #ifndef Q_OS_MAC\n-    // Note: On Mac, the dock icon's menu already has show / hide action.\n+    // Note: On macOS, the Dock icon's menu already has Show / Hide action.\n     trayIconMenu->addAction(toggleHideAction);\n     trayIconMenu->addSeparator();\n #endif\n@@ -626,7 +626,7 @@ void BitcoinGUI::createTrayIconMenu()\n         trayIconMenu->addAction(openRPCConsoleAction);\n     }\n     trayIconMenu->addAction(optionsAction);\n-#ifndef Q_OS_MAC // This is built-in on Mac\n+#ifndef Q_OS_MAC // This is built-in on macOS\n     trayIconMenu->addSeparator();\n     trayIconMenu->addAction(quitAction);\n #endif\n@@ -641,6 +641,12 @@ void BitcoinGUI::trayIconActivated(QSystemTrayIcon::ActivationReason reason)\n         toggleHidden();\n     }\n }\n+#else\n+void BitcoinGUI::macosDockIconActivated()\n+{\n+    show();\n+    activateWindow();\n+}\n #endif\n \n void BitcoinGUI::optionsClicked()"
      },
      {
        "sha": "be33b4679fed78b6f4d03ef2315394ff5a969512",
        "filename": "src/qt/bitcoingui.h",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/2464925e7be832d4926b6204169bbbc1646c6368/src/qt/bitcoingui.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/2464925e7be832d4926b6204169bbbc1646c6368/src/qt/bitcoingui.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoingui.h?ref=2464925e7be832d4926b6204169bbbc1646c6368",
        "patch": "@@ -260,6 +260,9 @@ public Q_SLOTS:\n #ifndef Q_OS_MAC\n     /** Handle tray icon clicked */\n     void trayIconActivated(QSystemTrayIcon::ActivationReason reason);\n+#else\n+    /** Handle macOS Dock icon clicked */\n+    void macosDockIconActivated();\n #endif\n \n     /** Show window if hidden, unminimize when minimized, rise when obscured or show if hidden and fToggleHidden is true */"
      },
      {
        "sha": "ea77cdf054342d2c5cfa48ddee38309234ee2c85",
        "filename": "src/qt/macdockiconhandler.h",
        "status": "modified",
        "additions": 2,
        "deletions": 6,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/2464925e7be832d4926b6204169bbbc1646c6368/src/qt/macdockiconhandler.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/2464925e7be832d4926b6204169bbbc1646c6368/src/qt/macdockiconhandler.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/macdockiconhandler.h?ref=2464925e7be832d4926b6204169bbbc1646c6368",
        "patch": "@@ -1,19 +1,18 @@\n-// Copyright (c) 2011-2015 The Bitcoin Core developers\n+// Copyright (c) 2011-2018 The Bitcoin Core developers\n // Distributed under the MIT software license, see the accompanying\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n #ifndef BITCOIN_QT_MACDOCKICONHANDLER_H\n #define BITCOIN_QT_MACDOCKICONHANDLER_H\n \n-#include <QMainWindow>\n #include <QObject>\n \n QT_BEGIN_NAMESPACE\n class QMenu;\n class QWidget;\n QT_END_NAMESPACE\n \n-/** Macintosh-specific dock icon handler.\n+/** macOS-specific Dock icon handler.\n  */\n class MacDockIconHandler : public QObject\n {\n@@ -23,10 +22,8 @@ class MacDockIconHandler : public QObject\n     ~MacDockIconHandler();\n \n     QMenu *dockMenu();\n-    void setMainWindow(QMainWindow *window);\n     static MacDockIconHandler *instance();\n     static void cleanup();\n-    void handleDockIconClickEvent();\n \n Q_SIGNALS:\n     void dockIconClicked();\n@@ -36,7 +33,6 @@ class MacDockIconHandler : public QObject\n \n     QWidget *m_dummyWidget;\n     QMenu *m_dockMenu;\n-    QMainWindow *mainWindow;\n };\n \n #endif // BITCOIN_QT_MACDOCKICONHANDLER_H"
      },
      {
        "sha": "a35661769762f3093ee67aad5c5c540be4656562",
        "filename": "src/qt/macdockiconhandler.mm",
        "status": "modified",
        "additions": 8,
        "deletions": 32,
        "changes": 40,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/2464925e7be832d4926b6204169bbbc1646c6368/src/qt/macdockiconhandler.mm",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/2464925e7be832d4926b6204169bbbc1646c6368/src/qt/macdockiconhandler.mm",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/macdockiconhandler.mm?ref=2464925e7be832d4926b6204169bbbc1646c6368",
        "patch": "@@ -1,4 +1,4 @@\n-// Copyright (c) 2011-2013 The Bitcoin Core developers\n+// Copyright (c) 2011-2018 The Bitcoin Core developers\n // Distributed under the MIT software license, see the accompanying\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n@@ -18,25 +18,18 @@ bool dockClickHandler(id self,SEL _cmd,...) {\n     Q_UNUSED(self)\n     Q_UNUSED(_cmd)\n \n-    s_instance->handleDockIconClickEvent();\n+    Q_EMIT s_instance->dockIconClicked();\n \n-    // Return NO (false) to suppress the default OS X actions\n+    // Return NO (false) to suppress the default macOS actions\n     return false;\n }\n \n void setupDockClickHandler() {\n-    Class cls = objc_getClass(\"NSApplication\");\n-    id appInst = objc_msgSend((id)cls, sel_registerName(\"sharedApplication\"));\n-\n-    if (appInst != nullptr) {\n-        id delegate = objc_msgSend(appInst, sel_registerName(\"delegate\"));\n-        Class delClass = (Class)objc_msgSend(delegate,  sel_registerName(\"class\"));\n-        SEL shouldHandle = sel_registerName(\"applicationShouldHandleReopen:hasVisibleWindows:\");\n-        if (class_getInstanceMethod(delClass, shouldHandle))\n-            class_replaceMethod(delClass, shouldHandle, (IMP)dockClickHandler, \"B@:\");\n-        else\n-            class_addMethod(delClass, shouldHandle, (IMP)dockClickHandler,\"B@:\");\n-    }\n+    id app = objc_msgSend((id)objc_getClass(\"NSApplication\"), sel_registerName(\"sharedApplication\"));\n+    id delegate = objc_msgSend(app, sel_registerName(\"delegate\"));\n+    Class delClass = (Class)objc_msgSend(delegate, sel_registerName(\"class\"));\n+    SEL shouldHandle = sel_registerName(\"applicationShouldHandleReopen:hasVisibleWindows:\");\n+    class_replaceMethod(delClass, shouldHandle, (IMP)dockClickHandler, \"B@:\");\n }\n \n \n@@ -47,21 +40,15 @@ void setupDockClickHandler() {\n     setupDockClickHandler();\n     this->m_dummyWidget = new QWidget();\n     this->m_dockMenu = new QMenu(this->m_dummyWidget);\n-    this->setMainWindow(nullptr);\n #if QT_VERSION >= 0x050200\n     this->m_dockMenu->setAsDockMenu();\n #endif\n     [pool release];\n }\n \n-void MacDockIconHandler::setMainWindow(QMainWindow *window) {\n-    this->mainWindow = window;\n-}\n-\n MacDockIconHandler::~MacDockIconHandler()\n {\n     delete this->m_dummyWidget;\n-    this->setMainWindow(nullptr);\n }\n \n QMenu *MacDockIconHandler::dockMenu()\n@@ -80,14 +67,3 @@ void setupDockClickHandler() {\n {\n     delete s_instance;\n }\n-\n-void MacDockIconHandler::handleDockIconClickEvent()\n-{\n-    if (this->mainWindow)\n-    {\n-        this->mainWindow->activateWindow();\n-        this->mainWindow->show();\n-    }\n-\n-    Q_EMIT this->dockIconClicked();\n-}"
      }
    ]
  },
  {
    "sha": "6b1d2972bf9a40f97ba3a5c95831fd179b1054cf",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2YjFkMjk3MmJmOWE0MGY5N2JhM2E1Yzk1ODMxZmQxNzliMTA1NGNm",
    "commit": {
      "author": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2018-11-02T08:58:14Z"
      },
      "committer": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2018-11-04T00:42:18Z"
      },
      "message": "Remove obj_c for macOS Dock icon menu\n\nQt `setAsDockMenu()` does this work.",
      "tree": {
        "sha": "45cb7b3258ab4b28685fd9b50f29234a4b749359",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/45cb7b3258ab4b28685fd9b50f29234a4b749359"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6b1d2972bf9a40f97ba3a5c95831fd179b1054cf",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE0dvyxLlvLev0wWZUQQEIES5+qB8FAlveQGoACgkQQQEIES5+\nqB+i9hAAsepGahnkNVymTpQ+odpOukZtHohQZyip6RbkZRUI078DXWjGFF4w1c87\npGL4aUwPGzvnFy9vVFeu7vALcgovoS1CQMFScgjHNgJXfSrNeemGdaqURnIM2MtD\npKvNZ2858GhdutIGq1X/MBs3nPmlOGUTYxObP9L5v+9njBEseF1wQ19dkzTZxPpw\nHvpois3qwBEL6I1y/JR3YmgcSHNPg4vY3301rX5OcxRtN34bAFjrLW+lkPbeNA6H\nYuuVkewFs5B88Kz5JHgzdHbLMaJpVwzF+YaTFbseIR4niHsw7TE+bOPnjI1hnQaP\ntULTKxTN1QI1HNoDdvzzKP1d+t1U2Xhl29zwso1sI+/twlpRe/X1lHA1DGdxwDYc\nG9jyFFKjUQ1GJZ2t5EFzcy2Uhq20Ya4JR/d1a9I1TQLNZ5GwF2kPPZuX2HBh39G6\n38gqP0u3Ft8hUxxVemZyzQFhLIT2hQwygeaMUJ6cM2QHWqFXgpgsVrsQlRdkQdpb\nXBhvdHPozZmKXBEKFfZsxgmwmm7lI68n+Urs4r0sLzx3RfrTnSPlHpOAAIq/gEt9\n7/aP4TLPPZBaogxYX8KMpOJAXELNlj+OZVIR9DwpZVSGys3jsFfY3feNXh/tDvjZ\nXS++N3PUjtk1Z/UPLf9galfQMkzf3TlH5h/roi0UvVSAIbn7FYA=\n=Qs4O\n-----END PGP SIGNATURE-----",
        "payload": "tree 45cb7b3258ab4b28685fd9b50f29234a4b749359\nparent 2464925e7be832d4926b6204169bbbc1646c6368\nauthor Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1541149094 +0200\ncommitter Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1541292138 +0200\n\nRemove obj_c for macOS Dock icon menu\n\nQt `setAsDockMenu()` does this work.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6b1d2972bf9a40f97ba3a5c95831fd179b1054cf",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/6b1d2972bf9a40f97ba3a5c95831fd179b1054cf",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6b1d2972bf9a40f97ba3a5c95831fd179b1054cf/comments",
    "author": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "2464925e7be832d4926b6204169bbbc1646c6368",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2464925e7be832d4926b6204169bbbc1646c6368",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/2464925e7be832d4926b6204169bbbc1646c6368"
      }
    ],
    "stats": {
      "total": 40,
      "additions": 4,
      "deletions": 36
    },
    "files": [
      {
        "sha": "de7153722022280b2b77442c4c19dcf926310104",
        "filename": "src/qt/bitcoingui.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 1,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6b1d2972bf9a40f97ba3a5c95831fd179b1054cf/src/qt/bitcoingui.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6b1d2972bf9a40f97ba3a5c95831fd179b1054cf/src/qt/bitcoingui.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoingui.cpp?ref=6b1d2972bf9a40f97ba3a5c95831fd179b1054cf",
        "patch": "@@ -607,7 +607,9 @@ void BitcoinGUI::createTrayIconMenu()\n     // Note: On macOS, the Dock icon is used to provide the tray's functionality.\n     MacDockIconHandler *dockIconHandler = MacDockIconHandler::instance();\n     connect(dockIconHandler, &MacDockIconHandler::dockIconClicked, this, &BitcoinGUI::macosDockIconActivated);\n-    trayIconMenu = dockIconHandler->dockMenu();\n+\n+    trayIconMenu = new QMenu(this);\n+    trayIconMenu->setAsDockMenu();\n #endif\n \n     // Configuration of the tray icon (or Dock icon) menu"
      },
      {
        "sha": "ff867e21a79c010f70c473978f85f10a22e55972",
        "filename": "src/qt/macdockiconhandler.h",
        "status": "modified",
        "additions": 0,
        "deletions": 11,
        "changes": 11,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6b1d2972bf9a40f97ba3a5c95831fd179b1054cf/src/qt/macdockiconhandler.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6b1d2972bf9a40f97ba3a5c95831fd179b1054cf/src/qt/macdockiconhandler.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/macdockiconhandler.h?ref=6b1d2972bf9a40f97ba3a5c95831fd179b1054cf",
        "patch": "@@ -7,21 +7,13 @@\n \n #include <QObject>\n \n-QT_BEGIN_NAMESPACE\n-class QMenu;\n-class QWidget;\n-QT_END_NAMESPACE\n-\n /** macOS-specific Dock icon handler.\n  */\n class MacDockIconHandler : public QObject\n {\n     Q_OBJECT\n \n public:\n-    ~MacDockIconHandler();\n-\n-    QMenu *dockMenu();\n     static MacDockIconHandler *instance();\n     static void cleanup();\n \n@@ -30,9 +22,6 @@ class MacDockIconHandler : public QObject\n \n private:\n     MacDockIconHandler();\n-\n-    QWidget *m_dummyWidget;\n-    QMenu *m_dockMenu;\n };\n \n #endif // BITCOIN_QT_MACDOCKICONHANDLER_H"
      },
      {
        "sha": "102adce6c5fb61159b5f8b0df94f500aa38f23b9",
        "filename": "src/qt/macdockiconhandler.mm",
        "status": "modified",
        "additions": 1,
        "deletions": 24,
        "changes": 25,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6b1d2972bf9a40f97ba3a5c95831fd179b1054cf/src/qt/macdockiconhandler.mm",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6b1d2972bf9a40f97ba3a5c95831fd179b1054cf/src/qt/macdockiconhandler.mm",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/macdockiconhandler.mm?ref=6b1d2972bf9a40f97ba3a5c95831fd179b1054cf",
        "patch": "@@ -4,17 +4,13 @@\n \n #include \"macdockiconhandler.h\"\n \n-#include <QMenu>\n-#include <QWidget>\n-\n #undef slots\n-#include <Cocoa/Cocoa.h>\n #include <objc/objc.h>\n #include <objc/message.h>\n \n static MacDockIconHandler *s_instance = nullptr;\n \n-bool dockClickHandler(id self,SEL _cmd,...) {\n+bool dockClickHandler(id self, SEL _cmd, ...) {\n     Q_UNUSED(self)\n     Q_UNUSED(_cmd)\n \n@@ -32,28 +28,9 @@ void setupDockClickHandler() {\n     class_replaceMethod(delClass, shouldHandle, (IMP)dockClickHandler, \"B@:\");\n }\n \n-\n MacDockIconHandler::MacDockIconHandler() : QObject()\n {\n-    NSAutoreleasePool *pool = [[NSAutoreleasePool alloc] init];\n-\n     setupDockClickHandler();\n-    this->m_dummyWidget = new QWidget();\n-    this->m_dockMenu = new QMenu(this->m_dummyWidget);\n-#if QT_VERSION >= 0x050200\n-    this->m_dockMenu->setAsDockMenu();\n-#endif\n-    [pool release];\n-}\n-\n-MacDockIconHandler::~MacDockIconHandler()\n-{\n-    delete this->m_dummyWidget;\n-}\n-\n-QMenu *MacDockIconHandler::dockMenu()\n-{\n-    return this->m_dockMenu;\n }\n \n MacDockIconHandler *MacDockIconHandler::instance()"
      }
    ]
  }
]