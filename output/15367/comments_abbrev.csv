kristapsk,2019-02-07T21:19:06Z,"I don't think this should be the scope of Bitcoin Core. Service dependencies should be handled by the init  / service management system you are using. Or you can just create a simple shell script, to run all the stuff you need. Besides, it is usually recommended to run different services under different users, if possible, to increase security.",https://github.com/bitcoin/bitcoin/pull/15367#issuecomment-461599555,461599555,
gmaxwell,2019-02-07T22:57:39Z,"@kristapsk Startup services can't trigger when bitcoin is ready to be actually used. That is the big reason for a notify here. Yes, as an alternative software could just poll until its ready but the same could be said for blocknotifys. \n\nHistorically speaking-- startup scripts people have created for bitcoin have been uniformly low quality (e.g. making the software unusable providing no way to",https://github.com/bitcoin/bitcoin/pull/15367#issuecomment-461627138,461627138,
promag,2019-02-08T14:39:27Z,"I understand the need, I'm not fond of the solution. I think it's perfectly sane to poll the interface or locally run something like netstat.\n\nDoes anyone knows an example using this strategy?",https://github.com/bitcoin/bitcoin/pull/15367#issuecomment-461823401,461823401,
gmaxwell,2019-02-09T22:36:28Z,"> I understand the need, I'm not fond of the solution. I think it's perfectly sane to poll the interface or locally run something like netstat.\n\nHuh. Netstat can not tell you if bitcoind is done starting.    If you connect as soon as the socket is listening you'll get ""bitcoin is starting"" errors returned.  The gain here over simply retrying is that you can start connecting only when it's actu",https://github.com/bitcoin/bitcoin/pull/15367#issuecomment-462085696,462085696,
kristapsk,2019-02-10T19:52:16Z,"> Startup services can't trigger when bitcoin is ready to be actually used. That is the big reason for a notify here.\n\nDidn't thought about that. Yes, then it makes sense, concept ACK from me too.",https://github.com/bitcoin/bitcoin/pull/15367#issuecomment-462165969,462165969,
benthecarman,2019-02-11T03:27:00Z,Moved function call to very end of init sequence,https://github.com/bitcoin/bitcoin/pull/15367#issuecomment-462210993,462210993,
DrahtBot,2019-02-11T03:34:48Z,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #17127 (util: Correct permissions for datadir and wallets subdir by hebasto)\n\nIf you consider this pull request importan",https://github.com/bitcoin/bitcoin/pull/15367#issuecomment-462211718,462211718,
promag,2019-02-11T19:10:28Z,"Still not convinced about this. I think the general approach is to poll the interface of interest.\n\nDocker, for instance, supports a directive to check if a container is healthy https://docs.docker.com/v17.09/engine/reference/builder/#healthcheck \n\nSee also https://docs.docker.com/compose/startup-order/\n\nAnyway, what if you want to trigger some command when both bitcoind and other serv",https://github.com/bitcoin/bitcoin/pull/15367#issuecomment-462454648,462454648,
abitfan,2019-02-25T18:18:00Z,"Electrum (and most likely lnd as well) already have a retry mechanism for rpc and the rpc can be unavailable for other reasons as well so this doesn't add much functionality.  \nYou can watch debug.log for ""init message: Done loading"" or setup a rawtx zmq publisher and consider bitcoind started when the first notification comes in.  \n  \nNot specific to this pr but running random commands is n",https://github.com/bitcoin/bitcoin/pull/15367#issuecomment-467119530,467119530,
benthecarman,2019-02-25T20:49:43Z,"> Consider the scenario where someone out of hurry and not wanting to deal with file permissions puts his notifywhatever script in a world writable place and forgets about it only to have his wallet flushed some months later. \n\nWhile that is true the same could be done with the other notify options, which are ran much more often. ",https://github.com/bitcoin/bitcoin/pull/15367#issuecomment-467177363,467177363,
benthecarman,2020-07-30T16:59:06Z,Rebased,https://github.com/bitcoin/bitcoin/pull/15367#issuecomment-666525179,666525179,
dongcarl,2020-07-30T18:49:58Z,"Concept ACK!\n\n-----\n\nThis is also a nice, init-system agnostic way of signaling to the init system that `bitcoind` is ready and in steady state.\n\nOn `systemd` systems, it could look like:\n```\n-startupnotify='systemd-notify --ready'\n```\n\nCouple this with `Type=notify` in `bitcoind.service` and set dependent units to `After=bitcoind.service` and Lennart will visit you in your d",https://github.com/bitcoin/bitcoin/pull/15367#issuecomment-666598128,666598128,
dongcarl,2020-07-30T19:25:35Z,"tACK 128d9fe1e2e1264753f821c972212fd24d9a2290\n\nNote the `-p Type=notify` which tells `systemd` that it'll be notified when the unit is ready, and the final log line `Started...`, which indicates that `systemd` received the ready notification after sockets are bound to and threads started.\n```\n$ systemd-run -p Type=notify --unit=bitcoind-test ./src/bitcoind -startupnotify='systemd-notify --",https://github.com/bitcoin/bitcoin/pull/15367#issuecomment-666629678,666629678,
jonatack,2020-08-17T18:14:45Z,Concept ACK,https://github.com/bitcoin/bitcoin/pull/15367#issuecomment-675033878,675033878,
MarcoFalke,2020-08-26T18:08:20Z,Concept ACK ,https://github.com/bitcoin/bitcoin/pull/15367#issuecomment-681038926,681038926,
benthecarman,2020-08-27T05:53:47Z,"Rebased and added `#if HAVE_SYSTEM` around the config option and function definition, similar to the other notify options",https://github.com/bitcoin/bitcoin/pull/15367#issuecomment-681574380,681574380,
benthecarman,2020-09-28T15:39:13Z,Incorporated @MarcoFalke's suggestions,https://github.com/bitcoin/bitcoin/pull/15367#issuecomment-700104252,700104252,
MarcoFalke,2020-09-28T18:10:09Z,"re-ACK 090530cc24\n\n@dongcarl or @kristapsk would be good to get another re-ACK or so, so that this can be merged into the upcoming major release.",https://github.com/bitcoin/bitcoin/pull/15367#issuecomment-700196707,700196707,
dongcarl,2020-09-28T18:41:23Z,tACK 090530c,https://github.com/bitcoin/bitcoin/pull/15367#issuecomment-700212240,700212240,
laanwj,2020-09-28T19:34:54Z,Posthumous ACK,https://github.com/bitcoin/bitcoin/pull/15367#issuecomment-700238274,700238274,
Kixunil,2021-01-19T08:23:51Z,"Thank you all for working on this! Very helpful to me and came in pretty much exactly when needed. And thanks @dongcarl for pointers - didn't know about `systemd-notify` command.\n\nOne more tip for other readers: `systemd-notify` doesn't seem to work if launched from within a script that is executed by `startupnotify=/path/to/somescript.sh`. That's no problem `startupnotify=systemd-notify --rea",https://github.com/bitcoin/bitcoin/pull/15367#issuecomment-762681497,762681497,
Kixunil,2021-01-19T14:07:26Z,"Hmm, seems to be affecting mainnet too. :(",https://github.com/bitcoin/bitcoin/pull/15367#issuecomment-762861256,762861256,
MarcoFalke,2019-02-08T16:14:48Z,I wonder if you could move this down a few lines so it would only fire after the rpc is up. This would also open the possibility to use it in the test framework to add coverage.,https://github.com/bitcoin/bitcoin/pull/15367#discussion_r255136602,255136602,src/init.cpp
benthecarman,2019-02-08T16:22:42Z,"Yeah I wasn't entirely sure on the best place for the function call, I could move it to the end of the function. ",https://github.com/bitcoin/bitcoin/pull/15367#discussion_r255140069,255140069,src/init.cpp
luke-jr,2019-10-22T23:35:12Z,Why is this indented weird?,https://github.com/bitcoin/bitcoin/pull/15367#discussion_r337794669,337794669,src/init.cpp
luke-jr,2019-10-22T23:40:46Z,`false` is wrong here too,https://github.com/bitcoin/bitcoin/pull/15367#discussion_r337795955,337795955,src/init.cpp
benthecarman,2019-10-23T01:59:34Z,Fixed.,https://github.com/bitcoin/bitcoin/pull/15367#discussion_r337820928,337820928,src/init.cpp
MarcoFalke,2020-09-28T07:23:43Z,"style-nit: \n```suggestion\n  sequence. (#15367)\n```",https://github.com/bitcoin/bitcoin/pull/15367#discussion_r495737110,495737110,doc/release-notes-15367.md
MarcoFalke,2020-09-28T07:25:42Z,"style-nit: Could pass in the argsmanager to avoid referencing the global?\n\n```suggestion\n    std::string cmd = args.GetArg(""-startupnotify"", """");\n```",https://github.com/bitcoin/bitcoin/pull/15367#discussion_r495738052,495738052,src/init.cpp
benthecarman,2020-09-28T15:51:14Z,Done,https://github.com/bitcoin/bitcoin/pull/15367#discussion_r496056463,496056463,src/init.cpp
benthecarman,2020-09-28T15:51:19Z,Done,https://github.com/bitcoin/bitcoin/pull/15367#discussion_r496056524,496056524,doc/release-notes-15367.md
