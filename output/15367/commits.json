[
  {
    "sha": "090530cc24054d6b4658752bb88f75a3b73eab5d",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzowOTA1MzBjYzI0MDU0ZDZiNDY1ODc1MmJiODhmNzVhM2I3M2VhYjVk",
    "commit": {
      "author": {
        "name": "Ben Carman",
        "email": "benthecarman@live.com",
        "date": "2020-09-28T15:38:36Z"
      },
      "committer": {
        "name": "Ben Carman",
        "email": "benthecarman@live.com",
        "date": "2020-09-28T15:38:36Z"
      },
      "message": "feature: Added ability for users to add a startup command",
      "tree": {
        "sha": "c89f951712e3e27ab495b9f285ce0ccb63f6ea4f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c89f951712e3e27ab495b9f285ce0ccb63f6ea4f"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/090530cc24054d6b4658752bb88f75a3b73eab5d",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEECtg4d8HwzR7pvWYK18x3C4H9IqgFAl9yA3wACgkQ18x3C4H9\nIqgsBgwApnfXRm1OsT7joxkRTVFaYfTnD7rSBd0meX8aqjPeY60SzYIBdBJ3O4SY\n/17V/8Oa2Mo5W/z2a8PjOSKmoGncufHfMM7gmJ85tHQphvHj6JpF3TX7Jhsamur8\nK02WPiEMlsM7G43CcgGKnPDEUYxSYIfuVDuaJfaUe9uBCtGAjDLV8JMNJgqtxZ8A\n5dCwDZ8k0vOto8mkaKmKYHMCkZ4+nmaTDwUIk9r5CevszyZHZQkv1Tx9TWBw5Yz3\nAuKOw0sn9Q/+ZSn8pcEDLZQBALbPkYRkfD54H6oDFMVNI8xYNScEsA+BZfKi0i2N\nBtioPnS1Zi7F1SD/hOwDLfFns/5fGfiVZYgFaopqZLXTlDbzK0dFNzykJ+mjtAym\nJwbsdNihHldEiJrUWBXIbL+YOCa7LGyclOTu/UPOSNVRuvZJvDgDBCIjTfu/SH03\nj0z4QwH1IpIFKmvoqLMGyHDafJqSIEJg4deLap4QsiSmr1a41Dw3L9/l8czh44mT\ngqQPcnTQ\n=ITZq\n-----END PGP SIGNATURE-----",
        "payload": "tree c89f951712e3e27ab495b9f285ce0ccb63f6ea4f\nparent 30568d3f1e238f6900265914c2d449adcc355c66\nauthor Ben Carman <benthecarman@live.com> 1601307516 -0500\ncommitter Ben Carman <benthecarman@live.com> 1601307516 -0500\n\nfeature: Added ability for users to add a startup command\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/090530cc24054d6b4658752bb88f75a3b73eab5d",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/090530cc24054d6b4658752bb88f75a3b73eab5d",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/090530cc24054d6b4658752bb88f75a3b73eab5d/comments",
    "author": {
      "login": "benthecarman",
      "id": 15256660,
      "node_id": "MDQ6VXNlcjE1MjU2NjYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/15256660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/benthecarman",
      "html_url": "https://github.com/benthecarman",
      "followers_url": "https://api.github.com/users/benthecarman/followers",
      "following_url": "https://api.github.com/users/benthecarman/following{/other_user}",
      "gists_url": "https://api.github.com/users/benthecarman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/benthecarman/subscriptions",
      "organizations_url": "https://api.github.com/users/benthecarman/orgs",
      "repos_url": "https://api.github.com/users/benthecarman/repos",
      "events_url": "https://api.github.com/users/benthecarman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/benthecarman/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "benthecarman",
      "id": 15256660,
      "node_id": "MDQ6VXNlcjE1MjU2NjYw",
      "avatar_url": "https://avatars.githubusercontent.com/u/15256660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/benthecarman",
      "html_url": "https://github.com/benthecarman",
      "followers_url": "https://api.github.com/users/benthecarman/followers",
      "following_url": "https://api.github.com/users/benthecarman/following{/other_user}",
      "gists_url": "https://api.github.com/users/benthecarman/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/benthecarman/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/benthecarman/subscriptions",
      "organizations_url": "https://api.github.com/users/benthecarman/orgs",
      "repos_url": "https://api.github.com/users/benthecarman/repos",
      "events_url": "https://api.github.com/users/benthecarman/events{/privacy}",
      "received_events_url": "https://api.github.com/users/benthecarman/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "30568d3f1e238f6900265914c2d449adcc355c66",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/30568d3f1e238f6900265914c2d449adcc355c66",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/30568d3f1e238f6900265914c2d449adcc355c66"
      }
    ],
    "stats": {
      "total": 24,
      "additions": 24,
      "deletions": 0
    },
    "files": [
      {
        "sha": "598e49dcae53c09c7afc2c8b4f8a3e68e0c15017",
        "filename": "doc/release-notes-15367.md",
        "status": "added",
        "additions": 6,
        "deletions": 0,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/090530cc24054d6b4658752bb88f75a3b73eab5d/doc/release-notes-15367.md",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/090530cc24054d6b4658752bb88f75a3b73eab5d/doc/release-notes-15367.md",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/doc/release-notes-15367.md?ref=090530cc24054d6b4658752bb88f75a3b73eab5d",
        "patch": "@@ -0,0 +1,6 @@\n+Configuration option changes\n+----------------------------\n+\n+- The `startupnotify` option is used to specify a command to\n+  execute when Bitcoin Core has finished with its startup\n+  sequence. (#15367)\n\\ No newline at end of file"
      },
      {
        "sha": "08075f87c8dfe65180ef85fde5907715ed51a22c",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 18,
        "deletions": 0,
        "changes": 18,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/090530cc24054d6b4658752bb88f75a3b73eab5d/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/090530cc24054d6b4658752bb88f75a3b73eab5d/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=090530cc24054d6b4658752bb88f75a3b73eab5d",
        "patch": "@@ -422,6 +422,9 @@ void SetupServerArgs(NodeContext& node)\n     argsman.AddArg(\"-reindex\", \"Rebuild chain state and block index from the blk*.dat files on disk\", ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n     argsman.AddArg(\"-reindex-chainstate\", \"Rebuild chain state from the currently indexed blocks. When in pruning mode or if blocks on disk might be corrupted, use full -reindex instead.\", ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n     argsman.AddArg(\"-settings=<file>\", strprintf(\"Specify path to dynamic settings data file. Can be disabled with -nosettings. File is written at runtime and not meant to be edited by users (use %s instead for custom settings). Relative paths will be prefixed by datadir location. (default: %s)\", BITCOIN_CONF_FILENAME, BITCOIN_SETTINGS_FILENAME), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n+#if HAVE_SYSTEM\n+    argsman.AddArg(\"-startupnotify=<cmd>\", \"Execute command on startup.\", ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n+#endif\n #ifndef WIN32\n     argsman.AddArg(\"-sysperms\", \"Create new files with system default permissions, instead of umask 077 (only effective with disabled wallet functionality)\", ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n #else\n@@ -670,6 +673,17 @@ static void CleanupBlockRevFiles()\n     }\n }\n \n+#if HAVE_SYSTEM\n+static void StartupNotify(const ArgsManager& args)\n+{\n+    std::string cmd = args.GetArg(\"-startupnotify\", \"\");\n+    if (!cmd.empty()) {\n+        std::thread t(runCommand, cmd);\n+        t.detach(); // thread runs free\n+    }\n+}\n+#endif\n+\n static void ThreadImport(ChainstateManager& chainman, std::vector<fs::path> vImportFiles, const ArgsManager& args)\n {\n     const CChainParams& chainparams = Params();\n@@ -1969,5 +1983,9 @@ bool AppInitMain(const util::Ref& context, NodeContext& node, interfaces::BlockA\n         banman->DumpBanlist();\n     }, DUMP_BANS_INTERVAL);\n \n+#if HAVE_SYSTEM\n+    StartupNotify(args);\n+#endif\n+\n     return true;\n }"
      }
    ]
  }
]