[
  {
    "sha": "820d31f95fb6b886b38dab5d378825bea7edd49e",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4MjBkMzFmOTVmYjZiODg2YjM4ZGFiNWQzNzg4MjViZWE3ZWRkNDll",
    "commit": {
      "author": {
        "name": "dexX7",
        "email": "dexx@bitwatch.co",
        "date": "2018-03-13T10:46:22Z"
      },
      "committer": {
        "name": "dexX7",
        "email": "dexx@bitwatch.co",
        "date": "2018-04-25T17:25:34Z"
      },
      "message": "Add \"bip125-replaceable\" flag to mempool RPCs\n\nThis affects getrawmempool, getmempoolentry, getmempoolancestors and getmempooldescendants.",
      "tree": {
        "sha": "a96a01ec57723420e7367177b3f3aac433328191",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a96a01ec57723420e7367177b3f3aac433328191"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/820d31f95fb6b886b38dab5d378825bea7edd49e",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1\n\niQIcBAABAgAGBQJa4LoPAAoJEHZ14xz1cZgyUGIP/1mDH4waQ2uzBrKZAgGhbcl8\nb9Q7NbgVML6gESaifY3eycwY3mS+wBpHZWdKUxGRaoLOKGWGXmQmb8dZJarMg4Xt\nW7/MdCTdhsesMGgD7o3+6egbPN7jI+I9HvgJ0Fop6DRZiSmU6Ri5pn09Rvw7cs0A\nOkoMF3+EvLSbBqdyVwRaUKuH/redQBhc8vOpCOulpjs6P9XQqTXYB8JQu4aW2Vmk\njXiqNvKS2YNNx0FeKTQHHeHeXAPZow7ngFsf9Jt5pbInEjH2mGRrw3PqpuuXRbCy\n5li1xON6WPj+SSj5Mht0wSxTgiJ9yjaL7UApfl2gX4Y6fcdDM17AkAawhLUW0bD6\n8pSCDiWgluVwKeo/TbWz3EoVjFT3a4NspzDnym4MVvuoZoskbUpboGoLmKqw0WG2\nHa1NCx8G7v6l5vvHS+gReAsmMUofBe3KqsFJ8/RUWtfDqwpFXDpAh9l4dT8KDDxs\nAzG4JCPrsGsCzksFRjDb/bUrJ2UJxw7qEmhcW4SM2OuMn4KLjWSe172DdCB1gn8q\nPchfMN5UQ+dF5XnPL5/FwZ4X/HbfwvT5cvoQtLPBTQpXF9ri0RKi/hCBr/CBTcBg\nWd9uY4ITOsDWZe3EA46MAh3jtItW00clKpEwiadKJ/b1bnJf/UnoSFIU9IUHodbs\nBFnEQ7ctS1j145vFSsDU\n=va63\n-----END PGP SIGNATURE-----",
        "payload": "tree a96a01ec57723420e7367177b3f3aac433328191\nparent a785bc3667d3c11a014da77436a23b1b865458a4\nauthor dexX7 <dexx@bitwatch.co> 1520937982 +0100\ncommitter dexX7 <dexx@bitwatch.co> 1524677134 +0200\n\nAdd \"bip125-replaceable\" flag to mempool RPCs\n\nThis affects getrawmempool, getmempoolentry, getmempoolancestors and getmempooldescendants.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/820d31f95fb6b886b38dab5d378825bea7edd49e",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/820d31f95fb6b886b38dab5d378825bea7edd49e",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/820d31f95fb6b886b38dab5d378825bea7edd49e/comments",
    "author": {
      "login": "dexX7",
      "id": 5836089,
      "node_id": "MDQ6VXNlcjU4MzYwODk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5836089?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dexX7",
      "html_url": "https://github.com/dexX7",
      "followers_url": "https://api.github.com/users/dexX7/followers",
      "following_url": "https://api.github.com/users/dexX7/following{/other_user}",
      "gists_url": "https://api.github.com/users/dexX7/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dexX7/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dexX7/subscriptions",
      "organizations_url": "https://api.github.com/users/dexX7/orgs",
      "repos_url": "https://api.github.com/users/dexX7/repos",
      "events_url": "https://api.github.com/users/dexX7/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dexX7/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "dexX7",
      "id": 5836089,
      "node_id": "MDQ6VXNlcjU4MzYwODk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5836089?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dexX7",
      "html_url": "https://github.com/dexX7",
      "followers_url": "https://api.github.com/users/dexX7/followers",
      "following_url": "https://api.github.com/users/dexX7/following{/other_user}",
      "gists_url": "https://api.github.com/users/dexX7/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dexX7/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dexX7/subscriptions",
      "organizations_url": "https://api.github.com/users/dexX7/orgs",
      "repos_url": "https://api.github.com/users/dexX7/repos",
      "events_url": "https://api.github.com/users/dexX7/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dexX7/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "a785bc3667d3c11a014da77436a23b1b865458a4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a785bc3667d3c11a014da77436a23b1b865458a4",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/a785bc3667d3c11a014da77436a23b1b865458a4"
      }
    ],
    "stats": {
      "total": 15,
      "additions": 14,
      "deletions": 1
    },
    "files": [
      {
        "sha": "a26b8f3b45701f5b4f4668ba2eadf6ec946349ff",
        "filename": "src/rpc/blockchain.cpp",
        "status": "modified",
        "additions": 14,
        "deletions": 1,
        "changes": 15,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/820d31f95fb6b886b38dab5d378825bea7edd49e/src/rpc/blockchain.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/820d31f95fb6b886b38dab5d378825bea7edd49e/src/rpc/blockchain.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/blockchain.cpp?ref=820d31f95fb6b886b38dab5d378825bea7edd49e",
        "patch": "@@ -15,6 +15,7 @@\n #include <core_io.h>\n #include <policy/feerate.h>\n #include <policy/policy.h>\n+#include <policy/rbf.h>\n #include <primitives/transaction.h>\n #include <rpc/server.h>\n #include <streams.h>\n@@ -376,7 +377,8 @@ std::string EntryDescriptionString()\n            \"       ... ]\\n\"\n            \"    \\\"spentby\\\" : [           (array) unconfirmed transactions spending outputs from this transaction\\n\"\n            \"        \\\"transactionid\\\",    (string) child transaction id\\n\"\n-           \"       ... ]\\n\";\n+           \"       ... ]\\n\"\n+           \"    \\\"bip125-replaceable\\\" : true|false,  (boolean) Whether this transaction could be replaced due to BIP125 (replace-by-fee)\\n\";\n }\n \n void entryToJSON(UniValue &info, const CTxMemPoolEntry &e)\n@@ -419,6 +421,17 @@ void entryToJSON(UniValue &info, const CTxMemPoolEntry &e)\n     }\n \n     info.pushKV(\"spentby\", spent);\n+\n+    // Add opt-in RBF status\n+    bool rbfStatus = false;\n+    RBFTransactionState rbfState = IsRBFOptIn(tx, mempool);\n+    if (rbfState == RBFTransactionState::UNKNOWN) {\n+        throw JSONRPCError(RPC_MISC_ERROR, \"Transaction is not in mempool\");\n+    } else if (rbfState == RBFTransactionState::REPLACEABLE_BIP125) {\n+        rbfStatus = true;\n+    }\n+\n+    info.pushKV(\"bip125-replaceable\", rbfStatus);\n }\n \n UniValue mempoolToJSON(bool fVerbose)"
      }
    ]
  },
  {
    "sha": "870bd4c73ddf494dc23c658bf0fb672ee0109158",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4NzBiZDRjNzNkZGY0OTRkYzIzYzY1OGJmMGZiNjcyZWUwMTA5MTU4",
    "commit": {
      "author": {
        "name": "dexX7",
        "email": "dexx@bitwatch.co",
        "date": "2018-03-13T11:03:49Z"
      },
      "committer": {
        "name": "dexX7",
        "email": "dexx@bitwatch.co",
        "date": "2018-05-22T06:23:02Z"
      },
      "message": "Update functional RBF test to check replaceable flag",
      "tree": {
        "sha": "f709f3c38d00ae6c3adcf933ecea77bebde7b2be",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f709f3c38d00ae6c3adcf933ecea77bebde7b2be"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/870bd4c73ddf494dc23c658bf0fb672ee0109158",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1\n\niQIcBAABAgAGBQJbA7dGAAoJEHZ14xz1cZgy074P/1GXZlGqVoCXIxUSSmGs2UZT\nh0axvG10XnxQPqdpngFxZ/xatrVBRKdH5W1Pcfjyd2b0PnaguUDlP/zksEQgk0Tn\nRxXGYGpnZoNRVL3ZF3gLtuXZ1YQckwgKcRf+ApjIfsxUqFsK1/w1hHUclEt7OMf0\n4dCE6+KtyrDpJF79hKH0TtdzoCcYyMf2mSH28xUuxsy++lVqzfNUZboPJKr1ej+r\njKeIRp+gc23O4JrKLe5GIgDrnDcqITffcoxOJX3976F3ykYL5XMUgKD/jDI7HZc1\nU0El32DdDKFZkxcriGqfGosN1BuGHFfD8Lv+D9VjaNWCKmvkE8cOctALTtOEJ3xQ\n4R/4/U6wJCYITTA64+b+6zu9C5VHOnbzOWC69snmVZOHdV5pcp6ZDvsexREjCHC0\nb8tfZ/jDTildSU1b4R177FBvl0JFoC2/XTP24Txp+yfOg6JWT5a3WSootTNs1D5P\ncsbXIrZkGbZI9ds8jPZDo+I1pawY4agucmgy8Lpe0dh04H72z3FROV6/ubUbIC+O\nNT1hLKnns1F/wNfnJzonw0mOahRQXQZfEx5k02aVeGQ71D5oJYsza4/yZZ0MAZUs\n7EUJi0nL+m5mV2acoT02aFN///dJYum7243ecE8hCuD6t9Ax2jXIj0mXKjn96TX5\nFu8sVKV57zm2KZGgFOU4\n=2hCL\n-----END PGP SIGNATURE-----",
        "payload": "tree f709f3c38d00ae6c3adcf933ecea77bebde7b2be\nparent 820d31f95fb6b886b38dab5d378825bea7edd49e\nauthor dexX7 <dexx@bitwatch.co> 1520939029 +0100\ncommitter dexX7 <dexx@bitwatch.co> 1526970182 +0200\n\nUpdate functional RBF test to check replaceable flag\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/870bd4c73ddf494dc23c658bf0fb672ee0109158",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/870bd4c73ddf494dc23c658bf0fb672ee0109158",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/870bd4c73ddf494dc23c658bf0fb672ee0109158/comments",
    "author": {
      "login": "dexX7",
      "id": 5836089,
      "node_id": "MDQ6VXNlcjU4MzYwODk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5836089?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dexX7",
      "html_url": "https://github.com/dexX7",
      "followers_url": "https://api.github.com/users/dexX7/followers",
      "following_url": "https://api.github.com/users/dexX7/following{/other_user}",
      "gists_url": "https://api.github.com/users/dexX7/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dexX7/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dexX7/subscriptions",
      "organizations_url": "https://api.github.com/users/dexX7/orgs",
      "repos_url": "https://api.github.com/users/dexX7/repos",
      "events_url": "https://api.github.com/users/dexX7/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dexX7/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "dexX7",
      "id": 5836089,
      "node_id": "MDQ6VXNlcjU4MzYwODk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5836089?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dexX7",
      "html_url": "https://github.com/dexX7",
      "followers_url": "https://api.github.com/users/dexX7/followers",
      "following_url": "https://api.github.com/users/dexX7/following{/other_user}",
      "gists_url": "https://api.github.com/users/dexX7/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dexX7/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dexX7/subscriptions",
      "organizations_url": "https://api.github.com/users/dexX7/orgs",
      "repos_url": "https://api.github.com/users/dexX7/repos",
      "events_url": "https://api.github.com/users/dexX7/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dexX7/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "820d31f95fb6b886b38dab5d378825bea7edd49e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/820d31f95fb6b886b38dab5d378825bea7edd49e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/820d31f95fb6b886b38dab5d378825bea7edd49e"
      }
    ],
    "stats": {
      "total": 8,
      "additions": 7,
      "deletions": 1
    },
    "files": [
      {
        "sha": "a9bcb8483cf32ec89e4bdc5c7148f761b84d621c",
        "filename": "test/functional/feature_rbf.py",
        "status": "modified",
        "additions": 7,
        "deletions": 1,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/870bd4c73ddf494dc23c658bf0fb672ee0109158/test/functional/feature_rbf.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/870bd4c73ddf494dc23c658bf0fb672ee0109158/test/functional/feature_rbf.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/feature_rbf.py?ref=870bd4c73ddf494dc23c658bf0fb672ee0109158",
        "patch": "@@ -427,6 +427,9 @@ def test_opt_in(self):\n         tx1a_hex = txToHex(tx1a)\n         tx1a_txid = self.nodes[0].sendrawtransaction(tx1a_hex, True)\n \n+        # This transaction isn't shown as replaceable\n+        assert_equal(self.nodes[0].getmempoolentry(tx1a_txid)['bip125-replaceable'], False)\n+\n         # Shouldn't be able to double-spend\n         tx1b = CTransaction()\n         tx1b.vin = [CTxIn(tx0_outpoint, nSequence=0)]\n@@ -467,7 +470,10 @@ def test_opt_in(self):\n         tx3a.vout = [CTxOut(int(0.9*COIN), CScript([b'c'])), CTxOut(int(0.9*COIN), CScript([b'd']))]\n         tx3a_hex = txToHex(tx3a)\n \n-        self.nodes[0].sendrawtransaction(tx3a_hex, True)\n+        tx3a_txid = self.nodes[0].sendrawtransaction(tx3a_hex, True)\n+\n+        # This transaction is shown as replaceable\n+        assert_equal(self.nodes[0].getmempoolentry(tx3a_txid)['bip125-replaceable'], True)\n \n         tx3b = CTransaction()\n         tx3b.vin = [CTxIn(COutPoint(tx1a_txid, 0), nSequence=0)]"
      }
    ]
  }
]