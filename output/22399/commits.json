[
  {
    "sha": "fa40c0964b751683774b79da4b72d330a9ff87e2",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYTQwYzA5NjRiNzUxNjgzNzc0Yjc5ZGE0YjcyZDMzMGE5ZmY4N2Uy",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-07-04T12:22:36Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-07-04T19:28:04Z"
      },
      "message": "fuzz: Move ConsumeTxDestination to cpp file\n\nMoving the implementation out of the header will reduce compile time",
      "tree": {
        "sha": "a2f0629712f7bc115a4317f09bd896f420bcfd05",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a2f0629712f7bc115a4317f09bd896f420bcfd05"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa40c0964b751683774b79da4b72d330a9ff87e2",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUhZPQwApsF5b0HdIeKrCa79GVmqO0sgwq0xq4i+ytlmOjwqFMPvVZL1Efpiye0D\n+w9nirT4Coa5su6sfy0rheeo7PR1kmibSvWrZQBhtSYsg+NZ55iEVCtVksFsnvOZ\nb4rI7nONEjEVYrKbbYXhkActzGA7urJ0yoZFjDp4cSp/FjQgMEKZVBXUogfEU1Xz\nKkhzmWSNgMZMJJroRwmjUvgBUYv2wdNTRy20IPUr69UKQfj1nMr7cwbxai5lYklH\ntQfmrF9CgohNdUyNe0MT/lV+Bn2bJnjL75KhIYcSQKylOLgPdxB+9jUt1z3dDxjY\nZOJ6Ht5//6nXeO6RLKHFtQfVelnw4F8XdE/XickOxNJZp5bLYBL6BmMD2IjqAArw\nX2+chSAhv1cwqHOJyZjJR64LYSP+TfoReBzCSzkzh3bovBfHK5+2s1SecEd5RxH0\nILXiKnyqCYySsipgkKEkUXEr1yAjEip+pluLLTXx+etm4zG6aiR3nX05pDVMJmYD\n6TbQ9z8J\n=HFIL\n-----END PGP SIGNATURE-----",
        "payload": "tree a2f0629712f7bc115a4317f09bd896f420bcfd05\nparent 7a49fdc58115845ece3a9890bf9498bee6b559de\nauthor MarcoFalke <falke.marco@gmail.com> 1625401356 +0200\ncommitter MarcoFalke <falke.marco@gmail.com> 1625426884 +0200\n\nfuzz: Move ConsumeTxDestination to cpp file\n\nMoving the implementation out of the header will reduce compile time\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa40c0964b751683774b79da4b72d330a9ff87e2",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fa40c0964b751683774b79da4b72d330a9ff87e2",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa40c0964b751683774b79da4b72d330a9ff87e2/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "7a49fdc58115845ece3a9890bf9498bee6b559de",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7a49fdc58115845ece3a9890bf9498bee6b559de",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/7a49fdc58115845ece3a9890bf9498bee6b559de"
      }
    ],
    "stats": {
      "total": 62,
      "additions": 32,
      "deletions": 30
    },
    "files": [
      {
        "sha": "a71b7e32fdbbd205499b68090972c67c99341014",
        "filename": "src/test/fuzz/util.cpp",
        "status": "modified",
        "additions": 31,
        "deletions": 0,
        "changes": 31,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa40c0964b751683774b79da4b72d330a9ff87e2/src/test/fuzz/util.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa40c0964b751683774b79da4b72d330a9ff87e2/src/test/fuzz/util.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/util.cpp?ref=fa40c0964b751683774b79da4b72d330a9ff87e2",
        "patch": "@@ -304,3 +304,34 @@ uint32_t ConsumeSequence(FuzzedDataProvider& fuzzed_data_provider) noexcept\n                }) :\n                fuzzed_data_provider.ConsumeIntegral<uint32_t>();\n }\n+\n+CTxDestination ConsumeTxDestination(FuzzedDataProvider& fuzzed_data_provider) noexcept\n+{\n+    CTxDestination tx_destination;\n+    CallOneOf(\n+        fuzzed_data_provider,\n+        [&] {\n+            tx_destination = CNoDestination{};\n+        },\n+        [&] {\n+            tx_destination = PKHash{ConsumeUInt160(fuzzed_data_provider)};\n+        },\n+        [&] {\n+            tx_destination = ScriptHash{ConsumeUInt160(fuzzed_data_provider)};\n+        },\n+        [&] {\n+            tx_destination = WitnessV0ScriptHash{ConsumeUInt256(fuzzed_data_provider)};\n+        },\n+        [&] {\n+            tx_destination = WitnessV0KeyHash{ConsumeUInt160(fuzzed_data_provider)};\n+        },\n+        [&] {\n+            WitnessUnknown witness_unknown{};\n+            witness_unknown.version = fuzzed_data_provider.ConsumeIntegral<uint32_t>();\n+            const std::vector<uint8_t> witness_unknown_program_1 = fuzzed_data_provider.ConsumeBytes<uint8_t>(40);\n+            witness_unknown.length = witness_unknown_program_1.size();\n+            std::copy(witness_unknown_program_1.begin(), witness_unknown_program_1.end(), witness_unknown.program);\n+            tx_destination = witness_unknown;\n+        });\n+    return tx_destination;\n+}"
      },
      {
        "sha": "60dc9050fee5308ae830d6c7c4a17a00cde32367",
        "filename": "src/test/fuzz/util.h",
        "status": "modified",
        "additions": 1,
        "deletions": 30,
        "changes": 31,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa40c0964b751683774b79da4b72d330a9ff87e2/src/test/fuzz/util.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa40c0964b751683774b79da4b72d330a9ff87e2/src/test/fuzz/util.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/util.h?ref=fa40c0964b751683774b79da4b72d330a9ff87e2",
        "patch": "@@ -178,36 +178,7 @@ template <typename WeakEnumType, size_t size>\n     return CTxMemPoolEntry{MakeTransactionRef(tx), fee, time, entry_height, spends_coinbase, sig_op_cost, {}};\n }\n \n-[[nodiscard]] inline CTxDestination ConsumeTxDestination(FuzzedDataProvider& fuzzed_data_provider) noexcept\n-{\n-    CTxDestination tx_destination;\n-    CallOneOf(\n-        fuzzed_data_provider,\n-        [&] {\n-            tx_destination = CNoDestination{};\n-        },\n-        [&] {\n-            tx_destination = PKHash{ConsumeUInt160(fuzzed_data_provider)};\n-        },\n-        [&] {\n-            tx_destination = ScriptHash{ConsumeUInt160(fuzzed_data_provider)};\n-        },\n-        [&] {\n-            tx_destination = WitnessV0ScriptHash{ConsumeUInt256(fuzzed_data_provider)};\n-        },\n-        [&] {\n-            tx_destination = WitnessV0KeyHash{ConsumeUInt160(fuzzed_data_provider)};\n-        },\n-        [&] {\n-            WitnessUnknown witness_unknown{};\n-            witness_unknown.version = fuzzed_data_provider.ConsumeIntegral<uint32_t>();\n-            const std::vector<uint8_t> witness_unknown_program_1 = fuzzed_data_provider.ConsumeBytes<uint8_t>(40);\n-            witness_unknown.length = witness_unknown_program_1.size();\n-            std::copy(witness_unknown_program_1.begin(), witness_unknown_program_1.end(), witness_unknown.program);\n-            tx_destination = witness_unknown;\n-        });\n-    return tx_destination;\n-}\n+[[nodiscard]] CTxDestination ConsumeTxDestination(FuzzedDataProvider& fuzzed_data_provider) noexcept;\n \n template <typename T>\n [[nodiscard]] bool MultiplicationOverflow(const T i, const T j) noexcept"
      }
    ]
  },
  {
    "sha": "fab99865c0e62468a1b55d7e467398cc2343121b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYWI5OTg2NWMwZTYyNDY4YTFiNTVkN2U0NjczOThjYzIzNDMxMjFi",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-07-04T14:38:51Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-07-04T19:28:35Z"
      },
      "message": "fuzz: Improve ConsumeTxDestination\n\n* Assert when a type is missing\n* Add missing WitnessV1Taproot\n* Limit WitnessUnknown to version [2, 16], to avoid abiguity\n* Limit WitnessUnknown to size [2, 40], to avoid invalid sizes",
      "tree": {
        "sha": "6e598c5e9b8c18109a50ba927360ede4beba7da9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6e598c5e9b8c18109a50ba927360ede4beba7da9"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fab99865c0e62468a1b55d7e467398cc2343121b",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUiWtQv+II4GqUvChW7PLdCG1Un0UeYn+SvKpbx8rLhzb193ISj6IhJ6zIStWffd\nd06Mb9EzyMM2kFXN10v6zpJsHc1FnBBTPk12yphqVZUzLq0LmxfuwE8Vc7xIzPc4\nBfjPIGt/R1pcBA3xbXVbbllYMw7qKxQm24/td6O5k8xjv4LZqZ0xQSAdL5WewOBv\n+U7SjmlqB4nvNtQRDS3THLQahzimgvQhKRNNrogduQ4tUa8Wbb024hY3kC/QKpAK\nxV9tQrkT0F5izOpA4En3/talFMKgfrtYxJyl0SSTbvOzuAoIIa3LOfyw+MsO54rr\nt5rgPo+8Qt9WZ1spH6lizUv8SR+97as7HQ3lTH0+WKXD19V/HlX/8rNMYCF4a3WS\n3071Cs23rmzlaso0X46bWC2Sgt9ml9P/ODWq6Jn6/YbfwnLgvVOVhny8Bl5cIQEK\nDUrcHysvORg+Kwccj8u2uJBgrLAreoK3/o/gK7ntB3oQdQoZAyEA3KDz7m8Ob7ES\nCsCB1amb\n=67iY\n-----END PGP SIGNATURE-----",
        "payload": "tree 6e598c5e9b8c18109a50ba927360ede4beba7da9\nparent fa40c0964b751683774b79da4b72d330a9ff87e2\nauthor MarcoFalke <falke.marco@gmail.com> 1625409531 +0200\ncommitter MarcoFalke <falke.marco@gmail.com> 1625426915 +0200\n\nfuzz: Improve ConsumeTxDestination\n\n* Assert when a type is missing\n* Add missing WitnessV1Taproot\n* Limit WitnessUnknown to version [2, 16], to avoid abiguity\n* Limit WitnessUnknown to size [2, 40], to avoid invalid sizes\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fab99865c0e62468a1b55d7e467398cc2343121b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fab99865c0e62468a1b55d7e467398cc2343121b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fab99865c0e62468a1b55d7e467398cc2343121b/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fa40c0964b751683774b79da4b72d330a9ff87e2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa40c0964b751683774b79da4b72d330a9ff87e2",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fa40c0964b751683774b79da4b72d330a9ff87e2"
      }
    ],
    "stats": {
      "total": 19,
      "additions": 14,
      "deletions": 5
    },
    "files": [
      {
        "sha": "ece3214ed5fcbc2ebae4ec59c48917ae20f29f10",
        "filename": "src/test/fuzz/util.cpp",
        "status": "modified",
        "additions": 12,
        "deletions": 4,
        "changes": 16,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fab99865c0e62468a1b55d7e467398cc2343121b/src/test/fuzz/util.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fab99865c0e62468a1b55d7e467398cc2343121b/src/test/fuzz/util.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/util.cpp?ref=fab99865c0e62468a1b55d7e467398cc2343121b",
        "patch": "@@ -2,6 +2,7 @@\n // Distributed under the MIT software license, see the accompanying\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n+#include <pubkey.h>\n #include <test/fuzz/util.h>\n #include <test/util/script.h>\n #include <util/rbf.h>\n@@ -308,7 +309,7 @@ uint32_t ConsumeSequence(FuzzedDataProvider& fuzzed_data_provider) noexcept\n CTxDestination ConsumeTxDestination(FuzzedDataProvider& fuzzed_data_provider) noexcept\n {\n     CTxDestination tx_destination;\n-    CallOneOf(\n+    const size_t call_size{CallOneOf(\n         fuzzed_data_provider,\n         [&] {\n             tx_destination = CNoDestination{};\n@@ -325,13 +326,20 @@ CTxDestination ConsumeTxDestination(FuzzedDataProvider& fuzzed_data_provider) no\n         [&] {\n             tx_destination = WitnessV0KeyHash{ConsumeUInt160(fuzzed_data_provider)};\n         },\n+        [&] {\n+            tx_destination = WitnessV1Taproot{XOnlyPubKey{ConsumeUInt256(fuzzed_data_provider)}};\n+        },\n         [&] {\n             WitnessUnknown witness_unknown{};\n-            witness_unknown.version = fuzzed_data_provider.ConsumeIntegral<uint32_t>();\n-            const std::vector<uint8_t> witness_unknown_program_1 = fuzzed_data_provider.ConsumeBytes<uint8_t>(40);\n+            witness_unknown.version = fuzzed_data_provider.ConsumeIntegralInRange(2, 16);\n+            std::vector<uint8_t> witness_unknown_program_1{fuzzed_data_provider.ConsumeBytes<uint8_t>(40)};\n+            if (witness_unknown_program_1.size() < 2) {\n+                witness_unknown_program_1 = {0, 0};\n+            }\n             witness_unknown.length = witness_unknown_program_1.size();\n             std::copy(witness_unknown_program_1.begin(), witness_unknown_program_1.end(), witness_unknown.program);\n             tx_destination = witness_unknown;\n-        });\n+        })};\n+    Assert(call_size == std::variant_size_v<CTxDestination>);\n     return tx_destination;\n }"
      },
      {
        "sha": "9f09395a9a1d5b1b8a0ea32f81af0ce80d4de326",
        "filename": "src/test/fuzz/util.h",
        "status": "modified",
        "additions": 2,
        "deletions": 1,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fab99865c0e62468a1b55d7e467398cc2343121b/src/test/fuzz/util.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fab99865c0e62468a1b55d7e467398cc2343121b/src/test/fuzz/util.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/util.h?ref=fab99865c0e62468a1b55d7e467398cc2343121b",
        "patch": "@@ -37,14 +37,15 @@\n #include <vector>\n \n template <typename... Callables>\n-void CallOneOf(FuzzedDataProvider& fuzzed_data_provider, Callables... callables)\n+size_t CallOneOf(FuzzedDataProvider& fuzzed_data_provider, Callables... callables)\n {\n     constexpr size_t call_size{sizeof...(callables)};\n     static_assert(call_size >= 1);\n     const size_t call_index{fuzzed_data_provider.ConsumeIntegralInRange<size_t>(0, call_size - 1)};\n \n     size_t i{0};\n     ((i++ == call_index ? callables() : void()), ...);\n+    return call_size;\n }\n \n template <typename Collection>"
      }
    ]
  },
  {
    "sha": "fa42800a51919bb50a1000ac4f58847e6a7092a3",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYTQyODAwYTUxOTE5YmI1MGExMDAwYWM0ZjU4ODQ3ZTZhNzA5MmEz",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-07-04T19:18:59Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-07-04T19:29:56Z"
      },
      "message": "fuzz: Simplify CTxDestination fuzzing in the script target\n\nThe WitnessUnknown operators == and < are already called indirectly by\nthe corresponding CTxDestination operators.",
      "tree": {
        "sha": "308bc11019eb09256d466409ac4ffa0da048d276",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/308bc11019eb09256d466409ac4ffa0da048d276"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa42800a51919bb50a1000ac4f58847e6a7092a3",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUiZtQv/Z3LFp4dVIsyjbSl/OSFUmY8V/csosItp1YehSB7kWZS9TJXeOOGKDck3\nLhZ7p64APQHFdq9PA4ksNpp2R7+JRMkARfCgQguZak0VJ56naGZx8r8ld7wqGn6M\nRzZSIXfEYvNMO9/F1PEA4lmw1VReISYpyjucpKGkWjJCA3v0pen0oBCjqZN6RtpI\nvzqDju4p0dlSUQ1xjg37BKlPmbLq+woLwxgP3RNmPdNgYhhPrS961nZmHQOSNf7r\nJYgkks5CZ5SiuuQPIEx3dRWxQwnCs0J5cK97o9xgv1CZc4utu3t3vwP/nwBfKMMk\nNH5ewDnOHIk6y/lsfPLLdQiPSOn6aw5CQj2f4EsLpgN+fDOKwQdAYDjWQYAMcPDb\nU+Uc+8zdnKHM7OAxkcyvEW6EGKGClpcqX2FL5Az3ZBvDiCEzkxylIQGB30Qk3CGS\nkXvejwygtHjz7ahaE8bNXLJsEYeSRM+5eD1oDPftYjy2OVappbTOLcpKcCqYPxcr\nuzOEZJHO\n=SzuO\n-----END PGP SIGNATURE-----",
        "payload": "tree 308bc11019eb09256d466409ac4ffa0da048d276\nparent fab99865c0e62468a1b55d7e467398cc2343121b\nauthor MarcoFalke <falke.marco@gmail.com> 1625426339 +0200\ncommitter MarcoFalke <falke.marco@gmail.com> 1625426996 +0200\n\nfuzz: Simplify CTxDestination fuzzing in the script target\n\nThe WitnessUnknown operators == and < are already called indirectly by\nthe corresponding CTxDestination operators.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa42800a51919bb50a1000ac4f58847e6a7092a3",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fa42800a51919bb50a1000ac4f58847e6a7092a3",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa42800a51919bb50a1000ac4f58847e6a7092a3/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fab99865c0e62468a1b55d7e467398cc2343121b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fab99865c0e62468a1b55d7e467398cc2343121b",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fab99865c0e62468a1b55d7e467398cc2343121b"
      }
    ],
    "stats": {
      "total": 23,
      "additions": 5,
      "deletions": 18
    },
    "files": [
      {
        "sha": "1d5f37d10933b305885096bf012784feb1dfe4c0",
        "filename": "src/test/fuzz/script.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 18,
        "changes": 23,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa42800a51919bb50a1000ac4f58847e6a7092a3/src/test/fuzz/script.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa42800a51919bb50a1000ac4f58847e6a7092a3/src/test/fuzz/script.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/script.cpp?ref=fa42800a51919bb50a1000ac4f58847e6a7092a3",
        "patch": "@@ -184,25 +184,12 @@ FUZZ_TARGET_INIT(script, initialize_script)\n     }\n \n     {\n-        WitnessUnknown witness_unknown_1{};\n-        witness_unknown_1.version = fuzzed_data_provider.ConsumeIntegral<uint32_t>();\n-        const std::vector<uint8_t> witness_unknown_program_1 = fuzzed_data_provider.ConsumeBytes<uint8_t>(40);\n-        witness_unknown_1.length = witness_unknown_program_1.size();\n-        std::copy(witness_unknown_program_1.begin(), witness_unknown_program_1.end(), witness_unknown_1.program);\n-\n-        WitnessUnknown witness_unknown_2{};\n-        witness_unknown_2.version = fuzzed_data_provider.ConsumeIntegral<uint32_t>();\n-        const std::vector<uint8_t> witness_unknown_program_2 = fuzzed_data_provider.ConsumeBytes<uint8_t>(40);\n-        witness_unknown_2.length = witness_unknown_program_2.size();\n-        std::copy(witness_unknown_program_2.begin(), witness_unknown_program_2.end(), witness_unknown_2.program);\n-\n-        (void)(witness_unknown_1 == witness_unknown_2);\n-        (void)(witness_unknown_1 < witness_unknown_2);\n-    }\n-\n-    {\n-        const CTxDestination tx_destination_1 = ConsumeTxDestination(fuzzed_data_provider);\n+        const CTxDestination tx_destination_1{\n+            fuzzed_data_provider.ConsumeBool() ?\n+                DecodeDestination(fuzzed_data_provider.ConsumeRandomLengthString()) :\n+                ConsumeTxDestination(fuzzed_data_provider)};\n         const CTxDestination tx_destination_2 = ConsumeTxDestination(fuzzed_data_provider);\n+\n         (void)(tx_destination_1 == tx_destination_2);\n         (void)(tx_destination_1 < tx_destination_2);\n     }"
      }
    ]
  },
  {
    "sha": "fabf17056c1046c6ac7fa5d140125050b7a2b0e0",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYWJmMTcwNTZjMTA0NmM2YWM3ZmE1ZDE0MDEyNTA1MGI3YTJiMGUw",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-07-04T19:24:27Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-07-04T19:30:50Z"
      },
      "message": "fuzz: Move CTxDestination fuzzing to script fuzz target\n\nNo need to split it over several targets",
      "tree": {
        "sha": "57db01668b30fa7b97a43f64be95926d6e6340c0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/57db01668b30fa7b97a43f64be95926d6e6340c0"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fabf17056c1046c6ac7fa5d140125050b7a2b0e0",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUgJbgv+JVqvdzsokNtWO4JScdmf0xspNj2ebRVIDybPm4CzPHcM4n2VwXB7neo/\nd+rmEaufS69S5xiPpu/mHzrwhQMuk56LXApr0/sfTDCWU5gQ2DkmbmnWg5us1mF+\n8l09NLt8Sdcv+u6jmNReMiv6LNly73BaCzZqyio4dPalpqx+TVq+YCezzKnrxEOP\na4X7iPBRSlQ180Ck60I+7OPsTmPQbGSqpR1qNoI7axyHeq5zdPJfDGzPsdfAK9Pf\nBHl4NEenBsXOjwfY+F0zcvVbpq07+vH8kua2/CsvWsZ2jZaUg0zD6sLoYG9bwuPr\n0vYNqgo0rGhEtvYBv014Gr2/1NJMjvEkmGt2KDABav9lSv4PR8m4iySoIsJFLuTB\nudp4Tuaoko771zP+rd+xR578czem0A7wY79h+NrK1122a/dyL5Iz0zzNcQbeWmwG\n+yL3MRslLjmS5yHqcUsVug2rNcvvCcrgtSBVjg/VszUObuAcu8zR2YEkZ+I0GyBv\ntF7V9Mlk\n=jH6N\n-----END PGP SIGNATURE-----",
        "payload": "tree 57db01668b30fa7b97a43f64be95926d6e6340c0\nparent fa42800a51919bb50a1000ac4f58847e6a7092a3\nauthor MarcoFalke <falke.marco@gmail.com> 1625426667 +0200\ncommitter MarcoFalke <falke.marco@gmail.com> 1625427050 +0200\n\nfuzz: Move CTxDestination fuzzing to script fuzz target\n\nNo need to split it over several targets\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fabf17056c1046c6ac7fa5d140125050b7a2b0e0",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fabf17056c1046c6ac7fa5d140125050b7a2b0e0",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fabf17056c1046c6ac7fa5d140125050b7a2b0e0/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fa42800a51919bb50a1000ac4f58847e6a7092a3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa42800a51919bb50a1000ac4f58847e6a7092a3",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fa42800a51919bb50a1000ac4f58847e6a7092a3"
      }
    ],
    "stats": {
      "total": 46,
      "additions": 17,
      "deletions": 29
    },
    "files": [
      {
        "sha": "e28e2feb0a20c8d9c2d60fd810eefd15f45f3360",
        "filename": "src/test/fuzz/integer.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 16,
        "changes": 16,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fabf17056c1046c6ac7fa5d140125050b7a2b0e0/src/test/fuzz/integer.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fabf17056c1046c6ac7fa5d140125050b7a2b0e0/src/test/fuzz/integer.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/integer.cpp?ref=fabf17056c1046c6ac7fa5d140125050b7a2b0e0",
        "patch": "@@ -16,8 +16,6 @@\n #include <pow.h>\n #include <protocol.h>\n #include <pubkey.h>\n-#include <rpc/util.h>\n-#include <script/signingprovider.h>\n #include <script/standard.h>\n #include <serialize.h>\n #include <streams.h>\n@@ -158,20 +156,6 @@ FUZZ_TARGET_INIT(integer, initialize_integer)\n \n     const CKeyID key_id{u160};\n     const CScriptID script_id{u160};\n-    // CTxDestination = CNoDestination \u222a PKHash \u222a ScriptHash \u222a WitnessV0ScriptHash \u222a WitnessV0KeyHash \u222a WitnessUnknown\n-    const PKHash pk_hash{u160};\n-    const ScriptHash script_hash{u160};\n-    const WitnessV0KeyHash witness_v0_key_hash{u160};\n-    const WitnessV0ScriptHash witness_v0_script_hash{u256};\n-    const std::vector<CTxDestination> destinations{pk_hash, script_hash, witness_v0_key_hash, witness_v0_script_hash};\n-    const SigningProvider store;\n-    for (const CTxDestination& destination : destinations) {\n-        (void)DescribeAddress(destination);\n-        (void)EncodeDestination(destination);\n-        (void)GetKeyForDestination(store, destination);\n-        (void)GetScriptForDestination(destination);\n-        (void)IsValidDestination(destination);\n-    }\n \n     {\n         CDataStream stream(SER_NETWORK, INIT_PROTO_VERSION);"
      },
      {
        "sha": "f58bf8b316db233e205b844ab33a390a95536a69",
        "filename": "src/test/fuzz/key_io.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 11,
        "changes": 11,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fabf17056c1046c6ac7fa5d140125050b7a2b0e0/src/test/fuzz/key_io.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fabf17056c1046c6ac7fa5d140125050b7a2b0e0/src/test/fuzz/key_io.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/key_io.cpp?ref=fabf17056c1046c6ac7fa5d140125050b7a2b0e0",
        "patch": "@@ -4,9 +4,6 @@\n \n #include <chainparams.h>\n #include <key_io.h>\n-#include <rpc/util.h>\n-#include <script/signingprovider.h>\n-#include <script/standard.h>\n #include <test/fuzz/fuzz.h>\n \n #include <cassert>\n@@ -39,12 +36,4 @@ FUZZ_TARGET_INIT(key_io, initialize_key_io)\n     if (ext_pub_key.pubkey.size() == CPubKey::COMPRESSED_SIZE) {\n         assert(ext_pub_key == DecodeExtPubKey(EncodeExtPubKey(ext_pub_key)));\n     }\n-\n-    const CTxDestination tx_destination = DecodeDestination(random_string);\n-    (void)DescribeAddress(tx_destination);\n-    (void)GetKeyForDestination(/* store */ {}, tx_destination);\n-    (void)GetScriptForDestination(tx_destination);\n-    (void)IsValidDestination(tx_destination);\n-\n-    (void)IsValidDestinationString(random_string);\n }"
      },
      {
        "sha": "950ee45d1d10f63cf2b8855447f7ab50a628279a",
        "filename": "src/test/fuzz/script.cpp",
        "status": "modified",
        "additions": 17,
        "deletions": 2,
        "changes": 19,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fabf17056c1046c6ac7fa5d140125050b7a2b0e0/src/test/fuzz/script.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fabf17056c1046c6ac7fa5d140125050b7a2b0e0/src/test/fuzz/script.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/script.cpp?ref=fabf17056c1046c6ac7fa5d140125050b7a2b0e0",
        "patch": "@@ -6,8 +6,10 @@\n #include <compressor.h>\n #include <core_io.h>\n #include <core_memusage.h>\n+#include <key_io.h>\n #include <policy/policy.h>\n #include <pubkey.h>\n+#include <rpc/util.h>\n #include <script/descriptor.h>\n #include <script/interpreter.h>\n #include <script/script.h>\n@@ -188,9 +190,22 @@ FUZZ_TARGET_INIT(script, initialize_script)\n             fuzzed_data_provider.ConsumeBool() ?\n                 DecodeDestination(fuzzed_data_provider.ConsumeRandomLengthString()) :\n                 ConsumeTxDestination(fuzzed_data_provider)};\n-        const CTxDestination tx_destination_2 = ConsumeTxDestination(fuzzed_data_provider);\n+        const CTxDestination tx_destination_2{ConsumeTxDestination(fuzzed_data_provider)};\n+        const std::string encoded_dest{EncodeDestination(tx_destination_1)};\n+        const UniValue json_dest{DescribeAddress(tx_destination_1)};\n+        Assert(tx_destination_1 == DecodeDestination(encoded_dest));\n+        (void)GetKeyForDestination(/* store */ {}, tx_destination_1);\n+        const CScript dest{GetScriptForDestination(tx_destination_1)};\n+        const bool valid{IsValidDestination(tx_destination_1)};\n+        Assert(dest.empty() != valid);\n+\n+        Assert(valid == IsValidDestinationString(encoded_dest));\n \n-        (void)(tx_destination_1 == tx_destination_2);\n         (void)(tx_destination_1 < tx_destination_2);\n+        if (tx_destination_1 == tx_destination_2) {\n+            Assert(encoded_dest == EncodeDestination(tx_destination_2));\n+            Assert(json_dest.write() == DescribeAddress(tx_destination_2).write());\n+            Assert(dest == GetScriptForDestination(tx_destination_2));\n+        }\n     }\n }"
      }
    ]
  }
]