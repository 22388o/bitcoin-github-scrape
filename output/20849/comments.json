[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754075051",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20849#issuecomment-754075051",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20849",
    "id": 754075051,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NDA3NTA1MQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-04T16:27:50Z",
    "updated_at": "2021-01-04T16:27:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "The problem was discovered by @MarcoFalke.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754075051/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754079617",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20849#issuecomment-754079617",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20849",
    "id": 754079617,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NDA3OTYxNw==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-04T16:35:58Z",
    "updated_at": "2021-01-04T16:35:58Z",
    "author_association": "MEMBER",
    "body": "tested-only ACK 5fd2cee7fbc38c677d08a1545770156cc061833e did not review the code \ud83d\udd2e\r\n\r\n<details><summary>Show signature and timestamp</summary>\r\n\r\nSignature:\r\n\r\n```\r\n-----BEGIN PGP SIGNED MESSAGE-----\r\nHash: SHA512\r\n\r\ntested-only ACK 5fd2cee7fbc38c677d08a1545770156cc061833e did not review the code \ud83d\udd2e\r\n-----BEGIN PGP SIGNATURE-----\r\n\r\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\r\npUh/Sgv/W9d+TPMjSm+JqcwJBW7n3wmto0PDu+CvGkHSwHJaoLU7toj8W1y6Ohfz\r\nCDKRGq2ZG+VnxSbKRhItSeaWqleHfAJ0Ns1xZNbDudAw7/IrLMsvNd7+/apFgpUT\r\niM1ytrZMRRLqoPdRVgpzkamKMUyPTPzzXzGQoH6xdxSjMuKbJ69DVzg4d0DuAmH+\r\ny+ZP85yi7KDq5YvS25JUaOpZg4m9UnwTHctL1+hMeIWBtxlx3pFohExswbUC28xz\r\nytN4dWFxyQXC/t3i3fY3AiLiHZZ0frxHTd26sL/vqj935MWnH3SsIpIwm57kl1v2\r\nvHR7yakgWEcDF5qEQHa1+wYi1p26BgYQYjlPqYCM4fp+0MBg6lPpggthZkYVKTXI\r\nJg2mxdUl/kuFDA8Xy9u00uQj6BOWJfshBuClQkxf5184qTcMdQ6SwxagpfDGHEjn\r\nJDHbX+djj8+CfR6CVc3P7MWP1UxnuFI8NWiyMI6KrcEH3ESw16LmcrS3KOeLLI4Q\r\n5IVN+71Z\r\n=kXbR\r\n-----END PGP SIGNATURE-----\r\n```\r\n\r\n[Timestamp of file with hash `ffb08779a664f7e34db6952de6f0948d1fb8eeb7089b81525f9ffde67a8ac202  -`](https://opentimestamps.org/info/?004f70656e54696d657374616d7073000050726f6f6600bf89e2e884e892940108ffb08779a664f7e34db6952de6f0948d1fb8eeb7089b81525f9ffde67a8ac202f010ba914ef96fcd58dcf7ef97e69507f30f08fff01001ca557449cdd59ee8a489fa048bb29a08f1045ff343ccf0088c83c2e0c2202b560083dfe30d2ef90c8e232268747470733a2f2f6274632e63616c656e6461722e636174616c6c6178792e636f6dfff01004a917a47de2960e291f72db62a88de908f020750bb0dd61da48daa72731e0113a36703767a6b3fa7aedbd93d981a8f0b83d2008f020552fdc0c24dad87b2a713d4c04937ee0f5bbcd61bb355994634f12a8e8c28cdc08f1045ff343ccf00861a940fef48bc4080083dfe30d2ef90c8e2c2b68747470733a2f2f626f622e6274632e63616c656e6461722e6f70656e74696d657374616d70732e6f7267fff01016190e20a52f4e363ae04d98e1a52d8a08f020cd808e86f44edce43d5e8b4acfb96b5f61594caba830320a4d1be42eb59ebf1708f02022722abb7230b220a5da7037cd78b817045cf688c776916a9e38b955dc9a124608f02050b970d8126c0f5156e36ddb8b6f7d12297ee07c6860729af27d60d4df312ed908f1045ff343ccf0088f329964afa83b3d0083dfe30d2ef90c8e292868747470733a2f2f66696e6e65792e63616c656e6461722e657465726e69747977616c6c2e636f6df010dce13a9487c5c580d62df60b7705cc0d08f020b00c82767aafbe20855a385ea3e94bc9d48475c132a5000324b368a74520fba808f020ce0e21933b7b4cf9b6f557430dc02455a94ae6c0e85cee26ded22d0094a9dad408f1045ff343ccf00850484396068324400083dfe30d2ef90c8e2e2d68747470733a2f2f616c6963652e6274632e63616c656e6461722e6f70656e74696d657374616d70732e6f7267)\r\n\r\n</details>\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754079617/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754122796",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20849#issuecomment-754122796",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20849",
    "id": 754122796,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NDEyMjc5Ng==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-04T17:57:25Z",
    "updated_at": "2021-01-04T17:57:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "https://github.com/bitcoin/bitcoin/pull/20852 contains a fix for this issue + it also fixes a similar issue in `BanMan`. If it is merged, then this can be closed without merge. They do not conflict in any way. Both can go in.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754122796/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754602325",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20849#issuecomment-754602325",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20849",
    "id": 754602325,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NDYwMjMyNQ==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-05T12:20:36Z",
    "updated_at": "2021-01-05T12:20:36Z",
    "author_association": "MEMBER",
    "body": "Any tips how to test this manually? Disconnecting outbound onion peers with `disconnectnode` works for me on both master and this PR and in #20852.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754602325/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754740638",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20849#issuecomment-754740638",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20849",
    "id": 754740638,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NDc0MDYzOA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-05T16:21:32Z",
    "updated_at": "2021-01-05T16:21:32Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jonatack yes, the `disconnectnode` RPC uses either `DisconnectNode(std::string)` or `DisconnectNode(NodeId)` and the problem is in `DisconnectNode(CNetAddr)`.\r\n\r\n`bitcoin-cli setban foo.onion add` will do the job.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754740638/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754743895",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20849#issuecomment-754743895",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20849",
    "id": 754743895,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NDc0Mzg5NQ==",
    "user": {
      "login": "taurus228",
      "id": 45716417,
      "node_id": "MDQ6VXNlcjQ1NzE2NDE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/45716417?u=8efe2dc3e5e0572a95a123b2d3a5ee8580a88d46&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/taurus228",
      "html_url": "https://github.com/taurus228",
      "followers_url": "https://api.github.com/users/taurus228/followers",
      "following_url": "https://api.github.com/users/taurus228/following{/other_user}",
      "gists_url": "https://api.github.com/users/taurus228/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/taurus228/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/taurus228/subscriptions",
      "organizations_url": "https://api.github.com/users/taurus228/orgs",
      "repos_url": "https://api.github.com/users/taurus228/repos",
      "events_url": "https://api.github.com/users/taurus228/events{/privacy}",
      "received_events_url": "https://api.github.com/users/taurus228/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-05T16:26:58Z",
    "updated_at": "2021-01-05T17:00:20Z",
    "author_association": "NONE",
    "body": "\u0432\u0442, 5 \u044f\u043d\u0432. 2021 \u0433. \u0432 19:24, Vasil Dimov <notifications@github.com>:\n\n> @jonatack <https://github.com/jonatack> yes, the disconnectnode RPC uses\n> either DisconnectNode(std::string) or DisconnectNode(NodeId) and the\n> problem is in DisconnectNode(CNetAddr).\n>\n> bitcoin-cli setban foo.onion add will do the job.\n>\n> \u2014\n> You are receiving this because you are subscribed to this thread.\n> Reply to this email directly, view it on GitHub\n> <https://github.com/bitcoin/bitcoin/pull/20849#issuecomment-754740638>,\n> or unsubscribe\n> <https://github.com/notifications/unsubscribe-auth/AK4ZHQKMTWFQ66BD3TC7WTLSYM4J7ANCNFSM4VTHTMFA>\n> .\n>\n-- \nNik\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754743895/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754803214",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20849#issuecomment-754803214",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20849",
    "id": 754803214,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NDgwMzIxNA==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-05T18:06:10Z",
    "updated_at": "2021-01-05T18:06:10Z",
    "author_association": "MEMBER",
    "body": "utACK 5fd2cee7fbc38c677d08a1545770156cc061833e\r\n\r\nLet's get this merged so the path forward for 0.21 is clear (we can still do #20852, but it's no longer critical then).",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/754803214/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/755261977",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20849#issuecomment-755261977",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20849",
    "id": 755261977,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NTI2MTk3Nw==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-06T12:06:04Z",
    "updated_at": "2021-01-06T12:31:57Z",
    "author_association": "MEMBER",
    "body": "Adding logging to the code path and verified that `setban <onion> add` disconnects peers with this patch and fails to do so on master @ 68196a891056f, with both tor v2 and v3 peers.\r\n\r\nLogging added to master and to this patch:\r\n```diff\r\n@@ -2805,6 +2805,7 @@ bool CConnman::DisconnectNode(const CSubNet& subnet)\r\n     LOCK(cs_vNodes);\r\n     for (CNode* pnode : vNodes) {\r\n         if (subnet.Match(pnode->addr)) {\r\n+            LogPrintf(\"Disconnecting %s via subnet peer=%d address=%s network=%s\\n\",\r\n+                      pnode->ConnectionTypeAsString(), pnode->GetId(),\r\n+                      pnode->addr.ToString(), GetNetworkName(pnode->ConnectedThroughNetwork()));\r\n             pnode->fDisconnect = true;\r\n             disconnected = true;\r\n         }\r\n```\r\nLogging also added to this patch:\r\n```diff\r\n@@ -2818,6 +2819,7 @@ bool CConnman::DisconnectNode(const CNetAddr& addr)\r\n     LOCK(cs_vNodes);\r\n     for (CNode* pnode : vNodes) {\r\n         if (addr == pnode->addr) {\r\n+            LogPrintf(\"Disconnecting %s via addr peer=%d address=%s network=%s\\n\",\r\n+                      pnode->ConnectionTypeAsString(), pnode->GetId(),\r\n+                      pnode->addr.ToString(), GetNetworkName(pnode->ConnectedThroughNetwork()));\r\n             pnode->fDisconnect = true;\r\n             disconnected = true;\r\n         }\r\n```\r\n\r\nOn master, disconnection fails and nothing is logged. With this patch, the peer is immediately removed from the -netinfo 4 peers dashboard and the log shows:\r\n```\r\n2021-01-06T11:47:36Z Disconnecting manual via addr peer=5 address=TOR_V3_PEER network=onion\r\n2021-01-06T11:54:30Z Disconnecting manual via addr peer=25 address=TOR_V2_PEER network=onion\r\n2021-01-06T11:54:49Z Disconnecting outbound-full-relay via addr peer=16 address=TOR_V2_PEER:8333 network=onion\r\n```\r\n\r\nUpgrading to tested ACK 5fd2cee7fbc38c677d08a1545770156cc061833e",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/755261977/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/755345783",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20849#issuecomment-755345783",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20849",
    "id": 755345783,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NTM0NTc4Mw==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-06T14:55:17Z",
    "updated_at": "2021-01-06T14:55:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "Appended an extra commit with unit test that fails on `master` and passes on this PR.\r\n\r\nIf it does not get re-ACKs or if it turns out to be problematic I will remove it, restoring the already ACK'ed commit id.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/755345783/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/755369515",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20849#issuecomment-755369515",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20849",
    "id": 755369515,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NTM2OTUxNQ==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-06T15:33:21Z",
    "updated_at": "2021-01-06T15:33:21Z",
    "author_association": "MEMBER",
    "body": "Nice, will review asap.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/755369515/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/755526834",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20849#issuecomment-755526834",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20849",
    "id": 755526834,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NTUyNjgzNA==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-06T19:03:27Z",
    "updated_at": "2021-01-10T15:01:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20811 (refactor: move net_processing implementation details out of header by ajtowns)\n* #20228 (addrman: Make addrman a top-level component by jnewbery)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/755526834/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/756667568",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20849#issuecomment-756667568",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20849",
    "id": 756667568,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1NjY2NzU2OA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-08T10:05:18Z",
    "updated_at": "2021-01-08T10:05:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "Just to elaborate on the relationship between https://github.com/bitcoin/bitcoin/pull/20849 and https://github.com/bitcoin/bitcoin/pull/20852:\r\n\r\nThe problem in `master` is that `CSubNet(foo.onion)` creates an invalid subnet which later does not match any address, not even `foo.onion`. In two places in the code we expect that once we create such subnet later it will match `foo.onion`: in `CConnman::DisconnectNode()` and in `BanMan`.\r\n\r\nhttps://github.com/bitcoin/bitcoin/pull/20849 fixes `DisconnectNode()` by changing it to not use subnets at all (small isolated change, easy to verify it is correct).\r\n\r\nhttps://github.com/bitcoin/bitcoin/pull/20852 changes `CSubNet` to follow the above expected behavior, thus fixing both `DisconnectNode()` and `BanMan` (bigger change, harder to verify it is correct, caused unexpected CI failure (fixed)).\r\n\r\n**About the release, maybe the following makes sense:**\r\n\r\nInclude https://github.com/bitcoin/bitcoin/pull/20849 in the next rc and in the `0.21.0` release.\r\n\r\nLater, if https://github.com/bitcoin/bitcoin/pull/20852 is merged (ever) there is no need to revert https://github.com/bitcoin/bitcoin/pull/20849.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/756667568/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/757852730",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20849#issuecomment-757852730",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20849",
    "id": 757852730,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1Nzg1MjczMA==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-11T10:15:39Z",
    "updated_at": "2021-01-11T10:15:39Z",
    "author_association": "MEMBER",
    "body": "It might be better to wait for #20852 (0.21.1), after which this is not needed.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/757852730/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/758074471",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20849#issuecomment-758074471",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20849",
    "id": 758074471,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1ODA3NDQ3MQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-11T16:39:20Z",
    "updated_at": "2021-01-11T16:39:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "The test is included in https://github.com/bitcoin/bitcoin/pull/20904.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/758074471/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/552933686",
    "pull_request_review_id": 563001548,
    "id": 552933686,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MjkzMzY4Ng==",
    "diff_hunk": "@@ -223,47 +223,84 @@ BOOST_AUTO_TEST_CASE(peer_discouragement)\n {\n     const CChainParams& chainparams = Params();\n     auto banman = MakeUnique<BanMan>(GetDataDir() / \"banlist.dat\", nullptr, DEFAULT_MISBEHAVING_BANTIME);\n-    auto connman = MakeUnique<CConnman>(0x1337, 0x1337);\n+    auto connman = MakeUnique<CConnmanTest>(0x1337, 0x1337);\n     auto peerLogic = std::make_unique<PeerManager>(chainparams, *connman, banman.get(), *m_node.scheduler,\n                                                    *m_node.chainman, *m_node.mempool, false);\n \n+    std::vector<CNode*> nodes(3);\n+\n     banman->ClearBanned();\n     CAddress addr1(ip(0xa0b0c001), NODE_NONE);\n-    CNode dummyNode1(id++, NODE_NETWORK, INVALID_SOCKET, addr1, 0, 0, CAddress(), \"\", ConnectionType::INBOUND);\n-    dummyNode1.SetCommonVersion(PROTOCOL_VERSION);\n-    peerLogic->InitializeNode(&dummyNode1);\n-    dummyNode1.fSuccessfullyConnected = true;\n-    peerLogic->Misbehaving(dummyNode1.GetId(), DISCOURAGEMENT_THRESHOLD, /* message */ \"\"); // Should be discouraged\n+    nodes[0] = new CNode(id++, NODE_NETWORK, INVALID_SOCKET, addr1, 0, 0, CAddress(), \"\", ConnectionType::INBOUND);\n+    nodes[0]->SetCommonVersion(PROTOCOL_VERSION);\n+    peerLogic->InitializeNode(nodes[0]);\n+    nodes[0]->fSuccessfullyConnected = true;\n+    connman->AddNode(*nodes[0]);\n+    peerLogic->Misbehaving(nodes[0]->GetId(), DISCOURAGEMENT_THRESHOLD, /* message */ \"\"); // Should be discouraged\n     {\n-        LOCK(dummyNode1.cs_sendProcessing);\n-        BOOST_CHECK(peerLogic->SendMessages(&dummyNode1));\n+        LOCK(nodes[0]->cs_sendProcessing);\n+        BOOST_CHECK(peerLogic->SendMessages(nodes[0]));\n     }\n     BOOST_CHECK(banman->IsDiscouraged(addr1));\n+    BOOST_CHECK(nodes[0]->fDisconnect);\n     BOOST_CHECK(!banman->IsDiscouraged(ip(0xa0b0c001|0x0000ff00))); // Different IP, not discouraged\n \n     CAddress addr2(ip(0xa0b0c002), NODE_NONE);\n-    CNode dummyNode2(id++, NODE_NETWORK, INVALID_SOCKET, addr2, 1, 1, CAddress(), \"\", ConnectionType::INBOUND);\n-    dummyNode2.SetCommonVersion(PROTOCOL_VERSION);\n-    peerLogic->InitializeNode(&dummyNode2);\n-    dummyNode2.fSuccessfullyConnected = true;\n-    peerLogic->Misbehaving(dummyNode2.GetId(), DISCOURAGEMENT_THRESHOLD - 1, /* message */ \"\");\n+    nodes[1] = new CNode(id++, NODE_NETWORK, INVALID_SOCKET, addr2, 1, 1, CAddress(), \"\", ConnectionType::INBOUND);\n+    nodes[1]->SetCommonVersion(PROTOCOL_VERSION);\n+    peerLogic->InitializeNode(nodes[1]);\n+    nodes[1]->fSuccessfullyConnected = true;\n+    connman->AddNode(*nodes[1]);\n+    peerLogic->Misbehaving(nodes[1]->GetId(), DISCOURAGEMENT_THRESHOLD - 1, /* message */ \"\");\n     {\n-        LOCK(dummyNode2.cs_sendProcessing);\n-        BOOST_CHECK(peerLogic->SendMessages(&dummyNode2));\n+        LOCK(nodes[1]->cs_sendProcessing);\n+        BOOST_CHECK(peerLogic->SendMessages(nodes[1]));\n     }\n     BOOST_CHECK(!banman->IsDiscouraged(addr2)); // 2 not discouraged yet...\n+    BOOST_CHECK(!nodes[1]->fDisconnect);\n     BOOST_CHECK(banman->IsDiscouraged(addr1));  // ... but 1 still should be\n-    peerLogic->Misbehaving(dummyNode2.GetId(), 1, /* message */ \"\");         // 2 reaches discouragement threshold\n+    BOOST_CHECK(nodes[0]->fDisconnect);\n+    peerLogic->Misbehaving(nodes[1]->GetId(), 1, /* message */ \"\");         // 2 reaches discouragement threshold\n+    {\n+        LOCK(nodes[1]->cs_sendProcessing);\n+        BOOST_CHECK(peerLogic->SendMessages(nodes[1]));\n+    }\n+    // Expect both 1 and 2 to be discouraged now.\n+    BOOST_CHECK(banman->IsDiscouraged(addr1));\n+    BOOST_CHECK(nodes[0]->fDisconnect);\n+    BOOST_CHECK(banman->IsDiscouraged(addr2));\n+    BOOST_CHECK(nodes[1]->fDisconnect);\n+\n+    // Make sure non-IP peers get discouraged and disconnected properly.\n+\n+    CNetAddr tor_netaddr;\n+    BOOST_REQUIRE(\n+        tor_netaddr.SetSpecial(\"pg6mmjiyjmcrsslvykfwnntlaru7p5svn6y2ymmju6nubxndf4pscryd.onion\"));\n+\n+    const CAddress addr3(CService(tor_netaddr, Params().GetDefaultPort()), NODE_NONE);\n+    nodes[2] = new CNode(id++, NODE_NETWORK, INVALID_SOCKET, addr3, 1, 1, CAddress(), \"\",\n+                         ConnectionType::OUTBOUND_FULL_RELAY);\n+    nodes[2]->SetCommonVersion(PROTOCOL_VERSION);\n+    peerLogic->InitializeNode(nodes[2]);\n+    connman->AddNode(*nodes[2]);\n+    nodes[2]->fSuccessfullyConnected = true;\n+    peerLogic->Misbehaving(nodes[2]->GetId(), DISCOURAGEMENT_THRESHOLD, /* message */ \"\");\n     {\n-        LOCK(dummyNode2.cs_sendProcessing);\n-        BOOST_CHECK(peerLogic->SendMessages(&dummyNode2));\n+        LOCK(nodes[2]->cs_sendProcessing);\n+        BOOST_CHECK(peerLogic->SendMessages(nodes[2]));\n+    }\n+    BOOST_CHECK(banman->IsDiscouraged(addr1));\n+    BOOST_CHECK(banman->IsDiscouraged(addr2));\n+    BOOST_CHECK(banman->IsDiscouraged(addr3));\n+    for (CNode* node : nodes) {\n+        BOOST_CHECK(node->fDisconnect);",
    "path": "src/test/denialofservice_tests.cpp",
    "position": 92,
    "original_position": 92,
    "commit_id": "98140bc855b037d2c552153496e8e4e2c2efdad9",
    "original_commit_id": "98140bc855b037d2c552153496e8e4e2c2efdad9",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The new test code fails at the right place on master\r\n```\r\ntest/denialofservice_tests.cpp(292): info: check banman->IsDiscouraged(addr1) has passed\r\ntest/denialofservice_tests.cpp(293): info: check banman->IsDiscouraged(addr2) has passed\r\ntest/denialofservice_tests.cpp(294): info: check banman->IsDiscouraged(addr3) has passed\r\ntest/denialofservice_tests.cpp(296): info: check node->fDisconnect has passed\r\ntest/denialofservice_tests.cpp(296): info: check node->fDisconnect has passed\r\ntest/denialofservice_tests.cpp(296): error: in \"denialofservice_tests/peer_discouragement\": check node->fDisconnect has failed\r\ntest/denialofservice_tests.cpp(222): Leaving test case \"peer_discouragement\"; testing time: 32905us\r\n```\r\n\r\nnit, maybe not worth it for tests, could use `nodes.at()` notation for bounds checking instead of `nodes[]`",
    "created_at": "2021-01-06T19:58:35Z",
    "updated_at": "2021-01-06T23:19:42Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20849#discussion_r552933686",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20849",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/552933686"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20849#discussion_r552933686"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20849"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/552933686/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 296,
    "original_line": 296,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/553374275",
    "pull_request_review_id": 563546566,
    "id": 553374275,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzM3NDI3NQ==",
    "diff_hunk": "@@ -2814,7 +2814,15 @@ bool CConnman::DisconnectNode(const CSubNet& subnet)\n \n bool CConnman::DisconnectNode(const CNetAddr& addr)\n {\n-    return DisconnectNode(CSubNet(addr));\n+    bool disconnected = false;",
    "path": "src/net.cpp",
    "position": 5,
    "original_position": 5,
    "commit_id": "98140bc855b037d2c552153496e8e4e2c2efdad9",
    "original_commit_id": "98140bc855b037d2c552153496e8e4e2c2efdad9",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Is this change still needed with #20852? It seems to me that makes the old, much more compact, construction work?",
    "created_at": "2021-01-07T14:49:46Z",
    "updated_at": "2021-01-07T14:50:41Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20849#discussion_r553374275",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20849",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/553374275"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20849#discussion_r553374275"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20849"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/553374275/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2817,
    "original_line": 2817,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/553388972",
    "pull_request_review_id": 563566447,
    "id": 553388972,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1MzM4ODk3Mg==",
    "diff_hunk": "@@ -2814,7 +2814,15 @@ bool CConnman::DisconnectNode(const CSubNet& subnet)\n \n bool CConnman::DisconnectNode(const CNetAddr& addr)\n {\n-    return DisconnectNode(CSubNet(addr));\n+    bool disconnected = false;",
    "path": "src/net.cpp",
    "position": 5,
    "original_position": 5,
    "commit_id": "98140bc855b037d2c552153496e8e4e2c2efdad9",
    "original_commit_id": "98140bc855b037d2c552153496e8e4e2c2efdad9",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "No, if #20852 is merged, then this PR is not needed, see https://github.com/bitcoin/bitcoin/pull/20849#issuecomment-754122796.\r\n\r\nI first opened this PR to fix `DisconnectNode()` and then realized that the same problem exists in `BanMan`, thus opened #20852 which fixes both by modifying `CSubNet`.\r\n\r\nMaybe this PR could be preferred as less risky compared to #20852. It is ok if this is merged first and later #20852 is also merged - they do not conflict and both go in `master`.",
    "created_at": "2021-01-07T15:13:12Z",
    "updated_at": "2021-01-07T15:13:12Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20849#discussion_r553388972",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20849",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/553388972"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20849#discussion_r553388972"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20849"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/553388972/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2817,
    "original_line": 2817,
    "side": "RIGHT",
    "in_reply_to_id": 553374275
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/555019312",
    "pull_request_review_id": 565317267,
    "id": 555019312,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTAxOTMxMg==",
    "diff_hunk": "@@ -223,47 +223,84 @@ BOOST_AUTO_TEST_CASE(peer_discouragement)\n {\n     const CChainParams& chainparams = Params();\n     auto banman = MakeUnique<BanMan>(GetDataDir() / \"banlist.dat\", nullptr, DEFAULT_MISBEHAVING_BANTIME);\n-    auto connman = MakeUnique<CConnman>(0x1337, 0x1337);\n+    auto connman = MakeUnique<CConnmanTest>(0x1337, 0x1337);",
    "path": "src/test/denialofservice_tests.cpp",
    "position": 5,
    "original_position": 5,
    "commit_id": "98140bc855b037d2c552153496e8e4e2c2efdad9",
    "original_commit_id": "98140bc855b037d2c552153496e8e4e2c2efdad9",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "std::make_unique for new code?\r\n\r\nAlso, could split the refactoring changes from the new-test changes?",
    "created_at": "2021-01-11T12:40:42Z",
    "updated_at": "2021-01-11T12:43:29Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20849#discussion_r555019312",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20849",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/555019312"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20849#discussion_r555019312"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20849"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/555019312/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 226,
    "original_line": 226,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/555021056",
    "pull_request_review_id": 565319584,
    "id": 555021056,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU1NTAyMTA1Ng==",
    "diff_hunk": "@@ -223,47 +223,84 @@ BOOST_AUTO_TEST_CASE(peer_discouragement)\n {\n     const CChainParams& chainparams = Params();\n     auto banman = MakeUnique<BanMan>(GetDataDir() / \"banlist.dat\", nullptr, DEFAULT_MISBEHAVING_BANTIME);\n-    auto connman = MakeUnique<CConnman>(0x1337, 0x1337);\n+    auto connman = MakeUnique<CConnmanTest>(0x1337, 0x1337);",
    "path": "src/test/denialofservice_tests.cpp",
    "position": 5,
    "original_position": 5,
    "commit_id": "98140bc855b037d2c552153496e8e4e2c2efdad9",
    "original_commit_id": "98140bc855b037d2c552153496e8e4e2c2efdad9",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Nvm, forget the std::make_unique suggestion. We want to backport the test changes.",
    "created_at": "2021-01-11T12:44:07Z",
    "updated_at": "2021-01-11T12:44:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20849#discussion_r555021056",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20849",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/555021056"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20849#discussion_r555021056"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20849"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/555021056/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 226,
    "original_line": 226,
    "side": "RIGHT",
    "in_reply_to_id": 555019312
  }
]