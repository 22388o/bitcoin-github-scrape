[
  {
    "sha": "a10972bc03e1ebbe79c3edc929c91ed53b391c9a",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphMTA5NzJiYzAzZTFlYmJlNzljM2VkYzkyOWM5MWVkNTNiMzkxYzlh",
    "commit": {
      "author": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2019-03-17T17:54:35Z"
      },
      "committer": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2019-03-22T09:51:04Z"
      },
      "message": "gui: Defer removeAndDeleteWallet when no modal widget is active",
      "tree": {
        "sha": "0cb0c2217a7ba16c56c5ace775d59df73023ef8b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0cb0c2217a7ba16c56c5ace775d59df73023ef8b"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a10972bc03e1ebbe79c3edc929c91ed53b391c9a",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a10972bc03e1ebbe79c3edc929c91ed53b391c9a",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/a10972bc03e1ebbe79c3edc929c91ed53b391c9a",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a10972bc03e1ebbe79c3edc929c91ed53b391c9a/comments",
    "author": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "717fd58c4ba5c64778fa9a8bf6bbf5ae1164df3f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/717fd58c4ba5c64778fa9a8bf6bbf5ae1164df3f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/717fd58c4ba5c64778fa9a8bf6bbf5ae1164df3f"
      }
    ],
    "stats": {
      "total": 14,
      "additions": 13,
      "deletions": 1
    },
    "files": [
      {
        "sha": "019bd6582348d35523e134b36ce0c7fecec292eb",
        "filename": "src/qt/walletcontroller.cpp",
        "status": "modified",
        "additions": 13,
        "deletions": 1,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a10972bc03e1ebbe79c3edc929c91ed53b391c9a/src/qt/walletcontroller.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a10972bc03e1ebbe79c3edc929c91ed53b391c9a/src/qt/walletcontroller.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/walletcontroller.cpp?ref=a10972bc03e1ebbe79c3edc929c91ed53b391c9a",
        "patch": "@@ -9,9 +9,11 @@\n \n #include <algorithm>\n \n+#include <QApplication>\n #include <QMessageBox>\n #include <QMutexLocker>\n #include <QThread>\n+#include <QWindow>\n \n WalletController::WalletController(interfaces::Node& node, const PlatformStyle* platform_style, OptionsModel* options_model, QObject* parent)\n     : QObject(parent)\n@@ -97,7 +99,17 @@ WalletModel* WalletController::getOrCreateWallet(std::unique_ptr<interfaces::Wal\n     m_wallets.push_back(wallet_model);\n \n     connect(wallet_model, &WalletModel::unload, [this, wallet_model] {\n-        removeAndDeleteWallet(wallet_model);\n+        // Defer removeAndDeleteWallet when no modal widget is active.\n+        // TODO: remove this workaround by removing usage of QDiallog::exec.\n+        if (QApplication::activeModalWidget()) {\n+            connect(qApp, &QApplication::focusWindowChanged, wallet_model, [this, wallet_model]() {\n+                if (!QApplication::activeModalWidget()) {\n+                    removeAndDeleteWallet(wallet_model);\n+                }\n+            }, Qt::QueuedConnection);\n+        } else {\n+            removeAndDeleteWallet(wallet_model);\n+        }\n     });\n \n     // Re-emit coinsSent signal from wallet model."
      }
    ]
  }
]