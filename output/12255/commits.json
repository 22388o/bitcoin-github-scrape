[
  {
    "sha": "b0c7b54d0c2e116d61e686b1adfdea6a1f7f02fe",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiMGM3YjU0ZDBjMmUxMTZkNjFlNjg2YjFhZGZkZWE2YTFmN2YwMmZl",
    "commit": {
      "author": {
        "name": "Carl Dong",
        "email": "accounts@carldong.me",
        "date": "2019-01-03T13:53:51Z"
      },
      "committer": {
        "name": "Carl Dong",
        "email": "accounts@carldong.me",
        "date": "2019-01-05T05:21:44Z"
      },
      "message": "init: Use systemd automatic directory creation\n\nTell systemd to create, set, and ensure the right mode for the PID,\nconfiguration, and data directories.\n\nOnly the exec bit is set for groups for the aforementioned directories.\nThis is the least privilege perm that allows for the\nreading/writing/execing of files under the directory _if_ the files\nthemselves give permission to its group to do so (e.g. when -sysperms is\nspecified). Note that this does not allow for the listing of files under\nthe directory.",
      "tree": {
        "sha": "7ac03b7eaf06ec68770c2d32a73a5be1be05d358",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7ac03b7eaf06ec68770c2d32a73a5be1be05d358"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b0c7b54d0c2e116d61e686b1adfdea6a1f7f02fe",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b0c7b54d0c2e116d61e686b1adfdea6a1f7f02fe",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/b0c7b54d0c2e116d61e686b1adfdea6a1f7f02fe",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b0c7b54d0c2e116d61e686b1adfdea6a1f7f02fe/comments",
    "author": {
      "login": "dongcarl",
      "id": 3445290,
      "node_id": "MDQ6VXNlcjM0NDUyOTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dongcarl",
      "html_url": "https://github.com/dongcarl",
      "followers_url": "https://api.github.com/users/dongcarl/followers",
      "following_url": "https://api.github.com/users/dongcarl/following{/other_user}",
      "gists_url": "https://api.github.com/users/dongcarl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
      "organizations_url": "https://api.github.com/users/dongcarl/orgs",
      "repos_url": "https://api.github.com/users/dongcarl/repos",
      "events_url": "https://api.github.com/users/dongcarl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dongcarl/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "dongcarl",
      "id": 3445290,
      "node_id": "MDQ6VXNlcjM0NDUyOTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dongcarl",
      "html_url": "https://github.com/dongcarl",
      "followers_url": "https://api.github.com/users/dongcarl/followers",
      "following_url": "https://api.github.com/users/dongcarl/following{/other_user}",
      "gists_url": "https://api.github.com/users/dongcarl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
      "organizations_url": "https://api.github.com/users/dongcarl/orgs",
      "repos_url": "https://api.github.com/users/dongcarl/repos",
      "events_url": "https://api.github.com/users/dongcarl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dongcarl/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fe5a70b9fefa0548f497a749746f53f3d7fd0ebb",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fe5a70b9fefa0548f497a749746f53f3d7fd0ebb",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fe5a70b9fefa0548f497a749746f53f3d7fd0ebb"
      }
    ],
    "stats": {
      "total": 34,
      "additions": 29,
      "deletions": 5
    },
    "files": [
      {
        "sha": "cfc5f775800d837952b8074d09a09dcff60c1dac",
        "filename": "contrib/init/bitcoind.service",
        "status": "modified",
        "additions": 29,
        "deletions": 5,
        "changes": 34,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b0c7b54d0c2e116d61e686b1adfdea6a1f7f02fe/contrib/init/bitcoind.service",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b0c7b54d0c2e116d61e686b1adfdea6a1f7f02fe/contrib/init/bitcoind.service",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/init/bitcoind.service?ref=b0c7b54d0c2e116d61e686b1adfdea6a1f7f02fe",
        "patch": "@@ -5,21 +5,45 @@\n # See \"man systemd.service\" for details.\n \n # Note that almost all daemon options could be specified in\n-# /etc/bitcoin/bitcoin.conf\n+# /etc/bitcoin/bitcoin.conf, except for those explicitly specified as arguments\n+# in ExecStart=\n \n [Unit]\n Description=Bitcoin daemon\n After=network.target\n \n [Service]\n-ExecStart=/usr/bin/bitcoind -daemon -conf=/etc/bitcoin/bitcoin.conf -pid=/run/bitcoind/bitcoind.pid\n-# Creates /run/bitcoind owned by bitcoin\n-RuntimeDirectory=bitcoind\n-User=bitcoin\n+ExecStart=/usr/bin/bitcoind -daemon \\\n+                            -pid=/run/bitcoind/bitcoind.pid \\\n+                            -conf=/etc/bitcoin/bitcoin.conf \\\n+                            -datadir=/var/lib/bitcoind\n+\n+# Process management\n+####################\n+\n Type=forking\n PIDFile=/run/bitcoind/bitcoind.pid\n Restart=on-failure\n \n+# Directory creation and permissions\n+####################################\n+\n+# Run as bitcoin:bitcoin\n+User=bitcoin\n+Group=bitcoin\n+\n+# /run/bitcoind\n+RuntimeDirectory=bitcoind\n+RuntimeDirectoryMode=0710\n+\n+# /etc/bitcoin\n+ConfigurationDirectory=bitcoin\n+ConfigurationDirectoryMode=0710\n+\n+# /var/lib/bitcoind\n+StateDirectory=bitcoind\n+StateDirectoryMode=0710\n+\n # Hardening measures\n ####################\n "
      }
    ]
  },
  {
    "sha": "bad1716c6d30fdf4be6d5050a04e1211f920bbd6",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiYWQxNzE2YzZkMzBmZGY0YmU2ZDUwNTBhMDRlMTIxMWY5MjBiYmQ2",
    "commit": {
      "author": {
        "name": "Carl Dong",
        "email": "accounts@carldong.me",
        "date": "2019-01-03T15:14:32Z"
      },
      "committer": {
        "name": "Carl Dong",
        "email": "accounts@carldong.me",
        "date": "2019-02-04T14:18:28Z"
      },
      "message": "init: Modify docs and add release note for 12255",
      "tree": {
        "sha": "b00057ad553487f5d781e8a3bb001f251f153692",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b00057ad553487f5d781e8a3bb001f251f153692"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bad1716c6d30fdf4be6d5050a04e1211f920bbd6",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bad1716c6d30fdf4be6d5050a04e1211f920bbd6",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/bad1716c6d30fdf4be6d5050a04e1211f920bbd6",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bad1716c6d30fdf4be6d5050a04e1211f920bbd6/comments",
    "author": {
      "login": "dongcarl",
      "id": 3445290,
      "node_id": "MDQ6VXNlcjM0NDUyOTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dongcarl",
      "html_url": "https://github.com/dongcarl",
      "followers_url": "https://api.github.com/users/dongcarl/followers",
      "following_url": "https://api.github.com/users/dongcarl/following{/other_user}",
      "gists_url": "https://api.github.com/users/dongcarl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
      "organizations_url": "https://api.github.com/users/dongcarl/orgs",
      "repos_url": "https://api.github.com/users/dongcarl/repos",
      "events_url": "https://api.github.com/users/dongcarl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dongcarl/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "dongcarl",
      "id": 3445290,
      "node_id": "MDQ6VXNlcjM0NDUyOTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3445290?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dongcarl",
      "html_url": "https://github.com/dongcarl",
      "followers_url": "https://api.github.com/users/dongcarl/followers",
      "following_url": "https://api.github.com/users/dongcarl/following{/other_user}",
      "gists_url": "https://api.github.com/users/dongcarl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
      "organizations_url": "https://api.github.com/users/dongcarl/orgs",
      "repos_url": "https://api.github.com/users/dongcarl/repos",
      "events_url": "https://api.github.com/users/dongcarl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dongcarl/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "b0c7b54d0c2e116d61e686b1adfdea6a1f7f02fe",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b0c7b54d0c2e116d61e686b1adfdea6a1f7f02fe",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/b0c7b54d0c2e116d61e686b1adfdea6a1f7f02fe"
      }
    ],
    "stats": {
      "total": 35,
      "additions": 34,
      "deletions": 1
    },
    "files": [
      {
        "sha": "a6c9bb94d8453061b9b52aefc317848e07109ef9",
        "filename": "doc/init.md",
        "status": "modified",
        "additions": 17,
        "deletions": 1,
        "changes": 18,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bad1716c6d30fdf4be6d5050a04e1211f920bbd6/doc/init.md",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bad1716c6d30fdf4be6d5050a04e1211f920bbd6/doc/init.md",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/doc/init.md?ref=bad1716c6d30fdf4be6d5050a04e1211f920bbd6",
        "patch": "@@ -56,7 +56,7 @@ All three configurations assume several paths that might need to be adjusted.\n Binary:              `/usr/bin/bitcoind`  \n Configuration file:  `/etc/bitcoin/bitcoin.conf`  \n Data directory:      `/var/lib/bitcoind`  \n-PID file:            `/var/run/bitcoind/bitcoind.pid` (OpenRC and Upstart) or `/var/lib/bitcoind/bitcoind.pid` (systemd)  \n+PID file:            `/var/run/bitcoind/bitcoind.pid` (OpenRC and Upstart) or `/run/bitcoind/bitcoind.pid` (systemd)\n Lock file:           `/var/lock/subsys/bitcoind` (CentOS)  \n \n The configuration file, PID directory (if applicable) and data directory\n@@ -65,6 +65,22 @@ reasons to make the configuration file and data directory only readable by the\n bitcoin user and group.  Access to bitcoin-cli and other bitcoind rpc clients\n can then be controlled by group membership.\n \n+NOTE: When using the systemd .service file, the creation of the aforementioned\n+directories and the setting of their permissions is automatically handled by\n+systemd. Directories are given a permission of 710, giving the bitcoin group\n+access to files under it _if_ the files themselves give permission to the\n+bitcoin group to do so (e.g. when `-sysperms` is specified). This does not allow\n+for the listing of files under the directory.\n+\n+NOTE: It is not currently possible to override `datadir` in\n+`/etc/bitcoin/bitcoin.conf` with the current systemd, OpenRC, and Upstart init\n+files out-of-the-box. This is because the command line options specified in the\n+init files take precedence over the configurations in\n+`/etc/bitcoin/bitcoin.conf`. However, some init systems have their own\n+configuration mechanisms that would allow for overriding the command line\n+options specified in the init files (e.g. setting `BITCOIND_DATADIR` for\n+OpenRC).\n+\n ### macOS\n \n Binary:              `/usr/local/bin/bitcoind`  "
      },
      {
        "sha": "5ac8b44283975b9064e9be004f7bf7fad898b440",
        "filename": "doc/release-notes/release-notes-pr12255.md",
        "status": "added",
        "additions": 17,
        "deletions": 0,
        "changes": 17,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bad1716c6d30fdf4be6d5050a04e1211f920bbd6/doc/release-notes/release-notes-pr12255.md",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bad1716c6d30fdf4be6d5050a04e1211f920bbd6/doc/release-notes/release-notes-pr12255.md",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/doc/release-notes/release-notes-pr12255.md?ref=bad1716c6d30fdf4be6d5050a04e1211f920bbd6",
        "patch": "@@ -0,0 +1,17 @@\n+systemd init file\n+=========\n+\n+The systemd init file (`contrib/init/bitcoind.service`) has been changed to use\n+`/var/lib/bitcoind` as the data directory instead of `~bitcoin/.bitcoin`. This\n+change makes Bitcoin Core more consistent with other services, and makes the\n+systemd init config more consistent with existing Upstart and OpenRC configs.\n+\n+The configuration, PID, and data directories are now completely managed by\n+systemd, which will take care of their creation, permissions, etc. See\n+[`systemd.exec (5)`](https://www.freedesktop.org/software/systemd/man/systemd.exec.html#RuntimeDirectory=)\n+for more details.\n+\n+When using the provided init files under `contrib/init`, overriding the\n+`datadir` option in `/etc/bitcoin/bitcoin.conf` will have no effect. This is\n+because the command line arguments specified in the init files take precedence\n+over the options specified in `/etc/bitcoin/bitcoin.conf`."
      }
    ]
  }
]