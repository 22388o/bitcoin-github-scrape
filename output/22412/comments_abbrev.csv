MarcoFalke,2021-07-07 07:06:21,"Thank you for your contribution. However we do not accept patches that are only meant for downstream projects that are shipping modified versions of Bitcoin Core. This project's goal is to maintain the vanilla version of Bitcoin Core.\n\nhttps://github.com/bitcoin-core/univalue/commit/98fadc090984fa7e070b6c41ccb514f69a371c85",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-875345174,875345174,
MarcoFalke,2021-07-07 08:25:07,Happy to reopen for more feedback,https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-875400254,875400254,
hebasto,2021-07-07 08:33:55,"> Fixes regressions introduced by #20012 and #21302\n\nDo we need tests to prevent such regressions in the future?",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-875406596,875406596,
MarcoFalke,2021-07-07 08:57:00,Agree that this needs tests if it is decided that the workaround should be applied. Also the minimum dependency version should be properly documented in https://github.com/bitcoin/bitcoin/blob/master/doc/dependencies.md#dependencies to have an objective criteria to decide on what workarounds are acceptable and which ones are not. Currently it is not documented and I (incorrectly?) assumed that onl,https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-875422895,875422895,
MarcoFalke,2021-07-07 09:15:38,"To reply to my own comment: The minimum required univalue version is hidden in the configure.ac. The last time it was bumped was https://github.com/bitcoin/bitcoin/pull/12666 to require the bool dictionary fix.\n\nSo Concept NACK on this pull. I'd prefer to bump the minimum univalue dependency to require the bool array fix. This is a reliable fix for the bug (unlike this pull request) that also ",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-875437216,875437216,
luke-jr,2021-07-07 17:22:43,">However we do not accept patches that are only meant for downstream projects that are shipping modified versions of Bitcoin Core. \n\nMany changes that benefit other projects (eg, Liquid) have been accepted into Core. This particular fix, however, affects Core itself, without modifications.\n\n>Do we need tests to prevent such regressions in the future?\n\nIt would be good to get one of the",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-875787304,875787304,
DrahtBot,2021-07-08 00:52:02,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #22006 by 0xB10C\n\nIf you consider this pull request important, please also help to review the conflicting pull requests.",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-876032639,876032639,
MarcoFalke,2021-07-08 06:11:19,"> AFAIK, you have never submitted it upstream (despite me bringing it to your attention previously), so that hasn't even begun...\n\nAssuming others are obliged to do something is not how open source dev works.\n\n\nRegardless, I just looked into this and it seems this issue is fixed in the latest release? At least the code where the patch could be applied is removed.",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-876158486,876158486,
luke-jr,2021-07-08 06:28:59,"> Assuming others are obliged to do something is not how open source dev works.\n\nI didn't assume that. It's simply what would be necessary to avoid this workaround.\n\n>Regardless, I just looked into this and it seems this issue is fixed in the latest release? At least the code where the patch could be applied is removed.\n\nIt's still an issue in the latest stable 1.0.5, and 1.1.1 (a deve",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-876167351,876167351,
MarcoFalke,2021-07-08 06:47:03,"In my view there are two options:\n\n* The univalue upstream that you are using is unmaintained and/or dropped support for Bitcoin Core. In this case we should simply remove `--with-system-univalue`, because there is no long-term prospect in keeping it.\n* It is still maintained. In that case, the bug(s) should be fixed upstream and the minimum version be bumped in our build system to require t",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-876176774,876176774,
luke-jr,2021-07-08 06:59:55,"> In that case, the bug(s) should be fixed upstream and the minimum version be bumped in our build system to require the bugfix to be included.\n\nIMO this is the ideal approach to take.\n\n> Reporting the bug upstream to the dependency you are using also seems a more logical first step to me than to craft a workaround.\n\nIt is unclear if this is going to happen before 22.0.",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-876184044,876184044,
luke-jr,2021-07-08 07:15:07,"To get the ball rolling on eventually not needing this, I opened https://github.com/jgarzik/univalue/pull/83",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-876193497,876193497,
jnewbery,2021-07-08 19:49:17,"> In this case we should simply remove --with-system-univalue, because there is no long-term prospect in keeping it.\n\nStrong concept ACK. The upstream https://github.com/jgarzik/univalue/ project is barely maintained.",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-876700523,876700523,
luke-jr,2021-07-08 20:05:31,">>In this case we should simply remove --with-system-univalue, because there is no long-term prospect in keeping it.\n\n>Strong concept ACK. The upstream https://github.com/jgarzik/univalue/ project is barely maintained.\n\nStrong concept *NACK*. It appears to be maintained just fine. The only reason this has broken is because @MarcoFalke has gone out of his way to create a divergent fork in t",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-876709959,876709959,
MarcoFalke,2021-07-08 20:10:01,"> The only reason this has broken is because @MarcoFalke has gone out of his way to create a divergent fork in the Core subtree for no benefit.\n\nThis is false; I did not create the repo that feeds the subtree. Also, it is irrelevant who created the repo, it was created so that bugfixes can be merged faster into the subtree.\n\nIn fact, as you can see from all the cross-merge commits, I was p",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-876712718,876712718,
MarcoFalke,2021-07-08 20:15:15,"> Ideally, we should just drop the subtree entirely\n\nRelated discussion about this happened in at least:\n\n* https://github.com/bitcoin/bitcoin/pull/7349\n* and https://github.com/bitcoin/bitcoin/pull/7485\n\nRe-hashing the same topic every year isn't going to help this project.\n\n",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-876715606,876715606,
luke-jr,2021-07-08 20:18:48,"What I see, is that you made an incompatible API change, ignored efforts to reconcile the official UniValue tree, rudely insta-closed this PR to fix compatibility, and when pushed here, you created [a PR for it with 15 unrelated commits](https://github.com/jgarzik/univalue/pull/82) that you know you would *never* merge to Core.\n\n>Re-hashing the same topic every year isn't going to help this pr",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-876718556,876718556,
sipa,2021-07-08 20:27:59,"Sorry @luke-jr, but this is ridiculous. Upstream is _obviously_ unmaintained. It seems the maintainer has not had any comments/commits or other activity in over two years, while there have been PRs opened and commented on on a semi-regular basis. Bitcoin Core has had its own fork for a while, because the maintenance situation was sporadic before for time before already, but at this point there is ",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-876724919,876724919,
luke-jr,2021-07-08 20:35:42,"@sipa There has been nothing to merge during that time. I glanced at the PRs. Some are enhancements tagged for a future release. None are merged in the Core subtree (aside from the ones just opened yesterday), so if upstream is unmaintained, so is Core's fork.\n\n>So I think we should simply start treating the https://github.com/bitcoin-core/univalue repository as upstream.\n\nIF upstream is i",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-876729040,876729040,
sipa,2021-07-08 20:48:31,"> > You can't go call clear improvements to the codebase ""going out of your way to create a divergent fork"" when upstream isn't accepting any changes at all.\n>\n> That isn't established yet. Upstream hasn't had more than 1 day to triage the push_back change.\n\nI assumed you were talking about earlier changes when making that accusation. If that's not the case, I take my words back on that as",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-876735898,876735898,
MarcoFalke,2021-07-09 06:52:37,"> you created a PR for it with 15 unrelated commits that you know you would never merge to Core.\n\nThis is also false. Both the forks did merge PRs with ""unrelated commits"":\n* https://github.com/jgarzik/univalue/pull/57\n* https://github.com/bitcoin-core/univalue/pull/23\n\nMerging one branch into another (with all commits) is one way to keep them in sync.\n\n> Edit: We should probably a",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-876959432,876959432,
luke-jr,2021-07-09 16:09:32,">It might be good to explain which fixes you are referring to.\n\nhttps://github.com/jgarzik/univalue/pull/58\n",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-877295480,877295480,
luke-jr,2021-07-09 18:38:32,"Mr. Garzik advises that he still maintains UniValue and will make a new stable release (presumably with the fix) this month.\n\nPerhaps the best approach at this time, is to simply bump the minimum version required to 1.0.6 assuming it will be available by the time 22.0 is final?",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-877382104,877382104,
DrahtBot,2021-07-27 18:13:49,"<!--cf906140f33d8803c4a75a2196329ecb-->\n🐙 This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a ""draft"".</sub>",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-887725882,887725882,
fanquake,2021-07-30 04:00:10,"> Mr. Garzik advises that he still maintains UniValue and will make a new stable release (presumably with the fix) this month.\n\nIt's now essentially the end of the month, and I can't yet see any new activity in https://github.com/jgarzik/univalue.",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-889610121,889610121,
MarcoFalke,2021-07-30 06:40:08,In this case we should remove `--with-system-univalue`. See https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-876176774,https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-889667089,889667089,
luke-jr,2021-07-30 13:12:38,"Or just fix the bug in Core. Upstream not agreeing to your API change is not an excuse to break compatibility.\n\nIf you want to become upstream, fine, but don't be a jerk to everyone who wishes to use proper shared libraries. NACK to removing UniValue support and creating divergent vendor-only forks for no reason.",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-889884073,889884073,
fanquake,2021-09-02 04:53:59,"Concept NACK. I agree with the discussion here, in regards to why this is not something we want to, or should have to do. I've summarized my thoughts in #22646, which removes support for system univalue.\n\n> PRs like #22412 highlight the ""issue"" with us operating with our own Univalue fork, where we actively fix bugs, and make improvements, when upstream (https://github.com/jgarzik/univalue) ma",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-911174208,911174208,
fanquake,2021-10-20 03:06:19,"I'm closing this now that #22646 has been merged. For the record, there still doesn't seem to be any new activity [upstream](https://github.com/jgarzik/univalue/), and this is now nearly 3 months after upstream advised they were going to make a new release. ",https://github.com/bitcoin/bitcoin/pull/22412#issuecomment-947280111,947280111,
MarcoFalke,2021-07-07 11:54:45,This note is only true for broken versions of univalue. push_back in our tree works just fine.,https://github.com/bitcoin/bitcoin/pull/22412#discussion_r665299861,665299861,src/rpc/util.cpp
