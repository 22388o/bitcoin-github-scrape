achow101,2020-10-20 18:42:48,ACK 4dd26ef6e65f09f187d947497f15ada80ed5e6f5,https://github.com/bitcoin/bitcoin/pull/20199#issuecomment-713061912,713061912,
DrahtBot,2020-10-21 01:30:24,<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.,https://github.com/bitcoin/bitcoin/pull/20199#issuecomment-713234402,713234402,
luke-jr,2020-10-24 19:29:26,"Seems like a better fix would be to not save wallets in settings.json if they're specified by config/commandline? Seems pretty weird to run with a -wallet option one time, and get it autoloaded from then on...",https://github.com/bitcoin/bitcoin/pull/20199#issuecomment-716043663,716043663,
laanwj,2020-10-29 11:24:03,"@luke-jr Yes, managing manual loading versus command-line loading in a separate way to avoid this problem (e.g. a flag per wallet?) could be a further improvement.\n\nI do think this is at least a lot better than loading wallets twice or sudden startup errors.",https://github.com/bitcoin/bitcoin/pull/20199#issuecomment-718686784,718686784,
ryanofsky,2020-10-29 12:24:04,"> Seems pretty weird to run with a -wallet option one time, and get it autoloaded from then on...\n\nI don't think that's what's happening. List of wallets to load is only modified if you call createwallet/loadwallet/unloadwallet with load_on_startup=True, or if you cread/load/unload interactively from the GUI",https://github.com/bitcoin/bitcoin/pull/20199#issuecomment-718718417,718718417,
MarcoFalke,2020-10-29 14:10:36,"This still breaks git bisect, so it can't be merged: https://github.com/bitcoin/bitcoin/pull/20199#discussion_r509096109",https://github.com/bitcoin/bitcoin/pull/20199#issuecomment-718778652,718778652,
jonasschnelli,2020-11-03 10:36:14,Rebased and squashed. Re-added the test after @MarcoFalke and @promag recommendation.,https://github.com/bitcoin/bitcoin/pull/20199#issuecomment-721035253,721035253,
MarcoFalke,2020-11-03 10:45:38,"nit: There is a typo in the commit message, too\n\ndublicate -> duplicate",https://github.com/bitcoin/bitcoin/pull/20199#issuecomment-721039800,721039800,
jonasschnelli,2020-11-03 10:47:55,@MarcoFalke: thanks for spotting. Fixed.,https://github.com/bitcoin/bitcoin/pull/20199#issuecomment-721040935,721040935,
MarcoFalke,2020-11-03 10:57:38,"I presume the steps to reproduce in OP no longer work. The first two steps need to be removed and the third one replaced with ""create wallet (if via RPC set load_on_startup)""",https://github.com/bitcoin/bitcoin/pull/20199#issuecomment-721045619,721045619,
jonasschnelli,2020-11-03 11:03:31,Fixed the steps in OP.,https://github.com/bitcoin/bitcoin/pull/20199#issuecomment-721048553,721048553,
MarcoFalke,2020-11-04 12:54:22,"I am getting an ""Er"" ""Error:"" when testing\n\n```\n$ ./src/qt/bitcoin-qt -regtest -datadir=/tmp -wallet=/tmp/regtest/wallets/load/ -wallet=load\n```\n\n![Screenshot from 2020-11-04 13-52-33](https://user-images.githubusercontent.com/6399679/98114122-11ae3a00-1ea5-11eb-88e7-c678337ce6d5.png)\n",https://github.com/bitcoin/bitcoin/pull/20199#issuecomment-721714939,721714939,
jonasschnelli,2020-11-04 13:33:22,"@MarcoFalke:\nI'm getting a different error (seems valid though):\n./src/qt/bitcoin-qt --regtest --server --datadir=/tmp/dummy4 --wallet=/tmp/dummy4/regtest/wallets/test --wallet=test\n\n<img width=""507"" alt=""Bildschirmfoto 2020-11-04 um 14 31 28"" src=""https://user-images.githubusercontent.com/178464/98117744-7f109980-1eaa-11eb-9d73-86022caca7cd.png"">\n<img width=""532"" alt=""Bildschirmfoto 202",https://github.com/bitcoin/bitcoin/pull/20199#issuecomment-721734126,721734126,
promag,2020-11-04 14:07:13,"@MarcoFalke are you able to resize the error dialog?\n\nAfter\n```\n$ mkdir -p /tmp/regtest/wallets/load\n$ ./src/qt/bitcoin-qt -regtest -datadir=/tmp -wallet=/tmp/regtest/wallets/load/ -wallet=load\n```\nI get\n![Screenshot 2020-11-04 at 14 06 41](https://user-images.githubusercontent.com/3534524/98121293-04924a80-1ea7-11eb-91b4-0d00cfd9d07c.png)\n",https://github.com/bitcoin/bitcoin/pull/20199#issuecomment-721751913,721751913,
achow101,2020-11-04 22:16:56,Tested ACK 58cfbc38e040925b51cb8d35d23b50e9cf06fb2a,https://github.com/bitcoin/bitcoin/pull/20199#issuecomment-722004948,722004948,
MarcoFalke,2020-10-21 08:40:28,"The test can probably be kept, using `node.stop_node(expected_stderr='War...`\n\nEdit: Also needs to be squashed to not break git bisect on this test case",https://github.com/bitcoin/bitcoin/pull/20199#discussion_r509096109,509096109,test/functional/wallet_multiwallet.py
hebasto,2020-10-30 21:08:09,"4dd26ef6e65f09f187d947497f15ada80ed5e6f5\n\nnit: The term ""filename"" seems a bit incorrect for the `-wallet` argument value:\n```suggestion\n            chain.initWarning(strprintf(_(""Ignoring duplicate -wallet=%s argument.""), wallet_file));\n```",https://github.com/bitcoin/bitcoin/pull/20199#discussion_r515383671,515383671,src/wallet/load.cpp
MarcoFalke,2020-11-04 15:16:51,"```suggestion\n            if (!wallet_paths.insert(fs::absolute(name, GetWalletDir()).second) {\n```\n\nyou'll probably need something like this",https://github.com/bitcoin/bitcoin/pull/20199#discussion_r517418943,517418943,src/wallet/load.cpp
ryanofsky,2020-11-04 17:12:52,"re: https://github.com/bitcoin/bitcoin/pull/20199#discussion_r517418943\n\n> you'll probably need something like this\n\nThis doesn't seem like this best thing. What is it supposed to do? The name specified `-wallet=<name>` is significant and shouldn't be normalized or transformed for things to work right now. It needs to be used as the RPC endpoint name, so for example must match the `bitcoin",https://github.com/bitcoin/bitcoin/pull/20199#discussion_r517501836,517501836,src/wallet/load.cpp
ryanofsky,2020-11-04 17:25:15,"re: https://github.com/bitcoin/bitcoin/pull/20199#discussion_r517501836\n\n> We should figure out what's causing the error you reported [#20199 (comment)](https://github.com/bitcoin/bitcoin/pull/20199#issuecomment-721714939). It seems promag and jonas tried to reproduce it but haven't been able, if I'm following correctly\n\nI'd also be curious to know if that error is caused by this PR or hap",https://github.com/bitcoin/bitcoin/pull/20199#discussion_r517509772,517509772,src/wallet/load.cpp
MarcoFalke,2020-11-04 19:27:43,"> What is it supposed to do?\n\nIt is simply using the same duplicate check when loading all wallet that is used previously when verifying all wallets. The name isn't normalized or touched at all. The absolute path is only used to check for duplicates.\n\n> It seems promag and jonas tried to reproduce it but haven't been able\n\nJonas has reproduced it. I suspect the error message is differe",https://github.com/bitcoin/bitcoin/pull/20199#discussion_r517580432,517580432,src/wallet/load.cpp
ryanofsky,2020-11-04 20:19:06,"> > It seems promag and jonas tried to reproduce it but haven't been able\n> \n> Jonas has reproduced it. I suspect the error message is different because jonas used a bdb wallet and I used a sqlite wallet.\n\nIs this referring to https://github.com/bitcoin/bitcoin/pull/20199#issuecomment-721734126? The error Jonas reported there is a legitimate error that should *not* be a warning because the",https://github.com/bitcoin/bitcoin/pull/20199#discussion_r517607308,517607308,src/wallet/load.cpp
achow101,2020-11-04 22:21:33,"> Jonas has reproduced it. I suspect the error message is different because jonas used a bdb wallet and I used a sqlite wallet.\n\nThere are two different errors each related to the respective database type used.\n\nWhen BDB is used (as Jonas did), the error is because of BDB's requirement of unique wallet files. It is opening the second wallet and seeing that it's BDB ID is one that is alread",https://github.com/bitcoin/bitcoin/pull/20199#discussion_r517665467,517665467,src/wallet/load.cpp
ryanofsky,2020-11-04 23:28:36,"Just to add on, I think this PR does what it intended and is good in it's current form, but could be improved now or in the future to:\n\n1. Check for duplicate `wallet_file` values instead of duplicate `path` values in `VerifyWallets()` to avoid pointlessly showing a warning dialog before showing a different error dialog as described https://github.com/bitcoin/bitcoin/pull/20199#issuecomment-72",https://github.com/bitcoin/bitcoin/pull/20199#discussion_r517691457,517691457,src/wallet/load.cpp
MarcoFalke,2020-11-05 06:53:01,"Ok, clearly the wallet.dat files are the same, but I didn't know that they get different RPC endpoints (even when in the default `wallets` folder). Thanks for pointing that out.",https://github.com/bitcoin/bitcoin/pull/20199#discussion_r517825986,517825986,src/wallet/load.cpp
