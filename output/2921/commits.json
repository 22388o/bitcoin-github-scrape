[
  {
    "sha": "1621da04596fc6e8886b5be5c7bf67ffb9b08a60",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxNjIxZGEwNDU5NmZjNmU4ODg2YjViZTVjN2JmNjdmZmI5YjA4YTYw",
    "commit": {
      "author": {
        "name": "Kirill Berezin",
        "email": "enelar@develop-project.ru",
        "date": "2013-08-21T04:42:31Z"
      },
      "committer": {
        "name": "Kirill Berezin",
        "email": "enelar@develop-project.ru",
        "date": "2013-08-21T04:42:31Z"
      },
      "message": "Optimization TimingResistantEqual\n\nTime of comparison proportional length of shorter argument. Less\noperations on cycle. (Removing weight % operation).",
      "tree": {
        "sha": "f32c0cb7822536224b53f5190591578fa4e25f4e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f32c0cb7822536224b53f5190591578fa4e25f4e"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1621da04596fc6e8886b5be5c7bf67ffb9b08a60",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1621da04596fc6e8886b5be5c7bf67ffb9b08a60",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/1621da04596fc6e8886b5be5c7bf67ffb9b08a60",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1621da04596fc6e8886b5be5c7bf67ffb9b08a60/comments",
    "author": {
      "login": "Enelar",
      "id": 750396,
      "node_id": "MDQ6VXNlcjc1MDM5Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/750396?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Enelar",
      "html_url": "https://github.com/Enelar",
      "followers_url": "https://api.github.com/users/Enelar/followers",
      "following_url": "https://api.github.com/users/Enelar/following{/other_user}",
      "gists_url": "https://api.github.com/users/Enelar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Enelar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Enelar/subscriptions",
      "organizations_url": "https://api.github.com/users/Enelar/orgs",
      "repos_url": "https://api.github.com/users/Enelar/repos",
      "events_url": "https://api.github.com/users/Enelar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Enelar/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "Enelar",
      "id": 750396,
      "node_id": "MDQ6VXNlcjc1MDM5Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/750396?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Enelar",
      "html_url": "https://github.com/Enelar",
      "followers_url": "https://api.github.com/users/Enelar/followers",
      "following_url": "https://api.github.com/users/Enelar/following{/other_user}",
      "gists_url": "https://api.github.com/users/Enelar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Enelar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Enelar/subscriptions",
      "organizations_url": "https://api.github.com/users/Enelar/orgs",
      "repos_url": "https://api.github.com/users/Enelar/repos",
      "events_url": "https://api.github.com/users/Enelar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Enelar/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "b986663ccdd3dfd8a93aad660839a315ca5c5bdd",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b986663ccdd3dfd8a93aad660839a315ca5c5bdd",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/b986663ccdd3dfd8a93aad660839a315ca5c5bdd"
      }
    ],
    "stats": {
      "total": 19,
      "additions": 12,
      "deletions": 7
    },
    "files": [
      {
        "sha": "9b8e5c7423502c34b60d147f9cb7974a9ecfbc21",
        "filename": "src/util.h",
        "status": "modified",
        "additions": 12,
        "deletions": 7,
        "changes": 19,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1621da04596fc6e8886b5be5c7bf67ffb9b08a60/src/util.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1621da04596fc6e8886b5be5c7bf67ffb9b08a60/src/util.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util.h?ref=1621da04596fc6e8886b5be5c7bf67ffb9b08a60",
        "patch": "@@ -439,17 +439,22 @@ void seed_insecure_rand(bool fDeterministic=false);\n \n /**\n  * Timing-attack-resistant comparison.\n- * Takes time proportional to length\n- * of first argument.\n+ * Takes time proportional to minimum length\n+ * of arguments.\n  */\n template <typename T>\n bool TimingResistantEqual(const T& a, const T& b)\n {\n-    if (b.size() == 0) return a.size() == 0;\n-    size_t accumulator = a.size() ^ b.size();\n-    for (size_t i = 0; i < a.size(); i++)\n-        accumulator |= a[i] ^ b[i%b.size()];\n-    return accumulator == 0;\n+\tif (b.size() == 0) return a.size() == 0;\n+\tbool second_shorter = b.size() < a.size();\n+\tconst T\n+\t\t& A = second_shorter ? b : a,\n+\t\t& B = second_shorter ? a : b;\n+\t\n+\tsize_t accumulator = A.size() ^ B.size();\n+\tfor (size_t i = 0; i < A.size(); i++)\n+\t\taccumulator |= A[i] ^ B[i];\n+\treturn accumulator == 0;\n }\n \n /** Median filter over a stream of values."
      }
    ]
  },
  {
    "sha": "328433fbd5be0276da03a5199afc39ed5264c5e9",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozMjg0MzNmYmQ1YmUwMjc2ZGEwM2E1MTk5YWZjMzllZDUyNjRjNWU5",
    "commit": {
      "author": {
        "name": "Kirill Berezin",
        "email": "enelar@develop-project.ru",
        "date": "2013-08-21T04:56:27Z"
      },
      "committer": {
        "name": "Kirill Berezin",
        "email": "enelar@develop-project.ru",
        "date": "2013-08-21T04:56:27Z"
      },
      "message": "Speedup CMedianFilter\n\nBy the defer `rendering` of sorted values we gaining speed on multiply\nnumbers insert.",
      "tree": {
        "sha": "5d9c01b47c6ea00190309242982b810d5ac5207c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5d9c01b47c6ea00190309242982b810d5ac5207c"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/328433fbd5be0276da03a5199afc39ed5264c5e9",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/328433fbd5be0276da03a5199afc39ed5264c5e9",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/328433fbd5be0276da03a5199afc39ed5264c5e9",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/328433fbd5be0276da03a5199afc39ed5264c5e9/comments",
    "author": {
      "login": "Enelar",
      "id": 750396,
      "node_id": "MDQ6VXNlcjc1MDM5Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/750396?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Enelar",
      "html_url": "https://github.com/Enelar",
      "followers_url": "https://api.github.com/users/Enelar/followers",
      "following_url": "https://api.github.com/users/Enelar/following{/other_user}",
      "gists_url": "https://api.github.com/users/Enelar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Enelar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Enelar/subscriptions",
      "organizations_url": "https://api.github.com/users/Enelar/orgs",
      "repos_url": "https://api.github.com/users/Enelar/repos",
      "events_url": "https://api.github.com/users/Enelar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Enelar/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "Enelar",
      "id": 750396,
      "node_id": "MDQ6VXNlcjc1MDM5Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/750396?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Enelar",
      "html_url": "https://github.com/Enelar",
      "followers_url": "https://api.github.com/users/Enelar/followers",
      "following_url": "https://api.github.com/users/Enelar/following{/other_user}",
      "gists_url": "https://api.github.com/users/Enelar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Enelar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Enelar/subscriptions",
      "organizations_url": "https://api.github.com/users/Enelar/orgs",
      "repos_url": "https://api.github.com/users/Enelar/repos",
      "events_url": "https://api.github.com/users/Enelar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Enelar/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "1621da04596fc6e8886b5be5c7bf67ffb9b08a60",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1621da04596fc6e8886b5be5c7bf67ffb9b08a60",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/1621da04596fc6e8886b5be5c7bf67ffb9b08a60"
      }
    ],
    "stats": {
      "total": 23,
      "additions": 15,
      "deletions": 8
    },
    "files": [
      {
        "sha": "70a418ef9f5cd74ad7a54e64a9d3060e74055489",
        "filename": "src/util.h",
        "status": "modified",
        "additions": 15,
        "deletions": 8,
        "changes": 23,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/328433fbd5be0276da03a5199afc39ed5264c5e9/src/util.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/328433fbd5be0276da03a5199afc39ed5264c5e9/src/util.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util.h?ref=328433fbd5be0276da03a5199afc39ed5264c5e9",
        "patch": "@@ -464,33 +464,40 @@ template <typename T> class CMedianFilter\n {\n private:\n     std::vector<T> vValues;\n-    std::vector<T> vSorted;\n+    mutable std::vector<T> vSorted;\n     unsigned int nSize;\n+\n+    std::vector<T> &sorted_access() const\n+    {\n+      if (vSorted.size() != vValues.size())\n+      {\n+        vSorted.resize(vValues.size());\n+        std::copy(vValues.begin(), vValues.end(), vSorted.begin());\n+        std::sort(vSorted.begin(), vSorted.end());\n+      }\n+      return vSorted;\n+    }\n public:\n     CMedianFilter(unsigned int size, T initial_value):\n         nSize(size)\n     {\n         vValues.reserve(size);\n         vValues.push_back(initial_value);\n-        vSorted = vValues;\n     }\n \n     void input(T value)\n     {\n         if(vValues.size() == nSize)\n         {\n             vValues.erase(vValues.begin());\n+            sorted_access();\n         }\n         vValues.push_back(value);\n-\n-        vSorted.resize(vValues.size());\n-        std::copy(vValues.begin(), vValues.end(), vSorted.begin());\n-        std::sort(vSorted.begin(), vSorted.end());\n     }\n \n     T median() const\n     {\n-        int size = vSorted.size();\n+        int size = sorted_access().size();\n         assert(size>0);\n         if(size & 1) // Odd number of elements\n         {\n@@ -509,7 +516,7 @@ template <typename T> class CMedianFilter\n \n     std::vector<T> sorted () const\n     {\n-        return vSorted;\n+        return sorted_access();\n     }\n };\n "
      }
    ]
  },
  {
    "sha": "ee78b6c5292a6613d33223761c9a2548d936bd77",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplZTc4YjZjNTI5MmE2NjEzZDMzMjIzNzYxYzlhMjU0OGQ5MzZiZDc3",
    "commit": {
      "author": {
        "name": "Kirill Berezin",
        "email": "enelar@develop-project.ru",
        "date": "2013-08-21T04:59:41Z"
      },
      "committer": {
        "name": "Kirill Berezin",
        "email": "enelar@develop-project.ru",
        "date": "2013-08-21T04:59:41Z"
      },
      "message": "Skip copying arrays on constant usage\n\nMaybe, someone need to use sorted().size(), for that, he dont need\ncopying constructor",
      "tree": {
        "sha": "0b5220d83e989da24b35512687acb0d51a542460",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0b5220d83e989da24b35512687acb0d51a542460"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ee78b6c5292a6613d33223761c9a2548d936bd77",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ee78b6c5292a6613d33223761c9a2548d936bd77",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/ee78b6c5292a6613d33223761c9a2548d936bd77",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ee78b6c5292a6613d33223761c9a2548d936bd77/comments",
    "author": {
      "login": "Enelar",
      "id": 750396,
      "node_id": "MDQ6VXNlcjc1MDM5Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/750396?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Enelar",
      "html_url": "https://github.com/Enelar",
      "followers_url": "https://api.github.com/users/Enelar/followers",
      "following_url": "https://api.github.com/users/Enelar/following{/other_user}",
      "gists_url": "https://api.github.com/users/Enelar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Enelar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Enelar/subscriptions",
      "organizations_url": "https://api.github.com/users/Enelar/orgs",
      "repos_url": "https://api.github.com/users/Enelar/repos",
      "events_url": "https://api.github.com/users/Enelar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Enelar/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "Enelar",
      "id": 750396,
      "node_id": "MDQ6VXNlcjc1MDM5Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/750396?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Enelar",
      "html_url": "https://github.com/Enelar",
      "followers_url": "https://api.github.com/users/Enelar/followers",
      "following_url": "https://api.github.com/users/Enelar/following{/other_user}",
      "gists_url": "https://api.github.com/users/Enelar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Enelar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Enelar/subscriptions",
      "organizations_url": "https://api.github.com/users/Enelar/orgs",
      "repos_url": "https://api.github.com/users/Enelar/repos",
      "events_url": "https://api.github.com/users/Enelar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Enelar/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "328433fbd5be0276da03a5199afc39ed5264c5e9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/328433fbd5be0276da03a5199afc39ed5264c5e9",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/328433fbd5be0276da03a5199afc39ed5264c5e9"
      }
    ],
    "stats": {
      "total": 4,
      "additions": 2,
      "deletions": 2
    },
    "files": [
      {
        "sha": "2262138bdc6bc886bc13f4bdc4fd8717f2d1ac8e",
        "filename": "src/util.h",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ee78b6c5292a6613d33223761c9a2548d936bd77/src/util.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ee78b6c5292a6613d33223761c9a2548d936bd77/src/util.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util.h?ref=ee78b6c5292a6613d33223761c9a2548d936bd77",
        "patch": "@@ -497,7 +497,7 @@ template <typename T> class CMedianFilter\n \n     T median() const\n     {\n-        int size = sorted_access().size();\n+        int size = sorted().size();\n         assert(size>0);\n         if(size & 1) // Odd number of elements\n         {\n@@ -514,7 +514,7 @@ template <typename T> class CMedianFilter\n         return vValues.size();\n     }\n \n-    std::vector<T> sorted () const\n+    const std::vector<T> &sorted () const\n     {\n         return sorted_access();\n     }"
      }
    ]
  }
]