[
  {
    "sha": "da4f35a356bcb547836bf2da61a1a9de8420c77f",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkYTRmMzVhMzU2YmNiNTQ3ODM2YmYyZGE2MWExYTlkZTg0MjBjNzdm",
    "commit": {
      "author": {
        "name": "Gregory Maxwell",
        "email": "greg@xiph.org",
        "date": "2016-12-06T00:24:13Z"
      },
      "committer": {
        "name": "Gregory Maxwell",
        "email": "greg@xiph.org",
        "date": "2016-12-06T00:24:13Z"
      },
      "message": "Time-based expiration in LimitOrphanTxSize only when map is full.\n\nWhile testing using BIP152 using the orphan map I observed a\nround trip that occurred only because the relevant orphan was\ntime based expired first.\n\nThe purpose of the time based expiration is simply because the\nrandom eviction has particularly bad effects on chains of txn\n(it tends to poke holes in the chains, resulting in the pool\nfilling with things that are unconnectable).  As such, We don't\nreally need the time based until just before the random eviction\nwould take place.",
      "tree": {
        "sha": "b860d10f940c443e6ac72758a6c92b536484f8b1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b860d10f940c443e6ac72758a6c92b536484f8b1"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/da4f35a356bcb547836bf2da61a1a9de8420c77f",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/da4f35a356bcb547836bf2da61a1a9de8420c77f",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/da4f35a356bcb547836bf2da61a1a9de8420c77f",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/da4f35a356bcb547836bf2da61a1a9de8420c77f/comments",
    "author": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "7d5d44969b4ab46a5146a46b4ed1ed7704d71c63",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7d5d44969b4ab46a5146a46b4ed1ed7704d71c63",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/7d5d44969b4ab46a5146a46b4ed1ed7704d71c63"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 1,
      "deletions": 1
    },
    "files": [
      {
        "sha": "17f16e86cf2f9d88343e29d4957386687be90330",
        "filename": "src/net_processing.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/da4f35a356bcb547836bf2da61a1a9de8420c77f/src/net_processing.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/da4f35a356bcb547836bf2da61a1a9de8420c77f/src/net_processing.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net_processing.cpp?ref=da4f35a356bcb547836bf2da61a1a9de8420c77f",
        "patch": "@@ -656,7 +656,7 @@ unsigned int LimitOrphanTxSize(unsigned int nMaxOrphans) EXCLUSIVE_LOCKS_REQUIRE\n     unsigned int nEvicted = 0;\n     static int64_t nNextSweep;\n     int64_t nNow = GetTime();\n-    if (nNextSweep <= nNow) {\n+    if (mapOrphanTransactions.size() > nMaxOrphans && nNextSweep <= nNow) {\n         // Sweep out expired orphan pool entries:\n         int nErased = 0;\n         int64_t nMinExpTime = nNow + ORPHAN_TX_EXPIRE_TIME - ORPHAN_TX_EXPIRE_INTERVAL;"
      }
    ]
  }
]