DrahtBot,2020-11-11 02:57:42,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20864 (net: Move SocketSendData lock annotation to header by MarcoFalke)\n\nIf you consider this pull request important, ",https://github.com/bitcoin/bitcoin/pull/20364#issuecomment-725096733,725096733,
troygiorshev,2020-11-11 16:23:57,"CI fails with ""Timed out!"" when running the fuzz tests, at exactly 2h of running time.  Looks to be unrelated to this PR.",https://github.com/bitcoin/bitcoin/pull/20364#issuecomment-725519631,725519631,
MarcoFalke,2020-11-11 16:32:24,You can fix that by rebasing on current master,https://github.com/bitcoin/bitcoin/pull/20364#issuecomment-725524511,725524511,
troygiorshev,2020-11-17 05:40:42,"`git range-diff master ec4fd8a a10135e`\n\n* Trivial rebase to master, to fix the CI error",https://github.com/bitcoin/bitcoin/pull/20364#issuecomment-728699129,728699129,
troygiorshev,2020-11-17 05:53:34,"`git range-diff master a10135e 78fb468`\n\n* Initialized out parameter `reject_message`\n* Renamed COMMAND to MSGTYPE in error logs",https://github.com/bitcoin/bitcoin/pull/20364#issuecomment-728703461,728703461,
ryanofsky,2020-11-19 12:09:13,"> I'm not seeing what the benefit of dropping the optional is though, it just changes:\n\nThe benefit of dropping optional is that the calling code can reliably use `msg.m_raw_message_size`, instead of sometimes using `m_raw_message_size` and sometimes having to look in `out_err_raw_size` depending on the code path. It is easy to imagine a future change changing the logic a little and causing th",https://github.com/bitcoin/bitcoin/pull/20364#issuecomment-730330982,730330982,
DrahtBot,2021-01-07 15:06:15,"<!--cf906140f33d8803c4a75a2196329ecb-->\nüêô This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a ""draft"".</sub>",https://github.com/bitcoin/bitcoin/pull/20364#issuecomment-756172232,756172232,
jnewbery,2021-02-04 11:32:19,"Code review ACK 78fb468c7a1e5942cb1dc16864a4bbf8c85381ba\n\nNeeds rebase",https://github.com/bitcoin/bitcoin/pull/20364#issuecomment-773240155,773240155,
jnewbery,2021-02-04 11:33:49,"Suggest you remove ""For this part, I think this is a definite improvement, but I'm not sure it's the best solution.  Open to suggestions."" from the first commit log. The commit messages should be used to explain the code changes, and github should be used for review/meta-commentary.\n",https://github.com/bitcoin/bitcoin/pull/20364#issuecomment-773240981,773240981,
fanquake,2021-08-18 12:09:12,Closing this as up for grabs.,https://github.com/bitcoin/bitcoin/pull/20364#issuecomment-901059725,901059725,
ryanofsky,2020-11-11 21:29:35,"In commit ""Remove Optional from GetMessage"" (eb21969fe3fcd845d4060d890f7c46d703238661)\n\nMight be good to initialize `reject_message = false` here just to be clear this is an output parameter, not an in/out parameter",https://github.com/bitcoin/bitcoin/pull/20364#discussion_r521649581,521649581,src/net.cpp
MarcoFalke,2020-11-12 09:18:30,"```suggestion\n        LogPrint(BCLog::NET, ""HEADER ERROR - INVALID MSGTYPE (%s, %u bytes), peer=%d\n"",\n```\n\nstyle-nit: When changing the log message, might as well change command->msg type, which is preferred in new code.",https://github.com/bitcoin/bitcoin/pull/20364#discussion_r521953702,521953702,src/net.cpp
troygiorshev,2020-11-17 05:47:56,"I hesitated away from this just in case the caller wanted to reject the message for some other reason before calling GetMessage.  (So reject_message would already be true)\n\nHowever, now writing that out into words, I think that's an unlikely scenario, and I agree that setting it at the beginning makes things clearer.\n\nThanks, made the change!",https://github.com/bitcoin/bitcoin/pull/20364#discussion_r524898317,524898317,src/net.cpp
ajtowns,2020-11-19 08:39:57,`GetId()` is an inline method that returns id already; this change seems pretty pointless?,https://github.com/bitcoin/bitcoin/pull/20364#discussion_r526681998,526681998,src/net.cpp
ajtowns,2020-11-19 08:49:58,Should change this `.find()` to `.at()` as well?,https://github.com/bitcoin/bitcoin/pull/20364#discussion_r526688145,526688145,src/net.cpp
jnewbery,2021-02-04 11:14:51,"We should remove `GetId()` entirely. `id` is a const member so should just be made public.\n\nhttps://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines#Rh-get\n\nWe certainly shouldn't be using trivial getters inside `CNode` methods. They can access member variables directly.",https://github.com/bitcoin/bitcoin/pull/20364#discussion_r570141973,570141973,src/net.cpp
jnewbery,2021-02-04 11:31:26,"`std::map::at` returns a reference to the value, not an iterator on the map, which is what is required here for the `i->second` call below. Alternatively:\n\n```diff\ndiff --git a/src/net.cpp b/src/net.cpp\nindex 9c2a79b809..e6a3d69810 100644\n--- a/src/net.cpp\n+++ b/src/net.cpp\n@@ -670,11 +670,11 @@ bool CNode::ReceiveMsgBytes(const char *pch, unsigned int nBytes, bool& complete\n \n  ",https://github.com/bitcoin/bitcoin/pull/20364#discussion_r570152015,570152015,src/net.cpp
