[
  {
    "sha": "e9a1881b90704c6708cfba79d2208debbd4476d0",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplOWExODgxYjkwNzA0YzY3MDhjZmJhNzlkMjIwOGRlYmJkNDQ3NmQw",
    "commit": {
      "author": {
        "name": "Karl-Johan Alm",
        "email": "karljohan-alm@garage.co.jp",
        "date": "2018-05-17T07:30:00Z"
      },
      "committer": {
        "name": "Karl-Johan Alm",
        "email": "karljohan-alm@garage.co.jp",
        "date": "2018-05-30T03:23:44Z"
      },
      "message": "refactor: add a function for determining if a block is pruned or not",
      "tree": {
        "sha": "0fd589c336747139b3012995e183935023965f02",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0fd589c336747139b3012995e183935023965f02"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e9a1881b90704c6708cfba79d2208debbd4476d0",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEExCr/fGGz5EoUVM01V692LbM1MyIFAlsOGUEACgkQV692LbM1\nMyJNOA//fJt3kzLY/0AXQoA3OonM6iNO7hNqUYj4rG2OpukcKheCLcRhZCiuDUKK\nCoG5X2flUKW1SS15cNp0Jwf42603n9OljrOMZrTiDWcp4/hq+f6IGXWDMSgZf/Gq\n74PFY6IFgvuNqbzy38F1CfzAdJ0Phu+qwuBk5IDVFMbLkR24Ws8C1o0jwjtkDIvc\nQs/BRjB8eVeV3qzDDjNgGNKfQGjnsijbCImkljX/QPL31IRHqC4vcvEqnUXtdyNw\niN0h+TCQbTIJ4iXuUCpHF5aHa8PEL9rG/LAtym++HpYOcC9j682+QNuXfkK/TV+O\nquK6d+epnWiCssNSr8PF683c7Wu2wuwnpK/trWVOGDp2xmg9tYdhAIztoK0zwv8F\nJKdiIy3aP4qttLX01q4ft9xvu0z3ZXU70t4K9o7PpK/rKU+BnnLPmip4x51/as3N\n34GSnd29u1c5pnYZka/NI/14jkqaLHkRakJ5vNHeBeRD4GFV5EkjLoQQ8vJRi2OY\nUEJusTGQgWjNl7u53QVX+sGbS2jIek+nyoc3Uu3ngzZaZt6qymA4sG/oOS3byX2t\nVLcVVu/UyV6NcagIAw5PxYRElGzVs2/wE+7QyhJVzLJ3wJ+8zbqsB6A03TLansjt\nHn+/t51yF20Mk/7sQMjmQN/eGgqWvqJqQlUtwUqLjpvLnRrLnbk=\n=fem/\n-----END PGP SIGNATURE-----",
        "payload": "tree 0fd589c336747139b3012995e183935023965f02\nparent f8a29ca823fba7fc0eb63896ac4d3d5a0093a023\nauthor Karl-Johan Alm <karljohan-alm@garage.co.jp> 1526542200 +0900\ncommitter Karl-Johan Alm <karljohan-alm@garage.co.jp> 1527650624 +0900\n\nrefactor: add a function for determining if a block is pruned or not\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e9a1881b90704c6708cfba79d2208debbd4476d0",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/e9a1881b90704c6708cfba79d2208debbd4476d0",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e9a1881b90704c6708cfba79d2208debbd4476d0/comments",
    "author": {
      "login": "kallewoof",
      "id": 250224,
      "node_id": "MDQ6VXNlcjI1MDIyNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/250224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kallewoof",
      "html_url": "https://github.com/kallewoof",
      "followers_url": "https://api.github.com/users/kallewoof/followers",
      "following_url": "https://api.github.com/users/kallewoof/following{/other_user}",
      "gists_url": "https://api.github.com/users/kallewoof/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kallewoof/subscriptions",
      "organizations_url": "https://api.github.com/users/kallewoof/orgs",
      "repos_url": "https://api.github.com/users/kallewoof/repos",
      "events_url": "https://api.github.com/users/kallewoof/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kallewoof/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "kallewoof",
      "id": 250224,
      "node_id": "MDQ6VXNlcjI1MDIyNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/250224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kallewoof",
      "html_url": "https://github.com/kallewoof",
      "followers_url": "https://api.github.com/users/kallewoof/followers",
      "following_url": "https://api.github.com/users/kallewoof/following{/other_user}",
      "gists_url": "https://api.github.com/users/kallewoof/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kallewoof/subscriptions",
      "organizations_url": "https://api.github.com/users/kallewoof/orgs",
      "repos_url": "https://api.github.com/users/kallewoof/repos",
      "events_url": "https://api.github.com/users/kallewoof/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kallewoof/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "f8a29ca823fba7fc0eb63896ac4d3d5a0093a023",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f8a29ca823fba7fc0eb63896ac4d3d5a0093a023",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/f8a29ca823fba7fc0eb63896ac4d3d5a0093a023"
      }
    ],
    "stats": {
      "total": 10,
      "additions": 8,
      "deletions": 2
    },
    "files": [
      {
        "sha": "a5f164497da30aa6549cf3b61ba64a72503ecb01",
        "filename": "src/rest.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e9a1881b90704c6708cfba79d2208debbd4476d0/src/rest.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e9a1881b90704c6708cfba79d2208debbd4476d0/src/rest.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rest.cpp?ref=e9a1881b90704c6708cfba79d2208debbd4476d0",
        "patch": "@@ -217,7 +217,7 @@ static bool rest_block(HTTPRequest* req,\n             return RESTERR(req, HTTP_NOT_FOUND, hashStr + \" not found\");\n         }\n \n-        if (fHavePruned && !(pblockindex->nStatus & BLOCK_HAVE_DATA) && pblockindex->nTx > 0)\n+        if (IsBlockPruned(pblockindex))\n             return RESTERR(req, HTTP_NOT_FOUND, hashStr + \" not available (pruned data)\");\n \n         if (!ReadBlockFromDisk(block, pblockindex, Params().GetConsensus()))"
      },
      {
        "sha": "ea9eb3ecafa508b2431f30ea24e68a3bb9d37018",
        "filename": "src/rpc/blockchain.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e9a1881b90704c6708cfba79d2208debbd4476d0/src/rpc/blockchain.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e9a1881b90704c6708cfba79d2208debbd4476d0/src/rpc/blockchain.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/blockchain.cpp?ref=e9a1881b90704c6708cfba79d2208debbd4476d0",
        "patch": "@@ -742,7 +742,7 @@ static UniValue getblockheader(const JSONRPCRequest& request)\n static CBlock GetBlockChecked(const CBlockIndex* pblockindex)\n {\n     CBlock block;\n-    if (fHavePruned && !(pblockindex->nStatus & BLOCK_HAVE_DATA) && pblockindex->nTx > 0) {\n+    if (IsBlockPruned(pblockindex)) {\n         throw JSONRPCError(RPC_MISC_ERROR, \"Block not available (pruned data)\");\n     }\n "
      },
      {
        "sha": "04f5b6cb8082141eca15cf7d2c5f78f2a4136dfc",
        "filename": "src/validation.h",
        "status": "modified",
        "additions": 6,
        "deletions": 0,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e9a1881b90704c6708cfba79d2208debbd4476d0/src/validation.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e9a1881b90704c6708cfba79d2208debbd4476d0/src/validation.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/validation.h?ref=e9a1881b90704c6708cfba79d2208debbd4476d0",
        "patch": "@@ -497,4 +497,10 @@ bool DumpMempool();\n /** Load the mempool from disk. */\n bool LoadMempool();\n \n+//! Check whether the block associated with this index entry is pruned or not.\n+inline bool IsBlockPruned(const CBlockIndex* pblockindex)\n+{\n+    return (fHavePruned && !(pblockindex->nStatus & BLOCK_HAVE_DATA) && pblockindex->nTx > 0);\n+}\n+\n #endif // BITCOIN_VALIDATION_H"
      }
    ]
  }
]