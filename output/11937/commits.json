[
  {
    "sha": "872f281b6953840ca1f4360b9b0823e219265294",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4NzJmMjgxYjY5NTM4NDBjYTFmNDM2MGI5YjA4MjNlMjE5MjY1Mjk0",
    "commit": {
      "author": {
        "name": "Hampus Sj\u00f6berg",
        "email": "hampus.sjoberg@gmail.com",
        "date": "2017-12-17T20:29:24Z"
      },
      "committer": {
        "name": "Hampus Sj\u00f6berg",
        "email": "hampus.sjoberg@gmail.com",
        "date": "2018-06-03T21:46:24Z"
      },
      "message": "Qt: Adding address type GUI options\n\nThe Options-dialog now contains radio buttons for deciding which address\ntype to use (legacy, p2sh or BIP173 (bech32)).\n\nThis setting is connected to the `addresstype` parameter.",
      "tree": {
        "sha": "3998cbfd7b736f8ea261ff8ca8596489df9396ef",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3998cbfd7b736f8ea261ff8ca8596489df9396ef"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/872f281b6953840ca1f4360b9b0823e219265294",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/872f281b6953840ca1f4360b9b0823e219265294",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/872f281b6953840ca1f4360b9b0823e219265294",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/872f281b6953840ca1f4360b9b0823e219265294/comments",
    "author": {
      "login": "hsjoberg",
      "id": 3824379,
      "node_id": "MDQ6VXNlcjM4MjQzNzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3824379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hsjoberg",
      "html_url": "https://github.com/hsjoberg",
      "followers_url": "https://api.github.com/users/hsjoberg/followers",
      "following_url": "https://api.github.com/users/hsjoberg/following{/other_user}",
      "gists_url": "https://api.github.com/users/hsjoberg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hsjoberg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hsjoberg/subscriptions",
      "organizations_url": "https://api.github.com/users/hsjoberg/orgs",
      "repos_url": "https://api.github.com/users/hsjoberg/repos",
      "events_url": "https://api.github.com/users/hsjoberg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hsjoberg/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "hsjoberg",
      "id": 3824379,
      "node_id": "MDQ6VXNlcjM4MjQzNzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3824379?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hsjoberg",
      "html_url": "https://github.com/hsjoberg",
      "followers_url": "https://api.github.com/users/hsjoberg/followers",
      "following_url": "https://api.github.com/users/hsjoberg/following{/other_user}",
      "gists_url": "https://api.github.com/users/hsjoberg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hsjoberg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hsjoberg/subscriptions",
      "organizations_url": "https://api.github.com/users/hsjoberg/orgs",
      "repos_url": "https://api.github.com/users/hsjoberg/repos",
      "events_url": "https://api.github.com/users/hsjoberg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hsjoberg/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "e24bf1ce184bc8d5bba70a3f3e9c43c2df07f4d3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e24bf1ce184bc8d5bba70a3f3e9c43c2df07f4d3",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/e24bf1ce184bc8d5bba70a3f3e9c43c2df07f4d3"
      }
    ],
    "stats": {
      "total": 104,
      "additions": 104,
      "deletions": 0
    },
    "files": [
      {
        "sha": "eae87f2a65cea51bd2ebba4531613f5aaea63813",
        "filename": "src/qt/forms/optionsdialog.ui",
        "status": "modified",
        "additions": 51,
        "deletions": 0,
        "changes": 51,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/872f281b6953840ca1f4360b9b0823e219265294/src/qt/forms/optionsdialog.ui",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/872f281b6953840ca1f4360b9b0823e219265294/src/qt/forms/optionsdialog.ui",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/forms/optionsdialog.ui?ref=872f281b6953840ca1f4360b9b0823e219265294",
        "patch": "@@ -166,6 +166,57 @@\n          </layout>\n         </widget>\n        </item>\n+       <item>\n+        <widget class=\"QGroupBox\" name=\"groupBoxAddressType\">\n+         <property name=\"title\">\n+          <string>Address type</string>\n+         </property>\n+         <property name=\"checkable\">\n+          <bool>false</bool>\n+         </property>\n+         <layout class=\"QHBoxLayout\" name=\"horizontalLayout_2\">\n+          <item>\n+           <widget class=\"QRadioButton\" name=\"addressTypeLegacy\">\n+            <property name=\"sizePolicy\">\n+             <sizepolicy hsizetype=\"Minimum\" vsizetype=\"Fixed\">\n+              <horstretch>0</horstretch>\n+              <verstretch>0</verstretch>\n+             </sizepolicy>\n+            </property>\n+            <property name=\"text\">\n+             <string>Legacy</string>\n+            </property>\n+           </widget>\n+          </item>\n+          <item>\n+           <widget class=\"QRadioButton\" name=\"addressTypeP2SHSegWit\">\n+            <property name=\"sizePolicy\">\n+             <sizepolicy hsizetype=\"Minimum\" vsizetype=\"Fixed\">\n+              <horstretch>0</horstretch>\n+              <verstretch>0</verstretch>\n+             </sizepolicy>\n+            </property>\n+            <property name=\"text\">\n+             <string>P2SH-SegWit</string>\n+            </property>\n+           </widget>\n+          </item>\n+          <item>\n+           <widget class=\"QRadioButton\" name=\"addressTypeBech32\">\n+            <property name=\"sizePolicy\">\n+             <sizepolicy hsizetype=\"MinimumExpanding\" vsizetype=\"Fixed\">\n+              <horstretch>0</horstretch>\n+              <verstretch>0</verstretch>\n+             </sizepolicy>\n+            </property>\n+            <property name=\"text\">\n+             <string>Native SegWit (bech32)</string>\n+            </property>\n+           </widget>\n+          </item>\n+         </layout>\n+        </widget>\n+       </item>\n        <item>\n         <spacer name=\"verticalSpacer_Wallet\">\n          <property name=\"orientation\">"
      },
      {
        "sha": "fa23109629a0b6dc4f11807f4653359458221438",
        "filename": "src/qt/optionsdialog.cpp",
        "status": "modified",
        "additions": 22,
        "deletions": 0,
        "changes": 22,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/872f281b6953840ca1f4360b9b0823e219265294/src/qt/optionsdialog.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/872f281b6953840ca1f4360b9b0823e219265294/src/qt/optionsdialog.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/optionsdialog.cpp?ref=872f281b6953840ca1f4360b9b0823e219265294",
        "patch": "@@ -152,6 +152,7 @@ void OptionsDialog::setModel(OptionsModel *_model)\n         mapper->toFirst();\n \n         updateDefaultProxyNets();\n+        setActiveAddressType();\n     }\n \n     /* warn when one of the following settings changes by user action (placed here so init via mapper doesn't trigger them) */\n@@ -181,6 +182,10 @@ void OptionsDialog::setMapper()\n     mapper->addMapping(ui->spendZeroConfChange, OptionsModel::SpendZeroConfChange);\n     mapper->addMapping(ui->coinControlFeatures, OptionsModel::CoinControlFeatures);\n \n+    mapper->addMapping(ui->addressTypeLegacy, OptionsModel::AddressTypeLegacy);\n+    mapper->addMapping(ui->addressTypeP2SHSegWit, OptionsModel::AddressTypeP2SHSegWit);\n+    mapper->addMapping(ui->addressTypeBech32, OptionsModel::AddressTypeBech32);\n+\n     /* Network */\n     mapper->addMapping(ui->mapPortUpnp, OptionsModel::MapPortUPnP);\n     mapper->addMapping(ui->allowIncoming, OptionsModel::Listen);\n@@ -330,6 +335,23 @@ void OptionsDialog::updateDefaultProxyNets()\n     (strProxy == strDefaultProxyGUI.toStdString()) ? ui->proxyReachTor->setChecked(true) : ui->proxyReachTor->setChecked(false);\n }\n \n+void OptionsDialog::setActiveAddressType() {\n+    switch(g_address_type) {\n+    case OUTPUT_TYPE_LEGACY:\n+        ui->addressTypeLegacy->setChecked(true);\n+        break;\n+    case OUTPUT_TYPE_P2SH_SEGWIT:\n+        ui->addressTypeP2SHSegWit->setChecked(true);\n+        break;\n+    case OUTPUT_TYPE_BECH32:\n+        ui->addressTypeBech32->setChecked(true);\n+        break;\n+    case OUTPUT_TYPE_NONE:\n+    default:\n+        break;\n+    }\n+}\n+\n ProxyAddressValidator::ProxyAddressValidator(QObject *parent) :\n QValidator(parent)\n {"
      },
      {
        "sha": "88cf5bc696cced2144186fb8a5333af41237bdf5",
        "filename": "src/qt/optionsdialog.h",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/872f281b6953840ca1f4360b9b0823e219265294/src/qt/optionsdialog.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/872f281b6953840ca1f4360b9b0823e219265294/src/qt/optionsdialog.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/optionsdialog.h?ref=872f281b6953840ca1f4360b9b0823e219265294",
        "patch": "@@ -58,6 +58,7 @@ private Q_SLOTS:\n     void updateProxyValidationState();\n     /* query the networks, for which the default proxy is used */\n     void updateDefaultProxyNets();\n+    void setActiveAddressType();\n \n Q_SIGNALS:\n     void proxyIpChecks(QValidatedLineEdit *pUiProxyIp, int nProxyPort);"
      },
      {
        "sha": "bba2d1add9b47fe1a9485ef27321721b7a77c39c",
        "filename": "src/qt/optionsmodel.cpp",
        "status": "modified",
        "additions": 26,
        "deletions": 0,
        "changes": 26,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/872f281b6953840ca1f4360b9b0823e219265294/src/qt/optionsmodel.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/872f281b6953840ca1f4360b9b0823e219265294/src/qt/optionsmodel.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/optionsmodel.cpp?ref=872f281b6953840ca1f4360b9b0823e219265294",
        "patch": "@@ -107,6 +107,11 @@ void OptionsModel::Init(bool resetSettings)\n         settings.setValue(\"bSpendZeroConfChange\", true);\n     if (!m_node.softSetBoolArg(\"-spendzeroconfchange\", settings.value(\"bSpendZeroConfChange\").toBool()))\n         addOverriddenOption(\"-spendzeroconfchange\");\n+\n+    if (!settings.contains(\"strAddressType\"))\n+        settings.setValue(\"strAddressType\", QString::fromStdString(FormatOutputType(OUTPUT_TYPE_DEFAULT)));\n+    if (!gArgs.SoftSetArg(\"-addresstype\", settings.value(\"strAddressType\").toString().toStdString()))\n+        addOverriddenOption(\"-addresstype\");\n #endif\n \n     // Network\n@@ -383,6 +388,27 @@ bool OptionsModel::setData(const QModelIndex & index, const QVariant & value, in\n                 setRestartRequired(true);\n             }\n             break;\n+        case AddressTypeLegacy:\n+            if (value.toBool()) {\n+                settings.setValue(\"strAddressType\", QString::fromStdString(FormatOutputType(OUTPUT_TYPE_LEGACY)));\n+                g_address_type = OUTPUT_TYPE_LEGACY;\n+                g_change_type = ParseOutputType(gArgs.GetArg(\"-changetype\", \"\"), g_address_type);\n+            }\n+            break;\n+        case AddressTypeP2SHSegWit:\n+            if (value.toBool()) {\n+                settings.setValue(\"strAddressType\", QString::fromStdString(FormatOutputType(OUTPUT_TYPE_P2SH_SEGWIT)));\n+                g_address_type = OUTPUT_TYPE_P2SH_SEGWIT;\n+                g_change_type = ParseOutputType(gArgs.GetArg(\"-changetype\", \"\"), g_address_type);\n+            }\n+            break;\n+        case AddressTypeBech32:\n+            if (value.toBool()) {\n+                settings.setValue(\"strAddressType\", QString::fromStdString(FormatOutputType(OUTPUT_TYPE_BECH32)));\n+                g_address_type = OUTPUT_TYPE_BECH32;\n+                g_change_type = ParseOutputType(gArgs.GetArg(\"-changetype\", \"\"), g_address_type);\n+            }\n+            break;\n #endif\n         case DisplayUnit:\n             setDisplayUnit(value);"
      },
      {
        "sha": "e3af695abf346b263902fcf674df4056b57d1d44",
        "filename": "src/qt/optionsmodel.h",
        "status": "modified",
        "additions": 4,
        "deletions": 0,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/872f281b6953840ca1f4360b9b0823e219265294/src/qt/optionsmodel.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/872f281b6953840ca1f4360b9b0823e219265294/src/qt/optionsmodel.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/optionsmodel.h?ref=872f281b6953840ca1f4360b9b0823e219265294",
        "patch": "@@ -6,6 +6,7 @@\n #define BITCOIN_QT_OPTIONSMODEL_H\n \n #include <amount.h>\n+#include <wallet/wallet.h>\n \n #include <QAbstractListModel>\n \n@@ -52,6 +53,9 @@ class OptionsModel : public QAbstractListModel\n         ThreadsScriptVerif,     // int\n         DatabaseCache,          // int\n         SpendZeroConfChange,    // bool\n+        AddressTypeLegacy,      // bool\n+        AddressTypeP2SHSegWit,  // bool\n+        AddressTypeBech32,      // bool\n         Listen,                 // bool\n         OptionIDRowCount,\n     };"
      }
    ]
  }
]