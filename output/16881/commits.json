[
  {
    "sha": "87a8cbf5dccb76224b2934a2ee281a475cc04711",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4N2E4Y2JmNWRjY2I3NjIyNGIyOTM0YTJlZTI4MWE0NzVjYzA0NzEx",
    "commit": {
      "author": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2019-09-16T07:30:58Z"
      },
      "committer": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2019-09-16T07:38:12Z"
      },
      "message": "consensus: Improve CScriptNum error reporting\n\nInstead of reporting \"unknown error\", more specific messages are returned for CScriptNum related errors.\n\nOriginal PR: #15074\n\nCo-Authored-By: Johnson Lau <jl2012@xbt.hk>",
      "tree": {
        "sha": "9395063462d99f863309103cb47da3e27173d53d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9395063462d99f863309103cb47da3e27173d53d"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/87a8cbf5dccb76224b2934a2ee281a475cc04711",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz7FuIclQ9n+pXlWPLuufXMCVJsEFAl1/O/UACgkQLuufXMCV\nJsEoew/+IblAiUqgq0IY8GcEi1GegexACK3Ea+BbyeszggcadvlyCSe/B/C2Ekgc\nlrB4yHqSsa14ZfgqdpY97mg2dQNMk6ojToIWmbCjpL5rsaLY+e0vWPU7dPHK64UF\nXiQgjnkJDq1Ud96vXAf4zv72B00xj9qkEW+pFMz8tUU/EnianHA5nA8DGdDedHoq\nyRsSH0Dq6H+kWPmcKrYEW+YntosIvcCW1ryqbhZ02RUMC+WaJMcEDxqefrnnZMCD\nrhQ856Io0k3FL8HIMFFK/5Jp7psphjQ+uG3dfLzm0VuNfJh8nCwVQpkoDfE0okC3\n3vi8CncSHFoQNn9Ba4j6s9Dw1/JJoPH9S1sIJIYT8a04kuXPq7MfW0RblL8lTdbQ\ntkk6/NhVf2JBLfDTbO6jgjD/uKiGSfmUF4RBEx6Gm7gh6itZFJBw5QnFtma70qj9\nLArPNdKQ/pwVB0D+6gTsQPwSALq9YDBlQ9/RFtNj3GsNxA2VT0wWzsJil9FvjiA7\nGiOJY1stW0Nx1EWsQvlFwtPsrdrgQqjfXu6mM7rmZn82W3K5EJ6MOKqxcgx3YmWH\nvu3a6+4RBePwArbt/OEoVhnBsA98Ta46QqUMUaaQ1BMaPELt7NHUXHCFe5knyuTW\nzA0aIt5a6l9xXG79Q/kFD990s1YCf2yDUi4VzZjvM3raStkh83E=\n=/zbZ\n-----END PGP SIGNATURE-----",
        "payload": "tree 9395063462d99f863309103cb47da3e27173d53d\nparent 9debfd0e28413df1ba669f614aa44bb652fedb32\nauthor fanquake <fanquake@gmail.com> 1568619058 +0800\ncommitter fanquake <fanquake@gmail.com> 1568619492 +0800\n\nconsensus: Improve CScriptNum error reporting\n\nInstead of reporting \"unknown error\", more specific messages are returned for CScriptNum related errors.\n\nOriginal PR: #15074\n\nCo-Authored-By: Johnson Lau <jl2012@xbt.hk>\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/87a8cbf5dccb76224b2934a2ee281a475cc04711",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/87a8cbf5dccb76224b2934a2ee281a475cc04711",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/87a8cbf5dccb76224b2934a2ee281a475cc04711/comments",
    "author": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "9debfd0e28413df1ba669f614aa44bb652fedb32",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9debfd0e28413df1ba669f614aa44bb652fedb32",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/9debfd0e28413df1ba669f614aa44bb652fedb32"
      }
    ],
    "stats": {
      "total": 161,
      "additions": 84,
      "deletions": 77
    },
    "files": [
      {
        "sha": "962567e886b2eb6af3c68fa02d5c6f196d294286",
        "filename": "src/script/interpreter.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/87a8cbf5dccb76224b2934a2ee281a475cc04711/src/script/interpreter.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/87a8cbf5dccb76224b2934a2ee281a475cc04711/src/script/interpreter.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script/interpreter.cpp?ref=87a8cbf5dccb76224b2934a2ee281a475cc04711",
        "patch": "@@ -1071,6 +1071,8 @@ bool EvalScript(std::vector<std::vector<unsigned char> >& stack, const CScript&\n             if (stack.size() + altstack.size() > MAX_STACK_SIZE)\n                 return set_error(serror, SCRIPT_ERR_STACK_SIZE);\n         }\n+    } catch (ScriptError runtime_error) {\n+        return set_error(serror, runtime_error);\n     }\n     catch (...)\n     {"
      },
      {
        "sha": "a794faeca19604de2ebfe9f983d547eb4803124a",
        "filename": "src/script/script.h",
        "status": "modified",
        "additions": 3,
        "deletions": 8,
        "changes": 11,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/87a8cbf5dccb76224b2934a2ee281a475cc04711/src/script/script.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/87a8cbf5dccb76224b2934a2ee281a475cc04711/src/script/script.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script/script.h?ref=87a8cbf5dccb76224b2934a2ee281a475cc04711",
        "patch": "@@ -9,6 +9,7 @@\n #include <crypto/common.h>\n #include <prevector.h>\n #include <serialize.h>\n+#include <script/script_error.h>\n \n #include <assert.h>\n #include <climits>\n@@ -195,12 +196,6 @@ static const unsigned int MAX_OPCODE = OP_NOP10;\n \n const char* GetOpName(opcodetype opcode);\n \n-class scriptnum_error : public std::runtime_error\n-{\n-public:\n-    explicit scriptnum_error(const std::string& str) : std::runtime_error(str) {}\n-};\n-\n class CScriptNum\n {\n /**\n@@ -224,7 +219,7 @@ class CScriptNum\n                         const size_t nMaxNumSize = nDefaultMaxNumSize)\n     {\n         if (vch.size() > nMaxNumSize) {\n-            throw scriptnum_error(\"script number overflow\");\n+            throw SCRIPT_ERR_NUMOVERFLOW;\n         }\n         if (fRequireMinimal && vch.size() > 0) {\n             // Check that the number is encoded with the minimum possible\n@@ -240,7 +235,7 @@ class CScriptNum\n                 // is +-255, which encode to 0xff00 and 0xff80 respectively.\n                 // (big-endian).\n                 if (vch.size() <= 1 || (vch[vch.size() - 2] & 0x80) == 0) {\n-                    throw scriptnum_error(\"non-minimally encoded script number\");\n+                    throw SCRIPT_ERR_MINIMALNUM;\n                 }\n             }\n         }"
      },
      {
        "sha": "8fdea2e297c1cce47d934cdefa523101c59b275b",
        "filename": "src/script/script_error.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 0,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/87a8cbf5dccb76224b2934a2ee281a475cc04711/src/script/script_error.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/87a8cbf5dccb76224b2934a2ee281a475cc04711/src/script/script_error.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script/script_error.cpp?ref=87a8cbf5dccb76224b2934a2ee281a475cc04711",
        "patch": "@@ -93,6 +93,10 @@ const char* ScriptErrorString(const ScriptError serror)\n             return \"Using OP_CODESEPARATOR in non-witness script\";\n         case SCRIPT_ERR_SIG_FINDANDDELETE:\n             return \"Signature is found in scriptCode\";\n+        case SCRIPT_ERR_NUMOVERFLOW:\n+            return \"Script number overflow\";\n+        case SCRIPT_ERR_MINIMALNUM:\n+            return \"Non-minimally encoded script number\";\n         case SCRIPT_ERR_UNKNOWN_ERROR:\n         case SCRIPT_ERR_ERROR_COUNT:\n         default: break;"
      },
      {
        "sha": "beedfb21b15a4d211165e175ad30f7bd4d1bca52",
        "filename": "src/script/script_error.h",
        "status": "modified",
        "additions": 4,
        "deletions": 0,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/87a8cbf5dccb76224b2934a2ee281a475cc04711/src/script/script_error.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/87a8cbf5dccb76224b2934a2ee281a475cc04711/src/script/script_error.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script/script_error.h?ref=87a8cbf5dccb76224b2934a2ee281a475cc04711",
        "patch": "@@ -68,6 +68,10 @@ typedef enum ScriptError_t\n     SCRIPT_ERR_OP_CODESEPARATOR,\n     SCRIPT_ERR_SIG_FINDANDDELETE,\n \n+    /* Script Num */\n+    SCRIPT_ERR_NUMOVERFLOW,\n+    SCRIPT_ERR_MINIMALNUM,\n+\n     SCRIPT_ERR_ERROR_COUNT\n } ScriptError;\n "
      },
      {
        "sha": "a1e277bc6278d4842869a285f44b1bed481487fa",
        "filename": "src/test/data/script_tests.json",
        "status": "modified",
        "additions": 69,
        "deletions": 69,
        "changes": 138,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/87a8cbf5dccb76224b2934a2ee281a475cc04711/src/test/data/script_tests.json",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/87a8cbf5dccb76224b2934a2ee281a475cc04711/src/test/data/script_tests.json",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/data/script_tests.json?ref=87a8cbf5dccb76224b2934a2ee281a475cc04711",
        "patch": "@@ -856,10 +856,10 @@\n [\"1 1 ADD\", \"0 EQUAL\", \"P2SH,STRICTENC\", \"EVAL_FALSE\"],\n [\"11 1 ADD 12 SUB\", \"11 EQUAL\", \"P2SH,STRICTENC\", \"EVAL_FALSE\"],\n \n-[\"2147483648 0 ADD\", \"NOP\", \"P2SH,STRICTENC\", \"UNKNOWN_ERROR\", \"arithmetic operands must be in range [-2^31...2^31] \"],\n-[\"-2147483648 0 ADD\", \"NOP\", \"P2SH,STRICTENC\", \"UNKNOWN_ERROR\", \"arithmetic operands must be in range [-2^31...2^31] \"],\n-[\"2147483647 DUP ADD\", \"4294967294 NUMEQUAL\", \"P2SH,STRICTENC\", \"UNKNOWN_ERROR\", \"NUMEQUAL must be in numeric range\"],\n-[\"'abcdef' NOT\", \"0 EQUAL\", \"P2SH,STRICTENC\", \"UNKNOWN_ERROR\", \"NOT is an arithmetic operand\"],\n+[\"2147483648 0 ADD\", \"NOP\", \"P2SH,STRICTENC\", \"NUMOVERFLOW\", \"arithmetic operands must be in range [-2^31...2^31] \"],\n+[\"-2147483648 0 ADD\", \"NOP\", \"P2SH,STRICTENC\", \"NUMOVERFLOW\", \"arithmetic operands must be in range [-2^31...2^31] \"],\n+[\"2147483647 DUP ADD\", \"4294967294 NUMEQUAL\", \"P2SH,STRICTENC\", \"NUMOVERFLOW\", \"NUMEQUAL must be in numeric range\"],\n+[\"'abcdef' NOT\", \"0 EQUAL\", \"P2SH,STRICTENC\", \"NUMOVERFLOW\", \"NOT is an arithmetic operand\"],\n \n [\"2 DUP MUL\", \"4 EQUAL\", \"P2SH,STRICTENC\", \"DISABLED_OPCODE\", \"disabled\"],\n [\"2 DUP DIV\", \"1 EQUAL\", \"P2SH,STRICTENC\", \"DISABLED_OPCODE\", \"disabled\"],\n@@ -1013,14 +1013,14 @@\n [\"1\",\"RESERVED2\", \"P2SH,STRICTENC\", \"BAD_OPCODE\", \"OP_RESERVED2 is reserved\"],\n [\"1\",\"0xba\", \"P2SH,STRICTENC\", \"BAD_OPCODE\", \"0xba == MAX_OPCODE + 1\"],\n \n-[\"2147483648\", \"1ADD 1\", \"P2SH,STRICTENC\", \"UNKNOWN_ERROR\", \"We cannot do math on 5-byte integers\"],\n-[\"2147483648\", \"NEGATE 1\", \"P2SH,STRICTENC\", \"UNKNOWN_ERROR\", \"We cannot do math on 5-byte integers\"],\n-[\"-2147483648\", \"1ADD 1\", \"P2SH,STRICTENC\", \"UNKNOWN_ERROR\", \"Because we use a sign bit, -2147483648 is also 5 bytes\"],\n-[\"2147483647\", \"1ADD 1SUB 1\", \"P2SH,STRICTENC\", \"UNKNOWN_ERROR\", \"We cannot do math on 5-byte integers, even if the result is 4-bytes\"],\n-[\"2147483648\", \"1SUB 1\", \"P2SH,STRICTENC\", \"UNKNOWN_ERROR\", \"We cannot do math on 5-byte integers, even if the result is 4-bytes\"],\n+[\"2147483648\", \"1ADD 1\", \"P2SH,STRICTENC\", \"NUMOVERFLOW\", \"We cannot do math on 5-byte integers\"],\n+[\"2147483648\", \"NEGATE 1\", \"P2SH,STRICTENC\", \"NUMOVERFLOW\", \"We cannot do math on 5-byte integers\"],\n+[\"-2147483648\", \"1ADD 1\", \"P2SH,STRICTENC\", \"NUMOVERFLOW\", \"Because we use a sign bit, -2147483648 is also 5 bytes\"],\n+[\"2147483647\", \"1ADD 1SUB 1\", \"P2SH,STRICTENC\", \"NUMOVERFLOW\", \"We cannot do math on 5-byte integers, even if the result is 4-bytes\"],\n+[\"2147483648\", \"1SUB 1\", \"P2SH,STRICTENC\", \"NUMOVERFLOW\", \"We cannot do math on 5-byte integers, even if the result is 4-bytes\"],\n \n-[\"2147483648 1\", \"BOOLOR 1\", \"P2SH,STRICTENC\", \"UNKNOWN_ERROR\", \"We cannot do BOOLOR on 5-byte integers (but we can still do IF etc)\"],\n-[\"2147483648 1\", \"BOOLAND 1\", \"P2SH,STRICTENC\", \"UNKNOWN_ERROR\", \"We cannot do BOOLAND on 5-byte integers\"],\n+[\"2147483648 1\", \"BOOLOR 1\", \"P2SH,STRICTENC\", \"NUMOVERFLOW\", \"We cannot do BOOLOR on 5-byte integers (but we can still do IF etc)\"],\n+[\"2147483648 1\", \"BOOLAND 1\", \"P2SH,STRICTENC\", \"NUMOVERFLOW\", \"We cannot do BOOLAND on 5-byte integers\"],\n \n [\"1\", \"1 ENDIF\", \"P2SH,STRICTENC\", \"UNBALANCED_CONDITIONAL\", \"ENDIF without IF\"],\n [\"1\", \"IF 1\", \"P2SH,STRICTENC\", \"UNBALANCED_CONDITIONAL\", \"IF without ENDIF\"],\n@@ -1166,66 +1166,66 @@\n \n [\"MINIMALDATA enforcement for numeric arguments\"],\n \n-[\"0x01 0x00\", \"NOT DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\", \"numequals 0\"],\n-[\"0x02 0x0000\", \"NOT DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\", \"numequals 0\"],\n-[\"0x01 0x80\", \"NOT DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\", \"0x80 (negative zero) numequals 0\"],\n-[\"0x02 0x0080\", \"NOT DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\", \"numequals 0\"],\n-[\"0x02 0x0500\", \"NOT DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\", \"numequals 5\"],\n-[\"0x03 0x050000\", \"NOT DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\", \"numequals 5\"],\n-[\"0x02 0x0580\", \"NOT DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\", \"numequals -5\"],\n-[\"0x03 0x050080\", \"NOT DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\", \"numequals -5\"],\n-[\"0x03 0xff7f80\", \"NOT DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\", \"Minimal encoding is 0xffff\"],\n-[\"0x03 0xff7f00\", \"NOT DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\", \"Minimal encoding is 0xff7f\"],\n-[\"0x04 0xffff7f80\", \"NOT DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\", \"Minimal encoding is 0xffffff\"],\n-[\"0x04 0xffff7f00\", \"NOT DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\", \"Minimal encoding is 0xffff7f\"],\n+[\"0x01 0x00\", \"NOT DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\", \"numequals 0\"],\n+[\"0x02 0x0000\", \"NOT DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\", \"numequals 0\"],\n+[\"0x01 0x80\", \"NOT DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\", \"0x80 (negative zero) numequals 0\"],\n+[\"0x02 0x0080\", \"NOT DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\", \"numequals 0\"],\n+[\"0x02 0x0500\", \"NOT DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\", \"numequals 5\"],\n+[\"0x03 0x050000\", \"NOT DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\", \"numequals 5\"],\n+[\"0x02 0x0580\", \"NOT DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\", \"numequals -5\"],\n+[\"0x03 0x050080\", \"NOT DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\", \"numequals -5\"],\n+[\"0x03 0xff7f80\", \"NOT DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\", \"Minimal encoding is 0xffff\"],\n+[\"0x03 0xff7f00\", \"NOT DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\", \"Minimal encoding is 0xff7f\"],\n+[\"0x04 0xffff7f80\", \"NOT DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\", \"Minimal encoding is 0xffffff\"],\n+[\"0x04 0xffff7f00\", \"NOT DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\", \"Minimal encoding is 0xffff7f\"],\n \n [\"Test every numeric-accepting opcode for correct handling of the numeric minimal encoding rule\"],\n \n-[\"1 0x02 0x0000\", \"PICK DROP\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"1 0x02 0x0000\", \"ROLL DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0x02 0x0000\", \"1ADD DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0x02 0x0000\", \"1SUB DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0x02 0x0000\", \"NEGATE DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0x02 0x0000\", \"ABS DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0x02 0x0000\", \"NOT DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0x02 0x0000\", \"0NOTEQUAL DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-\n-[\"0 0x02 0x0000\", \"ADD DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0x02 0x0000 0\", \"ADD DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0 0x02 0x0000\", \"SUB DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0x02 0x0000 0\", \"SUB DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0 0x02 0x0000\", \"BOOLAND DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0x02 0x0000 0\", \"BOOLAND DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0 0x02 0x0000\", \"BOOLOR DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0x02 0x0000 0\", \"BOOLOR DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0 0x02 0x0000\", \"NUMEQUAL DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0x02 0x0000 1\", \"NUMEQUAL DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0 0x02 0x0000\", \"NUMEQUALVERIFY 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0x02 0x0000 0\", \"NUMEQUALVERIFY 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0 0x02 0x0000\", \"NUMNOTEQUAL DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0x02 0x0000 0\", \"NUMNOTEQUAL DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0 0x02 0x0000\", \"LESSTHAN DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0x02 0x0000 0\", \"LESSTHAN DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0 0x02 0x0000\", \"GREATERTHAN DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0x02 0x0000 0\", \"GREATERTHAN DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0 0x02 0x0000\", \"LESSTHANOREQUAL DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0x02 0x0000 0\", \"LESSTHANOREQUAL DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0 0x02 0x0000\", \"GREATERTHANOREQUAL DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0x02 0x0000 0\", \"GREATERTHANOREQUAL DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0 0x02 0x0000\", \"MIN DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0x02 0x0000 0\", \"MIN DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0 0x02 0x0000\", \"MAX DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0x02 0x0000 0\", \"MAX DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-\n-[\"0x02 0x0000 0 0\", \"WITHIN DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0 0x02 0x0000 0\", \"WITHIN DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0 0 0x02 0x0000\", \"WITHIN DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-\n-[\"0 0 0x02 0x0000\", \"CHECKMULTISIG DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0 0x02 0x0000 0\", \"CHECKMULTISIG DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0 0x02 0x0000 0 1\", \"CHECKMULTISIG DROP 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0 0 0x02 0x0000\", \"CHECKMULTISIGVERIFY 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n-[\"0 0x02 0x0000 0\", \"CHECKMULTISIGVERIFY 1\", \"MINIMALDATA\", \"UNKNOWN_ERROR\"],\n+[\"1 0x02 0x0000\", \"PICK DROP\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"1 0x02 0x0000\", \"ROLL DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0x02 0x0000\", \"1ADD DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0x02 0x0000\", \"1SUB DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0x02 0x0000\", \"NEGATE DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0x02 0x0000\", \"ABS DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0x02 0x0000\", \"NOT DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0x02 0x0000\", \"0NOTEQUAL DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+\n+[\"0 0x02 0x0000\", \"ADD DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0x02 0x0000 0\", \"ADD DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0 0x02 0x0000\", \"SUB DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0x02 0x0000 0\", \"SUB DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0 0x02 0x0000\", \"BOOLAND DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0x02 0x0000 0\", \"BOOLAND DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0 0x02 0x0000\", \"BOOLOR DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0x02 0x0000 0\", \"BOOLOR DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0 0x02 0x0000\", \"NUMEQUAL DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0x02 0x0000 1\", \"NUMEQUAL DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0 0x02 0x0000\", \"NUMEQUALVERIFY 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0x02 0x0000 0\", \"NUMEQUALVERIFY 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0 0x02 0x0000\", \"NUMNOTEQUAL DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0x02 0x0000 0\", \"NUMNOTEQUAL DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0 0x02 0x0000\", \"LESSTHAN DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0x02 0x0000 0\", \"LESSTHAN DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0 0x02 0x0000\", \"GREATERTHAN DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0x02 0x0000 0\", \"GREATERTHAN DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0 0x02 0x0000\", \"LESSTHANOREQUAL DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0x02 0x0000 0\", \"LESSTHANOREQUAL DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0 0x02 0x0000\", \"GREATERTHANOREQUAL DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0x02 0x0000 0\", \"GREATERTHANOREQUAL DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0 0x02 0x0000\", \"MIN DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0x02 0x0000 0\", \"MIN DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0 0x02 0x0000\", \"MAX DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0x02 0x0000 0\", \"MAX DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+\n+[\"0x02 0x0000 0 0\", \"WITHIN DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0 0x02 0x0000 0\", \"WITHIN DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0 0 0x02 0x0000\", \"WITHIN DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+\n+[\"0 0 0x02 0x0000\", \"CHECKMULTISIG DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0 0x02 0x0000 0\", \"CHECKMULTISIG DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0 0x02 0x0000 0 1\", \"CHECKMULTISIG DROP 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0 0 0x02 0x0000\", \"CHECKMULTISIGVERIFY 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n+[\"0 0x02 0x0000 0\", \"CHECKMULTISIGVERIFY 1\", \"MINIMALDATA\", \"MINIMALNUM\"],\n \n \n [\"Order of CHECKMULTISIG evaluation tests, inverted by swapping the order of\"],\n@@ -2518,7 +2518,7 @@\n [\"CHECKSEQUENCEVERIFY tests\"],\n [\"\", \"CHECKSEQUENCEVERIFY\", \"CHECKSEQUENCEVERIFY\", \"INVALID_STACK_OPERATION\", \"CSV automatically fails on an empty stack\"],\n [\"-1\", \"CHECKSEQUENCEVERIFY\", \"CHECKSEQUENCEVERIFY\", \"NEGATIVE_LOCKTIME\", \"CSV automatically fails if stack top is negative\"],\n-[\"0x0100\", \"CHECKSEQUENCEVERIFY\", \"CHECKSEQUENCEVERIFY,MINIMALDATA\", \"UNKNOWN_ERROR\", \"CSV fails if stack top is not minimally encoded\"],\n+[\"0x0100\", \"CHECKSEQUENCEVERIFY\", \"CHECKSEQUENCEVERIFY,MINIMALDATA\", \"MINIMALNUM\", \"CSV fails if stack top is not minimally encoded\"],\n [\"0\", \"CHECKSEQUENCEVERIFY\", \"CHECKSEQUENCEVERIFY\", \"UNSATISFIED_LOCKTIME\", \"CSV fails if stack top bit 1 << 31 is set and the tx version < 2\"],\n [\"4294967296\", \"CHECKSEQUENCEVERIFY\", \"CHECKSEQUENCEVERIFY\", \"UNSATISFIED_LOCKTIME\",\n   \"CSV fails if stack top bit 1 << 31 is not set, and tx version < 2\"],"
      },
      {
        "sha": "bed2cbda1758156b13cc4e634043afea695c3d82",
        "filename": "src/test/script_tests.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/87a8cbf5dccb76224b2934a2ee281a475cc04711/src/test/script_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/87a8cbf5dccb76224b2934a2ee281a475cc04711/src/test/script_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/script_tests.cpp?ref=87a8cbf5dccb76224b2934a2ee281a475cc04711",
        "patch": "@@ -99,6 +99,8 @@ static ScriptErrorDesc script_errors[]={\n     {SCRIPT_ERR_WITNESS_PUBKEYTYPE, \"WITNESS_PUBKEYTYPE\"},\n     {SCRIPT_ERR_OP_CODESEPARATOR, \"OP_CODESEPARATOR\"},\n     {SCRIPT_ERR_SIG_FINDANDDELETE, \"SIG_FINDANDDELETE\"},\n+    {SCRIPT_ERR_NUMOVERFLOW, \"NUMOVERFLOW\"},\n+    {SCRIPT_ERR_MINIMALNUM, \"MINIMALNUM\"},\n };\n \n static const char *FormatScriptError(ScriptError_t err)"
      }
    ]
  },
  {
    "sha": "7260d6b5ec305f320e9fcfae03bdfc1129c093c1",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3MjYwZDZiNWVjMzA1ZjMyMGU5ZmNmYWUwM2JkZmMxMTI5YzA5M2Mx",
    "commit": {
      "author": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2019-09-16T07:33:20Z"
      },
      "committer": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2019-09-16T07:38:29Z"
      },
      "message": "consensus: assert that opcodes are in a valid range\n\nReplace throw with assert in case opcode is negative or bigger than 0xff, which should never happen.\n\nOriginal PR: 15074\n\nCo-Authored-By: Johnson Lau <jl2012@xbt.hk>",
      "tree": {
        "sha": "7aa5f3c660987022ab8055f2d1a0703de1cbb77b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7aa5f3c660987022ab8055f2d1a0703de1cbb77b"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7260d6b5ec305f320e9fcfae03bdfc1129c093c1",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz7FuIclQ9n+pXlWPLuufXMCVJsEFAl1/PAQACgkQLuufXMCV\nJsHArQ//RTFiVFQScqMIl6YDPZ7jx8zklHXbHt4UWFbFeBtF50WCJw3Jjxs27RrU\nAwcHF5rLu4PMAMd8iPIu8WHXJUUTyv4sgSnNHjugp807gDbvEDlwU6hBf39jeD2F\n5OH+BMzlTlFwkdnF6nKcmxPWl3jvlhVw0IlTDTO0pHnPJSX4Y/bY1ewBhwfOdj1/\n8BarNUsB+aWgu9SsHEMk5NDPVmf/QiQsj7eZvG3ibaFF8YbikHJ/O6C7kQX2mWXk\nsZTXpjwgT6C6Z8L9prhtDAamOT3rMczlLuRI8ejuUFSdcqXkISri2hyFHp7VSZuB\ncWipHDuAoz7AJjR9lYBkcLiDF2E1fOrVwVtMZI2tUz71X4iKzcJkeR/qBC5mYCUo\n6Tu4QJiOa34Gd8KlnujuGypUu6nHSsAaCmgVsvSrv+l6pFo/up03rjT2OQIO+ck5\n7UtyDLvHAkaKlJvkaAE9yJ4UeSPm8X6SuEk8WNv2mTfoTY5vboJABS+tjFtcqrLW\nr+wzrlfC8EKSVtC20BxF1znf1N5d4akqU2vB5KRwcatF+YX+PzMbts92traZ++Ob\ni/7J5uwPII4oizI0XKdsUQyTYkL1q3NJyRvnjzLyBptzBN2GyUQaWD+h26PKR9PS\nZz9BdB2oeVgyFDIAAMvzLJ4HBn200wzZWct8TWuerjhWgec6rIY=\n=4kLK\n-----END PGP SIGNATURE-----",
        "payload": "tree 7aa5f3c660987022ab8055f2d1a0703de1cbb77b\nparent 87a8cbf5dccb76224b2934a2ee281a475cc04711\nauthor fanquake <fanquake@gmail.com> 1568619200 +0800\ncommitter fanquake <fanquake@gmail.com> 1568619509 +0800\n\nconsensus: assert that opcodes are in a valid range\n\nReplace throw with assert in case opcode is negative or bigger than 0xff, which should never happen.\n\nOriginal PR: 15074\n\nCo-Authored-By: Johnson Lau <jl2012@xbt.hk>\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7260d6b5ec305f320e9fcfae03bdfc1129c093c1",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/7260d6b5ec305f320e9fcfae03bdfc1129c093c1",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7260d6b5ec305f320e9fcfae03bdfc1129c093c1/comments",
    "author": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "87a8cbf5dccb76224b2934a2ee281a475cc04711",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/87a8cbf5dccb76224b2934a2ee281a475cc04711",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/87a8cbf5dccb76224b2934a2ee281a475cc04711"
      }
    ],
    "stats": {
      "total": 3,
      "additions": 1,
      "deletions": 2
    },
    "files": [
      {
        "sha": "210af8605e2189cb2f858b63574b927fc9cfaf05",
        "filename": "src/script/script.h",
        "status": "modified",
        "additions": 1,
        "deletions": 2,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7260d6b5ec305f320e9fcfae03bdfc1129c093c1/src/script/script.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7260d6b5ec305f320e9fcfae03bdfc1129c093c1/src/script/script.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script/script.h?ref=7260d6b5ec305f320e9fcfae03bdfc1129c093c1",
        "patch": "@@ -441,8 +441,7 @@ class CScript : public CScriptBase\n \n     CScript& operator<<(opcodetype opcode)\n     {\n-        if (opcode < 0 || opcode > 0xff)\n-            throw std::runtime_error(\"CScript::operator<<(): invalid opcode\");\n+        assert(opcode >= 0 && opcode <= 0xff);\n         insert(end(), (unsigned char)opcode);\n         return *this;\n     }"
      }
    ]
  }
]