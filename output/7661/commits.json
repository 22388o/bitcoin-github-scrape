[
  {
    "sha": "faccb1818cdc2c14e0d4b4db1c6b19ed935af470",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYWNjYjE4MThjZGMyYzE0ZTBkNGI0ZGIxYzZiMTllZDkzNWFmNDcw",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2016-03-09T11:54:32Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2016-03-09T15:13:13Z"
      },
      "message": "[amount] Extend GetFee() by optional flag ceil\n\n* This flag causes rounding up to the next satoshi instead of just\n  truncating (default behavior)\n\n* This reverts the hard-to-read and buggy code introduced in\n  d88af560111863c3e9c1ae855dcc287f04dffb02",
      "tree": {
        "sha": "a7a0f10366554bfb0a2b1fa69992c224e3de6589",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a7a0f10366554bfb0a2b1fa69992c224e3de6589"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/faccb1818cdc2c14e0d4b4db1c6b19ed935af470",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faccb1818cdc2c14e0d4b4db1c6b19ed935af470",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/faccb1818cdc2c14e0d4b4db1c6b19ed935af470",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faccb1818cdc2c14e0d4b4db1c6b19ed935af470/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "3cd836c1d855b92e7c73ab31979f471c4f8dad68",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3cd836c1d855b92e7c73ab31979f471c4f8dad68",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/3cd836c1d855b92e7c73ab31979f471c4f8dad68"
      }
    ],
    "stats": {
      "total": 80,
      "additions": 69,
      "deletions": 11
    },
    "files": [
      {
        "sha": "453471a4edfb69fc042a0f05f7970bbc6e216c63",
        "filename": "src/Makefile.test.include",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faccb1818cdc2c14e0d4b4db1c6b19ed935af470/src/Makefile.test.include",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faccb1818cdc2c14e0d4b4db1c6b19ed935af470/src/Makefile.test.include",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.test.include?ref=faccb1818cdc2c14e0d4b4db1c6b19ed935af470",
        "patch": "@@ -38,6 +38,7 @@ BITCOIN_TESTS =\\\n   test/scriptnum10.h \\\n   test/addrman_tests.cpp \\\n   test/alert_tests.cpp \\\n+  test/amount_tests.cpp \\\n   test/allocator_tests.cpp \\\n   test/base32_tests.cpp \\\n   test/base58_tests.cpp \\"
      },
      {
        "sha": "83792f5436492502ee24407a0bb52f9cf8cd5bec",
        "filename": "src/amount.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 7,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faccb1818cdc2c14e0d4b4db1c6b19ed935af470/src/amount.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faccb1818cdc2c14e0d4b4db1c6b19ed935af470/src/amount.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/amount.cpp?ref=faccb1818cdc2c14e0d4b4db1c6b19ed935af470",
        "patch": "@@ -3,6 +3,8 @@\n // Distributed under the MIT software license, see the accompanying\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n+#include <cmath>\n+\n #include \"amount.h\"\n \n #include \"tinyformat.h\"\n@@ -17,14 +19,12 @@ CFeeRate::CFeeRate(const CAmount& nFeePaid, size_t nSize)\n         nSatoshisPerK = 0;\n }\n \n-CAmount CFeeRate::GetFee(size_t nSize) const\n+CAmount CFeeRate::GetFee(size_t nSize, bool ceil) const\n {\n-    CAmount nFee = nSatoshisPerK*nSize / 1000;\n-\n-    if (nFee == 0 && nSatoshisPerK > 0)\n-        nFee = nSatoshisPerK;\n-\n-    return nFee;\n+    if (ceil)\n+        return (CAmount)std::ceil(nSatoshisPerK * nSize / 1000.);\n+    else\n+        return nSatoshisPerK * nSize / 1000;\n }\n \n std::string CFeeRate::ToString() const"
      },
      {
        "sha": "00a19cc51c89af0821288795ae30b5234eff9d78",
        "filename": "src/amount.h",
        "status": "modified",
        "additions": 8,
        "deletions": 4,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faccb1818cdc2c14e0d4b4db1c6b19ed935af470/src/amount.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faccb1818cdc2c14e0d4b4db1c6b19ed935af470/src/amount.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/amount.h?ref=faccb1818cdc2c14e0d4b4db1c6b19ed935af470",
        "patch": "@@ -42,10 +42,14 @@ class CFeeRate\n     explicit CFeeRate(const CAmount& _nSatoshisPerK): nSatoshisPerK(_nSatoshisPerK) { }\n     CFeeRate(const CAmount& nFeePaid, size_t nSize);\n     CFeeRate(const CFeeRate& other) { nSatoshisPerK = other.nSatoshisPerK; }\n-\n-    CAmount GetFee(size_t size) const; // unit returned is satoshis\n-    CAmount GetFeePerK() const { return GetFee(1000); } // satoshis-per-1000-bytes\n-\n+    /**\n+     * Return the fee in satoshis for the given size in bytes.\n+     */\n+    CAmount GetFee(size_t size, bool ceil = false) const;\n+    /**\n+     * Return the fee in satoshis for a size of 1000 bytes\n+     */\n+    CAmount GetFeePerK() const { return nSatoshisPerK; }\n     friend bool operator<(const CFeeRate& a, const CFeeRate& b) { return a.nSatoshisPerK < b.nSatoshisPerK; }\n     friend bool operator>(const CFeeRate& a, const CFeeRate& b) { return a.nSatoshisPerK > b.nSatoshisPerK; }\n     friend bool operator==(const CFeeRate& a, const CFeeRate& b) { return a.nSatoshisPerK == b.nSatoshisPerK; }"
      },
      {
        "sha": "781984450acd1c22960a8681ef6df7d483f560c5",
        "filename": "src/test/amount_tests.cpp",
        "status": "added",
        "additions": 53,
        "deletions": 0,
        "changes": 53,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faccb1818cdc2c14e0d4b4db1c6b19ed935af470/src/test/amount_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faccb1818cdc2c14e0d4b4db1c6b19ed935af470/src/test/amount_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/amount_tests.cpp?ref=faccb1818cdc2c14e0d4b4db1c6b19ed935af470",
        "patch": "@@ -0,0 +1,53 @@\n+// Copyright (c) 2016 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"amount.h\"\n+#include \"test/test_bitcoin.h\"\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_FIXTURE_TEST_SUITE(amount_tests, BasicTestingSetup)\n+\n+BOOST_AUTO_TEST_CASE(GetFeeTest)\n+{\n+    CFeeRate feeRate;\n+\n+    feeRate = CFeeRate(1000);\n+    // Must always just return the arg\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(0), 0);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(1), 1);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(121), 121);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(999), 999);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(1e3), 1e3);\n+\n+    feeRate = CFeeRate(123);\n+    // Truncates the result, if not integer\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(0), 0);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(8), 0);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(9), 1);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(121), 14);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(122), 15);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(999), 122);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(1e3), 123);\n+\n+    feeRate = CFeeRate(1000);\n+    // Must always return the arg\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(0, true), 0);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(1, true), 1);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(121, true), 121);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(999, true), 999);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(1e3, true), 1e3);\n+\n+    feeRate = CFeeRate(123);\n+    // Applies ceil to the result\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(0, true), 0);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(8, true), 1);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(9, true), 2);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(121, true), 15);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(122, true), 16);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(999, true), 123);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(1e3, true), 123);\n+}\n+\n+BOOST_AUTO_TEST_SUITE_END()"
      }
    ]
  },
  {
    "sha": "f0058cdee4a9b3207db0d68857471dc3200c937f",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmMDA1OGNkZWU0YTliMzIwN2RiMGQ2ODg1NzQ3MWRjMzIwMGM5Mzdm",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2016-03-09T16:03:36Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2016-03-09T16:03:36Z"
      },
      "message": "Merge branch 'Mf1603-amountCeil' into HEAD",
      "tree": {
        "sha": "8cf73df61942e123f5b22997716f3aa1f4cee20d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8cf73df61942e123f5b22997716f3aa1f4cee20d"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f0058cdee4a9b3207db0d68857471dc3200c937f",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f0058cdee4a9b3207db0d68857471dc3200c937f",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/f0058cdee4a9b3207db0d68857471dc3200c937f",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f0058cdee4a9b3207db0d68857471dc3200c937f/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "87d65622996d6b6539dba973a4427e542cc291c7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/87d65622996d6b6539dba973a4427e542cc291c7",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/87d65622996d6b6539dba973a4427e542cc291c7"
      },
      {
        "sha": "faccb1818cdc2c14e0d4b4db1c6b19ed935af470",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faccb1818cdc2c14e0d4b4db1c6b19ed935af470",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/faccb1818cdc2c14e0d4b4db1c6b19ed935af470"
      }
    ],
    "stats": {
      "total": 80,
      "additions": 69,
      "deletions": 11
    },
    "files": [
      {
        "sha": "24e4c8c02430fb68db16702b63752ac6d76570c9",
        "filename": "src/Makefile.test.include",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f0058cdee4a9b3207db0d68857471dc3200c937f/src/Makefile.test.include",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f0058cdee4a9b3207db0d68857471dc3200c937f/src/Makefile.test.include",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.test.include?ref=f0058cdee4a9b3207db0d68857471dc3200c937f",
        "patch": "@@ -38,6 +38,7 @@ BITCOIN_TESTS =\\\n   test/scriptnum10.h \\\n   test/addrman_tests.cpp \\\n   test/alert_tests.cpp \\\n+  test/amount_tests.cpp \\\n   test/allocator_tests.cpp \\\n   test/base32_tests.cpp \\\n   test/base58_tests.cpp \\"
      },
      {
        "sha": "cd00972f18e0e5d86c89565d1b6cf647078d7140",
        "filename": "src/amount.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 7,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f0058cdee4a9b3207db0d68857471dc3200c937f/src/amount.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f0058cdee4a9b3207db0d68857471dc3200c937f/src/amount.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/amount.cpp?ref=f0058cdee4a9b3207db0d68857471dc3200c937f",
        "patch": "@@ -3,6 +3,8 @@\n // Distributed under the MIT software license, see the accompanying\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n+#include <cmath>\n+\n #include \"amount.h\"\n \n #include \"tinyformat.h\"\n@@ -17,14 +19,12 @@ CFeeRate::CFeeRate(const CAmount& nFeePaid, size_t nSize)\n         nSatoshisPerK = 0;\n }\n \n-CAmount CFeeRate::GetFee(size_t nSize) const\n+CAmount CFeeRate::GetFee(size_t nSize, bool ceil) const\n {\n-    CAmount nFee = nSatoshisPerK*nSize / 1000;\n-\n-    if (nFee == 0 && nSatoshisPerK > 0)\n-        nFee = nSatoshisPerK;\n-\n-    return nFee;\n+    if (ceil)\n+        return (CAmount)std::ceil(nSatoshisPerK * nSize / 1000.);\n+    else\n+        return nSatoshisPerK * nSize / 1000;\n }\n \n std::string CFeeRate::ToString() const"
      },
      {
        "sha": "99714e816b309640899efd27d7d9e6b1c878b0ca",
        "filename": "src/amount.h",
        "status": "modified",
        "additions": 8,
        "deletions": 4,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f0058cdee4a9b3207db0d68857471dc3200c937f/src/amount.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f0058cdee4a9b3207db0d68857471dc3200c937f/src/amount.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/amount.h?ref=f0058cdee4a9b3207db0d68857471dc3200c937f",
        "patch": "@@ -42,10 +42,14 @@ class CFeeRate\n     explicit CFeeRate(const CAmount& _nSatoshisPerK): nSatoshisPerK(_nSatoshisPerK) { }\n     CFeeRate(const CAmount& nFeePaid, size_t nSize);\n     CFeeRate(const CFeeRate& other) { nSatoshisPerK = other.nSatoshisPerK; }\n-\n-    CAmount GetFee(size_t size) const; // unit returned is satoshis\n-    CAmount GetFeePerK() const { return GetFee(1000); } // satoshis-per-1000-bytes\n-\n+    /**\n+     * Return the fee in satoshis for the given size in bytes.\n+     */\n+    CAmount GetFee(size_t size, bool ceil = false) const;\n+    /**\n+     * Return the fee in satoshis for a size of 1000 bytes\n+     */\n+    CAmount GetFeePerK() const { return nSatoshisPerK; }\n     friend bool operator<(const CFeeRate& a, const CFeeRate& b) { return a.nSatoshisPerK < b.nSatoshisPerK; }\n     friend bool operator>(const CFeeRate& a, const CFeeRate& b) { return a.nSatoshisPerK > b.nSatoshisPerK; }\n     friend bool operator==(const CFeeRate& a, const CFeeRate& b) { return a.nSatoshisPerK == b.nSatoshisPerK; }"
      },
      {
        "sha": "781984450acd1c22960a8681ef6df7d483f560c5",
        "filename": "src/test/amount_tests.cpp",
        "status": "added",
        "additions": 53,
        "deletions": 0,
        "changes": 53,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f0058cdee4a9b3207db0d68857471dc3200c937f/src/test/amount_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f0058cdee4a9b3207db0d68857471dc3200c937f/src/test/amount_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/amount_tests.cpp?ref=f0058cdee4a9b3207db0d68857471dc3200c937f",
        "patch": "@@ -0,0 +1,53 @@\n+// Copyright (c) 2016 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include \"amount.h\"\n+#include \"test/test_bitcoin.h\"\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_FIXTURE_TEST_SUITE(amount_tests, BasicTestingSetup)\n+\n+BOOST_AUTO_TEST_CASE(GetFeeTest)\n+{\n+    CFeeRate feeRate;\n+\n+    feeRate = CFeeRate(1000);\n+    // Must always just return the arg\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(0), 0);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(1), 1);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(121), 121);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(999), 999);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(1e3), 1e3);\n+\n+    feeRate = CFeeRate(123);\n+    // Truncates the result, if not integer\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(0), 0);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(8), 0);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(9), 1);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(121), 14);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(122), 15);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(999), 122);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(1e3), 123);\n+\n+    feeRate = CFeeRate(1000);\n+    // Must always return the arg\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(0, true), 0);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(1, true), 1);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(121, true), 121);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(999, true), 999);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(1e3, true), 1e3);\n+\n+    feeRate = CFeeRate(123);\n+    // Applies ceil to the result\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(0, true), 0);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(8, true), 1);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(9, true), 2);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(121, true), 15);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(122, true), 16);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(999, true), 123);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(1e3, true), 123);\n+}\n+\n+BOOST_AUTO_TEST_SUITE_END()"
      }
    ]
  },
  {
    "sha": "1923bb13de2bb45646b3437ecfa1781df15f88e9",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxOTIzYmIxM2RlMmJiNDU2NDZiMzQzN2VjZmExNzgxZGYxNWY4OGU5",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2016-03-09T16:00:37Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2016-03-09T16:14:59Z"
      },
      "message": "[wallet] Round up to the next satoshi on odd fee rates",
      "tree": {
        "sha": "bf7dd9de887854b4965a7584bffe146b6b794399",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bf7dd9de887854b4965a7584bffe146b6b794399"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1923bb13de2bb45646b3437ecfa1781df15f88e9",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1923bb13de2bb45646b3437ecfa1781df15f88e9",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/1923bb13de2bb45646b3437ecfa1781df15f88e9",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1923bb13de2bb45646b3437ecfa1781df15f88e9/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "f0058cdee4a9b3207db0d68857471dc3200c937f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f0058cdee4a9b3207db0d68857471dc3200c937f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/f0058cdee4a9b3207db0d68857471dc3200c937f"
      }
    ],
    "stats": {
      "total": 22,
      "additions": 16,
      "deletions": 6
    },
    "files": [
      {
        "sha": "5a2e29e1ece362baa60d7530e8e99f53fcd614d7",
        "filename": "src/test/amount_tests.cpp",
        "status": "modified",
        "additions": 10,
        "deletions": 0,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1923bb13de2bb45646b3437ecfa1781df15f88e9/src/test/amount_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1923bb13de2bb45646b3437ecfa1781df15f88e9/src/test/amount_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/amount_tests.cpp?ref=1923bb13de2bb45646b3437ecfa1781df15f88e9",
        "patch": "@@ -48,6 +48,16 @@ BOOST_AUTO_TEST_CASE(GetFeeTest)\n     BOOST_CHECK_EQUAL(feeRate.GetFee(122, true), 16);\n     BOOST_CHECK_EQUAL(feeRate.GetFee(999, true), 123);\n     BOOST_CHECK_EQUAL(feeRate.GetFee(1e3, true), 123);\n+\n+    feeRate = CFeeRate(1);\n+    // Check rounding for really small fee rates\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(0, true), 0);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(1, true), 1);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(1e3, true), 1);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(0), 0);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(1), 0);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(999), 0);\n+    BOOST_CHECK_EQUAL(feeRate.GetFee(1e3), 1);\n }\n \n BOOST_AUTO_TEST_SUITE_END()"
      },
      {
        "sha": "9542aaad39686276205127bba2e7bd5d71c05a09",
        "filename": "src/wallet/wallet.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 6,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1923bb13de2bb45646b3437ecfa1781df15f88e9/src/wallet/wallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1923bb13de2bb45646b3437ecfa1781df15f88e9/src/wallet/wallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/wallet.cpp?ref=1923bb13de2bb45646b3437ecfa1781df15f88e9",
        "patch": "@@ -2212,8 +2212,7 @@ bool CWallet::CreateTransaction(const vector<CRecipient>& vecSend, CWalletTx& wt\n \n                 // If we made it here and we aren't even able to meet the relay fee on the next pass, give up\n                 // because we must be at the maximum allowed fee.\n-                if (nFeeNeeded < ::minRelayTxFee.GetFee(nBytes))\n-                {\n+                if (nFeeNeeded < ::minRelayTxFee.GetFee(nBytes, true)) {\n                     strFailReason = _(\"Transaction too large for fee policy\");\n                     return false;\n                 }\n@@ -2297,20 +2296,21 @@ bool CWallet::AddAccountingEntry(const CAccountingEntry& acentry, CWalletDB & pw\n \n CAmount CWallet::GetRequiredFee(unsigned int nTxBytes)\n {\n-    return std::max(minTxFee.GetFee(nTxBytes), ::minRelayTxFee.GetFee(nTxBytes));\n+    return std::max(minTxFee.GetFee(nTxBytes, true),\n+        ::minRelayTxFee.GetFee(nTxBytes, true));\n }\n \n CAmount CWallet::GetMinimumFee(unsigned int nTxBytes, unsigned int nConfirmTarget, const CTxMemPool& pool)\n {\n     // payTxFee is user-set \"I want to pay this much\"\n-    CAmount nFeeNeeded = payTxFee.GetFee(nTxBytes);\n+    CAmount nFeeNeeded = payTxFee.GetFee(nTxBytes, true);\n     // User didn't set: use -txconfirmtarget to estimate...\n     if (nFeeNeeded == 0) {\n         int estimateFoundTarget = nConfirmTarget;\n-        nFeeNeeded = pool.estimateSmartFee(nConfirmTarget, &estimateFoundTarget).GetFee(nTxBytes);\n+        nFeeNeeded = pool.estimateSmartFee(nConfirmTarget, &estimateFoundTarget).GetFee(nTxBytes, true);\n         // ... unless we don't have enough mempool data for estimatefee, then use fallbackFee\n         if (nFeeNeeded == 0)\n-            nFeeNeeded = fallbackFee.GetFee(nTxBytes);\n+            nFeeNeeded = fallbackFee.GetFee(nTxBytes, true);\n     }\n     // prevent user from paying a fee below minRelayTxFee or minTxFee\n     nFeeNeeded = std::max(nFeeNeeded, GetRequiredFee(nTxBytes));"
      }
    ]
  }
]