laanwj,2017-11-28T07:23:43Z,Concept ACK,https://github.com/bitcoin/bitcoin/pull/11779#issuecomment-347435932,347435932,
jnewbery,2017-11-28T13:05:41Z,"Concept ACK.  My only concern would be if combine_logs.py wasn't reliable and this could potentially lead to us losing important logging information. However, I've been using combine_logs regularly for 6+ months and haven't had any problems with it yet.\n\nDo you have a branch on top of this where you've introduced a test failure to trigger this in Travis? If so, can you link to it?",https://github.com/bitcoin/bitcoin/pull/11779#issuecomment-347517513,347517513,
MarcoFalke,2017-11-28T15:14:41Z,"@jnewbery You can test locally with\n\n```sh\nPYTHON_DEBUG=1 ./test/functional/test_runner.py\n```\n\nAn example run would be any of the red ones out of https://travis-ci.org/bitcoin/bitcoin/builds/308465667",https://github.com/bitcoin/bitcoin/pull/11779#issuecomment-347554805,347554805,
MarcoFalke,2017-11-28T17:39:03Z,I think moving it to test_runner.py makes sense. Taking a look...,https://github.com/bitcoin/bitcoin/pull/11779#issuecomment-347603046,347603046,
MarcoFalke,2017-11-28T23:06:37Z,"Again, there should be red travis failures in https://travis-ci.org/bitcoin/bitcoin/builds/308698327 soon.\n\nThough, I'd recommend to test locally with\n\n```sh\nTRAVIS=true ./test/functional/test_runner.py",https://github.com/bitcoin/bitcoin/pull/11779#issuecomment-347694600,347694600,
jnewbery,2017-11-29T16:31:43Z,"This is better. I think it can be improved further as follows:\n\n- no need to modify combine_logs to be an importable module - we can just call it as a subprocess from test_runner.\n- this prints out the combined logs *after* the summary table of results. It's useful to have those results at the bottom so it's very quick to see which tests have failed at a glance.\n- as @laanwj points out, it",https://github.com/bitcoin/bitcoin/pull/11779#issuecomment-347916849,347916849,
MarcoFalke,2017-11-29T17:13:54Z,@jnewbery Awesome! Thanks for picking this up. Mind to submit a pull for that?,https://github.com/bitcoin/bitcoin/pull/11779#issuecomment-347930227,347930227,
jnewbery,2017-11-29T17:25:52Z,"> Awesome! Thanks for picking this up. Mind to submit a pull for that?\n\nI didn't realise suggesting changes implied I'd picked this up! :slightly_frowning_face:",https://github.com/bitcoin/bitcoin/pull/11779#issuecomment-347933847,347933847,
jnewbery,2017-11-29T17:32:25Z,"as discussed, I'll open a new PR",https://github.com/bitcoin/bitcoin/pull/11779#issuecomment-347935812,347935812,
jnewbery,2017-11-28T16:36:04Z,"Python reference: https://docs.python.org/3/library/logging.html#logging.shutdown :\n\n> This should be called at application exit and no further use of the logging system should be made after this call.\n\nYou're calling `log.info()` after this call, and also calling `logging.shutdown()` a second time.\n\nPerhaps to avoid this, you could move this whole block to below the last call to `self",https://github.com/bitcoin/bitcoin/pull/11779#discussion_r153549096,153549096,test/functional/test_framework/test_framework.py
jnewbery,2017-11-28T16:38:13Z,"nit: I have a preference for:\n\n`print('\nCombine the logs and print the last {} lines ...\n'.format(lines))`\n\nrather than the empty `print()` function calls.",https://github.com/bitcoin/bitcoin/pull/11779#discussion_r153549729,153549729,test/functional/test_framework/test_framework.py
MarcoFalke,2017-11-28T17:37:25Z,Should be fine. I call `sys.exit` a few lines below.,https://github.com/bitcoin/bitcoin/pull/11779#discussion_r153567662,153567662,test/functional/test_framework/test_framework.py
promag,2017-11-28T23:31:01Z,Move to .travis.yml?,https://github.com/bitcoin/bitcoin/pull/11779#discussion_r153655215,153655215,test/functional/test_runner.py
laanwj,2017-11-29T10:40:49Z,"You mean, make `LINES_PRINT_TRAVIS` the environment variable instead of `TRAVIS`?",https://github.com/bitcoin/bitcoin/pull/11779#discussion_r153750363,153750363,test/functional/test_runner.py
laanwj,2017-11-29T10:41:38Z,"Could it be useful to have this as a general command line option, instead of a hidden environment variable?\n(no need to do in this PR, the integration just seems fairly useful)",https://github.com/bitcoin/bitcoin/pull/11779#discussion_r153750542,153750542,test/functional/test_runner.py
MarcoFalke,2017-11-29T15:59:38Z,"Yes, adding that feature to parse the max_lines in combine_logs is useful, but totally out of scope of this pull.\nThis code branch was only ever executed on travis and presumably by no developer. My goal here is to combine the logs on travis to debug travis specific failures.\nI think placing that constant right here in the code is compact and eases code review.\n\nBikeshedding and new featur",https://github.com/bitcoin/bitcoin/pull/11779#discussion_r153830741,153830741,test/functional/test_runner.py
promag,2017-11-29T16:46:48Z,My point is if in the future this value needs to be changed then a change to travis config would sound better. A nit really.,https://github.com/bitcoin/bitcoin/pull/11779#discussion_r153846385,153846385,test/functional/test_runner.py
