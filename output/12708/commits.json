[
  {
    "sha": "577f11141c5155345c68809aac8511b018cc4050",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo1NzdmMTExNDFjNTE1NTM0NWM2ODgwOWFhYzg1MTFiMDE4Y2M0MDUw",
    "commit": {
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2018-03-16T17:24:59Z"
      },
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2018-03-16T17:24:59Z"
      },
      "message": "Make verify-commits.sh test that merges are clean",
      "tree": {
        "sha": "118becb75906fd60d4eb0f3e4985250b5e4e78aa",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/118becb75906fd60d4eb0f3e4985250b5e4e78aa"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/577f11141c5155345c68809aac8511b018cc4050",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/577f11141c5155345c68809aac8511b018cc4050",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/577f11141c5155345c68809aac8511b018cc4050",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/577f11141c5155345c68809aac8511b018cc4050/comments",
    "author": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "7be9a9a570c1140048f8781ced1111e1d930e517",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7be9a9a570c1140048f8781ced1111e1d930e517",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/7be9a9a570c1140048f8781ced1111e1d930e517"
      }
    ],
    "stats": {
      "total": 32,
      "additions": 27,
      "deletions": 5
    },
    "files": [
      {
        "sha": "6415eea4d53fe805367f1cf7ed06d5e7339f55db",
        "filename": "contrib/verify-commits/verify-commits.sh",
        "status": "modified",
        "additions": 27,
        "deletions": 5,
        "changes": 32,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/577f11141c5155345c68809aac8511b018cc4050/contrib/verify-commits/verify-commits.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/577f11141c5155345c68809aac8511b018cc4050/contrib/verify-commits/verify-commits.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/verify-commits/verify-commits.sh?ref=577f11141c5155345c68809aac8511b018cc4050",
        "patch": "@@ -35,6 +35,8 @@ NO_SHA1=1\n PREV_COMMIT=\"\"\n INITIAL_COMMIT=\"${CURRENT_COMMIT}\"\n \n+BRANCH=\"$(git rev-parse --abbrev-ref HEAD)\"\n+\n while true; do\n \tif [ \"$CURRENT_COMMIT\" = $VERIFIED_ROOT ]; then\n \t\techo \"There is a valid path from \\\"$INITIAL_COMMIT\\\" to $VERIFIED_ROOT where all commits are signed!\"\n@@ -123,9 +125,29 @@ while true; do\n \tfi\n \n \tPARENTS=$(git show -s --format=format:%P \"$CURRENT_COMMIT\")\n-\tfor PARENT in $PARENTS; do\n-\t\tPREV_COMMIT=\"$CURRENT_COMMIT\"\n-\t\tCURRENT_COMMIT=\"$PARENT\"\n-\t\tbreak\n-\tdone\n+\tPARENT1=${PARENTS%% *}\n+\tPARENT2=\"\"\n+\tif [ \"x$PARENT1\" != \"x$PARENTS\" ]; then\n+\t\tPARENTX=${PARENTS#* }\n+\t\tPARENT2=${PARENTX%% *}\n+\t\tif [ \"x$PARENT2\" != \"x$PARENTX\" ]; then\n+\t\t\techo \"Commit $CURRENT_COMMIT is an octopus merge\" > /dev/stderr\n+\t\t\texit 1\n+\t\tfi\n+\tfi\n+\tif [ \"x$PARENT2\" != \"x\" ]; then\n+\t\tCURRENT_TREE=\"$(git show --format=\"%T\" \"$CURRENT_COMMIT\")\"\n+\t\tgit checkout --force --quiet \"$PARENT1\"\n+\t\tgit merge --no-ff --quiet \"$PARENT2\" >/dev/null\n+\t\tRECREATED_TREE=\"$(git show --format=\"%T\" HEAD)\"\n+\t\tif [ \"$CURRENT_TREE\" != \"$RECREATED_TREE\" ]; then\n+\t\t\techo \"Merge commit $CURRENT_COMMIT is not clean\" > /dev/stderr\n+\t\t\tgit diff \"$CURRENT_COMMIT\"\n+\t\t\tgit checkout --force --quiet \"$BRANCH\"\n+\t\t\texit 1\n+\t\tfi\n+\t\tgit checkout --force --quiet \"$BRANCH\"\n+\tfi\n+\tPREV_COMMIT=\"$CURRENT_COMMIT\"\n+\tCURRENT_COMMIT=\"$PARENT1\"\n done"
      }
    ]
  }
]