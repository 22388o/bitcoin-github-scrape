[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/763344104",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-763344104",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 763344104,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MzM0NDEwNA==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-20T05:29:12Z",
    "updated_at": "2021-06-22T09:27:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/763344104/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/763497435",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-763497435",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 763497435,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MzQ5NzQzNQ==",
    "user": {
      "login": "theStack",
      "id": 91535,
      "node_id": "MDQ6VXNlcjkxNTM1",
      "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theStack",
      "html_url": "https://github.com/theStack",
      "followers_url": "https://api.github.com/users/theStack/followers",
      "following_url": "https://api.github.com/users/theStack/following{/other_user}",
      "gists_url": "https://api.github.com/users/theStack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theStack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
      "organizations_url": "https://api.github.com/users/theStack/orgs",
      "repos_url": "https://api.github.com/users/theStack/repos",
      "events_url": "https://api.github.com/users/theStack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theStack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-20T10:16:04Z",
    "updated_at": "2021-01-20T10:16:04Z",
    "author_association": "CONTRIBUTOR",
    "body": "Concept ACK",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/763497435/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/763521567",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-763521567",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 763521567,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MzUyMTU2Nw==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-20T10:57:32Z",
    "updated_at": "2021-01-20T11:02:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "790727eea..fd751850e: add the tests from #20904 (closed without merge), they are precious",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/763521567/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/763540526",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-763540526",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 763540526,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MzU0MDUyNg==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-20T11:30:18Z",
    "updated_at": "2021-01-20T11:30:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "fd751850e..2d287f639: add release notes",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/763540526/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/763578760",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-763578760",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 763578760,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MzU3ODc2MA==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-20T12:37:59Z",
    "updated_at": "2021-01-20T12:37:59Z",
    "author_association": "MEMBER",
    "body": "Concept ACK",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/763578760/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/763587128",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-763587128",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 763587128,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MzU4NzEyOA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-20T12:53:59Z",
    "updated_at": "2021-01-20T12:53:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "2d287f639...fd751850e: remove edits of `doc/release-notes.md`",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/763587128/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/763591233",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-763591233",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 763591233,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2MzU5MTIzMw==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-20T13:01:48Z",
    "updated_at": "2021-01-20T13:01:48Z",
    "author_association": "CONTRIBUTOR",
    "body": "Notes:\r\n\r\n* I guess it would be possible to write the ban list to `settings.json` instead of in `banlist.json` (as originally proposed in https://github.com/bitcoin/bitcoin/issues/19748), but the periodic dump may create some complications and also it is unclear what to do if we are running with `-nosettings`.\r\n\r\n* The current patch would write `banlist.json` on the first change of the ban list. This means that a node that upgrades from before this PR with only `banlist.dat` on disk may not create `banlist.json` for some time. I think this is ok.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/763591233/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/768261953",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-768261953",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 768261953,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2ODI2MTk1Mw==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-27T12:46:34Z",
    "updated_at": "2021-01-27T12:46:34Z",
    "author_association": "MEMBER",
    "body": "Concept ACK\r\n\r\n> [790727e](https://github.com/bitcoin/bitcoin/commit/790727eeaf165449f691d1f874b70f0816ef7601)..[fd75185](https://github.com/bitcoin/bitcoin/commit/fd751850e5dc918b523c63ce9db98279f2398c96): add the tests from #20904 (closed without merge), they are precious\r\n\r\nGood to see these tests brought in.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/768261953/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/769058840",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-769058840",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 769058840,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc2OTA1ODg0MA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-28T13:39:39Z",
    "updated_at": "2021-01-28T13:39:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "fd751850e...e74196741: read `banlist.dat` only if `banlist.json` is not present and catch all exceptions that could come from an invalid JSON.\r\n\r\n@promag  \r\n> Should try to read JSON first, and if it exists then skip old format?\r\n\r\nI made it to read both if present so that if the user temporary downgrades and makes some changes to `banlist.dat` those changes would be picked up by the new version. However this has the deficiency that if an entry is deleted from `banlist.json` it will keep being loaded from `banlist.dat`. Changed to what you suggest above.\r\n\r\n> Personally I wouldn't add from/to JSON in `CBanEntry`, `BanMapFromJson` and `BanMapToJson` seem enough.\r\n\r\n`CBanEntry` being able to ser/unser itself to/from JSON improves its encapsulation.\r\n\r\n> Also, there should be some validation in `BanMapFromJson`?\r\n\r\nRight! Added `try/catch` to handle invalid JSONs.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/769058840/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/779253018",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-779253018",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 779253018,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3OTI1MzAxOA==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-15T14:20:42Z",
    "updated_at": "2021-02-15T14:20:42Z",
    "author_association": "MEMBER",
    "body": "needs rebase after #21167",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/779253018/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/779272710",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-779272710",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 779272710,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3OTI3MjcxMA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-15T14:54:24Z",
    "updated_at": "2021-02-15T14:54:24Z",
    "author_association": "CONTRIBUTOR",
    "body": "`e74196741...7493bbe38`: rebase due to conflicts",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/779272710/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/795669488",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-795669488",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 795669488,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5NTY2OTQ4OA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-10T16:12:28Z",
    "updated_at": "2021-03-10T16:12:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "`7493bbe38...1310b5460`: rebase due to conflicts",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/795669488/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/795681231",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-795681231",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 795681231,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5NTY4MTIzMQ==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-10T16:20:43Z",
    "updated_at": "2021-03-10T16:20:43Z",
    "author_association": "MEMBER",
    "body": "So many rebases. I hope the backport won't be too nasty",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/795681231/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/799510958",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-799510958",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 799510958,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc5OTUxMDk1OA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-15T15:27:26Z",
    "updated_at": "2021-03-15T15:27:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "`1310b5460...469da8ca3`: rebase due to conflicts",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/799510958/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/805928003",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-805928003",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 805928003,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwNTkyODAwMw==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-24T15:35:19Z",
    "updated_at": "2021-03-24T15:35:19Z",
    "author_association": "CONTRIBUTOR",
    "body": "`469da8ca3...4efa5e73b`: address review suggestions, remove the release notes that were removed before but sneaked back in one of the updates",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/805928003/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/812635126",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-812635126",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 812635126,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxMjYzNTEyNg==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-02T17:41:09Z",
    "updated_at": "2021-04-02T17:41:09Z",
    "author_association": "MEMBER",
    "body": "@vasild I've split up the unit tests from this pull, since they are unrelated to changes here (They are checking functionality that already works just fine on master). See #21571. The benefit is that this pull can focus on the disk serialization changes only. I hope you don't mind and maybe can leave a (Concept) (N)ACK.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/812635126/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/813933912",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-813933912",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 813933912,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxMzkzMzkxMg==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-06T08:27:28Z",
    "updated_at": "2021-04-06T08:27:28Z",
    "author_association": "MEMBER",
    "body": "Rebase should be easy now `git rebase --skip`",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/813933912/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/813955853",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-813955853",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 813955853,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgxMzk1NTg1Mw==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-06T09:00:08Z",
    "updated_at": "2021-04-06T09:00:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "`4efa5e7...03239a3ab`: rebase due to conflicts, remove 3 commits from this PR that were already merged via https://github.com/bitcoin/bitcoin/pull/21571.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/813955853/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/820911383",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-820911383",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 820911383,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMDkxMTM4Mw==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-16T05:15:12Z",
    "updated_at": "2021-04-16T05:15:12Z",
    "author_association": "MEMBER",
    "body": "Moving milestone to 0.21.2. We'd like to do 0.21.1 soon, and even though this may be ready for merge soon, it seems like a risky thing to rush into a point release.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/820911383/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/822536616",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-822536616",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 822536616,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMjUzNjYxNg==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-19T14:59:45Z",
    "updated_at": "2021-04-19T14:59:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "`03239a3ab...aa90a7d46`: address suggestions",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/822536616/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/823396970",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-823396970",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 823396970,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMzM5Njk3MA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-20T15:55:14Z",
    "updated_at": "2021-04-20T15:55:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "`aa90a7d46...7e399e2de`: rebase due to conflicts",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/823396970/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/823399313",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-823399313",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 823399313,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyMzM5OTMxMw==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-20T15:58:25Z",
    "updated_at": "2021-04-20T15:58:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "`7e399e2de...08f4f98ea`: address some suggestions; force saving on disk if we loaded just the old `banlist.dat` so that we create the new `banlist.json` this way, without waiting for mods to the list in order to flush it to disk.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/823399313/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/826155791",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-826155791",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 826155791,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyNjE1NTc5MQ==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-24T21:27:26Z",
    "updated_at": "2021-04-25T12:58:24Z",
    "author_association": "MEMBER",
    "body": "ACK 08f4f98ea2cdc3fbff5c9e21870296106430e468 with the suggestion to perhaps remove any leftover (e.g. \"::/0\") addresses from mis-saved addrv2 ban entries when creating the json file and add a test. They may eventually expire--or not, depending on the duration--so it might not be a bad idea to remove any that are identifiable. Tested on master that an existing banlist.dat containing IPv4/6 and torv3 addresses is read on restart (with an entry of \"::/0\" or an \"IPv4\"-like address for the torv3 addresses), and that after building this patch, a banlist.json file with the existing entries is auto-created on startup except with incorrect ban entries for the addrv2 addresses, and that subsequent setban add/remove operations correctly update the `banlist.json` file for torv3 and i2p addresses. As expected, attempting to remove any previously incorrectly saved addrv2 addresses fails to recognize them unless the \"new\" address is stipulated, but subsequent setban add/remove operations work correctly. This testing was done by simultaneously looking at the banlist files and running setban/listbanned, shutting down, sometimes rm-ing the banlist.json file, restarting on master and with this patch, and repeating the testing.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/826155791/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/826603992",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-826603992",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 826603992,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyNjYwMzk5Mg==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-26T08:00:07Z",
    "updated_at": "2021-04-26T08:00:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "`08f4f98ea...fe4aafda5`: apply doc and style suggestions",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/826603992/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/826608515",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-826608515",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 826608515,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyNjYwODUxNQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-26T08:06:06Z",
    "updated_at": "2021-04-26T08:06:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "> ... remove any leftover (e.g. \"::/0\") addresses from mis-saved addrv2 ban entries when creating the json file ...\r\n\r\nHmm. Could there be real, manually added, no-mistake, ban entries like `::/0`? Somebody has banned deliberately the entire IPv6 network?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/826608515/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/826638612",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-826638612",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 826638612,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgyNjYzODYxMg==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-04-26T08:45:21Z",
    "updated_at": "2021-04-26T08:45:21Z",
    "author_association": "MEMBER",
    "body": "> > ... remove any leftover (e.g. \"::/0\") addresses from mis-saved addrv2 ban entries when creating the json file ...\r\n> \r\n> Hmm. Could there be real, manually added, no-mistake, ban entries like `::/0`? Somebody has banned deliberately the entire IPv6 network?\r\n\r\nGood question. Would anyone do that. OTOH, have people been banning tor v3 addresses yet. Possible. IDK if it's an edge case worth worrying about.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/826638612/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/831409748",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-831409748",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 831409748,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgzMTQwOTc0OA==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-03T17:25:49Z",
    "updated_at": "2021-05-03T17:25:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--4a62be1de6b64f3ed646cdc7932c8cf5-->\n\ud83d\udd75\ufe0f @harding @hebasto have been requested to review this pull request as specified in the REVIEWERS file.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/831409748/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/843245302",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-843245302",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 843245302,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MzI0NTMwMg==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-18T14:59:04Z",
    "updated_at": "2021-05-18T14:59:04Z",
    "author_association": "CONTRIBUTOR",
    "body": "`fe4aafda51...13c681161c`: address review suggestions",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/843245302/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/843250170",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-843250170",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 843250170,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MzI1MDE3MA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-18T15:05:07Z",
    "updated_at": "2021-05-18T15:05:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "> this is the behavior I'd like to point to and make sure it's ok ... Node 1 deletes banlist.json to clear all bans ... The ban comes back from banlist.dat\r\n\r\nYes, this is how it is supposed to work. The operator should have seen that there are two files `banlist.dat` and `banlist.json` and deleted both or consulted `doc/files.md`. We don't automatically delete `banlist.dat` after creating `banlist.json` because that would create issues if the user decides to downgrade to the previous version which only recognizes `banlist.dat`.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/843250170/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/843290442",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-843290442",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 843290442,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0MzI5MDQ0Mg==",
    "user": {
      "login": "dhruv",
      "id": 856960,
      "node_id": "MDQ6VXNlcjg1Njk2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/856960?u=65406da0f40524c00b8b647f916d31cbbb449edb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dhruv",
      "html_url": "https://github.com/dhruv",
      "followers_url": "https://api.github.com/users/dhruv/followers",
      "following_url": "https://api.github.com/users/dhruv/following{/other_user}",
      "gists_url": "https://api.github.com/users/dhruv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
      "organizations_url": "https://api.github.com/users/dhruv/orgs",
      "repos_url": "https://api.github.com/users/dhruv/repos",
      "events_url": "https://api.github.com/users/dhruv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dhruv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-18T15:55:09Z",
    "updated_at": "2021-05-18T15:55:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "re-ACK `13c6811`",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/843290442/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/844172348",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-844172348",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 844172348,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NDE3MjM0OA==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-19T14:41:58Z",
    "updated_at": "2021-05-19T14:41:58Z",
    "author_association": "MEMBER",
    "body": "Diff-review re-ACK 13c681161c4a3f2a2acd6d812c1360e0ad94019c per ` git diff 08f4f98 13c6811` and  `git range-diff d4c409c 08f4f98 13c6811`\r\n\r\nOnly non-showstopping mini-regret is the Python \"not in\" not updated while re-touching to conform to PEP8 per our functional test guidelines.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/844172348/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/846931030",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-846931030",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 846931030,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NjkzMTAzMA==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-24T10:00:11Z",
    "updated_at": "2021-05-24T10:00:11Z",
    "author_association": "MEMBER",
    "body": "Sorry, this had two ACKs and I didn't see the conflict.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/846931030/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/847001828",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-847001828",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 847001828,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NzAwMTgyOA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-24T12:13:56Z",
    "updated_at": "2021-05-24T12:13:56Z",
    "author_association": "CONTRIBUTOR",
    "body": "`13c681161c...88b843e49c`: rebase due to conflicts\r\n\r\n<details>\r\n<summary>Release notes</summary>\r\n\r\n```diff\r\n--- a/doc/release-notes.md\r\n+++ b/doc/release-notes.md\r\n@@ -182,12 +182,21 @@ RPC\r\n   - `verifymessage` now returns RPC_TYPE_ERROR (-3) if the passed signature\r\n     is malformed. Previously returned RPC_INVALID_ADDRESS_OR_KEY (-5).\r\n\r\n Tests\r\n -----\r\n\r\n+Files\r\n+-----\r\n+\r\n+- The list of banned hosts and networks (via `setban` RPC) is now saved on disk\r\n+  in JSON format in `banlist.json` instead of `banlist.dat`. `banlist.dat` is\r\n+  only read on startup if `banlist.json` is not present. Changes are only\r\n+  written to the new `banlist.json`. A future version of Bitcoin Core may\r\n+  completely ignore `banlist.dat`. (#20966)\r\n+\r\n Credits\r\n =======\r\n```\r\n</details>\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/847001828/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/847030339",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-847030339",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 847030339,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg0NzAzMDMzOQ==",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?u=7297e8aaf9188c0cb98bc549a8a02a1dc8d59e4c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-05-24T13:07:27Z",
    "updated_at": "2021-05-24T13:07:27Z",
    "author_association": "MEMBER",
    "body": "Concept ACK.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/847030339/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/860629340",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-860629340",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 860629340,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MDYyOTM0MA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-14T12:02:35Z",
    "updated_at": "2021-06-14T12:02:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "`88b843e49c...4b52c7234f`: rebase due to conflicts\r\n\r\nrelease notes in https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-847001828",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/860629340/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/860772236",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-860772236",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 860772236,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MDc3MjIzNg==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-14T15:22:11Z",
    "updated_at": "2021-06-15T04:05:09Z",
    "author_association": "MEMBER",
    "body": "> - The list of banned hosts and networks (via `setban` RPC) is now saved on disk\r\n>   in JSON format in `banlist.json` instead of `banlist.dat`. `banlist.dat` is\r\n>   only read on startup if `banlist.json` is not present. Changes are only\r\n>   written to the new `banlist.json`. A future version of Bitcoin Core may\r\n>   completely ignore `banlist.dat`. (#20966)\r\n\r\nRegarding the release note, peers may be banned and unbanned via the GUI peers window in addition to the setban RPC. As mentioned in my previous comment, it may be a good idea to describe user gotchas and best practices for upgrading and downgrading.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/860772236/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861150204",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-861150204",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 861150204,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2MTE1MDIwNA==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-15T03:59:15Z",
    "updated_at": "2021-06-15T03:59:15Z",
    "author_association": "MEMBER",
    "body": "utACK 4b52c7234f3c2e3067d7d6c6fd7ebf2b96bb8a45\r\n\r\nI think it would be useful to make the code ignore future version numbers, so it will not completely wipe banlists on downgrading (from future versions that introduce additional features to this format), but that can be done later.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/861150204/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/865035904",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-865035904",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 865035904,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2NTAzNTkwNA==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-21T13:31:40Z",
    "updated_at": "2021-06-21T13:31:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "`4b52c7234f...5fcc96457d`: rebase due to conflicts",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/865035904/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/865037181",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-865037181",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 865037181,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2NTAzNzE4MQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-21T13:33:26Z",
    "updated_at": "2021-06-21T13:33:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "`5fcc96457d...bb719a08db`: minor tweaks in `rpc_setban.py` - log a message and use `node` instead of `self.nodes[1]`",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/865037181/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/865064475",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-865064475",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 865064475,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2NTA2NDQ3NQ==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-21T14:10:24Z",
    "updated_at": "2021-06-21T14:10:24Z",
    "author_association": "MEMBER",
    "body": "Code review re-ACK bb719a08db173a753984a04534de6f148b87b17a per `git range-diff 6a67366 4b52c72 bb719a0`",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/865064475/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/866384961",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-866384961",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 866384961,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2NjM4NDk2MQ==",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?u=9791e96cd4268d48e3517bac41eaf2b1d09759fd&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-22T22:43:14Z",
    "updated_at": "2021-06-22T22:43:14Z",
    "author_association": "MEMBER",
    "body": "Code Review ACK bb719a08db173a753984a04534de6f148b87b17a",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/866384961/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/866625710",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-866625710",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 866625710,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2NjYyNTcxMA==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-23T08:08:42Z",
    "updated_at": "2021-06-23T08:08:42Z",
    "author_association": "MEMBER",
    "body": "Removed from backport, but if someone wants to backport, it will need to be done together with https://github.com/bitcoin/bitcoin/pull/20852#issuecomment-866610187",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/866625710/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/866630110",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#issuecomment-866630110",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20966",
    "id": 866630110,
    "node_id": "MDEyOklzc3VlQ29tbWVudDg2NjYzMDExMA==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-06-23T08:15:03Z",
    "updated_at": "2021-06-23T08:15:03Z",
    "author_association": "MEMBER",
    "body": "Added to release notes: https://github.com/bitcoin-core/bitcoin-devwiki/wiki/22.0-Release-Notes-draft/_history",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/866630110/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/560912563",
    "pull_request_review_id": 572158049,
    "id": 560912563,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MDkxMjU2Mw==",
    "diff_hunk": "@@ -105,6 +105,15 @@ RPC\n Tests\n -----\n \n+Files\n+-----\n+\n+- The list of banned hosts and networks (via `setban` RPC) is now saved on disk\n+  in JSON format in `banlist.json` instead of `banlist.dat`. Both files are\n+  read on startup and contents merged. Updateds are only written to the new\n+  `banlist.json`. A future version of Bitcoin Core may completely ignore\n+  `banlist.dat`. (#20966)",
    "path": "doc/release-notes.md",
    "position": null,
    "original_position": 11,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "2d287f639a77e03b07009712c756664c761d2867",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Please add the release notes to https://github.com/bitcoin-core/bitcoin-devwiki/wiki/%2320852-Release-notes-snippet\r\n\r\nOtherwise they will have to be removed here after merge, then added to the `0.21` branch. (Release notes are only added to the point releases, not the next major version that also includes those fixes)",
    "created_at": "2021-01-20T12:10:31Z",
    "updated_at": "2021-04-26T07:58:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r560912563",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/560912563"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r560912563"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/560912563/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 119,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/560934560",
    "pull_request_review_id": 572186410,
    "id": 560934560,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2MDkzNDU2MA==",
    "diff_hunk": "@@ -105,6 +105,15 @@ RPC\n Tests\n -----\n \n+Files\n+-----\n+\n+- The list of banned hosts and networks (via `setban` RPC) is now saved on disk\n+  in JSON format in `banlist.json` instead of `banlist.dat`. Both files are\n+  read on startup and contents merged. Updateds are only written to the new\n+  `banlist.json`. A future version of Bitcoin Core may completely ignore\n+  `banlist.dat`. (#20966)",
    "path": "doc/release-notes.md",
    "position": null,
    "original_position": 11,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "2d287f639a77e03b07009712c756664c761d2867",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I guess after/if this PR is merged?",
    "created_at": "2021-01-20T12:49:05Z",
    "updated_at": "2021-04-26T07:58:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r560934560",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/560934560"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r560934560"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/560934560/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 119,
    "side": "RIGHT",
    "in_reply_to_id": 560912563
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598083776",
    "pull_request_review_id": 616895551,
    "id": 598083776,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODA4Mzc3Ng==",
    "diff_hunk": "@@ -11,13 +11,69 @@\n #include <cstdint>\n #include <hash.h>\n #include <logging/timer.h>\n+#include <netbase.h>\n #include <random.h>\n #include <streams.h>\n #include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/settings.h>\n #include <util/system.h>\n \n+CBanEntry::CBanEntry(const UniValue& json)\n+    : nVersion(json[\"version\"].get_int()), nCreateTime(json[\"ban_created\"].get_int64()),\n+      nBanUntil(json[\"banned_until\"].get_int64())\n+{\n+}\n+\n+UniValue CBanEntry::ToJson() const\n+{\n+    UniValue json(UniValue::VOBJ);\n+    json.pushKV(\"version\", nVersion);\n+    json.pushKV(\"ban_created\", nCreateTime);\n+    json.pushKV(\"banned_until\", nBanUntil);\n+    return json;\n+}\n+\n namespace {\n \n+/**\n+ * Convert a `banmap_t` object to a JSON array.\n+ * @param[in] bans Bans list to convert.\n+ * @return a JSON array, similar to the one returned by the `listbanned` RPC. Suitable for\n+ * passing to `BanMapFromJson()`.\n+ */\n+UniValue BanMapToJson(const banmap_t& bans)\n+{\n+    UniValue bans_json(UniValue::VARR);\n+    for (const auto& [address, ban_entry] : bans) {",
    "path": "src/addrdb.cpp",
    "position": null,
    "original_position": 38,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "8372aad9cc01774e981edee1dd8822a31ef6ea18",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "8372aad9cc01774e981edee1dd8822a31ef6ea18\r\n\r\nis the goal still to backport this? If yes, it could make sense to use C++11",
    "created_at": "2021-03-20T08:45:11Z",
    "updated_at": "2021-04-26T07:58:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r598083776",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598083776"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r598083776"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598083776/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 48,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598084377",
    "pull_request_review_id": 616895551,
    "id": 598084377,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODA4NDM3Nw==",
    "diff_hunk": "@@ -11,13 +11,69 @@\n #include <cstdint>\n #include <hash.h>\n #include <logging/timer.h>\n+#include <netbase.h>\n #include <random.h>\n #include <streams.h>\n #include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/settings.h>\n #include <util/system.h>\n \n+CBanEntry::CBanEntry(const UniValue& json)\n+    : nVersion(json[\"version\"].get_int()), nCreateTime(json[\"ban_created\"].get_int64()),\n+      nBanUntil(json[\"banned_until\"].get_int64())\n+{\n+}\n+\n+UniValue CBanEntry::ToJson() const\n+{\n+    UniValue json(UniValue::VOBJ);\n+    json.pushKV(\"version\", nVersion);\n+    json.pushKV(\"ban_created\", nCreateTime);\n+    json.pushKV(\"banned_until\", nBanUntil);\n+    return json;\n+}\n+\n namespace {\n \n+/**\n+ * Convert a `banmap_t` object to a JSON array.\n+ * @param[in] bans Bans list to convert.\n+ * @return a JSON array, similar to the one returned by the `listbanned` RPC. Suitable for\n+ * passing to `BanMapFromJson()`.\n+ */\n+UniValue BanMapToJson(const banmap_t& bans)\n+{\n+    UniValue bans_json(UniValue::VARR);\n+    for (const auto& [address, ban_entry] : bans) {\n+        UniValue j = ban_entry.ToJson();\n+        j.pushKV(\"address\", address.ToString());\n+        bans_json.push_back(j);\n+    }\n+    return bans_json;\n+}\n+\n+/**\n+ * Convert a JSON array to a `banmap_t` object.\n+ * @param[in] bans_json JSON to convert, must be as returned by `BanMapToJson()`.\n+ * @param[out] bans Bans list to create from the JSON.\n+ * @return true if the conversion was successful.\n+ * @throws std::runtime_error if the JSON does not have the expected fields.\n+ */\n+bool BanMapFromJson(const UniValue& bans_json, banmap_t& bans)\n+{\n+    for (const auto& ban_entry_json : bans_json.getValues()) {\n+        CSubNet subnet;\n+        const auto& subnet_str = ban_entry_json[\"address\"].get_str();\n+        if (!LookupSubNet(subnet_str, subnet)) {\n+            return error(\"%s: Cannot parse banned address or subnet: %s\", __func__, subnet_str);",
    "path": "src/addrdb.cpp",
    "position": null,
    "original_position": 59,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "8372aad9cc01774e981edee1dd8822a31ef6ea18",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "8372aad9cc01774e981edee1dd8822a31ef6ea18\r\n\r\n* Any reason to prepend the function name? This is already done by -logfunctionnames\r\n* Any reason to use `error` here, but `std::runtime_error` if a field is missing?\r\n* It would be better to leave the logging to the caller and not mix logging responsibility between a utility function and the caller object",
    "created_at": "2021-03-20T08:50:00Z",
    "updated_at": "2021-04-26T07:58:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r598084377",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598084377"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r598084377"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598084377/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 69,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598085409",
    "pull_request_review_id": 616895551,
    "id": 598085409,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODA4NTQwOQ==",
    "diff_hunk": "@@ -119,18 +175,46 @@ bool DeserializeFileDB(const fs::path& path, Data& data)\n }\n } // namespace\n \n-CBanDB::CBanDB(fs::path ban_list_path) : m_ban_list_path(std::move(ban_list_path))\n+CBanDB::CBanDB(fs::path ban_list_path)\n+    : m_banlist_dat(ban_list_path.string() + \".dat\"),\n+      m_banlist_json(ban_list_path.string() + \".json\")\n {\n }\n \n bool CBanDB::Write(const banmap_t& banSet)\n {\n-    return SerializeFileDB(\"banlist\", m_ban_list_path, banSet);\n+    std::vector<std::string> errors;\n+    if (util::WriteSettings(m_banlist_json, {{JSON_KEY, BanMapToJson(banSet)}}, errors)) {\n+        return true;\n+    }\n+\n+    for (const auto& err : errors) {\n+        error(\"%s: %s\", __func__, err);",
    "path": "src/addrdb.cpp",
    "position": null,
    "original_position": 90,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "8372aad9cc01774e981edee1dd8822a31ef6ea18",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "same commit:\r\n\r\n* It seems the caller ignores the return code, so calling this ERROR seems confusing\r\n* No longer need `__func__`",
    "created_at": "2021-03-20T09:00:47Z",
    "updated_at": "2021-04-26T07:58:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r598085409",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598085409"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r598085409"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598085409/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 192,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598085607",
    "pull_request_review_id": 616895551,
    "id": 598085607,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODA4NTYwNw==",
    "diff_hunk": "@@ -119,18 +175,46 @@ bool DeserializeFileDB(const fs::path& path, Data& data)\n }\n } // namespace\n \n-CBanDB::CBanDB(fs::path ban_list_path) : m_ban_list_path(std::move(ban_list_path))\n+CBanDB::CBanDB(fs::path ban_list_path)\n+    : m_banlist_dat(ban_list_path.string() + \".dat\"),\n+      m_banlist_json(ban_list_path.string() + \".json\")\n {\n }\n \n bool CBanDB::Write(const banmap_t& banSet)\n {\n-    return SerializeFileDB(\"banlist\", m_ban_list_path, banSet);\n+    std::vector<std::string> errors;\n+    if (util::WriteSettings(m_banlist_json, {{JSON_KEY, BanMapToJson(banSet)}}, errors)) {\n+        return true;\n+    }\n+\n+    for (const auto& err : errors) {\n+        error(\"%s: %s\", __func__, err);\n+    }\n+    return false;\n }\n \n bool CBanDB::Read(banmap_t& banSet)\n {\n-    return DeserializeFileDB(m_ban_list_path, banSet);\n+    if (!fs::exists(m_banlist_json)) {\n+        return DeserializeFileDB(m_banlist_dat, banSet);\n+    }\n+\n+    std::map<std::string, util::SettingsValue> settings;\n+    std::vector<std::string> errors;\n+\n+    if (!util::ReadSettings(m_banlist_json, settings, errors)) {\n+        for (const auto& err : errors) {\n+            error(\"%s: %s\", __func__, err);",
    "path": "src/addrdb.cpp",
    "position": null,
    "original_position": 107,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "8372aad9cc01774e981edee1dd8822a31ef6ea18",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "same commit:\r\n\r\n* The caller will be \"Recreating the banlist database\", so calling this ERROR seems confusing\r\n* `__func__` ;)",
    "created_at": "2021-03-20T09:03:43Z",
    "updated_at": "2021-04-26T07:58:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r598085607",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598085607"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r598085607"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598085607/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 208,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598085630",
    "pull_request_review_id": 616895551,
    "id": 598085630,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODA4NTYzMA==",
    "diff_hunk": "@@ -119,18 +175,46 @@ bool DeserializeFileDB(const fs::path& path, Data& data)\n }\n } // namespace\n \n-CBanDB::CBanDB(fs::path ban_list_path) : m_ban_list_path(std::move(ban_list_path))\n+CBanDB::CBanDB(fs::path ban_list_path)\n+    : m_banlist_dat(ban_list_path.string() + \".dat\"),\n+      m_banlist_json(ban_list_path.string() + \".json\")\n {\n }\n \n bool CBanDB::Write(const banmap_t& banSet)\n {\n-    return SerializeFileDB(\"banlist\", m_ban_list_path, banSet);\n+    std::vector<std::string> errors;\n+    if (util::WriteSettings(m_banlist_json, {{JSON_KEY, BanMapToJson(banSet)}}, errors)) {\n+        return true;\n+    }\n+\n+    for (const auto& err : errors) {\n+        error(\"%s: %s\", __func__, err);\n+    }\n+    return false;\n }\n \n bool CBanDB::Read(banmap_t& banSet)\n {\n-    return DeserializeFileDB(m_ban_list_path, banSet);\n+    if (!fs::exists(m_banlist_json)) {\n+        return DeserializeFileDB(m_banlist_dat, banSet);\n+    }\n+\n+    std::map<std::string, util::SettingsValue> settings;\n+    std::vector<std::string> errors;\n+\n+    if (!util::ReadSettings(m_banlist_json, settings, errors)) {\n+        for (const auto& err : errors) {\n+            error(\"%s: %s\", __func__, err);\n+        }\n+        return false;\n+    }\n+\n+    try {\n+        return BanMapFromJson(settings[JSON_KEY], banSet);\n+    } catch (const std::runtime_error& e) {\n+        return error(\"%s: Cannot parse %s: %s\", __func__, m_banlist_json.string(), e.what());",
    "path": "src/addrdb.cpp",
    "position": null,
    "original_position": 115,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "8372aad9cc01774e981edee1dd8822a31ef6ea18",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "same ;)",
    "created_at": "2021-03-20T09:03:55Z",
    "updated_at": "2021-04-26T07:58:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r598085630",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598085630"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r598085630"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598085630/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 216,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598086423",
    "pull_request_review_id": 616895551,
    "id": 598086423,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU5ODA4NjQyMw==",
    "diff_hunk": "@@ -34,8 +34,9 @@ FUZZ_TARGET_INIT(banman, initialize_banman)\n {\n     FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n     SetMockTime(ConsumeTime(fuzzed_data_provider));\n-    const fs::path banlist_file = GetDataDir() / \"fuzzed_banlist.dat\";\n-    fs::remove(banlist_file);\n+    const fs::path banlist_file = GetDataDir() / \"fuzzed_banlist\";\n+    fs::remove(banlist_file.string() + \".dat\");",
    "path": "src/test/fuzz/banman.cpp",
    "position": null,
    "original_position": 7,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "8372aad9cc01774e981edee1dd8822a31ef6ea18",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "same commit:\r\n\r\nI don't understand this line. There shouldn't be any reason this instance will ever write a banlist.dat file.\r\n\r\nAlso, to make the fuzz test more useful, it should probably *create* a banlist.dat file. Extra points for creating a corrupted one. With extra bonus points for passing one in without disk access.",
    "created_at": "2021-03-20T09:11:33Z",
    "updated_at": "2021-04-26T07:58:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r598086423",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598086423"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r598086423"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/598086423/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 38,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600601565",
    "pull_request_review_id": 619883706,
    "id": 600601565,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDYwMTU2NQ==",
    "diff_hunk": "@@ -11,13 +11,69 @@\n #include <cstdint>\n #include <hash.h>\n #include <logging/timer.h>\n+#include <netbase.h>\n #include <random.h>\n #include <streams.h>\n #include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/settings.h>\n #include <util/system.h>\n \n+CBanEntry::CBanEntry(const UniValue& json)\n+    : nVersion(json[\"version\"].get_int()), nCreateTime(json[\"ban_created\"].get_int64()),\n+      nBanUntil(json[\"banned_until\"].get_int64())\n+{\n+}\n+\n+UniValue CBanEntry::ToJson() const\n+{\n+    UniValue json(UniValue::VOBJ);\n+    json.pushKV(\"version\", nVersion);\n+    json.pushKV(\"ban_created\", nCreateTime);\n+    json.pushKV(\"banned_until\", nBanUntil);\n+    return json;\n+}\n+\n namespace {\n \n+/**\n+ * Convert a `banmap_t` object to a JSON array.\n+ * @param[in] bans Bans list to convert.\n+ * @return a JSON array, similar to the one returned by the `listbanned` RPC. Suitable for\n+ * passing to `BanMapFromJson()`.\n+ */\n+UniValue BanMapToJson(const banmap_t& bans)\n+{\n+    UniValue bans_json(UniValue::VARR);\n+    for (const auto& [address, ban_entry] : bans) {",
    "path": "src/addrdb.cpp",
    "position": null,
    "original_position": 38,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "8372aad9cc01774e981edee1dd8822a31ef6ea18",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "My understanding is that this deserves a backport because it would allow storing torv3 addresses in the banlist on disk. Not super important though.\r\n\r\nSwitched to C++11.",
    "created_at": "2021-03-24T15:37:09Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r600601565",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600601565"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r600601565"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600601565/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 48,
    "side": "RIGHT",
    "in_reply_to_id": 598083776
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600604218",
    "pull_request_review_id": 619887083,
    "id": 600604218,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDYwNDIxOA==",
    "diff_hunk": "@@ -11,13 +11,69 @@\n #include <cstdint>\n #include <hash.h>\n #include <logging/timer.h>\n+#include <netbase.h>\n #include <random.h>\n #include <streams.h>\n #include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/settings.h>\n #include <util/system.h>\n \n+CBanEntry::CBanEntry(const UniValue& json)\n+    : nVersion(json[\"version\"].get_int()), nCreateTime(json[\"ban_created\"].get_int64()),\n+      nBanUntil(json[\"banned_until\"].get_int64())\n+{\n+}\n+\n+UniValue CBanEntry::ToJson() const\n+{\n+    UniValue json(UniValue::VOBJ);\n+    json.pushKV(\"version\", nVersion);\n+    json.pushKV(\"ban_created\", nCreateTime);\n+    json.pushKV(\"banned_until\", nBanUntil);\n+    return json;\n+}\n+\n namespace {\n \n+/**\n+ * Convert a `banmap_t` object to a JSON array.\n+ * @param[in] bans Bans list to convert.\n+ * @return a JSON array, similar to the one returned by the `listbanned` RPC. Suitable for\n+ * passing to `BanMapFromJson()`.\n+ */\n+UniValue BanMapToJson(const banmap_t& bans)\n+{\n+    UniValue bans_json(UniValue::VARR);\n+    for (const auto& [address, ban_entry] : bans) {\n+        UniValue j = ban_entry.ToJson();\n+        j.pushKV(\"address\", address.ToString());\n+        bans_json.push_back(j);\n+    }\n+    return bans_json;\n+}\n+\n+/**\n+ * Convert a JSON array to a `banmap_t` object.\n+ * @param[in] bans_json JSON to convert, must be as returned by `BanMapToJson()`.\n+ * @param[out] bans Bans list to create from the JSON.\n+ * @return true if the conversion was successful.\n+ * @throws std::runtime_error if the JSON does not have the expected fields.\n+ */\n+bool BanMapFromJson(const UniValue& bans_json, banmap_t& bans)\n+{\n+    for (const auto& ban_entry_json : bans_json.getValues()) {\n+        CSubNet subnet;\n+        const auto& subnet_str = ban_entry_json[\"address\"].get_str();\n+        if (!LookupSubNet(subnet_str, subnet)) {\n+            return error(\"%s: Cannot parse banned address or subnet: %s\", __func__, subnet_str);",
    "path": "src/addrdb.cpp",
    "position": null,
    "original_position": 59,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "8372aad9cc01774e981edee1dd8822a31ef6ea18",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "You probably mean `-logsourcelocations` instead of `-logfunctionnames`.\r\n\r\nRemoved `__func__`. Changed this function to throw an exception for all errors and return `void`. Now it does not do any logging - just bubble up a detailed error message to the callers via the exception.",
    "created_at": "2021-03-24T15:39:46Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r600604218",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600604218"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r600604218"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600604218/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 69,
    "side": "RIGHT",
    "in_reply_to_id": 598084377
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600607040",
    "pull_request_review_id": 619890819,
    "id": 600607040,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDYwNzA0MA==",
    "diff_hunk": "@@ -119,18 +175,46 @@ bool DeserializeFileDB(const fs::path& path, Data& data)\n }\n } // namespace\n \n-CBanDB::CBanDB(fs::path ban_list_path) : m_ban_list_path(std::move(ban_list_path))\n+CBanDB::CBanDB(fs::path ban_list_path)\n+    : m_banlist_dat(ban_list_path.string() + \".dat\"),\n+      m_banlist_json(ban_list_path.string() + \".json\")\n {\n }\n \n bool CBanDB::Write(const banmap_t& banSet)\n {\n-    return SerializeFileDB(\"banlist\", m_ban_list_path, banSet);\n+    std::vector<std::string> errors;\n+    if (util::WriteSettings(m_banlist_json, {{JSON_KEY, BanMapToJson(banSet)}}, errors)) {\n+        return true;\n+    }\n+\n+    for (const auto& err : errors) {\n+        error(\"%s: %s\", __func__, err);",
    "path": "src/addrdb.cpp",
    "position": null,
    "original_position": 90,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "8372aad9cc01774e981edee1dd8822a31ef6ea18",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The caller of `CBanDB::Write()` does not ignore its return code? If you mean the return code of `error()` itself - this is because we want to log all of the errors (possibly more than one) before returning `false`.\r\n\r\nRemoved `__func__`.",
    "created_at": "2021-03-24T15:42:21Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r600607040",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600607040"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r600607040"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600607040/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 192,
    "side": "RIGHT",
    "in_reply_to_id": 598085409
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600609034",
    "pull_request_review_id": 619892999,
    "id": 600609034,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDYwOTAzNA==",
    "diff_hunk": "@@ -119,18 +175,46 @@ bool DeserializeFileDB(const fs::path& path, Data& data)\n }\n } // namespace\n \n-CBanDB::CBanDB(fs::path ban_list_path) : m_ban_list_path(std::move(ban_list_path))\n+CBanDB::CBanDB(fs::path ban_list_path)\n+    : m_banlist_dat(ban_list_path.string() + \".dat\"),\n+      m_banlist_json(ban_list_path.string() + \".json\")\n {\n }\n \n bool CBanDB::Write(const banmap_t& banSet)\n {\n-    return SerializeFileDB(\"banlist\", m_ban_list_path, banSet);\n+    std::vector<std::string> errors;\n+    if (util::WriteSettings(m_banlist_json, {{JSON_KEY, BanMapToJson(banSet)}}, errors)) {\n+        return true;\n+    }\n+\n+    for (const auto& err : errors) {\n+        error(\"%s: %s\", __func__, err);\n+    }\n+    return false;\n }\n \n bool CBanDB::Read(banmap_t& banSet)\n {\n-    return DeserializeFileDB(m_ban_list_path, banSet);\n+    if (!fs::exists(m_banlist_json)) {\n+        return DeserializeFileDB(m_banlist_dat, banSet);\n+    }\n+\n+    std::map<std::string, util::SettingsValue> settings;\n+    std::vector<std::string> errors;\n+\n+    if (!util::ReadSettings(m_banlist_json, settings, errors)) {\n+        for (const auto& err : errors) {\n+            error(\"%s: %s\", __func__, err);",
    "path": "src/addrdb.cpp",
    "position": null,
    "original_position": 107,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "8372aad9cc01774e981edee1dd8822a31ef6ea18",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think it is ok to see something like the following in the log:\r\n```\r\nERROR: ... banlist foo ...\r\nERROR: ... banlist bar ...\r\nRecreating the banlist database\r\n```\r\n\r\nRemoved `__func__`.",
    "created_at": "2021-03-24T15:44:14Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r600609034",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600609034"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r600609034"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600609034/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 208,
    "side": "RIGHT",
    "in_reply_to_id": 598085607
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600609538",
    "pull_request_review_id": 619893728,
    "id": 600609538,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDYwOTUzOA==",
    "diff_hunk": "@@ -119,18 +175,46 @@ bool DeserializeFileDB(const fs::path& path, Data& data)\n }\n } // namespace\n \n-CBanDB::CBanDB(fs::path ban_list_path) : m_ban_list_path(std::move(ban_list_path))\n+CBanDB::CBanDB(fs::path ban_list_path)\n+    : m_banlist_dat(ban_list_path.string() + \".dat\"),\n+      m_banlist_json(ban_list_path.string() + \".json\")\n {\n }\n \n bool CBanDB::Write(const banmap_t& banSet)\n {\n-    return SerializeFileDB(\"banlist\", m_ban_list_path, banSet);\n+    std::vector<std::string> errors;\n+    if (util::WriteSettings(m_banlist_json, {{JSON_KEY, BanMapToJson(banSet)}}, errors)) {\n+        return true;\n+    }\n+\n+    for (const auto& err : errors) {\n+        error(\"%s: %s\", __func__, err);\n+    }\n+    return false;\n }\n \n bool CBanDB::Read(banmap_t& banSet)\n {\n-    return DeserializeFileDB(m_ban_list_path, banSet);\n+    if (!fs::exists(m_banlist_json)) {\n+        return DeserializeFileDB(m_banlist_dat, banSet);\n+    }\n+\n+    std::map<std::string, util::SettingsValue> settings;\n+    std::vector<std::string> errors;\n+\n+    if (!util::ReadSettings(m_banlist_json, settings, errors)) {\n+        for (const auto& err : errors) {\n+            error(\"%s: %s\", __func__, err);\n+        }\n+        return false;\n+    }\n+\n+    try {\n+        return BanMapFromJson(settings[JSON_KEY], banSet);\n+    } catch (const std::runtime_error& e) {\n+        return error(\"%s: Cannot parse %s: %s\", __func__, m_banlist_json.string(), e.what());",
    "path": "src/addrdb.cpp",
    "position": null,
    "original_position": 115,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "8372aad9cc01774e981edee1dd8822a31ef6ea18",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Removed `__func__`.",
    "created_at": "2021-03-24T15:44:51Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r600609538",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600609538"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r600609538"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600609538/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 216,
    "side": "RIGHT",
    "in_reply_to_id": 598085630
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600612275",
    "pull_request_review_id": 619898024,
    "id": 600612275,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYwMDYxMjI3NQ==",
    "diff_hunk": "@@ -34,8 +34,9 @@ FUZZ_TARGET_INIT(banman, initialize_banman)\n {\n     FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n     SetMockTime(ConsumeTime(fuzzed_data_provider));\n-    const fs::path banlist_file = GetDataDir() / \"fuzzed_banlist.dat\";\n-    fs::remove(banlist_file);\n+    const fs::path banlist_file = GetDataDir() / \"fuzzed_banlist\";\n+    fs::remove(banlist_file.string() + \".dat\");",
    "path": "src/test/fuzz/banman.cpp",
    "position": null,
    "original_position": 7,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "8372aad9cc01774e981edee1dd8822a31ef6ea18",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Right, removed the `fs::remove` calls and replaced them with a creation of a corrupted or inaccessible banlist file.",
    "created_at": "2021-03-24T15:47:45Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r600612275",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600612275"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r600612275"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/600612275/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 38,
    "side": "RIGHT",
    "in_reply_to_id": 598086423
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615236159",
    "pull_request_review_id": 638215405,
    "id": 615236159,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTIzNjE1OQ==",
    "diff_hunk": "@@ -119,18 +175,46 @@ bool DeserializeFileDB(const fs::path& path, Data& data)\n }\n } // namespace\n \n-CBanDB::CBanDB(fs::path ban_list_path) : m_ban_list_path(std::move(ban_list_path))\n+CBanDB::CBanDB(fs::path ban_list_path)\n+    : m_banlist_dat(ban_list_path.string() + \".dat\"),\n+      m_banlist_json(ban_list_path.string() + \".json\")\n {\n }\n \n bool CBanDB::Write(const banmap_t& banSet)\n {\n-    return SerializeFileDB(\"banlist\", m_ban_list_path, banSet);\n+    std::vector<std::string> errors;\n+    if (util::WriteSettings(m_banlist_json, {{JSON_KEY, BanMapToJson(banSet)}}, errors)) {\n+        return true;\n+    }\n+\n+    for (const auto& err : errors) {\n+        error(\"%s: %s\", __func__, err);\n+    }\n+    return false;\n }\n \n bool CBanDB::Read(banmap_t& banSet)\n {\n-    return DeserializeFileDB(m_ban_list_path, banSet);\n+    if (!fs::exists(m_banlist_json)) {\n+        return DeserializeFileDB(m_banlist_dat, banSet);\n+    }\n+\n+    std::map<std::string, util::SettingsValue> settings;\n+    std::vector<std::string> errors;\n+\n+    if (!util::ReadSettings(m_banlist_json, settings, errors)) {\n+        for (const auto& err : errors) {\n+            error(\"%s: %s\", __func__, err);",
    "path": "src/addrdb.cpp",
    "position": null,
    "original_position": 107,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "8372aad9cc01774e981edee1dd8822a31ef6ea18",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "User will report bugs if they see `ERROR`. For example, http://www.erisian.com.au/bitcoin-core-dev/log-2021-02-13.html#l-296",
    "created_at": "2021-04-17T10:03:59Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r615236159",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615236159"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r615236159"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615236159/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 208,
    "side": "RIGHT",
    "in_reply_to_id": 598085607
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615236932",
    "pull_request_review_id": 638215872,
    "id": 615236932,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTIzNjkzMg==",
    "diff_hunk": "@@ -188,7 +188,7 @@ void BanMan::SweepBanned()\n                 m_banned.erase(it++);\n                 m_is_dirty = true;\n                 notify_ui = true;\n-                LogPrint(BCLog::NET, \"%s: Removed banned node ip/subnet from banlist.dat: %s\\n\", __func__, sub_net.ToString());\n+                LogPrint(BCLog::NET, \"%s: Removed banned node address/subnet: %s\\n\", __func__, sub_net.ToString());",
    "path": "src/banman.cpp",
    "position": null,
    "original_position": 30,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "03239a3ab204dfc71bb46f85679414b331836763",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Can remove `__func__` while touching this line?",
    "created_at": "2021-04-17T10:11:18Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r615236932",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615236932"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r615236932"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615236932/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 191,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615925693",
    "pull_request_review_id": 638974463,
    "id": 615925693,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTkyNTY5Mw==",
    "diff_hunk": "@@ -188,7 +188,7 @@ void BanMan::SweepBanned()\n                 m_banned.erase(it++);\n                 m_is_dirty = true;\n                 notify_ui = true;\n-                LogPrint(BCLog::NET, \"%s: Removed banned node ip/subnet from banlist.dat: %s\\n\", __func__, sub_net.ToString());\n+                LogPrint(BCLog::NET, \"%s: Removed banned node address/subnet: %s\\n\", __func__, sub_net.ToString());",
    "path": "src/banman.cpp",
    "position": null,
    "original_position": 30,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "03239a3ab204dfc71bb46f85679414b331836763",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Removed",
    "created_at": "2021-04-19T14:59:53Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r615925693",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615925693"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r615925693"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615925693/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 191,
    "side": "RIGHT",
    "in_reply_to_id": 615236932
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615930585",
    "pull_request_review_id": 638981145,
    "id": 615930585,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNTkzMDU4NQ==",
    "diff_hunk": "@@ -119,18 +175,46 @@ bool DeserializeFileDB(const fs::path& path, Data& data)\n }\n } // namespace\n \n-CBanDB::CBanDB(fs::path ban_list_path) : m_ban_list_path(std::move(ban_list_path))\n+CBanDB::CBanDB(fs::path ban_list_path)\n+    : m_banlist_dat(ban_list_path.string() + \".dat\"),\n+      m_banlist_json(ban_list_path.string() + \".json\")\n {\n }\n \n bool CBanDB::Write(const banmap_t& banSet)\n {\n-    return SerializeFileDB(\"banlist\", m_ban_list_path, banSet);\n+    std::vector<std::string> errors;\n+    if (util::WriteSettings(m_banlist_json, {{JSON_KEY, BanMapToJson(banSet)}}, errors)) {\n+        return true;\n+    }\n+\n+    for (const auto& err : errors) {\n+        error(\"%s: %s\", __func__, err);\n+    }\n+    return false;\n }\n \n bool CBanDB::Read(banmap_t& banSet)\n {\n-    return DeserializeFileDB(m_ban_list_path, banSet);\n+    if (!fs::exists(m_banlist_json)) {\n+        return DeserializeFileDB(m_banlist_dat, banSet);\n+    }\n+\n+    std::map<std::string, util::SettingsValue> settings;\n+    std::vector<std::string> errors;\n+\n+    if (!util::ReadSettings(m_banlist_json, settings, errors)) {\n+        for (const auto& err : errors) {\n+            error(\"%s: %s\", __func__, err);",
    "path": "src/addrdb.cpp",
    "position": null,
    "original_position": 107,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "8372aad9cc01774e981edee1dd8822a31ef6ea18",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I changed it to avoid the word \"error\". I don't think those errors should be hushed - those are errors from loading the file and we already checked that the file exists. So may include something like \"json parse error\", \"io error\", \"permission denied\".\r\n\r\nIn general I don't think we should avoid using \"error\" or use it just for cases where we have detected a bug in the program. Messages like \"error: permission denied\" or \"error: connection reset\" are to be expected.",
    "created_at": "2021-04-19T15:05:44Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r615930585",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615930585"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r615930585"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/615930585/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 208,
    "side": "RIGHT",
    "in_reply_to_id": 598085607
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616099538",
    "pull_request_review_id": 639208463,
    "id": 616099538,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNjA5OTUzOA==",
    "diff_hunk": "@@ -119,18 +175,46 @@ bool DeserializeFileDB(const fs::path& path, Data& data)\n }\n } // namespace\n \n-CBanDB::CBanDB(fs::path ban_list_path) : m_ban_list_path(std::move(ban_list_path))\n+CBanDB::CBanDB(fs::path ban_list_path)\n+    : m_banlist_dat(ban_list_path.string() + \".dat\"),\n+      m_banlist_json(ban_list_path.string() + \".json\")\n {\n }\n \n bool CBanDB::Write(const banmap_t& banSet)\n {\n-    return SerializeFileDB(\"banlist\", m_ban_list_path, banSet);\n+    std::vector<std::string> errors;\n+    if (util::WriteSettings(m_banlist_json, {{JSON_KEY, BanMapToJson(banSet)}}, errors)) {\n+        return true;\n+    }\n+\n+    for (const auto& err : errors) {\n+        error(\"%s: %s\", __func__, err);\n+    }\n+    return false;\n }\n \n bool CBanDB::Read(banmap_t& banSet)\n {\n-    return DeserializeFileDB(m_ban_list_path, banSet);\n+    if (!fs::exists(m_banlist_json)) {\n+        return DeserializeFileDB(m_banlist_dat, banSet);\n+    }\n+\n+    std::map<std::string, util::SettingsValue> settings;\n+    std::vector<std::string> errors;\n+\n+    if (!util::ReadSettings(m_banlist_json, settings, errors)) {\n+        for (const auto& err : errors) {\n+            error(\"%s: %s\", __func__, err);",
    "path": "src/addrdb.cpp",
    "position": null,
    "original_position": 107,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "8372aad9cc01774e981edee1dd8822a31ef6ea18",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": ":facepalm: Oh wait, I might have missed that this is actually an error. Then it is fine to mention the word \"error\"",
    "created_at": "2021-04-19T19:00:11Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r616099538",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616099538"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r616099538"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616099538/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 208,
    "side": "RIGHT",
    "in_reply_to_id": 598085607
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616166735",
    "pull_request_review_id": 639293715,
    "id": 616166735,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNjE2NjczNQ==",
    "diff_hunk": "@@ -51,12 +51,22 @@ def run_test(self):\n         ip_addr = \"1.2.3.4\"\n         assert(not self.is_banned(node, tor_addr))\n         assert(not self.is_banned(node, ip_addr))\n+\n         node.setban(tor_addr, \"add\")\n         assert(self.is_banned(node, tor_addr))\n         assert(not self.is_banned(node, ip_addr))\n+\n+        self.restart_node(1)",
    "path": "test/functional/rpc_setban.py",
    "position": 41,
    "original_position": 9,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "aa90a7d46a506b26a6016d1171f7ddae809e9c99",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "aa90a7d46a506b26a6016d1171f7ddae809e9c99\r\n\r\nnit, here and below, add a comment on why the check is repeated after the restart.",
    "created_at": "2021-04-19T20:47:46Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r616166735",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616166735"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r616166735"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616166735/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 61,
    "original_line": 61,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616173334",
    "pull_request_review_id": 639293715,
    "id": 616173334,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNjE3MzMzNA==",
    "diff_hunk": "@@ -119,18 +176,49 @@ bool DeserializeFileDB(const fs::path& path, Data& data)\n }\n } // namespace\n \n-CBanDB::CBanDB(fs::path ban_list_path) : m_ban_list_path(std::move(ban_list_path))\n+CBanDB::CBanDB(fs::path ban_list_path)\n+    : m_banlist_dat(ban_list_path.string() + \".dat\"),",
    "path": "src/addrdb.cpp",
    "position": 79,
    "original_position": 77,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "51909ded1e8b26158f8d36cfe323ac72feac1d78",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "51909ded1e8b26158f8d36cfe323ac72feac1d78\r\n\r\nnit, `fs::path(ban_list_path).replace_extension(\"dat\")`.",
    "created_at": "2021-04-19T20:58:44Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r616173334",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616173334"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r616173334"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616173334/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 182,
    "original_line": 182,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616211147",
    "pull_request_review_id": 639293715,
    "id": 616211147,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNjIxMTE0Nw==",
    "diff_hunk": "@@ -119,18 +176,49 @@ bool DeserializeFileDB(const fs::path& path, Data& data)\n }\n } // namespace\n \n-CBanDB::CBanDB(fs::path ban_list_path) : m_ban_list_path(std::move(ban_list_path))\n+CBanDB::CBanDB(fs::path ban_list_path)\n+    : m_banlist_dat(ban_list_path.string() + \".dat\"),\n+      m_banlist_json(ban_list_path.string() + \".json\")\n {\n }\n \n bool CBanDB::Write(const banmap_t& banSet)\n {\n-    return SerializeFileDB(\"banlist\", m_ban_list_path, banSet);\n+    std::vector<std::string> errors;\n+    if (util::WriteSettings(m_banlist_json, {{JSON_KEY, BanMapToJson(banSet)}}, errors)) {\n+        return true;\n+    }\n+\n+    for (const auto& err : errors) {\n+        error(\"%s\", err);\n+    }\n+    return false;\n }\n \n bool CBanDB::Read(banmap_t& banSet)\n {\n-    return DeserializeFileDB(m_ban_list_path, banSet);\n+    if (!fs::exists(m_banlist_json)) {",
    "path": "src/addrdb.cpp",
    "position": 103,
    "original_position": 99,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "aa90a7d46a506b26a6016d1171f7ddae809e9c99",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "51909ded1e8b26158f8d36cfe323ac72feac1d78\r\n\r\nA comment here would be nice. Or maybe just take the next suggestion so it's clear what this is doing.",
    "created_at": "2021-04-19T22:11:19Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r616211147",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616211147"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r616211147"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616211147/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 203,
    "original_line": 203,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616214439",
    "pull_request_review_id": 639293715,
    "id": 616214439,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNjIxNDQzOQ==",
    "diff_hunk": "@@ -119,18 +176,49 @@ bool DeserializeFileDB(const fs::path& path, Data& data)\n }\n } // namespace\n \n-CBanDB::CBanDB(fs::path ban_list_path) : m_ban_list_path(std::move(ban_list_path))\n+CBanDB::CBanDB(fs::path ban_list_path)\n+    : m_banlist_dat(ban_list_path.string() + \".dat\"),\n+      m_banlist_json(ban_list_path.string() + \".json\")\n {\n }\n \n bool CBanDB::Write(const banmap_t& banSet)\n {\n-    return SerializeFileDB(\"banlist\", m_ban_list_path, banSet);\n+    std::vector<std::string> errors;\n+    if (util::WriteSettings(m_banlist_json, {{JSON_KEY, BanMapToJson(banSet)}}, errors)) {\n+        return true;\n+    }\n+\n+    for (const auto& err : errors) {\n+        error(\"%s\", err);\n+    }\n+    return false;\n }\n \n bool CBanDB::Read(banmap_t& banSet)\n {\n-    return DeserializeFileDB(m_ban_list_path, banSet);\n+    if (!fs::exists(m_banlist_json)) {\n+        return DeserializeFileDB(m_banlist_dat, banSet);",
    "path": "src/addrdb.cpp",
    "position": null,
    "original_position": 100,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "aa90a7d46a506b26a6016d1171f7ddae809e9c99",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "51909ded1e8b26158f8d36cfe323ac72feac1d78\r\n\r\nMaybe migrate on 1st run?\r\n```diff\r\n bool CBanDB::Read(banmap_t& banSet)\r\n {\r\n     if (!fs::exists(m_banlist_json)) {\r\n-        return DeserializeFileDB(m_banlist_dat, banSet);\r\n+        if (!DeserializeFileDB(m_banlist_dat, banSet)) {\r\n+            return false;\r\n+        }\r\n+        // log something\r\n+        Write(banSet);\r\n+        return true;\r\n     }\r\n```",
    "created_at": "2021-04-19T22:19:17Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r616214439",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616214439"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r616214439"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616214439/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 206,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616826373",
    "pull_request_review_id": 640147406,
    "id": 616826373,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNjgyNjM3Mw==",
    "diff_hunk": "@@ -119,18 +175,46 @@ bool DeserializeFileDB(const fs::path& path, Data& data)\n }\n } // namespace\n \n-CBanDB::CBanDB(fs::path ban_list_path) : m_ban_list_path(std::move(ban_list_path))\n+CBanDB::CBanDB(fs::path ban_list_path)\n+    : m_banlist_dat(ban_list_path.string() + \".dat\"),\n+      m_banlist_json(ban_list_path.string() + \".json\")\n {\n }\n \n bool CBanDB::Write(const banmap_t& banSet)\n {\n-    return SerializeFileDB(\"banlist\", m_ban_list_path, banSet);\n+    std::vector<std::string> errors;\n+    if (util::WriteSettings(m_banlist_json, {{JSON_KEY, BanMapToJson(banSet)}}, errors)) {\n+        return true;\n+    }\n+\n+    for (const auto& err : errors) {\n+        error(\"%s: %s\", __func__, err);\n+    }\n+    return false;\n }\n \n bool CBanDB::Read(banmap_t& banSet)\n {\n-    return DeserializeFileDB(m_ban_list_path, banSet);\n+    if (!fs::exists(m_banlist_json)) {\n+        return DeserializeFileDB(m_banlist_dat, banSet);\n+    }\n+\n+    std::map<std::string, util::SettingsValue> settings;\n+    std::vector<std::string> errors;\n+\n+    if (!util::ReadSettings(m_banlist_json, settings, errors)) {\n+        for (const auto& err : errors) {\n+            error(\"%s: %s\", __func__, err);",
    "path": "src/addrdb.cpp",
    "position": null,
    "original_position": 107,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "8372aad9cc01774e981edee1dd8822a31ef6ea18",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I am leaving it as is, I don't like `error()` too much.",
    "created_at": "2021-04-20T15:59:23Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r616826373",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616826373"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r616826373"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616826373/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 208,
    "side": "RIGHT",
    "in_reply_to_id": 598085607
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616826715",
    "pull_request_review_id": 640147832,
    "id": 616826715,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNjgyNjcxNQ==",
    "diff_hunk": "@@ -51,12 +51,22 @@ def run_test(self):\n         ip_addr = \"1.2.3.4\"\n         assert(not self.is_banned(node, tor_addr))\n         assert(not self.is_banned(node, ip_addr))\n+\n         node.setban(tor_addr, \"add\")\n         assert(self.is_banned(node, tor_addr))\n         assert(not self.is_banned(node, ip_addr))\n+\n+        self.restart_node(1)",
    "path": "test/functional/rpc_setban.py",
    "position": 41,
    "original_position": 9,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "aa90a7d46a506b26a6016d1171f7ddae809e9c99",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Added a comment.",
    "created_at": "2021-04-20T15:59:46Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r616826715",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616826715"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r616826715"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616826715/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 61,
    "original_line": 61,
    "side": "RIGHT",
    "in_reply_to_id": 616166735
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616827889",
    "pull_request_review_id": 640149483,
    "id": 616827889,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNjgyNzg4OQ==",
    "diff_hunk": "@@ -119,18 +176,49 @@ bool DeserializeFileDB(const fs::path& path, Data& data)\n }\n } // namespace\n \n-CBanDB::CBanDB(fs::path ban_list_path) : m_ban_list_path(std::move(ban_list_path))\n+CBanDB::CBanDB(fs::path ban_list_path)\n+    : m_banlist_dat(ban_list_path.string() + \".dat\"),",
    "path": "src/addrdb.cpp",
    "position": 79,
    "original_position": 77,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "51909ded1e8b26158f8d36cfe323ac72feac1d78",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I find `replace_extension()` a bit confusing in this case because we know that there is no extension, so we are not replacing anything (I know it will do the right thing, but still).",
    "created_at": "2021-04-20T16:01:15Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r616827889",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616827889"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r616827889"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616827889/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 182,
    "original_line": 182,
    "side": "RIGHT",
    "in_reply_to_id": 616173334
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616828047",
    "pull_request_review_id": 640149711,
    "id": 616828047,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNjgyODA0Nw==",
    "diff_hunk": "@@ -119,18 +176,49 @@ bool DeserializeFileDB(const fs::path& path, Data& data)\n }\n } // namespace\n \n-CBanDB::CBanDB(fs::path ban_list_path) : m_ban_list_path(std::move(ban_list_path))\n+CBanDB::CBanDB(fs::path ban_list_path)\n+    : m_banlist_dat(ban_list_path.string() + \".dat\"),\n+      m_banlist_json(ban_list_path.string() + \".json\")\n {\n }\n \n bool CBanDB::Write(const banmap_t& banSet)\n {\n-    return SerializeFileDB(\"banlist\", m_ban_list_path, banSet);\n+    std::vector<std::string> errors;\n+    if (util::WriteSettings(m_banlist_json, {{JSON_KEY, BanMapToJson(banSet)}}, errors)) {\n+        return true;\n+    }\n+\n+    for (const auto& err : errors) {\n+        error(\"%s\", err);\n+    }\n+    return false;\n }\n \n bool CBanDB::Read(banmap_t& banSet)\n {\n-    return DeserializeFileDB(m_ban_list_path, banSet);\n+    if (!fs::exists(m_banlist_json)) {",
    "path": "src/addrdb.cpp",
    "position": 103,
    "original_position": 99,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "aa90a7d46a506b26a6016d1171f7ddae809e9c99",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Added some comments.",
    "created_at": "2021-04-20T16:01:27Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r616828047",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616828047"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r616828047"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616828047/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 203,
    "original_line": 203,
    "side": "RIGHT",
    "in_reply_to_id": 616211147
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616829628",
    "pull_request_review_id": 640151910,
    "id": 616829628,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNjgyOTYyOA==",
    "diff_hunk": "@@ -119,18 +176,49 @@ bool DeserializeFileDB(const fs::path& path, Data& data)\n }\n } // namespace\n \n-CBanDB::CBanDB(fs::path ban_list_path) : m_ban_list_path(std::move(ban_list_path))\n+CBanDB::CBanDB(fs::path ban_list_path)\n+    : m_banlist_dat(ban_list_path.string() + \".dat\"),\n+      m_banlist_json(ban_list_path.string() + \".json\")\n {\n }\n \n bool CBanDB::Write(const banmap_t& banSet)\n {\n-    return SerializeFileDB(\"banlist\", m_ban_list_path, banSet);\n+    std::vector<std::string> errors;\n+    if (util::WriteSettings(m_banlist_json, {{JSON_KEY, BanMapToJson(banSet)}}, errors)) {\n+        return true;\n+    }\n+\n+    for (const auto& err : errors) {\n+        error(\"%s\", err);\n+    }\n+    return false;\n }\n \n bool CBanDB::Read(banmap_t& banSet)\n {\n-    return DeserializeFileDB(m_ban_list_path, banSet);\n+    if (!fs::exists(m_banlist_json)) {\n+        return DeserializeFileDB(m_banlist_dat, banSet);",
    "path": "src/addrdb.cpp",
    "position": null,
    "original_position": 100,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "aa90a7d46a506b26a6016d1171f7ddae809e9c99",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Migrate on first run - yes. But `Read()` calling `Write()` seems like some anti-pattern to me. Instead I signal from `Read()` that the list needs re-flushing, so that the caller takes care of it.",
    "created_at": "2021-04-20T16:03:30Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r616829628",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616829628"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r616829628"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616829628/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 206,
    "side": "RIGHT",
    "in_reply_to_id": 616214439
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616843518",
    "pull_request_review_id": 640170176,
    "id": 616843518,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNjg0MzUxOA==",
    "diff_hunk": "@@ -119,18 +176,49 @@ bool DeserializeFileDB(const fs::path& path, Data& data)\n }\n } // namespace\n \n-CBanDB::CBanDB(fs::path ban_list_path) : m_ban_list_path(std::move(ban_list_path))\n+CBanDB::CBanDB(fs::path ban_list_path)\n+    : m_banlist_dat(ban_list_path.string() + \".dat\"),\n+      m_banlist_json(ban_list_path.string() + \".json\")\n {\n }\n \n bool CBanDB::Write(const banmap_t& banSet)\n {\n-    return SerializeFileDB(\"banlist\", m_ban_list_path, banSet);\n+    std::vector<std::string> errors;\n+    if (util::WriteSettings(m_banlist_json, {{JSON_KEY, BanMapToJson(banSet)}}, errors)) {\n+        return true;\n+    }\n+\n+    for (const auto& err : errors) {\n+        error(\"%s\", err);\n+    }\n+    return false;\n }\n \n bool CBanDB::Read(banmap_t& banSet)\n {\n-    return DeserializeFileDB(m_ban_list_path, banSet);\n+    if (!fs::exists(m_banlist_json)) {\n+        return DeserializeFileDB(m_banlist_dat, banSet);",
    "path": "src/addrdb.cpp",
    "position": null,
    "original_position": 100,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "aa90a7d46a506b26a6016d1171f7ddae809e9c99",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Good point. Maybe add a `CBanDB::MigrateAndRead` where calling `Write()` isn't so bad.",
    "created_at": "2021-04-20T16:20:39Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r616843518",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616843518"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r616843518"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/616843518/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 206,
    "side": "RIGHT",
    "in_reply_to_id": 616214439
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/617300060",
    "pull_request_review_id": 640752196,
    "id": 617300060,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxNzMwMDA2MA==",
    "diff_hunk": "@@ -119,18 +176,49 @@ bool DeserializeFileDB(const fs::path& path, Data& data)\n }\n } // namespace\n \n-CBanDB::CBanDB(fs::path ban_list_path) : m_ban_list_path(std::move(ban_list_path))\n+CBanDB::CBanDB(fs::path ban_list_path)\n+    : m_banlist_dat(ban_list_path.string() + \".dat\"),\n+      m_banlist_json(ban_list_path.string() + \".json\")\n {\n }\n \n bool CBanDB::Write(const banmap_t& banSet)\n {\n-    return SerializeFileDB(\"banlist\", m_ban_list_path, banSet);\n+    std::vector<std::string> errors;\n+    if (util::WriteSettings(m_banlist_json, {{JSON_KEY, BanMapToJson(banSet)}}, errors)) {\n+        return true;\n+    }\n+\n+    for (const auto& err : errors) {\n+        error(\"%s\", err);\n+    }\n+    return false;\n }\n \n bool CBanDB::Read(banmap_t& banSet)\n {\n-    return DeserializeFileDB(m_ban_list_path, banSet);\n+    if (!fs::exists(m_banlist_json)) {\n+        return DeserializeFileDB(m_banlist_dat, banSet);",
    "path": "src/addrdb.cpp",
    "position": null,
    "original_position": 100,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "aa90a7d46a506b26a6016d1171f7ddae809e9c99",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Not necessary with the latest changes.",
    "created_at": "2021-04-21T08:13:44Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r617300060",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/617300060"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r617300060"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/617300060/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 206,
    "side": "RIGHT",
    "in_reply_to_id": 616214439
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/619372413",
    "pull_request_review_id": 643501581,
    "id": 619372413,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxOTM3MjQxMw==",
    "diff_hunk": "@@ -55,7 +55,8 @@ Subdirectory       | File(s)               | Description\n `indexes/blockfilter/basic/`    | `fltrNNNNN.dat`<sup>[\\[2\\]](#note2)</sup> | Blockfilter index filters for the basic filtertype; *optional*, used if `-blockfilterindex=basic`\n `wallets/`         |                       | [Contains wallets](#multi-wallet-environment); can be specified by `-walletdir` option; if `wallets/` subdirectory does not exist, wallets reside in the [data directory](#data-directory-location)\n `./`               | `anchors.dat`         | Anchor IP address database, created on shutdown and deleted at startup. Anchors are last known outgoing block-relay-only peers that are tried to re-connect to on startup\n-`./`               | `banlist.dat`         | Stores the IPs/subnets of banned nodes\n+`./`               | `banlist.dat`         | Stores the addresses/subnets of banned nodes (deprecated). Bitcoin Core will not save the banlist to it. It would only read it on startup if `banlist.json` is not present.",
    "path": "doc/files.md",
    "position": null,
    "original_position": 5,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "08f4f98ea2cdc3fbff5c9e21870296106430e468",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "s/would/will/\r\n\r\nSuggested version all in present tense:\r\n```suggestion\r\n`./`               | `banlist.dat`         | Stores the addresses/subnets of banned nodes (deprecated); `bitcoind` or `bitcoin-qt` no longer save the banlist to this file, but read it on startup if `banlist.json` is not present.\r\n```\r\n------\r\nif you retouch, in the same commit and file would you please touch up:\r\n```diff\r\n ## Legacy subdirectories and files\r\n \r\n-These subdirectories and files are no longer used by the Bitcoin Core:\r\n+These subdirectories and files are no longer used by Bitcoin Core:\r\n```\r\n",
    "created_at": "2021-04-23T17:04:16Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r619372413",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/619372413"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r619372413"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/619372413/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 58,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/619375121",
    "pull_request_review_id": 643501581,
    "id": 619375121,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYxOTM3NTEyMQ==",
    "diff_hunk": "@@ -51,12 +51,24 @@ def run_test(self):\n         ip_addr = \"1.2.3.4\"\n         assert(not self.is_banned(node, tor_addr))\n         assert(not self.is_banned(node, ip_addr))\n+\n         node.setban(tor_addr, \"add\")\n         assert(self.is_banned(node, tor_addr))\n         assert(not self.is_banned(node, ip_addr))\n+\n+        # Test that the ban list is preserved through restart.\n+\n+        self.restart_node(1)\n+        assert(self.is_banned(node, tor_addr))\n+        assert(not self.is_banned(node, ip_addr))\n+\n         node.setban(tor_addr, \"remove\")\n         assert(not self.is_banned(self.nodes[1], tor_addr))\n         assert(not self.is_banned(node, ip_addr))\n \n+        self.restart_node(1)\n+        assert(not self.is_banned(self.nodes[1], tor_addr))\n+        assert(not self.is_banned(node, ip_addr))",
    "path": "test/functional/rpc_setban.py",
    "position": null,
    "original_position": 21,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "08f4f98ea2cdc3fbff5c9e21870296106430e468",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "08f4f98ea nit, drop the outer parens on the 4 added asserts and add a second newline at line 72 (per pycodestyle, \"E305 expected 2 blank lines after class or function definition, found 1\") \r\n\r\n(the black linter, e.g. `apt install black && black test/functional/rpc_setban.py` will do both of these for you)",
    "created_at": "2021-04-23T17:08:45Z",
    "updated_at": "2021-04-26T07:58:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r619375121",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/619375121"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r619375121"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/619375121/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 71,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620060270",
    "pull_request_review_id": 644370881,
    "id": 620060270,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDA2MDI3MA==",
    "diff_hunk": "@@ -55,7 +55,8 @@ Subdirectory       | File(s)               | Description\n `indexes/blockfilter/basic/`    | `fltrNNNNN.dat`<sup>[\\[2\\]](#note2)</sup> | Blockfilter index filters for the basic filtertype; *optional*, used if `-blockfilterindex=basic`\n `wallets/`         |                       | [Contains wallets](#multi-wallet-environment); can be specified by `-walletdir` option; if `wallets/` subdirectory does not exist, wallets reside in the [data directory](#data-directory-location)\n `./`               | `anchors.dat`         | Anchor IP address database, created on shutdown and deleted at startup. Anchors are last known outgoing block-relay-only peers that are tried to re-connect to on startup\n-`./`               | `banlist.dat`         | Stores the IPs/subnets of banned nodes\n+`./`               | `banlist.dat`         | Stores the addresses/subnets of banned nodes (deprecated). Bitcoin Core will not save the banlist to it. It would only read it on startup if `banlist.json` is not present.",
    "path": "doc/files.md",
    "position": null,
    "original_position": 5,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "08f4f98ea2cdc3fbff5c9e21870296106430e468",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done. Put that last change in a separate commit.",
    "created_at": "2021-04-26T08:01:07Z",
    "updated_at": "2021-04-26T08:01:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r620060270",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620060270"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r620060270"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620060270/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 58,
    "side": "RIGHT",
    "in_reply_to_id": 619372413
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620061718",
    "pull_request_review_id": 644372897,
    "id": 620061718,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDA2MTcxOA==",
    "diff_hunk": "@@ -51,12 +51,24 @@ def run_test(self):\n         ip_addr = \"1.2.3.4\"\n         assert(not self.is_banned(node, tor_addr))\n         assert(not self.is_banned(node, ip_addr))\n+\n         node.setban(tor_addr, \"add\")\n         assert(self.is_banned(node, tor_addr))\n         assert(not self.is_banned(node, ip_addr))\n+\n+        # Test that the ban list is preserved through restart.\n+\n+        self.restart_node(1)\n+        assert(self.is_banned(node, tor_addr))\n+        assert(not self.is_banned(node, ip_addr))\n+\n         node.setban(tor_addr, \"remove\")\n         assert(not self.is_banned(self.nodes[1], tor_addr))\n         assert(not self.is_banned(node, ip_addr))\n \n+        self.restart_node(1)\n+        assert(not self.is_banned(self.nodes[1], tor_addr))\n+        assert(not self.is_banned(node, ip_addr))",
    "path": "test/functional/rpc_setban.py",
    "position": null,
    "original_position": 21,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "08f4f98ea2cdc3fbff5c9e21870296106430e468",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done. Since the surrounding code uses `assert()` I added the new code with `assert()` for consistency and then removed all `()` from asserts in the entire file in a separate commit.",
    "created_at": "2021-04-26T08:03:17Z",
    "updated_at": "2021-04-26T08:03:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r620061718",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620061718"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r620061718"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620061718/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 71,
    "side": "RIGHT",
    "in_reply_to_id": 619375121
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620088086",
    "pull_request_review_id": 644406696,
    "id": 620088086,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDA4ODA4Ng==",
    "diff_hunk": "@@ -22,7 +22,7 @@ def run_test(self):\n         # Node 0 connects to Node 1, check that the noban permission is not granted\n         self.connect_nodes(0, 1)\n         peerinfo = self.nodes[1].getpeerinfo()[0]\n-        assert(not 'noban' in peerinfo['permissions'])\n+        assert not \"noban\" in peerinfo[\"permissions\"]",
    "path": "test/functional/rpc_setban.py",
    "position": 5,
    "original_position": 5,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "fe4aafda512483e863b23cfad403509b1604555c",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "fe4aafda512483e863b23cfad403509b1604555c drive-by nit, while touching lines 25 and 46 in this commit (maybe just make it a PEP8/black linter commit)\r\n\r\n`$ pycodestyle test/functional/rpc_setban.py`\r\n\r\n    test/functional/rpc_setban.py:25:16: E713 test for membership should be 'not in'\r\n    test/functional/rpc_setban.py:46:16: E713 test for membership should be 'not in'\r\n",
    "created_at": "2021-04-26T08:39:23Z",
    "updated_at": "2021-04-26T08:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r620088086",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620088086"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r620088086"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620088086/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 25,
    "original_line": 25,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620116268",
    "pull_request_review_id": 644443038,
    "id": 620116268,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDExNjI2OA==",
    "diff_hunk": "@@ -22,7 +22,7 @@ def run_test(self):\n         # Node 0 connects to Node 1, check that the noban permission is not granted\n         self.connect_nodes(0, 1)\n         peerinfo = self.nodes[1].getpeerinfo()[0]\n-        assert(not 'noban' in peerinfo['permissions'])\n+        assert not \"noban\" in peerinfo[\"permissions\"]",
    "path": "test/functional/rpc_setban.py",
    "position": 5,
    "original_position": 5,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "fe4aafda512483e863b23cfad403509b1604555c",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Going to leave it as is because none of \"black\" or \"pycodestyle\" is mentioned in `doc/`. Don't want to bother other reviewers with too big and unrelated changes to this PR.",
    "created_at": "2021-04-26T09:15:12Z",
    "updated_at": "2021-04-26T09:15:12Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r620116268",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620116268"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r620116268"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620116268/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 25,
    "original_line": 25,
    "side": "RIGHT",
    "in_reply_to_id": 620088086
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620119397",
    "pull_request_review_id": 644447234,
    "id": 620119397,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDExOTM5Nw==",
    "diff_hunk": "@@ -22,7 +22,7 @@ def run_test(self):\n         # Node 0 connects to Node 1, check that the noban permission is not granted\n         self.connect_nodes(0, 1)\n         peerinfo = self.nodes[1].getpeerinfo()[0]\n-        assert(not 'noban' in peerinfo['permissions'])\n+        assert not \"noban\" in peerinfo[\"permissions\"]",
    "path": "test/functional/rpc_setban.py",
    "position": 5,
    "original_position": 5,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "fe4aafda512483e863b23cfad403509b1604555c",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Ok. For info, pycodestyle is PEP8 that we follow per doc/test/functional/README.md\r\n\r\nhttps://pypi.org/project/pycodestyle",
    "created_at": "2021-04-26T09:19:27Z",
    "updated_at": "2021-04-26T09:19:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r620119397",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620119397"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r620119397"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620119397/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 25,
    "original_line": 25,
    "side": "RIGHT",
    "in_reply_to_id": 620088086
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620120674",
    "pull_request_review_id": 644448947,
    "id": 620120674,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDEyMDY3NA==",
    "diff_hunk": "@@ -22,7 +22,7 @@ def run_test(self):\n         # Node 0 connects to Node 1, check that the noban permission is not granted\n         self.connect_nodes(0, 1)\n         peerinfo = self.nodes[1].getpeerinfo()[0]\n-        assert(not 'noban' in peerinfo['permissions'])\n+        assert not \"noban\" in peerinfo[\"permissions\"]",
    "path": "test/functional/rpc_setban.py",
    "position": 5,
    "original_position": 5,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "fe4aafda512483e863b23cfad403509b1604555c",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "(ah, it was renamed from PEP8 for this reason https://github.com/PyCQA/pycodestyle/issues/466)",
    "created_at": "2021-04-26T09:21:12Z",
    "updated_at": "2021-04-26T09:21:12Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r620120674",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620120674"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r620120674"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620120674/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 25,
    "original_line": 25,
    "side": "RIGHT",
    "in_reply_to_id": 620088086
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620133277",
    "pull_request_review_id": 644464895,
    "id": 620133277,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDEzMzI3Nw==",
    "diff_hunk": "@@ -22,7 +22,7 @@ def run_test(self):\n         # Node 0 connects to Node 1, check that the noban permission is not granted\n         self.connect_nodes(0, 1)\n         peerinfo = self.nodes[1].getpeerinfo()[0]\n-        assert(not 'noban' in peerinfo['permissions'])\n+        assert not \"noban\" in peerinfo[\"permissions\"]",
    "path": "test/functional/rpc_setban.py",
    "position": 5,
    "original_position": 5,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "fe4aafda512483e863b23cfad403509b1604555c",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`lint-python.sh` is happy with the current `rpc_setban.py`:\r\n\r\n```sh\r\n$ ./test/lint/lint-python.sh\r\ntest/functional/test_runner.py:42: error: Module has no attribute \"getwindowsversion\"\r\nFound 1 error in 1 file (checked 199 source files)\r\n$\r\n```",
    "created_at": "2021-04-26T09:37:44Z",
    "updated_at": "2021-04-26T09:37:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r620133277",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620133277"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r620133277"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620133277/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 25,
    "original_line": 25,
    "side": "RIGHT",
    "in_reply_to_id": 620088086
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620157123",
    "pull_request_review_id": 644494451,
    "id": 620157123,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYyMDE1NzEyMw==",
    "diff_hunk": "@@ -22,7 +22,7 @@ def run_test(self):\n         # Node 0 connects to Node 1, check that the noban permission is not granted\n         self.connect_nodes(0, 1)\n         peerinfo = self.nodes[1].getpeerinfo()[0]\n-        assert(not 'noban' in peerinfo['permissions'])\n+        assert not \"noban\" in peerinfo[\"permissions\"]",
    "path": "test/functional/rpc_setban.py",
    "position": 5,
    "original_position": 5,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "fe4aafda512483e863b23cfad403509b1604555c",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "If adding new code or retouching old code for style reasons, I'd try to make it conform (https://www.python.org/dev/peps/pep-0008/#other-recommendations, https://www.flake8rules.com/rules/E713.html for \"not in\") because reviewers are often picky about it. I also wouldn't add a commit that does a one-word grammar change because otherwise someone will invariably ask me to squash the commit. But everyone has a different experience with this so definitely feel free to ignore.",
    "created_at": "2021-04-26T10:09:35Z",
    "updated_at": "2021-04-26T10:12:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r620157123",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620157123"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r620157123"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/620157123/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 25,
    "original_line": 25,
    "side": "RIGHT",
    "in_reply_to_id": 620088086
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/631375563",
    "pull_request_review_id": 658347550,
    "id": 631375563,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzMTM3NTU2Mw==",
    "diff_hunk": "@@ -119,18 +176,54 @@ bool DeserializeFileDB(const fs::path& path, Data& data)\n }\n } // namespace\n \n-CBanDB::CBanDB(fs::path ban_list_path) : m_ban_list_path(std::move(ban_list_path))\n+CBanDB::CBanDB(fs::path ban_list_path)\n+    : m_banlist_dat(ban_list_path.string() + \".dat\"),\n+      m_banlist_json(ban_list_path.string() + \".json\")\n {\n }\n \n bool CBanDB::Write(const banmap_t& banSet)\n {\n-    return SerializeFileDB(\"banlist\", m_ban_list_path, banSet);\n+    std::vector<std::string> errors;\n+    if (util::WriteSettings(m_banlist_json, {{JSON_KEY, BanMapToJson(banSet)}}, errors)) {",
    "path": "src/addrdb.cpp",
    "position": 88,
    "original_position": 86,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "391b4d5e84db2811df4de371480729fd0e8c42b8",
    "user": {
      "login": "dhruv",
      "id": 856960,
      "node_id": "MDQ6VXNlcjg1Njk2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dhruv",
      "html_url": "https://github.com/dhruv",
      "followers_url": "https://api.github.com/users/dhruv/followers",
      "following_url": "https://api.github.com/users/dhruv/following{/other_user}",
      "gists_url": "https://api.github.com/users/dhruv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
      "organizations_url": "https://api.github.com/users/dhruv/orgs",
      "repos_url": "https://api.github.com/users/dhruv/repos",
      "events_url": "https://api.github.com/users/dhruv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dhruv/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Would it be worthwhile renaming `(Read)WriteSettings()` to something like `(Read)WriteJsonObjFile()`?",
    "created_at": "2021-05-12T20:29:10Z",
    "updated_at": "2021-05-14T19:36:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r631375563",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/631375563"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r631375563"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/631375563/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 190,
    "original_line": 190,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/631378639",
    "pull_request_review_id": 658347550,
    "id": 631378639,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzMTM3ODYzOQ==",
    "diff_hunk": "@@ -11,13 +11,70 @@\n #include <cstdint>\n #include <hash.h>\n #include <logging/timer.h>\n+#include <netbase.h>\n #include <random.h>\n #include <streams.h>\n #include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/settings.h>\n #include <util/system.h>\n \n+CBanEntry::CBanEntry(const UniValue& json)\n+    : nVersion(json[\"version\"].get_int()), nCreateTime(json[\"ban_created\"].get_int64()),\n+      nBanUntil(json[\"banned_until\"].get_int64())\n+{\n+}\n+\n+UniValue CBanEntry::ToJson() const\n+{\n+    UniValue json(UniValue::VOBJ);\n+    json.pushKV(\"version\", nVersion);\n+    json.pushKV(\"ban_created\", nCreateTime);\n+    json.pushKV(\"banned_until\", nBanUntil);\n+    return json;\n+}\n+\n namespace {\n \n+/**\n+ * Convert a `banmap_t` object to a JSON array.\n+ * @param[in] bans Bans list to convert.\n+ * @return a JSON array, similar to the one returned by the `listbanned` RPC. Suitable for\n+ * passing to `BanMapFromJson()`.\n+ */\n+UniValue BanMapToJson(const banmap_t& bans)\n+{\n+    UniValue bans_json(UniValue::VARR);\n+    for (const auto& it : bans) {\n+        const auto& address = it.first;\n+        const auto& ban_entry = it.second;\n+        UniValue j = ban_entry.ToJson();\n+        j.pushKV(\"address\", address.ToString());",
    "path": "src/addrdb.cpp",
    "position": null,
    "original_position": 42,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "391b4d5e84db2811df4de371480729fd0e8c42b8",
    "user": {
      "login": "dhruv",
      "id": 856960,
      "node_id": "MDQ6VXNlcjg1Njk2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dhruv",
      "html_url": "https://github.com/dhruv",
      "followers_url": "https://api.github.com/users/dhruv/followers",
      "following_url": "https://api.github.com/users/dhruv/following{/other_user}",
      "gists_url": "https://api.github.com/users/dhruv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
      "organizations_url": "https://api.github.com/users/dhruv/orgs",
      "repos_url": "https://api.github.com/users/dhruv/repos",
      "events_url": "https://api.github.com/users/dhruv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dhruv/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Can the string \"address\" be a file-level `const` and re-used in `BanMapFromJson()`?",
    "created_at": "2021-05-12T20:34:32Z",
    "updated_at": "2021-05-14T19:36:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r631378639",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/631378639"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r631378639"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/631378639/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 52,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/631402209",
    "pull_request_review_id": 658347550,
    "id": 631402209,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzMTQwMjIwOQ==",
    "diff_hunk": "@@ -11,13 +11,70 @@\n #include <cstdint>\n #include <hash.h>\n #include <logging/timer.h>\n+#include <netbase.h>\n #include <random.h>\n #include <streams.h>\n #include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/settings.h>\n #include <util/system.h>\n \n+CBanEntry::CBanEntry(const UniValue& json)\n+    : nVersion(json[\"version\"].get_int()), nCreateTime(json[\"ban_created\"].get_int64()),\n+      nBanUntil(json[\"banned_until\"].get_int64())\n+{\n+}\n+\n+UniValue CBanEntry::ToJson() const\n+{\n+    UniValue json(UniValue::VOBJ);\n+    json.pushKV(\"version\", nVersion);\n+    json.pushKV(\"ban_created\", nCreateTime);\n+    json.pushKV(\"banned_until\", nBanUntil);\n+    return json;\n+}\n+\n namespace {\n \n+/**\n+ * Convert a `banmap_t` object to a JSON array.\n+ * @param[in] bans Bans list to convert.\n+ * @return a JSON array, similar to the one returned by the `listbanned` RPC. Suitable for\n+ * passing to `BanMapFromJson()`.\n+ */\n+UniValue BanMapToJson(const banmap_t& bans)\n+{\n+    UniValue bans_json(UniValue::VARR);\n+    for (const auto& it : bans) {\n+        const auto& address = it.first;\n+        const auto& ban_entry = it.second;\n+        UniValue j = ban_entry.ToJson();\n+        j.pushKV(\"address\", address.ToString());\n+        bans_json.push_back(j);\n+    }\n+    return bans_json;\n+}\n+\n+/**\n+ * Convert a JSON array to a `banmap_t` object.\n+ * @param[in] bans_json JSON to convert, must be as returned by `BanMapToJson()`.\n+ * @param[out] bans Bans list to create from the JSON.\n+ * @throws std::runtime_error if the JSON does not have the expected fields or they contain\n+ * unparsable values.\n+ */\n+void BanMapFromJson(const UniValue& bans_json, banmap_t& bans)\n+{\n+    for (const auto& ban_entry_json : bans_json.getValues()) {\n+        CSubNet subnet;\n+        const auto& subnet_str = ban_entry_json[\"address\"].get_str();\n+        if (!LookupSubNet(subnet_str, subnet)) {",
    "path": "src/addrdb.cpp",
    "position": 62,
    "original_position": 60,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "391b4d5e84db2811df4de371480729fd0e8c42b8",
    "user": {
      "login": "dhruv",
      "id": 856960,
      "node_id": "MDQ6VXNlcjg1Njk2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dhruv",
      "html_url": "https://github.com/dhruv",
      "followers_url": "https://api.github.com/users/dhruv/followers",
      "following_url": "https://api.github.com/users/dhruv/following{/other_user}",
      "gists_url": "https://api.github.com/users/dhruv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
      "organizations_url": "https://api.github.com/users/dhruv/orgs",
      "repos_url": "https://api.github.com/users/dhruv/repos",
      "events_url": "https://api.github.com/users/dhruv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dhruv/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Is it useful to sanity check `version` and `banned_until` as well?",
    "created_at": "2021-05-12T21:06:06Z",
    "updated_at": "2021-05-14T19:36:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r631402209",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/631402209"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r631402209"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/631402209/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 72,
    "original_line": 72,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/632146518",
    "pull_request_review_id": 658347550,
    "id": 632146518,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzMjE0NjUxOA==",
    "diff_hunk": "@@ -62,15 +76,30 @@ class CAddrDB\n     static bool Read(CAddrMan& addr, CDataStream& ssPeers);\n };\n \n-/** Access to the banlist database (banlist.dat) */\n+/** Access to the banlist databases (banlist.json and banlist.dat) */\n class CBanDB\n {\n private:\n-    const fs::path m_ban_list_path;\n+    /**\n+     * JSON key under which the data is stored in the json database.\n+     */\n+    static constexpr const char* JSON_KEY = \"banned_nets\";\n+\n+    const fs::path m_banlist_dat;\n+    const fs::path m_banlist_json;\n public:\n     explicit CBanDB(fs::path ban_list_path);\n     bool Write(const banmap_t& banSet);\n-    bool Read(banmap_t& banSet);\n+\n+    /**\n+     * Read the banlist from disk.\n+     * @param[out] banSet The loaded list, set if `true` is returned, otherwise it is left\n+     * in an undefined state.\n+     * @param[out] dirty Indicates whether the loaded list needs flushing to disk, only set",
    "path": "src/addrdb.h",
    "position": null,
    "original_position": 61,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "391b4d5e84db2811df4de371480729fd0e8c42b8",
    "user": {
      "login": "dhruv",
      "id": 856960,
      "node_id": "MDQ6VXNlcjg1Njk2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dhruv",
      "html_url": "https://github.com/dhruv",
      "followers_url": "https://api.github.com/users/dhruv/followers",
      "following_url": "https://api.github.com/users/dhruv/following{/other_user}",
      "gists_url": "https://api.github.com/users/dhruv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
      "organizations_url": "https://api.github.com/users/dhruv/orgs",
      "repos_url": "https://api.github.com/users/dhruv/repos",
      "events_url": "https://api.github.com/users/dhruv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dhruv/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> only set if `true` is returned.\r\n\r\nI _think_ it's possible for it to be set and yet the function return false if `DeserializeFileDB` returns `false` due to an invalid or missing file.",
    "created_at": "2021-05-13T22:39:38Z",
    "updated_at": "2021-05-14T19:36:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r632146518",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/632146518"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r632146518"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/632146518/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 98,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/632151649",
    "pull_request_review_id": 658347550,
    "id": 632151649,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzMjE1MTY0OQ==",
    "diff_hunk": "@@ -119,18 +176,54 @@ bool DeserializeFileDB(const fs::path& path, Data& data)\n }\n } // namespace\n \n-CBanDB::CBanDB(fs::path ban_list_path) : m_ban_list_path(std::move(ban_list_path))\n+CBanDB::CBanDB(fs::path ban_list_path)\n+    : m_banlist_dat(ban_list_path.string() + \".dat\"),\n+      m_banlist_json(ban_list_path.string() + \".json\")\n {\n }\n \n bool CBanDB::Write(const banmap_t& banSet)\n {\n-    return SerializeFileDB(\"banlist\", m_ban_list_path, banSet);\n+    std::vector<std::string> errors;\n+    if (util::WriteSettings(m_banlist_json, {{JSON_KEY, BanMapToJson(banSet)}}, errors)) {\n+        return true;",
    "path": "src/addrdb.cpp",
    "position": 89,
    "original_position": 87,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "391b4d5e84db2811df4de371480729fd0e8c42b8",
    "user": {
      "login": "dhruv",
      "id": 856960,
      "node_id": "MDQ6VXNlcjg1Njk2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dhruv",
      "html_url": "https://github.com/dhruv",
      "followers_url": "https://api.github.com/users/dhruv/followers",
      "following_url": "https://api.github.com/users/dhruv/following{/other_user}",
      "gists_url": "https://api.github.com/users/dhruv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
      "organizations_url": "https://api.github.com/users/dhruv/orgs",
      "repos_url": "https://api.github.com/users/dhruv/repos",
      "events_url": "https://api.github.com/users/dhruv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dhruv/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Is it useful to remove `banlist.dat` if it does exist at this point? Or a log to inform the user that they can remove it? Might be confusing to have two files both claiming to be banlists.",
    "created_at": "2021-05-13T22:54:26Z",
    "updated_at": "2021-05-14T19:36:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r632151649",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/632151649"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r632151649"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/632151649/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 191,
    "original_line": 191,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/632169018",
    "pull_request_review_id": 658347550,
    "id": 632169018,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzMjE2OTAxOA==",
    "diff_hunk": "@@ -17,7 +17,8 @@\n \n // NOTE: When adjusting this, update rpcnet:setban's help (\"24h\")\n static constexpr unsigned int DEFAULT_MISBEHAVING_BANTIME = 60 * 60 * 24; // Default 24-hour ban\n-// How often to dump addresses to banlist.dat\n+\n+/// How often to dump banned addresses/subnets to disk.",
    "path": "src/banman.h",
    "position": 6,
    "original_position": 6,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "391b4d5e84db2811df4de371480729fd0e8c42b8",
    "user": {
      "login": "dhruv",
      "id": 856960,
      "node_id": "MDQ6VXNlcjg1Njk2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dhruv",
      "html_url": "https://github.com/dhruv",
      "followers_url": "https://api.github.com/users/dhruv/followers",
      "following_url": "https://api.github.com/users/dhruv/following{/other_user}",
      "gists_url": "https://api.github.com/users/dhruv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
      "organizations_url": "https://api.github.com/users/dhruv/orgs",
      "repos_url": "https://api.github.com/users/dhruv/repos",
      "events_url": "https://api.github.com/users/dhruv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dhruv/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Extra \"/\"",
    "created_at": "2021-05-13T23:48:15Z",
    "updated_at": "2021-05-14T19:36:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r632169018",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/632169018"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r632169018"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/632169018/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 21,
    "original_line": 21,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/632279391",
    "pull_request_review_id": 658347550,
    "id": 632279391,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzMjI3OTM5MQ==",
    "diff_hunk": "@@ -34,8 +36,20 @@ FUZZ_TARGET_INIT(banman, initialize_banman)\n {\n     FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n     SetMockTime(ConsumeTime(fuzzed_data_provider));\n-    const fs::path banlist_file = GetDataDir() / \"fuzzed_banlist.dat\";\n-    fs::remove(banlist_file);\n+    fs::path banlist_file = GetDataDir() / \"fuzzed_banlist\";",
    "path": "src/test/fuzz/banman.cpp",
    "position": null,
    "original_position": 17,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "391b4d5e84db2811df4de371480729fd0e8c42b8",
    "user": {
      "login": "dhruv",
      "id": 856960,
      "node_id": "MDQ6VXNlcjg1Njk2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dhruv",
      "html_url": "https://github.com/dhruv",
      "followers_url": "https://api.github.com/users/dhruv/followers",
      "following_url": "https://api.github.com/users/dhruv/following{/other_user}",
      "gists_url": "https://api.github.com/users/dhruv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
      "organizations_url": "https://api.github.com/users/dhruv/orgs",
      "repos_url": "https://api.github.com/users/dhruv/repos",
      "events_url": "https://api.github.com/users/dhruv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dhruv/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Is there a way to add these fuzz tests and not invalidate the existing seeds?",
    "created_at": "2021-05-14T04:52:35Z",
    "updated_at": "2021-05-14T19:36:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r632279391",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/632279391"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r632279391"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/632279391/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 39,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/632705279",
    "pull_request_review_id": 658347550,
    "id": 632705279,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzMjcwNTI3OQ==",
    "diff_hunk": "@@ -22,7 +22,7 @@ def run_test(self):\n         # Node 0 connects to Node 1, check that the noban permission is not granted\n         self.connect_nodes(0, 1)\n         peerinfo = self.nodes[1].getpeerinfo()[0]\n-        assert(not 'noban' in peerinfo['permissions'])\n+        assert not \"noban\" in peerinfo[\"permissions\"]",
    "path": "test/functional/rpc_setban.py",
    "position": 5,
    "original_position": 5,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "fe4aafda512483e863b23cfad403509b1604555c",
    "user": {
      "login": "dhruv",
      "id": 856960,
      "node_id": "MDQ6VXNlcjg1Njk2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dhruv",
      "html_url": "https://github.com/dhruv",
      "followers_url": "https://api.github.com/users/dhruv/followers",
      "following_url": "https://api.github.com/users/dhruv/following{/other_user}",
      "gists_url": "https://api.github.com/users/dhruv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
      "organizations_url": "https://api.github.com/users/dhruv/orgs",
      "repos_url": "https://api.github.com/users/dhruv/repos",
      "events_url": "https://api.github.com/users/dhruv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dhruv/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I know this is a resolved comment. Just leaving my +1 for `assert x not in y` being easier than `not assert x in y`",
    "created_at": "2021-05-14T18:05:53Z",
    "updated_at": "2021-05-14T19:36:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r632705279",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/632705279"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r632705279"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/632705279/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 25,
    "original_line": 25,
    "side": "RIGHT",
    "in_reply_to_id": 620088086
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634439439",
    "pull_request_review_id": 662162688,
    "id": 634439439,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzNDQzOTQzOQ==",
    "diff_hunk": "@@ -11,13 +11,70 @@\n #include <cstdint>\n #include <hash.h>\n #include <logging/timer.h>\n+#include <netbase.h>\n #include <random.h>\n #include <streams.h>\n #include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/settings.h>\n #include <util/system.h>\n \n+CBanEntry::CBanEntry(const UniValue& json)\n+    : nVersion(json[\"version\"].get_int()), nCreateTime(json[\"ban_created\"].get_int64()),\n+      nBanUntil(json[\"banned_until\"].get_int64())\n+{\n+}\n+\n+UniValue CBanEntry::ToJson() const\n+{\n+    UniValue json(UniValue::VOBJ);\n+    json.pushKV(\"version\", nVersion);\n+    json.pushKV(\"ban_created\", nCreateTime);\n+    json.pushKV(\"banned_until\", nBanUntil);\n+    return json;\n+}\n+\n namespace {\n \n+/**\n+ * Convert a `banmap_t` object to a JSON array.\n+ * @param[in] bans Bans list to convert.\n+ * @return a JSON array, similar to the one returned by the `listbanned` RPC. Suitable for\n+ * passing to `BanMapFromJson()`.\n+ */\n+UniValue BanMapToJson(const banmap_t& bans)\n+{\n+    UniValue bans_json(UniValue::VARR);\n+    for (const auto& it : bans) {\n+        const auto& address = it.first;\n+        const auto& ban_entry = it.second;\n+        UniValue j = ban_entry.ToJson();\n+        j.pushKV(\"address\", address.ToString());\n+        bans_json.push_back(j);\n+    }\n+    return bans_json;\n+}\n+\n+/**\n+ * Convert a JSON array to a `banmap_t` object.\n+ * @param[in] bans_json JSON to convert, must be as returned by `BanMapToJson()`.\n+ * @param[out] bans Bans list to create from the JSON.\n+ * @throws std::runtime_error if the JSON does not have the expected fields or they contain\n+ * unparsable values.\n+ */\n+void BanMapFromJson(const UniValue& bans_json, banmap_t& bans)\n+{\n+    for (const auto& ban_entry_json : bans_json.getValues()) {\n+        CSubNet subnet;\n+        const auto& subnet_str = ban_entry_json[\"address\"].get_str();\n+        if (!LookupSubNet(subnet_str, subnet)) {",
    "path": "src/addrdb.cpp",
    "position": 62,
    "original_position": 60,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "391b4d5e84db2811df4de371480729fd0e8c42b8",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I am not sure. `version` and `banned_until` are not sanity-checked when reading `banlist.dat`, so I do the same with `banlist.json` as the purpose of this PR is to switch the format, not introduce new checks.\r\n\r\nMaybe worth considering separately.",
    "created_at": "2021-05-18T14:29:05Z",
    "updated_at": "2021-05-18T14:29:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r634439439",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634439439"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r634439439"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634439439/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 72,
    "original_line": 72,
    "side": "RIGHT",
    "in_reply_to_id": 631402209
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634452821",
    "pull_request_review_id": 662180763,
    "id": 634452821,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzNDQ1MjgyMQ==",
    "diff_hunk": "@@ -119,18 +176,54 @@ bool DeserializeFileDB(const fs::path& path, Data& data)\n }\n } // namespace\n \n-CBanDB::CBanDB(fs::path ban_list_path) : m_ban_list_path(std::move(ban_list_path))\n+CBanDB::CBanDB(fs::path ban_list_path)\n+    : m_banlist_dat(ban_list_path.string() + \".dat\"),\n+      m_banlist_json(ban_list_path.string() + \".json\")\n {\n }\n \n bool CBanDB::Write(const banmap_t& banSet)\n {\n-    return SerializeFileDB(\"banlist\", m_ban_list_path, banSet);\n+    std::vector<std::string> errors;\n+    if (util::WriteSettings(m_banlist_json, {{JSON_KEY, BanMapToJson(banSet)}}, errors)) {\n+        return true;",
    "path": "src/addrdb.cpp",
    "position": 89,
    "original_position": 87,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "391b4d5e84db2811df4de371480729fd0e8c42b8",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I deliberately avoid removing `banlist.dat` automatically because that would prevent downgrading to an older version (and keeping the ban list).\r\n\r\nSomething like this may be a good idea:\r\n\r\n```diff\r\n--- i/src/addrdb.cpp\r\n+++ w/src/addrdb.cpp\r\n@@ -185,12 +185,18 @@ CBanDB::CBanDB(fs::path ban_list_path)\r\n }\r\n\r\n bool CBanDB::Write(const banmap_t& banSet)\r\n {\r\n     std::vector<std::string> errors;\r\n     if (util::WriteSettings(m_banlist_json, {{JSON_KEY, BanMapToJson(banSet)}}, errors)) {\r\n+        if (fs::exists(m_banlist_dat)) {\r\n+            LogPrintf(\"Successfully saved %s to disk. %s can be removed manually now if \"\r\n+                      \"downgrading to an older version is not planned.\\n\",\r\n+                      m_banlist_json.string(),\r\n+                      m_banlist_dat.string());\r\n+        }\r\n         return true;\r\n     }\r\n\r\n     for (const auto& err : errors) {\r\n         error(\"%s\", err);\r\n     }\r\n```\r\n\r\nbut it would be printed **every** time which would be annoying. There is some doc added to `doc/files.md` which should clarify things if the user wonders why there are two files. Maybe leave it as is?\r\n\r\nWe can add an automatic removal of `banlist.dat` one major version after this change is released.",
    "created_at": "2021-05-18T14:43:01Z",
    "updated_at": "2021-05-18T14:58:31Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r634452821",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634452821"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r634452821"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634452821/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 191,
    "original_line": 191,
    "side": "RIGHT",
    "in_reply_to_id": 632151649
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634455991",
    "pull_request_review_id": 662185086,
    "id": 634455991,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzNDQ1NTk5MQ==",
    "diff_hunk": "@@ -17,7 +17,8 @@\n \n // NOTE: When adjusting this, update rpcnet:setban's help (\"24h\")\n static constexpr unsigned int DEFAULT_MISBEHAVING_BANTIME = 60 * 60 * 24; // Default 24-hour ban\n-// How often to dump addresses to banlist.dat\n+\n+/// How often to dump banned addresses/subnets to disk.",
    "path": "src/banman.h",
    "position": 6,
    "original_position": 6,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "391b4d5e84db2811df4de371480729fd0e8c42b8",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The 3 slashes make it a [doxygen comment](https://www.doxygen.nl/manual/docblocks.html#specialblock) for inclusion in https://doxygen.bitcoincore.org/.\r\n\r\n",
    "created_at": "2021-05-18T14:46:28Z",
    "updated_at": "2021-05-18T14:46:28Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r634455991",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634455991"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r634455991"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634455991/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 21,
    "original_line": 21,
    "side": "RIGHT",
    "in_reply_to_id": 632169018
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634460741",
    "pull_request_review_id": 662191428,
    "id": 634460741,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzNDQ2MDc0MQ==",
    "diff_hunk": "@@ -34,8 +36,20 @@ FUZZ_TARGET_INIT(banman, initialize_banman)\n {\n     FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n     SetMockTime(ConsumeTime(fuzzed_data_provider));\n-    const fs::path banlist_file = GetDataDir() / \"fuzzed_banlist.dat\";\n-    fs::remove(banlist_file);\n+    fs::path banlist_file = GetDataDir() / \"fuzzed_banlist\";",
    "path": "src/test/fuzz/banman.cpp",
    "position": null,
    "original_position": 17,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "391b4d5e84db2811df4de371480729fd0e8c42b8",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I don't see how - we must first write the file or set `banlist_file` and only after that execute the actual test.",
    "created_at": "2021-05-18T14:51:26Z",
    "updated_at": "2021-05-18T14:51:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r634460741",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634460741"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r634460741"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634460741/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 39,
    "side": "RIGHT",
    "in_reply_to_id": 632279391
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634462854",
    "pull_request_review_id": 662194361,
    "id": 634462854,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzNDQ2Mjg1NA==",
    "diff_hunk": "@@ -62,15 +76,30 @@ class CAddrDB\n     static bool Read(CAddrMan& addr, CDataStream& ssPeers);\n };\n \n-/** Access to the banlist database (banlist.dat) */\n+/** Access to the banlist databases (banlist.json and banlist.dat) */\n class CBanDB\n {\n private:\n-    const fs::path m_ban_list_path;\n+    /**\n+     * JSON key under which the data is stored in the json database.\n+     */\n+    static constexpr const char* JSON_KEY = \"banned_nets\";\n+\n+    const fs::path m_banlist_dat;\n+    const fs::path m_banlist_json;\n public:\n     explicit CBanDB(fs::path ban_list_path);\n     bool Write(const banmap_t& banSet);\n-    bool Read(banmap_t& banSet);\n+\n+    /**\n+     * Read the banlist from disk.\n+     * @param[out] banSet The loaded list, set if `true` is returned, otherwise it is left\n+     * in an undefined state.\n+     * @param[out] dirty Indicates whether the loaded list needs flushing to disk, only set",
    "path": "src/addrdb.h",
    "position": null,
    "original_position": 61,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "391b4d5e84db2811df4de371480729fd0e8c42b8",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Right, reworded the comment.",
    "created_at": "2021-05-18T14:53:35Z",
    "updated_at": "2021-05-18T14:53:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r634462854",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634462854"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r634462854"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634462854/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 98,
    "side": "RIGHT",
    "in_reply_to_id": 632146518
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634463232",
    "pull_request_review_id": 662194891,
    "id": 634463232,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzNDQ2MzIzMg==",
    "diff_hunk": "@@ -11,13 +11,70 @@\n #include <cstdint>\n #include <hash.h>\n #include <logging/timer.h>\n+#include <netbase.h>\n #include <random.h>\n #include <streams.h>\n #include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/settings.h>\n #include <util/system.h>\n \n+CBanEntry::CBanEntry(const UniValue& json)\n+    : nVersion(json[\"version\"].get_int()), nCreateTime(json[\"ban_created\"].get_int64()),\n+      nBanUntil(json[\"banned_until\"].get_int64())\n+{\n+}\n+\n+UniValue CBanEntry::ToJson() const\n+{\n+    UniValue json(UniValue::VOBJ);\n+    json.pushKV(\"version\", nVersion);\n+    json.pushKV(\"ban_created\", nCreateTime);\n+    json.pushKV(\"banned_until\", nBanUntil);\n+    return json;\n+}\n+\n namespace {\n \n+/**\n+ * Convert a `banmap_t` object to a JSON array.\n+ * @param[in] bans Bans list to convert.\n+ * @return a JSON array, similar to the one returned by the `listbanned` RPC. Suitable for\n+ * passing to `BanMapFromJson()`.\n+ */\n+UniValue BanMapToJson(const banmap_t& bans)\n+{\n+    UniValue bans_json(UniValue::VARR);\n+    for (const auto& it : bans) {\n+        const auto& address = it.first;\n+        const auto& ban_entry = it.second;\n+        UniValue j = ban_entry.ToJson();\n+        j.pushKV(\"address\", address.ToString());",
    "path": "src/addrdb.cpp",
    "position": null,
    "original_position": 42,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "391b4d5e84db2811df4de371480729fd0e8c42b8",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes, good idea! Done.",
    "created_at": "2021-05-18T14:54:00Z",
    "updated_at": "2021-05-18T14:54:01Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r634463232",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634463232"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r634463232"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634463232/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 52,
    "side": "RIGHT",
    "in_reply_to_id": 631378639
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634466857",
    "pull_request_review_id": 662199887,
    "id": 634466857,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzNDQ2Njg1Nw==",
    "diff_hunk": "@@ -119,18 +176,54 @@ bool DeserializeFileDB(const fs::path& path, Data& data)\n }\n } // namespace\n \n-CBanDB::CBanDB(fs::path ban_list_path) : m_ban_list_path(std::move(ban_list_path))\n+CBanDB::CBanDB(fs::path ban_list_path)\n+    : m_banlist_dat(ban_list_path.string() + \".dat\"),\n+      m_banlist_json(ban_list_path.string() + \".json\")\n {\n }\n \n bool CBanDB::Write(const banmap_t& banSet)\n {\n-    return SerializeFileDB(\"banlist\", m_ban_list_path, banSet);\n+    std::vector<std::string> errors;\n+    if (util::WriteSettings(m_banlist_json, {{JSON_KEY, BanMapToJson(banSet)}}, errors)) {",
    "path": "src/addrdb.cpp",
    "position": 88,
    "original_position": 86,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "391b4d5e84db2811df4de371480729fd0e8c42b8",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think either one is fine. Renaming is out of the scope of this PR.",
    "created_at": "2021-05-18T14:57:50Z",
    "updated_at": "2021-05-18T14:57:50Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r634466857",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634466857"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r634466857"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634466857/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 190,
    "original_line": 190,
    "side": "RIGHT",
    "in_reply_to_id": 631375563
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634498403",
    "pull_request_review_id": 662242388,
    "id": 634498403,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzNDQ5ODQwMw==",
    "diff_hunk": "@@ -17,7 +17,8 @@\n \n // NOTE: When adjusting this, update rpcnet:setban's help (\"24h\")\n static constexpr unsigned int DEFAULT_MISBEHAVING_BANTIME = 60 * 60 * 24; // Default 24-hour ban\n-// How often to dump addresses to banlist.dat\n+\n+/// How often to dump banned addresses/subnets to disk.",
    "path": "src/banman.h",
    "position": 6,
    "original_position": 6,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "391b4d5e84db2811df4de371480729fd0e8c42b8",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes, and doc/developer-notes.md also provides an example with /// iirc.",
    "created_at": "2021-05-18T15:29:39Z",
    "updated_at": "2021-05-18T15:29:39Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r634498403",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634498403"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r634498403"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634498403/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 21,
    "original_line": 21,
    "side": "RIGHT",
    "in_reply_to_id": 632169018
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634514956",
    "pull_request_review_id": 662264959,
    "id": 634514956,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzNDUxNDk1Ng==",
    "diff_hunk": "@@ -17,7 +17,8 @@\n \n // NOTE: When adjusting this, update rpcnet:setban's help (\"24h\")\n static constexpr unsigned int DEFAULT_MISBEHAVING_BANTIME = 60 * 60 * 24; // Default 24-hour ban\n-// How often to dump addresses to banlist.dat\n+\n+/// How often to dump banned addresses/subnets to disk.",
    "path": "src/banman.h",
    "position": 6,
    "original_position": 6,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "391b4d5e84db2811df4de371480729fd0e8c42b8",
    "user": {
      "login": "dhruv",
      "id": 856960,
      "node_id": "MDQ6VXNlcjg1Njk2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dhruv",
      "html_url": "https://github.com/dhruv",
      "followers_url": "https://api.github.com/users/dhruv/followers",
      "following_url": "https://api.github.com/users/dhruv/following{/other_user}",
      "gists_url": "https://api.github.com/users/dhruv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
      "organizations_url": "https://api.github.com/users/dhruv/orgs",
      "repos_url": "https://api.github.com/users/dhruv/repos",
      "events_url": "https://api.github.com/users/dhruv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dhruv/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Oh. Thanks for teaching.",
    "created_at": "2021-05-18T15:48:44Z",
    "updated_at": "2021-05-18T15:48:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r634514956",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634514956"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r634514956"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634514956/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 21,
    "original_line": 21,
    "side": "RIGHT",
    "in_reply_to_id": 632169018
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634517262",
    "pull_request_review_id": 662268112,
    "id": 634517262,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzNDUxNzI2Mg==",
    "diff_hunk": "@@ -119,18 +176,54 @@ bool DeserializeFileDB(const fs::path& path, Data& data)\n }\n } // namespace\n \n-CBanDB::CBanDB(fs::path ban_list_path) : m_ban_list_path(std::move(ban_list_path))\n+CBanDB::CBanDB(fs::path ban_list_path)\n+    : m_banlist_dat(ban_list_path.string() + \".dat\"),\n+      m_banlist_json(ban_list_path.string() + \".json\")\n {\n }\n \n bool CBanDB::Write(const banmap_t& banSet)\n {\n-    return SerializeFileDB(\"banlist\", m_ban_list_path, banSet);\n+    std::vector<std::string> errors;\n+    if (util::WriteSettings(m_banlist_json, {{JSON_KEY, BanMapToJson(banSet)}}, errors)) {\n+        return true;",
    "path": "src/addrdb.cpp",
    "position": 89,
    "original_position": 87,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "391b4d5e84db2811df4de371480729fd0e8c42b8",
    "user": {
      "login": "dhruv",
      "id": 856960,
      "node_id": "MDQ6VXNlcjg1Njk2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dhruv",
      "html_url": "https://github.com/dhruv",
      "followers_url": "https://api.github.com/users/dhruv/followers",
      "following_url": "https://api.github.com/users/dhruv/following{/other_user}",
      "gists_url": "https://api.github.com/users/dhruv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
      "organizations_url": "https://api.github.com/users/dhruv/orgs",
      "repos_url": "https://api.github.com/users/dhruv/repos",
      "events_url": "https://api.github.com/users/dhruv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dhruv/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Removing `banlist.dat` one major version later seems like a fair choice!",
    "created_at": "2021-05-18T15:51:27Z",
    "updated_at": "2021-05-18T15:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r634517262",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634517262"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r634517262"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634517262/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 191,
    "original_line": 191,
    "side": "RIGHT",
    "in_reply_to_id": 632151649
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634518185",
    "pull_request_review_id": 662269355,
    "id": 634518185,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzNDUxODE4NQ==",
    "diff_hunk": "@@ -34,8 +36,20 @@ FUZZ_TARGET_INIT(banman, initialize_banman)\n {\n     FuzzedDataProvider fuzzed_data_provider{buffer.data(), buffer.size()};\n     SetMockTime(ConsumeTime(fuzzed_data_provider));\n-    const fs::path banlist_file = GetDataDir() / \"fuzzed_banlist.dat\";\n-    fs::remove(banlist_file);\n+    fs::path banlist_file = GetDataDir() / \"fuzzed_banlist\";",
    "path": "src/test/fuzz/banman.cpp",
    "position": null,
    "original_position": 17,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "391b4d5e84db2811df4de371480729fd0e8c42b8",
    "user": {
      "login": "dhruv",
      "id": 856960,
      "node_id": "MDQ6VXNlcjg1Njk2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dhruv",
      "html_url": "https://github.com/dhruv",
      "followers_url": "https://api.github.com/users/dhruv/followers",
      "following_url": "https://api.github.com/users/dhruv/following{/other_user}",
      "gists_url": "https://api.github.com/users/dhruv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
      "organizations_url": "https://api.github.com/users/dhruv/orgs",
      "repos_url": "https://api.github.com/users/dhruv/repos",
      "events_url": "https://api.github.com/users/dhruv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dhruv/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Perhaps with a separate fuzz test? I'm a fuzzing n00b though. We should ask @MarcoFalke and @practicalswift!",
    "created_at": "2021-05-18T15:52:34Z",
    "updated_at": "2021-05-18T15:52:34Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r634518185",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634518185"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r634518185"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/634518185/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 39,
    "side": "RIGHT",
    "in_reply_to_id": 632279391
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/635305449",
    "pull_request_review_id": 663293152,
    "id": 635305449,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzNTMwNTQ0OQ==",
    "diff_hunk": "@@ -11,13 +11,70 @@\n #include <cstdint>\n #include <hash.h>\n #include <logging/timer.h>\n+#include <netbase.h>\n #include <random.h>\n #include <streams.h>\n #include <tinyformat.h>\n+#include <univalue.h>\n+#include <util/settings.h>\n #include <util/system.h>\n \n+CBanEntry::CBanEntry(const UniValue& json)\n+    : nVersion(json[\"version\"].get_int()), nCreateTime(json[\"ban_created\"].get_int64()),\n+      nBanUntil(json[\"banned_until\"].get_int64())\n+{\n+}\n+\n+UniValue CBanEntry::ToJson() const\n+{\n+    UniValue json(UniValue::VOBJ);\n+    json.pushKV(\"version\", nVersion);\n+    json.pushKV(\"ban_created\", nCreateTime);\n+    json.pushKV(\"banned_until\", nBanUntil);\n+    return json;\n+}\n+\n namespace {\n \n+/**\n+ * Convert a `banmap_t` object to a JSON array.\n+ * @param[in] bans Bans list to convert.\n+ * @return a JSON array, similar to the one returned by the `listbanned` RPC. Suitable for\n+ * passing to `BanMapFromJson()`.\n+ */\n+UniValue BanMapToJson(const banmap_t& bans)\n+{\n+    UniValue bans_json(UniValue::VARR);\n+    for (const auto& it : bans) {\n+        const auto& address = it.first;\n+        const auto& ban_entry = it.second;\n+        UniValue j = ban_entry.ToJson();\n+        j.pushKV(\"address\", address.ToString());",
    "path": "src/addrdb.cpp",
    "position": null,
    "original_position": 42,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "391b4d5e84db2811df4de371480729fd0e8c42b8",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Not a fan of doing this for a short string like this that is used only twice, but it's not a blocker.",
    "created_at": "2021-05-19T14:36:48Z",
    "updated_at": "2021-05-19T14:36:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r635305449",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/635305449"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r635305449"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/635305449/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 52,
    "side": "RIGHT",
    "in_reply_to_id": 631378639
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/637932195",
    "pull_request_review_id": 666719128,
    "id": 637932195,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzNzkzMjE5NQ==",
    "diff_hunk": "@@ -36,27 +36,40 @@ def run_test(self):\n         self.restart_node(1, ['-whitelist=127.0.0.1'])\n         self.connect_nodes(0, 1)\n         peerinfo = self.nodes[1].getpeerinfo()[0]\n-        assert('noban' in peerinfo['permissions'])\n+        assert \"noban\" in peerinfo[\"permissions\"]\n \n         # If we remove the ban, Node 0 should be able to reconnect even without noban permission\n         self.nodes[1].setban(\"127.0.0.1\", \"remove\")\n         self.restart_node(1, [])\n         self.connect_nodes(0, 1)\n         peerinfo = self.nodes[1].getpeerinfo()[0]\n-        assert(not 'noban' in peerinfo['permissions'])\n+        assert not \"noban\" in peerinfo[\"permissions\"]\n \n         self.log.info(\"Test that a non-IP address can be banned/unbanned\")\n         node = self.nodes[1]\n         tor_addr = \"pg6mmjiyjmcrsslvykfwnntlaru7p5svn6y2ymmju6nubxndf4pscryd.onion\"\n         ip_addr = \"1.2.3.4\"\n-        assert(not self.is_banned(node, tor_addr))\n-        assert(not self.is_banned(node, ip_addr))\n+        assert not self.is_banned(node, tor_addr)\n+        assert not self.is_banned(node, ip_addr)\n+\n         node.setban(tor_addr, \"add\")\n-        assert(self.is_banned(node, tor_addr))\n-        assert(not self.is_banned(node, ip_addr))\n+        assert self.is_banned(node, tor_addr)\n+        assert not self.is_banned(node, ip_addr)\n+\n+        # Test that the ban list is preserved through restart.\n+\n+        self.restart_node(1)\n+        assert self.is_banned(node, tor_addr)\n+        assert not self.is_banned(node, ip_addr)\n+\n         node.setban(tor_addr, \"remove\")\n-        assert(not self.is_banned(self.nodes[1], tor_addr))\n-        assert(not self.is_banned(node, ip_addr))\n+        assert not self.is_banned(self.nodes[1], tor_addr)\n+        assert not self.is_banned(node, ip_addr)\n+\n+        self.restart_node(1)\n+        assert not self.is_banned(self.nodes[1], tor_addr)\n+        assert not self.is_banned(node, ip_addr)",
    "path": "test/functional/rpc_setban.py",
    "position": 53,
    "original_position": 53,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "88b843e49c84e331e40bfbe249269deaf2a6a2ac",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "f371273 could be done in a follow-up along with `not_in`, but if you retouch\r\n```diff\r\n--- a/test/functional/rpc_setban.py\r\n+++ b/test/functional/rpc_setban.py\r\n@@ -56,18 +56,17 @@ class SetBanTests(BitcoinTestFramework):\r\n         assert self.is_banned(node, tor_addr)\r\n         assert not self.is_banned(node, ip_addr)\r\n \r\n-        # Test that the ban list is preserved through restart.\r\n-\r\n+        self.log.info(\"Test the ban list is preserved through restart\")\r\n         self.restart_node(1)\r\n         assert self.is_banned(node, tor_addr)\r\n         assert not self.is_banned(node, ip_addr)\r\n \r\n         node.setban(tor_addr, \"remove\")\r\n-        assert not self.is_banned(self.nodes[1], tor_addr)\r\n+        assert not self.is_banned(node, tor_addr)\r\n         assert not self.is_banned(node, ip_addr)\r\n \r\n         self.restart_node(1)\r\n-        assert not self.is_banned(self.nodes[1], tor_addr)\r\n+        assert not self.is_banned(node, tor_addr)\r\n         assert not self.is_banned(node, ip_addr)\r\n```\r\n",
    "created_at": "2021-05-24T13:09:04Z",
    "updated_at": "2021-05-24T13:13:00Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r637932195",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/637932195"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r637932195"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/637932195/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 71,
    "original_line": 71,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/637940462",
    "pull_request_review_id": 666730325,
    "id": 637940462,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzNzk0MDQ2Mg==",
    "diff_hunk": "@@ -56,7 +56,8 @@ Subdirectory       | File(s)               | Description\n `indexes/coinstats/db/` | LevelDB database | Coinstats index; *optional*, used if `-coinstatsindex=1`\n `wallets/`         |                       | [Contains wallets](#multi-wallet-environment); can be specified by `-walletdir` option; if `wallets/` subdirectory does not exist, wallets reside in the [data directory](#data-directory-location)\n `./`               | `anchors.dat`         | Anchor IP address database, created on shutdown and deleted at startup. Anchors are last known outgoing block-relay-only peers that are tried to re-connect to on startup\n-`./`               | `banlist.dat`         | Stores the IPs/subnets of banned nodes\n+`./`               | `banlist.dat`         | Stores the addresses/subnets of banned nodes (deprecated). `bitcoind` or `bitcoin-qt` no longer save the banlist to this file, but read it on startup if `banlist.json` is not present.\n+`./`               | `banlist.json`        | Stores the addresses/subnets of banned nodes.",
    "path": "doc/files.md",
    "position": 6,
    "original_position": 6,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "88b843e49c84e331e40bfbe249269deaf2a6a2ac",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@vasild \r\nIn your opinion, when will be an appropriate moment to move the `banlist.dat` description into the \"Legacy subdirectories and files\" subsection?",
    "created_at": "2021-05-24T13:22:22Z",
    "updated_at": "2021-05-24T13:22:22Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r637940462",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/637940462"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r637940462"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/637940462/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 59,
    "original_start_line": 59,
    "start_side": "LEFT",
    "line": 60,
    "original_line": 60,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/637941953",
    "pull_request_review_id": 666732386,
    "id": 637941953,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzNzk0MTk1Mw==",
    "diff_hunk": "@@ -56,7 +56,8 @@ Subdirectory       | File(s)               | Description\n `indexes/coinstats/db/` | LevelDB database | Coinstats index; *optional*, used if `-coinstatsindex=1`\n `wallets/`         |                       | [Contains wallets](#multi-wallet-environment); can be specified by `-walletdir` option; if `wallets/` subdirectory does not exist, wallets reside in the [data directory](#data-directory-location)\n `./`               | `anchors.dat`         | Anchor IP address database, created on shutdown and deleted at startup. Anchors are last known outgoing block-relay-only peers that are tried to re-connect to on startup\n-`./`               | `banlist.dat`         | Stores the IPs/subnets of banned nodes\n+`./`               | `banlist.dat`         | Stores the addresses/subnets of banned nodes (deprecated). `bitcoind` or `bitcoin-qt` no longer save the banlist to this file, but read it on startup if `banlist.json` is not present.\n+`./`               | `banlist.json`        | Stores the addresses/subnets of banned nodes.",
    "path": "doc/files.md",
    "position": 6,
    "original_position": 6,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "88b843e49c84e331e40bfbe249269deaf2a6a2ac",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "See https://github.com/bitcoin/bitcoin/pull/20966#discussion_r634452821.",
    "created_at": "2021-05-24T13:24:41Z",
    "updated_at": "2021-05-24T13:25:55Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r637941953",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/637941953"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r637941953"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/637941953/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 59,
    "original_start_line": 59,
    "start_side": "LEFT",
    "line": 60,
    "original_line": 60,
    "side": "RIGHT",
    "in_reply_to_id": 637940462
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/637943278",
    "pull_request_review_id": 666734300,
    "id": 637943278,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzNzk0MzI3OA==",
    "diff_hunk": "@@ -56,7 +56,8 @@ Subdirectory       | File(s)               | Description\n `indexes/coinstats/db/` | LevelDB database | Coinstats index; *optional*, used if `-coinstatsindex=1`\n `wallets/`         |                       | [Contains wallets](#multi-wallet-environment); can be specified by `-walletdir` option; if `wallets/` subdirectory does not exist, wallets reside in the [data directory](#data-directory-location)\n `./`               | `anchors.dat`         | Anchor IP address database, created on shutdown and deleted at startup. Anchors are last known outgoing block-relay-only peers that are tried to re-connect to on startup\n-`./`               | `banlist.dat`         | Stores the IPs/subnets of banned nodes\n+`./`               | `banlist.dat`         | Stores the addresses/subnets of banned nodes (deprecated). `bitcoind` or `bitcoin-qt` no longer save the banlist to this file, but read it on startup if `banlist.json` is not present.\n+`./`               | `banlist.json`        | Stores the addresses/subnets of banned nodes.",
    "path": "doc/files.md",
    "position": 6,
    "original_position": 6,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "88b843e49c84e331e40bfbe249269deaf2a6a2ac",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Good question! I am not sure. Either now or in a next release where we completely ignore `banlist.dat`?",
    "created_at": "2021-05-24T13:26:48Z",
    "updated_at": "2021-05-24T13:26:49Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r637943278",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/637943278"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r637943278"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/637943278/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 59,
    "original_start_line": 59,
    "start_side": "LEFT",
    "line": 60,
    "original_line": 60,
    "side": "RIGHT",
    "in_reply_to_id": 637940462
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/637953866",
    "pull_request_review_id": 666748246,
    "id": 637953866,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzNzk1Mzg2Ng==",
    "diff_hunk": "@@ -36,27 +36,40 @@ def run_test(self):\n         self.restart_node(1, ['-whitelist=127.0.0.1'])\n         self.connect_nodes(0, 1)\n         peerinfo = self.nodes[1].getpeerinfo()[0]\n-        assert('noban' in peerinfo['permissions'])\n+        assert \"noban\" in peerinfo[\"permissions\"]\n \n         # If we remove the ban, Node 0 should be able to reconnect even without noban permission\n         self.nodes[1].setban(\"127.0.0.1\", \"remove\")\n         self.restart_node(1, [])\n         self.connect_nodes(0, 1)\n         peerinfo = self.nodes[1].getpeerinfo()[0]\n-        assert(not 'noban' in peerinfo['permissions'])\n+        assert not \"noban\" in peerinfo[\"permissions\"]\n \n         self.log.info(\"Test that a non-IP address can be banned/unbanned\")\n         node = self.nodes[1]\n         tor_addr = \"pg6mmjiyjmcrsslvykfwnntlaru7p5svn6y2ymmju6nubxndf4pscryd.onion\"\n         ip_addr = \"1.2.3.4\"\n-        assert(not self.is_banned(node, tor_addr))\n-        assert(not self.is_banned(node, ip_addr))\n+        assert not self.is_banned(node, tor_addr)\n+        assert not self.is_banned(node, ip_addr)\n+\n         node.setban(tor_addr, \"add\")\n-        assert(self.is_banned(node, tor_addr))\n-        assert(not self.is_banned(node, ip_addr))\n+        assert self.is_banned(node, tor_addr)\n+        assert not self.is_banned(node, ip_addr)\n+\n+        # Test that the ban list is preserved through restart.\n+\n+        self.restart_node(1)\n+        assert self.is_banned(node, tor_addr)\n+        assert not self.is_banned(node, ip_addr)\n+\n         node.setban(tor_addr, \"remove\")\n-        assert(not self.is_banned(self.nodes[1], tor_addr))\n-        assert(not self.is_banned(node, ip_addr))\n+        assert not self.is_banned(self.nodes[1], tor_addr)\n+        assert not self.is_banned(node, ip_addr)\n+\n+        self.restart_node(1)\n+        assert not self.is_banned(self.nodes[1], tor_addr)",
    "path": "test/functional/rpc_setban.py",
    "position": null,
    "original_position": 52,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "88b843e49c84e331e40bfbe249269deaf2a6a2ac",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "As we have https://github.com/bitcoin/bitcoin/blob/88b843e49c84e331e40bfbe249269deaf2a6a2ac/test/functional/rpc_setban.py#L49\r\n\r\nwhat are reasons to use `self.nodes[1]`? Did I miss something?",
    "created_at": "2021-05-24T13:41:58Z",
    "updated_at": "2021-05-24T13:41:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r637953866",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/637953866"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r637953866"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/637953866/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 66,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 70,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/637954472",
    "pull_request_review_id": 666749019,
    "id": 637954472,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDYzNzk1NDQ3Mg==",
    "diff_hunk": "@@ -36,27 +36,40 @@ def run_test(self):\n         self.restart_node(1, ['-whitelist=127.0.0.1'])\n         self.connect_nodes(0, 1)\n         peerinfo = self.nodes[1].getpeerinfo()[0]\n-        assert('noban' in peerinfo['permissions'])\n+        assert \"noban\" in peerinfo[\"permissions\"]\n \n         # If we remove the ban, Node 0 should be able to reconnect even without noban permission\n         self.nodes[1].setban(\"127.0.0.1\", \"remove\")\n         self.restart_node(1, [])\n         self.connect_nodes(0, 1)\n         peerinfo = self.nodes[1].getpeerinfo()[0]\n-        assert(not 'noban' in peerinfo['permissions'])\n+        assert not \"noban\" in peerinfo[\"permissions\"]\n \n         self.log.info(\"Test that a non-IP address can be banned/unbanned\")\n         node = self.nodes[1]\n         tor_addr = \"pg6mmjiyjmcrsslvykfwnntlaru7p5svn6y2ymmju6nubxndf4pscryd.onion\"\n         ip_addr = \"1.2.3.4\"\n-        assert(not self.is_banned(node, tor_addr))\n-        assert(not self.is_banned(node, ip_addr))\n+        assert not self.is_banned(node, tor_addr)\n+        assert not self.is_banned(node, ip_addr)\n+\n         node.setban(tor_addr, \"add\")\n-        assert(self.is_banned(node, tor_addr))\n-        assert(not self.is_banned(node, ip_addr))\n+        assert self.is_banned(node, tor_addr)\n+        assert not self.is_banned(node, ip_addr)\n+\n+        # Test that the ban list is preserved through restart.\n+\n+        self.restart_node(1)\n+        assert self.is_banned(node, tor_addr)\n+        assert not self.is_banned(node, ip_addr)\n+\n         node.setban(tor_addr, \"remove\")\n-        assert(not self.is_banned(self.nodes[1], tor_addr))\n-        assert(not self.is_banned(node, ip_addr))\n+        assert not self.is_banned(self.nodes[1], tor_addr)\n+        assert not self.is_banned(node, ip_addr)\n+\n+        self.restart_node(1)\n+        assert not self.is_banned(self.nodes[1], tor_addr)",
    "path": "test/functional/rpc_setban.py",
    "position": null,
    "original_position": 52,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "88b843e49c84e331e40bfbe249269deaf2a6a2ac",
    "user": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Oh, I see https://github.com/bitcoin/bitcoin/pull/20966/files#r637932195",
    "created_at": "2021-05-24T13:42:49Z",
    "updated_at": "2021-05-24T13:50:13Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r637954472",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/637954472"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r637954472"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/637954472/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 66,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 70,
    "side": "RIGHT",
    "in_reply_to_id": 637953866
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655381856",
    "pull_request_review_id": 688430476,
    "id": 655381856,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NTM4MTg1Ng==",
    "diff_hunk": "@@ -36,27 +36,40 @@ def run_test(self):\n         self.restart_node(1, ['-whitelist=127.0.0.1'])\n         self.connect_nodes(0, 1)\n         peerinfo = self.nodes[1].getpeerinfo()[0]\n-        assert('noban' in peerinfo['permissions'])\n+        assert \"noban\" in peerinfo[\"permissions\"]\n \n         # If we remove the ban, Node 0 should be able to reconnect even without noban permission\n         self.nodes[1].setban(\"127.0.0.1\", \"remove\")\n         self.restart_node(1, [])\n         self.connect_nodes(0, 1)\n         peerinfo = self.nodes[1].getpeerinfo()[0]\n-        assert(not 'noban' in peerinfo['permissions'])\n+        assert not \"noban\" in peerinfo[\"permissions\"]\n \n         self.log.info(\"Test that a non-IP address can be banned/unbanned\")\n         node = self.nodes[1]\n         tor_addr = \"pg6mmjiyjmcrsslvykfwnntlaru7p5svn6y2ymmju6nubxndf4pscryd.onion\"\n         ip_addr = \"1.2.3.4\"\n-        assert(not self.is_banned(node, tor_addr))\n-        assert(not self.is_banned(node, ip_addr))\n+        assert not self.is_banned(node, tor_addr)\n+        assert not self.is_banned(node, ip_addr)\n+\n         node.setban(tor_addr, \"add\")\n-        assert(self.is_banned(node, tor_addr))\n-        assert(not self.is_banned(node, ip_addr))\n+        assert self.is_banned(node, tor_addr)\n+        assert not self.is_banned(node, ip_addr)\n+\n+        # Test that the ban list is preserved through restart.\n+\n+        self.restart_node(1)\n+        assert self.is_banned(node, tor_addr)\n+        assert not self.is_banned(node, ip_addr)\n+\n         node.setban(tor_addr, \"remove\")\n-        assert(not self.is_banned(self.nodes[1], tor_addr))\n-        assert(not self.is_banned(node, ip_addr))\n+        assert not self.is_banned(self.nodes[1], tor_addr)\n+        assert not self.is_banned(node, ip_addr)\n+\n+        self.restart_node(1)\n+        assert not self.is_banned(self.nodes[1], tor_addr)\n+        assert not self.is_banned(node, ip_addr)",
    "path": "test/functional/rpc_setban.py",
    "position": 53,
    "original_position": 53,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "88b843e49c84e331e40bfbe249269deaf2a6a2ac",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Added the log message and changed to `node` in the second one, but left the first one as that line is not modified by this PR.",
    "created_at": "2021-06-21T13:35:41Z",
    "updated_at": "2021-06-21T13:35:41Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r655381856",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655381856"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r655381856"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655381856/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 71,
    "original_line": 71,
    "side": "RIGHT",
    "in_reply_to_id": 637932195
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655410027",
    "pull_request_review_id": 688468848,
    "id": 655410027,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY1NTQxMDAyNw==",
    "diff_hunk": "@@ -36,27 +36,40 @@ def run_test(self):\n         self.restart_node(1, ['-whitelist=127.0.0.1'])\n         self.connect_nodes(0, 1)\n         peerinfo = self.nodes[1].getpeerinfo()[0]\n-        assert('noban' in peerinfo['permissions'])\n+        assert \"noban\" in peerinfo[\"permissions\"]\n \n         # If we remove the ban, Node 0 should be able to reconnect even without noban permission\n         self.nodes[1].setban(\"127.0.0.1\", \"remove\")\n         self.restart_node(1, [])\n         self.connect_nodes(0, 1)\n         peerinfo = self.nodes[1].getpeerinfo()[0]\n-        assert(not 'noban' in peerinfo['permissions'])\n+        assert not \"noban\" in peerinfo[\"permissions\"]\n \n         self.log.info(\"Test that a non-IP address can be banned/unbanned\")\n         node = self.nodes[1]\n         tor_addr = \"pg6mmjiyjmcrsslvykfwnntlaru7p5svn6y2ymmju6nubxndf4pscryd.onion\"\n         ip_addr = \"1.2.3.4\"\n-        assert(not self.is_banned(node, tor_addr))\n-        assert(not self.is_banned(node, ip_addr))\n+        assert not self.is_banned(node, tor_addr)\n+        assert not self.is_banned(node, ip_addr)\n+\n         node.setban(tor_addr, \"add\")\n-        assert(self.is_banned(node, tor_addr))\n-        assert(not self.is_banned(node, ip_addr))\n+        assert self.is_banned(node, tor_addr)\n+        assert not self.is_banned(node, ip_addr)\n+\n+        # Test that the ban list is preserved through restart.\n+\n+        self.restart_node(1)\n+        assert self.is_banned(node, tor_addr)\n+        assert not self.is_banned(node, ip_addr)\n+\n         node.setban(tor_addr, \"remove\")\n-        assert(not self.is_banned(self.nodes[1], tor_addr))\n-        assert(not self.is_banned(node, ip_addr))\n+        assert not self.is_banned(self.nodes[1], tor_addr)\n+        assert not self.is_banned(node, ip_addr)\n+\n+        self.restart_node(1)\n+        assert not self.is_banned(self.nodes[1], tor_addr)\n+        assert not self.is_banned(node, ip_addr)",
    "path": "test/functional/rpc_setban.py",
    "position": 53,
    "original_position": 53,
    "commit_id": "bb719a08db173a753984a04534de6f148b87b17a",
    "original_commit_id": "88b843e49c84e331e40bfbe249269deaf2a6a2ac",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Seems that line was added by me (hides) in 39b43298d9c, so I don't mind if you change it :D",
    "created_at": "2021-06-21T14:08:40Z",
    "updated_at": "2021-06-21T14:08:40Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r655410027",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655410027"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20966#discussion_r655410027"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20966"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/655410027/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 71,
    "original_line": 71,
    "side": "RIGHT",
    "in_reply_to_id": 637932195
  }
]