[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/525947108",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#issuecomment-525947108",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16748",
    "id": 525947108,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNTk0NzEwOA==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-08-28T22:30:28Z",
    "updated_at": "2020-01-18T11:26:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#17812](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/17812.html) (config, test: asmap functional tests and feature refinements by jonatack)\n* [#16702](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16702.html) (p2p: supplying and using asmap to improve IP bucketing in addrman by naumenkogs)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/525947108/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/526106195",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#issuecomment-526106195",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16748",
    "id": 526106195,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNjEwNjE5NQ==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-08-29T09:31:59Z",
    "updated_at": "2019-08-29T09:31:59Z",
    "author_association": "MEMBER",
    "body": "Concept ACK, thanks for working on this",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/526106195/reactions",
      "total_count": 3,
      "+1": 0,
      "-1": 0,
      "laugh": 3,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/527539510",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#issuecomment-527539510",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16748",
    "id": 527539510,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNzUzOTUxMA==",
    "user": {
      "login": "naumenkogs",
      "id": 7975071,
      "node_id": "MDQ6VXNlcjc5NzUwNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7975071?u=06eb9ae4f9b3f954056098860decccbf1340e40f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naumenkogs",
      "html_url": "https://github.com/naumenkogs",
      "followers_url": "https://api.github.com/users/naumenkogs/followers",
      "following_url": "https://api.github.com/users/naumenkogs/following{/other_user}",
      "gists_url": "https://api.github.com/users/naumenkogs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
      "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
      "repos_url": "https://api.github.com/users/naumenkogs/repos",
      "events_url": "https://api.github.com/users/naumenkogs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-03T16:39:17Z",
    "updated_at": "2019-09-03T16:39:27Z",
    "author_association": "MEMBER",
    "body": "Concept ACK\r\n\r\nI reviewed ```std::vector<unsigned char> CNetAddr::GetGroup() const``` part and it seems correct to me, although not sure mixing GetByte() and direct reading from the ip array is a good idea.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/527539510/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/536311628",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#issuecomment-536311628",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16748",
    "id": 536311628,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUzNjMxMTYyOA==",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?u=5ff13e375b40ea55ecd3c108337dd6a23f68eddf&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-09-29T15:13:39Z",
    "updated_at": "2019-09-29T15:13:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "Concept ACK\r\n\r\nRegarding the tests: could add a test for `IsStandardV2Deserialization` which seems both unused and untested currently? :)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/536311628/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/617631642",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#issuecomment-617631642",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16748",
    "id": 617631642,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNzYzMTY0Mg==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-22T08:27:25Z",
    "updated_at": "2020-04-22T08:27:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "> What would be the best way to split up [e600992](https://github.com/bitcoin/bitcoin/commit/e6009922077ce330bc76b82b9c3aa1e813e40356)? I've tried to split it up in multiple ways but every time I attempt to do it, it just increases the total diff.\r\n\r\nIt looks ok to me, no screaming need to split it.\r\n\r\n> In [e10f8bf](https://github.com/bitcoin/bitcoin/commit/e10f8bfcaec44cf1e7b73c390225b80644e8367f), I'm wondering if there are better ways of structuring the code for ignoring single `addr` entries, and the entire message.\r\n\r\nYou mean that `CNetAddr::Unserialize()` was changed to [throw an exception](https://github.com/bitcoin/bitcoin/pull/16748/files#diff-76d15e11a95be7a4aee1eb89de6098caR163) and the [parsing code is now in try/catch](https://github.com/bitcoin/bitcoin/pull/16748/files#diff-eff7adeaec73a769788bb78858815c91R2140)? I think the current approach is sound, given that 1) some addresses might already have been deserialized into the vector before we stumble on a problematic one, 2) the `Unserialize()` returns `void` and 3) we should stop parsing and reject the entire message, not just a particular address from it.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/617631642/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622310812",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#issuecomment-622310812",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16748",
    "id": 622310812,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMjMxMDgxMg==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-01T09:05:27Z",
    "updated_at": "2020-05-01T09:05:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "I rebased this and fixed some unit tests and a compilation warning at:\r\nhttps://github.com/vasild/bitcoin/tree/2019-07-addrv2v4\r\nNext I will address the above suggestions.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622310812/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622455096",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#issuecomment-622455096",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16748",
    "id": 622455096,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMjQ1NTA5Ng==",
    "user": {
      "login": "dongcarl",
      "id": 3445290,
      "node_id": "MDQ6VXNlcjM0NDUyOTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3445290?u=62e3204f6586795420395a7059ec7dc7c4a40c7d&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dongcarl",
      "html_url": "https://github.com/dongcarl",
      "followers_url": "https://api.github.com/users/dongcarl/followers",
      "following_url": "https://api.github.com/users/dongcarl/following{/other_user}",
      "gists_url": "https://api.github.com/users/dongcarl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
      "organizations_url": "https://api.github.com/users/dongcarl/orgs",
      "repos_url": "https://api.github.com/users/dongcarl/repos",
      "events_url": "https://api.github.com/users/dongcarl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dongcarl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-01T16:19:50Z",
    "updated_at": "2020-05-01T16:19:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "@vasild Great! I'll close this one as soon as you open your PR :-)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/622455096/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/624847869",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#issuecomment-624847869",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16748",
    "id": 624847869,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyNDg0Nzg2OQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-06T19:36:30Z",
    "updated_at": "2020-05-06T19:36:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "Just to note - I am addressing the above suggestions and will then open a PR, which I deem would be ready for wider review.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/624847869/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631581865",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#issuecomment-631581865",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16748",
    "id": 631581865,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMTU4MTg2NQ==",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?u=d06d2903ce6ad8b9d0c66ef9225fa21adfe22c7f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-20T16:24:33Z",
    "updated_at": "2020-05-20T16:24:33Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Just to note - I am addressing the above suggestions and will then open a PR, which I deem would be ready for wider review.\r\n\r\nDone: https://github.com/bitcoin/bitcoin/pull/19031",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631581865/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631596050",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#issuecomment-631596050",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16748",
    "id": 631596050,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMTU5NjA1MA==",
    "user": {
      "login": "dongcarl",
      "id": 3445290,
      "node_id": "MDQ6VXNlcjM0NDUyOTA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3445290?u=62e3204f6586795420395a7059ec7dc7c4a40c7d&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dongcarl",
      "html_url": "https://github.com/dongcarl",
      "followers_url": "https://api.github.com/users/dongcarl/followers",
      "following_url": "https://api.github.com/users/dongcarl/following{/other_user}",
      "gists_url": "https://api.github.com/users/dongcarl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dongcarl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dongcarl/subscriptions",
      "organizations_url": "https://api.github.com/users/dongcarl/orgs",
      "repos_url": "https://api.github.com/users/dongcarl/repos",
      "events_url": "https://api.github.com/users/dongcarl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dongcarl/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-20T16:49:54Z",
    "updated_at": "2020-05-20T16:49:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "Closing in favor of #19031, will review there.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/631596050/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/692244028",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#issuecomment-692244028",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16748",
    "id": 692244028,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY5MjI0NDAyOA==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-09-14T18:49:19Z",
    "updated_at": "2020-09-14T18:49:19Z",
    "author_association": "MEMBER",
    "body": "Big, big, big kudos for your work on this @dongcarl.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/692244028/reactions",
      "total_count": 2,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 2,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410364056",
    "pull_request_review_id": 395637985,
    "id": 410364056,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDM2NDA1Ng==",
    "diff_hunk": "@@ -692,51 +745,57 @@ CSubNet::CSubNet():\n \n CSubNet::CSubNet(const CNetAddr &addr, int32_t mask)\n {\n-    valid = true;\n+    valid = (addr.m_network_id == NetworkID::IPV4 || addr.m_network_id == NetworkID::IPV6);\n     network = addr;\n     // Default to /32 (IPv4) or /128 (IPv6), i.e. match single address\n     memset(netmask, 255, sizeof(netmask));\n \n     // IPv4 addresses start at offset 12, and first 12 bytes must match, so just offset n",
    "path": "src/netaddress.cpp",
    "position": 436,
    "original_position": 382,
    "commit_id": "e54fb70b3dfeed37b0955c5814507f7c59c615d2",
    "original_commit_id": "e6009922077ce330bc76b82b9c3aa1e813e40356",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: this comment is outdated now, needs to be adjusted (or deleted).",
    "created_at": "2020-04-17T17:23:02Z",
    "updated_at": "2020-04-21T19:12:29Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r410364056",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410364056"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r410364056"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410364056/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 785,
    "original_line": 753,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410365541",
    "pull_request_review_id": 395637985,
    "id": 410365541,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDM2NTU0MQ==",
    "diff_hunk": "@@ -692,51 +745,57 @@ CSubNet::CSubNet():\n \n CSubNet::CSubNet(const CNetAddr &addr, int32_t mask)\n {\n-    valid = true;\n+    valid = (addr.m_network_id == NetworkID::IPV4 || addr.m_network_id == NetworkID::IPV6);\n     network = addr;\n     // Default to /32 (IPv4) or /128 (IPv6), i.e. match single address\n     memset(netmask, 255, sizeof(netmask));\n \n     // IPv4 addresses start at offset 12, and first 12 bytes must match, so just offset n\n-    const int astartofs = network.IsIPv4() ? 12 : 0;\n+    const int alens = network.ip.size();\n \n     int32_t n = mask;\n-    if(n >= 0 && n <= (128 - astartofs*8)) // Only valid if in range of bits of address\n+    if(n >= 0 && n <= (alens*8)) // Only valid if in range of bits of address\n     {\n-        n += astartofs*8;\n         // Clear bits [n..127]\n         for (; n < 128; ++n)\n             netmask[n>>3] &= ~(1<<(7-(n&7)));\n-    } else\n+    } else {\n         valid = false;\n+    }\n \n     // Normalize network according to netmask\n-    for(int x=0; x<16; ++x)\n-        network.ip[x] &= netmask[x];\n+    for(size_t x=0; x<alens; ++x)\n+        network.ip.at(x) &= netmask[x];\n }\n \n CSubNet::CSubNet(const CNetAddr &addr, const CNetAddr &mask)\n {\n-    valid = true;\n+    valid = (addr.m_network_id == NetworkID::IPV4 || addr.m_network_id == NetworkID::IPV6);\n     network = addr;\n     // Default to /32 (IPv4) or /128 (IPv6), i.e. match single address\n     memset(netmask, 255, sizeof(netmask));\n \n     // IPv4 addresses start at offset 12, and first 12 bytes must match, so just offset n",
    "path": "src/netaddress.cpp",
    "position": 468,
    "original_position": 414,
    "commit_id": "e54fb70b3dfeed37b0955c5814507f7c59c615d2",
    "original_commit_id": "e6009922077ce330bc76b82b9c3aa1e813e40356",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: this comment is outdated now, needs to be adjusted (or deleted).",
    "created_at": "2020-04-17T17:25:45Z",
    "updated_at": "2020-04-21T19:12:29Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r410365541",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410365541"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r410365541"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410365541/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 810,
    "original_line": 778,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410423357",
    "pull_request_review_id": 395637985,
    "id": 410423357,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQyMzM1Nw==",
    "diff_hunk": "@@ -81,6 +81,17 @@ bool CNetAddr::SetSpecial(const std::string &strName)\n             m_network_id = NetworkID::TORV2;\n             ip.assign(vchAddr.begin(), vchAddr.end());\n             return true;\n+        } else if (vchAddr.size() == 35) {",
    "path": "src/netaddress.cpp",
    "position": 63,
    "original_position": 4,
    "commit_id": "e54fb70b3dfeed37b0955c5814507f7c59c615d2",
    "original_commit_id": "fb78590939ff2d8c008cfd68f2f7df816389ac01",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: this function's comment is now outdated",
    "created_at": "2020-04-17T19:20:33Z",
    "updated_at": "2020-04-21T19:12:29Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r410423357",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410423357"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r410423357"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410423357/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 84,
    "original_line": 84,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410440592",
    "pull_request_review_id": 395637985,
    "id": 410440592,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQ0MDU5Mg==",
    "diff_hunk": "@@ -477,7 +486,8 @@ class CAddrMan\n         mapAddr.clear();\n     }\n \n-    CAddrMan()\n+    CAddrMan(unsigned char serialization_version = ADDRMAN_HIGHEST_KNOWN_SERIALIZATION_VERSION)",
    "path": "src/addrman.h",
    "position": 62,
    "original_position": 62,
    "commit_id": "e54fb70b3dfeed37b0955c5814507f7c59c615d2",
    "original_commit_id": "02dfac7799dc3a1febfe6d009debf28d59c64465",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: deserves `explicit`",
    "created_at": "2020-04-17T19:58:16Z",
    "updated_at": "2020-04-21T19:12:29Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r410440592",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410440592"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r410440592"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410440592/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 489,
    "original_line": 489,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410445532",
    "pull_request_review_id": 395637985,
    "id": 410445532,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMDQ0NTUzMg==",
    "diff_hunk": "@@ -134,6 +136,42 @@ BOOST_AUTO_TEST_CASE(caddrdb_read)\n     BOOST_CHECK(addrman2.size() == 3);\n }\n \n+BOOST_AUTO_TEST_CASE(caddrdb_read_v1_ser)\n+{\n+    // Construct an AddrMan that serializes in v1 format\n+    CAddrManUncorrupted addrmanUncorrupted(1);\n+    addrmanUncorrupted.MakeDeterministic();\n+\n+    CService addr1, addr2, addr3;\n+    BOOST_CHECK(Lookup(\"250.7.1.1\", addr1, 8333, false));\n+    BOOST_CHECK(Lookup(\"250.7.2.2\", addr2, 9999, false));\n+    BOOST_CHECK(Lookup(\"250.7.3.3\", addr3, 9999, false));\n+\n+    // Add three addresses to new table.\n+    CService source;\n+    BOOST_CHECK(Lookup(\"252.5.1.1\", source, 8333, false));\n+    BOOST_CHECK(addrmanUncorrupted.Add(CAddress(addr1, NODE_NONE), source));\n+    BOOST_CHECK(addrmanUncorrupted.Add(CAddress(addr2, NODE_NONE), source));\n+    BOOST_CHECK(addrmanUncorrupted.Add(CAddress(addr3, NODE_NONE), source));\n+\n+    // Test that the de-serialization does not throw an exception.\n+    CDataStream ssPeers1 = AddrmanToStream(addrmanUncorrupted);\n+    bool exceptionThrown = false;\n+    CAddrMan addrman1;\n+\n+    BOOST_CHECK(addrman1.size() == 0);\n+    try {\n+        unsigned char pchMsgTmp[4];\n+        ssPeers1 >> pchMsgTmp;\n+        ssPeers1 >> addrman1;\n+    } catch (const std::exception&) {\n+        exceptionThrown = true;\n+    }",
    "path": "src/test/net_tests.cpp",
    "position": 59,
    "original_position": 59,
    "commit_id": "e54fb70b3dfeed37b0955c5814507f7c59c615d2",
    "original_commit_id": "02dfac7799dc3a1febfe6d009debf28d59c64465",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: if we just let the exception uncaught, this will suffice to fail the test?",
    "created_at": "2020-04-17T20:09:33Z",
    "updated_at": "2020-04-21T19:12:29Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r410445532",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410445532"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r410445532"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/410445532/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 163,
    "original_start_line": 163,
    "start_side": "RIGHT",
    "line": 169,
    "original_line": 169,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/412236060",
    "pull_request_review_id": 395637985,
    "id": 412236060,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjIzNjA2MA==",
    "diff_hunk": "@@ -2124,9 +2131,18 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n         return false;\n     }\n \n-    if (strCommand == NetMsgType::ADDR) {\n+    if (strCommand == NetMsgType::ADDR || strCommand == NetMsgType::ADDRv2) {\n+        if (strCommand == NetMsgType::ADDRv2) {\n+            vRecv.SetVersion(vRecv.GetVersion() | SERIALIZE_ADDR_AS_V2);\n+        }\n         std::vector<CAddress> vAddr;\n-        vRecv >> vAddr;\n+        try {\n+            vRecv >> vAddr;\n+        } catch (...) {\n+            LOCK(cs_main);\n+            Misbehaving(pfrom->GetId(), 20, \"absurdly large addrv2 entry\");",
    "path": "src/net_processing.cpp",
    "position": 36,
    "original_position": 36,
    "commit_id": "e54fb70b3dfeed37b0955c5814507f7c59c615d2",
    "original_commit_id": "c0414a6a17ea2cf5812b45dbddf318059cde0b7e",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This message implies that the only reason `vRecv >> vAddr` could throw is a too large addrv2 entry. While this is the case with the current code, it is better to avoid such an assumption to make it less fragile wrt future changes (where we start throwing for more reasons).\r\n\r\nWould it be possible to catch the exception object and print something like `\"can't parse address message: %s\", e.what()`?",
    "created_at": "2020-04-21T14:30:01Z",
    "updated_at": "2020-04-21T19:12:29Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r412236060",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/412236060"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r412236060"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/412236060/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2143,
    "original_line": 2143,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/412257785",
    "pull_request_review_id": 395637985,
    "id": 412257785,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjI1Nzc4NQ==",
    "diff_hunk": "@@ -2181,6 +2197,12 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n         return true;\n     }\n \n+    if (strCommand == NetMsgType::SENDADDRv2) {",
    "path": "src/net_processing.cpp",
    "position": 46,
    "original_position": 46,
    "commit_id": "e54fb70b3dfeed37b0955c5814507f7c59c615d2",
    "original_commit_id": "c0414a6a17ea2cf5812b45dbddf318059cde0b7e",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This would accept the `SENDADDRv2` message at any time during the connection lifetime. @laanwj [commented](https://github.com/bitcoin/bips/pull/766#issuecomment-517003833):\r\n\r\n> I think for simplicy of implementation we'd want to mandate that this should be sent _after_ `version` but _before_ any other (non-BIP-signalling) messages, so a connection won't switch to v2 suddenly halfway other things.\r\n\r\nIt looks ok to me to switch to v2 in the middle of the connection lifetime, or do I miss something?",
    "created_at": "2020-04-21T14:54:57Z",
    "updated_at": "2020-04-21T19:12:29Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r412257785",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/412257785"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r412257785"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/412257785/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2200,
    "original_line": 2200,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/412281609",
    "pull_request_review_id": 395637985,
    "id": 412281609,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjI4MTYwOQ==",
    "diff_hunk": "@@ -3590,14 +3612,24 @@ bool PeerLogicValidation::SendMessages(CNode* pto)\n                     // receiver rejects addr messages larger than 1000\n                     if (vAddr.size() >= 1000)\n                     {\n-                        connman->PushMessage(pto, msgMaker.Make(NetMsgType::ADDR, vAddr));\n+                        if (state.m_accepts_addrv2) {\n+                            connman->PushMessage(pto, msgMaker.Make(SERIALIZE_ADDR_AS_V2, NetMsgType::ADDRv2, vAddr));",
    "path": "src/net_processing.cpp",
    "position": 61,
    "original_position": 61,
    "commit_id": "e54fb70b3dfeed37b0955c5814507f7c59c615d2",
    "original_commit_id": "c0414a6a17ea2cf5812b45dbddf318059cde0b7e",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The arguments seem redundant: `NetMsgType::ADDRv2` already implies v2, so `SERIALIZE_ADDR_AS_V2` shouldn't be necessary?\r\n\r\nThis also opens up the possibility for an unintentional misuses like `Make(SERIALIZE_ADDR_AS_V2, NetMsgType::ADDR, vAddr)` or `Make(NetMsgType::ADDRv2, vAddr)`. Would it be more appropriate to have something like the following inside `CNetMsgMaker::Make()`?\r\n\r\n```cpp\r\nif (sCommand == NetMsgType::ADDRv2) {\r\n    nFlags |= SERIALIZE_ADDR_AS_V2;\r\n}   \r\n```\r\n\r\nand call it like `Make(NetMsgType::ADDRv2, vAddr)`?",
    "created_at": "2020-04-21T15:22:33Z",
    "updated_at": "2020-04-21T19:12:29Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r412281609",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/412281609"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r412281609"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/412281609/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 3616,
    "original_line": 3616,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/412308897",
    "pull_request_review_id": 395637985,
    "id": 412308897,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjMwODg5Nw==",
    "diff_hunk": "@@ -2124,9 +2131,18 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n         return false;\n     }\n \n-    if (strCommand == NetMsgType::ADDR) {\n+    if (strCommand == NetMsgType::ADDR || strCommand == NetMsgType::ADDRv2) {\n+        if (strCommand == NetMsgType::ADDRv2) {\n+            vRecv.SetVersion(vRecv.GetVersion() | SERIALIZE_ADDR_AS_V2);",
    "path": "src/net_processing.cpp",
    "position": 28,
    "original_position": 28,
    "commit_id": "e54fb70b3dfeed37b0955c5814507f7c59c615d2",
    "original_commit_id": "c0414a6a17ea2cf5812b45dbddf318059cde0b7e",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Here `SERIALIZE_ADDR_AS_V2` is being used as a **de**serialize instruction (\"deserialize this addr message which is in v2 format\") which may be confusing. What about using a separate constant like `DESERIALIZE_ADDR_FROM_V2`, or just one constant but with a generic name like `ADDR_V2_FORMAT`?",
    "created_at": "2020-04-21T16:32:03Z",
    "updated_at": "2020-04-21T19:12:29Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r412308897",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/412308897"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r412308897"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/412308897/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2136,
    "original_line": 2136,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/412934714",
    "pull_request_review_id": 398135006,
    "id": 412934714,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMjkzNDcxNA==",
    "diff_hunk": "@@ -209,6 +211,7 @@ class CAddrMan\n     //! Holds addrs inserted into tried table that collide with existing entries. Test-before-evict discipline used to resolve these collisions.\n     std::set<int> m_tried_collisions;\n \n+    unsigned char m_serialization_version;",
    "path": "src/addrman.h",
    "position": 13,
    "original_position": 13,
    "commit_id": "e54fb70b3dfeed37b0955c5814507f7c59c615d2",
    "original_commit_id": "e54fb70b3dfeed37b0955c5814507f7c59c615d2",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This member variable is unused.",
    "created_at": "2020-04-22T12:24:31Z",
    "updated_at": "2020-04-25T07:26:41Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r412934714",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/412934714"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r412934714"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/412934714/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 214,
    "original_line": 214,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/414663229",
    "pull_request_review_id": 398135006,
    "id": 414663229,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxNDY2MzIyOQ==",
    "diff_hunk": "@@ -703,51 +777,57 @@ CSubNet::CSubNet():\n \n CSubNet::CSubNet(const CNetAddr &addr, int32_t mask)\n {\n-    valid = true;\n+    valid = (addr.m_network_id == NetworkID::IPV4 || addr.m_network_id == NetworkID::IPV6);\n     network = addr;\n     // Default to /32 (IPv4) or /128 (IPv6), i.e. match single address\n     memset(netmask, 255, sizeof(netmask));\n \n     // IPv4 addresses start at offset 12, and first 12 bytes must match, so just offset n\n-    const int astartofs = network.IsIPv4() ? 12 : 0;\n+    const int alens = network.ip.size();\n \n     int32_t n = mask;\n-    if(n >= 0 && n <= (128 - astartofs*8)) // Only valid if in range of bits of address\n+    if(n >= 0 && n <= (alens*8)) // Only valid if in range of bits of address\n     {\n-        n += astartofs*8;\n         // Clear bits [n..127]\n         for (; n < 128; ++n)\n             netmask[n>>3] &= ~(1<<(7-(n&7)));\n-    } else\n+    } else {\n         valid = false;\n+    }\n \n     // Normalize network according to netmask\n-    for(int x=0; x<16; ++x)\n-        network.ip[x] &= netmask[x];\n+    for(size_t x=0; x<alens; ++x)\n+        network.ip.at(x) &= netmask[x];\n }\n \n CSubNet::CSubNet(const CNetAddr &addr, const CNetAddr &mask)\n {\n-    valid = true;\n+    valid = (addr.m_network_id == NetworkID::IPV4 || addr.m_network_id == NetworkID::IPV6);\n     network = addr;\n     // Default to /32 (IPv4) or /128 (IPv6), i.e. match single address\n     memset(netmask, 255, sizeof(netmask));\n \n     // IPv4 addresses start at offset 12, and first 12 bytes must match, so just offset n\n-    const int astartofs = network.IsIPv4() ? 12 : 0;\n+    const int alens = network.ip.size();\n \n-    for(int x=astartofs; x<16; ++x)\n-        netmask[x] = mask.ip[x];\n+    for(int x=0; x<alens; ++x)\n+        netmask[x] = mask.ip.at(x);\n+    for(int x=alens; x<16; ++x)\n+        netmask[x] = 0;\n \n     // Normalize network according to netmask\n-    for(int x=0; x<16; ++x)\n-        network.ip[x] &= netmask[x];\n+    for(size_t x=0; x<network.ip.size(); ++x)\n+        network.ip.at(x) &= netmask[x];\n }\n \n CSubNet::CSubNet(const CNetAddr &addr):\n     valid(addr.IsValid())\n {\n-    memset(netmask, 255, sizeof(netmask));\n+    valid &= (addr.m_network_id == NetworkID::IPV4 || addr.m_network_id == NetworkID::IPV6);\n+\n+    memset(netmask, 0, sizeof(netmask));\n+    memset(netmask, 255, addr.ip.size());",
    "path": "src/netaddress.cpp",
    "position": 493,
    "original_position": 493,
    "commit_id": "e54fb70b3dfeed37b0955c5814507f7c59c615d2",
    "original_commit_id": "e54fb70b3dfeed37b0955c5814507f7c59c615d2",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`netmask` is still [defined](https://github.com/bitcoin/bitcoin/pull/16748/files#diff-76d15e11a95be7a4aee1eb89de6098caR185) as `uint8_t netmask[16];` and if this is one of the new addresses that has `addr.ip.size()` equal to 32, then this `memset()` will overflow the buffer. Yes, `valid` will be false due to the above `valid &= ...`, but the overflow would still happen.",
    "created_at": "2020-04-24T15:26:13Z",
    "updated_at": "2020-04-25T07:26:41Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r414663229",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/414663229"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r414663229"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/414663229/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 829,
    "original_line": 829,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/420852452",
    "pull_request_review_id": 406690396,
    "id": 420852452,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMDg1MjQ1Mg==",
    "diff_hunk": "@@ -477,7 +486,8 @@ class CAddrMan\n         mapAddr.clear();\n     }\n \n-    CAddrMan()\n+    CAddrMan(unsigned char serialization_version = ADDRMAN_HIGHEST_KNOWN_SERIALIZATION_VERSION)",
    "path": "src/addrman.h",
    "position": 62,
    "original_position": 62,
    "commit_id": "e54fb70b3dfeed37b0955c5814507f7c59c615d2",
    "original_commit_id": "02dfac7799dc3a1febfe6d009debf28d59c64465",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "No, it does not because the argument is `unsigned char`.",
    "created_at": "2020-05-06T14:49:06Z",
    "updated_at": "2020-05-06T14:49:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r420852452",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/420852452"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r420852452"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/420852452/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 489,
    "original_line": 489,
    "side": "RIGHT",
    "in_reply_to_id": 410440592
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/421031112",
    "pull_request_review_id": 406912724,
    "id": 421031112,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTAzMTExMg==",
    "diff_hunk": "@@ -81,19 +116,61 @@ class CNetAddr\n         bool GetInAddr(struct in_addr* pipv4Addr) const;\n         std::vector<unsigned char> GetGroup() const;\n         int GetReachabilityFrom(const CNetAddr *paddrPartner = nullptr) const;\n-\n+        bool GetV1Serialization(unsigned char *buff) const;\n+        void FromV1Serialization(unsigned char *buff);\n         explicit CNetAddr(const struct in6_addr& pipv6Addr, const uint32_t scope = 0);\n         bool GetIn6Addr(struct in6_addr* pipv6Addr) const;\n \n         friend bool operator==(const CNetAddr& a, const CNetAddr& b);\n         friend bool operator!=(const CNetAddr& a, const CNetAddr& b) { return !(a == b); }\n         friend bool operator<(const CNetAddr& a, const CNetAddr& b);\n \n-        ADD_SERIALIZE_METHODS;\n+        template<typename Stream>\n+        void Serialize(Stream &s) const\n+        {\n+            if (s.GetVersion() & SERIALIZE_ADDR_AS_V2) {\n+                s << static_cast<uint8_t>(m_network_id);\n+                s << ip;\n+            } else {\n+                unsigned char ip_temp[16];\n+                GetV1Serialization(ip_temp);",
    "path": "src/netaddress.h",
    "position": 90,
    "original_position": 90,
    "commit_id": "e54fb70b3dfeed37b0955c5814507f7c59c615d2",
    "original_commit_id": "e54fb70b3dfeed37b0955c5814507f7c59c615d2",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "We must make sure that we never end up here with `this` being one of the new address types, e.g. Tor v3. If that happens `GetV1Serialization()` will return `false` (which is currently ignored).\r\n\r\nWe should not attempt to send e.g. Tor v3 address to a peer that did not signal ADDRv2 support. Maybe `CNode::PushAddress()` is a good place to plant a check for that and skip adding new type addresses to the send queue of an old peer.",
    "created_at": "2020-05-06T19:15:18Z",
    "updated_at": "2020-05-06T19:33:47Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r421031112",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/421031112"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r421031112"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/421031112/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 136,
    "original_line": 136,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/421033048",
    "pull_request_review_id": 406912724,
    "id": 421033048,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyMTAzMzA0OA==",
    "diff_hunk": "@@ -2124,9 +2131,18 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n         return false;\n     }\n \n-    if (strCommand == NetMsgType::ADDR) {\n+    if (strCommand == NetMsgType::ADDR || strCommand == NetMsgType::ADDRv2) {\n+        if (strCommand == NetMsgType::ADDRv2) {\n+            vRecv.SetVersion(vRecv.GetVersion() | SERIALIZE_ADDR_AS_V2);",
    "path": "src/net_processing.cpp",
    "position": 28,
    "original_position": 28,
    "commit_id": "e54fb70b3dfeed37b0955c5814507f7c59c615d2",
    "original_commit_id": "e54fb70b3dfeed37b0955c5814507f7c59c615d2",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This will flip `vRecv` to always deserialize addr messages as addrv2. If we subsequently receive addr(v1) then it will fail to parse it as addrv2. It would be unusual for a peer to send addrv2 followed by addrv1, but still that's not forbidden and we should handle it.",
    "created_at": "2020-05-06T19:18:47Z",
    "updated_at": "2020-05-06T19:33:47Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r421033048",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/421033048"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16748#discussion_r421033048"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16748"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/421033048/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2136,
    "original_line": 2136,
    "side": "RIGHT"
  }
]