[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/457733582",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#issuecomment-457733582",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/15266",
    "id": 457733582,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1NzczMzU4Mg==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-25T21:22:47Z",
    "updated_at": "2019-01-25T21:22:47Z",
    "author_association": "MEMBER",
    "body": "Just as a way to minimize the diff (which may or may not be desirable): you can have a trivial proxy object instantiated as g_logger whose operator->() invokes GetLogger().",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/457733582/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/457782454",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#issuecomment-457782454",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/15266",
    "id": 457782454,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1Nzc4MjQ1NA==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-26T00:41:47Z",
    "updated_at": "2019-01-26T00:41:47Z",
    "author_association": "MEMBER",
    "body": "> `COFU<string> const  g_str_new;`\r\n\r\nIt looks like you are introducing a new global for this, which again opens up the problem I am trying to solve. Either I am missing something or we are running in circles.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/457782454/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/457783169",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#issuecomment-457783169",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/15266",
    "id": 457783169,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1Nzc4MzE2OQ==",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?u=4a9af998e1a560b3f49c3827f453e1bcbe6a5cfb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-26T00:46:29Z",
    "updated_at": "2019-01-26T00:46:49Z",
    "author_association": "MEMBER",
    "body": "@MarcoFalke my suggestion is to do:\r\n```cpp\r\nCOFU<BCLog::Logger> const g_logger;\r\n```\r\nso that the following is unchanged:\r\n```cpp\r\ng_logger->m_reopen_file = true;\r\n```\r\nLike @sipa suggested.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/457783169/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/457783857",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#issuecomment-457783857",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/15266",
    "id": 457783857,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1Nzc4Mzg1Nw==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-26T00:51:07Z",
    "updated_at": "2019-01-26T00:52:38Z",
    "author_association": "MEMBER",
    "body": "@MarcoFalke Not sure if that's what you're referring to, but the COFU object has no member variables to initialize, so it doesn't have any runtime initialization (in other words, it's fully constructed before any code is executed).\r\n\r\nI don't have a strong opinion on whether such a COFU object/type is the right solution; just offering it as a possibility if reducing the size of the diff is wanted.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/457783857/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/457784060",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#issuecomment-457784060",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/15266",
    "id": 457784060,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1Nzc4NDA2MA==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-26T00:52:37Z",
    "updated_at": "2019-01-26T00:52:37Z",
    "author_association": "MEMBER",
    "body": "Ah, that makes it clearer.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/457784060/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/457784439",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#issuecomment-457784439",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/15266",
    "id": 457784439,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1Nzc4NDQzOQ==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-26T00:55:24Z",
    "updated_at": "2019-01-26T00:55:24Z",
    "author_association": "MEMBER",
    "body": "Relevant section from https://en.cppreference.com/w/cpp/language/constant_initialization:\r\n\r\n> The effects of constant initialization are the same as the effects of the corresponding initialization, except that it's guaranteed that it is complete before any other initialization of a static or thread-local object begins, and it may be performed at compile time. \r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/457784439/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/457786634",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#issuecomment-457786634",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/15266",
    "id": 457786634,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1Nzc4NjYzNA==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-26T01:12:31Z",
    "updated_at": "2019-02-04T17:27:31Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#15329](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15329.html) (Fix InitError() and InitWarning() content by hebasto)\n* [#14169](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14169.html) (add -debuglogsize=<n> option by SuckShit)\n* [#13746](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/13746.html) (-masterdatadir for datadir bootstrapping by kallewoof)\n* [#13088](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/13088.html) (Log early messages with -printtoconsole by ajtowns)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/457786634/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/458671497",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#issuecomment-458671497",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/15266",
    "id": 458671497,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ1ODY3MTQ5Nw==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-01-29T19:20:56Z",
    "updated_at": "2019-01-29T19:20:56Z",
    "author_association": "MEMBER",
    "body": "Reverted back to my initial patch (using the `LogInstance` wording suggested here https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251495210)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/458671497/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/460371851",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#issuecomment-460371851",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/15266",
    "id": 460371851,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ2MDM3MTg1MQ==",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?u=eab5d0cdbb6cc25087cb61d4ca4a6f85255f42a7&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-02-04T19:07:50Z",
    "updated_at": "2019-02-04T19:07:50Z",
    "author_association": "CONTRIBUTOR",
    "body": "utACK 77777c5624e2f5416d85500e82b7c80e10ed01b6",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/460371851/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251166054",
    "pull_request_review_id": 196749425,
    "id": 251166054,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTE2NjA1NA==",
    "diff_hunk": "@@ -62,22 +63,11 @@ typedef std::map<std::pair<void*, void*>, LockStack> LockOrders;\n typedef std::set<std::pair<void*, void*> > InvLockOrders;\n \n struct LockData {\n-    // Very ugly hack: as the global constructs and destructors run single\n-    // threaded, we use this boolean to know whether LockData still exists,\n-    // as DeleteLock can get called by global CCriticalSection destructors\n-    // after LockData disappears.\n-    bool available;\n-    LockData() : available(true) {}\n-    ~LockData() { available = false; }\n-\n     LockOrders lockorders;\n     InvLockOrders invlockorders;\n     std::mutex dd_mutex;\n };\n-LockData& GetLockData() {\n-    static LockData lockdata;\n-    return lockdata;\n-}\n+static GLOBAL_COFU(LockData, GetLockData);",
    "path": "src/sync.cpp",
    "position": null,
    "original_position": 28,
    "commit_id": "77777c5624e2f5416d85500e82b7c80e10ed01b6",
    "original_commit_id": "fadf76a166c1dd99223595bd34df8a523a201f62",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "static \ud83d\udc4d ",
    "created_at": "2019-01-25T23:17:22Z",
    "updated_at": "2019-01-29T20:30:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251166054",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251166054"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251166054"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251166054/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 70,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251186586",
    "pull_request_review_id": 196774270,
    "id": 251186586,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTE4NjU4Ng==",
    "diff_hunk": "@@ -5,6 +5,7 @@\n #include <sync.h>\n \n #include <logging.h>\n+#include <util/memory.h>",
    "path": "src/sync.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "77777c5624e2f5416d85500e82b7c80e10ed01b6",
    "original_commit_id": "fad73c1474c2e2fd5cb5bbc4a77455cef2683153",
    "user": {
      "login": "AkioNak",
      "id": 24285095,
      "node_id": "MDQ6VXNlcjI0Mjg1MDk1",
      "avatar_url": "https://avatars.githubusercontent.com/u/24285095?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AkioNak",
      "html_url": "https://github.com/AkioNak",
      "followers_url": "https://api.github.com/users/AkioNak/followers",
      "following_url": "https://api.github.com/users/AkioNak/following{/other_user}",
      "gists_url": "https://api.github.com/users/AkioNak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AkioNak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AkioNak/subscriptions",
      "organizations_url": "https://api.github.com/users/AkioNak/orgs",
      "repos_url": "https://api.github.com/users/AkioNak/repos",
      "events_url": "https://api.github.com/users/AkioNak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AkioNak/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: You can delete `` `#include <memory>` `` after a few lines.",
    "created_at": "2019-01-26T03:31:30Z",
    "updated_at": "2019-01-29T20:30:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251186586",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251186586"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251186586"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251186586/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 8,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251187335",
    "pull_request_review_id": 196774270,
    "id": 251187335,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTE4NzMzNQ==",
    "diff_hunk": "@@ -113,7 +103,7 @@ static void potential_deadlock_detected(const std::pair<void*, void*>& mismatch,\n \n static void push_lock(void* c, const CLockLocation& locklocation)\n {\n-    LockData& lockdata = GetLockData();\n+    LockData& lockdata{*g_lockdata.Get()};",
    "path": "src/sync.cpp",
    "position": null,
    "original_position": 37,
    "commit_id": "77777c5624e2f5416d85500e82b7c80e10ed01b6",
    "original_commit_id": "fad73c1474c2e2fd5cb5bbc4a77455cef2683153",
    "user": {
      "login": "AkioNak",
      "id": 24285095,
      "node_id": "MDQ6VXNlcjI0Mjg1MDk1",
      "avatar_url": "https://avatars.githubusercontent.com/u/24285095?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AkioNak",
      "html_url": "https://github.com/AkioNak",
      "followers_url": "https://api.github.com/users/AkioNak/followers",
      "following_url": "https://api.github.com/users/AkioNak/following{/other_user}",
      "gists_url": "https://api.github.com/users/AkioNak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AkioNak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AkioNak/subscriptions",
      "organizations_url": "https://api.github.com/users/AkioNak/orgs",
      "repos_url": "https://api.github.com/users/AkioNak/repos",
      "events_url": "https://api.github.com/users/AkioNak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AkioNak/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I prefer following code rather than calling Get() directly.\r\n```suggestion\r\n    LockData& lockdata = *g_lockdata;\r\n```\r\nor\r\n```suggestion\r\n    LockData& lockdata{*g_lockdata};\r\n```",
    "created_at": "2019-01-26T04:08:53Z",
    "updated_at": "2019-01-29T20:30:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251187335",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251187335"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251187335"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251187335/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 106,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251187390",
    "pull_request_review_id": 196774270,
    "id": 251187390,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTE4NzM5MA==",
    "diff_hunk": "@@ -178,11 +168,7 @@ void AssertLockNotHeldInternal(const char* pszName, const char* pszFile, int nLi\n \n void DeleteLock(void* cs)\n {\n-    LockData& lockdata = GetLockData();\n-    if (!lockdata.available) {\n-        // We're already shutting down.\n-        return;\n-    }\n+    LockData& lockdata{*g_lockdata.Get()};",
    "path": "src/sync.cpp",
    "position": null,
    "original_position": 50,
    "commit_id": "77777c5624e2f5416d85500e82b7c80e10ed01b6",
    "original_commit_id": "fad73c1474c2e2fd5cb5bbc4a77455cef2683153",
    "user": {
      "login": "AkioNak",
      "id": 24285095,
      "node_id": "MDQ6VXNlcjI0Mjg1MDk1",
      "avatar_url": "https://avatars.githubusercontent.com/u/24285095?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AkioNak",
      "html_url": "https://github.com/AkioNak",
      "followers_url": "https://api.github.com/users/AkioNak/followers",
      "following_url": "https://api.github.com/users/AkioNak/following{/other_user}",
      "gists_url": "https://api.github.com/users/AkioNak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AkioNak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AkioNak/subscriptions",
      "organizations_url": "https://api.github.com/users/AkioNak/orgs",
      "repos_url": "https://api.github.com/users/AkioNak/repos",
      "events_url": "https://api.github.com/users/AkioNak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AkioNak/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "\r\n(same above)\r\nI prefer following code rather than calling Get() directly.\r\n```suggestion\r\n    LockData& lockdata = *g_lockdata;\r\n```\r\nor\r\n```suggestion\r\n    LockData& lockdata{*g_lockdata};\r\n```",
    "created_at": "2019-01-26T04:11:51Z",
    "updated_at": "2019-01-29T20:30:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251187390",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251187390"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251187390"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251187390/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 171,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251200234",
    "pull_request_review_id": 196788983,
    "id": 251200234,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTIwMDIzNA==",
    "diff_hunk": "@@ -113,7 +103,7 @@ static void potential_deadlock_detected(const std::pair<void*, void*>& mismatch,\n \n static void push_lock(void* c, const CLockLocation& locklocation)\n {\n-    LockData& lockdata = GetLockData();\n+    LockData& lockdata{*g_lockdata.Get()};\n     std::lock_guard<std::mutex> lock(lockdata.dd_mutex);",
    "path": "src/sync.cpp",
    "position": null,
    "original_position": 38,
    "commit_id": "77777c5624e2f5416d85500e82b7c80e10ed01b6",
    "original_commit_id": "fad73c1474c2e2fd5cb5bbc4a77455cef2683153",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Another alternative is to ditch local `lockdata` and use global `g_lockdata`:\r\n```cpp\r\nstd::lock_guard<std::mutex> lock(g_lockdata->dd_mutex);\r\n```\r\nWould result in a bigger diff but I think it is better than \"aliases\".",
    "created_at": "2019-01-26T14:06:42Z",
    "updated_at": "2019-01-29T20:30:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251200234",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251200234"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251200234"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251200234/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 117,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251241332",
    "pull_request_review_id": 196832082,
    "id": 251241332,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTI0MTMzMg==",
    "diff_hunk": "@@ -21,7 +22,7 @@ const char * const DEFAULT_DEBUGLOGFILE = \"debug.log\";\n  * This method of initialization was originally introduced in\n  * ee3374234c60aba2cc4c5cd5cac1c0aefc2d817c.\n  */\n-BCLog::Logger* const g_logger = new BCLog::Logger();\n+GlobalCOFU<BCLog::Logger> g_logger;",
    "path": "src/logging.cpp",
    "position": null,
    "original_position": 17,
    "commit_id": "77777c5624e2f5416d85500e82b7c80e10ed01b6",
    "original_commit_id": "faacd53015e59548b748ae32dd71af1eab0a62d7",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Could update comment above to note that the raw pointer is now in GlobalCOFU?",
    "created_at": "2019-01-27T15:17:38Z",
    "updated_at": "2019-01-29T20:30:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251241332",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251241332"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251241332"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251241332/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 25,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251241363",
    "pull_request_review_id": 196832082,
    "id": 251241363,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTI0MTM2Mw==",
    "diff_hunk": "@@ -5,6 +5,7 @@\n #include <sync.h>\n \n #include <logging.h>\n+#include <util/memory.h>",
    "path": "src/sync.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "77777c5624e2f5416d85500e82b7c80e10ed01b6",
    "original_commit_id": "fad73c1474c2e2fd5cb5bbc4a77455cef2683153",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Any reason to keep the mentioned include?",
    "created_at": "2019-01-27T15:18:07Z",
    "updated_at": "2019-01-29T20:30:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251241363",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251241363"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251241363"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251241363/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 8,
    "side": "RIGHT",
    "in_reply_to_id": 251186586
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251241587",
    "pull_request_review_id": 196832379,
    "id": 251241587,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTI0MTU4Nw==",
    "diff_hunk": "@@ -5,6 +5,7 @@\n #include <sync.h>\n \n #include <logging.h>\n+#include <util/memory.h>",
    "path": "src/sync.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "77777c5624e2f5416d85500e82b7c80e10ed01b6",
    "original_commit_id": "fad73c1474c2e2fd5cb5bbc4a77455cef2683153",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It has been there before, so according to iwyu it should stay there. I'd prefer if someone jotted down some notes on how to run iwyu on Bitcoin Core, so that we wouldn't have to spend review on those.",
    "created_at": "2019-01-27T15:25:18Z",
    "updated_at": "2019-01-29T20:30:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251241587",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251241587"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251241587"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251241587/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 8,
    "side": "RIGHT",
    "in_reply_to_id": 251186586
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251261669",
    "pull_request_review_id": 196851962,
    "id": 251261669,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTI2MTY2OQ==",
    "diff_hunk": "@@ -16,4 +16,20 @@ std::unique_ptr<T> MakeUnique(Args&&... args)\n     return std::unique_ptr<T>(new T(std::forward<Args>(args)...));\n }\n \n+/**\n+ * Ensure that a global is initialized before its first use and never",
    "path": "src/util/memory.h",
    "position": null,
    "original_position": 12,
    "commit_id": "77777c5624e2f5416d85500e82b7c80e10ed01b6",
    "original_commit_id": "faacd53015e59548b748ae32dd71af1eab0a62d7",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This no-destruction property shouldn't be needed. C++ guarantees that destructors are invoked at shutdown in reverse order as they were constructed (even taking objects constructed through functions invoked from other module's global initializers into account).\r\n\r\nHave you found evidence that this isn't enough?",
    "created_at": "2019-01-28T00:21:40Z",
    "updated_at": "2019-01-29T20:30:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251261669",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251261669"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251261669"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251261669/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 20,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251261731",
    "pull_request_review_id": 196852030,
    "id": 251261731,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTI2MTczMQ==",
    "diff_hunk": "@@ -16,4 +16,20 @@ std::unique_ptr<T> MakeUnique(Args&&... args)\n     return std::unique_ptr<T>(new T(std::forward<Args>(args)...));\n }\n \n+/**\n+ * Ensure that a global is initialized before its first use and never\n+ * destructed, since other destructors might use it.\n+ * This class should not be used where the destructor ~T() is non-trivial.\n+ */\n+template <typename T>",
    "path": "src/util/memory.h",
    "position": null,
    "original_position": 16,
    "commit_id": "77777c5624e2f5416d85500e82b7c80e10ed01b6",
    "original_commit_id": "faacd53015e59548b748ae32dd71af1eab0a62d7",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Perhaps also add a comment to explain that if multiple instances of GlobalCOFU<T> for the same T exist, they will all share the underlying T object.",
    "created_at": "2019-01-28T00:23:14Z",
    "updated_at": "2019-01-29T20:30:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251261731",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251261731"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251261731"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251261731/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 24,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251265900",
    "pull_request_review_id": 196856784,
    "id": 251265900,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTI2NTkwMA==",
    "diff_hunk": "@@ -5,6 +5,7 @@\n #include <sync.h>\n \n #include <logging.h>\n+#include <util/memory.h>",
    "path": "src/sync.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "77777c5624e2f5416d85500e82b7c80e10ed01b6",
    "original_commit_id": "fad73c1474c2e2fd5cb5bbc4a77455cef2683153",
    "user": {
      "login": "AkioNak",
      "id": 24285095,
      "node_id": "MDQ6VXNlcjI0Mjg1MDk1",
      "avatar_url": "https://avatars.githubusercontent.com/u/24285095?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/AkioNak",
      "html_url": "https://github.com/AkioNak",
      "followers_url": "https://api.github.com/users/AkioNak/followers",
      "following_url": "https://api.github.com/users/AkioNak/following{/other_user}",
      "gists_url": "https://api.github.com/users/AkioNak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/AkioNak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/AkioNak/subscriptions",
      "organizations_url": "https://api.github.com/users/AkioNak/orgs",
      "repos_url": "https://api.github.com/users/AkioNak/repos",
      "events_url": "https://api.github.com/users/AkioNak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/AkioNak/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In this case, I think it was already unnecessary to include, and good time to remove.\r\n\r\n1. ```#include <memory>``` has been added to ```sync.cpp``` because it already using ```std::unique_ptr``` ( #12859).\r\n2. ```std::unique_ptr``` has been removed from ```sync.cpp``` (#13300)\r\n",
    "created_at": "2019-01-28T01:41:36Z",
    "updated_at": "2019-01-29T20:30:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251265900",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251265900"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251265900"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251265900/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 8,
    "side": "RIGHT",
    "in_reply_to_id": 251186586
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251495210",
    "pull_request_review_id": 197137115,
    "id": 251495210,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTQ5NTIxMA==",
    "diff_hunk": "@@ -16,4 +16,20 @@ std::unique_ptr<T> MakeUnique(Args&&... args)\n     return std::unique_ptr<T>(new T(std::forward<Args>(args)...));\n }\n \n+/**\n+ * Ensure that a global is initialized before its first use and never\n+ * destructed, since other destructors might use it.\n+ * This class should not be used where the destructor ~T() is non-trivial.\n+ */\n+template <typename T>\n+struct GlobalCOFU {",
    "path": "src/util/memory.h",
    "position": null,
    "original_position": 17,
    "commit_id": "77777c5624e2f5416d85500e82b7c80e10ed01b6",
    "original_commit_id": "faacd53015e59548b748ae32dd71af1eab0a62d7",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This seems over-engineered. Why not just have a simple function like:\r\n\r\n```c++\r\nLogger& LogInstance() {\r\n  static Logger logger;\r\n  return logger;\r\n}\r\n```\r\n\r\nand have a scripted diff replacing `g_logger->` with `LogInstance().` This would be equivalent to what the `GlobalCOFU` class is doing but more straightforward, and would actually guarantee destruction, and avoid creating landmines where separate variables of the same type point to the same instances, and avoid weird terminology (COFU == singleton?)",
    "created_at": "2019-01-28T16:38:55Z",
    "updated_at": "2019-01-29T20:30:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251495210",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251495210"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251495210"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251495210/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 25,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251505793",
    "pull_request_review_id": 197150341,
    "id": 251505793,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTUwNTc5Mw==",
    "diff_hunk": "@@ -16,4 +16,20 @@ std::unique_ptr<T> MakeUnique(Args&&... args)\n     return std::unique_ptr<T>(new T(std::forward<Args>(args)...));\n }\n \n+/**\n+ * Ensure that a global is initialized before its first use and never\n+ * destructed, since other destructors might use it.\n+ * This class should not be used where the destructor ~T() is non-trivial.\n+ */\n+template <typename T>\n+struct GlobalCOFU {",
    "path": "src/util/memory.h",
    "position": null,
    "original_position": 17,
    "commit_id": "77777c5624e2f5416d85500e82b7c80e10ed01b6",
    "original_commit_id": "faacd53015e59548b748ae32dd71af1eab0a62d7",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> and would actually guarantee destruction\r\n\r\nFWIW the same could be done with `GlobalCOFU`.",
    "created_at": "2019-01-28T17:02:44Z",
    "updated_at": "2019-01-29T20:30:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251505793",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251505793"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251505793"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251505793/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 25,
    "side": "RIGHT",
    "in_reply_to_id": 251495210
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251532777",
    "pull_request_review_id": 197184589,
    "id": 251532777,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTUzMjc3Nw==",
    "diff_hunk": "@@ -16,4 +16,20 @@ std::unique_ptr<T> MakeUnique(Args&&... args)\n     return std::unique_ptr<T>(new T(std::forward<Args>(args)...));\n }\n \n+/**\n+ * Ensure that a global is initialized before its first use and never",
    "path": "src/util/memory.h",
    "position": null,
    "original_position": 12,
    "commit_id": "77777c5624e2f5416d85500e82b7c80e10ed01b6",
    "original_commit_id": "faacd53015e59548b748ae32dd71af1eab0a62d7",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@sipa, see the comments in `sync` and `logging`. Basically the order in what you need the destructor to be called might be different from the inverse order they were constructed.\r\n\r\nSee a simple example that segfaults if I dropped that requirement:\r\n\r\n(The `~Init` destructor uses the log after the logger has been destructed)\r\n\r\n```cpp\r\n#include <iostream>\r\n#include <memory>\r\nstruct Log{\r\n std::unique_ptr<const std::string> m_prefix;\r\n Log(){m_prefix=std::unique_ptr<const std::string>(new std::string{\"::: \"});log(__func__);};\r\n ~Log(){log(__func__);};\r\n void log(const std::string&s){std::cout << *m_prefix << s << std::endl;}\r\n};\r\n\r\nLog& LogInstance() {\r\n static Log l;\r\n return l;\r\n}\r\n\r\nstruct Init{\r\n Init(){std::cout << __func__<<std::endl;}\r\n ~Init(){LogInstance().log(__func__);}\r\n} g_init;\r\n\r\nint main()\r\n{\r\n LogInstance().log(__func__);\r\n}",
    "created_at": "2019-01-28T18:16:20Z",
    "updated_at": "2019-01-29T20:30:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251532777",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251532777"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251532777"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251532777/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 20,
    "side": "RIGHT",
    "in_reply_to_id": 251261669
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251534520",
    "pull_request_review_id": 197186780,
    "id": 251534520,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTUzNDUyMA==",
    "diff_hunk": "@@ -16,4 +16,20 @@ std::unique_ptr<T> MakeUnique(Args&&... args)\n     return std::unique_ptr<T>(new T(std::forward<Args>(args)...));\n }\n \n+/**\n+ * Ensure that a global is initialized before its first use and never",
    "path": "src/util/memory.h",
    "position": null,
    "original_position": 12,
    "commit_id": "77777c5624e2f5416d85500e82b7c80e10ed01b6",
    "original_commit_id": "faacd53015e59548b748ae32dd71af1eab0a62d7",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@MarcoFalke because Init is constructed first. It works if you change `Init` constructor to `Init(){LogInstance().log(__func__);}`.\r\n",
    "created_at": "2019-01-28T18:21:25Z",
    "updated_at": "2019-01-29T20:30:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251534520",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251534520"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251534520"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251534520/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 20,
    "side": "RIGHT",
    "in_reply_to_id": 251261669
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251534831",
    "pull_request_review_id": 197187167,
    "id": 251534831,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTUzNDgzMQ==",
    "diff_hunk": "@@ -16,4 +16,20 @@ std::unique_ptr<T> MakeUnique(Args&&... args)\n     return std::unique_ptr<T>(new T(std::forward<Args>(args)...));\n }\n \n+/**\n+ * Ensure that a global is initialized before its first use and never",
    "path": "src/util/memory.h",
    "position": null,
    "original_position": 12,
    "commit_id": "77777c5624e2f5416d85500e82b7c80e10ed01b6",
    "original_commit_id": "faacd53015e59548b748ae32dd71af1eab0a62d7",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@MarcoFalke I think that can be resolved by calling `LogInstance` in the `Init::Init` constructor once. That forces the `Log` object to finished construction before `Init`, guaranteeing it's still available at `Init`'s destruction time.",
    "created_at": "2019-01-28T18:22:19Z",
    "updated_at": "2019-01-29T20:30:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251534831",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251534831"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251534831"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251534831/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 20,
    "side": "RIGHT",
    "in_reply_to_id": 251261669
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251536731",
    "pull_request_review_id": 197189358,
    "id": 251536731,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTUzNjczMQ==",
    "diff_hunk": "@@ -16,4 +16,20 @@ std::unique_ptr<T> MakeUnique(Args&&... args)\n     return std::unique_ptr<T>(new T(std::forward<Args>(args)...));\n }\n \n+/**\n+ * Ensure that a global is initialized before its first use and never",
    "path": "src/util/memory.h",
    "position": null,
    "original_position": 12,
    "commit_id": "77777c5624e2f5416d85500e82b7c80e10ed01b6",
    "original_commit_id": "faacd53015e59548b748ae32dd71af1eab0a62d7",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I know, but there is no way to enforce that (in Bitcoin Core or generally) the logger (or any other global \"module\") is called in each constructor when the destructor calls it.",
    "created_at": "2019-01-28T18:27:14Z",
    "updated_at": "2019-01-29T20:30:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251536731",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251536731"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251536731"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251536731/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 20,
    "side": "RIGHT",
    "in_reply_to_id": 251261669
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251537884",
    "pull_request_review_id": 197190737,
    "id": 251537884,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTUzNzg4NA==",
    "diff_hunk": "@@ -16,4 +16,20 @@ std::unique_ptr<T> MakeUnique(Args&&... args)\n     return std::unique_ptr<T>(new T(std::forward<Args>(args)...));\n }\n \n+/**\n+ * Ensure that a global is initialized before its first use and never",
    "path": "src/util/memory.h",
    "position": null,
    "original_position": 12,
    "commit_id": "77777c5624e2f5416d85500e82b7c80e10ed01b6",
    "original_commit_id": "faacd53015e59548b748ae32dd71af1eab0a62d7",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I really prefer going over the few global objects whose destructors need other globals and fixing this, than having lingering global objects at shutdown.",
    "created_at": "2019-01-28T18:30:16Z",
    "updated_at": "2019-01-29T20:30:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251537884",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251537884"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251537884"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251537884/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 20,
    "side": "RIGHT",
    "in_reply_to_id": 251261669
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251538373",
    "pull_request_review_id": 197191325,
    "id": 251538373,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTUzODM3Mw==",
    "diff_hunk": "@@ -16,4 +16,20 @@ std::unique_ptr<T> MakeUnique(Args&&... args)\n     return std::unique_ptr<T>(new T(std::forward<Args>(args)...));\n }\n \n+/**\n+ * Ensure that a global is initialized before its first use and never",
    "path": "src/util/memory.h",
    "position": null,
    "original_position": 12,
    "commit_id": "77777c5624e2f5416d85500e82b7c80e10ed01b6",
    "original_commit_id": "faacd53015e59548b748ae32dd71af1eab0a62d7",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Just make a call to `LogInstance()`?",
    "created_at": "2019-01-28T18:31:30Z",
    "updated_at": "2019-01-29T20:30:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251538373",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251538373"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251538373"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251538373/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 20,
    "side": "RIGHT",
    "in_reply_to_id": 251261669
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251986118",
    "pull_request_review_id": 197745242,
    "id": 251986118,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MTk4NjExOA==",
    "diff_hunk": "@@ -21,7 +21,11 @@ const char * const DEFAULT_DEBUGLOGFILE = \"debug.log\";\n  * This method of initialization was originally introduced in\n  * ee3374234c60aba2cc4c5cd5cac1c0aefc2d817c.\n  */\n-BCLog::Logger* const g_logger = new BCLog::Logger();\n+BCLog::Logger& LogInstance()\n+{\n+    static BCLog::Logger* g_logger{new BCLog::Logger()};",
    "path": "src/logging.cpp",
    "position": 20,
    "original_position": 7,
    "commit_id": "77777c5624e2f5416d85500e82b7c80e10ed01b6",
    "original_commit_id": "fa8e2b75ff7de6b09f97512256092c1d03edef01",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Would add comment here that this intentionally never calls logger destructor. Would also add a comment in the logger class saying that if a destructor is defined there it will never be called, and that any members added to the logger class will not have their destructors called either.",
    "created_at": "2019-01-29T19:37:28Z",
    "updated_at": "2019-01-29T20:30:36Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251986118",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251986118"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r251986118"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/251986118/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 28,
    "original_line": 28,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252005257",
    "pull_request_review_id": 197768992,
    "id": 252005257,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MjAwNTI1Nw==",
    "diff_hunk": "@@ -21,7 +21,11 @@ const char * const DEFAULT_DEBUGLOGFILE = \"debug.log\";\n  * This method of initialization was originally introduced in\n  * ee3374234c60aba2cc4c5cd5cac1c0aefc2d817c.\n  */\n-BCLog::Logger* const g_logger = new BCLog::Logger();\n+BCLog::Logger& LogInstance()\n+{\n+    static BCLog::Logger* g_logger{new BCLog::Logger()};",
    "path": "src/logging.cpp",
    "position": 20,
    "original_position": 7,
    "commit_id": "77777c5624e2f5416d85500e82b7c80e10ed01b6",
    "original_commit_id": "fa8e2b75ff7de6b09f97512256092c1d03edef01",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The comment above says that, I think. Though I added a line clarifying that it must be a trivial destructor.",
    "created_at": "2019-01-29T20:31:45Z",
    "updated_at": "2019-01-29T20:31:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r252005257",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252005257"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/15266#discussion_r252005257"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/15266"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/252005257/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 28,
    "original_line": 28,
    "side": "RIGHT",
    "in_reply_to_id": 251986118
  }
]