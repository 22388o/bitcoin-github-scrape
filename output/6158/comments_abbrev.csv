jonasschnelli,2015-05-19T09:01:54Z,I'm open to alternatives (naming) for  `setban` and `listbanned`. I thought adding banning options over the `addnode` command is a misuse.\nI'm also not sure about banning whole IPs instead of only IP:port (node).\n,https://github.com/bitcoin/bitcoin/pull/6158#issuecomment-103406052,103406052,
jonasschnelli,2015-05-19T15:09:10Z,Added a `clearbanned` command (also included in tests).\n,https://github.com/bitcoin/bitcoin/pull/6158#issuecomment-103540685,103540685,
laanwj,2015-05-21T10:52:49Z,"Concept ACK, did not test or review code yet, this will be after 0.11 release\n",https://github.com/bitcoin/bitcoin/pull/6158#issuecomment-104224813,104224813,
gmaxwell,2015-05-22T06:46:32Z,Great;  I had an old bitrotted version of this and had implemented almost exactly the same interface.  One thing this can't accomplish though is banning netgroups.  (thats actually what held up my code: I found issues with out netgroup parser that broke my tests)\n,https://github.com/bitcoin/bitcoin/pull/6158#issuecomment-104539108,104539108,
LeMiner,2015-05-22T10:00:28Z,"In light of what gmaxwell said, perhaps allowing for  -- setban 12. \* .12.12 or setban 50.50.50. \*   would make sense as well. To allow for banning of entire octets.\n",https://github.com/bitcoin/bitcoin/pull/6158#issuecomment-104605160,104605160,
laanwj,2015-05-22T10:08:16Z,"@leminer Good idea, but I'd say the interface should use `/n` or `/x.y.z.w` CIDR syntax (as parsed by `CSubNet`) instead of bringing back 0.9-era wildcards.\n",https://github.com/bitcoin/bitcoin/pull/6158#issuecomment-104607567,104607567,
jonasschnelli,2015-05-22T11:32:57Z,Agreed with @laanwj.\nI don't think there is a use case for 1.x.2.3\n,https://github.com/bitcoin/bitcoin/pull/6158#issuecomment-104633025,104633025,
LeMiner,2015-05-22T11:39:54Z,"Yep, agreed as well.\n",https://github.com/bitcoin/bitcoin/pull/6158#issuecomment-104636957,104636957,
laanwj,2015-05-22T12:26:40Z,"`1.x.2.3` in CIDR would be `1.0.2.3/255.0.255.255`. But no, I don't see a use-case either.\n",https://github.com/bitcoin/bitcoin/pull/6158#issuecomment-104648043,104648043,
jonasschnelli,2015-05-26T07:55:02Z,Extended this PR to allow subnet banning/unbanning.\nThis needs testing because it changes the internal ban set from `CNetAddr` to `CSubNet`.\n,https://github.com/bitcoin/bitcoin/pull/6158#issuecomment-105432934,105432934,
jonasschnelli,2015-05-27T07:15:21Z,Rebased to make use of the fixed CSubNet issue (https://github.com/bitcoin/bitcoin/pull/6186).\n,https://github.com/bitcoin/bitcoin/pull/6158#issuecomment-105789662,105789662,
jgarzik,2015-06-11T19:45:40Z,ut ACK\n,https://github.com/bitcoin/bitcoin/pull/6158#issuecomment-111256906,111256906,
laanwj,2015-06-12T14:53:09Z,"Needs rebase.\nI agree with @luke-jr that it should be somehow possible to specify an absolute ban time. Relative times are useful for end-users, but not so much for programmatic use.\n",https://github.com/bitcoin/bitcoin/pull/6158#issuecomment-111517619,111517619,
jonasschnelli,2015-06-12T16:34:24Z,Rebased and added the possibility of setting an absolute bantime with `setban add <ip> <unixtimestamp> true`.\n,https://github.com/bitcoin/bitcoin/pull/6158#issuecomment-111550095,111550095,
jonasschnelli,2015-06-16T16:22:11Z,Rebased and added also tests for the new `disconnectnode` command\n,https://github.com/bitcoin/bitcoin/pull/6158#issuecomment-112486029,112486029,
jonasschnelli,2015-06-18T14:51:10Z,Thanks for the merge. I now try to extend this to the UI peers window.\n,https://github.com/bitcoin/bitcoin/pull/6158#issuecomment-113182383,113182383,
Diapolo,2015-05-19T12:32:34Z,"Why was/is this returning a bool, if it seems to be only true?\n",https://github.com/bitcoin/bitcoin/pull/6158#discussion_r30593780,30593780,src/net.cpp
Diapolo,2015-05-19T12:33:46Z,Same question for this function...\n,https://github.com/bitcoin/bitcoin/pull/6158#discussion_r30593867,30593867,src/net.cpp
Diapolo,2015-05-19T12:35:28Z,`listbanned` is not added here?\n,https://github.com/bitcoin/bitcoin/pull/6158#discussion_r30593979,30593979,src/rpcclient.cpp
Diapolo,2015-05-19T12:36:02Z,"What is the default value, if no bantime is supplied? Perhaps add this information in here?\n",https://github.com/bitcoin/bitcoin/pull/6158#discussion_r30594022,30594022,src/rpcnet.cpp
Diapolo,2015-05-19T12:36:51Z,"Why make a copy here, you seem to only use it once anyway?\n",https://github.com/bitcoin/bitcoin/pull/6158#discussion_r30594097,30594097,src/rpcnet.cpp
Diapolo,2015-05-19T12:37:32Z,Suggestion: Perhaps also add a removeall option?\n,https://github.com/bitcoin/bitcoin/pull/6158#discussion_r30594135,30594135,src/rpcnet.cpp
jonasschnelli,2015-05-19T12:39:36Z,Right. I didn't want to change this in this PR and i kept it for legacy reasons and to lower the risk of breaking something.\n,https://github.com/bitcoin/bitcoin/pull/6158#discussion_r30594276,30594276,src/net.cpp
jonasschnelli,2015-05-19T12:40:29Z,This is only for the rpc client (bitcoin-cli) string to json conversion which is not required for `listbanned`.\n,https://github.com/bitcoin/bitcoin/pull/6158#discussion_r30594319,30594319,src/rpcclient.cpp
jonasschnelli,2015-05-19T12:41:13Z,Right. This is a good point. It's actually the cmd arg -bantime. Will add this information.\n,https://github.com/bitcoin/bitcoin/pull/6158#discussion_r30594366,30594366,src/rpcnet.cpp
jonasschnelli,2015-05-19T12:41:59Z,Indeed. This is a relict from copy/paste some code from addnode. Will change.\n,https://github.com/bitcoin/bitcoin/pull/6158#discussion_r30594428,30594428,src/rpcnet.cpp
LeMiner,2015-05-19T14:29:05Z,"+1 for removeall option to clear the list of banned peers. And if possible, adding a right click -> kick/ban option for GUI, which could also be implemented like this: http://i.imgur.com/K5jifJx.png (but better looking obv.)\n",https://github.com/bitcoin/bitcoin/pull/6158#discussion_r30604541,30604541,src/rpcnet.cpp
jonasschnelli,2015-05-19T14:45:15Z,Agreed on the remove all feature. But it would be ugly to have a command like `setban <IP> removeall` (<IP> would then be dummy). And supporting `setban removeall` will make the help message unreadable (because of parameter mixups).\nIMO adding a `clearbanned` command could make sense.\nAny other suggestions?\n,https://github.com/bitcoin/bitcoin/pull/6158#discussion_r30606414,30606414,src/rpcnet.cpp
jonasschnelli,2015-05-19T15:01:21Z,Just added information about the default bantime.\n,https://github.com/bitcoin/bitcoin/pull/6158#discussion_r30608331,30608331,src/rpcnet.cpp
jonasschnelli,2015-05-19T15:01:43Z,Fixed @Diapolo's nit\n,https://github.com/bitcoin/bitcoin/pull/6158#discussion_r30608374,30608374,src/rpcnet.cpp
Diapolo,2015-05-19T15:05:44Z,"Understood, but IMHO a function that doesn't need it could just be `void`. Perhaps you can just add a commit for that at the end? At least it could be changed for `GetBanned` as you just added it :).\n",https://github.com/bitcoin/bitcoin/pull/6158#discussion_r30608843,30608843,src/net.cpp
Diapolo,2015-05-19T15:08:39Z,"`clearbanned` is fine with me, or perhaps `setban * remove` ;)?\n",https://github.com/bitcoin/bitcoin/pull/6158#discussion_r30609210,30609210,src/rpcnet.cpp
jonasschnelli,2015-05-19T15:16:11Z,Agreed. Added a commit on top.\n,https://github.com/bitcoin/bitcoin/pull/6158#discussion_r30610107,30610107,src/net.cpp
Diapolo,2015-06-01T12:09:21Z,"Perhaps I'm not seeing it, but where is a or b used at all?\n",https://github.com/bitcoin/bitcoin/pull/6158#discussion_r31419416,31419416,src/net.cpp
Diapolo,2015-06-01T12:10:26Z,Nit: The `&` should be left `CSubNet&`.\nThis is also true for the new functions below... will make the clang-cleanup smaller in the future.\n,https://github.com/bitcoin/bitcoin/pull/6158#discussion_r31419455,31419455,src/net.cpp
jonasschnelli,2015-06-01T12:15:24Z,Oh. Right. Fixed (did use those lines for debugging).\n,https://github.com/bitcoin/bitcoin/pull/6158#discussion_r31419739,31419739,src/net.cpp
jonasschnelli,2015-06-01T12:19:02Z,Agreed. Fixed.\n,https://github.com/bitcoin/bitcoin/pull/6158#discussion_r31419980,31419980,src/net.cpp
luke-jr,2015-06-02T04:01:09Z,What's with all the whitespace changes? :(\n,https://github.com/bitcoin/bitcoin/pull/6158#discussion_r31491661,31491661,qa/rpc-tests/httpbasics.py
luke-jr,2015-06-02T04:06:04Z,Full words? (s/till/until/) Maybe add underscore?\n,https://github.com/bitcoin/bitcoin/pull/6158#discussion_r31491776,31491776,src/rpcnet.cpp
luke-jr,2015-06-02T04:06:39Z,"Should have some way to set an absolute time here, so banlists can be easily saved/restored across restarts.\n",https://github.com/bitcoin/bitcoin/pull/6158#discussion_r31491787,31491787,src/rpcnet.cpp
jonasschnelli,2015-06-02T04:12:37Z,A relict from one of my previous pulls which i try to clean out without big noise. :-)\n,https://github.com/bitcoin/bitcoin/pull/6158#discussion_r31491901,31491901,qa/rpc-tests/httpbasics.py
jonasschnelli,2015-06-02T04:14:16Z,The stored time is absolute (int64 Unix timestamp). The offset is more a input thing and I think it's suitable when banning a node.\n,https://github.com/bitcoin/bitcoin/pull/6158#discussion_r31491935,31491935,src/rpcnet.cpp
jonasschnelli,2015-06-02T04:14:38Z,Agreed. Will change this.\n,https://github.com/bitcoin/bitcoin/pull/6158#discussion_r31491942,31491942,src/rpcnet.cpp
luke-jr,2015-06-02T05:18:00Z,"Unless you can input an absolute time, restoring a saved list of bans is annoying.\n",https://github.com/bitcoin/bitcoin/pull/6158#discussion_r31493411,31493411,src/rpcnet.cpp
jonasschnelli,2015-06-02T18:45:23Z,Right. An additional method to set the bantime over an absolute value would make sense.\n,https://github.com/bitcoin/bitcoin/pull/6158#discussion_r31556687,31556687,src/rpcnet.cpp
jonasschnelli,2015-06-12T16:35:07Z,"Renamed ""bannedtill"" to ""banned_until"".\n",https://github.com/bitcoin/bitcoin/pull/6158#discussion_r32331710,32331710,src/rpcnet.cpp
laanwj,2015-06-12T16:49:24Z,"I think this should be:\n\n``` c++\nreturn (a.network < b.network || (a.network == b.network && memcmp(a.netmask, b.netmask, 16) < 0));\n```\n",https://github.com/bitcoin/bitcoin/pull/6158#discussion_r32332821,32332821,src/netbase.cpp
jonasschnelli,2015-06-12T17:52:43Z,Good catch! Thanks for the review.\nFixed.\n,https://github.com/bitcoin/bitcoin/pull/6158#discussion_r32338196,32338196,src/netbase.cpp
