laanwj,2018-02-07T17:57:24Z,"If you have means to reproduce the underlying issue, what might also work is moving the shutdown detection to only start *after* the GUI side of the initialization. E.g. move\n```\n    pollShutdownTimer->start(200);\n```\nfrom `BitcoinApplication::createWindow` to `BitcoinApplication::initializeResult` (in the `if(success)`). This makes sure that no special action is undertaken if request shut",https://github.com/bitcoin/bitcoin/pull/12377#issuecomment-363854620,363854620,
meshcollider,2018-02-07T21:47:55Z,utACK https://github.com/bitcoin/bitcoin/pull/12377/commits/2222bf02c94a10387c318b295982719eb07b8d06,https://github.com/bitcoin/bitcoin/pull/12377#issuecomment-363921941,363921941,
MarcoFalke,2018-02-07T22:12:10Z,Changed to @laanwj suggestion,https://github.com/bitcoin/bitcoin/pull/12377#issuecomment-363928561,363928561,
laanwj,2018-02-08T07:51:12Z,utACK 2222bf0,https://github.com/bitcoin/bitcoin/pull/12377#issuecomment-364029611,364029611,
laanwj,2018-02-07T14:10:09Z,"I'm not convinced that this makes a difference at all. initialzeResult is emitted with the return value of `appInitMain`. The return value of `appInitMain` (""success"") is supposed to be false when shutdown was requested during initialization.",https://github.com/bitcoin/bitcoin/pull/12377#discussion_r166627236,166627236,src/qt/bitcoin.cpp
promag,2018-02-07T15:08:45Z,"It can make a difference if shutdown is requested between `AppInitMain()` returns and when this slot is executed, it's a QueuedConnection.",https://github.com/bitcoin/bitcoin/pull/12377#discussion_r166645923,166645923,src/qt/bitcoin.cpp
MarcoFalke,2018-02-07T15:10:23Z,"Maybe \n```diff\ndiff --git a/src/init.cpp b/src/init.cpp\nindex 50643ff96b..1f46e5e3d2 100644\n--- a/src/init.cpp\n+++ b/src/init.cpp\n@@ -1736,5 +1736,5 @@ bool AppInitMain()\n     StartWallets(scheduler);\n #endif\n \n-    return true;\n+    return !ShutdownRequested();\n }",https://github.com/bitcoin/bitcoin/pull/12377#discussion_r166646506,166646506,src/qt/bitcoin.cpp
promag,2018-02-07T15:19:00Z,"Indeed `AppInitMain()` return was changed recently in #11831, but I still think that is correct. IMO this change is also correct, it avoids initialization **but** the application should not crash without this change, so I don't agree it's a fix.",https://github.com/bitcoin/bitcoin/pull/12377#discussion_r166649434,166649434,src/qt/bitcoin.cpp
laanwj,2018-02-07T16:26:44Z,"> It can make a difference if shutdown is requested between AppInitMain() returns and when this slot is executed, it's a QueuedConnection.\n\nThen after AppInitMain was successfully executed, a shutdown was requested (but not yet acted on), so I don't understand why going into qt initialization would crash. It could successfully shutdown after that.\n\nBut anyhow if this fixes a reproducible i",https://github.com/bitcoin/bitcoin/pull/12377#discussion_r166672946,166672946,src/qt/bitcoin.cpp
promag,2018-02-07T16:39:30Z,"> so I don't understand why going into qt initialization would crash\n\nThat's why I think this doesn't fix the problem, just avoids it.",https://github.com/bitcoin/bitcoin/pull/12377#discussion_r166677263,166677263,src/qt/bitcoin.cpp
laanwj,2018-02-07T17:21:01Z,"That's good enough for rc3, though.",https://github.com/bitcoin/bitcoin/pull/12377#discussion_r166690834,166690834,src/qt/bitcoin.cpp
