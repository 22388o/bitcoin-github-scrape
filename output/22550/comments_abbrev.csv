laanwj,2021-07-26 05:37:59,Concept and tested ACK. All tests pass now. Fixes #22542.,https://github.com/bitcoin/bitcoin/pull/22550#issuecomment-886391830,886391830,
theStack,2021-07-26 13:28:53,"Force-pushed with the following changes:\n* fixed a logical flaw in the `generate_to_height`: instead of calling generate with at most 200 blocks, it was called with a _minimum_ of 200 blocks (changed max(...) to min(...) now)\n* using the test-framework `generate` helper instead of generatetoaddress RPC, also add an assert after, [as suggested by MarcoFalke](https://github.com/bitcoin/bitcoin/p",https://github.com/bitcoin/bitcoin/pull/22550#issuecomment-886704572,886704572,
theStack,2021-07-26 22:23:00,"Force-pushed again, taking [laanwj's suggestion](https://github.com/bitcoin/bitcoin/pull/22550#discussion_r676395527) of not calling the getblockcount() RPC in the generation loop into account -- I don't think this approach has any drawbacks. The block height is now only fetched twice: once at the start of the function to initialize the `current_height` variable, and another time at the end for th",https://github.com/bitcoin/bitcoin/pull/22550#issuecomment-887067752,887067752,
laanwj,2021-07-27 12:02:56,Code review and tested ACK 12f094ec215aacf30e4e380c0399f80d4e45c345,https://github.com/bitcoin/bitcoin/pull/22550#issuecomment-887453802,887453802,
DrahtBot,2021-07-27 12:46:42,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #22567 by MarcoFalke\n* #21862 by MarcoFalke\n\nIf you consider this pull request important, please also help to review th",https://github.com/bitcoin/bitcoin/pull/22550#issuecomment-887481800,887481800,
MarcoFalke,2021-07-26 08:06:36,"Could write shorter and add an assert?\n\n```suggestion\n        node.generate(nblocks)\n        current_height = node.getblockcount()\n    assert_equal(target_height, node.getblockcount())\n\n```",https://github.com/bitcoin/bitcoin/pull/22550#discussion_r676382135,676382135,test/functional/test_framework/util.py
laanwj,2021-07-26 08:25:47,"Couldn't we just as well remove the `getblockcount` within the loop, then assert afterward? e.g. is there any harm in asserting that nothing else is going to generate blocks behind our back?",https://github.com/bitcoin/bitcoin/pull/22550#discussion_r676395527,676395527,test/functional/test_framework/util.py
laanwj,2021-07-26 08:30:09,"No strong opinion but I think moving these constants to `blocktools` would make some sense; as `COINBASE_MATURITY` is already there, and all three tests using them already import from there.",https://github.com/bitcoin/bitcoin/pull/22550#discussion_r676398724,676398724,test/functional/rpc_signrawtransaction.py
theStack,2021-07-26 13:26:22,"Thanks, that seems like a good place to put them. Done.",https://github.com/bitcoin/bitcoin/pull/22550#discussion_r676601476,676601476,test/functional/rpc_signrawtransaction.py
theStack,2021-07-26 13:32:25,"@MarcoFalke: Thanks, done.\n@laanwj: If I understood you correctly, we'd have `current_height += nblocks` in the loop and call the `getblockcount` RPC only twice -- once before the loop to initialize current_height, and another time after the loop for the assertion, right? That sounds reasonable to me, will try that out later.",https://github.com/bitcoin/bitcoin/pull/22550#discussion_r676606557,676606557,test/functional/test_framework/util.py
laanwj,2021-07-27 12:02:23,"Clever idea. An additional sanity assertion could be that `length(result) == nblocks`, as it could get in an infinite loop if `generate` is broken and returns nothing.",https://github.com/bitcoin/bitcoin/pull/22550#discussion_r677382112,677382112,test/functional/test_framework/util.py
jonatack,2021-07-28 12:57:31,"It may have been nice to mention the related BIP numbers (65 `OP_CHECKLOCKTIMEVERIFY`, 112 `CHECKSEQUENCEVERIFY`) here.",https://github.com/bitcoin/bitcoin/pull/22550#discussion_r678275087,678275087,test/functional/test_framework/blocktools.py
