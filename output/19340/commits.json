[
  {
    "sha": "1f96be25b020a56afa330286ee4f241aa14d3983",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxZjk2YmUyNWIwMjBhNTZhZmEzMzAyODZlZTRmMjQxYWExNGQzOTgz",
    "commit": {
      "author": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2020-06-22T18:12:14Z"
      },
      "committer": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2020-08-02T13:42:33Z"
      },
      "message": "Preserve initial state if push_lock() throws exception",
      "tree": {
        "sha": "86f902b36990e429986069d31a2c6164ff615f34",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/86f902b36990e429986069d31a2c6164ff615f34"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1f96be25b020a56afa330286ee4f241aa14d3983",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE0dvyxLlvLev0wWZUQQEIES5+qB8FAl8mwskACgkQQQEIES5+\nqB/4ZQ//XxDkV2IbC8q5Fq3uOgeqhzIQps1RcyFyxjKlujA2gV0GVsRepUzR2DbP\n5t2xQPV1Q1Q1gJP1kKLYreQKof2JydzeHk2PVCmd0KrJSxTuP7YNCd6pnjlRWSrn\n2Sa79L1G48OASTXDwcdbfEHQ9pZN48irNNYoIaizdI30WwvNz3b04aktVQPbenn+\nUDzWDSH2cDc3eEP0ZG5yr3ykfg90BtspvsrMgdYNoF+oB8dwWI/3SCt06OwjE+jr\n4isdLCtxAn9AJ51zugeukFOCLjK6NlxYfup01jxesj2uGPmdkK4j9gsv1pv/BMtI\nIIgtnowOxSmPpwuBBu6LeQd1kNZEV5lnKrDSdid6X75zuQRJGg6kIOT4EKEyiQkb\n2BJ3528JBhj8BGvTm0PKQFbY7BJLMDVKrpGkRHNHV1R1Fjw0tVoQRHRMiuAsIkHa\ndrg54IbZvW1Iwdc5shWENi3su56jwRUycKERuRZjlhAQMGQBDsQjh389V4W7Ou6A\nipR2VXNV6KTSyEtycZCutPDsrXYG4wGoSWcytnK6zcOjeeMYIzhZCl/HIiyGBtIp\n+ZgDy9MnwTAgcNynCzXoOXq5TctC1jZeYET6Xzn6E+ex8SF5PLH8ztFSQf59YqEO\nrIf0RduZ54S5xAXmuu9QQmq5ozlZ1sHNYbFBe7hvqR3HPzRtbKk=\n=Eh7D\n-----END PGP SIGNATURE-----",
        "payload": "tree 86f902b36990e429986069d31a2c6164ff615f34\nparent a78742830aa35bf57bcb0a4730977a1e5a1876bc\nauthor Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1592849534 +0300\ncommitter Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1596375753 +0300\n\nPreserve initial state if push_lock() throws exception\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1f96be25b020a56afa330286ee4f241aa14d3983",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/1f96be25b020a56afa330286ee4f241aa14d3983",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1f96be25b020a56afa330286ee4f241aa14d3983/comments",
    "author": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "a78742830aa35bf57bcb0a4730977a1e5a1876bc",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a78742830aa35bf57bcb0a4730977a1e5a1876bc",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/a78742830aa35bf57bcb0a4730977a1e5a1876bc"
      }
    ],
    "stats": {
      "total": 11,
      "additions": 8,
      "deletions": 3
    },
    "files": [
      {
        "sha": "f72436530e1d8ddee9a0a252d95f44aae6c0517c",
        "filename": "src/sync.cpp",
        "status": "modified",
        "additions": 8,
        "deletions": 3,
        "changes": 11,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1f96be25b020a56afa330286ee4f241aa14d3983/src/sync.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1f96be25b020a56afa330286ee4f241aa14d3983/src/sync.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/sync.cpp?ref=1f96be25b020a56afa330286ee4f241aa14d3983",
        "patch": "@@ -149,12 +149,17 @@ static void push_lock(void* c, const CLockLocation& locklocation)\n         const LockPair p1 = std::make_pair(i.first, c);\n         if (lockdata.lockorders.count(p1))\n             continue;\n-        lockdata.lockorders.emplace(p1, lock_stack);\n \n         const LockPair p2 = std::make_pair(c, i.first);\n+        if (lockdata.lockorders.count(p2)) {\n+            auto lock_stack_copy = lock_stack;\n+            lock_stack.pop_back();\n+            potential_deadlock_detected(p1, lockdata.lockorders[p2], lock_stack_copy);\n+            // potential_deadlock_detected() does not return.\n+        }\n+\n+        lockdata.lockorders.emplace(p1, lock_stack);\n         lockdata.invlockorders.insert(p2);\n-        if (lockdata.lockorders.count(p2))\n-            potential_deadlock_detected(p1, lockdata.lockorders[p2], lockdata.lockorders[p1]);\n     }\n }\n "
      }
    ]
  },
  {
    "sha": "42b2a953735457cbf7b62a18b89811a66e573298",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0MmIyYTk1MzczNTQ1N2NiZjdiNjJhMThiODk4MTFhNjZlNTczMjk4",
    "commit": {
      "author": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2020-06-22T18:35:43Z"
      },
      "committer": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2020-08-02T13:42:39Z"
      },
      "message": "test: Repeat deadlock tests",
      "tree": {
        "sha": "3e03f63b6d3d6fdd1940e60f24137a84b8a0680a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3e03f63b6d3d6fdd1940e60f24137a84b8a0680a"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/42b2a953735457cbf7b62a18b89811a66e573298",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE0dvyxLlvLev0wWZUQQEIES5+qB8FAl8mws8ACgkQQQEIES5+\nqB/CyA/+McUipJm0DBSm1UCKQtMdJw7qb4Iw08gX97OgWRwN925duofz8+ddSNqf\noqHKKK8Zye1zlvttWmKC8c5ACp6IOw+ALBOy8O6PKz5+fQGdPBl4rnbiH00s0kGx\nQuXBcvKw4biY6teb8RpNX/L711ki8SKZ8utmeTo5LuzQCxkSyIP8ct1ME9K4m71T\nQW7g5USCpfjm7R0KICzHP9D1FmM32+gMu+ygO3mUZUXL2MEqhNOI2NCk2dXD0YY4\nNYqMkDdRGNo48Jne2j3u+pWMiuv35+N1FevZeQ1iC62Abw4G3AWiPEEJdLAEL3lT\nmfdx0NfaEAfE3rBcDOKDWUj9TzlrRlJZoG6tE698sbD3cKq2pZm2HLc4Y6ZNEN2w\nkNzM3WOWugZUfo3rDspts/csJzls0BIU1U4LT5G9uCuZt77XNP+quEZ9j0K4rVun\nv0en9AbJGs3ySLzHp/EMRhOzqCQmdH97JMQIBQG3kf4IDpGeo0QoNYxxotOcBPUV\n6uUXP4PhR6lEyA6AzwPGrcv59M+XgPzMiLbyJOamDj3rUsMqY36wPm0/KUF+VuDY\nimNnQKqfUhdyoDPIFFtSIKkBJP9rLfaO2kwKTf0M9qP91bjlt1WQO+y8XEQ9MPi4\n24YWLgrkiFkp5tvIt5FIlN+zuc0dL5oa+6hPfJo1xAXNoIc5GIg=\n=B9b/\n-----END PGP SIGNATURE-----",
        "payload": "tree 3e03f63b6d3d6fdd1940e60f24137a84b8a0680a\nparent 1f96be25b020a56afa330286ee4f241aa14d3983\nauthor Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1592850943 +0300\ncommitter Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1596375759 +0300\n\ntest: Repeat deadlock tests\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/42b2a953735457cbf7b62a18b89811a66e573298",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/42b2a953735457cbf7b62a18b89811a66e573298",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/42b2a953735457cbf7b62a18b89811a66e573298/comments",
    "author": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "1f96be25b020a56afa330286ee4f241aa14d3983",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1f96be25b020a56afa330286ee4f241aa14d3983",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/1f96be25b020a56afa330286ee4f241aa14d3983"
      }
    ],
    "stats": {
      "total": 4,
      "additions": 4,
      "deletions": 0
    },
    "files": [
      {
        "sha": "36f9c9bce3d5589241f89fe055615ba7968e05e6",
        "filename": "src/test/sync_tests.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 0,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/42b2a953735457cbf7b62a18b89811a66e573298/src/test/sync_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/42b2a953735457cbf7b62a18b89811a66e573298/src/test/sync_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/sync_tests.cpp?ref=42b2a953735457cbf7b62a18b89811a66e573298",
        "patch": "@@ -40,9 +40,13 @@ BOOST_AUTO_TEST_CASE(potential_deadlock_detected)\n \n     RecursiveMutex rmutex1, rmutex2;\n     TestPotentialDeadLockDetected(rmutex1, rmutex2);\n+    // The second test ensures that lock tracking data have not been broken by exception.\n+    TestPotentialDeadLockDetected(rmutex1, rmutex2);\n \n     Mutex mutex1, mutex2;\n     TestPotentialDeadLockDetected(mutex1, mutex2);\n+    // The second test ensures that lock tracking data have not been broken by exception.\n+    TestPotentialDeadLockDetected(mutex1, mutex2);\n \n     #ifdef DEBUG_LOCKORDER\n     g_debug_lockorder_abort = prev;"
      }
    ]
  },
  {
    "sha": "63e9e40b73507b0c9361fc8728d4e97fd72c9ec9",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2M2U5ZTQwYjczNTA3YjBjOTM2MWZjODcyOGQ0ZTk3ZmQ3MmM5ZWM5",
    "commit": {
      "author": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2020-06-20T20:00:52Z"
      },
      "committer": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2020-08-02T13:42:39Z"
      },
      "message": "test: Add LockStackEmpty()",
      "tree": {
        "sha": "681300eb961c2cbfb2a82a8d026ad5c04e07f792",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/681300eb961c2cbfb2a82a8d026ad5c04e07f792"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/63e9e40b73507b0c9361fc8728d4e97fd72c9ec9",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE0dvyxLlvLev0wWZUQQEIES5+qB8FAl8mws8ACgkQQQEIES5+\nqB9Ndg//WCKYrck9xhh/kCOrlMXEpCPJN2NzAxfDKOH4rEIN4U81MDdnqZN7NPFl\nW+SgdIe6GmX84Wc2E92EeZXuY89+w7t3MWG5lTPpsVtvL18y1jktTiwRzpUf9Vkm\neocyaNjr7IpRgrNDQgytG4hWj66d/o0tl9HybV10lZyTZIR8lEbyBu7ykukdQPTi\ngN3C1rAiGMj/cVKLAgVrqnVppOKv8N7VZ5uYXG2d0T7AAmpHyPcZQREX7ReZp8uL\n72Lr+887llv8FJg26Z+UY1qRvnoch9cYQ0YDHwTWPhl1Dwz7H9e1ZHAR3XyAogld\nH5LUoqXOxaKxKSBiDBECdUL0SL+d6Qm1OMdJ7bm8CFLKLHxRVlwW8/K0rPVXT4vU\nYpH7aV/i0kyKebQbpTCe5N7AQxujPIr3RY5JN7DC1eaOKwTxU9n6ThijLc4UQOIP\ngHhHCrKRyd6uoMABQKkA4spw9f5RKyRAeUT3B0Hq5k8AhzmEsxdnOSRVTcQVNupz\nou+Lkx/MmMQi2HMj1nUX2Hoqed9vPGBhABv9wcHg1JWYvBZTRexld232veNcYmvK\nsSoVO2do/KNnostlqu60IuxGEZwXP+9RSI+2G7ElypKsIWQuQ6/bQ/56nBO7BU23\nprJ0q1lG8oVHo01PETf8MjJAA0ONdyNqjCfTDW+qg96+ZyBSF3Y=\n=qHgk\n-----END PGP SIGNATURE-----",
        "payload": "tree 681300eb961c2cbfb2a82a8d026ad5c04e07f792\nparent 42b2a953735457cbf7b62a18b89811a66e573298\nauthor Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1592683252 +0300\ncommitter Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1596375759 +0300\n\ntest: Add LockStackEmpty()\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/63e9e40b73507b0c9361fc8728d4e97fd72c9ec9",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/63e9e40b73507b0c9361fc8728d4e97fd72c9ec9",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/63e9e40b73507b0c9361fc8728d4e97fd72c9ec9/comments",
    "author": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "42b2a953735457cbf7b62a18b89811a66e573298",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/42b2a953735457cbf7b62a18b89811a66e573298",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/42b2a953735457cbf7b62a18b89811a66e573298"
      }
    ],
    "stats": {
      "total": 27,
      "additions": 21,
      "deletions": 6
    },
    "files": [
      {
        "sha": "4be13a3c48ac2d0fea436503276864689db7f44a",
        "filename": "src/sync.cpp",
        "status": "modified",
        "additions": 11,
        "deletions": 0,
        "changes": 11,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/63e9e40b73507b0c9361fc8728d4e97fd72c9ec9/src/sync.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/63e9e40b73507b0c9361fc8728d4e97fd72c9ec9/src/sync.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/sync.cpp?ref=63e9e40b73507b0c9361fc8728d4e97fd72c9ec9",
        "patch": "@@ -264,6 +264,17 @@ void DeleteLock(void* cs)\n     }\n }\n \n+bool LockStackEmpty()\n+{\n+    LockData& lockdata = GetLockData();\n+    std::lock_guard<std::mutex> lock(lockdata.dd_mutex);\n+    const auto it = lockdata.m_lock_stacks.find(std::this_thread::get_id());\n+    if (it == lockdata.m_lock_stacks.end()) {\n+        return true;\n+    }\n+    return it->second.empty();\n+}\n+\n bool g_debug_lockorder_abort = true;\n \n #endif /* DEBUG_LOCKORDER */"
      },
      {
        "sha": "05ff2ee8a9ce71dc24e8817fbafcfc25582b6fae",
        "filename": "src/sync.h",
        "status": "modified",
        "additions": 8,
        "deletions": 6,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/63e9e40b73507b0c9361fc8728d4e97fd72c9ec9/src/sync.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/63e9e40b73507b0c9361fc8728d4e97fd72c9ec9/src/sync.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/sync.h?ref=63e9e40b73507b0c9361fc8728d4e97fd72c9ec9",
        "patch": "@@ -56,6 +56,7 @@ template <typename MutexType>\n void AssertLockHeldInternal(const char* pszName, const char* pszFile, int nLine, MutexType* cs) ASSERT_EXCLUSIVE_LOCK(cs);\n void AssertLockNotHeldInternal(const char* pszName, const char* pszFile, int nLine, void* cs);\n void DeleteLock(void* cs);\n+bool LockStackEmpty();\n \n /**\n  * Call abort() if a potential lock order deadlock bug is detected, instead of\n@@ -64,13 +65,14 @@ void DeleteLock(void* cs);\n  */\n extern bool g_debug_lockorder_abort;\n #else\n-void static inline EnterCritical(const char* pszName, const char* pszFile, int nLine, void* cs, bool fTry = false) {}\n-void static inline LeaveCritical() {}\n-void static inline CheckLastCritical(void* cs, std::string& lockname, const char* guardname, const char* file, int line) {}\n+inline void EnterCritical(const char* pszName, const char* pszFile, int nLine, void* cs, bool fTry = false) {}\n+inline void LeaveCritical() {}\n+inline void CheckLastCritical(void* cs, std::string& lockname, const char* guardname, const char* file, int line) {}\n template <typename MutexType>\n-void static inline AssertLockHeldInternal(const char* pszName, const char* pszFile, int nLine, MutexType* cs) ASSERT_EXCLUSIVE_LOCK(cs) {}\n-void static inline AssertLockNotHeldInternal(const char* pszName, const char* pszFile, int nLine, void* cs) {}\n-void static inline DeleteLock(void* cs) {}\n+inline void AssertLockHeldInternal(const char* pszName, const char* pszFile, int nLine, MutexType* cs) ASSERT_EXCLUSIVE_LOCK(cs) {}\n+inline void AssertLockNotHeldInternal(const char* pszName, const char* pszFile, int nLine, void* cs) {}\n+inline void DeleteLock(void* cs) {}\n+inline bool LockStackEmpty() { return true; }\n #endif\n #define AssertLockHeld(cs) AssertLockHeldInternal(#cs, __FILE__, __LINE__, &cs)\n #define AssertLockNotHeld(cs) AssertLockNotHeldInternal(#cs, __FILE__, __LINE__, &cs)"
      },
      {
        "sha": "19029ebd3c7e24522c54f94cf15cd680e7347aa1",
        "filename": "src/test/sync_tests.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/63e9e40b73507b0c9361fc8728d4e97fd72c9ec9/src/test/sync_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/63e9e40b73507b0c9361fc8728d4e97fd72c9ec9/src/test/sync_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/sync_tests.cpp?ref=63e9e40b73507b0c9361fc8728d4e97fd72c9ec9",
        "patch": "@@ -14,13 +14,15 @@ void TestPotentialDeadLockDetected(MutexType& mutex1, MutexType& mutex2)\n     {\n         LOCK2(mutex1, mutex2);\n     }\n+    BOOST_CHECK(LockStackEmpty());\n     bool error_thrown = false;\n     try {\n         LOCK2(mutex2, mutex1);\n     } catch (const std::logic_error& e) {\n         BOOST_CHECK_EQUAL(e.what(), \"potential deadlock detected: mutex1 -> mutex2 -> mutex1\");\n         error_thrown = true;\n     }\n+    BOOST_CHECK(LockStackEmpty());\n     #ifdef DEBUG_LOCKORDER\n     BOOST_CHECK(error_thrown);\n     #else"
      }
    ]
  }
]