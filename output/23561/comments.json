[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/974790491",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-974790491",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561",
    "id": 974790491,
    "node_id": "IC_kwDOABII5846Gh9b",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-21T10:27:18Z",
    "updated_at": "2021-11-26T08:54:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#23432](https://github.com/bitcoin/bitcoin/pull/23432) (BIP324: CPubKey encode/decode to elligator-squared by dhruv)\n* [#23233](https://github.com/bitcoin/bitcoin/pull/23233) (BIP324: Add encrypted p2p transport {de}serializer by dhruv)\n* [#20196](https://github.com/bitcoin/bitcoin/pull/20196) (net: fix GetListenPort() to derive the proper port by vasild)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/974790491/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/975194275",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-975194275",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561",
    "id": 975194275,
    "node_id": "IC_kwDOABII5846IEij",
    "user": {
      "login": "naumenkogs",
      "id": 7975071,
      "node_id": "MDQ6VXNlcjc5NzUwNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7975071?u=06eb9ae4f9b3f954056098860decccbf1340e40f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/naumenkogs",
      "html_url": "https://github.com/naumenkogs",
      "followers_url": "https://api.github.com/users/naumenkogs/followers",
      "following_url": "https://api.github.com/users/naumenkogs/following{/other_user}",
      "gists_url": "https://api.github.com/users/naumenkogs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/naumenkogs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/naumenkogs/subscriptions",
      "organizations_url": "https://api.github.com/users/naumenkogs/orgs",
      "repos_url": "https://api.github.com/users/naumenkogs/repos",
      "events_url": "https://api.github.com/users/naumenkogs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/naumenkogs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-22T07:14:31Z",
    "updated_at": "2021-11-22T07:14:31Z",
    "author_association": "MEMBER",
    "body": "Concept ACK.\r\nMoving forward with BIP324 is a good idea, and this code seems to not have any negative/unexpected side-effects.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/975194275/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/979455585",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#issuecomment-979455585",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23561",
    "id": 979455585,
    "node_id": "IC_kwDOABII5846YU5h",
    "user": {
      "login": "dhruv",
      "id": 856960,
      "node_id": "MDQ6VXNlcjg1Njk2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/856960?u=65406da0f40524c00b8b647f916d31cbbb449edb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dhruv",
      "html_url": "https://github.com/dhruv",
      "followers_url": "https://api.github.com/users/dhruv/followers",
      "following_url": "https://api.github.com/users/dhruv/following{/other_user}",
      "gists_url": "https://api.github.com/users/dhruv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
      "organizations_url": "https://api.github.com/users/dhruv/orgs",
      "repos_url": "https://api.github.com/users/dhruv/repos",
      "events_url": "https://api.github.com/users/dhruv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dhruv/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-25T20:25:45Z",
    "updated_at": "2021-11-25T20:25:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "Addressed review comments from @sipa. Ready for further review.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/979455585/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755498657",
    "pull_request_review_id": 814167558,
    "id": 755498657,
    "node_id": "PRRC_kwDOABII584tB_6h",
    "diff_hunk": "@@ -332,6 +333,23 @@ bool CKey::Derive(CKey& keyChild, ChainCode &ccChild, unsigned int nChild, const\n     return ret;\n }\n \n+std::optional<ECDHSecret> CKey::ComputeECDHSecret(const CPubKey& pubkey) const\n+{\n+    secp256k1_pubkey pubkey_internal;\n+    if (!secp256k1_ec_pubkey_parse(secp256k1_context_sign, &pubkey_internal, pubkey.data(), pubkey.size())) {\n+        return {};\n+    }\n+\n+    ECDHSecret secret;\n+    secret.resize(ECDH_SECRET_SIZE);\n+\n+    if (secp256k1_ecdh(secp256k1_context_sign, secret.data(), &pubkey_internal,",
    "path": "src/key.cpp",
    "position": null,
    "original_position": 22,
    "commit_id": "00142e1cf85995c15e1990005240ebc9725773e4",
    "original_commit_id": "2d58b293461c0b8890ce82eb5683c06ff805b85e",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The case of secp256k1_ecdh returning 0 corresponds to invalid input. That won't happen here; I think you can assert instead and avoid the `std::optional` in the return type.",
    "created_at": "2021-11-23T20:58:40Z",
    "updated_at": "2021-11-23T21:19:59Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755498657",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755498657"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755498657"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755498657/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 346,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755500261",
    "pull_request_review_id": 814167558,
    "id": 755500261,
    "node_id": "PRRC_kwDOABII584tCATl",
    "diff_hunk": "@@ -305,4 +305,20 @@ FUZZ_TARGET_INIT(key, initialize_key)\n             assert(key == loaded_key);\n         }\n     }\n+\n+    {\n+        // Test ECDH computation with another key",
    "path": "src/test/fuzz/key.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "00142e1cf85995c15e1990005240ebc9725773e4",
    "original_commit_id": "042f771e16f887b1364291bb05b9da9d74c9f45c",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "You could do a much stronger test: take two private keys as input fuzz data, compute the corresponding public keys, and compute the ecdh secrets from (sec1,pub2) and (sec2,pub1), and check that they match.\r\n\r\nIt's cryptographic data (hashes and EC operations), so this is very unlikely to actually uncover any bugs unless they're very apparent, but this way the fuzz test actually verifies the full behavior we desire from these functions.",
    "created_at": "2021-11-23T21:01:18Z",
    "updated_at": "2021-11-23T21:19:59Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755500261",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755500261"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755500261"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755500261/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 310,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755501124",
    "pull_request_review_id": 814167558,
    "id": 755501124,
    "node_id": "PRRC_kwDOABII584tCAhE",
    "diff_hunk": "@@ -0,0 +1,32 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_UTIL_BIP324_H\n+#define BITCOIN_UTIL_BIP324_H\n+\n+#include <key.h>\n+#include <span.h>\n+\n+#include <array>\n+\n+constexpr size_t BIP324_KEY_LEN = 32;\n+\n+class BIP324Keys\n+{\n+public:\n+    std::array<uint8_t, BIP324_KEY_LEN> initiator_F; // k1a\n+    std::array<uint8_t, BIP324_KEY_LEN> initiator_V; // k2a\n+    std::array<uint8_t, BIP324_KEY_LEN> responder_F; // k1b\n+    std::array<uint8_t, BIP324_KEY_LEN> responder_V; // k2b\n+    std::array<uint8_t, BIP324_KEY_LEN> session_id;\n+\n+    // Takes ownership of the ECDH secret and wipes the ephemeral secret once\n+    // the derivation is complete.\n+    explicit BIP324Keys(ECDHSecret&& ecdh_secret, const Span<uint8_t>& initiator_hdata, const Span<uint8_t>& responder_hdata);",
    "path": "src/util/bip324.h",
    "position": null,
    "original_position": 26,
    "commit_id": "00142e1cf85995c15e1990005240ebc9725773e4",
    "original_commit_id": "8d09fb5cc213011f59b7abadb0db7cc7a2abb046",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Nit: pass Spans by value.",
    "created_at": "2021-11-23T21:02:47Z",
    "updated_at": "2021-11-23T21:19:59Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755501124",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755501124"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755501124"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755501124/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 26,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755505318",
    "pull_request_review_id": 814167558,
    "id": 755505318,
    "node_id": "PRRC_kwDOABII584tCBim",
    "diff_hunk": "@@ -0,0 +1,36 @@\n+// Copyright (c) 2021 The Bitcoin Core developers",
    "path": "src/util/bip324.cpp",
    "position": null,
    "original_position": 1,
    "commit_id": "00142e1cf85995c15e1990005240ebc9725773e4",
    "original_commit_id": "8d09fb5cc213011f59b7abadb0db7cc7a2abb046",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I'm not sure this belongs in util, it seems pretty specific to Bitcoin.",
    "created_at": "2021-11-23T21:10:08Z",
    "updated_at": "2021-11-23T21:19:59Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755505318",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755505318"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755505318"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755505318/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755510650",
    "pull_request_review_id": 814167558,
    "id": 755510650,
    "node_id": "PRRC_kwDOABII584tCC16",
    "diff_hunk": "@@ -0,0 +1,32 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_UTIL_BIP324_H\n+#define BITCOIN_UTIL_BIP324_H\n+\n+#include <key.h>\n+#include <span.h>\n+\n+#include <array>\n+\n+constexpr size_t BIP324_KEY_LEN = 32;\n+\n+class BIP324Keys",
    "path": "src/util/bip324.h",
    "position": null,
    "original_position": 15,
    "commit_id": "00142e1cf85995c15e1990005240ebc9725773e4",
    "original_commit_id": "8d09fb5cc213011f59b7abadb0db7cc7a2abb046",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Not sure if a class for this is desirable in the first place. These keys shouldn't be long-lived in any case (they're only used to initialize the stream ciphers, and then destroyed). That can just as well be done with a simple function call?",
    "created_at": "2021-11-23T21:19:41Z",
    "updated_at": "2021-11-23T21:19:59Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755510650",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755510650"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r755510650"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/755510650/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 15,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757114972",
    "pull_request_review_id": 816282146,
    "id": 757114972,
    "node_id": "PRRC_kwDOABII584tIKhc",
    "diff_hunk": "@@ -332,6 +333,23 @@ bool CKey::Derive(CKey& keyChild, ChainCode &ccChild, unsigned int nChild, const\n     return ret;\n }\n \n+std::optional<ECDHSecret> CKey::ComputeECDHSecret(const CPubKey& pubkey) const\n+{\n+    secp256k1_pubkey pubkey_internal;\n+    if (!secp256k1_ec_pubkey_parse(secp256k1_context_sign, &pubkey_internal, pubkey.data(), pubkey.size())) {\n+        return {};\n+    }\n+\n+    ECDHSecret secret;\n+    secret.resize(ECDH_SECRET_SIZE);\n+\n+    if (secp256k1_ecdh(secp256k1_context_sign, secret.data(), &pubkey_internal,",
    "path": "src/key.cpp",
    "position": null,
    "original_position": 22,
    "commit_id": "00142e1cf85995c15e1990005240ebc9725773e4",
    "original_commit_id": "2d58b293461c0b8890ce82eb5683c06ff805b85e",
    "user": {
      "login": "dhruv",
      "id": 856960,
      "node_id": "MDQ6VXNlcjg1Njk2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dhruv",
      "html_url": "https://github.com/dhruv",
      "followers_url": "https://api.github.com/users/dhruv/followers",
      "following_url": "https://api.github.com/users/dhruv/following{/other_user}",
      "gists_url": "https://api.github.com/users/dhruv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
      "organizations_url": "https://api.github.com/users/dhruv/orgs",
      "repos_url": "https://api.github.com/users/dhruv/repos",
      "events_url": "https://api.github.com/users/dhruv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dhruv/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done - still needed a boolean return value due to the other failure case above.",
    "created_at": "2021-11-25T20:24:19Z",
    "updated_at": "2021-11-25T20:24:19Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757114972",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757114972"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757114972"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757114972/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 346,
    "side": "RIGHT",
    "in_reply_to_id": 755498657
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757114984",
    "pull_request_review_id": 816282165,
    "id": 757114984,
    "node_id": "PRRC_kwDOABII584tIKho",
    "diff_hunk": "@@ -305,4 +305,20 @@ FUZZ_TARGET_INIT(key, initialize_key)\n             assert(key == loaded_key);\n         }\n     }\n+\n+    {\n+        // Test ECDH computation with another key",
    "path": "src/test/fuzz/key.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "00142e1cf85995c15e1990005240ebc9725773e4",
    "original_commit_id": "042f771e16f887b1364291bb05b9da9d74c9f45c",
    "user": {
      "login": "dhruv",
      "id": 856960,
      "node_id": "MDQ6VXNlcjg1Njk2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dhruv",
      "html_url": "https://github.com/dhruv",
      "followers_url": "https://api.github.com/users/dhruv/followers",
      "following_url": "https://api.github.com/users/dhruv/following{/other_user}",
      "gists_url": "https://api.github.com/users/dhruv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
      "organizations_url": "https://api.github.com/users/dhruv/orgs",
      "repos_url": "https://api.github.com/users/dhruv/repos",
      "events_url": "https://api.github.com/users/dhruv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dhruv/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done!",
    "created_at": "2021-11-25T20:24:23Z",
    "updated_at": "2021-11-25T20:24:23Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757114984",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757114984"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757114984"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757114984/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 310,
    "side": "RIGHT",
    "in_reply_to_id": 755500261
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115000",
    "pull_request_review_id": 816282189,
    "id": 757115000,
    "node_id": "PRRC_kwDOABII584tIKh4",
    "diff_hunk": "@@ -0,0 +1,32 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_UTIL_BIP324_H\n+#define BITCOIN_UTIL_BIP324_H\n+\n+#include <key.h>\n+#include <span.h>\n+\n+#include <array>\n+\n+constexpr size_t BIP324_KEY_LEN = 32;\n+\n+class BIP324Keys\n+{\n+public:\n+    std::array<uint8_t, BIP324_KEY_LEN> initiator_F; // k1a\n+    std::array<uint8_t, BIP324_KEY_LEN> initiator_V; // k2a\n+    std::array<uint8_t, BIP324_KEY_LEN> responder_F; // k1b\n+    std::array<uint8_t, BIP324_KEY_LEN> responder_V; // k2b\n+    std::array<uint8_t, BIP324_KEY_LEN> session_id;\n+\n+    // Takes ownership of the ECDH secret and wipes the ephemeral secret once\n+    // the derivation is complete.\n+    explicit BIP324Keys(ECDHSecret&& ecdh_secret, const Span<uint8_t>& initiator_hdata, const Span<uint8_t>& responder_hdata);",
    "path": "src/util/bip324.h",
    "position": null,
    "original_position": 26,
    "commit_id": "00142e1cf85995c15e1990005240ebc9725773e4",
    "original_commit_id": "8d09fb5cc213011f59b7abadb0db7cc7a2abb046",
    "user": {
      "login": "dhruv",
      "id": 856960,
      "node_id": "MDQ6VXNlcjg1Njk2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dhruv",
      "html_url": "https://github.com/dhruv",
      "followers_url": "https://api.github.com/users/dhruv/followers",
      "following_url": "https://api.github.com/users/dhruv/following{/other_user}",
      "gists_url": "https://api.github.com/users/dhruv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
      "organizations_url": "https://api.github.com/users/dhruv/orgs",
      "repos_url": "https://api.github.com/users/dhruv/repos",
      "events_url": "https://api.github.com/users/dhruv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dhruv/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2021-11-25T20:24:26Z",
    "updated_at": "2021-11-25T20:24:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757115000",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115000"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757115000"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115000/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 26,
    "side": "RIGHT",
    "in_reply_to_id": 755501124
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115010",
    "pull_request_review_id": 816282205,
    "id": 757115010,
    "node_id": "PRRC_kwDOABII584tIKiC",
    "diff_hunk": "@@ -0,0 +1,36 @@\n+// Copyright (c) 2021 The Bitcoin Core developers",
    "path": "src/util/bip324.cpp",
    "position": null,
    "original_position": 1,
    "commit_id": "00142e1cf85995c15e1990005240ebc9725773e4",
    "original_commit_id": "8d09fb5cc213011f59b7abadb0db7cc7a2abb046",
    "user": {
      "login": "dhruv",
      "id": 856960,
      "node_id": "MDQ6VXNlcjg1Njk2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dhruv",
      "html_url": "https://github.com/dhruv",
      "followers_url": "https://api.github.com/users/dhruv/followers",
      "following_url": "https://api.github.com/users/dhruv/following{/other_user}",
      "gists_url": "https://api.github.com/users/dhruv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
      "organizations_url": "https://api.github.com/users/dhruv/orgs",
      "repos_url": "https://api.github.com/users/dhruv/repos",
      "events_url": "https://api.github.com/users/dhruv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dhruv/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I moved this into `net.{h|cpp}` as that's where it will be used. I didn't particularly want to increase the length of those files, so please let me know if the right thing to do is to have it in `src/bip324.{h|cpp}`",
    "created_at": "2021-11-25T20:24:30Z",
    "updated_at": "2021-11-25T20:24:30Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757115010",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115010"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757115010"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115010/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1,
    "side": "RIGHT",
    "in_reply_to_id": 755505318
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115092",
    "pull_request_review_id": 816282312,
    "id": 757115092,
    "node_id": "PRRC_kwDOABII584tIKjU",
    "diff_hunk": "@@ -0,0 +1,32 @@\n+// Copyright (c) 2021 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_UTIL_BIP324_H\n+#define BITCOIN_UTIL_BIP324_H\n+\n+#include <key.h>\n+#include <span.h>\n+\n+#include <array>\n+\n+constexpr size_t BIP324_KEY_LEN = 32;\n+\n+class BIP324Keys",
    "path": "src/util/bip324.h",
    "position": null,
    "original_position": 15,
    "commit_id": "00142e1cf85995c15e1990005240ebc9725773e4",
    "original_commit_id": "8d09fb5cc213011f59b7abadb0db7cc7a2abb046",
    "user": {
      "login": "dhruv",
      "id": 856960,
      "node_id": "MDQ6VXNlcjg1Njk2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/856960?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dhruv",
      "html_url": "https://github.com/dhruv",
      "followers_url": "https://api.github.com/users/dhruv/followers",
      "following_url": "https://api.github.com/users/dhruv/following{/other_user}",
      "gists_url": "https://api.github.com/users/dhruv/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dhruv/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dhruv/subscriptions",
      "organizations_url": "https://api.github.com/users/dhruv/orgs",
      "repos_url": "https://api.github.com/users/dhruv/repos",
      "events_url": "https://api.github.com/users/dhruv/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dhruv/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done.",
    "created_at": "2021-11-25T20:24:44Z",
    "updated_at": "2021-11-25T20:24:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757115092",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115092"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23561#discussion_r757115092"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23561"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/757115092/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 15,
    "side": "RIGHT",
    "in_reply_to_id": 755510650
  }
]