[
  {
    "sha": "b9e8f01842113776dd41f70dc0f8b4b34676a66b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiOWU4ZjAxODQyMTEzNzc2ZGQ0MWY3MGRjMGY4YjRiMzQ2NzZhNjZi",
    "commit": {
      "author": {
        "name": "Douglas Roark",
        "email": "joroark@vt.edu",
        "date": "2018-06-28T09:04:19Z"
      },
      "committer": {
        "name": "Douglas Roark",
        "email": "joroark@vt.edu",
        "date": "2018-10-09T08:04:51Z"
      },
      "message": "Remove unnecessary image buffer for Mac dock icon\n\nThe code curently writes the Mac dock icon to a buffer and then sets the final image data from the buffer. This was presumably done to satisfy Qt 4. Now that Qt 5 is mandatory, remove the buffer and write the data directly to the image.\n\nNote that this patch will force the bitcoin-qt binary to have a minimum of Qt 5.2 on Macs due to usage of QtMacExtras (https://wiki.qt.io/New_Features_in_Qt_5.2). While this needs to be discussed before accepting the patch, Qt 5.2 is almost five years old. It's arguable that a Mac with Qt 5 but staying below 5.2 is an improbable corner case.",
      "tree": {
        "sha": "01c496b0533ff61813e2ab952413146d30c6edac",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/01c496b0533ff61813e2ab952413146d30c6edac"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b9e8f01842113776dd41f70dc0f8b4b34676a66b",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQIzBAABCgAdFiEEbTFwwdwsb9Cu68pnQ4EdGiZiOSQFAlu8YSMACgkQQ4EdGiZi\nOSQAiQ//fmxxg69nZMinZQn1jcWWCNatbreYZjfzNuCC9gE8yttE9txbNyVsXobZ\nFBtq76tmChOfdcDzGHiE74WA9jLHStAvyU8gtc6S2nxnNIgmvRcQAW9IZx3FLUP1\n1YS+gPPr+22HWu959ow8tZHm35iDgwQffvYXp7hgBMqpRkwQOnwT/bU0dWSHxjBS\nR0s/znEBGxArxUdKJ2hxKHfW+3OKd5nVkGcswJ8FSlmBhyNs0Ua3KYuGTFJ27qI/\nF86BXPR8FXjkJkbSD8QG2HhTl5KMMOOxRfWNoLKDCaaa5CvifpGghozOa9AjG8nL\nL/bFNw6QuEvjqsPoa52QOrEV+gIeWaW1ppJHgpm9DiuLot1crTi/iLiZfijkf19u\nsBtYdtOTreXIgj2flWtLuWnxQfvaNVkvjEeBaarGwOWEqKvWZl5e1zHMSOhq6KJo\nE/9aeJjljmF9Iw/PPfGxKmiEwjCfnPiYOjkHx6AhCPJlLGobxY0uyLmdkOTcf6I3\n3RT3v5egUXnHkaFnL+MsabS1x3942GSOMXCX9MEcWsHOuNruK/Hh/Mp8nStwTJus\nvl2/XwkD4JO98xDlBs1J/Szbt6yWXqerTdhFlwufO1yan3ds5MplPyXlaWZd1kn5\npXQtk3RnlVQMqWk3D66s9Lvmq29/RfaNiK8craLwANBqBo2Th3Y=\n=5bjC\n-----END PGP SIGNATURE-----",
        "payload": "tree 01c496b0533ff61813e2ab952413146d30c6edac\nparent 1d1417430c829a0c21bf5a2fe4a5b2f592a9423f\nauthor Douglas Roark <joroark@vt.edu> 1530176659 -0700\ncommitter Douglas Roark <joroark@vt.edu> 1539072291 -0700\n\nRemove unnecessary image buffer for Mac dock icon\n\nThe code curently writes the Mac dock icon to a buffer and then sets the final image data from the buffer. This was presumably done to satisfy Qt 4. Now that Qt 5 is mandatory, remove the buffer and write the data directly to the image.\n\nNote that this patch will force the bitcoin-qt binary to have a minimum of Qt 5.2 on Macs due to usage of QtMacExtras (https://wiki.qt.io/New_Features_in_Qt_5.2). While this needs to be discussed before accepting the patch, Qt 5.2 is almost five years old. It's arguable that a Mac with Qt 5 but staying below 5.2 is an improbable corner case.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b9e8f01842113776dd41f70dc0f8b4b34676a66b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/b9e8f01842113776dd41f70dc0f8b4b34676a66b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b9e8f01842113776dd41f70dc0f8b4b34676a66b/comments",
    "author": {
      "login": "droark",
      "id": 5931802,
      "node_id": "MDQ6VXNlcjU5MzE4MDI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5931802?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/droark",
      "html_url": "https://github.com/droark",
      "followers_url": "https://api.github.com/users/droark/followers",
      "following_url": "https://api.github.com/users/droark/following{/other_user}",
      "gists_url": "https://api.github.com/users/droark/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/droark/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/droark/subscriptions",
      "organizations_url": "https://api.github.com/users/droark/orgs",
      "repos_url": "https://api.github.com/users/droark/repos",
      "events_url": "https://api.github.com/users/droark/events{/privacy}",
      "received_events_url": "https://api.github.com/users/droark/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "droark",
      "id": 5931802,
      "node_id": "MDQ6VXNlcjU5MzE4MDI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5931802?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/droark",
      "html_url": "https://github.com/droark",
      "followers_url": "https://api.github.com/users/droark/followers",
      "following_url": "https://api.github.com/users/droark/following{/other_user}",
      "gists_url": "https://api.github.com/users/droark/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/droark/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/droark/subscriptions",
      "organizations_url": "https://api.github.com/users/droark/orgs",
      "repos_url": "https://api.github.com/users/droark/repos",
      "events_url": "https://api.github.com/users/droark/events{/privacy}",
      "received_events_url": "https://api.github.com/users/droark/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "1d1417430c829a0c21bf5a2fe4a5b2f592a9423f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1d1417430c829a0c21bf5a2fe4a5b2f592a9423f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/1d1417430c829a0c21bf5a2fe4a5b2f592a9423f"
      }
    ],
    "stats": {
      "total": 17,
      "additions": 5,
      "deletions": 12
    },
    "files": [
      {
        "sha": "4802150d415bd608604d0978d313a4987ba0d707",
        "filename": "build-aux/m4/bitcoin_qt.m4",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b9e8f01842113776dd41f70dc0f8b4b34676a66b/build-aux/m4/bitcoin_qt.m4",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b9e8f01842113776dd41f70dc0f8b4b34676a66b/build-aux/m4/bitcoin_qt.m4",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/build-aux/m4/bitcoin_qt.m4?ref=b9e8f01842113776dd41f70dc0f8b4b34676a66b",
        "patch": "@@ -429,6 +429,9 @@ AC_DEFUN([_BITCOIN_QT_FIND_LIBS_WITH_PKGCONFIG],[\n   m4_ifdef([PKG_CHECK_MODULES],[\n     QT_LIB_PREFIX=Qt5\n     qt5_modules=\"Qt5Core Qt5Gui Qt5Network Qt5Widgets\"\n+    if test \"x$TARGET_OS\" = xdarwin; then\n+      qt5_modules=\"$qt5_modules Qt5MacExtras\"\n+    fi\n     BITCOIN_QT_CHECK([\n       PKG_CHECK_MODULES([QT5], [$qt5_modules], [QT_INCLUDES=\"$QT5_CFLAGS\"; QT_LIBS=\"$QT5_LIBS\" have_qt=yes],[have_qt=no])\n "
      },
      {
        "sha": "a2244637504085d89b63d43029185fdd4c4ebba9",
        "filename": "src/qt/macdockiconhandler.mm",
        "status": "modified",
        "additions": 2,
        "deletions": 12,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b9e8f01842113776dd41f70dc0f8b4b34676a66b/src/qt/macdockiconhandler.mm",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b9e8f01842113776dd41f70dc0f8b4b34676a66b/src/qt/macdockiconhandler.mm",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/macdockiconhandler.mm?ref=b9e8f01842113776dd41f70dc0f8b4b34676a66b",
        "patch": "@@ -8,6 +8,7 @@\n #include <QMenu>\n #include <QBuffer>\n #include <QWidget>\n+#include <QtMac>\n \n #undef slots\n #include <Cocoa/Cocoa.h>\n@@ -80,18 +81,7 @@ void setupDockClickHandler() {\n     else {\n         // generate NSImage from QIcon and use this as dock icon.\n         QSize size = icon.actualSize(QSize(128, 128));\n-        QPixmap pixmap = icon.pixmap(size);\n-\n-        // Write image into a R/W buffer from raw pixmap, then save the image.\n-        QBuffer notificationBuffer;\n-        if (!pixmap.isNull() && notificationBuffer.open(QIODevice::ReadWrite)) {\n-            QImageWriter writer(&notificationBuffer, \"PNG\");\n-            if (writer.write(pixmap.toImage())) {\n-                NSData* macImgData = [NSData dataWithBytes:notificationBuffer.buffer().data()\n-                                             length:notificationBuffer.buffer().size()];\n-                image =  [[NSImage alloc] initWithData:macImgData];\n-            }\n-        }\n+        image = QtMac::toNSImage(icon.pixmap(size));\n \n         if(!image) {\n             // if testnet image could not be created, load std. app icon"
      }
    ]
  },
  {
    "sha": "462b35b827f26d7a0b651007c3bb0584440a9f58",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0NjJiMzViODI3ZjI2ZDdhMGI2NTEwMDdjM2JiMDU4NDQ0MGE5ZjU4",
    "commit": {
      "author": {
        "name": "Douglas Roark",
        "email": "joroark@vt.edu",
        "date": "2018-10-10T09:07:39Z"
      },
      "committer": {
        "name": "Douglas Roark",
        "email": "joroark@vt.edu",
        "date": "2018-10-10T09:07:39Z"
      },
      "message": "Remove QtMacExtras requirement\n\nCross-compiling for platform-specific Qt extras may not be possible. Work around by copying the code from QtMac::toNSImage() and modifying as necessary. A redundant Qt version check was also removed.",
      "tree": {
        "sha": "6bf98ada9007aa579b1b349f146edfe84dcda780",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6bf98ada9007aa579b1b349f146edfe84dcda780"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/462b35b827f26d7a0b651007c3bb0584440a9f58",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQIzBAABCgAdFiEEbTFwwdwsb9Cu68pnQ4EdGiZiOSQFAlu9wVsACgkQQ4EdGiZi\nOSQRwA//Y8rWmibN7FGbSl8denBcNdHEOyBYq4buVGQa3TaPScIJYDIolJPfxP9b\nP9TvTRpuj/QsL42lYcy9IyJcmLe8h0+DX+tsDm6jiGIj90OXvZRF47+iFDSgOnM3\nXIQ3qr/LvFKPXejuG/rBt71H1GzAgMYr1870wRSG5x3Zl1mz8J0BAN1gBF8OU3Yn\n502qy0WC1qj2xRvwdxizuAX1sEOMTodPEfZWp7oezl5HGlKKLPUSoegriinP+cny\nIVR0qJWtFH4/QeDiHrt5cNib9n7Fzu4WrU3kXGZxQNX2HSiERKiz5+aDozZkH9sR\nSAV6iwY99s8/5wZHxR/fp3SrzFRpkrLQm4ooFAqOJ6zgVJggY0k3QHEEy4jcDrpL\nJRKnflqcJD1ijIB09RluC0kyLemVt8tG2HY/nrNsVQjfPS/XXtsE9msuMKOn9T4Z\nahIS2MNbbgkpZ3QN4bGJrar888vL8kVsdoBHWQAwKRSDpU0A/uD+rEQog5KWUZtG\nQczuOdCevZ0faWE4YvmNywAZVFMX00OUtp6PTyoIE3TXwkY+jck0FBEh1RXg1w4K\nq1VEs6ClsA+43w6X2h4mO0RBIQjEPWHMln3erp9j5Z9LIubfWxjlukCtcbliDU9q\ncPHTY4Uwpj1mxcjfR4v59nBx55KYdW9iT6ccDZcdfdK+LBGeEFU=\n=QLNU\n-----END PGP SIGNATURE-----",
        "payload": "tree 6bf98ada9007aa579b1b349f146edfe84dcda780\nparent b9e8f01842113776dd41f70dc0f8b4b34676a66b\nauthor Douglas Roark <joroark@vt.edu> 1539162459 -0700\ncommitter Douglas Roark <joroark@vt.edu> 1539162459 -0700\n\nRemove QtMacExtras requirement\n\nCross-compiling for platform-specific Qt extras may not be possible. Work around by copying the code from QtMac::toNSImage() and modifying as necessary. A redundant Qt version check was also removed.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/462b35b827f26d7a0b651007c3bb0584440a9f58",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/462b35b827f26d7a0b651007c3bb0584440a9f58",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/462b35b827f26d7a0b651007c3bb0584440a9f58/comments",
    "author": {
      "login": "droark",
      "id": 5931802,
      "node_id": "MDQ6VXNlcjU5MzE4MDI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5931802?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/droark",
      "html_url": "https://github.com/droark",
      "followers_url": "https://api.github.com/users/droark/followers",
      "following_url": "https://api.github.com/users/droark/following{/other_user}",
      "gists_url": "https://api.github.com/users/droark/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/droark/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/droark/subscriptions",
      "organizations_url": "https://api.github.com/users/droark/orgs",
      "repos_url": "https://api.github.com/users/droark/repos",
      "events_url": "https://api.github.com/users/droark/events{/privacy}",
      "received_events_url": "https://api.github.com/users/droark/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "droark",
      "id": 5931802,
      "node_id": "MDQ6VXNlcjU5MzE4MDI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5931802?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/droark",
      "html_url": "https://github.com/droark",
      "followers_url": "https://api.github.com/users/droark/followers",
      "following_url": "https://api.github.com/users/droark/following{/other_user}",
      "gists_url": "https://api.github.com/users/droark/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/droark/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/droark/subscriptions",
      "organizations_url": "https://api.github.com/users/droark/orgs",
      "repos_url": "https://api.github.com/users/droark/repos",
      "events_url": "https://api.github.com/users/droark/events{/privacy}",
      "received_events_url": "https://api.github.com/users/droark/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "b9e8f01842113776dd41f70dc0f8b4b34676a66b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b9e8f01842113776dd41f70dc0f8b4b34676a66b",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/b9e8f01842113776dd41f70dc0f8b4b34676a66b"
      }
    ],
    "stats": {
      "total": 13,
      "additions": 6,
      "deletions": 7
    },
    "files": [
      {
        "sha": "05df8621d2056f772c6d411e79ee34d12d06cd07",
        "filename": "build-aux/m4/bitcoin_qt.m4",
        "status": "modified",
        "additions": 0,
        "deletions": 3,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/462b35b827f26d7a0b651007c3bb0584440a9f58/build-aux/m4/bitcoin_qt.m4",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/462b35b827f26d7a0b651007c3bb0584440a9f58/build-aux/m4/bitcoin_qt.m4",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/build-aux/m4/bitcoin_qt.m4?ref=462b35b827f26d7a0b651007c3bb0584440a9f58",
        "patch": "@@ -429,9 +429,6 @@ AC_DEFUN([_BITCOIN_QT_FIND_LIBS_WITH_PKGCONFIG],[\n   m4_ifdef([PKG_CHECK_MODULES],[\n     QT_LIB_PREFIX=Qt5\n     qt5_modules=\"Qt5Core Qt5Gui Qt5Network Qt5Widgets\"\n-    if test \"x$TARGET_OS\" = xdarwin; then\n-      qt5_modules=\"$qt5_modules Qt5MacExtras\"\n-    fi\n     BITCOIN_QT_CHECK([\n       PKG_CHECK_MODULES([QT5], [$qt5_modules], [QT_INCLUDES=\"$QT5_CFLAGS\"; QT_LIBS=\"$QT5_LIBS\" have_qt=yes],[have_qt=no])\n "
      },
      {
        "sha": "5b419e3acb98a3bba96ca020a30cec075de30fe1",
        "filename": "src/qt/macdockiconhandler.mm",
        "status": "modified",
        "additions": 6,
        "deletions": 4,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/462b35b827f26d7a0b651007c3bb0584440a9f58/src/qt/macdockiconhandler.mm",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/462b35b827f26d7a0b651007c3bb0584440a9f58/src/qt/macdockiconhandler.mm",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/macdockiconhandler.mm?ref=462b35b827f26d7a0b651007c3bb0584440a9f58",
        "patch": "@@ -8,7 +8,6 @@\n #include <QMenu>\n #include <QBuffer>\n #include <QWidget>\n-#include <QtMac>\n \n #undef slots\n #include <Cocoa/Cocoa.h>\n@@ -51,9 +50,7 @@ void setupDockClickHandler() {\n     this->m_dummyWidget = new QWidget();\n     this->m_dockMenu = new QMenu(this->m_dummyWidget);\n     this->setMainWindow(nullptr);\n-#if QT_VERSION >= 0x050200\n     this->m_dockMenu->setAsDockMenu();\n-#endif\n     [pool release];\n }\n \n@@ -81,7 +78,12 @@ void setupDockClickHandler() {\n     else {\n         // generate NSImage from QIcon and use this as dock icon.\n         QSize size = icon.actualSize(QSize(128, 128));\n-        image = QtMac::toNSImage(icon.pixmap(size));\n+        CGImageRef cgimage = toCGImageRef(icon.pixmap(size));\n+        NSBitmapImageRep *bitmapRep = [[NSBitmapImageRep alloc] initWithCGImage:cgimage];\n+        image = [[NSImage alloc] init];\n+        [image addRepresentation:bitmapRep];\n+        [bitmapRep release];\n+        CFRelease(cgimage);\n \n         if(!image) {\n             // if testnet image could not be created, load std. app icon"
      }
    ]
  }
]