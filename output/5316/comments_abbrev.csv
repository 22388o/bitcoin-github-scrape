sipa,2014-11-19T16:55:52Z,"Tested on testnet by issuing blacklistblock of an older block during IBD, and later calling reconsiderblock with the same hash. Also the same with with a restart of the node in between.\n",https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-63673062,63673062,
sipa,2014-11-19T17:02:45Z,"Heh, I can even successfully mark the genesis block invalid and recover it seems.\n",https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-63674379,63674379,
gmaxwell,2014-11-19T21:25:28Z,"\O/  @TheBlueMatt  Any interest in making pulltester use this? in particular, the reconsideration path is obviously completely untested right now.  Any ideas how we can test that?\n",https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-63716456,63716456,
sipa,2014-11-19T21:29:46Z,"@gmaxwell It would be 'ugly' for comparison tool (which is a blackbox network behaviour tester) to invoke RPCs that are deliberately designed to override the correct network behaviour.\n\nA python-based RPC test would be very nice for this, which mines some blocks, blacklists, mines more, reconsiders, and checks whether it recovers. I'll have to dig into that framework code, though.\n",https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-63717162,63717162,
gmaxwell,2014-11-19T21:38:34Z,@sipa the case thats hard to test is we'd like to have a invalid block get rejected through the normal pathways and then get reconsidered.\n,https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-63718611,63718611,
gmaxwell,2014-11-19T21:41:55Z,I'm currently trying to reorg the main chain on a node with a wallet back down to height 1 and it's taking about 7 seconds per block.  Makes it a little frustrating for testing.\n,https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-63719123,63719123,
gmaxwell,2014-11-20T01:19:08Z,"Minor comment, we might want to make a help section for 'diagnostic/testin' commands and move these and mocktime  and maybe the txoutset commands into it.\n",https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-63746003,63746003,
gmaxwell,2014-11-20T01:20:47Z,After several kill/restart cycles while it was reorging back down to block 1 (but thousands of blocks away) one time when it came up it didn't continue going on its own and I had to resend the blacklist command.  Any idea why?\n,https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-63746172,63746172,
sipa,2014-11-20T08:39:21Z,@gmaxwell logs?\n,https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-63776279,63776279,
gmaxwell,2014-11-20T08:46:42Z,What it seems to actually be doing on restart is only reorginizing some finite number of blocks and then stopping and sitting stuck until I perform the RPC again.\n\nE.g.\n\n2014-11-20 01:29:15 Rescanning last 36 blocks (from block 330629)...\n2014-11-20 01:29:35  rescan                20103ms\n2014-11-20 01:31:55 UpdateTip: new best=00000000000000001585818b3733f687ff1263fd822dd22da13173f86a40d862,https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-63777005,63777005,
sipa,2014-11-20T10:00:51Z,"Oh, that's expected. You need to wait for the RPC to finish I'm afraid.\n\nThe current ActivateBestChain assumes the currently active chain is always valid, and changing that assumption means that more things have to change, which I'd rather not do now (the patch is very clean, as there is no code changed except code invoked by those RPCs themselves).\n",https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-63785535,63785535,
gmaxwell,2014-11-20T17:35:13Z,@sipa Seems reasonable enough. My host (with the checkforkwarning fix) is still grinding away using this reorging its chain.\n,https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-63847060,63847060,
gmaxwell,2014-11-21T00:02:01Z,"15:05 < gmaxwell> sipa: so I realize I keep thinking of your blockblackist thing performing the verb ""invalidate"" not ""blacklist"". Perhaps the rpc should be \n                  renamed? e.g. invalidateblock <hash> / reconsiderblock <hash>  ?\n15:05 < sipa> gmaxwell: fair enough\n",https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-63903228,63903228,
gmaxwell,2014-11-21T22:00:27Z,ACK\n,https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-64044884,64044884,
jgarzik,2014-11-21T22:32:14Z,Any chance of batching those writes?\n,https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-64048646,64048646,
sipa,2014-11-21T22:46:51Z,"@jgarzik I'll be happy to turn them into batch writes after #5241 is in; now it would just be duplicate work (and there's no real requirement for these to be actually fast, as they are for very manual emergency intervention and testing only).\n",https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-64050209,64050209,
rebroad,2014-11-22T12:33:44Z,What's the reason for this functionality?\n,https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-64078850,64078850,
sipa,2014-11-22T14:17:14Z,"A much earlier version of this patch was actually used by slush's pool in march 2013 when the 0.7 vs 0.8 split happened, to force their 0.8 node to switch to the 0.7 chain. Having such functionality present is definitely useful for manual interventions.\n\nOther than that, testing very-large scale reorganizations for example.\n",https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-64081545,64081545,
sipa,2014-11-22T14:17:58Z,"Maybe the `invalidateblock` RPC needs a big fat warning when used on mainnet, though.\n",https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-64081571,64081571,
gmaxwell,2014-11-23T19:53:04Z,Or just hide it in the RPC help if you think users are too likely to foot-gun by forcing themselves off the best chain.\n,https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-64131703,64131703,
gmaxwell,2014-11-25T22:33:52Z,"ACK. Looks and tests good, though a bit slow.\n\nWumpus suggested that perhaps the rpc be disabled unless some -blockdebugging=1 was set to reduce the footgun risk. If you wanted to do that I'd find it agreeable too.\n",https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-64483595,64483595,
laanwj,2014-11-26T09:16:50Z,"Ye, please put this behind an option for Advanced Usage and don't display them in the help by default.\n",https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-64534737,64534737,
sipa,2014-11-26T15:37:04Z,@laanwj @gmaxwell Moved them to a 'hidden' category.\n,https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-64663218,64663218,
laanwj,2014-11-27T07:56:44Z,"If everyone else agrees that moving them to a hidden category is enough, I'm fine with that.\n\nThis only adds code so there is effectively no regression risk. utACK for 0.10.\n\ncommithash bd9aebf19d6714552fe9f23bce97159d90d63e5b https://dev.visucore.com/bitcoin/acks/5316\n",https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-64756641,64756641,
sipa,2014-11-27T08:30:19Z,"I dislike having them only being available behind an command-line option, as there may be benefit in case of emergencies to not having to restart nodes first.\n",https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-64759337,64759337,
gmaxwell,2014-11-27T10:40:15Z,"I'm still an ACK, and I've tested this a fair bit more... it's pretty fun zapping blocks and watching it move up and down the chain to get back to the new best position.\n",https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-64773794,64773794,
laanwj,2014-11-28T10:32:21Z,Merged w/ added commit f86a24b368cf4e133add769966c7652ec3b63a75 that moves setmocktime to the hidden category as well.\n,https://github.com/bitcoin/bitcoin/pull/5316#issuecomment-64879300,64879300,
