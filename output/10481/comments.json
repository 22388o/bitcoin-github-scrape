[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/305992151",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10481#issuecomment-305992151",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10481",
    "id": 305992151,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNTk5MjE1MQ==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-03T18:14:12Z",
    "updated_at": "2017-06-03T18:14:12Z",
    "author_association": "MEMBER",
    "body": "utACK 6909865869d9f2582e33e936e770538dfc541cf7",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/305992151/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/306076013",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10481#issuecomment-306076013",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10481",
    "id": 306076013,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNjA3NjAxMw==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-04T23:55:13Z",
    "updated_at": "2017-06-04T23:55:13Z",
    "author_association": "MEMBER",
    "body": "Something else you could consider is checking whether the total script is not too large (MAX_SCRIPT_SIZE) or the stack elements aren't too large (MAX_SCRIPT_ELEMENT_SIZE).",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/306076013/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/306274726",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10481#issuecomment-306274726",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10481",
    "id": 306274726,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNjI3NDcyNg==",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?u=9791e96cd4268d48e3517bac41eaf2b1d09759fd&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-05T19:02:23Z",
    "updated_at": "2017-06-05T19:02:23Z",
    "author_association": "MEMBER",
    "body": "addressed @sipa's comments.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/306274726/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/306625939",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10481#issuecomment-306625939",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10481",
    "id": 306625939,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNjYyNTkzOQ==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-06T21:41:59Z",
    "updated_at": "2017-06-06T21:41:59Z",
    "author_association": "MEMBER",
    "body": "reutACK e76d516a19f09f546d6fb5f16f8b4c758c5287ed",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/306625939/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/325142230",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10481#issuecomment-325142230",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10481",
    "id": 325142230,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNTE0MjIzMA==",
    "user": {
      "login": "roconnor-blockstream",
      "id": 21371712,
      "node_id": "MDQ6VXNlcjIxMzcxNzEy",
      "avatar_url": "https://avatars.githubusercontent.com/u/21371712?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/roconnor-blockstream",
      "html_url": "https://github.com/roconnor-blockstream",
      "followers_url": "https://api.github.com/users/roconnor-blockstream/followers",
      "following_url": "https://api.github.com/users/roconnor-blockstream/following{/other_user}",
      "gists_url": "https://api.github.com/users/roconnor-blockstream/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/roconnor-blockstream/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/roconnor-blockstream/subscriptions",
      "organizations_url": "https://api.github.com/users/roconnor-blockstream/orgs",
      "repos_url": "https://api.github.com/users/roconnor-blockstream/repos",
      "events_url": "https://api.github.com/users/roconnor-blockstream/events{/privacy}",
      "received_events_url": "https://api.github.com/users/roconnor-blockstream/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-26T16:10:45Z",
    "updated_at": "2017-08-26T16:11:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "This sanity check doesn't work.  invalid opcodes are not illegal, and can even appear in real transactions.  For an example see transaction 95f7832b6449348bd1f3bc2e6eb110785248427bbe13853f2d61da9a6e810800 on testnet.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/325142230/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/325157442",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10481#issuecomment-325157442",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10481",
    "id": 325157442,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNTE1NzQ0Mg==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-26T19:35:34Z",
    "updated_at": "2017-08-26T19:35:34Z",
    "author_association": "MEMBER",
    "body": "@roconnor-blockstream This test is only a heuristic to determine whether to prefer a non-witness interpretation of a transaction over a witness interpretation when it has 0 inputs. It's also only relevant for interpreting inputs to `decoderawtransaction` and `fundrawtransaction` (which are the only things that accept transactions with 0 inputs in the first place).",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/325157442/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/325177009",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10481#issuecomment-325177009",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10481",
    "id": 325177009,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNTE3NzAwOQ==",
    "user": {
      "login": "roconnor-blockstream",
      "id": 21371712,
      "node_id": "MDQ6VXNlcjIxMzcxNzEy",
      "avatar_url": "https://avatars.githubusercontent.com/u/21371712?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/roconnor-blockstream",
      "html_url": "https://github.com/roconnor-blockstream",
      "followers_url": "https://api.github.com/users/roconnor-blockstream/followers",
      "following_url": "https://api.github.com/users/roconnor-blockstream/following{/other_user}",
      "gists_url": "https://api.github.com/users/roconnor-blockstream/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/roconnor-blockstream/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/roconnor-blockstream/subscriptions",
      "organizations_url": "https://api.github.com/users/roconnor-blockstream/orgs",
      "repos_url": "https://api.github.com/users/roconnor-blockstream/repos",
      "events_url": "https://api.github.com/users/roconnor-blockstream/events{/privacy}",
      "received_events_url": "https://api.github.com/users/roconnor-blockstream/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-27T04:50:55Z",
    "updated_at": "2017-08-27T04:50:55Z",
    "author_association": "CONTRIBUTOR",
    "body": "We cannot use heuristics for deciding how to interpret ambiguous parameters to API calls such as `fundrawtransaction`.  It is a security hazard.\r\n\r\nImagine someone is using Bitcoin Core as part of some protocol.  They have assembled data from various parties, some of them generated adversarially.  The protocol safely validates the adversarial inputs and composes a valid, partial transaction, and passes it to `fundrawtransaction`, then sends that output to `signrawtransaction` and then passes it around or even broadcasts it with `sendrawtransaction`.\r\n\r\nThe system has validated the construction of their transaction, and the designers have tested it many times and believes it work.  However, it isn't secure.  After deployment an adversary tickles their data, perhaps by creating an output with invalid opcodes.  These adversarially provided output scripts are legal and pass protocol's validation engine.  However this causes the data passed to `fundrawtransaction` to be interpreted differently, either as a segwit transaction when the protocol thinks it is generating a legacy transaction, or vice versa.  Now `fundrawtransaciton` is generating a transaction that is different than the protocol intends, and it is probably a transaction sending the funds somewhere else.  Nobody expected that fine details about the contents of output scripts to change how the transaction being passed is parsed, that would be very surprising, so the software just assumes `fundrawtransaction` output is the transaction it thinks it has created, and blindly sends it onto `signrawtransaction`. With that transaction now signed, who knows where the money will end up.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/325177009/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/325235809",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10481#issuecomment-325235809",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10481",
    "id": 325235809,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNTIzNTgwOQ==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-28T00:42:46Z",
    "updated_at": "2017-08-28T00:42:55Z",
    "author_association": "MEMBER",
    "body": "@roconnor-blockstream Then what do you suggest? The only full solution is not using the same format for partial transactions (something that @achow101's PSBT format accomplishes). Anything else will inherently risk being ambiguous.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/325235809/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/325244946",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10481#issuecomment-325244946",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10481",
    "id": 325244946,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNTI0NDk0Ng==",
    "user": {
      "login": "roconnor-blockstream",
      "id": 21371712,
      "node_id": "MDQ6VXNlcjIxMzcxNzEy",
      "avatar_url": "https://avatars.githubusercontent.com/u/21371712?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/roconnor-blockstream",
      "html_url": "https://github.com/roconnor-blockstream",
      "followers_url": "https://api.github.com/users/roconnor-blockstream/followers",
      "following_url": "https://api.github.com/users/roconnor-blockstream/following{/other_user}",
      "gists_url": "https://api.github.com/users/roconnor-blockstream/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/roconnor-blockstream/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/roconnor-blockstream/subscriptions",
      "organizations_url": "https://api.github.com/users/roconnor-blockstream/orgs",
      "repos_url": "https://api.github.com/users/roconnor-blockstream/repos",
      "events_url": "https://api.github.com/users/roconnor-blockstream/events{/privacy}",
      "received_events_url": "https://api.github.com/users/roconnor-blockstream/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-08-28T02:21:13Z",
    "updated_at": "2017-08-28T02:22:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "Yes, ultimately this format for partial transactions must be retired.\r\n\r\nIn the mean time I suggest either adding a, preferably mandatory, flag to `fundrawtransaction` to tell it whether the parameter is a partially signed segwit transaction or a partially signed legacy transaction.\r\nIf you choose to make the flag optional, then, when no flag is given, you must parse the parameter both ways and fail of both parses are successful.  For consistency, and safety, `decoderawtransaction` should operate the same way.\r\n\r\n(instead of a flag, you could instead create two new API calls for `fundrawlegacytransaction` and `fundrawsegwittransaction`).\r\n\r\nPerhaps there are some other ideas.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/325244946/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/119242422",
    "pull_request_review_id": 41103675,
    "id": 119242422,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExOTI0MjQyMg==",
    "diff_hunk": "@@ -88,18 +88,38 @@ CScript ParseScript(const std::string& s)\n     return result;\n }\n \n+// Check that all of the input and output scripts of a transaction contains valid opcodes\n+bool CheckTxScriptsSanity(CMutableTransaction& tx)\n+{\n+    // Check input scripts\n+    for(unsigned int i = 0; i < tx.vin.size(); i++) {",
    "path": "src/core_read.cpp",
    "position": null,
    "original_position": 8,
    "commit_id": "ac4e438229134595e949bfedb1f487c71fd45d24",
    "original_commit_id": "d1fb4337b57c9db47819feba020b04383e2c4385",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "You should probably skip this loop for coinbase transactions, as those don't have meaningful input scripts.\r\n\r\nIs testing the inputs even useful, as the function of this test is to distinguish between transactions that may errorneously be decoded as 0-input transaction?\r\n\r\nNit: space after `for` (and elsewhere).",
    "created_at": "2017-05-30T23:46:43Z",
    "updated_at": "2017-06-07T21:07:41Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10481#discussion_r119242422",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10481",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/119242422"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/10481#discussion_r119242422"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10481"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/119242422/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 95,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/119260852",
    "pull_request_review_id": 41122891,
    "id": 119260852,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExOTI2MDg1Mg==",
    "diff_hunk": "@@ -88,18 +88,40 @@ CScript ParseScript(const std::string& s)\n     return result;\n }\n \n+// Check that all of the input and output scripts of a transaction contains valid opcodes\n+bool CheckTxScriptsSanity(CMutableTransaction& tx)",
    "path": "src/core_read.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "ac4e438229134595e949bfedb1f487c71fd45d24",
    "original_commit_id": "6909865869d9f2582e33e936e770538dfc541cf7",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Mark the `tx` argument const?",
    "created_at": "2017-05-31T02:52:50Z",
    "updated_at": "2017-06-07T21:07:41Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10481#discussion_r119260852",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10481",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/119260852"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/10481#discussion_r119260852"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10481"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/119260852/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 92,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120184103",
    "pull_request_review_id": 42126033,
    "id": 120184103,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMDE4NDEwMw==",
    "diff_hunk": "@@ -88,18 +88,40 @@ CScript ParseScript(const std::string& s)\n     return result;\n }\n \n+// Check that all of the input and output scripts of a transaction contains valid opcodes\n+bool CheckTxScriptsSanity(CMutableTransaction& tx)",
    "path": "src/core_read.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "ac4e438229134595e949bfedb1f487c71fd45d24",
    "original_commit_id": "6909865869d9f2582e33e936e770538dfc541cf7",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "done",
    "created_at": "2017-06-05T19:02:10Z",
    "updated_at": "2017-06-07T21:07:41Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10481#discussion_r120184103",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10481",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120184103"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/10481#discussion_r120184103"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10481"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120184103/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 92,
    "side": "RIGHT",
    "in_reply_to_id": 119260852
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120219601",
    "pull_request_review_id": 42164400,
    "id": 120219601,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMDIxOTYwMQ==",
    "diff_hunk": "@@ -267,3 +267,16 @@ std::string CScriptWitness::ToString() const\n     }\n     return ret + \")\";\n }\n+\n+bool CScript::HasValidOps() const\n+{\n+    CScript::const_iterator it = begin();\n+    while (it < end()) {\n+        opcodetype opcode;\n+        CScript::const_iterator prev_it = it;\n+        if (!GetOp(it, opcode) || opcode > 0xb9 || it - prev_it > MAX_SCRIPT_ELEMENT_SIZE) {",
    "path": "src/script/script.cpp",
    "position": null,
    "original_position": 11,
    "commit_id": "ac4e438229134595e949bfedb1f487c71fd45d24",
    "original_commit_id": "e21a9f48fe5ce2b6dec49a3fd6240b52e620027a",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think this isn't actually correct. MAX_SCRIPT_ELEMENT_SIZE is the maximum length of the data, but its encoding as a CScript push may be up to 2 bytes more. Perhaps you can use GetOp2, which returns the data being pushed?",
    "created_at": "2017-06-05T21:54:18Z",
    "updated_at": "2017-06-07T21:07:41Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10481#discussion_r120219601",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10481",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120219601"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/10481#discussion_r120219601"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10481"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120219601/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 277,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120226426",
    "pull_request_review_id": 42171507,
    "id": 120226426,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMDIyNjQyNg==",
    "diff_hunk": "@@ -267,3 +267,16 @@ std::string CScriptWitness::ToString() const\n     }\n     return ret + \")\";\n }\n+\n+bool CScript::HasValidOps() const\n+{\n+    CScript::const_iterator it = begin();\n+    while (it < end()) {\n+        opcodetype opcode;\n+        CScript::const_iterator prev_it = it;\n+        if (!GetOp(it, opcode) || opcode > 0xb9 || it - prev_it > MAX_SCRIPT_ELEMENT_SIZE) {",
    "path": "src/script/script.cpp",
    "position": null,
    "original_position": 11,
    "commit_id": "ac4e438229134595e949bfedb1f487c71fd45d24",
    "original_commit_id": "e21a9f48fe5ce2b6dec49a3fd6240b52e620027a",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "done",
    "created_at": "2017-06-05T22:31:27Z",
    "updated_at": "2017-06-07T21:07:41Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10481#discussion_r120226426",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10481",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120226426"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/10481#discussion_r120226426"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10481"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120226426/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 277,
    "side": "RIGHT",
    "in_reply_to_id": 120219601
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120227012",
    "pull_request_review_id": 42172129,
    "id": 120227012,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMDIyNzAxMg==",
    "diff_hunk": "@@ -88,18 +88,40 @@ CScript ParseScript(const std::string& s)\n     return result;\n }\n \n+// Check that all of the input and output scripts of a transaction contains valid opcodes\n+bool CheckTxScriptsSanity(const CMutableTransaction& tx)\n+{\n+    // Check input scripts for non-coinbase txs\n+    if (!CTransaction(tx).IsCoinBase()) {\n+        for (unsigned int i = 0; i < tx.vin.size(); i++) {\n+            if (!tx.vin[i].scriptSig.HasValidOps()) {\n+                return false;\n+            }\n+        }\n+    }\n+    // Check output scripts\n+    for (unsigned int i = 0; i < tx.vout.size(); i++) {\n+        if (!tx.vout[0].scriptPubKey.HasValidOps() || tx.vout[0].scriptPubKey.size() > MAX_SCRIPT_SIZE) {",
    "path": "src/core_read.cpp",
    "position": null,
    "original_position": 17,
    "commit_id": "ac4e438229134595e949bfedb1f487c71fd45d24",
    "original_commit_id": "dc95ca642ef82d5c47604bf0b6faf3a5c44786f4",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "vout[i]",
    "created_at": "2017-06-05T22:35:22Z",
    "updated_at": "2017-06-07T21:07:41Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10481#discussion_r120227012",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10481",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120227012"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/10481#discussion_r120227012"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10481"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120227012/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 104,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120278241",
    "pull_request_review_id": 42224921,
    "id": 120278241,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMDI3ODI0MQ==",
    "diff_hunk": "@@ -88,18 +88,40 @@ CScript ParseScript(const std::string& s)\n     return result;\n }\n \n+// Check that all of the input and output scripts of a transaction contains valid opcodes\n+bool CheckTxScriptsSanity(const CMutableTransaction& tx)\n+{\n+    // Check input scripts for non-coinbase txs\n+    if (!CTransaction(tx).IsCoinBase()) {\n+        for (unsigned int i = 0; i < tx.vin.size(); i++) {\n+            if (!tx.vin[i].scriptSig.HasValidOps()) {",
    "path": "src/core_read.cpp",
    "position": null,
    "original_position": 10,
    "commit_id": "ac4e438229134595e949bfedb1f487c71fd45d24",
    "original_commit_id": "a3c9b93b18102db6195558285f64dc6b7c33479d",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "No MAX_SCRIPT_SIZE test here?",
    "created_at": "2017-06-06T07:01:24Z",
    "updated_at": "2017-06-07T21:07:41Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10481#discussion_r120278241",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10481",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120278241"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/10481#discussion_r120278241"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10481"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120278241/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 97,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120430950",
    "pull_request_review_id": 42393156,
    "id": 120430950,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMDQzMDk1MA==",
    "diff_hunk": "@@ -88,18 +88,40 @@ CScript ParseScript(const std::string& s)\n     return result;\n }\n \n+// Check that all of the input and output scripts of a transaction contains valid opcodes\n+bool CheckTxScriptsSanity(const CMutableTransaction& tx)\n+{\n+    // Check input scripts for non-coinbase txs\n+    if (!CTransaction(tx).IsCoinBase()) {\n+        for (unsigned int i = 0; i < tx.vin.size(); i++) {\n+            if (!tx.vin[i].scriptSig.HasValidOps()) {",
    "path": "src/core_read.cpp",
    "position": null,
    "original_position": 10,
    "commit_id": "ac4e438229134595e949bfedb1f487c71fd45d24",
    "original_commit_id": "a3c9b93b18102db6195558285f64dc6b7c33479d",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "done",
    "created_at": "2017-06-06T17:47:28Z",
    "updated_at": "2017-06-07T21:07:41Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10481#discussion_r120430950",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10481",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120430950"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/10481#discussion_r120430950"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10481"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120430950/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 97,
    "side": "RIGHT",
    "in_reply_to_id": 120278241
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120700111",
    "pull_request_review_id": 42685322,
    "id": 120700111,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMDcwMDExMQ==",
    "diff_hunk": "@@ -267,3 +267,16 @@ std::string CScriptWitness::ToString() const\n     }\n     return ret + \")\";\n }\n+\n+bool CScript::HasValidOps() const\n+{\n+    CScript::const_iterator it = begin();\n+    while (it < end()) {\n+        opcodetype opcode;\n+        std::vector<unsigned char> item;\n+        if (!GetOp(it, opcode, item) || opcode > 0xb9 || item.size() > MAX_SCRIPT_ELEMENT_SIZE) {",
    "path": "src/script/script.cpp",
    "position": null,
    "original_position": 11,
    "commit_id": "ac4e438229134595e949bfedb1f487c71fd45d24",
    "original_commit_id": "e76d516a19f09f546d6fb5f16f8b4c758c5287ed",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Let's define a constant for 0xb9, this is kind of a magic number here. `OP_NOP10` would work, but maybe it's better to explicitly mark what the maximum valid opcode is.",
    "created_at": "2017-06-07T17:59:10Z",
    "updated_at": "2017-06-07T21:07:41Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10481#discussion_r120700111",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10481",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120700111"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/10481#discussion_r120700111"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10481"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120700111/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 277,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120745147",
    "pull_request_review_id": 42735094,
    "id": 120745147,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMDc0NTE0Nw==",
    "diff_hunk": "@@ -267,3 +267,16 @@ std::string CScriptWitness::ToString() const\n     }\n     return ret + \")\";\n }\n+\n+bool CScript::HasValidOps() const\n+{\n+    CScript::const_iterator it = begin();\n+    while (it < end()) {\n+        opcodetype opcode;\n+        std::vector<unsigned char> item;\n+        if (!GetOp(it, opcode, item) || opcode > 0xb9 || item.size() > MAX_SCRIPT_ELEMENT_SIZE) {",
    "path": "src/script/script.cpp",
    "position": null,
    "original_position": 11,
    "commit_id": "ac4e438229134595e949bfedb1f487c71fd45d24",
    "original_commit_id": "e76d516a19f09f546d6fb5f16f8b4c758c5287ed",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done",
    "created_at": "2017-06-07T21:08:04Z",
    "updated_at": "2017-06-07T21:08:04Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10481#discussion_r120745147",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10481",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120745147"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/10481#discussion_r120745147"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10481"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120745147/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 277,
    "side": "RIGHT",
    "in_reply_to_id": 120700111
  }
]