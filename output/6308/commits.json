[
  {
    "sha": "fec82f682ea8c74911f8dd0d6de974be8c1ad599",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmZWM4MmY2ODJlYThjNzQ5MTFmOGRkMGQ2ZGU5NzRiZThjMWFkNTk5",
    "commit": {
      "author": {
        "name": "Philip Kaufmann",
        "email": "phil.kaufmann@t-online.de",
        "date": "2015-06-19T14:00:57Z"
      },
      "committer": {
        "name": "Philip Kaufmann",
        "email": "phil.kaufmann@t-online.de",
        "date": "2015-06-19T14:03:52Z"
      },
      "message": "remove pathAddr field from CAddrDB class\n\n- removes the need for a boost::filesystem::path field, which caused\n  issues on shutdown because of a static initialized internal pointer",
      "tree": {
        "sha": "e055635a7ff57429961fedb67eba8a76742de443",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e055635a7ff57429961fedb67eba8a76742de443"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fec82f682ea8c74911f8dd0d6de974be8c1ad599",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fec82f682ea8c74911f8dd0d6de974be8c1ad599",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fec82f682ea8c74911f8dd0d6de974be8c1ad599",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fec82f682ea8c74911f8dd0d6de974be8c1ad599/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "529a44c144a0c9c4bfefb6d7b41b328c3642149b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/529a44c144a0c9c4bfefb6d7b41b328c3642149b",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/529a44c144a0c9c4bfefb6d7b41b328c3642149b"
      }
    ],
    "stats": {
      "total": 14,
      "additions": 5,
      "deletions": 9
    },
    "files": [
      {
        "sha": "0138052da1d21e2e2817dbae7dd379e65c7d15e5",
        "filename": "src/net.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 6,
        "changes": 11,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fec82f682ea8c74911f8dd0d6de974be8c1ad599/src/net.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fec82f682ea8c74911f8dd0d6de974be8c1ad599/src/net.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.cpp?ref=fec82f682ea8c74911f8dd0d6de974be8c1ad599",
        "patch": "@@ -1854,18 +1854,16 @@ void CNode::Fuzz(int nChance)\n // CAddrDB\n //\n \n-CAddrDB::CAddrDB()\n-{\n-    pathAddr = GetDataDir() / \"peers.dat\";\n-}\n-\n bool CAddrDB::Write(const CAddrMan& addr)\n {\n     // Generate random temporary filename\n     unsigned short randv = 0;\n     GetRandBytes((unsigned char*)&randv, sizeof(randv));\n     std::string tmpfn = strprintf(\"peers.dat.%04x\", randv);\n \n+    boost::filesystem::path pathAddr = GetDataDir() / \"peers.dat\";\n+    boost::filesystem::path pathTmp = GetDataDir() / tmpfn;\n+\n     // serialize addresses, checksum data up to that point, then append csum\n     CDataStream ssPeers(SER_DISK, CLIENT_VERSION);\n     ssPeers << FLATDATA(Params().MessageStart());\n@@ -1874,7 +1872,6 @@ bool CAddrDB::Write(const CAddrMan& addr)\n     ssPeers << hash;\n \n     // open temp output file, and associate with CAutoFile\n-    boost::filesystem::path pathTmp = GetDataDir() / tmpfn;\n     FILE *file = fopen(pathTmp.string().c_str(), \"wb\");\n     CAutoFile fileout(file, SER_DISK, CLIENT_VERSION);\n     if (fileout.IsNull())\n@@ -1899,6 +1896,8 @@ bool CAddrDB::Write(const CAddrMan& addr)\n \n bool CAddrDB::Read(CAddrMan& addr)\n {\n+    boost::filesystem::path pathAddr = GetDataDir() / \"peers.dat\";\n+\t\n     // open input file, and associate with CAutoFile\n     FILE *file = fopen(pathAddr.string().c_str(), \"rb\");\n     CAutoFile filein(file, SER_DISK, CLIENT_VERSION);"
      },
      {
        "sha": "8ec4c377f4fbc7c5c877087f584a9b9c788f16d2",
        "filename": "src/net.h",
        "status": "modified",
        "additions": 0,
        "deletions": 3,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fec82f682ea8c74911f8dd0d6de974be8c1ad599/src/net.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fec82f682ea8c74911f8dd0d6de974be8c1ad599/src/net.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.h?ref=fec82f682ea8c74911f8dd0d6de974be8c1ad599",
        "patch": "@@ -636,10 +636,7 @@ void RelayTransaction(const CTransaction& tx, const CDataStream& ss);\n /** Access to the (IP) address database (peers.dat) */\n class CAddrDB\n {\n-private:\n-    boost::filesystem::path pathAddr;\n public:\n-    CAddrDB();\n     bool Write(const CAddrMan& addr);\n     bool Read(CAddrMan& addr);\n };"
      }
    ]
  }
]