laanwj,2015-04-08T08:08:58Z,"I like the concept, although this has a lot of 'collateral' code impact. Of course this is a necessary step in the process toward explicitly passing in a Consensus or ChainParams structure.\n\nThe part that generates most of the diff here is that which removes the getters and replaces them with `GetConsensus().x`. For the sake of reviewability, let's do this in a separate pull, with a large diff b",https://github.com/bitcoin/bitcoin/pull/5968#issuecomment-90837749,90837749,
jtimon,2015-04-08T12:16:50Z,"I left the last 3 commits for #5970, so the redundant getters aren't removed yet and the GetBlockValue/GetBlockSubsidy and IsSupermajority changes are also delayed. Is this what you had in mind?\n",https://github.com/bitcoin/bitcoin/pull/5968#issuecomment-90895545,90895545,
jtimon,2015-04-08T15:28:35Z,Last commit updated to avoid conflicts with #5975 after its latest chainparams fix.\n,https://github.com/bitcoin/bitcoin/pull/5968#issuecomment-90950875,90950875,
jtimon,2015-04-10T09:09:05Z,Rebased\n,https://github.com/bitcoin/bitcoin/pull/5968#issuecomment-91488356,91488356,
jtimon,2015-04-10T16:59:41Z,Updated only with the changes to IsSuperMajority. Other changes are left for other PRs like #5996\n,https://github.com/bitcoin/bitcoin/pull/5968#issuecomment-91621671,91621671,
jtimon,2015-04-15T17:40:49Z,"Added a squashme commit with @theuni 's suggestion of passing Consensus::Params instead of nToCheck. At the very least it produces shorter lines. I'm happy to squash it.\nI also added another squashme commit that makes the PR a little bit harder to read, but since I plan to do that later anyway and I'm now touching those same lines...\nI would prefer to squash it as well but I'm also happy leaving",https://github.com/bitcoin/bitcoin/pull/5968#issuecomment-93495967,93495967,
laanwj,2015-04-16T17:30:23Z,utACK\n,https://github.com/bitcoin/bitcoin/pull/5968#issuecomment-93791604,93791604,
jtimon,2015-04-16T18:14:28Z,Squashed the last 2 commits.\n,https://github.com/bitcoin/bitcoin/pull/5968#issuecomment-93805905,93805905,
theuni,2015-04-23T21:05:18Z,ut ACK other than the nit above\n,https://github.com/bitcoin/bitcoin/pull/5968#issuecomment-95718751,95718751,
jtimon,2015-04-29T11:26:06Z,Updated without introducing the loop\n,https://github.com/bitcoin/bitcoin/pull/5968#issuecomment-97392625,97392625,
jtimon,2015-05-06T10:56:58Z,Needed rebase\n,https://github.com/bitcoin/bitcoin/pull/5968#issuecomment-99417495,99417495,
theuni,2015-04-10T19:11:33Z,Just pass Consensus::Params and use the parts here?\n,https://github.com/bitcoin/bitcoin/pull/5968#discussion_r28172133,28172133,src/main.cpp
jtimon,2015-04-11T06:32:33Z,"It would only serve for nToCheck. nRequired is sometimes enforceUpgrade and some times rejectOoutdated. I thought that instead of passing the params to take the majority window, I could just pass a number directly.\n",https://github.com/bitcoin/bitcoin/pull/5968#discussion_r28192860,28192860,src/main.cpp
theuni,2015-04-23T21:00:10Z,"Why change this? Seems less clear and less conducive to documentation. If anything, I'd prefer to see comments added for when block versions stopped being accepted.\n",https://github.com/bitcoin/bitcoin/pull/5968#discussion_r29002896,29002896,src/main.cpp
jtimon,2015-04-23T21:49:00Z,"Well, if we have 10 voted softfork at the same time I prefer to have a loop over 10 practically identical unrolled ifs...\nI would also like to have a ""time proof"" solution for forks that are enforced by height instead of voting as suggested in #5966 . This is the only place where you can have a generic solution for block versions.\nAnyway, I don't think \n\n```\n// Reject block.nVersion=n blocks ",https://github.com/bitcoin/bitcoin/pull/5968#discussion_r29007135,29007135,src/main.cpp
theuni,2015-04-23T21:56:40Z,"Not completely against, but if we had 10 voted softforks, it'd probably be a good place to have 10 short explanations.\n",https://github.com/bitcoin/bitcoin/pull/5968#discussion_r29007738,29007738,src/main.cpp
jtimon,2015-04-24T08:10:23Z,"Mhmm, I think putting those in ContextualCheckBlock and Consensus::GetFlags (not existing yet, see https://github.com/jtimon/bitcoin/commit/9ba7d0641019d7f6c08f7b15ce3a2bd2e5e8a4ac) would be more informative. But anyway, it seems I squashed the loop change too fast, I can separate that again if it's going to delay this.\n",https://github.com/bitcoin/bitcoin/pull/5968#discussion_r29031300,29031300,src/main.cpp
sipa,2015-04-30T07:05:17Z,"I would just pass both nMajorityWindow and nRequired as argument, and leave this as a utility function.\n",https://github.com/bitcoin/bitcoin/pull/5968#discussion_r29407453,29407453,src/main.cpp
jtimon,2015-04-30T07:43:08Z,"the initial version took both ints instead of taking Consensus::Params as the second. But I changed it solving a nit because this produces shorter lines. If you mean maintaining a utility function still coupled to Params(), no, only consensus functions call this function (well, plus the consensus part of connectBlock) and they need it decoupled.\n",https://github.com/bitcoin/bitcoin/pull/5968#discussion_r29408934,29408934,src/main.cpp
sipa,2015-04-30T09:20:58Z,"This is a very minor nit, feel free to ignore.\n\nI mean not taking Params, but do taking both the number to check and the\nnumber required. It's a bit ugly to pass both params and something\nextracted from params, imho.\n",https://github.com/bitcoin/bitcoin/pull/5968#discussion_r29414557,29414557,src/main.cpp
jtimon,2015-04-30T10:39:34Z,"As said, at the beginning it was getting nRequired and nToCheck, but @theuni suggested the change. I'm happy to change it back but I don't have strong feelings either way.\nYou could also have a version with nRequired and nToCheck and two other inlined functions:\n\n```\nbool IsSuperMajorityUpgrade(int minVersion, const CBlockIndex* pstart, const Consensus::Params& consensusParams);\nbool IsSuperM",https://github.com/bitcoin/bitcoin/pull/5968#discussion_r29419079,29419079,src/main.cpp
laanwj,2015-05-13T16:07:26Z,"You're changing the  counter data type here, is that intentional?\n",https://github.com/bitcoin/bitcoin/pull/5968#discussion_r30247046,30247046,src/main.cpp
jtimon,2015-05-13T18:39:28Z,"Yes, to avoid introducing a new warning.\n",https://github.com/bitcoin/bitcoin/pull/5968#discussion_r30261898,30261898,src/main.cpp
jtimon,2015-05-13T18:40:23Z,Another option would be to change consensusParams.nMajorityWindow to unsigned.\n,https://github.com/bitcoin/bitcoin/pull/5968#discussion_r30262010,30262010,src/main.cpp
laanwj,2015-05-15T11:46:11Z,"I'm happy with an int counter, just asked to be sure.\n",https://github.com/bitcoin/bitcoin/pull/5968#discussion_r30402510,30402510,src/main.cpp
