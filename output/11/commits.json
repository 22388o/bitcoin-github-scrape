[
  {
    "sha": "5f88e8887a31db68493334fc8e5652c5dd9cbf89",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo1Zjg4ZTg4ODdhMzFkYjY4NDkzMzM0ZmM4ZTU2NTJjNWRkOWNiZjg5",
    "commit": {
      "author": {
        "name": "Witchspace",
        "email": "witchspace81@gmail.com",
        "date": "2010-12-22T13:08:00Z"
      },
      "committer": {
        "name": "Witchspace",
        "email": "witchspace81@gmail.com",
        "date": "2010-12-22T13:08:00Z"
      },
      "message": "add -nolisten command line option",
      "tree": {
        "sha": "cc723c7d3424b54e06a7f50d96cd7af417e97d65",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/cc723c7d3424b54e06a7f50d96cd7af417e97d65"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5f88e8887a31db68493334fc8e5652c5dd9cbf89",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/5f88e8887a31db68493334fc8e5652c5dd9cbf89",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/5f88e8887a31db68493334fc8e5652c5dd9cbf89",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/5f88e8887a31db68493334fc8e5652c5dd9cbf89/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "2d96276e243c93add0b0d292ae9f05a54508b6e7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2d96276e243c93add0b0d292ae9f05a54508b6e7",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/2d96276e243c93add0b0d292ae9f05a54508b6e7"
      }
    ],
    "stats": {
      "total": 25,
      "additions": 17,
      "deletions": 8
    },
    "files": [
      {
        "sha": "cfb5d8e33040d53c0707b65ee656f0f2bbdc812b",
        "filename": "init.cpp",
        "status": "modified",
        "additions": 10,
        "deletions": 4,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/5f88e8887a31db68493334fc8e5652c5dd9cbf89/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/5f88e8887a31db68493334fc8e5652c5dd9cbf89/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/init.cpp?ref=5f88e8887a31db68493334fc8e5652c5dd9cbf89",
        "patch": "@@ -181,7 +181,8 @@ bool AppInit2(int argc, char* argv[])\n             \"  -rpcpassword=<pw>\\t  \"   + _(\"Password for JSON-RPC connections\\n\") +\n             \"  -rpcport=<port>  \\t\\t  \" + _(\"Listen for JSON-RPC connections on <port>\\n\") +\n             \"  -rpcallowip=<ip> \\t\\t  \" + _(\"Allow JSON-RPC connections from specified IP address\\n\") +\n-            \"  -rpcconnect=<ip> \\t  \"   + _(\"Send commands to node running on <ip>\\n\");\n+            \"  -rpcconnect=<ip> \\t  \"   + _(\"Send commands to node running on <ip>\\n\") +\n+            \"  -nolisten        \\t  \"   + _(\"Don't accept connections from outside\");\n \n #ifdef USE_SSL\n         strUsage += string() +\n@@ -211,6 +212,8 @@ bool AppInit2(int argc, char* argv[])\n     fPrintToDebugger = GetBoolArg(\"-printtodebugger\");\n \n     fTestNet = GetBoolArg(\"-testnet\");\n+    \n+    fNoListen = GetBoolArg(\"-nolisten\");\n \n     if (fCommandLine)\n     {\n@@ -290,10 +293,13 @@ bool AppInit2(int argc, char* argv[])\n \n     // Bind to the port early so we can tell if another instance is already running.\n     string strErrors;\n-    if (!BindListenPort(strErrors))\n+    if (!fNoListen)\n     {\n-        wxMessageBox(strErrors, \"Bitcoin\");\n-        return false;\n+        if (!BindListenPort(strErrors))\n+        {\n+            wxMessageBox(strErrors, \"Bitcoin\");\n+            return false;\n+        }\n     }\n \n     //"
      },
      {
        "sha": "a626acd3760c2267493f7b69367726e706e10d3b",
        "filename": "net.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 3,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/5f88e8887a31db68493334fc8e5652c5dd9cbf89/net.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/5f88e8887a31db68493334fc8e5652c5dd9cbf89/net.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/net.cpp?ref=5f88e8887a31db68493334fc8e5652c5dd9cbf89",
        "patch": "@@ -643,7 +643,9 @@ void ThreadSocketHandler2(void* parg)\n         FD_ZERO(&fdsetSend);\n         FD_ZERO(&fdsetError);\n         SOCKET hSocketMax = 0;\n-        FD_SET(hListenSocket, &fdsetRecv);\n+\n+        if(hListenSocket != INVALID_SOCKET)\n+            FD_SET(hListenSocket, &fdsetRecv);\n         hSocketMax = max(hSocketMax, hListenSocket);\n         CRITICAL_BLOCK(cs_vNodes)\n         {\n@@ -680,7 +682,7 @@ void ThreadSocketHandler2(void* parg)\n         //\n         // Accept new connections\n         //\n-        if (FD_ISSET(hListenSocket, &fdsetRecv))\n+        if (hListenSocket != INVALID_SOCKET && FD_ISSET(hListenSocket, &fdsetRecv))\n         {\n             struct sockaddr_in sockaddr;\n             socklen_t len = sizeof(sockaddr);\n@@ -1344,7 +1346,7 @@ void StartNode(void* parg)\n #endif\n     printf(\"addrLocalHost = %s\\n\", addrLocalHost.ToString().c_str());\n \n-    if (fUseProxy || mapArgs.count(\"-connect\"))\n+    if (fUseProxy || mapArgs.count(\"-connect\") || fNoListen)\n     {\n         // Proxies can't take incoming connections\n         addrLocalHost.ip = CAddress(\"0.0.0.0\").ip;"
      },
      {
        "sha": "694f913045073e1f02be933e1d8924dfdeae7121",
        "filename": "util.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/5f88e8887a31db68493334fc8e5652c5dd9cbf89/util.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/5f88e8887a31db68493334fc8e5652c5dd9cbf89/util.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/util.cpp?ref=5f88e8887a31db68493334fc8e5652c5dd9cbf89",
        "patch": "@@ -17,7 +17,7 @@ bool fDaemon = false;\n bool fCommandLine = false;\n string strMiscWarning;\n bool fTestNet = false;\n-\n+bool fNoListen = false;\n \n \n "
      },
      {
        "sha": "c69bf1ce17fdb2556a20ffe7eba5a3da7985ee6d",
        "filename": "util.h",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/5f88e8887a31db68493334fc8e5652c5dd9cbf89/util.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/5f88e8887a31db68493334fc8e5652c5dd9cbf89/util.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/util.h?ref=5f88e8887a31db68493334fc8e5652c5dd9cbf89",
        "patch": "@@ -146,6 +146,7 @@ extern bool fDaemon;\n extern bool fCommandLine;\n extern string strMiscWarning;\n extern bool fTestNet;\n+extern bool fNoListen;\n \n void RandAddSeed();\n void RandAddSeedPerfmon();"
      }
    ]
  },
  {
    "sha": "72b9861635dcdb9fd73b84bbb43b3f755bc9f64a",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3MmI5ODYxNjM1ZGNkYjlmZDczYjg0YmJiNDNiM2Y3NTViYzlmNjRh",
    "commit": {
      "author": {
        "name": "Witchspace",
        "email": "witchspace81@gmail.com",
        "date": "2010-12-24T09:25:21Z"
      },
      "committer": {
        "name": "Witchspace",
        "email": "witchspace81@gmail.com",
        "date": "2010-12-24T09:25:21Z"
      },
      "message": "don't advertise on IRC if we don't allow external connections",
      "tree": {
        "sha": "34be4b0e0e9fee049314bdf72b41ff0274b2de06",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/34be4b0e0e9fee049314bdf72b41ff0274b2de06"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/72b9861635dcdb9fd73b84bbb43b3f755bc9f64a",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/72b9861635dcdb9fd73b84bbb43b3f755bc9f64a",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/72b9861635dcdb9fd73b84bbb43b3f755bc9f64a",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/72b9861635dcdb9fd73b84bbb43b3f755bc9f64a/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "5f88e8887a31db68493334fc8e5652c5dd9cbf89",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/5f88e8887a31db68493334fc8e5652c5dd9cbf89",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/5f88e8887a31db68493334fc8e5652c5dd9cbf89"
      }
    ],
    "stats": {
      "total": 4,
      "additions": 3,
      "deletions": 1
    },
    "files": [
      {
        "sha": "5adaf11658b11238c13859b3aefb0b7418223b1a",
        "filename": "irc.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 1,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/72b9861635dcdb9fd73b84bbb43b3f755bc9f64a/irc.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/72b9861635dcdb9fd73b84bbb43b3f755bc9f64a/irc.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/irc.cpp?ref=72b9861635dcdb9fd73b84bbb43b3f755bc9f64a",
        "patch": "@@ -257,8 +257,10 @@ void ThreadIRCSeed(void* parg)\n \n void ThreadIRCSeed2(void* parg)\n {\n-    if (mapArgs.count(\"-connect\"))\n+    /* Dont advertise on IRC if we don't allow incoming connections */\n+    if (mapArgs.count(\"-connect\") || fNoListen)\n         return;\n+\n     if (GetBoolArg(\"-noirc\"))\n         return;\n     printf(\"ThreadIRCSeed started\\n\");"
      }
    ]
  }
]