[
  {
    "sha": "1410dcdc8f5166a59a3cbb2a7075d81447f40263",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxNDEwZGNkYzhmNTE2NmE1OWEzY2JiMmE3MDc1ZDgxNDQ3ZjQwMjYz",
    "commit": {
      "author": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2017-11-25T08:28:14Z"
      },
      "committer": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2017-11-25T08:28:14Z"
      },
      "message": "Add missing cs_main lock in rest/getutxos",
      "tree": {
        "sha": "98b2c99f7f2ed6f10a99ef494a8780d56d59ff9c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/98b2c99f7f2ed6f10a99ef494a8780d56d59ff9c"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1410dcdc8f5166a59a3cbb2a7075d81447f40263",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyhopCNzi8TB0xizeHrd2uwPHki0FAloZKa4ACgkQHrd2uwPH\nki3HSg/+ObhgrD1bCv/K+dRYLYQSDUFhUFTUs3Unq7zhvyxnjqByYhUUfUkfjriq\nEla1C/+HD3AY3rkRim6XyutQppPp/GWXSLp//hDTIjMva8gMVVFkhMaale/YrcOa\nvdYF9RGOrwJjXKJm0Nq2TMhn7qYC+l0rVd6mRjKB/cuYB8WaglDt/DISurTc822v\n85TPTZVJ1ed+1oVenw8rGFnfSD0wf6lIg7/wMnw2w19Voen7ki0MgNcdHItO0Z3k\npUXfZB2pu6tixnBZTt068NgizQ+QV2CTszam1fG+BamSdgzEQYi/XKs+MS/91TTn\nk/VPcqCX+osiQxuC6MF2cOvHHKyZBh6fUPFLHf97A7uSXInE1NBGW/ApBQSpPk18\n3mysMF5xuhdxdoOgzAydIsNTafIndn96iiP1E3fHxYeLrpHrBC5HuISttdpnwvoe\nv1N2yHnvwayCWtpv9r1Mb73kJvU8bmvGIVfc0Mq4biSwYJaZUOK4vcpGsQpu27aC\n7VhW+0CWSBZeTwvt5FMfU5tsqE57eSYp6DdDVzhzrt2v8yv3ORsQgAA8YuRtKZ6W\nBetbXnGXNjGNczlY164/eYJZWeqfWhWKGoECB5w+f3bMCz+YvcgHf1dTtJftiDda\ngXmZ17Kr1r3VxhKEkzRULNNRuasUyKH1Y+hmS/2aNcqkT7GrvlA=\n=4lfD\n-----END PGP SIGNATURE-----",
        "payload": "tree 98b2c99f7f2ed6f10a99ef494a8780d56d59ff9c\nparent a933cb14c75b9c79a02f8de8397a8eae405a264f\nauthor Jonas Schnelli <dev@jonasschnelli.ch> 1511598494 -1000\ncommitter Jonas Schnelli <dev@jonasschnelli.ch> 1511598494 -1000\n\nAdd missing cs_main lock in rest/getutxos\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1410dcdc8f5166a59a3cbb2a7075d81447f40263",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/1410dcdc8f5166a59a3cbb2a7075d81447f40263",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1410dcdc8f5166a59a3cbb2a7075d81447f40263/comments",
    "author": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "a933cb14c75b9c79a02f8de8397a8eae405a264f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a933cb14c75b9c79a02f8de8397a8eae405a264f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/a933cb14c75b9c79a02f8de8397a8eae405a264f"
      }
    ],
    "stats": {
      "total": 17,
      "additions": 13,
      "deletions": 4
    },
    "files": [
      {
        "sha": "badd781c653f6562c50e8a26030f137b47056a96",
        "filename": "src/rest.cpp",
        "status": "modified",
        "additions": 13,
        "deletions": 4,
        "changes": 17,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1410dcdc8f5166a59a3cbb2a7075d81447f40263/src/rest.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1410dcdc8f5166a59a3cbb2a7075d81447f40263/src/rest.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rest.cpp?ref=1410dcdc8f5166a59a3cbb2a7075d81447f40263",
        "patch": "@@ -517,7 +517,10 @@ static bool rest_getutxos(HTTPRequest* req, const std::string& strURIPart)\n         // serialize data\n         // use exact same output as mentioned in Bip64\n         CDataStream ssGetUTXOResponse(SER_NETWORK, PROTOCOL_VERSION);\n-        ssGetUTXOResponse << chainActive.Height() << chainActive.Tip()->GetBlockHash() << bitmap << outs;\n+        {\n+            LOCK(cs_main);\n+            ssGetUTXOResponse << chainActive.Height() << chainActive.Tip()->GetBlockHash() << bitmap << outs;\n+        }\n         std::string ssGetUTXOResponseString = ssGetUTXOResponse.str();\n \n         req->WriteHeader(\"Content-Type\", \"application/octet-stream\");\n@@ -527,7 +530,10 @@ static bool rest_getutxos(HTTPRequest* req, const std::string& strURIPart)\n \n     case RF_HEX: {\n         CDataStream ssGetUTXOResponse(SER_NETWORK, PROTOCOL_VERSION);\n-        ssGetUTXOResponse << chainActive.Height() << chainActive.Tip()->GetBlockHash() << bitmap << outs;\n+        {\n+            LOCK(cs_main);\n+            ssGetUTXOResponse << chainActive.Height() << chainActive.Tip()->GetBlockHash() << bitmap << outs;\n+        }\n         std::string strHex = HexStr(ssGetUTXOResponse.begin(), ssGetUTXOResponse.end()) + \"\\n\";\n \n         req->WriteHeader(\"Content-Type\", \"text/plain\");\n@@ -540,8 +546,11 @@ static bool rest_getutxos(HTTPRequest* req, const std::string& strURIPart)\n \n         // pack in some essentials\n         // use more or less the same output as mentioned in Bip64\n-        objGetUTXOResponse.push_back(Pair(\"chainHeight\", chainActive.Height()));\n-        objGetUTXOResponse.push_back(Pair(\"chaintipHash\", chainActive.Tip()->GetBlockHash().GetHex()));\n+        {\n+            LOCK(cs_main);\n+            objGetUTXOResponse.push_back(Pair(\"chainHeight\", chainActive.Height()));\n+            objGetUTXOResponse.push_back(Pair(\"chaintipHash\", chainActive.Tip()->GetBlockHash().GetHex()));\n+        }\n         objGetUTXOResponse.push_back(Pair(\"bitmap\", bitmapStringRepresentation));\n \n         UniValue utxos(UniValue::VARR);"
      }
    ]
  }
]