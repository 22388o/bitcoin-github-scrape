gmaxwell,2017-01-08T05:35:16Z,"I am somewhat dubious that it's feasible to determine and maintain that various bits of code do not take cs_main anywhere in their call graph.\n\nI think code like this might need a new debug tool where you can poison_lock(cs_main) which increments a thread local counter while it is in scope. And if the counter is positive when cs_main is taken it causes an assertion/debug print. ",https://github.com/bitcoin/bitcoin/pull/9488#issuecomment-271131335,271131335,
TheBlueMatt,2017-01-08T05:45:48Z,"Yea, I thought about adding something like that and never got around to it...I'll try to add it to this in the coming days.",https://github.com/bitcoin/bitcoin/pull/9488#issuecomment-271131679,271131679,
TheBlueMatt,2017-01-10T19:57:14Z,Added a DEBUG_LOCKORDER check to prevent cs_main.,https://github.com/bitcoin/bitcoin/pull/9488#issuecomment-271680739,271680739,
TheBlueMatt,2017-01-17T15:42:52Z,Closing for now. Will work towards a more whole solution for 0.15.,https://github.com/bitcoin/bitcoin/pull/9488#issuecomment-273205526,273205526,
gmaxwell,2017-01-08T05:29:59Z,cs_main is taken by ProcessGetData  at like 2456 above. (github won't let me comment there).,https://github.com/bitcoin/bitcoin/pull/9488#discussion_r95072053,95072053,src/net_processing.cpp
TheBlueMatt,2017-01-08T05:49:07Z,Fixed,https://github.com/bitcoin/bitcoin/pull/9488#discussion_r95072242,95072242,src/net_processing.cpp
