[
  {
    "sha": "1b9dc5340264912ad06202ffef7a8b954615fabe",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxYjlkYzUzNDAyNjQ5MTJhZDA2MjAyZmZlZjdhOGI5NTQ2MTVmYWJl",
    "commit": {
      "author": {
        "name": "Emanuele Cisbani",
        "email": "emanuele.cisbani@gmail.com",
        "date": "2018-09-09T10:30:45Z"
      },
      "committer": {
        "name": "Emanuele Cisbani",
        "email": "emanuele.cisbani@gmail.com",
        "date": "2018-09-09T10:37:56Z"
      },
      "message": "Scripts and tools: fix two gitian build issues related to Debian and MacOSX SDK\n\nThe [documentation](https://github.com/bitcoin-core/docs/blob/master/gitian-building.md) suggest to use debian 8.x, but the script bin/make-base-vm is invoked with '--suite bionic\u2019 that on debian rises an error (not easy to understand for a newby). It is solved detecting automatically the distro and the suite-codename invoking lsb_release.\n\nThe [documentation](https://github.com/bitcoin-core/docs/blob/master/gitian-building/gitian-building-mac-os-sdk.md) instrunct to create the directory \u2018gitian-builder/inputs\u2019 with the MacOSX  SDK inside. The presence of this path does not consent to clone the gitian-builder repos and rises a subsequent error not clearly related to the issue. It is solved checking the presence of the \u2018.git\u2019 inside and moving the SDK temporary outside, relocating at his place after cloning.",
      "tree": {
        "sha": "ee007ce503232d95e5333f0244a7f51623edc8b0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ee007ce503232d95e5333f0244a7f51623edc8b0"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1b9dc5340264912ad06202ffef7a8b954615fabe",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1b9dc5340264912ad06202ffef7a8b954615fabe",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/1b9dc5340264912ad06202ffef7a8b954615fabe",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1b9dc5340264912ad06202ffef7a8b954615fabe/comments",
    "author": {
      "login": "cisba",
      "id": 2389559,
      "node_id": "MDQ6VXNlcjIzODk1NTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2389559?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cisba",
      "html_url": "https://github.com/cisba",
      "followers_url": "https://api.github.com/users/cisba/followers",
      "following_url": "https://api.github.com/users/cisba/following{/other_user}",
      "gists_url": "https://api.github.com/users/cisba/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cisba/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cisba/subscriptions",
      "organizations_url": "https://api.github.com/users/cisba/orgs",
      "repos_url": "https://api.github.com/users/cisba/repos",
      "events_url": "https://api.github.com/users/cisba/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cisba/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "cisba",
      "id": 2389559,
      "node_id": "MDQ6VXNlcjIzODk1NTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2389559?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cisba",
      "html_url": "https://github.com/cisba",
      "followers_url": "https://api.github.com/users/cisba/followers",
      "following_url": "https://api.github.com/users/cisba/following{/other_user}",
      "gists_url": "https://api.github.com/users/cisba/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cisba/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cisba/subscriptions",
      "organizations_url": "https://api.github.com/users/cisba/orgs",
      "repos_url": "https://api.github.com/users/cisba/repos",
      "events_url": "https://api.github.com/users/cisba/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cisba/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "cb25cd6aa18c69918176d68e36e26f7e373aa48c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/cb25cd6aa18c69918176d68e36e26f7e373aa48c",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/cb25cd6aa18c69918176d68e36e26f7e373aa48c"
      }
    ],
    "stats": {
      "total": 11,
      "additions": 9,
      "deletions": 2
    },
    "files": [
      {
        "sha": "7760d9f9f6f6150c71bb4af0d357b2110c4a0d73",
        "filename": "contrib/gitian-build.py",
        "status": "modified",
        "additions": 9,
        "deletions": 2,
        "changes": 11,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1b9dc5340264912ad06202ffef7a8b954615fabe/contrib/gitian-build.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1b9dc5340264912ad06202ffef7a8b954615fabe/contrib/gitian-build.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/gitian-build.py?ref=1b9dc5340264912ad06202ffef7a8b954615fabe",
        "patch": "@@ -4,6 +4,7 @@\n import os\n import subprocess\n import sys\n+import shutil\n \n def setup():\n     global args, workdir\n@@ -26,12 +27,18 @@ def setup():\n         subprocess.check_call(['git', 'clone', 'https://github.com/bitcoin-core/gitian.sigs.git'])\n     if not os.path.isdir('bitcoin-detached-sigs'):\n         subprocess.check_call(['git', 'clone', 'https://github.com/bitcoin-core/bitcoin-detached-sigs.git'])\n-    if not os.path.isdir('gitian-builder'):\n+    if not os.path.isdir('gitian-builder/.git'):\n+        if os.path.isdir('gitian-builder/inputs'):\n+            shutil.move('gitian-builder/inputs', 'gitian-builder-inputs')\n         subprocess.check_call(['git', 'clone', 'https://github.com/devrandom/gitian-builder.git'])\n+        if os.path.isdir('gitian-builder-inputs'):\n+            shutil.move('gitian-builder-inputs', 'gitian-builder/inputs')\n     if not os.path.isdir('bitcoin'):\n         subprocess.check_call(['git', 'clone', 'https://github.com/bitcoin/bitcoin.git'])\n     os.chdir('gitian-builder')\n-    make_image_prog = ['bin/make-base-vm', '--suite', 'bionic', '--arch', 'amd64']\n+    distro = subprocess.check_output(['lsb_release', '-is']).decode(\"utf-8\").strip('\\n').lower()\n+    suite = subprocess.check_output(['lsb_release', '-cs']).decode(\"utf-8\").strip('\\n')\n+    make_image_prog = ['bin/make-base-vm', '--distro', distro, '--suite', suite, '--arch', 'amd64']\n     if args.docker:\n         make_image_prog += ['--docker']\n     elif not args.kvm:"
      }
    ]
  },
  {
    "sha": "97d9bf88a7f2c6ec63c6c633ac901554f63b098d",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo5N2Q5YmY4OGE3ZjJjNmVjNjNjNmM2MzNhYzkwMTU1NGY2M2IwOThk",
    "commit": {
      "author": {
        "name": "Emanuele Cisbani",
        "email": "emanuele.cisbani@gmail.com",
        "date": "2018-09-09T14:01:03Z"
      },
      "committer": {
        "name": "Emanuele Cisbani",
        "email": "emanuele.cisbani@gmail.com",
        "date": "2018-09-09T14:01:03Z"
      },
      "message": "Scripts and tools: fix missed curl in setup\n\nThe curl package is required for the build process as described [here](https://github.com/bitcoin/bitcoin/blob/master/depends/README.md).",
      "tree": {
        "sha": "9687586da774c6f36d87770912bc81a1e75fa99b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9687586da774c6f36d87770912bc81a1e75fa99b"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/97d9bf88a7f2c6ec63c6c633ac901554f63b098d",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/97d9bf88a7f2c6ec63c6c633ac901554f63b098d",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/97d9bf88a7f2c6ec63c6c633ac901554f63b098d",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/97d9bf88a7f2c6ec63c6c633ac901554f63b098d/comments",
    "author": {
      "login": "cisba",
      "id": 2389559,
      "node_id": "MDQ6VXNlcjIzODk1NTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2389559?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cisba",
      "html_url": "https://github.com/cisba",
      "followers_url": "https://api.github.com/users/cisba/followers",
      "following_url": "https://api.github.com/users/cisba/following{/other_user}",
      "gists_url": "https://api.github.com/users/cisba/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cisba/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cisba/subscriptions",
      "organizations_url": "https://api.github.com/users/cisba/orgs",
      "repos_url": "https://api.github.com/users/cisba/repos",
      "events_url": "https://api.github.com/users/cisba/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cisba/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "cisba",
      "id": 2389559,
      "node_id": "MDQ6VXNlcjIzODk1NTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2389559?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cisba",
      "html_url": "https://github.com/cisba",
      "followers_url": "https://api.github.com/users/cisba/followers",
      "following_url": "https://api.github.com/users/cisba/following{/other_user}",
      "gists_url": "https://api.github.com/users/cisba/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cisba/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cisba/subscriptions",
      "organizations_url": "https://api.github.com/users/cisba/orgs",
      "repos_url": "https://api.github.com/users/cisba/repos",
      "events_url": "https://api.github.com/users/cisba/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cisba/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "1b9dc5340264912ad06202ffef7a8b954615fabe",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1b9dc5340264912ad06202ffef7a8b954615fabe",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/1b9dc5340264912ad06202ffef7a8b954615fabe"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 1,
      "deletions": 1
    },
    "files": [
      {
        "sha": "b4e6333b9eff622e1800de900b3433f15f76b8e2",
        "filename": "contrib/gitian-build.py",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/97d9bf88a7f2c6ec63c6c633ac901554f63b098d/contrib/gitian-build.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/97d9bf88a7f2c6ec63c6c633ac901554f63b098d/contrib/gitian-build.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/gitian-build.py?ref=97d9bf88a7f2c6ec63c6c633ac901554f63b098d",
        "patch": "@@ -8,7 +8,7 @@\n \n def setup():\n     global args, workdir\n-    programs = ['ruby', 'git', 'apt-cacher-ng', 'make', 'wget']\n+    programs = ['ruby', 'git', 'apt-cacher-ng', 'make', 'wget', 'curl']\n     if args.kvm:\n         programs += ['python-vm-builder', 'qemu-kvm', 'qemu-utils']\n     elif args.docker:"
      }
    ]
  }
]