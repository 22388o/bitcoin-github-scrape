laanwj,2019-08-01 12:47:47,"Concept ACK, not sure whether there's reasons someone would want to disable this, but in any case I think privacy-by-default behavior is good",https://github.com/bitcoin/bitcoin/pull/16512#issuecomment-517272223,517272223,
practicalswift,2019-08-01 16:44:55,Concept ACK,https://github.com/bitcoin/bitcoin/pull/16512#issuecomment-517367590,517367590,
fanquake,2019-08-14 09:37:23,"Concept ACK - Can we get some sort of simple test case to ensure that there's some shuffling going on.\n\n> but in any case I think privacy-by-default behavior is good\n\nDefinitely agree.\n\nI guess this should also be backported given the patch is fairly simple and it's a privacy improvement?",https://github.com/bitcoin/bitcoin/pull/16512#issuecomment-521176179,521176179,
achow101,2019-08-14 18:31:16,I've added a test. It runs joinpsbts multiple times and checks whether at least one of the resulting psbts are different.,https://github.com/bitcoin/bitcoin/pull/16512#issuecomment-521364423,521364423,
achow101,2019-08-15 00:22:51,Added a release note.,https://github.com/bitcoin/bitcoin/pull/16512#issuecomment-521467147,521467147,
DrahtBot,2019-08-15 01:10:56,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#16839](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16839.html) (Replace Connman and BanMan globals with Nod",https://github.com/bitcoin/bitcoin/pull/16512#issuecomment-521476619,521476619,
luke-jr,2019-08-20 00:55:54,"Only bugfixes should be backported, not improvements...",https://github.com/bitcoin/bitcoin/pull/16512#issuecomment-522808974,522808974,
JeremyRubin,2019-08-20 01:37:00,Wouldn't it be better to deterministically sort them?,https://github.com/bitcoin/bitcoin/pull/16512#issuecomment-522816735,522816735,
achow101,2019-08-20 02:33:00,"> Wouldn't it be better to deterministically sort them?\n\nNot at all. That gives a different privacy leak as it will indicate that `joinpsbts` has been used on that transaction.",https://github.com/bitcoin/bitcoin/pull/16512#issuecomment-522827469,522827469,
JeremyRubin,2019-08-20 17:28:00,Hm gotcha. I was unclear of the status of BIP-69 and related standard adoption efforts for Core,https://github.com/bitcoin/bitcoin/pull/16512#issuecomment-523115160,523115160,
instagibbs,2019-08-27 14:47:34,"> Only bugfixes should be backported, not improvements...\n\nPrivacy leak is a bug imo. Everywhere else we(should be) shuffle.\n",https://github.com/bitcoin/bitcoin/pull/16512#issuecomment-525335864,525335864,
nopara73,2019-09-04 14:42:35,Concept ACK. Related: https://github.com/bitcoin/bitcoin/issues/12457,https://github.com/bitcoin/bitcoin/pull/16512#issuecomment-527932804,527932804,
jonatack,2019-09-17 16:58:07,@achow101 what did you think of [this question / suggestion](https://github.com/bitcoin/bitcoin/pull/16512#pullrequestreview-283522359) above?,https://github.com/bitcoin/bitcoin/pull/16512#issuecomment-532308583,532308583,
achow101,2019-09-17 17:07:58,"> Is testing joinpsbt inequality in rpc_psbt.py enough?\n\nIt should be.\n\n> Could the manual copy+shuffling be extracted and covered by unit tests? e.g. as a member function of PartiallySignedTransaction?\n\nMaybe later? I would like this merged for 0.19 so I do want any further changes to this to be minimal.",https://github.com/bitcoin/bitcoin/pull/16512#issuecomment-532312385,532312385,
instagibbs,2019-09-17 17:08:13,utACK https://github.com/bitcoin/bitcoin/pull/16512/commits/c0b5d9710322a614a50ab5da081558cf6a38ad2a ,https://github.com/bitcoin/bitcoin/pull/16512#issuecomment-532312493,532312493,
jonatack,2019-09-17 17:16:22,"> > Could the manual copy+shuffling be extracted and covered by unit tests? e.g. as a member function of PartiallySignedTransaction?\n> \n> Maybe later? I would like this merged for 0.19 so I do want any further changes to this to be minimal.\n\nFair enough. I might propose it later.",https://github.com/bitcoin/bitcoin/pull/16512#issuecomment-532315682,532315682,
jonatack,2019-09-18 12:58:13,ACK c0b5d9710322a614a50ab5da081558cf6a38ad2a modulo suggestions for later.,https://github.com/bitcoin/bitcoin/pull/16512#issuecomment-532672240,532672240,
laanwj,2019-09-18 14:19:44,"ACK c0b5d9710322a614a50ab5da081558cf6a38ad2a\n\nAgree the shuffling should ideally be factored out to a function, but that can be done in a future PR",https://github.com/bitcoin/bitcoin/pull/16512#issuecomment-532706478,532706478,
fanquake,2019-09-19 01:59:04,Added for backport in #16617.,https://github.com/bitcoin/bitcoin/pull/16512#issuecomment-532932862,532932862,
promag,2019-07-31 23:05:57,Unnecessary comment? Or maybe move it to L1607 like `Shuffle inputs and outputs of the merged PSBT`.,https://github.com/bitcoin/bitcoin/pull/16512#discussion_r309467183,309467183,src/rpc/rawtransaction.cpp
achow101,2019-08-01 19:56:56,Removed the comment and updated the one above.,https://github.com/bitcoin/bitcoin/pull/16512#discussion_r309871010,309871010,src/rpc/rawtransaction.cpp
promag,2019-08-14 22:47:26,"nit, could break if shuffled.",https://github.com/bitcoin/bitcoin/pull/16512#discussion_r314116083,314116083,test/functional/rpc_psbt.py
promag,2019-08-14 22:50:59,"nit, could improve comment like ""10 attempts should be enough to get a shuffled join"".",https://github.com/bitcoin/bitcoin/pull/16512#discussion_r314116940,314116940,test/functional/rpc_psbt.py
promag,2019-08-14 22:58:14,Should `#include <random.h>`,https://github.com/bitcoin/bitcoin/pull/16512#discussion_r314118616,314118616,src/rpc/rawtransaction.cpp
achow101,2019-08-15 00:22:37,Done,https://github.com/bitcoin/bitcoin/pull/16512#discussion_r314136258,314136258,test/functional/rpc_psbt.py
achow101,2019-08-15 00:22:41,Done,https://github.com/bitcoin/bitcoin/pull/16512#discussion_r314136272,314136272,test/functional/rpc_psbt.py
achow101,2019-08-15 00:22:45,Done,https://github.com/bitcoin/bitcoin/pull/16512#discussion_r314136284,314136284,src/rpc/rawtransaction.cpp
instagibbs,2019-08-27 14:49:52,"I think it's simpler to just do an infinite loop and break IFF a difference is found, makes it less dependent on number of inputs and lowers false negatives",https://github.com/bitcoin/bitcoin/pull/16512#discussion_r318126162,318126162,test/functional/rpc_psbt.py
instagibbs,2019-08-27 14:54:02,"> std::iota\n\nnot sure we should be adding IOTA support to Core\n\n\n\n\n\n\n(this is a joke)",https://github.com/bitcoin/bitcoin/pull/16512#discussion_r318128643,318128643,src/rpc/rawtransaction.cpp
instagibbs,2019-08-27 15:02:11,"Forgive me, why are we not just shuffling the vector of inputs and outputs in `merged_psbt` using `Shuffle` directly?",https://github.com/bitcoin/bitcoin/pull/16512#discussion_r318133389,318133389,src/rpc/rawtransaction.cpp
promag,2019-08-27 15:27:38,Do you mean just replacing the line below with `while True:`? If you mean to drop `shuffled` then what would you assert after the loop?,https://github.com/bitcoin/bitcoin/pull/16512#discussion_r318147346,318147346,test/functional/rpc_psbt.py
instagibbs,2019-08-27 15:34:56,"just saying remove the 10 times limit, maybe makes the logic simpler. hanging with implementation bug is better than false negative imo",https://github.com/bitcoin/bitcoin/pull/16512#discussion_r318151348,318151348,test/functional/rpc_psbt.py
promag,2019-08-27 15:39:33,"I agree with you but it it isn't that informative. Suppose it hangs in travis, you would be clueless.",https://github.com/bitcoin/bitcoin/pull/16512#discussion_r318153789,318153789,test/functional/rpc_psbt.py
instagibbs,2019-08-27 15:45:42,"Wouldn't be clueless if it printed out what tests are still running, but those PRs have been unable to get merged, sad!\n\nCould just bump it to some fairly ridiculous number that's unlikely to be hit even if the test itself is modified significantly. I think the easiest case to get a false negative is just two entries, 50/50 chance, so run that 128 times and we're fine :P",https://github.com/bitcoin/bitcoin/pull/16512#discussion_r318157116,318157116,test/functional/rpc_psbt.py
achow101,2019-08-27 16:14:19,"There are two input vectors and output vectors. The on in the global tx, and the one in the psbt metadata. Both need to line up, so by shuffling the indicies, each input and output can be lined up with its respective metadata.",https://github.com/bitcoin/bitcoin/pull/16512#discussion_r318171332,318171332,src/rpc/rawtransaction.cpp
instagibbs,2019-08-27 16:19:58,"ah! Missed how the actual transaction was being reconstructed, got it.",https://github.com/bitcoin/bitcoin/pull/16512#discussion_r318173935,318173935,src/rpc/rawtransaction.cpp
jonatack,2019-09-04 10:32:21,"Suggested change:\n```python\n-        for i in range(0, 10):\n+        for _ in range(10):\n```",https://github.com/bitcoin/bitcoin/pull/16512#discussion_r320687551,320687551,test/functional/rpc_psbt.py
jonatack,2019-09-04 10:34:18,"Suggested change:\n```python\n-        # Check that joining shuffles the inputs and outputs\n-        # 10 attempts should be enough to get a shuffled join\n\n+        # Check that joining shuffles the inputs and outputs.\n+        # Run up to 10 attempts to ensure seeing a shuffled join.\n```",https://github.com/bitcoin/bitcoin/pull/16512#discussion_r320688239,320688239,test/functional/rpc_psbt.py
jonatack,2019-09-04 10:42:43,"Suggested change for git grepping, mainly the line ""// Shuffle input and output indices lists"" to have a comment beginning with ""Shuffle"" like:\n```cpp\nsrc/wallet/rpcwallet.cpp:913: // Shuffle recipient list\nsrc/wallet/wallet.cpp:3211: // Shuffle selected coins and fill in final vin\n```\n```cpp\n    // Generate lists of input and output indices of the merged PSBT\n    // to be shuffled.",https://github.com/bitcoin/bitcoin/pull/16512#discussion_r320691211,320691211,src/rpc/rawtransaction.cpp
jonatack,2019-09-04 10:54:52,"Perhaps provide more context on ""why"" and what the previous behavior was, like in your PR description.",https://github.com/bitcoin/bitcoin/pull/16512#discussion_r320695520,320695520,doc/release-notes-16512.md
jonatack,2019-09-04 11:04:54,"Note that the proposed change places the two Shuffle functions together. First generate the lists, then perform the shuffles.",https://github.com/bitcoin/bitcoin/pull/16512#discussion_r320698946,320698946,src/rpc/rawtransaction.cpp
achow101,2019-09-04 21:39:51,I think 10 is enough for now.,https://github.com/bitcoin/bitcoin/pull/16512#discussion_r320987709,320987709,test/functional/rpc_psbt.py
achow101,2019-09-04 21:40:29,meh. not important enough to change,https://github.com/bitcoin/bitcoin/pull/16512#discussion_r320987929,320987929,test/functional/rpc_psbt.py
achow101,2019-09-04 21:40:35,meh. not important enough to change,https://github.com/bitcoin/bitcoin/pull/16512#discussion_r320987956,320987956,test/functional/rpc_psbt.py
achow101,2019-09-04 21:44:46,Done,https://github.com/bitcoin/bitcoin/pull/16512#discussion_r320989404,320989404,src/rpc/rawtransaction.cpp
achow101,2019-09-04 21:44:50,Done,https://github.com/bitcoin/bitcoin/pull/16512#discussion_r320989431,320989431,doc/release-notes-16512.md
jonatack,2019-09-05 21:03:17,nit (if you need to retouch this): s/indicies/indices/,https://github.com/bitcoin/bitcoin/pull/16512#discussion_r321480004,321480004,src/rpc/rawtransaction.cpp
instagibbs,2019-09-05 21:15:00,first test failure you're getting strung up :P,https://github.com/bitcoin/bitcoin/pull/16512#discussion_r321486399,321486399,test/functional/rpc_psbt.py
