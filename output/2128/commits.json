[
  {
    "sha": "c80efe132575f2ca65479d784f18f5c6e6d478ec",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpjODBlZmUxMzI1NzVmMmNhNjU0NzlkNzg0ZjE4ZjVjNmU2ZDQ3OGVj",
    "commit": {
      "author": {
        "name": "Cameron Garnham",
        "email": "da2ce7@gmail.com",
        "date": "2012-12-26T01:26:07Z"
      },
      "committer": {
        "name": "Cameron Garnham",
        "email": "da2ce7@gmail.com",
        "date": "2013-07-12T07:40:40Z"
      },
      "message": "updated windows installer script",
      "tree": {
        "sha": "8d45bceb9678f07ce87c556994e28a3d509bdc5a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8d45bceb9678f07ce87c556994e28a3d509bdc5a"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c80efe132575f2ca65479d784f18f5c6e6d478ec",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c80efe132575f2ca65479d784f18f5c6e6d478ec",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/c80efe132575f2ca65479d784f18f5c6e6d478ec",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c80efe132575f2ca65479d784f18f5c6e6d478ec/comments",
    "author": {
      "login": "da2ce7",
      "id": 691439,
      "node_id": "MDQ6VXNlcjY5MTQzOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/691439?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/da2ce7",
      "html_url": "https://github.com/da2ce7",
      "followers_url": "https://api.github.com/users/da2ce7/followers",
      "following_url": "https://api.github.com/users/da2ce7/following{/other_user}",
      "gists_url": "https://api.github.com/users/da2ce7/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/da2ce7/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/da2ce7/subscriptions",
      "organizations_url": "https://api.github.com/users/da2ce7/orgs",
      "repos_url": "https://api.github.com/users/da2ce7/repos",
      "events_url": "https://api.github.com/users/da2ce7/events{/privacy}",
      "received_events_url": "https://api.github.com/users/da2ce7/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "da2ce7",
      "id": 691439,
      "node_id": "MDQ6VXNlcjY5MTQzOQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/691439?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/da2ce7",
      "html_url": "https://github.com/da2ce7",
      "followers_url": "https://api.github.com/users/da2ce7/followers",
      "following_url": "https://api.github.com/users/da2ce7/following{/other_user}",
      "gists_url": "https://api.github.com/users/da2ce7/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/da2ce7/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/da2ce7/subscriptions",
      "organizations_url": "https://api.github.com/users/da2ce7/orgs",
      "repos_url": "https://api.github.com/users/da2ce7/repos",
      "events_url": "https://api.github.com/users/da2ce7/events{/privacy}",
      "received_events_url": "https://api.github.com/users/da2ce7/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "d598872726ce9e2cbabdf705a616495c44851c2c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d598872726ce9e2cbabdf705a616495c44851c2c",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/d598872726ce9e2cbabdf705a616495c44851c2c"
      }
    ],
    "stats": {
      "total": 75,
      "additions": 40,
      "deletions": 35
    },
    "files": [
      {
        "sha": "537e865028e5de404a1f947616e0ccd24b60f1d4",
        "filename": "share/setup.nsi",
        "status": "modified",
        "additions": 40,
        "deletions": 35,
        "changes": 75,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/c80efe132575f2ca65479d784f18f5c6e6d478ec/share/setup.nsi",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/c80efe132575f2ca65479d784f18f5c6e6d478ec/share/setup.nsi",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/share/setup.nsi?ref=c80efe132575f2ca65479d784f18f5c6e6d478ec",
        "patch": "@@ -1,11 +1,14 @@\n Name Bitcoin\r\n \r\n-RequestExecutionLevel highest\r\n+RequestExecutionLevel admin\r\n SetCompressor /SOLID lzma\r\n \r\n+!define NAME Bitcoin\r\n+\r\n # General Symbol Definitions\r\n-!define REGKEY \"SOFTWARE\\$(^Name)\"\r\n+!define REGKEY \"SOFTWARE\\${NAME}\"\r\n !define VERSION 0.8.2\r\n+!define PRODUCT_VERSION \"${VERSION}.0\"\r\n !define COMPANY \"Bitcoin project\"\r\n !define URL http://www.bitcoin.org/\r\n \r\n@@ -19,7 +22,7 @@ SetCompressor /SOLID lzma\n !define MUI_STARTMENUPAGE_REGISTRY_ROOT HKLM\r\n !define MUI_STARTMENUPAGE_REGISTRY_KEY ${REGKEY}\r\n !define MUI_STARTMENUPAGE_REGISTRY_VALUENAME StartMenuGroup\r\n-!define MUI_STARTMENUPAGE_DEFAULTFOLDER Bitcoin\r\n+!define MUI_STARTMENUPAGE_DEFAULTFOLDER ${NAME}\r\n !define MUI_FINISHPAGE_RUN $INSTDIR\\bitcoin-qt.exe\r\n !define MUI_UNICON \"${NSISDIR}\\Contrib\\Graphics\\Icons\\modern-uninstall.ico\"\r\n !define MUI_UNWELCOMEFINISHPAGE_BITMAP \"../share/pixmaps/nsis-wizard.bmp\"\r\n@@ -45,21 +48,21 @@ Var StartMenuGroup\n !insertmacro MUI_LANGUAGE English\r\n \r\n # Installer attributes\r\n-OutFile bitcoin-0.8.2-win32-setup.exe\r\n-InstallDir $PROGRAMFILES\\Bitcoin\r\n+OutFile ${NAME}-${VERSION}-win32-setup.exe\r\n+InstallDir $PROGRAMFILES\\${NAME}\r\n CRCCheck on\r\n XPStyle on\r\n BrandingText \" \"\r\n ShowInstDetails show\r\n-VIProductVersion 0.8.2.2\r\n-VIAddVersionKey ProductName Bitcoin\r\n-VIAddVersionKey ProductVersion \"${VERSION}\"\r\n+VIProductVersion ${PRODUCT_VERSION}\r\n+VIAddVersionKey ProductName ${NAME}\r\n+VIAddVersionKey ProductVersion ${VERSION}\r\n VIAddVersionKey CompanyName \"${COMPANY}\"\r\n VIAddVersionKey CompanyWebsite \"${URL}\"\r\n-VIAddVersionKey FileVersion \"${VERSION}\"\r\n+VIAddVersionKey FileVersion ${VERSION}\r\n VIAddVersionKey FileDescription \"\"\r\n VIAddVersionKey LegalCopyright \"\"\r\n-InstallDirRegKey HKCU \"${REGKEY}\" Path\r\n+InstallDirRegKey HKLM \"${REGKEY}\" Path\r\n ShowUninstDetails show\r\n \r\n # Installer sections\r\n@@ -74,40 +77,41 @@ Section -Main SEC0000\n     SetOutPath $INSTDIR\\src\r\n     File /r /x *.exe /x *.o ../src\\*.*\r\n     SetOutPath $INSTDIR\r\n-    WriteRegStr HKCU \"${REGKEY}\\Components\" Main 1\r\n+    WriteRegStr HKLM \"${REGKEY}\\Components\" Main 1\r\n \r\n     # Remove old wxwidgets-based-bitcoin executable and locales:\r\n     Delete /REBOOTOK $INSTDIR\\bitcoin.exe\r\n     RMDir /r /REBOOTOK $INSTDIR\\locale\r\n SectionEnd\r\n \r\n Section -post SEC0001\r\n-    WriteRegStr HKCU \"${REGKEY}\" Path $INSTDIR\r\n+    WriteRegStr HKLM \"${REGKEY}\" Path $INSTDIR\r\n     SetOutPath $INSTDIR\r\n     WriteUninstaller $INSTDIR\\uninstall.exe\r\n     !insertmacro MUI_STARTMENU_WRITE_BEGIN Application\r\n+    SetShellVarContext all\r\n     CreateDirectory $SMPROGRAMS\\$StartMenuGroup\r\n-    CreateShortcut \"$SMPROGRAMS\\$StartMenuGroup\\Bitcoin.lnk\" $INSTDIR\\bitcoin-qt.exe\r\n-    CreateShortcut \"$SMPROGRAMS\\$StartMenuGroup\\Uninstall Bitcoin.lnk\" $INSTDIR\\uninstall.exe\r\n+    CreateShortcut \"$SMPROGRAMS\\$StartMenuGroup\\${NAME}.lnk\" $INSTDIR\\bitcoin-qt.exe\r\n+    CreateShortcut \"$SMPROGRAMS\\$StartMenuGroup\\Uninstall ${NAME}.lnk\" $INSTDIR\\uninstall.exe\r\n     !insertmacro MUI_STARTMENU_WRITE_END\r\n-    WriteRegStr HKCU \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\$(^Name)\" DisplayName \"$(^Name)\"\r\n-    WriteRegStr HKCU \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\$(^Name)\" DisplayVersion \"${VERSION}\"\r\n-    WriteRegStr HKCU \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\$(^Name)\" Publisher \"${COMPANY}\"\r\n-    WriteRegStr HKCU \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\$(^Name)\" URLInfoAbout \"${URL}\"\r\n-    WriteRegStr HKCU \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\$(^Name)\" DisplayIcon $INSTDIR\\uninstall.exe\r\n-    WriteRegStr HKCU \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\$(^Name)\" UninstallString $INSTDIR\\uninstall.exe\r\n-    WriteRegDWORD HKCU \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\$(^Name)\" NoModify 1\r\n-    WriteRegDWORD HKCU \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\$(^Name)\" NoRepair 1\r\n+    WriteRegStr HKLM \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\${NAME}\" DisplayName \"${NAME}\"\r\n+    WriteRegStr HKLM \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\${NAME}\" DisplayVersion \"${VERSION}\"\r\n+    WriteRegStr HKLM \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\${NAME}\" Publisher \"${COMPANY}\"\r\n+    WriteRegStr HKLM \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\${NAME}\" URLInfoAbout \"${URL}\"\r\n+    WriteRegStr HKLM \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\${NAME}\" DisplayIcon $INSTDIR\\uninstall.exe\r\n+    WriteRegStr HKLM \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\${NAME}\" UninstallString $INSTDIR\\uninstall.exe\r\n+    WriteRegDWORD HKLM \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\${NAME}\" NoModify 1\r\n+    WriteRegDWORD HKLM \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\${NAME}\" NoRepair 1\r\n     WriteRegStr HKCR \"bitcoin\" \"URL Protocol\" \"\"\r\n-    WriteRegStr HKCR \"bitcoin\" \"\" \"URL:Bitcoin\"\r\n+    WriteRegStr HKCR \"bitcoin\" \"\" \"URL:${NAME}\"\r\n     WriteRegStr HKCR \"bitcoin\\DefaultIcon\" \"\" $INSTDIR\\bitcoin-qt.exe\r\n     WriteRegStr HKCR \"bitcoin\\shell\\open\\command\" \"\" '\"$INSTDIR\\bitcoin-qt.exe\" \"%1\"'\r\n SectionEnd\r\n \r\n # Macro for selecting uninstaller sections\r\n !macro SELECT_UNSECTION SECTION_NAME UNSECTION_ID\r\n     Push $R0\r\n-    ReadRegStr $R0 HKCU \"${REGKEY}\\Components\" \"${SECTION_NAME}\"\r\n+    ReadRegStr $R0 HKLM \"${REGKEY}\\Components\" \"${SECTION_NAME}\"\r\n     StrCmp $R0 1 0 next${UNSECTION_ID}\r\n     !insertmacro SelectSection \"${UNSECTION_ID}\"\r\n     GoTo done${UNSECTION_ID}\r\n@@ -124,22 +128,23 @@ Section /o -un.Main UNSEC0000\n     Delete /REBOOTOK $INSTDIR\\readme.txt\r\n     RMDir /r /REBOOTOK $INSTDIR\\daemon\r\n     RMDir /r /REBOOTOK $INSTDIR\\src\r\n-    DeleteRegValue HKCU \"${REGKEY}\\Components\" Main\r\n+    DeleteRegValue HKLM \"${REGKEY}\\Components\" Main\r\n SectionEnd\r\n \r\n Section -un.post UNSEC0001\r\n-    DeleteRegKey HKCU \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\$(^Name)\"\r\n-    Delete /REBOOTOK \"$SMPROGRAMS\\$StartMenuGroup\\Uninstall Bitcoin.lnk\"\r\n-    Delete /REBOOTOK \"$SMPROGRAMS\\$StartMenuGroup\\Bitcoin.lnk\"\r\n-    Delete /REBOOTOK \"$SMSTARTUP\\Bitcoin.lnk\"\r\n+    DeleteRegKey HKLM \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\${NAME}\"\r\n+    SetShellVarContext all\r\n+    Delete /REBOOTOK \"$SMPROGRAMS\\$StartMenuGroup\\Uninstall ${NAME}.lnk\"\r\n+    Delete /REBOOTOK \"$SMPROGRAMS\\$StartMenuGroup\\${NAME}.lnk\"\r\n+    Delete /REBOOTOK \"$SMSTARTUP\\${NAME}.lnk\"\r\n     Delete /REBOOTOK $INSTDIR\\uninstall.exe\r\n     Delete /REBOOTOK $INSTDIR\\debug.log\r\n     Delete /REBOOTOK $INSTDIR\\db.log\r\n-    DeleteRegValue HKCU \"${REGKEY}\" StartMenuGroup\r\n-    DeleteRegValue HKCU \"${REGKEY}\" Path\r\n-    DeleteRegKey /IfEmpty HKCU \"${REGKEY}\\Components\"\r\n-    DeleteRegKey /IfEmpty HKCU \"${REGKEY}\"\r\n-    DeleteRegKey HKCR \"bitcoin\"\r\n+    DeleteRegValue HKLM \"${REGKEY}\" StartMenuGroup\r\n+    DeleteRegValue HKLM \"${REGKEY}\" Path\r\n+    DeleteRegKey /IfEmpty HKLM \"${REGKEY}\\Components\"\r\n+    DeleteRegKey /IfEmpty HKLM \"${REGKEY}\"\r\n+    DeleteRegKey HKCR \"${NAME}\"\r\n     RmDir /REBOOTOK $SMPROGRAMS\\$StartMenuGroup\r\n     RmDir /REBOOTOK $INSTDIR\r\n     Push $R0\r\n@@ -156,7 +161,7 @@ FunctionEnd\n \r\n # Uninstaller functions\r\n Function un.onInit\r\n-    ReadRegStr $INSTDIR HKCU \"${REGKEY}\" Path\r\n+    ReadRegStr $INSTDIR HKLM \"${REGKEY}\" Path\r\n     !insertmacro MUI_STARTMENU_GETFOLDER Application $StartMenuGroup\r\n     !insertmacro SELECT_UNSECTION Main ${UNSEC0000}\r\n FunctionEnd\r"
      }
    ]
  }
]