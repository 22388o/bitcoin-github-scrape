[
  {
    "sha": "66fb32d267d90fe2e1f652570bc45aba26be55fa",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2NmZiMzJkMjY3ZDkwZmUyZTFmNjUyNTcwYmM0NWFiYTI2YmU1NWZh",
    "commit": {
      "author": {
        "name": "gjs278",
        "email": "admin@garyshood.com",
        "date": "2011-04-13T00:15:19Z"
      },
      "committer": {
        "name": "root",
        "email": "root@Gentoo.(none)",
        "date": "2011-04-13T00:15:19Z"
      },
      "message": "pidfile support for daemon",
      "tree": {
        "sha": "f56704c64f01faab35d3e781a836702e6ad9f8e7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f56704c64f01faab35d3e781a836702e6ad9f8e7"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/66fb32d267d90fe2e1f652570bc45aba26be55fa",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/66fb32d267d90fe2e1f652570bc45aba26be55fa",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/66fb32d267d90fe2e1f652570bc45aba26be55fa",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/66fb32d267d90fe2e1f652570bc45aba26be55fa/comments",
    "author": {
      "login": "gjs278",
      "id": 705268,
      "node_id": "MDQ6VXNlcjcwNTI2OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/705268?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gjs278",
      "html_url": "https://github.com/gjs278",
      "followers_url": "https://api.github.com/users/gjs278/followers",
      "following_url": "https://api.github.com/users/gjs278/following{/other_user}",
      "gists_url": "https://api.github.com/users/gjs278/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gjs278/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gjs278/subscriptions",
      "organizations_url": "https://api.github.com/users/gjs278/orgs",
      "repos_url": "https://api.github.com/users/gjs278/repos",
      "events_url": "https://api.github.com/users/gjs278/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gjs278/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": null,
    "parents": [
      {
        "sha": "485dda9774b574a82fd23dc9650dd2cbcab2a391",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/485dda9774b574a82fd23dc9650dd2cbcab2a391",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/485dda9774b574a82fd23dc9650dd2cbcab2a391"
      }
    ],
    "stats": {
      "total": 26,
      "additions": 26,
      "deletions": 0
    },
    "files": [
      {
        "sha": "dcfc6765b52ed3c2d13cfcdb6954030c81331eed",
        "filename": "init.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 0,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/66fb32d267d90fe2e1f652570bc45aba26be55fa/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/66fb32d267d90fe2e1f652570bc45aba26be55fa/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/init.cpp?ref=66fb32d267d90fe2e1f652570bc45aba26be55fa",
        "patch": "@@ -41,6 +41,7 @@ void Shutdown(void* parg)\n         DBFlush(false);\n         StopNode();\n         DBFlush(true);\n+        boost::filesystem::remove(GetPidFile());\n         CreateThread(ExitTimeout, NULL);\n         Sleep(50);\n         printf(\"Bitcoin exiting\\n\\n\");\n@@ -151,6 +152,7 @@ bool AppInit2(int argc, char* argv[])\n             \"  bitcoin [options] help <command>    \\t\\t  \" + _(\"Get help for a command\\n\") +\n           _(\"Options:\\n\") +\n             \"  -conf=<file>     \\t\\t  \" + _(\"Specify configuration file (default: bitcoin.conf)\\n\") +\n+            \"  -pid=<file>      \\t\\t  \" + _(\"Specify pid file (default: bitcoind.pid)\\n\") +\n             \"  -gen             \\t\\t  \" + _(\"Generate coins\\n\") +\n             \"  -gen=0           \\t\\t  \" + _(\"Don't generate coins\\n\") +\n             \"  -min             \\t\\t  \" + _(\"Start minimized\\n\") +\n@@ -251,7 +253,10 @@ bool AppInit2(int argc, char* argv[])\n             return false;\n         }\n         if (pid > 0)\n+        {\n+            CreatePidFile(GetPidFile(), pid);\n             return true;\n+        }\n \n         pid_t sid = setsid();\n         if (sid < 0)"
      },
      {
        "sha": "06da0cb1e461b5723c05ad9886a5383a8b89e00b",
        "filename": "util.cpp",
        "status": "modified",
        "additions": 19,
        "deletions": 0,
        "changes": 19,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/66fb32d267d90fe2e1f652570bc45aba26be55fa/util.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/66fb32d267d90fe2e1f652570bc45aba26be55fa/util.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/util.cpp?ref=66fb32d267d90fe2e1f652570bc45aba26be55fa",
        "patch": "@@ -747,6 +747,25 @@ void ReadConfigFile(map<string, string>& mapSettingsRet,\n     }\n }\n \n+string GetPidFile()\n+{\n+    namespace fs = boost::filesystem;\n+    fs::path pathConfig(GetArg(\"-pid\", \"bitcoind.pid\"));\n+    if (!pathConfig.is_complete())\n+        pathConfig = fs::path(GetDataDir()) / pathConfig;\n+    return pathConfig.string();\n+}\n+\n+void CreatePidFile(string pidFile, pid_t pid)\n+{\n+    FILE* file;\n+    if (file = fopen(pidFile.c_str(), \"w\"))\n+    {\n+        fprintf(file, \"%d\\n\", pid);\n+        fclose(file);\n+    }\n+}\n+\n int GetFilesize(FILE* file)\n {\n     int nSavePos = ftell(file);"
      },
      {
        "sha": "4bd5cb89548370401b917e8e7ff3a4262e6e9b22",
        "filename": "util.h",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/66fb32d267d90fe2e1f652570bc45aba26be55fa/util.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/66fb32d267d90fe2e1f652570bc45aba26be55fa/util.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/util.h?ref=66fb32d267d90fe2e1f652570bc45aba26be55fa",
        "patch": "@@ -172,6 +172,8 @@ bool WildcardMatch(const string& str, const string& mask);\n int GetFilesize(FILE* file);\n void GetDataDir(char* pszDirRet);\n string GetConfigFile();\n+string GetPidFile();\n+void CreatePidFile(string pidFile, pid_t pid);\n void ReadConfigFile(map<string, string>& mapSettingsRet, map<string, vector<string> >& mapMultiSettingsRet);\n #ifdef __WXMSW__\n string MyGetSpecialFolderPath(int nFolder, bool fCreate);"
      }
    ]
  }
]