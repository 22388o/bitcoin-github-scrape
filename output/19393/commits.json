[
  {
    "sha": "5c049780c8b310428cf72fb304bf0c1071742785",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo1YzA0OTc4MGM4YjMxMDQyOGNmNzJmYjMwNGJmMGMxMDcxNzQyNzg1",
    "commit": {
      "author": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2020-06-27T10:13:51Z"
      },
      "committer": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2021-09-03T04:53:41Z"
      },
      "message": "test: Add test for erase orphan tx from peer",
      "tree": {
        "sha": "c6c3331142c491bcf6559ab98ca46483d4374987",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c6c3331142c491bcf6559ab98ca46483d4374987"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5c049780c8b310428cf72fb304bf0c1071742785",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE0dvyxLlvLev0wWZUQQEIES5+qB8FAmExqlUACgkQQQEIES5+\nqB+HWhAAqjbErE2QXpotc0Cd9Ok+TCJXEsDNN/wXDVP61v1XKcDA9osKUDtb3YGa\nRT3sBaiB9cMPMuC0vGnM9LpJETCxfFa6k8yXiciuCetY6/hhJQJYcufCWEN30W98\nw/IEI1Yp/hZxoTtLONznMrFjqyGBRMiCTGTN1bgWFY6LZqIBpNPZ/yPXa01qy1fl\nfp0LIzFvvaGV5X/nHYAmYiIrGwyjxRNzGUO1U38zyY+aFWMLyibgNv1G/FBJo5lZ\n+LxNDmed+4LupK9kTrGVMIe1jB7XJTMhWC0wj8lfMHKQHgAkDWaQK9h/nEPqp9B/\nKaarPt+1saQdloBFbq05X7rb9C1F+0EOimUNoBDh9To8dJ0aAK+XCgvmbtqVAX/x\nPfA6J5efoXE5Pztc90J3ZqCFLeavRH7HYWTJ7fSxVN+K3jooicdp5CEWHQowY+Jx\np1wh8xPHLKZtGx4BoquQJeMbbE5J4HPgMxAysNyxV3myF5Mxoz+lvq+Rr6MGluUT\nowxV8JfAelryzkrWMSaSvGd9oTQ77/pNeS9tpFFtkq50K/PS5e3v4a5H0iOIFurd\nnR818xXDB75wo2UJlG8iHrB3C0grCfwp9MQgY4JA6vmfGAcEt6XG1ez5w22+TEak\nkhZFNb+BHan1c3rL9zguNbV1dm+krulsmBrx3zGMbiJWKn7L57A=\n=1K1K\n-----END PGP SIGNATURE-----",
        "payload": "tree c6c3331142c491bcf6559ab98ca46483d4374987\nparent dd097c42df7378c9d0114c04c82b3c38c18e13dc\nauthor Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1593252831 +0300\ncommitter Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1630644821 +0300\n\ntest: Add test for erase orphan tx from peer\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/5c049780c8b310428cf72fb304bf0c1071742785",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/5c049780c8b310428cf72fb304bf0c1071742785",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/5c049780c8b310428cf72fb304bf0c1071742785/comments",
    "author": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "dd097c42df7378c9d0114c04c82b3c38c18e13dc",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dd097c42df7378c9d0114c04c82b3c38c18e13dc",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/dd097c42df7378c9d0114c04c82b3c38c18e13dc"
      }
    ],
    "stats": {
      "total": 6,
      "additions": 5,
      "deletions": 1
    },
    "files": [
      {
        "sha": "037a4249cc7680e5893650f6b8c0ced7503d0235",
        "filename": "test/functional/p2p_invalid_tx.py",
        "status": "modified",
        "additions": 5,
        "deletions": 1,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/5c049780c8b310428cf72fb304bf0c1071742785/test/functional/p2p_invalid_tx.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/5c049780c8b310428cf72fb304bf0c1071742785/test/functional/p2p_invalid_tx.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/p2p_invalid_tx.py?ref=5c049780c8b310428cf72fb304bf0c1071742785",
        "patch": "@@ -60,7 +60,6 @@ def run_test(self):\n         block.solve()\n         # Save the coinbase for later\n         block1 = block\n-        tip = block.sha256\n         node.p2ps[0].send_blocks_and_test([block], node, success=True)\n \n         self.log.info(\"Mature the block.\")\n@@ -157,13 +156,18 @@ def run_test(self):\n         with node.assert_debug_log(['orphanage overflow, removed 1 tx']):\n             node.p2ps[0].send_txs_and_test(orphan_tx_pool, node, success=False)\n \n+        self.log.info('Test orphan with rejected parents')\n         rejected_parent = CTransaction()\n         rejected_parent.vin.append(CTxIn(outpoint=COutPoint(tx_orphan_2_invalid.sha256, 0)))\n         rejected_parent.vout.append(CTxOut(nValue=11 * COIN, scriptPubKey=SCRIPT_PUB_KEY_OP_TRUE))\n         rejected_parent.rehash()\n         with node.assert_debug_log(['not keeping orphan with rejected parents {}'.format(rejected_parent.hash)]):\n             node.p2ps[0].send_txs_and_test([rejected_parent], node, success=False)\n \n+        self.log.info('Test that a peer disconnection causes erase its transactions from the orphan pool')\n+        with node.assert_debug_log(['Erased 100 orphan tx from peer=25']):\n+            self.reconnect_p2p(num_connections=1)\n+\n \n if __name__ == '__main__':\n     InvalidTxRequestTest().main()"
      }
    ]
  },
  {
    "sha": "fa45bb21193ae0c220cfc224d5e3ea0e7f3ec988",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYTQ1YmIyMTE5M2FlMGMyMjBjZmMyMjRkNWUzZWEwZTdmM2VjOTg4",
    "commit": {
      "author": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2020-06-27T10:15:55Z"
      },
      "committer": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2021-09-03T05:03:54Z"
      },
      "message": "test: Add test for erase orphan tx included by block",
      "tree": {
        "sha": "c93148b71e8241e398a13ab10c24f32c0e1d1208",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c93148b71e8241e398a13ab10c24f32c0e1d1208"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa45bb21193ae0c220cfc224d5e3ea0e7f3ec988",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE0dvyxLlvLev0wWZUQQEIES5+qB8FAmExrLoACgkQQQEIES5+\nqB86Sw/9HRPXT4A1Z9rzHnDhJVxOzdqBsQZzrvDzvsOsOklHckAlrAdeFPUtMNwz\ntcsKtXD6UkwJf8/cuDAR/gTq5xrOf/vsS2k1yr+E7vbg3wrqgy0E6C/KLdVy3Wl4\nHeb/zyVadty753qbFADjym8YMtSb8sSNTEjZtfJaT9UBl8kw54o0YhsyKmyQKnTa\nXs/Sf+YyvIPT1r3iPj5sIbJBr59G+IITBpRAQc+bPlacCF34qezCvlbVYNDLLtxl\n60jkFNCE7rSSjEqf+spvPgf27uiIHxAqWzaE8sw69AhaQP86qG0Z/t27sgd1RpYT\nBZzTQHrRyUr4cc1C25vOdR1VJzwLe0P2c+DrfFq199ckbM7S0q6ogXKgvPVO0Igy\nfibpDI2g7I+RIRCqLJz2FH5ag71gO2xOcuAU3rzAlHVkkBnDVeffbemcJ8bjG4TD\nEaI7pgSbAOxgO8Bv9iCJLcdRtTvZcJPvSXoE/U7TP5NnhA1RNNESNQE2BIm8QSGd\n6+x9FD3NiIMr/vc/KEEOvaFgT3YZAE1GcC+VrvS/ueu/4WZlss6jGv6A9PF6tuIB\nFxmYSbiMR0RmgNEoiyaEhqqs+JQ1/OtgGcHIXqTFCijtMtAooQV2fbOKjoKAfbuY\nV5um3BEP3SCcqrK60E6C9K5bvIZare90/RKWrkcybfuBCUc/RBI=\n=epjv\n-----END PGP SIGNATURE-----",
        "payload": "tree c93148b71e8241e398a13ab10c24f32c0e1d1208\nparent 5c049780c8b310428cf72fb304bf0c1071742785\nauthor Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1593252955 +0300\ncommitter Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1630645434 +0300\n\ntest: Add test for erase orphan tx included by block\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa45bb21193ae0c220cfc224d5e3ea0e7f3ec988",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fa45bb21193ae0c220cfc224d5e3ea0e7f3ec988",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa45bb21193ae0c220cfc224d5e3ea0e7f3ec988/comments",
    "author": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "5c049780c8b310428cf72fb304bf0c1071742785",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/5c049780c8b310428cf72fb304bf0c1071742785",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/5c049780c8b310428cf72fb304bf0c1071742785"
      }
    ],
    "stats": {
      "total": 33,
      "additions": 29,
      "deletions": 4
    },
    "files": [
      {
        "sha": "0eb099b1d5ab2373c756afbd34d06a1e4ac27753",
        "filename": "test/functional/p2p_invalid_tx.py",
        "status": "modified",
        "additions": 29,
        "deletions": 4,
        "changes": 33,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa45bb21193ae0c220cfc224d5e3ea0e7f3ec988/test/functional/p2p_invalid_tx.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa45bb21193ae0c220cfc224d5e3ea0e7f3ec988/test/functional/p2p_invalid_tx.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/p2p_invalid_tx.py?ref=fa45bb21193ae0c220cfc224d5e3ea0e7f3ec988",
        "patch": "@@ -92,24 +92,24 @@ def run_test(self):\n         SCRIPT_PUB_KEY_OP_TRUE = b'\\x51\\x75' * 15 + b'\\x51'\n         tx_withhold = CTransaction()\n         tx_withhold.vin.append(CTxIn(outpoint=COutPoint(block1.vtx[0].sha256, 0)))\n-        tx_withhold.vout.append(CTxOut(nValue=50 * COIN - 12000, scriptPubKey=SCRIPT_PUB_KEY_OP_TRUE))\n+        tx_withhold.vout = [CTxOut(nValue=25 * COIN - 12000, scriptPubKey=SCRIPT_PUB_KEY_OP_TRUE)] * 2\n         tx_withhold.calc_sha256()\n \n         # Our first orphan tx with some outputs to create further orphan txs\n         tx_orphan_1 = CTransaction()\n         tx_orphan_1.vin.append(CTxIn(outpoint=COutPoint(tx_withhold.sha256, 0)))\n-        tx_orphan_1.vout = [CTxOut(nValue=10 * COIN, scriptPubKey=SCRIPT_PUB_KEY_OP_TRUE)] * 3\n+        tx_orphan_1.vout = [CTxOut(nValue=8 * COIN, scriptPubKey=SCRIPT_PUB_KEY_OP_TRUE)] * 3\n         tx_orphan_1.calc_sha256()\n \n         # A valid transaction with low fee\n         tx_orphan_2_no_fee = CTransaction()\n         tx_orphan_2_no_fee.vin.append(CTxIn(outpoint=COutPoint(tx_orphan_1.sha256, 0)))\n-        tx_orphan_2_no_fee.vout.append(CTxOut(nValue=10 * COIN, scriptPubKey=SCRIPT_PUB_KEY_OP_TRUE))\n+        tx_orphan_2_no_fee.vout.append(CTxOut(nValue=8 * COIN, scriptPubKey=SCRIPT_PUB_KEY_OP_TRUE))\n \n         # A valid transaction with sufficient fee\n         tx_orphan_2_valid = CTransaction()\n         tx_orphan_2_valid.vin.append(CTxIn(outpoint=COutPoint(tx_orphan_1.sha256, 1)))\n-        tx_orphan_2_valid.vout.append(CTxOut(nValue=10 * COIN - 12000, scriptPubKey=SCRIPT_PUB_KEY_OP_TRUE))\n+        tx_orphan_2_valid.vout.append(CTxOut(nValue=8 * COIN - 12000, scriptPubKey=SCRIPT_PUB_KEY_OP_TRUE))\n         tx_orphan_2_valid.calc_sha256()\n \n         # An invalid transaction with negative fee\n@@ -168,6 +168,31 @@ def run_test(self):\n         with node.assert_debug_log(['Erased 100 orphan tx from peer=25']):\n             self.reconnect_p2p(num_connections=1)\n \n+        self.log.info('Test that a transaction in the orphan pool is included in a new tip block causes erase this transaction from the orphan pool')\n+        tx_withhold_until_block_A = CTransaction()\n+        tx_withhold_until_block_A.vin.append(CTxIn(outpoint=COutPoint(tx_withhold.sha256, 1)))\n+        tx_withhold_until_block_A.vout = [CTxOut(nValue=12 * COIN, scriptPubKey=SCRIPT_PUB_KEY_OP_TRUE)] * 2\n+        tx_withhold_until_block_A.calc_sha256()\n+\n+        tx_orphan_include_by_block_A = CTransaction()\n+        tx_orphan_include_by_block_A.vin.append(CTxIn(outpoint=COutPoint(tx_withhold_until_block_A.sha256, 0)))\n+        tx_orphan_include_by_block_A.vout.append(CTxOut(nValue=12 * COIN - 12000, scriptPubKey=SCRIPT_PUB_KEY_OP_TRUE))\n+        tx_orphan_include_by_block_A.calc_sha256()\n+\n+        self.log.info('Send the orphan ... ')\n+        node.p2ps[0].send_txs_and_test([tx_orphan_include_by_block_A], node, success=False)\n+\n+        tip = int(node.getbestblockhash(), 16)\n+        height = node.getblockcount() + 1\n+        block_A = create_block(tip, create_coinbase(height))\n+        block_A.vtx.extend([tx_withhold, tx_withhold_until_block_A, tx_orphan_include_by_block_A])\n+        block_A.hashMerkleRoot = block_A.calc_merkle_root()\n+        block_A.solve()\n+\n+        self.log.info('Send the block that includes the previous orphan ... ')\n+        with node.assert_debug_log([\"Erased 1 orphan tx included or conflicted by block\"]):\n+            node.p2ps[0].send_blocks_and_test([block_A], node, success=True)\n+\n \n if __name__ == '__main__':\n     InvalidTxRequestTest().main()"
      }
    ]
  },
  {
    "sha": "c0a5fceee9858afd24fe0bf655b7b30728e96e78",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpjMGE1ZmNlZWU5ODU4YWZkMjRmZTBiZjY1NWI3YjMwNzI4ZTk2ZTc4",
    "commit": {
      "author": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2020-06-27T10:21:12Z"
      },
      "committer": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2021-09-03T05:10:58Z"
      },
      "message": "test: Add test for erase orphan tx conflicted by block",
      "tree": {
        "sha": "26a41abc822c4d77b123e2644e296779aae2187a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/26a41abc822c4d77b123e2644e296779aae2187a"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c0a5fceee9858afd24fe0bf655b7b30728e96e78",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE0dvyxLlvLev0wWZUQQEIES5+qB8FAmExrmIACgkQQQEIES5+\nqB8Krw/8DwE66DrFJ1OqgbVR83o5XNNChL4jLxVC1SEZIUcqq30hvGqkz16lDJZ1\np7RGn6W/Vksz2UfBN+HGAJqNUhR/ffUJou9HMp5tB05KgOH5r3RzfWpIDB5rS8Sd\npJv3NkHFDOVZPLYAL0S1hDcLsaIEzDkTH/UGzjG7KFT3q+J61jSTUZHFvYfX1NW/\nET9NpF14KgXH7QSDHojFzAxdQLRwjVZb9jDgCzamamJJ2FtD4JPcDQAbsIjXT1RM\nyVWHnlBSHRYZM2XHtpLCsNTYaxpw48CvJ2ZxzmMosdZQnrbL/Ik5b6Stnvsah2dU\nQNIn717yay9b4JMZp+/6x85W6M93iflhzknmoIF5RUk+H5lyitmyPfdKYfkkx2Kn\ndymZXfkSvIGWRlwECHOOsAKa75DdJfIbHfN183xjnIv+DndeUS+ScIAxCIcHlceh\nG5VhiezOS+0VovUKnSMc2+U/lFB5Spvg7jXObectj/L4UoD7ASOI7TZ1NMJ1LmZS\nnjpGTNWpXH9SpC+NP1+2t2qCziszfWXmunJSyv/Wf/J6+LXMQMN2fsa2og3xU7C0\nBvs6kaKdAlog47Nxjho8VTD+/JpNlx3AZ6wXdvpRYZmM8oPJWHq/8T+MDtwMUzmW\n+A8RM+uM4Zh8w+dpp6uo8dGVHNnB5uvx1vpxOzve0kHg3vDlQgM=\n=5fnp\n-----END PGP SIGNATURE-----",
        "payload": "tree 26a41abc822c4d77b123e2644e296779aae2187a\nparent fa45bb21193ae0c220cfc224d5e3ea0e7f3ec988\nauthor Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1593253272 +0300\ncommitter Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1630645858 +0300\n\ntest: Add test for erase orphan tx conflicted by block\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c0a5fceee9858afd24fe0bf655b7b30728e96e78",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/c0a5fceee9858afd24fe0bf655b7b30728e96e78",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c0a5fceee9858afd24fe0bf655b7b30728e96e78/comments",
    "author": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fa45bb21193ae0c220cfc224d5e3ea0e7f3ec988",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa45bb21193ae0c220cfc224d5e3ea0e7f3ec988",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fa45bb21193ae0c220cfc224d5e3ea0e7f3ec988"
      }
    ],
    "stats": {
      "total": 29,
      "additions": 29,
      "deletions": 0
    },
    "files": [
      {
        "sha": "54d4f966d34c0a0f7a9d7720651552ce580a2582",
        "filename": "test/functional/p2p_invalid_tx.py",
        "status": "modified",
        "additions": 29,
        "deletions": 0,
        "changes": 29,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/c0a5fceee9858afd24fe0bf655b7b30728e96e78/test/functional/p2p_invalid_tx.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/c0a5fceee9858afd24fe0bf655b7b30728e96e78/test/functional/p2p_invalid_tx.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/p2p_invalid_tx.py?ref=c0a5fceee9858afd24fe0bf655b7b30728e96e78",
        "patch": "@@ -193,6 +193,35 @@ def run_test(self):\n         with node.assert_debug_log([\"Erased 1 orphan tx included or conflicted by block\"]):\n             node.p2ps[0].send_blocks_and_test([block_A], node, success=True)\n \n+        self.log.info('Test that a transaction in the orphan pool conflicts with a new tip block causes erase this transaction from the orphan pool')\n+        tx_withhold_until_block_B = CTransaction()\n+        tx_withhold_until_block_B.vin.append(CTxIn(outpoint=COutPoint(tx_withhold_until_block_A.sha256, 1)))\n+        tx_withhold_until_block_B.vout.append(CTxOut(nValue=11 * COIN, scriptPubKey=SCRIPT_PUB_KEY_OP_TRUE))\n+        tx_withhold_until_block_B.calc_sha256()\n+\n+        tx_orphan_include_by_block_B = CTransaction()\n+        tx_orphan_include_by_block_B.vin.append(CTxIn(outpoint=COutPoint(tx_withhold_until_block_B.sha256, 0)))\n+        tx_orphan_include_by_block_B.vout.append(CTxOut(nValue=10 * COIN, scriptPubKey=SCRIPT_PUB_KEY_OP_TRUE))\n+        tx_orphan_include_by_block_B.calc_sha256()\n+\n+        tx_orphan_conflict_by_block_B = CTransaction()\n+        tx_orphan_conflict_by_block_B.vin.append(CTxIn(outpoint=COutPoint(tx_withhold_until_block_B.sha256, 0)))\n+        tx_orphan_conflict_by_block_B.vout.append(CTxOut(nValue=9 * COIN, scriptPubKey=SCRIPT_PUB_KEY_OP_TRUE))\n+        tx_orphan_conflict_by_block_B.calc_sha256()\n+        self.log.info('Send the orphan ... ')\n+        node.p2ps[0].send_txs_and_test([tx_orphan_conflict_by_block_B], node, success=False)\n+\n+        tip = int(node.getbestblockhash(), 16)\n+        height = node.getblockcount() + 1\n+        block_B = create_block(tip, create_coinbase(height))\n+        block_B.vtx.extend([tx_withhold_until_block_B, tx_orphan_include_by_block_B])\n+        block_B.hashMerkleRoot = block_B.calc_merkle_root()\n+        block_B.solve()\n+\n+        self.log.info('Send the block that includes a transaction which conflicts with the previous orphan ... ')\n+        with node.assert_debug_log([\"Erased 1 orphan tx included or conflicted by block\"]):\n+            node.p2ps[0].send_blocks_and_test([block_B], node, success=True)\n+\n \n if __name__ == '__main__':\n     InvalidTxRequestTest().main()"
      }
    ]
  }
]