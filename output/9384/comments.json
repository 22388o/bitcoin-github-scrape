[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271916098",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9384#issuecomment-271916098",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9384",
    "id": 271916098,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTkxNjA5OA==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-11T16:26:39Z",
    "updated_at": "2017-01-11T16:26:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "@sipa, this is the PR I mentioned other day. It does move code to the modifier object, but the code could be moved if the modifier object is going away.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271916098/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/283492374",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9384#issuecomment-283492374",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9384",
    "id": 283492374,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4MzQ5MjM3NA==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-01T22:30:12Z",
    "updated_at": "2017-03-01T22:30:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "@sipa, I posted a version of your [pertxoutcache](https://github.com/sipa/bitcoin/commits/pertxoutcache) branch rebased on top of this PR here: \r\nhttps://github.com/ryanofsky/bitcoin/commits/pr/pertxoutcache\r\n\r\nIt might be useful to you even if you aren't interested in this PR because it also updates coins_tests to be compatible with your change.\r\n\r\nRelevant commits:\r\n\r\n- 6b547c287e63a48d24547f48ac8108d83dcc7266 `WIP per-txout chainstate` \u2013 rebased version of your main commit on top of this PR.\r\n- 5853aed217e4fd7f4a02790491ef1ea01821a2d5 `Re-enable and fix coins_test.cpp` \u2013 coins_test fixes that you can incorporate (regardless of the code refactoring in this PR)\r\n- 1b8425fce6498be757e663d202be025730f86725 `Fix wallet CCoinsViewCache::GetCoins call` \u2013 fix for compile error in wallet caused by ccoins changes\r\n ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/283492374/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/305895810",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9384#issuecomment-305895810",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9384",
    "id": 305895810,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNTg5NTgxMA==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-02T20:03:40Z",
    "updated_at": "2017-06-02T20:03:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased c72de76bf803254454a5dc4618bde85d1d992b7d -> 2f2d3c856520da6fcdcb82b2330515136be3f028 ([pr/ccoins-cleanup.6](https://github.com/ryanofsky/bitcoin/commits/pr/ccoins-cleanup.6) -> [pr/ccoins-cleanup.7](https://github.com/ryanofsky/bitcoin/commits/pr/ccoins-cleanup.7)) after #10195 merge.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/305895810/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/370856624",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9384#issuecomment-370856624",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9384",
    "id": 370856624,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM3MDg1NjYyNA==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-03-06T17:15:05Z",
    "updated_at": "2018-03-06T17:15:05Z",
    "author_association": "MEMBER",
    "body": "Concept ACK",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/370856624/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/473390121",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9384#issuecomment-473390121",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9384",
    "id": 473390121,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MzM5MDEyMQ==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-15T18:10:29Z",
    "updated_at": "2021-12-01T10:46:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#17487](https://github.com/bitcoin/bitcoin/pull/17487) (coins: allow write to disk without cache drop by jamesob)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/473390121/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/487407255",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9384#issuecomment-487407255",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9384",
    "id": 487407255,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NzQwNzI1NQ==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-28T19:12:13Z",
    "updated_at": "2019-04-28T19:12:13Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--5d09a71f8925f3f132321140b44b946d-->The last travis run for this pull request was 281 days ago and is thus outdated. To trigger a fresh travis build, this pull request should be closed and re-opened.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/487407255/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/620218918",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9384#issuecomment-620218918",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9384",
    "id": 620218918,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYyMDIxODkxOA==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-27T20:33:53Z",
    "updated_at": "2021-11-29T21:03:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased 8c743919935f628e27fd24e8809c9cee273f3930 -> b837952bfac658aa868b9299f7cf6f8ffe248620 ([`pr/ccoins-cleanup.13`](https://github.com/ryanofsky/bitcoin/commits/pr/ccoins-cleanup.13) -> [`pr/ccoins-cleanup.14`](https://github.com/ryanofsky/bitcoin/commits/pr/ccoins-cleanup.14), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/ccoins-cleanup.13-rebase..pr/ccoins-cleanup.14)) after #18752 to avoid mempool_reorg sync timeout https://travis-ci.org/github/bitcoin/bitcoin/jobs/678462266#L681\r\nRebased b837952bfac658aa868b9299f7cf6f8ffe248620 -> 0c33bd2efa48d276e3475d458f12cba863c83448 ([`pr/ccoins-cleanup.14`](https://github.com/ryanofsky/bitcoin/commits/pr/ccoins-cleanup.14) -> [`pr/ccoins-cleanup.15`](https://github.com/ryanofsky/bitcoin/commits/pr/ccoins-cleanup.15), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/ccoins-cleanup.14-rebase..pr/ccoins-cleanup.15)) due to conflict with #19806\r\nUpdated 0c33bd2efa48d276e3475d458f12cba863c83448 -> a40f7e5ed7e55a22ecd604f5632c5c83f0eb0781 ([`pr/ccoins-cleanup.15`](https://github.com/ryanofsky/bitcoin/commits/pr/ccoins-cleanup.15) -> [`pr/ccoins-cleanup.16`](https://github.com/ryanofsky/bitcoin/commits/pr/ccoins-cleanup.16), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/ccoins-cleanup.15..pr/ccoins-cleanup.16)) to fix fuzz and appveyor CI errors https://cirrus-ci.com/task/5569196852510720?command=ci#L2831 and https://ci.appveyor.com/project/DrahtBot/bitcoin/builds/38155594#L31\r\nRebased a40f7e5ed7e55a22ecd604f5632c5c83f0eb0781 -> ed037857dad102f0829ab16cce0bb9acf11892ff ([`pr/ccoins-cleanup.16`](https://github.com/ryanofsky/bitcoin/commits/pr/ccoins-cleanup.16) -> [`pr/ccoins-cleanup.17`](https://github.com/ryanofsky/bitcoin/commits/pr/ccoins-cleanup.17), [compare](https://github.com/ryanofsky/bitcoin/compare/pr/ccoins-cleanup.16-rebase..pr/ccoins-cleanup.17)) due to conflict with #22902",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/620218918/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95610292",
    "pull_request_review_id": 16171111,
    "id": 95610292,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk1NjEwMjky",
    "diff_hunk": "@@ -612,7 +612,7 @@ BOOST_AUTO_TEST_CASE(ccoins_access)\n     CheckAccessCoins(ABSENT, VALUE2, VALUE2, FRESH      , FRESH      );\n     CheckAccessCoins(ABSENT, VALUE2, VALUE2, DIRTY      , DIRTY      );\n     CheckAccessCoins(ABSENT, VALUE2, VALUE2, DIRTY|FRESH, DIRTY|FRESH);\n-    CheckAccessCoins(PRUNED, ABSENT, PRUNED, NO_ENTRY   , FRESH      );\n+    CheckAccessCoins(PRUNED, ABSENT, ABSENT, NO_ENTRY   , NO_ENTRY   );",
    "path": "src/test/coins_tests.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "ed037857dad102f0829ab16cce0bb9acf11892ff",
    "original_commit_id": "c72de76bf803254454a5dc4618bde85d1d992b7d",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Explanation of this change: Calling CCoinsViewCache::AccessCoins when no cache entry exists and the base entry is pruned no longer creates a cache entry.\r\n\r\nThe changed behavior in this case is better than the current behavior because now this case is consistent with the case in line 606 above where no cache entry exists and no base entry exists. It doesn't make any sense for the cache to behave differently just because a base entry is pruned instead of nonexistent.",
    "created_at": "2017-01-11T16:07:07Z",
    "updated_at": "2021-03-29T14:10:01Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9384#discussion_r95610292",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9384",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95610292"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9384#discussion_r95610292"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9384"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95610292/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 615,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95611169",
    "pull_request_review_id": 16171111,
    "id": 95611169,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk1NjExMTY5",
    "diff_hunk": "@@ -826,15 +826,15 @@ BOOST_AUTO_TEST_CASE(ccoins_write)\n     CheckWriteCoins(PRUNED, ABSENT, PRUNED, DIRTY      , NO_ENTRY   , DIRTY      );\n     CheckWriteCoins(PRUNED, ABSENT, PRUNED, DIRTY|FRESH, NO_ENTRY   , DIRTY|FRESH);\n     CheckWriteCoins(PRUNED, PRUNED, PRUNED, 0          , DIRTY      , DIRTY      );\n-    CheckWriteCoins(PRUNED, PRUNED, PRUNED, 0          , DIRTY|FRESH, DIRTY      );\n+    CheckWriteCoins(PRUNED, PRUNED, ABSENT, 0          , DIRTY|FRESH, NO_ENTRY   );",
    "path": "src/test/coins_tests.cpp",
    "position": null,
    "original_position": 14,
    "commit_id": "ed037857dad102f0829ab16cce0bb9acf11892ff",
    "original_commit_id": "c72de76bf803254454a5dc4618bde85d1d992b7d",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Explanation of this change: Overwriting a non-dirty pruned cache entry with a fresh pruned cache entry now deletes the cache entry instead of leaving behind a dirty pruned entry that will trigger an unnecessary database write later.\r\n",
    "created_at": "2017-01-11T16:10:36Z",
    "updated_at": "2021-03-29T14:10:01Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9384#discussion_r95611169",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9384",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95611169"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9384#discussion_r95611169"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9384"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95611169/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 829,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95611376",
    "pull_request_review_id": 16171111,
    "id": 95611376,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk1NjExMzc2",
    "diff_hunk": "@@ -826,15 +826,15 @@ BOOST_AUTO_TEST_CASE(ccoins_write)\n     CheckWriteCoins(PRUNED, ABSENT, PRUNED, DIRTY      , NO_ENTRY   , DIRTY      );\n     CheckWriteCoins(PRUNED, ABSENT, PRUNED, DIRTY|FRESH, NO_ENTRY   , DIRTY|FRESH);\n     CheckWriteCoins(PRUNED, PRUNED, PRUNED, 0          , DIRTY      , DIRTY      );\n-    CheckWriteCoins(PRUNED, PRUNED, PRUNED, 0          , DIRTY|FRESH, DIRTY      );\n+    CheckWriteCoins(PRUNED, PRUNED, ABSENT, 0          , DIRTY|FRESH, NO_ENTRY   );\n     CheckWriteCoins(PRUNED, PRUNED, ABSENT, FRESH      , DIRTY      , NO_ENTRY   );\n     CheckWriteCoins(PRUNED, PRUNED, ABSENT, FRESH      , DIRTY|FRESH, NO_ENTRY   );\n     CheckWriteCoins(PRUNED, PRUNED, PRUNED, DIRTY      , DIRTY      , DIRTY      );\n     CheckWriteCoins(PRUNED, PRUNED, PRUNED, DIRTY      , DIRTY|FRESH, DIRTY      );\n     CheckWriteCoins(PRUNED, PRUNED, ABSENT, DIRTY|FRESH, DIRTY      , NO_ENTRY   );\n     CheckWriteCoins(PRUNED, PRUNED, ABSENT, DIRTY|FRESH, DIRTY|FRESH, NO_ENTRY   );\n     CheckWriteCoins(PRUNED, VALUE2, VALUE2, 0          , DIRTY      , DIRTY      );\n-    CheckWriteCoins(PRUNED, VALUE2, VALUE2, 0          , DIRTY|FRESH, DIRTY      );\n+    CheckWriteCoins(PRUNED, VALUE2, VALUE2, 0          , DIRTY|FRESH, DIRTY|FRESH);",
    "path": "src/test/coins_tests.cpp",
    "position": null,
    "original_position": 23,
    "commit_id": "ed037857dad102f0829ab16cce0bb9acf11892ff",
    "original_commit_id": "c72de76bf803254454a5dc4618bde85d1d992b7d",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Explanation of this change: Overwriting a dirty pruned fresh cache entry with a nonpruned entry updates the entry without dropping the fresh flag. There's no reason to drop the fresh flag in this case because the flag accurately describes the state of the base view and could prevent unnecessary database writes in the future if the utxo is spent later.\r\n",
    "created_at": "2017-01-11T16:11:37Z",
    "updated_at": "2021-03-29T14:10:01Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9384#discussion_r95611376",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9384",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95611376"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9384#discussion_r95611376"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9384"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95611376/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 837,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219851897",
    "pull_request_review_id": 158123897,
    "id": 219851897,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIxOTg1MTg5Nw==",
    "diff_hunk": "@@ -96,19 +93,14 @@ void AddCoins(CCoinsViewCache& cache, const CTransaction &tx, int nHeight, bool\n }\n \n bool CCoinsViewCache::SpendCoin(const COutPoint &outpoint, Coin* moveout) {\n-    CCoinsMap::iterator it = FetchCoin(outpoint);\n-    if (it == cacheCoins.end()) return false;\n-    cachedCoinsUsage -= it->second.coin.DynamicMemoryUsage();\n+    Modifier modifier(*this, outpoint);\n+    Coin& coin = modifier.Modify();\n+    bool already_spent = coin.IsSpent();\n     if (moveout) {\n-        *moveout = std::move(it->second.coin);\n-    }\n-    if (it->second.flags & CCoinsCacheEntry::FRESH) {\n-        cacheCoins.erase(it);\n-    } else {\n-        it->second.flags |= CCoinsCacheEntry::DIRTY;\n-        it->second.coin.Clear();\n+        *moveout = std::move(coin);\n     }\n-    return true;\n+    coin.Clear();\n+    return !already_spent;",
    "path": "src/coins.cpp",
    "position": 135,
    "original_position": 101,
    "commit_id": "ed037857dad102f0829ab16cce0bb9acf11892ff",
    "original_commit_id": "2279ff50b74a4fd11379f4b22a41ace453df07d7",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think this change (after #10537) would have prevented the inflation bug caused by #9049 + #10195, discussed in\r\nthe [CVE-2018-17144](https://bitcoincore.org/en/2018/09/20/notice/) full disclosure.",
    "created_at": "2018-09-24T14:15:20Z",
    "updated_at": "2021-03-29T14:10:01Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9384#discussion_r219851897",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9384",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219851897"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9384#discussion_r219851897"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9384"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/219851897/reactions",
      "total_count": 4,
      "+1": 4,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 124,
    "original_line": 124,
    "side": "RIGHT"
  }
]