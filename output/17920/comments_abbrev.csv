DrahtBot,2020-01-13 23:47:42,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20629 (depends: Improve id string robustness by dongcarl)\n\nIf you consider this pull request important, please also hel",https://github.com/bitcoin/bitcoin/pull/17920#issuecomment-573928920,573928920,
dongcarl,2020-07-30 18:28:37,Update: this is still being actively worked on. Current hurdle: some weird clang internal search path logic.,https://github.com/bitcoin/bitcoin/pull/17920#issuecomment-666584564,666584564,
Sjors,2020-12-11 18:34:05,"Tested 40ad76806b9f750d9c94675b3a136132bf1e6449. I (re)installed guix on an Ubuntu 20 machine and used `--no-substitutes` and `--bootstrap` to exercise my low time preference.\n\nThis did not go without hickups, e.g.:\n* `guix install glibc-locales` (as root, this would fail without substitutes) and configuring `GUIX_LOCPATH` (as guix user) is not particularly well documented upstream\n* durin",https://github.com/bitcoin/bitcoin/pull/17920#issuecomment-743355962,743355962,
dongcarl,2020-12-11 19:48:00,"Many thanks for testing @Sjors! Your review is super helpful as I want to make this process as user-friendly as possible. Even for the folks building without substitutes! Cheers.\n\nTo start off, it seems like reproducibility is working!\n```\n$ sha256sum distsrc-x86_64-linux-gnu/src/bitcoind distsrc-x86_64-apple-darwin16/Bitcoin-Qt.app/Contents/MacOS/Bitcoin-Qt\n0aa66de467110bf45e7606d2696ea",https://github.com/bitcoin/bitcoin/pull/17920#issuecomment-743392549,743392549,
Sjors,2020-12-13 14:04:44,"guix describe (as root)\n```\n/gnu/store/pwcp239kjf7lnj5i4lkdzcfcxwcfyk72-bash-minimal-5.0.16/bin/bash: warning: setlocale: LC_ALL: cannot change locale (en_US.UTF-8)\nguix describe: error: failed to determine origin\nhint: Perhaps this `guix' command was not obtained with `guix pull'? Its version string is 1.2.0.\n```\n\n(my Ubuntu install in general is a cluster f*** that I very much feel",https://github.com/bitcoin/bitcoin/pull/17920#issuecomment-744012656,744012656,
dongcarl,2020-12-14 23:51:40,"@Sjors Looking into a few things... Could you send me the file that's returned by:\n```\n$ guix build --log-file /gnu/store/36fgj9n3c8bmix2pd12kfaszi7bd5y7a-ghostscript-9.27.drv\n```\n\nMuch appreciated.",https://github.com/bitcoin/bitcoin/pull/17920#issuecomment-744830881,744830881,
Sjors,2020-12-15 12:48:19,"As user `guix` as well as `root`:\n```\n/gnu/store/pwcp239kjf7lnj5i4lkdzcfcxwcfyk72-bash-minimal-5.0.16/bin/bash: warning: setlocale: LC_ALL: cannot change locale (en_US.UTF-8)\nguix build: error: no build log for '/gnu/store/3i5qm6z0qihhjbdgs3pwj42gy63sf74h-ghostscript-9.27'\n```\n\nI ran the garbage collector `guix gc` and `git clean -xdff --exclude='/depends/SDKs/*'` and did another build",https://github.com/bitcoin/bitcoin/pull/17920#issuecomment-745266535,745266535,
dongcarl,2020-12-15 23:05:49,"@Sjors Would you mind giving me more info on your setup? I'm particularly interested in what distro and kernel version you were using when you encountered:\n\n> guix install glibc-locales (as root, this would fail without substitutes)",https://github.com/bitcoin/bitcoin/pull/17920#issuecomment-745622551,745622551,
Sjors,2020-12-17 12:37:44,"Ubuntu 20.04.1 LTS (GNU/Linux 5.4.0-33-generic x86_64)\n\nI installed Guix as root using their `guix-install.sh` script. I have a user `guix` where I cloned this branch and from which I run the builds. ",https://github.com/bitcoin/bitcoin/pull/17920#issuecomment-747414337,747414337,
dongcarl,2021-01-13 19:54:07,"Pushed 0e5c7bf5991a3e1c5e3df779a445e1690f067f5b -> 05a31a95832b592ee565d3a429afcf6cbf5ae672\n- Addressed https://github.com/bitcoin/bitcoin/pull/17920#discussion_r556184995 and https://github.com/bitcoin/bitcoin/pull/17920#discussion_r556185284\n\n-----\n\n> Is there a reason this is still draft?\n\nNope!",https://github.com/bitcoin/bitcoin/pull/17920#issuecomment-759702814,759702814,
fanquake,2021-01-14 00:57:43,"05a31a95832b592ee565d3a429afcf6cbf5ae672\n```bash\nfind output/ -type f -print0 | env LC_ALL=C sort -z | xargs -r0 sha256sum\n3f2762da34e6681471a7ede52ff7739e0e5ad64dd4584ae1e6d4af47456c2a98  output/bitcoin-05a31a95832b-osx-unsigned.dmg\nffc15b01f5028bf15fda61c1b3d785c2ba6e72fdfdd3292ea7f7d7f0b5230f9f  output/bitcoin-05a31a95832b-osx-unsigned.tar.gz\n538ba85976b7dec9353d9e246346cac792916ed2a5",https://github.com/bitcoin/bitcoin/pull/17920#issuecomment-759854278,759854278,
dongcarl,2021-01-14 03:36:56,"I'm getting matching hashes!\n\n```\nfind output/ -type f -print0 | env LC_ALL=C sort -z | xargs -r0 sha256sum\n3f2762da34e6681471a7ede52ff7739e0e5ad64dd4584ae1e6d4af47456c2a98  output/bitcoin-05a31a95832b-osx-unsigned.dmg\nffc15b01f5028bf15fda61c1b3d785c2ba6e72fdfdd3292ea7f7d7f0b5230f9f  output/bitcoin-05a31a95832b-osx-unsigned.tar.gz\n538ba85976b7dec9353d9e246346cac792916ed2a59360c5ded8c7e",https://github.com/bitcoin/bitcoin/pull/17920#issuecomment-759904139,759904139,
dongcarl,2021-01-21 16:19:24,"Pushed 05a31a95832b592ee565d3a429afcf6cbf5ae672 -> f1694757ddbcb3635213b085e864851e285c8c12\n- Rebased over master\n- Fixed typo\n\nHashes:\n```\n2d17b6c787f91bf32e5d3732a6a054df1940d26030fc19d845ca0b472283a1bb  output/bitcoin-f1694757ddbc-osx-unsigned.dmg\nc5a8207f4d76928b88ac9dfed61197be9bfd62ba93821898a9c90e1eb8a5a7d5  output/bitcoin-f1694757ddbc-osx-unsigned.tar.gz\nbb972ac7f0f03c31d30",https://github.com/bitcoin/bitcoin/pull/17920#issuecomment-764763002,764763002,
fanquake,2021-01-22 04:16:43,"ACK f1694757ddbcb3635213b085e864851e285c8c12 - I think we can make some small usability improvements, but this is ok to merge now.\n\n```bash\nfind output/ -type f -print0 | env LC_ALL=C sort -z | xargs -r0 sha256sum\n2d17b6c787f91bf32e5d3732a6a054df1940d26030fc19d845ca0b472283a1bb  output/bitcoin-f1694757ddbc-osx-unsigned.dmg\nc5a8207f4d76928b88ac9dfed61197be9bfd62ba93821898a9c90e1eb8a5a7d5 ",https://github.com/bitcoin/bitcoin/pull/17920#issuecomment-765109583,765109583,
Sjors,2021-01-22 19:20:23,Post merge test: I get the same checksums!,https://github.com/bitcoin/bitcoin/pull/17920#issuecomment-765631615,765631615,
fanquake,2020-01-14 04:02:54," I assume we no longer have to set `ZERO_AR_DATE` here because we're not using a libtool from cctools?\n\nFrom [libtool.c](https://opensource.apple.com/source/cctools/cctools-927.0.2/misc/libtool.c.auto.html):\n> all of these values are initialized to reasonable defaults for deterministic\narchives: archives that are consistent regardless of user, time, or umask\ndifferences. Ordinarily, thes",https://github.com/bitcoin/bitcoin/pull/17920#discussion_r366143926,366143926,contrib/guix/libexec/build-osx.sh
fanquake,2020-01-14 04:08:16,ðŸ—£ ,https://github.com/bitcoin/bitcoin/pull/17920#discussion_r366144729,366144729,contrib/guix/libexec/build.sh
fanquake,2021-01-13 00:30:12,"```suggestion\n  x86_64-apple-darwin18"")_\n```\n\nThroughout this PR, to match depends, gitian etc.",https://github.com/bitcoin/bitcoin/pull/17920#discussion_r556184995,556184995,contrib/guix/README.md
fanquake,2021-01-13 00:31:12,"Why are we skipping the security checks for macOS builds? Same Q re symbol checks below. If there's a specific reason why these can't be run right now, we should add a comment.\n\nYou could also drop `ELF`, as these are already being done on Linux & Win binaries.",https://github.com/bitcoin/bitcoin/pull/17920#discussion_r556185284,556185284,contrib/guix/libexec/build.sh
dongcarl,2021-01-13 19:52:08,Thanks! Fixed as of 05a31a95832b592ee565d3a429afcf6cbf5ae672,https://github.com/bitcoin/bitcoin/pull/17920#discussion_r556788979,556788979,contrib/guix/README.md
dongcarl,2021-01-13 19:53:21,"Originally I skipped them because we don't perform them in gitian osx builds, which I thought had some significance. As of 05a31a95832b592ee565d3a429afcf6cbf5ae672 they are enabled for all builds in Guix. Sweet!",https://github.com/bitcoin/bitcoin/pull/17920#discussion_r556789676,556789676,contrib/guix/libexec/build.sh
MarcoFalke,2021-01-22 06:38:12,"Why is this changed, seems unrelated to macos, no? Does this break gcc cross builds for our linux archs that need gcc 8 at least?",https://github.com/bitcoin/bitcoin/pull/17920#discussion_r562417371,562417371,contrib/guix/manifest.scm
MarcoFalke,2021-01-23 07:40:47,"Btw, this is the comment I was referring to: https://github.com/bitcoin/bitcoin/pull/13665#issuecomment-405601228\n\nI presume that guix is using a gcc-7 that has a fix backported?",https://github.com/bitcoin/bitcoin/pull/17920#discussion_r563033667,563033667,contrib/guix/manifest.scm
