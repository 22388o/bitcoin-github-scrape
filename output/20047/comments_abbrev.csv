theStack,2020-09-30 15:01:41,"Note that the test methods `last_block_equals()` and `last_header_equals()` are still needed for checking that the concerned message _didn't_ arrive within a certain time window:\nhttps://github.com/bitcoin/bitcoin/blob/72affcb16cad45bd9e08ca163b2147fd01b84b70/test/functional/p2p_fingerprint.py#L123-L131\nUnfortunately I couldn't figure out how to use the `wait_for_{block,header}` functions for ",https://github.com/bitcoin/bitcoin/pull/20047#issuecomment-701448360,701448360,
guggero,2020-10-04 10:20:33,"Concept ACK 136d96b7.\n\nMaybe we should inline the two methods `last_block_equals` and `last_header_equals` because they are only used with a negation currently.\nThat means the test would still pass if for some reason `node.last_message.get(""block"")` is falsey. What should be tested in the `assert not self.last_block_equals()` is that the last message's block was available but the hash didn't",https://github.com/bitcoin/bitcoin/pull/20047#issuecomment-703234004,703234004,
theStack,2020-10-04 12:36:27,"@guggero: Thanks a lot for reviewing and your inputs, good points!\nI think that actually we can get rid of the functions `last_{block,header}_equals` completely (i.e. not even needing to inline them), as a check ensuring that _no_ blocks or header message actually arrives after requesting very old blocks/headers should be sufficient. That is, removing ""blocks""/""headers"" from the last_message dic",https://github.com/bitcoin/bitcoin/pull/20047#issuecomment-703249363,703249363,
guggero,2020-10-04 13:09:37,"tACK 521b833a.\n\nNice change with this additional commit, I agree that this makes the test even more precise while removing more code than it adds.",https://github.com/bitcoin/bitcoin/pull/20047#issuecomment-703253348,703253348,
theStack,2020-10-06 13:30:15,"Force-pushed with the suggestions from MarcoFalke (https://github.com/bitcoin/bitcoin/pull/20047#discussion_r499482654, https://github.com/bitcoin/bitcoin/pull/20047#discussion_r499482805).",https://github.com/bitcoin/bitcoin/pull/20047#issuecomment-704270106,704270106,
MarcoFalke,2020-11-19 15:37:50,"pm ACK 6b56c1f4d0d5857d9d61a81dc96db1b603c368b5\n",https://github.com/bitcoin/bitcoin/pull/20047#issuecomment-730456828,730456828,
MarcoFalke,2020-10-05 10:00:52,"I think this can replace the section ""# Send getdata & getheaders to refresh last received getheader message"", no?",https://github.com/bitcoin/bitcoin/pull/20047#discussion_r499482654,499482654,test/functional/p2p_fingerprint.py
MarcoFalke,2020-10-05 10:01:07,unrelated: why not sync_with_ping?,https://github.com/bitcoin/bitcoin/pull/20047#discussion_r499482805,499482805,test/functional/p2p_fingerprint.py
theStack,2020-10-06 13:29:02,"Indeed, done. The ""node0.sync_with_ping()"" is still needed though to ensure that the newly generated block in the previous section ""Longest chain is extended so stale is much older than chain tip"" has been already received and doesn't interfere with the request for the old stale block test.",https://github.com/bitcoin/bitcoin/pull/20047#discussion_r500276177,500276177,test/functional/p2p_fingerprint.py
theStack,2020-10-06 13:29:10,"Good idea, done. It's always nice to get rid of time.sleep(...) constructs that are not really needed.",https://github.com/bitcoin/bitcoin/pull/20047#discussion_r500276260,500276260,test/functional/p2p_fingerprint.py
guggero,2020-10-21 12:42:45,The array index selection at the end of the line (`[0]`) isn't needed anymore if return value isn't stored in a variable.,https://github.com/bitcoin/bitcoin/pull/20047#discussion_r509244801,509244801,test/functional/p2p_fingerprint.py
theStack,2020-10-21 13:33:30,"Good find, thanks! Fixed.",https://github.com/bitcoin/bitcoin/pull/20047#discussion_r509286770,509286770,test/functional/p2p_fingerprint.py
