[
  {
    "sha": "025b5f74969251704c12a42864cb4891ba3ae47b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzowMjViNWY3NDk2OTI1MTcwNGMxMmE0Mjg2NGNiNDg5MWJhM2FlNDdi",
    "commit": {
      "author": {
        "name": "Philip Kaufmann",
        "email": "phil.kaufmann@t-online.de",
        "date": "2015-05-31T13:39:51Z"
      },
      "committer": {
        "name": "Philip Kaufmann",
        "email": "phil.kaufmann@t-online.de",
        "date": "2015-06-06T10:15:35Z"
      },
      "message": "[net] remove an obscure macro used in CNode::copyStats\n\n- no code change",
      "tree": {
        "sha": "6d6aa0bf8be96c80ca66b9e0bf1678ed8d7401ed",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6d6aa0bf8be96c80ca66b9e0bf1678ed8d7401ed"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/025b5f74969251704c12a42864cb4891ba3ae47b",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/025b5f74969251704c12a42864cb4891ba3ae47b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/025b5f74969251704c12a42864cb4891ba3ae47b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/025b5f74969251704c12a42864cb4891ba3ae47b/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "606ba62d88ff58c7c5f0b3cd619999e03bc4f6a2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/606ba62d88ff58c7c5f0b3cd619999e03bc4f6a2",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/606ba62d88ff58c7c5f0b3cd619999e03bc4f6a2"
      }
    ],
    "stats": {
      "total": 29,
      "additions": 13,
      "deletions": 16
    },
    "files": [
      {
        "sha": "ee020444a8987ab5e0023abb26a929c48cf84d42",
        "filename": "src/net.cpp",
        "status": "modified",
        "additions": 13,
        "deletions": 16,
        "changes": 29,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/025b5f74969251704c12a42864cb4891ba3ae47b/src/net.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/025b5f74969251704c12a42864cb4891ba3ae47b/src/net.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.cpp?ref=025b5f74969251704c12a42864cb4891ba3ae47b",
        "patch": "@@ -486,24 +486,22 @@ void CNode::AddWhitelistedRange(const CSubNet &subnet) {\n     vWhitelistedRange.push_back(subnet);\n }\n \n-#undef X\n-#define X(name) stats.name = name\n void CNode::copyStats(CNodeStats &stats)\n {\n     stats.nodeid = this->GetId();\n-    X(nServices);\n-    X(nLastSend);\n-    X(nLastRecv);\n-    X(nTimeConnected);\n-    X(nTimeOffset);\n-    X(addrName);\n-    X(nVersion);\n-    X(cleanSubVer);\n-    X(fInbound);\n-    X(nStartingHeight);\n-    X(nSendBytes);\n-    X(nRecvBytes);\n-    X(fWhitelisted);\n+    stats.nServices = nServices;\n+    stats.nLastSend = nLastSend;\n+    stats.nLastRecv = nLastRecv;\n+    stats.nTimeConnected = nTimeConnected;\n+    stats.nTimeOffset = nTimeOffset;\n+    stats.addrName = addrName;\n+    stats.nVersion = nVersion;\n+    stats.cleanSubVer = cleanSubVer;\n+    stats.fInbound = fInbound;\n+    stats.nStartingHeight = nStartingHeight;\n+    stats.nSendBytes = nSendBytes;\n+    stats.nRecvBytes = nRecvBytes;\n+    stats.fWhitelisted = fWhitelisted;\n \n     // It is common for nodes with good ping times to suddenly become lagged,\n     // due to a new block arriving or other large transfer.\n@@ -523,7 +521,6 @@ void CNode::copyStats(CNodeStats &stats)\n     // Leave string empty if addrLocal invalid (not filled in yet)\n     stats.addrLocal = addrLocal.IsValid() ? addrLocal.ToString() : \"\";\n }\n-#undef X\n \n // requires LOCK(cs_vRecvMsg)\n bool CNode::ReceiveMsgBytes(const char *pch, unsigned int nBytes)"
      }
    ]
  },
  {
    "sha": "84c6b8536559c7767e6e0b35a1e5d7a7aa158683",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4NGM2Yjg1MzY1NTljNzc2N2U2ZTBiMzVhMWU1ZDdhN2FhMTU4Njgz",
    "commit": {
      "author": {
        "name": "Philip Kaufmann",
        "email": "phil.kaufmann@t-online.de",
        "date": "2015-06-06T10:38:24Z"
      },
      "committer": {
        "name": "Philip Kaufmann",
        "email": "phil.kaufmann@t-online.de",
        "date": "2015-06-06T10:38:24Z"
      },
      "message": "squashme",
      "tree": {
        "sha": "1585297067fe01c17c039d6c52968780ab0a19ff",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1585297067fe01c17c039d6c52968780ab0a19ff"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/84c6b8536559c7767e6e0b35a1e5d7a7aa158683",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/84c6b8536559c7767e6e0b35a1e5d7a7aa158683",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/84c6b8536559c7767e6e0b35a1e5d7a7aa158683",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/84c6b8536559c7767e6e0b35a1e5d7a7aa158683/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "025b5f74969251704c12a42864cb4891ba3ae47b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/025b5f74969251704c12a42864cb4891ba3ae47b",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/025b5f74969251704c12a42864cb4891ba3ae47b"
      }
    ],
    "stats": {
      "total": 48,
      "additions": 24,
      "deletions": 24
    },
    "files": [
      {
        "sha": "3cd688971f4dcbf9380030dab03ec2c8b35a4e1a",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/84c6b8536559c7767e6e0b35a1e5d7a7aa158683/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/84c6b8536559c7767e6e0b35a1e5d7a7aa158683/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=84c6b8536559c7767e6e0b35a1e5d7a7aa158683",
        "patch": "@@ -3940,7 +3940,7 @@ bool static ProcessMessage(CNode* pfrom, string strCommand, CDataStream& vRecv,\n         CAddress addrMe;\n         CAddress addrFrom;\n         uint64_t nNonce = 1;\n-        vRecv >> pfrom->nVersion >> pfrom->nServices >> nTime >> addrMe;\n+        vRecv >> pfrom->nVersion >> pfrom->stats.nServices >> nTime >> addrMe;\n         if (pfrom->nVersion < MIN_PEER_PROTO_VERSION)\n         {\n             // disconnect from peers older than this proto version\n@@ -3984,7 +3984,7 @@ bool static ProcessMessage(CNode* pfrom, string strCommand, CDataStream& vRecv,\n         if (pfrom->fInbound)\n             pfrom->PushVersion();\n \n-        pfrom->fClient = !(pfrom->nServices & NODE_NETWORK);\n+        pfrom->fClient = !(pfrom->stats.nServices & NODE_NETWORK);\n \n         // Potentially mark this peer as a preferred download peer.\n         UpdatePreferredDownload(pfrom, State(pfrom->GetId()));"
      },
      {
        "sha": "4c3527902c01329f2e024b5ef34e54ae46ef60db",
        "filename": "src/net.cpp",
        "status": "modified",
        "additions": 20,
        "deletions": 20,
        "changes": 40,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/84c6b8536559c7767e6e0b35a1e5d7a7aa158683/src/net.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/84c6b8536559c7767e6e0b35a1e5d7a7aa158683/src/net.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.cpp?ref=84c6b8536559c7767e6e0b35a1e5d7a7aa158683",
        "patch": "@@ -486,22 +486,22 @@ void CNode::AddWhitelistedRange(const CSubNet &subnet) {\n     vWhitelistedRange.push_back(subnet);\n }\n \n-void CNode::copyStats(CNodeStats &stats)\n-{\n-    stats.nodeid = this->GetId();\n-    stats.nServices = nServices;\n-    stats.nLastSend = nLastSend;\n-    stats.nLastRecv = nLastRecv;\n-    stats.nTimeConnected = nTimeConnected;\n-    stats.nTimeOffset = nTimeOffset;\n-    stats.addrName = addrName;\n-    stats.nVersion = nVersion;\n-    stats.cleanSubVer = cleanSubVer;\n-    stats.fInbound = fInbound;\n-    stats.nStartingHeight = nStartingHeight;\n-    stats.nSendBytes = nSendBytes;\n-    stats.nRecvBytes = nRecvBytes;\n-    stats.fWhitelisted = fWhitelisted;\n+void CNode::copyStats(CNodeStats& statsIn)\n+{\n+    statsIn.nodeid = this->GetId();\n+    statsIn.nServices = stats.nServices;\n+    statsIn.nLastSend = nLastSend;\n+    statsIn.nLastRecv = nLastRecv;\n+    statsIn.nTimeConnected = nTimeConnected;\n+    statsIn.nTimeOffset = nTimeOffset;\n+    statsIn.addrName = addrName;\n+    statsIn.nVersion = nVersion;\n+    statsIn.cleanSubVer = cleanSubVer;\n+    statsIn.fInbound = fInbound;\n+    statsIn.nStartingHeight = nStartingHeight;\n+    statsIn.nSendBytes = nSendBytes;\n+    statsIn.nRecvBytes = nRecvBytes;\n+    statsIn.fWhitelisted = fWhitelisted;\n \n     // It is common for nodes with good ping times to suddenly become lagged,\n     // due to a new block arriving or other large transfer.\n@@ -515,11 +515,11 @@ void CNode::copyStats(CNodeStats &stats)\n     }\n \n     // Raw ping time is in microseconds, but show it to user as whole seconds (Bitcoin users should be well used to small numbers with many decimal places by now :)\n-    stats.dPingTime = (((double)nPingUsecTime) / 1e6);\n-    stats.dPingWait = (((double)nPingUsecWait) / 1e6);\n+    statsIn.dPingTime = (((double)nPingUsecTime) / 1e6);\n+    statsIn.dPingWait = (((double)nPingUsecWait) / 1e6);\n \n     // Leave string empty if addrLocal invalid (not filled in yet)\n-    stats.addrLocal = addrLocal.IsValid() ? addrLocal.ToString() : \"\";\n+    statsIn.addrLocal = addrLocal.IsValid() ? addrLocal.ToString() : \"\";\n }\n \n // requires LOCK(cs_vRecvMsg)\n@@ -1907,7 +1907,7 @@ CNode::CNode(SOCKET hSocketIn, const CAddress& addrIn, const std::string& addrNa\n     addrKnown(5000, 0.001, insecure_rand()),\n     setInventoryKnown(SendBufferSize() / 1000)\n {\n-    nServices = 0;\n+    stats.nServices = 0;\n     hSocket = hSocketIn;\n     nRecvVersion = INIT_PROTO_VERSION;\n     nLastSend = 0;"
      },
      {
        "sha": "a19cc4b697d1cc77de457c5ecd81c7e002a46512",
        "filename": "src/net.h",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/84c6b8536559c7767e6e0b35a1e5d7a7aa158683/src/net.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/84c6b8536559c7767e6e0b35a1e5d7a7aa158683/src/net.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.h?ref=84c6b8536559c7767e6e0b35a1e5d7a7aa158683",
        "patch": "@@ -234,8 +234,8 @@ class CNetMessage {\n class CNode\n {\n public:\n+    CNodeStats stats;\n     // socket\n-    uint64_t nServices;\n     SOCKET hSocket;\n     CDataStream ssSend;\n     size_t nSendSize; // total size of all vSendMsg entries\n@@ -607,7 +607,7 @@ class CNode\n     static void ClearBanned(); // needed for unit testing\n     static bool IsBanned(CNetAddr ip);\n     static bool Ban(const CNetAddr &ip);\n-    void copyStats(CNodeStats &stats);\n+    void copyStats(CNodeStats& statsIn);\n \n     static bool IsWhitelistedRange(const CNetAddr &ip);\n     static void AddWhitelistedRange(const CSubNet &subnet);"
      }
    ]
  }
]