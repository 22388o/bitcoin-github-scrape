[
  {
    "sha": "40f4aa8a619e44208c33d1cee4db2f42b823cade",
    "node_id": "C_kwDOABII59oAKDQwZjRhYThhNjE5ZTQ0MjA4YzMzZDFjZWU0ZGIyZjQyYjgyM2NhZGU",
    "commit": {
      "author": {
        "name": "Perlover",
        "email": "perlover@perlover.com",
        "date": "2021-11-26T16:27:48Z"
      },
      "committer": {
        "name": "Perlover",
        "email": "perlover@perlover.com",
        "date": "2021-11-30T14:38:31Z"
      },
      "message": "Now the evhttp_connection_get_peer in the libevent library has a second parameter as 'const char **' instead 'char **' (commit libevent/libevent@a18301a). Compilation is aborted with an error after type conversion. In order for the compilation to work with all libraries, here we use macros to make the necessary transformation, which was determined during configure.",
      "tree": {
        "sha": "e330a5904a852d6c9e1992949aa5741f01f70a28",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e330a5904a852d6c9e1992949aa5741f01f70a28"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/40f4aa8a619e44208c33d1cee4db2f42b823cade",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/40f4aa8a619e44208c33d1cee4db2f42b823cade",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/40f4aa8a619e44208c33d1cee4db2f42b823cade",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/40f4aa8a619e44208c33d1cee4db2f42b823cade/comments",
    "author": {
      "login": "Perlover",
      "id": 574333,
      "node_id": "MDQ6VXNlcjU3NDMzMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/574333?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Perlover",
      "html_url": "https://github.com/Perlover",
      "followers_url": "https://api.github.com/users/Perlover/followers",
      "following_url": "https://api.github.com/users/Perlover/following{/other_user}",
      "gists_url": "https://api.github.com/users/Perlover/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Perlover/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Perlover/subscriptions",
      "organizations_url": "https://api.github.com/users/Perlover/orgs",
      "repos_url": "https://api.github.com/users/Perlover/repos",
      "events_url": "https://api.github.com/users/Perlover/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Perlover/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "Perlover",
      "id": 574333,
      "node_id": "MDQ6VXNlcjU3NDMzMw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/574333?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Perlover",
      "html_url": "https://github.com/Perlover",
      "followers_url": "https://api.github.com/users/Perlover/followers",
      "following_url": "https://api.github.com/users/Perlover/following{/other_user}",
      "gists_url": "https://api.github.com/users/Perlover/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Perlover/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Perlover/subscriptions",
      "organizations_url": "https://api.github.com/users/Perlover/orgs",
      "repos_url": "https://api.github.com/users/Perlover/repos",
      "events_url": "https://api.github.com/users/Perlover/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Perlover/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "ffdf8ee43e2440ab59b85846ab98854b17e49e49",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ffdf8ee43e2440ab59b85846ab98854b17e49e49",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/ffdf8ee43e2440ab59b85846ab98854b17e49e49"
      }
    ],
    "stats": {
      "total": 20,
      "additions": 19,
      "deletions": 1
    },
    "files": [
      {
        "sha": "79229f253e1fd46053a2eb0eef3d300447347c51",
        "filename": "configure.ac",
        "status": "modified",
        "additions": 8,
        "deletions": 0,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/40f4aa8a619e44208c33d1cee4db2f42b823cade/configure.ac",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/40f4aa8a619e44208c33d1cee4db2f42b823cade/configure.ac",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/configure.ac?ref=40f4aa8a619e44208c33d1cee4db2f42b823cade",
        "patch": "@@ -1510,6 +1510,13 @@ if test x$build_bitcoin_cli$build_bitcoind$bitcoin_enable_qt$use_tests$use_bench\n   fi\n fi\n \n+AC_MSG_CHECKING([for evhttp_connection_get_peer])\n+AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[#include <event2/http.h>]],\n+  [[ evhttp_connection_get_peer((evhttp_connection*) nullptr,(const char**) nullptr,(uint16_t *) nullptr); ]])],\n+  [ AC_MSG_RESULT([yes]); AC_DEFINE([HAVE_EVHTTP_CONNECTION_GET_PEER_CONST_CHAR], [1], [Define this symbol if evhttp_connection_get_peer has const char]) ],\n+  [ AC_MSG_RESULT([no]); AC_DEFINE([HAVE_EVHTTP_CONNECTION_GET_PEER_CONST_CHAR], [0], [Define this symbol if evhttp_connection_get_peer has const char]) ]\n+)\n+\n dnl QR Code encoding library check\n \n if test \"x$use_qr\" != xno; then\n@@ -1870,6 +1877,7 @@ AC_SUBST(HAVE_BUILTIN_PREFETCH)\n AC_SUBST(HAVE_MM_PREFETCH)\n AC_SUBST(HAVE_STRONG_GETAUXVAL)\n AC_SUBST(ANDROID_ARCH)\n+AC_SUBST(HAVE_EVHTTP_CONNECTION_GET_PEER_CONST_CHAR)\n AC_CONFIG_FILES([Makefile src/Makefile doc/man/Makefile share/setup.nsi share/qt/Info.plist test/config.ini])\n AC_CONFIG_FILES([contrib/devtools/split-debug.sh],[chmod +x contrib/devtools/split-debug.sh])\n AM_COND_IF([HAVE_DOXYGEN], [AC_CONFIG_FILES([doc/Doxyfile])])"
      },
      {
        "sha": "17a41357d8e17057ca8499a8094c705d34c64ebc",
        "filename": "src/httpserver.cpp",
        "status": "modified",
        "additions": 11,
        "deletions": 1,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/40f4aa8a619e44208c33d1cee4db2f42b823cade/src/httpserver.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/40f4aa8a619e44208c33d1cee4db2f42b823cade/src/httpserver.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/httpserver.cpp?ref=40f4aa8a619e44208c33d1cee4db2f42b823cade",
        "patch": "@@ -2,6 +2,10 @@\n // Distributed under the MIT software license, see the accompanying\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n+#if defined(HAVE_CONFIG_H)\n+#include <config/bitcoin-config.h>\n+#endif\n+\n #include <httpserver.h>\n \n #include <chainparamsbase.h>\n@@ -597,7 +601,13 @@ CService HTTPRequest::GetPeer() const\n         // evhttp retains ownership over returned address string\n         const char* address = \"\";\n         uint16_t port = 0;\n-        evhttp_connection_get_peer(con, (char**)&address, &port);\n+\n+#if HAVE_EVHTTP_CONNECTION_GET_PEER_CONST_CHAR\n+        evhttp_connection_get_peer(con, &address, &port);\n+#else\n+        evhttp_connection_get_peer(con, (char **)&address, &port);\n+#endif // HAVE_EVHTTP_CONNECTION_GET_PEER_CONST_CHAR\n+\n         peer = LookupNumeric(address, port);\n     }\n     return peer;"
      }
    ]
  }
]