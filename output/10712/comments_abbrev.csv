morcos,2017-06-30T19:51:29Z,"Fixed bug and nits and squashed\n\n@instagibbs I'm fine with doing the GetMinimumFeeRate refactor for 0.15, but I already did a lot of other work on GetMinimumFee in #10706 which I would really like to get in for 0.15, so I'm wary of piling on too many changes that touch the same lines of code and not being able to get them all in.\n\n\n",https://github.com/bitcoin/bitcoin/pull/10712#issuecomment-312358618,312358618,
promag,2017-07-03T09:06:35Z,All return points should call `reservekey.ReturnKey()`?,https://github.com/bitcoin/bitcoin/pull/10712#issuecomment-312591291,312591291,
promag,2017-07-03T09:16:41Z,Reference #10247.,https://github.com/bitcoin/bitcoin/pull/10712#issuecomment-312593651,312593651,
instagibbs,2017-07-03T12:20:23Z,@promag this is a bugfix with limited scope. Switching to effective value calculation fixes this in a more natural fashion. See: https://github.com/bitcoin/bitcoin/pull/10360 and https://github.com/bitcoin/bitcoin/pull/10637,https://github.com/bitcoin/bitcoin/pull/10712#issuecomment-312631038,312631038,
morcos,2017-07-05T16:36:27Z,"@promag \nNew variables are supposed to be snake_case, did I miss one?\nIf there are any other changes, I can fix the braces, but I didn't touch the moved code.\n\nAs for calling ReturnKey, I suppose that does make sense, but the existing code did not do that, and I haven't materially changed that behavior. I'm happy to add it though if I should?\n(Clarification: My only hesitation is that it",https://github.com/bitcoin/bitcoin/pull/10712#issuecomment-313157515,313157515,
promag,2017-07-06T00:10:21Z,"@morcos another PR is fine. As @instagibbs said, this is a bugfix.",https://github.com/bitcoin/bitcoin/pull/10712#issuecomment-313260057,313260057,
laanwj,2017-07-06T14:09:56Z,"Replaced #10333 with this one in ""High priority for review"" (reviewing a closed PR with high priority makes little sense).",https://github.com/bitcoin/bitcoin/pull/10712#issuecomment-313407260,313407260,
morcos,2017-07-11T00:21:01Z,"Fixed commit history and fixed comment nit\n\n```\ngit diff d64a4b9 533b3f0\n\n-                    // change input. Only try this once.\n+                    // change output. Only try this once.\n```",https://github.com/bitcoin/bitcoin/pull/10712#issuecomment-314286684,314286684,
instagibbs,2017-07-11T13:57:41Z,utACK https://github.com/bitcoin/bitcoin/pull/10712/commits/533b3f07f0525939d5fef2d22ec1ee699b7d437b,https://github.com/bitcoin/bitcoin/pull/10712#issuecomment-314451972,314451972,
morcos,2017-07-11T16:28:51Z,"This was rebased to add 2 new arguments to GetMinimumFee line which were introduced in #10589 \n\nWill change again as it conflicts with #10706 on that same point (depending on which is merged first, but I think this is ready)",https://github.com/bitcoin/bitcoin/pull/10712#issuecomment-314499307,314499307,
sipa,2017-07-11T18:03:25Z,Posthumous utACK 0f402b9,https://github.com/bitcoin/bitcoin/pull/10712#issuecomment-314525205,314525205,
instagibbs,2017-06-30T17:42:38Z,"please move first explanation a few lines before for the ""increase change"" to appropriate spot",https://github.com/bitcoin/bitcoin/pull/10712#discussion_r125092666,125092666,src/wallet/wallet.cpp
instagibbs,2017-06-30T17:48:51Z,"nit: slightly longer explanation for reader?\n\n""This shouldn't happen, we should have had enough excess fee to pay for the newly created change output.""\n\nWith fix on the nFeeRet, a very slight increase in fee between estimation calls(can that happen?) will result in this triggering.",https://github.com/bitcoin/bitcoin/pull/10712#discussion_r125094011,125094011,src/wallet/wallet.cpp
instagibbs,2017-06-30T17:51:02Z,"looks like a capital ""K"" snuck in here.",https://github.com/bitcoin/bitcoin/pull/10712#discussion_r125094446,125094446,src/wallet/wallet.cpp
instagibbs,2017-06-30T18:02:09Z,"this needs to be `nFeeRet = nFeeNeeded + GetMinimumFee(change_prototype_size, currentConfirmationTarget, ::mempool, ::feeEstimator, nullptr) ;` at a minimum, right?\n\nnFeeNeeded at this point will not pay for the new change output.",https://github.com/bitcoin/bitcoin/pull/10712#discussion_r125097059,125097059,src/wallet/wallet.cpp
morcos,2017-06-30T19:29:32Z,"oops, correct \n",https://github.com/bitcoin/bitcoin/pull/10712#discussion_r125114245,125114245,src/wallet/wallet.cpp
morcos,2017-06-30T19:30:06Z,"weird, i fixed that but must have not committed before push\n",https://github.com/bitcoin/bitcoin/pull/10712#discussion_r125114338,125114338,src/wallet/wallet.cpp
morcos,2017-06-30T19:31:04Z,"yes, i don't think that can happen (a change in fee estimation) but belts and suspenders.\nIn any case will be cleaned up post 0.15 with effective value logic and only calculating the needed fee rate once.",https://github.com/bitcoin/bitcoin/pull/10712#discussion_r125114484,125114484,src/wallet/wallet.cpp
instagibbs,2017-06-30T20:08:16Z,sorry to both you again on this but it appears to still be there,https://github.com/bitcoin/bitcoin/pull/10712#discussion_r125120879,125120879,src/wallet/wallet.cpp
ryanofsky,2017-07-10T21:38:20Z,"In commit ""Fix rare edge case of paying too many fees""\n\nThis needs to be moved to the previous commit for it to compile.",https://github.com/bitcoin/bitcoin/pull/10712#discussion_r126543900,126543900,src/wallet/wallet.cpp
ryanofsky,2017-07-10T22:03:14Z,change output,https://github.com/bitcoin/bitcoin/pull/10712#discussion_r126548824,126548824,src/wallet/wallet.cpp
ryanofsky,2017-07-10T22:24:10Z,"> please move first explanation a few lines before for the ""increase change"" to appropriate spot\n\nI think order of the comments does makes sense. First comment describes the normal case, second comment describes unhandled special case, and third comment describes handled special case accompanied by implementation for that case.\n\nI might move the code for the normal case above the code & co",https://github.com/bitcoin/bitcoin/pull/10712#discussion_r126552321,126552321,src/wallet/wallet.cpp
sipa,2017-07-11T08:30:32Z,Nit: else on the same line as `}`,https://github.com/bitcoin/bitcoin/pull/10712#discussion_r126626320,126626320,src/wallet/wallet.cpp
instagibbs,2017-07-11T13:56:07Z,"He moved it, the comment wasn't marked as resolved. Happy with current arrangement.",https://github.com/bitcoin/bitcoin/pull/10712#discussion_r126695357,126695357,src/wallet/wallet.cpp
