[
  {
    "sha": "4efbda3f257bd8e635715377d85862d322c57c4b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0ZWZiZGEzZjI1N2JkOGU2MzU3MTUzNzdkODU4NjJkMzIyYzU3YzRi",
    "commit": {
      "author": {
        "name": "sje397",
        "email": "sje397@gmail.com",
        "date": "2012-02-14T12:14:43Z"
      },
      "committer": {
        "name": "sje397",
        "email": "sje397@gmail.com",
        "date": "2012-02-15T12:29:59Z"
      },
      "message": "Added 'Backup Wallet' menu option\n\n- icon from the LGPL Nuvola set (like the tick) - http://www.icon-king.com/projects/nuvola/\n- include 'boost/version.hpp' in db.cpp so that the overwrite version of copy can be used\n- catch exceptions in BackupWallet (e.g. filesystem_error thrown when trying to overwrite without the overwrite flag set)\n- include db.h in walletmodel.cpp for BackupWallet function\n- updated doc/assets-attribution.txt and contrib/debian/copyright with copyright info for new icon",
      "tree": {
        "sha": "b968cfa7ffcded317da62e8792ff1aa3dacb2c88",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b968cfa7ffcded317da62e8792ff1aa3dacb2c88"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4efbda3f257bd8e635715377d85862d322c57c4b",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4efbda3f257bd8e635715377d85862d322c57c4b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/4efbda3f257bd8e635715377d85862d322c57c4b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4efbda3f257bd8e635715377d85862d322c57c4b/comments",
    "author": {
      "login": "sje397",
      "id": 214252,
      "node_id": "MDQ6VXNlcjIxNDI1Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/214252?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sje397",
      "html_url": "https://github.com/sje397",
      "followers_url": "https://api.github.com/users/sje397/followers",
      "following_url": "https://api.github.com/users/sje397/following{/other_user}",
      "gists_url": "https://api.github.com/users/sje397/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sje397/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sje397/subscriptions",
      "organizations_url": "https://api.github.com/users/sje397/orgs",
      "repos_url": "https://api.github.com/users/sje397/repos",
      "events_url": "https://api.github.com/users/sje397/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sje397/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sje397",
      "id": 214252,
      "node_id": "MDQ6VXNlcjIxNDI1Mg==",
      "avatar_url": "https://avatars.githubusercontent.com/u/214252?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sje397",
      "html_url": "https://github.com/sje397",
      "followers_url": "https://api.github.com/users/sje397/followers",
      "following_url": "https://api.github.com/users/sje397/following{/other_user}",
      "gists_url": "https://api.github.com/users/sje397/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sje397/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sje397/subscriptions",
      "organizations_url": "https://api.github.com/users/sje397/orgs",
      "repos_url": "https://api.github.com/users/sje397/repos",
      "events_url": "https://api.github.com/users/sje397/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sje397/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "15b87b2ec40bdcbc7e8173c79b829fc0f550909e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/15b87b2ec40bdcbc7e8173c79b829fc0f550909e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/15b87b2ec40bdcbc7e8173c79b829fc0f550909e"
      }
    ],
    "stats": {
      "total": 49,
      "additions": 42,
      "deletions": 7
    },
    "files": [
      {
        "sha": "71fa77cf6cb13a33a0abd69ee5cc4e91ef3d0b28",
        "filename": "contrib/debian/copyright",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4efbda3f257bd8e635715377d85862d322c57c4b/contrib/debian/copyright",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4efbda3f257bd8e635715377d85862d322c57c4b/contrib/debian/copyright",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/debian/copyright?ref=4efbda3f257bd8e635715377d85862d322c57c4b",
        "patch": "@@ -37,7 +37,7 @@ Files: src/qt/res/icons/address-book.png, src/qt/res/icons/export.png,\n        src/qt/res/icons/history.png, src/qt/res/icons/key.png,\n        src/qt/res/icons/lock_*.png, src/qt/res/icons/overview.png,\n        src/qt/res/icons/receive.png, src/qt/res/icons/send.png,\n-       src/qt/res/icons/synced.png\n+       src/qt/res/icons/synced.png, src/qt/res/icons/filesave.png\n Copyright: David Vignoni (david@icon-king.com)\n            ICON KING - www.icon-king.com\n License: LGPL"
      },
      {
        "sha": "fabcdeea76287e4588da54606b8a7776de370398",
        "filename": "doc/assets-attribution.txt",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4efbda3f257bd8e635715377d85862d322c57c4b/doc/assets-attribution.txt",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4efbda3f257bd8e635715377d85862d322c57c4b/doc/assets-attribution.txt",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/doc/assets-attribution.txt?ref=4efbda3f257bd8e635715377d85862d322c57c4b",
        "patch": "@@ -7,7 +7,7 @@ Icon: src/qt/res/icons/address-book.png, src/qt/res/icons/export.png,\n       src/qt/res/icons/history.png, src/qt/res/icons/key.png,\n       src/qt/res/icons/lock_*.png, src/qt/res/icons/overview.png,\n       src/qt/res/icons/receive.png, src/qt/res/icons/send.png,\n-      src/qt/res/icons/synced.png\n+      src/qt/res/icons/synced.png, src/qt/res/icons/filesave.png\n Icon Pack: NUVOLA ICON THEME for KDE 3.x\n Designer: David Vignoni (david@icon-king.com)\n           ICON KING - www.icon-king.com"
      },
      {
        "sha": "9a904ec2e07a69acf033089886bed2d41067366f",
        "filename": "src/db.cpp",
        "status": "modified",
        "additions": 11,
        "deletions": 5,
        "changes": 16,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4efbda3f257bd8e635715377d85862d322c57c4b/src/db.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4efbda3f257bd8e635715377d85862d322c57c4b/src/db.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/db.cpp?ref=4efbda3f257bd8e635715377d85862d322c57c4b",
        "patch": "@@ -6,6 +6,7 @@\n #include \"headers.h\"\n #include \"db.h\"\n #include \"net.h\"\n+#include <boost/version.hpp>\n #include <boost/filesystem.hpp>\n #include <boost/filesystem/fstream.hpp>\n \n@@ -1064,14 +1065,19 @@ bool BackupWallet(const CWallet& wallet, const string& strDest)\n                 filesystem::path pathDest(strDest);\n                 if (filesystem::is_directory(pathDest))\n                     pathDest = pathDest / wallet.strWalletFile;\n+\n+                try {\n #if BOOST_VERSION >= 104000\n-                filesystem::copy_file(pathSrc, pathDest, filesystem::copy_option::overwrite_if_exists);\n+                    filesystem::copy_file(pathSrc, pathDest, filesystem::copy_option::overwrite_if_exists);\n #else\n-                filesystem::copy_file(pathSrc, pathDest);\n+                    filesystem::copy_file(pathSrc, pathDest);\n #endif\n-                printf(\"copied wallet.dat to %s\\n\", pathDest.string().c_str());\n-\n-                return true;\n+                    printf(\"copied wallet.dat to %s\\n\", pathDest.string().c_str());\n+                    return true;\n+                } catch(const filesystem::filesystem_error &e) {\n+                    printf(\"error copying wallet.dat to %s - %s\\n\", pathDest.string().c_str(), e.what());\n+                    return false;\n+                }\n             }\n         }\n         Sleep(100);"
      },
      {
        "sha": "d823752c9cc34416cc34f42c93ab58b964e4bf8d",
        "filename": "src/qt/bitcoin.qrc",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4efbda3f257bd8e635715377d85862d322c57c4b/src/qt/bitcoin.qrc",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4efbda3f257bd8e635715377d85862d322c57c4b/src/qt/bitcoin.qrc",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoin.qrc?ref=4efbda3f257bd8e635715377d85862d322c57c4b",
        "patch": "@@ -37,6 +37,7 @@\n         <file alias=\"lock_closed\">res/icons/lock_closed.png</file>\n         <file alias=\"lock_open\">res/icons/lock_open.png</file>\n         <file alias=\"key\">res/icons/key.png</file>\n+        <file alias=\"filesave\">res/icons/filesave.png</file>\n     </qresource>\n     <qresource prefix=\"/images\">\n         <file alias=\"about\">res/images/about.png</file>"
      },
      {
        "sha": "f3b1d0e48f0b1d5858a2c9d2986c21963822e066",
        "filename": "src/qt/bitcoingui.cpp",
        "status": "modified",
        "additions": 17,
        "deletions": 0,
        "changes": 17,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4efbda3f257bd8e635715377d85862d322c57c4b/src/qt/bitcoingui.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4efbda3f257bd8e635715377d85862d322c57c4b/src/qt/bitcoingui.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoingui.cpp?ref=4efbda3f257bd8e635715377d85862d322c57c4b",
        "patch": "@@ -46,6 +46,8 @@\n #include <QStackedWidget>\n #include <QDateTime>\n #include <QMovie>\n+#include <QFileDialog>\n+#include <QDesktopServices>\n \n #include <QDragEnterEvent>\n #include <QUrl>\n@@ -243,6 +245,8 @@ void BitcoinGUI::createActions()\n     encryptWalletAction = new QAction(QIcon(\":/icons/lock_closed\"), tr(\"&Encrypt Wallet\"), this);\n     encryptWalletAction->setToolTip(tr(\"Encrypt or decrypt wallet\"));\n     encryptWalletAction->setCheckable(true);\n+    backupWalletAction = new QAction(QIcon(\":/icons/filesave\"), tr(\"&Backup Wallet\"), this);\n+    backupWalletAction->setToolTip(tr(\"Backup wallet to another location\"));\n     changePassphraseAction = new QAction(QIcon(\":/icons/key\"), tr(\"&Change Passphrase\"), this);\n     changePassphraseAction->setToolTip(tr(\"Change the passphrase used for wallet encryption\"));\n \n@@ -252,6 +256,7 @@ void BitcoinGUI::createActions()\n     connect(aboutQtAction, SIGNAL(triggered()), qApp, SLOT(aboutQt()));\n     connect(openBitcoinAction, SIGNAL(triggered()), this, SLOT(showNormal()));\n     connect(encryptWalletAction, SIGNAL(triggered(bool)), this, SLOT(encryptWallet(bool)));\n+    connect(backupWalletAction, SIGNAL(triggered()), this, SLOT(backupWallet()));\n     connect(changePassphraseAction, SIGNAL(triggered()), this, SLOT(changePassphrase()));\n }\n \n@@ -277,6 +282,7 @@ void BitcoinGUI::createMenuBar()\n     QMenu *settings = appMenuBar->addMenu(tr(\"&Settings\"));\n     settings->addAction(encryptWalletAction);\n     settings->addAction(changePassphraseAction);\n+    settings->addAction(backupWalletAction);\n     settings->addSeparator();\n     settings->addAction(optionsAction);\n \n@@ -778,6 +784,17 @@ void BitcoinGUI::encryptWallet(bool status)\n     setEncryptionStatus(walletModel->getEncryptionStatus());\n }\n \n+void BitcoinGUI::backupWallet()\n+{\n+    QString saveDir = QDesktopServices::storageLocation(QDesktopServices::DocumentsLocation);\n+    QString filename = QFileDialog::getSaveFileName(this, tr(\"Backup Wallet\"), saveDir, tr(\"Wallet Data (*.dat)\"));\n+    if(!filename.isEmpty()) {\n+        if(!walletModel->backupWallet(filename)) {\n+            QMessageBox::warning(this, tr(\"Backup Failed\"), tr(\"There was an error trying to save the wallet data to the new location.\"));\n+        }\n+    }\n+}\n+\n void BitcoinGUI::changePassphrase()\n {\n     AskPassphraseDialog dlg(AskPassphraseDialog::ChangePass, this);"
      },
      {
        "sha": "a5224290001cc1ef430162c3f2337af6455c13ee",
        "filename": "src/qt/bitcoingui.h",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4efbda3f257bd8e635715377d85862d322c57c4b/src/qt/bitcoingui.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4efbda3f257bd8e635715377d85862d322c57c4b/src/qt/bitcoingui.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoingui.h?ref=4efbda3f257bd8e635715377d85862d322c57c4b",
        "patch": "@@ -86,6 +86,7 @@ class BitcoinGUI : public QMainWindow\n     QAction *openBitcoinAction;\n     QAction *exportAction;\n     QAction *encryptWalletAction;\n+    QAction *backupWalletAction;\n     QAction *changePassphraseAction;\n     QAction *aboutQtAction;\n \n@@ -162,6 +163,8 @@ private slots:\n     void incomingTransaction(const QModelIndex & parent, int start, int end);\n     /** Encrypt the wallet */\n     void encryptWallet(bool status);\n+    /** Backup the wallet */\n+    void backupWallet();\n     /** Change encrypted wallet passphrase */\n     void changePassphrase();\n     /** Ask for pass phrase to unlock wallet temporarily */"
      },
      {
        "sha": "ae13a151d5ad11239194edd1fd91199f8dd72f4e",
        "filename": "src/qt/res/icons/filesave.png",
        "status": "added",
        "additions": 0,
        "deletions": 0,
        "changes": 0,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4efbda3f257bd8e635715377d85862d322c57c4b/src/qt/res/icons/filesave.png",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4efbda3f257bd8e635715377d85862d322c57c4b/src/qt/res/icons/filesave.png",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/res/icons/filesave.png?ref=4efbda3f257bd8e635715377d85862d322c57c4b"
      },
      {
        "sha": "8344a653d5112edc63bd84d7cdb6a22de22dc09a",
        "filename": "src/qt/walletmodel.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 0,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4efbda3f257bd8e635715377d85862d322c57c4b/src/qt/walletmodel.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4efbda3f257bd8e635715377d85862d322c57c4b/src/qt/walletmodel.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/walletmodel.cpp?ref=4efbda3f257bd8e635715377d85862d322c57c4b",
        "patch": "@@ -5,6 +5,7 @@\n #include \"transactiontablemodel.h\"\n \n #include \"headers.h\"\n+#include \"db.h\" // for BackupWallet\n \n #include <QTimer>\n #include <QSet>\n@@ -239,6 +240,11 @@ bool WalletModel::changePassphrase(const SecureString &oldPass, const SecureStri\n     return retval;\n }\n \n+bool WalletModel::backupWallet(const QString &filename)\n+{\n+    return BackupWallet(*wallet, filename.toLocal8Bit().data());\n+}\n+\n // WalletModel::UnlockContext implementation\n WalletModel::UnlockContext WalletModel::requestUnlock()\n {"
      },
      {
        "sha": "4123240e90a2688e0e41b4ff533fe0ee8a9148e3",
        "filename": "src/qt/walletmodel.h",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4efbda3f257bd8e635715377d85862d322c57c4b/src/qt/walletmodel.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4efbda3f257bd8e635715377d85862d322c57c4b/src/qt/walletmodel.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/walletmodel.h?ref=4efbda3f257bd8e635715377d85862d322c57c4b",
        "patch": "@@ -77,6 +77,8 @@ class WalletModel : public QObject\n     // Passphrase only needed when unlocking\n     bool setWalletLocked(bool locked, const SecureString &passPhrase=SecureString());\n     bool changePassphrase(const SecureString &oldPass, const SecureString &newPass);\n+    // Wallet backup\n+    bool backupWallet(const QString &filename);\n \n     // RAI object for unlocking wallet, returned by requestUnlock()\n     class UnlockContext"
      }
    ]
  }
]