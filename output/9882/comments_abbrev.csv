gmaxwell,2017-02-28T01:00:00Z,I don't understand how this is intended to be remotely safe?  RPC invisibly changing its units out from under callers sounds like a receipt for disaster.,https://github.com/bitcoin/bitcoin/pull/9882#issuecomment-282907866,282907866,
jtimon,2017-02-28T01:08:02Z,"It was @laanwj 's suggestion in https://github.com/bitcoin/bitcoin/pull/9855#issuecomment-282467878 Well, #3759 is different, but the same as this in that sense.\nDo you have other suggestions or do you think we should stick to BTC as unit for the RPC forever?\n\nHonestly my preference would be to break the API and only allow satoshis, but as said in #9855 that would also require many changes o",https://github.com/bitcoin/bitcoin/pull/9882#issuecomment-282909272,282909272,
luke-jr,2017-02-28T01:32:56Z,"I also prefer to just break API and use satoshis everywhere. We've wanted to use satoshis for several years now and keep getting hung up on compatibility. If we'd just changed it to begin with, we'd be long over it by now...",https://github.com/bitcoin/bitcoin/pull/9882#issuecomment-282913601,282913601,
dcousens,2017-02-28T02:04:39Z,"Deprecation of non-satoshi methods would be the only safe option IMHO,  with new methods under different names.\n\nhttps://github.com/bitcoin/bitcoin/pull/3759#issuecomment-37192191",https://github.com/bitcoin/bitcoin/pull/9882#issuecomment-282919067,282919067,
sipa,2017-02-28T02:16:46Z,"I don't think that amounts-in-satoshis-only is necessarily the solution we'd want, even if we could start from scratch.\n\nJSON does not have a concept of integers or doubles, only of numbers. At least for some JSON libraries, using integral number wouldn't be any better than the BTC numbers now.\n\nIf anything, my preference would be using strings (in BTC) for amounts, which is already possib",https://github.com/bitcoin/bitcoin/pull/9882#issuecomment-282921080,282921080,
jtimon,2017-02-28T02:20:02Z,"Assuming that we were starting from scratch, why do you prefer using strings in BTC over strings in satoshis?",https://github.com/bitcoin/bitcoin/pull/9882#issuecomment-282921564,282921564,
sipa,2017-02-28T02:24:39Z,"The currency is BTC, not satoshi. The fact that internally numbers are represented as multiples of 0.00000001 BTC is not necessarily something we should expose (unless there is another good reason - like avoiding rounding - but that isn't an issue when you're using strings already).",https://github.com/bitcoin/bitcoin/pull/9882#issuecomment-282922278,282922278,
sipa,2017-02-28T02:27:08Z,"To be clear: that's a very minor and unimportant preference. Using satoshis is perfectly reasonable, but I don't think it's so obviously a better choice that it's worth switching to solely that.",https://github.com/bitcoin/bitcoin/pull/9882#issuecomment-282922687,282922687,
dcousens,2017-02-28T02:36:31Z,"@sipa I think the ""better choice"" reasoning is that most libraries interacting with Bitcoin typically operate on satoshis,  externally and internally,  and thus it has been assumed as the typical inter-op unit. [in my experience]\n\nThat at least,  is why it is my preferred unit.\n\nHow it is encoded in JSON, `String` or `Number`, is simply a matter of what expectations are are made of the JSO",https://github.com/bitcoin/bitcoin/pull/9882#issuecomment-282924148,282924148,
jtimon,2017-02-28T02:38:54Z,"As a disclaimer, I'm doing this because I want to do it in elements. With multiple assets, using always 8 decimals seems more arbitrary. See https://github.com/ElementsProject/elements/pull/132\nOf course, the fact that I want it for elements doesn't mean we want it for Bitcoin, but I remembered the satoshi vs BTC discussion and ideally I would prefer to do on elements whatever is more upstreamab",https://github.com/bitcoin/bitcoin/pull/9882#issuecomment-282924521,282924521,
jonasschnelli,2017-02-28T09:25:46Z,"I agree with @sipa.\nAlso, I think a such radical API change would be dangerous. It could make sense if we would introduce a co-existign v2 API (where you may can disabled the v1 API). But to do that for just the floating point issue (that has no guarantees to make it safer as @sipa stated) is probably not worth the effort.",https://github.com/bitcoin/bitcoin/pull/9882#issuecomment-282987334,282987334,
laanwj,2017-02-28T10:50:36Z,"> I don't think that amounts-in-satoshis-only is necessarily the solution we'd want, even if we could start from scratch.\n> JSON does not have a concept of integers or doubles, only of numbers. At least for some JSON libraries, using integral number wouldn't be any better than the BTC numbers now.\n> If anything, my preference would be using strings (in BTC) for amounts, which is already possib",https://github.com/bitcoin/bitcoin/pull/9882#issuecomment-283007354,283007354,
kallewoof,2017-02-28T18:12:13Z,"I personally think we should phase out BTC values completely, as there is an inconsistency when juggling the raw values of a transaction vs using the RPC to manipulate said transaction. There may be others as well, but I'm not sure.\n\nAs a middle ground, we could introduce a suffix feature which makes the reference explicit, since we're leaning towards strings anyway.\n\n1. ""123"" = whatever t",https://github.com/bitcoin/bitcoin/pull/9882#issuecomment-283118998,283118998,
TheBlueMatt,2017-02-28T18:36:56Z,"Yea, I'm still super not a fan of doing this on a global, per-node-by-config-option basis. Isn't this kind of thing exactly what named arguments is for? Just add a global named argument that lets you pick the encoding you want.",https://github.com/bitcoin/bitcoin/pull/9882#issuecomment-283124712,283124712,
jtimon,2017-02-28T20:35:01Z,"@TheBlueMatt Sorry, I don't know what you mean by ""a global named argument"".\nI also need to learn how to do named arguments, I was trying in https://github.com/bitcoin/bitcoin/pull/9855/commits/f799d8b01d4bf475cef26db061f94ea9a879ab23 but that (and some variants like adding the other 2 missing args for signrawtransaction) didn't seem to work.\n",https://github.com/bitcoin/bitcoin/pull/9882#issuecomment-283152977,283152977,
jtimon,2017-02-28T20:37:03Z,"@laanwj isn't using strings already possible? I thought it was possible and this didn't change that fact, simply the string with satoshis doesnt have decimals and the one with BTC does.\nI should test it more or maybe I'm missing something.",https://github.com/bitcoin/bitcoin/pull/9882#issuecomment-283153450,283153450,
instagibbs,2017-03-01T00:39:04Z,"@jtimon seems to mean ""let `-decimalcount=<n>` work for any rpc command so you don't have to scatter it everywhere"".",https://github.com/bitcoin/bitcoin/pull/9882#issuecomment-283207641,283207641,
sradforth,2017-03-01T22:05:46Z,"My +1 is for using satoshi's everywhere, deprecate all API calls that return BTC and create a few new API calls for the new formatted calls.\nE.g. setTxFee gets deprecated and a new API call of setTxFeeSatoshisPerByte is added.\n\nIt seems clear the reason Satoshi used integers and 2,100,000,000,000,000 satoshis was to fit within the 53 bits mantissa of double floats to avoid any risk of roundi",https://github.com/bitcoin/bitcoin/pull/9882#issuecomment-283486103,283486103,
da2ce7,2017-03-02T10:09:00Z,"I have the same view as @sradforth .  All of the Bitcoin Ecosystem use Satoshi as the unit.  It is the de-facto standard.  I don't see what is gained from doing the 'technically correct, but different' behaviour.\n\nStrings vs Numbers? I guess the question is:  is ""2,100,000,000,000,000"" unsafe in any commonly used JSON lib?",https://github.com/bitcoin/bitcoin/pull/9882#issuecomment-283611625,283611625,
laanwj,2017-03-02T10:39:11Z,"> @laanwj isn't using strings already possible? I thought it was possible and this didn't change that fact, simply the string with satoshis doesnt have decimals and the one with BTC does. I should test it more or maybe I'm missing something.\n\nPassing strings in is possible (so `ValueToAmount`), getting them out (so `AmountToValue`) isn't yet. This would need a setting.\n",https://github.com/bitcoin/bitcoin/pull/9882#issuecomment-283618461,283618461,
jtimon,2017-03-06T22:05:25Z,"Well, it seems we should first decide whether we ever plan to break the API and use satoshis everywhere or not. Something like this or ""a global named argument"" would be just temporary arrangements to that that in a slower and less disruptive way.\nThanks everyone for their thoughts on the matter.\nClosing.",https://github.com/bitcoin/bitcoin/pull/9882#issuecomment-284548828,284548828,
MarcoFalke,2017-02-28T10:39:02Z,Please don't use floating point calculations.,https://github.com/bitcoin/bitcoin/pull/9882#discussion_r103424455,103424455,src/rpc/server.cpp
jtimon,2017-02-28T20:30:06Z,"should I implement my own pow function for unsigned integers?\n",https://github.com/bitcoin/bitcoin/pull/9882#discussion_r103544833,103544833,src/rpc/server.cpp
MarcoFalke,2017-02-28T20:58:42Z,"Yes, floating point calculations tend to be unpredictable. You could maybe use\n```cpp\nstatic constexpr std::array<CAmount,9> pow_10 {{1,10,100,1000,10000,100000,1000000,10000000,100000000}};\nnRpcUnit = pow_10.at(nRPCAmountDecimals);\n```\nor come up with something else.",https://github.com/bitcoin/bitcoin/pull/9882#discussion_r103550137,103550137,src/rpc/server.cpp
