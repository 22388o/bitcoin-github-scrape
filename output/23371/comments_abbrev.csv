theStack,2021-10-27 12:03:20,"Force-pushed with suggestions by MarcoFalke (https://github.com/bitcoin/bitcoin/pull/23371#discussion_r737334936, https://github.com/bitcoin/bitcoin/pull/23371#discussion_r737336458, https://github.com/bitcoin/bitcoin/pull/23371#discussion_r737341568) and also adapted the PR description accordingly.",https://github.com/bitcoin/bitcoin/pull/23371#issuecomment-952853498,952853498,
laanwj,2021-10-27 12:23:47,"Concept ACK, nice",https://github.com/bitcoin/bitcoin/pull/23371#issuecomment-952871374,952871374,
DrahtBot,2021-10-27 14:35:19,<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.,https://github.com/bitcoin/bitcoin/pull/23371#issuecomment-952993686,952993686,
mjdietzx,2021-10-27 14:59:13,"Great idea, Concept and Approach ACK",https://github.com/bitcoin/bitcoin/pull/23371#issuecomment-953015964,953015964,
theStack,2021-10-28 17:48:46,"Force-pushed with a fix for the failing test `mempool_compatibility.py`. On the previous release node (v0.19.1), the transaction from the newer node can't be added to the mempool, as `CheckInputs()` fails with `non-mandatory-script-verify-flag (Witness version reserved for soft-fork upgrades)`. This is due to the script verification flag `SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM` being ",https://github.com/bitcoin/bitcoin/pull/23371#issuecomment-954066561,954066561,
theStack,2021-10-29 12:19:31,"Rebased on master (after the merge of https://github.com/bitcoin/bitcoin/pull/23375, the call to `rescan_utxos` is not needed anymore in rpc_blockchain.py) and fixed the cause for the failing CI log due to node shutdown while generate (https://github.com/bitcoin/bitcoin/pull/23371#discussion_r739139394). All CI instances should (hopefully) pass now.",https://github.com/bitcoin/bitcoin/pull/23371#issuecomment-954697403,954697403,
theStack,2021-11-09 11:35:28,Rebased on master.,https://github.com/bitcoin/bitcoin/pull/23371#issuecomment-964067869,964067869,
laanwj,2021-11-10 10:49:22,Code review ACK 041abfebe49ae5e3e882c00cc5caea1365a27a49,https://github.com/bitcoin/bitcoin/pull/23371#issuecomment-965011188,965011188,
DrahtBot,2021-11-10 11:52:18,"<!--cf906140f33d8803c4a75a2196329ecb-->\nüêô This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a ""draft"".</sub>",https://github.com/bitcoin/bitcoin/pull/23371#issuecomment-965057575,965057575,
michaelfolkson,2021-11-11 12:43:12,Why was this closed?,https://github.com/bitcoin/bitcoin/pull/23371#issuecomment-966272158,966272158,
fanquake,2021-11-11 12:48:36,"> Why was this closed?\n\nBecause it was merged.",https://github.com/bitcoin/bitcoin/pull/23371#issuecomment-966275477,966275477,
michaelfolkson,2021-11-11 12:53:24,Ok I must be being dumb :) But this is a PR that is marked as closed on GitHub rather than marked as merged. It isn't an issue that can be closed when a separate PR fixes the issue. It is a PR and PRs are marked as merged rather than closed if they are merged...,https://github.com/bitcoin/bitcoin/pull/23371#issuecomment-966278516,966278516,
fanquake,2021-11-11 13:01:06,"Sometimes GitHub just doesn't work properly, and PRs that have been merged via the merge script don't actually get displayed as ""merged"" on GitHub. It's not entirely clear why this happens, and iirc there is an issue open for it on GitHubs support forum. This has happened number of time over the last few months.",https://github.com/bitcoin/bitcoin/pull/23371#issuecomment-966283476,966283476,
MarcoFalke,2021-10-27 10:37:50,"```suggestion\n        # MiniWallet's default address in blocks\n```\n\nnit: Maybe remove, since it is not needed for context?",https://github.com/bitcoin/bitcoin/pull/23371#discussion_r737334936,737334936,test/functional/feature_rbf.py
MarcoFalke,2021-10-27 10:39:55,Maybe remove this and replace it with miniwallet.address() for clarity?,https://github.com/bitcoin/bitcoin/pull/23371#discussion_r737336458,737336458,test/functional/rpc_blockchain.py
MarcoFalke,2021-10-27 10:47:19,"nit: Maybe move the comment on how to create the address here?\n\nOr alternatively simply make this a method that can be called to generate the address on demand?",https://github.com/bitcoin/bitcoin/pull/23371#discussion_r737341568,737341568,test/functional/test_framework/address.py
theStack,2021-10-27 11:52:36,"Thanks, done.",https://github.com/bitcoin/bitcoin/pull/23371#discussion_r737386377,737386377,test/functional/feature_rbf.py
theStack,2021-10-27 11:54:39,"Good idea. I added another commit (before the P2TR introduction) that generates directly to the MiniWallet in rpc_blockchain.py, using `self.generate(self.wallet, ....)`.",https://github.com/bitcoin/bitcoin/pull/23371#discussion_r737387904,737387904,test/functional/rpc_blockchain.py
theStack,2021-10-27 11:57:46,"Thanks, done. Added a method `create_deterministic_address_bcrt1_p2tr_op_true` that returns both address and internal key, in order to avoid another import from the address module.",https://github.com/bitcoin/bitcoin/pull/23371#discussion_r737390164,737390164,test/functional/test_framework/address.py
MarcoFalke,2021-10-27 12:13:40,"I think this is done by `generate`, so can be dropped?",https://github.com/bitcoin/bitcoin/pull/23371#discussion_r737401936,737401936,test/functional/rpc_blockchain.py
theStack,2021-10-27 12:18:26,"Turned out that without the UTXOs from the pre-mined chain, the coinbases can't be spent due to not being mature yet (`'reject-reason': 'bad-txns-premature-spend-of-coinbase'`). ",https://github.com/bitcoin/bitcoin/pull/23371#discussion_r737405533,737405533,test/functional/rpc_blockchain.py
theStack,2021-10-27 12:23:37,"Hm, maybe that's due to a coin selection issue in MiniWallet -- currently it only selects UTXOs based on value, maybe it should also take age as second criteria, i.e. oldest ones first. Will take a closer look.",https://github.com/bitcoin/bitcoin/pull/23371#discussion_r737409680,737409680,test/functional/rpc_blockchain.py
theStack,2021-10-27 16:05:53,"Opened a separate PR for this issue, since it isn't directly related to the P2TR introduction: #23375. After merging this, the `rescan_utxos` call can be removed from the rpc_blockchain.py test. Probably there are also other places where extra `generate` calls can be removed, though I didn't check out yet.",https://github.com/bitcoin/bitcoin/pull/23371#discussion_r737627117,737627117,test/functional/rpc_blockchain.py
MarcoFalke,2021-10-29 11:02:58,"I think this can't use the miniwallet because the node will shut down while `generate`. Alternative would be to add the exception below to the `pass`:\n\n```\n                                   test_framework.authproxy.JSONRPCException: non-JSON HTTP response with '503 Service Unavailable' from server (-342)",https://github.com/bitcoin/bitcoin/pull/23371#discussion_r739139394,739139394,test/functional/rpc_blockchain.py
theStack,2021-10-29 12:15:05,"Thanks, tried to the decipher the failing CI log yesterday without success, now it makes more sense. Decided to go the easy route by simply keeping the `generatetoaddress` call to the MiniWallet address (i.e. coinbase is not added to its UTXO set, but we don't need it).",https://github.com/bitcoin/bitcoin/pull/23371#discussion_r739181565,739181565,test/functional/rpc_blockchain.py
