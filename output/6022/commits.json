[
  {
    "sha": "b74dcb3b4aa29958d22135f2d6c015578069e83c",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiNzRkY2IzYjRhYTI5OTU4ZDIyMTM1ZjJkNmMwMTU1NzgwNjllODNj",
    "commit": {
      "author": {
        "name": "Jorge Tim\u00f3n",
        "email": "jtimon@jtimon.cc",
        "date": "2015-04-16T14:20:01Z"
      },
      "committer": {
        "name": "Jorge Tim\u00f3n",
        "email": "jtimon@jtimon.cc",
        "date": "2015-04-16T17:58:48Z"
      },
      "message": "Separate CTranslationInterface from CClientUIInterface",
      "tree": {
        "sha": "3c7555117404c14c54be2415c00d6a7b65e951da",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3c7555117404c14c54be2415c00d6a7b65e951da"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b74dcb3b4aa29958d22135f2d6c015578069e83c",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b74dcb3b4aa29958d22135f2d6c015578069e83c",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/b74dcb3b4aa29958d22135f2d6c015578069e83c",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b74dcb3b4aa29958d22135f2d6c015578069e83c/comments",
    "author": {
      "login": "jtimon",
      "id": 1008458,
      "node_id": "MDQ6VXNlcjEwMDg0NTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1008458?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtimon",
      "html_url": "https://github.com/jtimon",
      "followers_url": "https://api.github.com/users/jtimon/followers",
      "following_url": "https://api.github.com/users/jtimon/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtimon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtimon/subscriptions",
      "organizations_url": "https://api.github.com/users/jtimon/orgs",
      "repos_url": "https://api.github.com/users/jtimon/repos",
      "events_url": "https://api.github.com/users/jtimon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtimon/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jtimon",
      "id": 1008458,
      "node_id": "MDQ6VXNlcjEwMDg0NTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1008458?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtimon",
      "html_url": "https://github.com/jtimon",
      "followers_url": "https://api.github.com/users/jtimon/followers",
      "following_url": "https://api.github.com/users/jtimon/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtimon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtimon/subscriptions",
      "organizations_url": "https://api.github.com/users/jtimon/orgs",
      "repos_url": "https://api.github.com/users/jtimon/repos",
      "events_url": "https://api.github.com/users/jtimon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtimon/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "8f955b9661224adc950e302b42d2f7bcb5e90bef",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/8f955b9661224adc950e302b42d2f7bcb5e90bef",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/8f955b9661224adc950e302b42d2f7bcb5e90bef"
      }
    ],
    "stats": {
      "total": 47,
      "additions": 24,
      "deletions": 23
    },
    "files": [
      {
        "sha": "1269d7a119fd5b6e0d82009f98ec16571ee07a82",
        "filename": "src/bitcoin-cli.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 2,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b74dcb3b4aa29958d22135f2d6c015578069e83c/src/bitcoin-cli.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b74dcb3b4aa29958d22135f2d6c015578069e83c/src/bitcoin-cli.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoin-cli.cpp?ref=b74dcb3b4aa29958d22135f2d6c015578069e83c",
        "patch": "@@ -12,8 +12,6 @@\n \n #include <boost/filesystem/operations.hpp>\n \n-#define _(x) std::string(x) /* Keep the _() around in case gettext or such will be used later to translate non-UI */\n-\n using namespace std;\n using namespace json_spirit;\n "
      },
      {
        "sha": "075d529408e04b403603b15138ca89c4769d6cb0",
        "filename": "src/bitcoin-tx.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 2,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b74dcb3b4aa29958d22135f2d6c015578069e83c/src/bitcoin-tx.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b74dcb3b4aa29958d22135f2d6c015578069e83c/src/bitcoin-tx.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoin-tx.cpp?ref=b74dcb3b4aa29958d22135f2d6c015578069e83c",
        "patch": "@@ -11,7 +11,6 @@\n #include \"keystore.h\"\n #include \"script/script.h\"\n #include \"script/sign.h\"\n-#include \"ui_interface.h\" // for _(...)\n #include \"univalue/univalue.h\"\n #include \"util.h\"\n #include \"utilstrencodings.h\"\n@@ -26,7 +25,6 @@ using namespace std;\n \n static bool fCreateBlank;\n static map<string,UniValue> registers;\n-CClientUIInterface uiInterface;\n \n static bool AppInitRawTx(int argc, char* argv[])\n {"
      },
      {
        "sha": "84df00527cb99edd6804343fcb4861d1c1b46f46",
        "filename": "src/bitcoind.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b74dcb3b4aa29958d22135f2d6c015578069e83c/src/bitcoind.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b74dcb3b4aa29958d22135f2d6c015578069e83c/src/bitcoind.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoind.cpp?ref=b74dcb3b4aa29958d22135f2d6c015578069e83c",
        "patch": "@@ -8,7 +8,6 @@\n #include \"init.h\"\n #include \"main.h\"\n #include \"noui.h\"\n-#include \"ui_interface.h\"\n #include \"util.h\"\n \n #include <boost/algorithm/string/predicate.hpp>"
      },
      {
        "sha": "7f95b5f92773d36182386f6cb5e92d62c6f700b5",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b74dcb3b4aa29958d22135f2d6c015578069e83c/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b74dcb3b4aa29958d22135f2d6c015578069e83c/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=b74dcb3b4aa29958d22135f2d6c015578069e83c",
        "patch": "@@ -68,7 +68,7 @@ enum BindFlags {\n };\n \n static const char* FEE_ESTIMATES_FILENAME=\"fee_estimates.dat\";\n-CClientUIInterface uiInterface;\n+CClientUIInterface uiInterface; // Declared but not defined in ui_interface.h\n \n //////////////////////////////////////////////////////////////////////////////\n //"
      },
      {
        "sha": "1abce1eb2185cbdc432d7576e3ded3b69b1dadf3",
        "filename": "src/qt/bitcoin.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b74dcb3b4aa29958d22135f2d6c015578069e83c/src/qt/bitcoin.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b74dcb3b4aa29958d22135f2d6c015578069e83c/src/qt/bitcoin.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoin.cpp?ref=b74dcb3b4aa29958d22135f2d6c015578069e83c",
        "patch": "@@ -533,7 +533,7 @@ int main(int argc, char *argv[])\n     // Now that QSettings are accessible, initialize translations\n     QTranslator qtTranslatorBase, qtTranslator, translatorBase, translator;\n     initTranslations(qtTranslatorBase, qtTranslator, translatorBase, translator);\n-    uiInterface.Translate.connect(Translate);\n+    translationInterface.Translate.connect(Translate);\n \n     // Show help message immediately after parsing command-line options (for \"-lang\") and setting locale,\n     // but before showing splash screen."
      },
      {
        "sha": "a7f705d2b243d5c8e9e75c30f17274636fbee8c9",
        "filename": "src/qt/transactiondesc.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b74dcb3b4aa29958d22135f2d6c015578069e83c/src/qt/transactiondesc.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b74dcb3b4aa29958d22135f2d6c015578069e83c/src/qt/transactiondesc.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/transactiondesc.cpp?ref=b74dcb3b4aa29958d22135f2d6c015578069e83c",
        "patch": "@@ -14,7 +14,6 @@\n #include \"main.h\"\n #include \"script/script.h\"\n #include \"timedata.h\"\n-#include \"ui_interface.h\"\n #include \"util.h\"\n #include \"wallet/wallet.h\"\n "
      },
      {
        "sha": "ccb7cf15e9ac2d18ca1bc20f23f96a690e100127",
        "filename": "src/rpcclient.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b74dcb3b4aa29958d22135f2d6c015578069e83c/src/rpcclient.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b74dcb3b4aa29958d22135f2d6c015578069e83c/src/rpcclient.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpcclient.cpp?ref=b74dcb3b4aa29958d22135f2d6c015578069e83c",
        "patch": "@@ -7,7 +7,6 @@\n \n #include \"rpcprotocol.h\"\n #include \"util.h\"\n-#include \"ui_interface.h\"\n \n #include <set>\n #include <stdint.h>"
      },
      {
        "sha": "4057eccbedfda5ffea7b0a5430ae252b64a45c3b",
        "filename": "src/test/test_bitcoin.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b74dcb3b4aa29958d22135f2d6c015578069e83c/src/test/test_bitcoin.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b74dcb3b4aa29958d22135f2d6c015578069e83c/src/test/test_bitcoin.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/test_bitcoin.cpp?ref=b74dcb3b4aa29958d22135f2d6c015578069e83c",
        "patch": "@@ -20,7 +20,7 @@\n #include <boost/test/unit_test.hpp>\n #include <boost/thread.hpp>\n \n-CClientUIInterface uiInterface;\n+CClientUIInterface uiInterface; // Declared but not defined in ui_interface.h\n CWallet* pwalletMain;\n \n extern bool fPrintToConsole;"
      },
      {
        "sha": "32a92a4b81db02253a13d4f7b12a93825c9745a2",
        "filename": "src/ui_interface.h",
        "status": "modified",
        "additions": 0,
        "deletions": 13,
        "changes": 13,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b74dcb3b4aa29958d22135f2d6c015578069e83c/src/ui_interface.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b74dcb3b4aa29958d22135f2d6c015578069e83c/src/ui_interface.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/ui_interface.h?ref=b74dcb3b4aa29958d22135f2d6c015578069e83c",
        "patch": "@@ -78,9 +78,6 @@ class CClientUIInterface\n     /** Progress message during initialization. */\n     boost::signals2::signal<void (const std::string &message)> InitMessage;\n \n-    /** Translate a message to the native language of the user. */\n-    boost::signals2::signal<std::string (const char* psz)> Translate;\n-\n     /** Number of network connections changed. */\n     boost::signals2::signal<void (int newNumConnections)> NotifyNumConnectionsChanged;\n \n@@ -102,14 +99,4 @@ class CClientUIInterface\n \n extern CClientUIInterface uiInterface;\n \n-/**\n- * Translation function: Call Translate signal on UI interface, which returns a boost::optional result.\n- * If no translation slot is registered, nothing is returned, and simply return the input.\n- */\n-inline std::string _(const char* psz)\n-{\n-    boost::optional<std::string> rv = uiInterface.Translate(psz);\n-    return rv ? (*rv) : psz;\n-}\n-\n #endif // BITCOIN_UI_INTERFACE_H"
      },
      {
        "sha": "78c7731500d812a4b5366674a2e2314a9b4b18ec",
        "filename": "src/util.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b74dcb3b4aa29958d22135f2d6c015578069e83c/src/util.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b74dcb3b4aa29958d22135f2d6c015578069e83c/src/util.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util.cpp?ref=b74dcb3b4aa29958d22135f2d6c015578069e83c",
        "patch": "@@ -104,6 +104,7 @@ string strMiscWarning;\n bool fLogTimestamps = false;\n bool fLogIPs = false;\n volatile bool fReopenDebugLog = false;\n+CTranslationInterface translationInterface;\n \n /** Init OpenSSL library multithreading support */\n static CCriticalSection** ppmutexOpenSSL;"
      },
      {
        "sha": "483d9d7858357cf0f07738733ee6bf1face6f4b9",
        "filename": "src/util.h",
        "status": "modified",
        "additions": 20,
        "deletions": 0,
        "changes": 20,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b74dcb3b4aa29958d22135f2d6c015578069e83c/src/util.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b74dcb3b4aa29958d22135f2d6c015578069e83c/src/util.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util.h?ref=b74dcb3b4aa29958d22135f2d6c015578069e83c",
        "patch": "@@ -25,8 +25,17 @@\n #include <vector>\n \n #include <boost/filesystem/path.hpp>\n+#include <boost/signals2/signal.hpp>\n #include <boost/thread/exceptions.hpp>\n \n+/** Signals for translation. */\n+class CTranslationInterface\n+{\n+public:\n+    /** Translate a message to the native language of the user. */\n+    boost::signals2::signal<std::string (const char* psz)> Translate;\n+};\n+\n extern std::map<std::string, std::string> mapArgs;\n extern std::map<std::string, std::vector<std::string> > mapMultiArgs;\n extern bool fDebug;\n@@ -37,6 +46,17 @@ extern std::string strMiscWarning;\n extern bool fLogTimestamps;\n extern bool fLogIPs;\n extern volatile bool fReopenDebugLog;\n+extern CTranslationInterface translationInterface;\n+\n+/**\n+ * Translation function: Call Translate signal on UI interface, which returns a boost::optional result.\n+ * If no translation slot is registered, nothing is returned, and simply return the input.\n+ */\n+inline std::string _(const char* psz)\n+{\n+    boost::optional<std::string> rv = translationInterface.Translate(psz);\n+    return rv ? (*rv) : psz;\n+}\n \n void SetupEnvironment();\n "
      }
    ]
  }
]