[
  {
    "sha": "d789386371699fee14bb5e444507a6067293ff67",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkNzg5Mzg2MzcxNjk5ZmVlMTRiYjVlNDQ0NTA3YTYwNjcyOTNmZjY3",
    "commit": {
      "author": {
        "name": "Jeff Garzik",
        "email": "jgarzik@bitpay.com",
        "date": "2014-08-19T14:28:58Z"
      },
      "committer": {
        "name": "Jeff Garzik",
        "email": "jgarzik@bitpay.com",
        "date": "2014-08-19T14:28:58Z"
      },
      "message": "Add \"it works\" test for bitcoin-tx",
      "tree": {
        "sha": "e852391fb16a530c5ad40757b1f77b94c0c46273",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e852391fb16a530c5ad40757b1f77b94c0c46273"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d789386371699fee14bb5e444507a6067293ff67",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d789386371699fee14bb5e444507a6067293ff67",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/d789386371699fee14bb5e444507a6067293ff67",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d789386371699fee14bb5e444507a6067293ff67/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "dd2819701a1a4481ae06b24924b75d55b9feb115",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dd2819701a1a4481ae06b24924b75d55b9feb115",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/dd2819701a1a4481ae06b24924b75d55b9feb115"
      }
    ],
    "stats": {
      "total": 63,
      "additions": 62,
      "deletions": 1
    },
    "files": [
      {
        "sha": "24af4cb72e4e6f64fce376bc2e490ad9e26fbdcd",
        "filename": ".gitignore",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d789386371699fee14bb5e444507a6067293ff67/.gitignore",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d789386371699fee14bb5e444507a6067293ff67/.gitignore",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/.gitignore?ref=d789386371699fee14bb5e444507a6067293ff67",
        "patch": "@@ -43,6 +43,7 @@ src/qt/test/moc*.cpp\n *.bak\n *.rej\n *.orig\n+*.pyc\n *.o\n *.o-*\n *.patch"
      },
      {
        "sha": "7e25430e3ebfbf5d1d36cf149dd1b59dd865cb77",
        "filename": "src/Makefile.test.include",
        "status": "modified",
        "additions": 8,
        "deletions": 1,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d789386371699fee14bb5e444507a6067293ff67/src/Makefile.test.include",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d789386371699fee14bb5e444507a6067293ff67/src/Makefile.test.include",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.test.include?ref=d789386371699fee14bb5e444507a6067293ff67",
        "patch": "@@ -1,8 +1,15 @@\n-TESTS += test/test_bitcoin\n+TESTS += test/test_bitcoin test/bitcoin-util-test.py\n bin_PROGRAMS += test/test_bitcoin\n TEST_SRCDIR = test\n TEST_BINARY=test/test_bitcoin$(EXEEXT)\n \n+\n+EXTRA_DIST += \\\n+\ttest/bctest.py \\\n+\ttest/bitcoin-util-test.py \\\n+\ttest/data/bitcoin-util-test.json \\\n+\ttest/data/blanktx.hex\n+\n JSON_TEST_FILES = \\\n   test/data/script_valid.json \\\n   test/data/base58_keys_valid.json \\"
      },
      {
        "sha": "3b17acb75e0d800d4f2d7a61044f0d1d21a48564",
        "filename": "src/test/bctest.py",
        "status": "added",
        "additions": 35,
        "deletions": 0,
        "changes": 35,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d789386371699fee14bb5e444507a6067293ff67/src/test/bctest.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d789386371699fee14bb5e444507a6067293ff67/src/test/bctest.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/bctest.py?ref=d789386371699fee14bb5e444507a6067293ff67",
        "patch": "@@ -0,0 +1,35 @@\n+# Copyright 2014 BitPay, Inc.\n+# Distributed under the MIT/X11 software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+import subprocess\n+import os\n+import json\n+import sys\n+\n+def bctest(testDir, testObj):\n+\texecargs = testObj['exec']\n+\toutputFn = testObj['output_cmp']\n+\toutputData = open(testDir + \"/\" + outputFn).read()\n+\n+\tproc = subprocess.Popen(execargs, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n+\ttry:\n+\t\touts = proc.communicate()\n+\texcept OSError:\n+\t\tprint(\"OSError, Failed to execute \" + execargs[0])\n+\t\tsys.exit(1)\n+\n+\tif outs[0] != outputData:\n+\t\tprint(\"Output data mismatch for \" + outputFn)\n+\t\tsys.exit(1)\n+\n+def bctester(testDir, input_basename):\n+\tinput_filename = testDir + \"/\" + input_basename\n+\traw_data = open(input_filename).read()\n+\tinput_data = json.loads(raw_data)\n+\n+\tfor testObj in input_data:\n+\t\tbctest(testDir, testObj)\n+\n+\tsys.exit(0)\n+"
      },
      {
        "sha": "40690c2fed891f40d458bf4419a9e1876aeadeab",
        "filename": "src/test/bitcoin-util-test.py",
        "status": "added",
        "additions": 12,
        "deletions": 0,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d789386371699fee14bb5e444507a6067293ff67/src/test/bitcoin-util-test.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d789386371699fee14bb5e444507a6067293ff67/src/test/bitcoin-util-test.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/bitcoin-util-test.py?ref=d789386371699fee14bb5e444507a6067293ff67",
        "patch": "@@ -0,0 +1,12 @@\n+#!/usr/bin/python\n+# Copyright 2014 BitPay, Inc.\n+# Distributed under the MIT/X11 software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+import os\n+import bctest\n+\n+if __name__ == '__main__':\n+\tbctest.bctester(os.environ[\"srcdir\"] + \"/test/data\",\n+\t\t\t\"bitcoin-util-test.json\")\n+"
      },
      {
        "sha": "af29fd75a5493708f8f0bc65ee906fd7971efb4e",
        "filename": "src/test/data/bitcoin-util-test.json",
        "status": "added",
        "additions": 5,
        "deletions": 0,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d789386371699fee14bb5e444507a6067293ff67/src/test/data/bitcoin-util-test.json",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d789386371699fee14bb5e444507a6067293ff67/src/test/data/bitcoin-util-test.json",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/data/bitcoin-util-test.json?ref=d789386371699fee14bb5e444507a6067293ff67",
        "patch": "@@ -0,0 +1,5 @@\n+[\n+  { \"exec\": [\"./bitcoin-tx\", \"-create\"],\n+    \"output_cmp\": \"blanktx.hex\"\n+  }\n+]"
      },
      {
        "sha": "36b6f00fb67fc8a93faf75cb75dd95fe64fc5c5f",
        "filename": "src/test/data/blanktx.hex",
        "status": "added",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d789386371699fee14bb5e444507a6067293ff67/src/test/data/blanktx.hex",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d789386371699fee14bb5e444507a6067293ff67/src/test/data/blanktx.hex",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/data/blanktx.hex?ref=d789386371699fee14bb5e444507a6067293ff67",
        "patch": "@@ -0,0 +1 @@\n+01000000000000000000"
      }
    ]
  },
  {
    "sha": "fb14452c6cadb8d977c405dddb0a94115250d7c4",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYjE0NDUyYzZjYWRiOGQ5NzdjNDA1ZGRkYjBhOTQxMTUyNTBkN2M0",
    "commit": {
      "author": {
        "name": "Jeff Garzik",
        "email": "jgarzik@bitpay.com",
        "date": "2014-08-19T03:14:29Z"
      },
      "committer": {
        "name": "Jeff Garzik",
        "email": "jgarzik@bitpay.com",
        "date": "2014-08-19T14:29:10Z"
      },
      "message": "bitcoin-tx: Accept input via stdin. Add input handling to tests.",
      "tree": {
        "sha": "15bee02d3211d2043b2f5b390ee19745b79bbc6a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/15bee02d3211d2043b2f5b390ee19745b79bbc6a"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fb14452c6cadb8d977c405dddb0a94115250d7c4",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fb14452c6cadb8d977c405dddb0a94115250d7c4",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fb14452c6cadb8d977c405dddb0a94115250d7c4",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fb14452c6cadb8d977c405dddb0a94115250d7c4/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "d789386371699fee14bb5e444507a6067293ff67",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d789386371699fee14bb5e444507a6067293ff67",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/d789386371699fee14bb5e444507a6067293ff67"
      }
    ],
    "stats": {
      "total": 44,
      "additions": 40,
      "deletions": 4
    },
    "files": [
      {
        "sha": "6cd2768d700f2be06323d6ed81188c4f91b3f03c",
        "filename": "src/bitcoin-tx.cpp",
        "status": "modified",
        "additions": 26,
        "deletions": 2,
        "changes": 28,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fb14452c6cadb8d977c405dddb0a94115250d7c4/src/bitcoin-tx.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fb14452c6cadb8d977c405dddb0a94115250d7c4/src/bitcoin-tx.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoin-tx.cpp?ref=fb14452c6cadb8d977c405dddb0a94115250d7c4",
        "patch": "@@ -13,6 +13,7 @@\n \n #include <stdio.h>\n #include <boost/assign/list_of.hpp>\n+#include <boost/algorithm/string.hpp>\n \n using namespace std;\n using namespace boost::assign;\n@@ -501,13 +502,34 @@ static void OutputTx(const CTransaction& tx)\n         OutputTxHex(tx);\n }\n \n+static string readStdin()\n+{\n+    char buf[4096];\n+    string ret;\n+\n+    while (!feof(stdin)) {\n+        size_t bread = fread(buf, 1, sizeof(buf), stdin);\n+        ret.append(buf, bread);\n+        if (bread < sizeof(buf))\n+            break;\n+    }\n+\n+    if (ferror(stdin))\n+        throw runtime_error(\"error reading stdin\");\n+\n+    boost::algorithm::trim_right(ret);\n+\n+    return ret;\n+}\n+\n static int CommandLineRawTx(int argc, char* argv[])\n {\n     string strPrint;\n     int nRet = 0;\n     try {\n-        // Skip switches\n-        while (argc > 1 && IsSwitchChar(argv[1][0])) {\n+        // Skip switches; Permit common stdin convention \"-\"\n+        while (argc > 1 && IsSwitchChar(argv[1][0]) &&\n+               (argv[1][1] != 0)) {\n             argc--;\n             argv++;\n         }\n@@ -522,6 +544,8 @@ static int CommandLineRawTx(int argc, char* argv[])\n \n             // param: hex-encoded bitcoin transaction\n             string strHexTx(argv[1]);\n+            if (strHexTx == \"-\")                 // \"-\" implies standard input\n+                strHexTx = readStdin();\n \n             if (!DecodeHexTx(txDecodeTmp, strHexTx))\n                 throw runtime_error(\"invalid transaction encoding\");"
      },
      {
        "sha": "b1264790839456d07f37a7ddf3ac866838151664",
        "filename": "src/test/bctest.py",
        "status": "modified",
        "additions": 10,
        "deletions": 2,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fb14452c6cadb8d977c405dddb0a94115250d7c4/src/test/bctest.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fb14452c6cadb8d977c405dddb0a94115250d7c4/src/test/bctest.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/bctest.py?ref=fb14452c6cadb8d977c405dddb0a94115250d7c4",
        "patch": "@@ -9,12 +9,20 @@\n \n def bctest(testDir, testObj):\n \texecargs = testObj['exec']\n+\n+\tstdinCfg = None\n+\tinputData = None\n+\tif \"input\" in testObj:\n+\t\tfilename = testDir + \"/\" + testObj['input']\n+\t\tinputData = open(filename).read()\n+\t\tstdinCfg = subprocess.PIPE\n+\n \toutputFn = testObj['output_cmp']\n \toutputData = open(testDir + \"/\" + outputFn).read()\n \n-\tproc = subprocess.Popen(execargs, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n+\tproc = subprocess.Popen(execargs, stdin=stdinCfg, stdout=subprocess.PIPE, stderr=subprocess.PIPE)\n \ttry:\n-\t\touts = proc.communicate()\n+\t\touts = proc.communicate(input=inputData)\n \texcept OSError:\n \t\tprint(\"OSError, Failed to execute \" + execargs[0])\n \t\tsys.exit(1)"
      },
      {
        "sha": "16bcb44898186d23f4237b874a12c602a8f1b86f",
        "filename": "src/test/data/bitcoin-util-test.json",
        "status": "modified",
        "additions": 4,
        "deletions": 0,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fb14452c6cadb8d977c405dddb0a94115250d7c4/src/test/data/bitcoin-util-test.json",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fb14452c6cadb8d977c405dddb0a94115250d7c4/src/test/data/bitcoin-util-test.json",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/data/bitcoin-util-test.json?ref=fb14452c6cadb8d977c405dddb0a94115250d7c4",
        "patch": "@@ -1,5 +1,9 @@\n [\n   { \"exec\": [\"./bitcoin-tx\", \"-create\"],\n     \"output_cmp\": \"blanktx.hex\"\n+  },\n+  { \"exec\": [\"./bitcoin-tx\", \"-\"],\n+    \"input\": \"blanktx.hex\",\n+    \"output_cmp\": \"blanktx.hex\"\n   }\n ]"
      }
    ]
  }
]