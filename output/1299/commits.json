[
  {
    "sha": "0f1707de678a23b8600510be366289071203fc6e",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzowZjE3MDdkZTY3OGEyM2I4NjAwNTEwYmUzNjYyODkwNzEyMDNmYzZl",
    "commit": {
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2012-05-14T15:15:58Z"
      },
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2012-05-14T15:52:45Z"
      },
      "message": "-onlynet instead of -blocknet",
      "tree": {
        "sha": "86ad8eddb178c01da5d65983030ccceab30220d6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/86ad8eddb178c01da5d65983030ccceab30220d6"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0f1707de678a23b8600510be366289071203fc6e",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0f1707de678a23b8600510be366289071203fc6e",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/0f1707de678a23b8600510be366289071203fc6e",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0f1707de678a23b8600510be366289071203fc6e/comments",
    "author": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "0071a540d40f8e7cf75eb555f007ab61473a3a81",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0071a540d40f8e7cf75eb555f007ab61473a3a81",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/0071a540d40f8e7cf75eb555f007ab61473a3a81"
      }
    ],
    "stats": {
      "total": 28,
      "additions": 21,
      "deletions": 7
    },
    "files": [
      {
        "sha": "f1599ed3a51c7c1052c12202792dde43ccbeb32e",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 11,
        "deletions": 5,
        "changes": 16,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/0f1707de678a23b8600510be366289071203fc6e/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/0f1707de678a23b8600510be366289071203fc6e/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=0f1707de678a23b8600510be366289071203fc6e",
        "patch": "@@ -204,7 +204,7 @@ std::string HelpMessage()\n         \"  -connect=<ip>          \" + _(\"Connect only to the specified node\") + \"\\n\" +\n         \"  -seednode=<ip>         \" + _(\"Connect to a node to retrieve peer addresses, and disconnect\") + \"\\n\" +\n         \"  -externalip=<ip>       \" + _(\"Specify your own public address\") + \"\\n\" +\n-        \"  -blocknet=<net>        \" + _(\"Do not connect to addresses in network <net> (IPv4 or IPv6)\") + \"\\n\" +\n+        \"  -onlynet=<net>         \" + _(\"Only connect to nodes in network <net> (IPv4 or IPv6)\") + \"\\n\" +\n         \"  -discover              \" + _(\"Try to discover public IP address (default: 1)\") + \"\\n\" +\n         \"  -irc                   \" + _(\"Find peers using internet relay chat (default: 0)\") + \"\\n\" +\n         \"  -listen                \" + _(\"Accept connections from outside (default: 1)\") + \"\\n\" +\n@@ -572,12 +572,18 @@ bool AppInit2()\n         SoftSetBoolArg(\"-discover\", false);\n     }\n \n-    if (mapArgs.count(\"-blocknet\")) {\n-        BOOST_FOREACH(std::string snet, mapMultiArgs[\"-blocknet\"]) {\n+    if (mapArgs.count(\"-onlynet\")) {\n+        std::set<enum Network> nets;\n+        BOOST_FOREACH(std::string snet, mapMultiArgs[\"-onlynet\"]) {\n             enum Network net = ParseNetwork(snet);\n             if (net == NET_UNROUTABLE)\n-                return InitError(strprintf(_(\"Unknown network specified in -blocknet: '%s'\"), snet.c_str()));\n-            SetLimited(net);\n+                return InitError(strprintf(_(\"Unknown network specified in -onlynet: '%s'\"), snet.c_str()));\n+            nets.insert(net);\n+        }\n+        for (int n = 0; n < NET_MAX; n++) {\n+            enum Network net = (enum Network)n;\n+            if (!nets.count(net))\n+                SetLimited(net);\n         }\n     }\n "
      },
      {
        "sha": "e48b3009538cda68577cf0db6679fdd4df21c037",
        "filename": "src/net.cpp",
        "status": "modified",
        "additions": 9,
        "deletions": 2,
        "changes": 11,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/0f1707de678a23b8600510be366289071203fc6e/src/net.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/0f1707de678a23b8600510be366289071203fc6e/src/net.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.cpp?ref=0f1707de678a23b8600510be366289071203fc6e",
        "patch": "@@ -245,14 +245,21 @@ bool AddLocal(const CNetAddr &addr, int nScore)\n /** Make a particular network entirely off-limits (no automatic connects to it) */\n void SetLimited(enum Network net, bool fLimited)\n {\n+    if (net == NET_UNROUTABLE)\n+        return;\n     LOCK(cs_mapLocalHost);\n     vfLimited[net] = fLimited;\n }\n \n-bool IsLimited(const CNetAddr& addr)\n+bool IsLimited(enum Network net)\n {\n     LOCK(cs_mapLocalHost);\n-    return vfLimited[addr.GetNetwork()];\n+    return vfLimited[net];\n+}\n+\n+bool IsLimited(const CNetAddr &addr)\n+{\n+    return IsLimited(addr.GetNetwork());\n }\n \n /** vote for a local address */"
      },
      {
        "sha": "cb90ef6e7200bb5060509ab7c8711160eb373386",
        "filename": "src/net.h",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/0f1707de678a23b8600510be366289071203fc6e/src/net.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/0f1707de678a23b8600510be366289071203fc6e/src/net.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.h?ref=0f1707de678a23b8600510be366289071203fc6e",
        "patch": "@@ -57,6 +57,7 @@ enum\n };\n \n void SetLimited(enum Network net, bool fLimited = true);\n+bool IsLimited(enum Network net);\n bool IsLimited(const CNetAddr& addr);\n bool AddLocal(const CService& addr, int nScore = LOCAL_NONE);\n bool AddLocal(const CNetAddr& addr, int nScore = LOCAL_NONE);"
      }
    ]
  },
  {
    "sha": "55bb0cfbb6841372e4969b598f04dfc15a7687c0",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo1NWJiMGNmYmI2ODQxMzcyZTQ5NjliNTk4ZjA0ZGZjMTVhNzY4N2Mw",
    "commit": {
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2012-05-14T15:40:08Z"
      },
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2012-05-14T15:52:50Z"
      },
      "message": "Allow binding to the any address, and report failure",
      "tree": {
        "sha": "ef36593b7a530137c602017d949285c7c0301d21",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ef36593b7a530137c602017d949285c7c0301d21"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/55bb0cfbb6841372e4969b598f04dfc15a7687c0",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/55bb0cfbb6841372e4969b598f04dfc15a7687c0",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/55bb0cfbb6841372e4969b598f04dfc15a7687c0",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/55bb0cfbb6841372e4969b598f04dfc15a7687c0/comments",
    "author": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "0f1707de678a23b8600510be366289071203fc6e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0f1707de678a23b8600510be366289071203fc6e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/0f1707de678a23b8600510be366289071203fc6e"
      }
    ],
    "stats": {
      "total": 6,
      "additions": 3,
      "deletions": 3
    },
    "files": [
      {
        "sha": "81a414a71dec12e14b9911c3700c32d231999b27",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 3,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/55bb0cfbb6841372e4969b598f04dfc15a7687c0/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/55bb0cfbb6841372e4969b598f04dfc15a7687c0/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=55bb0cfbb6841372e4969b598f04dfc15a7687c0",
        "patch": "@@ -611,8 +611,8 @@ bool AppInit2()\n         std::string strError;\n         if (mapArgs.count(\"-bind\")) {\n             BOOST_FOREACH(std::string strBind, mapMultiArgs[\"-bind\"]) {\n-                CService addrBind(strBind, GetListenPort(), false);\n-                if (!addrBind.IsValid())\n+                CService addrBind;\n+                if (!Lookup(strBind.c_str(), addrBind, GetListenPort(), false))\n                     return InitError(strprintf(_(\"Cannot resolve -bind address: '%s'\"), strBind.c_str()));\n                 fBound |= Bind(addrBind);\n             }\n@@ -625,7 +625,7 @@ bool AppInit2()\n #endif\n         }\n         if (!fBound)\n-            return false;\n+            return InitError(_(\"Not listening on any port\"));\n     }\n \n     if (mapArgs.count(\"-externalip\"))"
      }
    ]
  },
  {
    "sha": "91dace35a1c7821675c369d60d1e88b2ed638842",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo5MWRhY2UzNWExYzc4MjE2NzVjMzY5ZDYwZDFlODhiMmVkNjM4ODQy",
    "commit": {
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2012-05-14T15:40:35Z"
      },
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2012-05-14T15:52:51Z"
      },
      "message": "Do not listen on blocked networks",
      "tree": {
        "sha": "bff12d156a2fbe1c8b06e72a0394015469df3b4c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bff12d156a2fbe1c8b06e72a0394015469df3b4c"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/91dace35a1c7821675c369d60d1e88b2ed638842",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/91dace35a1c7821675c369d60d1e88b2ed638842",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/91dace35a1c7821675c369d60d1e88b2ed638842",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/91dace35a1c7821675c369d60d1e88b2ed638842/comments",
    "author": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "55bb0cfbb6841372e4969b598f04dfc15a7687c0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/55bb0cfbb6841372e4969b598f04dfc15a7687c0",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/55bb0cfbb6841372e4969b598f04dfc15a7687c0"
      }
    ],
    "stats": {
      "total": 6,
      "additions": 4,
      "deletions": 2
    },
    "files": [
      {
        "sha": "9b12ab0aa4239301d0a0d48b9690ba58f54288ee",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 2,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/91dace35a1c7821675c369d60d1e88b2ed638842/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/91dace35a1c7821675c369d60d1e88b2ed638842/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=91dace35a1c7821675c369d60d1e88b2ed638842",
        "patch": "@@ -619,9 +619,11 @@ bool AppInit2()\n         } else {\n             struct in_addr inaddr_any;\n             inaddr_any.s_addr = INADDR_ANY;\n-            fBound |= Bind(CService(inaddr_any, GetListenPort()));\n+            if (!IsLimited(NET_IPV4))\n+                fBound |= Bind(CService(inaddr_any, GetListenPort()));\n #ifdef USE_IPV6\n-            fBound |= Bind(CService(in6addr_any, GetListenPort()));\n+            if (!IsLimited(NET_IPV6))\n+                fBound |= Bind(CService(in6addr_any, GetListenPort()));\n #endif\n         }\n         if (!fBound)"
      }
    ]
  }
]