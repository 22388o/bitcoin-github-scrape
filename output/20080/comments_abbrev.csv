hebasto,2020-10-04 20:03:17,"@promag As an author of #14561, mind looking into his PR?",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-703308335,703308335,
Saibato,2020-10-05 06:45:58,"> from the other PR #19933   ... to strip correctly,without boost > 1.47 siggh.\n\nSo if we could really now use the 1.58 that approach here concept tACK, since i might have choose this also if i was sure we had 1.58 and after the comment from @promag  \n\nTyI: i still find in the compile cache after` make distclean`\nmultiple lines like\n```.\n/autom4te.cache/output.2:29476:  _AX_BOOST_BAS",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-703433766,703433766,
hebasto,2020-10-05 08:12:56,"@Saibato \n> TyI: i still find in the compile cache after` make distclean`\n> multiple lines like\n> \n> ```\n> /autom4te.cache/output.2:29476:  _AX_BOOST_BASE_TONUMERICVERSION_req=""1.47.0""  \n> ```\n\nYou need something like `git clean -fdx` to clean the `autom4te.cache` directory.\n\n> \n> But that's probably just trash form old version compiles?\n\nYes, it is a cache from your old ",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-703476413,703476413,
MarcoFalke,2020-10-05 13:04:53,review ACK de37a1de75859b85619382867a9755a8bb8ae457,https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-703618211,703618211,
hebasto,2020-10-05 13:24:17,"The `utACK` from @luke-jr is [buried](https://github.com/bitcoin/bitcoin/pull/20080#discussion_r499276664) under ""Show resolved"":\n> lol, looks like #14146 was the culprit, released in v0.18.0.\n> \n> Might as well just call it a bug in the dependency docs at this point I guess.\n> \n> utACK",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-703629595,703629595,
promag,2020-10-05 17:42:15,"ACK, Could add a test with trailing /?",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-703783684,703783684,
MarcoFalke,2020-10-05 17:52:18,"I wrote a test when I reviewed this, btw:\n\n```diff\ndiff --git a/src/test/util_tests.cpp b/src/test/util_tests.cpp\nindex 241c56934e..e9f2ba8e13 100644\n--- a/src/test/util_tests.cpp\n+++ b/src/test/util_tests.cpp\n@@ -42,6 +42,17 @@ namespace BCLog {\n \n BOOST_FIXTURE_TEST_SUITE(util_tests, BasicTestingSetup)\n \n+BOOST_AUTO_TEST_CASE(util_datadir)\n+{\n+    ClearDatadirCache();\",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-703789084,703789084,
hebasto,2020-10-05 18:20:32,"> I wrote a test when I reviewed this, btw:\n\nThanks @MarcoFalke! Test added.",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-703804769,703804769,
MarcoFalke,2020-10-06 05:50:52,"review ACK b7c5a94ee1550f4f85b1889314f41b47fdf86cc2 ðŸ’¥\n\n<details><summary>Show signature and timestamp</summary>\n\nSignature:\n\n```\n-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA512\n\nreview ACK b7c5a94ee1550f4f85b1889314f41b47fdf86cc2 ðŸ’¥\n-----BEGIN PGP SIGNATURE-----\n\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUgTkwv/XaFo530gaTkb5Y2vUPmsqTN21ZGiqxSGAQWY",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-704043643,704043643,
hebasto,2020-10-07 08:55:37,"Updated b7c5a94ee1550f4f85b1889314f41b47fdf86cc2 -> 3cd0a16d5a53e2e1d6aec30d67a4c449b5dd919c ([pr20080.02](https://github.com/hebasto/bitcoin/commits/pr20080.02) -> [pr20080.03](https://github.com/hebasto/bitcoin/commits/pr20080.03)):\n\n- addressed @promag's [comment](https://github.com/bitcoin/bitcoin/pull/20080#discussion_r500806899):\n> nit, could add another case lile `+ ""/./""` to it's cle",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-704794437,704794437,
meshcollider,2020-10-07 09:18:52,"Sorry I may be confused about the boost versions that this requires, but if this needs boost 1.58, it can't actually be backported to the branches tagged can it? This works on master but only the alternative #19933 could be backported?\nEDIT: or does a boost version bump also apply to backport branches ðŸ¤” ",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-704807301,704807301,
hebasto,2020-10-07 09:47:31,"@meshcollider \n> Sorry I may be confused about the boost versions that this requires, but if this needs boost 1.58, it can't actually be backported to the branches tagged can it? This works on master but only the alternative #19933 could be backported?\n> EDIT: or does a boost version bump also apply to backport branches thinking\n\nThere is a [discussion](https://github.com/bitcoin/bitcoin/p",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-704823607,704823607,
prayank23,2020-10-11 20:51:34,"Concept ACK\n\nWhile I was testing few things with wallet names on Windows and Ubuntu, I found that user can create wallets with names:\n\n`../testwallet` for Linux \n`..\testwallet` for Windows\n\nIt creates the wallet in `testnet3` instead of `testnet3/wallets` in the case of Ubuntu and `testnet3\wallets` for Windows which is kind of directory traversal although this is not a web applicat",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-706766527,706766527,
hebasto,2020-10-12 06:03:44,"@prayank23 \n> ... maybe we can add some code to validate user's input for a wallet name before saving.\n\nGood idea for a new pr.\n",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-706886740,706886740,
MarcoFalke,2020-10-13 11:22:53,"re-ACK 3cd0a16d5a , only change is adding even more tests ðŸ¦‰\n\n<details><summary>Show signature and timestamp</summary>\n\nSignature:\n\n```\n-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA512\n\nre-ACK 3cd0a16d5a , only change is adding even more tests ðŸ¦‰\n-----BEGIN PGP SIGNATURE-----\n\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUhbtAwAvcAR2ST3Ku0kAbPVuQu9weJk",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-707673894,707673894,
hebasto,2020-10-13 16:01:37,"@meshcollider \n> Sorry I may be confused about the boost versions that this requires, but if this needs boost 1.58, it can't actually be backported to the branches tagged can it? This works on master but only the alternative #19933 could be backported?\n> EDIT: or does a boost version bump also apply to backport branches thinking\n\nSince #20142 has been merged, still you have concerns about ",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-707843130,707843130,
meshcollider,2020-10-15 07:25:17,I really don't have a preference now for either this or #19933 but would like to see one of them picked so we can get the fix in soon.,https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-708956188,708956188,
MarcoFalke,2020-10-15 20:23:18,"Tested\n\n* master with trailing `/`\n\n```\n{\n  ""wallets"": [\n    {\n      ""name"": ""est_20080_wallet""\n    }\n  ]\n}\n```\n* this pull with trailing `/`:\n\n```\n{\n  ""wallets"": [\n    {\n      ""name"": ""test_20080_wallet""\n    }\n  ]\n}\n",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-709570068,709570068,
fanquake,2020-10-16 03:24:57,"When merged into master this currently breaks at least the `feature_asmap.py` & `feature_filelock.py` tests (and by the looks of it a few others others). Note the difference in file path `/private/var/folders/z2/cn877....` vs `/var/folders/z2/cn877....`\n\n```bash\n1/1 - feature_filelock.py failed, Duration: 1 s\n\nstdout:\n2020-10-16T03:21:53.605000Z TestFramework (INFO): Initializing test ",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-709708344,709708344,
hebasto,2020-10-16 09:19:03,"A [canonical path](https://www.boost.org/doc/libs/1_48_0/libs/filesystem/v3/doc/reference.html#Canonical-path):\n> has no elements which are symbolic links\n\nAnd I agree with @luke-jr's [comment](https://github.com/bitcoin/bitcoin/pull/1133#issuecomment-5267627):\n> Does this resolve symbolic links? (I don't think that is proper behaviour, if so)\n\nI think that we should handle symbolic li",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-709931469,709931469,
MarcoFalke,2020-10-16 09:47:28,"I don't think we are going to switch to std::fs any time soon, at least doing so would mean dropping support for major OSs.\n\nIf the concept from #19933 is preferred, then at least put the sanitizing workaround here, not at the call site. Otherwise we'll have to copy-paste the workaround everywhere it is needed, instead of having it run once right after the datadir is parsed.",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-709945000,709945000,
hebasto,2020-10-16 09:50:09,"> I don't think we are going to switch to std::fs any time soon, at least doing so would mean dropping support for major OSs.\n\nHow is so?\n\n> If the concept from #19933 is preferred, then at least put the sanitizing workaround here, not at the call site. Otherwise we'll have to copy-paste the workaround everywhere it is needed, instead of having it run once right after the datadir is parsed",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-709946159,709946159,
MarcoFalke,2020-10-16 09:52:45,"> Agree\n\nWould you mind doing here (and attributing @Saibato for the idea on the fix)?",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-709947417,709947417,
hebasto,2020-10-16 09:55:20,"> > Agree\n> \n> Would you mind doing here (and attributing @Saibato for the idea on the fix)?\n\nWith my pleasure!",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-709948557,709948557,
hebasto,2020-10-16 15:45:55,"Updated 3cd0a16d5a53e2e1d6aec30d67a4c449b5dd919c -> 2ed6c43cf662590358bb44d582940baee2df9ba5 ([pr20080.03](https://github.com/hebasto/bitcoin/commits/pr20080.03) -> [pr20080.04](https://github.com/hebasto/bitcoin/commits/pr20080.04)):\n\n- reworked from scratch to keep symlinks unresolved\n\n@promag\n> Same canonical tests could be added for -blocksdir and -walletdir.\n\n`-blocksdir` path i",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-710125485,710125485,
DrahtBot,2020-10-16 21:11:57,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19213 (refactor: Replace RecursiveMutex with Mutex in Get{Data,Blocks}Dir() by hebasto)\n\nIf you consider this pull requ",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-710641386,710641386,
MarcoFalke,2020-10-27 19:03:53,review ACK 1c55140c3950a9c0c250f21e0a45f77e04efc5ec,https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-717470609,717470609,
hebasto,2020-10-27 19:54:55,"Updated 1c55140c3950a9c0c250f21e0a45f77e04efc5ec -> ad5cef5dfdd5802fc187a52e74d940a52f420a51 ([pr20080.06](https://github.com/hebasto/bitcoin/commits/pr20080.06) -> [pr20080.07](https://github.com/hebasto/bitcoin/commits/pr20080.07), [diff](https://github.com/hebasto/bitcoin/compare/pr20080.06..pr20080.07)):\n\n- addressed @MarcoFalke's [comment](https://github.com/bitcoin/bitcoin/pull/20080#dis",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-717499942,717499942,
MarcoFalke,2020-10-28 12:59:17,"review ACK ad5cef5dfd ðŸ”™\n\n<details><summary>Show signature and timestamp</summary>\n\nSignature:\n\n```\n-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA512\n\nreview ACK ad5cef5dfd ðŸ”™\n-----BEGIN PGP SIGNATURE-----\n\niQGzBAEBCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUh2GgwAz4Uptv3ziQnbQG+tUMVeu01+X+QPQlyBvxFx9r8PbhaLTEpKXGFd48QA\nQbkxIgPR3JibK5QXLc2am1s6BPXmkGDc4jNTf",https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-717915662,717915662,
fanquake,2020-11-06 08:05:56,Added to #20166 for backporting to 0.20.,https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-722938914,722938914,
luke-jr,2020-10-04 18:34:50,"This isn't in boost 1.47.0, which is our minimum required in older versions. Thus, it is ineligible for use in a bugfix.",https://github.com/bitcoin/bitcoin/pull/20080#discussion_r499275308,499275308,src/util/system.cpp
hebasto,2020-10-04 18:40:05,"Hmm, \n```\n$ git checkout v0.19.1\n$ git grep -e 'fs::canonical' | wc -l\n5\n```",https://github.com/bitcoin/bitcoin/pull/20080#discussion_r499275789,499275789,src/util/system.cpp
luke-jr,2020-10-04 18:49:43,"lol, looks like #14146 was the culprit, released in v0.18.0.\n\nMight as well just call it a bug in the dependency docs at this point I guess.\n\nutACK",https://github.com/bitcoin/bitcoin/pull/20080#discussion_r499276664,499276664,src/util/system.cpp
sipa,2020-10-04 18:53:05,"According to doc/dependencies.md, our minimum supported Boost version is 1.58 ?",https://github.com/bitcoin/bitcoin/pull/20080#discussion_r499276957,499276957,src/util/system.cpp
luke-jr,2020-10-04 18:55:34,@sipa that just changed in master (only).,https://github.com/bitcoin/bitcoin/pull/20080#discussion_r499277175,499277175,src/util/system.cpp
sipa,2020-10-04 18:56:34,This PR is also fixing a bug that's only in master AFAIK?,https://github.com/bitcoin/bitcoin/pull/20080#discussion_r499277278,499277278,src/util/system.cpp
luke-jr,2020-10-04 18:57:52,FWIW fs::canonical was introduced in Boost 1.48.,https://github.com/bitcoin/bitcoin/pull/20080#discussion_r499277473,499277473,src/util/system.cpp
hebasto,2020-10-04 19:06:16,"> This PR is also fixing a bug that's only in master AFAIK?\n\nJust tested `0.19.1`. It has that bug too.",https://github.com/bitcoin/bitcoin/pull/20080#discussion_r499278261,499278261,src/util/system.cpp
sipa,2020-10-04 19:08:20,"Ah, my mistake.",https://github.com/bitcoin/bitcoin/pull/20080#discussion_r499278461,499278461,src/util/system.cpp
promag,2020-10-07 07:50:32,"nit, could add another case lile `+ ""/./""` to it's clear the result is canonical, not just without last `/`.",https://github.com/bitcoin/bitcoin/pull/20080#discussion_r500806899,500806899,src/test/util_tests.cpp
hebasto,2020-10-07 08:56:04,Thanks! [Updated](https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-704794437).,https://github.com/bitcoin/bitcoin/pull/20080#discussion_r500848413,500848413,src/test/util_tests.cpp
MarcoFalke,2020-10-27 19:15:10,"nit: Can be written shorter\n\n```suggestion\n        result = result.parent_path();\n```",https://github.com/bitcoin/bitcoin/pull/20080#discussion_r512960359,512960359,src/util/system.cpp
hebasto,2020-10-27 19:55:36,Thanks! [Updated](https://github.com/bitcoin/bitcoin/pull/20080#issuecomment-717499942).,https://github.com/bitcoin/bitcoin/pull/20080#discussion_r512990723,512990723,src/util/system.cpp
