[
  {
    "sha": "b19e88230f0e93e95e883e65376963cb9c36f606",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiMTllODgyMzBmMGU5M2U5NWU4ODNlNjUzNzY5NjNjYjljMzZmNjA2",
    "commit": {
      "author": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2020-10-16T15:06:14Z"
      },
      "committer": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2020-10-27T19:45:32Z"
      },
      "message": "util: Add StripRedundantLastElementsOfPath function\n\nCo-authored-by: saibato <saibato.naga@pm.me>\nCo-authored-by: MarcoFalke <falke.marco@gmail.com>",
      "tree": {
        "sha": "d50c41eec352973eccc262981958d8dbc1802aaf",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d50c41eec352973eccc262981958d8dbc1802aaf"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b19e88230f0e93e95e883e65376963cb9c36f606",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE0dvyxLlvLev0wWZUQQEIES5+qB8FAl+YeNwACgkQQQEIES5+\nqB9vCg/+K/+xvYx2uXCysMhiv95CpMEbqQ0Rvf0M8X0aA9uMu7TeCrK7oCgmFtk8\nCE4CpLf0ENj4ystGeP+ITl7Z5qTcoAZ9AVke1UP8PN2xaYMNAvbZzWsCRcxO60UJ\nSqkUNgIIlxizd//SUELMADutQ5z9LlLL4JSviEL5p82Ocua8t/XhyRu3t2hkoySC\n4gA8isSj5AqxT0LoOiQpF1NA5Ed5sjm6gf0+bWv3SjOfViYJQgDd1HvSHy9j0UuJ\nGqHpQBrvOoxbaEZ21iqpZ/6iZR3uxXMddHcQ9y5l1wv+qQaOgIFviMNro8FmsDgY\nvfHhl4ut71TP4ehLmYh1TGDVHrSJqhxCwvWl8CR9rT29WTrLsONISmpR/e2BolAD\ni31IRAhVlRpjzzvquQ4KXuqu0YIDMG6sEfRmUgnynhgb2oF2UzCCanhADQO1asQh\nZTgP9jC6TA8qAdSR5tSaKHZLdwP5REqvWeBT/6iSWJUOm4eiF62mALjz/T2z+GdQ\nQWStzxIfrk1CiLCGo1/hW1MUkuWy7jfkHszWWc7sO6f5xhARQlFN73l970eNvPA+\nbRZJ/+9mK4gMwqR8I8u6vIoW1qnWNheVtX++yh10+q78MxqLSHmi2HcUDe7u0hX+\nF8Wz1OFACNiAcEifMIYLTbLtvnS1KUUZhA54wiOxh2Zrhdkgsyg=\n=yjGf\n-----END PGP SIGNATURE-----",
        "payload": "tree d50c41eec352973eccc262981958d8dbc1802aaf\nparent 9e8d2bd076d78ba59abceb80106f44fe26246b14\nauthor Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1602860774 +0300\ncommitter Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1603827932 +0200\n\nutil: Add StripRedundantLastElementsOfPath function\n\nCo-authored-by: saibato <saibato.naga@pm.me>\nCo-authored-by: MarcoFalke <falke.marco@gmail.com>\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b19e88230f0e93e95e883e65376963cb9c36f606",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/b19e88230f0e93e95e883e65376963cb9c36f606",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b19e88230f0e93e95e883e65376963cb9c36f606/comments",
    "author": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "9e8d2bd076d78ba59abceb80106f44fe26246b14",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9e8d2bd076d78ba59abceb80106f44fe26246b14",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/9e8d2bd076d78ba59abceb80106f44fe26246b14"
      }
    ],
    "stats": {
      "total": 38,
      "additions": 38,
      "deletions": 0
    },
    "files": [
      {
        "sha": "010b6adf1f83cc1ea003435cf7a95ea589922cf9",
        "filename": "src/test/util_tests.cpp",
        "status": "modified",
        "additions": 22,
        "deletions": 0,
        "changes": 22,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b19e88230f0e93e95e883e65376963cb9c36f606/src/test/util_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b19e88230f0e93e95e883e65376963cb9c36f606/src/test/util_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/util_tests.cpp?ref=b19e88230f0e93e95e883e65376963cb9c36f606",
        "patch": "@@ -42,6 +42,28 @@ namespace BCLog {\n \n BOOST_FIXTURE_TEST_SUITE(util_tests, BasicTestingSetup)\n \n+BOOST_AUTO_TEST_CASE(util_datadir)\n+{\n+    ClearDatadirCache();\n+    const fs::path dd_norm = GetDataDir();\n+\n+    gArgs.ForceSetArg(\"-datadir\", dd_norm.string() + \"/\");\n+    ClearDatadirCache();\n+    BOOST_CHECK_EQUAL(dd_norm, GetDataDir());\n+\n+    gArgs.ForceSetArg(\"-datadir\", dd_norm.string() + \"/.\");\n+    ClearDatadirCache();\n+    BOOST_CHECK_EQUAL(dd_norm, GetDataDir());\n+\n+    gArgs.ForceSetArg(\"-datadir\", dd_norm.string() + \"/./\");\n+    ClearDatadirCache();\n+    BOOST_CHECK_EQUAL(dd_norm, GetDataDir());\n+\n+    gArgs.ForceSetArg(\"-datadir\", dd_norm.string() + \"/.//\");\n+    ClearDatadirCache();\n+    BOOST_CHECK_EQUAL(dd_norm, GetDataDir());\n+}\n+\n BOOST_AUTO_TEST_CASE(util_check)\n {\n     // Check that Assert can forward"
      },
      {
        "sha": "7754ef3e01740997ee4785c515d6ecba8f0d80aa",
        "filename": "src/util/system.cpp",
        "status": "modified",
        "additions": 16,
        "deletions": 0,
        "changes": 16,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b19e88230f0e93e95e883e65376963cb9c36f606/src/util/system.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b19e88230f0e93e95e883e65376963cb9c36f606/src/util/system.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util/system.cpp?ref=b19e88230f0e93e95e883e65376963cb9c36f606",
        "patch": "@@ -34,6 +34,7 @@\n #endif // __linux__\n \n #include <algorithm>\n+#include <cassert>\n #include <fcntl.h>\n #include <sched.h>\n #include <sys/resource.h>\n@@ -665,6 +666,19 @@ fs::path GetDefaultDataDir()\n #endif\n }\n \n+namespace {\n+fs::path StripRedundantLastElementsOfPath(const fs::path& path)\n+{\n+    auto result = path;\n+    while (result.filename().string() == \".\") {\n+        result = result.parent_path();\n+    }\n+\n+    assert(fs::equivalent(result, path));\n+    return result;\n+}\n+} // namespace\n+\n static fs::path g_blocks_path_cache_net_specific;\n static fs::path pathCached;\n static fs::path pathCachedNetSpecific;\n@@ -692,6 +706,7 @@ const fs::path &GetBlocksDir()\n     path /= BaseParams().DataDir();\n     path /= \"blocks\";\n     fs::create_directories(path);\n+    path = StripRedundantLastElementsOfPath(path);\n     return path;\n }\n \n@@ -722,6 +737,7 @@ const fs::path &GetDataDir(bool fNetSpecific)\n         fs::create_directories(path / \"wallets\");\n     }\n \n+    path = StripRedundantLastElementsOfPath(path);\n     return path;\n }\n "
      }
    ]
  },
  {
    "sha": "ad5cef5dfdd5802fc187a52e74d940a52f420a51",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphZDVjZWY1ZGZkZDU4MDJmYzE4N2E1MmU3NGQ5NDBhNTJmNDIwYTUx",
    "commit": {
      "author": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2020-10-16T15:32:43Z"
      },
      "committer": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2020-10-27T19:46:00Z"
      },
      "message": "doc: Update data directory path comments",
      "tree": {
        "sha": "fc88d021bd7af337e2fdd5a96e3d01ad17863a0f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fc88d021bd7af337e2fdd5a96e3d01ad17863a0f"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ad5cef5dfdd5802fc187a52e74d940a52f420a51",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE0dvyxLlvLev0wWZUQQEIES5+qB8FAl+YePgACgkQQQEIES5+\nqB92Ng//RCWDMAmvu/VGkF0fuJ3i4z4/vJN4YStQTes7HT6TnkZTXefHqnCvxzHA\njBBu0SfR3RExMywMTvpC0dZkgLh2gH0bN1vKtVUF8cFIGTgTAXiTikQRnNt/QSKr\no+otV1s69FXyr5Lb2iymtGOKuPKJiTSEqDaNqK5NAyCKRjbJrNRhwxXl6UAt07tS\nuAMZoQDLFnbCC7KsVaSQfi66Nbc/AHozU02VgA3ngmF+YvjY//n5K8Chek6gpEL7\nT3OwNwhfw3LYp86sJNDZEo8qvI7qlxNXrs93v5BCyA4qyPj59b2FxUTxcBLZtKY4\nBeRKoO2hGvx58X4HaX3qyxEWiwYLeWLprkTIryRqb8Jq+d/mgXi+RXb3YtHbaD/E\n2EB4AqkGKjc6eu16qlRx9z1SsDbsl59G2SZqu5CuJnesMQtsojSWPx5p+fcn9ZxA\nNCml3dtJ4I/6Z9x/ybX6fCTkBOvA1OZILQuMok8x/xM9AlWZt+j9vt1iIj7j2EuX\nnSC7WDc+WN2kbECwh4gGCrJA6KBDGnN3ekzMWIy7y3rEH/J6S6xVqI49SXUjQXeq\nQykwohlce6shCPJKpNsXpMTkEIibXOySw5Tujkb9FBMkg61Gk9wrrBMswPGlsx5N\nQetlOB63dUPujJeZrwr/MTdz8KiMf5guNv6N48Q8gTSLZ7KcrII=\n=XED4\n-----END PGP SIGNATURE-----",
        "payload": "tree fc88d021bd7af337e2fdd5a96e3d01ad17863a0f\nparent b19e88230f0e93e95e883e65376963cb9c36f606\nauthor Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1602862363 +0300\ncommitter Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1603827960 +0200\n\ndoc: Update data directory path comments\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ad5cef5dfdd5802fc187a52e74d940a52f420a51",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/ad5cef5dfdd5802fc187a52e74d940a52f420a51",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ad5cef5dfdd5802fc187a52e74d940a52f420a51/comments",
    "author": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "b19e88230f0e93e95e883e65376963cb9c36f606",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b19e88230f0e93e95e883e65376963cb9c36f606",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/b19e88230f0e93e95e883e65376963cb9c36f606"
      }
    ],
    "stats": {
      "total": 11,
      "additions": 5,
      "deletions": 6
    },
    "files": [
      {
        "sha": "a3f21f016249d38e3c6f5dd56c150e3add95e8c4",
        "filename": "src/util/system.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 6,
        "changes": 11,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ad5cef5dfdd5802fc187a52e74d940a52f420a51/src/util/system.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ad5cef5dfdd5802fc187a52e74d940a52f420a51/src/util/system.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util/system.cpp?ref=ad5cef5dfdd5802fc187a52e74d940a52f420a51",
        "patch": "@@ -642,10 +642,9 @@ void PrintExceptionContinue(const std::exception* pex, const char* pszThread)\n \n fs::path GetDefaultDataDir()\n {\n-    // Windows < Vista: C:\\Documents and Settings\\Username\\Application Data\\Bitcoin\n-    // Windows >= Vista: C:\\Users\\Username\\AppData\\Roaming\\Bitcoin\n-    // Mac: ~/Library/Application Support/Bitcoin\n-    // Unix: ~/.bitcoin\n+    // Windows: C:\\Users\\Username\\AppData\\Roaming\\Bitcoin\n+    // macOS: ~/Library/Application Support/Bitcoin\n+    // Unix-like: ~/.bitcoin\n #ifdef WIN32\n     // Windows\n     return GetSpecialFolderPath(CSIDL_APPDATA) / \"Bitcoin\";\n@@ -657,10 +656,10 @@ fs::path GetDefaultDataDir()\n     else\n         pathRet = fs::path(pszHome);\n #ifdef MAC_OSX\n-    // Mac\n+    // macOS\n     return pathRet / \"Library/Application Support/Bitcoin\";\n #else\n-    // Unix\n+    // Unix-like\n     return pathRet / \".bitcoin\";\n #endif\n #endif"
      }
    ]
  }
]