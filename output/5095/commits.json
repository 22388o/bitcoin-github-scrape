[
  {
    "sha": "d4746d56c0c45b8721da36bc19b2bdaba5d7d094",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkNDc0NmQ1NmMwYzQ1Yjg3MjFkYTM2YmMxOWIyYmRhYmE1ZDdkMDk0",
    "commit": {
      "author": {
        "name": "Mark Friedenbach",
        "email": "mark@blockstream.io",
        "date": "2014-10-16T23:16:29Z"
      },
      "committer": {
        "name": "Mark Friedenbach",
        "email": "mark@blockstream.io",
        "date": "2014-10-17T07:33:31Z"
      },
      "message": "Add a SECURE style flag for ThreadSafeMessageBox, which indicates that the message contains sensitive information. This keeps the message from being output to the debug log by bitcoind. Fixes a possible security risk when starting bitcoind in server mode without the 'rpcpassword' option configured, resulting in the \"suggested\" password being output to the debug log.",
      "tree": {
        "sha": "01304911064e6f0ccce518ab2d7456b89681d0c4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/01304911064e6f0ccce518ab2d7456b89681d0c4"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d4746d56c0c45b8721da36bc19b2bdaba5d7d094",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d4746d56c0c45b8721da36bc19b2bdaba5d7d094",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/d4746d56c0c45b8721da36bc19b2bdaba5d7d094",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d4746d56c0c45b8721da36bc19b2bdaba5d7d094/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "e8f6d54f1f58d9a5998e37367b84b427e51e1ad7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e8f6d54f1f58d9a5998e37367b84b427e51e1ad7",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/e8f6d54f1f58d9a5998e37367b84b427e51e1ad7"
      }
    ],
    "stats": {
      "total": 14,
      "additions": 12,
      "deletions": 2
    },
    "files": [
      {
        "sha": "8f3b0275b00491aa07e53e351d5751e4eeb08971",
        "filename": "src/noui.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 1,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d4746d56c0c45b8721da36bc19b2bdaba5d7d094/src/noui.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d4746d56c0c45b8721da36bc19b2bdaba5d7d094/src/noui.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/noui.cpp?ref=d4746d56c0c45b8721da36bc19b2bdaba5d7d094",
        "patch": "@@ -14,6 +14,9 @@\n \n static bool noui_ThreadSafeMessageBox(const std::string& message, const std::string& caption, unsigned int style)\n {\n+    bool fSecure = style & CClientUIInterface::SECURE;\n+    style &= ~CClientUIInterface::SECURE;\n+\n     std::string strCaption;\n     // Check for usage of predefined caption\n     switch (style) {\n@@ -30,7 +33,8 @@ static bool noui_ThreadSafeMessageBox(const std::string& message, const std::str\n         strCaption += caption; // Use supplied caption (can be empty)\n     }\n \n-    LogPrintf(\"%s: %s\\n\", strCaption, message);\n+    if (!fSecure)\n+        LogPrintf(\"%s: %s\\n\", strCaption, message);\n     fprintf(stderr, \"%s: %s\\n\", strCaption.c_str(), message.c_str());\n     return false;\n }"
      },
      {
        "sha": "9d6d07a56bd4a49b5d51177b2515703478537a5f",
        "filename": "src/qt/bitcoingui.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d4746d56c0c45b8721da36bc19b2bdaba5d7d094/src/qt/bitcoingui.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d4746d56c0c45b8721da36bc19b2bdaba5d7d094/src/qt/bitcoingui.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoingui.cpp?ref=d4746d56c0c45b8721da36bc19b2bdaba5d7d094",
        "patch": "@@ -992,6 +992,9 @@ void BitcoinGUI::showProgress(const QString &title, int nProgress)\n static bool ThreadSafeMessageBox(BitcoinGUI *gui, const std::string& message, const std::string& caption, unsigned int style)\n {\n     bool modal = (style & CClientUIInterface::MODAL);\n+    // The SECURE flag has no effect in the Qt GUI.\n+    // bool secure = (style & CClientUIInterface::SECURE);\n+    style &= ~CClientUIInterface::SECURE;\n     bool ret = false;\n     // In case of modal message, use blocking connection to wait for user to click a button\n     QMetaObject::invokeMethod(gui, \"message\","
      },
      {
        "sha": "9668c7883144b65a1a8331958c0778c3e566b7c6",
        "filename": "src/rpcserver.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d4746d56c0c45b8721da36bc19b2bdaba5d7d094/src/rpcserver.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d4746d56c0c45b8721da36bc19b2bdaba5d7d094/src/rpcserver.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpcserver.cpp?ref=d4746d56c0c45b8721da36bc19b2bdaba5d7d094",
        "patch": "@@ -581,7 +581,7 @@ void StartRPCThreads()\n                 strWhatAmI,\n                 GetConfigFile().string(),\n                 EncodeBase58(&rand_pwd[0],&rand_pwd[0]+32)),\n-                \"\", CClientUIInterface::MSG_ERROR);\n+                \"\", CClientUIInterface::MSG_ERROR | CClientUIInterface::SECURE);\n         StartShutdown();\n         return;\n     }"
      },
      {
        "sha": "1231d5ed0bcd0df81200756a219c886221618897",
        "filename": "src/ui_interface.h",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d4746d56c0c45b8721da36bc19b2bdaba5d7d094/src/ui_interface.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d4746d56c0c45b8721da36bc19b2bdaba5d7d094/src/ui_interface.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/ui_interface.h?ref=d4746d56c0c45b8721da36bc19b2bdaba5d7d094",
        "patch": "@@ -63,6 +63,9 @@ class CClientUIInterface\n         /** Force blocking, modal message box dialog (not just OS notification) */\n         MODAL               = 0x10000000U,\n \n+        /** Do not print contents of message to debug log */\n+        SECURE              = 0x40000000U,\n+\n         /** Predefined combinations for certain default usage cases */\n         MSG_INFORMATION = ICON_INFORMATION,\n         MSG_WARNING = (ICON_WARNING | BTN_OK | MODAL),"
      }
    ]
  }
]