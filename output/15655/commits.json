[
  {
    "sha": "418d3230f86f77dde6e817f502baff8a54b707fa",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0MThkMzIzMGY4NmY3N2RkZTZlODE3ZjUwMmJhZmY4YTU0YjcwN2Zh",
    "commit": {
      "author": {
        "name": "251",
        "email": "13120787+251Labs@users.noreply.github.com",
        "date": "2019-03-23T16:41:16Z"
      },
      "committer": {
        "name": "251",
        "email": "13120787+251Labs@users.noreply.github.com",
        "date": "2019-03-23T16:43:54Z"
      },
      "message": "Resolve the checkpoints <-> validation CD.\n\nThis commit resolves the checkpoints -> validation -> checkpoints\ncirular dependency by moving\n`CheckPoints::GetLastCheckpoint(const CCheckpointData& data)` from\n`checkpoints.cpp` to `validation.cpp`.",
      "tree": {
        "sha": "a3507114d0b0a2d9184d187d6ded516791151894",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a3507114d0b0a2d9184d187d6ded516791151894"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/418d3230f86f77dde6e817f502baff8a54b707fa",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/418d3230f86f77dde6e817f502baff8a54b707fa",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/418d3230f86f77dde6e817f502baff8a54b707fa",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/418d3230f86f77dde6e817f502baff8a54b707fa/comments",
    "author": {
      "login": "l2a5b1",
      "id": 13120787,
      "node_id": "MDQ6VXNlcjEzMTIwNzg3",
      "avatar_url": "https://avatars.githubusercontent.com/u/13120787?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/l2a5b1",
      "html_url": "https://github.com/l2a5b1",
      "followers_url": "https://api.github.com/users/l2a5b1/followers",
      "following_url": "https://api.github.com/users/l2a5b1/following{/other_user}",
      "gists_url": "https://api.github.com/users/l2a5b1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/l2a5b1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/l2a5b1/subscriptions",
      "organizations_url": "https://api.github.com/users/l2a5b1/orgs",
      "repos_url": "https://api.github.com/users/l2a5b1/repos",
      "events_url": "https://api.github.com/users/l2a5b1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/l2a5b1/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "l2a5b1",
      "id": 13120787,
      "node_id": "MDQ6VXNlcjEzMTIwNzg3",
      "avatar_url": "https://avatars.githubusercontent.com/u/13120787?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/l2a5b1",
      "html_url": "https://github.com/l2a5b1",
      "followers_url": "https://api.github.com/users/l2a5b1/followers",
      "following_url": "https://api.github.com/users/l2a5b1/following{/other_user}",
      "gists_url": "https://api.github.com/users/l2a5b1/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/l2a5b1/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/l2a5b1/subscriptions",
      "organizations_url": "https://api.github.com/users/l2a5b1/orgs",
      "repos_url": "https://api.github.com/users/l2a5b1/repos",
      "events_url": "https://api.github.com/users/l2a5b1/events{/privacy}",
      "received_events_url": "https://api.github.com/users/l2a5b1/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "7b13c646457980f44599412f243694fa682a1abf",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7b13c646457980f44599412f243694fa682a1abf",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/7b13c646457980f44599412f243694fa682a1abf"
      }
    ],
    "stats": {
      "total": 86,
      "additions": 18,
      "deletions": 68
    },
    "files": [
      {
        "sha": "1e801821399ba5cf603682dd0d0cd195166ba1b7",
        "filename": "src/Makefile.am",
        "status": "modified",
        "additions": 0,
        "deletions": 2,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/418d3230f86f77dde6e817f502baff8a54b707fa/src/Makefile.am",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/418d3230f86f77dde6e817f502baff8a54b707fa/src/Makefile.am",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.am?ref=418d3230f86f77dde6e817f502baff8a54b707fa",
        "patch": "@@ -113,7 +113,6 @@ BITCOIN_CORE_H = \\\n   chainparams.h \\\n   chainparamsbase.h \\\n   chainparamsseeds.h \\\n-  checkpoints.h \\\n   checkqueue.h \\\n   clientversion.h \\\n   coins.h \\\n@@ -247,7 +246,6 @@ libbitcoin_server_a_SOURCES = \\\n   blockencodings.cpp \\\n   blockfilter.cpp \\\n   chain.cpp \\\n-  checkpoints.cpp \\\n   consensus/tx_verify.cpp \\\n   flatfile.cpp \\\n   httprpc.cpp \\"
      },
      {
        "sha": "ad5edfeb390b8b6ba91afd2b890df5d911f832bc",
        "filename": "src/checkpoints.cpp",
        "status": "removed",
        "additions": 0,
        "deletions": 32,
        "changes": 32,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7b13c646457980f44599412f243694fa682a1abf/src/checkpoints.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7b13c646457980f44599412f243694fa682a1abf/src/checkpoints.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/checkpoints.cpp?ref=7b13c646457980f44599412f243694fa682a1abf",
        "patch": "@@ -1,32 +0,0 @@\n-// Copyright (c) 2009-2018 The Bitcoin Core developers\n-// Distributed under the MIT software license, see the accompanying\n-// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n-\n-#include <checkpoints.h>\n-\n-#include <chain.h>\n-#include <chainparams.h>\n-#include <reverse_iterator.h>\n-#include <validation.h>\n-\n-#include <stdint.h>\n-\n-\n-namespace Checkpoints {\n-\n-    CBlockIndex* GetLastCheckpoint(const CCheckpointData& data)\n-    {\n-        const MapCheckpoints& checkpoints = data.mapCheckpoints;\n-\n-        for (const MapCheckpoints::value_type& i : reverse_iterate(checkpoints))\n-        {\n-            const uint256& hash = i.second;\n-            CBlockIndex* pindex = LookupBlockIndex(hash);\n-            if (pindex) {\n-                return pindex;\n-            }\n-        }\n-        return nullptr;\n-    }\n-\n-} // namespace Checkpoints"
      },
      {
        "sha": "a25e97e469c8b2ae85711a3abda6b0a4470840cc",
        "filename": "src/checkpoints.h",
        "status": "removed",
        "additions": 0,
        "deletions": 27,
        "changes": 27,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7b13c646457980f44599412f243694fa682a1abf/src/checkpoints.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7b13c646457980f44599412f243694fa682a1abf/src/checkpoints.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/checkpoints.h?ref=7b13c646457980f44599412f243694fa682a1abf",
        "patch": "@@ -1,27 +0,0 @@\n-// Copyright (c) 2009-2018 The Bitcoin Core developers\n-// Distributed under the MIT software license, see the accompanying\n-// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n-\n-#ifndef BITCOIN_CHECKPOINTS_H\n-#define BITCOIN_CHECKPOINTS_H\n-\n-#include <uint256.h>\n-\n-#include <map>\n-\n-class CBlockIndex;\n-struct CCheckpointData;\n-\n-/**\n- * Block-chain checkpoints are compiled-in sanity checks.\n- * They are updated every release or three.\n- */\n-namespace Checkpoints\n-{\n-\n-//! Returns last CBlockIndex* that is a checkpoint\n-CBlockIndex* GetLastCheckpoint(const CCheckpointData& data);\n-\n-} //namespace Checkpoints\n-\n-#endif // BITCOIN_CHECKPOINTS_H"
      },
      {
        "sha": "3b4f0c940e60a94c77dc50a6a8518297bae64867",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/418d3230f86f77dde6e817f502baff8a54b707fa/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/418d3230f86f77dde6e817f502baff8a54b707fa/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=418d3230f86f77dde6e817f502baff8a54b707fa",
        "patch": "@@ -14,7 +14,6 @@\n #include <banman.h>\n #include <chain.h>\n #include <chainparams.h>\n-#include <checkpoints.h>\n #include <compat/sanity.h>\n #include <consensus/validation.h>\n #include <fs.h>"
      },
      {
        "sha": "88a35534c21c4c62b1c4fd4c370890faf8d6b2e2",
        "filename": "src/qt/clientmodel.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/418d3230f86f77dde6e817f502baff8a54b707fa/src/qt/clientmodel.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/418d3230f86f77dde6e817f502baff8a54b707fa/src/qt/clientmodel.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/clientmodel.cpp?ref=418d3230f86f77dde6e817f502baff8a54b707fa",
        "patch": "@@ -11,7 +11,6 @@\n \n #include <chain.h>\n #include <chainparams.h>\n-#include <checkpoints.h>\n #include <clientversion.h>\n #include <interfaces/handler.h>\n #include <interfaces/node.h>"
      },
      {
        "sha": "0d588ac88d9d0d6c6a84bea99f9a4bc87ea42ade",
        "filename": "src/rpc/blockchain.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/418d3230f86f77dde6e817f502baff8a54b707fa/src/rpc/blockchain.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/418d3230f86f77dde6e817f502baff8a54b707fa/src/rpc/blockchain.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/blockchain.cpp?ref=418d3230f86f77dde6e817f502baff8a54b707fa",
        "patch": "@@ -9,7 +9,6 @@\n #include <base58.h>\n #include <chain.h>\n #include <chainparams.h>\n-#include <checkpoints.h>\n #include <coins.h>\n #include <consensus/validation.h>\n #include <core_io.h>"
      },
      {
        "sha": "a0818384b019d4ec84316d90ae4fed467aec2c26",
        "filename": "src/validation.cpp",
        "status": "modified",
        "additions": 18,
        "deletions": 2,
        "changes": 20,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/418d3230f86f77dde6e817f502baff8a54b707fa/src/validation.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/418d3230f86f77dde6e817f502baff8a54b707fa/src/validation.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/validation.cpp?ref=418d3230f86f77dde6e817f502baff8a54b707fa",
        "patch": "@@ -8,7 +8,6 @@\n #include <arith_uint256.h>\n #include <chain.h>\n #include <chainparams.h>\n-#include <checkpoints.h>\n #include <checkqueue.h>\n #include <consensus/consensus.h>\n #include <consensus/merkle.h>\n@@ -35,6 +34,7 @@\n #include <txdb.h>\n #include <txmempool.h>\n #include <ui_interface.h>\n+#include <uint256.h>\n #include <undo.h>\n #include <util/moneystr.h>\n #include <util/strencodings.h>\n@@ -3196,6 +3196,22 @@ std::vector<unsigned char> GenerateCoinbaseCommitment(CBlock& block, const CBloc\n     return commitment;\n }\n \n+//! Returns last CBlockIndex* that is a checkpoint\n+static CBlockIndex* GetLastCheckpoint(const CCheckpointData& data)\n+{\n+    const MapCheckpoints& checkpoints = data.mapCheckpoints;\n+\n+    for (const MapCheckpoints::value_type& i : reverse_iterate(checkpoints))\n+    {\n+        const uint256& hash = i.second;\n+        CBlockIndex* pindex = LookupBlockIndex(hash);\n+        if (pindex) {\n+            return pindex;\n+        }\n+    }\n+    return nullptr;\n+}\n+\n /** Context-dependent validity checks.\n  *  By \"context\", we mean only the previous block headers, but not the UTXO\n  *  set; UTXO-related validity checks are done in ConnectBlock().\n@@ -3220,7 +3236,7 @@ static bool ContextualCheckBlockHeader(const CBlockHeader& block, CValidationSta\n         // Don't accept any forks from the main chain prior to last checkpoint.\n         // GetLastCheckpoint finds the last checkpoint in MapCheckpoints that's in our\n         // MapBlockIndex.\n-        CBlockIndex* pcheckpoint = Checkpoints::GetLastCheckpoint(params.Checkpoints());\n+        CBlockIndex* pcheckpoint = GetLastCheckpoint(params.Checkpoints());\n         if (pcheckpoint && nHeight < pcheckpoint->nHeight)\n             return state.DoS(100, error(\"%s: forked chain older than last checkpoint (height %d)\", __func__, nHeight), REJECT_CHECKPOINT, \"bad-fork-prior-to-checkpoint\");\n     }"
      },
      {
        "sha": "2723590f5e1c4bc8a39c298dd374296bd462f9ca",
        "filename": "src/wallet/wallet.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/418d3230f86f77dde6e817f502baff8a54b707fa/src/wallet/wallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/418d3230f86f77dde6e817f502baff8a54b707fa/src/wallet/wallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/wallet.cpp?ref=418d3230f86f77dde6e817f502baff8a54b707fa",
        "patch": "@@ -5,7 +5,6 @@\n \n #include <wallet/wallet.h>\n \n-#include <checkpoints.h>\n #include <chain.h>\n #include <wallet/coincontrol.h>\n #include <consensus/consensus.h>"
      },
      {
        "sha": "2b3a61cfbabc24186147a3a97f00b8fe4ce9ecf0",
        "filename": "test/lint/lint-circular-dependencies.sh",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/418d3230f86f77dde6e817f502baff8a54b707fa/test/lint/lint-circular-dependencies.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/418d3230f86f77dde6e817f502baff8a54b707fa/test/lint/lint-circular-dependencies.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/lint/lint-circular-dependencies.sh?ref=418d3230f86f77dde6e817f502baff8a54b707fa",
        "patch": "@@ -10,7 +10,6 @@ export LC_ALL=C\n \n EXPECTED_CIRCULAR_DEPENDENCIES=(\n     \"chainparamsbase -> util/system -> chainparamsbase\"\n-    \"checkpoints -> validation -> checkpoints\"\n     \"index/txindex -> validation -> index/txindex\"\n     \"policy/fees -> txmempool -> policy/fees\"\n     \"policy/policy -> validation -> policy/policy\""
      }
    ]
  }
]