[
  {
    "sha": "bd943d195903edcb8a4464eeed22871326e42be8",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiZDk0M2QxOTU5MDNlZGNiOGE0NDY0ZWVlZDIyODcxMzI2ZTQyYmU4",
    "commit": {
      "author": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2020-12-22T05:17:36Z"
      },
      "committer": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2020-12-22T05:23:42Z"
      },
      "message": "Add patch to make codesign_allocate compatible with Apple's\n\nGithub-Pull: #20644\nRebased-From: a4118c6\n\nCo-authored-by: Pieter Wuille <pieter@wuille.net>",
      "tree": {
        "sha": "f93aedd9b1ad8d756fa481e6baf82b558fe531be",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f93aedd9b1ad8d756fa481e6baf82b558fe531be"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bd943d195903edcb8a4464eeed22871326e42be8",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz7FuIclQ9n+pXlWPLuufXMCVJsEFAl/hgt4ACgkQLuufXMCV\nJsEvwBAAvdmC/YWpvj4ARGJsrVrKa8rDJwA1/I5Ek7EREq0hxvDYBSpFJ3YI1SWq\nWKH7eRdjjJ1jU24s/HeSAsYudslNLCd8Oe2DMrVejOSspmDMDL3tXgZXsJdXNdX6\nG4XQiqUYJDFh63DFkSRfIfJgx9POJc5jCP299LN32ZU5gIdIJIL5axLpb8ZB9SFh\nHKY63g+FsucKz6RNzKhMaqA9VeWpBVjD6ad9ew7mmMZ+r/QTtVytNo6nUSlOAAPB\nwS8/jeAlEwQKfgWJKcObIIlFlf1+gh5tY+fX7z0d+tVY7cmAibRNIG5ieMC9vBR1\nRa/DeCcvoFGSB+j+ALVtkSOjZfvnDW52JKhyNpr/QccadRTceAWO1CNc398kbJrU\nDj59Isand0xVGRTVWyXZWWg28l9yATU/kxZOI26KlB3IzaFHfgsUCOp2OF+elTdc\nsFkHfdJZsgCqzPlTf6wRVNfDMpCUjVjxW+MR8Qj4ZhtQZzyYJMv8c0qCu476x7BH\nTx4aTW1BOAnWFdcykKgIKcH9YWlMefY1Nu+/i6BnFfNTy3HaYiST4+3qoStksv4D\naVOY59D0UOVI4RibH/XQbI+UnYoPch1R3/YYWSzQm1+nctnKyP0DzyhZbXBm0aLU\n3qz/hZDW6f0HgYhybCFe5JbN+tDJJTsRd0arWp50p0fyh7Ommg0=\n=32Lg\n-----END PGP SIGNATURE-----",
        "payload": "tree f93aedd9b1ad8d756fa481e6baf82b558fe531be\nparent e301a9fde3513c24ef9e77fa7c2864f993ef871e\nauthor fanquake <fanquake@gmail.com> 1608614256 +0800\ncommitter fanquake <fanquake@gmail.com> 1608614622 +0800\n\nAdd patch to make codesign_allocate compatible with Apple's\n\nGithub-Pull: #20644\nRebased-From: a4118c6\n\nCo-authored-by: Pieter Wuille <pieter@wuille.net>\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bd943d195903edcb8a4464eeed22871326e42be8",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/bd943d195903edcb8a4464eeed22871326e42be8",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bd943d195903edcb8a4464eeed22871326e42be8/comments",
    "author": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "e301a9fde3513c24ef9e77fa7c2864f993ef871e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e301a9fde3513c24ef9e77fa7c2864f993ef871e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/e301a9fde3513c24ef9e77fa7c2864f993ef871e"
      }
    ],
    "stats": {
      "total": 31,
      "additions": 30,
      "deletions": 1
    },
    "files": [
      {
        "sha": "4b1f4f435f4265a9c6151495e3373bde38d1cc02",
        "filename": "depends/packages/native_cctools.mk",
        "status": "modified",
        "additions": 3,
        "deletions": 1,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bd943d195903edcb8a4464eeed22871326e42be8/depends/packages/native_cctools.mk",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bd943d195903edcb8a4464eeed22871326e42be8/depends/packages/native_cctools.mk",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/packages/native_cctools.mk?ref=bd943d195903edcb8a4464eeed22871326e42be8",
        "patch": "@@ -5,6 +5,7 @@ $(package)_file_name=$($(package)_version).tar.gz\n $(package)_sha256_hash=a09c9ba4684670a0375e42d9d67e7f12c1f62581a27f28f7c825d6d7032ccc6a\n $(package)_build_subdir=cctools\n $(package)_clang_version=3.7.1\n+$(package)_patches=segalign.patch\n $(package)_clang_download_path=https://llvm.org/releases/$($(package)_clang_version)\n $(package)_clang_download_file=clang+llvm-$($(package)_clang_version)-x86_64-linux-gnu-ubuntu-14.04.tar.xz\n $(package)_clang_file_name=clang-llvm-$($(package)_clang_version)-x86_64-linux-gnu-ubuntu-14.04.tar.xz\n@@ -39,7 +40,8 @@ endef\n \n define $(package)_preprocess_cmds\n   cd $($(package)_build_subdir); ./autogen.sh && \\\n-  sed -i.old \"/define HAVE_PTHREADS/d\" ld64/src/ld/InputFiles.h\n+  sed -i.old \"/define HAVE_PTHREADS/d\" ld64/src/ld/InputFiles.h && \\\n+  patch -p1 < $($(package)_patch_dir)/segalign.patch\n endef\n \n define $(package)_config_cmds"
      },
      {
        "sha": "40c5c97cb75395f4f6b32c285dc303c1f41502d3",
        "filename": "depends/patches/native_cctools/segalign.patch",
        "status": "added",
        "additions": 27,
        "deletions": 0,
        "changes": 27,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bd943d195903edcb8a4464eeed22871326e42be8/depends/patches/native_cctools/segalign.patch",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bd943d195903edcb8a4464eeed22871326e42be8/depends/patches/native_cctools/segalign.patch",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/patches/native_cctools/segalign.patch?ref=bd943d195903edcb8a4464eeed22871326e42be8",
        "patch": "@@ -0,0 +1,27 @@\n+commit b46a0ecd324b0536ed7ac709626d8b446a0d5c01\n+Author: fanquake <fanquake@gmail.com>\n+Date:   Tue Dec 22 13:10:54 2020 +0800\n+\n+    Make cctools_port's codesign_allocate compatible with Apple's\n+    \n+    This is a backport of the cctools patch added in #20644 (a4118c6)\n+    that is compatible with the older version of cctools (877.8) used\n+    in the 0.19 branch.\n+\n+diff --git a/libstuff/arch.c b/libstuff/arch.c\n+index e43c240..3262af8 100644\n+--- a/libstuff/arch.c\n++++ b/libstuff/arch.c\n+@@ -328,9 +328,10 @@ const struct arch_flag *flag)\n+ \tif(flag->cputype == CPU_TYPE_POWERPC ||\n+ \t   flag->cputype == CPU_TYPE_POWERPC64 ||\n+ \t   flag->cputype == CPU_TYPE_VEO ||\n+-\t   flag->cputype == CPU_TYPE_I386 ||\n+-\t   flag->cputype == CPU_TYPE_X86_64)\n++\t   flag->cputype == CPU_TYPE_I386)\n+ \t    return(0x1000); /* 4K */\n++        /* CPU_TYPE_X86_64 used to be 0x1000; */\n++        /* Changed to 0x2000 to match Apple's distributed codesign_allocate. */\n+ \telse\n+ \t    return(0x2000); /* 8K */\n+ }"
      }
    ]
  }
]