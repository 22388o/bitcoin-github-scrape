[
  {
    "sha": "3af6f058a86a70c6afe121f143f8e68779e0b081",
    "node_id": "C_kwDOABII59oAKDNhZjZmMDU4YTg2YTcwYzZhZmUxMjFmMTQzZjhlNjg3NzllMGIwODE",
    "commit": {
      "author": {
        "name": "Kambiz Asadzadeh",
        "email": "kambiz.ceo@gmail.com",
        "date": "2021-12-02T13:33:15Z"
      },
      "committer": {
        "name": "Kambiz Asadzadeh",
        "email": "kambiz.ceo@gmail.com",
        "date": "2021-12-02T13:33:15Z"
      },
      "message": "Added some safety features from permissions.\n\nUsers can now view the permissions requests themselves.",
      "tree": {
        "sha": "801f8bb431657ec12029841677c003200951dadc",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/801f8bb431657ec12029841677c003200951dadc"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3af6f058a86a70c6afe121f143f8e68779e0b081",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3af6f058a86a70c6afe121f143f8e68779e0b081",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/3af6f058a86a70c6afe121f143f8e68779e0b081",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3af6f058a86a70c6afe121f143f8e68779e0b081/comments",
    "author": {
      "login": "KambizAsadzadeh",
      "id": 4066299,
      "node_id": "MDQ6VXNlcjQwNjYyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4066299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/KambizAsadzadeh",
      "html_url": "https://github.com/KambizAsadzadeh",
      "followers_url": "https://api.github.com/users/KambizAsadzadeh/followers",
      "following_url": "https://api.github.com/users/KambizAsadzadeh/following{/other_user}",
      "gists_url": "https://api.github.com/users/KambizAsadzadeh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/KambizAsadzadeh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/KambizAsadzadeh/subscriptions",
      "organizations_url": "https://api.github.com/users/KambizAsadzadeh/orgs",
      "repos_url": "https://api.github.com/users/KambizAsadzadeh/repos",
      "events_url": "https://api.github.com/users/KambizAsadzadeh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/KambizAsadzadeh/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "KambizAsadzadeh",
      "id": 4066299,
      "node_id": "MDQ6VXNlcjQwNjYyOTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4066299?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/KambizAsadzadeh",
      "html_url": "https://github.com/KambizAsadzadeh",
      "followers_url": "https://api.github.com/users/KambizAsadzadeh/followers",
      "following_url": "https://api.github.com/users/KambizAsadzadeh/following{/other_user}",
      "gists_url": "https://api.github.com/users/KambizAsadzadeh/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/KambizAsadzadeh/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/KambizAsadzadeh/subscriptions",
      "organizations_url": "https://api.github.com/users/KambizAsadzadeh/orgs",
      "repos_url": "https://api.github.com/users/KambizAsadzadeh/repos",
      "events_url": "https://api.github.com/users/KambizAsadzadeh/events{/privacy}",
      "received_events_url": "https://api.github.com/users/KambizAsadzadeh/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "0bd7ca9a036ea33397b04cade07d9acc1c31cd30",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0bd7ca9a036ea33397b04cade07d9acc1c31cd30",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/0bd7ca9a036ea33397b04cade07d9acc1c31cd30"
      }
    ],
    "stats": {
      "total": 71,
      "additions": 71,
      "deletions": 0
    },
    "files": [
      {
        "sha": "78f448d6155f29b72cb68075f066e5eb2422a223",
        "filename": "src/qt/android/src/org/bitcoincore/qt/BitcoinQtActivity.java",
        "status": "modified",
        "additions": 62,
        "deletions": 0,
        "changes": 62,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/3af6f058a86a70c6afe121f143f8e68779e0b081/src/qt/android/src/org/bitcoincore/qt/BitcoinQtActivity.java",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/3af6f058a86a70c6afe121f143f8e68779e0b081/src/qt/android/src/org/bitcoincore/qt/BitcoinQtActivity.java",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/android/src/org/bitcoincore/qt/BitcoinQtActivity.java?ref=3af6f058a86a70c6afe121f143f8e68779e0b081",
        "patch": "@@ -10,6 +10,8 @@\n \n public class BitcoinQtActivity extends QtActivity\n {\n+\n+    final private int REQUEST_CODE_ASK_MULTIPLE_PERMISSIONS = 124;\n     @Override\n     public void onCreate(Bundle savedInstanceState)\n     {\n@@ -25,5 +27,65 @@ public void onCreate(Bundle savedInstanceState)\n         }\n \n         super.onCreate(savedInstanceState);\n+\n+        // Marshmallow+ Permission APIs\n+        if (Build.VERSION.SDK_INT >= 23) {\n+             fuckMarshMallow();\n+         }\n+    }\n+\n+@Override\n+public void onRequestPermissionsResult(int requestCode, String[] permissions, int[] grantResults) {\n+    switch (requestCode) {\n+        case REQUEST_CODE_ASK_MULTIPLE_PERMISSIONS: {\n+            Map<String, Integer> perms = new HashMap<String, Integer>();\n+            perms.put(Manifest.permission.ACCESS_FINE_LOCATION, PackageManager.PERMISSION_GRANTED);\n+            for (int i = 0; i < permissions.length; i++)\n+                perms.put(permissions[i], grantResults[i]);\n+            if (perms.get(Manifest.permission.ACCESS_FINE_LOCATION) == PackageManager.PERMISSION_GRANTED\n+\n+            ) {\n+                 Toast.makeText(BitcoinQtActivity.this, \"All Permission GRANTED!\", Toast.LENGTH_SHORT).show();\n+            } else {\n+                 Toast.makeText(BitcoinQtActivity.this, \"One or More Permissions are DENIED Exiting App!\", Toast.LENGTH_SHORT).show();\n+                 finish();\n+            }\n+        }\n+        break;\n+        default:\n+            super.onRequestPermissionsResult(requestCode, permissions, grantResults);\n     }\n }\n+\n+@TargetApi(Build.VERSION_CODES.M)\n+private void fuckMarshMallow() {\n+    List<String> permissionsNeeded = new ArrayList<String>();\n+    final List<String> permissionsList = new ArrayList<String>();\n+    if (!addPermission(permissionsList, Manifest.permission.ACCESS_FINE_LOCATION))\n+        permissionsNeeded.add(\"Show Location\");\n+    if (permissionsList.size() > 0) {\n+        if (permissionsNeeded.size() > 0) {\n+            String message = \"App need access to \" + permissionsNeeded.get(0);\n+            for (int i = 1; i < permissionsNeeded.size(); i++)\n+                message = message + \", \" + permissionsNeeded.get(i);\n+            requestPermissions(permissionsList.toArray(new String[permissionsList.size()]),\n+                                    REQUEST_CODE_ASK_MULTIPLE_PERMISSIONS);\n+            return;\n+        }\n+        requestPermissions(permissionsList.toArray(new String[permissionsList.size()]), REQUEST_CODE_ASK_MULTIPLE_PERMISSIONS);\n+        return;\n+    }\n+    Toast.makeText(BitcoinQtActivity.this, \"No new Permission Required - Launching Bitcoin Core.\", Toast.LENGTH_SHORT).show();\n+}\n+\n+@TargetApi(Build.VERSION_CODES.M)\n+private boolean addPermission(List<String> permissionsList, String permission) {\n+    if (checkSelfPermission(permission) != PackageManager.PERMISSION_GRANTED) {\n+        permissionsList.add(permission);\n+        if (!shouldShowRequestPermissionRationale(permission))\n+            return false;\n+    }\n+    return true;\n+}\n+\n+}"
      },
      {
        "sha": "d5718e6eff0106c6ae046d2c459b61148d894ac2",
        "filename": "src/qt/bitcoin.cpp",
        "status": "modified",
        "additions": 9,
        "deletions": 0,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/3af6f058a86a70c6afe121f143f8e68779e0b081/src/qt/bitcoin.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/3af6f058a86a70c6afe121f143f8e68779e0b081/src/qt/bitcoin.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoin.cpp?ref=3af6f058a86a70c6afe121f143f8e68779e0b081",
        "patch": "@@ -486,8 +486,17 @@ int GuiMain(int argc, char* argv[])\n     QApplication::setAttribute(Qt::AA_DontUseNativeMenuBar);\n     QApplication::setAttribute(Qt::AA_DontCreateNativeWidgetSiblings);\n     QApplication::setAttribute(Qt::AA_DontUseNativeDialogs);\n+\n+    // Add new safety native permission dialog for R/W actions.\n+    static const QString write_permission = \"android.permission.WRITE_EXTERNAL_STORAGE\";\n+    if (QtAndroid::checkPermission(write_permission) == QtAndroid::PermissionResult::Denied)\n+        QtAndroid::requestPermissionsSync(QStringList() << write_permission);\n+    static const QString read_permission = \"android.permission.READ_EXTERNAL_STORAGE\";\n+    if (QtAndroid::checkPermission(read_permission) == QtAndroid::PermissionResult::Denied)\n+        QtAndroid::requestPermissionsSync(QStringList() << read_permission);\n #endif\n \n+\n     BitcoinApplication app;\n     GUIUtil::LoadFont(QStringLiteral(\":/fonts/monospace\"));\n "
      }
    ]
  }
]