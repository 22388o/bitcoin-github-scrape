luke-jr,2017-09-15T17:07:14Z,I don't know if this is a good idea. We don't allow wallets to be symlinks or outside the datadir for good reason (they're not self-sufficient files).,https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329841578,329841578,
esotericnonsense,2017-09-15T17:24:26Z,"https://github.com/bitcoin/bitcoin/pull/10885 contains some further information on this.\n\nPreferred option there seems to be allowing a seperate walletdir (that would include bdb state).",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329845701,329845701,
wtogami,2017-09-15T17:39:50Z,FWIW I used my wallet.dat as a symlink to a separate encrypted partition for years now. ,https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329849634,329849634,
gmaxwell,2017-09-15T17:50:12Z,If the wallet.dat is on another filesystem from the database/ directory this will result in corruption in the event of unclean shutoffs.,https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329852815,329852815,
d3zd3z,2017-09-15T18:01:21Z,"So, the argument is that it is better that my wallet be on an unencrypted filesystem than a chance something might get corrupt?",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329855598,329855598,
d3zd3z,2017-09-15T18:06:26Z,"I'm not sure I'm seeing how being on the same filesystem would prevent corruption. In my particular case, though, they are on the same filesystem, but the wallet goes through encfs to an underlying encrypted file on the filesystem.",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329856876,329856876,
TheBlueMatt,2017-09-15T18:08:28Z,"If you want to do this you should instead just put your datadir on your encrypted partition and symlink chainstate/ and blocks/ onto your unencrypted partition. This will leave a few (smaller) files on your encrypted partition, but that should be fine. Worst case if anything blow up the thing you lose is your blocks/chainstate, which you can re-sync, instead of your wallet. This should maybe be no",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329857354,329857354,
isghe,2017-09-15T18:12:08Z,"I think we should suppose that, who is using symbolic links, knows the risks on the way using them.\n\n1. In multi wallet configuration, the risk to load more than one time the same wallet;\n2. The risk that the target file is in another filesystem (as @gmaxwell told before).\n\nAnyway introducing this limitation (rejecting symbolic links) introduce a big incompatibility with previous version",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329858250,329858250,
jnewbery,2017-09-15T18:21:19Z,"> I think we should suppose that, who is using symbolic links, knows the risks on the way using them.\n\nThis isn't a problem with symbolic links per se, it's that it's not safe to use them for the `.dat` file:\n\n- bitcoind can't distinguish whether multiple symlinks refer to the same file\n- it's not safe for the `.dat` file to be stored on a separate file system from the `database` directo",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329861765,329861765,
luke-jr,2017-09-15T18:21:45Z,"Symlinked wallets have never been supported. It was a bug that we didn't error immediately before.\n\nNote that you won't benefit from the encrypted filesystem wrapper in your example either: all the data will be written to the database/ directory before wallet.dat...",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329861916,329861916,
achow101,2017-09-15T18:21:59Z,"> So, the argument is that it is better that my wallet be on an unencrypted filesystem than a chance something might get corrupt?\n\nNo.\n\nThe wallet database creates extra temporary files in the location of where Bitcoin Core thinks your wallet is (i.e. the symlink location). If your wallet is unencrypted (i.e. not using Bitcoin Core's wallet encryption), then those temporary files will be w",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329862019,329862019,
esotericnonsense,2017-09-15T18:23:15Z,"Referencing gmaxwell's comment and jnewbery's above I also agree that allowing a seperate wallet directory that includes both wallet.dat and the BDB logs would be a far better solution. This folder could be specified or symlinked.\n\nluke-jr's comment about the database directory being unencrypted also came up on IRC in a related discussion.\n\nI believe that the relative paths are in wallet/d",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329862530,329862530,
Polve,2017-09-15T18:41:57Z,"> If you want to do this you should instead just put your datadir on your encrypted partition and symlink chainstate/ and blocks/ onto your unencrypted partition\n\nHow this would solve the corruption problems in the event of unclean shutoffs gmax is talking about?",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329867156,329867156,
achow101,2017-09-15T18:48:23Z,"> How this would solve the corruption problems in the event of unclean shutoffs gmax is talking about?\n\nAll of the relevant database files needed for the wallet.dat file would be present in the datadir on the encrypted disk instead of separated on different disks. They would actually be found in the same folder together as they are supposed to be.",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329868661,329868661,
Polve,2017-09-15T19:05:42Z,"> All of the relevant database files needed for the wallet.dat file would be present in the datadir on the encrypted disk instead of separated on different disks\n\nwouldn't this be the same case where only the .dat file is symlinked to another folder/partition?\n(that's my usual use case, like @wtogami, on an encrypted partition)",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329872687,329872687,
achow101,2017-09-15T19:13:21Z,"> wouldn't this be the same case where only the .dat file is symlinked to another folder/partition?\n(that's my usual use case, like @wtogami, on an encrypted partition)\n\nNo it is not. When only the wallet file is symlinked, the wallet database files are created in the Bitcoin Core datadir which contains the symlink. They are not created in the folder containing the actual file itself. When y",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329874563,329874563,
isghe,2017-09-15T20:20:10Z,"My point of view is that who is using symbolic links, knows what it is doing:\n\nI know that:\n\n1.  I am not using multi wallet;\n2. If I will use multi wallet, I'll take care not passing the same files to bitcoin-core;\n3. the original file is not on another file system;\n4. I am not generating dynamically new addresses;\n5. I can lose the original wallet.dat (that's why I make regular b",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329891652,329891652,
jnewbery,2017-09-15T20:42:16Z,"The fact that it is safe for you to use in no way implies that it's safe in general to use. Contributors to this project consider the needs of all users, not just those who are as sophisticated and knowledgeable as you.",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329896455,329896455,
isghe,2017-09-15T20:56:26Z,"@jnewbery didn't you consider that the possible workarounds, a user can adopt, to go over this limitation (rejecting symbolic links), would be more dangerous, than giving to the user the choice to use it or not at his own risk?",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329899358,329899358,
jnewbery,2017-09-15T21:05:57Z,"> didn't you consider...\n\nYes, and my personal judgement is that taking previously undocumented behaviour which could result in loss of funds and turning it into a documented option is irresponsible.",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329902017,329902017,
isghe,2017-09-15T21:28:56Z,"@jnewbery interesting point of view, I'll think on it. Thanks :-)",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329908621,329908621,
achow101,2017-09-15T21:47:03Z,"> My point of view is that who is using symbolic links, knows what it is doing:\n\nBut do you really? Do you know the other BDB temporary files created are not in the same directory as the actual wallet file when you use symbolic links? Those files are actually in your datadir with the symlink, not the actual wallet file. Do you know that by using symbolic links you are at more risk of corruptin",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329911814,329911814,
isghe,2017-09-15T21:52:25Z,"@achow101 I think I wrote very well I am not symlinking to another file system.\n",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329912800,329912800,
achow101,2017-09-15T22:01:21Z,I brought up the file systems thing for others who were talking about encrypted file systems. The other points still stand as they don't depend on other file systems.,https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329914497,329914497,
laanwj,2017-09-16T07:59:51Z,NACK. My preferred approach would be: Wallets should be in their own directory #11348,https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-329953430,329953430,
isghe,2017-09-20T23:48:21Z,"I don't understand why the limitation `no wallet.dat as symbolic link` introduced in v.0.15, is not declared in https://github.com/bitcoin/bitcoin/blob/v0.15.0/doc/release-notes.md\nThanks",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-331011718,331011718,
sipa,2017-09-21T00:02:08Z,"@isghe It's not in the release notes because it was not supported functionality, and I don't think anyone was aware of users relying on this.\n\nIn any case, NACK. This is a footgun. I prefer #11348.",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-331013752,331013752,
MarcoFalke,2017-09-22T09:03:38Z,"This pull points to the wrong branch (we only merge on the master branch). Also, there is disagreement whether this is the right direction.",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-331392927,331392927,
sylvandb,2017-11-15T21:54:31Z,"Symbolic links have nothing to do with specific applications and have been system supported functionality for decades. Bitcoin core intentionally preventing that functionality is EGOCENTRIC, RUDE and as it wasn't documented in the release notes, INCONSIDERATE.\n\nEvery reason cited above in the threads on this topic justifies nothing more than a warning which the user should be free to bypass at",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-344741021,344741021,
MarcoFalke,2017-11-15T22:04:15Z,"If you are happy to accept loss of funds, you are very welcome to remove the `fs::is_symlink(wallet_path)` check in `init.cpp`. After all, this is open source. 🎉 \n",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-344743688,344743688,
ryanofsky,2017-11-15T22:07:27Z,"@sylvandb, we have some changes queued up which should allow more flexibility. I have #11687 and there is also #11466. Right this second I am working on an improvement to #11687 that will actually reallow symlinks and address lukejr's concerns in that PR.",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-344744766,344744766,
ryanofsky,2017-11-15T22:09:50Z,"By the way, I was also surprised that there didn't seem to be a mention of symlink change in the release notes. That does seem like an unfortunate oversight. I wish more prs would update documentation and code together.",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-344745415,344745415,
sylvandb,2017-11-15T22:15:00Z,"@MarcoFalke already done. How do you propose to address my other concern about potential for ""other bombs"" left in the code or the loss of trust caused by hidden, incompatible changes?\n\n@ryanofsky that's good news.\n\nAll, usually I try to leave a constructive idea with a gripe. Sorry for the first post where I forgot to do that, so here it is:\n\nThe correct approach to resolve symlink pr",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-344746669,344746669,
MarcoFalke,2017-11-15T22:19:58Z,"@sylvandb I (and others) are paying close attention to every pull and commit to see if it might break some use case or interface. We will then mention that change not only in the list of changes in the release notes, but also devote a section or short sentence to it. However, there is only a limited amount of people that care about the release notes and oversights happen from time to time. This is",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-344747927,344747927,
MarcoFalke,2017-11-15T22:24:13Z,"Also, when it comes to the wallet it is hard to reason about the different ways people use the wallet. This makes it tedious to review new wallet features, which often ends in rejection of wallet features and limiting the usability. Rather err on the save side, than letting inexperienced users lose funds.",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-344748925,344748925,
isghe,2017-11-16T23:50:31Z,"I merged this patch `-walletallowsymboliclink` to version `v0.15.1` in branch https://github.com/isghe/bitcoin/tree/isghe_0.15.1.\n\nFor my purposes it just works. Anyway take care the risks using symbolic link, not only with bitcoin, but also with a text editor…\n\nThanks, Isidoro",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-345100680,345100680,
luke-jr,2017-11-16T23:55:46Z,There's no comparison. Text files are single standalone files.,https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-345101675,345101675,
isghe,2017-11-17T00:16:28Z,"I don't know any other software inhibiting symbolic links.\nWhy is it necessary in bitcoin, and why it is not described in release note?",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-345105506,345105506,
sipa,2017-11-17T00:23:44Z,"Because Bitcoin Core (BDB) creates temporary database journal files in the same directory as the wallet files. If those database files end up on a different filesystem, and a crash happens, there is no more guarantee the file is in sync with the journals. When people move files around (which often happens) between directories, it's even harder to reason about consistency.\n\nYou're free to use a",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-345106751,345106751,
isghe,2017-11-17T00:37:35Z,"so, please add in release note, something similar to: ""for security reasons we don't allow anymore symbolic links to wallet.dat files""",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-345109087,345109087,
luke-jr,2017-11-17T00:51:00Z,"It was *never* supported, and *never* safe.",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-345111310,345111310,
sipa,2017-11-17T00:52:45Z,"@luke-jr I agree with that, but still it makes sense to communicate that this situation is now detected.",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-345111599,345111599,
sylvandb,2017-11-17T19:56:00Z,"@luke-jr of course it was supported. Not explicitly, but implicitly, likely the same way core supports running on an SSD versus a mechanical hard disk or possibly even an AMD vs. Intel processor.\n\nThere are a lot of relative safety arguments for SSD vs. mechanical, and there are unique failure cases for a symlink vs. real file in the directory.\n\nIn my case, a symlink is safer because it al",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-345349986,345349986,
Polve,2017-11-18T06:33:26Z,My (forced) choice was to not upgrade. ,https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-345422356,345422356,
meshcollider,2017-11-18T07:50:01Z,"@Polve as mentioned above, hopefully the next major release (0.16.0) should support having wallet files outside the data directory (see https://github.com/bitcoin/bitcoin/pull/11466 which is basically ready to merge) in a way which is much safer than symlinking, apologies for the inconvenience caused until then :)",https://github.com/bitcoin/bitcoin/pull/11343#issuecomment-345425612,345425612,
