jonasschnelli,2015-06-29T11:06:12Z,"IMO `bip65-cltv-p2p.py` should be included in extended list in `pull-tester/rpc-tests.sh`. Adding it in the ""normal"" not extended list makes not much sense even if the script execution time is acceptable (<1min on a decent system).\n\nTested ACK.\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-116610191,116610191,
jtimon,2015-06-29T12:24:19Z,"I didn't reviewed the python tests, just the c++ part, but utACK on that part.\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-116635139,116635139,
btcdrak,2015-06-29T12:31:14Z,utACK\n,https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-116637654,116637654,
petertodd,2015-06-29T23:33:43Z,"@jonasschnelli Added the tests to the extended list. I didn't actually know about the pull-tester test list before, thanks!\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-116879195,116879195,
mruddy,2015-07-01T00:55:35Z,"Looks pretty good. Minor todo's with the python test scripts.\n\nNeeds some release notes, but you might have been waiting on those until later in the process. When you get to them, perhaps add a disclaimer that we may change the OP_NOP2 name decode to OP_CHECKLOCKTIMEVERIFY in script ""asm"" outputs in the future. That way we'll have the flexibility to make that change if/when we get to it.\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-117381206,117381206,
petertodd,2015-07-01T21:35:20Z,"So, @mruddy brought up two issues that are really the same as with the BIP66 tests: out of date copyright headers and TODO items that are out of date. The latter issue is pretty simple: bipdersig-p2p.py covers the missing test cases marked as ""TODO"" in bipdersig.py\n\nI wanted to show I've replicated the exact same testing procedure done on BIP66 given that the code changes itself are also replica",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-117831460,117831460,
mruddy,2015-07-02T12:13:01Z,"@petertodd I see what you're saying about trying to keep the diff compares as close and easy as possible. But, the diffs on the tests are necessarily going to be somewhat different. I wouldn't make updated BIP66 test cases part of this change set. My choice would be to make the minor cleanups to these tests so that they are cleaner when reviewed in isolation (and in the future, not within the cont",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-118011482,118011482,
petertodd,2015-07-04T06:16:53Z,"@mruddy Thanks! It'd be awesome for you to do that, and it'd be a good opportunity to have more eyes on the code too of course.\n\nAnyway, I'll see what the other reviewers think re: the tests.\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-118467983,118467983,
mruddy,2015-07-04T18:14:48Z,"I probably will, it's on my todo list.\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-118539749,118539749,
mruddy,2015-08-02T09:48:03Z,"What do we need to do now to move this forward? Is this waiting on coordination with some other work, in need of more testing, or just baking and giving time for more review (it's been about a month since last update)?\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-127008658,127008658,
jtimon,2015-08-04T11:04:07Z,"@mruddy I would say that, as usual, we're just waiting for more review, but IMO the harder-to-review parts have already been merged. I would really like that we move forward on this.\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-127566481,127566481,
petertodd,2015-08-04T11:06:40Z,"I think what's holding this up is a lack of political will to do yet another non-nVersion bits soft-fork upgrade; @gmaxwell has indicated a strong preference for never using IsSuperMajority() again.\n\nOn 4 August 2015 07:04:50 GMT-04:00, ""Jorge Timón"" notifications@github.com wrote:\n\n> @mruddy I would say that, as usual, we're just waiting for more review,\n> but IMO the harder-to-review parts ",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-127566817,127566817,
btcdrak,2015-08-04T16:20:44Z,"It would seem a better plan to deploy this softfork now rather than waiting for nVersionbits code which isnt done yet. We know this method works and it doesnt get in the way of nVersionbits deployment later. Many players in the ecosystem are waiting for CLTV, I dont see why we should wait for perfection when we can deploy a much anticipated feature now. @sipa @gmaxwell @laanwj \n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-127663793,127663793,
jl2012,2015-08-04T17:39:19Z,"Do we have any softfork ready to deploy in the coming 4 months? If no I don't think we need to wait for nVerionbits. I guess BIP62 is not ready yet.\n\nIs there any plan to prevent a fork due to reckless SPV mining?\n\nBy the way, if BIP101 is implemented in Bitcoin XT, blocks will have a version number with bits 1,2,3 and 14 set (0x20000007 in hex). In that case, it is not possible to support BIP",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-127687729,127687729,
btcdrak,2015-08-04T22:44:15Z,"Just for the record, @sipa ACK'd for `IsSuperMajority()` on the [ML](http://lists.linuxfoundation.org/pipermail/bitcoin-dev/2015-August/009913.html)\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-127782626,127782626,
dcousens,2015-08-05T01:29:13Z,> @gmaxwell has indicated a strong preference for never using IsSuperMajority() again.\n\n@gmaxwell can you confirm this?\n,https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-127812882,127812882,
maaku,2015-08-05T16:45:09Z,"@dcousens this pull request shouldn't be held up waiting for a response from someone who has never participated in it.\n\n@jl2012 there is BIP68, and the as-yet unnumbered CHECKSEQUENCEVERIFY and median-lock-time-past BIPs, all of which are related to CHECKTIMELOCKVERIFY and could be rolled out together...\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-128066929,128066929,
jl2012,2015-08-06T13:02:02Z,"@maaku I think we could go with IsSuperMajority(). If BIP68 or other related BIPs are ready before BIP65 is completed, they could be considered as ""addon"" of BIP65. People will use nVersion=5 to support BIP65 and those addon.\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-128355103,128355103,
btcdrak,2015-08-06T22:41:24Z,"@maaku I was thinking the same thing recently that rolling out CLTV and CSV opcodes as one upgrade would be ideal and most efficient but when are you planning to make the PR for CSV?  Seems like the code is there in your fork...\n\nIf this is going to take you a while then in my opinion we should not hold up CLTV, but I think it would be a wasted opportunity not to bundle the features you list as ",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-128530946,128530946,
maaku,2015-08-06T22:50:58Z,"The code is done, ready, tested, deployed to alpha testnet and known to\nwork.\n\nWhat remains to be done is writing a BIP... Assistance is welcome if\nsomeone wants to help speed this along. I'm being pulled in 10 different\ndirections and having trouble allocating the time necessary.\n\nOn Thu, Aug 6, 2015 at 3:42 PM, ฿tcDrak notifications@github.com wrote:\n\n> @maaku https://github.com/maaku I",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-128533656,128533656,
jtimon,2015-08-06T22:58:10Z,+1 to @btcdrak 's thoughts.\n,https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-128534707,128534707,
TheBlueMatt,2015-08-08T16:36:25Z,Concept ACK and +1 to @btcdrak. I'd suggest holding off merging this until either CSV is ready or a week or two before a new release is going to freeze.\n,https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-129005365,129005365,
NicolasDorier,2015-08-13T15:54:13Z,+1 for @btcdrak would be awesome\n,https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-130736262,130736262,
jl2012,2015-08-19T02:41:07Z,"Slush has found the first version 0x20000007 block on the mainnet. So there are only two options left for BIP65: 1. adopt the ""version bit"" BIP; 2. Use IsSuperMajority with vserion>0x20000007\n\nOtherwise, there may be a premature birth of BIP65\n\nIn this case, I don't support IsSuperMajority as it will permanently invalidate a large range of nVersion\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-132426602,132426602,
btcdrak,2015-08-19T02:52:34Z,"@jl2012 You could also mask away bits 1,2,3, and 14 and have an integer comparison with blockversion>=8.\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-132427989,132427989,
jl2012,2015-08-19T03:02:45Z,"@btcdrak I guess masking only bit 14 is enough? So one has to set bits 1,2,3,4 and 14 to support both BIP65 and BIP101? And bit 4 for BIP65 only?\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-132428959,132428959,
btcdrak,2015-08-19T08:10:35Z,"@jl2012  By masking out 1,2,3 and 14 and nVersion=8 can be tested to be `>=4` without wasting a bit for whenever we do adopt versionbits softfork signalling.\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-132485296,132485296,
jgarzik,2015-09-16T13:34:06Z,concept ACK.  Big fan of CLTV and its benefits.\n,https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-140743940,140743940,
dcousens,2015-09-16T15:13:11Z,concept ACK here too.   I have been waiting on this to be merged for a while now.  Anything blocking it? (other than the soft-fork)\n,https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-140772338,140772338,
petertodd,2015-09-16T20:38:04Z,"FWIW currently BIP101/XT's nVersion bits aren't a concern to me, as the adoption is low enough to not trigger accidentally. Also, @gavinandresen confirmed w/ other devs recently that they'll add CLTV support to XT.\n\nIn terms of deployment, this IsSuperMajority() deployment mechanism is well tested and works, and there's no compatibility issue with it and a future nVersion bits deployment. (or su",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-140885379,140885379,
btcdrak,2015-09-16T20:44:12Z,I would prefer to wait for the other locktime PRs to be merged and soft fork them in as a bundle.\n,https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-140889318,140889318,
petertodd,2015-09-16T20:58:37Z,"@btcdrak So basically IMO the advantage of that approach is it results in fewer overall # of soft-forks. Personally I'm kinda ""meh"" on that, but it's a reasonable position to hold.\n\nRe: my schedule, I'm going to try to spend a day or two next week with the other locktime soft-forks and do a code review.\n\nWhat I am a rather dubious about, is waiting until nVersion bits is finished, given that c",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-140892619,140892619,
petertodd,2015-09-16T20:59:06Z,"tl;dr: For deploying CLTV, lets not let perfect be the enemy of good...\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-140892728,140892728,
maaku,2015-09-16T22:35:54Z,"The only outstanding question on the other LT bips is whether there is sufficient justification to save some extra soft-fork bits in the sequence field, which has a somewhat messy solution. I'm available to do what is necessary to get these merged.\n\nOh, and ACK on merging this, version bits or no, but like @btcdrak would prefer the 4 lock time bips were done together.\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-140913187,140913187,
btcdrak,2015-09-16T22:37:47Z,"@petertodd I'm definitely not suggesting to wait for Versionbits proposal. If it's ready before the 0.12 release then of course we should use it, but otherwise we should deploy using IsSuperMajority(). \n\nIdeally we deploy CLTV+CSV(etc), unless they are not ready then we just go with CLTV. Until then, I would defer on merging this.\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-140913590,140913590,
dcousens,2015-09-16T23:19:28Z,"> Ideally we deploy CLTV+CSV(etc), unless they are not ready then we just go with CLTV. Until then, I would defer on merging this.\n\nACK,  but I'd prefer we had a hard time line on this,  say,  if CSV isn't ready by the end of the month, then just push forward with CLTV alone?\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-140923527,140923527,
btcdrak,2015-09-16T23:23:41Z,"@dcousens While I think the locktime PRs are very nearly ready, I believe the right cutoff would be before the feature freeze of 0.12 (which wont be that far off anyway if we're following avg 6 months between major releases). What we really need to do is rally people to review https://github.com/bitcoin/bitcoin/pull/6566, https://github.com/bitcoin/bitcoin/pull/6312 and https://github.com/bitcoin/",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-140924597,140924597,
dcousens,2015-09-16T23:36:59Z,"@btcdrak that sounds like a good plan.  I forgot about the release cycle.\nI've added those PRs to my to-review list, and suspect I'll read through them before the end of the week.\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-140926181,140926181,
maaku,2015-09-17T03:47:20Z,@dcousens be aware that #6312 / BIP 68 has two alternative implementations that are under consideration:\n\nhttps://github.com/bitcoin/bitcoin/pull/6312#issuecomment-135594513\n\n#6564 would have to be correspondingly adjusted. The remaining decision that needs to be made is which of these two branches we move forward with.\n,https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-140961250,140961250,
jtimon,2015-09-17T04:10:20Z,"> @petertodd I'm definitely not suggesting to wait for Versionbits\n> proposal. If it's ready before the 0.12 release then of course we should\n> use it, but otherwise we should deploy using IsSuperMajority().\n> \n> Ideally we deploy CLTV+CSV(etc), unless they are not ready then we just\n> go with CLTV. Until then, I would defer on merging this.\n\nACK this plan.\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-140965228,140965228,
laanwj,2015-09-29T19:54:28Z,"Looks good to me /. utACK\n\nNit: `getblockchaininfo` RPC in `rpcblockchain.cpp` needs to be updated to report this softfork as well, This is a trivial code change, but will allow users to see how far the fork is along.\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-144170193,144170193,
maaku,2015-09-30T16:54:36Z,"NACK as-is. The optics, communication difficulties, and extra work of pulling off multiple lock-time related soft-forks are not being properly considered.\n\n#6312 was proposed three months ago and has seen a good deal of review. The much simpler and less controversial #6564 and #6566 have been open for a month. Together these constitute a complete upgrade to the behavior of lock-time in bitcoin. ",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-144474557,144474557,
jtimon,2015-09-30T18:08:28Z,"@maaku I thought we already had a plan:\n\n1) Merge this before 0.12\n2) If nVersion bits is ready on time, deploy it using nVersion bits.\n3) If the maturity/rcltv/csv BIPs PRs are ready on time, deploy them all as a single softfork.\n\nI believe we still have time to make all these 3 things for 0.12, I hope I'm not too optimistic.\nBut if we are not able to do so, I don't think BIP65 should wait",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-144493980,144493980,
petertodd,2015-09-30T18:26:19Z,"@maaku CLTV is written in such a way as to _not_ change any of the semantics of anything other than OP_NOP2; whether or not CLTV is implemented has no bearing on CSV. Also, the statement ""Together these constitute a complete upgrade to the behavior of lock-time in bitcoin."" is incorrect: the upgrade is to the behavior of nSequence only. The behavior of nLockTime - and hence CLTV - remains unchange",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-144499265,144499265,
maaku,2015-09-30T18:27:57Z,@petertodd I request that you please review #6566.\n,https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-144499685,144499685,
petertodd,2015-09-30T18:35:55Z,"@maaku I have looked at it. Like I say, whether or not CLTV is implemented has no impact on it.\n\nRemember the only thing this pull-req does is enforce CLTV during block validation - code that already exists in git HEAD. CSV is a separate issue. For that matter, the unit tests for CLTV don't even change with any of these proposed changes!\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-144501749,144501749,
btcdrak,2015-09-30T22:03:31Z,"@jtimon Beginning the CLTV softfork now would only speed up CLTV deployment by a couple of months tops, which makes no sense to me if we can get the remaining locktime PRs merged in that same timeframe. But what is clear, is CLTV needs to be ready to go if CSV isnt ready in time. We should discuss this at the next dev meeting.\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-144554965,144554965,
jtimon,2015-09-30T22:23:32Z,@btcdrak I believe it was you who wrote the plan I explain above and I acked that plan https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-140965228\n,https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-144561154,144561154,
petertodd,2015-10-01T15:53:49Z,"@laanwj Re: your nit, I'll fix that once this is merged, because https://github.com/bitcoin/bitcoin/pull/6707#issuecomment-143583019\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-144770158,144770158,
CodeShark,2015-10-07T12:14:28Z,I would like to merge #6747 first as it will make all soft fork deployments easier to review. I'd be happy to rebase this PR to #6747 myself. Otherwise ACK.\n,https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-146178900,146178900,
petertodd,2015-10-07T12:47:36Z,"I'm not sure that #6747 is safe to be honest... It moves a lot of code around in ways that aren't obviously correct. (by the standards of consensus critical code that is)\n\nTo review this pull-req, I'd suggest you follow the instructions in the commit message and verify that it's identical to the BIP66 pull-req; if you find any issues the BIP66 soft-fork would be similarly vulnerable.\n\nOn 7 Oct",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-146186191,146186191,
btcdrak,2015-10-07T12:50:12Z,"> I'm not sure that #6747 is safe to be honest... It moves a lot of code around in ways that aren't obviously correct. (by the standards of consensus critical code that is)\n\nI checked consensus is maintained in #6747 by doing a full blockchain sync from the network on top of careful code review, but I'm not agreeing or disagreeing that #6747 needs to be part of this ISM roll-out.\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-146186988,146186988,
petertodd,2015-10-07T12:52:34Z,"@brcdrak Glad to hear! But again, its a big change... Anyway, I wrote the CLTV enable pull-req the way I did to make it maximally easy to review - if BIP66 was done right, this pull-req is done right.\n\nOn 7 October 2015 14:50:54 CEST, ""฿tcDrak"" notifications@github.com wrote:\n\n> > I'm not sure that #6747 is safe to be honest... It moves a lot of\n> > code around in ways that aren't obviously c",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-146187688,146187688,
sipa,2015-10-07T12:52:34Z,"btcdrak: that's a necessary condition, but by no means a sufficient one. It\nalso has to reject everything the old code rejected.\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-146187689,146187689,
dcousens,2015-10-07T12:57:59Z,>  It also has to reject everything the old code rejected.\n\nHow would that be tested?\n,https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-146189148,146189148,
petertodd,2015-10-07T13:03:32Z,@dcousens With great difficulty.... That's one of the biggest challenges in changing consensus critical code.\n,https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-146190226,146190226,
CodeShark,2015-10-07T14:59:12Z,"@petertodd I created a new PR #6774 and rebased #6747 atop it to make the relevant code changes as explicit as possible.I also added the mechanism for your PR to it without activating it yet so that we're ready to go with BIP65.\n\nIn any case, I don't want this to hold up deploying BIP65 and I understand you patterned it after BIP66. My intention was to make it even easier to compare the two (or ",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-146221480,146221480,
petertodd,2015-10-08T15:38:33Z,Rebased and added BIP65 to getblockchaininfo softforks list.\n,https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-146582083,146582083,
CodeShark,2015-10-09T02:03:13Z,"@petertodd I created a [branch](https://github.com/CodeShark/bitcoin/tree/BIP65_deploy) demonstrating how we will deploy soft forks using #6747. The deployment logic for BIP65 can be conveniently compared side-by-side with that for BIP66, and future soft forks will also be possible to compare in this fashion regardless of whether we use IsSuperMajority or versionbits.\n\ngrep for ""DEPLOY BIP65"" to",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-146736658,146736658,
btcdrak,2015-10-22T20:45:38Z,ACK\n,https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-150351222,150351222,
NicolasDorier,2015-10-24T09:43:02Z,"By making my test, I noticed something odd...\n\n```\n// Now that we know we're comparing apples-to-apples, the\n// comparison is a simple numeric one.\nif(nLockTime > (long)txTo.LockTime)\n    return false;\n```\n\nThis means that if nLockTime == txTo.LockTime, then the script evaluate to true, which made me believe that I can spend ""1000 OP_CLTV"" from exactly block 1000.\n\nHowever, such a trans",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-150779595,150779595,
jl2012,2015-10-24T15:42:02Z,"@NicolasDorier \n\n> So the script ""1000 OP_CLTV"" only pass from block 1001.\n\nIt is consistent with the meaning of nLockTime, i.e. a tx is final only after (not at or before) the nLockTime. ""1000 OP_CLTV"" means the output is spendable after block 1000.\n\n> 1000 OP_CLTV can only be spent from block 1001, even if the script pass at block 1000.\n\nIt is always possible to create a valid script at ",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-150827943,150827943,
NicolasDorier,2015-10-24T17:25:13Z,"> It is consistent with the meaning of nLockTime, i.e. a tx is final only after (not at or before) the nLockTime. ""1000 OP_CLTV"" means the output is spendable after block 1000.\n\nThis is what is not consistent ! ""1000 OP_CLTV"" is currently true if nLockTime is 1000. (1000 included)\n\nWhereas a nLocktime of 1000 at block 1000 is not final as you rightly said "" tx is final only after (not at or be",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-150835755,150835755,
jl2012,2015-10-24T17:37:07Z,"> A consistent behavior would be ""1000 OP_CLTV"" false with a nLockTime of 1000.\n\nIn that case you need a nLockTime of 1001 to spend ""1000 OP_CLTV"", which means unspendable until block 1002.\n\nAnyway, by ""consistent"" I mean:\n1. With ""X OP_CLTV"", an output is spendable after block X.\n2. With nLockTime = X, the tx is valid after block X\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-150836268,150836268,
NicolasDorier,2015-10-25T04:28:31Z,"> 1. With ""X OP_CLTV"", an output is spendable after block X.\n\nNo, with ""X OP_CLTV"" the output is spendable AT block X.\n\n> 1. With nLockTime = X, the tx is valid after block X\n\nYes, in other words nLockTime=X the tx is valid at block X+1.\n\nThis is the inconsistency.\nBecause of 2., it means that X OP_CLTV is spendable at X+1 even if the script returns true at X. This is what is not very coh",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-150891295,150891295,
gmaxwell,2015-10-25T04:59:57Z,"@NicolasDorier it sounds like you are misunderstanding the design of OP_CLTV.  There is no ""return true"" in it.  It is a VERIFY op_code. It checks that the nlocktime field in the transaction agrees with the value on the stack, if it does-- it does nothing. If it does not, it terminates execution. It has no clue about the height of the blockchain, and if it did it would make script execution no lon",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-150891959,150891959,
NicolasDorier,2015-10-25T06:44:04Z,"@gmaxwell I understand that.\nWhat I am saying is that from a script perpective ""X OP_CLTV"" means ""can spend AT and AFTER block X"".\n\nWhile nLockTime=X means ""can broadcast AT and AFTER block X+1"".\n\nBoth of these means that ""X OP_CLTV"" will always been able to me spent at X+1, even if the X OP_CLTV will pass with nLockTime of X.\n\nWell, I don't mind though, if it is the expected behavior, I ha",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-150896879,150896879,
gmaxwell,2015-10-25T06:57:02Z,"@NicolasDorier  CLTV has nothing to do with blocks, X OP_CLTV means is ""this transaction is invalid if X > the transaction's nLocktime field"".  What effect the nlocktime field has is largely a mystery to OP_CLTV.\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-150897700,150897700,
NicolasDorier,2015-10-25T16:24:00Z,"Ok now by thinking about it like you said,\nIf I want to say ""Can spend this output at block X"" then I need to use : \n""X-1 OP_CTLV"" and \nat least nLockTime = X-1 when spending which is coherent. \n\nI was indeed making things more complicated than they needed to be, I'm fine now !\n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-150938709,150938709,
petertodd,2015-10-25T17:36:55Z,"Great!\n\nIf you think there's a way to better explain CLTV in the BIP, pull-reqs welcome.\n\nOn 25 October 2015 12:24:41 GMT-04:00, Nicolas Dorier notifications@github.com wrote:\n\n> Ok now by thinking about it like you said,\n> If I want to say ""Can spend this output at block X"" then I need to use\n> : \n> ""X-1 OP_CTLV"" and \n> at least nLockTime = X-1 when spending which is coherent indeed. \n",https://github.com/bitcoin/bitcoin/pull/6351#issuecomment-150947238,150947238,
mruddy,2015-07-01T00:25:12Z,Line 70 should be: Failed to mine a version=4 block\n,https://github.com/bitcoin/bitcoin/pull/6351#discussion_r33638998,33638998,qa/rpc-tests/bip65-cltv.py
mruddy,2015-07-01T00:44:05Z,"In order to fill out the test for this ""not enforced"" TODO, you'll need to add a testable transaction to the 750th v4 block. As in your other script, you'd want to check that the new CLTV rules are not enforced on the 750th v4 block and that they are enforced on the 751st v4 block.\n",https://github.com/bitcoin/bitcoin/pull/6351#discussion_r33639841,33639841,qa/rpc-tests/bip65-cltv.py
mruddy,2015-07-01T00:47:31Z,"minor nit, just noticed that the copyright header was different in this file than the other\n",https://github.com/bitcoin/bitcoin/pull/6351#discussion_r33639969,33639969,qa/rpc-tests/bip65-cltv-p2p.py
petertodd,2015-07-01T21:30:26Z,Fixed.\n,https://github.com/bitcoin/bitcoin/pull/6351#discussion_r33726919,33726919,qa/rpc-tests/bip65-cltv.py
jtimon,2015-08-04T11:00:41Z,"I still don't know why we wait for 75% to start using a policy rule.\nI would do it from the start but only enforce it as a consensus rule after 95%.\nI don't want to slow this down since it is a general softfork question (even if I'm right it can be solved after this PR), but I haven't been able to find an answer anywhere.\n",https://github.com/bitcoin/bitcoin/pull/6351#discussion_r36176656,36176656,src/main.cpp
sipa,2015-08-04T16:40:55Z,This is not a policy rule.\n,https://github.com/bitcoin/bitcoin/pull/6351#discussion_r36210846,36210846,src/main.cpp
jtimon,2015-08-04T17:41:58Z,"While individual miners apply it but still not enforce it as a consensus rule (ie reject blocks that don't apply it), it is just mining policy.\nWhat am I missing?\n",https://github.com/bitcoin/bitcoin/pull/6351#discussion_r36217886,36217886,src/main.cpp
jtimon,2015-10-15T11:42:34Z,"Seriously, what am I missing here? Why wait for 75% for enforcing the new rule in your own blocks (which by the way you are marking as being version 4)?\n",https://github.com/bitcoin/bitcoin/pull/6351#discussion_r42113494,42113494,src/main.cpp
petertodd,2015-10-16T06:25:15Z,"This code is executed against all blocks, not just blocks you created. If another miner creates a nVersion=4 block with an invalid use of CHECKLOCKTIMEVERIFY if you reject it without a majority of hashing power also rejecting it you'll get forked.\n\nIn fact, it might be a good idea to go the other way and remove the 75% rule, accepting invalid nVersion=4 blocks until 95%\n",https://github.com/bitcoin/bitcoin/pull/6351#discussion_r42212076,42212076,src/main.cpp
jtimon,2015-10-16T11:05:42Z,"Thanks, for some reason I was fixated on this 75% threshold only affecting your own blocks, but this is ConnectBlock so it obviously affects all blocks. Yes, I wouldn't oppose to wait for the 95% here too. But with versionbits this disappears so is probably not worth to discuss this much.\n",https://github.com/bitcoin/bitcoin/pull/6351#discussion_r42231178,42231178,src/main.cpp
petertodd,2015-10-16T12:08:54Z,"Yeah, I probably would have changed it to remove 75% a year ago... but at this stage I think it's harmless to leave in.\n",https://github.com/bitcoin/bitcoin/pull/6351#discussion_r42235492,42235492,src/main.cpp
