[
  {
    "sha": "c8b2e4426b78e63c0e9565688192963331221984",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpjOGIyZTQ0MjZiNzhlNjNjMGU5NTY1Njg4MTkyOTYzMzMxMjIxOTg0",
    "commit": {
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2012-12-04T22:46:30Z"
      },
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2012-12-06T21:04:58Z"
      },
      "message": "Update the block file counter in database when using -reindex\n\nThis problem is like earth (mostly harmless). After/during a\n-reindex, it means the statistics about the last block file\nreported in debug.log are always of blk00000.dat instead of the\nlast file. Apart from that, it means a few more database entries\nneed to be read when finding a file to append to the first time.",
      "tree": {
        "sha": "890188b8ad9c0ee306105e4877f396a9609df7d8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/890188b8ad9c0ee306105e4877f396a9609df7d8"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c8b2e4426b78e63c0e9565688192963331221984",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c8b2e4426b78e63c0e9565688192963331221984",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/c8b2e4426b78e63c0e9565688192963331221984",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c8b2e4426b78e63c0e9565688192963331221984/comments",
    "author": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "d79775a04d6dfc03dfc71d7811375a33e1e5c833",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d79775a04d6dfc03dfc71d7811375a33e1e5c833",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/d79775a04d6dfc03dfc71d7811375a33e1e5c833"
      }
    ],
    "stats": {
      "total": 1,
      "additions": 1,
      "deletions": 0
    },
    "files": [
      {
        "sha": "0e0be2f01ee782f1299a7077f1fd2cb822ebffb2",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/c8b2e4426b78e63c0e9565688192963331221984/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/c8b2e4426b78e63c0e9565688192963331221984/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=c8b2e4426b78e63c0e9565688192963331221984",
        "patch": "@@ -1897,6 +1897,7 @@ bool FindBlockPos(CDiskBlockPos &pos, unsigned int nAddSize, unsigned int nHeigh\n             nLastBlockFile = pos.nFile;\n             infoLastBlockFile.SetNull();\n             pblocktree->ReadBlockFileInfo(nLastBlockFile, infoLastBlockFile);\n+            fUpdatedLast = true;\n         }\n     } else {\n         while (infoLastBlockFile.nSize + nAddSize >= MAX_BLOCKFILE_SIZE) {"
      }
    ]
  },
  {
    "sha": "3fb9b99cca390e8ac5838c03363c46a99396e463",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozZmI5Yjk5Y2NhMzkwZThhYzU4MzhjMDMzNjNjNDZhOTkzOTZlNDYz",
    "commit": {
      "author": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2012-12-04T22:53:26Z"
      },
      "committer": {
        "name": "Pieter Wuille",
        "email": "pieter.wuille@gmail.com",
        "date": "2012-12-06T21:04:59Z"
      },
      "message": "Allow lengthy block reconnections to be interrupted\n\nWhen the coin database is out of date with the block database, the\nbest block in it is automatically switched to. This reconnection\nprocess can take time, so allow it to be interrupted.\n\nThis also stops block connection as soon as shutdown is requested,\nleading to a faster shutdown.",
      "tree": {
        "sha": "5d792804a3a46b72f35e6490cd8247f81395ff76",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5d792804a3a46b72f35e6490cd8247f81395ff76"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3fb9b99cca390e8ac5838c03363c46a99396e463",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3fb9b99cca390e8ac5838c03363c46a99396e463",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/3fb9b99cca390e8ac5838c03363c46a99396e463",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3fb9b99cca390e8ac5838c03363c46a99396e463/comments",
    "author": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "c8b2e4426b78e63c0e9565688192963331221984",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c8b2e4426b78e63c0e9565688192963331221984",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/c8b2e4426b78e63c0e9565688192963331221984"
      }
    ],
    "stats": {
      "total": 19,
      "additions": 11,
      "deletions": 8
    },
    "files": [
      {
        "sha": "b68ca1cf1af790a10e10df99aa6f2c4276cd09c9",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 4,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/3fb9b99cca390e8ac5838c03363c46a99396e463/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/3fb9b99cca390e8ac5838c03363c46a99396e463/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=3fb9b99cca390e8ac5838c03363c46a99396e463",
        "patch": "@@ -345,7 +345,7 @@ void ThreadImport(void *data) {\n     if (fReindex) {\n         CImportingNow imp;\n         int nFile = 0;\n-        while (!fShutdown) {\n+        while (!fRequestShutdown) {\n             CDiskBlockPos pos(nFile, 0);\n             FILE *file = OpenBlockFile(pos, true);\n             if (!file)\n@@ -354,7 +354,7 @@ void ThreadImport(void *data) {\n             LoadExternalBlockFile(file, &pos);\n             nFile++;\n         }\n-        if (!fShutdown) {\n+        if (!fRequestShutdown) {\n             pblocktree->WriteReindexing(false);\n             fReindex = false;\n             printf(\"Reindexing finished\\n\");\n@@ -363,7 +363,7 @@ void ThreadImport(void *data) {\n \n     // hardcoded $DATADIR/bootstrap.dat\n     filesystem::path pathBootstrap = GetDataDir() / \"bootstrap.dat\";\n-    if (filesystem::exists(pathBootstrap) && !fShutdown) {\n+    if (filesystem::exists(pathBootstrap) && !fRequestShutdown) {\n         FILE *file = fopen(pathBootstrap.string().c_str(), \"rb\");\n         if (file) {\n             CImportingNow imp;\n@@ -376,7 +376,7 @@ void ThreadImport(void *data) {\n \n     // -loadblock=\n     BOOST_FOREACH(boost::filesystem::path &path, import->vFiles) {\n-        if (fShutdown)\n+        if (fRequestShutdown)\n             break;\n         FILE *file = fopen(path.string().c_str(), \"rb\");\n         if (file) {"
      },
      {
        "sha": "158c94783c49a9e6681b26758997c19a144c3e80",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 2,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/3fb9b99cca390e8ac5838c03363c46a99396e463/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/3fb9b99cca390e8ac5838c03363c46a99396e463/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=3fb9b99cca390e8ac5838c03363c46a99396e463",
        "patch": "@@ -1240,9 +1240,12 @@ bool ConnectBestBlock() {\n \n             if (pindexTest->pprev == NULL || pindexTest->pnext != NULL) {\n                 reverse(vAttach.begin(), vAttach.end());\n-                BOOST_FOREACH(CBlockIndex *pindexSwitch, vAttach)\n+                BOOST_FOREACH(CBlockIndex *pindexSwitch, vAttach) {\n+                    if (fRequestShutdown)\n+                        break;\n                     if (!SetBestChain(pindexSwitch))\n                         return false;\n+                }\n                 return true;\n             }\n             pindexTest = pindexTest->pprev;\n@@ -2553,7 +2556,7 @@ bool LoadExternalBlockFile(FILE* fileIn, CDiskBlockPos *dbp)\n             }\n         }\n         uint64 nRewind = blkdat.GetPos();\n-        while (blkdat.good() && !blkdat.eof() && !fShutdown) {\n+        while (blkdat.good() && !blkdat.eof() && !fRequestShutdown) {\n             blkdat.SetPos(nRewind);\n             nRewind++; // start one byte further next time, in case of failure\n             blkdat.SetLimit(); // remove former limit"
      },
      {
        "sha": "3cbc6b196bd6c5e027e16913972b303487ebc44a",
        "filename": "src/util.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/3fb9b99cca390e8ac5838c03363c46a99396e463/src/util.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/3fb9b99cca390e8ac5838c03363c46a99396e463/src/util.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util.cpp?ref=3fb9b99cca390e8ac5838c03363c46a99396e463",
        "patch": "@@ -64,7 +64,7 @@ bool fDebug = false;\n bool fDebugNet = false;\n bool fPrintToConsole = false;\n bool fPrintToDebugger = false;\n-bool fRequestShutdown = false;\n+volatile bool fRequestShutdown = false;\n bool fShutdown = false;\n bool fDaemon = false;\n bool fServer = false;"
      },
      {
        "sha": "d8203b58eed1dff55b2de048a74a697b0aad0c38",
        "filename": "src/util.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/3fb9b99cca390e8ac5838c03363c46a99396e463/src/util.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/3fb9b99cca390e8ac5838c03363c46a99396e463/src/util.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util.h?ref=3fb9b99cca390e8ac5838c03363c46a99396e463",
        "patch": "@@ -132,7 +132,7 @@ extern bool fDebug;\n extern bool fDebugNet;\n extern bool fPrintToConsole;\n extern bool fPrintToDebugger;\n-extern bool fRequestShutdown;\n+extern volatile bool fRequestShutdown;\n extern bool fShutdown;\n extern bool fDaemon;\n extern bool fServer;"
      }
    ]
  }
]