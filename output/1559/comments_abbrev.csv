Diapolo,2012-07-05T16:33:35Z,"Thanks for starting the real fix :), before I test it, can you rebase this to be on top of #1478?\n#1778 has an ACK, so to not have any merge conflicts this would be better (the real changes are rather small).\n",https://github.com/bitcoin/bitcoin/pull/1559#issuecomment-6783666,6783666,
laanwj,2012-07-05T16:48:15Z,Code looks good. Haven't tested yet.\n,https://github.com/bitcoin/bitcoin/pull/1559#issuecomment-6784050,6784050,
sje397,2012-07-05T17:08:24Z,@Diapolo - I had already made those same changes :)\n,https://github.com/bitcoin/bitcoin/pull/1559#issuecomment-6784572,6784572,
laanwj,2012-07-06T06:59:35Z,Good idea to only start the timer when there is immature or unconfirmed balance!\n,https://github.com/bitcoin/bitcoin/pull/1559#issuecomment-6798536,6798536,
laanwj,2012-07-07T11:36:59Z,ACK\n,https://github.com/bitcoin/bitcoin/pull/1559#issuecomment-6822383,6822383,
laanwj,2012-07-06T06:48:04Z,"You may want to check for the timer already active here with `isActive` ""If the timer is already running, it will be stopped and restarted."" so the start() postpones it. This is not needed in pollBalangeChanged as you already know that the timer triggered there.\n",https://github.com/bitcoin/bitcoin/pull/1559#discussion_r1111169,1111169,src/qt/walletmodel.cpp
sje397,2012-07-06T06:58:59Z,"The timer is single-shot. I was thinking that the half-second period is pretty fast already...if we get a bunch of transactions at a time, it would make sense to delay wouldn't it?\n",https://github.com/bitcoin/bitcoin/pull/1559#discussion_r1111201,1111201,src/qt/walletmodel.cpp
laanwj,2012-07-06T07:11:35Z,"Every half a second is not fast, even in human terms. I'd prefer the simple semantics of ""if there is outstanding immature (or unconfirmed) balance, poll every half a second"".\n",https://github.com/bitcoin/bitcoin/pull/1559#discussion_r1111233,1111233,src/qt/walletmodel.cpp
sje397,2012-07-06T07:40:56Z,"On second thought, it does call 'checkBalanceChanged' immediately before starting or restarting the timer - so it won't be delayed, but might actually be a bit costly if a bunch of transactions come in very quickly. Perhaps it would be better to remove the call to 'checkBalanceChanged', and remove the condition that is there, and just check 'isActive' like you suggest. I.e.\n\n// checkBalanceChang",https://github.com/bitcoin/bitcoin/pull/1559#discussion_r1111314,1111314,src/qt/walletmodel.cpp
laanwj,2012-07-06T08:00:03Z,"Nah, for simplicity's sake and to prevent problems like this in the future, I prefer balance to be recomputed instantly when a transaction comes in. Some caching also happens inside Bitcoin, so computing the balance is not a very expensive operation. Also remember that transactions can also deduct from the balance, which happens instantly and not after maturing/confirmation.\n\nAlso mind that upda",https://github.com/bitcoin/bitcoin/pull/1559#discussion_r1111368,1111368,src/qt/walletmodel.cpp
sje397,2012-07-06T11:30:00Z,"Ok - so leave it as is? Since 'checkBalanceChanged' is already called for each 'updateTransaction', restarting the timer if it's running seems to be sensible.\n",https://github.com/bitcoin/bitcoin/pull/1559#discussion_r1112149,1112149,src/qt/walletmodel.cpp
laanwj,2012-07-06T12:43:15Z,"Yeah, it's fine...\n",https://github.com/bitcoin/bitcoin/pull/1559#discussion_r1112454,1112454,src/qt/walletmodel.cpp
