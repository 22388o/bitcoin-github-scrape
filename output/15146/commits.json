[
  {
    "sha": "7fb886b1b1110de4c79478ac094e64cdcb81f3c8",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3ZmI4ODZiMWIxMTEwZGU0Yzc5NDc4YWMwOTRlNjRjZGNiODFmM2M4",
    "commit": {
      "author": {
        "name": "Ben Woosley",
        "email": "ben.woosley@gmail.com",
        "date": "2019-03-09T17:32:48Z"
      },
      "committer": {
        "name": "Ben Woosley",
        "email": "ben.woosley@gmail.com",
        "date": "2019-04-14T03:21:02Z"
      },
      "message": "[moveonly] Split glibc sanity_test_fdelt out",
      "tree": {
        "sha": "d8afe112aa9d58e2ae4162f5694bdc8127046311",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d8afe112aa9d58e2ae4162f5694bdc8127046311"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7fb886b1b1110de4c79478ac094e64cdcb81f3c8",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE+XLHXoy4Dim7e8hvTYykuhgECQYFAlyypx4ACgkQTYykuhgE\nCQZJ/w//ZH9Sdstr5pMeHjcjvYv0bAx5V0xoI1WwpqrJJTSxWREblJqAP0c2fhdw\n3XRM683w+JZAKI8IT5FydgZOTaDt6UF7wCbU2yjYI+gWksah0wczavsTvC2ndfDb\nSuP/t2tncWZcZqA3f/NPNtnKoIsgZf2xgQq3mZNMqYC+BP3JaTLzAoKKPwNAvzip\nFvFUCy/fOxT2YJmPfQ/0faRLkW+d5ZH5bnFg37XcH0eQBWb+3izzf3IpaG64CMYT\nojwkCaXNCXdA/nraVdrBO2tayn10czEu75kg9ub0R14thaHLEd2ibpQTJQYk3+6v\nydOzJXoUFTfrpEY9U+rZEaM1MyEyk1DW4Y9yhBqf4CUtEqZmu4NT9pQjIv2jP1sF\nemWml6RRoCeLsS2epg9/1xO5UVsLUZgF+h8Hwe9vuwofqklCfHfO0xNjRujUFr4O\nPKPIX18EPQwVfWD1AcebFkJr/5wlYC3XIwotCYseW+yTvjoUwEOp8yl/73FfHqFx\nAqXWQFPia9oGYQsrtDWpVlflIAZYa+7UiM/0qIXdzSW0ZdzSmqPlycVTQWU6kfRz\nVBLSD/ZKlQfnOQPbI8I0abdx7sL6PHqWltKAxBEsQuFznzYtdmLeDCKsrZO/IBEu\nKHKTej8D3kV0wTdFjKGoxvEok+Kh3X24SLmYdoIXwh8MpSbpmr4=\n=Hr04\n-----END PGP SIGNATURE-----",
        "payload": "tree d8afe112aa9d58e2ae4162f5694bdc8127046311\nparent 66ce95a4340019ed3be8a36a8aeec86e4f0ace85\nauthor Ben Woosley <ben.woosley@gmail.com> 1552152768 -0500\ncommitter Ben Woosley <ben.woosley@gmail.com> 1555212062 -0700\n\n[moveonly] Split glibc sanity_test_fdelt out\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7fb886b1b1110de4c79478ac094e64cdcb81f3c8",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/7fb886b1b1110de4c79478ac094e64cdcb81f3c8",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7fb886b1b1110de4c79478ac094e64cdcb81f3c8/comments",
    "author": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "66ce95a4340019ed3be8a36a8aeec86e4f0ace85",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/66ce95a4340019ed3be8a36a8aeec86e4f0ace85",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/66ce95a4340019ed3be8a36a8aeec86e4f0ace85"
      }
    ],
    "stats": {
      "total": 43,
      "additions": 26,
      "deletions": 17
    },
    "files": [
      {
        "sha": "dc0863f71bdb4590458a5d1177a7e09528a732a1",
        "filename": "src/Makefile.am",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7fb886b1b1110de4c79478ac094e64cdcb81f3c8/src/Makefile.am",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7fb886b1b1110de4c79478ac094e64cdcb81f3c8/src/Makefile.am",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.am?ref=7fb886b1b1110de4c79478ac094e64cdcb81f3c8",
        "patch": "@@ -472,6 +472,7 @@ libbitcoin_util_a_SOURCES = \\\n   support/lockedpool.cpp \\\n   chainparamsbase.cpp \\\n   clientversion.cpp \\\n+  compat/glibc_sanity_fdelt.cpp \\\n   compat/glibc_sanity.cpp \\\n   compat/glibcxx_sanity.cpp \\\n   compat/strnlen.cpp \\"
      },
      {
        "sha": "cc74f28899e914e592ff409b96b62873e8b5807f",
        "filename": "src/compat/glibc_sanity.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 17,
        "changes": 19,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7fb886b1b1110de4c79478ac094e64cdcb81f3c8/src/compat/glibc_sanity.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7fb886b1b1110de4c79478ac094e64cdcb81f3c8/src/compat/glibc_sanity.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/compat/glibc_sanity.cpp?ref=7fb886b1b1110de4c79478ac094e64cdcb81f3c8",
        "patch": "@@ -1,4 +1,4 @@\n-// Copyright (c) 2009-2018 The Bitcoin Core developers\n+// Copyright (c) 2009-2019 The Bitcoin Core developers\n // Distributed under the MIT software license, see the accompanying\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n@@ -9,7 +9,7 @@\n #include <cstddef>\n \n #if defined(HAVE_SYS_SELECT_H)\n-#include <sys/select.h>\n+bool sanity_test_fdelt();\n #endif\n \n extern \"C\" void* memcpy(void* a, const void* b, size_t c);\n@@ -41,21 +41,6 @@ bool sanity_test_memcpy()\n     }\n     return true;\n }\n-\n-#if defined(HAVE_SYS_SELECT_H)\n-// trigger: Call FD_SET to trigger __fdelt_chk. FORTIFY_SOURCE must be defined\n-//   as >0 and optimizations must be set to at least -O2.\n-// test: Add a file descriptor to an empty fd_set. Verify that it has been\n-//   correctly added.\n-bool sanity_test_fdelt()\n-{\n-    fd_set fds;\n-    FD_ZERO(&fds);\n-    FD_SET(0, &fds);\n-    return FD_ISSET(0, &fds);\n-}\n-#endif\n-\n } // namespace\n \n bool glibc_sanity_test()"
      },
      {
        "sha": "13661d3eef68e6dc67a8070a89d8e333eeef84aa",
        "filename": "src/compat/glibc_sanity_fdelt.cpp",
        "status": "added",
        "additions": 23,
        "deletions": 0,
        "changes": 23,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7fb886b1b1110de4c79478ac094e64cdcb81f3c8/src/compat/glibc_sanity_fdelt.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7fb886b1b1110de4c79478ac094e64cdcb81f3c8/src/compat/glibc_sanity_fdelt.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/compat/glibc_sanity_fdelt.cpp?ref=7fb886b1b1110de4c79478ac094e64cdcb81f3c8",
        "patch": "@@ -0,0 +1,23 @@\n+// Copyright (c) 2009-2019 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#if defined(HAVE_CONFIG_H)\n+#include <config/bitcoin-config.h>\n+#endif\n+\n+#if defined(HAVE_SYS_SELECT_H)\n+#include <sys/select.h>\n+\n+// trigger: Call FD_SET to trigger __fdelt_chk. FORTIFY_SOURCE must be defined\n+//   as >0 and optimizations must be set to at least -O2.\n+// test: Add a file descriptor to an empty fd_set. Verify that it has been\n+//   correctly added.\n+bool sanity_test_fdelt()\n+{\n+    fd_set fds;\n+    FD_ZERO(&fds);\n+    FD_SET(0, &fds);\n+    return FD_ISSET(0, &fds);\n+}\n+#endif"
      }
    ]
  },
  {
    "sha": "b4fd0ca9be14c81023db759c405c0f67cfa78166",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiNGZkMGNhOWJlMTRjODEwMjNkYjc1OWM0MDVjMGY2N2NmYTc4MTY2",
    "commit": {
      "author": {
        "name": "Ben Woosley",
        "email": "ben.woosley@gmail.com",
        "date": "2019-03-09T17:37:09Z"
      },
      "committer": {
        "name": "Ben Woosley",
        "email": "ben.woosley@gmail.com",
        "date": "2019-04-14T03:21:02Z"
      },
      "message": "Include cstring for sanity_test_fdelt if required\n\nSmartOS FD_ZERO is implemented in a way that requires\nan external declaration of memcpy. We can not simply\ninclude cstring in the existing file because\nsanity_test_memcpy is attempting to replace memcpy, but we can do\nso here, now that the fdelt test is split out.",
      "tree": {
        "sha": "087c594164ddd6f2d5d96669e4cdc18b1edb67f9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/087c594164ddd6f2d5d96669e4cdc18b1edb67f9"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b4fd0ca9be14c81023db759c405c0f67cfa78166",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEE+XLHXoy4Dim7e8hvTYykuhgECQYFAlyypx4ACgkQTYykuhgE\nCQayQg/8CPhouyxNadWBolBHuoEMHLeJxPGCmU1FaZVjaNOP11iap3774CcJ6yJQ\naGylbBmGSkWZgpIHa05J+KKlvLj1qrDMpn4ZkTUXHn/r/n+UI8JEHIDwMOf7euB0\nlxN3X1DD2FQgnTjtxUyzDxuKmIkJNmEVmy4r5lLGYcoDWHNMWDNZkDsnOuuc0vHv\n3Qr7HLlAMd998VqaP7M1nUVyHQ1fOlxdgt9NmXKQJI8tO0ecfMlgUk4zqnbgtTou\nUuvLms2bQXWMOh6ptWijzCznP46d3SK30BFntQyEf9O6NAPUMOH7Ud3ipbKDp8Cj\nch+KoQR+9oiu5YVTVLp6O3AO4KXKn7YtkxUu+e8C9HUBZYY2C4F3Rr0msTa7zb1i\nGyOQoa7vvX1E/X3UVPmWSGaeUYqa2/yIJ9it5wHIwfkWwBH5RAujApk4Bcz2JuNi\n8QMUqISA5lyB6VZSU3ds0OZdQ9UY+TsXHWyUztfulrVZ4HQujXIocixj0pmu5veO\nKNp5htkGBH5o1LfLItfkCMiPz3rOQybUATnm5o3VVC1M7sCIuMYb78zO9Paygjk4\nmWUbNHdGPdB8urqleWxqYyXYZzvrR1z5aUiO3VbfOwM4K/FlemZILiJyN9qN1L7y\njkaLHc8PQOCVF6SOvD+SSRkiuBz6QI6nWLMj9mLh11XG2PfCJzk=\n=60kw\n-----END PGP SIGNATURE-----",
        "payload": "tree 087c594164ddd6f2d5d96669e4cdc18b1edb67f9\nparent 7fb886b1b1110de4c79478ac094e64cdcb81f3c8\nauthor Ben Woosley <ben.woosley@gmail.com> 1552153029 -0500\ncommitter Ben Woosley <ben.woosley@gmail.com> 1555212062 -0700\n\nInclude cstring for sanity_test_fdelt if required\n\nSmartOS FD_ZERO is implemented in a way that requires\nan external declaration of memcpy. We can not simply\ninclude cstring in the existing file because\nsanity_test_memcpy is attempting to replace memcpy, but we can do\nso here, now that the fdelt test is split out.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b4fd0ca9be14c81023db759c405c0f67cfa78166",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/b4fd0ca9be14c81023db759c405c0f67cfa78166",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b4fd0ca9be14c81023db759c405c0f67cfa78166/comments",
    "author": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "7fb886b1b1110de4c79478ac094e64cdcb81f3c8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7fb886b1b1110de4c79478ac094e64cdcb81f3c8",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/7fb886b1b1110de4c79478ac094e64cdcb81f3c8"
      }
    ],
    "stats": {
      "total": 36,
      "additions": 36,
      "deletions": 0
    },
    "files": [
      {
        "sha": "579aeed49dbe18881842618a93806cc318b27832",
        "filename": "configure.ac",
        "status": "modified",
        "additions": 33,
        "deletions": 0,
        "changes": 33,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b4fd0ca9be14c81023db759c405c0f67cfa78166/configure.ac",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b4fd0ca9be14c81023db759c405c0f67cfa78166/configure.ac",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/configure.ac?ref=b4fd0ca9be14c81023db759c405c0f67cfa78166",
        "patch": "@@ -758,6 +758,39 @@ fi\n \n AC_CHECK_HEADERS([endian.h sys/endian.h byteswap.h stdio.h stdlib.h unistd.h strings.h sys/types.h sys/stat.h sys/select.h sys/prctl.h])\n \n+# FD_ZERO may be dependent on a declaration of memcpy, e.g. in SmartOS\n+# check that it fails to build without memcpy, then that it builds with\n+AC_MSG_CHECKING(FD_ZERO memcpy dependence)\n+AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[\n+    #include <cstddef>\n+    #if HAVE_SYS_SELECT_H\n+    #include <sys/select.h>\n+    #endif\n+  ]],[[\n+    #if HAVE_SYS_SELECT_H\n+    fd_set fds;\n+    FD_ZERO(&fds);\n+    #endif\n+  ]])],\n+  [ AC_MSG_RESULT(no) ],\n+  [\n+      AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[\n+          #include <cstring>\n+          #if HAVE_SYS_SELECT_H\n+          #include <sys/select.h>\n+          #endif\n+        ]], [[\n+          #if HAVE_SYS_SELECT_H\n+          fd_set fds;\n+          FD_ZERO(&fds);\n+          #endif\n+        ]])],\n+        [ AC_MSG_RESULT(yes); AC_DEFINE(HAVE_CSTRING_DEPENDENT_FD_ZERO, 1, [Define this symbol if FD_ZERO is dependent of a memcpy declaration being available]) ],\n+        [ AC_MSG_ERROR(failed with cstring include) ]\n+      )\n+  ]\n+)\n+\n AC_CHECK_DECLS([getifaddrs, freeifaddrs],,,\n     [#include <sys/types.h>\n     #include <ifaddrs.h>]"
      },
      {
        "sha": "87140d0c714dc5c261d678a48ba329d2f68b8643",
        "filename": "src/compat/glibc_sanity_fdelt.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b4fd0ca9be14c81023db759c405c0f67cfa78166/src/compat/glibc_sanity_fdelt.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b4fd0ca9be14c81023db759c405c0f67cfa78166/src/compat/glibc_sanity_fdelt.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/compat/glibc_sanity_fdelt.cpp?ref=b4fd0ca9be14c81023db759c405c0f67cfa78166",
        "patch": "@@ -7,6 +7,9 @@\n #endif\n \n #if defined(HAVE_SYS_SELECT_H)\n+#ifdef HAVE_CSTRING_DEPENDENT_FD_ZERO\n+#include <cstring>\n+#endif\n #include <sys/select.h>\n \n // trigger: Call FD_SET to trigger __fdelt_chk. FORTIFY_SOURCE must be defined"
      }
    ]
  }
]