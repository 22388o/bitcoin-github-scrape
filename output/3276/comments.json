[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/28793347",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/3276#issuecomment-28793347",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/3276",
    "id": 28793347,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NzkzMzQ3",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-11-19T14:24:22Z",
    "updated_at": "2013-11-19T14:24:22Z",
    "author_association": "MEMBER",
    "body": "Code changes look good\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/28793347/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/28943815",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/3276#issuecomment-28943815",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/3276",
    "id": 28943815,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4OTQzODE1",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-11-20T23:34:36Z",
    "updated_at": "2013-11-20T23:34:36Z",
    "author_association": "MEMBER",
    "body": "Rebased to trigger pulltester evaluation.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/28943815/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/28948690",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/3276#issuecomment-28948690",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/3276",
    "id": 28948690,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4OTQ4Njkw",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-11-21T00:53:25Z",
    "updated_at": "2013-11-21T00:53:25Z",
    "author_association": "MEMBER",
    "body": "I missed the should-not-disconnect-localhost behaviour, thanks pulltester!\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/28948690/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/29069119",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/3276#issuecomment-29069119",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/3276",
    "id": 29069119,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5MDY5MTE5",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-11-22T12:32:02Z",
    "updated_at": "2013-11-22T12:32:02Z",
    "author_association": "MEMBER",
    "body": "@gavinandresen @gmaxwell Some ACKs?\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/29069119/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/29375427",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/3276#issuecomment-29375427",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/3276",
    "id": 29375427,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5Mzc1NDI3",
    "user": {
      "login": "mikehearn",
      "id": 971089,
      "node_id": "MDQ6VXNlcjk3MTA4OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/971089?u=f32bbe8d8d0f9e10b1387f0aa582b1ee83b8aac5&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mikehearn",
      "html_url": "https://github.com/mikehearn",
      "followers_url": "https://api.github.com/users/mikehearn/followers",
      "following_url": "https://api.github.com/users/mikehearn/following{/other_user}",
      "gists_url": "https://api.github.com/users/mikehearn/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mikehearn/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mikehearn/subscriptions",
      "organizations_url": "https://api.github.com/users/mikehearn/orgs",
      "repos_url": "https://api.github.com/users/mikehearn/repos",
      "events_url": "https://api.github.com/users/mikehearn/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mikehearn/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-11-27T10:51:29Z",
    "updated_at": "2013-11-27T10:51:29Z",
    "author_association": "CONTRIBUTOR",
    "body": "A lock assertion in State() would be nice, it's hard to see from the diff that it truly is always called with cs_main held. \n\nBut unfortunately it seems that boost locks don't support that :( Perhaps the LOCK macros could be extended to support it.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/29375427/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/29499984",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/3276#issuecomment-29499984",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/3276",
    "id": 29499984,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5NDk5OTg0",
    "user": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?u=db313a954a318b81f5283d34908397d1ea3aeba3&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-11-29T07:23:17Z",
    "updated_at": "2013-11-29T07:23:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "I'm getting core dumps on shutdown with this, because the cs_main CCriticalSection is being globally-destructed on my machine before instance_of_cnetcleanup.\n\nOrder of events at shutdown:\ncs_main deleted\ninstance_of_cnetcleanup deleted:\n  foreach CNode\\* pnode: delete pnode\n  CNode::~CNode : GetNodeSignals().FinalizeNode(this);\n  Signal calls FinalizeNode slot, which tries to LOCK(cs_main) : seg fault.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/29499984/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/30058228",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/3276#issuecomment-30058228",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/3276",
    "id": 30058228,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMDU4MjI4",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-12-07T16:16:05Z",
    "updated_at": "2013-12-07T16:16:05Z",
    "author_association": "MEMBER",
    "body": "It seems there was no UnregisterNodeSignals() called anywhere, which should prevent signals being delivered at global-destruct time. I added one in Shutdown().\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/30058228/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/30082063",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/3276#issuecomment-30082063",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/3276",
    "id": 30082063,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMDgyMDYz",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-12-08T13:56:56Z",
    "updated_at": "2013-12-08T13:56:56Z",
    "author_association": "MEMBER",
    "body": "Rebased and modified NodeId to be a simple sequentially-assigned integer, instead of an encapsulated const CNode*. Reason: simpler, and doesn't risk confusing an old disconnected node with a new one, if they get allocated in the same memory area.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/30082063/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/30082391",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/3276#issuecomment-30082391",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/3276",
    "id": 30082391,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMDgyMzkx",
    "user": {
      "login": "BitcoinPullTester",
      "id": 2110907,
      "node_id": "MDQ6VXNlcjIxMTA5MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2110907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BitcoinPullTester",
      "html_url": "https://github.com/BitcoinPullTester",
      "followers_url": "https://api.github.com/users/BitcoinPullTester/followers",
      "following_url": "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
      "gists_url": "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BitcoinPullTester/subscriptions",
      "organizations_url": "https://api.github.com/users/BitcoinPullTester/orgs",
      "repos_url": "https://api.github.com/users/BitcoinPullTester/repos",
      "events_url": "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BitcoinPullTester/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-12-08T14:15:58Z",
    "updated_at": "2013-12-08T14:15:58Z",
    "author_association": "NONE",
    "body": "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/b2864d2fb35fa85e32c76e111f8900598e0bb69d for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/current/\nContact BlueMatt on freenode if something looks broken.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/30082391/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/30102873",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/3276#issuecomment-30102873",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/3276",
    "id": 30102873,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMTAyODcz",
    "user": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?u=db313a954a318b81f5283d34908397d1ea3aeba3&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-12-09T03:05:43Z",
    "updated_at": "2013-12-09T03:05:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "ACK.\n\nI found another crash-at-shutdown bug, but it has nothing to do with this code.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/30102873/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7827803",
    "pull_request_review_id": null,
    "id": 7827803,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDc4Mjc4MDM=",
    "diff_hunk": "@@ -149,17 +149,64 @@ void SyncWithWallets(const uint256 &hash, const CTransaction &tx, const CBlock *\n // Registration of network node signals.\n //\n \n-int static GetHeight()\n+namespace {\n+// Maintain validation-specific state about nodes, protected by cs_main, instead\n+// by CNode's own locks. This simplifies asynchronous operation, where\n+// processing of incoming data is done after the ProcessMessage call returns,\n+// and we're no longer holding the node's locks.\n+// The CNode* here is only used as an identifier, and should not be dereferenced.\n+struct CNodeState {\n+    int nMisbehavior;\n+    bool fShouldBan;\n+\n+    CNodeState() {\n+        nMisbehavior = 0;\n+        fShouldBan = false;\n+    }\n+};\n+\n+map<const CNode*, CNodeState> mapNodeState;\n+\n+CNodeState *State(const CNode *pnode) {\n+    map<const CNode*, CNodeState>::iterator it = mapNodeState.find(pnode);\n+    if (it == mapNodeState.end())\n+        return NULL;\n+    return &it->second;\n+}\n+\n+int GetHeight()\n {\n     LOCK(cs_main);\n     return chainActive.Height();\n }\n \n+void InitializeNode(const CNode* pnode) {\n+    LOCK(cs_main);\n+    mapNodeState.insert(std::make_pair(pnode, CNodeState()));\n+}\n+\n+void FinalizeNode(const CNode* pnode) {\n+    LOCK(cs_main);\n+    mapNodeState.erase(pnode);\n+}\n+}",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 45,
    "commit_id": "b2864d2fb35fa85e32c76e111f8900598e0bb69d",
    "original_commit_id": "6a14a6e8b5c52211601258eed258cd05c2e7fd46",
    "user": {
      "login": "Diapolo",
      "id": 1419649,
      "node_id": "MDQ6VXNlcjE0MTk2NDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1419649?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Diapolo",
      "html_url": "https://github.com/Diapolo",
      "followers_url": "https://api.github.com/users/Diapolo/followers",
      "following_url": "https://api.github.com/users/Diapolo/following{/other_user}",
      "gists_url": "https://api.github.com/users/Diapolo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Diapolo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Diapolo/subscriptions",
      "organizations_url": "https://api.github.com/users/Diapolo/orgs",
      "repos_url": "https://api.github.com/users/Diapolo/repos",
      "events_url": "https://api.github.com/users/Diapolo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Diapolo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Seems like a dup `}`?\n",
    "created_at": "2013-11-21T16:00:30Z",
    "updated_at": "2013-12-08T13:54:25Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/3276#discussion_r7827803",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/3276",
    "author_association": "NONE",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7827803"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/3276#discussion_r7827803"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/3276"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7827803/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 192,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7830012",
    "pull_request_review_id": null,
    "id": 7830012,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDc4MzAwMTI=",
    "diff_hunk": "@@ -149,17 +149,64 @@ void SyncWithWallets(const uint256 &hash, const CTransaction &tx, const CBlock *\n // Registration of network node signals.\n //\n \n-int static GetHeight()\n+namespace {\n+// Maintain validation-specific state about nodes, protected by cs_main, instead\n+// by CNode's own locks. This simplifies asynchronous operation, where\n+// processing of incoming data is done after the ProcessMessage call returns,\n+// and we're no longer holding the node's locks.\n+// The CNode* here is only used as an identifier, and should not be dereferenced.\n+struct CNodeState {\n+    int nMisbehavior;\n+    bool fShouldBan;\n+\n+    CNodeState() {\n+        nMisbehavior = 0;\n+        fShouldBan = false;\n+    }\n+};\n+\n+map<const CNode*, CNodeState> mapNodeState;\n+\n+CNodeState *State(const CNode *pnode) {\n+    map<const CNode*, CNodeState>::iterator it = mapNodeState.find(pnode);\n+    if (it == mapNodeState.end())\n+        return NULL;\n+    return &it->second;\n+}\n+\n+int GetHeight()\n {\n     LOCK(cs_main);\n     return chainActive.Height();\n }\n \n+void InitializeNode(const CNode* pnode) {\n+    LOCK(cs_main);\n+    mapNodeState.insert(std::make_pair(pnode, CNodeState()));\n+}\n+\n+void FinalizeNode(const CNode* pnode) {\n+    LOCK(cs_main);\n+    mapNodeState.erase(pnode);\n+}\n+}",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 45,
    "commit_id": "b2864d2fb35fa85e32c76e111f8900598e0bb69d",
    "original_commit_id": "6a14a6e8b5c52211601258eed258cd05c2e7fd46",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "No, it's the end of the anonymous namespace.\n",
    "created_at": "2013-11-21T16:56:34Z",
    "updated_at": "2013-12-08T13:54:25Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/3276#discussion_r7830012",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/3276",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7830012"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/3276#discussion_r7830012"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/3276"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7830012/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 192,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7995095",
    "pull_request_review_id": null,
    "id": 7995095,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDc5OTUwOTU=",
    "diff_hunk": "@@ -5,6 +5,7 @@\n \n \n #include \"bitcoinrpc.h\"",
    "path": "src/rpcnet.cpp",
    "position": null,
    "original_position": 3,
    "commit_id": "b2864d2fb35fa85e32c76e111f8900598e0bb69d",
    "original_commit_id": "fed1b52ada9aeb017ba0babcc37188164205762b",
    "user": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Merge conflict fix: replace bitcoinrpc.h include with:\n#include \"rpcserver.h\"\n",
    "created_at": "2013-11-29T05:27:21Z",
    "updated_at": "2013-12-08T13:54:25Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/3276#discussion_r7995095",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/3276",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7995095"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/3276#discussion_r7995095"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/3276"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7995095/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 7,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7995336",
    "pull_request_review_id": null,
    "id": 7995336,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDc5OTUzMzY=",
    "diff_hunk": "@@ -149,17 +149,64 @@ void SyncWithWallets(const uint256 &hash, const CTransaction &tx, const CBlock *\n // Registration of network node signals.\n //\n \n-int static GetHeight()\n+namespace {\n+// Maintain validation-specific state about nodes, protected by cs_main, instead\n+// by CNode's own locks. This simplifies asynchronous operation, where\n+// processing of incoming data is done after the ProcessMessage call returns,\n+// and we're no longer holding the node's locks.\n+// The CNode* here is only used as an identifier, and should not be dereferenced.",
    "path": "src/main.cpp",
    "position": null,
    "original_position": 10,
    "commit_id": "b2864d2fb35fa85e32c76e111f8900598e0bb69d",
    "original_commit_id": "fed1b52ada9aeb017ba0babcc37188164205762b",
    "user": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "If it is just used as an identifier, use void\\* instead of CNode\\* ...\n",
    "created_at": "2013-11-29T05:59:42Z",
    "updated_at": "2013-12-08T13:54:25Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/3276#discussion_r7995336",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/3276",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7995336"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/3276#discussion_r7995336"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/3276"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/7995336/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 157,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/12464124",
    "pull_request_review_id": null,
    "id": 12464124,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyNDY0MTI0",
    "diff_hunk": "@@ -3153,7 +3221,7 @@ bool static ProcessMessage(CNode* pfrom, string strCommand, CDataStream& vRecv)\n     else if (pfrom->nVersion == 0)\n     {\n         // Must have a version message before anything else\n-        pfrom->Misbehaving(1);\n+        Misbehaving(pfrom->GetId(), 1);",
    "path": "src/main.cpp",
    "position": 115,
    "original_position": 115,
    "commit_id": "b2864d2fb35fa85e32c76e111f8900598e0bb69d",
    "original_commit_id": "b2864d2fb35fa85e32c76e111f8900598e0bb69d",
    "user": {
      "login": "rebroad",
      "id": 1530283,
      "node_id": "MDQ6VXNlcjE1MzAyODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1530283?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rebroad",
      "html_url": "https://github.com/rebroad",
      "followers_url": "https://api.github.com/users/rebroad/followers",
      "following_url": "https://api.github.com/users/rebroad/following{/other_user}",
      "gists_url": "https://api.github.com/users/rebroad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rebroad/subscriptions",
      "organizations_url": "https://api.github.com/users/rebroad/orgs",
      "repos_url": "https://api.github.com/users/rebroad/repos",
      "events_url": "https://api.github.com/users/rebroad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rebroad/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Why pfrom->GetId() and not just pfrom->id ?\n",
    "created_at": "2014-05-09T04:38:56Z",
    "updated_at": "2014-05-09T04:38:56Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/3276#discussion_r12464124",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/3276",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/12464124"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/3276#discussion_r12464124"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/3276"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/12464124/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 3224,
    "original_line": 3224,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/12464129",
    "pull_request_review_id": null,
    "id": 12464129,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyNDY0MTI5",
    "diff_hunk": "@@ -326,6 +339,9 @@ class CNode\n \n public:\n \n+    NodeId GetId() const {",
    "path": "src/net.h",
    "position": 96,
    "original_position": 96,
    "commit_id": "b2864d2fb35fa85e32c76e111f8900598e0bb69d",
    "original_commit_id": "b2864d2fb35fa85e32c76e111f8900598e0bb69d",
    "user": {
      "login": "rebroad",
      "id": 1530283,
      "node_id": "MDQ6VXNlcjE1MzAyODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1530283?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rebroad",
      "html_url": "https://github.com/rebroad",
      "followers_url": "https://api.github.com/users/rebroad/followers",
      "following_url": "https://api.github.com/users/rebroad/following{/other_user}",
      "gists_url": "https://api.github.com/users/rebroad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rebroad/subscriptions",
      "organizations_url": "https://api.github.com/users/rebroad/orgs",
      "repos_url": "https://api.github.com/users/rebroad/repos",
      "events_url": "https://api.github.com/users/rebroad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rebroad/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@sipa Why is this function needed please?\n",
    "created_at": "2014-05-09T04:39:50Z",
    "updated_at": "2014-05-09T04:39:50Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/3276#discussion_r12464129",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/3276",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/12464129"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/3276#discussion_r12464129"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/3276"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/12464129/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 342,
    "original_line": 342,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/12469792",
    "pull_request_review_id": null,
    "id": 12469792,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyNDY5Nzky",
    "diff_hunk": "@@ -3153,7 +3221,7 @@ bool static ProcessMessage(CNode* pfrom, string strCommand, CDataStream& vRecv)\n     else if (pfrom->nVersion == 0)\n     {\n         // Must have a version message before anything else\n-        pfrom->Misbehaving(1);\n+        Misbehaving(pfrom->GetId(), 1);",
    "path": "src/main.cpp",
    "position": 115,
    "original_position": 115,
    "commit_id": "b2864d2fb35fa85e32c76e111f8900598e0bb69d",
    "original_commit_id": "b2864d2fb35fa85e32c76e111f8900598e0bb69d",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In sane software design, you don't expose internal state, and use accessor methods like these to query it from the outside. I know the code currently violates it almost everywhere, but that doesn't mean we need to continue that practice.\n",
    "created_at": "2014-05-09T09:57:46Z",
    "updated_at": "2014-05-09T09:57:46Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/3276#discussion_r12469792",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/3276",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/12469792"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/3276#discussion_r12469792"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/3276"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/12469792/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 3224,
    "original_line": 3224,
    "side": "RIGHT"
  }
]