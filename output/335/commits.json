[
  {
    "sha": "551a4ef3720c84ebf426daa92de3667478124a76",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo1NTFhNGVmMzcyMGM4NGViZjQyNmRhYTkyZGUzNjY3NDc4MTI0YTc2",
    "commit": {
      "author": {
        "name": "St\u00e9phane Gimenez",
        "email": "dev@gim.name",
        "date": "2011-06-20T21:29:20Z"
      },
      "committer": {
        "name": "St\u00e9phane Gimenez",
        "email": "dev@gim.name",
        "date": "2011-06-20T21:29:20Z"
      },
      "message": "Add a check for validity of sending addresses (Issue #328).\nThis also fixes the syncrhonization of sending addresses between a\nCWallet and its associated CWalletDB.",
      "tree": {
        "sha": "65945bdbf6b580ba73298287ff87d700450ca802",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/65945bdbf6b580ba73298287ff87d700450ca802"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/551a4ef3720c84ebf426daa92de3667478124a76",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/551a4ef3720c84ebf426daa92de3667478124a76",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/551a4ef3720c84ebf426daa92de3667478124a76",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/551a4ef3720c84ebf426daa92de3667478124a76/comments",
    "author": {
      "login": "sgimenez",
      "id": 858993,
      "node_id": "MDQ6VXNlcjg1ODk5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858993?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sgimenez",
      "html_url": "https://github.com/sgimenez",
      "followers_url": "https://api.github.com/users/sgimenez/followers",
      "following_url": "https://api.github.com/users/sgimenez/following{/other_user}",
      "gists_url": "https://api.github.com/users/sgimenez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sgimenez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sgimenez/subscriptions",
      "organizations_url": "https://api.github.com/users/sgimenez/orgs",
      "repos_url": "https://api.github.com/users/sgimenez/repos",
      "events_url": "https://api.github.com/users/sgimenez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sgimenez/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sgimenez",
      "id": 858993,
      "node_id": "MDQ6VXNlcjg1ODk5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858993?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sgimenez",
      "html_url": "https://github.com/sgimenez",
      "followers_url": "https://api.github.com/users/sgimenez/followers",
      "following_url": "https://api.github.com/users/sgimenez/following{/other_user}",
      "gists_url": "https://api.github.com/users/sgimenez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sgimenez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sgimenez/subscriptions",
      "organizations_url": "https://api.github.com/users/sgimenez/orgs",
      "repos_url": "https://api.github.com/users/sgimenez/repos",
      "events_url": "https://api.github.com/users/sgimenez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sgimenez/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "1179257bfd1d0f7742d57449b37c40c28464f152",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1179257bfd1d0f7742d57449b37c40c28464f152",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/1179257bfd1d0f7742d57449b37c40c28464f152"
      }
    ],
    "stats": {
      "total": 32,
      "additions": 23,
      "deletions": 9
    },
    "files": [
      {
        "sha": "7712fd1a2c7d3af5f48a9a08d3d710b2e434e92b",
        "filename": "src/ui.cpp",
        "status": "modified",
        "additions": 13,
        "deletions": 8,
        "changes": 21,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/551a4ef3720c84ebf426daa92de3667478124a76/src/ui.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/551a4ef3720c84ebf426daa92de3667478124a76/src/ui.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/ui.cpp?ref=551a4ef3720c84ebf426daa92de3667478124a76",
        "patch": "@@ -2479,7 +2479,7 @@ void CAddressBookDialog::OnButtonDelete(wxCommandEvent& event)\n         if (m_listCtrl->GetItemState(nIndex, wxLIST_STATE_SELECTED))\n         {\n             string strAddress = (string)GetItemText(m_listCtrl, nIndex, 1);\n-            CWalletDB(pwalletMain->strWalletFile).EraseName(strAddress);\n+            pwalletMain->DelAddressBookName(strAddress);\n             m_listCtrl->DeleteItem(nIndex);\n         }\n     }\n@@ -2496,13 +2496,18 @@ void CAddressBookDialog::OnButtonCopy(wxCommandEvent& event)\n     }\n }\n \n-bool CAddressBookDialog::CheckIfMine(const string& strAddress, const string& strTitle)\n+bool CAddressBookDialog::CheckSendingAddress(const string& strAddress, const string& strTitle)\n {\n     uint160 hash160;\n-    bool fMine = (AddressToHash160(strAddress, hash160) && mapPubKeys.count(hash160));\n-    if (fMine)\n+    if (!AddressToHash160(strAddress, hash160)) {\n+        wxMessageBox(_(\"Invalid bitcoin address\"), strTitle);\n+        return false;\n+    }\n+    if (mapPubKeys.count(hash160)) {\n         wxMessageBox(_(\"This is one of your own addresses for receiving payments and cannot be entered in the address book.  \"), strTitle);\n-    return fMine;\n+        return false;\n+    }\n+    return true;\n }\n \n void CAddressBookDialog::OnButtonEdit(wxCommandEvent& event)\n@@ -2525,7 +2530,7 @@ void CAddressBookDialog::OnButtonEdit(wxCommandEvent& event)\n             strName = dialog.GetValue1();\n             strAddress = dialog.GetValue2();\n         }\n-        while (CheckIfMine(strAddress, _(\"Edit Address\")));\n+        while (!CheckSendingAddress(strAddress, _(\"Edit Address\")));\n \n     }\n     else if (nPage == RECEIVING)\n@@ -2539,7 +2544,7 @@ void CAddressBookDialog::OnButtonEdit(wxCommandEvent& event)\n \n     // Write back\n     if (strAddress != strAddressOrg)\n-        CWalletDB(pwalletMain->strWalletFile).EraseName(strAddressOrg);\n+        pwalletMain->DelAddressBookName(strAddressOrg);\n     pwalletMain->SetAddressBookName(strAddress, strName);\n     m_listCtrl->SetItem(nIndex, 1, strAddress);\n     m_listCtrl->SetItemText(nIndex, strName);\n@@ -2562,7 +2567,7 @@ void CAddressBookDialog::OnButtonNew(wxCommandEvent& event)\n             strName = dialog.GetValue1();\n             strAddress = dialog.GetValue2();\n         }\n-        while (CheckIfMine(strAddress, _(\"Add Address\")));\n+        while (!CheckSendingAddress(strAddress, _(\"Add Address\")));\n     }\n     else if (nPage == RECEIVING)\n     {"
      },
      {
        "sha": "24162183065449dcb559955c7048d5bbb66ad01c",
        "filename": "src/ui.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/551a4ef3720c84ebf426daa92de3667478124a76/src/ui.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/551a4ef3720c84ebf426daa92de3667478124a76/src/ui.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/ui.h?ref=551a4ef3720c84ebf426daa92de3667478124a76",
        "patch": "@@ -262,7 +262,7 @@ class CAddressBookDialog : public CAddressBookDialogBase\n     wxString GetSelectedAddress();\n     wxString GetSelectedSendingAddress();\n     wxString GetSelectedReceivingAddress();\n-    bool CheckIfMine(const std::string& strAddress, const std::string& strTitle);\n+    bool CheckSendingAddress(const std::string& strAddress, const std::string& strTitle);\n };\n \n "
      },
      {
        "sha": "180cc8558f6fab0ca6a073759feb8e281e38423b",
        "filename": "src/wallet.h",
        "status": "modified",
        "additions": 9,
        "deletions": 0,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/551a4ef3720c84ebf426daa92de3667478124a76/src/wallet.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/551a4ef3720c84ebf426daa92de3667478124a76/src/wallet.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet.h?ref=551a4ef3720c84ebf426daa92de3667478124a76",
        "patch": "@@ -155,9 +155,18 @@ class CWallet : public CKeyStore\n     {\n         if (!fFileBacked)\n             return false;\n+        mapAddressBook[strAddress] = strName;\n         return CWalletDB(strWalletFile).WriteName(strAddress, strName);\n     }\n \n+    bool DelAddressBookName(const std::string& strAddress)\n+    {\n+        if (!fFileBacked)\n+            return false;\n+        mapAddressBook.erase(strAddress);\n+        return CWalletDB(strWalletFile).EraseName(strAddress);\n+    }\n+\n     void UpdatedTransaction(const uint256 &hashTx)\n     {\n         CRITICAL_BLOCK(cs_mapWallet)"
      }
    ]
  },
  {
    "sha": "bb18958efe4ab428f9adb2ff5375261c010e238f",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiYjE4OTU4ZWZlNGFiNDI4ZjlhZGIyZmY1Mzc1MjYxYzAxMGUyMzhm",
    "commit": {
      "author": {
        "name": "St\u00e9phane Gimenez",
        "email": "dev@gim.name",
        "date": "2011-06-20T23:54:57Z"
      },
      "committer": {
        "name": "St\u00e9phane Gimenez",
        "email": "dev@gim.name",
        "date": "2011-06-20T23:54:57Z"
      },
      "message": "Allow Address Book edition in non-file backed CWallets",
      "tree": {
        "sha": "b3e422576e9c9555b60b61400294a2ea61120c82",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b3e422576e9c9555b60b61400294a2ea61120c82"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bb18958efe4ab428f9adb2ff5375261c010e238f",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bb18958efe4ab428f9adb2ff5375261c010e238f",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/bb18958efe4ab428f9adb2ff5375261c010e238f",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bb18958efe4ab428f9adb2ff5375261c010e238f/comments",
    "author": {
      "login": "sgimenez",
      "id": 858993,
      "node_id": "MDQ6VXNlcjg1ODk5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858993?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sgimenez",
      "html_url": "https://github.com/sgimenez",
      "followers_url": "https://api.github.com/users/sgimenez/followers",
      "following_url": "https://api.github.com/users/sgimenez/following{/other_user}",
      "gists_url": "https://api.github.com/users/sgimenez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sgimenez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sgimenez/subscriptions",
      "organizations_url": "https://api.github.com/users/sgimenez/orgs",
      "repos_url": "https://api.github.com/users/sgimenez/repos",
      "events_url": "https://api.github.com/users/sgimenez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sgimenez/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sgimenez",
      "id": 858993,
      "node_id": "MDQ6VXNlcjg1ODk5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858993?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sgimenez",
      "html_url": "https://github.com/sgimenez",
      "followers_url": "https://api.github.com/users/sgimenez/followers",
      "following_url": "https://api.github.com/users/sgimenez/following{/other_user}",
      "gists_url": "https://api.github.com/users/sgimenez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sgimenez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sgimenez/subscriptions",
      "organizations_url": "https://api.github.com/users/sgimenez/orgs",
      "repos_url": "https://api.github.com/users/sgimenez/repos",
      "events_url": "https://api.github.com/users/sgimenez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sgimenez/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "551a4ef3720c84ebf426daa92de3667478124a76",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/551a4ef3720c84ebf426daa92de3667478124a76",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/551a4ef3720c84ebf426daa92de3667478124a76"
      }
    ],
    "stats": {
      "total": 4,
      "additions": 2,
      "deletions": 2
    },
    "files": [
      {
        "sha": "f7df5dd8d5045b57d40a248f709e2120662766d6",
        "filename": "src/wallet.h",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bb18958efe4ab428f9adb2ff5375261c010e238f/src/wallet.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bb18958efe4ab428f9adb2ff5375261c010e238f/src/wallet.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet.h?ref=bb18958efe4ab428f9adb2ff5375261c010e238f",
        "patch": "@@ -153,17 +153,17 @@ class CWallet : public CKeyStore\n \n     bool SetAddressBookName(const std::string& strAddress, const std::string& strName)\n     {\n+        mapAddressBook[strAddress] = strName;\n         if (!fFileBacked)\n             return false;\n-        mapAddressBook[strAddress] = strName;\n         return CWalletDB(strWalletFile).WriteName(strAddress, strName);\n     }\n \n     bool DelAddressBookName(const std::string& strAddress)\n     {\n+        mapAddressBook.erase(strAddress);\n         if (!fFileBacked)\n             return false;\n-        mapAddressBook.erase(strAddress);\n         return CWalletDB(strWalletFile).EraseName(strAddress);\n     }\n "
      }
    ]
  },
  {
    "sha": "f2b6b0747cfa49345c38006923aa2acdba63cbbd",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmMmI2YjA3NDdjZmE0OTM0NWMzODAwNjkyM2FhMmFjZGJhNjNjYmJk",
    "commit": {
      "author": {
        "name": "St\u00e9phane Gimenez",
        "email": "dev@gim.name",
        "date": "2011-06-21T17:05:29Z"
      },
      "committer": {
        "name": "St\u00e9phane Gimenez",
        "email": "dev@gim.name",
        "date": "2011-06-21T17:05:29Z"
      },
      "message": "Update critical sections for Address Book editions",
      "tree": {
        "sha": "b576cbbaac106b39203fbb85d1d1e915a77884c1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b576cbbaac106b39203fbb85d1d1e915a77884c1"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f2b6b0747cfa49345c38006923aa2acdba63cbbd",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f2b6b0747cfa49345c38006923aa2acdba63cbbd",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/f2b6b0747cfa49345c38006923aa2acdba63cbbd",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f2b6b0747cfa49345c38006923aa2acdba63cbbd/comments",
    "author": {
      "login": "sgimenez",
      "id": 858993,
      "node_id": "MDQ6VXNlcjg1ODk5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858993?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sgimenez",
      "html_url": "https://github.com/sgimenez",
      "followers_url": "https://api.github.com/users/sgimenez/followers",
      "following_url": "https://api.github.com/users/sgimenez/following{/other_user}",
      "gists_url": "https://api.github.com/users/sgimenez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sgimenez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sgimenez/subscriptions",
      "organizations_url": "https://api.github.com/users/sgimenez/orgs",
      "repos_url": "https://api.github.com/users/sgimenez/repos",
      "events_url": "https://api.github.com/users/sgimenez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sgimenez/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sgimenez",
      "id": 858993,
      "node_id": "MDQ6VXNlcjg1ODk5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858993?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sgimenez",
      "html_url": "https://github.com/sgimenez",
      "followers_url": "https://api.github.com/users/sgimenez/followers",
      "following_url": "https://api.github.com/users/sgimenez/following{/other_user}",
      "gists_url": "https://api.github.com/users/sgimenez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sgimenez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sgimenez/subscriptions",
      "organizations_url": "https://api.github.com/users/sgimenez/orgs",
      "repos_url": "https://api.github.com/users/sgimenez/repos",
      "events_url": "https://api.github.com/users/sgimenez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sgimenez/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "bb18958efe4ab428f9adb2ff5375261c010e238f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bb18958efe4ab428f9adb2ff5375261c010e238f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/bb18958efe4ab428f9adb2ff5375261c010e238f"
      }
    ],
    "stats": {
      "total": 34,
      "additions": 24,
      "deletions": 10
    },
    "files": [
      {
        "sha": "f2a0db0fc4e3ccd52458b943507ad36957f00b64",
        "filename": "src/rpc.cpp",
        "status": "modified",
        "additions": 8,
        "deletions": 3,
        "changes": 11,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f2b6b0747cfa49345c38006923aa2acdba63cbbd/src/rpc.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f2b6b0747cfa49345c38006923aa2acdba63cbbd/src/rpc.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc.cpp?ref=f2b6b0747cfa49345c38006923aa2acdba63cbbd",
        "patch": "@@ -332,12 +332,15 @@ Value getnewaddress(const Array& params, bool fHelp)\n     // Generate a new key that is added to wallet\n     string strAddress = PubKeyToAddress(pwalletMain->GetKeyFromKeyPool());\n \n-    pwalletMain->SetAddressBookName(strAddress, strAccount);\n+    // This could be done in the same main CS as GetKeyFromKeyPool.\n+    CRITICAL_BLOCK(pwalletMain->cs_mapAddressBook)\n+       pwalletMain->SetAddressBookName(strAddress, strAccount);\n+\n     return strAddress;\n }\n \n \n-// requires cs_main, cs_mapWallet locks\n+// requires cs_main, cs_mapWallet, cs_mapAddressBook locks\n string GetAccountAddress(string strAccount, bool bForceNew=false)\n {\n     string strAddress;\n@@ -393,6 +396,7 @@ Value getaccountaddress(const Array& params, bool fHelp)\n \n     CRITICAL_BLOCK(cs_main)\n     CRITICAL_BLOCK(pwalletMain->cs_mapWallet)\n+    CRITICAL_BLOCK(pwalletMain->cs_mapAddressBook)\n     {\n         ret = GetAccountAddress(strAccount);\n     }\n@@ -431,9 +435,10 @@ Value setaccount(const Array& params, bool fHelp)\n             if (strAddress == GetAccountAddress(strOldAccount))\n                 GetAccountAddress(strOldAccount, true);\n         }\n+\n+        pwalletMain->SetAddressBookName(strAddress, strAccount);\n     }\n \n-    pwalletMain->SetAddressBookName(strAddress, strAccount);\n     return Value::null;\n }\n "
      },
      {
        "sha": "6cc32e7aac7ca0f786ebb6a637163de1ea4c8669",
        "filename": "src/ui.cpp",
        "status": "modified",
        "additions": 14,
        "deletions": 7,
        "changes": 21,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f2b6b0747cfa49345c38006923aa2acdba63cbbd/src/ui.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f2b6b0747cfa49345c38006923aa2acdba63cbbd/src/ui.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/ui.cpp?ref=f2b6b0747cfa49345c38006923aa2acdba63cbbd",
        "patch": "@@ -1186,7 +1186,8 @@ void CMainFrame::OnButtonNew(wxCommandEvent& event)\n     string strAddress = PubKeyToAddress(pwalletMain->GetKeyFromKeyPool());\n \n     // Save\n-    pwalletMain->SetAddressBookName(strAddress, strName);\n+    CRITICAL_BLOCK(pwalletMain->cs_mapAddressBook)\n+        pwalletMain->SetAddressBookName(strAddress, strName);\n     SetDefaultReceivingAddress(strAddress);\n }\n \n@@ -2444,7 +2445,8 @@ void CAddressBookDialog::OnListEndLabelEdit(wxListEvent& event)\n     if (event.IsEditCancelled())\n         return;\n     string strAddress = (string)GetItemText(m_listCtrl, event.GetIndex(), 1);\n-    pwalletMain->SetAddressBookName(strAddress, string(event.GetText()));\n+    CRITICAL_BLOCK(pwalletMain->cs_mapAddressBook)\n+        pwalletMain->SetAddressBookName(strAddress, string(event.GetText()));\n     pframeMain->RefreshListCtrl();\n }\n \n@@ -2479,7 +2481,8 @@ void CAddressBookDialog::OnButtonDelete(wxCommandEvent& event)\n         if (m_listCtrl->GetItemState(nIndex, wxLIST_STATE_SELECTED))\n         {\n             string strAddress = (string)GetItemText(m_listCtrl, nIndex, 1);\n-            pwalletMain->DelAddressBookName(strAddress);\n+            CRITICAL_BLOCK(pwalletMain->cs_mapAddressBook)\n+                pwalletMain->DelAddressBookName(strAddress);\n             m_listCtrl->DeleteItem(nIndex);\n         }\n     }\n@@ -2543,9 +2546,12 @@ void CAddressBookDialog::OnButtonEdit(wxCommandEvent& event)\n     }\n \n     // Write back\n-    if (strAddress != strAddressOrg)\n-        pwalletMain->DelAddressBookName(strAddressOrg);\n-    pwalletMain->SetAddressBookName(strAddress, strName);\n+    CRITICAL_BLOCK(pwalletMain->cs_mapAddressBook)\n+    {\n+        if (strAddress != strAddressOrg)\n+            pwalletMain->DelAddressBookName(strAddressOrg);\n+        pwalletMain->SetAddressBookName(strAddress, strName);\n+    }\n     m_listCtrl->SetItem(nIndex, 1, strAddress);\n     m_listCtrl->SetItemText(nIndex, strName);\n     pframeMain->RefreshListCtrl();\n@@ -2585,7 +2591,8 @@ void CAddressBookDialog::OnButtonNew(wxCommandEvent& event)\n     }\n \n     // Add to list and select it\n-    pwalletMain->SetAddressBookName(strAddress, strName);\n+    CRITICAL_BLOCK(pwalletMain->cs_mapAddressBook)\n+        pwalletMain->SetAddressBookName(strAddress, strName);\n     int nIndex = InsertLine(m_listCtrl, strName, strAddress);\n     SetSelection(m_listCtrl, nIndex);\n     m_listCtrl->SetFocus();"
      },
      {
        "sha": "07d9743cb113403970107e47b17beddfb66ad99f",
        "filename": "src/wallet.h",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f2b6b0747cfa49345c38006923aa2acdba63cbbd/src/wallet.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f2b6b0747cfa49345c38006923aa2acdba63cbbd/src/wallet.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet.h?ref=f2b6b0747cfa49345c38006923aa2acdba63cbbd",
        "patch": "@@ -151,6 +151,7 @@ class CWallet : public CKeyStore\n     bool LoadWallet(bool& fFirstRunRet);\n //    bool BackupWallet(const std::string& strDest);\n \n+    // requires cs_mapAddressBook lock\n     bool SetAddressBookName(const std::string& strAddress, const std::string& strName)\n     {\n         mapAddressBook[strAddress] = strName;\n@@ -159,6 +160,7 @@ class CWallet : public CKeyStore\n         return CWalletDB(strWalletFile).WriteName(strAddress, strName);\n     }\n \n+    // requires cs_mapAddressBook lock\n     bool DelAddressBookName(const std::string& strAddress)\n     {\n         mapAddressBook.erase(strAddress);"
      }
    ]
  },
  {
    "sha": "eca796bee4e188b4fc6995648f790aa860be2c00",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplY2E3OTZiZWU0ZTE4OGI0ZmM2OTk1NjQ4Zjc5MGFhODYwYmUyYzAw",
    "commit": {
      "author": {
        "name": "St\u00e9phane Gimenez",
        "email": "dev@gim.name",
        "date": "2011-06-21T17:06:53Z"
      },
      "committer": {
        "name": "St\u00e9phane Gimenez",
        "email": "dev@gim.name",
        "date": "2011-06-21T17:06:53Z"
      },
      "message": "Avoid propagation of unnecessary updates to CWalletDB",
      "tree": {
        "sha": "c829ec0c334b6f2b2ed160472013ef6aa6b48a79",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c829ec0c334b6f2b2ed160472013ef6aa6b48a79"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/eca796bee4e188b4fc6995648f790aa860be2c00",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/eca796bee4e188b4fc6995648f790aa860be2c00",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/eca796bee4e188b4fc6995648f790aa860be2c00",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/eca796bee4e188b4fc6995648f790aa860be2c00/comments",
    "author": {
      "login": "sgimenez",
      "id": 858993,
      "node_id": "MDQ6VXNlcjg1ODk5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858993?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sgimenez",
      "html_url": "https://github.com/sgimenez",
      "followers_url": "https://api.github.com/users/sgimenez/followers",
      "following_url": "https://api.github.com/users/sgimenez/following{/other_user}",
      "gists_url": "https://api.github.com/users/sgimenez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sgimenez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sgimenez/subscriptions",
      "organizations_url": "https://api.github.com/users/sgimenez/orgs",
      "repos_url": "https://api.github.com/users/sgimenez/repos",
      "events_url": "https://api.github.com/users/sgimenez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sgimenez/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sgimenez",
      "id": 858993,
      "node_id": "MDQ6VXNlcjg1ODk5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858993?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sgimenez",
      "html_url": "https://github.com/sgimenez",
      "followers_url": "https://api.github.com/users/sgimenez/followers",
      "following_url": "https://api.github.com/users/sgimenez/following{/other_user}",
      "gists_url": "https://api.github.com/users/sgimenez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sgimenez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sgimenez/subscriptions",
      "organizations_url": "https://api.github.com/users/sgimenez/orgs",
      "repos_url": "https://api.github.com/users/sgimenez/repos",
      "events_url": "https://api.github.com/users/sgimenez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sgimenez/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "f2b6b0747cfa49345c38006923aa2acdba63cbbd",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f2b6b0747cfa49345c38006923aa2acdba63cbbd",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/f2b6b0747cfa49345c38006923aa2acdba63cbbd"
      }
    ],
    "stats": {
      "total": 4,
      "additions": 4,
      "deletions": 0
    },
    "files": [
      {
        "sha": "71cdbe640115ca3b24375f37b110decc53900d9e",
        "filename": "src/wallet.h",
        "status": "modified",
        "additions": 4,
        "deletions": 0,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/eca796bee4e188b4fc6995648f790aa860be2c00/src/wallet.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/eca796bee4e188b4fc6995648f790aa860be2c00/src/wallet.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet.h?ref=eca796bee4e188b4fc6995648f790aa860be2c00",
        "patch": "@@ -154,6 +154,8 @@ class CWallet : public CKeyStore\n     // requires cs_mapAddressBook lock\n     bool SetAddressBookName(const std::string& strAddress, const std::string& strName)\n     {\n+        if (mapAddressBook[strAddress] == strName)\n+            return false;\n         mapAddressBook[strAddress] = strName;\n         if (!fFileBacked)\n             return false;\n@@ -163,6 +165,8 @@ class CWallet : public CKeyStore\n     // requires cs_mapAddressBook lock\n     bool DelAddressBookName(const std::string& strAddress)\n     {\n+        if (!mapAddressBook.count(strAddress))\n+            return false;\n         mapAddressBook.erase(strAddress);\n         if (!fFileBacked)\n             return false;"
      }
    ]
  },
  {
    "sha": "6d7de046e49838d82976d28f5b0ef4540302ea28",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2ZDdkZTA0NmU0OTgzOGQ4Mjk3NmQyOGY1YjBlZjQ1NDAzMDJlYTI4",
    "commit": {
      "author": {
        "name": "St\u00e9phane Gimenez",
        "email": "dev@gim.name",
        "date": "2011-06-21T17:13:50Z"
      },
      "committer": {
        "name": "St\u00e9phane Gimenez",
        "email": "dev@gim.name",
        "date": "2011-06-21T17:13:50Z"
      },
      "message": "Fix for setaccount related Issue #329",
      "tree": {
        "sha": "1653a866140aba9112e5fe25da3d02ce9023a12d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1653a866140aba9112e5fe25da3d02ce9023a12d"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6d7de046e49838d82976d28f5b0ef4540302ea28",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6d7de046e49838d82976d28f5b0ef4540302ea28",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/6d7de046e49838d82976d28f5b0ef4540302ea28",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6d7de046e49838d82976d28f5b0ef4540302ea28/comments",
    "author": {
      "login": "sgimenez",
      "id": 858993,
      "node_id": "MDQ6VXNlcjg1ODk5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858993?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sgimenez",
      "html_url": "https://github.com/sgimenez",
      "followers_url": "https://api.github.com/users/sgimenez/followers",
      "following_url": "https://api.github.com/users/sgimenez/following{/other_user}",
      "gists_url": "https://api.github.com/users/sgimenez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sgimenez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sgimenez/subscriptions",
      "organizations_url": "https://api.github.com/users/sgimenez/orgs",
      "repos_url": "https://api.github.com/users/sgimenez/repos",
      "events_url": "https://api.github.com/users/sgimenez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sgimenez/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sgimenez",
      "id": 858993,
      "node_id": "MDQ6VXNlcjg1ODk5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858993?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sgimenez",
      "html_url": "https://github.com/sgimenez",
      "followers_url": "https://api.github.com/users/sgimenez/followers",
      "following_url": "https://api.github.com/users/sgimenez/following{/other_user}",
      "gists_url": "https://api.github.com/users/sgimenez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sgimenez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sgimenez/subscriptions",
      "organizations_url": "https://api.github.com/users/sgimenez/orgs",
      "repos_url": "https://api.github.com/users/sgimenez/repos",
      "events_url": "https://api.github.com/users/sgimenez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sgimenez/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "eca796bee4e188b4fc6995648f790aa860be2c00",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/eca796bee4e188b4fc6995648f790aa860be2c00",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/eca796bee4e188b4fc6995648f790aa860be2c00"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 1,
      "deletions": 1
    },
    "files": [
      {
        "sha": "ebc36713f8e40ace33fb9d59fda2b74e5bccf33f",
        "filename": "src/rpc.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6d7de046e49838d82976d28f5b0ef4540302ea28/src/rpc.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6d7de046e49838d82976d28f5b0ef4540302ea28/src/rpc.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc.cpp?ref=6d7de046e49838d82976d28f5b0ef4540302ea28",
        "patch": "@@ -429,7 +429,7 @@ Value setaccount(const Array& params, bool fHelp)\n     CRITICAL_BLOCK(pwalletMain->cs_mapWallet)\n     CRITICAL_BLOCK(pwalletMain->cs_mapAddressBook)\n     {\n-        if (pwalletMain->mapAddressBook.count(strAddress))\n+        if (mapPubKeys.count(hash160))\n         {\n             string strOldAccount = pwalletMain->mapAddressBook[strAddress];\n             if (strAddress == GetAccountAddress(strOldAccount))"
      }
    ]
  },
  {
    "sha": "fe927d5cb0e9946cb39550fd0da7a3d643f6e3f5",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmZTkyN2Q1Y2IwZTk5NDZjYjM5NTUwZmQwZGE3YTNkNjQzZjZlM2Y1",
    "commit": {
      "author": {
        "name": "St\u00e9phane Gimenez",
        "email": "dev@gim.name",
        "date": "2011-06-27T20:09:54Z"
      },
      "committer": {
        "name": "St\u00e9phane Gimenez",
        "email": "dev@gim.name",
        "date": "2011-06-27T20:13:13Z"
      },
      "message": "Extract Address Book code from wallet.h to wallet.cpp",
      "tree": {
        "sha": "51f5c875650ecdc5b4e8c7e8a72b1df03d45a081",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/51f5c875650ecdc5b4e8c7e8a72b1df03d45a081"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fe927d5cb0e9946cb39550fd0da7a3d643f6e3f5",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fe927d5cb0e9946cb39550fd0da7a3d643f6e3f5",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fe927d5cb0e9946cb39550fd0da7a3d643f6e3f5",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fe927d5cb0e9946cb39550fd0da7a3d643f6e3f5/comments",
    "author": {
      "login": "sgimenez",
      "id": 858993,
      "node_id": "MDQ6VXNlcjg1ODk5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858993?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sgimenez",
      "html_url": "https://github.com/sgimenez",
      "followers_url": "https://api.github.com/users/sgimenez/followers",
      "following_url": "https://api.github.com/users/sgimenez/following{/other_user}",
      "gists_url": "https://api.github.com/users/sgimenez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sgimenez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sgimenez/subscriptions",
      "organizations_url": "https://api.github.com/users/sgimenez/orgs",
      "repos_url": "https://api.github.com/users/sgimenez/repos",
      "events_url": "https://api.github.com/users/sgimenez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sgimenez/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sgimenez",
      "id": 858993,
      "node_id": "MDQ6VXNlcjg1ODk5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858993?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sgimenez",
      "html_url": "https://github.com/sgimenez",
      "followers_url": "https://api.github.com/users/sgimenez/followers",
      "following_url": "https://api.github.com/users/sgimenez/following{/other_user}",
      "gists_url": "https://api.github.com/users/sgimenez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sgimenez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sgimenez/subscriptions",
      "organizations_url": "https://api.github.com/users/sgimenez/orgs",
      "repos_url": "https://api.github.com/users/sgimenez/repos",
      "events_url": "https://api.github.com/users/sgimenez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sgimenez/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "6d7de046e49838d82976d28f5b0ef4540302ea28",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6d7de046e49838d82976d28f5b0ef4540302ea28",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/6d7de046e49838d82976d28f5b0ef4540302ea28"
      }
    ],
    "stats": {
      "total": 42,
      "additions": 24,
      "deletions": 18
    },
    "files": [
      {
        "sha": "9c958042999d1770953bc14c5e6332595862a35e",
        "filename": "src/wallet.cpp",
        "status": "modified",
        "additions": 22,
        "deletions": 0,
        "changes": 22,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fe927d5cb0e9946cb39550fd0da7a3d643f6e3f5/src/wallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fe927d5cb0e9946cb39550fd0da7a3d643f6e3f5/src/wallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet.cpp?ref=fe927d5cb0e9946cb39550fd0da7a3d643f6e3f5",
        "patch": "@@ -983,6 +983,28 @@ bool CWallet::LoadWallet(bool& fFirstRunRet)\n     return true;\n }\n \n+\n+bool CWallet::SetAddressBookName(const string& strAddress, const string& strName)\n+{\n+    if (mapAddressBook[strAddress] == strName)\n+        return false;\n+    mapAddressBook[strAddress] = strName;\n+    if (!fFileBacked)\n+        return false;\n+    return CWalletDB(strWalletFile).WriteName(strAddress, strName);\n+}\n+\n+bool CWallet::DelAddressBookName(const string& strAddress)\n+{\n+    if (!mapAddressBook.count(strAddress))\n+        return false;\n+    mapAddressBook.erase(strAddress);\n+    if (!fFileBacked)\n+        return false;\n+    return CWalletDB(strWalletFile).EraseName(strAddress);\n+}\n+\n+\n void CWallet::PrintWallet(const CBlock& block)\n {\n     CRITICAL_BLOCK(cs_mapWallet)"
      },
      {
        "sha": "9f54046ee5ec6a01d3605b7efd16911037100403",
        "filename": "src/wallet.h",
        "status": "modified",
        "additions": 2,
        "deletions": 18,
        "changes": 20,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fe927d5cb0e9946cb39550fd0da7a3d643f6e3f5/src/wallet.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fe927d5cb0e9946cb39550fd0da7a3d643f6e3f5/src/wallet.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet.h?ref=fe927d5cb0e9946cb39550fd0da7a3d643f6e3f5",
        "patch": "@@ -152,26 +152,10 @@ class CWallet : public CKeyStore\n //    bool BackupWallet(const std::string& strDest);\n \n     // requires cs_mapAddressBook lock\n-    bool SetAddressBookName(const std::string& strAddress, const std::string& strName)\n-    {\n-        if (mapAddressBook[strAddress] == strName)\n-            return false;\n-        mapAddressBook[strAddress] = strName;\n-        if (!fFileBacked)\n-            return false;\n-        return CWalletDB(strWalletFile).WriteName(strAddress, strName);\n-    }\n+    bool SetAddressBookName(const std::string& strAddress, const std::string& strName);\n \n     // requires cs_mapAddressBook lock\n-    bool DelAddressBookName(const std::string& strAddress)\n-    {\n-        if (!mapAddressBook.count(strAddress))\n-            return false;\n-        mapAddressBook.erase(strAddress);\n-        if (!fFileBacked)\n-            return false;\n-        return CWalletDB(strWalletFile).EraseName(strAddress);\n-    }\n+    bool DelAddressBookName(const std::string& strAddress);\n \n     void UpdatedTransaction(const uint256 &hashTx)\n     {"
      }
    ]
  },
  {
    "sha": "1d4341bbdb3d55e94c08f519ed689c54deaeb544",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxZDQzNDFiYmRiM2Q1NWU5NGMwOGY1MTllZDY4OWM1NGRlYWViNTQ0",
    "commit": {
      "author": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2011-06-27T20:15:27Z"
      },
      "committer": {
        "name": "St\u00e9phane Gimenez",
        "email": "dev@gim.name",
        "date": "2011-06-27T20:15:27Z"
      },
      "message": "Add wallet methods GetDefaultAddress, SetDefaultAddress",
      "tree": {
        "sha": "25cb32c1ef55dc98abe9f5c3c6a75b7b2aded3c5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/25cb32c1ef55dc98abe9f5c3c6a75b7b2aded3c5"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1d4341bbdb3d55e94c08f519ed689c54deaeb544",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1d4341bbdb3d55e94c08f519ed689c54deaeb544",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/1d4341bbdb3d55e94c08f519ed689c54deaeb544",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1d4341bbdb3d55e94c08f519ed689c54deaeb544/comments",
    "author": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sgimenez",
      "id": 858993,
      "node_id": "MDQ6VXNlcjg1ODk5Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858993?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sgimenez",
      "html_url": "https://github.com/sgimenez",
      "followers_url": "https://api.github.com/users/sgimenez/followers",
      "following_url": "https://api.github.com/users/sgimenez/following{/other_user}",
      "gists_url": "https://api.github.com/users/sgimenez/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sgimenez/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sgimenez/subscriptions",
      "organizations_url": "https://api.github.com/users/sgimenez/orgs",
      "repos_url": "https://api.github.com/users/sgimenez/repos",
      "events_url": "https://api.github.com/users/sgimenez/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sgimenez/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fe927d5cb0e9946cb39550fd0da7a3d643f6e3f5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fe927d5cb0e9946cb39550fd0da7a3d643f6e3f5",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fe927d5cb0e9946cb39550fd0da7a3d643f6e3f5"
      }
    ],
    "stats": {
      "total": 25,
      "additions": 25,
      "deletions": 0
    },
    "files": [
      {
        "sha": "e6a73037c131a977c81c70b758294fa5ead531b4",
        "filename": "src/wallet.cpp",
        "status": "modified",
        "additions": 22,
        "deletions": 0,
        "changes": 22,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1d4341bbdb3d55e94c08f519ed689c54deaeb544/src/wallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1d4341bbdb3d55e94c08f519ed689c54deaeb544/src/wallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet.cpp?ref=1d4341bbdb3d55e94c08f519ed689c54deaeb544",
        "patch": "@@ -1004,6 +1004,28 @@ bool CWallet::DelAddressBookName(const string& strAddress)\n     return CWalletDB(strWalletFile).EraseName(strAddress);\n }\n \n+string CWallet::GetDefaultAddress()\n+{\n+    if (!fFileBacked)\n+        return false;\n+    std::vector<unsigned char> vchPubKey;\n+    if (CWalletDB(strWalletFile, \"r\").ReadDefaultKey(vchPubKey))\n+    {\n+        return PubKeyToAddress(vchPubKey);\n+    }\n+    else\n+        return \"\";\n+}\n+\n+bool CWallet::SetDefaultAddress(const string& strAddress)\n+{\n+    uint160 hash160;\n+    if (!AddressToHash160(strAddress, hash160))\n+        return false;\n+    if (!mapPubKeys.count(hash160))\n+        return false;\n+    return CWalletDB(strWalletFile).WriteDefaultKey(mapPubKeys[hash160]);\n+}\n \n void CWallet::PrintWallet(const CBlock& block)\n {"
      },
      {
        "sha": "137ad4877f232a3e430bcf14456c047047a49403",
        "filename": "src/wallet.h",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1d4341bbdb3d55e94c08f519ed689c54deaeb544/src/wallet.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1d4341bbdb3d55e94c08f519ed689c54deaeb544/src/wallet.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet.h?ref=1d4341bbdb3d55e94c08f519ed689c54deaeb544",
        "patch": "@@ -157,6 +157,9 @@ class CWallet : public CKeyStore\n     // requires cs_mapAddressBook lock\n     bool DelAddressBookName(const std::string& strAddress);\n \n+    std::string GetDefaultAddress();\n+    bool SetDefaultAddress(const std::string& strAddress);\n+\n     void UpdatedTransaction(const uint256 &hashTx)\n     {\n         CRITICAL_BLOCK(cs_mapWallet)"
      }
    ]
  }
]