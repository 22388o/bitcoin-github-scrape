[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/759395959",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20921#issuecomment-759395959",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20921",
    "id": 759395959,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc1OTM5NTk1OQ==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-01-13T11:45:14Z",
    "updated_at": "2021-01-13T11:45:14Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--4a62be1de6b64f3ed646cdc7932c8cf5-->\n\ud83d\udd75\ufe0f @sipa has been requested to review this pull request as specified in the REVIEWERS file.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/759395959/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/776308991",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20921#issuecomment-776308991",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20921",
    "id": 776308991,
    "node_id": "MDEyOklzc3VlQ29tbWVudDc3NjMwODk5MQ==",
    "user": {
      "login": "theStack",
      "id": 91535,
      "node_id": "MDQ6VXNlcjkxNTM1",
      "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theStack",
      "html_url": "https://github.com/theStack",
      "followers_url": "https://api.github.com/users/theStack/followers",
      "following_url": "https://api.github.com/users/theStack/following{/other_user}",
      "gists_url": "https://api.github.com/users/theStack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theStack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
      "organizations_url": "https://api.github.com/users/theStack/orgs",
      "repos_url": "https://api.github.com/users/theStack/repos",
      "events_url": "https://api.github.com/users/theStack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theStack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-02-09T23:16:03Z",
    "updated_at": "2021-02-09T23:16:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ViralTaco: Agree that there should also be a null pointer check on `pindex` before access. Solved this now by adding a simple `assert` (alternatively one could change the parameter to a reference).",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/776308991/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/802483684",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20921#issuecomment-802483684",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20921",
    "id": 802483684,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwMjQ4MzY4NA==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-19T02:24:37Z",
    "updated_at": "2021-03-19T02:24:37Z",
    "author_association": "MEMBER",
    "body": "ACK 787df19b09babf50dd8124b3ac990b29c33cfe93. Tested invalidation of generic on regtest.\r\n\r\nWould be nice to add a functional test that attempts this, so that it gets detected if it were reintroduced.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/802483684/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/803130202",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20921#issuecomment-803130202",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/20921",
    "id": 803130202,
    "node_id": "MDEyOklzc3VlQ29tbWVudDgwMzEzMDIwMg==",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?u=5ff13e375b40ea55ecd3c108337dd6a23f68eddf&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-03-19T21:02:52Z",
    "updated_at": "2021-03-19T21:02:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "Tested ACK 787df19b09babf50dd8124b3ac990b29c33cfe93\r\n\r\nBefore:\r\n\r\n```\r\n$ git checkout master\r\n$ make distclean\r\n$ ./autogen.sh\r\n$ CC=clang CXX=clang++ ./configure --with-sanitizers=address,undefined\r\n$ make\r\n$ src/bitcoind -regtest &\r\n$ src/bitcoin-cli -regtest generatetodescriptor 1 'addr(bcrt1qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq3xueyj)#juyq9d97'\r\n$ src/bitcoin-cli -regtest invalidateblock 0f9188f13cb7b2c71f2a335e3a4fc328bf5beb436012afca590b1a11466e2206\r\n$ src/bitcoin-cli -regtest invalidateblock 0f9188f13cb7b2c71f2a335e3a4fc328bf5beb436012afca590b1a11466e2206\r\nvalidation.cpp:89:30: runtime error: member access within null pointer of type 'const CBlockIndex'\r\n==11604==ERROR: AddressSanitizer: SEGV on unknown address 0x000000000044 (pc 0x56387ee23e87 bp 0x000000000008 sp 0x7f3a6e1b6570 T16)\r\n==11604==The signal is caused by a READ memory access.\r\n==11604==Hint: address points to the zero page.\r\n```\r\n\r\nAfter:\r\n\r\n```\r\n$ gh pr checkout 20921\r\n$ make -C src/ bitcoind\r\n$ src/bitcoind -regtest &\r\n$ src/bitcoin-cli -regtest generatetodescriptor 1 'addr(bcrt1qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq3xueyj)#juyq9d97'\r\n$ src/bitcoin-cli -regtest invalidateblock 0f9188f13cb7b2c71f2a335e3a4fc328bf5beb436012afca590b1a11466e2206\r\n$ src/bitcoin-cli -regtest invalidateblock 0f9188f13cb7b2c71f2a335e3a4fc328bf5beb436012afca590b1a11466e2206\r\n$ jobs\r\n[1]+  Running                 src/bitcoind -regtest &\r\n```\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/803130202/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/569147226",
    "pull_request_review_id": 582022119,
    "id": 569147226,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDU2OTE0NzIyNg==",
    "diff_hunk": "@@ -2923,6 +2923,9 @@ bool PreciousBlock(BlockValidationState& state, const CChainParams& params, CBlo\n \n bool CChainState::InvalidateBlock(BlockValidationState& state, const CChainParams& chainparams, CBlockIndex *pindex)\n {\n+    // Genesis block can't be invalidated\n+    if (pindex->nHeight == 0) return false;",
    "path": "src/validation.cpp",
    "position": 6,
    "original_position": 5,
    "commit_id": "787df19b09babf50dd8124b3ac990b29c33cfe93",
    "original_commit_id": "91ff54441974f926b3ab280357e9eb8250f7511b",
    "user": {
      "login": "ViralTaco",
      "id": 7462994,
      "node_id": "MDQ6VXNlcjc0NjI5OTQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7462994?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ViralTaco",
      "html_url": "https://github.com/ViralTaco",
      "followers_url": "https://api.github.com/users/ViralTaco/followers",
      "following_url": "https://api.github.com/users/ViralTaco/following{/other_user}",
      "gists_url": "https://api.github.com/users/ViralTaco/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ViralTaco/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ViralTaco/subscriptions",
      "organizations_url": "https://api.github.com/users/ViralTaco/orgs",
      "repos_url": "https://api.github.com/users/ViralTaco/repos",
      "events_url": "https://api.github.com/users/ViralTaco/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ViralTaco/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This is actually not preventing UB, it's adding more. \r\nSuggested fix here is adding a `nullptr`check. \r\n```\r\nif (pindex == nullptr) {\r\n  // properly handle error\r\n  throw std::runtime_error(\"nullptr dereference in \\'src\\/validation.cpp\\' in \\'bool CChainState::InvalidateBlock(BlockValidationState&, CChainParams const&, CBlockIndex* pindex)\\' \\npindex was nullptr\");\r\n} else if (pindex->nHeight == 0) {\r\n  return false;\r\n}\r\n```",
    "created_at": "2021-02-03T05:48:32Z",
    "updated_at": "2021-02-09T23:16:00Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/20921#discussion_r569147226",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20921",
    "author_association": "NONE",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/569147226"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/20921#discussion_r569147226"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/20921"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/569147226/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2928,
    "original_line": 2928,
    "side": "RIGHT"
  }
]