[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/246095336",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-246095336",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 246095336,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NjA5NTMzNg==",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?u=eab5d0cdbb6cc25087cb61d4ca4a6f85255f42a7&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-09-10T06:54:26Z",
    "updated_at": "2016-09-10T06:54:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "Impressive changeset!\nGeneral Concept ACK.\n\nInstead of the extending the RPC auth, I could imaging using different RPC endpoints would also work.\n- Accessing RPC at `/` would result in the default wallet.\n- Accessing RPC at `/<walletid>` would result in using the wallet with the id `<walletid>`.\n\nbitcoin-cli could just support a new argument `-walletid`.\nSomething like `bitcoin-cli -walletid=something getbalance` would result in the same RPC call just against the endpoint `/something`.\nMaybe this would result in a simple RPC access to the multiple wallets.\n\nWill review soon.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/246095336/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/246104190",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-246104190",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 246104190,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NjEwNDE5MA==",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-09-10T10:22:49Z",
    "updated_at": "2016-09-10T10:22:49Z",
    "author_association": "MEMBER",
    "body": "> Instead of the extending the RPC auth, I could imaging using different RPC endpoints would also work.\n\nIndeed, although my main purpose in doing this was to isolate JoinMarket, and it's less isolated if it has auth to my real hotwallet. :)\n\n(Also, endpoints seemed like they'd require more code.)\n\n> Accessing RPC at `/<walletid>` would result in using the wallet with the id `<walletid>`.\n\nThis isn't very future-proof. If we go this route, I'd suggest `/?wallet=<walletid>`\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/246104190/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/247158244",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-247158244",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 247158244,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI0NzE1ODI0NA==",
    "user": {
      "login": "btcdrak",
      "id": 7275704,
      "node_id": "MDQ6VXNlcjcyNzU3MDQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7275704?u=578995010af9e1872285cb8e67bcb4f6052d52dd&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/btcdrak",
      "html_url": "https://github.com/btcdrak",
      "followers_url": "https://api.github.com/users/btcdrak/followers",
      "following_url": "https://api.github.com/users/btcdrak/following{/other_user}",
      "gists_url": "https://api.github.com/users/btcdrak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/btcdrak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/btcdrak/subscriptions",
      "organizations_url": "https://api.github.com/users/btcdrak/orgs",
      "repos_url": "https://api.github.com/users/btcdrak/repos",
      "events_url": "https://api.github.com/users/btcdrak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/btcdrak/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-09-14T21:21:10Z",
    "updated_at": "2016-09-14T21:21:10Z",
    "author_association": "CONTRIBUTOR",
    "body": "Nice, Concept ACK. Will test.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/247158244/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270247894",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-270247894",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 270247894,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDI0Nzg5NA==",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-03T22:48:10Z",
    "updated_at": "2017-01-03T22:48:10Z",
    "author_association": "MEMBER",
    "body": "Rebased, but please prioritise #8775 review (which this is based on) first. Once that's merged, it may or may not make sense to split the Qt changes out of this.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270247894/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271090119",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-271090119",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 271090119,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTA5MDExOQ==",
    "user": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?u=63e5c438c242094837a9deeda775d77988b508bf&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-07T15:31:24Z",
    "updated_at": "2017-01-07T15:35:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "Concept ACK.\r\n\r\nSyntax for the auth field should have a clear way to extend it to support a list of wallets (first being the default, I guess).  I think.  To support things like the path selected wallets suggested above later.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271090119/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/277166185",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-277166185",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 277166185,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3NzE2NjE4NQ==",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-02-03T05:10:48Z",
    "updated_at": "2017-02-03T05:10:48Z",
    "author_association": "MEMBER",
    "body": "Moved RPC/GUI changes out of this, and rebased.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/277166185/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/284124924",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-284124924",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 284124924,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NDEyNDkyNA==",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-04T03:54:00Z",
    "updated_at": "2017-03-04T03:54:00Z",
    "author_association": "MEMBER",
    "body": "Rebased and now the next-step in multiwallet integration.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/284124924/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/284332981",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-284332981",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 284332981,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NDMzMjk4MQ==",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?u=eab5d0cdbb6cc25087cb61d4ca4a6f85255f42a7&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-06T08:34:47Z",
    "updated_at": "2017-03-06T09:57:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "Re-Concept ACK.\r\nBinaries to play with: https://bitcoin.jonasschnelli.ch/build/PR/8694",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/284332981/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/285100437",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-285100437",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 285100437,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NTEwMDQzNw==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-08T17:00:08Z",
    "updated_at": "2017-03-08T17:00:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "(needs another rebase)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/285100437/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/285298597",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-285298597",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 285298597,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NTI5ODU5Nw==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-09T09:22:43Z",
    "updated_at": "2017-03-09T09:22:43Z",
    "author_association": "MEMBER",
    "body": "Added 0.15.0 milestone.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/285298597/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/285499326",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-285499326",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 285499326,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NTQ5OTMyNg==",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-09T22:08:27Z",
    "updated_at": "2017-03-09T22:08:27Z",
    "author_association": "MEMBER",
    "body": "Significantly rebased. Also fixed minor race conditions surrounding wallet flush (it was bumping the \"have update to flush\" counter before doing the actual update).",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/285499326/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/285599692",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-285599692",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 285599692,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NTU5OTY5Mg==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-10T07:40:04Z",
    "updated_at": "2017-03-10T07:40:36Z",
    "author_association": "MEMBER",
    "body": "It would be preferable to increment the update counter after committing a database transaction, not after every call to a CWalletDB method.\r\nSo this would mean the destructor of `CWalletDB` and `TxnCommit()` . Which should be overridden in CWalletDB, or alternatively use composition not inheritance for CDB as I've done in the last commit in #9951.\r\nThis will simplify these changes (no need to do WriteIC/EraseIC everywhere), as well as makes sure that only changes that actually hit the database/disk are counted.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/285599692/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/285600713",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-285600713",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 285600713,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NTYwMDcxMw==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-10T07:46:05Z",
    "updated_at": "2017-03-10T07:46:05Z",
    "author_association": "MEMBER",
    "body": "I think the overall approach here is good. This is another step towards multi-wallet support. As it's not anywhere on the API yet, I guess it's too early to ask for a multiwallet test?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/285600713/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/285729345",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-285729345",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 285729345,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NTcyOTM0NQ==",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-10T17:20:05Z",
    "updated_at": "2017-03-10T17:20:05Z",
    "author_association": "MEMBER",
    "body": "> It would be preferable to increment the update counter after committing a database transaction, not after every call to a CWalletDB method.\r\n\r\nIMO too much for this PR. Just trying to multiwallet here, not refactor stuff that doesn't need it. :)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/285729345/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/285748918",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-285748918",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 285748918,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NTc0ODkxOA==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-10T18:36:22Z",
    "updated_at": "2017-03-10T18:36:22Z",
    "author_association": "MEMBER",
    "body": "> IMO too much for this PR. Just trying to multiwallet here, not refactor stuff that doesn't need it. :)\r\n\r\nMaybe my recommendation goes to far but I just think your current approach there is messy. The mutator functions call `WriteIC`/`EraseIC` which call `IncrementUpdateCounter` which calls `IncrementUpdateCounter(strFile)` which indexes into a global map indexed by name. This makes the wallet code even more complex and hard to understand as it introduces another place where per-wallet(-database) information is stored.\r\n\r\nWe need to decide whether CWalletDBStateInfo belongs with the database wrapper, or with the wallet.\r\n\r\n- If it is part of the database statistics side of things, the place to put it would be CDBEnv, with the other maps `mapFileUseCount` and `mapDb`. After #9951 I'm going to refactor these to put them on a CDBWrapper object which represents a single database.\r\n- If it is specific to wallets, the structure could be put on CWallet, and a reference passed in where it is needed (e.g. to CWalletDB) instead of looking it up all the time. This makes the CWallet more self-contained.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/285748918/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/285828510",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-285828510",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 285828510,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NTgyODUxMA==",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-11T01:27:36Z",
    "updated_at": "2017-03-11T01:27:36Z",
    "author_association": "MEMBER",
    "body": "@laanwj I agree that stuff should be refactored, but I don't think multiwallet needs to depend on it here.\r\n\r\n(Why is CWalletDB not just a private parent class of CWallet anyway?)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/285828510/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/285850854",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-285850854",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 285850854,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI4NTg1MDg1NA==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-03-11T07:47:03Z",
    "updated_at": "2017-03-11T08:48:57Z",
    "author_association": "MEMBER",
    "body": "> (Why is CWalletDB not just a private parent class of CWallet anyway?)\r\n\r\n- It's named wrongly. Because CWalletDB is not a database, it provides access to it. To be exact, it is a database transaction, similar to the CDBBatch in leveldbwrapper.h. It is commited when the object goes out of scope or `TxnCommit()` is called. It is not committed if `TxnAbort()` is called.\r\n- Should at least use composition there not inheritance. A wallet *uses* a wallet database, it *is* not a wallet database. This avoids low-level implementation details from leaking through.\r\n\r\n> I agree that stuff should be refactored, but I don't think multiwallet needs to depend on it here.\r\n\r\nAs said I understand that. I'm not asking for you to do big changes. I just don't want it to become even worse and more muddled. \r\n\r\nI might pick this up myself if I have some time next week.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/285850854/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/293529526",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-293529526",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 293529526,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5MzUyOTUyNg==",
    "user": {
      "login": "NicolasDorier",
      "id": 3020646,
      "node_id": "MDQ6VXNlcjMwMjA2NDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3020646?u=256d78207f88d303d61b62060a309657276cf6cb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NicolasDorier",
      "html_url": "https://github.com/NicolasDorier",
      "followers_url": "https://api.github.com/users/NicolasDorier/followers",
      "following_url": "https://api.github.com/users/NicolasDorier/following{/other_user}",
      "gists_url": "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NicolasDorier/subscriptions",
      "organizations_url": "https://api.github.com/users/NicolasDorier/orgs",
      "repos_url": "https://api.github.com/users/NicolasDorier/repos",
      "events_url": "https://api.github.com/users/NicolasDorier/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NicolasDorier/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-04-12T09:54:17Z",
    "updated_at": "2017-04-12T09:54:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "not blocking, but I think a `CWallets` instead of `vpwallets` it would make the code way easier to read and less error prone.\r\nWould also make locking easier to get right, and preventing some loop.\r\n\r\nIt would impact:\r\n```\r\nstd::map<std::string, CWalletDBStateInfo> WalletDBStateInfos\r\nstd::vector<CWallet_ptr> vpwallets;\r\nIncrementUpdateCounter()\r\n```\r\nThat said, this can be done in a separate PR.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/293529526/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/294878238",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-294878238",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 294878238,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI5NDg3ODIzOA==",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-04-18T15:17:24Z",
    "updated_at": "2017-04-18T15:17:24Z",
    "author_association": "MEMBER",
    "body": "In-scope nits addressed and rebased.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/294878238/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/302907619",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-302907619",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 302907619,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMjkwNzYxOQ==",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-05-21T00:42:28Z",
    "updated_at": "2017-05-21T00:42:28Z",
    "author_association": "MEMBER",
    "body": "Rebased",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/302907619/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/303652612",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-303652612",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 303652612,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMzY1MjYxMg==",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?u=eab5d0cdbb6cc25087cb61d4ca4a6f85255f42a7&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-05-24T08:18:31Z",
    "updated_at": "2017-05-24T08:18:31Z",
    "author_association": "CONTRIBUTOR",
    "body": "Tested a bit and seems to work as intended.\r\nThe only point I found during testing that needs fixing is the SalvageWallet renaming to \"wallet.%d.bak\".\r\nStep-debugged the flushing and SyncTransaction.\r\n\r\n### Conceptual:\r\nThis PR mostly goes into a direction that one has to choose the wallets-to-work-with before starting up Core. I miss the pre-work for run-time adding and removing of wallets. Sure, this may be added later. \r\nFurthermore, the \"globalness\" of the startup arguments and action like `-usehd` or `-zapwallettxes`, `--keypool`, etc. are somehow conceptual issues that need to be solved before deploying multiwallet.\r\n\r\n* Ideally creating, loading and unloading of wallets happens during runtime over an RPC call (or though the GUI).\r\n* In the long run, actions like `zapwallettx`, `salvagewallet`, `rescan`, `upgradewallet`, etc should also be moved to runtime.\r\n* Per wallet settings like `-usehd`, `-keypool`, etc. should be values that can be set during creation (or loading of a wallet).\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/303652612/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/303668042",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-303668042",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 303668042,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMzY2ODA0Mg==",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?u=eab5d0cdbb6cc25087cb61d4ca4a6f85255f42a7&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-05-24T09:22:28Z",
    "updated_at": "2017-05-24T09:22:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "Gitian builds are failing (all three platforms): https://bitcoin.jonasschnelli.ch/build/147",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/303668042/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/304092421",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-304092421",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 304092421,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNDA5MjQyMQ==",
    "user": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?u=63e5c438c242094837a9deeda775d77988b508bf&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-05-25T18:51:18Z",
    "updated_at": "2017-05-25T18:51:18Z",
    "author_association": "CONTRIBUTOR",
    "body": "> zapwallettx, salvagewallet\r\n\r\nThese should probably become less visible or go away or move to a separate utility. \r\n\r\n> rescan\r\n\r\nWe can do this from the rpc now.\r\n\r\nNot sure about upgradewallet.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/304092421/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/306329076",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-306329076",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 306329076,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNjMyOTA3Ng==",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-05T22:31:46Z",
    "updated_at": "2017-06-05T22:31:46Z",
    "author_association": "MEMBER",
    "body": "Rebased and issues addressed",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/306329076/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/306473476",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-306473476",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 306473476,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNjQ3MzQ3Ng==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-06T12:39:12Z",
    "updated_at": "2017-06-06T12:39:12Z",
    "author_association": "MEMBER",
    "body": "Travis falure:\r\n```\r\nRunning 255 test cases...\r\nunknown location(0): fatal error: in \"wallet_tests/importwallet_rescan\": unknown type\r\nwallet/test/wallet_tests.cpp(446): last checkpoint: \"importwallet_rescan\" entry.\r\n*** 1 failure is detected in the test module \"Bitcoin Test Suite\"\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/306473476/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/306474587",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-306474587",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 306474587,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNjQ3NDU4Nw==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-06T12:44:08Z",
    "updated_at": "2017-06-06T12:44:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Travis falure:\r\n\r\nThe importwallet_rescan test has another pwalletMain usage that needs to be changed to vpwallets.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/306474587/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/306536473",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-306536473",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 306536473,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNjUzNjQ3Mw==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-06T16:10:39Z",
    "updated_at": "2017-06-06T16:10:39Z",
    "author_association": "MEMBER",
    "body": "I've had a quick scan and the new commits look generally good, although #10457 seems like a simpler solution to the wallet backup name issue. I don't think it's really worth passing the backup file name around through multiple function calls just so it can be printed in a single warning message.\r\n\r\nI'll fully review once the the test has been fixed.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/306536473/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/307762965",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-307762965",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 307762965,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNzc2Mjk2NQ==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-12T11:27:35Z",
    "updated_at": "2017-06-12T11:27:35Z",
    "author_association": "MEMBER",
    "body": "utACK c237bd7\r\nSeems ready to merge.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/307762965/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/307798429",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#issuecomment-307798429",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/8694",
    "id": 307798429,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwNzc5ODQyOQ==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-06-12T14:01:17Z",
    "updated_at": "2017-06-12T14:01:17Z",
    "author_association": "MEMBER",
    "body": "> I've had a quick scan and the new commits look generally good, although #10457 seems like a simpler solution to the wallet backup name issue. I don't think it's really worth passing the backup file name around through multiple function calls just so it can be printed in a single warning message.\r\n\r\nI agree. We should probably revert that part and do #10457 afterward.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/307798429/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/79791358",
    "pull_request_review_id": 912360,
    "id": 79791358,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDc5NzkxMzU4",
    "diff_hunk": "@@ -196,8 +196,9 @@ void Shutdown()\n     StopRPC();\n     StopHTTPServer();\n #ifdef ENABLE_WALLET\n-    if (pwalletMain)\n-        pwalletMain->Flush(false);\n+    for (CWallet_ptr pwallet : vpwallets) {",
    "path": "src/init.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "996948af12b418562cbc2d29c1d7f9d8b9ca2a46",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I like the approach by @jonasschnelli better. Let's keep most of the multiwallet logic in `wallet.cpp`.\n",
    "created_at": "2016-09-21T09:17:28Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r79791358",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/79791358"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r79791358"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/79791358/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 199,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104261222",
    "pull_request_review_id": 25090434,
    "id": 104261222,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwNDI2MTIyMg==",
    "diff_hunk": "@@ -196,8 +196,9 @@ void Shutdown()\n     StopRPC();\n     StopHTTPServer();\n #ifdef ENABLE_WALLET\n-    if (pwalletMain)\n-        pwalletMain->Flush(false);\n+    for (CWallet_ptr pwallet : vpwallets) {",
    "path": "src/init.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "996948af12b418562cbc2d29c1d7f9d8b9ca2a46",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It's not in `wallet.cpp` now. Moving it there seems like a good idea, but independent of this PR...",
    "created_at": "2017-03-03T23:09:58Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r104261222",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104261222"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r104261222"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104261222/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 199,
    "side": "RIGHT",
    "in_reply_to_id": 79791358
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104459247",
    "pull_request_review_id": 25297921,
    "id": 104459247,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwNDQ1OTI0Nw==",
    "diff_hunk": "@@ -31,7 +31,8 @@\n #include <boost/shared_ptr.hpp>\n #include <boost/thread.hpp>\n \n-extern CWallet* pwalletMain;\n+typedef CWallet* CWallet_ptr;",
    "path": "src/wallet/wallet.h",
    "position": null,
    "original_position": 5,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "0d348d5a5646cf9c522896a297538b7d1ec1509f",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Curious, why have a `CWallet_ptr` typedef instead of using `CWallet *`? Is there a plan to switch to a different type of pointer later? Curious, because this seems to make the rest of the code more opaque. For example:\r\n\r\n```\r\nfor (CWallet_ptr pwallet : vpwallets)\r\n```\r\n\r\nBecause this says `CWallet_ptr` instead of `CWallet*` it's unclear whether the copy initialization has extra cost (which it would for a shared_ptr), implying a const reference should be used instead.\r\n",
    "created_at": "2017-03-06T16:37:12Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r104459247",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104459247"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r104459247"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104459247/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 34,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104467005",
    "pull_request_review_id": 25297921,
    "id": 104467005,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwNDQ2NzAwNQ==",
    "diff_hunk": "@@ -819,21 +819,23 @@ void ThreadFlushWalletDB()\n                 if (nRefCount == 0)\n                 {\n                     boost::this_thread::interruption_point();\n-                    const std::string& strFile = pwalletMain->strWalletFile;\n-                    map<string, int>::iterator _mi = bitdb.mapFileUseCount.find(strFile);\n-                    if (_mi != bitdb.mapFileUseCount.end())\n-                    {\n-                        LogPrint(\"db\", \"Flushing %s\\n\", strFile);\n-                        nLastFlushed = CWalletDB::GetUpdateCounter();\n-                        int64_t nStart = GetTimeMillis();\n-\n-                        // Flush wallet file so it's self contained\n-                        bitdb.CloseDb(strFile);\n-                        bitdb.CheckpointLSN(strFile);\n-\n-                        bitdb.mapFileUseCount.erase(_mi++);\n-                        LogPrint(\"db\", \"Flushed %s %dms\\n\", strFile, GetTimeMillis() - nStart);\n+                    for (CWallet_ptr pwallet : vpwallets) {",
    "path": "src/wallet/walletdb.cpp",
    "position": null,
    "original_position": 18,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "0d348d5a5646cf9c522896a297538b7d1ec1509f",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This thread is created from the non-static method `CWallet::postInitProcess`, so it seems like it makes more sense for it to continue flushing a single wallet, rather than going through the global wallets list. Instead of looping and accessing the global `vpwallet` variable, `ThreadFlushWalletDB` could just take a new `CWallet* pwallet` argument and be invoked with:\r\n\r\n```\r\nthreadGroup.create_thread([this](){ThreadFlushWalletDB(this);});\r\n```\r\n\r\nfrom `CWallet::postInitProcess`.",
    "created_at": "2017-03-06T17:07:04Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r104467005",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104467005"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r104467005"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104467005/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 822,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104467401",
    "pull_request_review_id": 25297921,
    "id": 104467401,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwNDQ2NzQwMQ==",
    "diff_hunk": "@@ -819,21 +819,23 @@ void ThreadFlushWalletDB()\n                 if (nRefCount == 0)\n                 {\n                     boost::this_thread::interruption_point();\n-                    const std::string& strFile = pwalletMain->strWalletFile;\n-                    map<string, int>::iterator _mi = bitdb.mapFileUseCount.find(strFile);\n-                    if (_mi != bitdb.mapFileUseCount.end())\n-                    {\n-                        LogPrint(\"db\", \"Flushing %s\\n\", strFile);\n-                        nLastFlushed = CWalletDB::GetUpdateCounter();\n-                        int64_t nStart = GetTimeMillis();\n-\n-                        // Flush wallet file so it's self contained\n-                        bitdb.CloseDb(strFile);\n-                        bitdb.CheckpointLSN(strFile);\n-\n-                        bitdb.mapFileUseCount.erase(_mi++);\n-                        LogPrint(\"db\", \"Flushed %s %dms\\n\", strFile, GetTimeMillis() - nStart);\n+                    for (CWallet_ptr pwallet : vpwallets) {\n+                        const std::string& strFile = pwallet->strWalletFile;\n+                        map<string, int>::iterator _mi = bitdb.mapFileUseCount.find(strFile);\n+                        if (_mi != bitdb.mapFileUseCount.end())\n+                        {\n+                            LogPrint(\"db\", \"Flushing %s\\n\", strFile);\n+                            int64_t nStart = GetTimeMillis();\n+\n+                            // Flush wallet file so it's self contained\n+                            bitdb.CloseDb(strFile);\n+                            bitdb.CheckpointLSN(strFile);\n+\n+                            bitdb.mapFileUseCount.erase(_mi++);\n+                            LogPrint(\"db\", \"Flushed %s %dms\\n\", strFile, GetTimeMillis() - nStart);\n+                        }\n                     }\n+                    nLastFlushed = CWalletDB::GetUpdateCounter();",
    "path": "src/wallet/walletdb.cpp",
    "position": null,
    "original_position": 34,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "0d348d5a5646cf9c522896a297538b7d1ec1509f",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "How come the `nLastFlushed` assignment is moving ouside of the `_mi != bitdb.mapFileUseCount.end()` condition? It seems unrelated to this change. Maybe a code comment explaining the assignment would be good here.",
    "created_at": "2017-03-06T17:08:37Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r104467401",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104467401"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r104467401"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104467401/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 838,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104522825",
    "pull_request_review_id": 25364181,
    "id": 104522825,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwNDUyMjgyNQ==",
    "diff_hunk": "@@ -31,7 +31,8 @@\n #include <boost/shared_ptr.hpp>\n #include <boost/thread.hpp>\n \n-extern CWallet* pwalletMain;\n+typedef CWallet* CWallet_ptr;",
    "path": "src/wallet/wallet.h",
    "position": null,
    "original_position": 5,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "0d348d5a5646cf9c522896a297538b7d1ec1509f",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Indeed, a shared_ptr or similar would be needed for when/if we add the ability to close wallets at runtime.",
    "created_at": "2017-03-06T21:08:54Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r104522825",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104522825"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r104522825"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104522825/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 34,
    "side": "RIGHT",
    "in_reply_to_id": 104459247
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104523089",
    "pull_request_review_id": 25364459,
    "id": 104523089,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwNDUyMzA4OQ==",
    "diff_hunk": "@@ -819,21 +819,23 @@ void ThreadFlushWalletDB()\n                 if (nRefCount == 0)\n                 {\n                     boost::this_thread::interruption_point();\n-                    const std::string& strFile = pwalletMain->strWalletFile;\n-                    map<string, int>::iterator _mi = bitdb.mapFileUseCount.find(strFile);\n-                    if (_mi != bitdb.mapFileUseCount.end())\n-                    {\n-                        LogPrint(\"db\", \"Flushing %s\\n\", strFile);\n-                        nLastFlushed = CWalletDB::GetUpdateCounter();\n-                        int64_t nStart = GetTimeMillis();\n-\n-                        // Flush wallet file so it's self contained\n-                        bitdb.CloseDb(strFile);\n-                        bitdb.CheckpointLSN(strFile);\n-\n-                        bitdb.mapFileUseCount.erase(_mi++);\n-                        LogPrint(\"db\", \"Flushed %s %dms\\n\", strFile, GetTimeMillis() - nStart);\n+                    for (CWallet_ptr pwallet : vpwallets) {",
    "path": "src/wallet/walletdb.cpp",
    "position": null,
    "original_position": 18,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "0d348d5a5646cf9c522896a297538b7d1ec1509f",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Having a dedicated thread per wallet is just needlessly inefficient.",
    "created_at": "2017-03-06T21:10:00Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r104523089",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104523089"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r104523089"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104523089/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 822,
    "side": "RIGHT",
    "in_reply_to_id": 104467005
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104523568",
    "pull_request_review_id": 25364997,
    "id": 104523568,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwNDUyMzU2OA==",
    "diff_hunk": "@@ -819,21 +819,23 @@ void ThreadFlushWalletDB()\n                 if (nRefCount == 0)\n                 {\n                     boost::this_thread::interruption_point();\n-                    const std::string& strFile = pwalletMain->strWalletFile;\n-                    map<string, int>::iterator _mi = bitdb.mapFileUseCount.find(strFile);\n-                    if (_mi != bitdb.mapFileUseCount.end())\n-                    {\n-                        LogPrint(\"db\", \"Flushing %s\\n\", strFile);\n-                        nLastFlushed = CWalletDB::GetUpdateCounter();\n-                        int64_t nStart = GetTimeMillis();\n-\n-                        // Flush wallet file so it's self contained\n-                        bitdb.CloseDb(strFile);\n-                        bitdb.CheckpointLSN(strFile);\n-\n-                        bitdb.mapFileUseCount.erase(_mi++);\n-                        LogPrint(\"db\", \"Flushed %s %dms\\n\", strFile, GetTimeMillis() - nStart);\n+                    for (CWallet_ptr pwallet : vpwallets) {\n+                        const std::string& strFile = pwallet->strWalletFile;\n+                        map<string, int>::iterator _mi = bitdb.mapFileUseCount.find(strFile);\n+                        if (_mi != bitdb.mapFileUseCount.end())\n+                        {\n+                            LogPrint(\"db\", \"Flushing %s\\n\", strFile);\n+                            int64_t nStart = GetTimeMillis();\n+\n+                            // Flush wallet file so it's self contained\n+                            bitdb.CloseDb(strFile);\n+                            bitdb.CheckpointLSN(strFile);\n+\n+                            bitdb.mapFileUseCount.erase(_mi++);\n+                            LogPrint(\"db\", \"Flushed %s %dms\\n\", strFile, GetTimeMillis() - nStart);\n+                        }\n                     }\n+                    nLastFlushed = CWalletDB::GetUpdateCounter();",
    "path": "src/wallet/walletdb.cpp",
    "position": null,
    "original_position": 34,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "0d348d5a5646cf9c522896a297538b7d1ec1509f",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Because the condition is per-wallet. Maybe nLastFlushed ought to be as well...?",
    "created_at": "2017-03-06T21:12:16Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r104523568",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104523568"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r104523568"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/104523568/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 838,
    "side": "RIGHT",
    "in_reply_to_id": 104467401
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105283157",
    "pull_request_review_id": 26157122,
    "id": 105283157,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwNTI4MzE1Nw==",
    "diff_hunk": "@@ -819,21 +819,23 @@ void ThreadFlushWalletDB()\n                 if (nRefCount == 0)\n                 {\n                     boost::this_thread::interruption_point();\n-                    const std::string& strFile = pwalletMain->strWalletFile;\n-                    map<string, int>::iterator _mi = bitdb.mapFileUseCount.find(strFile);\n-                    if (_mi != bitdb.mapFileUseCount.end())\n-                    {\n-                        LogPrint(\"db\", \"Flushing %s\\n\", strFile);\n-                        nLastFlushed = CWalletDB::GetUpdateCounter();\n-                        int64_t nStart = GetTimeMillis();\n-\n-                        // Flush wallet file so it's self contained\n-                        bitdb.CloseDb(strFile);\n-                        bitdb.CheckpointLSN(strFile);\n-\n-                        bitdb.mapFileUseCount.erase(_mi++);\n-                        LogPrint(\"db\", \"Flushed %s %dms\\n\", strFile, GetTimeMillis() - nStart);\n+                    for (CWallet_ptr pwallet : vpwallets) {\n+                        const std::string& strFile = pwallet->strWalletFile;\n+                        map<string, int>::iterator _mi = bitdb.mapFileUseCount.find(strFile);\n+                        if (_mi != bitdb.mapFileUseCount.end())\n+                        {\n+                            LogPrint(\"db\", \"Flushing %s\\n\", strFile);\n+                            int64_t nStart = GetTimeMillis();\n+\n+                            // Flush wallet file so it's self contained\n+                            bitdb.CloseDb(strFile);\n+                            bitdb.CheckpointLSN(strFile);\n+\n+                            bitdb.mapFileUseCount.erase(_mi++);\n+                            LogPrint(\"db\", \"Flushed %s %dms\\n\", strFile, GetTimeMillis() - nStart);\n+                        }\n                     }\n+                    nLastFlushed = CWalletDB::GetUpdateCounter();",
    "path": "src/wallet/walletdb.cpp",
    "position": null,
    "original_position": 34,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "0d348d5a5646cf9c522896a297538b7d1ec1509f",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Sanitised this better in the rebase",
    "created_at": "2017-03-09T22:07:20Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105283157",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105283157"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105283157"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105283157/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 838,
    "side": "RIGHT",
    "in_reply_to_id": 104467401
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105344494",
    "pull_request_review_id": 26220683,
    "id": 105344494,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwNTM0NDQ5NA==",
    "diff_hunk": "@@ -418,6 +418,7 @@ bool SoftSetArg(const std::string& strArg, const std::string& strValue)\n     if (mapArgs.count(strArg))\n         return false;\n     mapArgs[strArg] = strValue;\n+    _mapMultiArgs[strArg].push_back(strValue);",
    "path": "src/util.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "3f096ca2cad68c8bc66a15142dabce28ed8e6998",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think it is confusing for a \"Set\" function to add something to a list. If anything it should replace it.\r\nWhat do you need this for, specifically?\r\nIn the past I've defined [SoftSetMultiArg](https://github.com/laanwj/bitcoin/commit/1024183eff629b758745aa7ebf9329d987179644) to be able to define a whole list argument at once.",
    "created_at": "2017-03-10T07:44:19Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105344494",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105344494"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105344494"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105344494/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 421,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105344527",
    "pull_request_review_id": 26220719,
    "id": 105344527,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwNTM0NDUyNw==",
    "diff_hunk": "@@ -8,6 +8,8 @@\n #include \"wallet/db.h\"\n #include \"wallet/wallet.h\"\n \n+CWallet *pwalletMain;",
    "path": "src/wallet/test/wallet_test_fixture.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "3f096ca2cad68c8bc66a15142dabce28ed8e6998",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Why define pwalletMain here?",
    "created_at": "2017-03-10T07:44:40Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105344527",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105344527"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105344527"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105344527/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 11,
    "original_line": 11,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105443469",
    "pull_request_review_id": 26328271,
    "id": 105443469,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwNTQ0MzQ2OQ==",
    "diff_hunk": "@@ -418,6 +418,7 @@ bool SoftSetArg(const std::string& strArg, const std::string& strValue)\n     if (mapArgs.count(strArg))\n         return false;\n     mapArgs[strArg] = strValue;\n+    _mapMultiArgs[strArg].push_back(strValue);",
    "path": "src/util.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "3f096ca2cad68c8bc66a15142dabce28ed8e6998",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It can't get here unless the list is currently empty. It's used to initialise `-wallet`, which is accessed as a list only now.",
    "created_at": "2017-03-10T17:16:56Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105443469",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105443469"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105443469"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105443469/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 421,
    "side": "RIGHT",
    "in_reply_to_id": 105344494
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105443597",
    "pull_request_review_id": 26328413,
    "id": 105443597,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwNTQ0MzU5Nw==",
    "diff_hunk": "@@ -8,6 +8,8 @@\n #include \"wallet/db.h\"\n #include \"wallet/wallet.h\"\n \n+CWallet *pwalletMain;",
    "path": "src/wallet/test/wallet_test_fixture.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "3f096ca2cad68c8bc66a15142dabce28ed8e6998",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "There's no need to modify the tests to use vpwallets in most cases?",
    "created_at": "2017-03-10T17:17:36Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105443597",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105443597"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105443597"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105443597/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 11,
    "original_line": 11,
    "side": "RIGHT",
    "in_reply_to_id": 105344527
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105449231",
    "pull_request_review_id": 26334485,
    "id": 105449231,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwNTQ0OTIzMQ==",
    "diff_hunk": "@@ -8,6 +8,8 @@\n #include \"wallet/db.h\"\n #include \"wallet/wallet.h\"\n \n+CWallet *pwalletMain;",
    "path": "src/wallet/test/wallet_test_fixture.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "3f096ca2cad68c8bc66a15142dabce28ed8e6998",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Wallet: Replace pwalletMain with a vector of wallet pointers\":\r\n\r\nMaybe add a TODO comment for updating the tests to stop referencing pwalletMain, since this will be confusing to someone seeing this who isn't familiar with the pre-multiwallet history of the code.",
    "created_at": "2017-03-10T17:44:04Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105449231",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105449231"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105449231"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105449231/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 11,
    "original_line": 11,
    "side": "RIGHT",
    "in_reply_to_id": 105344527
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105457768",
    "pull_request_review_id": 26343423,
    "id": 105457768,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwNTQ1Nzc2OA==",
    "diff_hunk": "@@ -8,6 +8,8 @@\n #include \"wallet/db.h\"\n #include \"wallet/wallet.h\"\n \n+CWallet *pwalletMain;",
    "path": "src/wallet/test/wallet_test_fixture.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "3f096ca2cad68c8bc66a15142dabce28ed8e6998",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Depends on the reason why they are setting pwalletMain. Generally that is to communicate with stuff in wallet.cpp/walletdb.cpp I'd say.",
    "created_at": "2017-03-10T18:24:08Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105457768",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105457768"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105457768"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105457768/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 11,
    "original_line": 11,
    "side": "RIGHT",
    "in_reply_to_id": 105344527
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105461051",
    "pull_request_review_id": 26334485,
    "id": 105461051,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwNTQ2MTA1MQ==",
    "diff_hunk": "@@ -103,42 +94,40 @@ bool CWalletDB::WriteCryptedKey(const CPubKey& vchPubKey,\n         Erase(std::make_pair(std::string(\"key\"), vchPubKey));\n         Erase(std::make_pair(std::string(\"wkey\"), vchPubKey));\n     }\n+\n+    IncrementUpdateCounter();",
    "path": "src/wallet/walletdb.cpp",
    "position": null,
    "original_position": 75,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "f1052c224c9ea7699dac4d2fba988b3a8ef2224b",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Bugfix: wallet: Increment \"update counter\" only after actually making the applicable db changes to avoid potential races\":\r\n\r\nI'm probably missing something, but if the first write above succeeds and second write fails, the counter won't be incremented. Is this wrong? Would a possible fix be to drop this line and replace all the Write/Erases above with WriteIC/EraseIC?",
    "created_at": "2017-03-10T18:39:55Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105461051",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105461051"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105461051"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105461051/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 98,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105461805",
    "pull_request_review_id": 26334485,
    "id": 105461805,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwNTQ2MTgwNQ==",
    "diff_hunk": "@@ -32,46 +32,38 @@ static std::atomic<unsigned int> nWalletDBUpdateCounter;\n \n bool CWalletDB::WriteName(const std::string& strAddress, const std::string& strName)\n {\n-    nWalletDBUpdateCounter++;",
    "path": "src/wallet/walletdb.cpp",
    "position": 14,
    "original_position": 4,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "f1052c224c9ea7699dac4d2fba988b3a8ef2224b",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Bugfix: wallet: Increment \"update counter\" only after actually making the applicable db changes to avoid potential races\":\r\n\r\nIt seems good not to increment the counter when a write or erase fails. But I don't understand what the \"potential races\" are that could happen if the counter is incremented regardless. If you could clarify / expand the commit message on this point, I think that would be helpful.",
    "created_at": "2017-03-10T18:44:00Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105461805",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105461805"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105461805"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105461805/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 35,
    "original_line": null,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105520211",
    "pull_request_review_id": 26410271,
    "id": 105520211,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwNTUyMDIxMQ==",
    "diff_hunk": "@@ -32,46 +32,38 @@ static std::atomic<unsigned int> nWalletDBUpdateCounter;\n \n bool CWalletDB::WriteName(const std::string& strAddress, const std::string& strName)\n {\n-    nWalletDBUpdateCounter++;",
    "path": "src/wallet/walletdb.cpp",
    "position": 14,
    "original_position": 4,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "f1052c224c9ea7699dac4d2fba988b3a8ef2224b",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "1. (thread 1) Increment the counter.\r\n2. (thread 2) DB gets flushed\r\n3. (thread 1) Actual change happens.\r\n4. (thread 2) Thinks DB hasn't changed, so doesn't flush again.",
    "created_at": "2017-03-11T01:25:50Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105520211",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105520211"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105520211"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105520211/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 35,
    "original_line": null,
    "side": "RIGHT",
    "in_reply_to_id": 105461805
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105520237",
    "pull_request_review_id": 26410301,
    "id": 105520237,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwNTUyMDIzNw==",
    "diff_hunk": "@@ -103,42 +94,40 @@ bool CWalletDB::WriteCryptedKey(const CPubKey& vchPubKey,\n         Erase(std::make_pair(std::string(\"key\"), vchPubKey));\n         Erase(std::make_pair(std::string(\"wkey\"), vchPubKey));\n     }\n+\n+    IncrementUpdateCounter();",
    "path": "src/wallet/walletdb.cpp",
    "position": null,
    "original_position": 75,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "f1052c224c9ea7699dac4d2fba988b3a8ef2224b",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Hmm, not sure what we want to happen in that case...",
    "created_at": "2017-03-11T01:26:25Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105520237",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105520237"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105520237"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105520237/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 98,
    "side": "RIGHT",
    "in_reply_to_id": 105461051
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105528436",
    "pull_request_review_id": 26417967,
    "id": 105528436,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwNTUyODQzNg==",
    "diff_hunk": "@@ -103,42 +94,40 @@ bool CWalletDB::WriteCryptedKey(const CPubKey& vchPubKey,\n         Erase(std::make_pair(std::string(\"key\"), vchPubKey));\n         Erase(std::make_pair(std::string(\"wkey\"), vchPubKey));\n     }\n+\n+    IncrementUpdateCounter();",
    "path": "src/wallet/walletdb.cpp",
    "position": null,
    "original_position": 75,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "f1052c224c9ea7699dac4d2fba988b3a8ef2224b",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This is one of the reasons why I suggested above to only update the update counter if a DB transaction actually hits the database. That's more robust than doing it per operation. It's possible for all the operations to succeed then TxnAbort() to be called and still no update happens.",
    "created_at": "2017-03-11T07:42:29Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105528436",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105528436"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r105528436"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/105528436/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 98,
    "side": "RIGHT",
    "in_reply_to_id": 105461051
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/107046358",
    "pull_request_review_id": 27996392,
    "id": 107046358,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwNzA0NjM1OA==",
    "diff_hunk": "@@ -30,7 +30,8 @@\n \n #include <boost/shared_ptr.hpp>\n \n-extern CWallet* pwalletMain;\n+typedef CWallet* CWallet_ptr;",
    "path": "src/wallet/wallet.h",
    "position": null,
    "original_position": 5,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "3f096ca2cad68c8bc66a15142dabce28ed8e6998",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Why typedef this? Its literally /more/ characters now.",
    "created_at": "2017-03-21T00:03:11Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r107046358",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/107046358"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r107046358"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/107046358/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 33,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/107046516",
    "pull_request_review_id": 27996392,
    "id": 107046516,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwNzA0NjUxNg==",
    "diff_hunk": "@@ -256,8 +258,7 @@ void Shutdown()\n #endif\n     UnregisterAllValidationInterfaces();\n #ifdef ENABLE_WALLET\n-    delete pwalletMain;\n-    pwalletMain = NULL;\n+    vpwallets.clear();",
    "path": "src/init.cpp",
    "position": null,
    "original_position": 30,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "3f096ca2cad68c8bc66a15142dabce28ed8e6998",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Don't you still need to delete each wallet here?",
    "created_at": "2017-03-21T00:04:28Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r107046516",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/107046516"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r107046516"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/107046516/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 268,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/107046936",
    "pull_request_review_id": 27996392,
    "id": 107046936,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwNzA0NjkzNg==",
    "diff_hunk": "@@ -418,6 +418,7 @@ bool SoftSetArg(const std::string& strArg, const std::string& strValue)\n     if (mapArgs.count(strArg))\n         return false;\n     mapArgs[strArg] = strValue;\n+    _mapMultiArgs[strArg].push_back(strValue);",
    "path": "src/util.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "3f096ca2cad68c8bc66a15142dabce28ed8e6998",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I believe this is also not correct - other threads may be using mapMultiArgs or the vector in it at the same time",
    "created_at": "2017-03-21T00:07:31Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r107046936",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/107046936"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r107046936"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/107046936/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 421,
    "side": "RIGHT",
    "in_reply_to_id": 105344494
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/108462865",
    "pull_request_review_id": 29494953,
    "id": 108462865,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEwODQ2Mjg2NQ==",
    "diff_hunk": "@@ -418,6 +418,7 @@ bool SoftSetArg(const std::string& strArg, const std::string& strValue)\n     if (mapArgs.count(strArg))\n         return false;\n     mapArgs[strArg] = strValue;\n+    _mapMultiArgs[strArg].push_back(strValue);",
    "path": "src/util.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "3f096ca2cad68c8bc66a15142dabce28ed8e6998",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Maybe get @jtimon to do it in #9494 and then just use it here?",
    "created_at": "2017-03-28T15:58:43Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r108462865",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/108462865"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r108462865"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/108462865/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 421,
    "side": "RIGHT",
    "in_reply_to_id": 105344494
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111102248",
    "pull_request_review_id": 32321662,
    "id": 111102248,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExMTEwMjI0OA==",
    "diff_hunk": "@@ -30,7 +30,8 @@\n \n #include <boost/shared_ptr.hpp>\n \n-extern CWallet* pwalletMain;\n+typedef CWallet* CWallet_ptr;",
    "path": "src/wallet/wallet.h",
    "position": null,
    "original_position": 5,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "3f096ca2cad68c8bc66a15142dabce28ed8e6998",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Typedef-ing a pointer type doesn't seem that useful to me either. I suppose the rationale is \"what if we want to change it to e.g. std::shared_ptr later\". But a) I think the code is more readable if the kind of pointer is clear from the function/struct/class signatures using it b) You might want to have different kinds of pointers to the same kind of objects in different places.",
    "created_at": "2017-04-12T09:23:47Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r111102248",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111102248"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r111102248"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111102248/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 33,
    "side": "RIGHT",
    "in_reply_to_id": 107046358
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111106307",
    "pull_request_review_id": 32325933,
    "id": 111106307,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExMTEwNjMwNw==",
    "diff_hunk": "@@ -29,7 +29,8 @@\n \n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n-    return pwalletMain;\n+    // TODO: Some way to access secondary wallets",
    "path": "src/wallet/rpcwallet.cpp",
    "position": 5,
    "original_position": 5,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "3f096ca2cad68c8bc66a15142dabce28ed8e6998",
    "user": {
      "login": "NicolasDorier",
      "id": 3020646,
      "node_id": "MDQ6VXNlcjMwMjA2NDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3020646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NicolasDorier",
      "html_url": "https://github.com/NicolasDorier",
      "followers_url": "https://api.github.com/users/NicolasDorier/followers",
      "following_url": "https://api.github.com/users/NicolasDorier/following{/other_user}",
      "gists_url": "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NicolasDorier/subscriptions",
      "organizations_url": "https://api.github.com/users/NicolasDorier/orgs",
      "repos_url": "https://api.github.com/users/NicolasDorier/repos",
      "events_url": "https://api.github.com/users/NicolasDorier/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NicolasDorier/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I throwing an RPC error like `RPC_METHOD_NOT_FOUND` is better than returning `NULL`.",
    "created_at": "2017-04-12T09:42:28Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r111106307",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111106307"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r111106307"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111106307/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 36,
    "original_line": 36,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111106832",
    "pull_request_review_id": 32326488,
    "id": 111106832,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExMTEwNjgzMg==",
    "diff_hunk": "@@ -3724,24 +3734,17 @@ CWallet* CWallet::CreateWalletFromFile(const std::string walletFile)\n bool CWallet::InitLoadWallet()\n {\n     if (GetBoolArg(\"-disablewallet\", DEFAULT_DISABLE_WALLET)) {\n-        pwalletMain = NULL;",
    "path": "src/wallet/wallet.cpp",
    "position": 93,
    "original_position": 90,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "3f096ca2cad68c8bc66a15142dabce28ed8e6998",
    "user": {
      "login": "NicolasDorier",
      "id": 3020646,
      "node_id": "MDQ6VXNlcjMwMjA2NDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3020646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NicolasDorier",
      "html_url": "https://github.com/NicolasDorier",
      "followers_url": "https://api.github.com/users/NicolasDorier/followers",
      "following_url": "https://api.github.com/users/NicolasDorier/following{/other_user}",
      "gists_url": "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NicolasDorier/subscriptions",
      "organizations_url": "https://api.github.com/users/NicolasDorier/orgs",
      "repos_url": "https://api.github.com/users/NicolasDorier/repos",
      "events_url": "https://api.github.com/users/NicolasDorier/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NicolasDorier/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`vpwallets.clear()` ?\r\n\r\nEDIT: Meh, not really needed, just thought it would be more coherent.",
    "created_at": "2017-04-12T09:45:07Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r111106832",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111106832"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r111106832"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111106832/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 3929,
    "original_line": 3929,
    "side": "LEFT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111107294",
    "pull_request_review_id": 32327016,
    "id": 111107294,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExMTEwNzI5NA==",
    "diff_hunk": "@@ -30,7 +30,8 @@\n \n #include <boost/shared_ptr.hpp>\n \n-extern CWallet* pwalletMain;\n+typedef CWallet* CWallet_ptr;",
    "path": "src/wallet/wallet.h",
    "position": null,
    "original_position": 5,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "3f096ca2cad68c8bc66a15142dabce28ed8e6998",
    "user": {
      "login": "NicolasDorier",
      "id": 3020646,
      "node_id": "MDQ6VXNlcjMwMjA2NDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3020646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NicolasDorier",
      "html_url": "https://github.com/NicolasDorier",
      "followers_url": "https://api.github.com/users/NicolasDorier/followers",
      "following_url": "https://api.github.com/users/NicolasDorier/following{/other_user}",
      "gists_url": "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NicolasDorier/subscriptions",
      "organizations_url": "https://api.github.com/users/NicolasDorier/orgs",
      "repos_url": "https://api.github.com/users/NicolasDorier/repos",
      "events_url": "https://api.github.com/users/NicolasDorier/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NicolasDorier/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "not sure it make sense either, but if it is done, better naming it to `CWalletRef` to be consistent with `CTransactionRef`",
    "created_at": "2017-04-12T09:47:31Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r111107294",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111107294"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r111107294"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111107294/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 33,
    "side": "RIGHT",
    "in_reply_to_id": 107046358
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111109013",
    "pull_request_review_id": 32328960,
    "id": 111109013,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExMTEwOTAxMw==",
    "diff_hunk": "@@ -418,6 +418,7 @@ bool SoftSetArg(const std::string& strArg, const std::string& strValue)\n     if (mapArgs.count(strArg))\n         return false;\n     mapArgs[strArg] = strValue;\n+    _mapMultiArgs[strArg].push_back(strValue);",
    "path": "src/util.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "3f096ca2cad68c8bc66a15142dabce28ed8e6998",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> It can't get here unless the list is currently empty.\r\n\r\nGood point",
    "created_at": "2017-04-12T09:55:52Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r111109013",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111109013"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r111109013"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111109013/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 421,
    "side": "RIGHT",
    "in_reply_to_id": 105344494
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111109604",
    "pull_request_review_id": 32329623,
    "id": 111109604,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExMTEwOTYwNA==",
    "diff_hunk": "@@ -29,7 +29,8 @@\n \n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n-    return pwalletMain;\n+    // TODO: Some way to access secondary wallets\n+    return vpwallets.empty() ? NULL : vpwallets[0];",
    "path": "src/wallet/rpcwallet.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "3f096ca2cad68c8bc66a15142dabce28ed8e6998",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "s/NULL/nullptr?",
    "created_at": "2017-04-12T09:58:42Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r111109604",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111109604"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r111109604"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111109604/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 33,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111113071",
    "pull_request_review_id": 32333487,
    "id": 111113071,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExMTExMzA3MQ==",
    "diff_hunk": "@@ -442,30 +442,40 @@ bool CWallet::Verify()\n     if (GetBoolArg(\"-disablewallet\", DEFAULT_DISABLE_WALLET))\n         return true;\n \n+    SoftSetArg(\"-wallet\", DEFAULT_WALLET_DAT);\n+\n     uiInterface.InitMessage(_(\"Verifying wallet...\"));\n-    std::string walletFile = GetArg(\"-wallet\", DEFAULT_WALLET_DAT);\n \n-    std::string strError;\n-    if (!CWalletDB::VerifyEnvironment(walletFile, GetDataDir().string(), strError))\n-        return InitError(strError);\n+    for (const std::string& walletFile : mapMultiArgs.at(\"-wallet\")) {\n+        if (walletFile.find_first_of(\"/\\\\\") != std::string::npos) {",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 22,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "3f096ca2cad68c8bc66a15142dabce28ed8e6998",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`walletFile.find_first_of(\"/\\\\\")` is not portable. Likely, boost::filesystem::path has a way to check a path for path separators.",
    "created_at": "2017-04-12T10:17:36Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r111113071",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111113071"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r111113071"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111113071/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 457,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111972028",
    "pull_request_review_id": 33251234,
    "id": 111972028,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExMTk3MjAyOA==",
    "diff_hunk": "@@ -103,42 +94,40 @@ bool CWalletDB::WriteCryptedKey(const CPubKey& vchPubKey,\n         Erase(std::make_pair(std::string(\"key\"), vchPubKey));\n         Erase(std::make_pair(std::string(\"wkey\"), vchPubKey));\n     }\n+\n+    IncrementUpdateCounter();",
    "path": "src/wallet/walletdb.cpp",
    "position": null,
    "original_position": 75,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "f1052c224c9ea7699dac4d2fba988b3a8ef2224b",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I agree, but it's outside the scope of this PR. For now, I'll just increment the counter more aggressively (merely reordering the increment to fix the race issue).",
    "created_at": "2017-04-18T14:41:59Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r111972028",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111972028"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r111972028"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111972028/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 98,
    "side": "RIGHT",
    "in_reply_to_id": 105461051
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111973532",
    "pull_request_review_id": 33252999,
    "id": 111973532,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExMTk3MzUzMg==",
    "diff_hunk": "@@ -29,7 +29,8 @@\n \n CWallet *GetWalletForJSONRPCRequest(const JSONRPCRequest& request)\n {\n-    return pwalletMain;\n+    // TODO: Some way to access secondary wallets",
    "path": "src/wallet/rpcwallet.cpp",
    "position": 5,
    "original_position": 5,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "3f096ca2cad68c8bc66a15142dabce28ed8e6998",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It is not always an error for there to be no wallet (eg, signrawtransaction).",
    "created_at": "2017-04-18T14:47:22Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r111973532",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111973532"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r111973532"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111973532/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 36,
    "original_line": 36,
    "side": "RIGHT",
    "in_reply_to_id": 111106307
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111981623",
    "pull_request_review_id": 33261811,
    "id": 111981623,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExMTk4MTYyMw==",
    "diff_hunk": "@@ -442,30 +442,40 @@ bool CWallet::Verify()\n     if (GetBoolArg(\"-disablewallet\", DEFAULT_DISABLE_WALLET))\n         return true;\n \n+    SoftSetArg(\"-wallet\", DEFAULT_WALLET_DAT);\n+\n     uiInterface.InitMessage(_(\"Verifying wallet...\"));\n-    std::string walletFile = GetArg(\"-wallet\", DEFAULT_WALLET_DAT);\n \n-    std::string strError;\n-    if (!CWalletDB::VerifyEnvironment(walletFile, GetDataDir().string(), strError))\n-        return InitError(strError);\n+    for (const std::string& walletFile : mapMultiArgs.at(\"-wallet\")) {\n+        if (walletFile.find_first_of(\"/\\\\\") != std::string::npos) {",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 22,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "3f096ca2cad68c8bc66a15142dabce28ed8e6998",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "```C++\r\n        boost::filesystem::path walletFileBoost = walletFile;\r\n        if (walletFileBoost.has_root_path() || walletFileBoost.has_parent_path()) {\r\n```\r\n\r\nThis would work, but off-topic here since this is existing code.",
    "created_at": "2017-04-18T15:15:30Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r111981623",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111981623"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r111981623"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111981623/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 457,
    "side": "RIGHT",
    "in_reply_to_id": 111113071
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111981973",
    "pull_request_review_id": 33262204,
    "id": 111981973,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExMTk4MTk3Mw==",
    "diff_hunk": "@@ -418,6 +418,7 @@ bool SoftSetArg(const std::string& strArg, const std::string& strValue)\n     if (mapArgs.count(strArg))\n         return false;\n     mapArgs[strArg] = strValue;\n+    _mapMultiArgs[strArg].push_back(strValue);",
    "path": "src/util.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "3f096ca2cad68c8bc66a15142dabce28ed8e6998",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@TheBlueMatt I don't see what your concern is... We have the lock here already.",
    "created_at": "2017-04-18T15:16:39Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r111981973",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111981973"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r111981973"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/111981973/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 421,
    "side": "RIGHT",
    "in_reply_to_id": 105344494
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/112005561",
    "pull_request_review_id": 33287575,
    "id": 112005561,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExMjAwNTU2MQ==",
    "diff_hunk": "@@ -484,6 +485,8 @@ void ForceSetArg(const std::string& strArg, const std::string& strValue)\n {\n     LOCK(cs_args);\n     mapArgs[strArg] = strValue;\n+    _mapMultiArgs[strArg].clear();",
    "path": "src/util.cpp",
    "position": null,
    "original_position": 12,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "20e5bfc444f736ee466a21fa9c28645e67d7d070",
    "user": {
      "login": "jtimon",
      "id": 1008458,
      "node_id": "MDQ6VXNlcjEwMDg0NTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1008458?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtimon",
      "html_url": "https://github.com/jtimon",
      "followers_url": "https://api.github.com/users/jtimon/followers",
      "following_url": "https://api.github.com/users/jtimon/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtimon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtimon/subscriptions",
      "organizations_url": "https://api.github.com/users/jtimon/orgs",
      "repos_url": "https://api.github.com/users/jtimon/repos",
      "events_url": "https://api.github.com/users/jtimon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtimon/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "why clear here? afaik this is only used for unittests now.",
    "created_at": "2017-04-18T16:48:17Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r112005561",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/112005561"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r112005561"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/112005561/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 488,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/112024031",
    "pull_request_review_id": 33307464,
    "id": 112024031,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExMjAyNDAzMQ==",
    "diff_hunk": "@@ -484,6 +485,8 @@ void ForceSetArg(const std::string& strArg, const std::string& strValue)\n {\n     LOCK(cs_args);\n     mapArgs[strArg] = strValue;\n+    _mapMultiArgs[strArg].clear();",
    "path": "src/util.cpp",
    "position": null,
    "original_position": 12,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "20e5bfc444f736ee466a21fa9c28645e67d7d070",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "So that there's only one value in _mapMultiArgs...",
    "created_at": "2017-04-18T18:06:02Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r112024031",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/112024031"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r112024031"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/112024031/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 488,
    "side": "RIGHT",
    "in_reply_to_id": 112005561
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/113726806",
    "pull_request_review_id": 35140414,
    "id": 113726806,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExMzcyNjgwNg==",
    "diff_hunk": "@@ -418,6 +418,7 @@ bool SoftSetArg(const std::string& strArg, const std::string& strValue)\n     if (mapArgs.count(strArg))\n         return false;\n     mapArgs[strArg] = strValue;\n+    _mapMultiArgs[strArg].push_back(strValue);",
    "path": "src/util.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "3f096ca2cad68c8bc66a15142dabce28ed8e6998",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "We do not take the lock when accessing mapMultiArgs all over the codebase. You cannot write a new entry to this map without updating the various locations in the codebase which access mapMultiArgs to also go through cs_args.",
    "created_at": "2017-04-27T15:24:37Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r113726806",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/113726806"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r113726806"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/113726806/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 421,
    "side": "RIGHT",
    "in_reply_to_id": 105344494
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/117797621",
    "pull_request_review_id": 39534562,
    "id": 117797621,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExNzc5NzYyMQ==",
    "diff_hunk": "@@ -247,6 +245,7 @@ class CWalletDB\n     bool WriteVersion(int nVersion);\n private:\n     CDB batch;\n+    CWalletDBWrapper& wrapper;",
    "path": "src/wallet/walletdb.h",
    "position": null,
    "original_position": 40,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "ca8d241af308ef186786dac80403ed329fbc4172",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"CWalletDB: Store the update counter per wallet\"\r\n\r\nMight be nice to call this member dbw instead of wrapper for consistency with the wallet member.",
    "created_at": "2017-05-22T17:09:16Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r117797621",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/117797621"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r117797621"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/117797621/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 248,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/117798167",
    "pull_request_review_id": 39534562,
    "id": 117798167,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExNzc5ODE2Nw==",
    "diff_hunk": "@@ -140,6 +140,27 @@ class CKeyMetadata\n  */\n class CWalletDB\n {\n+private:\n+    template <typename K, typename T>\n+    bool WriteIC(const K& key, const T& value, bool fOverwrite = true)\n+    {\n+        if (!batch.Write(key, value, fOverwrite)) {\n+            return false;\n+        }\n+        IncrementUpdateCounter();",
    "path": "src/wallet/walletdb.h",
    "position": null,
    "original_position": 11,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "7772f23ad5b1dfe1ed0a3177ef965592ec27f67d",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Bugfix: wallet: Increment \"update counter\" only after actually making the applicable db changes to avoid potential races\"\r\n\r\nWould be helpful to have a comment mentioning that counter should be updated after the write operation, rather than before to prevent a race where the flush thread could run and store the higher counter value before the database is fully updated.\r\n\r\nCould also mention the idea of moving the counter increment to the destructor / commit function so these write and erase wrappers would be unnecessary.",
    "created_at": "2017-05-22T17:12:00Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r117798167",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/117798167"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r117798167"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/117798167/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 150,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/117800249",
    "pull_request_review_id": 39534562,
    "id": 117800249,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExNzgwMDI0OQ==",
    "diff_hunk": "@@ -122,11 +122,15 @@ class CWalletDBWrapper\n     void IncrementUpdateCounter();\n     unsigned int GetUpdateCounter();\n \n+    std::atomic<unsigned int> nUpdateCounter;\n+    unsigned int nLastSeen;\n+    unsigned int nLastFlushed;\n+    int64_t nLastWalletUpdate;",
    "path": "src/wallet/db.h",
    "position": null,
    "original_position": 7,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "68bc5b926fadbe1d904b5138dc299d2dd06fdead",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Wallet: Replace pwalletMain with a vector of wallet pointers\"\r\n\r\nIt would be nice if conversion of these values from static variables to per-wallet members happened in the previous commit (\"CWalletDB: Store the update counter per wallet\") instead of this one. Would make both commits easier to follow and avoid the unusual intermediate state where globals and per-wallet members are compared to each other.",
    "created_at": "2017-05-22T17:21:53Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r117800249",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/117800249"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r117800249"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/117800249/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 128,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/117801976",
    "pull_request_review_id": 39534562,
    "id": 117801976,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExNzgwMTk3Ng==",
    "diff_hunk": "@@ -122,11 +122,15 @@ class CWalletDBWrapper\n     void IncrementUpdateCounter();\n     unsigned int GetUpdateCounter();\n \n+    std::atomic<unsigned int> nUpdateCounter;\n+    unsigned int nLastSeen;",
    "path": "src/wallet/db.h",
    "position": null,
    "original_position": 5,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "68bc5b926fadbe1d904b5138dc299d2dd06fdead",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Wallet: Replace pwalletMain with a vector of wallet pointers\"\r\n\r\nShould initialize these values.",
    "created_at": "2017-05-22T17:30:01Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r117801976",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/117801976"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r117801976"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/117801976/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 126,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/117802544",
    "pull_request_review_id": 39534562,
    "id": 117802544,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExNzgwMjU0NA==",
    "diff_hunk": "@@ -119,10 +119,14 @@ class CWalletDBWrapper\n      */\n     void Flush(bool shutdown);\n \n+    void IncrementUpdateCounter();\n+    unsigned int GetUpdateCounter();\n+\n private:\n     /** BerkeleyDB specific */\n     CDBEnv *env;\n     std::string strFile;\n+    std::atomic<unsigned int> nUpdateCounter;",
    "path": "src/wallet/db.h",
    "position": null,
    "original_position": 11,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "ca8d241af308ef186786dac80403ed329fbc4172",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"CWalletDB: Store the update counter per wallet\":\r\n\r\nShould initialize this value.",
    "created_at": "2017-05-22T17:32:57Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r117802544",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/117802544"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r117802544"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/117802544/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 129,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/117803568",
    "pull_request_review_id": 39534562,
    "id": 117803568,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExNzgwMzU2OA==",
    "diff_hunk": "@@ -762,20 +760,22 @@ void MaybeCompactWalletDB()\n         return;\n     }\n \n-    static unsigned int nLastSeen = CWalletDB::GetUpdateCounter();\n-    static unsigned int nLastFlushed = CWalletDB::GetUpdateCounter();\n+    CWalletDBWrapper& dbh = pwalletMain->GetDBHandle();",
    "path": "src/wallet/walletdb.cpp",
    "position": null,
    "original_position": 15,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "ca8d241af308ef186786dac80403ed329fbc4172",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"CWalletDB: Store the update counter per wallet\"\r\n\r\nMaybe call this dbw for consistency with existing wallet code.",
    "created_at": "2017-05-22T17:37:14Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r117803568",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/117803568"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r117803568"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/117803568/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 763,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118176576",
    "pull_request_review_id": 39941364,
    "id": 118176576,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExODE3NjU3Ng==",
    "diff_hunk": "@@ -440,30 +440,40 @@ bool CWallet::Verify()\n     if (GetBoolArg(\"-disablewallet\", DEFAULT_DISABLE_WALLET))\n         return true;\n \n+    SoftSetArg(\"-wallet\", DEFAULT_WALLET_DAT);\n+\n     uiInterface.InitMessage(_(\"Verifying wallet...\"));\n-    std::string walletFile = GetArg(\"-wallet\", DEFAULT_WALLET_DAT);\n \n-    std::string strError;\n-    if (!CWalletDB::VerifyEnvironment(walletFile, GetDataDir().string(), strError))\n-        return InitError(strError);\n+    for (const std::string& walletFile : gArgs.GetArgs(\"-wallet\")) {\n+        if (boost::filesystem::path(walletFile).filename() != walletFile) {\n+            return InitError(_(\"-wallet parameter must only specify a filename (not a path)\"));\n+        } else if (SanitizeString(walletFile, SAFE_CHARS_FILENAME) != walletFile) {\n+            return InitError(_(\"Invalid characters in -wallet filename\"));\n+        }\n \n-    if (GetBoolArg(\"-salvagewallet\", false))\n-    {\n-        // Recover readable keypairs:\n-        CWallet dummyWallet;\n-        if (!CWalletDB::Recover(walletFile, (void *)&dummyWallet, CWalletDB::RecoverKeysOnlyFilter))\n+        std::string strError;\n+        if (!CWalletDB::VerifyEnvironment(walletFile, GetDataDir().string(), strError))",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 34,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "96089fffd8d4bea24b83d253e0540b9836bef2ef",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This redundantly opens/checks the datadir via BDB. Not sure if this is a problem...",
    "created_at": "2017-05-24T07:03:58Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r118176576",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118176576"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r118176576"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118176576/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 455,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118183947",
    "pull_request_review_id": 39949204,
    "id": 118183947,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExODE4Mzk0Nw==",
    "diff_hunk": "@@ -785,22 +760,23 @@ void MaybeCompactWalletDB()\n         return;\n     }\n \n-    static unsigned int nLastSeen = CWalletDB::GetUpdateCounter();\n-    static unsigned int nLastFlushed = CWalletDB::GetUpdateCounter();\n-    static int64_t nLastWalletUpdate = GetTime();\n+    for (CWalletRef pwallet : vpwallets) {",
    "path": "src/wallet/walletdb.cpp",
    "position": 229,
    "original_position": 222,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "96089fffd8d4bea24b83d253e0540b9836bef2ef",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Without a lock we set the assumption that `vpwallets` is immutable.",
    "created_at": "2017-05-24T07:48:26Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r118183947",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118183947"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r118183947"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118183947/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 766,
    "original_line": 766,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118184966",
    "pull_request_review_id": 39950256,
    "id": 118184966,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExODE4NDk2Ng==",
    "diff_hunk": "@@ -440,30 +440,40 @@ bool CWallet::Verify()\n     if (GetBoolArg(\"-disablewallet\", DEFAULT_DISABLE_WALLET))\n         return true;\n \n+    SoftSetArg(\"-wallet\", DEFAULT_WALLET_DAT);\n+\n     uiInterface.InitMessage(_(\"Verifying wallet...\"));",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 15,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "96089fffd8d4bea24b83d253e0540b9836bef2ef",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: using `Verifying wallet(s)...`?",
    "created_at": "2017-05-24T07:53:54Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r118184966",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118184966"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r118184966"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118184966/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 445,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118185652",
    "pull_request_review_id": 39951010,
    "id": 118185652,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExODE4NTY1Mg==",
    "diff_hunk": "@@ -440,30 +440,40 @@ bool CWallet::Verify()\n     if (GetBoolArg(\"-disablewallet\", DEFAULT_DISABLE_WALLET))\n         return true;\n \n+    SoftSetArg(\"-wallet\", DEFAULT_WALLET_DAT);\n+\n     uiInterface.InitMessage(_(\"Verifying wallet...\"));\n-    std::string walletFile = GetArg(\"-wallet\", DEFAULT_WALLET_DAT);\n \n-    std::string strError;\n-    if (!CWalletDB::VerifyEnvironment(walletFile, GetDataDir().string(), strError))\n-        return InitError(strError);\n+    for (const std::string& walletFile : gArgs.GetArgs(\"-wallet\")) {\n+        if (boost::filesystem::path(walletFile).filename() != walletFile) {\n+            return InitError(_(\"-wallet parameter must only specify a filename (not a path)\"));\n+        } else if (SanitizeString(walletFile, SAFE_CHARS_FILENAME) != walletFile) {\n+            return InitError(_(\"Invalid characters in -wallet filename\"));\n+        }\n \n-    if (GetBoolArg(\"-salvagewallet\", false))\n-    {\n-        // Recover readable keypairs:\n-        CWallet dummyWallet;\n-        if (!CWalletDB::Recover(walletFile, (void *)&dummyWallet, CWalletDB::RecoverKeysOnlyFilter))\n+        std::string strError;\n+        if (!CWalletDB::VerifyEnvironment(walletFile, GetDataDir().string(), strError))\n+            return InitError(strError);\n+\n+        if (GetBoolArg(\"-salvagewallet\", false))\n+        {\n+            // Recover readable keypairs:\n+            CWallet dummyWallet;\n+            if (!CWalletDB::Recover(walletFile, (void *)&dummyWallet, CWalletDB::RecoverKeysOnlyFilter))",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 41,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "96089fffd8d4bea24b83d253e0540b9836bef2ef",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This renames an arbitrary wallet name to \"wallet.%d.bak\", collisions may happen.\r\n\r\n`2017-05-24 07:56:04 Renamed test1.dat to wallet.1495612559.bak`",
    "created_at": "2017-05-24T07:57:40Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r118185652",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118185652"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r118185652"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118185652/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 462,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118185864",
    "pull_request_review_id": 39951252,
    "id": 118185864,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExODE4NTg2NA==",
    "diff_hunk": "@@ -440,30 +440,40 @@ bool CWallet::Verify()\n     if (GetBoolArg(\"-disablewallet\", DEFAULT_DISABLE_WALLET))\n         return true;\n \n+    SoftSetArg(\"-wallet\", DEFAULT_WALLET_DAT);\n+\n     uiInterface.InitMessage(_(\"Verifying wallet...\"));\n-    std::string walletFile = GetArg(\"-wallet\", DEFAULT_WALLET_DAT);\n \n-    std::string strError;\n-    if (!CWalletDB::VerifyEnvironment(walletFile, GetDataDir().string(), strError))\n-        return InitError(strError);\n+    for (const std::string& walletFile : gArgs.GetArgs(\"-wallet\")) {\n+        if (boost::filesystem::path(walletFile).filename() != walletFile) {\n+            return InitError(_(\"-wallet parameter must only specify a filename (not a path)\"));\n+        } else if (SanitizeString(walletFile, SAFE_CHARS_FILENAME) != walletFile) {\n+            return InitError(_(\"Invalid characters in -wallet filename\"));\n+        }\n \n-    if (GetBoolArg(\"-salvagewallet\", false))\n-    {\n-        // Recover readable keypairs:\n-        CWallet dummyWallet;\n-        if (!CWalletDB::Recover(walletFile, (void *)&dummyWallet, CWalletDB::RecoverKeysOnlyFilter))\n+        std::string strError;\n+        if (!CWalletDB::VerifyEnvironment(walletFile, GetDataDir().string(), strError))\n+            return InitError(strError);\n+\n+        if (GetBoolArg(\"-salvagewallet\", false))\n+        {\n+            // Recover readable keypairs:\n+            CWallet dummyWallet;\n+            if (!CWalletDB::Recover(walletFile, (void *)&dummyWallet, CWalletDB::RecoverKeysOnlyFilter))",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 41,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "96089fffd8d4bea24b83d253e0540b9836bef2ef",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Maybe we should use `<filename>.<date>.bak` (will result in something like `test1.dat.1495612559.bak` (which is preferable IMO).",
    "created_at": "2017-05-24T07:58:58Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r118185864",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118185864"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r118185864"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118185864/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 462,
    "side": "RIGHT",
    "in_reply_to_id": 118185652
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118586960",
    "pull_request_review_id": 40394941,
    "id": 118586960,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExODU4Njk2MA==",
    "diff_hunk": "@@ -22,57 +22,45 @@\n #include <boost/foreach.hpp>\n #include <boost/thread.hpp>\n \n-static uint64_t nAccountingEntryNumber = 0;\n-\n-static std::atomic<unsigned int> nWalletDBUpdateCounter;\n-\n //\n // CWalletDB\n //\n \n bool CWalletDB::WriteName(const std::string& strAddress, const std::string& strName)\n {\n-    nWalletDBUpdateCounter++;\n-    return batch.Write(std::make_pair(std::string(\"name\"), strAddress), strName);\n+    return WriteIC(std::make_pair(std::string(\"name\"), strAddress), strName);\n }\n \n bool CWalletDB::EraseName(const std::string& strAddress)\n {\n     // This should only be used for sending addresses, never for receiving addresses,\n     // receiving addresses must always have an address book entry if they're not change return.\n-    nWalletDBUpdateCounter++;\n-    return batch.Erase(std::make_pair(std::string(\"name\"), strAddress));\n+    return EraseIC(std::make_pair(std::string(\"name\"), strAddress));\n }\n \n bool CWalletDB::WritePurpose(const std::string& strAddress, const std::string& strPurpose)\n {\n-    nWalletDBUpdateCounter++;\n-    return batch.Write(std::make_pair(std::string(\"purpose\"), strAddress), strPurpose);\n+    return WriteIC(std::make_pair(std::string(\"purpose\"), strAddress), strPurpose);\n }\n \n bool CWalletDB::ErasePurpose(const std::string& strPurpose)\n {\n-    nWalletDBUpdateCounter++;\n-    return batch.Erase(std::make_pair(std::string(\"purpose\"), strPurpose));\n+    return EraseIC(std::make_pair(std::string(\"purpose\"), strPurpose));\n }\n \n bool CWalletDB::WriteTx(const CWalletTx& wtx)\n {\n-    nWalletDBUpdateCounter++;\n-    return batch.Write(std::make_pair(std::string(\"tx\"), wtx.GetHash()), wtx);\n+    return WriteIC(std::make_pair(std::string(\"tx\"), wtx.GetHash()), wtx);\n }\n \n bool CWalletDB::EraseTx(uint256 hash)\n {\n-    nWalletDBUpdateCounter++;\n-    return batch.Erase(std::make_pair(std::string(\"tx\"), hash));\n+    return EraseIC(std::make_pair(std::string(\"tx\"), hash));\n }\n \n bool CWalletDB::WriteKey(const CPubKey& vchPubKey, const CPrivKey& vchPrivKey, const CKeyMetadata& keyMeta)\n {\n-    nWalletDBUpdateCounter++;\n-\n-    if (!batch.Write(std::make_pair(std::string(\"keymeta\"), vchPubKey),\n+    if (!WriteIC(std::make_pair(std::string(\"keymeta\"), vchPubKey),",
    "path": "src/wallet/walletdb.cpp",
    "position": null,
    "original_position": 61,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "96089fffd8d4bea24b83d253e0540b9836bef2ef",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Please update to use braces. You can also combine this line with the one below.\r\n\r\nSeveral other if statements below which you can update to use braces.",
    "created_at": "2017-05-25T21:15:34Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r118586960",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118586960"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r118586960"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118586960/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 63,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118987521",
    "pull_request_review_id": 40394941,
    "id": 118987521,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExODk4NzUyMQ==",
    "diff_hunk": "@@ -434,6 +434,16 @@ void CDB::Flush()\n     env->dbenv->txn_checkpoint(nMinutes ? GetArg(\"-dblogsize\", DEFAULT_WALLET_DBLOGSIZE) * 1024 : 0, nMinutes, 0);\n }\n \n+void CWalletDBWrapper::IncrementUpdateCounter()\n+{\n+    ++nUpdateCounter;\n+}\n+\n+unsigned int CWalletDBWrapper::GetUpdateCounter()",
    "path": "src/wallet/db.cpp",
    "position": null,
    "original_position": 9,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "96089fffd8d4bea24b83d253e0540b9836bef2ef",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "You've changed `MaybeCompactWalletDB()` to access `CDB::nUpdateCounter` directly, so this function isn't used.",
    "created_at": "2017-05-29T21:26:28Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r118987521",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118987521"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r118987521"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118987521/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 442,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118991629",
    "pull_request_review_id": 40394941,
    "id": 118991629,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDExODk5MTYyOQ==",
    "diff_hunk": "@@ -440,30 +440,40 @@ bool CWallet::Verify()\n     if (GetBoolArg(\"-disablewallet\", DEFAULT_DISABLE_WALLET))\n         return true;\n \n+    SoftSetArg(\"-wallet\", DEFAULT_WALLET_DAT);\n+\n     uiInterface.InitMessage(_(\"Verifying wallet...\"));\n-    std::string walletFile = GetArg(\"-wallet\", DEFAULT_WALLET_DAT);\n \n-    std::string strError;\n-    if (!CWalletDB::VerifyEnvironment(walletFile, GetDataDir().string(), strError))\n-        return InitError(strError);\n+    for (const std::string& walletFile : gArgs.GetArgs(\"-wallet\")) {\n+        if (boost::filesystem::path(walletFile).filename() != walletFile) {\n+            return InitError(_(\"-wallet parameter must only specify a filename (not a path)\"));\n+        } else if (SanitizeString(walletFile, SAFE_CHARS_FILENAME) != walletFile) {\n+            return InitError(_(\"Invalid characters in -wallet filename\"));\n+        }\n \n-    if (GetBoolArg(\"-salvagewallet\", false))\n-    {\n-        // Recover readable keypairs:\n-        CWallet dummyWallet;\n-        if (!CWalletDB::Recover(walletFile, (void *)&dummyWallet, CWalletDB::RecoverKeysOnlyFilter))\n+        std::string strError;\n+        if (!CWalletDB::VerifyEnvironment(walletFile, GetDataDir().string(), strError))\n+            return InitError(strError);\n+\n+        if (GetBoolArg(\"-salvagewallet\", false))\n+        {\n+            // Recover readable keypairs:\n+            CWallet dummyWallet;\n+            if (!CWalletDB::Recover(walletFile, (void *)&dummyWallet, CWalletDB::RecoverKeysOnlyFilter))",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 41,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "96089fffd8d4bea24b83d253e0540b9836bef2ef",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I agree with @jonasschnelli . This seems dangerous if `Recover()` or `VerifyDatabaseFile()` is called for multiple wallets. Should be straightforward to update `Recover()` to name the backup file uniquely (the warning string in `VerifyDatabaseFile()` will also need to be updated)",
    "created_at": "2017-05-29T22:50:29Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r118991629",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118991629"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r118991629"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/118991629/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 462,
    "side": "RIGHT",
    "in_reply_to_id": 118185652
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120211039",
    "pull_request_review_id": 42155117,
    "id": 120211039,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMDIxMTAzOQ==",
    "diff_hunk": "@@ -119,10 +119,14 @@ class CWalletDBWrapper\n      */\n     void Flush(bool shutdown);\n \n+    void IncrementUpdateCounter();\n+    unsigned int GetUpdateCounter();\n+\n private:\n     /** BerkeleyDB specific */\n     CDBEnv *env;\n     std::string strFile;\n+    std::atomic<unsigned int> nUpdateCounter;",
    "path": "src/wallet/db.h",
    "position": null,
    "original_position": 11,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "ca8d241af308ef186786dac80403ed329fbc4172",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It's an atomic, should have a default constructor?",
    "created_at": "2017-06-05T21:11:19Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r120211039",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120211039"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r120211039"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120211039/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 129,
    "side": "RIGHT",
    "in_reply_to_id": 117802544
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120212883",
    "pull_request_review_id": 42157117,
    "id": 120212883,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMDIxMjg4Mw==",
    "diff_hunk": "@@ -119,10 +119,14 @@ class CWalletDBWrapper\n      */\n     void Flush(bool shutdown);\n \n+    void IncrementUpdateCounter();\n+    unsigned int GetUpdateCounter();\n+\n private:\n     /** BerkeleyDB specific */\n     CDBEnv *env;\n     std::string strFile;\n+    std::atomic<unsigned int> nUpdateCounter;",
    "path": "src/wallet/db.h",
    "position": null,
    "original_position": 11,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "ca8d241af308ef186786dac80403ed329fbc4172",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> It's an atomic, should have a default constructor?\r\n\r\nYes but it seems to not initialize the value, see\r\nhttps://stackoverflow.com/questions/36320008/whats-the-default-value-for-a-stdatomic or http://en.cppreference.com/w/cpp/atomic/atomic/atomic. IMO, adding `= 0` to this line would make the code clearer anyway.",
    "created_at": "2017-06-05T21:20:24Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r120212883",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120212883"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r120212883"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120212883/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 129,
    "side": "RIGHT",
    "in_reply_to_id": 117802544
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120379039",
    "pull_request_review_id": 42336053,
    "id": 120379039,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMDM3OTAzOQ==",
    "diff_hunk": "@@ -19,6 +19,8 @@\n #include <boost/test/unit_test.hpp>\n #include <univalue.h>\n \n+extern CWallet* pwalletMain;",
    "path": "src/wallet/test/wallet_tests.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "574e44eab4fd440c11e67538e57964f3862eca52",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Replace pwalletMain with a vector of wallet\"\r\n\r\nThis can probably be removed after the importwallet_rescan test is updated.",
    "created_at": "2017-06-06T14:36:59Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r120379039",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120379039"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r120379039"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120379039/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 22,
    "original_line": 22,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120381177",
    "pull_request_review_id": 42336053,
    "id": 120381177,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMDM4MTE3Nw==",
    "diff_hunk": "@@ -439,11 +439,6 @@ void CWalletDBWrapper::IncrementUpdateCounter()\n     ++nUpdateCounter;\n }\n \n-unsigned int CWalletDBWrapper::GetUpdateCounter()",
    "path": "src/wallet/db.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "60c5a3778d7497adad27f704842a096d61d6a765",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Wallet: Support loading multiple wallets if -wallet used more than once\"\r\n\r\nRemoving GetUpdateCounter in this commit isn't related to the rest of the changes here. This change was probably meant for the \"CWalletDB: Store the update counter per wallet\" commit.",
    "created_at": "2017-06-06T14:44:02Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r120381177",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120381177"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r120381177"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120381177/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 442,
    "side": "LEFT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120384212",
    "pull_request_review_id": 42336053,
    "id": 120384212,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMDM4NDIxMg==",
    "diff_hunk": "@@ -440,30 +440,40 @@ bool CWallet::Verify()\n     if (GetBoolArg(\"-disablewallet\", DEFAULT_DISABLE_WALLET))\n         return true;\n \n-    uiInterface.InitMessage(_(\"Verifying wallet...\"));\n-    std::string walletFile = GetArg(\"-wallet\", DEFAULT_WALLET_DAT);\n+    SoftSetArg(\"-wallet\", DEFAULT_WALLET_DAT);",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "4c0f78c44df11aa3fed735f20cf51e1cc4d39dcf",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Wallet: Move multiwallet sanity checks to CWallet::Verify\"\r\n\r\nConsider squashing this commit into previous commit \"Wallet: Support loading multiple wallets if -wallet used more than once\", because the two commits are making parallel sets changes, and having them separate makes the interaction confusing to think about.",
    "created_at": "2017-06-06T14:53:28Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r120384212",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120384212"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r120384212"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120384212/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 443,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120385084",
    "pull_request_review_id": 42336053,
    "id": 120385084,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMDM4NTA4NA==",
    "diff_hunk": "@@ -122,11 +122,15 @@ class CWalletDBWrapper\n     void IncrementUpdateCounter();\n     unsigned int GetUpdateCounter();\n \n+    std::atomic<unsigned int> nUpdateCounter;\n+    unsigned int nLastSeen;",
    "path": "src/wallet/db.h",
    "position": null,
    "original_position": 5,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "68bc5b926fadbe1d904b5138dc299d2dd06fdead",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> Should initialize these values.\r\n\r\nNote: comment no longer applies. This is now done in two CWalletDBWrapper constructors.",
    "created_at": "2017-06-06T14:56:25Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r120385084",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120385084"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r120385084"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120385084/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 126,
    "side": "RIGHT",
    "in_reply_to_id": 117801976
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120387244",
    "pull_request_review_id": 42336053,
    "id": 120387244,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMDM4NzI0NA==",
    "diff_hunk": "@@ -825,7 +825,7 @@ bool CWalletDB::VerifyEnvironment(const std::string& walletFile, const fs::path&\n \n bool CWalletDB::VerifyDatabaseFile(const std::string& walletFile, const fs::path& dataDir, std::string& warningStr, std::string& errorStr)\n {\n-    return CDB::VerifyDatabaseFile(walletFile, dataDir, errorStr, warningStr, CWalletDB::Recover);\n+    return CDB::VerifyDatabaseFile(walletFile, dataDir, warningStr, errorStr, CWalletDB::Recover);",
    "path": "src/wallet/walletdb.cpp",
    "position": 283,
    "original_position": 5,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "9dacebee9eec12c37749fd851bdf1ab32012b9ed",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Bugfix: wallet: Fix warningStr, errorStr argument order\"\r\n\r\nNote: the bug seems to have been introduced in #8574.",
    "created_at": "2017-06-06T15:04:24Z",
    "updated_at": "2017-06-06T21:20:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r120387244",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120387244"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r120387244"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120387244/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 831,
    "original_line": 831,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120755919",
    "pull_request_review_id": 42746733,
    "id": 120755919,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMDc1NTkxOQ==",
    "diff_hunk": "@@ -3972,15 +3979,27 @@ bool CWallet::ParameterInteraction()\n     }\n \n     if (GetBoolArg(\"-salvagewallet\", false) && SoftSetBoolArg(\"-rescan\", true)) {\n+        if (is_multiwallet) {\n+            return InitError(strprintf(\"%s is only allowed with a single wallet file\", \"-salvagewallet\"));",
    "path": "src/wallet/wallet.cpp",
    "position": 135,
    "original_position": 135,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Here you say that `-salvagewallet` is only for one wallet file, but in `CWallet::Verify()`, the loop through all wallets checks for `-salvagewallet` and recovers all wallets if `-salvagewallet` is set. Which behavior is correct: salvage all wallets, or salvage only if there is one wallet?\r\n\r\nFor the latter, the `-salvagewallet` check in `CWallet::Verify()` can be moved out of the loop.",
    "created_at": "2017-06-07T21:59:27Z",
    "updated_at": "2017-06-07T22:09:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r120755919",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120755919"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r120755919"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120755919/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 3983,
    "original_line": 3983,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120759494",
    "pull_request_review_id": 42750311,
    "id": 120759494,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMDc1OTQ5NA==",
    "diff_hunk": "@@ -3972,15 +3979,27 @@ bool CWallet::ParameterInteraction()\n     }\n \n     if (GetBoolArg(\"-salvagewallet\", false) && SoftSetBoolArg(\"-rescan\", true)) {\n+        if (is_multiwallet) {\n+            return InitError(strprintf(\"%s is only allowed with a single wallet file\", \"-salvagewallet\"));",
    "path": "src/wallet/wallet.cpp",
    "position": 135,
    "original_position": 135,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Both are correct. If we get to ::Verify, we should salvage all wallets. But for now, we forbid this combination. Moving it out of the loop is error-prone, and creates unnecessary complexity.",
    "created_at": "2017-06-07T22:18:51Z",
    "updated_at": "2017-06-07T22:18:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r120759494",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120759494"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r120759494"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/120759494/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 3983,
    "original_line": 3983,
    "side": "RIGHT",
    "in_reply_to_id": 120755919
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/121222897",
    "pull_request_review_id": 43262043,
    "id": 121222897,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyMTIyMjg5Nw==",
    "diff_hunk": "@@ -19,6 +19,8 @@\n #include <boost/test/unit_test.hpp>\n #include <univalue.h>\n \n+extern CWallet* pwalletMain;",
    "path": "src/wallet/test/wallet_tests.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "c237bd750e11472f0f9639891036b975cf7faf15",
    "original_commit_id": "574e44eab4fd440c11e67538e57964f3862eca52",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> This can probably be removed after the importwallet_rescan test is updated.\r\n\r\nNever mind, it's used by the receiverequests test.",
    "created_at": "2017-06-09T21:06:47Z",
    "updated_at": "2017-06-09T21:10:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r121222897",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/121222897"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/8694#discussion_r121222897"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/8694"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/121222897/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 22,
    "original_line": 22,
    "side": "RIGHT",
    "in_reply_to_id": 120379039
  }
]