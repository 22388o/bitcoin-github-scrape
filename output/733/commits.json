[
  {
    "sha": "6ec76ca09efca03236a67db65cbfe44d7c7a878e",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2ZWM3NmNhMDllZmNhMDMyMzZhNjdkYjY1Y2JmZTQ0ZDdjN2E4Nzhl",
    "commit": {
      "author": {
        "name": "coderrr",
        "email": "coderrr.contact@gmail.com",
        "date": "2012-01-02T07:27:41Z"
      },
      "committer": {
        "name": "coderrr",
        "email": "coderrr.contact@gmail.com",
        "date": "2012-01-02T23:24:52Z"
      },
      "message": "make sure IsMine only returns true when we own all keys",
      "tree": {
        "sha": "a7588c2d89de58240713aa72751cffa422455f87",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a7588c2d89de58240713aa72751cffa422455f87"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6ec76ca09efca03236a67db65cbfe44d7c7a878e",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6ec76ca09efca03236a67db65cbfe44d7c7a878e",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/6ec76ca09efca03236a67db65cbfe44d7c7a878e",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6ec76ca09efca03236a67db65cbfe44d7c7a878e/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "625b56de6491170ad6a2e45c57d974fca6160750",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/625b56de6491170ad6a2e45c57d974fca6160750",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/625b56de6491170ad6a2e45c57d974fca6160750"
      }
    ],
    "stats": {
      "total": 7,
      "additions": 5,
      "deletions": 2
    },
    "files": [
      {
        "sha": "34872808b3f156c9aa363eca1778117a7928a005",
        "filename": "src/script.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6ec76ca09efca03236a67db65cbfe44d7c7a878e/src/script.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6ec76ca09efca03236a67db65cbfe44d7c7a878e/src/script.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script.cpp?ref=6ec76ca09efca03236a67db65cbfe44d7c7a878e",
        "patch": "@@ -1436,7 +1436,7 @@ bool IsMine(const CKeyStore &keystore, const CScript& scriptPubKey)\n         // them) enable spend-out-from-under-you attacks, especially\n         // in shared-wallet situations.\n         vector<valtype> keys(vSolutions.begin()+1, vSolutions.begin()+vSolutions.size()-1);\n-        return HaveKeys(vSolutions, keystore);\n+        return HaveKeys(keys, keystore) == keys.size();\n     }\n     }\n     return false;"
      },
      {
        "sha": "0c2e41aeddd463f35651dd7a6aa7889cd867d2a3",
        "filename": "src/test/multisig_tests.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 1,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6ec76ca09efca03236a67db65cbfe44d7c7a878e/src/test/multisig_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6ec76ca09efca03236a67db65cbfe44d7c7a878e/src/test/multisig_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/multisig_tests.cpp?ref=6ec76ca09efca03236a67db65cbfe44d7c7a878e",
        "patch": "@@ -174,7 +174,7 @@ BOOST_AUTO_TEST_CASE(multisig_Solver1)\n     // one key that would satisfy an (a|b) or 2-of-3 keys needed\n     // to spend an escrow transaction.\n     //\n-    CBasicKeyStore keystore, emptykeystore;\n+    CBasicKeyStore keystore, emptykeystore, partialkeystore;\n     CKey key[3];\n     CBitcoinAddress keyaddr[3];\n     for (int i = 0; i < 3; i++)\n@@ -183,6 +183,7 @@ BOOST_AUTO_TEST_CASE(multisig_Solver1)\n         keystore.AddKey(key[i]);\n         keyaddr[i].SetPubKey(key[i].GetPubKey());\n     }\n+    partialkeystore.AddKey(key[0]);\n \n     {\n         vector<valtype> solutions;\n@@ -221,6 +222,7 @@ BOOST_AUTO_TEST_CASE(multisig_Solver1)\n         BOOST_CHECK(!ExtractAddress(s, addr));\n         BOOST_CHECK(IsMine(keystore, s));\n         BOOST_CHECK(!IsMine(emptykeystore, s));\n+        BOOST_CHECK(!IsMine(partialkeystore, s));\n     }\n     {\n         vector<valtype> solutions;\n@@ -237,6 +239,7 @@ BOOST_AUTO_TEST_CASE(multisig_Solver1)\n         BOOST_CHECK(nRequired = 1);\n         BOOST_CHECK(IsMine(keystore, s));\n         BOOST_CHECK(!IsMine(emptykeystore, s));\n+        BOOST_CHECK(!IsMine(partialkeystore, s));\n     }\n     {\n         vector<valtype> solutions;"
      }
    ]
  }
]