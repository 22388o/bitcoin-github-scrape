[
  {
    "sha": "9819ad6d07097ca4df92231e18de0b57313e3b78",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo5ODE5YWQ2ZDA3MDk3Y2E0ZGY5MjIzMWUxOGRlMGI1NzMxM2UzYjc4",
    "commit": {
      "author": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2019-04-04T19:42:50Z"
      },
      "committer": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2019-04-10T15:44:37Z"
      },
      "message": "[rpc] simplify generate RPC\n\nRemoves dead code from after the generate method was removed",
      "tree": {
        "sha": "350d1829a3cbdd5d3219d00473ade7dda3c14a89",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/350d1829a3cbdd5d3219d00473ade7dda3c14a89"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9819ad6d07097ca4df92231e18de0b57313e3b78",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9819ad6d07097ca4df92231e18de0b57313e3b78",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/9819ad6d07097ca4df92231e18de0b57313e3b78",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9819ad6d07097ca4df92231e18de0b57313e3b78/comments",
    "author": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "6a135fbe5b30c3603616589b4779b1ce602c9392",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6a135fbe5b30c3603616589b4779b1ce602c9392",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/6a135fbe5b30c3603616589b4779b1ce602c9392"
      }
    ],
    "stats": {
      "total": 34,
      "additions": 6,
      "deletions": 28
    },
    "files": [
      {
        "sha": "fb429d41d2319eb7ef96d256c79b09f0c13cc7bf",
        "filename": "src/Makefile.am",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/9819ad6d07097ca4df92231e18de0b57313e3b78/src/Makefile.am",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/9819ad6d07097ca4df92231e18de0b57313e3b78/src/Makefile.am",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.am?ref=9819ad6d07097ca4df92231e18de0b57313e3b78",
        "patch": "@@ -174,7 +174,6 @@ BITCOIN_CORE_H = \\\n   reverselock.h \\\n   rpc/blockchain.h \\\n   rpc/client.h \\\n-  rpc/mining.h \\\n   rpc/protocol.h \\\n   rpc/server.h \\\n   rpc/rawtransaction_util.h \\"
      },
      {
        "sha": "4de738a756e6fa74d93567456b69f269ff75b0f8",
        "filename": "src/rpc/mining.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 12,
        "changes": 18,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/9819ad6d07097ca4df92231e18de0b57313e3b78/src/rpc/mining.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/9819ad6d07097ca4df92231e18de0b57313e3b78/src/rpc/mining.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/mining.cpp?ref=9819ad6d07097ca4df92231e18de0b57313e3b78",
        "patch": "@@ -16,11 +16,12 @@\n #include <policy/fees.h>\n #include <pow.h>\n #include <rpc/blockchain.h>\n-#include <rpc/mining.h>\n #include <rpc/server.h>\n #include <rpc/util.h>\n+#include <script/script.h>\n #include <shutdown.h>\n #include <txmempool.h>\n+#include <univalue.h>\n #include <util/fees.h>\n #include <util/strencodings.h>\n #include <util/system.h>\n@@ -100,7 +101,7 @@ static UniValue getnetworkhashps(const JSONRPCRequest& request)\n     return GetNetworkHashPS(!request.params[0].isNull() ? request.params[0].get_int() : 120, !request.params[1].isNull() ? request.params[1].get_int() : -1);\n }\n \n-UniValue generateBlocks(std::shared_ptr<CReserveScript> coinbaseScript, int nGenerate, uint64_t nMaxTries, bool keepScript)\n+static UniValue generateBlocks(const CScript& coinbase_script, int nGenerate, uint64_t nMaxTries)\n {\n     static const int nInnerLoopCount = 0x10000;\n     int nHeightEnd = 0;\n@@ -115,7 +116,7 @@ UniValue generateBlocks(std::shared_ptr<CReserveScript> coinbaseScript, int nGen\n     UniValue blockHashes(UniValue::VARR);\n     while (nHeight < nHeightEnd && !ShutdownRequested())\n     {\n-        std::unique_ptr<CBlockTemplate> pblocktemplate(BlockAssembler(Params()).CreateNewBlock(coinbaseScript->reserveScript));\n+        std::unique_ptr<CBlockTemplate> pblocktemplate(BlockAssembler(Params()).CreateNewBlock(coinbase_script));\n         if (!pblocktemplate.get())\n             throw JSONRPCError(RPC_INTERNAL_ERROR, \"Couldn't create new block\");\n         CBlock *pblock = &pblocktemplate->block;\n@@ -138,12 +139,6 @@ UniValue generateBlocks(std::shared_ptr<CReserveScript> coinbaseScript, int nGen\n             throw JSONRPCError(RPC_INTERNAL_ERROR, \"ProcessNewBlock, block not accepted\");\n         ++nHeight;\n         blockHashes.push_back(pblock->GetHash().GetHex());\n-\n-        //mark script as important because it was used at least for one coinbase output if the script came from the wallet\n-        if (keepScript)\n-        {\n-            coinbaseScript->KeepScript();\n-        }\n     }\n     return blockHashes;\n }\n@@ -181,10 +176,9 @@ static UniValue generatetoaddress(const JSONRPCRequest& request)\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Error: Invalid address\");\n     }\n \n-    std::shared_ptr<CReserveScript> coinbaseScript = std::make_shared<CReserveScript>();\n-    coinbaseScript->reserveScript = GetScriptForDestination(destination);\n+    CScript coinbase_script = GetScriptForDestination(destination);\n \n-    return generateBlocks(coinbaseScript, nGenerate, nMaxTries, false);\n+    return generateBlocks(coinbase_script, nGenerate, nMaxTries);\n }\n \n static UniValue getmininginfo(const JSONRPCRequest& request)"
      },
      {
        "sha": "be9a9733159171cdf6019cfae6040b88fcc2c864",
        "filename": "src/rpc/mining.h",
        "status": "removed",
        "additions": 0,
        "deletions": 15,
        "changes": 15,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6a135fbe5b30c3603616589b4779b1ce602c9392/src/rpc/mining.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6a135fbe5b30c3603616589b4779b1ce602c9392/src/rpc/mining.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/mining.h?ref=6a135fbe5b30c3603616589b4779b1ce602c9392",
        "patch": "@@ -1,15 +0,0 @@\n-// Copyright (c) 2017 The Bitcoin Core developers\n-// Distributed under the MIT software license, see the accompanying\n-// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n-\n-#ifndef BITCOIN_RPC_MINING_H\n-#define BITCOIN_RPC_MINING_H\n-\n-#include <script/script.h>\n-\n-#include <univalue.h>\n-\n-/** Generate blocks (mine) */\n-UniValue generateBlocks(std::shared_ptr<CReserveScript> coinbaseScript, int nGenerate, uint64_t nMaxTries, bool keepScript);\n-\n-#endif"
      }
    ]
  },
  {
    "sha": "1b46a4889f894d63062454fb9f4c2e88689a9d75",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxYjQ2YTQ4ODlmODk0ZDYzMDYyNDU0ZmI5ZjRjMmU4ODY4OWE5ZDc1",
    "commit": {
      "author": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2019-04-04T19:45:37Z"
      },
      "committer": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2019-04-10T15:44:40Z"
      },
      "message": "[cleanup] Remove unused CReserveKey",
      "tree": {
        "sha": "ba67a7227117f0c02755a2c1d171befe408b65a9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ba67a7227117f0c02755a2c1d171befe408b65a9"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1b46a4889f894d63062454fb9f4c2e88689a9d75",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1b46a4889f894d63062454fb9f4c2e88689a9d75",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/1b46a4889f894d63062454fb9f4c2e88689a9d75",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1b46a4889f894d63062454fb9f4c2e88689a9d75/comments",
    "author": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "9819ad6d07097ca4df92231e18de0b57313e3b78",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9819ad6d07097ca4df92231e18de0b57313e3b78",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/9819ad6d07097ca4df92231e18de0b57313e3b78"
      }
    ],
    "stats": {
      "total": 13,
      "additions": 1,
      "deletions": 12
    },
    "files": [
      {
        "sha": "11e8661a5baa049fb05b95205631530269608f41",
        "filename": "src/script/script.h",
        "status": "modified",
        "additions": 0,
        "deletions": 9,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1b46a4889f894d63062454fb9f4c2e88689a9d75/src/script/script.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1b46a4889f894d63062454fb9f4c2e88689a9d75/src/script/script.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script/script.h?ref=1b46a4889f894d63062454fb9f4c2e88689a9d75",
        "patch": "@@ -581,13 +581,4 @@ struct CScriptWitness\n     std::string ToString() const;\n };\n \n-class CReserveScript\n-{\n-public:\n-    CScript reserveScript;\n-    virtual void KeepScript() {}\n-    CReserveScript() {}\n-    virtual ~CReserveScript() {}\n-};\n-\n #endif // BITCOIN_SCRIPT_SCRIPT_H"
      },
      {
        "sha": "ea1b2e7e7618d4c9e0f99be6a8e3785f1e043249",
        "filename": "src/validationinterface.h",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1b46a4889f894d63062454fb9f4c2e88689a9d75/src/validationinterface.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1b46a4889f894d63062454fb9f4c2e88689a9d75/src/validationinterface.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/validationinterface.h?ref=1b46a4889f894d63062454fb9f4c2e88689a9d75",
        "patch": "@@ -18,7 +18,6 @@ class CBlockIndex;\n struct CBlockLocator;\n class CBlockIndex;\n class CConnman;\n-class CReserveScript;\n class CValidationInterface;\n class CValidationState;\n class uint256;"
      },
      {
        "sha": "f4deec4f324fa5451a81081046845e1a268876ad",
        "filename": "src/wallet/wallet.h",
        "status": "modified",
        "additions": 1,
        "deletions": 2,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1b46a4889f894d63062454fb9f4c2e88689a9d75/src/wallet/wallet.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1b46a4889f894d63062454fb9f4c2e88689a9d75/src/wallet/wallet.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/wallet.h?ref=1b46a4889f894d63062454fb9f4c2e88689a9d75",
        "patch": "@@ -1219,7 +1219,7 @@ class CWallet final : public CCryptoKeyStore, private interfaces::Chain::Notific\n void MaybeResendWalletTxs();\n \n /** A key allocated from the key pool. */\n-class CReserveKey final : public CReserveScript\n+class CReserveKey\n {\n protected:\n     CWallet* pwallet;\n@@ -1244,7 +1244,6 @@ class CReserveKey final : public CReserveScript\n     void ReturnKey();\n     bool GetReservedKey(CPubKey &pubkey, bool internal = false);\n     void KeepKey();\n-    void KeepScript() override { KeepKey(); }\n };\n \n /** RAII object to check and reserve a wallet rescan */"
      }
    ]
  }
]