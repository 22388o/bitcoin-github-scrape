[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/613683149",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#issuecomment-613683149",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18637",
    "id": 613683149,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxMzY4MzE0OQ==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-14T21:10:15Z",
    "updated_at": "2020-07-28T21:49:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19604 (Pass mempool pointer to UnloadBlockIndex/GetCoinsCacheSizeState by MarcoFalke)\n* #19556 (Remove mempool global by MarcoFalke)\n* #17487 (coins: allow write to disk without cache drop by jamesob)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/613683149/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/617849721",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#issuecomment-617849721",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18637",
    "id": 617849721,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYxNzg0OTcyMQ==",
    "user": {
      "login": "jamesob",
      "id": 73197,
      "node_id": "MDQ6VXNlcjczMTk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jamesob",
      "html_url": "https://github.com/jamesob",
      "followers_url": "https://api.github.com/users/jamesob/followers",
      "following_url": "https://api.github.com/users/jamesob/following{/other_user}",
      "gists_url": "https://api.github.com/users/jamesob/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
      "organizations_url": "https://api.github.com/users/jamesob/orgs",
      "repos_url": "https://api.github.com/users/jamesob/repos",
      "events_url": "https://api.github.com/users/jamesob/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jamesob/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-04-22T15:28:09Z",
    "updated_at": "2020-04-22T15:28:09Z",
    "author_association": "MEMBER",
    "body": "Thanks for the review and good suggestions, @ryanofsky. I've incorporated your feedback in the latest revision.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/617849721/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/632821018",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#issuecomment-632821018",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18637",
    "id": 632821018,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzMjgyMTAxOA==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-22T17:32:30Z",
    "updated_at": "2020-05-22T17:32:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "Should this be added to in progress column https://github.com/bitcoin/bitcoin/projects/11? \r\n\r\nAlso maybe if there's a main assumeutxo pr you'd prioritize for review now it could go on high priority reviews https://github.com/bitcoin/bitcoin/projects/8",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/632821018/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/636468316",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#issuecomment-636468316",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18637",
    "id": 636468316,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNjQ2ODMxNg==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-31T12:59:37Z",
    "updated_at": "2020-05-31T12:59:37Z",
    "author_association": "MEMBER",
    "body": "This doesn't compile\r\n\r\n```\r\nvalidation.cpp: In member function \u2018bool CChainState::ResizeCoinsCaches(size_t, size_t)\u2019:\r\n\r\nvalidation.cpp:4990:23: error: comparison of integer expressions of different signedness: \u2018size_t\u2019 {aka \u2018unsigned int\u2019} and \u2018int\u2019 [-Werror=sign-compare]\r\n\r\n     if (coinstip_size > old_coinstip_size) {\r\n\r\n         ~~~~~~~~~~~~~~^~~~~~~~~~~~~~~~~~~\r\n\r\ncc1plus: some warnings being treated as errors",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/636468316/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/636468355",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#issuecomment-636468355",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18637",
    "id": 636468355,
    "node_id": "MDEyOklzc3VlQ29tbWVudDYzNjQ2ODM1NQ==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-05-31T13:00:07Z",
    "updated_at": "2020-05-31T13:00:07Z",
    "author_association": "MEMBER",
    "body": "It does compile locally, so I am not sure how to reproduce this failure :(",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/636468355/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/651932209",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#issuecomment-651932209",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18637",
    "id": 651932209,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY1MTkzMjIwOQ==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-06-30T17:20:44Z",
    "updated_at": "2020-06-30T17:20:44Z",
    "author_association": "CONTRIBUTOR",
    "body": "[\"if anyone wants to see forward motion on assumeutxo, #18637 is the one to review\"](http://www.erisian.com.au/bitcoin-core-dev/log-2020-06-11.html#l-442)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/651932209/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/663469178",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#issuecomment-663469178",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/18637",
    "id": 663469178,
    "node_id": "MDEyOklzc3VlQ29tbWVudDY2MzQ2OTE3OA==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-07-24T10:15:42Z",
    "updated_at": "2020-07-24T10:15:42Z",
    "author_association": "CONTRIBUTOR",
    "body": "This looks ready to merge",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/663469178/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408954497",
    "pull_request_review_id": 393914341,
    "id": 408954497,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwODk1NDQ5Nw==",
    "diff_hunk": "@@ -0,0 +1,76 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+//\n+#include <random.h>\n+#include <uint256.h>\n+#include <consensus/validation.h>\n+#include <sync.h>\n+#include <test/util/setup_common.h>\n+#include <validation.h>\n+\n+#include <vector>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_FIXTURE_TEST_SUITE(validation_chainstate_tests, TestingSetup)\n+\n+//! Test resizing coins-related CChainState caches during runtime.\n+//!\n+BOOST_AUTO_TEST_CASE(validation_chainstate_resize_caches)\n+{\n+    ChainstateManager manager;\n+\n+    //! Create and add a Coin with DynamicMemoryUsage of 80 bytes to the given view.\n+    auto add_coin = [](CCoinsViewCache& coins_view) -> COutPoint {\n+        Coin newcoin;\n+        uint256 txid = InsecureRand256();\n+        COutPoint outp{txid, 0};\n+        newcoin.nHeight = 1;\n+        newcoin.out.nValue = InsecureRand32();\n+        newcoin.out.scriptPubKey.assign((uint32_t)56, 1);\n+        coins_view.AddCoin(outp, std::move(newcoin), false);\n+\n+        return outp;\n+    };\n+\n+    ENTER_CRITICAL_SECTION(cs_main);\n+    CChainState& c1 = manager.InitializeChainstate();\n+    LEAVE_CRITICAL_SECTION(cs_main);\n+    c1.InitCoinsDB(\n+        /* cache_size_bytes */ 1 << 23, /* in_memory */ true, /* should_wipe */ false);\n+    WITH_LOCK(::cs_main, c1.InitCoinsCache(1 << 23));\n+\n+    // Add a coin to the in-memory cache, upsize once, then downsize.\n+    {\n+        LOCK(::cs_main);\n+        auto outpoint = add_coin(c1.CoinsTip());\n+\n+        // Set a meaningless bestblock value in the coinsview cache - otherwise we won't\n+        // flush during ResizecoinsCaches() and will subsequently hit an assertion.\n+        c1.CoinsTip().SetBestBlock(InsecureRand256());\n+\n+        BOOST_CHECK(c1.CoinsTip().HaveCoinInCache(outpoint));\n+\n+        c1.ResizeCoinsCaches(\n+            1 << 24,  // upsizing the coinsview cache\n+            1 << 22  // downsizing the coinsdb cache\n+        );\n+\n+        // View should still have the coin cached, since we haven't destructed the cache on upsize.\n+        BOOST_CHECK(c1.CoinsTip().HaveCoinInCache(outpoint));\n+\n+        c1.ResizeCoinsCaches(\n+            1 << 22,  // downsizing the coinsview cache\n+            1 << 23  // upsizing the coinsdb cache\n+        );\n+\n+        // The view cache should be empty since we had to destruct to downsize.\n+        BOOST_CHECK(!c1.CoinsTip().HaveCoinInCache(outpoint));\n+    }\n+\n+    // Avoid triggering the address sanitizer.\n+    WITH_LOCK(::cs_main, manager.Unload());",
    "path": "src/test/validation_chainstate_tests.cpp",
    "position": 73,
    "original_position": 73,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "03e5fe6ee3cc44f8a2b27de31e3fcd9612f907b5",
    "user": {
      "login": "jamesob",
      "id": 73197,
      "node_id": "MDQ6VXNlcjczMTk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jamesob",
      "html_url": "https://github.com/jamesob",
      "followers_url": "https://api.github.com/users/jamesob/followers",
      "following_url": "https://api.github.com/users/jamesob/following{/other_user}",
      "gists_url": "https://api.github.com/users/jamesob/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
      "organizations_url": "https://api.github.com/users/jamesob/orgs",
      "repos_url": "https://api.github.com/users/jamesob/repos",
      "events_url": "https://api.github.com/users/jamesob/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jamesob/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This will need to be modified with the change that @MarcoFalke has made in https://github.com/bitcoin/bitcoin/pull/18615.",
    "created_at": "2020-04-15T15:57:58Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r408954497",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408954497"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r408954497"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/408954497/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 73,
    "original_line": 73,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409694987",
    "pull_request_review_id": 394808868,
    "id": 409694987,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTY5NDk4Nw==",
    "diff_hunk": "@@ -53,35 +53,50 @@ struct CoinEntry {\n \n }\n \n-CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) : db(ldb_path, nCacheSize, fMemory, fWipe, true)\n+CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) :\n+    m_ldb_path(ldb_path),\n+    m_is_memory(fMemory)\n {\n+    db.reset(new CDBWrapper(ldb_path, nCacheSize, fMemory, fWipe, true));\n+}\n+\n+// XXX this should never be called without holding cs_main. Maybe figure out\n+// a better way of articulating this (lock annotations can't be used due to\n+// circular dep. with validation).",
    "path": "src/txdb.cpp",
    "position": null,
    "original_position": 14,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "565a4b5c659038bf2e0a24f3d9dca32aef402df6",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"coins: add Sync() method to allow flush without cacheCoins drop\" (b2abb396c64e96585a0c38a269372b35cced08bd)\r\n\r\nAssertLockHeld would be one option",
    "created_at": "2020-04-16T16:36:13Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409694987",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409694987"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409694987"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409694987/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 63,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 65,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409697186",
    "pull_request_review_id": 394808868,
    "id": 409697186,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTY5NzE4Ng==",
    "diff_hunk": "@@ -53,35 +53,50 @@ struct CoinEntry {\n \n }\n \n-CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) : db(ldb_path, nCacheSize, fMemory, fWipe, true)\n+CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) :\n+    m_ldb_path(ldb_path),",
    "path": "src/txdb.cpp",
    "position": 15,
    "original_position": 6,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "565a4b5c659038bf2e0a24f3d9dca32aef402df6",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"coins: add Sync() method to allow flush without cacheCoins drop\" (b2abb396c64e96585a0c38a269372b35cced08bd)\r\n\r\nWould be nice to stick to member initialization and keep empty constructor body `db(MakeUnique<CDBWrapper>(...)))`",
    "created_at": "2020-04-16T16:39:29Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409697186",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409697186"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409697186"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409697186/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 47,
    "original_line": 47,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409699250",
    "pull_request_review_id": 394808868,
    "id": 409699250,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTY5OTI1MA==",
    "diff_hunk": "@@ -53,35 +53,50 @@ struct CoinEntry {\n \n }\n \n-CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) : db(ldb_path, nCacheSize, fMemory, fWipe, true)\n+CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) :\n+    m_ldb_path(ldb_path),\n+    m_is_memory(fMemory)\n {\n+    db.reset(new CDBWrapper(ldb_path, nCacheSize, fMemory, fWipe, true));\n+}\n+\n+// XXX this should never be called without holding cs_main. Maybe figure out\n+// a better way of articulating this (lock annotations can't be used due to\n+// circular dep. with validation).\n+void CCoinsViewDB::ResizeCache(size_t new_cache_size)\n+{\n+    // Have to do a reset first to get the original `db` state to release its\n+    // filesystem lock.\n+    db.reset();\n+    db.reset(new CDBWrapper(",
    "path": "src/txdb.cpp",
    "position": null,
    "original_position": 20,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "565a4b5c659038bf2e0a24f3d9dca32aef402df6",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"coins: add Sync() method to allow flush without cacheCoins drop\" (b2abb396c64e96585a0c38a269372b35cced08bd)\r\n\r\nDoesn't really matter but general better to avoid `new` with `MakeUnique`\r\nhttps://isocpp.org/blog/2019/06/quick-q-differences-between-stdmake-unique-and-stdunique-ptr-with-new",
    "created_at": "2020-04-16T16:42:36Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409699250",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409699250"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409699250"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409699250/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 71,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409701315",
    "pull_request_review_id": 394808868,
    "id": 409701315,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTcwMTMxNQ==",
    "diff_hunk": "@@ -43,7 +43,9 @@ static const int64_t nMaxCoinsDBCache = 8;\n class CCoinsViewDB final : public CCoinsView\n {\n protected:\n-    CDBWrapper db;\n+    std::unique_ptr<CDBWrapper> db;",
    "path": "src/txdb.h",
    "position": null,
    "original_position": 5,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "565a4b5c659038bf2e0a24f3d9dca32aef402df6",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"coins: add Sync() method to allow flush without cacheCoins drop\" (b2abb396c64e96585a0c38a269372b35cced08bd)\r\n\r\nSince this commit is already changing the type of `db` and updating every single line where it's referenced, it'd be nice to rename it to `m_db` at the same time",
    "created_at": "2020-04-16T16:45:45Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409701315",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409701315"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409701315"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409701315/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 46,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409705135",
    "pull_request_review_id": 394808868,
    "id": 409705135,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTcwNTEzNQ==",
    "diff_hunk": "@@ -0,0 +1,76 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+//\n+#include <random.h>\n+#include <uint256.h>\n+#include <consensus/validation.h>\n+#include <sync.h>\n+#include <test/util/setup_common.h>\n+#include <validation.h>\n+\n+#include <vector>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_FIXTURE_TEST_SUITE(validation_chainstate_tests, TestingSetup)\n+\n+//! Test resizing coins-related CChainState caches during runtime.\n+//!\n+BOOST_AUTO_TEST_CASE(validation_chainstate_resize_caches)",
    "path": "src/test/validation_chainstate_tests.cpp",
    "position": 20,
    "original_position": 20,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "03e5fe6ee3cc44f8a2b27de31e3fcd9612f907b5",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"test: add test for CChainState::ResizeCoinsCaches()\" (03e5fe6ee3cc44f8a2b27de31e3fcd9612f907b5)\r\n\r\nNice test!",
    "created_at": "2020-04-16T16:51:46Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409705135",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409705135"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409705135"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409705135/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 20,
    "original_line": 20,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409709750",
    "pull_request_review_id": 394808868,
    "id": 409709750,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTcwOTc1MA==",
    "diff_hunk": "@@ -4924,6 +4924,36 @@ std::string CChainState::ToString()\n         tip ? tip->nHeight : -1, tip ? tip->GetBlockHash().ToString() : \"null\");\n }\n \n+void CChainState::ResizeCoinsCaches(size_t coinstip_size, size_t coinsdb_size)\n+{\n+    if (coinstip_size == m_coinstip_cache_size_bytes &&\n+            coinsdb_size == m_coinsdb_cache_size_bytes) {\n+        // Cache sizes are unchanged, no need to continue.\n+        return;\n+    }\n+    int old_coinstip_size = m_coinstip_cache_size_bytes;\n+    m_coinstip_cache_size_bytes = coinstip_size;\n+    m_coinsdb_cache_size_bytes = coinsdb_size;\n+    CoinsDB().ResizeCache(coinsdb_size);\n+\n+    LogPrintf(\"[%s] resized coinsdb cache to %.1f MiB\\n\",\n+        this->ToString(), coinsdb_size * (1.0 / 1024 / 1024));\n+    LogPrintf(\"[%s] resized coinstip cache to %.1f MiB\\n\",\n+        this->ToString(), coinstip_size * (1.0 / 1024 / 1024));\n+\n+    BlockValidationState state;\n+    const CChainParams& chainparams = Params();\n+\n+    if (coinstip_size > old_coinstip_size) {\n+        // Likely no need to flush if cache sizes have grown.\n+        FlushStateToDisk(chainparams, state, FlushStateMode::IF_NEEDED);",
    "path": "src/validation.cpp",
    "position": null,
    "original_position": 64,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "df0f720cfdcc1ad70d5ef2656039f008b3bc4bba",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Add CChainState::ResizeCoinsCaches\" (df0f720cfdcc1ad70d5ef2656039f008b3bc4bba)\r\n\r\nWould be good to pass along false return value to caller in case this fails",
    "created_at": "2020-04-16T16:59:10Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409709750",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409709750"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409709750"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409709750/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 4949,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409714771",
    "pull_request_review_id": 394808868,
    "id": 409714771,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTcxNDc3MQ==",
    "diff_hunk": "@@ -116,7 +116,6 @@ bool fPruneMode = false;\n bool fRequireStandard = true;\n bool fCheckBlockIndex = false;\n bool fCheckpointsEnabled = DEFAULT_CHECKPOINTS_ENABLED;\n-size_t nCoinCacheUsage = 5000 * 300;",
    "path": "src/validation.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "df0f720cfdcc1ad70d5ef2656039f008b3bc4bba",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Add CChainState::ResizeCoinsCaches\" (df0f720cfdcc1ad70d5ef2656039f008b3bc4bba)\r\n\r\nJust confirming but looks like this 1.5MB default cache size was only used by test cases previously, which are now using 8MB or 1KB caches depending on the case.",
    "created_at": "2020-04-16T17:07:19Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409714771",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409714771"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409714771"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409714771/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 138,
    "original_line": 138,
    "side": "LEFT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409719460",
    "pull_request_review_id": 394808868,
    "id": 409719460,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTcxOTQ2MA==",
    "diff_hunk": "@@ -4924,6 +4924,36 @@ std::string CChainState::ToString()\n         tip ? tip->nHeight : -1, tip ? tip->GetBlockHash().ToString() : \"null\");\n }\n \n+void CChainState::ResizeCoinsCaches(size_t coinstip_size, size_t coinsdb_size)\n+{\n+    if (coinstip_size == m_coinstip_cache_size_bytes &&\n+            coinsdb_size == m_coinsdb_cache_size_bytes) {\n+        // Cache sizes are unchanged, no need to continue.\n+        return;\n+    }\n+    int old_coinstip_size = m_coinstip_cache_size_bytes;\n+    m_coinstip_cache_size_bytes = coinstip_size;\n+    m_coinsdb_cache_size_bytes = coinsdb_size;\n+    CoinsDB().ResizeCache(coinsdb_size);",
    "path": "src/validation.cpp",
    "position": 52,
    "original_position": 52,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "df0f720cfdcc1ad70d5ef2656039f008b3bc4bba",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"Add CChainState::ResizeCoinsCaches\" (df0f720cfdcc1ad70d5ef2656039f008b3bc4bba)\r\n\r\nJust curious, but would it make sense to call FlushStateToDisk before resetting CoinsDB instead of after? Thought would be that maybe live CDBWrapper object has cached state that would make the flush faster, or maybe it could be good to start with a new CDBWrapper after the flush",
    "created_at": "2020-04-16T17:15:24Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409719460",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409719460"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409719460"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409719460/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 4978,
    "original_line": 4978,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409723518",
    "pull_request_review_id": 394808868,
    "id": 409723518,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQwOTcyMzUxOA==",
    "diff_hunk": "@@ -5237,3 +5237,33 @@ void ChainstateManager::Reset()\n     m_active_chainstate = nullptr;\n     m_snapshot_validated = false;\n }\n+\n+void ChainstateManager::MaybeRebalanceCaches()",
    "path": "src/validation.cpp",
    "position": 83,
    "original_position": 5,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "69514bd9fce0f867256bd08ec9f1b616a3ece573",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"add ChainstateManager::MaybeRebalanceCaches()\" (69514bd9fce0f867256bd08ec9f1b616a3ece573)\r\n\r\nCould probably write a short unit test exercising this (checking m_coins{tip,db}_cache_size_bytes)",
    "created_at": "2020-04-16T17:22:01Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409723518",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409723518"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r409723518"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/409723518/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 5301,
    "original_line": 5301,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/413083482",
    "pull_request_review_id": 398310433,
    "id": 413083482,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzA4MzQ4Mg==",
    "diff_hunk": "@@ -5237,3 +5237,33 @@ void ChainstateManager::Reset()\n     m_active_chainstate = nullptr;\n     m_snapshot_validated = false;\n }\n+\n+void ChainstateManager::MaybeRebalanceCaches()",
    "path": "src/validation.cpp",
    "position": 83,
    "original_position": 5,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "69514bd9fce0f867256bd08ec9f1b616a3ece573",
    "user": {
      "login": "jamesob",
      "id": 73197,
      "node_id": "MDQ6VXNlcjczMTk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jamesob",
      "html_url": "https://github.com/jamesob",
      "followers_url": "https://api.github.com/users/jamesob/followers",
      "following_url": "https://api.github.com/users/jamesob/following{/other_user}",
      "gists_url": "https://api.github.com/users/jamesob/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
      "organizations_url": "https://api.github.com/users/jamesob/orgs",
      "repos_url": "https://api.github.com/users/jamesob/repos",
      "events_url": "https://api.github.com/users/jamesob/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jamesob/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Good idea, done.",
    "created_at": "2020-04-22T15:28:29Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r413083482",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/413083482"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r413083482"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/413083482/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 5301,
    "original_line": 5301,
    "side": "RIGHT",
    "in_reply_to_id": 409723518
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/413083886",
    "pull_request_review_id": 398310897,
    "id": 413083886,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzA4Mzg4Ng==",
    "diff_hunk": "@@ -53,35 +53,50 @@ struct CoinEntry {\n \n }\n \n-CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) : db(ldb_path, nCacheSize, fMemory, fWipe, true)\n+CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) :\n+    m_ldb_path(ldb_path),\n+    m_is_memory(fMemory)\n {\n+    db.reset(new CDBWrapper(ldb_path, nCacheSize, fMemory, fWipe, true));\n+}\n+\n+// XXX this should never be called without holding cs_main. Maybe figure out\n+// a better way of articulating this (lock annotations can't be used due to\n+// circular dep. with validation).\n+void CCoinsViewDB::ResizeCache(size_t new_cache_size)\n+{\n+    // Have to do a reset first to get the original `db` state to release its\n+    // filesystem lock.\n+    db.reset();\n+    db.reset(new CDBWrapper(",
    "path": "src/txdb.cpp",
    "position": null,
    "original_position": 20,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "565a4b5c659038bf2e0a24f3d9dca32aef402df6",
    "user": {
      "login": "jamesob",
      "id": 73197,
      "node_id": "MDQ6VXNlcjczMTk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jamesob",
      "html_url": "https://github.com/jamesob",
      "followers_url": "https://api.github.com/users/jamesob/followers",
      "following_url": "https://api.github.com/users/jamesob/following{/other_user}",
      "gists_url": "https://api.github.com/users/jamesob/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
      "organizations_url": "https://api.github.com/users/jamesob/orgs",
      "repos_url": "https://api.github.com/users/jamesob/repos",
      "events_url": "https://api.github.com/users/jamesob/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jamesob/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Ah thanks, didn't know that.",
    "created_at": "2020-04-22T15:28:56Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r413083886",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/413083886"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r413083886"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/413083886/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 71,
    "side": "RIGHT",
    "in_reply_to_id": 409699250
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/413084378",
    "pull_request_review_id": 398311456,
    "id": 413084378,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQxMzA4NDM3OA==",
    "diff_hunk": "@@ -53,35 +53,50 @@ struct CoinEntry {\n \n }\n \n-CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) : db(ldb_path, nCacheSize, fMemory, fWipe, true)\n+CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) :\n+    m_ldb_path(ldb_path),\n+    m_is_memory(fMemory)\n {\n+    db.reset(new CDBWrapper(ldb_path, nCacheSize, fMemory, fWipe, true));\n+}\n+\n+// XXX this should never be called without holding cs_main. Maybe figure out\n+// a better way of articulating this (lock annotations can't be used due to\n+// circular dep. with validation).",
    "path": "src/txdb.cpp",
    "position": null,
    "original_position": 14,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "565a4b5c659038bf2e0a24f3d9dca32aef402df6",
    "user": {
      "login": "jamesob",
      "id": 73197,
      "node_id": "MDQ6VXNlcjczMTk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jamesob",
      "html_url": "https://github.com/jamesob",
      "followers_url": "https://api.github.com/users/jamesob/followers",
      "following_url": "https://api.github.com/users/jamesob/following{/other_user}",
      "gists_url": "https://api.github.com/users/jamesob/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
      "organizations_url": "https://api.github.com/users/jamesob/orgs",
      "repos_url": "https://api.github.com/users/jamesob/repos",
      "events_url": "https://api.github.com/users/jamesob/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jamesob/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I just ended up using an `extern` declaration for the lock and adding an annotation. Not sure why I didn't do that in the first place.",
    "created_at": "2020-04-22T15:29:29Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r413084378",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/413084378"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r413084378"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/413084378/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": 63,
    "start_side": "RIGHT",
    "line": null,
    "original_line": 65,
    "side": "RIGHT",
    "in_reply_to_id": 409694987
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427549224",
    "pull_request_review_id": 414759782,
    "id": 427549224,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyNzU0OTIyNA==",
    "diff_hunk": "@@ -101,4 +101,58 @@ BOOST_AUTO_TEST_CASE(chainstatemanager)\n     WITH_LOCK(::cs_main, manager.Unload());\n }\n \n+//! Test rebalancing the caches associated with each chainstate.\n+BOOST_AUTO_TEST_CASE(chainstatemanager_rebalance_caches)\n+{\n+    ChainstateManager manager;\n+    int max_cache = 10000;\n+    manager.m_total_coinsdb_cache = max_cache;\n+    manager.m_total_coinstip_cache = max_cache;\n+\n+    std::vector<CChainState*> chainstates;\n+\n+    // Create a legacy (IBD) chainstate.\n+    //\n+    ENTER_CRITICAL_SECTION(cs_main);\n+    CChainState& c1 = manager.InitializeChainstate();\n+    LEAVE_CRITICAL_SECTION(cs_main);",
    "path": "src/test/validation_chainstatemanager_tests.cpp",
    "position": 50,
    "original_position": 18,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "db5e36a033e642599db808f59d16d03a40860f17",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"add ChainstateManager::MaybeRebalanceCaches()\" (db5e36a033e642599db808f59d16d03a40860f17)\r\n\r\nThis is interesting. Once we update to c++14 or 17 we should be able to use WITH_LOCK like\r\n\r\n```c++\r\nCChainState& c1 = WITH_LOCK(cs_main, return manager.InitializeChainstate());\r\n```\r\n\r\nI think it changing it wouldn't work now without decltype(auto)",
    "created_at": "2020-05-19T19:31:36Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r427549224",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427549224"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r427549224"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/427549224/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 118,
    "original_start_line": 116,
    "start_side": "RIGHT",
    "line": 120,
    "original_line": 120,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429373795",
    "pull_request_review_id": 417080272,
    "id": 429373795,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM3Mzc5NQ==",
    "diff_hunk": "@@ -101,4 +101,58 @@ BOOST_AUTO_TEST_CASE(chainstatemanager)\n     WITH_LOCK(::cs_main, manager.Unload());\n }\n \n+//! Test rebalancing the caches associated with each chainstate.\n+BOOST_AUTO_TEST_CASE(chainstatemanager_rebalance_caches)\n+{\n+    ChainstateManager manager;\n+    int max_cache = 10000;\n+    manager.m_total_coinsdb_cache = max_cache;\n+    manager.m_total_coinstip_cache = max_cache;\n+\n+    std::vector<CChainState*> chainstates;\n+\n+    // Create a legacy (IBD) chainstate.\n+    //\n+    ENTER_CRITICAL_SECTION(cs_main);\n+    CChainState& c1 = manager.InitializeChainstate();\n+    LEAVE_CRITICAL_SECTION(cs_main);",
    "path": "src/test/validation_chainstatemanager_tests.cpp",
    "position": 50,
    "original_position": 18,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "db5e36a033e642599db808f59d16d03a40860f17",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "What is different between this potential WITH_LOCK use, and the existing ones that return a value?",
    "created_at": "2020-05-22T17:37:12Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r429373795",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429373795"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r429373795"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429373795/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 118,
    "original_start_line": 116,
    "start_side": "RIGHT",
    "line": 120,
    "original_line": 120,
    "side": "RIGHT",
    "in_reply_to_id": 427549224
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429383887",
    "pull_request_review_id": 417093545,
    "id": 429383887,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTM4Mzg4Nw==",
    "diff_hunk": "@@ -101,4 +101,58 @@ BOOST_AUTO_TEST_CASE(chainstatemanager)\n     WITH_LOCK(::cs_main, manager.Unload());\n }\n \n+//! Test rebalancing the caches associated with each chainstate.\n+BOOST_AUTO_TEST_CASE(chainstatemanager_rebalance_caches)\n+{\n+    ChainstateManager manager;\n+    int max_cache = 10000;\n+    manager.m_total_coinsdb_cache = max_cache;\n+    manager.m_total_coinstip_cache = max_cache;\n+\n+    std::vector<CChainState*> chainstates;\n+\n+    // Create a legacy (IBD) chainstate.\n+    //\n+    ENTER_CRITICAL_SECTION(cs_main);\n+    CChainState& c1 = manager.InitializeChainstate();\n+    LEAVE_CRITICAL_SECTION(cs_main);",
    "path": "src/test/validation_chainstatemanager_tests.cpp",
    "position": 50,
    "original_position": 18,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "db5e36a033e642599db808f59d16d03a40860f17",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I don't know, but maybe C++11 lambda can not return references? If yes, this can be solved with\r\n\r\n\r\n```cpp\r\nCChainState& c1 = *WITH_LOCK(cs_main, return &manager.InitializeChainstate());",
    "created_at": "2020-05-22T18:00:00Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r429383887",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429383887"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r429383887"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429383887/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 118,
    "original_start_line": 116,
    "start_side": "RIGHT",
    "line": 120,
    "original_line": 120,
    "side": "RIGHT",
    "in_reply_to_id": 427549224
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429401621",
    "pull_request_review_id": 417117008,
    "id": 429401621,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTQwMTYyMQ==",
    "diff_hunk": "@@ -101,4 +101,58 @@ BOOST_AUTO_TEST_CASE(chainstatemanager)\n     WITH_LOCK(::cs_main, manager.Unload());\n }\n \n+//! Test rebalancing the caches associated with each chainstate.\n+BOOST_AUTO_TEST_CASE(chainstatemanager_rebalance_caches)\n+{\n+    ChainstateManager manager;\n+    int max_cache = 10000;\n+    manager.m_total_coinsdb_cache = max_cache;\n+    manager.m_total_coinstip_cache = max_cache;\n+\n+    std::vector<CChainState*> chainstates;\n+\n+    // Create a legacy (IBD) chainstate.\n+    //\n+    ENTER_CRITICAL_SECTION(cs_main);\n+    CChainState& c1 = manager.InitializeChainstate();\n+    LEAVE_CRITICAL_SECTION(cs_main);",
    "path": "src/test/validation_chainstatemanager_tests.cpp",
    "position": 50,
    "original_position": 18,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "db5e36a033e642599db808f59d16d03a40860f17",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes, just what marco said, auto return type won't deduce a reference, and I think the pointer trick would work here, so it might nice to incorporate if the PR is gets updated again",
    "created_at": "2020-05-22T18:44:01Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r429401621",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429401621"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r429401621"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429401621/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 118,
    "original_start_line": 116,
    "start_side": "RIGHT",
    "line": 120,
    "original_line": 120,
    "side": "RIGHT",
    "in_reply_to_id": 427549224
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429541761",
    "pull_request_review_id": 417275042,
    "id": 429541761,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTU0MTc2MQ==",
    "diff_hunk": "@@ -1532,6 +1532,9 @@ bool AppInitMain(NodeContext& node)\n             try {\n                 LOCK(cs_main);\n                 g_chainman.InitializeChainstate();\n+                g_chainman.m_total_coinstip_cache = nCoinCacheUsage;\n+                g_chainman.m_total_coinsdb_cache = nCoinDBCache;",
    "path": "src/init.cpp",
    "position": null,
    "original_position": 14,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "4cc7b612d1413451d500c5fd6eefebea34216460",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "```suggestion\r\n                chainman.m_total_coinsdb_cache = nCoinDBCache;\r\n```\r\n\r\nNeeds rebase to remove the `g_` prefix in this line",
    "created_at": "2020-05-23T12:26:35Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r429541761",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429541761"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r429541761"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429541761/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1536,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429541868",
    "pull_request_review_id": 417275131,
    "id": 429541868,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQyOTU0MTg2OA==",
    "diff_hunk": "@@ -0,0 +1,76 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+//\n+#include <random.h>\n+#include <uint256.h>\n+#include <consensus/validation.h>\n+#include <sync.h>\n+#include <test/util/setup_common.h>\n+#include <validation.h>\n+\n+#include <vector>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_FIXTURE_TEST_SUITE(validation_chainstate_tests, TestingSetup)\n+\n+//! Test resizing coins-related CChainState caches during runtime.\n+//!\n+BOOST_AUTO_TEST_CASE(validation_chainstate_resize_caches)\n+{\n+    ChainstateManager manager;\n+\n+    //! Create and add a Coin with DynamicMemoryUsage of 80 bytes to the given view.\n+    auto add_coin = [](CCoinsViewCache& coins_view) -> COutPoint {\n+        Coin newcoin;\n+        uint256 txid = InsecureRand256();\n+        COutPoint outp{txid, 0};\n+        newcoin.nHeight = 1;\n+        newcoin.out.nValue = InsecureRand32();\n+        newcoin.out.scriptPubKey.assign((uint32_t)56, 1);\n+        coins_view.AddCoin(outp, std::move(newcoin), false);\n+\n+        return outp;\n+    };\n+\n+    ENTER_CRITICAL_SECTION(cs_main);\n+    CChainState& c1 = manager.InitializeChainstate();\n+    LEAVE_CRITICAL_SECTION(cs_main);\n+    c1.InitCoinsDB(\n+        /* cache_size_bytes */ 1 << 23, /* in_memory */ true, /* should_wipe */ false);\n+    WITH_LOCK(::cs_main, c1.InitCoinsCache(1 << 23));\n+\n+    // Add a coin to the in-memory cache, upsize once, then downsize.\n+    {\n+        LOCK(::cs_main);\n+        auto outpoint = add_coin(c1.CoinsTip());\n+\n+        // Set a meaningless bestblock value in the coinsview cache - otherwise we won't\n+        // flush during ResizecoinsCaches() and will subsequently hit an assertion.\n+        c1.CoinsTip().SetBestBlock(InsecureRand256());\n+\n+        BOOST_CHECK(c1.CoinsTip().HaveCoinInCache(outpoint));\n+\n+        c1.ResizeCoinsCaches(\n+            1 << 24,  // upsizing the coinsview cache\n+            1 << 22  // downsizing the coinsdb cache\n+        );\n+\n+        // View should still have the coin cached, since we haven't destructed the cache on upsize.\n+        BOOST_CHECK(c1.CoinsTip().HaveCoinInCache(outpoint));\n+\n+        c1.ResizeCoinsCaches(\n+            1 << 22,  // downsizing the coinsview cache\n+            1 << 23  // upsizing the coinsdb cache\n+        );\n+\n+        // The view cache should be empty since we had to destruct to downsize.\n+        BOOST_CHECK(!c1.CoinsTip().HaveCoinInCache(outpoint));\n+    }\n+\n+    // Avoid triggering the address sanitizer.\n+    WITH_LOCK(::cs_main, manager.Unload());",
    "path": "src/test/validation_chainstate_tests.cpp",
    "position": 73,
    "original_position": 73,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "03e5fe6ee3cc44f8a2b27de31e3fcd9612f907b5",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I don't think this needs a `SyncWithValidationInterfaceQueue` before the unload because in this test not blocks are mined and no txs are added to the mempool.",
    "created_at": "2020-05-23T12:28:17Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r429541868",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429541868"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r429541868"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/429541868/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 73,
    "original_line": 73,
    "side": "RIGHT",
    "in_reply_to_id": 408954497
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432009502",
    "pull_request_review_id": 420343465,
    "id": 432009502,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjAwOTUwMg==",
    "diff_hunk": "@@ -1532,6 +1532,9 @@ bool AppInitMain(NodeContext& node)\n             try {\n                 LOCK(cs_main);\n                 g_chainman.InitializeChainstate();\n+                g_chainman.m_total_coinstip_cache = nCoinCacheUsage;\n+                g_chainman.m_total_coinsdb_cache = nCoinDBCache;",
    "path": "src/init.cpp",
    "position": null,
    "original_position": 14,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "4cc7b612d1413451d500c5fd6eefebea34216460",
    "user": {
      "login": "jamesob",
      "id": 73197,
      "node_id": "MDQ6VXNlcjczMTk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jamesob",
      "html_url": "https://github.com/jamesob",
      "followers_url": "https://api.github.com/users/jamesob/followers",
      "following_url": "https://api.github.com/users/jamesob/following{/other_user}",
      "gists_url": "https://api.github.com/users/jamesob/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
      "organizations_url": "https://api.github.com/users/jamesob/orgs",
      "repos_url": "https://api.github.com/users/jamesob/repos",
      "events_url": "https://api.github.com/users/jamesob/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jamesob/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Pushed, thanks!",
    "created_at": "2020-05-28T17:37:49Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r432009502",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432009502"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r432009502"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432009502/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1536,
    "side": "RIGHT",
    "in_reply_to_id": 429541761
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432944978",
    "pull_request_review_id": 421492649,
    "id": 432944978,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk0NDk3OA==",
    "diff_hunk": "@@ -104,4 +104,58 @@ BOOST_AUTO_TEST_CASE(chainstatemanager)\n     WITH_LOCK(::cs_main, manager.Unload());\n }\n \n+//! Test rebalancing the caches associated with each chainstate.\n+BOOST_AUTO_TEST_CASE(chainstatemanager_rebalance_caches)\n+{\n+    ChainstateManager manager;\n+    int max_cache = 10000;\n+    manager.m_total_coinsdb_cache = max_cache;\n+    manager.m_total_coinstip_cache = max_cache;\n+\n+    std::vector<CChainState*> chainstates;\n+\n+    // Create a legacy (IBD) chainstate.\n+    //\n+    ENTER_CRITICAL_SECTION(cs_main);\n+    CChainState& c1 = manager.InitializeChainstate();\n+    LEAVE_CRITICAL_SECTION(cs_main);",
    "path": "src/test/validation_chainstatemanager_tests.cpp",
    "position": 50,
    "original_position": 18,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "1e6e0b9af6c5470dbf1e61f54900ac9a21f147a2",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "style-nit in commit 1e6e0b9af6c5470dbf1e61:\r\n\r\nNow that you have to force push anyway, might as well remove the clumsy `ENTER_CRITICAL_SECTION`?\r\n\r\n```suggestion\r\n    CChainState& c1 = *WITH_LOCK(cs_main, return &manager.InitializeChainstate());\r\n```",
    "created_at": "2020-05-31T13:02:50Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r432944978",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432944978"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r432944978"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432944978/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 118,
    "original_start_line": 119,
    "start_side": "RIGHT",
    "line": 120,
    "original_line": 120,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432945053",
    "pull_request_review_id": 421492649,
    "id": 432945053,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQzMjk0NTA1Mw==",
    "diff_hunk": "@@ -104,4 +104,58 @@ BOOST_AUTO_TEST_CASE(chainstatemanager)\n     WITH_LOCK(::cs_main, manager.Unload());\n }\n \n+//! Test rebalancing the caches associated with each chainstate.\n+BOOST_AUTO_TEST_CASE(chainstatemanager_rebalance_caches)\n+{\n+    ChainstateManager manager;\n+    int max_cache = 10000;\n+    manager.m_total_coinsdb_cache = max_cache;\n+    manager.m_total_coinstip_cache = max_cache;\n+\n+    std::vector<CChainState*> chainstates;\n+\n+    // Create a legacy (IBD) chainstate.\n+    //\n+    ENTER_CRITICAL_SECTION(cs_main);\n+    CChainState& c1 = manager.InitializeChainstate();\n+    LEAVE_CRITICAL_SECTION(cs_main);\n+    chainstates.push_back(&c1);\n+    c1.InitCoinsDB(\n+        /* cache_size_bytes */ 1 << 23, /* in_memory */ true, /* should_wipe */ false);\n+\n+    {\n+        LOCK(::cs_main);\n+        c1.InitCoinsCache(1 << 23);\n+        c1.CoinsTip().SetBestBlock(InsecureRand256());\n+        manager.MaybeRebalanceCaches();\n+    }\n+\n+    BOOST_CHECK_EQUAL(c1.m_coinstip_cache_size_bytes, max_cache);\n+    BOOST_CHECK_EQUAL(c1.m_coinsdb_cache_size_bytes, max_cache);\n+\n+    // Create a snapshot-based chainstate.\n+    //\n+    ENTER_CRITICAL_SECTION(cs_main);\n+    CChainState& c2 = manager.InitializeChainstate(GetRandHash());\n+    LEAVE_CRITICAL_SECTION(cs_main);",
    "path": "src/test/validation_chainstatemanager_tests.cpp",
    "position": 69,
    "original_position": 37,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "1e6e0b9af6c5470dbf1e61f54900ac9a21f147a2",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "```suggestion\r\n    CChainState& c2 = *WITH_LOCK(cs_main, return &manager.InitializeChainstate(GetRandHash()));\r\n```\r\n\r\nSame",
    "created_at": "2020-05-31T13:03:51Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r432945053",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432945053"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r432945053"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/432945053/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 137,
    "original_start_line": 138,
    "start_side": "RIGHT",
    "line": 139,
    "original_line": 139,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/440414525",
    "pull_request_review_id": 430951947,
    "id": 440414525,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQxNDUyNQ==",
    "diff_hunk": "@@ -41,35 +42,45 @@ struct CoinEntry {\n \n }\n \n-CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) : db(ldb_path, nCacheSize, fMemory, fWipe, true)\n+CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) :\n+    m_ldb_path(ldb_path),\n+    m_is_memory(fMemory),",
    "path": "src/txdb.cpp",
    "position": null,
    "original_position": 15,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "0fd9039ab3de00a0ac03b8fe0463f0c62a92dd43",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "0fd9039ab3de00a0ac03b8fe0463f0c62a92dd43\r\n\r\nThis currently introduces a new compiler warning. The initializer list should be in the same order as they members are declared.\r\n\r\n```\r\ntxdb.cpp:47:5: warning: field 'm_is_memory' will be initialized after field 'm_db' [-Wreorder]\r\n    m_is_memory(fMemory),\r\n```",
    "created_at": "2020-06-15T20:01:25Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r440414525",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/440414525"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r440414525"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/440414525/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 47,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/440415231",
    "pull_request_review_id": 430951947,
    "id": 440415231,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQxNTIzMQ==",
    "diff_hunk": "@@ -139,7 +139,7 @@ TestingSetup::TestingSetup(const std::string& chainName, const std::vector<const\n     ::ChainstateActive().InitCoinsDB(\n         /* cache_size_bytes */ 1 << 23, /* in_memory */ true, /* should_wipe */ false);\n     assert(!::ChainstateActive().CanFlushToDisk());\n-    ::ChainstateActive().InitCoinsCache();\n+    ::ChainstateActive().InitCoinsCache(1 << 23);",
    "path": "src/test/util/setup_common.cpp",
    "position": 5,
    "original_position": 5,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "1bf9a836713b44d873dd6f2b99ce8ab343808ffe",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "1bf9a836713b44d873dd6f2b99ce8ab343808ffe\r\n\r\nThis looks like it could be a constant?",
    "created_at": "2020-06-15T20:02:47Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r440415231",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/440415231"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r440415231"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/440415231/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 142,
    "original_line": 142,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/440416684",
    "pull_request_review_id": 430951947,
    "id": 440416684,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0MDQxNjY4NA==",
    "diff_hunk": "@@ -103,4 +103,58 @@ BOOST_AUTO_TEST_CASE(chainstatemanager)\n     WITH_LOCK(::cs_main, manager.Unload());\n }\n \n+//! Test rebalancing the caches associated with each chainstate.\n+BOOST_AUTO_TEST_CASE(chainstatemanager_rebalance_caches)\n+{\n+    ChainstateManager manager;\n+    size_t max_cache = 10000;\n+    manager.m_total_coinsdb_cache = max_cache;\n+    manager.m_total_coinstip_cache = max_cache;\n+\n+    std::vector<CChainState*> chainstates;\n+\n+    // Create a legacy (IBD) chainstate.\n+    //\n+    ENTER_CRITICAL_SECTION(cs_main);\n+    CChainState& c1 = manager.InitializeChainstate();\n+    LEAVE_CRITICAL_SECTION(cs_main);\n+    chainstates.push_back(&c1);\n+    c1.InitCoinsDB(\n+        /* cache_size_bytes */ 1 << 23, /* in_memory */ true, /* should_wipe */ false);\n+\n+    {\n+        LOCK(::cs_main);\n+        c1.InitCoinsCache(1 << 23);",
    "path": "src/test/validation_chainstatemanager_tests.cpp",
    "position": 57,
    "original_position": 25,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "6df742f093de1c1360e3f37d011fbdf0a3888017",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "6df742f093de1c1360e3f37d011fbdf0a3888017\r\n\r\nIn the test I think `1 << 23` could also be a variable to help a little bit with readability.",
    "created_at": "2020-06-15T20:05:53Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r440416684",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/440416684"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r440416684"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/440416684/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 127,
    "original_line": 127,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/447889705",
    "pull_request_review_id": 440275077,
    "id": 447889705,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0Nzg4OTcwNQ==",
    "diff_hunk": "@@ -41,35 +42,45 @@ struct CoinEntry {\n \n }\n \n-CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) : db(ldb_path, nCacheSize, fMemory, fWipe, true)\n+CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) :\n+    m_ldb_path(ldb_path),\n+    m_is_memory(fMemory),",
    "path": "src/txdb.cpp",
    "position": null,
    "original_position": 15,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "0fd9039ab3de00a0ac03b8fe0463f0c62a92dd43",
    "user": {
      "login": "jamesob",
      "id": 73197,
      "node_id": "MDQ6VXNlcjczMTk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jamesob",
      "html_url": "https://github.com/jamesob",
      "followers_url": "https://api.github.com/users/jamesob/followers",
      "following_url": "https://api.github.com/users/jamesob/following{/other_user}",
      "gists_url": "https://api.github.com/users/jamesob/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
      "organizations_url": "https://api.github.com/users/jamesob/orgs",
      "repos_url": "https://api.github.com/users/jamesob/repos",
      "events_url": "https://api.github.com/users/jamesob/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jamesob/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "FWIW I can't reproduce this locally with either clang or gcc:\r\n\r\n```\r\nCC            = /usr/bin/ccache /usr/bin/clang\r\nCFLAGS        = -g -O2\r\nCPPFLAGS      =  -DDEBUG -DDEBUG_LOCKORDER  -I/home/james/src/bitcoin/db4/include/ -DHAVE_BUILD_INFO -D__STDC_FORMAT_MACROS\r\nCXX           = /usr/bin/ccache /usr/bin/clang++ -std=c++11\r\nCXXFLAGS      =  -O0 -g3 -ftrapv  -Wstack-protector -fstack-protector-all     -std=c++11 -Wthread-safety-analysis -Werror\r\n\r\n% clang++ --version\r\nclang version 7.0.1-8 (tags/RELEASE_701/final)\r\nTarget: x86_64-pc-linux-gnu\r\nThread model: posix\r\nInstalledDir: /usr/bin\r\n\r\n% gcc --version\r\ngcc (Debian 8.3.0-6) 8.3.0\r\nCopyright (C) 2018 Free Software Foundation, Inc.\r\nThis is free software; see the source for copying conditions.  There is NO\r\nwarranty; not even for MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.\r\n```",
    "created_at": "2020-06-30T18:20:51Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r447889705",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/447889705"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r447889705"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/447889705/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 47,
    "side": "RIGHT",
    "in_reply_to_id": 440414525
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/448459247",
    "pull_request_review_id": 440997107,
    "id": 448459247,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQ1OTI0Nw==",
    "diff_hunk": "@@ -41,35 +42,45 @@ struct CoinEntry {\n \n }\n \n-CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) : db(ldb_path, nCacheSize, fMemory, fWipe, true)\n+CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) :\n+    m_ldb_path(ldb_path),\n+    m_is_memory(fMemory),",
    "path": "src/txdb.cpp",
    "position": null,
    "original_position": 15,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "0fd9039ab3de00a0ac03b8fe0463f0c62a92dd43",
    "user": {
      "login": "ajtowns",
      "id": 127186,
      "node_id": "MDQ6VXNlcjEyNzE4Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajtowns",
      "html_url": "https://github.com/ajtowns",
      "followers_url": "https://api.github.com/users/ajtowns/followers",
      "following_url": "https://api.github.com/users/ajtowns/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajtowns/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
      "organizations_url": "https://api.github.com/users/ajtowns/orgs",
      "repos_url": "https://api.github.com/users/ajtowns/repos",
      "events_url": "https://api.github.com/users/ajtowns/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajtowns/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "You just need to move `m_db` to be the first thing initialized, just as it's the first thing declared in txdb.h. Warning appears for me with clang 9.0 fwiw. cf https://en.cppreference.com/w/cpp/language/constructor#Initialization_order",
    "created_at": "2020-07-01T15:52:42Z",
    "updated_at": "2020-07-01T18:46:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r448459247",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/448459247"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r448459247"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/448459247/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 47,
    "side": "RIGHT",
    "in_reply_to_id": 440414525
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/448479334",
    "pull_request_review_id": 441023103,
    "id": 448479334,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODQ3OTMzNA==",
    "diff_hunk": "@@ -60,6 +65,9 @@ class CCoinsViewDB final : public CCoinsView\n     //! Attempt to update from an older database format. Returns whether an error occurred.\n     bool Upgrade();\n     size_t EstimateSize() const override;\n+\n+    //! Dynamically alter the underlying leveldb cache size.\n+    void ResizeCache(size_t new_cache_size) EXCLUSIVE_LOCKS_REQUIRED(cs_main);",
    "path": "src/txdb.h",
    "position": 24,
    "original_position": 24,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "0fd9039ab3de00a0ac03b8fe0463f0c62a92dd43",
    "user": {
      "login": "ajtowns",
      "id": 127186,
      "node_id": "MDQ6VXNlcjEyNzE4Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajtowns",
      "html_url": "https://github.com/ajtowns",
      "followers_url": "https://api.github.com/users/ajtowns/followers",
      "following_url": "https://api.github.com/users/ajtowns/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajtowns/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
      "organizations_url": "https://api.github.com/users/ajtowns/orgs",
      "repos_url": "https://api.github.com/users/ajtowns/repos",
      "events_url": "https://api.github.com/users/ajtowns/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajtowns/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This seems a bit of an anti-pattern -- it's not ResizeCache() that needs cs_main, it's the fact that when it's called it ends up operating on `m_coins_views->m_dbview` which does need cs_main, but that's not enforced because the constraint is thrown away by CoinsDB() returning a reference to the guarded object.\r\n\r\nI think it might be better to replace `CoinsDB()` by a `GetCoinsViews()` that returns a reference to `m_coins_views`, and then have `auto& x = GetCoinsViews(); LOCK(cs_main); x.m_dbview.ResizeCache(y);` ? No need to address in this PR though, I think.",
    "created_at": "2020-07-01T16:26:23Z",
    "updated_at": "2020-07-01T18:47:09Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r448479334",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/448479334"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r448479334"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/448479334/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 70,
    "original_line": 70,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/448552717",
    "pull_request_review_id": 441115809,
    "id": 448552717,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0ODU1MjcxNw==",
    "diff_hunk": "@@ -41,35 +42,45 @@ struct CoinEntry {\n \n }\n \n-CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) : db(ldb_path, nCacheSize, fMemory, fWipe, true)\n+CCoinsViewDB::CCoinsViewDB(fs::path ldb_path, size_t nCacheSize, bool fMemory, bool fWipe) :\n+    m_ldb_path(ldb_path),\n+    m_is_memory(fMemory),",
    "path": "src/txdb.cpp",
    "position": null,
    "original_position": 15,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "0fd9039ab3de00a0ac03b8fe0463f0c62a92dd43",
    "user": {
      "login": "jamesob",
      "id": 73197,
      "node_id": "MDQ6VXNlcjczMTk3",
      "avatar_url": "https://avatars.githubusercontent.com/u/73197?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jamesob",
      "html_url": "https://github.com/jamesob",
      "followers_url": "https://api.github.com/users/jamesob/followers",
      "following_url": "https://api.github.com/users/jamesob/following{/other_user}",
      "gists_url": "https://api.github.com/users/jamesob/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jamesob/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jamesob/subscriptions",
      "organizations_url": "https://api.github.com/users/jamesob/orgs",
      "repos_url": "https://api.github.com/users/jamesob/repos",
      "events_url": "https://api.github.com/users/jamesob/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jamesob/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Fixed, thanks",
    "created_at": "2020-07-01T18:47:04Z",
    "updated_at": "2020-07-01T18:47:04Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r448552717",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/448552717"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r448552717"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/448552717/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 47,
    "side": "RIGHT",
    "in_reply_to_id": 440414525
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/449710524",
    "pull_request_review_id": 442566498,
    "id": 449710524,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ0OTcxMDUyNA==",
    "diff_hunk": "@@ -5297,3 +5297,33 @@ void ChainstateManager::Reset()\n     m_active_chainstate = nullptr;\n     m_snapshot_validated = false;\n }\n+\n+void ChainstateManager::MaybeRebalanceCaches()\n+{\n+    if (m_ibd_chainstate && !m_snapshot_chainstate) {\n+        LogPrintf(\"[snapshot] allocating all cache to the IBD chainstate\\n\");\n+        // Allocate everything to the IBD chainstate.\n+        m_ibd_chainstate->ResizeCoinsCaches(m_total_coinstip_cache, m_total_coinsdb_cache);\n+    }\n+    else if (m_snapshot_chainstate && !m_ibd_chainstate) {\n+        LogPrintf(\"[snapshot] allocating all cache to the snapshot chainstate\\n\");\n+        // Allocate everything to the snapshot chainstate.\n+        m_snapshot_chainstate->ResizeCoinsCaches(m_total_coinstip_cache, m_total_coinsdb_cache);\n+    }\n+    else if (m_ibd_chainstate && m_snapshot_chainstate) {\n+        // If both chainstates exist, determine who needs more cache based on IBD status.",
    "path": "src/validation.cpp",
    "position": 96,
    "original_position": 18,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "8ac3ef46999ed676ca3775f7b2f461d92f09a542",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "super-nit: A bit more info on the rationale behind 0.05/0.95 would be nice. Also, the values could be constants. But that can be considered for a follow-up.",
    "created_at": "2020-07-03T21:59:03Z",
    "updated_at": "2020-07-03T22:00:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r449710524",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/449710524"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r449710524"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/449710524/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 5314,
    "original_line": 5314,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/462269791",
    "pull_request_review_id": 457483812,
    "id": 462269791,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI2OTc5MQ==",
    "diff_hunk": "@@ -57,12 +55,13 @@ BOOST_AUTO_TEST_CASE(chainstatemanager)\n     // Create a snapshot-based chainstate.\n     //\n     ENTER_CRITICAL_SECTION(cs_main);\n-    CChainState& c2 = manager.InitializeChainstate(GetRandHash());\n+    CChainState& c2 = *WITH_LOCK(::cs_main,\n+        return &manager.InitializeChainstate(GetRandHash()));",
    "path": "src/test/validation_chainstatemanager_tests.cpp",
    "position": 22,
    "original_position": 22,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "user": {
      "login": "darosior",
      "id": 22457751,
      "node_id": "MDQ6VXNlcjIyNDU3NzUx",
      "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/darosior",
      "html_url": "https://github.com/darosior",
      "followers_url": "https://api.github.com/users/darosior/followers",
      "following_url": "https://api.github.com/users/darosior/following{/other_user}",
      "gists_url": "https://api.github.com/users/darosior/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/darosior/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
      "organizations_url": "https://api.github.com/users/darosior/orgs",
      "repos_url": "https://api.github.com/users/darosior/repos",
      "events_url": "https://api.github.com/users/darosior/events{/privacy}",
      "received_events_url": "https://api.github.com/users/darosior/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Doesn't this lock `cs_main` twice ?",
    "created_at": "2020-07-29T12:45:58Z",
    "updated_at": "2020-07-29T12:46:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r462269791",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/462269791"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r462269791"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/462269791/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 57,
    "original_start_line": 57,
    "start_side": "RIGHT",
    "line": 59,
    "original_line": 59,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/462271342",
    "pull_request_review_id": 457485909,
    "id": 462271342,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI3MTM0Mg==",
    "diff_hunk": "@@ -57,12 +55,13 @@ BOOST_AUTO_TEST_CASE(chainstatemanager)\n     // Create a snapshot-based chainstate.\n     //\n     ENTER_CRITICAL_SECTION(cs_main);\n-    CChainState& c2 = manager.InitializeChainstate(GetRandHash());\n+    CChainState& c2 = *WITH_LOCK(::cs_main,\n+        return &manager.InitializeChainstate(GetRandHash()));",
    "path": "src/test/validation_chainstatemanager_tests.cpp",
    "position": 22,
    "original_position": 22,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The test nits are fixed in the first commit of #19604 ",
    "created_at": "2020-07-29T12:48:35Z",
    "updated_at": "2020-07-29T12:48:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r462271342",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/462271342"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r462271342"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/462271342/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 57,
    "original_start_line": 57,
    "start_side": "RIGHT",
    "line": 59,
    "original_line": 59,
    "side": "RIGHT",
    "in_reply_to_id": 462269791
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/462275500",
    "pull_request_review_id": 457491435,
    "id": 462275500,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDQ2MjI3NTUwMA==",
    "diff_hunk": "@@ -57,12 +55,13 @@ BOOST_AUTO_TEST_CASE(chainstatemanager)\n     // Create a snapshot-based chainstate.\n     //\n     ENTER_CRITICAL_SECTION(cs_main);\n-    CChainState& c2 = manager.InitializeChainstate(GetRandHash());\n+    CChainState& c2 = *WITH_LOCK(::cs_main,\n+        return &manager.InitializeChainstate(GetRandHash()));",
    "path": "src/test/validation_chainstatemanager_tests.cpp",
    "position": 22,
    "original_position": 22,
    "commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "original_commit_id": "f19fdd47a6371dcbe0760ef6f3c3c5adb31b1bb4",
    "user": {
      "login": "darosior",
      "id": 22457751,
      "node_id": "MDQ6VXNlcjIyNDU3NzUx",
      "avatar_url": "https://avatars.githubusercontent.com/u/22457751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/darosior",
      "html_url": "https://github.com/darosior",
      "followers_url": "https://api.github.com/users/darosior/followers",
      "following_url": "https://api.github.com/users/darosior/following{/other_user}",
      "gists_url": "https://api.github.com/users/darosior/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/darosior/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/darosior/subscriptions",
      "organizations_url": "https://api.github.com/users/darosior/orgs",
      "repos_url": "https://api.github.com/users/darosior/repos",
      "events_url": "https://api.github.com/users/darosior/events{/privacy}",
      "received_events_url": "https://api.github.com/users/darosior/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yep. Brainfart. Just noticed while rebasing https://github.com/bitcoin/bitcoin/pull/19556 and commented without thinking.",
    "created_at": "2020-07-29T12:55:18Z",
    "updated_at": "2020-07-29T12:55:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r462275500",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/462275500"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/18637#discussion_r462275500"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/18637"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/462275500/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 57,
    "original_start_line": 57,
    "start_side": "RIGHT",
    "line": 59,
    "original_line": 59,
    "side": "RIGHT",
    "in_reply_to_id": 462269791
  }
]