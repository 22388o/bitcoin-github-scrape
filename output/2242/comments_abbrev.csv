sipa,2013-01-30T15:54:37Z,"fReindex=false is set immediately after the while loop anyway, just break suffices. I prefer not changing fReindex without writing it to the block index.\n",https://github.com/bitcoin/bitcoin/pull/2242#discussion_r2828009,2828009,src/init.cpp
sipa,2013-01-30T15:55:17Z,"Is this necessary? it will fail if the directory exists but is empty, for example. Trying to do a reindex shouldn't hurt.\n",https://github.com/bitcoin/bitcoin/pull/2242#discussion_r2828018,2828018,src/init.cpp
Diapolo,2013-01-30T18:13:54Z,"The change here is intended to give ""Reindexing aborted"" in the log (nothing more in the end, as I found it weird to read `Reindexing finished` after a crash).\n\nI understand your wish to link setting fReindex with writing the reindex-state to block index. But if fRequestShutdown is getting true we also don't write it?\n\nEdit: What about using nFile = -1 as a check that OpenBlockFile() failed ;)",https://github.com/bitcoin/bitcoin/pull/2242#discussion_r2830311,2830311,src/init.cpp
Diapolo,2013-01-30T18:15:12Z,"This check prevents the crash for me, you are right perhaps it should use ::is_empty(). If you think there is no crash or problem, did you try -reindex with empty data dir yet?\n",https://github.com/bitcoin/bitcoin/pull/2242#discussion_r2830329,2830329,src/init.cpp
Diapolo,2013-01-30T18:35:48Z,Changed this to use the flag nFile = -1 now.\n,https://github.com/bitcoin/bitcoin/pull/2242#discussion_r2830703,2830703,src/init.cpp
Diapolo,2013-01-30T18:36:12Z,Reworked to now check if the dir exists and if it's empty.\n,https://github.com/bitcoin/bitcoin/pull/2242#discussion_r2830716,2830716,src/init.cpp
sipa,2013-01-30T19:23:00Z,"That will cause it to always report aborted, no? We iterate until we can't open any file anymore.\n",https://github.com/bitcoin/bitcoin/pull/2242#discussion_r2831664,2831664,src/init.cpp
sipa,2013-01-30T19:24:03Z,"I don't think this is the correct solution. Whether the directory exist or not shouldn't ever cause a crash. If it does, that's a bug elsewhere.\n",https://github.com/bitcoin/bitcoin/pull/2242#discussion_r2831693,2831693,src/init.cpp
