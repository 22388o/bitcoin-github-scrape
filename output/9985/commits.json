[
  {
    "sha": "bbfdb8da664bb19798c74d2e10bd879696231a58",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiYmZkYjhkYTY2NGJiMTk3OThjNzRkMmUxMGJkODc5Njk2MjMxYTU4",
    "commit": {
      "author": {
        "name": "NicolasDorier",
        "email": "nicolas.dorier@gmail.com",
        "date": "2017-03-13T12:12:07Z"
      },
      "committer": {
        "name": "NicolasDorier",
        "email": "nicolas.dorier@gmail.com",
        "date": "2017-03-13T17:04:31Z"
      },
      "message": "[QT] Show more descriptive label for pay to yourself transaction entries",
      "tree": {
        "sha": "f7bf0aa3e12f8605c5b8386605a3493d202e2c73",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f7bf0aa3e12f8605c5b8386605a3493d202e2c73"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bbfdb8da664bb19798c74d2e10bd879696231a58",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bbfdb8da664bb19798c74d2e10bd879696231a58",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/bbfdb8da664bb19798c74d2e10bd879696231a58",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bbfdb8da664bb19798c74d2e10bd879696231a58/comments",
    "author": {
      "login": "NicolasDorier",
      "id": 3020646,
      "node_id": "MDQ6VXNlcjMwMjA2NDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3020646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NicolasDorier",
      "html_url": "https://github.com/NicolasDorier",
      "followers_url": "https://api.github.com/users/NicolasDorier/followers",
      "following_url": "https://api.github.com/users/NicolasDorier/following{/other_user}",
      "gists_url": "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NicolasDorier/subscriptions",
      "organizations_url": "https://api.github.com/users/NicolasDorier/orgs",
      "repos_url": "https://api.github.com/users/NicolasDorier/repos",
      "events_url": "https://api.github.com/users/NicolasDorier/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NicolasDorier/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "NicolasDorier",
      "id": 3020646,
      "node_id": "MDQ6VXNlcjMwMjA2NDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3020646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NicolasDorier",
      "html_url": "https://github.com/NicolasDorier",
      "followers_url": "https://api.github.com/users/NicolasDorier/followers",
      "following_url": "https://api.github.com/users/NicolasDorier/following{/other_user}",
      "gists_url": "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NicolasDorier/subscriptions",
      "organizations_url": "https://api.github.com/users/NicolasDorier/orgs",
      "repos_url": "https://api.github.com/users/NicolasDorier/repos",
      "events_url": "https://api.github.com/users/NicolasDorier/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NicolasDorier/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "afcd7c0e52d87734a29e55f695553ff0dee31078",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/afcd7c0e52d87734a29e55f695553ff0dee31078",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/afcd7c0e52d87734a29e55f695553ff0dee31078"
      }
    ],
    "stats": {
      "total": 21,
      "additions": 14,
      "deletions": 7
    },
    "files": [
      {
        "sha": "c5693d00889764e51ec7ea3d75259b479aea3e80",
        "filename": "src/qt/addresstablemodel.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 1,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bbfdb8da664bb19798c74d2e10bd879696231a58/src/qt/addresstablemodel.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bbfdb8da664bb19798c74d2e10bd879696231a58/src/qt/addresstablemodel.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/addresstablemodel.cpp?ref=bbfdb8da664bb19798c74d2e10bd879696231a58",
        "patch": "@@ -422,7 +422,9 @@ bool AddressTableModel::removeRows(int row, int count, const QModelIndex &parent\n  */\n QString AddressTableModel::labelForAddress(const QString &address) const\n {\n-    {\n+    if (address.isEmpty())\n+        return QString();\n+    {        \n         LOCK(wallet->cs_wallet);\n         CBitcoinAddress address_parsed(address.toStdString());\n         std::map<CTxDestination, CAddressBookData>::iterator mi = wallet->mapAddressBook.find(address_parsed.Get());"
      },
      {
        "sha": "51f1864e6d0ed01516e99c6d8fb211fcde3c282c",
        "filename": "src/qt/transactionrecord.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 2,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bbfdb8da664bb19798c74d2e10bd879696231a58/src/qt/transactionrecord.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bbfdb8da664bb19798c74d2e10bd879696231a58/src/qt/transactionrecord.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/transactionrecord.cpp?ref=bbfdb8da664bb19798c74d2e10bd879696231a58",
        "patch": "@@ -103,8 +103,13 @@ QList<TransactionRecord> TransactionRecord::decomposeTransaction(const CWallet *\n         {\n             // Payment to self\n             CAmount nChange = wtx.GetChange();\n-\n-            parts.append(TransactionRecord(hash, nTime, TransactionRecord::SendToSelf, \"\",\n+            std::string address;\n+            CTxDestination destAddress;\n+            if (wtx.tx->vout.size() >= 1 && ExtractDestination(wtx.tx->vout[0].scriptPubKey, destAddress))\n+            { \n+                address = CBitcoinAddress(destAddress).ToString();\n+            }\n+            parts.append(TransactionRecord(hash, nTime, TransactionRecord::SendToSelf, address,\n                             -(nDebit - nChange), nCredit - nChange));\n             parts.last().involvesWatchAddress = involvesWatchAddress;   // maybe pass to TransactionRecord as constructor argument\n         }"
      },
      {
        "sha": "46196da6ad6764a1963ed5c9207f729a6756d723",
        "filename": "src/qt/transactiontablemodel.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 4,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bbfdb8da664bb19798c74d2e10bd879696231a58/src/qt/transactiontablemodel.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bbfdb8da664bb19798c74d2e10bd879696231a58/src/qt/transactiontablemodel.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/transactiontablemodel.cpp?ref=bbfdb8da664bb19798c74d2e10bd879696231a58",
        "patch": "@@ -360,7 +360,8 @@ QString TransactionTableModel::lookupAddress(const std::string &address, bool to\n     }\n     if(label.isEmpty() || tooltip)\n     {\n-        description += QString(\" (\") + QString::fromStdString(address) + QString(\")\");\n+        label = address.empty() ? QString(\"n/a\") : QString::fromStdString(address);\n+        description += QString(\" (\") + label + QString(\")\");\n     }\n     return description;\n }\n@@ -417,10 +418,10 @@ QString TransactionTableModel::formatTxToAddress(const TransactionRecord *wtx, b\n     case TransactionRecord::RecvWithAddress:\n     case TransactionRecord::SendToAddress:\n     case TransactionRecord::Generated:\n+    case TransactionRecord::SendToSelf:\n         return lookupAddress(wtx->address, tooltip) + watchAddress;\n     case TransactionRecord::SendToOther:\n         return QString::fromStdString(wtx->address) + watchAddress;\n-    case TransactionRecord::SendToSelf:\n     default:\n         return tr(\"(n/a)\") + watchAddress;\n     }\n@@ -434,13 +435,12 @@ QVariant TransactionTableModel::addressColor(const TransactionRecord *wtx) const\n     case TransactionRecord::RecvWithAddress:\n     case TransactionRecord::SendToAddress:\n     case TransactionRecord::Generated:\n+    case TransactionRecord::SendToSelf:\n         {\n         QString label = walletModel->getAddressTableModel()->labelForAddress(QString::fromStdString(wtx->address));\n         if(label.isEmpty())\n             return COLOR_BAREADDRESS;\n         } break;\n-    case TransactionRecord::SendToSelf:\n-        return COLOR_BAREADDRESS;\n     default:\n         break;\n     }"
      }
    ]
  }
]