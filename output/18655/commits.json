[
  {
    "sha": "fa215adc7aeb3d1fc5897b5c8e987e93c1a48741",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYTIxNWFkYzdhZWIzZDFmYzU4OTdiNWM4ZTk4N2U5M2MxYTQ4NzQx",
    "commit": {
      "author": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2020-04-13T19:47:26Z"
      },
      "committer": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2020-04-15T16:43:19Z"
      },
      "message": "Add bumpFeePSBT action instead of changing normal bumpfee behavior\n\nInstead of changing GUI bumpfee behavior based on private keys,\nmake a separate menu action to do that.",
      "tree": {
        "sha": "bdc53b600500eb45c55ef7ceb201a2b338190277",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bdc53b600500eb45c55ef7ceb201a2b338190277"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa215adc7aeb3d1fc5897b5c8e987e93c1a48741",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa215adc7aeb3d1fc5897b5c8e987e93c1a48741",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fa215adc7aeb3d1fc5897b5c8e987e93c1a48741",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa215adc7aeb3d1fc5897b5c8e987e93c1a48741/comments",
    "author": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "20c0e2e0f04f699d29419d52696601b76eca3124",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/20c0e2e0f04f699d29419d52696601b76eca3124",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/20c0e2e0f04f699d29419d52696601b76eca3124"
      }
    ],
    "stats": {
      "total": 29,
      "additions": 20,
      "deletions": 9
    },
    "files": [
      {
        "sha": "fd5bd36b920cfbbf638e864fd857c0f76abd455b",
        "filename": "src/qt/transactionview.cpp",
        "status": "modified",
        "additions": 15,
        "deletions": 4,
        "changes": 19,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa215adc7aeb3d1fc5897b5c8e987e93c1a48741/src/qt/transactionview.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa215adc7aeb3d1fc5897b5c8e987e93c1a48741/src/qt/transactionview.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/transactionview.cpp?ref=fa215adc7aeb3d1fc5897b5c8e987e93c1a48741",
        "patch": "@@ -37,7 +37,7 @@\n \n TransactionView::TransactionView(const PlatformStyle *platformStyle, QWidget *parent) :\n     QWidget(parent), model(nullptr), transactionProxyModel(nullptr),\n-    transactionView(nullptr), abandonAction(nullptr), bumpFeeAction(nullptr), columnResizingFixer(nullptr)\n+    transactionView(nullptr), abandonAction(nullptr), bumpFeeAction(nullptr), bumpFeePSBTAction(nullptr), columnResizingFixer(nullptr)\n {\n     // Build filter row\n     setContentsMargins(0,0,0,0);\n@@ -152,6 +152,8 @@ TransactionView::TransactionView(const PlatformStyle *platformStyle, QWidget *pa\n     abandonAction = new QAction(tr(\"Abandon transaction\"), this);\n     bumpFeeAction = new QAction(tr(\"Increase transaction fee\"), this);\n     bumpFeeAction->setObjectName(\"bumpFeeAction\");\n+    bumpFeePSBTAction = new QAction(tr(\"Increase transaction fee (make PSBT)\"), this);\n+    bumpFeePSBTAction->setObjectName(\"bumpFeePSBTAction\");\n     QAction *copyAddressAction = new QAction(tr(\"Copy address\"), this);\n     QAction *copyLabelAction = new QAction(tr(\"Copy label\"), this);\n     QAction *copyAmountAction = new QAction(tr(\"Copy amount\"), this);\n@@ -172,6 +174,7 @@ TransactionView::TransactionView(const PlatformStyle *platformStyle, QWidget *pa\n     contextMenu->addAction(showDetailsAction);\n     contextMenu->addSeparator();\n     contextMenu->addAction(bumpFeeAction);\n+    contextMenu->addAction(bumpFeePSBTAction);\n     contextMenu->addAction(abandonAction);\n     contextMenu->addAction(editLabelAction);\n \n@@ -187,6 +190,7 @@ TransactionView::TransactionView(const PlatformStyle *platformStyle, QWidget *pa\n     connect(view, &QTableView::customContextMenuRequested, this, &TransactionView::contextualMenu);\n \n     connect(bumpFeeAction, &QAction::triggered, this, &TransactionView::bumpFee);\n+    connect(bumpFeePSBTAction, &QAction::triggered, this, &TransactionView::bumpFeePSBT);\n     connect(abandonAction, &QAction::triggered, this, &TransactionView::abandonTx);\n     connect(copyAddressAction, &QAction::triggered, this, &TransactionView::copyAddress);\n     connect(copyLabelAction, &QAction::triggered, this, &TransactionView::copyLabel);\n@@ -394,7 +398,8 @@ void TransactionView::contextualMenu(const QPoint &point)\n     uint256 hash;\n     hash.SetHex(selection.at(0).data(TransactionTableModel::TxHashRole).toString().toStdString());\n     abandonAction->setEnabled(model->wallet().transactionCanBeAbandoned(hash));\n-    bumpFeeAction->setEnabled(model->wallet().transactionCanBeBumped(hash));\n+    bumpFeeAction->setEnabled(model->wallet().transactionCanBeBumped(hash) && !model->wallet().privateKeysDisabled());\n+    bumpFeePSBTAction->setEnabled(model->wallet().transactionCanBeBumped(hash));\n \n     if(index.isValid())\n     {\n@@ -420,7 +425,7 @@ void TransactionView::abandonTx()\n     model->getTransactionTableModel()->updateTransaction(hashQStr, CT_UPDATED, false);\n }\n \n-void TransactionView::bumpFee()\n+void TransactionView::bumpFee(bool make_psbt)\n {\n     if(!transactionView || !transactionView->selectionModel())\n         return;\n@@ -433,7 +438,7 @@ void TransactionView::bumpFee()\n \n     // Bump tx fee over the walletModel\n     uint256 newHash;\n-    if (model->bumpFee(hash, newHash)) {\n+    if (model->bumpFee(hash, newHash, make_psbt)) {\n         // Update the table\n         transactionView->selectionModel()->clearSelection();\n         model->getTransactionTableModel()->updateTransaction(hashQStr, CT_UPDATED, true);\n@@ -443,6 +448,12 @@ void TransactionView::bumpFee()\n     }\n }\n \n+\n+void TransactionView::bumpFeePSBT()\n+{\n+    bumpFee(true);\n+}\n+\n void TransactionView::copyAddress()\n {\n     GUIUtil::copyEntryData(transactionView, 0, TransactionTableModel::AddressRole);"
      },
      {
        "sha": "68ff83ffcec47f70f26e070d4d4990088a646383",
        "filename": "src/qt/transactionview.h",
        "status": "modified",
        "additions": 3,
        "deletions": 1,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa215adc7aeb3d1fc5897b5c8e987e93c1a48741/src/qt/transactionview.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa215adc7aeb3d1fc5897b5c8e987e93c1a48741/src/qt/transactionview.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/transactionview.h?ref=fa215adc7aeb3d1fc5897b5c8e987e93c1a48741",
        "patch": "@@ -77,6 +77,7 @@ class TransactionView : public QWidget\n     QDateTimeEdit *dateTo;\n     QAction *abandonAction;\n     QAction *bumpFeeAction;\n+    QAction *bumpFeePSBTAction;\n \n     QWidget *createDateRangeWidget();\n \n@@ -100,7 +101,8 @@ private Q_SLOTS:\n     void openThirdPartyTxUrl(QString url);\n     void updateWatchOnlyColumn(bool fHaveWatchOnly);\n     void abandonTx();\n-    void bumpFee();\n+    void bumpFee(bool make_psbt = false);\n+    void bumpFeePSBT();\n \n Q_SIGNALS:\n     void doubleClicked(const QModelIndex&);"
      },
      {
        "sha": "8c560ce12f899e659278ba8e0cf96bb4cc01576e",
        "filename": "src/qt/walletmodel.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 3,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa215adc7aeb3d1fc5897b5c8e987e93c1a48741/src/qt/walletmodel.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa215adc7aeb3d1fc5897b5c8e987e93c1a48741/src/qt/walletmodel.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/walletmodel.cpp?ref=fa215adc7aeb3d1fc5897b5c8e987e93c1a48741",
        "patch": "@@ -478,7 +478,7 @@ bool WalletModel::saveReceiveRequest(const std::string &sAddress, const int64_t\n         return m_wallet->addDestData(dest, key, sRequest);\n }\n \n-bool WalletModel::bumpFee(uint256 hash, uint256& new_hash)\n+bool WalletModel::bumpFee(uint256 hash, uint256& new_hash, bool create_psbt)\n {\n     CCoinControl coin_control;\n     coin_control.m_signal_bip125_rbf = true;\n@@ -492,8 +492,6 @@ bool WalletModel::bumpFee(uint256 hash, uint256& new_hash)\n          return false;\n     }\n \n-    const bool create_psbt = m_wallet->privateKeysDisabled();\n-\n     // allow a user based fee verification\n     QString questionString = create_psbt ? tr(\"Do you want to draft a transaction with fee increase?\") : tr(\"Do you want to increase the fee?\");\n     questionString.append(\"<br />\");"
      },
      {
        "sha": "4371d6b02643be706f2437cf5b62649b20aa0dd4",
        "filename": "src/qt/walletmodel.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa215adc7aeb3d1fc5897b5c8e987e93c1a48741/src/qt/walletmodel.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa215adc7aeb3d1fc5897b5c8e987e93c1a48741/src/qt/walletmodel.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/walletmodel.h?ref=fa215adc7aeb3d1fc5897b5c8e987e93c1a48741",
        "patch": "@@ -138,7 +138,7 @@ class WalletModel : public QObject\n     void loadReceiveRequests(std::vector<std::string>& vReceiveRequests);\n     bool saveReceiveRequest(const std::string &sAddress, const int64_t nId, const std::string &sRequest);\n \n-    bool bumpFee(uint256 hash, uint256& new_hash);\n+    bool bumpFee(uint256 hash, uint256& new_hash, bool make_psbt);\n \n     static bool isWalletEnabled();\n "
      }
    ]
  }
]