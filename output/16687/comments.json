[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/524086041",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16687#issuecomment-524086041",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/16687",
    "id": 524086041,
    "node_id": "MDEyOklzc3VlQ29tbWVudDUyNDA4NjA0MQ==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-08-22T21:32:22Z",
    "updated_at": "2019-08-22T21:32:22Z",
    "author_association": "MEMBER",
    "body": "opened in error. Should have been on a different repo",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/524086041/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/316890943",
    "pull_request_review_id": 278694433,
    "id": 316890943,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMxNjg5MDk0Mw==",
    "diff_hunk": "@@ -583,4 +595,15 @@ struct CScriptWitness\n     std::string ToString() const;\n };\n \n+class CReserveScript",
    "path": "src/script/script.h",
    "position": 30,
    "original_position": 30,
    "commit_id": "00708a2029d13a3876cb01a566dc6e93330674af",
    "original_commit_id": "00708a2029d13a3876cb01a566dc6e93330674af",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "You've accidentally reintroduced this in ebcfe3584199f281f825625dcadef8535dece536",
    "created_at": "2019-08-22T21:22:33Z",
    "updated_at": "2019-08-22T21:29:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16687#discussion_r316890943",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16687",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/316890943"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16687#discussion_r316890943"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16687"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/316890943/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 598,
    "original_line": 598,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/316891659",
    "pull_request_review_id": 278694433,
    "id": 316891659,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMxNjg5MTY1OQ==",
    "diff_hunk": "@@ -908,54 +911,105 @@ bool EvalScript(std::vector<std::vector<unsigned char> >& stack, const CScript&\n \n                     // Hash starts after the code separator\n                     pbegincodehash = pc;\n+                    execdata.m_codeseparator_pos = opcode_pos;\n                 }\n                 break;\n \n                 case OP_CHECKSIG:\n                 case OP_CHECKSIGVERIFY:\n+                case OP_CHECKSIGADD:\n                 {\n+                    if (opcode == OP_CHECKSIGADD && sigversion <= SigVersion::WITNESS_V0) {\n+                        return set_error(serror, SCRIPT_ERR_BAD_OPCODE);\n+                    }\n+                    const int args = (opcode == OP_CHECKSIGADD) ? 3 : 2;\n+\n                     // (sig pubkey -- bool)\n-                    if (stack.size() < 2)\n+                    if (stack.size() < (size_t)args)\n                         return set_error(serror, SCRIPT_ERR_INVALID_STACK_OPERATION);\n \n-                    valtype& vchSig    = stacktop(-2);\n-                    valtype& vchPubKey = stacktop(-1);\n+                    const valtype& vchSig    = stacktop(-args);\n+                    const valtype& vchPubKey = stacktop(-1);\n+                    const CScriptNum num = (opcode == OP_CHECKSIGADD) ? CScriptNum(stacktop(-2), fRequireMinimal) : bnZero;\n \n-                    // Subset of script starting at the most recent codeseparator\n-                    CScript scriptCode(pbegincodehash, pend);\n+                    bool fSuccess;\n \n-                    // Drop the signature in pre-segwit scripts but not segwit scripts\n-                    if (sigversion == SigVersion::BASE) {\n-                        int found = FindAndDelete(scriptCode, CScript() << vchSig);\n-                        if (found > 0 && (flags & SCRIPT_VERIFY_CONST_SCRIPTCODE))\n-                            return set_error(serror, SCRIPT_ERR_SIG_FINDANDDELETE);\n-                    }\n+                    switch (sigversion)\n+                    {\n+                    case SigVersion::BASE:\n+                    case SigVersion::WITNESS_V0:\n+                    {\n+                        // Subset of script starting at the most recent codeseparator\n+                        execdata.m_scriptcode = CScript(pbegincodehash, pend);\n \n-                    if (!CheckSignatureEncoding(vchSig, flags, serror) || !CheckPubKeyEncoding(vchPubKey, flags, sigversion, serror)) {\n-                        //serror is set\n-                        return false;\n-                    }\n-                    bool fSuccess = checker.CheckSig(vchSig, vchPubKey, scriptCode, sigversion);\n+                        // Drop the signature in pre-segwit scripts but not segwit scripts\n+                        if (sigversion == SigVersion::BASE) {\n+                            int found = FindAndDelete(execdata.m_scriptcode,  CScript() << vchSig);",
    "path": "src/script/interpreter.cpp",
    "position": 81,
    "original_position": 81,
    "commit_id": "00708a2029d13a3876cb01a566dc6e93330674af",
    "original_commit_id": "00708a2029d13a3876cb01a566dc6e93330674af",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: double space before `CScript`",
    "created_at": "2019-08-22T21:24:42Z",
    "updated_at": "2019-08-22T21:29:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16687#discussion_r316891659",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16687",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/316891659"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16687#discussion_r316891659"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16687"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/316891659/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 947,
    "original_line": 947,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/316892660",
    "pull_request_review_id": 278694433,
    "id": 316892660,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMxNjg5MjY2MA==",
    "diff_hunk": "@@ -1689,6 +1695,11 @@ static unsigned int GetBlockScriptFlags(const CBlockIndex* pindex, const Consens\n         flags |= SCRIPT_VERIFY_CHECKSEQUENCEVERIFY;\n     }\n \n+    // Start enforcing Taproot using versionbits logic.\n+    if (VersionBitsState(pindex->pprev, consensusparams, Consensus::DEPLOYMENT_TAPROOT, versionbitscache) == ThresholdState::ACTIVE) {\n+        flags |= SCRIPT_VERIFY_TAPROOT;\n+    }\n+    ",
    "path": "src/validation.cpp",
    "position": 53,
    "original_position": 53,
    "commit_id": "00708a2029d13a3876cb01a566dc6e93330674af",
    "original_commit_id": "00708a2029d13a3876cb01a566dc6e93330674af",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: trailing whitespace",
    "created_at": "2019-08-22T21:27:45Z",
    "updated_at": "2019-08-22T21:29:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16687#discussion_r316892660",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16687",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/316892660"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16687#discussion_r316892660"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16687"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/316892660/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1702,
    "original_line": 1702,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/316903701",
    "pull_request_review_id": 278710617,
    "id": 316903701,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDMxNjkwMzcwMQ==",
    "diff_hunk": "@@ -583,4 +595,15 @@ struct CScriptWitness\n     std::string ToString() const;\n };\n \n+class CReserveScript",
    "path": "src/script/script.h",
    "position": 30,
    "original_position": 30,
    "commit_id": "00708a2029d13a3876cb01a566dc6e93330674af",
    "original_commit_id": "00708a2029d13a3876cb01a566dc6e93330674af",
    "user": {
      "login": "elichai",
      "id": 2167860,
      "node_id": "MDQ6VXNlcjIxNjc4NjA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2167860?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/elichai",
      "html_url": "https://github.com/elichai",
      "followers_url": "https://api.github.com/users/elichai/followers",
      "following_url": "https://api.github.com/users/elichai/following{/other_user}",
      "gists_url": "https://api.github.com/users/elichai/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/elichai/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/elichai/subscriptions",
      "organizations_url": "https://api.github.com/users/elichai/orgs",
      "repos_url": "https://api.github.com/users/elichai/repos",
      "events_url": "https://api.github.com/users/elichai/events{/privacy}",
      "received_events_url": "https://api.github.com/users/elichai/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "What do you mean? isn't https://github.com/bitcoin/bitcoin/commit/ebcfe3584199f281f825625dcadef8535dece536 the only thing where this exists?",
    "created_at": "2019-08-22T22:02:56Z",
    "updated_at": "2019-08-22T22:02:56Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/16687#discussion_r316903701",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16687",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/316903701"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/16687#discussion_r316903701"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/16687"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/316903701/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 598,
    "original_line": 598,
    "side": "RIGHT",
    "in_reply_to_id": 316890943
  }
]