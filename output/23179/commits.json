[
  {
    "sha": "ee08741c9c6c6931c521f57d179532277dced546",
    "node_id": "C_kwDOABII59oAKGVlMDg3NDFjOWM2YzY5MzFjNTIxZjU3ZDE3OTUzMjI3N2RjZWQ1NDY",
    "commit": {
      "author": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-10-05T00:41:41Z"
      },
      "committer": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-10-05T00:41:41Z"
      },
      "message": "sandbox: add newfstatat to allowed filesystem syscalls",
      "tree": {
        "sha": "034238dbd4a11b8282e67e771188f84b14cd60ff",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/034238dbd4a11b8282e67e771188f84b14cd60ff"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ee08741c9c6c6931c521f57d179532277dced546",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz7FuIclQ9n+pXlWPLuufXMCVJsEFAmFbn1wACgkQLuufXMCV\nJsEEeRAAjxTb6en1FpGE8eoVHJ7ZkjEtrmSveiCkxE7SKWLRcLidXGt5keo/4UQQ\nFRzQnlAywOJ3uyTELp2L+Ovrz5NvMrYk/Wl/y3/6ApJ96E4DuGsQ3dDMkXjwsez9\nO4ioGGYU6UDx8TUTeO42ZVaRbcUFbHGznJf6ESBr90Jl00nusE0etfafIBtLkMI4\nI1psYoFV3OqjvNZhmxMzkoYlUkbmoCecRfgZ6BL8X1fAPqcmwRXQR8yiIhy/OSLK\nApVrvdYzs+VfIT/PVs0m0DDfFAGEa8K34wiU7ctznZOJtAqZ+XB9ramNkHSznhsK\nzyxu3z6Rbi9/QiXJ3lUqUPC3rkNSfZs7cLndaFN65Z0//NY539hxVFDaBpIWW+Ub\n5GQbTfum27zFwlz8fMUcDCEAQa3TY+B85/TmbcyCJ6Hp4mOtI+rdwvWUKu+iNxRl\nOVwXuBPRVbn2lVxN6JphUQa5kpLNl1vELr3OZnQVetxFIkMmx2L63Q+b68Gli+5K\nxiJHJAHhT2R7qZFqjjvE5RkKHbINSHaakKwo4gIcA+bZ68qnDqrIxm0MNgGTG+n7\nBI15lC0q6fVRLNG69m3AsCcBrqRGzaww4kVZ352PRgEHJfdG4O2SQoyYqGIqm+Zw\nLymJgC4PHh9T5IvRH1W4ig8GMD5IXHIxYZcuafZ1AhIOjhje1bM=\n=n9SQ\n-----END PGP SIGNATURE-----",
        "payload": "tree 034238dbd4a11b8282e67e771188f84b14cd60ff\nparent 9e530c6352c3e3d4f2936bbbb1bcb34ff9ca6378\nauthor fanquake <fanquake@gmail.com> 1633394501 +0800\ncommitter fanquake <fanquake@gmail.com> 1633394501 +0800\n\nsandbox: add newfstatat to allowed filesystem syscalls\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ee08741c9c6c6931c521f57d179532277dced546",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/ee08741c9c6c6931c521f57d179532277dced546",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ee08741c9c6c6931c521f57d179532277dced546/comments",
    "author": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "9e530c6352c3e3d4f2936bbbb1bcb34ff9ca6378",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9e530c6352c3e3d4f2936bbbb1bcb34ff9ca6378",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/9e530c6352c3e3d4f2936bbbb1bcb34ff9ca6378"
      }
    ],
    "stats": {
      "total": 1,
      "additions": 1,
      "deletions": 0
    },
    "files": [
      {
        "sha": "83d69dd72d60738aac0faf4c626ceeb6a2808c27",
        "filename": "src/util/syscall_sandbox.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ee08741c9c6c6931c521f57d179532277dced546/src/util/syscall_sandbox.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ee08741c9c6c6931c521f57d179532277dced546/src/util/syscall_sandbox.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util/syscall_sandbox.cpp?ref=ee08741c9c6c6931c521f57d179532277dced546",
        "patch": "@@ -545,6 +545,7 @@ class SeccompPolicyBuilder\n         allowed_syscalls.insert(__NR_fdatasync);  // synchronize a file's in-core state with storage device\n         allowed_syscalls.insert(__NR_flock);      // apply or remove an advisory lock on an open file\n         allowed_syscalls.insert(__NR_fstat);      // get file status\n+        allowed_syscalls.insert(__NR_newfstatat); // get file status\n         allowed_syscalls.insert(__NR_fsync);      // synchronize a file's in-core state with storage device\n         allowed_syscalls.insert(__NR_ftruncate);  // truncate a file to a specified length\n         allowed_syscalls.insert(__NR_getcwd);     // get current working directory"
      }
    ]
  },
  {
    "sha": "44d77d2213e6bd2e2f700dd8c3c3f932bc1bcb48",
    "node_id": "C_kwDOABII59oAKDQ0ZDc3ZDIyMTNlNmJkMmUyZjcwMGRkOGMzYzNmOTMyYmMxYmNiNDg",
    "commit": {
      "author": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-10-05T01:13:55Z"
      },
      "committer": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2021-10-05T01:13:55Z"
      },
      "message": "sandbox: add copy_file_range to allowed filesystem syscalls",
      "tree": {
        "sha": "38b565b50d400818f8890bdba441d1e6c7b8c16a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/38b565b50d400818f8890bdba441d1e6c7b8c16a"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/44d77d2213e6bd2e2f700dd8c3c3f932bc1bcb48",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz7FuIclQ9n+pXlWPLuufXMCVJsEFAmFbpvYACgkQLuufXMCV\nJsH/nxAAnKtP62P8Z0XhIsvIKT/z5DuwxDMg5YocQSTQuaAZZCIDrknVaL0wVr/T\nUykJkZ/VXul6ju8TbJ5TLHKd0mIOHmMQEdr09D2/R3Nm1sWq+dqyKs67XDO6EjbC\nZgwNuSzGCcz07ebTzyvsUFdxmJKe/yOmw0q2AsVTU0cdPQOyLqsFAotdZQOzNwlh\naU5D300raKJSA8aLQ0vTdDU15r+OnvnocD+xhEtGyjubi6AiyPcPY7PMXbaJj1Ql\nti1X1RuEHum+uXatZ9ei6Yh/zoE4wEyGNCyAZx7Wo933Sb5lY6MchHkAHyq9vM7b\nFSensFyAqz/KBXqInV2a+v5Pw/7IWDVSs89Glz0WOM0+T+ZdspVtdUPd4oVmDOsK\nxALNzJkyWA/pCWqultRqJ7yXukBb8Dx0/FFT2dBntkS9T57oXVpB4KgA4AVVBDpm\nEL+z7lyaY0StQEgtUqbsCA20YhFOyWlKwlSLEJEKf3KnTyJRGiYC1YXumIZ4nx05\ntsNDvwJDDYRundyZRPHpnkRxisCU+nunXmjzTqh5kPoiSZXjPKtAi76TaI9L4+OJ\n3rmPRRKA9/rrQvm37lBbWQMWHGEX/Z8gp5KFdh3LRCu0hC0Ea8HqE+dDRzVu5iLe\nWPwlK1RIZzNWt6ArJE5m3z24HQozp528y0Ry0ZmpzPPQrOMzO74=\n=vcm5\n-----END PGP SIGNATURE-----",
        "payload": "tree 38b565b50d400818f8890bdba441d1e6c7b8c16a\nparent ee08741c9c6c6931c521f57d179532277dced546\nauthor fanquake <fanquake@gmail.com> 1633396435 +0800\ncommitter fanquake <fanquake@gmail.com> 1633396435 +0800\n\nsandbox: add copy_file_range to allowed filesystem syscalls\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/44d77d2213e6bd2e2f700dd8c3c3f932bc1bcb48",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/44d77d2213e6bd2e2f700dd8c3c3f932bc1bcb48",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/44d77d2213e6bd2e2f700dd8c3c3f932bc1bcb48/comments",
    "author": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "ee08741c9c6c6931c521f57d179532277dced546",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ee08741c9c6c6931c521f57d179532277dced546",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/ee08741c9c6c6931c521f57d179532277dced546"
      }
    ],
    "stats": {
      "total": 53,
      "additions": 27,
      "deletions": 26
    },
    "files": [
      {
        "sha": "2b479a072e0cb46dfbc44b8179b61b56dcaf513b",
        "filename": "src/util/syscall_sandbox.cpp",
        "status": "modified",
        "additions": 27,
        "deletions": 26,
        "changes": 53,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/44d77d2213e6bd2e2f700dd8c3c3f932bc1bcb48/src/util/syscall_sandbox.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/44d77d2213e6bd2e2f700dd8c3c3f932bc1bcb48/src/util/syscall_sandbox.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util/syscall_sandbox.cpp?ref=44d77d2213e6bd2e2f700dd8c3c3f932bc1bcb48",
        "patch": "@@ -536,32 +536,33 @@ class SeccompPolicyBuilder\n \n     void AllowFileSystem()\n     {\n-        allowed_syscalls.insert(__NR_access);     // check user's permissions for a file\n-        allowed_syscalls.insert(__NR_chdir);      // change working directory\n-        allowed_syscalls.insert(__NR_chmod);      // change permissions of a file\n-        allowed_syscalls.insert(__NR_fallocate);  // manipulate file space\n-        allowed_syscalls.insert(__NR_fchmod);     // change permissions of a file\n-        allowed_syscalls.insert(__NR_fchown);     // change ownership of a file\n-        allowed_syscalls.insert(__NR_fdatasync);  // synchronize a file's in-core state with storage device\n-        allowed_syscalls.insert(__NR_flock);      // apply or remove an advisory lock on an open file\n-        allowed_syscalls.insert(__NR_fstat);      // get file status\n-        allowed_syscalls.insert(__NR_newfstatat); // get file status\n-        allowed_syscalls.insert(__NR_fsync);      // synchronize a file's in-core state with storage device\n-        allowed_syscalls.insert(__NR_ftruncate);  // truncate a file to a specified length\n-        allowed_syscalls.insert(__NR_getcwd);     // get current working directory\n-        allowed_syscalls.insert(__NR_getdents);   // get directory entries\n-        allowed_syscalls.insert(__NR_getdents64); // get directory entries\n-        allowed_syscalls.insert(__NR_lstat);      // get file status\n-        allowed_syscalls.insert(__NR_mkdir);      // create a directory\n-        allowed_syscalls.insert(__NR_open);       // open and possibly create a file\n-        allowed_syscalls.insert(__NR_openat);     // open and possibly create a file\n-        allowed_syscalls.insert(__NR_readlink);   // read value of a symbolic link\n-        allowed_syscalls.insert(__NR_rename);     // change the name or location of a file\n-        allowed_syscalls.insert(__NR_rmdir);      // delete a directory\n-        allowed_syscalls.insert(__NR_stat);       // get file status\n-        allowed_syscalls.insert(__NR_statfs);     // get filesystem statistics\n-        allowed_syscalls.insert(__NR_statx);      // get file status (extended)\n-        allowed_syscalls.insert(__NR_unlink);     // delete a name and possibly the file it refers to\n+        allowed_syscalls.insert(__NR_access);          // check user's permissions for a file\n+        allowed_syscalls.insert(__NR_chdir);           // change working directory\n+        allowed_syscalls.insert(__NR_chmod);           // change permissions of a file\n+        allowed_syscalls.insert(__NR_copy_file_range); // copy a range of data from one file to another\n+        allowed_syscalls.insert(__NR_fallocate);       // manipulate file space\n+        allowed_syscalls.insert(__NR_fchmod);          // change permissions of a file\n+        allowed_syscalls.insert(__NR_fchown);          // change ownership of a file\n+        allowed_syscalls.insert(__NR_fdatasync);       // synchronize a file's in-core state with storage device\n+        allowed_syscalls.insert(__NR_flock);           // apply or remove an advisory lock on an open file\n+        allowed_syscalls.insert(__NR_fstat);           // get file status\n+        allowed_syscalls.insert(__NR_newfstatat);      // get file status\n+        allowed_syscalls.insert(__NR_fsync);           // synchronize a file's in-core state with storage device\n+        allowed_syscalls.insert(__NR_ftruncate);       // truncate a file to a specified length\n+        allowed_syscalls.insert(__NR_getcwd);          // get current working directory\n+        allowed_syscalls.insert(__NR_getdents);        // get directory entries\n+        allowed_syscalls.insert(__NR_getdents64);      // get directory entries\n+        allowed_syscalls.insert(__NR_lstat);           // get file status\n+        allowed_syscalls.insert(__NR_mkdir);           // create a directory\n+        allowed_syscalls.insert(__NR_open);            // open and possibly create a file\n+        allowed_syscalls.insert(__NR_openat);          // open and possibly create a file\n+        allowed_syscalls.insert(__NR_readlink);        // read value of a symbolic link\n+        allowed_syscalls.insert(__NR_rename);          // change the name or location of a file\n+        allowed_syscalls.insert(__NR_rmdir);           // delete a directory\n+        allowed_syscalls.insert(__NR_stat);            // get file status\n+        allowed_syscalls.insert(__NR_statfs);          // get filesystem statistics\n+        allowed_syscalls.insert(__NR_statx);           // get file status (extended)\n+        allowed_syscalls.insert(__NR_unlink);          // delete a name and possibly the file it refers to\n     }\n \n     void AllowFutex()"
      }
    ]
  }
]