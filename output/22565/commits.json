[
  {
    "sha": "1c612b274b1587c43ee6e6a486aed653b9ca5f70",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxYzYxMmIyNzRiMTU4N2M0M2VlNmU2YTQ4NmFlZDY1M2I5Y2E1Zjcw",
    "commit": {
      "author": {
        "name": "NikhilBartwal",
        "email": "nikhilbartwal1234@gmail.com",
        "date": "2021-07-29T09:59:27Z"
      },
      "committer": {
        "name": "NikhilBartwal",
        "email": "nikhilbartwal1234@gmail.com",
        "date": "2021-08-04T21:27:58Z"
      },
      "message": "[script] Update signet getcoins.py for custom network\n\nCurrently, using the getcoins.py with a custom signet executes successfully and shows the transaction as complete, however for obvious reasons, it  should not.\nThis PR adds a sanity check for custom signet by comparing the current network's first block hash with global signet's respective hash.",
      "tree": {
        "sha": "e9ee7f630ba841b93a6ced740e6e3d0b8a51c6f1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e9ee7f630ba841b93a6ced740e6e3d0b8a51c6f1"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1c612b274b1587c43ee6e6a486aed653b9ca5f70",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1c612b274b1587c43ee6e6a486aed653b9ca5f70",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/1c612b274b1587c43ee6e6a486aed653b9ca5f70",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1c612b274b1587c43ee6e6a486aed653b9ca5f70/comments",
    "author": {
      "login": "NikhilBartwal",
      "id": 42388668,
      "node_id": "MDQ6VXNlcjQyMzg4NjY4",
      "avatar_url": "https://avatars.githubusercontent.com/u/42388668?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NikhilBartwal",
      "html_url": "https://github.com/NikhilBartwal",
      "followers_url": "https://api.github.com/users/NikhilBartwal/followers",
      "following_url": "https://api.github.com/users/NikhilBartwal/following{/other_user}",
      "gists_url": "https://api.github.com/users/NikhilBartwal/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NikhilBartwal/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NikhilBartwal/subscriptions",
      "organizations_url": "https://api.github.com/users/NikhilBartwal/orgs",
      "repos_url": "https://api.github.com/users/NikhilBartwal/repos",
      "events_url": "https://api.github.com/users/NikhilBartwal/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NikhilBartwal/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "NikhilBartwal",
      "id": 42388668,
      "node_id": "MDQ6VXNlcjQyMzg4NjY4",
      "avatar_url": "https://avatars.githubusercontent.com/u/42388668?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NikhilBartwal",
      "html_url": "https://github.com/NikhilBartwal",
      "followers_url": "https://api.github.com/users/NikhilBartwal/followers",
      "following_url": "https://api.github.com/users/NikhilBartwal/following{/other_user}",
      "gists_url": "https://api.github.com/users/NikhilBartwal/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NikhilBartwal/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NikhilBartwal/subscriptions",
      "organizations_url": "https://api.github.com/users/NikhilBartwal/orgs",
      "repos_url": "https://api.github.com/users/NikhilBartwal/repos",
      "events_url": "https://api.github.com/users/NikhilBartwal/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NikhilBartwal/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "3308c61091b6b7cb22569f3abadea6d001295c90",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3308c61091b6b7cb22569f3abadea6d001295c90",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/3308c61091b6b7cb22569f3abadea6d001295c90"
      }
    ],
    "stats": {
      "total": 23,
      "additions": 19,
      "deletions": 4
    },
    "files": [
      {
        "sha": "0a8e762ff08874c1cb5d3badea507874506f9785",
        "filename": "contrib/signet/getcoins.py",
        "status": "modified",
        "additions": 19,
        "deletions": 4,
        "changes": 23,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1c612b274b1587c43ee6e6a486aed653b9ca5f70/contrib/signet/getcoins.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1c612b274b1587c43ee6e6a486aed653b9ca5f70/contrib/signet/getcoins.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/signet/getcoins.py?ref=1c612b274b1587c43ee6e6a486aed653b9ca5f70",
        "patch": "@@ -5,21 +5,36 @@\n \n import argparse\n import subprocess\n-import requests\n import sys\n+import requests\n+\n+DEFAULT_GLOBAL_FAUCET = 'https://signetfaucet.com/claim'\n+GLOBAL_FIRST_BLOCK_HASH = '00000086d6b2636cb2a392d45edc4ec544a10024d30141c9adf4bfd9de533b53'\n \n parser = argparse.ArgumentParser(description='Script to get coins from a faucet.', epilog='You may need to start with double-dash (--) when providing bitcoin-cli arguments.')\n parser.add_argument('-c', '--cmd', dest='cmd', default='bitcoin-cli', help='bitcoin-cli command to use')\n-parser.add_argument('-f', '--faucet', dest='faucet', default='https://signetfaucet.com/claim', help='URL of the faucet')\n+parser.add_argument('-f', '--faucet', dest='faucet', default=DEFAULT_GLOBAL_FAUCET, help='URL of the faucet')\n parser.add_argument('-a', '--addr', dest='addr', default='', help='Bitcoin address to which the faucet should send')\n parser.add_argument('-p', '--password', dest='password', default='', help='Faucet password, if any')\n parser.add_argument('bitcoin_cli_args', nargs='*', help='Arguments to pass on to bitcoin-cli (default: -signet)')\n \n args = parser.parse_args()\n \n+if args.bitcoin_cli_args == []:\n+    args.bitcoin_cli_args = ['-signet']\n+\n+if args.faucet.lower() == DEFAULT_GLOBAL_FAUCET:\n+    # Get the hash of the block at height 1 of the currently active signet chain\n+    try:\n+        curr_signet_hash = subprocess.check_output([args.cmd] + args.bitcoin_cli_args + ['getblockhash', '1']).strip().decode()\n+    except FileNotFoundError:\n+        print('The binary', args.cmd, 'could not be found.')\n+        exit()\n+    if curr_signet_hash != GLOBAL_FIRST_BLOCK_HASH:\n+        print('The global faucet cannot be used with a custom Signet network. Please use the global signet or setup your custom faucet to use this functionality.\\n')\n+        exit()\n+\n if args.addr == '':\n-    if args.bitcoin_cli_args == []:\n-        args.bitcoin_cli_args = ['-signet']\n     # get address for receiving coins\n     try:\n         args.addr = subprocess.check_output([args.cmd] + args.bitcoin_cli_args + ['getnewaddress', 'faucet', 'bech32']).strip()"
      }
    ]
  },
  {
    "sha": "b0c8246cac97b7792a50afc22ef1fe39c5028e00",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiMGM4MjQ2Y2FjOTdiNzc5MmE1MGFmYzIyZWYxZmUzOWM1MDI4ZTAw",
    "commit": {
      "author": {
        "name": "NikhilBartwal",
        "email": "nikhilbartwal1234@gmail.com",
        "date": "2021-07-29T10:01:55Z"
      },
      "committer": {
        "name": "NikhilBartwal",
        "email": "nikhilbartwal1234@gmail.com",
        "date": "2021-08-04T21:28:07Z"
      },
      "message": "Add cleaner errors for unsuccessful faucet transactions",
      "tree": {
        "sha": "c868eec99180941803bd3688758d124680cdde39",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c868eec99180941803bd3688758d124680cdde39"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b0c8246cac97b7792a50afc22ef1fe39c5028e00",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b0c8246cac97b7792a50afc22ef1fe39c5028e00",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/b0c8246cac97b7792a50afc22ef1fe39c5028e00",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b0c8246cac97b7792a50afc22ef1fe39c5028e00/comments",
    "author": {
      "login": "NikhilBartwal",
      "id": 42388668,
      "node_id": "MDQ6VXNlcjQyMzg4NjY4",
      "avatar_url": "https://avatars.githubusercontent.com/u/42388668?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NikhilBartwal",
      "html_url": "https://github.com/NikhilBartwal",
      "followers_url": "https://api.github.com/users/NikhilBartwal/followers",
      "following_url": "https://api.github.com/users/NikhilBartwal/following{/other_user}",
      "gists_url": "https://api.github.com/users/NikhilBartwal/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NikhilBartwal/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NikhilBartwal/subscriptions",
      "organizations_url": "https://api.github.com/users/NikhilBartwal/orgs",
      "repos_url": "https://api.github.com/users/NikhilBartwal/repos",
      "events_url": "https://api.github.com/users/NikhilBartwal/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NikhilBartwal/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "NikhilBartwal",
      "id": 42388668,
      "node_id": "MDQ6VXNlcjQyMzg4NjY4",
      "avatar_url": "https://avatars.githubusercontent.com/u/42388668?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NikhilBartwal",
      "html_url": "https://github.com/NikhilBartwal",
      "followers_url": "https://api.github.com/users/NikhilBartwal/followers",
      "following_url": "https://api.github.com/users/NikhilBartwal/following{/other_user}",
      "gists_url": "https://api.github.com/users/NikhilBartwal/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NikhilBartwal/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NikhilBartwal/subscriptions",
      "organizations_url": "https://api.github.com/users/NikhilBartwal/orgs",
      "repos_url": "https://api.github.com/users/NikhilBartwal/repos",
      "events_url": "https://api.github.com/users/NikhilBartwal/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NikhilBartwal/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "1c612b274b1587c43ee6e6a486aed653b9ca5f70",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1c612b274b1587c43ee6e6a486aed653b9ca5f70",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/1c612b274b1587c43ee6e6a486aed653b9ca5f70"
      }
    ],
    "stats": {
      "total": 13,
      "additions": 12,
      "deletions": 1
    },
    "files": [
      {
        "sha": "c50c2cc16a34662e57c60f36df74fb7c56adbcd1",
        "filename": "contrib/signet/getcoins.py",
        "status": "modified",
        "additions": 12,
        "deletions": 1,
        "changes": 13,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b0c8246cac97b7792a50afc22ef1fe39c5028e00/contrib/signet/getcoins.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b0c8246cac97b7792a50afc22ef1fe39c5028e00/contrib/signet/getcoins.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/signet/getcoins.py?ref=b0c8246cac97b7792a50afc22ef1fe39c5028e00",
        "patch": "@@ -48,4 +48,15 @@\n except:\n     print('Unexpected error when contacting faucet:', sys.exc_info()[0])\n     exit()\n-print(res.text)\n+\n+# Display the output as per the returned status code\n+if res:\n+    # When the return code is in between 200 and 400 i.e. successful\n+    print(res.text)\n+elif res.status_code == 404:\n+    print('The specified faucet URL does not exist. Please check for any server issues/typo.')\n+elif res.status_code == 429:\n+    print('The script does not allow for repeated transactions as the global faucet is rate-limitied to 1 request/IP/day. You can access the faucet website to get more coins manually')\n+else:\n+    print(f'Returned Error Code {res.status_code}\\n{res.text}\\n')\n+    print('Please check the provided arguments for their validity and/or any possible typo.')"
      }
    ]
  }
]