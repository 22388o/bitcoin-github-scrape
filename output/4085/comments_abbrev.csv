laanwj,2014-04-23T07:23:09Z,"Having fixed this I get a different exception (not related to locking) on shutdown now sometimes when I try to reproduce #4083,\n\n```\nbitcoin-qt: main.cpp:1737: bool ConnectBlock(CBlock&, CValidationState&, CBlockIndex*, CCoinsViewCache&, bool): Assertion `hashPrevBlock == view.GetBestBlock()' failed.\n```\n\nTraceback:\n\n```\n#4  0x00005555556c5afa in ConnectBlock (block=..., state=..., \n    ",https://github.com/bitcoin/bitcoin/pull/4085#issuecomment-41131868,41131868,
BitcoinPullTester,2014-04-23T07:37:20Z,"Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/b39a07dc42ab6ba746a25206969fb81913146f1f for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/cu",https://github.com/bitcoin/bitcoin/pull/4085#issuecomment-41132761,41132761,
rdponticelli,2014-04-23T10:39:46Z,That looks like the same issue I had when I ran master with 55a1db4fa2cf62b9766ef382c1e14b3ecbdf67fe reverted.\n,https://github.com/bitcoin/bitcoin/pull/4085#issuecomment-41146840,41146840,
laanwj,2014-04-23T11:30:33Z,"I think I know what happens:\n- CheckDiskSpace calls StartShutdown and returns false. \n  - This error propagates up the call chain, causing ProcessBlock to fail, leaving the view in an inconsistent state.\n- After ProcessBlock fails, the message loop continues as normal (see https://github.com/bitcoin/bitcoin/blob/master/src/main.cpp#L3812 ).\n\nSomehow it manages to process another message befor",https://github.com/bitcoin/bitcoin/pull/4085#issuecomment-41150338,41150338,
gavinandresen,2014-04-23T14:55:08Z,ACK\n,https://github.com/bitcoin/bitcoin/pull/4085#issuecomment-41170762,41170762,
