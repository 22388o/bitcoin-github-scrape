laanwj,2021-06-02 16:55:18,"Thanks for adding tests for this functionality. This goes as far as can be reasonably expected without emulating a DNS server in the tests :sweat_smile: \n\nCode review ACK 75ee018f9b8371cfb16bd3ad8f9491d386d9c238",https://github.com/bitcoin/bitcoin/pull/22098#issuecomment-853212065,853212065,
amitiuttarwar,2021-07-28 21:59:26,"thank you for the reviews @lsilva01, @willcl-ark, @laanwj, @mzumsande & @jnewbery! \n\nI've incorporated all the review comments ([diff](https://github.com/bitcoin/bitcoin/compare/75ee018f9b8371cfb16bd3ad8f9491d386d9c238..6108630a9e6a250922ab8189172476927223b4e8)).\n\nI also changed the regtest dns seed to be `dummySeed.invalid` ([diff](https://github.com/bitcoin/bitcoin/compare/6108630a9e6a25",https://github.com/bitcoin/bitcoin/pull/22098#issuecomment-888648789,888648789,
jnewbery,2021-07-29 14:17:57,Code review ACK a8834fa,https://github.com/bitcoin/bitcoin/pull/22098#issuecomment-889184642,889184642,
mzumsande,2021-07-29 18:40:35,Code Review ACK a8834fa0513d6bfcd4dfc759bbb841c02fcf8517,https://github.com/bitcoin/bitcoin/pull/22098#issuecomment-889372998,889372998,
mzumsande,2021-07-30 11:55:23,This probably needs a rebase / exception added for the new test after #22490 was merged. ,https://github.com/bitcoin/bitcoin/pull/22098#issuecomment-889842332,889842332,
amitiuttarwar,2021-07-30 18:36:38,"thanks for the reviews @kristapsk & @practicalswift! & for the re-reviews @jnewbery & @mzumsande ☺️\n\n@practicalswift \nI took all your suggestions to further reduce changes of external communication except for being able to apply the IP addresses reserved for testing. Thanks again for these! I learned about how FQDNs work. \n\n@mzumsande \nas I mentioned over here https://github.com/bitcoi",https://github.com/bitcoin/bitcoin/pull/22098#issuecomment-890080099,890080099,
practicalswift,2021-07-30 22:56:45,"> I took all your suggestions to further reduce changes of external communication except for being able to apply the IP addresses reserved for testing. Thanks again for these! I learned about how FQDNs work.\n\nExcellent!\n\nIt is outside of the scope of this PR but I think it would make sense to err on the safe side and specify all seed domain names with an ending dot to make them unambiguous",https://github.com/bitcoin/bitcoin/pull/22098#issuecomment-890227550,890227550,
amitiuttarwar,2021-07-31 23:26:16,"all review comments have been addressed. \n\n> specify all seed domain names with an ending dot to make them unambiguous.. \n\n@practicalswift, very interesting! thanks for digging in & sharing your findings! I'll have to learn more myself but this seems like a good idea. Shall we open an issue?",https://github.com/bitcoin/bitcoin/pull/22098#issuecomment-890416247,890416247,
mzumsande,2021-08-01 19:47:28,"ACK 82b6f89819e55af26f5264678e0f93052934bcb3\n\n>I locally rebased & confirmed that the tests still pass, but opted not to push the rebase here to make it easier to re-review.  But lmk if you think it would be better to rebase & set self.disable_autoconnect and I'm happy to do so.\n\nnot necessary, I didn't realize that it would work, but your explanation makes sense.\n",https://github.com/bitcoin/bitcoin/pull/22098#issuecomment-890575846,890575846,
practicalswift,2021-08-01 20:36:07,"> > The former is guaranteed to be interpreted as `seed.bitcoin.sipa.be.` whereas the latter may be interpreted as say`seed.bitcoin.sipa.be.megacorp.com.` depending on the content of the user's `/etc/resolv.conf`.\n>\n> @practicalswift, very interesting! thanks for digging in & sharing your findings! I'll have to learn more myself but this seems like a good idea. Shall we open an issue?\n\nFee",https://github.com/bitcoin/bitcoin/pull/22098#issuecomment-890582857,890582857,
practicalswift,2021-08-02 06:38:55,"> > > The former is guaranteed to be interpreted as `seed.bitcoin.sipa.be.` whereas the latter may be interpreted as say`seed.bitcoin.sipa.be.megacorp.com.` depending on the content of the user's `/etc/resolv.conf`.\n> > \n> > \n> > @practicalswift, very interesting! thanks for digging in & sharing your findings! I'll have to learn more myself but this seems like a good idea. Shall we open an i",https://github.com/bitcoin/bitcoin/pull/22098#issuecomment-890763573,890763573,
jnewbery,2021-08-02 09:46:19,reACK 82b6f89819e55af26f5264678e0f93052934bcb3,https://github.com/bitcoin/bitcoin/pull/22098#issuecomment-890886245,890886245,
fanquake,2021-08-03 03:20:58,"The DNS querying logic and related config options certainly are somewhat convoluted / confusing. This is not helped by the fact that certain options (soft)-set other options, or sometimes behave un-intuitively. I think there is definitely scope to improve this code further going forward.",https://github.com/bitcoin/bitcoin/pull/22098#issuecomment-891488023,891488023,
fanquake,2021-08-03 03:25:43,cc @ajtowns ,https://github.com/bitcoin/bitcoin/pull/22098#issuecomment-891489783,891489783,
mzumsande,2021-05-30 20:58:44,"Not that it matters much, but at this point, the address is already in addrman, so this returns success=false.",https://github.com/bitcoin/bitcoin/pull/22098#discussion_r642127752,642127752,test/functional/p2p_dns_seeds.py
mzumsande,2021-05-30 21:18:12,"Not sure why this use of `-connect` is even allowed considering that `-connect`  without an argument leads to the node trying to connect to nothingness, but maybe add some dummy argument so that it is not confused with a boolean option.",https://github.com/bitcoin/bitcoin/pull/22098#discussion_r642129821,642129821,test/functional/p2p_dns_seeds.py
mzumsande,2021-06-02 17:45:50,The test runs quite long (much waiting). I don't think it's possible to prevent this (mocking time doesn't seem possible) but running `init_arg_tests` before `existing_outbound_connections_test` would save one 11 second wait because addrman would still be empty.,https://github.com/bitcoin/bitcoin/pull/22098#discussion_r644190076,644190076,test/functional/p2p_dns_seeds.py
amitiuttarwar,2021-06-02 21:23:45,"ah, totally. this line is unnecessary when running the tests together, but I added it so the `existing_block_relay_connections_test` setup would not be dependent on `existing_outbound_connections_test`. would it better if I change the IP address to be something new? ",https://github.com/bitcoin/bitcoin/pull/22098#discussion_r644330212,644330212,test/functional/p2p_dns_seeds.py
mzumsande,2021-06-02 22:11:19,"oh, I see. No, I don't think that is necessary.",https://github.com/bitcoin/bitcoin/pull/22098#discussion_r644353410,644353410,test/functional/p2p_dns_seeds.py
jnewbery,2021-06-03 15:57:03,"You don't need to specify the default value for this arg:\n\n```suggestion\n        self.restart_node(0)\n```\n\nwill just restart with the default extra args.",https://github.com/bitcoin/bitcoin/pull/22098#discussion_r644919783,644919783,test/functional/p2p_dns_seeds.py
jnewbery,2021-06-03 15:57:17,"As above:\n\n```suggestion\n        self.restart_node(0)\n```",https://github.com/bitcoin/bitcoin/pull/22098#discussion_r644919955,644919955,test/functional/p2p_dns_seeds.py
jnewbery,2021-06-03 15:58:10,"Consider:\n\n```suggestion\n        for i in itertools.count():\n```\n\nTo avoid the magic `1500` constant. You'll need to import `itertools`.",https://github.com/bitcoin/bitcoin/pull/22098#discussion_r644920673,644920673,test/functional/p2p_dns_seeds.py
jnewbery,2021-06-03 16:03:17,"If you're touching these anyway...\n\n```suggestion\nstatic constexpr bool DEFAULT_FORCEDNSSEED{false};\nstatic constexpr bool DEFAULT_DNSSEED{true};\nstatic constexpr bool DEFAULT_FIXEDSEEDS{true};\n```",https://github.com/bitcoin/bitcoin/pull/22098#discussion_r644924852,644924852,src/net.h
amitiuttarwar,2021-07-28 21:49:06,"didn't change it, but added a comment to clarify.",https://github.com/bitcoin/bitcoin/pull/22098#discussion_r678675913,678675913,test/functional/p2p_dns_seeds.py
amitiuttarwar,2021-07-28 21:49:18,good call! changed the ordering,https://github.com/bitcoin/bitcoin/pull/22098#discussion_r678676010,678676010,test/functional/p2p_dns_seeds.py
amitiuttarwar,2021-07-28 21:51:27,"ah I see! I thought the args forwarded between restarts, but I see now its just the initial setup args that get retained. updated these calls.",https://github.com/bitcoin/bitcoin/pull/22098#discussion_r678677146,678677146,test/functional/p2p_dns_seeds.py
amitiuttarwar,2021-07-28 21:51:51,done,https://github.com/bitcoin/bitcoin/pull/22098#discussion_r678677356,678677356,test/functional/p2p_dns_seeds.py
amitiuttarwar,2021-07-28 21:53:06,"nice! in addition to avoiding the magic number, it means the test has the flexibility to end earlier if we meet the required number of addresses in addrman. ",https://github.com/bitcoin/bitcoin/pull/22098#discussion_r678677990,678677990,test/functional/p2p_dns_seeds.py
amitiuttarwar,2021-07-28 21:53:16,done,https://github.com/bitcoin/bitcoin/pull/22098#discussion_r678678072,678678072,src/net.h
practicalswift,2021-07-29 18:37:06,Could use a FQDN such as `fakenodeaddr.fakedomain.invalid.` (note the ending dot) be used here to make it unambiguous and thus make sure we don't risk causing a DNS lookup for `fakenodeaddr.<local domain name as specified in /etc/resolv.conf>`?,https://github.com/bitcoin/bitcoin/pull/22098#discussion_r679396237,679396237,test/functional/p2p_dns_seeds.py
practicalswift,2021-07-29 18:37:19,Same here? :),https://github.com/bitcoin/bitcoin/pull/22098#discussion_r679396392,679396392,test/functional/p2p_dns_seeds.py
practicalswift,2021-07-29 18:45:26,"I think the recommendation is to use addresses in the block `192.0.2.0/24` (`TEST-NET-1`) for testing purposes (RFC 5735).\n\nI think the block `192.0.0.0/24` is reserved for future IETF protocol assignments.",https://github.com/bitcoin/bitcoin/pull/22098#discussion_r679401698,679401698,test/functional/p2p_dns_seeds.py
practicalswift,2021-07-29 18:45:48,Same here :),https://github.com/bitcoin/bitcoin/pull/22098#discussion_r679401965,679401965,test/functional/p2p_dns_seeds.py
practicalswift,2021-07-29 18:55:48,Non-blocking style nit: I think `with …:` is favoured over`with(…):` in the rest of the code base.,https://github.com/bitcoin/bitcoin/pull/22098#discussion_r679409023,679409023,test/functional/p2p_dns_seeds.py
practicalswift,2021-07-29 19:08:15,Could use a FQDN such as say `dummy-seed.invalid.` (note the ending dot) be used here to make it unambiguous and thus make sure we don't risk causing a DNS lookup for `dummySeed.invalid.<local domain name as specified in /etc/resolv.conf>`)?,https://github.com/bitcoin/bitcoin/pull/22098#discussion_r679416678,679416678,src/chainparams.cpp
amitiuttarwar,2021-07-30 18:07:01,"hmmm, I tried this out but unfortunately since the `CNetAddr` code specifically recognizes these as invalid addresses ([link](https://github.com/bitcoin/bitcoin/blob/da1c0c64fd094880712d1c4167ad9eb3bb6ffcc6/src/netaddress.cpp#L345-L347)), it prevents being able to test the functionality.",https://github.com/bitcoin/bitcoin/pull/22098#discussion_r680131932,680131932,test/functional/p2p_dns_seeds.py
amitiuttarwar,2021-07-30 18:24:05,"ah cool, thanks for the suggestion! I updated all 3 uses of `-connect=` to use this FQDN. ",https://github.com/bitcoin/bitcoin/pull/22098#discussion_r680141065,680141065,test/functional/p2p_dns_seeds.py
amitiuttarwar,2021-07-30 18:24:10,done,https://github.com/bitcoin/bitcoin/pull/22098#discussion_r680141115,680141115,test/functional/p2p_dns_seeds.py
amitiuttarwar,2021-07-30 18:25:00,responded https://github.com/bitcoin/bitcoin/pull/22098#discussion_r680131932. let's continue the convo there ,https://github.com/bitcoin/bitcoin/pull/22098#discussion_r680141538,680141538,test/functional/p2p_dns_seeds.py
amitiuttarwar,2021-07-30 18:28:17,updated all `with(...):` to be `with ...:`,https://github.com/bitcoin/bitcoin/pull/22098#discussion_r680143123,680143123,test/functional/p2p_dns_seeds.py
amitiuttarwar,2021-07-30 18:28:44,"good call, updated to `dummySeed.invalid.`",https://github.com/bitcoin/bitcoin/pull/22098#discussion_r680143308,680143308,src/chainparams.cpp
practicalswift,2021-07-30 21:44:43,"Got it! Then `192.0.0.8` (the IPv4 dummy address per [RFC 7600](https://www.rfc-editor.org/rfc/rfc7600.html)) is probably a good alternative to `192.0.2.0/24`.\n\nI checked the [IANA IPv4 Special-Purpose Address Registry](https://www.iana.org/assignments/iana-ipv4-special-registry/iana-ipv4-special-registry.xhtml) and `192.0.0.8` (like `192.0.2.0/24`) is guaranteed to not be in use as valid dest",https://github.com/bitcoin/bitcoin/pull/22098#discussion_r680236317,680236317,test/functional/p2p_dns_seeds.py
amitiuttarwar,2021-07-31 23:21:13,"awesome, thanks! ",https://github.com/bitcoin/bitcoin/pull/22098#discussion_r680421735,680421735,test/functional/p2p_dns_seeds.py
amitiuttarwar,2021-08-03 02:00:43,"oops, forgot to comment / resolve, but this has been fixed for all the `-connect` calls ",https://github.com/bitcoin/bitcoin/pull/22098#discussion_r681379078,681379078,test/functional/p2p_dns_seeds.py
