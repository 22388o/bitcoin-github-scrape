jnewbery,2018-01-16T16:55:30Z,Vaguely concept NACK-ish. I could imagine we'd want to test bitcoind's ability to accept incoming connections on multiple interfaces (in fact it's something I've considered adding to the test suite in the past). I don't think we should limit what we can test to work around an annoying issue on a single OS.,https://github.com/bitcoin/bitcoin/pull/12200#issuecomment-358028700,358028700,
Sjors,2018-01-16T19:38:12Z,"@jnewbery couldn't those specific tests just launch with a different `-bind` argument? Then we can worry about that issue later when those tests are ready. Those tests would likely break on OSX if the developer doesn't click on Allow quickly enough, so they would be brittle.\n\nThe good news is that the entire 127.0.0.1/8 range [can be used](https://en.wikipedia.org/wiki/Localhost) for these tes",https://github.com/bitcoin/bitcoin/pull/12200#issuecomment-358079678,358079678,
MarcoFalke,2018-01-16T20:45:41Z,"Specifying multiple `-bind` will not overwrite the previous ones, but rather accumulate and consider all of them.",https://github.com/bitcoin/bitcoin/pull/12200#issuecomment-358099248,358099248,
jnewbery,2018-01-16T21:43:41Z,"> Then we can worry about that issue later when those tests are ready.\n\nyes, true - which is why I'm only vaguely concept NACKish. I just would rather not be at a point in the future where we can't remove this option for some reason (eg because it causes tests to fail on OS X), and it makes adding tests with multiple interfaces more difficult.",https://github.com/bitcoin/bitcoin/pull/12200#issuecomment-358117112,358117112,
Sjors,2018-01-17T09:19:07Z,"Given that multiple `-bind` allows us to add interfaces and given that you can bind to 127.0.0.* without upsetting the OSX firewall, would what alleviate your objection?",https://github.com/bitcoin/bitcoin/pull/12200#issuecomment-358244252,358244252,
Sjors,2018-01-17T17:28:37Z,"Note sure why Travis is upset. The summary says that machine 2 failed after 6 hours and machine 8 never run, but both logs show `Done. Your build exited with 0.`",https://github.com/bitcoin/bitcoin/pull/12200#issuecomment-358379606,358379606,
jnewbery,2018-01-17T18:37:53Z,"> would that alleviate your objection?\n\nYes. My other concern is that all functional tests will now be running with the same `-bind` option (and so we're no longer testing nodes running without the `-bind` option).",https://github.com/bitcoin/bitcoin/pull/12200#issuecomment-358400470,358400470,
Sjors,2018-01-18T09:21:37Z,"@laanwj [suggested on IRC](https://botbot.me/freenode/bitcoin-core-dev/2018-01-16/?msg=95811302&page=3) that linux allows you to simulate network interfaces. That might be a more elegant* way to test what happens without `-bind` (that and using a different bitcoin.conf for those tests).\n\n`*` = in the sense that in some imaginary ideal world tests shouldn't rely on real world things like actual",https://github.com/bitcoin/bitcoin/pull/12200#issuecomment-358586366,358586366,
laanwj,2018-01-19T09:18:02Z,"Concept ACK.\n\n> Vaguely concept NACK-ish. I could imagine we'd want to test bitcoind's ability to accept incoming connections on multiple interfaces (in fact it's something I've considered adding to the test suite in the past). \n\nEven though only one platform complains, I think the warning is fair. From a security point of view it's better to not listen on any public interfaces during test",https://github.com/bitcoin/bitcoin/pull/12200#issuecomment-358909546,358909546,
Sjors,2018-01-19T10:28:44Z,Related question: is it possible to hide network interfaces from a process? That way we could launch `bitcoind` without `-bind=127.0.0.1` but achieve the same effect.,https://github.com/bitcoin/bitcoin/pull/12200#issuecomment-358926970,358926970,
laanwj,2018-01-19T10:32:51Z,"That's the simplest application of net namespaces:\n```bash\nip netns add isolate\nip netns exec isolate ip addr add 127.0.0.1/8 dev lo\nip netns exec isolate ip link set lo up\nip netns exec isolate <testsuite>\nip netns delete isolate\n```\nThat doesn't help on OSX though.\n\nEdit: which reminds me, as `127.0.0.1/8` is a `/8`, we could do multi-interface testing with just the loopback ",https://github.com/bitcoin/bitcoin/pull/12200#issuecomment-358927956,358927956,
randolf,2018-01-30T23:56:43Z,Has IPv6 loopback of ::1 been considered in this?,https://github.com/bitcoin/bitcoin/pull/12200#issuecomment-361775831,361775831,
laanwj,2018-01-31T09:08:18Z,"> Has IPv6 loopback of ::1 been considered in this?\n\nI'd be curious to hear how you think that would help here - though I think the chance of IPv4 loopback being present on test systems is slightly higher. I remember Travis had issues with their VMs not supporting IPv6 (not even locally!) a few years ago.\n",https://github.com/bitcoin/bitcoin/pull/12200#issuecomment-361868624,361868624,
laanwj,2018-02-13T09:54:33Z,utACK 95e2e9af124595aae4801fc9813ee1c294d404cd,https://github.com/bitcoin/bitcoin/pull/12200#issuecomment-365211752,365211752,
jnewbery,2018-02-16T20:46:05Z,"This breaks `rpc_bind.py` for me:\n\n```\n ./rpc_bind.py \n2018-02-16 20:39:32.628000 TestFramework (INFO): Initializing test directory /tmp/user/1000/testi0z5j5wf\n2018-02-16 20:39:32.628000 TestFramework (INFO): Using interface 10.0.2.15 for testing\n2018-02-16 20:39:32.629000 TestFramework (INFO): Bind test for []\nError: Cannot set -bind or -whitebind together with -listen=0\n2018-02-1",https://github.com/bitcoin/bitcoin/pull/12200#issuecomment-366353555,366353555,
Sjors,2018-02-17T08:57:46Z,I'll see if I can figure out how to test IPv6 stuff and make a new PR. My guess is that it needs to bind on `::1` as well.,https://github.com/bitcoin/bitcoin/pull/12200#issuecomment-366427631,366427631,
Sjors,2018-02-17T09:00:47Z,There's some recent discussion about how to use IPv6 on Travis: https://github.com/travis-ci/travis-ci/issues/8891,https://github.com/bitcoin/bitcoin/pull/12200#issuecomment-366427780,366427780,
laanwj,2018-02-22T14:16:10Z,"I completely forgot about the rpc_bind test, even though I wrote it. I think we should include it in default test_runner (could disable it specifically for travis with a flag, but have it run locally!) or remove it.",https://github.com/bitcoin/bitcoin/pull/12200#issuecomment-367693620,367693620,
laanwj,2018-02-22T14:32:36Z,"Ehh we have `test_ipv6_local()` in netutil.py (used by `feature_proxy.py`). Skipping the parts that require ipv6 binding when there is no ipv6 would be another possiblity and avoid any travis specific magic.\n\nCurrently it skips the whole test when ipv6 is not available, which seems OK as well. Was lack of IPv6 support the whole reason for excluding this test from the default runner?",https://github.com/bitcoin/bitcoin/pull/12200#issuecomment-367698532,367698532,
MarcoFalke,2018-01-16T14:49:06Z,"I'd prefer if you put it into the `bitcoin.conf` file (via `initialize_datadir`). This way, the option is valid also when nodes are (later) spun up for debugging purposes from outside the test framework.",https://github.com/bitcoin/bitcoin/pull/12200#discussion_r161778244,161778244,test/functional/test_framework/test_framework.py
Sjors,2018-01-16T15:47:38Z,It's also shorter. Done.,https://github.com/bitcoin/bitcoin/pull/12200#discussion_r161797962,161797962,test/functional/test_framework/test_framework.py
