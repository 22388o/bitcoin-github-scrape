[
  {
    "sha": "e0eae1b4a43a3c05d6a560112f5ac84a3dcd8bef",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplMGVhZTFiNGE0M2EzYzA1ZDZhNTYwMTEyZjVhYzg0YTNkY2Q4YmVm",
    "commit": {
      "author": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2019-01-23T09:23:24Z"
      },
      "committer": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2019-05-20T18:01:30Z"
      },
      "message": "Make --setup command independent\n\nA user can run 'gitian-build.py --setup' ignoring signer\nand version options.\nGet rid of warning about macOS build during setup for free.",
      "tree": {
        "sha": "0800bea8905330dd8bced291b2ad38c62bb30151",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/0800bea8905330dd8bced291b2ad38c62bb30151"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e0eae1b4a43a3c05d6a560112f5ac84a3dcd8bef",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE0dvyxLlvLev0wWZUQQEIES5+qB8FAlzi63oACgkQQQEIES5+\nqB94Fg//b9Jl0Armi7rPhMGK5iZ/b4o4UfQ7hsixft+Yuog3ozHjcU5J/1EbKSZO\n7Z3HkyMxCLbPFV9Gv7d+yDdcXH+5d1wOy3bPJEVDgIxPN5FE2yO1HU377hITN7Uh\nviRXv6k9pp/QobGx917IQbLEGN68Bpt9zK6xhJZxzdKTA/0zqArLSgx/XprEeTLq\njJfcaB+7//iwa2LUlHIUOwsUIPgu85EWTP2redyN1yhHf+1TNkj1u+WbHLjbYH4C\nGFuw0T+6a9XY+XSetJY3xV0DTA5NCm659/TPxaTFN8UBgzC3ci+W8pZi46kwpO9p\nhTyEze8SPjpx2C/bN2WX9Jzaw/EPmjLYOGw/KMGBqykjkVR/L/HHHcSK7AtqlpUK\nzyLmTKWfN+XhaJ2RsdTg6xx17v7b4yyz4jqkLYxYlKh9IqPW26kWMJKYM4Ih1nSQ\nSn4Z0yW6IjoA+ibpYjy1+KSTgGEe7xqzuiUUq2GcOw3ZMgn6rLQycNuB/WEZcFPf\nRwlrmLx/uFD1Nh3p5SXcuZ4xx9csKDEcsnT8notKMFr1sjQKnCFXFkZ7eXgKfrTJ\npQlHcGDypdVy3pleoPnDJjnAVyG2+PNw7T1wnca6PnaqdUBSIPutRDc+g08ZcaF3\n2ik/OS+BN8h3aXoNjAd2cAnOOaLiIkTM0X8s95CvhqT7WOGyPPs=\n=qkHr\n-----END PGP SIGNATURE-----",
        "payload": "tree 0800bea8905330dd8bced291b2ad38c62bb30151\nparent f49b8d4783bfffb821a509029bfdb7a69a944f6a\nauthor Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1548235404 +0200\ncommitter Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1558375290 +0300\n\nMake --setup command independent\n\nA user can run 'gitian-build.py --setup' ignoring signer\nand version options.\nGet rid of warning about macOS build during setup for free.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e0eae1b4a43a3c05d6a560112f5ac84a3dcd8bef",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/e0eae1b4a43a3c05d6a560112f5ac84a3dcd8bef",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e0eae1b4a43a3c05d6a560112f5ac84a3dcd8bef/comments",
    "author": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "f49b8d4783bfffb821a509029bfdb7a69a944f6a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f49b8d4783bfffb821a509029bfdb7a69a944f6a",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/f49b8d4783bfffb821a509029bfdb7a69a944f6a"
      }
    ],
    "stats": {
      "total": 44,
      "additions": 23,
      "deletions": 21
    },
    "files": [
      {
        "sha": "5cee59a9b91ebcdc8eb7cd09d16ec1b3625f300c",
        "filename": "contrib/gitian-build.py",
        "status": "modified",
        "additions": 23,
        "deletions": 21,
        "changes": 44,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e0eae1b4a43a3c05d6a560112f5ac84a3dcd8bef/contrib/gitian-build.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e0eae1b4a43a3c05d6a560112f5ac84a3dcd8bef/contrib/gitian-build.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/gitian-build.py?ref=e0eae1b4a43a3c05d6a560112f5ac84a3dcd8bef",
        "patch": "@@ -152,7 +152,7 @@ def verify():\n def main():\n     global args, workdir\n \n-    parser = argparse.ArgumentParser(usage='%(prog)s [options] signer version')\n+    parser = argparse.ArgumentParser(description='Script for running full Gitian builds.')\n     parser.add_argument('-c', '--commit', action='store_true', dest='commit', help='Indicate that the version argument is for a commit or branch')\n     parser.add_argument('-p', '--pull', action='store_true', dest='pull', help='Indicate that the version argument is the number of a github repository pull request')\n     parser.add_argument('-u', '--url', dest='url', default='https://github.com/bitcoin/bitcoin', help='Specify the URL of the repository. Default is %(default)s')\n@@ -168,27 +168,17 @@ def main():\n     parser.add_argument('-S', '--setup', action='store_true', dest='setup', help='Set up the Gitian building environment. Only works on Debian-based systems (Ubuntu, Debian)')\n     parser.add_argument('-D', '--detach-sign', action='store_true', dest='detach_sign', help='Create the assert file for detached signing. Will not commit anything.')\n     parser.add_argument('-n', '--no-commit', action='store_false', dest='commit_files', help='Do not commit anything to git')\n-    parser.add_argument('signer', help='GPG signer to sign each build assert file')\n-    parser.add_argument('version', help='Version number, commit, or branch to build. If building a commit or branch, the -c option must be specified')\n+    parser.add_argument('signer', nargs='?', help='GPG signer to sign each build assert file')\n+    parser.add_argument('version', nargs='?', help='Version number, commit, or branch to build. If building a commit or branch, the -c option must be specified')\n \n     args = parser.parse_args()\n     workdir = os.getcwd()\n \n-    args.linux = 'l' in args.os\n-    args.windows = 'w' in args.os\n-    args.macos = 'm' in args.os\n-\n     args.is_bionic = b'bionic' in subprocess.check_output(['lsb_release', '-cs'])\n \n-    if args.buildsign:\n-        args.build = True\n-        args.sign = True\n-\n     if args.kvm and args.docker:\n         raise Exception('Error: cannot have both kvm and docker')\n \n-    args.sign_prog = 'true' if args.detach_sign else 'gpg --detach-sign'\n-\n     # Ensure no more than one environment variable for gitian-builder (USE_LXC, USE_VBOX, USE_DOCKER) is set as they\n     # can interfere (e.g., USE_LXC being set shadows USE_DOCKER; for details see gitian-builder/libexec/make-clean-vm).\n     os.environ['USE_LXC'] = ''\n@@ -203,19 +193,34 @@ def main():\n         if 'LXC_GUEST_IP' not in os.environ.keys():\n             os.environ['LXC_GUEST_IP'] = '10.0.3.5'\n \n+    if args.setup:\n+        setup()\n+\n+    if args.buildsign:\n+        args.build = True\n+        args.sign = True\n+\n+    if not args.build and not args.sign and not args.verify:\n+        sys.exit(0)\n+\n+    args.linux = 'l' in args.os\n+    args.windows = 'w' in args.os\n+    args.macos = 'm' in args.os\n+\n     # Disable for MacOS if no SDK found\n     if args.macos and not os.path.isfile('gitian-builder/inputs/MacOSX10.11.sdk.tar.gz'):\n         print('Cannot build for MacOS, SDK does not exist. Will build for other OSes')\n         args.macos = False\n \n+    args.sign_prog = 'true' if args.detach_sign else 'gpg --detach-sign'\n+\n     script_name = os.path.basename(sys.argv[0])\n-    # Signer and version shouldn't be empty\n-    if args.signer == '':\n-        print(script_name+': Missing signer.')\n+    if not args.signer:\n+        print(script_name+': Missing signer')\n         print('Try '+script_name+' --help for more information')\n         sys.exit(1)\n-    if args.version == '':\n-        print(script_name+': Missing version.')\n+    if not args.version:\n+        print(script_name+': Missing version')\n         print('Try '+script_name+' --help for more information')\n         sys.exit(1)\n \n@@ -224,9 +229,6 @@ def main():\n         raise Exception('Cannot have both commit and pull')\n     args.commit = ('' if args.commit else 'v') + args.version\n \n-    if args.setup:\n-        setup()\n-\n     os.chdir('bitcoin')\n     if args.pull:\n         subprocess.check_call(['git', 'fetch', args.url, 'refs/pull/'+args.version+'/merge'])"
      }
    ]
  }
]