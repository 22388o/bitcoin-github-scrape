[
  {
    "sha": "ce41dec115da31565805424106915ee13cbe3173",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpjZTQxZGVjMTE1ZGEzMTU2NTgwNTQyNDEwNjkxNWVlMTNjYmUzMTcz",
    "commit": {
      "author": {
        "name": "Karl-Johan Alm",
        "email": "kalle.alm@gmail.com",
        "date": "2018-04-08T02:53:13Z"
      },
      "committer": {
        "name": "Karl-Johan Alm",
        "email": "karljohan-alm@garage.co.jp",
        "date": "2020-03-06T06:51:26Z"
      },
      "message": "wallet: Show fee in results for signrawtransaction* when known\n\nThe fee is considered known when all inputs are segwit inputs (which means amounts are enforced/known)..",
      "tree": {
        "sha": "a723180eda8846a932b56f8b81f84000a9bcf7d7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a723180eda8846a932b56f8b81f84000a9bcf7d7"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ce41dec115da31565805424106915ee13cbe3173",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEExCr/fGGz5EoUVM01V692LbM1MyIFAl5h8u4ACgkQV692LbM1\nMyKKHQ/+MSmW7rMnIwKHOOm07ydaTJLd3M/AtKYHbGlYj96Lktmb5OscAYKTXIIS\nRIC7c+jPynfw92cDvpiCUEaG5cLQANXTQ2QqGkuOQCG0DqcWANw+9m4M4FXUurTJ\nqejyomx9llb1WjdI2dzZaiyLgrlVA2uSS2/tqQm0h0nsp+ZrtTjd7lDXAy7LO6+m\n0c8vDD8EktIj99ZXIcNKeqBIm5oU4NDqtgsIbufGyhUgUJJ7lTGP3V7RG33bwfgk\nSI4TuDtVGvnQdfCcECVw+RdgAQw/z4f6O+QI/SdC8MsaIfWg3H+y4YLH9/e6J08E\n1edN5lSrg0ILaiMMWN1bKYv2JGlGbsEdWTCqTK+dHmOs85AaiWC6HZIUs/7EVvna\nKVGeh8h7Tu57JOATcaZV5I08L1EJ8avorZEDGneXzoUq5RUst89B5NfkO5o/5OMH\nvIH7rw5qTX4Cvo+V4C7BB6BcTyx7cxc4qCnKxlauQ/YbVB55XpYBeSUJ4WY0v2AU\nA5NU0gDJUuyBqRBan0XJoBlgP7jCYqfKUmGMtfJJPSI9V/RtRyb9UbrnSHLSLgL2\n924le7ovd0u7m/uo9AlySiL/Xje6yBHxNjut1eJtKnpDuUR13uTHr8Rz8IzL/Sa3\nk1Nqbvl7XzDvu9KPXF2WTZ+CBqFoKSAu0rMo0g2x38+cDemxTss=\n=ZuHG\n-----END PGP SIGNATURE-----",
        "payload": "tree a723180eda8846a932b56f8b81f84000a9bcf7d7\nparent 3f826598a42dcc707b58224e94c394e30a42ceee\nauthor Karl-Johan Alm <kalle.alm@gmail.com> 1523155993 +0900\ncommitter Karl-Johan Alm <karljohan-alm@garage.co.jp> 1583477486 +0900\n\nwallet: Show fee in results for signrawtransaction* when known\n\nThe fee is considered known when all inputs are segwit inputs (which means amounts are enforced/known)..\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ce41dec115da31565805424106915ee13cbe3173",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/ce41dec115da31565805424106915ee13cbe3173",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ce41dec115da31565805424106915ee13cbe3173/comments",
    "author": {
      "login": "kallewoof",
      "id": 250224,
      "node_id": "MDQ6VXNlcjI1MDIyNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/250224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kallewoof",
      "html_url": "https://github.com/kallewoof",
      "followers_url": "https://api.github.com/users/kallewoof/followers",
      "following_url": "https://api.github.com/users/kallewoof/following{/other_user}",
      "gists_url": "https://api.github.com/users/kallewoof/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kallewoof/subscriptions",
      "organizations_url": "https://api.github.com/users/kallewoof/orgs",
      "repos_url": "https://api.github.com/users/kallewoof/repos",
      "events_url": "https://api.github.com/users/kallewoof/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kallewoof/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "kallewoof",
      "id": 250224,
      "node_id": "MDQ6VXNlcjI1MDIyNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/250224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kallewoof",
      "html_url": "https://github.com/kallewoof",
      "followers_url": "https://api.github.com/users/kallewoof/followers",
      "following_url": "https://api.github.com/users/kallewoof/following{/other_user}",
      "gists_url": "https://api.github.com/users/kallewoof/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kallewoof/subscriptions",
      "organizations_url": "https://api.github.com/users/kallewoof/orgs",
      "repos_url": "https://api.github.com/users/kallewoof/repos",
      "events_url": "https://api.github.com/users/kallewoof/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kallewoof/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "3f826598a42dcc707b58224e94c394e30a42ceee",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3f826598a42dcc707b58224e94c394e30a42ceee",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/3f826598a42dcc707b58224e94c394e30a42ceee"
      }
    ],
    "stats": {
      "total": 14,
      "additions": 14,
      "deletions": 0
    },
    "files": [
      {
        "sha": "8c73e2dec377d8c6cee0711d9c3668a53e9b9bd6",
        "filename": "src/rpc/rawtransaction.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ce41dec115da31565805424106915ee13cbe3173/src/rpc/rawtransaction.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ce41dec115da31565805424106915ee13cbe3173/src/rpc/rawtransaction.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/rawtransaction.cpp?ref=ce41dec115da31565805424106915ee13cbe3173",
        "patch": "@@ -741,6 +741,7 @@ static UniValue signrawtransactionwithkey(const JSONRPCRequest& request)\n                     {\n                         {RPCResult::Type::STR_HEX, \"hex\", \"The hex-encoded raw transaction with signature(s)\"},\n                         {RPCResult::Type::BOOL, \"complete\", \"If the transaction has a complete set of signatures\"},\n+                        {RPCResult::Type::NUM, \"fee\", \"The fee (input amounts minus output amounts), if known\"},\n                         {RPCResult::Type::ARR, \"errors\", \"Script verification errors (if there are any)\",\n                         {\n                             {RPCResult::Type::OBJ, \"\", \"\","
      },
      {
        "sha": "2d472a38c50312172a898685ea1a44260f7963af",
        "filename": "src/rpc/rawtransaction_util.cpp",
        "status": "modified",
        "additions": 12,
        "deletions": 0,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ce41dec115da31565805424106915ee13cbe3173/src/rpc/rawtransaction_util.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ce41dec115da31565805424106915ee13cbe3173/src/rpc/rawtransaction_util.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/rawtransaction_util.cpp?ref=ce41dec115da31565805424106915ee13cbe3173",
        "patch": "@@ -281,20 +281,26 @@ void SignTransaction(CMutableTransaction& mtx, const SigningProvider* keystore,\n     // transaction to avoid rehashing.\n     const CTransaction txConst(mtx);\n     // Sign what we can:\n+    CAmount inout_amount = 0;\n+    bool known_inputs = true;\n     for (unsigned int i = 0; i < mtx.vin.size(); i++) {\n         CTxIn& txin = mtx.vin[i];\n         auto coin = coins.find(txin.prevout);\n         if (coin == coins.end() || coin->second.IsSpent()) {\n+            known_inputs = false;\n             TxInErrorToJSON(txin, vErrors, \"Input not found or already spent\");\n             continue;\n         }\n         const CScript& prevPubKey = coin->second.out.scriptPubKey;\n         const CAmount& amount = coin->second.out.nValue;\n+        inout_amount += amount;\n+        known_inputs &= amount > 0;\n \n         SignatureData sigdata = DataFromTransaction(mtx, i, coin->second.out);\n         // Only sign SIGHASH_SINGLE if there's a corresponding output:\n         if (!fHashSingle || (i < mtx.vout.size())) {\n             ProduceSignature(*keystore, MutableTransactionSignatureCreator(&mtx, i, amount, nHashType), prevPubKey, sigdata);\n+            known_inputs &= sigdata.witness;\n         }\n \n         UpdateInput(txin, sigdata);\n@@ -321,6 +327,12 @@ void SignTransaction(CMutableTransaction& mtx, const SigningProvider* keystore,\n \n     result.pushKV(\"hex\", EncodeHexTx(CTransaction(mtx)));\n     result.pushKV(\"complete\", fComplete);\n+    if (known_inputs) {\n+        for (const CTxOut& txout : mtx.vout) {\n+            inout_amount -= txout.nValue;\n+        }\n+        result.pushKV(\"fee\", ValueFromAmount(inout_amount));\n+    }\n     if (!vErrors.empty()) {\n         if (result.exists(\"errors\")) {\n             vErrors.push_backV(result[\"errors\"].getValues());"
      },
      {
        "sha": "c3343ac1581e9988e66fd4cda03cef590158e884",
        "filename": "src/wallet/rpcwallet.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ce41dec115da31565805424106915ee13cbe3173/src/wallet/rpcwallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ce41dec115da31565805424106915ee13cbe3173/src/wallet/rpcwallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/rpcwallet.cpp?ref=ce41dec115da31565805424106915ee13cbe3173",
        "patch": "@@ -3288,6 +3288,7 @@ UniValue signrawtransactionwithwallet(const JSONRPCRequest& request)\n                     {\n                         {RPCResult::Type::STR_HEX, \"hex\", \"The hex-encoded raw transaction with signature(s)\"},\n                         {RPCResult::Type::BOOL, \"complete\", \"If the transaction has a complete set of signatures\"},\n+                        {RPCResult::Type::NUM, \"fee\", \"The fee (input amounts minus output amounts), if known\"},\n                         {RPCResult::Type::ARR, \"errors\", \"Script verification errors (if there are any)\",\n                         {\n                             {RPCResult::Type::OBJ, \"\", \"\","
      }
    ]
  },
  {
    "sha": "33e5b88d22dc9b38468e3a86f230c4c8ebc5aada",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozM2U1Yjg4ZDIyZGM5YjM4NDY4ZTNhODZmMjMwYzRjOGViYzVhYWRh",
    "commit": {
      "author": {
        "name": "Karl-Johan Alm",
        "email": "karljohan-alm@garage.co.jp",
        "date": "2018-05-10T06:44:20Z"
      },
      "committer": {
        "name": "Karl-Johan Alm",
        "email": "karljohan-alm@garage.co.jp",
        "date": "2020-03-06T06:51:26Z"
      },
      "message": "doc: Update release notes about fee entry",
      "tree": {
        "sha": "11e0cf4ca06c7fda27491bc6599cecf7886e7191",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/11e0cf4ca06c7fda27491bc6599cecf7886e7191"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/33e5b88d22dc9b38468e3a86f230c4c8ebc5aada",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEExCr/fGGz5EoUVM01V692LbM1MyIFAl5h8u4ACgkQV692LbM1\nMyIEMA/6Ak4pKhiPdhUWWkZOStve2TY8zCfKk9Rl1gEhp1KUvZIrM6rTDeBDHB/F\nYTQWOzIaJTR4w0Ro2D4YzMHzapFC/BxtGDxkD8nyEDBdP//LuVqydvpce4jkbJQd\nR44uceKM1cl7GgXkQn0ehK6xGmJ5mg495tFi9GP7j39lKZ9Z8xB5f23fgOdCpZFp\naD46T1f1IRc+WdhSw5zcQ1jYNvrqfLcY5LLopYUBX4Ksah2Hm+ruDcVB3AcooS04\nduhjpNFPrrKi1zvYW00o4vJi7fNPZSoz8T2vmsgSZoMNMk6nSPi6aXS/WqVQkKmS\nHMorUP6ln9adpKGyj8gJYzG6J9X8m0hfEF2VRTXgmdhUD80yUiQdKFCW4rOFkLpY\npUM7fJBvBPOtuws62pVp1owqVrid5WCgtwmpw7eABEgA5ED0fy39jnfWAGgN1ZQ7\nf2Hi0lUMHGx6NM6PCg1zJsYaSpToobTqyuEOre0OZp6JxmV2Imapbj95t+kPu9ab\nQblCKNUZJz3ybFLEDry1/7Swgv91cIEic/ukTyQCqlP5RS/Jk2DIAoMDDLTQ//1U\njz9ZGj2z6TWpe4pH1w67UMl6qf+3jmPSPYP1eKIWw+c4U0PjZX0y+piUgo53zQoy\ndi7LNhWvbuECMt3XXrzjHWp8D5CXg5ht/7lWTNnhppCVZtgs320=\n=X9RL\n-----END PGP SIGNATURE-----",
        "payload": "tree 11e0cf4ca06c7fda27491bc6599cecf7886e7191\nparent ce41dec115da31565805424106915ee13cbe3173\nauthor Karl-Johan Alm <karljohan-alm@garage.co.jp> 1525934660 +0900\ncommitter Karl-Johan Alm <karljohan-alm@garage.co.jp> 1583477486 +0900\n\ndoc: Update release notes about fee entry\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/33e5b88d22dc9b38468e3a86f230c4c8ebc5aada",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/33e5b88d22dc9b38468e3a86f230c4c8ebc5aada",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/33e5b88d22dc9b38468e3a86f230c4c8ebc5aada/comments",
    "author": {
      "login": "kallewoof",
      "id": 250224,
      "node_id": "MDQ6VXNlcjI1MDIyNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/250224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kallewoof",
      "html_url": "https://github.com/kallewoof",
      "followers_url": "https://api.github.com/users/kallewoof/followers",
      "following_url": "https://api.github.com/users/kallewoof/following{/other_user}",
      "gists_url": "https://api.github.com/users/kallewoof/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kallewoof/subscriptions",
      "organizations_url": "https://api.github.com/users/kallewoof/orgs",
      "repos_url": "https://api.github.com/users/kallewoof/repos",
      "events_url": "https://api.github.com/users/kallewoof/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kallewoof/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "kallewoof",
      "id": 250224,
      "node_id": "MDQ6VXNlcjI1MDIyNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/250224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kallewoof",
      "html_url": "https://github.com/kallewoof",
      "followers_url": "https://api.github.com/users/kallewoof/followers",
      "following_url": "https://api.github.com/users/kallewoof/following{/other_user}",
      "gists_url": "https://api.github.com/users/kallewoof/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kallewoof/subscriptions",
      "organizations_url": "https://api.github.com/users/kallewoof/orgs",
      "repos_url": "https://api.github.com/users/kallewoof/repos",
      "events_url": "https://api.github.com/users/kallewoof/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kallewoof/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "ce41dec115da31565805424106915ee13cbe3173",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ce41dec115da31565805424106915ee13cbe3173",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/ce41dec115da31565805424106915ee13cbe3173"
      }
    ],
    "stats": {
      "total": 7,
      "additions": 7,
      "deletions": 0
    },
    "files": [
      {
        "sha": "f9f6a90f2ed5b62fce48c8d70f731b0da8cdce4a",
        "filename": "doc/release-notes-pr12911.md",
        "status": "added",
        "additions": 7,
        "deletions": 0,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/33e5b88d22dc9b38468e3a86f230c4c8ebc5aada/doc/release-notes-pr12911.md",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/33e5b88d22dc9b38468e3a86f230c4c8ebc5aada/doc/release-notes-pr12911.md",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/doc/release-notes-pr12911.md?ref=33e5b88d22dc9b38468e3a86f230c4c8ebc5aada",
        "patch": "@@ -0,0 +1,7 @@\n+RPC changes\n+------------\n+\n+### Low-level changes\n+\n+- `signrawtransactionwithkey` and `signrawtransactionwithwallet` will now include a `fee` entry in the results,\n+  for cases where the fee is known."
      }
    ]
  },
  {
    "sha": "476933ffe26e6d0192194ce557dd1400d177b06c",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0NzY5MzNmZmUyNmU2ZDAxOTIxOTRjZTU1N2RkMTQwMGQxNzdiMDZj",
    "commit": {
      "author": {
        "name": "Karl-Johan Alm",
        "email": "karljohan-alm@garage.co.jp",
        "date": "2018-04-09T05:43:10Z"
      },
      "committer": {
        "name": "Karl-Johan Alm",
        "email": "karljohan-alm@garage.co.jp",
        "date": "2020-03-06T06:52:23Z"
      },
      "message": "wallet: Display fee rate in signrawtransaction*",
      "tree": {
        "sha": "56b58639682f9e4f077e51e10ac81551c830085c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/56b58639682f9e4f077e51e10ac81551c830085c"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/476933ffe26e6d0192194ce557dd1400d177b06c",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEExCr/fGGz5EoUVM01V692LbM1MyIFAl5h8ycACgkQV692LbM1\nMyInuBAAl/xNwORP/NU9NRGM3AK9rpUmEdmNShZV1PlHw9e9VFrG6FKPTjcBsw7e\ndd/GLb/fJrquszbOmUFh8jSbkoUqHVlYbOuREprbtqWk0hAenyHpFT/pgLyOCdru\ntfCbi8iPq8iqmFEXF2AMoTCxhKzE+js6viHljpp8ecuYfl8NN7XSSYD/Mw0pNd1j\nrUl3bNTB/gkH1wLpqb0HIF3kqaRXTqWKKU8nwIn0fJINFCpJCVEOTo09HKpjy/Zc\neLPjIezotqcfSrOV/SvX6k7A9LOOPbklXhGrP8ZQ7oGBBGBsnivhu12KPtaWhcJK\nfrO34WpnVBqGrHqgYfq6R7KikL+mK8UfD/rZ914pZnH7NbOwGMzmOtbSkViLll6i\nKTElFRJqvCMQoKN1Sf2TjjgVi4KLXbGq/l9iMJikqY5WV6mtJ3fEVwoFTiC2gk9I\nq88OEHr5ArswPtDjuUNWDv0BL4tOyyvMow6HRtP5FqW/NWZLxHa82ne0hjv5SEDy\nIeXDaMWA9hXZ8vSknwmE99cjISO1NUTeO3qMy2hYGqZCBMr7ErS3Mg8ZmlPh0ACH\nKpSiqzOVJfCWsZIvJN39aCoIOnjf6KrrU0N1dxh0hKa04iNCbOuOP2ZEtJr56Csy\npA4CoyioudzWmG6Jz6Fxe5mWUdUryBg845jXzD9c9U5NRFib4uU=\n=5xvs\n-----END PGP SIGNATURE-----",
        "payload": "tree 56b58639682f9e4f077e51e10ac81551c830085c\nparent 33e5b88d22dc9b38468e3a86f230c4c8ebc5aada\nauthor Karl-Johan Alm <karljohan-alm@garage.co.jp> 1523252590 +0900\ncommitter Karl-Johan Alm <karljohan-alm@garage.co.jp> 1583477543 +0900\n\nwallet: Display fee rate in signrawtransaction*\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/476933ffe26e6d0192194ce557dd1400d177b06c",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/476933ffe26e6d0192194ce557dd1400d177b06c",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/476933ffe26e6d0192194ce557dd1400d177b06c/comments",
    "author": {
      "login": "kallewoof",
      "id": 250224,
      "node_id": "MDQ6VXNlcjI1MDIyNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/250224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kallewoof",
      "html_url": "https://github.com/kallewoof",
      "followers_url": "https://api.github.com/users/kallewoof/followers",
      "following_url": "https://api.github.com/users/kallewoof/following{/other_user}",
      "gists_url": "https://api.github.com/users/kallewoof/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kallewoof/subscriptions",
      "organizations_url": "https://api.github.com/users/kallewoof/orgs",
      "repos_url": "https://api.github.com/users/kallewoof/repos",
      "events_url": "https://api.github.com/users/kallewoof/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kallewoof/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "kallewoof",
      "id": 250224,
      "node_id": "MDQ6VXNlcjI1MDIyNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/250224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kallewoof",
      "html_url": "https://github.com/kallewoof",
      "followers_url": "https://api.github.com/users/kallewoof/followers",
      "following_url": "https://api.github.com/users/kallewoof/following{/other_user}",
      "gists_url": "https://api.github.com/users/kallewoof/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kallewoof/subscriptions",
      "organizations_url": "https://api.github.com/users/kallewoof/orgs",
      "repos_url": "https://api.github.com/users/kallewoof/repos",
      "events_url": "https://api.github.com/users/kallewoof/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kallewoof/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "33e5b88d22dc9b38468e3a86f230c4c8ebc5aada",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/33e5b88d22dc9b38468e3a86f230c4c8ebc5aada",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/33e5b88d22dc9b38468e3a86f230c4c8ebc5aada"
      }
    ],
    "stats": {
      "total": 10,
      "additions": 9,
      "deletions": 1
    },
    "files": [
      {
        "sha": "ecf3506b47e31f2d4cd1be4e8cec0df6bbf7c5d1",
        "filename": "src/rpc/rawtransaction.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/476933ffe26e6d0192194ce557dd1400d177b06c/src/rpc/rawtransaction.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/476933ffe26e6d0192194ce557dd1400d177b06c/src/rpc/rawtransaction.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/rawtransaction.cpp?ref=476933ffe26e6d0192194ce557dd1400d177b06c",
        "patch": "@@ -742,6 +742,7 @@ static UniValue signrawtransactionwithkey(const JSONRPCRequest& request)\n                         {RPCResult::Type::STR_HEX, \"hex\", \"The hex-encoded raw transaction with signature(s)\"},\n                         {RPCResult::Type::BOOL, \"complete\", \"If the transaction has a complete set of signatures\"},\n                         {RPCResult::Type::NUM, \"fee\", \"The fee (input amounts minus output amounts), if known\"},\n+                        {RPCResult::Type::NUM, \"feerate\", \"The fee rate (in \" + CURRENCY_UNIT + \"/kB), if fee is known\"},\n                         {RPCResult::Type::ARR, \"errors\", \"Script verification errors (if there are any)\",\n                         {\n                             {RPCResult::Type::OBJ, \"\", \"\","
      },
      {
        "sha": "fc31925188a223419f9d17af540a65cc9567311e",
        "filename": "src/rpc/rawtransaction_util.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 1,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/476933ffe26e6d0192194ce557dd1400d177b06c/src/rpc/rawtransaction_util.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/476933ffe26e6d0192194ce557dd1400d177b06c/src/rpc/rawtransaction_util.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/rawtransaction_util.cpp?ref=476933ffe26e6d0192194ce557dd1400d177b06c",
        "patch": "@@ -325,13 +325,19 @@ void SignTransaction(CMutableTransaction& mtx, const SigningProvider* keystore,\n     }\n     bool fComplete = vErrors.empty();\n \n-    result.pushKV(\"hex\", EncodeHexTx(CTransaction(mtx)));\n+    CTransaction tx(mtx);\n+    result.pushKV(\"hex\", EncodeHexTx(tx));\n     result.pushKV(\"complete\", fComplete);\n     if (known_inputs) {\n         for (const CTxOut& txout : mtx.vout) {\n             inout_amount -= txout.nValue;\n         }\n         result.pushKV(\"fee\", ValueFromAmount(inout_amount));\n+        result.pushKV(\"feerate\",\n+            ValueFromAmount(\n+                CFeeRate(inout_amount, GetVirtualTransactionSize(tx)).GetFeePerK()\n+            )\n+        );\n     }\n     if (!vErrors.empty()) {\n         if (result.exists(\"errors\")) {"
      },
      {
        "sha": "d4dc9d013632a9633595eb0a501f5368acab4e89",
        "filename": "src/wallet/rpcwallet.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/476933ffe26e6d0192194ce557dd1400d177b06c/src/wallet/rpcwallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/476933ffe26e6d0192194ce557dd1400d177b06c/src/wallet/rpcwallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/rpcwallet.cpp?ref=476933ffe26e6d0192194ce557dd1400d177b06c",
        "patch": "@@ -3289,6 +3289,7 @@ UniValue signrawtransactionwithwallet(const JSONRPCRequest& request)\n                         {RPCResult::Type::STR_HEX, \"hex\", \"The hex-encoded raw transaction with signature(s)\"},\n                         {RPCResult::Type::BOOL, \"complete\", \"If the transaction has a complete set of signatures\"},\n                         {RPCResult::Type::NUM, \"fee\", \"The fee (input amounts minus output amounts), if known\"},\n+                        {RPCResult::Type::NUM, \"feerate\", \"The fee rate (in \" + CURRENCY_UNIT + \"/kB), if fee is known\"},\n                         {RPCResult::Type::ARR, \"errors\", \"Script verification errors (if there are any)\",\n                         {\n                             {RPCResult::Type::OBJ, \"\", \"\","
      }
    ]
  },
  {
    "sha": "47b2ba29df297498a855833115968de3a3da06bf",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0N2IyYmEyOWRmMjk3NDk4YTg1NTgzMzExNTk2OGRlM2EzZGEwNmJm",
    "commit": {
      "author": {
        "name": "Karl-Johan Alm",
        "email": "karljohan-alm@garage.co.jp",
        "date": "2019-01-24T07:29:49Z"
      },
      "committer": {
        "name": "Karl-Johan Alm",
        "email": "karljohan-alm@garage.co.jp",
        "date": "2020-03-06T06:52:23Z"
      },
      "message": "test: add test to segwit tests for fee rate when signing raw tx",
      "tree": {
        "sha": "e56a5234d14c65c42f69388253be79c86141b531",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e56a5234d14c65c42f69388253be79c86141b531"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/47b2ba29df297498a855833115968de3a3da06bf",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEExCr/fGGz5EoUVM01V692LbM1MyIFAl5h8ycACgkQV692LbM1\nMyLi8Q/9FWg0FXHBq383OZebTsD3R6w++4mAZ2apv3KAJ7zZJ3b9mhL8QGraMGyy\n78PcQo2MYkcR93d1cx+TXYu06H4BdrmLcyE9Za5pDWYq2fCOp7924CQ6KXdiWPsv\n6aHKm+KQ7cHNSQBHj8Kb3h/Xirvsjq4uMoNfowkp+vEuw5y8okypHkUBZCJ47veh\nIO7JznxMKdDUDpIz4Y5ubPHxjZHS4mjWP6nBulFzbLuleULKTrDP1KgQJraFJKnf\nzGEK8M7DwnyrZ31RBMWBjOTOOT9q3C3c5e5IQnzs2UX/fQSy/iZEaOKxuSHh89h2\nKpgYk6raZsWwGHwvLAozhuxGZjtVkdv+/wVOX+I6zmVQkwHQ5HJ0Tv/SdFcgBQRV\nbC28C9smFOqIXOijJcwl8R2N1HDn6XM/dSP4707/21B4Yofz/s1lIGbQ4V8iF2Ez\n689o1yFKi2NGCGUIhtS7/ROuCohdOQbqoXIHA0fO1+iqB1SDNHuOF8C2WXBQp9NC\njRBPJJ40JO78L2PcUppqUwep9zsuHFstfkJS+E2eYym5XIsaw4uUYacu0TLVtMP8\nIvqaA+glX7IN3t8mpjH9TNv+IcJzBC/oDfYsPE77Q1dbNA9D3rmfsrYMA0qVBbTC\nldiAxzEpjk9z0NzCewrtcV29VYSMnnRTzxOUL0Nwwj6dw8WABmY=\n=H4/l\n-----END PGP SIGNATURE-----",
        "payload": "tree e56a5234d14c65c42f69388253be79c86141b531\nparent 476933ffe26e6d0192194ce557dd1400d177b06c\nauthor Karl-Johan Alm <karljohan-alm@garage.co.jp> 1548314989 +0900\ncommitter Karl-Johan Alm <karljohan-alm@garage.co.jp> 1583477543 +0900\n\ntest: add test to segwit tests for fee rate when signing raw tx\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/47b2ba29df297498a855833115968de3a3da06bf",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/47b2ba29df297498a855833115968de3a3da06bf",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/47b2ba29df297498a855833115968de3a3da06bf/comments",
    "author": {
      "login": "kallewoof",
      "id": 250224,
      "node_id": "MDQ6VXNlcjI1MDIyNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/250224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kallewoof",
      "html_url": "https://github.com/kallewoof",
      "followers_url": "https://api.github.com/users/kallewoof/followers",
      "following_url": "https://api.github.com/users/kallewoof/following{/other_user}",
      "gists_url": "https://api.github.com/users/kallewoof/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kallewoof/subscriptions",
      "organizations_url": "https://api.github.com/users/kallewoof/orgs",
      "repos_url": "https://api.github.com/users/kallewoof/repos",
      "events_url": "https://api.github.com/users/kallewoof/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kallewoof/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "kallewoof",
      "id": 250224,
      "node_id": "MDQ6VXNlcjI1MDIyNA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/250224?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/kallewoof",
      "html_url": "https://github.com/kallewoof",
      "followers_url": "https://api.github.com/users/kallewoof/followers",
      "following_url": "https://api.github.com/users/kallewoof/following{/other_user}",
      "gists_url": "https://api.github.com/users/kallewoof/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/kallewoof/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/kallewoof/subscriptions",
      "organizations_url": "https://api.github.com/users/kallewoof/orgs",
      "repos_url": "https://api.github.com/users/kallewoof/repos",
      "events_url": "https://api.github.com/users/kallewoof/events{/privacy}",
      "received_events_url": "https://api.github.com/users/kallewoof/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "476933ffe26e6d0192194ce557dd1400d177b06c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/476933ffe26e6d0192194ce557dd1400d177b06c",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/476933ffe26e6d0192194ce557dd1400d177b06c"
      }
    ],
    "stats": {
      "total": 29,
      "additions": 29,
      "deletions": 0
    },
    "files": [
      {
        "sha": "c20ddb6115c78f88f3ebd73e3d7df94c924ddf52",
        "filename": "test/functional/feature_segwit.py",
        "status": "modified",
        "additions": 29,
        "deletions": 0,
        "changes": 29,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/47b2ba29df297498a855833115968de3a3da06bf/test/functional/feature_segwit.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/47b2ba29df297498a855833115968de3a3da06bf/test/functional/feature_segwit.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/feature_segwit.py?ref=47b2ba29df297498a855833115968de3a3da06bf",
        "patch": "@@ -19,6 +19,7 @@\n from test_framework.script import CScript, OP_HASH160, OP_CHECKSIG, OP_0, hash160, OP_EQUAL, OP_DUP, OP_EQUALVERIFY, OP_1, OP_2, OP_CHECKMULTISIG, OP_TRUE, OP_DROP\n from test_framework.test_framework import BitcoinTestFramework\n from test_framework.util import (\n+    assert_approx,\n     assert_equal,\n     assert_raises_rpc_error,\n     connect_nodes,\n@@ -278,6 +279,34 @@ def run_test(self):\n         # Mine a block to clear the gbt cache again.\n         self.nodes[0].generate(1)\n \n+        self.log.info(\"Signing with all-segwit inputs reveals fee rate\")\n+        # Test that signing a tx with all-segwit inputs returns the fee\n+        # in the results\n+        addr = self.nodes[0].getnewaddress(address_type='p2sh-segwit')\n+        txid = self.nodes[0].sendtoaddress(addr, 1)\n+        tx = self.nodes[0].getrawtransaction(txid, True)\n+        n = -1\n+        value = -1\n+        for o in tx[\"vout\"]:\n+            if o[\"scriptPubKey\"][\"addresses\"][0] == addr:\n+                n = o[\"n\"]\n+                value = Decimal(o[\"value\"])\n+                break\n+        assert n > -1 # failure means we could not find the address in the outputs despite sending to it\n+        assert_approx(value, 1.0, 0.01) # failure means we got an unexpected amount of coins, despite trying to send 1\n+        fee = Decimal(\"0.00010000\")\n+        value_out = value - fee\n+        self.nodes[0].generatetoaddress(1, self.nodes[0].getnewaddress())\n+        raw = self.nodes[0].createrawtransaction([{\"txid\" : txid, \"vout\" : n}], [{self.nodes[0].getnewaddress() : value_out}])\n+        signed = self.nodes[0].signrawtransactionwithwallet(raw)\n+        assert_equal(signed[\"complete\"], True)\n+        txsize = self.nodes[0].decoderawtransaction(signed['hex'])['vsize']\n+        exp_feerate = 1000 * fee / Decimal(txsize)\n+        assert_approx(signed[\"feerate\"], exp_feerate, Decimal(\"0.00000010\"))\n+        # discrepancy = 100000000 * (exp_feerate - signed[\"feerate\"])\n+        # assert -10 < discrepancy < 10\n+        assert Decimal(signed[\"fee\"]) == fee\n+\n         self.log.info(\"Verify behaviour of importaddress and listunspent\")\n \n         # Some public keys to be used later"
      }
    ]
  }
]