practicalswift,2017-07-27T07:35:50Z,"@promag I prefer doing a check inside of `BlockNotifyCallback(…)` (as close as possible to the `RunCommand(…)`) since:\n* `BlockNotifyCallback(…)` might be invoked from other places in the future.\n* That is consistent with how it is done for `AlertNotify(...)` (`-alertnotify`) and `AddToWallet(...)` (`-walletnotify`).",https://github.com/bitcoin/bitcoin/pull/10939#issuecomment-318283719,318283719,
promag,2017-07-27T08:27:28Z,"Side note, should we treat empty args as invalid?",https://github.com/bitcoin/bitcoin/pull/10939#issuecomment-318294918,318294918,
practicalswift,2017-07-27T08:46:03Z,"@promag In the specific case of `-{alert,block,wallet}notify`: yes - no need to execute `""""` :-)",https://github.com/bitcoin/bitcoin/pull/10939#issuecomment-318299403,318299403,
laanwj,2017-07-27T09:07:47Z,"> Side note, should we treat empty args as invalid?\n\nDepends on the specific argument. For some things, an empty string might be a valid value, for others it's not.\n\nFor executing a command it makes sense to skip it when the string is empty.\nWhat does `system("""")` do? spawn a shell?\n\nBTW: Why not handle this in `runCommand`? that seems the shortest path to making this consistent.",https://github.com/bitcoin/bitcoin/pull/10939#issuecomment-318304677,318304677,
laanwj,2017-07-27T09:09:17Z,"> What does system("""") do? spawn a shell?\n\nIt already does nothing! Same for `system(""     "");` etc.\nWhy do we need this change?",https://github.com/bitcoin/bitcoin/pull/10939#issuecomment-318305055,318305055,
promag,2017-07-27T11:09:33Z,"@laanwj the only reason to test `""""` in each is to add some custom logging. Otherwise agree with you (despite the fact that we can avoid connecting to the signal in init). ",https://github.com/bitcoin/bitcoin/pull/10939#issuecomment-318332124,318332124,
laanwj,2017-07-27T11:38:17Z,"Not convinced that ""custom logging"" makes sense here. The user provided an empty command, which non-ambiguously means they don't want it to do anything. It doesn't do anything.\n\n(maybe skipping could be considered a small optimization, but could leave it up to the user to just not provide the argument at all so that the signal doesn't get registered? I have a hard time imagining any circumstan",https://github.com/bitcoin/bitcoin/pull/10939#issuecomment-318337595,318337595,
practicalswift,2017-07-27T12:12:50Z,"@laanwj My original idea was to make `-blocknotify`, `-alertnotify` and `-walletnotify` behave identically with regards to thread creation and `execve(…)`-calls in case of an `""""` argument. Not a big issue, just a small step towards increased user interface consistency :-)",https://github.com/bitcoin/bitcoin/pull/10939#issuecomment-318344338,318344338,
promag,2017-07-31T15:30:11Z,"@laanwj IMO empty commands should be invalid. The same goes for when a command does not exists. Not providing the argument/command should be the correct way to run nothing.\n\nFor instance, with `find` it fails:\n```\n$ find . -exec \;\nfind: -exec: no command specified\n```",https://github.com/bitcoin/bitcoin/pull/10939#issuecomment-319103747,319103747,
jnewbery,2017-09-01T21:10:41Z,"(slightly offtopic)\n\n@promag - I'm with you on this one. I'd like there to be better systematic validation of command line-arguments.\n\nI think you've spoken about argument validation on a few issues. Perhaps we should raise this in a future meeting to get concept feedback?",https://github.com/bitcoin/bitcoin/pull/10939#issuecomment-326684639,326684639,
promag,2017-09-01T21:36:05Z,"Yes @jnewbery, IMO it can be improved. We should validate command line arguments in the same way we validate RPC arguments. Again, for me `""""` is an invalid command.",https://github.com/bitcoin/bitcoin/pull/10939#issuecomment-326688959,326688959,
luke-jr,2017-09-02T06:42:15Z,"We shouldn't make the empty command invalid so quickly: if one has `blocknotify=foobar` in the `bitcoin.conf` file, they may wish to use `-blocknotify=` on the commandline to temporarily disable it.\n\n(The alternative, `-noblocknotify`, is probably broken...)",https://github.com/bitcoin/bitcoin/pull/10939#issuecomment-326726327,326726327,
promag,2017-09-02T08:37:17Z,"> they may wish to use -blocknotify= \n\nThey can remove the line or comment it out?",https://github.com/bitcoin/bitcoin/pull/10939#issuecomment-326731182,326731182,
luke-jr,2017-09-02T08:42:59Z,Better if no change to the config file is needed for such a temporary purpose.,https://github.com/bitcoin/bitcoin/pull/10939#issuecomment-326731494,326731494,
jnewbery,2017-09-04T16:00:32Z,"@luke-jr raises a good point. Being able to override and temporarily disable .conf file options from the command line is very useful. This PR allows that (supplying `blocknotify=` won't cause an error).\n\nHas anyone tested what happens with `noblocknotify`?",https://github.com/bitcoin/bitcoin/pull/10939#issuecomment-326993932,326993932,
laanwj,2017-10-04T12:53:47Z,"> We shouldn't make the empty command invalid so quickly: if one has blocknotify=foobar in the bitcoin.conf file, they may wish to use -blocknotify= on the commandline to temporarily disable it.\n\nGood point! And the first good argument for doing this at all. Being able to overriding the blocknotify command with """" (say, from the command line) to disable it is useful. In that case you don't wan",https://github.com/bitcoin/bitcoin/pull/10939#issuecomment-334145434,334145434,
promag,2017-07-27T00:49:32Z,Unrelated.,https://github.com/bitcoin/bitcoin/pull/10939#discussion_r129731533,129731533,src/wallet/wallet.cpp
promag,2017-07-27T00:50:46Z,"No need to test because in `init.cpp` there's:\n```cpp\n    if (IsArgSet(""-blocknotify""))\n        uiInterface.NotifyBlockTip.connect(BlockNotifyCallback);\n```",https://github.com/bitcoin/bitcoin/pull/10939#discussion_r129731661,129731661,src/init.cpp
practicalswift,2017-07-27T07:26:16Z,That change was intentional to show how the logic is handled in `AddToWallet` (`-walletnotify`).,https://github.com/bitcoin/bitcoin/pull/10939#discussion_r129770554,129770554,src/wallet/wallet.cpp
practicalswift,2017-07-27T07:27:13Z,Does `IsArgSet(…)` test for emptiness?,https://github.com/bitcoin/bitcoin/pull/10939#discussion_r129770684,129770684,src/init.cpp
promag,2017-07-27T08:26:17Z,Ignore if you want to keep the test here.,https://github.com/bitcoin/bitcoin/pull/10939#discussion_r129780812,129780812,src/init.cpp
