[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/966541375",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#issuecomment-966541375",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23486",
    "id": 966541375,
    "node_id": "IC_kwDOABII5845nEA_",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-11T18:48:00Z",
    "updated_at": "2021-11-11T18:48:00Z",
    "author_association": "MEMBER",
    "body": "Concept ACK. For slightly easier review, maybe split into a pure refactor/reformat commit and the actual behavior change.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/966541375/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/966554613",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#issuecomment-966554613",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23486",
    "id": 966554613,
    "node_id": "IC_kwDOABII5845nHP1",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-11T19:09:06Z",
    "updated_at": "2021-11-11T19:09:06Z",
    "author_association": "MEMBER",
    "body": "If you pass in `--ignore-all-space`, it will show only the behaviour changes. I think it makes sense to adjust the whitespace in the same commit that removes the if-body.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/966554613/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/966782730",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#issuecomment-966782730",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23486",
    "id": 966782730,
    "node_id": "IC_kwDOABII5845n-8K",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-12T03:04:38Z",
    "updated_at": "2021-11-22T14:58:46Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#23507](https://github.com/bitcoin/bitcoin/pull/23507) (Refactor: Improve API design of `ScriptToUniv`, `TxToUniv` etc to return the `UniValue` instead of mutating a parameter/reference by mjdietzx)\n* [#22924](https://github.com/bitcoin/bitcoin/pull/22924) (refactor: cleanup/followup of Remove -deprecatedrpc=addresses flag by mjdietzx)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/966782730/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/966969324",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#issuecomment-966969324",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23486",
    "id": 966969324,
    "node_id": "IC_kwDOABII5845osfs",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-12T09:54:28Z",
    "updated_at": "2021-11-12T09:54:28Z",
    "author_association": "MEMBER",
    "body": "I agree with @Sjors here. I think it makes sense to split the functionality change into a separate commit. Even if it can still be reviewed by providing extra arguments to diff, it just seems cleaner, say, when browsing git history later.\r\n\r\nDoes this need a functional test?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/966969324/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/967062461",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#issuecomment-967062461",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23486",
    "id": 967062461,
    "node_id": "IC_kwDOABII5845pDO9",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-12T12:08:28Z",
    "updated_at": "2021-11-15T15:17:39Z",
    "author_association": "MEMBER",
    "body": "~~Code review ACK fa1c1f417ef97d15331f4a13b40be9e00ecdb464~~\r\n\r\nCode review re-ACK fa972d8d771c93c1d37eeb31da04e95e8e5ca0ad",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/967062461/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/967192330",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#issuecomment-967192330",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23486",
    "id": 967192330,
    "node_id": "IC_kwDOABII5845pi8K",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-12T15:13:07Z",
    "updated_at": "2021-11-12T15:13:07Z",
    "author_association": "MEMBER",
    "body": "> Does this need a functional test?\r\n\r\nThere are steps to test in the first comment, but I am happy to add a commit with tests if someone writes them. I am also happy to review a pull if someone adds them after merge.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/967192330/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/967209533",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#issuecomment-967209533",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23486",
    "id": 967209533,
    "node_id": "IC_kwDOABII5845pnI9",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-12T15:36:28Z",
    "updated_at": "2021-11-12T15:36:45Z",
    "author_association": "MEMBER",
    "body": "tACK fa1c1f417ef97d15331f4a13b40be9e00ecdb464",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/967209533/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/968331423",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#issuecomment-968331423",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23486",
    "id": 968331423,
    "node_id": "IC_kwDOABII5845t5Cf",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-14T17:21:47Z",
    "updated_at": "2021-11-14T17:21:47Z",
    "author_association": "MEMBER",
    "body": "Reworked and updated pull request description",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/968331423/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/969105412",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#issuecomment-969105412",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23486",
    "id": 969105412,
    "node_id": "IC_kwDOABII5845w2AE",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-15T16:51:02Z",
    "updated_at": "2021-11-15T16:51:02Z",
    "author_association": "MEMBER",
    "body": "We may also need to check that no OP_CHECKSIGADD opcodes occur in a script before reporting a P2WSH for it.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/969105412/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/969122906",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#issuecomment-969122906",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23486",
    "id": 969122906,
    "node_id": "IC_kwDOABII5845w6Ra",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?u=9791e96cd4268d48e3517bac41eaf2b1d09759fd&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-15T17:09:06Z",
    "updated_at": "2021-11-15T17:09:06Z",
    "author_association": "MEMBER",
    "body": "> We may also need to check that no OP_CHECKSIGADD opcodes occur in a script before reporting a P2WSH for it.\r\n\r\nAnd OP_SUCCESSx too",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/969122906/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/970593400",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#issuecomment-970593400",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23486",
    "id": 970593400,
    "node_id": "IC_kwDOABII58452hR4",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-16T19:20:03Z",
    "updated_at": "2021-11-16T19:20:03Z",
    "author_association": "MEMBER",
    "body": "> And OP_SUCCESSx too\r\n\r\nAnd unparseable, and unspendable scripts.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/970593400/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/975493876",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#issuecomment-975493876",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23486",
    "id": 975493876,
    "node_id": "IC_kwDOABII5846JNr0",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-11-22T12:55:39Z",
    "updated_at": "2021-11-22T12:55:39Z",
    "author_association": "MEMBER",
    "body": "Force pushed to fix a \"typo\" :confounded: and updated OP to include more tests.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/975493876/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/747643612",
    "pull_request_review_id": 803989571,
    "id": 747643612,
    "node_id": "PRRC_kwDOABII584skCLc",
    "diff_hunk": "@@ -535,32 +535,35 @@ static std::string GetAllOutputTypes()\n \n static RPCHelpMan decodescript()\n {\n-    return RPCHelpMan{\"decodescript\",\n-                \"\\nDecode a hex-encoded script.\\n\",\n-                {\n-                    {\"hexstring\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"the hex-encoded script\"},\n-                },\n-                RPCResult{\n-                    RPCResult::Type::OBJ, \"\", \"\",\n-                    {\n-                        {RPCResult::Type::STR, \"asm\", \"Script public key\"},\n-                        {RPCResult::Type::STR, \"type\", \"The output type (e.g. \"+GetAllOutputTypes()+\")\"},\n-                        {RPCResult::Type::STR, \"address\", /* optional */ true, \"The Bitcoin address (only if a well-defined address exists)\"},\n-                        {RPCResult::Type::STR, \"p2sh\", /* optional */ true, \"address of P2SH script wrapping this redeem script (not returned if the script is already a P2SH)\"},\n-                        {RPCResult::Type::OBJ, \"segwit\", /* optional */ true, \"Result of a witness script public key wrapping this redeem script (not returned if the script is a P2SH or witness)\",\n-                        {\n-                            {RPCResult::Type::STR, \"asm\", \"String representation of the script public key\"},\n-                            {RPCResult::Type::STR_HEX, \"hex\", \"Hex string of the script public key\"},\n-                            {RPCResult::Type::STR, \"type\", \"The type of the script public key (e.g. witness_v0_keyhash or witness_v0_scripthash)\"},\n-                            {RPCResult::Type::STR, \"address\", /* optional */ true, \"The Bitcoin address (only if a well-defined address exists)\"},\n-                            {RPCResult::Type::STR, \"p2sh-segwit\", \"address of the P2SH script wrapping this witness redeem script\"},\n-                        }},\n-                    }\n-                },\n-                RPCExamples{\n-                    HelpExampleCli(\"decodescript\", \"\\\"hexstring\\\"\")\n-            + HelpExampleRpc(\"decodescript\", \"\\\"hexstring\\\"\")\n-                },\n+    return RPCHelpMan{\n+        \"decodescript\",\n+        \"\\nDecode a hex-encoded script.\\n\",\n+        {\n+            {\"hexstring\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"the hex-encoded script\"},\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+            {\n+                {RPCResult::Type::STR, \"asm\", \"Script public key\"},\n+                {RPCResult::Type::STR, \"type\", \"The output type (e.g. \" + GetAllOutputTypes() + \")\"},\n+                {RPCResult::Type::STR, \"address\", /* optional */ true, \"The Bitcoin address (only if a well-defined address exists)\"},\n+                {RPCResult::Type::STR, \"p2sh\", /*optional=*/true,",
    "path": "src/rpc/rawtransaction.cpp",
    "position": 42,
    "original_position": 42,
    "commit_id": "fa0aec30e2242ee6c3d859314352384c1b21e806",
    "original_commit_id": "8888154aae367f9c2cbf78ebf7c301d1673f975a",
    "user": {
      "login": "katesalazar",
      "id": 52637275,
      "node_id": "MDQ6VXNlcjUyNjM3Mjc1",
      "avatar_url": "https://avatars.githubusercontent.com/u/52637275?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/katesalazar",
      "html_url": "https://github.com/katesalazar",
      "followers_url": "https://api.github.com/users/katesalazar/followers",
      "following_url": "https://api.github.com/users/katesalazar/following{/other_user}",
      "gists_url": "https://api.github.com/users/katesalazar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/katesalazar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/katesalazar/subscriptions",
      "organizations_url": "https://api.github.com/users/katesalazar/orgs",
      "repos_url": "https://api.github.com/users/katesalazar/repos",
      "events_url": "https://api.github.com/users/katesalazar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/katesalazar/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Why this line departs from the comment style around?",
    "created_at": "2021-11-11T16:26:11Z",
    "updated_at": "2021-11-11T16:26:11Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r747643612",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/747643612"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r747643612"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/747643612/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 550,
    "original_line": 550,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/747645500",
    "pull_request_review_id": 803992025,
    "id": 747645500,
    "node_id": "PRRC_kwDOABII584skCo8",
    "diff_hunk": "@@ -535,32 +535,35 @@ static std::string GetAllOutputTypes()\n \n static RPCHelpMan decodescript()\n {\n-    return RPCHelpMan{\"decodescript\",\n-                \"\\nDecode a hex-encoded script.\\n\",\n-                {\n-                    {\"hexstring\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"the hex-encoded script\"},\n-                },\n-                RPCResult{\n-                    RPCResult::Type::OBJ, \"\", \"\",\n-                    {\n-                        {RPCResult::Type::STR, \"asm\", \"Script public key\"},\n-                        {RPCResult::Type::STR, \"type\", \"The output type (e.g. \"+GetAllOutputTypes()+\")\"},\n-                        {RPCResult::Type::STR, \"address\", /* optional */ true, \"The Bitcoin address (only if a well-defined address exists)\"},\n-                        {RPCResult::Type::STR, \"p2sh\", /* optional */ true, \"address of P2SH script wrapping this redeem script (not returned if the script is already a P2SH)\"},\n-                        {RPCResult::Type::OBJ, \"segwit\", /* optional */ true, \"Result of a witness script public key wrapping this redeem script (not returned if the script is a P2SH or witness)\",\n-                        {\n-                            {RPCResult::Type::STR, \"asm\", \"String representation of the script public key\"},\n-                            {RPCResult::Type::STR_HEX, \"hex\", \"Hex string of the script public key\"},\n-                            {RPCResult::Type::STR, \"type\", \"The type of the script public key (e.g. witness_v0_keyhash or witness_v0_scripthash)\"},\n-                            {RPCResult::Type::STR, \"address\", /* optional */ true, \"The Bitcoin address (only if a well-defined address exists)\"},\n-                            {RPCResult::Type::STR, \"p2sh-segwit\", \"address of the P2SH script wrapping this witness redeem script\"},\n-                        }},\n-                    }\n-                },\n-                RPCExamples{\n-                    HelpExampleCli(\"decodescript\", \"\\\"hexstring\\\"\")\n-            + HelpExampleRpc(\"decodescript\", \"\\\"hexstring\\\"\")\n-                },\n+    return RPCHelpMan{\n+        \"decodescript\",\n+        \"\\nDecode a hex-encoded script.\\n\",\n+        {\n+            {\"hexstring\", RPCArg::Type::STR_HEX, RPCArg::Optional::NO, \"the hex-encoded script\"},\n+        },\n+        RPCResult{\n+            RPCResult::Type::OBJ, \"\", \"\",\n+            {\n+                {RPCResult::Type::STR, \"asm\", \"Script public key\"},\n+                {RPCResult::Type::STR, \"type\", \"The output type (e.g. \" + GetAllOutputTypes() + \")\"},\n+                {RPCResult::Type::STR, \"address\", /* optional */ true, \"The Bitcoin address (only if a well-defined address exists)\"},\n+                {RPCResult::Type::STR, \"p2sh\", /*optional=*/true,",
    "path": "src/rpc/rawtransaction.cpp",
    "position": 42,
    "original_position": 42,
    "commit_id": "fa0aec30e2242ee6c3d859314352384c1b21e806",
    "original_commit_id": "8888154aae367f9c2cbf78ebf7c301d1673f975a",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I updated the style for the `p2sh` field because I changed the description for it. See https://github.com/bitcoin/bitcoin/pull/23437#discussion_r743438724",
    "created_at": "2021-11-11T16:28:33Z",
    "updated_at": "2021-11-11T16:28:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r747645500",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/747645500"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r747645500"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/747645500/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 550,
    "original_line": 550,
    "side": "RIGHT",
    "in_reply_to_id": 747643612
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748575997",
    "pull_request_review_id": 805213408,
    "id": 748575997,
    "node_id": "PRRC_kwDOABII584snlz9",
    "diff_hunk": "@@ -578,9 +580,8 @@ static RPCHelpMan decodescript()\n \n     const std::string type{find_value(r, \"type\").get_str()};\n \n-    if (type == \"scripthash\") {\n-        // P2SH cannot be wrapped in a P2SH. If this script is already a P2SH,\n-        // don't return the address for a P2SH of the P2SH.\n+    if (type == \"scripthash\" || type == \"witness_v1_taproot\") {",
    "path": "src/rpc/rawtransaction.cpp",
    "position": null,
    "original_position": 18,
    "commit_id": "fa0aec30e2242ee6c3d859314352384c1b21e806",
    "original_commit_id": "fa1c1f417ef97d15331f4a13b40be9e00ecdb464",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In fa1c1f417ef97d15331f4a13b40be9e00ecdb464 \"rpc: Avoid returning P2SH for witness_v1_taproot in decodescript\"\r\n\r\nI think it would be more future proof to disallow P2SH wrapping for witness v1+ scripts. If this did `IsWitnessProgram` and checked the version was not 0, then this could be futureproofed. Otherwise this list would need to be updated for every new witness version). Doing it in this way would also allow passing a higher witness version script to `decodescript` and not get a p2sh wrapped result.",
    "created_at": "2021-11-12T20:45:52Z",
    "updated_at": "2021-11-12T20:45:56Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r748575997",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748575997"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r748575997"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748575997/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 583,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748821648",
    "pull_request_review_id": 805445192,
    "id": 748821648,
    "node_id": "PRRC_kwDOABII584sohyQ",
    "diff_hunk": "@@ -578,9 +580,8 @@ static RPCHelpMan decodescript()\n \n     const std::string type{find_value(r, \"type\").get_str()};\n \n-    if (type == \"scripthash\") {\n-        // P2SH cannot be wrapped in a P2SH. If this script is already a P2SH,\n-        // don't return the address for a P2SH of the P2SH.\n+    if (type == \"scripthash\" || type == \"witness_v1_taproot\") {",
    "path": "src/rpc/rawtransaction.cpp",
    "position": null,
    "original_position": 18,
    "commit_id": "fa0aec30e2242ee6c3d859314352384c1b21e806",
    "original_commit_id": "fa1c1f417ef97d15331f4a13b40be9e00ecdb464",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Good point. It is unlikely that a future witness version will be wrappable, so the least maintenance effort would be to disallow all except v0.",
    "created_at": "2021-11-14T08:43:05Z",
    "updated_at": "2021-11-14T08:43:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r748821648",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748821648"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r748821648"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748821648/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 583,
    "side": "RIGHT",
    "in_reply_to_id": 748575997
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748835511",
    "pull_request_review_id": 805456230,
    "id": 748835511,
    "node_id": "PRRC_kwDOABII584solK3",
    "diff_hunk": "@@ -578,9 +580,8 @@ static RPCHelpMan decodescript()\n \n     const std::string type{find_value(r, \"type\").get_str()};\n \n-    if (type == \"scripthash\") {\n-        // P2SH cannot be wrapped in a P2SH. If this script is already a P2SH,\n-        // don't return the address for a P2SH of the P2SH.\n+    if (type == \"scripthash\" || type == \"witness_v1_taproot\") {",
    "path": "src/rpc/rawtransaction.cpp",
    "position": null,
    "original_position": 18,
    "commit_id": "fa0aec30e2242ee6c3d859314352384c1b21e806",
    "original_commit_id": "fa1c1f417ef97d15331f4a13b40be9e00ecdb464",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I am thinking about also skipping P2SH for OP_RETURN data outputs",
    "created_at": "2021-11-14T10:44:40Z",
    "updated_at": "2021-11-14T10:44:40Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r748835511",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748835511"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r748835511"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748835511/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 583,
    "side": "RIGHT",
    "in_reply_to_id": 748575997
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748870232",
    "pull_request_review_id": 805485520,
    "id": 748870232,
    "node_id": "PRRC_kwDOABII584sotpY",
    "diff_hunk": "@@ -578,9 +580,8 @@ static RPCHelpMan decodescript()\n \n     const std::string type{find_value(r, \"type\").get_str()};\n \n-    if (type == \"scripthash\") {\n-        // P2SH cannot be wrapped in a P2SH. If this script is already a P2SH,\n-        // don't return the address for a P2SH of the P2SH.\n+    if (type == \"scripthash\" || type == \"witness_v1_taproot\") {",
    "path": "src/rpc/rawtransaction.cpp",
    "position": null,
    "original_position": 18,
    "commit_id": "fa0aec30e2242ee6c3d859314352384c1b21e806",
    "original_commit_id": "fa1c1f417ef97d15331f4a13b40be9e00ecdb464",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> I am thinking about also skipping P2SH for OP_RETURN data outputs\r\n\r\nI think that is reasonable as OP_RETURN in a P2SH is also unspendable.",
    "created_at": "2021-11-14T15:28:52Z",
    "updated_at": "2021-11-14T15:28:52Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r748870232",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748870232"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r748870232"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748870232/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 583,
    "side": "RIGHT",
    "in_reply_to_id": 748575997
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748870964",
    "pull_request_review_id": 805486089,
    "id": 748870964,
    "node_id": "PRRC_kwDOABII584sot00",
    "diff_hunk": "@@ -578,10 +579,10 @@ static RPCHelpMan decodescript()\n \n     std::vector<std::vector<unsigned char>> solutions_data;\n     const TxoutType which_type{Solver(script, solutions_data)};\n+    const bool is_witness_v0{which_type == TxoutType::WITNESS_V0_KEYHASH || which_type == TxoutType::WITNESS_V0_SCRIPTHASH};\n \n-    if (which_type == TxoutType::SCRIPTHASH) {\n-        // P2SH cannot be wrapped in a P2SH. If this script is already a P2SH,\n-        // don't return the address for a P2SH of the P2SH.\n+    if (which_type == TxoutType::SCRIPTHASH || !is_witness_v0) {",
    "path": "src/rpc/rawtransaction.cpp",
    "position": null,
    "original_position": 19,
    "commit_id": "fa0aec30e2242ee6c3d859314352384c1b21e806",
    "original_commit_id": "b9cc2008ecfe823da840dd1c321aa298f8c8bef2",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In b9cc2008ecfe823da840dd1c321aa298f8c8bef2 \"rpc: Only return P2SH wrapped witness programs for BIP141 types in de\u2026 \"\r\n\r\nThis doesn't work as it is also catching all of the legacy things that can be wrapped such as multisig, p2pkh, p2pk, etc.\r\n\r\nI think it would be better to just enumerate lists of P2SH wrappable, and P2WSH wrappable, and check against those. I doubt any additional types would be added to those lists in the future.",
    "created_at": "2021-11-14T15:35:08Z",
    "updated_at": "2021-11-14T15:35:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r748870964",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748870964"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r748870964"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748870964/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 584,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748883674",
    "pull_request_review_id": 805496491,
    "id": 748883674,
    "node_id": "PRRC_kwDOABII584sow7a",
    "diff_hunk": "@@ -578,9 +580,8 @@ static RPCHelpMan decodescript()\n \n     const std::string type{find_value(r, \"type\").get_str()};\n \n-    if (type == \"scripthash\") {\n-        // P2SH cannot be wrapped in a P2SH. If this script is already a P2SH,\n-        // don't return the address for a P2SH of the P2SH.\n+    if (type == \"scripthash\" || type == \"witness_v1_taproot\") {",
    "path": "src/rpc/rawtransaction.cpp",
    "position": null,
    "original_position": 18,
    "commit_id": "fa0aec30e2242ee6c3d859314352384c1b21e806",
    "original_commit_id": "fa1c1f417ef97d15331f4a13b40be9e00ecdb464",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Thanks, done.",
    "created_at": "2021-11-14T17:20:31Z",
    "updated_at": "2021-11-14T17:20:31Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r748883674",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748883674"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r748883674"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748883674/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 583,
    "side": "RIGHT",
    "in_reply_to_id": 748575997
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748883684",
    "pull_request_review_id": 805496500,
    "id": 748883684,
    "node_id": "PRRC_kwDOABII584sow7k",
    "diff_hunk": "@@ -578,10 +579,10 @@ static RPCHelpMan decodescript()\n \n     std::vector<std::vector<unsigned char>> solutions_data;\n     const TxoutType which_type{Solver(script, solutions_data)};\n+    const bool is_witness_v0{which_type == TxoutType::WITNESS_V0_KEYHASH || which_type == TxoutType::WITNESS_V0_SCRIPTHASH};\n \n-    if (which_type == TxoutType::SCRIPTHASH) {\n-        // P2SH cannot be wrapped in a P2SH. If this script is already a P2SH,\n-        // don't return the address for a P2SH of the P2SH.\n+    if (which_type == TxoutType::SCRIPTHASH || !is_witness_v0) {",
    "path": "src/rpc/rawtransaction.cpp",
    "position": null,
    "original_position": 19,
    "commit_id": "fa0aec30e2242ee6c3d859314352384c1b21e806",
    "original_commit_id": "b9cc2008ecfe823da840dd1c321aa298f8c8bef2",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Fixed",
    "created_at": "2021-11-14T17:20:40Z",
    "updated_at": "2021-11-14T17:20:40Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r748883684",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748883684"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r748883684"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/748883684/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 584,
    "side": "RIGHT",
    "in_reply_to_id": 748870964
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/749507992",
    "pull_request_review_id": 806315992,
    "id": 749507992,
    "node_id": "PRRC_kwDOABII584srJWY",
    "diff_hunk": "@@ -579,39 +580,66 @@ static RPCHelpMan decodescript()\n     std::vector<std::vector<unsigned char>> solutions_data;\n     const TxoutType which_type{Solver(script, solutions_data)};\n \n-    if (which_type == TxoutType::SCRIPTHASH) {\n-        // P2SH cannot be wrapped in a P2SH. If this script is already a P2SH,\n-        // don't return the address for a P2SH of the P2SH.\n+    // Check if wrapping makes sense at all\n+    switch (which_type) {\n+    case TxoutType::MULTISIG:\n+    case TxoutType::NONSTANDARD:\n+    case TxoutType::PUBKEY:\n+    case TxoutType::PUBKEYHASH:\n+    case TxoutType::WITNESS_V0_KEYHASH:\n+    case TxoutType::WITNESS_V0_SCRIPTHASH:\n+        // Can be wrapped\n+        break;\n+    case TxoutType::NULL_DATA:\n+    case TxoutType::SCRIPTHASH:\n+    case TxoutType::WITNESS_UNKNOWN:\n+    case TxoutType::WITNESS_V1_TAPROOT:\n+        // Should not be wrapped, so return early\n         return r;\n     }\n     r.pushKV(\"p2sh\", EncodeDestination(ScriptHash(script)));\n+\n     // P2SH and witness programs cannot be wrapped in P2WSH, if this script\n     // is a witness program, don't return addresses for a segwit programs.\n-    if (which_type == TxoutType::PUBKEY || which_type == TxoutType::PUBKEYHASH || which_type == TxoutType::MULTISIG || which_type == TxoutType::NONSTANDARD) {\n-        // Uncompressed pubkeys cannot be used with segwit checksigs.\n-        // If the script contains an uncompressed pubkey, skip encoding of a segwit program.\n-        if ((which_type == TxoutType::PUBKEY) || (which_type == TxoutType::MULTISIG)) {\n-            for (const auto& solution : solutions_data) {\n-                if ((solution.size() != 1) && !CPubKey(solution).IsCompressed()) {\n-                    return r;\n-                }\n+    switch (which_type) {\n+    case TxoutType::MULTISIG:\n+    case TxoutType::NONSTANDARD:\n+    case TxoutType::PUBKEY:\n+    case TxoutType::PUBKEYHASH:\n+        // Can be wrapped\n+        break;\n+    case TxoutType::NULL_DATA:\n+    case TxoutType::SCRIPTHASH:\n+    case TxoutType::WITNESS_UNKNOWN:\n+    case TxoutType::WITNESS_V0_KEYHASH:\n+    case TxoutType::WITNESS_V0_SCRIPTHASH:\n+    case TxoutType::WITNESS_V1_TAPROOT:\n+        // Should not be wrapped, so return early\n+        return r;\n+    }\n+    // Uncompressed pubkeys cannot be used with segwit checksigs.\n+    // If the script contains an uncompressed pubkey, skip encoding of a segwit program.\n+    if ((which_type == TxoutType::PUBKEY) || (which_type == TxoutType::MULTISIG)) {\n+        for (const auto& solution : solutions_data) {\n+            if ((solution.size() != 1) && !CPubKey(solution).IsCompressed()) {\n+                return r;\n             }\n         }\n-        UniValue sr(UniValue::VOBJ);\n-        CScript segwitScr;\n-        if (which_type == TxoutType::PUBKEY) {\n-            segwitScr = GetScriptForDestination(WitnessV0KeyHash(Hash160(solutions_data[0])));\n-        } else if (which_type == TxoutType::PUBKEYHASH) {\n-            segwitScr = GetScriptForDestination(WitnessV0KeyHash(uint160{solutions_data[0]}));\n-        } else {\n-            // Scripts that are not fit for P2WPKH are encoded as P2WSH.\n-            // Newer segwit program versions should be considered when then become available.\n-            segwitScr = GetScriptForDestination(WitnessV0ScriptHash(script));\n-        }\n-        ScriptPubKeyToUniv(segwitScr, sr, /* include_hex */ true);\n-        sr.pushKV(\"p2sh-segwit\", EncodeDestination(ScriptHash(segwitScr)));\n-        r.pushKV(\"segwit\", sr);\n     }\n+    UniValue sr(UniValue::VOBJ);\n+    CScript segwitScr;\n+    if (which_type == TxoutType::PUBKEY) {\n+        segwitScr = GetScriptForDestination(WitnessV0KeyHash(Hash160(solutions_data[0])));\n+    } else if (which_type == TxoutType::PUBKEYHASH) {\n+        segwitScr = GetScriptForDestination(WitnessV0KeyHash(uint160{solutions_data[0]}));\n+    } else {\n+        // Scripts that are not fit for P2WPKH are encoded as P2WSH.\n+        // Newer segwit program versions should be considered when then become available.",
    "path": "src/rpc/rawtransaction.cpp",
    "position": null,
    "original_position": 93,
    "commit_id": "fa0aec30e2242ee6c3d859314352384c1b21e806",
    "original_commit_id": "fa972d8d771c93c1d37eeb31da04e95e8e5ca0ad",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Typo: s/then/they/",
    "created_at": "2021-11-15T16:49:29Z",
    "updated_at": "2021-11-15T16:49:29Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r749507992",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/749507992"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r749507992"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/749507992/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 637,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/750588797",
    "pull_request_review_id": 807735893,
    "id": 750588797,
    "node_id": "PRRC_kwDOABII584svRN9",
    "diff_hunk": "@@ -579,39 +580,66 @@ static RPCHelpMan decodescript()\n     std::vector<std::vector<unsigned char>> solutions_data;\n     const TxoutType which_type{Solver(script, solutions_data)};\n \n-    if (which_type == TxoutType::SCRIPTHASH) {\n-        // P2SH cannot be wrapped in a P2SH. If this script is already a P2SH,\n-        // don't return the address for a P2SH of the P2SH.\n+    // Check if wrapping makes sense at all\n+    switch (which_type) {\n+    case TxoutType::MULTISIG:\n+    case TxoutType::NONSTANDARD:\n+    case TxoutType::PUBKEY:\n+    case TxoutType::PUBKEYHASH:\n+    case TxoutType::WITNESS_V0_KEYHASH:\n+    case TxoutType::WITNESS_V0_SCRIPTHASH:\n+        // Can be wrapped\n+        break;\n+    case TxoutType::NULL_DATA:\n+    case TxoutType::SCRIPTHASH:\n+    case TxoutType::WITNESS_UNKNOWN:\n+    case TxoutType::WITNESS_V1_TAPROOT:\n+        // Should not be wrapped, so return early\n         return r;\n     }\n     r.pushKV(\"p2sh\", EncodeDestination(ScriptHash(script)));\n+\n     // P2SH and witness programs cannot be wrapped in P2WSH, if this script\n     // is a witness program, don't return addresses for a segwit programs.\n-    if (which_type == TxoutType::PUBKEY || which_type == TxoutType::PUBKEYHASH || which_type == TxoutType::MULTISIG || which_type == TxoutType::NONSTANDARD) {\n-        // Uncompressed pubkeys cannot be used with segwit checksigs.\n-        // If the script contains an uncompressed pubkey, skip encoding of a segwit program.\n-        if ((which_type == TxoutType::PUBKEY) || (which_type == TxoutType::MULTISIG)) {\n-            for (const auto& solution : solutions_data) {\n-                if ((solution.size() != 1) && !CPubKey(solution).IsCompressed()) {\n-                    return r;\n-                }\n+    switch (which_type) {\n+    case TxoutType::MULTISIG:\n+    case TxoutType::NONSTANDARD:\n+    case TxoutType::PUBKEY:\n+    case TxoutType::PUBKEYHASH:\n+        // Can be wrapped\n+        break;\n+    case TxoutType::NULL_DATA:\n+    case TxoutType::SCRIPTHASH:\n+    case TxoutType::WITNESS_UNKNOWN:\n+    case TxoutType::WITNESS_V0_KEYHASH:\n+    case TxoutType::WITNESS_V0_SCRIPTHASH:\n+    case TxoutType::WITNESS_V1_TAPROOT:\n+        // Should not be wrapped, so return early\n+        return r;\n+    }\n+    // Uncompressed pubkeys cannot be used with segwit checksigs.\n+    // If the script contains an uncompressed pubkey, skip encoding of a segwit program.\n+    if ((which_type == TxoutType::PUBKEY) || (which_type == TxoutType::MULTISIG)) {\n+        for (const auto& solution : solutions_data) {\n+            if ((solution.size() != 1) && !CPubKey(solution).IsCompressed()) {\n+                return r;\n             }\n         }\n-        UniValue sr(UniValue::VOBJ);\n-        CScript segwitScr;\n-        if (which_type == TxoutType::PUBKEY) {\n-            segwitScr = GetScriptForDestination(WitnessV0KeyHash(Hash160(solutions_data[0])));\n-        } else if (which_type == TxoutType::PUBKEYHASH) {\n-            segwitScr = GetScriptForDestination(WitnessV0KeyHash(uint160{solutions_data[0]}));\n-        } else {\n-            // Scripts that are not fit for P2WPKH are encoded as P2WSH.\n-            // Newer segwit program versions should be considered when then become available.\n-            segwitScr = GetScriptForDestination(WitnessV0ScriptHash(script));\n-        }\n-        ScriptPubKeyToUniv(segwitScr, sr, /* include_hex */ true);\n-        sr.pushKV(\"p2sh-segwit\", EncodeDestination(ScriptHash(segwitScr)));\n-        r.pushKV(\"segwit\", sr);\n     }\n+    UniValue sr(UniValue::VOBJ);\n+    CScript segwitScr;\n+    if (which_type == TxoutType::PUBKEY) {\n+        segwitScr = GetScriptForDestination(WitnessV0KeyHash(Hash160(solutions_data[0])));\n+    } else if (which_type == TxoutType::PUBKEYHASH) {\n+        segwitScr = GetScriptForDestination(WitnessV0KeyHash(uint160{solutions_data[0]}));\n+    } else {\n+        // Scripts that are not fit for P2WPKH are encoded as P2WSH.\n+        // Newer segwit program versions should be considered when then become available.",
    "path": "src/rpc/rawtransaction.cpp",
    "position": null,
    "original_position": 93,
    "commit_id": "fa0aec30e2242ee6c3d859314352384c1b21e806",
    "original_commit_id": "fa972d8d771c93c1d37eeb31da04e95e8e5ca0ad",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Thx, removed whole sentence.",
    "created_at": "2021-11-16T19:19:32Z",
    "updated_at": "2021-11-16T19:19:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r750588797",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/750588797"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r750588797"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/750588797/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 637,
    "side": "RIGHT",
    "in_reply_to_id": 749507992
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/751522225",
    "pull_request_review_id": 808982564,
    "id": 751522225,
    "node_id": "PRRC_kwDOABII584sy1Gx",
    "diff_hunk": "@@ -579,39 +580,75 @@ static RPCHelpMan decodescript()\n     std::vector<std::vector<unsigned char>> solutions_data;\n     const TxoutType which_type{Solver(script, solutions_data)};\n \n-    if (which_type == TxoutType::SCRIPTHASH) {\n-        // P2SH cannot be wrapped in a P2SH. If this script is already a P2SH,\n-        // don't return the address for a P2SH of the P2SH.\n+    // Check if wrapping makes sense at all\n+    switch (which_type) {\n+    case TxoutType::MULTISIG:\n+    case TxoutType::NONSTANDARD:\n+    case TxoutType::PUBKEY:\n+    case TxoutType::PUBKEYHASH:\n+    case TxoutType::WITNESS_V0_KEYHASH:\n+    case TxoutType::WITNESS_V0_SCRIPTHASH:\n+        // Can be wrapped\n+        break;\n+    case TxoutType::NULL_DATA:\n+    case TxoutType::SCRIPTHASH:\n+    case TxoutType::WITNESS_UNKNOWN:\n+    case TxoutType::WITNESS_V1_TAPROOT:\n+        // Should not be wrapped, so return early\n         return r;\n     }\n+    if (!script.HasValidOps() || script.IsUnspendable()) {\n+        return false;\n+    }\n+    for (CScript::const_iterator it{script.begin()}; it != script.end();) {\n+        opcodetype op;\n+        CHECK_NONFATAL(script.GetOp(it, op));\n+        if (op == OP_CHECKSIGADD || IsOpSuccess(op)) {\n+            return false;",
    "path": "src/rpc/rawtransaction.cpp",
    "position": null,
    "original_position": 41,
    "commit_id": "fa0aec30e2242ee6c3d859314352384c1b21e806",
    "original_commit_id": "fa200104235398a0c507122b95e0899022650be0",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In fa200104235398a0c507122b95e0899022650be0 \"rpc: Only allow specific types to be P2(W)SH wrapped in decodescript\"\r\n\r\nReturning false here is incorrect. If a script contained Taproot opcodes, we still want to decode them, we just don't want to get it wrapped in any addresses.\r\n\r\nThis also results in the following error scripts containing `OP_CHECKSIGADD` and `OP_SUCCESSx`:\r\n\r\n```\r\n> src/bitcoin-cli -regtest decodescript 20393ea2d59e5565796ef02e1f91d5efe0577be63e5cf460503009c01d368c7aebba\r\nerror code: -1\r\nerror message:\r\nrpc/util.cpp:577 (HandleRequest)\r\nInternal bug detected: 'std::any_of(m_results.m_results.begin(), m_results.m_results.end(), [ret](const RPCResult& res) { return res.MatchesType(ret); })'\r\nYou may report this issue here: https://github.com/bitcoin/bitcoin/issues\r\n```",
    "created_at": "2021-11-17T18:22:14Z",
    "updated_at": "2021-11-17T19:27:05Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r751522225",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/751522225"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r751522225"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/751522225/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 607,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/751527130",
    "pull_request_review_id": 808982564,
    "id": 751527130,
    "node_id": "PRRC_kwDOABII584sy2Ta",
    "diff_hunk": "@@ -579,39 +580,75 @@ static RPCHelpMan decodescript()\n     std::vector<std::vector<unsigned char>> solutions_data;\n     const TxoutType which_type{Solver(script, solutions_data)};\n \n-    if (which_type == TxoutType::SCRIPTHASH) {\n-        // P2SH cannot be wrapped in a P2SH. If this script is already a P2SH,\n-        // don't return the address for a P2SH of the P2SH.\n+    // Check if wrapping makes sense at all\n+    switch (which_type) {\n+    case TxoutType::MULTISIG:\n+    case TxoutType::NONSTANDARD:\n+    case TxoutType::PUBKEY:\n+    case TxoutType::PUBKEYHASH:\n+    case TxoutType::WITNESS_V0_KEYHASH:\n+    case TxoutType::WITNESS_V0_SCRIPTHASH:\n+        // Can be wrapped\n+        break;\n+    case TxoutType::NULL_DATA:\n+    case TxoutType::SCRIPTHASH:\n+    case TxoutType::WITNESS_UNKNOWN:\n+    case TxoutType::WITNESS_V1_TAPROOT:\n+        // Should not be wrapped, so return early\n         return r;\n     }\n+    if (!script.HasValidOps() || script.IsUnspendable()) {\n+        return false;",
    "path": "src/rpc/rawtransaction.cpp",
    "position": null,
    "original_position": 35,
    "commit_id": "fa0aec30e2242ee6c3d859314352384c1b21e806",
    "original_commit_id": "fa200104235398a0c507122b95e0899022650be0",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In fa200104235398a0c507122b95e0899022650be0 \"rpc: Only allow specific types to be P2(W)SH wrapped in decodescript\"\r\n\r\nReturning false here is incorrect. If a script contained invalid opcodes or is otherwise unspendable, we still want to decode them, we just don't want to get it wrapped in any addresses\r\n\r\nAny such scripts would result in an error similar to the following:\r\n\r\n```\r\n> src/bitcoin-cli -regtest decodescript 20393ea2d59e5565796ef02e1f91d5efe0577be63e5cf460503009c01d368c7aebba\r\nerror code: -1\r\nerror message:\r\nrpc/util.cpp:577 (HandleRequest)\r\nInternal bug detected: 'std::any_of(m_results.m_results.begin(), m_results.m_results.end(), [ret](const RPCResult& res) { return res.MatchesType(ret); })'\r\nYou may report this issue here: https://github.com/bitcoin/bitcoin/issues\r\n```\r\n\r\nThere appears to be a separate bug(?) where `OP_SUCESSx` and `OP_CHECKSIGADD` are being caught by this condition too.",
    "created_at": "2021-11-17T18:28:37Z",
    "updated_at": "2021-11-17T19:27:14Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r751527130",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/751527130"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r751527130"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/751527130/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 601,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754247593",
    "pull_request_review_id": 812497464,
    "id": 754247593,
    "node_id": "PRRC_kwDOABII584s9Oep",
    "diff_hunk": "@@ -579,39 +580,75 @@ static RPCHelpMan decodescript()\n     std::vector<std::vector<unsigned char>> solutions_data;\n     const TxoutType which_type{Solver(script, solutions_data)};\n \n-    if (which_type == TxoutType::SCRIPTHASH) {\n-        // P2SH cannot be wrapped in a P2SH. If this script is already a P2SH,\n-        // don't return the address for a P2SH of the P2SH.\n+    // Check if wrapping makes sense at all\n+    switch (which_type) {\n+    case TxoutType::MULTISIG:\n+    case TxoutType::NONSTANDARD:\n+    case TxoutType::PUBKEY:\n+    case TxoutType::PUBKEYHASH:\n+    case TxoutType::WITNESS_V0_KEYHASH:\n+    case TxoutType::WITNESS_V0_SCRIPTHASH:\n+        // Can be wrapped\n+        break;\n+    case TxoutType::NULL_DATA:\n+    case TxoutType::SCRIPTHASH:\n+    case TxoutType::WITNESS_UNKNOWN:\n+    case TxoutType::WITNESS_V1_TAPROOT:\n+        // Should not be wrapped, so return early\n         return r;\n     }\n+    if (!script.HasValidOps() || script.IsUnspendable()) {\n+        return false;\n+    }\n+    for (CScript::const_iterator it{script.begin()}; it != script.end();) {\n+        opcodetype op;\n+        CHECK_NONFATAL(script.GetOp(it, op));\n+        if (op == OP_CHECKSIGADD || IsOpSuccess(op)) {\n+            return false;",
    "path": "src/rpc/rawtransaction.cpp",
    "position": null,
    "original_position": 41,
    "commit_id": "fa0aec30e2242ee6c3d859314352384c1b21e806",
    "original_commit_id": "fa200104235398a0c507122b95e0899022650be0",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Well that is one embarrassing typo. Force pushed `return r;`.",
    "created_at": "2021-11-22T12:54:29Z",
    "updated_at": "2021-11-22T12:54:29Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r754247593",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754247593"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r754247593"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754247593/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 607,
    "side": "RIGHT",
    "in_reply_to_id": 751522225
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754247725",
    "pull_request_review_id": 812497633,
    "id": 754247725,
    "node_id": "PRRC_kwDOABII584s9Ogt",
    "diff_hunk": "@@ -579,39 +580,75 @@ static RPCHelpMan decodescript()\n     std::vector<std::vector<unsigned char>> solutions_data;\n     const TxoutType which_type{Solver(script, solutions_data)};\n \n-    if (which_type == TxoutType::SCRIPTHASH) {\n-        // P2SH cannot be wrapped in a P2SH. If this script is already a P2SH,\n-        // don't return the address for a P2SH of the P2SH.\n+    // Check if wrapping makes sense at all\n+    switch (which_type) {\n+    case TxoutType::MULTISIG:\n+    case TxoutType::NONSTANDARD:\n+    case TxoutType::PUBKEY:\n+    case TxoutType::PUBKEYHASH:\n+    case TxoutType::WITNESS_V0_KEYHASH:\n+    case TxoutType::WITNESS_V0_SCRIPTHASH:\n+        // Can be wrapped\n+        break;\n+    case TxoutType::NULL_DATA:\n+    case TxoutType::SCRIPTHASH:\n+    case TxoutType::WITNESS_UNKNOWN:\n+    case TxoutType::WITNESS_V1_TAPROOT:\n+        // Should not be wrapped, so return early\n         return r;\n     }\n+    if (!script.HasValidOps() || script.IsUnspendable()) {\n+        return false;",
    "path": "src/rpc/rawtransaction.cpp",
    "position": null,
    "original_position": 35,
    "commit_id": "fa0aec30e2242ee6c3d859314352384c1b21e806",
    "original_commit_id": "fa200104235398a0c507122b95e0899022650be0",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Force pushed `return r;`.",
    "created_at": "2021-11-22T12:54:39Z",
    "updated_at": "2021-11-22T12:54:39Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r754247725",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754247725"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r754247725"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/754247725/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 601,
    "side": "RIGHT",
    "in_reply_to_id": 751527130
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/759596698",
    "pull_request_review_id": 819469543,
    "id": 759596698,
    "node_id": "PRRC_kwDOABII584tRoaa",
    "diff_hunk": "@@ -575,44 +578,78 @@ static RPCHelpMan decodescript()\n     }\n     ScriptPubKeyToUniv(script, r, /* include_hex */ false);\n \n-    UniValue type;\n-    type = find_value(r, \"type\");\n-\n-    if (type.isStr() && type.get_str() != \"scripthash\") {\n-        // P2SH cannot be wrapped in a P2SH. If this script is already a P2SH,\n-        // don't return the address for a P2SH of the P2SH.\n-        r.pushKV(\"p2sh\", EncodeDestination(ScriptHash(script)));\n-        // P2SH and witness programs cannot be wrapped in P2WSH, if this script\n-        // is a witness program, don't return addresses for a segwit programs.\n-        if (type.get_str() == \"pubkey\" || type.get_str() == \"pubkeyhash\" || type.get_str() == \"multisig\" || type.get_str() == \"nonstandard\") {\n-            std::vector<std::vector<unsigned char>> solutions_data;\n-            TxoutType which_type = Solver(script, solutions_data);\n-            // Uncompressed pubkeys cannot be used with segwit checksigs.\n-            // If the script contains an uncompressed pubkey, skip encoding of a segwit program.\n-            if ((which_type == TxoutType::PUBKEY) || (which_type == TxoutType::MULTISIG)) {\n-                for (const auto& solution : solutions_data) {\n-                    if ((solution.size() != 1) && !CPubKey(solution).IsCompressed()) {\n-                        return r;\n-                    }\n-                }\n-            }\n-            UniValue sr(UniValue::VOBJ);\n-            CScript segwitScr;\n-            if (which_type == TxoutType::PUBKEY) {\n-                segwitScr = GetScriptForDestination(WitnessV0KeyHash(Hash160(solutions_data[0])));\n-            } else if (which_type == TxoutType::PUBKEYHASH) {\n-                segwitScr = GetScriptForDestination(WitnessV0KeyHash(uint160{solutions_data[0]}));\n-            } else {\n-                // Scripts that are not fit for P2WPKH are encoded as P2WSH.\n-                // Newer segwit program versions should be considered when then become available.\n-                segwitScr = GetScriptForDestination(WitnessV0ScriptHash(script));\n+    std::vector<std::vector<unsigned char>> solutions_data;\n+    const TxoutType which_type{Solver(script, solutions_data)};\n+\n+    // Check if wrapping makes sense at all\n+    switch (which_type) {\n+    case TxoutType::MULTISIG:\n+    case TxoutType::NONSTANDARD:\n+    case TxoutType::PUBKEY:\n+    case TxoutType::PUBKEYHASH:\n+    case TxoutType::WITNESS_V0_KEYHASH:\n+    case TxoutType::WITNESS_V0_SCRIPTHASH:\n+        // Can be wrapped\n+        break;\n+    case TxoutType::NULL_DATA:\n+    case TxoutType::SCRIPTHASH:\n+    case TxoutType::WITNESS_UNKNOWN:",
    "path": "src/rpc/rawtransaction.cpp",
    "position": 112,
    "original_position": 112,
    "commit_id": "fa0aec30e2242ee6c3d859314352384c1b21e806",
    "original_commit_id": "fa0aec30e2242ee6c3d859314352384c1b21e806",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Isn't it TBD if future witnesses can be wrapped? Though maybe too unlikely to matter...",
    "created_at": "2021-11-30T19:31:23Z",
    "updated_at": "2021-11-30T19:31:31Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r759596698",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/759596698"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r759596698"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/759596698/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 596,
    "original_line": 596,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/759597391",
    "pull_request_review_id": 819470514,
    "id": 759597391,
    "node_id": "PRRC_kwDOABII584tRolP",
    "diff_hunk": "@@ -575,44 +578,78 @@ static RPCHelpMan decodescript()\n     }\n     ScriptPubKeyToUniv(script, r, /* include_hex */ false);\n \n-    UniValue type;\n-    type = find_value(r, \"type\");\n-\n-    if (type.isStr() && type.get_str() != \"scripthash\") {\n-        // P2SH cannot be wrapped in a P2SH. If this script is already a P2SH,\n-        // don't return the address for a P2SH of the P2SH.\n-        r.pushKV(\"p2sh\", EncodeDestination(ScriptHash(script)));\n-        // P2SH and witness programs cannot be wrapped in P2WSH, if this script\n-        // is a witness program, don't return addresses for a segwit programs.\n-        if (type.get_str() == \"pubkey\" || type.get_str() == \"pubkeyhash\" || type.get_str() == \"multisig\" || type.get_str() == \"nonstandard\") {\n-            std::vector<std::vector<unsigned char>> solutions_data;\n-            TxoutType which_type = Solver(script, solutions_data);\n-            // Uncompressed pubkeys cannot be used with segwit checksigs.\n-            // If the script contains an uncompressed pubkey, skip encoding of a segwit program.\n-            if ((which_type == TxoutType::PUBKEY) || (which_type == TxoutType::MULTISIG)) {\n-                for (const auto& solution : solutions_data) {\n-                    if ((solution.size() != 1) && !CPubKey(solution).IsCompressed()) {\n-                        return r;\n-                    }\n-                }\n-            }\n-            UniValue sr(UniValue::VOBJ);\n-            CScript segwitScr;\n-            if (which_type == TxoutType::PUBKEY) {\n-                segwitScr = GetScriptForDestination(WitnessV0KeyHash(Hash160(solutions_data[0])));\n-            } else if (which_type == TxoutType::PUBKEYHASH) {\n-                segwitScr = GetScriptForDestination(WitnessV0KeyHash(uint160{solutions_data[0]}));\n-            } else {\n-                // Scripts that are not fit for P2WPKH are encoded as P2WSH.\n-                // Newer segwit program versions should be considered when then become available.\n-                segwitScr = GetScriptForDestination(WitnessV0ScriptHash(script));\n+    std::vector<std::vector<unsigned char>> solutions_data;\n+    const TxoutType which_type{Solver(script, solutions_data)};\n+\n+    // Check if wrapping makes sense at all\n+    switch (which_type) {\n+    case TxoutType::MULTISIG:\n+    case TxoutType::NONSTANDARD:\n+    case TxoutType::PUBKEY:\n+    case TxoutType::PUBKEYHASH:\n+    case TxoutType::WITNESS_V0_KEYHASH:\n+    case TxoutType::WITNESS_V0_SCRIPTHASH:\n+        // Can be wrapped\n+        break;\n+    case TxoutType::NULL_DATA:\n+    case TxoutType::SCRIPTHASH:\n+    case TxoutType::WITNESS_UNKNOWN:\n+    case TxoutType::WITNESS_V1_TAPROOT:\n+        // Should not be wrapped, so return early\n+        return r;",
    "path": "src/rpc/rawtransaction.cpp",
    "position": 115,
    "original_position": 115,
    "commit_id": "fa0aec30e2242ee6c3d859314352384c1b21e806",
    "original_commit_id": "fa0aec30e2242ee6c3d859314352384c1b21e806",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Not sure this \"return early\" is a good approach. Seems like it would be better to have a conditional block.",
    "created_at": "2021-11-30T19:32:25Z",
    "updated_at": "2021-11-30T19:32:25Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r759597391",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/759597391"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r759597391"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/759597391/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 599,
    "original_line": 599,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/759602525",
    "pull_request_review_id": 819477644,
    "id": 759602525,
    "node_id": "PRRC_kwDOABII584tRp1d",
    "diff_hunk": "@@ -575,44 +578,78 @@ static RPCHelpMan decodescript()\n     }\n     ScriptPubKeyToUniv(script, r, /* include_hex */ false);\n \n-    UniValue type;\n-    type = find_value(r, \"type\");\n-\n-    if (type.isStr() && type.get_str() != \"scripthash\") {\n-        // P2SH cannot be wrapped in a P2SH. If this script is already a P2SH,\n-        // don't return the address for a P2SH of the P2SH.\n-        r.pushKV(\"p2sh\", EncodeDestination(ScriptHash(script)));\n-        // P2SH and witness programs cannot be wrapped in P2WSH, if this script\n-        // is a witness program, don't return addresses for a segwit programs.\n-        if (type.get_str() == \"pubkey\" || type.get_str() == \"pubkeyhash\" || type.get_str() == \"multisig\" || type.get_str() == \"nonstandard\") {\n-            std::vector<std::vector<unsigned char>> solutions_data;\n-            TxoutType which_type = Solver(script, solutions_data);\n-            // Uncompressed pubkeys cannot be used with segwit checksigs.\n-            // If the script contains an uncompressed pubkey, skip encoding of a segwit program.\n-            if ((which_type == TxoutType::PUBKEY) || (which_type == TxoutType::MULTISIG)) {\n-                for (const auto& solution : solutions_data) {\n-                    if ((solution.size() != 1) && !CPubKey(solution).IsCompressed()) {\n-                        return r;\n-                    }\n-                }\n-            }\n-            UniValue sr(UniValue::VOBJ);\n-            CScript segwitScr;\n-            if (which_type == TxoutType::PUBKEY) {\n-                segwitScr = GetScriptForDestination(WitnessV0KeyHash(Hash160(solutions_data[0])));\n-            } else if (which_type == TxoutType::PUBKEYHASH) {\n-                segwitScr = GetScriptForDestination(WitnessV0KeyHash(uint160{solutions_data[0]}));\n-            } else {\n-                // Scripts that are not fit for P2WPKH are encoded as P2WSH.\n-                // Newer segwit program versions should be considered when then become available.\n-                segwitScr = GetScriptForDestination(WitnessV0ScriptHash(script));\n+    std::vector<std::vector<unsigned char>> solutions_data;\n+    const TxoutType which_type{Solver(script, solutions_data)};\n+\n+    // Check if wrapping makes sense at all\n+    switch (which_type) {\n+    case TxoutType::MULTISIG:\n+    case TxoutType::NONSTANDARD:\n+    case TxoutType::PUBKEY:\n+    case TxoutType::PUBKEYHASH:\n+    case TxoutType::WITNESS_V0_KEYHASH:\n+    case TxoutType::WITNESS_V0_SCRIPTHASH:\n+        // Can be wrapped\n+        break;\n+    case TxoutType::NULL_DATA:\n+    case TxoutType::SCRIPTHASH:\n+    case TxoutType::WITNESS_UNKNOWN:",
    "path": "src/rpc/rawtransaction.cpp",
    "position": 112,
    "original_position": 112,
    "commit_id": "fa0aec30e2242ee6c3d859314352384c1b21e806",
    "original_commit_id": "fa0aec30e2242ee6c3d859314352384c1b21e806",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It is possible but unlikely. In that case you need to upgrade to a version of Bitcoin Core that \"understands\" the witness program to wrap it.",
    "created_at": "2021-11-30T19:39:52Z",
    "updated_at": "2021-11-30T19:39:52Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r759602525",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/759602525"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23486#discussion_r759602525"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23486"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/759602525/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 596,
    "original_line": 596,
    "side": "RIGHT",
    "in_reply_to_id": 759596698
  }
]