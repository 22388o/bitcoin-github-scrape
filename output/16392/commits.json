[
  {
    "sha": "1de8c067c74cd171144c8a900a8a20efe3072c43",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxZGU4YzA2N2M3NGNkMTcxMTQ0YzhhOTAwYThhMjBlZmUzMDcyYzQz",
    "commit": {
      "author": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2019-06-03T15:11:05Z"
      },
      "committer": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2020-02-03T11:49:46Z"
      },
      "message": "depends: clang 6.0.1\n\nThis also removes some now-unnecessary cctools hacks.\n\nCo-Authored-By: Cory Fields <cory-nospam-@coryfields.com>",
      "tree": {
        "sha": "2c6c7ff322302376f1b56953f1edc8ae136b532d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2c6c7ff322302376f1b56953f1edc8ae136b532d"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1de8c067c74cd171144c8a900a8a20efe3072c43",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz7FuIclQ9n+pXlWPLuufXMCVJsEFAl44CNoACgkQLuufXMCV\nJsEtEBAAlz+w8zAPMQzMnKZjnbKHxz8CHJBl75kN4leLLpgrfaNSws+yWkK6gmn/\nD8vyEDOy/Xe8iuO1xe+fAsetZI68p/PhwPUP6ofp4/VDNzgRJ14ble45AqTIlQUR\niEcNll7/PoPnAooLspSoJmRmRY3OS/FTasAre3Ts2NbEYVt9BlcxhwsGhovWerjl\njnUX6FPl37kej7bmrXds6fltJhys8aNJUUeapgU6VyQz14MAuHatuJaDw98pR6+i\nnekIGdJX5uxxL9HKi32DaLpdnX9Qp3sZ4Ug9JVf8/rq/9zcrxy+v7SbmzDZmvycn\nAO7EhxYKRIKDkCMd2cZw6cnCGgdxwrGQYwPFC/ZQAn12tNWZHYhHtu33ZHt1DYIu\nNVXTSLzORTFOg8kaFF1ZXRsJJYyl/3hPCX6mNM3cViyu3PYAK08WOzagYFp8Y17g\nHaWX9s9cj+lMEUJZYp0+YVosnKFYCxsjGlD8hAAXo/6/ONS3uGZHj7myFUh691LW\njFYK4H11YTsMaMKB3NUjGaisLCR7ugmLe+QtOy8NUugyN79aJmXuVu3q3BTc1+WN\nCxdm31dD0d/G0xL6skfsd/vDuFCtvGPupZR9kqGVZXrQL/DjCOqEeqZzgxty5Ex7\n5yM1FZHt+W8ko0qp3v5xjGJYgng7RFxmQ6lAeJC4ENj5blmoLFM=\n=1T9e\n-----END PGP SIGNATURE-----",
        "payload": "tree 2c6c7ff322302376f1b56953f1edc8ae136b532d\nparent 651e34388832149402fea0d26f3dc13bbe197f5a\nauthor fanquake <fanquake@gmail.com> 1559574665 -0400\ncommitter fanquake <fanquake@gmail.com> 1580730586 +0800\n\ndepends: clang 6.0.1\n\nThis also removes some now-unnecessary cctools hacks.\n\nCo-Authored-By: Cory Fields <cory-nospam-@coryfields.com>\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1de8c067c74cd171144c8a900a8a20efe3072c43",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/1de8c067c74cd171144c8a900a8a20efe3072c43",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1de8c067c74cd171144c8a900a8a20efe3072c43/comments",
    "author": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "651e34388832149402fea0d26f3dc13bbe197f5a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/651e34388832149402fea0d26f3dc13bbe197f5a",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/651e34388832149402fea0d26f3dc13bbe197f5a"
      }
    ],
    "stats": {
      "total": 11,
      "additions": 4,
      "deletions": 7
    },
    "files": [
      {
        "sha": "833787a213082662f300369bfcd273506995971a",
        "filename": "depends/packages/native_cctools.mk",
        "status": "modified",
        "additions": 4,
        "deletions": 7,
        "changes": 11,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1de8c067c74cd171144c8a900a8a20efe3072c43/depends/packages/native_cctools.mk",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1de8c067c74cd171144c8a900a8a20efe3072c43/depends/packages/native_cctools.mk",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/packages/native_cctools.mk?ref=1de8c067c74cd171144c8a900a8a20efe3072c43",
        "patch": "@@ -4,11 +4,11 @@ $(package)_download_path=https://github.com/theuni/cctools-port/archive\n $(package)_file_name=$($(package)_version).tar.gz\n $(package)_sha256_hash=a09c9ba4684670a0375e42d9d67e7f12c1f62581a27f28f7c825d6d7032ccc6a\n $(package)_build_subdir=cctools\n-$(package)_clang_version=3.7.1\n-$(package)_clang_download_path=https://llvm.org/releases/$($(package)_clang_version)\n+$(package)_clang_version=6.0.1\n+$(package)_clang_download_path=https://releases.llvm.org/$($(package)_clang_version)\n $(package)_clang_download_file=clang+llvm-$($(package)_clang_version)-x86_64-linux-gnu-ubuntu-14.04.tar.xz\n $(package)_clang_file_name=clang-llvm-$($(package)_clang_version)-x86_64-linux-gnu-ubuntu-14.04.tar.xz\n-$(package)_clang_sha256_hash=99b28a6b48e793705228a390471991386daa33a9717cd9ca007fcdde69608fd9\n+$(package)_clang_sha256_hash=fa5416553ca94a8c071a27134c094a5fb736fe1bd0ecc5ef2d9bc02754e1bef0\n $(package)_extra_sources=$($(package)_clang_file_name)\n \n define $(package)_fetch_cmds\n@@ -21,12 +21,9 @@ define $(package)_extract_cmds\n   echo \"$($(package)_sha256_hash)  $($(package)_source)\" > $($(package)_extract_dir)/.$($(package)_file_name).hash && \\\n   echo \"$($(package)_clang_sha256_hash)  $($(package)_source_dir)/$($(package)_clang_file_name)\" >> $($(package)_extract_dir)/.$($(package)_file_name).hash && \\\n   $(build_SHA256SUM) -c $($(package)_extract_dir)/.$($(package)_file_name).hash && \\\n-  mkdir -p toolchain/bin toolchain/lib/clang/3.5/include && \\\n+  mkdir -p toolchain/bin toolchain/lib/clang/$($(package)_clang_version)/include && \\\n   tar --no-same-owner --strip-components=1 -C toolchain -xf $($(package)_source_dir)/$($(package)_clang_file_name) && \\\n   rm -f toolchain/lib/libc++abi.so* && \\\n-  echo \"#!/bin/sh\" > toolchain/bin/$(host)-dsymutil && \\\n-  echo \"exit 0\" >> toolchain/bin/$(host)-dsymutil && \\\n-  chmod +x toolchain/bin/$(host)-dsymutil && \\\n   tar --no-same-owner --strip-components=1 -xf $($(package)_source)\n endef\n "
      }
    ]
  },
  {
    "sha": "ca5055a5aa07aba81a87cf12f6f0526a63c423b5",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpjYTUwNTVhNWFhMDdhYmE4MWE4N2NmMTJmNmYwNTI2YTYzYzQyM2I1",
    "commit": {
      "author": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2019-07-14T05:33:39Z"
      },
      "committer": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2020-02-03T11:49:46Z"
      },
      "message": "depends: native_cctools 921, ld64 409.12, libtapi 1000.10.8\n\nThis also removes the obsolete mlinker-version option\n\nCo-Authored-By: Cory Fields <cory-nospam-@coryfields.com>",
      "tree": {
        "sha": "2486e95d5650848788aeaa8cdb7be72969e154b0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2486e95d5650848788aeaa8cdb7be72969e154b0"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ca5055a5aa07aba81a87cf12f6f0526a63c423b5",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz7FuIclQ9n+pXlWPLuufXMCVJsEFAl44CNoACgkQLuufXMCV\nJsFYAg//TzXBJR53ezb6+pKivTfyYAPJZUyOwNrlJSG404hhe+4jE8wd8HpyFZrl\nYu1SfaVihEkdiPoQb2szL6foyHikiE9Xielo6r3qfO29M0skQQKeDXEEliR+Sk0W\nIDeFDvnC7WiGLc0qOiXXVl447kRDEsbMnwWyeEynLNAF2e3nYQ4MvEiYxCz7pAwR\nvaqlTjNGfiHCU2whiEDlyuP4o08dXgoYZFPgEzrEEMEUb9odgvWvIoSfQMHmbPXo\nj2T9SGmuEOwtpal0NOykI/QW4SFT26conXsiDcKjwmxa6+ePTHLMpwiU1amRI3nL\nig2r70hhFtR2AqaOqQ7ORsL3dzS4aZ0XhKBZ2kim4xVFrZFndSw7ChrZsqcdzBlx\nUOaAY6yY7DfrS+OIAGXN9i8r3+VJuzPAAqVT7FQg4UaWy9VmQFKQH4//NlY7KIqW\nUM9eTrL8I/p+1OQ1ksEsTgGMAoiciBJEZzvKOcZRCKWP3DO2JSAZ/qBTuPZr+Ouv\nsTkCgZk7hDJmJVaAc9ysbAjTpmK09XY9SZJje/vmTwye2pEk5sx/MeOMNCbqvbof\n+P9m7ruL3rAfcZh8HtEU+A13dVTPpFNQJx4lbU1T0xY1pDl3cRotydYuOTNr9q34\nppZhGC6bVdPKQSQSpwPINKY/UK0gI+9n2658GqDgv1kkGBCxKQI=\n=QXA2\n-----END PGP SIGNATURE-----",
        "payload": "tree 2486e95d5650848788aeaa8cdb7be72969e154b0\nparent 1de8c067c74cd171144c8a900a8a20efe3072c43\nauthor fanquake <fanquake@gmail.com> 1563082419 +0800\ncommitter fanquake <fanquake@gmail.com> 1580730586 +0800\n\ndepends: native_cctools 921, ld64 409.12, libtapi 1000.10.8\n\nThis also removes the obsolete mlinker-version option\n\nCo-Authored-By: Cory Fields <cory-nospam-@coryfields.com>\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ca5055a5aa07aba81a87cf12f6f0526a63c423b5",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/ca5055a5aa07aba81a87cf12f6f0526a63c423b5",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ca5055a5aa07aba81a87cf12f6f0526a63c423b5/comments",
    "author": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "1de8c067c74cd171144c8a900a8a20efe3072c43",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1de8c067c74cd171144c8a900a8a20efe3072c43",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/1de8c067c74cd171144c8a900a8a20efe3072c43"
      }
    ],
    "stats": {
      "total": 44,
      "additions": 29,
      "deletions": 15
    },
    "files": [
      {
        "sha": "3968a7610001e6c1053144eb575f98c6212857e9",
        "filename": "depends/hosts/darwin.mk",
        "status": "modified",
        "additions": 2,
        "deletions": 3,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ca5055a5aa07aba81a87cf12f6f0526a63c423b5/depends/hosts/darwin.mk",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ca5055a5aa07aba81a87cf12f6f0526a63c423b5/depends/hosts/darwin.mk",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/hosts/darwin.mk?ref=ca5055a5aa07aba81a87cf12f6f0526a63c423b5",
        "patch": "@@ -1,9 +1,8 @@\n OSX_MIN_VERSION=10.12\n OSX_SDK_VERSION=10.11\n OSX_SDK=$(SDK_PATH)/MacOSX$(OSX_SDK_VERSION).sdk\n-LD64_VERSION=253.9\n-darwin_CC=clang -target $(host) -mmacosx-version-min=$(OSX_MIN_VERSION) --sysroot $(OSX_SDK) -mlinker-version=$(LD64_VERSION)\n-darwin_CXX=clang++ -target $(host) -mmacosx-version-min=$(OSX_MIN_VERSION) --sysroot $(OSX_SDK) -mlinker-version=$(LD64_VERSION) -stdlib=libc++\n+darwin_CC=clang -target $(host) -mmacosx-version-min=$(OSX_MIN_VERSION) --sysroot $(OSX_SDK)\n+darwin_CXX=clang++ -target $(host) -mmacosx-version-min=$(OSX_MIN_VERSION) --sysroot $(OSX_SDK) -stdlib=libc++\n \n darwin_CFLAGS=-pipe\n darwin_CXXFLAGS=$(darwin_CFLAGS)"
      },
      {
        "sha": "4195230b4003efac0071e416dd9c1ca1d66979e7",
        "filename": "depends/packages/native_cctools.mk",
        "status": "modified",
        "additions": 26,
        "deletions": 10,
        "changes": 36,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ca5055a5aa07aba81a87cf12f6f0526a63c423b5/depends/packages/native_cctools.mk",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ca5055a5aa07aba81a87cf12f6f0526a63c423b5/depends/packages/native_cctools.mk",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/packages/native_cctools.mk?ref=ca5055a5aa07aba81a87cf12f6f0526a63c423b5",
        "patch": "@@ -1,42 +1,55 @@\n package=native_cctools\n-$(package)_version=807d6fd1be5d2224872e381870c0a75387fe05e6\n-$(package)_download_path=https://github.com/theuni/cctools-port/archive\n+$(package)_version=3764b223c011574971ee3ae09ce968ba5dc2f00f\n+$(package)_download_path=https://github.com/tpoechtrager/cctools-port/archive\n $(package)_file_name=$($(package)_version).tar.gz\n-$(package)_sha256_hash=a09c9ba4684670a0375e42d9d67e7f12c1f62581a27f28f7c825d6d7032ccc6a\n+$(package)_sha256_hash=3e35907bf376269a844df08e03cbb43e345c88125374f2228e03724b5f9a2a04\n $(package)_build_subdir=cctools\n $(package)_clang_version=6.0.1\n $(package)_clang_download_path=https://releases.llvm.org/$($(package)_clang_version)\n $(package)_clang_download_file=clang+llvm-$($(package)_clang_version)-x86_64-linux-gnu-ubuntu-14.04.tar.xz\n $(package)_clang_file_name=clang-llvm-$($(package)_clang_version)-x86_64-linux-gnu-ubuntu-14.04.tar.xz\n $(package)_clang_sha256_hash=fa5416553ca94a8c071a27134c094a5fb736fe1bd0ecc5ef2d9bc02754e1bef0\n+\n+$(package)_libtapi_version=3efb201881e7a76a21e0554906cf306432539cef\n+$(package)_libtapi_download_path=https://github.com/tpoechtrager/apple-libtapi/archive\n+$(package)_libtapi_download_file=$($(package)_libtapi_version).tar.gz\n+$(package)_libtapi_file_name=$($(package)_libtapi_version).tar.gz\n+$(package)_libtapi_sha256_hash=380c1ca37cfa04a8699d0887a8d3ee1ad27f3d08baba78887c73b09485c0fbd3\n+\n $(package)_extra_sources=$($(package)_clang_file_name)\n+$(package)_extra_sources += $($(package)_libtapi_file_name)\n \n define $(package)_fetch_cmds\n $(call fetch_file,$(package),$($(package)_download_path),$($(package)_download_file),$($(package)_file_name),$($(package)_sha256_hash)) && \\\n-$(call fetch_file,$(package),$($(package)_clang_download_path),$($(package)_clang_download_file),$($(package)_clang_file_name),$($(package)_clang_sha256_hash))\n+$(call fetch_file,$(package),$($(package)_clang_download_path),$($(package)_clang_download_file),$($(package)_clang_file_name),$($(package)_clang_sha256_hash)) && \\\n+$(call fetch_file,$(package),$($(package)_libtapi_download_path),$($(package)_libtapi_download_file),$($(package)_libtapi_file_name),$($(package)_libtapi_sha256_hash))\n endef\n \n define $(package)_extract_cmds\n   mkdir -p $($(package)_extract_dir) && \\\n   echo \"$($(package)_sha256_hash)  $($(package)_source)\" > $($(package)_extract_dir)/.$($(package)_file_name).hash && \\\n   echo \"$($(package)_clang_sha256_hash)  $($(package)_source_dir)/$($(package)_clang_file_name)\" >> $($(package)_extract_dir)/.$($(package)_file_name).hash && \\\n+  echo \"$($(package)_libtapi_sha256_hash)  $($(package)_source_dir)/$($(package)_libtapi_file_name)\" >> $($(package)_extract_dir)/.$($(package)_file_name).hash && \\\n   $(build_SHA256SUM) -c $($(package)_extract_dir)/.$($(package)_file_name).hash && \\\n   mkdir -p toolchain/bin toolchain/lib/clang/$($(package)_clang_version)/include && \\\n+  mkdir -p libtapi && \\\n+  tar --no-same-owner --strip-components=1 -C libtapi -xf $($(package)_source_dir)/$($(package)_libtapi_file_name) && \\\n   tar --no-same-owner --strip-components=1 -C toolchain -xf $($(package)_source_dir)/$($(package)_clang_file_name) && \\\n   rm -f toolchain/lib/libc++abi.so* && \\\n   tar --no-same-owner --strip-components=1 -xf $($(package)_source)\n endef\n \n define $(package)_set_vars\n-$(package)_config_opts=--target=$(host) --disable-lto-support\n-$(package)_ldflags+=-Wl,-rpath=\\\\$$$$$$$$\\$$$$$$$$ORIGIN/../lib\n-$(package)_cc=$($(package)_extract_dir)/toolchain/bin/clang\n-$(package)_cxx=$($(package)_extract_dir)/toolchain/bin/clang++\n+  $(package)_config_opts=--target=$(host) --disable-lto-support --with-libtapi=$($(package)_extract_dir)\n+  $(package)_ldflags+=-Wl,-rpath=\\\\$$$$$$$$\\$$$$$$$$ORIGIN/../lib\n+  $(package)_cc=$($(package)_extract_dir)/toolchain/bin/clang\n+  $(package)_cxx=$($(package)_extract_dir)/toolchain/bin/clang++\n endef\n \n define $(package)_preprocess_cmds\n-  cd $($(package)_build_subdir); ./autogen.sh && \\\n-  sed -i.old \"/define HAVE_PTHREADS/d\" ld64/src/ld/InputFiles.h\n+  CC=$($(package)_cc) CXX=$($(package)_cxx) INSTALLPREFIX=$($(package)_extract_dir) ./libtapi/build.sh && \\\n+  CC=$($(package)_cc) CXX=$($(package)_cxx) INSTALLPREFIX=$($(package)_extract_dir) ./libtapi/install.sh && \\\n+  sed -i.old \"/define HAVE_PTHREADS/d\" $($(package)_build_subdir)/ld64/src/ld/InputFiles.h\n endef\n \n define $(package)_config_cmds\n@@ -49,6 +62,9 @@ endef\n \n define $(package)_stage_cmds\n   $(MAKE) DESTDIR=$($(package)_staging_dir) install && \\\n+  mkdir -p $($(package)_staging_prefix_dir)/lib/ && \\\n+  cd $($(package)_extract_dir) && \\\n+  cp lib/libtapi.so.6 $($(package)_staging_prefix_dir)/lib/ && \\\n   cd $($(package)_extract_dir)/toolchain && \\\n   mkdir -p $($(package)_staging_prefix_dir)/lib/clang/$($(package)_clang_version)/include && \\\n   mkdir -p $($(package)_staging_prefix_dir)/bin $($(package)_staging_prefix_dir)/include && \\"
      },
      {
        "sha": "366b1d0c423aee4fc4bc68226cddc0cf240c6377",
        "filename": "depends/packages/qt.mk",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ca5055a5aa07aba81a87cf12f6f0526a63c423b5/depends/packages/qt.mk",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ca5055a5aa07aba81a87cf12f6f0526a63c423b5/depends/packages/qt.mk",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/packages/qt.mk?ref=ca5055a5aa07aba81a87cf12f6f0526a63c423b5",
        "patch": "@@ -121,7 +121,6 @@ $(package)_config_opts_darwin += -device-option MAC_SDK_VERSION=$(OSX_SDK_VERSIO\n $(package)_config_opts_darwin += -device-option CROSS_COMPILE=\"$(host)-\"\n $(package)_config_opts_darwin += -device-option MAC_MIN_VERSION=$(OSX_MIN_VERSION)\n $(package)_config_opts_darwin += -device-option MAC_TARGET=$(host)\n-$(package)_config_opts_darwin += -device-option MAC_LD64_VERSION=$(LD64_VERSION)\n endif\n \n $(package)_config_opts_linux  = -qt-xkbcommon-x11"
      },
      {
        "sha": "4cd96df29ff307b012d5ae4c49cfff71948cca86",
        "filename": "depends/patches/qt/mac-qmake.conf",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ca5055a5aa07aba81a87cf12f6f0526a63c423b5/depends/patches/qt/mac-qmake.conf",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ca5055a5aa07aba81a87cf12f6f0526a63c423b5/depends/patches/qt/mac-qmake.conf",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/patches/qt/mac-qmake.conf?ref=ca5055a5aa07aba81a87cf12f6f0526a63c423b5",
        "patch": "@@ -18,7 +18,7 @@ QMAKE_APPLE_DEVICE_ARCHS=x86_64\n !host_build: QMAKE_CFLAGS += -target $${MAC_TARGET}\n !host_build: QMAKE_OBJECTIVE_CFLAGS += $$QMAKE_CFLAGS\n !host_build: QMAKE_CXXFLAGS += $$QMAKE_CFLAGS\n-!host_build: QMAKE_LFLAGS += -target $${MAC_TARGET} -mlinker-version=$${MAC_LD64_VERSION}\n+!host_build: QMAKE_LFLAGS += -target $${MAC_TARGET}\n QMAKE_AR = $${CROSS_COMPILE}ar cq\n QMAKE_RANLIB=$${CROSS_COMPILE}ranlib\n QMAKE_LIBTOOL=$${CROSS_COMPILE}libtool"
      }
    ]
  },
  {
    "sha": "7e2104433cd0905ccf94632511b3ca0ce5b0463b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3ZTIxMDQ0MzNjZDA5MDVjY2Y5NDYzMjUxMWIzY2EwY2U1YjA0NjNi",
    "commit": {
      "author": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2019-07-14T05:31:16Z"
      },
      "committer": {
        "name": "fanquake",
        "email": "fanquake@gmail.com",
        "date": "2020-02-03T11:49:46Z"
      },
      "message": "build: use macOS 10.14 SDK\n\nCo-Authored-By: Carl Dong <accounts@carldong.me>",
      "tree": {
        "sha": "46e866f9b46d139f3ee93991051e5e5d9be563d3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/46e866f9b46d139f3ee93991051e5e5d9be563d3"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7e2104433cd0905ccf94632511b3ca0ce5b0463b",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEz7FuIclQ9n+pXlWPLuufXMCVJsEFAl44CNoACgkQLuufXMCV\nJsHsFw//W5e/hyBM30isbnL0mkf6X49SUcVkqmo4lckTnHRjMc1LSzGiHzRoK+VI\nT5aMhQCgXPQ4JCEiufMPjfyXzpwNV+OJKOwcA4/gBgWRT5+3Jy7WODg4ZG+KTYte\nzxRvFwdhhJ76uRGMBvLapb20EMe7aRKL7EBeGg1o8rc8mIq0flRd7LtHTy34BhFw\ns/mVBX6cl3AjaD88t8Hc1NgaEII/Zr4efzH2YuvR4GEo6QQH1vWB9kwBcA2Y1V8L\nU3qX7VP/rtdnP7y85LzqpAtkx6e7XprRPKDniId8DQYS6IHJxFy7SkVbvwqk6iLr\nKLLIeKuKAhWb9ZTjr2u/P1Gkt6mIfA/FV8yKFQdiywzr3kZXepebH+xIKs+1moPX\nY+rNn+fmV7icpn+VvicoRwoxtAE+ce3+m8R6LSKxSrn0/vgyxkSFClKCwWh+5sST\n6Bsgh22mPm6VeKK83ofFZW+NPrfCi4RY4KQO3G/46vGWAXZu270ORHhEdVvoYK2/\nLt6eFxMKoKx5Ez5dXi5O/hO/yYMTdMEJNA5Ml7WkNzKzZ+EIWhbM0hQH9rUcZfHL\nZx5BSWj2kOu9+07hHBQaRlt7Rjzf/QTS9dEGJUEwBQZyugI2s1o6jBlbQH2C1RsD\nSQwWO3E0xudN9tGI32FahFq3ZAexBC2U9idtVTO9Cv8nWxhtY0s=\n=XJj7\n-----END PGP SIGNATURE-----",
        "payload": "tree 46e866f9b46d139f3ee93991051e5e5d9be563d3\nparent ca5055a5aa07aba81a87cf12f6f0526a63c423b5\nauthor fanquake <fanquake@gmail.com> 1563082276 +0800\ncommitter fanquake <fanquake@gmail.com> 1580730586 +0800\n\nbuild: use macOS 10.14 SDK\n\nCo-Authored-By: Carl Dong <accounts@carldong.me>\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7e2104433cd0905ccf94632511b3ca0ce5b0463b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/7e2104433cd0905ccf94632511b3ca0ce5b0463b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7e2104433cd0905ccf94632511b3ca0ce5b0463b/comments",
    "author": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "ca5055a5aa07aba81a87cf12f6f0526a63c423b5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ca5055a5aa07aba81a87cf12f6f0526a63c423b5",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/ca5055a5aa07aba81a87cf12f6f0526a63c423b5"
      }
    ],
    "stats": {
      "total": 239,
      "additions": 133,
      "deletions": 106
    },
    "files": [
      {
        "sha": "2f3d45f1fc62fd7523ae0ddb88c772f555f8028d",
        "filename": "ci/test/00_setup_env_mac.sh",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7e2104433cd0905ccf94632511b3ca0ce5b0463b/ci/test/00_setup_env_mac.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7e2104433cd0905ccf94632511b3ca0ce5b0463b/ci/test/00_setup_env_mac.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/ci/test/00_setup_env_mac.sh?ref=7e2104433cd0905ccf94632511b3ca0ce5b0463b",
        "patch": "@@ -8,7 +8,7 @@ export LC_ALL=C.UTF-8\n \n export HOST=x86_64-apple-darwin16\n export PACKAGES=\"cmake imagemagick libcap-dev librsvg2-bin libz-dev libbz2-dev libtiff-tools python3-dev python3-setuptools\"\n-export OSX_SDK=10.11\n+export OSX_SDK=10.14\n export RUN_UNIT_TESTS=false\n export RUN_FUNCTIONAL_TESTS=false\n export GOAL=\"deploy\""
      },
      {
        "sha": "4a3df93cea3d273ee5fb42061a3a155b8b172b2a",
        "filename": "contrib/gitian-build.py",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7e2104433cd0905ccf94632511b3ca0ce5b0463b/contrib/gitian-build.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7e2104433cd0905ccf94632511b3ca0ce5b0463b/contrib/gitian-build.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/gitian-build.py?ref=7e2104433cd0905ccf94632511b3ca0ce5b0463b",
        "patch": "@@ -209,7 +209,7 @@ def main():\n     args.macos = 'm' in args.os\n \n     # Disable for MacOS if no SDK found\n-    if args.macos and not os.path.isfile('gitian-builder/inputs/MacOSX10.11.sdk.tar.gz'):\n+    if args.macos and not os.path.isfile('gitian-builder/inputs/MacOSX10.14.sdk.tar.gz'):\n         print('Cannot build for MacOS, SDK does not exist. Will build for other OSes')\n         args.macos = False\n "
      },
      {
        "sha": "2b6aa599e0e6ec4f4257ad871a6b0e5e75557373",
        "filename": "contrib/gitian-descriptors/gitian-osx.yml",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7e2104433cd0905ccf94632511b3ca0ce5b0463b/contrib/gitian-descriptors/gitian-osx.yml",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7e2104433cd0905ccf94632511b3ca0ce5b0463b/contrib/gitian-descriptors/gitian-osx.yml",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/gitian-descriptors/gitian-osx.yml?ref=7e2104433cd0905ccf94632511b3ca0ce5b0463b",
        "patch": "@@ -32,7 +32,7 @@ remotes:\n - \"url\": \"https://github.com/bitcoin/bitcoin.git\"\n   \"dir\": \"bitcoin\"\n files:\n-- \"MacOSX10.11.sdk.tar.gz\"\n+- \"MacOSX10.14.sdk.tar.gz\"\n script: |\n   set -e -o pipefail\n \n@@ -90,7 +90,7 @@ script: |\n   BASEPREFIX=\"${PWD}/depends\"\n \n   mkdir -p ${BASEPREFIX}/SDKs\n-  tar -C ${BASEPREFIX}/SDKs -xf ${BUILD_DIR}/MacOSX10.11.sdk.tar.gz\n+  tar -C ${BASEPREFIX}/SDKs -xf ${BUILD_DIR}/MacOSX10.14.sdk.tar.gz\n \n   # Build dependencies for each host\n   for i in $HOSTS; do"
      },
      {
        "sha": "f78bebf114c4d6d9f2157b79063ff284621857ca",
        "filename": "contrib/macdeploy/README.md",
        "status": "modified",
        "additions": 128,
        "deletions": 8,
        "changes": 136,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7e2104433cd0905ccf94632511b3ca0ce5b0463b/contrib/macdeploy/README.md",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7e2104433cd0905ccf94632511b3ca0ce5b0463b/contrib/macdeploy/README.md",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/macdeploy/README.md?ref=7e2104433cd0905ccf94632511b3ca0ce5b0463b",
        "patch": "@@ -1,15 +1,135 @@\n-### MacDeploy ###\n+# MacOS Deployment\n \n-For Snow Leopard (which uses [Python 2.6](http://www.python.org/download/releases/2.6/)), you will need the param_parser package:\n+The `macdeployqtplus` script should not be run manually. Instead, after building as usual:\n \n-\tsudo easy_install argparse\n+```bash\n+make deploy\n+```\n \n-This script should not be run manually, instead, after building as usual:\n+During the deployment process, the disk image window will pop up briefly\n+when the fancy settings are applied. This is normal, please do not interfere,\n+the process will unmount the DMG and cleanup before finishing.\n \n-\tmake deploy\n+When complete, it will have produced `Bitcoin-Qt.dmg`.\n \n-During the process, the disk image window will pop up briefly where the fancy\n-settings are applied. This is normal, please do not interfere.\n+## SDK Extraction\n \n-When finished, it will produce `Bitcoin-Qt.dmg`.\n+`Xcode.app` is packaged in a `.xip` archive.\n+This makes the SDK less-trivial to extract on non-macOS machines.\n+One approach (tested on Debian Buster) is outlined below:\n \n+```bash\n+\n+apt install clang cpio git liblzma-dev libxml2-dev libssl-dev make\n+\n+git clone https://github.com/tpoechtrager/xar\n+pushd xar/xar\n+./configure\n+make\n+make install\n+popd\n+\n+git clone https://github.com/NiklasRosenstein/pbzx\n+pushd pbzx\n+clang -llzma -lxar pbzx.c -o pbzx -Wl,-rpath=/usr/local/lib\n+popd\n+\n+xar -xf Xcode_10.2.1.xip -C .\n+\n+./pbzx/pbzx -n Content | cpio -i\n+\n+find Xcode.app -type d -name MacOSX.sdk -execdir sh -c 'tar -c MacOSX.sdk/ | gzip -9n > /MacOSX10.14.sdk.tar.gz' \\;\n+```\n+\n+on macOS the process is more straightforward:\n+\n+```bash\n+xip -x Xcode_10.2.1.xip\n+tar -C Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/ -czf MacOSX10.14.sdk.tar.gz MacOSX.sdk\n+```\n+\n+Our previously used macOS SDK (`MacOSX10.11.sdk`) can be extracted from\n+[Xcode 7.3.1 dmg](https://developer.apple.com/devcenter/download.action?path=/Developer_Tools/Xcode_7.3.1/Xcode_7.3.1.dmg).\n+The script [`extract-osx-sdk.sh`](./extract-osx-sdk.sh) automates this. First\n+ensure the DMG file is in the current directory, and then run the script. You\n+may wish to delete the `intermediate 5.hfs` file and `MacOSX10.11.sdk` (the\n+directory) when you've confirmed the extraction succeeded.\n+\n+```bash\n+apt-get install p7zip-full sleuthkit\n+contrib/macdeploy/extract-osx-sdk.sh\n+rm -rf 5.hfs MacOSX10.11.sdk\n+```\n+\n+## Deterministic macOS DMG Notes\n+Working macOS DMGs are created in Linux by combining a recent `clang`, the Apple\n+`binutils` (`ld`, `ar`, etc) and DMG authoring tools.\n+\n+Apple uses `clang` extensively for development and has upstreamed the necessary\n+functionality so that a vanilla clang can take advantage. It supports the use of `-F`,\n+`-target`, `-mmacosx-version-min`, and `--sysroot`, which are all necessary when\n+building for macOS.\n+\n+Apple's version of `binutils` (called `cctools`) contains lots of functionality missing in the\n+FSF's `binutils`. In addition to extra linker options for frameworks and sysroots, several\n+other tools are needed as well such as `install_name_tool`, `lipo`, and `nmedit`. These\n+do not build under Linux, so they have been patched to do so. The work here was used as\n+a starting point: [mingwandroid/toolchain4](https://github.com/mingwandroid/toolchain4).\n+\n+In order to build a working toolchain, the following source packages are needed from\n+Apple: `cctools`, `dyld`, and `ld64`.\n+\n+These tools inject timestamps by default, which produce non-deterministic binaries. The\n+`ZERO_AR_DATE` environment variable is used to disable that.\n+\n+This version of `cctools` has been patched to use the current version of `clang`'s headers\n+and its `libLTO.so` rather than those from `llvmgcc`, as it was originally done in `toolchain4`.\n+\n+To complicate things further, all builds must target an Apple SDK. These SDKs are free to\n+download, but not redistributable. To obtain it, register for an Apple Developer Account,\n+then download [Xcode 10.2.1](https://download.developer.apple.com/Developer_Tools/Xcode_10.2.1/Xcode_10.2.1.xip).\n+\n+This file is many gigabytes in size, but most (but not all) of what we need is\n+contained only in a single directory:\n+\n+```bash\n+Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.14.sdk\n+```\n+\n+See the SDK Extraction notes above for how to obtain it.\n+\n+The Gitian descriptors build 2 sets of files: Linux tools, then Apple binaries which are\n+created using these tools. The build process has been designed to avoid including the\n+SDK's files in Gitian's outputs. All interim tarballs are fully deterministic and may be freely\n+redistributed.\n+\n+`genisoimage` is used to create the initial DMG. It is not deterministic as-is, so it has been\n+patched. A system `genisoimage` will work fine, but it will not be deterministic because\n+the file-order will change between invocations. The patch can be seen here: [cdrkit-deterministic.patch](https://github.com/bitcoin/bitcoin/blob/master/depends/patches/native_cdrkit/cdrkit-deterministic.patch).\n+No effort was made to fix this cleanly, so it likely leaks memory badly, however it's only used for\n+a single invocation, so that's no real concern.\n+\n+`genisoimage` cannot compress DMGs, so afterwards, the DMG tool from the\n+`libdmg-hfsplus` project is used to compress it. There are several bugs in this tool and its\n+maintainer has seemingly abandoned the project.\n+\n+The DMG tool has the ability to create DMGs from scratch as well, but this functionality is\n+broken. Only the compression feature is currently used. Ideally, the creation could be fixed\n+and `genisoimage` would no longer be necessary.\n+\n+Background images and other features can be added to DMG files by inserting a\n+`.DS_Store` before creation. This is generated by the script `contrib/macdeploy/custom_dsstore.py`.\n+\n+As of OS X 10.9 Mavericks, using an Apple-blessed key to sign binaries is a requirement in\n+order to satisfy the new Gatekeeper requirements. Because this private key cannot be\n+shared, we'll have to be a bit creative in order for the build process to remain somewhat\n+deterministic. Here's how it works:\n+\n+- Builders use Gitian to create an unsigned release. This outputs an unsigned DMG which\n+  users may choose to bless and run. It also outputs an unsigned app structure in the form\n+  of a tarball, which also contains all of the tools that have been previously (deterministically)\n+  built in order to create a final DMG.\n+- The Apple keyholder uses this unsigned app to create a detached signature, using the\n+  script that is also included there. Detached signatures are available from this [repository](https://github.com/bitcoin-core/bitcoin-detached-sigs).\n+- Builders feed the unsigned app + detached signature back into Gitian. It uses the\n+  pre-built tools to recombine the pieces into a deterministic DMG."
      },
      {
        "sha": "1bc4fb81896f6298c07ff50afaf3865da59797f4",
        "filename": "depends/hosts/darwin.mk",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7e2104433cd0905ccf94632511b3ca0ce5b0463b/depends/hosts/darwin.mk",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7e2104433cd0905ccf94632511b3ca0ce5b0463b/depends/hosts/darwin.mk",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/hosts/darwin.mk?ref=7e2104433cd0905ccf94632511b3ca0ce5b0463b",
        "patch": "@@ -1,5 +1,5 @@\n OSX_MIN_VERSION=10.12\n-OSX_SDK_VERSION=10.11\n+OSX_SDK_VERSION=10.14\n OSX_SDK=$(SDK_PATH)/MacOSX$(OSX_SDK_VERSION).sdk\n darwin_CC=clang -target $(host) -mmacosx-version-min=$(OSX_MIN_VERSION) --sysroot $(OSX_SDK)\n darwin_CXX=clang++ -target $(host) -mmacosx-version-min=$(OSX_MIN_VERSION) --sysroot $(OSX_SDK) -stdlib=libc++"
      },
      {
        "sha": "86b5c5b6021edd0fb20e209fe6ef07bfdd89b97b",
        "filename": "doc/build-osx.md",
        "status": "modified",
        "additions": 0,
        "deletions": 93,
        "changes": 93,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7e2104433cd0905ccf94632511b3ca0ce5b0463b/doc/build-osx.md",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7e2104433cd0905ccf94632511b3ca0ce5b0463b/doc/build-osx.md",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/doc/build-osx.md?ref=7e2104433cd0905ccf94632511b3ca0ce5b0463b",
        "patch": "@@ -113,96 +113,3 @@ tail -f $HOME/Library/Application\\ Support/Bitcoin/debug.log\n * Tested on OS X 10.12 Sierra through macOS 10.15 Catalina on 64-bit Intel\n processors only.\n * Building with downloaded Qt binaries is not officially supported. See the notes in [#7714](https://github.com/bitcoin/bitcoin/issues/7714).\n-\n-## Deterministic macOS DMG Notes\n-Working macOS DMGs are created in Linux by combining a recent `clang`, the Apple\n-`binutils` (`ld`, `ar`, etc) and DMG authoring tools.\n-\n-Apple uses `clang` extensively for development and has upstreamed the necessary\n-functionality so that a vanilla clang can take advantage. It supports the use of `-F`,\n-`-target`, `-mmacosx-version-min`, and `--sysroot`, which are all necessary when\n-building for macOS.\n-\n-Apple's version of `binutils` (called `cctools`) contains lots of functionality missing in the\n-FSF's `binutils`. In addition to extra linker options for frameworks and sysroots, several\n-other tools are needed as well such as `install_name_tool`, `lipo`, and `nmedit`. These\n-do not build under Linux, so they have been patched to do so. The work here was used as\n-a starting point: [mingwandroid/toolchain4](https://github.com/mingwandroid/toolchain4).\n-\n-In order to build a working toolchain, the following source packages are needed from\n-Apple: `cctools`, `dyld`, and `ld64`.\n-\n-These tools inject timestamps by default, which produce non-deterministic binaries. The\n-`ZERO_AR_DATE` environment variable is used to disable that.\n-\n-This version of `cctools` has been patched to use the current version of `clang`'s headers\n-and its `libLTO.so` rather than those from `llvmgcc`, as it was originally done in `toolchain4`.\n-\n-To complicate things further, all builds must target an Apple SDK. These SDKs are free to\n-download, but not redistributable. To obtain it, register for an Apple Developer Account,\n-then download the [Xcode 7.3.1 dmg](https://developer.apple.com/devcenter/download.action?path=/Developer_Tools/Xcode_7.3.1/Xcode_7.3.1.dmg).\n-\n-This file is several gigabytes in size, but only a single directory inside is needed:\n-```\n-Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/MacOSX10.11.sdk\n-```\n-\n-Unfortunately, the usual Linux tools (7zip, hpmount, loopback mount) are incapable of\n-opening this file. To create a tarball suitable for Gitian input, there are two options:\n-\n-Using macOS, you can mount the DMG, and then create it with:\n-```shell\n-hdiutil attach Xcode_7.3.1.dmg\n-tar -C /Volumes/Xcode/Xcode.app/Contents/Developer/Platforms/MacOSX.platform/Developer/SDKs/ -czf MacOSX10.11.sdk.tar.gz MacOSX10.11.sdk\n-```\n-\n-Alternatively, you can use 7zip and SleuthKit to extract the files one by one. The script\n-[`extract-osx-sdk.sh`](./../contrib/macdeploy/extract-osx-sdk.sh) automates this. First\n-ensure the DMG file is in the current directory, and then run the script. You may wish to\n-delete the `intermediate 5.hfs` file and `MacOSX10.11.sdk` (the directory) when you've\n-confirmed the extraction succeeded.\n-\n-```shell\n-apt-get install p7zip-full sleuthkit\n-contrib/macdeploy/extract-osx-sdk.sh\n-rm -rf 5.hfs MacOSX10.11.sdk\n-```\n-\n-The Gitian descriptors build 2 sets of files: Linux tools, then Apple binaries which are\n-created using these tools. The build process has been designed to avoid including the\n-SDK's files in Gitian's outputs. All interim tarballs are fully deterministic and may be freely\n-redistributed.\n-\n-`genisoimage` is used to create the initial DMG. It is not deterministic as-is, so it has been\n-patched. A system `genisoimage` will work fine, but it will not be deterministic because\n-the file-order will change between invocations. The patch can be seen here:  [theuni/osx-cross-depends](https://raw.githubusercontent.com/theuni/osx-cross-depends/master/patches/cdrtools/genisoimage.diff).\n-No effort was made to fix this cleanly, so it likely leaks memory badly. But it's only used for\n-a single invocation, so that's no real concern.\n-\n-`genisoimage` cannot compress DMGs, so afterwards, the DMG tool from the\n-`libdmg-hfsplus` project is used to compress it. There are several bugs in this tool and its\n-maintainer has seemingly abandoned the project. It has been forked and is available\n-(with fixes) here: [theuni/libdmg-hfsplus](https://github.com/theuni/libdmg-hfsplus).\n-\n-The DMG tool has the ability to create DMGs from scratch as well, but this functionality is\n-broken. Only the compression feature is currently used. Ideally, the creation could be fixed\n-and `genisoimage` would no longer be necessary.\n-\n-Background images and other features can be added to DMG files by inserting a\n-`.DS_Store` before creation. This is generated by the script\n-`contrib/macdeploy/custom_dsstore.py`.\n-\n-As of OS X 10.9 Mavericks, using an Apple-blessed key to sign binaries is a requirement in\n-order to satisfy the new Gatekeeper requirements. Because this private key cannot be\n-shared, we'll have to be a bit creative in order for the build process to remain somewhat\n-deterministic. Here's how it works:\n-\n-- Builders use Gitian to create an unsigned release. This outputs an unsigned DMG which\n-  users may choose to bless and run. It also outputs an unsigned app structure in the form\n-  of a tarball, which also contains all of the tools that have been previously (deterministically)\n-  built in order to create a final DMG.\n-- The Apple keyholder uses this unsigned app to create a detached signature, using the\n-  script that is also included there. Detached signatures are available from this [repository](https://github.com/bitcoin-core/bitcoin-detached-sigs).\n-- Builders feed the unsigned app + detached signature back into Gitian. It uses the\n-  pre-built tools to recombine the pieces into a deterministic DMG.\n-"
      }
    ]
  }
]