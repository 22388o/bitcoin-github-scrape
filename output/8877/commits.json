[
  {
    "sha": "fc95daa97f324f6a8b3643a3d3c5e8f909d46c35",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYzk1ZGFhOTdmMzI0ZjZhOGIzNjQzYTNkM2M1ZThmOTA5ZDQ2YzM1",
    "commit": {
      "author": {
        "name": "Jonas Schnelli",
        "email": "jonas.schnelli@include7.ch",
        "date": "2015-03-13T20:51:27Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2016-12-29T11:43:28Z"
      },
      "message": "Qt/RPCConsole: Save current command entry when browsing history\n\nShell-like, but doesn't store changed history commands until executing it.",
      "tree": {
        "sha": "dae2701c86e23ddf50969084b3c28cb9597f7a87",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/dae2701c86e23ddf50969084b3c28cb9597f7a87"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fc95daa97f324f6a8b3643a3d3c5e8f909d46c35",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fc95daa97f324f6a8b3643a3d3c5e8f909d46c35",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fc95daa97f324f6a8b3643a3d3c5e8f909d46c35",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fc95daa97f324f6a8b3643a3d3c5e8f909d46c35/comments",
    "author": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "dce853ef76ef90c46d84294225088d595467d08c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dce853ef76ef90c46d84294225088d595467d08c",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/dce853ef76ef90c46d84294225088d595467d08c"
      }
    ],
    "stats": {
      "total": 11,
      "additions": 11,
      "deletions": 0
    },
    "files": [
      {
        "sha": "5610e8b6ca029ac882c81adbd9eac50f9b63674e",
        "filename": "src/qt/rpcconsole.cpp",
        "status": "modified",
        "additions": 10,
        "deletions": 0,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fc95daa97f324f6a8b3643a3d3c5e8f909d46c35/src/qt/rpcconsole.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fc95daa97f324f6a8b3643a3d3c5e8f909d46c35/src/qt/rpcconsole.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/rpcconsole.cpp?ref=fc95daa97f324f6a8b3643a3d3c5e8f909d46c35",
        "patch": "@@ -751,6 +751,8 @@ void RPCConsole::on_lineEdit_returnPressed()\n \n     if(!cmd.isEmpty())\n     {\n+        cmdBeforeBrowsing = QString();\n+\n         message(CMD_REQUEST, cmd);\n         Q_EMIT cmdRequest(cmd);\n         // Remove command, if already in history\n@@ -769,6 +771,11 @@ void RPCConsole::on_lineEdit_returnPressed()\n \n void RPCConsole::browseHistory(int offset)\n {\n+    // store current text when start browsing through the history\n+    if (historyPtr == history.size()) {\n+        cmdBeforeBrowsing = ui->lineEdit->text();\n+    }\n+\n     historyPtr += offset;\n     if(historyPtr < 0)\n         historyPtr = 0;\n@@ -777,6 +784,9 @@ void RPCConsole::browseHistory(int offset)\n     QString cmd;\n     if(historyPtr < history.size())\n         cmd = history.at(historyPtr);\n+    else if (!cmdBeforeBrowsing.isNull()) {\n+        cmd = cmdBeforeBrowsing;\n+    }\n     ui->lineEdit->setText(cmd);\n }\n "
      },
      {
        "sha": "e1698711dae06d5a3e233354ddde68dd6708fcbb",
        "filename": "src/qt/rpcconsole.h",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fc95daa97f324f6a8b3643a3d3c5e8f909d46c35/src/qt/rpcconsole.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fc95daa97f324f6a8b3643a3d3c5e8f909d46c35/src/qt/rpcconsole.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/rpcconsole.h?ref=fc95daa97f324f6a8b3643a3d3c5e8f909d46c35",
        "patch": "@@ -140,6 +140,7 @@ public Q_SLOTS:\n     ClientModel *clientModel;\n     QStringList history;\n     int historyPtr;\n+    QString cmdBeforeBrowsing;\n     QList<NodeId> cachedNodeids;\n     const PlatformStyle *platformStyle;\n     RPCTimerInterface *rpcTimerInterface;"
      }
    ]
  },
  {
    "sha": "9044908636f0072d001d9a029053a384127b002b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo5MDQ0OTA4NjM2ZjAwNzJkMDAxZDlhMDI5MDUzYTM4NDEyN2IwMDJi",
    "commit": {
      "author": {
        "name": "Jonas Schnelli",
        "email": "jonas.schnelli@include7.ch",
        "date": "2015-03-13T20:51:27Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2016-12-29T11:43:28Z"
      },
      "message": "Qt/RPCConsole: Don't store commands with potentially sensitive information in the history\n\nFilters importprivkey, signrawtransaction, walletpassphrase, walletpassphrasechange, and encryptwallet",
      "tree": {
        "sha": "b222ea5dc55ec50a39ec5ddb1563c69ded8486a6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b222ea5dc55ec50a39ec5ddb1563c69ded8486a6"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9044908636f0072d001d9a029053a384127b002b",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9044908636f0072d001d9a029053a384127b002b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/9044908636f0072d001d9a029053a384127b002b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9044908636f0072d001d9a029053a384127b002b/comments",
    "author": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fc95daa97f324f6a8b3643a3d3c5e8f909d46c35",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fc95daa97f324f6a8b3643a3d3c5e8f909d46c35",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fc95daa97f324f6a8b3643a3d3c5e8f909d46c35"
      }
    ],
    "stats": {
      "total": 38,
      "additions": 29,
      "deletions": 9
    },
    "files": [
      {
        "sha": "562c9509da79ca9b581515af1e41d9f778949c4d",
        "filename": "src/qt/rpcconsole.cpp",
        "status": "modified",
        "additions": 28,
        "deletions": 9,
        "changes": 37,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/9044908636f0072d001d9a029053a384127b002b/src/qt/rpcconsole.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/9044908636f0072d001d9a029053a384127b002b/src/qt/rpcconsole.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/rpcconsole.cpp?ref=9044908636f0072d001d9a029053a384127b002b",
        "patch": "@@ -63,6 +63,14 @@ const struct {\n     {NULL, NULL}\n };\n \n+// don't add private key handling cmd's to the history\n+const QStringList RPCConsole::historyFilter = QStringList()\n+    << \"importprivkey\"\n+    << \"signrawtransaction\"\n+    << \"walletpassphrase\"\n+    << \"walletpassphrasechange\"\n+    << \"encryptwallet\";\n+\n /* Object for executing console RPC commands in a separate thread.\n */\n class RPCExecutor : public QObject\n@@ -755,15 +763,26 @@ void RPCConsole::on_lineEdit_returnPressed()\n \n         message(CMD_REQUEST, cmd);\n         Q_EMIT cmdRequest(cmd);\n-        // Remove command, if already in history\n-        history.removeOne(cmd);\n-        // Append command to history\n-        history.append(cmd);\n-        // Enforce maximum history size\n-        while(history.size() > CONSOLE_HISTORY)\n-            history.removeFirst();\n-        // Set pointer to end of history\n-        historyPtr = history.size();\n+\n+        bool storeHistory = true;\n+        Q_FOREACH(QString unallowedCmd, historyFilter)\n+        {\n+            if (cmd.trimmed().startsWith(unallowedCmd))\n+                storeHistory = false; break;\n+        }\n+\n+        if (storeHistory)\n+        {\n+            // Remove command, if already in history\n+            history.removeOne(cmd);\n+            // Append command to history\n+            history.append(cmd);\n+            // Enforce maximum history size\n+            while(history.size() > CONSOLE_HISTORY)\n+                history.removeFirst();\n+            // Set pointer to end of history\n+            historyPtr = history.size();\n+        }\n         // Scroll console view to end\n         scrollToEnd();\n     }"
      },
      {
        "sha": "4841ea825edf7d8d966c8eff89392e161afe338f",
        "filename": "src/qt/rpcconsole.h",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/9044908636f0072d001d9a029053a384127b002b/src/qt/rpcconsole.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/9044908636f0072d001d9a029053a384127b002b/src/qt/rpcconsole.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/rpcconsole.h?ref=9044908636f0072d001d9a029053a384127b002b",
        "patch": "@@ -140,6 +140,7 @@ public Q_SLOTS:\n     ClientModel *clientModel;\n     QStringList history;\n     int historyPtr;\n+    const static QStringList historyFilter;\n     QString cmdBeforeBrowsing;\n     QList<NodeId> cachedNodeids;\n     const PlatformStyle *platformStyle;"
      }
    ]
  },
  {
    "sha": "de8980df9d3a1fc0b257139cef10a0e6ba29a8bd",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkZTg5ODBkZjlkM2ExZmMwYjI1NzEzOWNlZjEwYTBlNmJhMjlhOGJk",
    "commit": {
      "author": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2016-10-04T04:11:01Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2016-12-29T11:43:29Z"
      },
      "message": "Bugfix: Do not add sensitive information to history for real\n\nOriginal code was missing braces, and short-circuited before checking everything after importprivkey",
      "tree": {
        "sha": "e8a0eafee6f9d08054b235cb85085931e97c04f1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e8a0eafee6f9d08054b235cb85085931e97c04f1"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/de8980df9d3a1fc0b257139cef10a0e6ba29a8bd",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/de8980df9d3a1fc0b257139cef10a0e6ba29a8bd",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/de8980df9d3a1fc0b257139cef10a0e6ba29a8bd",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/de8980df9d3a1fc0b257139cef10a0e6ba29a8bd/comments",
    "author": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "9044908636f0072d001d9a029053a384127b002b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9044908636f0072d001d9a029053a384127b002b",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/9044908636f0072d001d9a029053a384127b002b"
      }
    ],
    "stats": {
      "total": 5,
      "additions": 4,
      "deletions": 1
    },
    "files": [
      {
        "sha": "8aa3d10eb5ae0927fbe6eab13b7549e72b2e864c",
        "filename": "src/qt/rpcconsole.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 1,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/de8980df9d3a1fc0b257139cef10a0e6ba29a8bd/src/qt/rpcconsole.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/de8980df9d3a1fc0b257139cef10a0e6ba29a8bd/src/qt/rpcconsole.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/rpcconsole.cpp?ref=de8980df9d3a1fc0b257139cef10a0e6ba29a8bd",
        "patch": "@@ -768,7 +768,10 @@ void RPCConsole::on_lineEdit_returnPressed()\n         Q_FOREACH(QString unallowedCmd, historyFilter)\n         {\n             if (cmd.trimmed().startsWith(unallowedCmd))\n-                storeHistory = false; break;\n+            {\n+                storeHistory = false;\n+                break;\n+            }\n         }\n \n         if (storeHistory)"
      }
    ]
  },
  {
    "sha": "afde12f265bbc4742b329c6adecc853cb68a7155",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphZmRlMTJmMjY1YmJjNDc0MmIzMjljNmFkZWNjODUzY2I2OGE3MTU1",
    "commit": {
      "author": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2016-10-04T04:17:27Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2016-12-29T11:43:29Z"
      },
      "message": "Qt/RPCConsole: Refactor command_may_contain_sensitive_data function out of RPCConsole::on_lineEdit_returnPressed",
      "tree": {
        "sha": "8af667745e8c8d747cc10a7e9230d2b66aa84311",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8af667745e8c8d747cc10a7e9230d2b66aa84311"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/afde12f265bbc4742b329c6adecc853cb68a7155",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/afde12f265bbc4742b329c6adecc853cb68a7155",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/afde12f265bbc4742b329c6adecc853cb68a7155",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/afde12f265bbc4742b329c6adecc853cb68a7155/comments",
    "author": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "de8980df9d3a1fc0b257139cef10a0e6ba29a8bd",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/de8980df9d3a1fc0b257139cef10a0e6ba29a8bd",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/de8980df9d3a1fc0b257139cef10a0e6ba29a8bd"
      }
    ],
    "stats": {
      "total": 27,
      "additions": 16,
      "deletions": 11
    },
    "files": [
      {
        "sha": "23a4a250782cecfb2cf74dda096cd57f73d9e3c0",
        "filename": "src/qt/rpcconsole.cpp",
        "status": "modified",
        "additions": 16,
        "deletions": 10,
        "changes": 26,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/afde12f265bbc4742b329c6adecc853cb68a7155/src/qt/rpcconsole.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/afde12f265bbc4742b329c6adecc853cb68a7155/src/qt/rpcconsole.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/rpcconsole.cpp?ref=afde12f265bbc4742b329c6adecc853cb68a7155",
        "patch": "@@ -63,14 +63,28 @@ const struct {\n     {NULL, NULL}\n };\n \n+namespace {\n+\n // don't add private key handling cmd's to the history\n-const QStringList RPCConsole::historyFilter = QStringList()\n+const QStringList historyFilter = QStringList()\n     << \"importprivkey\"\n     << \"signrawtransaction\"\n     << \"walletpassphrase\"\n     << \"walletpassphrasechange\"\n     << \"encryptwallet\";\n \n+bool command_may_contain_sensitive_data(const QString cmd)\n+{\n+    Q_FOREACH(QString unallowedCmd, historyFilter) {\n+        if (cmd.trimmed().startsWith(unallowedCmd)) {\n+            return true;\n+        }\n+    }\n+    return false;\n+}\n+\n+}\n+\n /* Object for executing console RPC commands in a separate thread.\n */\n class RPCExecutor : public QObject\n@@ -764,15 +778,7 @@ void RPCConsole::on_lineEdit_returnPressed()\n         message(CMD_REQUEST, cmd);\n         Q_EMIT cmdRequest(cmd);\n \n-        bool storeHistory = true;\n-        Q_FOREACH(QString unallowedCmd, historyFilter)\n-        {\n-            if (cmd.trimmed().startsWith(unallowedCmd))\n-            {\n-                storeHistory = false;\n-                break;\n-            }\n-        }\n+        bool storeHistory = !command_may_contain_sensitive_data(cmd);\n \n         if (storeHistory)\n         {"
      },
      {
        "sha": "e1698711dae06d5a3e233354ddde68dd6708fcbb",
        "filename": "src/qt/rpcconsole.h",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/afde12f265bbc4742b329c6adecc853cb68a7155/src/qt/rpcconsole.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/afde12f265bbc4742b329c6adecc853cb68a7155/src/qt/rpcconsole.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/rpcconsole.h?ref=afde12f265bbc4742b329c6adecc853cb68a7155",
        "patch": "@@ -140,7 +140,6 @@ public Q_SLOTS:\n     ClientModel *clientModel;\n     QStringList history;\n     int historyPtr;\n-    const static QStringList historyFilter;\n     QString cmdBeforeBrowsing;\n     QList<NodeId> cachedNodeids;\n     const PlatformStyle *platformStyle;"
      }
    ]
  },
  {
    "sha": "d80a00660f5b26ee16c60b941c2bbbd2d49e711f",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkODBhMDA2NjBmNWIyNmVlMTZjNjBiOTQxYzJiYmJkMmQ0OWU3MTFm",
    "commit": {
      "author": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2016-10-04T14:07:50Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2016-12-29T11:43:29Z"
      },
      "message": "Qt/RPCConsole: Add signmessagewithprivkey to list of commands filtered from history",
      "tree": {
        "sha": "2f51c9bddc2dbd13e7a853b49a1c50473fbf15ab",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2f51c9bddc2dbd13e7a853b49a1c50473fbf15ab"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d80a00660f5b26ee16c60b941c2bbbd2d49e711f",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d80a00660f5b26ee16c60b941c2bbbd2d49e711f",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/d80a00660f5b26ee16c60b941c2bbbd2d49e711f",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d80a00660f5b26ee16c60b941c2bbbd2d49e711f/comments",
    "author": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "afde12f265bbc4742b329c6adecc853cb68a7155",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/afde12f265bbc4742b329c6adecc853cb68a7155",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/afde12f265bbc4742b329c6adecc853cb68a7155"
      }
    ],
    "stats": {
      "total": 1,
      "additions": 1,
      "deletions": 0
    },
    "files": [
      {
        "sha": "c979fdf87b60ee3255fc822be9ae64436c7f412b",
        "filename": "src/qt/rpcconsole.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d80a00660f5b26ee16c60b941c2bbbd2d49e711f/src/qt/rpcconsole.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d80a00660f5b26ee16c60b941c2bbbd2d49e711f/src/qt/rpcconsole.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/rpcconsole.cpp?ref=d80a00660f5b26ee16c60b941c2bbbd2d49e711f",
        "patch": "@@ -68,6 +68,7 @@ namespace {\n // don't add private key handling cmd's to the history\n const QStringList historyFilter = QStringList()\n     << \"importprivkey\"\n+    << \"signmessagewithprivkey\"\n     << \"signrawtransaction\"\n     << \"walletpassphrase\"\n     << \"walletpassphrasechange\""
      }
    ]
  },
  {
    "sha": "1755c04576eb42467ba16af9f2658e12b707b7d0",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxNzU1YzA0NTc2ZWI0MjQ2N2JhMTZhZjlmMjY1OGUxMmI3MDdiN2Qw",
    "commit": {
      "author": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2016-10-04T15:43:10Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2016-12-29T11:43:29Z"
      },
      "message": "Qt/RPCConsole: Truncate filtered commands to just the command name, rather than skip it entirely in history",
      "tree": {
        "sha": "864b1f14ef2c2dd9e423b4e615f2a237c543e690",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/864b1f14ef2c2dd9e423b4e615f2a237c543e690"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1755c04576eb42467ba16af9f2658e12b707b7d0",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1755c04576eb42467ba16af9f2658e12b707b7d0",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/1755c04576eb42467ba16af9f2658e12b707b7d0",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1755c04576eb42467ba16af9f2658e12b707b7d0/comments",
    "author": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "d80a00660f5b26ee16c60b941c2bbbd2d49e711f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d80a00660f5b26ee16c60b941c2bbbd2d49e711f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/d80a00660f5b26ee16c60b941c2bbbd2d49e711f"
      }
    ],
    "stats": {
      "total": 30,
      "additions": 14,
      "deletions": 16
    },
    "files": [
      {
        "sha": "c53ae53c6409e78c8fc0fcfa4df473daf827810c",
        "filename": "src/qt/rpcconsole.cpp",
        "status": "modified",
        "additions": 14,
        "deletions": 16,
        "changes": 30,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1755c04576eb42467ba16af9f2658e12b707b7d0/src/qt/rpcconsole.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1755c04576eb42467ba16af9f2658e12b707b7d0/src/qt/rpcconsole.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/rpcconsole.cpp?ref=1755c04576eb42467ba16af9f2658e12b707b7d0",
        "patch": "@@ -74,14 +74,14 @@ const QStringList historyFilter = QStringList()\n     << \"walletpassphrasechange\"\n     << \"encryptwallet\";\n \n-bool command_may_contain_sensitive_data(const QString cmd)\n+QString command_filter_sensitive_data(const QString cmd)\n {\n     Q_FOREACH(QString unallowedCmd, historyFilter) {\n         if (cmd.trimmed().startsWith(unallowedCmd)) {\n-            return true;\n+            return unallowedCmd;\n         }\n     }\n-    return false;\n+    return cmd;\n }\n \n }\n@@ -779,20 +779,18 @@ void RPCConsole::on_lineEdit_returnPressed()\n         message(CMD_REQUEST, cmd);\n         Q_EMIT cmdRequest(cmd);\n \n-        bool storeHistory = !command_may_contain_sensitive_data(cmd);\n+        cmd = command_filter_sensitive_data(cmd);\n+\n+        // Remove command, if already in history\n+        history.removeOne(cmd);\n+        // Append command to history\n+        history.append(cmd);\n+        // Enforce maximum history size\n+        while(history.size() > CONSOLE_HISTORY)\n+            history.removeFirst();\n+        // Set pointer to end of history\n+        historyPtr = history.size();\n \n-        if (storeHistory)\n-        {\n-            // Remove command, if already in history\n-            history.removeOne(cmd);\n-            // Append command to history\n-            history.append(cmd);\n-            // Enforce maximum history size\n-            while(history.size() > CONSOLE_HISTORY)\n-                history.removeFirst();\n-            // Set pointer to end of history\n-            historyPtr = history.size();\n-        }\n         // Scroll console view to end\n         scrollToEnd();\n     }"
      }
    ]
  },
  {
    "sha": "e2d9213c32e51fe197756709e24c6694f28bf842",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplMmQ5MjEzYzMyZTUxZmUxOTc3NTY3MDllMjRjNjY5NGYyOGJmODQy",
    "commit": {
      "author": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2016-11-16T10:56:32Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2016-12-29T11:43:29Z"
      },
      "message": "Qt/RPCConsole: Make it possible to parse a command without executing it",
      "tree": {
        "sha": "24a4bedc19ccf827689099b27d3449bef6658935",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/24a4bedc19ccf827689099b27d3449bef6658935"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e2d9213c32e51fe197756709e24c6694f28bf842",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e2d9213c32e51fe197756709e24c6694f28bf842",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/e2d9213c32e51fe197756709e24c6694f28bf842",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e2d9213c32e51fe197756709e24c6694f28bf842/comments",
    "author": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "1755c04576eb42467ba16af9f2658e12b707b7d0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1755c04576eb42467ba16af9f2658e12b707b7d0",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/1755c04576eb42467ba16af9f2658e12b707b7d0"
      }
    ],
    "stats": {
      "total": 29,
      "additions": 17,
      "deletions": 12
    },
    "files": [
      {
        "sha": "f45383341608ec04b9b3afccceebe17155bbac4c",
        "filename": "src/qt/rpcconsole.cpp",
        "status": "modified",
        "additions": 13,
        "deletions": 11,
        "changes": 24,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e2d9213c32e51fe197756709e24c6694f28bf842/src/qt/rpcconsole.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e2d9213c32e51fe197756709e24c6694f28bf842/src/qt/rpcconsole.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/rpcconsole.cpp?ref=e2d9213c32e51fe197756709e24c6694f28bf842",
        "patch": "@@ -136,10 +136,10 @@ class QtRPCTimerInterface: public RPCTimerInterface\n #include \"rpcconsole.moc\"\n \n /**\n- * Split shell command line into a list of arguments and execute the command(s).\n+ * Split shell command line into a list of arguments and optionally execute the command(s).\n  * Aims to emulate \\c bash and friends.\n  *\n- * - Command nesting is possible with brackets [example: validateaddress(getnewaddress())]\n+ * - Command nesting is possible with parenthesis; for example: validateaddress(getnewaddress())\n  * - Arguments are delimited with whitespace or comma\n  * - Extra whitespace at the beginning and end and between arguments will be ignored\n  * - Text can be \"double\" or 'single' quoted\n@@ -150,9 +150,10 @@ class QtRPCTimerInterface: public RPCTimerInterface\n  *\n  * @param[out]   result      stringified Result from the executed command(chain)\n  * @param[in]    strCommand  Command line to split\n+ * @param[in]    fExecute    set true if you want the command to be executed\n  */\n \n-bool RPCConsole::RPCExecuteCommandLine(std::string &strResult, const std::string &strCommand)\n+bool RPCConsole::RPCParseCommandLine(std::string &strResult, const std::string &strCommand, const bool fExecute)\n {\n     std::vector< std::vector<std::string> > stack;\n     stack.push_back(std::vector<std::string>());\n@@ -196,7 +197,7 @@ bool RPCConsole::RPCExecuteCommandLine(std::string &strResult, const std::string\n                                 curarg += ch;\n                                 break;\n                             }\n-                            if (curarg.size())\n+                            if (curarg.size() && fExecute)\n                             {\n                                 // if we have a value query, query arrays with index and objects with a string key\n                                 UniValue subelement;\n@@ -271,13 +272,14 @@ bool RPCConsole::RPCExecuteCommandLine(std::string &strResult, const std::string\n                     }\n                     if ((ch == ')' || ch == '\\n') && stack.size() > 0)\n                     {\n-                        std::string strPrint;\n-                        // Convert argument list to JSON objects in method-dependent way,\n-                        // and pass it along with the method name to the dispatcher.\n-                        JSONRPCRequest req;\n-                        req.params = RPCConvertValues(stack.back()[0], std::vector<std::string>(stack.back().begin() + 1, stack.back().end()));\n-                        req.strMethod = stack.back()[0];\n-                        lastResult = tableRPC.execute(req);\n+                        if (fExecute) {\n+                            // Convert argument list to JSON objects in method-dependent way,\n+                            // and pass it along with the method name to the dispatcher.\n+                            JSONRPCRequest req;\n+                            req.params = RPCConvertValues(stack.back()[0], std::vector<std::string>(stack.back().begin() + 1, stack.back().end()));\n+                            req.strMethod = stack.back()[0];\n+                            lastResult = tableRPC.execute(req);\n+                        }\n \n                         state = STATE_COMMAND_EXECUTED;\n                         curarg.clear();"
      },
      {
        "sha": "9567341ae26037dc9f56e01fdc46e1f0aff3aba8",
        "filename": "src/qt/rpcconsole.h",
        "status": "modified",
        "additions": 4,
        "deletions": 1,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e2d9213c32e51fe197756709e24c6694f28bf842/src/qt/rpcconsole.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e2d9213c32e51fe197756709e24c6694f28bf842/src/qt/rpcconsole.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/rpcconsole.h?ref=e2d9213c32e51fe197756709e24c6694f28bf842",
        "patch": "@@ -36,7 +36,10 @@ class RPCConsole: public QWidget\n     explicit RPCConsole(const PlatformStyle *platformStyle, QWidget *parent);\n     ~RPCConsole();\n \n-    static bool RPCExecuteCommandLine(std::string &strResult, const std::string &strCommand);\n+    static bool RPCParseCommandLine(std::string &strResult, const std::string &strCommand, bool fExecute);\n+    static bool RPCExecuteCommandLine(std::string &strResult, const std::string &strCommand) {\n+        return RPCParseCommandLine(strResult, strCommand, true);\n+    }\n \n     void setClientModel(ClientModel *model);\n "
      }
    ]
  },
  {
    "sha": "629cd423644b1f6d180eb5eeb3fb8a204881db97",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2MjljZDQyMzY0NGIxZjZkMTgwZWI1ZWViM2ZiOGEyMDQ4ODFkYjk3",
    "commit": {
      "author": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2016-11-16T11:36:21Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2016-12-29T11:46:26Z"
      },
      "message": "Qt/RPCConsole: Teach RPCParseCommandLine how to filter out arguments to sensitive commands",
      "tree": {
        "sha": "de9dc28baae2c1f10705c482a7ffce34baa926e9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/de9dc28baae2c1f10705c482a7ffce34baa926e9"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/629cd423644b1f6d180eb5eeb3fb8a204881db97",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/629cd423644b1f6d180eb5eeb3fb8a204881db97",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/629cd423644b1f6d180eb5eeb3fb8a204881db97",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/629cd423644b1f6d180eb5eeb3fb8a204881db97/comments",
    "author": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "e2d9213c32e51fe197756709e24c6694f28bf842",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e2d9213c32e51fe197756709e24c6694f28bf842",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/e2d9213c32e51fe197756709e24c6694f28bf842"
      }
    ],
    "stats": {
      "total": 38,
      "additions": 33,
      "deletions": 5
    },
    "files": [
      {
        "sha": "63a23dc496372f5dab57711b9e3d8db23c259eda",
        "filename": "src/qt/rpcconsole.cpp",
        "status": "modified",
        "additions": 30,
        "deletions": 2,
        "changes": 32,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/629cd423644b1f6d180eb5eeb3fb8a204881db97/src/qt/rpcconsole.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/629cd423644b1f6d180eb5eeb3fb8a204881db97/src/qt/rpcconsole.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/rpcconsole.cpp?ref=629cd423644b1f6d180eb5eeb3fb8a204881db97",
        "patch": "@@ -151,9 +151,10 @@ class QtRPCTimerInterface: public RPCTimerInterface\n  * @param[out]   result      stringified Result from the executed command(chain)\n  * @param[in]    strCommand  Command line to split\n  * @param[in]    fExecute    set true if you want the command to be executed\n+ * @param[out]   pstrFilteredOut  Command line, filtered to remove any sensitive data\n  */\n \n-bool RPCConsole::RPCParseCommandLine(std::string &strResult, const std::string &strCommand, const bool fExecute)\n+bool RPCConsole::RPCParseCommandLine(std::string &strResult, const std::string &strCommand, const bool fExecute, std::string * const pstrFilteredOut)\n {\n     std::vector< std::vector<std::string> > stack;\n     stack.push_back(std::vector<std::string>());\n@@ -173,12 +174,16 @@ bool RPCConsole::RPCParseCommandLine(std::string &strResult, const std::string &\n     } state = STATE_EATING_SPACES;\n     std::string curarg;\n     UniValue lastResult;\n+    unsigned nDepthInsideSensitive = 0;\n+    size_t filter_begin_pos = 0;\n+    std::vector<std::pair<size_t, size_t>> filter_ranges;\n \n     std::string strCommandTerminated = strCommand;\n     if (strCommandTerminated.back() != '\\n')\n         strCommandTerminated += \"\\n\";\n-    for(char ch: strCommandTerminated)\n+    for (size_t chpos = 0; chpos < strCommandTerminated.size(); ++chpos)\n     {\n+        char ch = strCommandTerminated[chpos];\n         switch(state)\n         {\n             case STATE_COMMAND_EXECUTED_INNER:\n@@ -222,6 +227,13 @@ bool RPCConsole::RPCParseCommandLine(std::string &strResult, const std::string &\n                         breakParsing = false;\n \n                         // pop the stack and return the result to the current command arguments\n+                        if (nDepthInsideSensitive) {\n+                            if (!--nDepthInsideSensitive) {\n+                                assert(filter_begin_pos);\n+                                filter_ranges.push_back(std::make_pair(filter_begin_pos, chpos));\n+                                filter_begin_pos = 0;\n+                            }\n+                        }\n                         stack.pop_back();\n \n                         // don't stringify the json in case of a string to avoid doublequotes\n@@ -260,7 +272,12 @@ bool RPCConsole::RPCParseCommandLine(std::string &strResult, const std::string &\n                     if (state == STATE_ARGUMENT)\n                     {\n                         if (ch == '(' && stack.size() && stack.back().size() > 0)\n+                        {\n+                            if (nDepthInsideSensitive) {\n+                                ++nDepthInsideSensitive;\n+                            }\n                             stack.push_back(std::vector<std::string>());\n+                        }\n \n                         // don't allow commands after executed commands on baselevel\n                         if (!stack.size())\n@@ -291,6 +308,11 @@ bool RPCConsole::RPCParseCommandLine(std::string &strResult, const std::string &\n \n                     else if(state == STATE_ARGUMENT) // Space ends argument\n                     {\n+                        // This is the only place where the method name should get pushed (as the first stack item)\n+                        if ((!nDepthInsideSensitive) && historyFilter.contains(QString::fromStdString(curarg), Qt::CaseInsensitive)) {\n+                            nDepthInsideSensitive = 1;\n+                            filter_begin_pos = chpos;\n+                        }\n                         stack.back().push_back(curarg);\n                         curarg.clear();\n                     }\n@@ -328,6 +350,12 @@ bool RPCConsole::RPCParseCommandLine(std::string &strResult, const std::string &\n                 break;\n         }\n     }\n+    if (pstrFilteredOut) {\n+        *pstrFilteredOut = strCommand;\n+        for (auto i = filter_ranges.rbegin(); i != filter_ranges.rend(); ++i) {\n+            pstrFilteredOut->replace(i->first, i->second - i->first, \"...\");\n+        }\n+    }\n     switch(state) // final state\n     {\n         case STATE_COMMAND_EXECUTED:"
      },
      {
        "sha": "dfc1cc26d67760ec551ef4ba0335de4eedae041b",
        "filename": "src/qt/rpcconsole.h",
        "status": "modified",
        "additions": 3,
        "deletions": 3,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/629cd423644b1f6d180eb5eeb3fb8a204881db97/src/qt/rpcconsole.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/629cd423644b1f6d180eb5eeb3fb8a204881db97/src/qt/rpcconsole.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/rpcconsole.h?ref=629cd423644b1f6d180eb5eeb3fb8a204881db97",
        "patch": "@@ -36,9 +36,9 @@ class RPCConsole: public QWidget\n     explicit RPCConsole(const PlatformStyle *platformStyle, QWidget *parent);\n     ~RPCConsole();\n \n-    static bool RPCParseCommandLine(std::string &strResult, const std::string &strCommand, bool fExecute);\n-    static bool RPCExecuteCommandLine(std::string &strResult, const std::string &strCommand) {\n-        return RPCParseCommandLine(strResult, strCommand, true);\n+    static bool RPCParseCommandLine(std::string &strResult, const std::string &strCommand, bool fExecute, std::string * const pstrFilteredOut = NULL);\n+    static bool RPCExecuteCommandLine(std::string &strResult, const std::string &strCommand, std::string * const pstrFilteredOut = NULL) {\n+        return RPCParseCommandLine(strResult, strCommand, true, pstrFilteredOut);\n     }\n \n     void setClientModel(ClientModel *model);"
      }
    ]
  },
  {
    "sha": "a79598ddf4bf35b934ed3513900f2a9fae0bff45",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphNzk1OThkZGY0YmYzNWI5MzRlZDM1MTM5MDBmMmE5ZmFlMGJmZjQ1",
    "commit": {
      "author": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2016-11-16T12:31:44Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2016-12-29T11:46:26Z"
      },
      "message": "Qt/Test: Make sure filtering sensitive data works correctly in nested commands",
      "tree": {
        "sha": "2625c76c6febae60a414639e3d210ac22ec5048a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2625c76c6febae60a414639e3d210ac22ec5048a"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a79598ddf4bf35b934ed3513900f2a9fae0bff45",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a79598ddf4bf35b934ed3513900f2a9fae0bff45",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/a79598ddf4bf35b934ed3513900f2a9fae0bff45",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a79598ddf4bf35b934ed3513900f2a9fae0bff45/comments",
    "author": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "629cd423644b1f6d180eb5eeb3fb8a204881db97",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/629cd423644b1f6d180eb5eeb3fb8a204881db97",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/629cd423644b1f6d180eb5eeb3fb8a204881db97"
      }
    ],
    "stats": {
      "total": 28,
      "additions": 26,
      "deletions": 2
    },
    "files": [
      {
        "sha": "fbec5722b6c22e5b1f0a1dcb3272dd2808900a39",
        "filename": "src/qt/test/rpcnestedtests.cpp",
        "status": "modified",
        "additions": 26,
        "deletions": 2,
        "changes": 28,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a79598ddf4bf35b934ed3513900f2a9fae0bff45/src/qt/test/rpcnestedtests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a79598ddf4bf35b934ed3513900f2a9fae0bff45/src/qt/test/rpcnestedtests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/test/rpcnestedtests.cpp?ref=a79598ddf4bf35b934ed3513900f2a9fae0bff45",
        "patch": "@@ -61,8 +61,10 @@ void RPCNestedTests::rpcNestedTests()\n \n     std::string result;\n     std::string result2;\n-    RPCConsole::RPCExecuteCommandLine(result, \"getblockchaininfo()[chain]\"); //simple result filtering with path\n+    std::string filtered;\n+    RPCConsole::RPCExecuteCommandLine(result, \"getblockchaininfo()[chain]\", &filtered); //simple result filtering with path\n     QVERIFY(result==\"main\");\n+    QVERIFY(filtered == \"getblockchaininfo()[chain]\");\n \n     RPCConsole::RPCExecuteCommandLine(result, \"getblock(getbestblockhash())\"); //simple 2 level nesting\n     RPCConsole::RPCExecuteCommandLine(result, \"getblock(getblock(getbestblockhash())[hash], true)\");\n@@ -87,8 +89,30 @@ void RPCNestedTests::rpcNestedTests()\n     (RPCConsole::RPCExecuteCommandLine(result2, \"createrawtransaction( [],  {} , 0   )\")); //whitespace between parametres is allowed\n     QVERIFY(result == result2);\n \n-    RPCConsole::RPCExecuteCommandLine(result, \"getblock(getbestblockhash())[tx][0]\");\n+    RPCConsole::RPCExecuteCommandLine(result, \"getblock(getbestblockhash())[tx][0]\", &filtered);\n     QVERIFY(result == \"4a5e1e4baab89f3a32518a88c31bc87f618f76673e2cc77ab2127b7afdeda33b\");\n+    QVERIFY(filtered == \"getblock(getbestblockhash())[tx][0]\");\n+\n+    RPCConsole::RPCParseCommandLine(result, \"importprivkey\", false, &filtered);\n+    QVERIFY(filtered == \"importprivkey(\u2026)\");\n+    RPCConsole::RPCParseCommandLine(result, \"signmessagewithprivkey abc\", false, &filtered);\n+    QVERIFY(filtered == \"signmessagewithprivkey(\u2026)\");\n+    RPCConsole::RPCParseCommandLine(result, \"signmessagewithprivkey abc,def\", false, &filtered);\n+    QVERIFY(filtered == \"signmessagewithprivkey(\u2026)\");\n+    RPCConsole::RPCParseCommandLine(result, \"signrawtransaction(abc)\", false, &filtered);\n+    QVERIFY(filtered == \"signrawtransaction(\u2026)\");\n+    RPCConsole::RPCParseCommandLine(result, \"walletpassphrase(help())\", false, &filtered);\n+    QVERIFY(filtered == \"walletpassphrase(\u2026)\");\n+    RPCConsole::RPCParseCommandLine(result, \"walletpassphrasechange(help(walletpassphrasechange(abc)))\", false, &filtered);\n+    QVERIFY(filtered == \"walletpassphrasechange(\u2026)\");\n+    RPCConsole::RPCParseCommandLine(result, \"help(encryptwallet(abc, def))\", false, &filtered);\n+    QVERIFY(filtered == \"help(encryptwallet(\u2026))\");\n+    RPCConsole::RPCParseCommandLine(result, \"help(importprivkey())\", false, &filtered);\n+    QVERIFY(filtered == \"help(importprivkey(\u2026))\");\n+    RPCConsole::RPCParseCommandLine(result, \"help(importprivkey(help()))\", false, &filtered);\n+    QVERIFY(filtered == \"help(importprivkey(\u2026))\");\n+    RPCConsole::RPCParseCommandLine(result, \"help(importprivkey(abc), walletpassphrase(def))\", false, &filtered);\n+    QVERIFY(filtered == \"help(importprivkey(\u2026), walletpassphrase(\u2026))\");\n \n     RPCConsole::RPCExecuteCommandLine(result, \"rpcNestedTest\");\n     QVERIFY(result == \"[]\");"
      }
    ]
  },
  {
    "sha": "ff77faf480cfaf8098cfa04af6cc17a75c19ba49",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmZjc3ZmFmNDgwY2ZhZjgwOThjZmEwNGFmNmNjMTdhNzVjMTliYTQ5",
    "commit": {
      "author": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2016-11-16T12:32:15Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2016-12-29T11:47:58Z"
      },
      "message": "Qt/RPCConsole: Use RPCParseCommandLine to perform command filtering",
      "tree": {
        "sha": "7ea21627fa0385d5123a7b5d7144557f01e6d267",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7ea21627fa0385d5123a7b5d7144557f01e6d267"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ff77faf480cfaf8098cfa04af6cc17a75c19ba49",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ff77faf480cfaf8098cfa04af6cc17a75c19ba49",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/ff77faf480cfaf8098cfa04af6cc17a75c19ba49",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ff77faf480cfaf8098cfa04af6cc17a75c19ba49/comments",
    "author": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "a79598ddf4bf35b934ed3513900f2a9fae0bff45",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a79598ddf4bf35b934ed3513900f2a9fae0bff45",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/a79598ddf4bf35b934ed3513900f2a9fae0bff45"
      }
    ],
    "stats": {
      "total": 77,
      "additions": 46,
      "deletions": 31
    },
    "files": [
      {
        "sha": "5cba588d0c6f17715ee7b375ccaa90e39a6c4cc8",
        "filename": "src/qt/rpcconsole.cpp",
        "status": "modified",
        "additions": 46,
        "deletions": 31,
        "changes": 77,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ff77faf480cfaf8098cfa04af6cc17a75c19ba49/src/qt/rpcconsole.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ff77faf480cfaf8098cfa04af6cc17a75c19ba49/src/qt/rpcconsole.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/rpcconsole.cpp?ref=ff77faf480cfaf8098cfa04af6cc17a75c19ba49",
        "patch": "@@ -31,6 +31,7 @@\n \n #include <QKeyEvent>\n #include <QMenu>\n+#include <QMessageBox>\n #include <QScrollBar>\n #include <QSettings>\n #include <QSignalMapper>\n@@ -74,16 +75,6 @@ const QStringList historyFilter = QStringList()\n     << \"walletpassphrasechange\"\n     << \"encryptwallet\";\n \n-QString command_filter_sensitive_data(const QString cmd)\n-{\n-    Q_FOREACH(QString unallowedCmd, historyFilter) {\n-        if (cmd.trimmed().startsWith(unallowedCmd)) {\n-            return unallowedCmd;\n-        }\n-    }\n-    return cmd;\n-}\n-\n }\n \n /* Object for executing console RPC commands in a separate thread.\n@@ -175,13 +166,32 @@ bool RPCConsole::RPCParseCommandLine(std::string &strResult, const std::string &\n     std::string curarg;\n     UniValue lastResult;\n     unsigned nDepthInsideSensitive = 0;\n-    size_t filter_begin_pos = 0;\n+    size_t filter_begin_pos = 0, chpos;\n     std::vector<std::pair<size_t, size_t>> filter_ranges;\n \n+    auto add_to_current_stack = [&](const std::string& curarg) {\n+        if (stack.back().empty() && (!nDepthInsideSensitive) && historyFilter.contains(QString::fromStdString(curarg), Qt::CaseInsensitive)) {\n+            nDepthInsideSensitive = 1;\n+            filter_begin_pos = chpos;\n+        }\n+        stack.back().push_back(curarg);\n+    };\n+\n+    auto close_out_params = [&]() {\n+        if (nDepthInsideSensitive) {\n+            if (!--nDepthInsideSensitive) {\n+                assert(filter_begin_pos);\n+                filter_ranges.push_back(std::make_pair(filter_begin_pos, chpos));\n+                filter_begin_pos = 0;\n+            }\n+        }\n+        stack.pop_back();\n+    };\n+\n     std::string strCommandTerminated = strCommand;\n     if (strCommandTerminated.back() != '\\n')\n         strCommandTerminated += \"\\n\";\n-    for (size_t chpos = 0; chpos < strCommandTerminated.size(); ++chpos)\n+    for (chpos = 0; chpos < strCommandTerminated.size(); ++chpos)\n     {\n         char ch = strCommandTerminated[chpos];\n         switch(state)\n@@ -227,14 +237,7 @@ bool RPCConsole::RPCParseCommandLine(std::string &strResult, const std::string &\n                         breakParsing = false;\n \n                         // pop the stack and return the result to the current command arguments\n-                        if (nDepthInsideSensitive) {\n-                            if (!--nDepthInsideSensitive) {\n-                                assert(filter_begin_pos);\n-                                filter_ranges.push_back(std::make_pair(filter_begin_pos, chpos));\n-                                filter_begin_pos = 0;\n-                            }\n-                        }\n-                        stack.pop_back();\n+                        close_out_params();\n \n                         // don't stringify the json in case of a string to avoid doublequotes\n                         if (lastResult.isStr())\n@@ -246,7 +249,7 @@ bool RPCConsole::RPCParseCommandLine(std::string &strResult, const std::string &\n                         if (curarg.size())\n                         {\n                             if (stack.size())\n-                                stack.back().push_back(curarg);\n+                                add_to_current_stack(curarg);\n                             else\n                                 strResult = curarg;\n                         }\n@@ -283,7 +286,7 @@ bool RPCConsole::RPCParseCommandLine(std::string &strResult, const std::string &\n                         if (!stack.size())\n                             throw std::runtime_error(\"Invalid Syntax\");\n \n-                        stack.back().push_back(curarg);\n+                        add_to_current_stack(curarg);\n                         curarg.clear();\n                         state = STATE_EATING_SPACES_IN_BRACKETS;\n                     }\n@@ -308,12 +311,7 @@ bool RPCConsole::RPCParseCommandLine(std::string &strResult, const std::string &\n \n                     else if(state == STATE_ARGUMENT) // Space ends argument\n                     {\n-                        // This is the only place where the method name should get pushed (as the first stack item)\n-                        if ((!nDepthInsideSensitive) && historyFilter.contains(QString::fromStdString(curarg), Qt::CaseInsensitive)) {\n-                            nDepthInsideSensitive = 1;\n-                            filter_begin_pos = chpos;\n-                        }\n-                        stack.back().push_back(curarg);\n+                        add_to_current_stack(curarg);\n                         curarg.clear();\n                     }\n                     if ((state == STATE_EATING_SPACES_IN_BRACKETS || state == STATE_ARGUMENT) && ch == ',')\n@@ -351,9 +349,13 @@ bool RPCConsole::RPCParseCommandLine(std::string &strResult, const std::string &\n         }\n     }\n     if (pstrFilteredOut) {\n+        if (STATE_COMMAND_EXECUTED == state) {\n+            assert(!stack.empty());\n+            close_out_params();\n+        }\n         *pstrFilteredOut = strCommand;\n         for (auto i = filter_ranges.rbegin(); i != filter_ranges.rend(); ++i) {\n-            pstrFilteredOut->replace(i->first, i->second - i->first, \"...\");\n+            pstrFilteredOut->replace(i->first, i->second - i->first, \"(\u2026)\");\n         }\n     }\n     switch(state) // final state\n@@ -800,16 +802,29 @@ void RPCConsole::setMempoolSize(long numberOfTxs, size_t dynUsage)\n void RPCConsole::on_lineEdit_returnPressed()\n {\n     QString cmd = ui->lineEdit->text();\n-    ui->lineEdit->clear();\n \n     if(!cmd.isEmpty())\n     {\n+        std::string strFilteredCmd;\n+        try {\n+            std::string dummy;\n+            if (!RPCParseCommandLine(dummy, cmd.toStdString(), false, &strFilteredCmd)) {\n+                // Failed to parse command, so we cannot even filter it for the history\n+                throw std::runtime_error(\"Invalid command line\");\n+            }\n+        } catch (const std::exception& e) {\n+            QMessageBox::critical(this, \"Error\", QString(\"Error: \") + QString::fromStdString(e.what()));\n+            return;\n+        }\n+\n+        ui->lineEdit->clear();\n+\n         cmdBeforeBrowsing = QString();\n \n         message(CMD_REQUEST, cmd);\n         Q_EMIT cmdRequest(cmd);\n \n-        cmd = command_filter_sensitive_data(cmd);\n+        cmd = QString::fromStdString(strFilteredCmd);\n \n         // Remove command, if already in history\n         history.removeOne(cmd);"
      }
    ]
  },
  {
    "sha": "8562792095a78fdef2dacc3c5e32c41206df4c87",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4NTYyNzkyMDk1YTc4ZmRlZjJkYWNjM2M1ZTMyYzQxMjA2ZGY0Yzg3",
    "commit": {
      "author": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2016-11-22T23:37:23Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2016-12-29T11:47:58Z"
      },
      "message": "GUI/RPCConsole: Include importmulti in history sensitive-command filter",
      "tree": {
        "sha": "07173250efdcecab8a921792d71b048d645944a6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/07173250efdcecab8a921792d71b048d645944a6"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8562792095a78fdef2dacc3c5e32c41206df4c87",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/8562792095a78fdef2dacc3c5e32c41206df4c87",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/8562792095a78fdef2dacc3c5e32c41206df4c87",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/8562792095a78fdef2dacc3c5e32c41206df4c87/comments",
    "author": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "ff77faf480cfaf8098cfa04af6cc17a75c19ba49",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ff77faf480cfaf8098cfa04af6cc17a75c19ba49",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/ff77faf480cfaf8098cfa04af6cc17a75c19ba49"
      }
    ],
    "stats": {
      "total": 1,
      "additions": 1,
      "deletions": 0
    },
    "files": [
      {
        "sha": "38fe659c331cbcf627de2d7dc7b3807b60880e20",
        "filename": "src/qt/rpcconsole.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/8562792095a78fdef2dacc3c5e32c41206df4c87/src/qt/rpcconsole.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/8562792095a78fdef2dacc3c5e32c41206df4c87/src/qt/rpcconsole.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/rpcconsole.cpp?ref=8562792095a78fdef2dacc3c5e32c41206df4c87",
        "patch": "@@ -69,6 +69,7 @@ namespace {\n // don't add private key handling cmd's to the history\n const QStringList historyFilter = QStringList()\n     << \"importprivkey\"\n+    << \"importmulti\"\n     << \"signmessagewithprivkey\"\n     << \"signrawtransaction\"\n     << \"walletpassphrase\""
      }
    ]
  }
]