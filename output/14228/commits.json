[
  {
    "sha": "ec1201a36847f7aa942eab1b3a3d082f6daf0031",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplYzEyMDFhMzY4NDdmN2FhOTQyZWFiMWIzYTNkMDgyZjZkYWYwMDMx",
    "commit": {
      "author": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2018-09-15T15:02:14Z"
      },
      "committer": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2018-09-27T14:24:04Z"
      },
      "message": "Don't use systray icon on inappropriate systems\n\nPrevent a user from losing access to the main window by minimizing it to\nthe tray on some systems (e.g. GNOME 3.26+).",
      "tree": {
        "sha": "4978fc05c896a833dc907df472ac66c0f6bf56fe",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4978fc05c896a833dc907df472ac66c0f6bf56fe"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ec1201a36847f7aa942eab1b3a3d082f6daf0031",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE0dvyxLlvLev0wWZUQQEIES5+qB8FAlus6AwACgkQQQEIES5+\nqB9/TBAAiPsJQNlmH2ycIKrTnZMdHEP8+EIVck+szQxa3hRXLYFk4UZ4JX7bZXLK\nvIZDxQ+lPGRLxxTo6s3jkO/FxQACzmhJ7PduXvB3vnS+/jRpDWk3d6MQnwpO5pPA\nbFHxrU7PA1G5NeNwAsoxDuTJR9Y6Mt6BjvvSRIT76e8dE8Hu8jJvdHgtEBfuXU0l\njT22JztRWKH/kiOFagLnXFpTddsYGaynS+EAWd36ohhxkcyli1+j/8f7RIJoHPhY\nLhRFPj0GYP6ZxwkkVAjDe1KMZbw1DF/stKRAM6XybqHa/D6GCdH3vUR3K/Rzn4by\n+3F8HE7NF4L0zT6KX994BJWowx7KumgVv/IJ7DUVfreCNc8nYRakmLcUCfrnMbzN\nBzbdw0mcW6O4gOacF6cetZJkOh83Px1qWZ5P/VQr//bL51XePxpave7OOdSiJhaz\n+NmJKuDg0ak5HSIJCbb5ihAp0q981zR6UObYL+G4CjbwDIYQT6k4rRWB01gfs8Dp\nbArgc1QGmxqZuQXAbKPxXG7PoduMCKQpfoWi0i2dV6KIoSzCvU/U66bYTQ05VsDX\nD6ojINPuOEvztIu4YGhGD5SQxfex78KjZ/YkbHWt2pQYMk70j8rd0F06rYBV2HH1\nGaXi+VDcbyAKp6CQTLKh+X9Y5c64+2NBvu3w+uKYWLC0BbCcqKo=\n=6WQG\n-----END PGP SIGNATURE-----",
        "payload": "tree 4978fc05c896a833dc907df472ac66c0f6bf56fe\nparent d799efe21432ad55c41d5315f24c002bc8b3d119\nauthor Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1537023734 +0300\ncommitter Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1538058244 +0300\n\nDon't use systray icon on inappropriate systems\n\nPrevent a user from losing access to the main window by minimizing it to\nthe tray on some systems (e.g. GNOME 3.26+).\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ec1201a36847f7aa942eab1b3a3d082f6daf0031",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/ec1201a36847f7aa942eab1b3a3d082f6daf0031",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ec1201a36847f7aa942eab1b3a3d082f6daf0031/comments",
    "author": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "d799efe21432ad55c41d5315f24c002bc8b3d119",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d799efe21432ad55c41d5315f24c002bc8b3d119",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/d799efe21432ad55c41d5315f24c002bc8b3d119"
      }
    ],
    "stats": {
      "total": 20,
      "additions": 17,
      "deletions": 3
    },
    "files": [
      {
        "sha": "4540fec4f75711022a916ae3ebfa634f9678f3da",
        "filename": "src/qt/bitcoingui.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 1,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ec1201a36847f7aa942eab1b3a3d082f6daf0031/src/qt/bitcoingui.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ec1201a36847f7aa942eab1b3a3d082f6daf0031/src/qt/bitcoingui.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoingui.cpp?ref=ec1201a36847f7aa942eab1b3a3d082f6daf0031",
        "patch": "@@ -131,7 +131,9 @@ BitcoinGUI::BitcoinGUI(interfaces::Node& node, const PlatformStyle *_platformSty\n     createToolBars();\n \n     // Create system tray icon and notification\n-    createTrayIcon(networkStyle);\n+    if (QSystemTrayIcon::isSystemTrayAvailable()) {\n+        createTrayIcon(networkStyle);\n+    }\n \n     // Create status bar\n     statusBar();\n@@ -585,6 +587,8 @@ void BitcoinGUI::setWalletActionsEnabled(bool enabled)\n \n void BitcoinGUI::createTrayIcon(const NetworkStyle *networkStyle)\n {\n+    assert(QSystemTrayIcon::isSystemTrayAvailable());\n+\n #ifndef Q_OS_MAC\n     trayIcon = new QSystemTrayIcon(this);\n     QString toolTip = tr(\"%1 client\").arg(tr(PACKAGE_NAME)) + \" \" + networkStyle->getTitleAddText();"
      },
      {
        "sha": "c9871f6c669526e6ea6d7550db1d79904aaeb90c",
        "filename": "src/qt/optionsdialog.cpp",
        "status": "modified",
        "additions": 12,
        "deletions": 2,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ec1201a36847f7aa942eab1b3a3d082f6daf0031/src/qt/optionsdialog.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ec1201a36847f7aa942eab1b3a3d082f6daf0031/src/qt/optionsdialog.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/optionsdialog.cpp?ref=ec1201a36847f7aa942eab1b3a3d082f6daf0031",
        "patch": "@@ -23,6 +23,7 @@\n #include <QIntValidator>\n #include <QLocale>\n #include <QMessageBox>\n+#include <QSystemTrayIcon>\n #include <QTimer>\n \n OptionsDialog::OptionsDialog(QWidget *parent, bool enableWallet) :\n@@ -126,6 +127,13 @@ OptionsDialog::OptionsDialog(QWidget *parent, bool enableWallet) :\n     connect(ui->proxyIpTor, &QValidatedLineEdit::validationDidChange, this, &OptionsDialog::updateProxyValidationState);\n     connect(ui->proxyPort, &QLineEdit::textChanged, this, &OptionsDialog::updateProxyValidationState);\n     connect(ui->proxyPortTor, &QLineEdit::textChanged, this, &OptionsDialog::updateProxyValidationState);\n+\n+    if (!QSystemTrayIcon::isSystemTrayAvailable()) {\n+        ui->hideTrayIcon->setChecked(true);\n+        ui->hideTrayIcon->setEnabled(false);\n+        ui->minimizeToTray->setChecked(false);\n+        ui->minimizeToTray->setEnabled(false);\n+    }\n }\n \n OptionsDialog::~OptionsDialog()\n@@ -211,8 +219,10 @@ void OptionsDialog::setMapper()\n \n     /* Window */\n #ifndef Q_OS_MAC\n-    mapper->addMapping(ui->hideTrayIcon, OptionsModel::HideTrayIcon);\n-    mapper->addMapping(ui->minimizeToTray, OptionsModel::MinimizeToTray);\n+    if (QSystemTrayIcon::isSystemTrayAvailable()) {\n+        mapper->addMapping(ui->hideTrayIcon, OptionsModel::HideTrayIcon);\n+        mapper->addMapping(ui->minimizeToTray, OptionsModel::MinimizeToTray);\n+    }\n     mapper->addMapping(ui->minimizeOnClose, OptionsModel::MinimizeOnClose);\n #endif\n "
      }
    ]
  }
]