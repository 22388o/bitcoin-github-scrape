[
  {
    "sha": "83d1d1a90603c6d063d176a3d5efdeb1074b0fe4",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4M2QxZDFhOTA2MDNjNmQwNjNkMTc2YTNkNWVmZGViMTA3NGIwZmU0",
    "commit": {
      "author": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2012-02-17T12:50:32Z"
      },
      "committer": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2012-02-17T16:14:02Z"
      },
      "message": "Hide window from taskbar when \"minimize to tray\" active by making window into Tool window",
      "tree": {
        "sha": "3d0228b238e448c0e4977fe2f348b2bae0658424",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3d0228b238e448c0e4977fe2f348b2bae0658424"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/83d1d1a90603c6d063d176a3d5efdeb1074b0fe4",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/83d1d1a90603c6d063d176a3d5efdeb1074b0fe4",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/83d1d1a90603c6d063d176a3d5efdeb1074b0fe4",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/83d1d1a90603c6d063d176a3d5efdeb1074b0fe4/comments",
    "author": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "b7c25e0c1346256be12310264ea5cc4ce7794118",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b7c25e0c1346256be12310264ea5cc4ce7794118",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/b7c25e0c1346256be12310264ea5cc4ce7794118"
      }
    ],
    "stats": {
      "total": 31,
      "additions": 9,
      "deletions": 22
    },
    "files": [
      {
        "sha": "a3b4fd2a821478860a3f6b80b06c4d40d91dbbff",
        "filename": "src/qt/bitcoingui.cpp",
        "status": "modified",
        "additions": 9,
        "deletions": 18,
        "changes": 27,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/83d1d1a90603c6d063d176a3d5efdeb1074b0fe4/src/qt/bitcoingui.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/83d1d1a90603c6d063d176a3d5efdeb1074b0fe4/src/qt/bitcoingui.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoingui.cpp?ref=83d1d1a90603c6d063d176a3d5efdeb1074b0fe4",
        "patch": "@@ -56,7 +56,6 @@ BitcoinGUI::BitcoinGUI(QWidget *parent):\n     QMainWindow(parent),\n     clientModel(0),\n     walletModel(0),\n-    dummyWidget(0),\n     encryptWalletAction(0),\n     changePassphraseAction(0),\n     aboutQtAction(0),\n@@ -86,9 +85,6 @@ BitcoinGUI::BitcoinGUI(QWidget *parent):\n     // Create the tray icon (or setup the dock icon)\n     createTrayIcon();\n \n-    // Dummy widget used when restoring window state after minimization\n-    dummyWidget = new QWidget();\n-\n     // Create tabs\n     overviewPage = new OverviewPage();\n \n@@ -166,7 +162,6 @@ BitcoinGUI::~BitcoinGUI()\n #ifdef Q_WS_MAC\n     delete appMenuBar;\n #endif\n-    delete dummyWidget;\n }\n \n void BitcoinGUI::createActions()\n@@ -414,14 +409,6 @@ void BitcoinGUI::trayIconActivated(QSystemTrayIcon::ActivationReason reason)\n }\n #endif\n \n-void BitcoinGUI::showNormal()\n-{\n-    // Reparent window to the desktop (in case it was hidden on minimize)\n-    if(parent() != NULL)\n-        setParent(NULL, Qt::Window);\n-    QMainWindow::showNormal();\n-}\n-\n void BitcoinGUI::optionsClicked()\n {\n     if(!clientModel || !clientModel->getOptionsModel())\n@@ -561,15 +548,19 @@ void BitcoinGUI::changeEvent(QEvent *e)\n     {\n         if(clientModel && clientModel->getOptionsModel()->getMinimizeToTray())\n         {\n-            if(isMinimized())\n+            QWindowStateChangeEvent *wsevt = static_cast<QWindowStateChangeEvent*>(e);\n+            bool wasMinimized = wsevt->oldState() & Qt::WindowMinimized;\n+            bool isMinimized = windowState() & Qt::WindowMinimized;\n+            if(!wasMinimized && isMinimized)\n             {\n-                // Hiding the window from taskbar\n-                setParent(dummyWidget, Qt::SubWindow);\n+                // Minimized, hide the window from taskbar\n+                setWindowFlags(windowFlags() | Qt::Tool);\n                 return;\n             }\n-            else\n+            else if(wasMinimized && !isMinimized)\n             {\n-                showNormal();\n+                // Unminimized, show the window in taskbar\n+                setWindowFlags(windowFlags() &~ Qt::Tool);\n             }\n         }\n     }"
      },
      {
        "sha": "09ad89a894054f7fc3262622941256ceb53683fd",
        "filename": "src/qt/bitcoingui.h",
        "status": "modified",
        "additions": 0,
        "deletions": 4,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/83d1d1a90603c6d063d176a3d5efdeb1074b0fe4/src/qt/bitcoingui.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/83d1d1a90603c6d063d176a3d5efdeb1074b0fe4/src/qt/bitcoingui.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoingui.h?ref=83d1d1a90603c6d063d176a3d5efdeb1074b0fe4",
        "patch": "@@ -58,8 +58,6 @@ class BitcoinGUI : public QMainWindow\n \n     QStackedWidget *centralWidget;\n \n-    QWidget *dummyWidget;\n-\n     OverviewPage *overviewPage;\n     QWidget *transactionsPage;\n     AddressBookPage *addressBookPage;\n@@ -133,8 +131,6 @@ public slots:\n     void gotoMessagePage();\n     void gotoMessagePage(QString);\n \n-    void showNormal();\n-\n private slots:\n     /** Switch to overview (home) page */\n     void gotoOverviewPage();"
      }
    ]
  },
  {
    "sha": "17690ea5a74005bd8c9e99702f75d690e70c7b2f",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxNzY5MGVhNWE3NDAwNWJkOGM5ZTk5NzAyZjc1ZDY5MGU3MGM3YjJm",
    "commit": {
      "author": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2012-02-17T22:19:52Z"
      },
      "committer": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2012-02-17T22:19:52Z"
      },
      "message": "Do show/showNormal only when needed.",
      "tree": {
        "sha": "8e403fe9b39d67b5616d515bd9640daf522c6aa3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8e403fe9b39d67b5616d515bd9640daf522c6aa3"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/17690ea5a74005bd8c9e99702f75d690e70c7b2f",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/17690ea5a74005bd8c9e99702f75d690e70c7b2f",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/17690ea5a74005bd8c9e99702f75d690e70c7b2f",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/17690ea5a74005bd8c9e99702f75d690e70c7b2f/comments",
    "author": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "83d1d1a90603c6d063d176a3d5efdeb1074b0fe4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/83d1d1a90603c6d063d176a3d5efdeb1074b0fe4",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/83d1d1a90603c6d063d176a3d5efdeb1074b0fe4"
      }
    ],
    "stats": {
      "total": 25,
      "additions": 18,
      "deletions": 7
    },
    "files": [
      {
        "sha": "3d6d7d7344d7d8b08970ac0b046318a51d76e096",
        "filename": "src/qt/bitcoingui.cpp",
        "status": "modified",
        "additions": 15,
        "deletions": 7,
        "changes": 22,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/17690ea5a74005bd8c9e99702f75d690e70c7b2f/src/qt/bitcoingui.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/17690ea5a74005bd8c9e99702f75d690e70c7b2f/src/qt/bitcoingui.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoingui.cpp?ref=17690ea5a74005bd8c9e99702f75d690e70c7b2f",
        "patch": "@@ -205,17 +205,17 @@ void BitcoinGUI::createActions()\n #endif\n     tabGroup->addAction(messageAction);\n \n-    connect(overviewAction, SIGNAL(triggered()), this, SLOT(showNormal()));\n+    connect(overviewAction, SIGNAL(triggered()), this, SLOT(showNormalIfMinimized()));\n     connect(overviewAction, SIGNAL(triggered()), this, SLOT(gotoOverviewPage()));\n-    connect(historyAction, SIGNAL(triggered()), this, SLOT(showNormal()));\n+    connect(historyAction, SIGNAL(triggered()), this, SLOT(showNormalIfMinimized()));\n     connect(historyAction, SIGNAL(triggered()), this, SLOT(gotoHistoryPage()));\n-    connect(addressBookAction, SIGNAL(triggered()), this, SLOT(showNormal()));\n+    connect(addressBookAction, SIGNAL(triggered()), this, SLOT(showNormalIfMinimized()));\n     connect(addressBookAction, SIGNAL(triggered()), this, SLOT(gotoAddressBookPage()));\n-    connect(receiveCoinsAction, SIGNAL(triggered()), this, SLOT(showNormal()));\n+    connect(receiveCoinsAction, SIGNAL(triggered()), this, SLOT(showNormalIfMinimized()));\n     connect(receiveCoinsAction, SIGNAL(triggered()), this, SLOT(gotoReceiveCoinsPage()));\n-    connect(sendCoinsAction, SIGNAL(triggered()), this, SLOT(showNormal()));\n+    connect(sendCoinsAction, SIGNAL(triggered()), this, SLOT(showNormalIfMinimized()));\n     connect(sendCoinsAction, SIGNAL(triggered()), this, SLOT(gotoSendCoinsPage()));\n-    connect(messageAction, SIGNAL(triggered()), this, SLOT(showNormal()));\n+    connect(messageAction, SIGNAL(triggered()), this, SLOT(showNormalIfMinimized()));\n     connect(messageAction, SIGNAL(triggered()), this, SLOT(gotoMessagePage()));\n \n     quitAction = new QAction(QIcon(\":/icons/quit\"), tr(\"E&xit\"), this);\n@@ -245,7 +245,7 @@ void BitcoinGUI::createActions()\n     connect(optionsAction, SIGNAL(triggered()), this, SLOT(optionsClicked()));\n     connect(aboutAction, SIGNAL(triggered()), this, SLOT(aboutClicked()));\n     connect(aboutQtAction, SIGNAL(triggered()), qApp, SLOT(aboutQt()));\n-    connect(openBitcoinAction, SIGNAL(triggered()), this, SLOT(showNormal()));\n+    connect(openBitcoinAction, SIGNAL(triggered()), this, SLOT(showNormalIfMinimized()));\n     connect(encryptWalletAction, SIGNAL(triggered(bool)), this, SLOT(encryptWallet(bool)));\n     connect(changePassphraseAction, SIGNAL(triggered()), this, SLOT(changePassphrase()));\n }\n@@ -788,3 +788,11 @@ void BitcoinGUI::unlockWallet()\n         dlg.exec();\n     }\n }\n+\n+void BitcoinGUI::showNormalIfMinimized()\n+{\n+    if(!isVisible()) // Show, if hidden\n+        show();\n+    if(isMinimized()) // Unminimize, if minimized\n+        showNormal();\n+}"
      },
      {
        "sha": "f996e6ba25d9d8bcd6be57291e1fd4681cdc3d19",
        "filename": "src/qt/bitcoingui.h",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/17690ea5a74005bd8c9e99702f75d690e70c7b2f/src/qt/bitcoingui.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/17690ea5a74005bd8c9e99702f75d690e70c7b2f/src/qt/bitcoingui.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoingui.h?ref=17690ea5a74005bd8c9e99702f75d690e70c7b2f",
        "patch": "@@ -162,6 +162,9 @@ private slots:\n     void changePassphrase();\n     /** Ask for pass phrase to unlock wallet temporarily */\n     void unlockWallet();\n+\n+    /** Show window if hidden, unminimize when minimized */\n+    void showNormalIfMinimized();\n };\n \n #endif"
      }
    ]
  }
]