[
  {
    "sha": "5b158707f23a290c750a083c8f7d43915bcc48c5",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo1YjE1ODcwN2YyM2EyOTBjNzUwYTA4M2M4ZjdkNDM5MTViY2M0OGM1",
    "commit": {
      "author": {
        "name": "Alex Morcos",
        "email": "morcos@chaincode.com",
        "date": "2017-01-19T21:17:38Z"
      },
      "committer": {
        "name": "Alex Morcos",
        "email": "morcos@chaincode.com",
        "date": "2017-01-20T01:31:29Z"
      },
      "message": "Use incrementalRelayFee for BIP 125 replacement",
      "tree": {
        "sha": "f0b49236012d13a64793127aed5f29918dcabd9c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f0b49236012d13a64793127aed5f29918dcabd9c"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/5b158707f23a290c750a083c8f7d43915bcc48c5",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/5b158707f23a290c750a083c8f7d43915bcc48c5",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/5b158707f23a290c750a083c8f7d43915bcc48c5",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/5b158707f23a290c750a083c8f7d43915bcc48c5/comments",
    "author": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "82274c02ed2d82537dc55f008a29edb1bc09bbc4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/82274c02ed2d82537dc55f008a29edb1bc09bbc4",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/82274c02ed2d82537dc55f008a29edb1bc09bbc4"
      }
    ],
    "stats": {
      "total": 18,
      "additions": 9,
      "deletions": 9
    },
    "files": [
      {
        "sha": "e605671e7dcf2f263aca366733206e50d94da8e2",
        "filename": "src/validation.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/5b158707f23a290c750a083c8f7d43915bcc48c5/src/validation.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/5b158707f23a290c750a083c8f7d43915bcc48c5/src/validation.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/validation.cpp?ref=5b158707f23a290c750a083c8f7d43915bcc48c5",
        "patch": "@@ -898,14 +898,14 @@ bool AcceptToMemoryPoolWorker(CTxMemPool& pool, CValidationState& state, const C\n             // Finally in addition to paying more fees than the conflicts the\n             // new transaction must pay for its own bandwidth.\n             CAmount nDeltaFees = nModifiedFees - nConflictingFees;\n-            if (nDeltaFees < ::minRelayTxFee.GetFee(nSize))\n+            if (nDeltaFees < ::incrementalRelayFee.GetFee(nSize))\n             {\n                 return state.DoS(0, false,\n                         REJECT_INSUFFICIENTFEE, \"insufficient fee\", false,\n                         strprintf(\"rejecting replacement %s, not enough additional fees to relay; %s < %s\",\n                               hash.ToString(),\n                               FormatMoney(nDeltaFees),\n-                              FormatMoney(::minRelayTxFee.GetFee(nSize))));\n+                              FormatMoney(::incrementalRelayFee.GetFee(nSize))));\n             }\n         }\n "
      },
      {
        "sha": "07c3688a4d3a46cec2fc36230951e6378df48798",
        "filename": "src/wallet/rpcwallet.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 7,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/5b158707f23a290c750a083c8f7d43915bcc48c5/src/wallet/rpcwallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/5b158707f23a290c750a083c8f7d43915bcc48c5/src/wallet/rpcwallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/rpcwallet.cpp?ref=5b158707f23a290c750a083c8f7d43915bcc48c5",
        "patch": "@@ -2652,8 +2652,8 @@ UniValue bumpfee(const JSONRPCRequest& request)\n             \"By default, the new fee will be calculated automatically using estimatefee.\\n\"\n             \"The user can specify a confirmation target for estimatefee.\\n\"\n             \"Alternatively, the user can specify totalFee, or use RPC setpaytxfee to set a higher fee rate.\\n\"\n-            \"At a minimum, the new fee rate must be high enough to pay a new relay fee (relay fee amount returned\\n\"\n-            \"by getnetworkinfo RPC) and to enter the node's mempool.\\n\"\n+            \"At a minimum, the new fee rate must be high enough to pay a new relay fee over the original fee\\n\"\n+            \"to enter the node's mempool.\\n\"\n             \"\\nArguments:\\n\"\n             \"1. txid                  (string, required) The txid to be bumped\\n\"\n             \"2. options               (object, optional)\\n\"\n@@ -2787,9 +2787,9 @@ UniValue bumpfee(const JSONRPCRequest& request)\n     CFeeRate nNewFeeRate;\n \n     if (totalFee > 0) {\n-        CAmount minTotalFee = nOldFeeRate.GetFee(maxNewTxSize) + minRelayTxFee.GetFee(maxNewTxSize);\n+        CAmount minTotalFee = nOldFeeRate.GetFee(maxNewTxSize) + ::incrementalRelayFee.GetFee(maxNewTxSize);\n         if (totalFee < minTotalFee) {\n-            throw JSONRPCError(RPC_INVALID_PARAMETER, strprintf(\"Invalid totalFee, must be at least %s (oldFee %s + relayFee %s)\", FormatMoney(minTotalFee), nOldFeeRate.GetFee(maxNewTxSize), minRelayTxFee.GetFee(maxNewTxSize)));\n+            throw JSONRPCError(RPC_INVALID_PARAMETER, strprintf(\"Invalid totalFee, must be at least %s (oldFee %s + relayFee %s)\", FormatMoney(minTotalFee), nOldFeeRate.GetFee(maxNewTxSize), ::incrementalRelayFee.GetFee(maxNewTxSize)));\n         }\n         nNewFee = totalFee;\n         nNewFeeRate = CFeeRate(totalFee, maxNewTxSize);\n@@ -2804,9 +2804,9 @@ UniValue bumpfee(const JSONRPCRequest& request)\n             nNewFeeRate = CWallet::fallbackFee;\n         }\n \n-        // new fee rate must be at least old rate + minimum relay rate\n-        if (nNewFeeRate.GetFeePerK() < nOldFeeRate.GetFeePerK() + ::minRelayTxFee.GetFeePerK()) {\n-            nNewFeeRate = CFeeRate(nOldFeeRate.GetFeePerK() + ::minRelayTxFee.GetFeePerK());\n+        // new fee rate must be at least old rate + minimum incremental relay rate\n+        if (nNewFeeRate.GetFeePerK() < nOldFeeRate.GetFeePerK() + ::incrementalRelayFee.GetFeePerK()) {\n+            nNewFeeRate = CFeeRate(nOldFeeRate.GetFeePerK() + ::incrementalRelayFee.GetFeePerK());\n         }\n \n         nNewFee = nNewFeeRate.GetFee(maxNewTxSize);"
      }
    ]
  },
  {
    "sha": "de6400de5d4b654007f21901d9555ddea0face82",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkZTY0MDBkZTVkNGI2NTQwMDdmMjE5MDFkOTU1NWRkZWEwZmFjZTgy",
    "commit": {
      "author": {
        "name": "Alex Morcos",
        "email": "morcos@chaincode.com",
        "date": "2017-01-19T21:18:24Z"
      },
      "committer": {
        "name": "Alex Morcos",
        "email": "morcos@chaincode.com",
        "date": "2017-01-20T01:31:29Z"
      },
      "message": "Fix missing use of dustRelayFee",
      "tree": {
        "sha": "152210a039c84554b6a44df3e45e8fa8c242e100",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/152210a039c84554b6a44df3e45e8fa8c242e100"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/de6400de5d4b654007f21901d9555ddea0face82",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/de6400de5d4b654007f21901d9555ddea0face82",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/de6400de5d4b654007f21901d9555ddea0face82",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/de6400de5d4b654007f21901d9555ddea0face82/comments",
    "author": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "5b158707f23a290c750a083c8f7d43915bcc48c5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/5b158707f23a290c750a083c8f7d43915bcc48c5",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/5b158707f23a290c750a083c8f7d43915bcc48c5"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 1,
      "deletions": 1
    },
    "files": [
      {
        "sha": "c0f7bbcb42fab94869ebc1e660040d0526238a14",
        "filename": "src/wallet/rpcwallet.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/de6400de5d4b654007f21901d9555ddea0face82/src/wallet/rpcwallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/de6400de5d4b654007f21901d9555ddea0face82/src/wallet/rpcwallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/rpcwallet.cpp?ref=de6400de5d4b654007f21901d9555ddea0face82",
        "patch": "@@ -2834,7 +2834,7 @@ UniValue bumpfee(const JSONRPCRequest& request)\n \n     // If the output would become dust, discard it (converting the dust to fee)\n     poutput->nValue -= nDelta;\n-    if (poutput->nValue <= poutput->GetDustThreshold(::minRelayTxFee)) {\n+    if (poutput->nValue <= poutput->GetDustThreshold(::dustRelayFee)) {\n         LogPrint(\"rpc\", \"Bumping fee and discarding dust output\\n\");\n         nNewFee += poutput->nValue;\n         tx.vout.erase(tx.vout.begin() + nOutput);"
      }
    ]
  },
  {
    "sha": "6b331e6cf977caa20c83a28a8c6c2af0b6c451c5",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2YjMzMWU2Y2Y5NzdjYWEyMGM4M2EyOGE4YzZjMmFmMGI2YzQ1MWM1",
    "commit": {
      "author": {
        "name": "Alex Morcos",
        "email": "morcos@chaincode.com",
        "date": "2017-01-20T02:02:54Z"
      },
      "committer": {
        "name": "Alex Morcos",
        "email": "morcos@chaincode.com",
        "date": "2017-01-20T02:35:39Z"
      },
      "message": "Fix to have miner test aware of new separate block min tx fee",
      "tree": {
        "sha": "d193a52f0ed63168070e4bb328c0f36457a3f6b0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d193a52f0ed63168070e4bb328c0f36457a3f6b0"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6b331e6cf977caa20c83a28a8c6c2af0b6c451c5",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6b331e6cf977caa20c83a28a8c6c2af0b6c451c5",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/6b331e6cf977caa20c83a28a8c6c2af0b6c451c5",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6b331e6cf977caa20c83a28a8c6c2af0b6c451c5/comments",
    "author": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "de6400de5d4b654007f21901d9555ddea0face82",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/de6400de5d4b654007f21901d9555ddea0face82",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/de6400de5d4b654007f21901d9555ddea0face82"
      }
    ],
    "stats": {
      "total": 11,
      "additions": 7,
      "deletions": 4
    },
    "files": [
      {
        "sha": "f856d8a91a704b20b29c42cf74e2f06d7d9def64",
        "filename": "src/test/miner_tests.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 4,
        "changes": 11,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6b331e6cf977caa20c83a28a8c6c2af0b6c451c5/src/test/miner_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6b331e6cf977caa20c83a28a8c6c2af0b6c451c5/src/test/miner_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/miner_tests.cpp?ref=6b331e6cf977caa20c83a28a8c6c2af0b6c451c5",
        "patch": "@@ -9,6 +9,7 @@\n #include \"consensus/validation.h\"\n #include \"validation.h\"\n #include \"miner.h\"\n+#include \"policy/policy.h\"\n #include \"pubkey.h\"\n #include \"script/standard.h\"\n #include \"txmempool.h\"\n@@ -24,6 +25,8 @@\n \n BOOST_FIXTURE_TEST_SUITE(miner_tests, TestingSetup)\n \n+static CFeeRate blockMinFeeRate = CFeeRate(DEFAULT_BLOCK_MIN_TX_FEE);\n+\n static\n struct {\n     unsigned char extranonce;\n@@ -112,16 +115,16 @@ void TestPackageSelection(const CChainParams& chainparams, CScript scriptPubKey,\n     BOOST_CHECK(pblocktemplate->block.vtx[2]->GetHash() == hashHighFeeTx);\n     BOOST_CHECK(pblocktemplate->block.vtx[3]->GetHash() == hashMediumFeeTx);\n \n-    // Test that a package below the min relay fee doesn't get included\n+    // Test that a package below the block min tx fee doesn't get included\n     tx.vin[0].prevout.hash = hashHighFeeTx;\n     tx.vout[0].nValue = 5000000000LL - 1000 - 50000; // 0 fee\n     uint256 hashFreeTx = tx.GetHash();\n     mempool.addUnchecked(hashFreeTx, entry.Fee(0).FromTx(tx));\n     size_t freeTxSize = ::GetSerializeSize(tx, SER_NETWORK, PROTOCOL_VERSION);\n \n     // Calculate a fee on child transaction that will put the package just\n-    // below the min relay fee (assuming 1 child tx of the same size).\n-    CAmount feeToUse = minRelayTxFee.GetFee(2*freeTxSize) - 1;\n+    // below the block min tx fee (assuming 1 child tx of the same size).\n+    CAmount feeToUse = blockMinFeeRate.GetFee(2*freeTxSize) - 1;\n \n     tx.vin[0].prevout.hash = hashFreeTx;\n     tx.vout[0].nValue = 5000000000LL - 1000 - 50000 - feeToUse;\n@@ -158,7 +161,7 @@ void TestPackageSelection(const CChainParams& chainparams, CScript scriptPubKey,\n     // This tx can't be mined by itself\n     tx.vin[0].prevout.hash = hashFreeTx2;\n     tx.vout.resize(1);\n-    feeToUse = minRelayTxFee.GetFee(freeTxSize);\n+    feeToUse = blockMinFeeRate.GetFee(freeTxSize);\n     tx.vout[0].nValue = 5000000000LL - 100000000 - feeToUse;\n     uint256 hashLowFeeTx2 = tx.GetHash();\n     mempool.addUnchecked(hashLowFeeTx2, entry.Fee(feeToUse).SpendsCoinbase(false).FromTx(tx));"
      }
    ]
  },
  {
    "sha": "fe8e8efcf91fa92db68aabeb0a1709b032e60dd6",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmZThlOGVmY2Y5MWZhOTJkYjY4YWFiZWIwYTE3MDliMDMyZTYwZGQ2",
    "commit": {
      "author": {
        "name": "Alex Morcos",
        "email": "morcos@chaincode.com",
        "date": "2017-01-20T02:18:46Z"
      },
      "committer": {
        "name": "Alex Morcos",
        "email": "morcos@chaincode.com",
        "date": "2017-01-20T12:40:36Z"
      },
      "message": "[rpc] Add incremental relay fee to getnetworkinfo",
      "tree": {
        "sha": "728949a4dc0b20890f579403cece6946de6cae0c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/728949a4dc0b20890f579403cece6946de6cae0c"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fe8e8efcf91fa92db68aabeb0a1709b032e60dd6",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fe8e8efcf91fa92db68aabeb0a1709b032e60dd6",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fe8e8efcf91fa92db68aabeb0a1709b032e60dd6",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fe8e8efcf91fa92db68aabeb0a1709b032e60dd6/comments",
    "author": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "6b331e6cf977caa20c83a28a8c6c2af0b6c451c5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6b331e6cf977caa20c83a28a8c6c2af0b6c451c5",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/6b331e6cf977caa20c83a28a8c6c2af0b6c451c5"
      }
    ],
    "stats": {
      "total": 7,
      "additions": 5,
      "deletions": 2
    },
    "files": [
      {
        "sha": "36c22943791ed7a030634d304c4f346ec1c64fd0",
        "filename": "src/rpc/net.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fe8e8efcf91fa92db68aabeb0a1709b032e60dd6/src/rpc/net.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fe8e8efcf91fa92db68aabeb0a1709b032e60dd6/src/rpc/net.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/net.cpp?ref=fe8e8efcf91fa92db68aabeb0a1709b032e60dd6",
        "patch": "@@ -10,6 +10,7 @@\n #include \"net.h\"\n #include \"net_processing.h\"\n #include \"netbase.h\"\n+#include \"policy/policy.h\"\n #include \"protocol.h\"\n #include \"sync.h\"\n #include \"timedata.h\"\n@@ -417,6 +418,7 @@ UniValue getnetworkinfo(const JSONRPCRequest& request)\n             \"  ,...\\n\"\n             \"  ],\\n\"\n             \"  \\\"relayfee\\\": x.xxxxxxxx,                (numeric) minimum relay fee for non-free transactions in \" + CURRENCY_UNIT + \"/kB\\n\"\n+            \"  \\\"incrementalfee\\\": x.xxxxxxxx,          (numeric) minimum fee increment for mempool limiting or BIP 125 replacement in \" + CURRENCY_UNIT + \"/kB\\n\"\n             \"  \\\"localaddresses\\\": [                    (array) list of local addresses\\n\"\n             \"  {\\n\"\n             \"    \\\"address\\\": \\\"xxxx\\\",                 (string) network address\\n\"\n@@ -447,6 +449,7 @@ UniValue getnetworkinfo(const JSONRPCRequest& request)\n     }\n     obj.push_back(Pair(\"networks\",      GetNetworksInfo()));\n     obj.push_back(Pair(\"relayfee\",      ValueFromAmount(::minRelayTxFee.GetFeePerK())));\n+    obj.push_back(Pair(\"incrementalfee\", ValueFromAmount(::incrementalRelayFee.GetFeePerK())));\n     UniValue localAddresses(UniValue::VARR);\n     {\n         LOCK(cs_mapLocalHost);"
      },
      {
        "sha": "b62fbeb10eb4e1126de111212cb4ef7f322b09bf",
        "filename": "src/wallet/rpcwallet.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fe8e8efcf91fa92db68aabeb0a1709b032e60dd6/src/wallet/rpcwallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fe8e8efcf91fa92db68aabeb0a1709b032e60dd6/src/wallet/rpcwallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/rpcwallet.cpp?ref=fe8e8efcf91fa92db68aabeb0a1709b032e60dd6",
        "patch": "@@ -2652,8 +2652,8 @@ UniValue bumpfee(const JSONRPCRequest& request)\n             \"By default, the new fee will be calculated automatically using estimatefee.\\n\"\n             \"The user can specify a confirmation target for estimatefee.\\n\"\n             \"Alternatively, the user can specify totalFee, or use RPC setpaytxfee to set a higher fee rate.\\n\"\n-            \"At a minimum, the new fee rate must be high enough to pay a new relay fee over the original fee\\n\"\n-            \"to enter the node's mempool.\\n\"\n+            \"At a minimum, the new fee rate must be high enough to pay an additional new relay fee (incrementalfee\\n\"\n+            \"returned by getnetworkinfo) to enter the node's mempool.\\n\"\n             \"\\nArguments:\\n\"\n             \"1. txid                  (string, required) The txid to be bumped\\n\"\n             \"2. options               (object, optional)\\n\""
      }
    ]
  },
  {
    "sha": "ae9719ab87a05ca4c3293b2f8675f17b16ed5872",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphZTk3MTlhYjg3YTA1Y2E0YzMyOTNiMmY4Njc1ZjE3YjE2ZWQ1ODcy",
    "commit": {
      "author": {
        "name": "Alex Morcos",
        "email": "morcos@chaincode.com",
        "date": "2017-01-26T03:20:02Z"
      },
      "committer": {
        "name": "Alex Morcos",
        "email": "morcos@chaincode.com",
        "date": "2017-01-26T03:24:40Z"
      },
      "message": "Refactor GetMinimumFee to give option of providing targetFee",
      "tree": {
        "sha": "264da44e84591767467c1ed2e1d2c620523b27ad",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/264da44e84591767467c1ed2e1d2c620523b27ad"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ae9719ab87a05ca4c3293b2f8675f17b16ed5872",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ae9719ab87a05ca4c3293b2f8675f17b16ed5872",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/ae9719ab87a05ca4c3293b2f8675f17b16ed5872",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ae9719ab87a05ca4c3293b2f8675f17b16ed5872/comments",
    "author": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fe8e8efcf91fa92db68aabeb0a1709b032e60dd6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fe8e8efcf91fa92db68aabeb0a1709b032e60dd6",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fe8e8efcf91fa92db68aabeb0a1709b032e60dd6"
      }
    ],
    "stats": {
      "total": 14,
      "additions": 12,
      "deletions": 2
    },
    "files": [
      {
        "sha": "c46d5ed7806264f407e29e877e2cee563f80670c",
        "filename": "src/wallet/wallet.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 2,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ae9719ab87a05ca4c3293b2f8675f17b16ed5872/src/wallet/wallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ae9719ab87a05ca4c3293b2f8675f17b16ed5872/src/wallet/wallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/wallet.cpp?ref=ae9719ab87a05ca4c3293b2f8675f17b16ed5872",
        "patch": "@@ -2790,8 +2790,13 @@ CAmount CWallet::GetRequiredFee(unsigned int nTxBytes)\n \n CAmount CWallet::GetMinimumFee(unsigned int nTxBytes, unsigned int nConfirmTarget, const CTxMemPool& pool)\n {\n-    // payTxFee is user-set \"I want to pay this much\"\n-    CAmount nFeeNeeded = payTxFee.GetFee(nTxBytes);\n+    // payTxFee is the user-set global for desired feerate\n+    return GetMinimumFee(nTxBytes, nConfirmTarget, pool, payTxFee.GetFee(nTxBytes));\n+}\n+\n+CAmount CWallet::GetMinimumFee(unsigned int nTxBytes, unsigned int nConfirmTarget, const CTxMemPool& pool, CAmount targetFee)\n+{\n+    CAmount nFeeNeeded = targetFee;\n     // User didn't set: use -txconfirmtarget to estimate...\n     if (nFeeNeeded == 0) {\n         int estimateFoundTarget = nConfirmTarget;"
      },
      {
        "sha": "f95c0589d68fb401389efe55da11fc760ff250fa",
        "filename": "src/wallet/wallet.h",
        "status": "modified",
        "additions": 5,
        "deletions": 0,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ae9719ab87a05ca4c3293b2f8675f17b16ed5872/src/wallet/wallet.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ae9719ab87a05ca4c3293b2f8675f17b16ed5872/src/wallet/wallet.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/wallet.h?ref=ae9719ab87a05ca4c3293b2f8675f17b16ed5872",
        "patch": "@@ -802,6 +802,11 @@ class CWallet : public CCryptoKeyStore, public CValidationInterface\n      * and the required fee\n      */\n     static CAmount GetMinimumFee(unsigned int nTxBytes, unsigned int nConfirmTarget, const CTxMemPool& pool);\n+    /**\n+     * Estimate the minimum fee considering required fee and targetFee or if 0\n+     * then fee estimation for nConfirmTarget\n+     */\n+    static CAmount GetMinimumFee(unsigned int nTxBytes, unsigned int nConfirmTarget, const CTxMemPool& pool, CAmount targetFee);\n     /**\n      * Return the minimum required fee taking into account the\n      * floating relay fee and user set minimum transaction fee"
      }
    ]
  },
  {
    "sha": "e8021ec9193c7e8137f9716bcafd197a357a624e",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplODAyMWVjOTE5M2M3ZTgxMzdmOTcxNmJjYWZkMTk3YTM1N2E2MjRl",
    "commit": {
      "author": {
        "name": "Alex Morcos",
        "email": "morcos@chaincode.com",
        "date": "2017-01-26T03:16:15Z"
      },
      "committer": {
        "name": "Alex Morcos",
        "email": "morcos@chaincode.com",
        "date": "2017-01-26T14:43:00Z"
      },
      "message": "Use CWallet::GetMinimumFee in bumpfee\n\nUse the wallet's fee calculation logic to properly clamp fee against minimums and maximums when calculating the fee for a bumpfee transaction.  Unless totalFee is explictly given, in which case, manually check against min, but do nothing to adjust given fee.\n\nIn all cases do a final check against maxTxFee (after adding any incremental amount).",
      "tree": {
        "sha": "31cbe60ee63f4f88613dd9424cadef34ca68d32a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/31cbe60ee63f4f88613dd9424cadef34ca68d32a"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e8021ec9193c7e8137f9716bcafd197a357a624e",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e8021ec9193c7e8137f9716bcafd197a357a624e",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/e8021ec9193c7e8137f9716bcafd197a357a624e",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e8021ec9193c7e8137f9716bcafd197a357a624e/comments",
    "author": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "ae9719ab87a05ca4c3293b2f8675f17b16ed5872",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ae9719ab87a05ca4c3293b2f8675f17b16ed5872",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/ae9719ab87a05ca4c3293b2f8675f17b16ed5872"
      }
    ],
    "stats": {
      "total": 42,
      "additions": 25,
      "deletions": 17
    },
    "files": [
      {
        "sha": "9ae36653b8cab240151437cccfa8e4ccefd6b7e5",
        "filename": "src/wallet/rpcwallet.cpp",
        "status": "modified",
        "additions": 25,
        "deletions": 17,
        "changes": 42,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e8021ec9193c7e8137f9716bcafd197a357a624e/src/wallet/rpcwallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e8021ec9193c7e8137f9716bcafd197a357a624e/src/wallet/rpcwallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/rpcwallet.cpp?ref=e8021ec9193c7e8137f9716bcafd197a357a624e",
        "patch": "@@ -2739,6 +2739,10 @@ UniValue bumpfee(const JSONRPCRequest& request)\n         throw JSONRPCError(RPC_MISC_ERROR, \"Transaction does not have a change output\");\n     }\n \n+    // signature sizes can vary by a byte, so add 1 for each input when calculating the new fee\n+    int64_t txSize = GetVirtualTransactionSize(*(wtx.tx));\n+    const int64_t maxNewTxSize = txSize + wtx.tx->vin.size();\n+\n     // optional parameters\n     bool specifiedConfirmTarget = false;\n     int newConfirmTarget = nTxConfirmTarget;\n@@ -2764,10 +2768,11 @@ UniValue bumpfee(const JSONRPCRequest& request)\n             }\n         } else if (options.exists(\"totalFee\")) {\n             totalFee = options[\"totalFee\"].get_int64();\n-            if (totalFee <= 0) {\n-                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid totalFee (cannot be <= 0)\");\n-            } else if (totalFee > maxTxFee) {\n-                throw JSONRPCError(RPC_INVALID_PARAMETER, \"Invalid totalFee (cannot be higher than maxTxFee)\");\n+            CAmount requiredFee = CWallet::GetRequiredFee(maxNewTxSize);\n+            if (totalFee < requiredFee ) {\n+                throw JSONRPCError(RPC_INVALID_PARAMETER,\n+                                   strprintf(\"Insufficient totalFee (cannot be less than required fee %s)\",\n+                                             FormatMoney(requiredFee)));\n             }\n         }\n \n@@ -2776,10 +2781,6 @@ UniValue bumpfee(const JSONRPCRequest& request)\n         }\n     }\n \n-    // signature sizes can vary by a byte, so add 1 for each input when calculating the new fee\n-    int64_t txSize = GetVirtualTransactionSize(*(wtx.tx));\n-    const int64_t maxNewTxSize = txSize + wtx.tx->vin.size();\n-\n     // calculate the old fee and fee-rate\n     CAmount nOldFee = wtx.GetDebit(ISMINE_SPENDABLE) - wtx.tx->GetValueOut();\n     CFeeRate nOldFeeRate(nOldFee, txSize);\n@@ -2794,24 +2795,31 @@ UniValue bumpfee(const JSONRPCRequest& request)\n         nNewFee = totalFee;\n         nNewFeeRate = CFeeRate(totalFee, maxNewTxSize);\n     } else {\n-        // use the user-defined payTxFee if possible, otherwise use smartfee / fallbackfee\n-        if (!specifiedConfirmTarget && payTxFee.GetFeePerK() != 0) {\n-            nNewFeeRate = payTxFee;\n-        } else {\n-            nNewFeeRate = mempool.estimateSmartFee(newConfirmTarget);\n+        // if user specified a confirm target then don't consider any global payTxFee\n+        if (specifiedConfirmTarget) {\n+            nNewFee = CWallet::GetMinimumFee(maxNewTxSize, newConfirmTarget, mempool, CAmount(0));\n         }\n-        if (nNewFeeRate.GetFeePerK() == 0) {\n-            nNewFeeRate = CWallet::fallbackFee;\n+        // otherwise use the regular wallet logic to select payTxFee or default confirm target\n+        else {\n+            nNewFee = CWallet::GetMinimumFee(maxNewTxSize, newConfirmTarget, mempool);\n         }\n \n+        nNewFeeRate = CFeeRate(nNewFee, maxNewTxSize);\n+\n         // new fee rate must be at least old rate + minimum incremental relay rate\n         if (nNewFeeRate.GetFeePerK() < nOldFeeRate.GetFeePerK() + ::incrementalRelayFee.GetFeePerK()) {\n             nNewFeeRate = CFeeRate(nOldFeeRate.GetFeePerK() + ::incrementalRelayFee.GetFeePerK());\n+            nNewFee = nNewFeeRate.GetFee(maxNewTxSize);\n         }\n-\n-        nNewFee = nNewFeeRate.GetFee(maxNewTxSize);\n     }\n \n+    // Check that in all cases the new fee doesn't violate maxTxFee\n+     if (nNewFee > maxTxFee) {\n+         throw JSONRPCError(RPC_MISC_ERROR,\n+                            strprintf(\"Specified or calculated fee %s is too high (cannot be higher than maxTxFee %s)\",\n+                                      FormatMoney(nNewFee), FormatMoney(maxTxFee)));\n+     }\n+\n     // check that fee rate is higher than mempool's minimum fee\n     // (no point in bumping fee if we know that the new tx won't be accepted to the mempool)\n     // This may occur if the user set TotalFee or paytxfee too low, if fallbackfee is too low, or, perhaps,"
      }
    ]
  },
  {
    "sha": "0c0c63f70a5376b87508e8f1c73dcbc59c8a96ed",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzowYzBjNjNmNzBhNTM3NmI4NzUwOGU4ZjFjNzNkY2JjNTljOGE5NmVk",
    "commit": {
      "author": {
        "name": "Alex Morcos",
        "email": "morcos@chaincode.com",
        "date": "2017-01-23T18:15:24Z"
      },
      "committer": {
        "name": "Alex Morcos",
        "email": "morcos@chaincode.com",
        "date": "2017-01-26T17:03:47Z"
      },
      "message": "Introduce WALLET_INCREMENTAL_RELAY_FEE\n\nHave wallet's default bump value be higher than the default incrementalRelayFee to future proof against changes to incremental relay fee.  Only applies when not setting the fee rate directly.",
      "tree": {
        "sha": "a89c36f1736f2f2e2015581792aa1572c5ca2c2d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a89c36f1736f2f2e2015581792aa1572c5ca2c2d"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0c0c63f70a5376b87508e8f1c73dcbc59c8a96ed",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0c0c63f70a5376b87508e8f1c73dcbc59c8a96ed",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/0c0c63f70a5376b87508e8f1c73dcbc59c8a96ed",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0c0c63f70a5376b87508e8f1c73dcbc59c8a96ed/comments",
    "author": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "e8021ec9193c7e8137f9716bcafd197a357a624e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e8021ec9193c7e8137f9716bcafd197a357a624e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/e8021ec9193c7e8137f9716bcafd197a357a624e"
      }
    ],
    "stats": {
      "total": 18,
      "additions": 14,
      "deletions": 4
    },
    "files": [
      {
        "sha": "6517bae52cd39c69f59d366481bbc08a11c01234",
        "filename": "src/wallet/rpcwallet.cpp",
        "status": "modified",
        "additions": 12,
        "deletions": 4,
        "changes": 16,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/0c0c63f70a5376b87508e8f1c73dcbc59c8a96ed/src/wallet/rpcwallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/0c0c63f70a5376b87508e8f1c73dcbc59c8a96ed/src/wallet/rpcwallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/rpcwallet.cpp?ref=0c0c63f70a5376b87508e8f1c73dcbc59c8a96ed",
        "patch": "@@ -2786,11 +2786,19 @@ UniValue bumpfee(const JSONRPCRequest& request)\n     CFeeRate nOldFeeRate(nOldFee, txSize);\n     CAmount nNewFee;\n     CFeeRate nNewFeeRate;\n+    // The wallet uses a conservative WALLET_INCREMENTAL_RELAY_FEE value to\n+    // future proof against changes to network wide policy for incremental relay\n+    // fee that our node may not be aware of.\n+    CFeeRate walletIncrementalRelayFee = CFeeRate(WALLET_INCREMENTAL_RELAY_FEE);\n+    if (::incrementalRelayFee > walletIncrementalRelayFee) {\n+        walletIncrementalRelayFee = ::incrementalRelayFee;\n+    }\n \n     if (totalFee > 0) {\n         CAmount minTotalFee = nOldFeeRate.GetFee(maxNewTxSize) + ::incrementalRelayFee.GetFee(maxNewTxSize);\n         if (totalFee < minTotalFee) {\n-            throw JSONRPCError(RPC_INVALID_PARAMETER, strprintf(\"Invalid totalFee, must be at least %s (oldFee %s + relayFee %s)\", FormatMoney(minTotalFee), nOldFeeRate.GetFee(maxNewTxSize), ::incrementalRelayFee.GetFee(maxNewTxSize)));\n+            throw JSONRPCError(RPC_INVALID_PARAMETER, strprintf(\"Insufficient totalFee, must be at least %s (oldFee %s + incrementalFee %s)\",\n+                                                                FormatMoney(minTotalFee), FormatMoney(nOldFeeRate.GetFee(maxNewTxSize)), FormatMoney(::incrementalRelayFee.GetFee(maxNewTxSize))));\n         }\n         nNewFee = totalFee;\n         nNewFeeRate = CFeeRate(totalFee, maxNewTxSize);\n@@ -2806,9 +2814,9 @@ UniValue bumpfee(const JSONRPCRequest& request)\n \n         nNewFeeRate = CFeeRate(nNewFee, maxNewTxSize);\n \n-        // new fee rate must be at least old rate + minimum incremental relay rate\n-        if (nNewFeeRate.GetFeePerK() < nOldFeeRate.GetFeePerK() + ::incrementalRelayFee.GetFeePerK()) {\n-            nNewFeeRate = CFeeRate(nOldFeeRate.GetFeePerK() + ::incrementalRelayFee.GetFeePerK());\n+        // New fee rate must be at least old rate + minimum incremental relay rate\n+        if (nNewFeeRate.GetFeePerK() < nOldFeeRate.GetFeePerK() + walletIncrementalRelayFee.GetFeePerK()) {\n+            nNewFeeRate = CFeeRate(nOldFeeRate.GetFeePerK() + walletIncrementalRelayFee.GetFeePerK());\n             nNewFee = nNewFeeRate.GetFee(maxNewTxSize);\n         }\n     }"
      },
      {
        "sha": "764a7aa268f7407787b1df250ea5a57dc2931b6d",
        "filename": "src/wallet/wallet.h",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/0c0c63f70a5376b87508e8f1c73dcbc59c8a96ed/src/wallet/wallet.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/0c0c63f70a5376b87508e8f1c73dcbc59c8a96ed/src/wallet/wallet.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/wallet.h?ref=0c0c63f70a5376b87508e8f1c73dcbc59c8a96ed",
        "patch": "@@ -48,6 +48,8 @@ static const CAmount DEFAULT_TRANSACTION_FEE = 0;\n static const CAmount DEFAULT_FALLBACK_FEE = 20000;\n //! -mintxfee default\n static const CAmount DEFAULT_TRANSACTION_MINFEE = 1000;\n+//! minimum recommended increment for BIP 125 replacement txs\n+static const CAmount WALLET_INCREMENTAL_RELAY_FEE = 5000;\n //! target minimum change amount\n static const CAmount MIN_CHANGE = CENT;\n //! final minimum change amount after paying for fees"
      }
    ]
  },
  {
    "sha": "4b189c13401bcd350c05cf8194beaeb3d18b3ebc",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0YjE4OWMxMzQwMWJjZDM1MGMwNWNmODE5NGJlYWViM2QxOGIzZWJj",
    "commit": {
      "author": {
        "name": "Alex Morcos",
        "email": "morcos@chaincode.com",
        "date": "2017-01-23T18:15:48Z"
      },
      "committer": {
        "name": "Alex Morcos",
        "email": "morcos@chaincode.com",
        "date": "2017-01-26T17:03:47Z"
      },
      "message": "Change bumpfee result value from 'oldfee' to 'origfee'.\n\nThe result value indicates the actual fee on the transaction that was replaced. But there is an error message which uses the description 'oldfee' to refer to the original fee rate applied to the new transaction's estimated max size.  It was confusing that two different uses of 'oldfee' had two different numeric values.",
      "tree": {
        "sha": "8592419a816b2e4abc3e992e05f2e022573e15d3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8592419a816b2e4abc3e992e05f2e022573e15d3"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4b189c13401bcd350c05cf8194beaeb3d18b3ebc",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4b189c13401bcd350c05cf8194beaeb3d18b3ebc",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/4b189c13401bcd350c05cf8194beaeb3d18b3ebc",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4b189c13401bcd350c05cf8194beaeb3d18b3ebc/comments",
    "author": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "0c0c63f70a5376b87508e8f1c73dcbc59c8a96ed",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0c0c63f70a5376b87508e8f1c73dcbc59c8a96ed",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/0c0c63f70a5376b87508e8f1c73dcbc59c8a96ed"
      }
    ],
    "stats": {
      "total": 6,
      "additions": 3,
      "deletions": 3
    },
    "files": [
      {
        "sha": "2e381630c8ad6fa51819ee27ee482b33c6133b10",
        "filename": "src/wallet/rpcwallet.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 3,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4b189c13401bcd350c05cf8194beaeb3d18b3ebc/src/wallet/rpcwallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4b189c13401bcd350c05cf8194beaeb3d18b3ebc/src/wallet/rpcwallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/rpcwallet.cpp?ref=4b189c13401bcd350c05cf8194beaeb3d18b3ebc",
        "patch": "@@ -2674,8 +2674,8 @@ UniValue bumpfee(const JSONRPCRequest& request)\n             \"\\nResult:\\n\"\n             \"{\\n\"\n             \"  \\\"txid\\\":    \\\"value\\\",   (string)  The id of the new transaction\\n\"\n-            \"  \\\"oldfee\\\":  n,         (numeric) Fee of the replaced transaction\\n\"\n-            \"  \\\"fee\\\":     n,         (numeric) Fee of the new transaction\\n\"\n+            \"  \\\"origfee\\\":  n,         (numeric) Fee of the replaced transaction\\n\"\n+            \"  \\\"fee\\\":      n,         (numeric) Fee of the new transaction\\n\"\n             \"}\\n\"\n             \"\\nExamples:\\n\"\n             \"\\nBump the fee, get the new transaction\\'s txid\\n\" +\n@@ -2899,7 +2899,7 @@ UniValue bumpfee(const JSONRPCRequest& request)\n \n     UniValue result(UniValue::VOBJ);\n     result.push_back(Pair(\"txid\", wtxBumped.GetHash().GetHex()));\n-    result.push_back(Pair(\"oldfee\", ValueFromAmount(nOldFee)));\n+    result.push_back(Pair(\"origfee\", ValueFromAmount(nOldFee)));\n     result.push_back(Pair(\"fee\", ValueFromAmount(nNewFee)));\n \n     return result;"
      }
    ]
  }
]