[
  {
    "sha": "faae5a9a356d821f0cbdea32030b0ce356351a1d",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYWFlNWE5YTM1NmQ4MjFmMGNiZGVhMzIwMzBiMGNlMzU2MzUxYTFk",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-03-03T17:48:49Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-03-03T17:42:52Z"
      },
      "message": "test: Add bad-txns-*-toolarge test cases to invalid_txs",
      "tree": {
        "sha": "6633a446f6277e893012e2fb8371481cf9394361",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6633a446f6277e893012e2fb8371481cf9394361"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/faae5a9a356d821f0cbdea32030b0ce356351a1d",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUgW1wv/fK5yVZk/JB9k7uj+F1+83sf2lFuNp4o+6zA7N72DQtEcsGlCl0Qv7Kh0\nu91TwYieS/KpvAm2COCNp9N9onBYgWoL08TAfuuX/u3+YqTY/n8CsQR2QW6Y5AFe\nxAUnKfGn75HSxq5v6pngL+gUs/zxSoRqp4Zjo3OEY3CSdzDEBCYbgPXZQxTsobBk\nvEEH7CPkjyXjkNoiKaKWWQbwSr0q4l1Mth2Yv+6/Qjzgo2UEIqsRQG6nPe/eoe9d\nh4UgS8aulsvuWEB5kHZG9v8hJnOqlxaWOsva/zDmVBr+u6Z6V3FVxGt/LatZ9aL3\nuwdFGla8a+ID9WdlqOkmzBOwQEo08fKILJlLcVOVLu9KTAlCvmkvdi79G1jT1Rev\n2/p2d3Voj5Ci90UYSvVG7TRM74964/uTVSeDKD6CE8gOGfpYsJcSTipa8KTdTFIh\nfYp8nI1l57yq88S/RntQd2+1VcFS15qXGf4NL6aHaOgYrFQ1v+XOdO48uNdjzuEI\n29n+ThdQ\n=UPU5\n-----END PGP SIGNATURE-----",
        "payload": "tree 6633a446f6277e893012e2fb8371481cf9394361\nparent ac5c5d0162a963be6fbaa53261c01705436a65f3\nauthor MarcoFalke <falke.marco@gmail.com> 1583257729 -0500\ncommitter MarcoFalke <falke.marco@gmail.com> 1583257372 -0500\n\ntest: Add bad-txns-*-toolarge test cases to invalid_txs\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faae5a9a356d821f0cbdea32030b0ce356351a1d",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/faae5a9a356d821f0cbdea32030b0ce356351a1d",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faae5a9a356d821f0cbdea32030b0ce356351a1d/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "ac5c5d0162a963be6fbaa53261c01705436a65f3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ac5c5d0162a963be6fbaa53261c01705436a65f3",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/ac5c5d0162a963be6fbaa53261c01705436a65f3"
      }
    ],
    "stats": {
      "total": 36,
      "additions": 31,
      "deletions": 5
    },
    "files": [
      {
        "sha": "ce14998fd137e1919b7f240b03ec91606ecf1593",
        "filename": "test/functional/data/invalid_txs.py",
        "status": "modified",
        "additions": 27,
        "deletions": 3,
        "changes": 30,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faae5a9a356d821f0cbdea32030b0ce356351a1d/test/functional/data/invalid_txs.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faae5a9a356d821f0cbdea32030b0ce356351a1d/test/functional/data/invalid_txs.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/data/invalid_txs.py?ref=faae5a9a356d821f0cbdea32030b0ce356351a1d",
        "patch": "@@ -21,7 +21,13 @@\n \"\"\"\n import abc\n \n-from test_framework.messages import CTransaction, CTxIn, CTxOut, COutPoint\n+from test_framework.messages import (\n+    COutPoint,\n+    CTransaction,\n+    CTxIn,\n+    CTxOut,\n+    MAX_MONEY,\n+)\n from test_framework import script as sc\n from test_framework.blocktools import create_tx_with_script, MAX_BLOCK_SIGOPS\n from test_framework.script import (\n@@ -166,14 +172,33 @@ def get_tx(self):\n             self.spend_tx, 0, script_pub_key=basic_p2sh, amount=(self.spend_avail + 1))\n \n \n-class SpendNegative(BadTxTemplate):\n+class CreateNegative(BadTxTemplate):\n     reject_reason = 'bad-txns-vout-negative'\n     expect_disconnect = True\n \n     def get_tx(self):\n         return create_tx_with_script(self.spend_tx, 0, amount=-1)\n \n \n+class CreateTooLarge(BadTxTemplate):\n+    reject_reason = 'bad-txns-vout-toolarge'\n+    expect_disconnect = True\n+\n+    def get_tx(self):\n+        return create_tx_with_script(self.spend_tx, 0, amount=MAX_MONEY + 1)\n+\n+\n+class CreateSumTooLarge(BadTxTemplate):\n+    reject_reason = 'bad-txns-txouttotal-toolarge'\n+    expect_disconnect = True\n+\n+    def get_tx(self):\n+        tx = create_tx_with_script(self.spend_tx, 0, amount=MAX_MONEY)\n+        tx.vout = [tx.vout[0]] * 2\n+        tx.calc_sha256()\n+        return tx\n+\n+\n class InvalidOPIFConstruction(BadTxTemplate):\n     reject_reason = \"mandatory-script-verify-flag-failed (Invalid OP_IF construction)\"\n     expect_disconnect = True\n@@ -237,4 +262,3 @@ def get_tx(self):\n def iter_all_templates():\n     \"\"\"Iterate through all bad transaction template types.\"\"\"\n     return BadTxTemplate.__subclasses__()\n-"
      },
      {
        "sha": "9ade22a7ebdd00d1c4f1dcf4d44808cf1d1ef850",
        "filename": "test/functional/mempool_accept.py",
        "status": "modified",
        "additions": 3,
        "deletions": 2,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faae5a9a356d821f0cbdea32030b0ce356351a1d/test/functional/mempool_accept.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faae5a9a356d821f0cbdea32030b0ce356351a1d/test/functional/mempool_accept.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/mempool_accept.py?ref=faae5a9a356d821f0cbdea32030b0ce356351a1d",
        "patch": "@@ -16,6 +16,7 @@\n     CTransaction,\n     CTxOut,\n     MAX_BLOCK_BASE_SIZE,\n+    MAX_MONEY,\n )\n from test_framework.script import (\n     hash160,\n@@ -220,7 +221,7 @@ def run_test(self):\n         # The following two validations prevent overflow of the output amounts (see CVE-2010-5139).\n         self.log.info('A transaction with too large output value')\n         tx.deserialize(BytesIO(hex_str_to_bytes(raw_tx_reference)))\n-        tx.vout[0].nValue = 21000000 * COIN + 1\n+        tx.vout[0].nValue = MAX_MONEY + 1\n         self.check_mempool_result(\n             result_expected=[{'txid': tx.rehash(), 'allowed': False, 'reject-reason': 'bad-txns-vout-toolarge'}],\n             rawtxs=[tx.serialize().hex()],\n@@ -229,7 +230,7 @@ def run_test(self):\n         self.log.info('A transaction with too large sum of output values')\n         tx.deserialize(BytesIO(hex_str_to_bytes(raw_tx_reference)))\n         tx.vout = [tx.vout[0]] * 2\n-        tx.vout[0].nValue = 21000000 * COIN\n+        tx.vout[0].nValue = MAX_MONEY\n         self.check_mempool_result(\n             result_expected=[{'txid': tx.rehash(), 'allowed': False, 'reject-reason': 'bad-txns-txouttotal-toolarge'}],\n             rawtxs=[tx.serialize().hex()],"
      },
      {
        "sha": "285a3fbbf48b6ebb085e04a4488a90610c9042c9",
        "filename": "test/functional/test_framework/messages.py",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faae5a9a356d821f0cbdea32030b0ce356351a1d/test/functional/test_framework/messages.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faae5a9a356d821f0cbdea32030b0ce356351a1d/test/functional/test_framework/messages.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/test_framework/messages.py?ref=faae5a9a356d821f0cbdea32030b0ce356351a1d",
        "patch": "@@ -39,6 +39,7 @@\n MAX_BLOCK_BASE_SIZE = 1000000\n \n COIN = 100000000  # 1 btc in satoshis\n+MAX_MONEY = 21000000 * COIN\n \n BIP125_SEQUENCE_NUMBER = 0xfffffffd  # Sequence number that is BIP 125 opt-in and BIP 68-opt-out\n "
      }
    ]
  }
]