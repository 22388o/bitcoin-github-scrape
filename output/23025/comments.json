[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/922406734",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#issuecomment-922406734",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23025",
    "id": 922406734,
    "node_id": "IC_kwDOABII5842-s9O",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-19T02:50:48Z",
    "updated_at": "2021-09-22T04:07:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#22950](https://github.com/bitcoin/bitcoin/pull/22950) ([p2p] Pimpl AddrMan to abstract implementation details by amitiuttarwar)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/922406734/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/922454698",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#issuecomment-922454698",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23025",
    "id": 922454698,
    "node_id": "IC_kwDOABII5842-4qq",
    "user": {
      "login": "martinus",
      "id": 14386,
      "node_id": "MDQ6VXNlcjE0Mzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/14386?u=da89313ed4793f9594c09c23513f49aa4dc1c141&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/martinus",
      "html_url": "https://github.com/martinus",
      "followers_url": "https://api.github.com/users/martinus/followers",
      "following_url": "https://api.github.com/users/martinus/following{/other_user}",
      "gists_url": "https://api.github.com/users/martinus/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/martinus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
      "organizations_url": "https://api.github.com/users/martinus/orgs",
      "repos_url": "https://api.github.com/users/martinus/repos",
      "events_url": "https://api.github.com/users/martinus/events{/privacy}",
      "received_events_url": "https://api.github.com/users/martinus/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-19T11:00:51Z",
    "updated_at": "2021-09-19T11:00:51Z",
    "author_association": "CONTRIBUTOR",
    "body": "Thanks for the reviews! I've incorporated all the suggestions into the right commits and rebased everything.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/922454698/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/922647753",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#issuecomment-922647753",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23025",
    "id": 922647753,
    "node_id": "IC_kwDOABII5842_nzJ",
    "user": {
      "login": "martinus",
      "id": 14386,
      "node_id": "MDQ6VXNlcjE0Mzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/14386?u=da89313ed4793f9594c09c23513f49aa4dc1c141&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/martinus",
      "html_url": "https://github.com/martinus",
      "followers_url": "https://api.github.com/users/martinus/followers",
      "following_url": "https://api.github.com/users/martinus/following{/other_user}",
      "gists_url": "https://api.github.com/users/martinus/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/martinus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
      "organizations_url": "https://api.github.com/users/martinus/orgs",
      "repos_url": "https://api.github.com/users/martinus/repos",
      "events_url": "https://api.github.com/users/martinus/events{/privacy}",
      "received_events_url": "https://api.github.com/users/martinus/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-20T05:32:26Z",
    "updated_at": "2021-09-20T05:32:26Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased with header cleanups, and signed all commits.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/922647753/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/922741072",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#issuecomment-922741072",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23025",
    "id": 922741072,
    "node_id": "IC_kwDOABII5842_-lQ",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-20T08:53:10Z",
    "updated_at": "2021-09-20T08:53:10Z",
    "author_association": "MEMBER",
    "body": "ACK e7e890079e92e346997cbdf491b5b0717cd4bcab",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/922741072/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/923989184",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#issuecomment-923989184",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23025",
    "id": 923989184,
    "node_id": "IC_kwDOABII5843EvTA",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-21T13:27:12Z",
    "updated_at": "2021-09-21T17:06:53Z",
    "author_association": "MEMBER",
    "body": "re-ACK e148a5233292d156cda76cb20afb6641fc20f25e\r\n\r\nThe Win64 CI failure looks unrelated.\r\n\r\n```\r\n$ NANOBENCH_SUPPRESS_WARNINGS=1 ./bench_bitcoin -filter=AddrMan*.* -min_time=20000\r\n\r\n|               ns/op |                op/s |    err% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------:|:----------\r\n|      762,448,657.67 |                1.31 |    6.8% |     23.20 | `AddrManAdd`\r\n|    1,794,860,430.00 |                0.56 |    2.5% |     19.71 | `AddrManAddThenGood`\r\n|        9,101,993.99 |              109.87 |    7.8% |     20.56 | `AddrManGetAddr`\r\n|           11,379.90 |           87,874.25 |    2.1% |     21.93 | `AddrManSelect`\r\n```\r\n\r\nIf you retouch, maybe order the addrman benchmark functions alphabetically, which would be the same order as the bench result output and place the two similar functions, AddrManAdd and AddrManAddThenGood, next to each other.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/923989184/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/924010520",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#issuecomment-924010520",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23025",
    "id": 924010520,
    "node_id": "IC_kwDOABII5843E0gY",
    "user": {
      "login": "martinus",
      "id": 14386,
      "node_id": "MDQ6VXNlcjE0Mzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/14386?u=da89313ed4793f9594c09c23513f49aa4dc1c141&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/martinus",
      "html_url": "https://github.com/martinus",
      "followers_url": "https://api.github.com/users/martinus/followers",
      "following_url": "https://api.github.com/users/martinus/following{/other_user}",
      "gists_url": "https://api.github.com/users/martinus/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/martinus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
      "organizations_url": "https://api.github.com/users/martinus/orgs",
      "repos_url": "https://api.github.com/users/martinus/repos",
      "events_url": "https://api.github.com/users/martinus/events{/privacy}",
      "received_events_url": "https://api.github.com/users/martinus/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-21T13:51:28Z",
    "updated_at": "2021-09-21T13:51:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "@jonatack Interesting that your benchmark results are so different. Did you compile for release? I can't believe my computer is ~20 times faster than yours... I compile with `./autogen.sh && ./configure --with-incompatible-bdb CC=clang CXX=clang++` ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/924010520/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/924016548",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#issuecomment-924016548",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23025",
    "id": 924016548,
    "node_id": "IC_kwDOABII5843E1-k",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-21T13:58:02Z",
    "updated_at": "2021-09-21T13:59:31Z",
    "author_association": "MEMBER",
    "body": "@martinus no, it's a debug build and the computer is not optimized. Re-building a non-debug build would take a long time (I have a slow 2-core laptop) and I'd already tested it properly above. Sorry for the weird example.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/924016548/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/926770523",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#issuecomment-926770523",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/23025",
    "id": 926770523,
    "node_id": "IC_kwDOABII5843PWVb",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-09-24T16:38:53Z",
    "updated_at": "2021-09-24T16:38:53Z",
    "author_association": "MEMBER",
    "body": "Code review ACK e148a5233292d156cda76cb20afb6641fc20f25e",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/926770523/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711589008",
    "pull_request_review_id": 758061464,
    "id": 711589008,
    "node_id": "PRRC_kwDOABII584qafyQ",
    "diff_hunk": "@@ -20,19 +20,17 @@ static void EvictionProtectionCommon(\n {\n     using Candidates = std::vector<NodeEvictionCandidate>;\n     FastRandomContext random_context{true};\n-    bench.warmup(100).epochIterations(1100);\n \n     Candidates candidates{GetRandomNodeEvictionCandidates(num_candidates, random_context)};\n     for (auto& c : candidates) {\n         candidate_setup_fn(c);\n     }\n \n-    std::vector<Candidates> copies{\n-        static_cast<size_t>(bench.epochs() * bench.epochIterations()), candidates};\n-    size_t i{0};\n+\n     bench.run([&] {\n-        ProtectEvictionCandidatesByRatio(copies.at(i));\n-        ++i;\n+        // creating a copy has an overhead of about 3%, so it does not influcence the benchmark results much.",
    "path": "src/bench/peer_eviction.cpp",
    "position": null,
    "original_position": 18,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "354fbc002275364fefc67fff7447e77fc44dbae1",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "3154897f nit, s/influcence/influence/",
    "created_at": "2021-09-18T13:12:44Z",
    "updated_at": "2021-09-18T14:07:53Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711589008",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711589008"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711589008"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711589008/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 31,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711589771",
    "pull_request_review_id": 758061464,
    "id": 711589771,
    "node_id": "PRRC_kwDOABII584qaf-L",
    "diff_hunk": "@@ -130,10 +115,20 @@ static void AddrManGood(benchmark::Bench& bench)\n         }\n     };\n \n-    uint64_t i = 0;\n+    // the benchmark is quite slow, so we reduce the number of epochs (measurements) for faster results.\n+    bench.epochs(5);\n+\n     bench.run([&] {\n-        markSomeAsGood(*addrmans.at(i));\n-        ++i;\n+        // To make the benchmark independent of the number of evaluations, we always prepare a new addrman.\n+        // This is necessary because CAddrMan::Good() method modifies theobject, affecting the timing of subsequent calls",
    "path": "src/bench/addrman.cpp",
    "position": null,
    "original_position": 34,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "354fbc002275364fefc67fff7447e77fc44dbae1",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "c67f365 nit s/method modifies theobject/modifies the object/",
    "created_at": "2021-09-18T13:19:39Z",
    "updated_at": "2021-09-18T14:07:53Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711589771",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711589771"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711589771"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711589771/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 123,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711590355",
    "pull_request_review_id": 758061464,
    "id": 711590355,
    "node_id": "PRRC_kwDOABII584qagHT",
    "diff_hunk": "@@ -4,21 +4,24 @@\n \n #include <bench/bench.h>\n \n+#include <clientversion.h>\n #include <crypto/sha256.h>\n #include <util/strencodings.h>\n #include <util/system.h>\n \n #include <memory>\n \n static const char* DEFAULT_BENCH_FILTER = \".*\";\n+static const int64_t DEFAULT_MIN_DURATION_MS = 10;",
    "path": "src/bench/bench_bitcoin.cpp",
    "position": null,
    "original_position": 12,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "354fbc002275364fefc67fff7447e77fc44dbae1",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "f167647\r\n```suggestion\r\nstatic constexpr int64_t DEFAULT_MIN_DURATION_MS{10};\r\n```",
    "created_at": "2021-09-18T13:25:41Z",
    "updated_at": "2021-09-18T14:07:53Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711590355",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711590355"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711590355"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711590355/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 15,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711590975",
    "pull_request_review_id": 758061464,
    "id": 711590975,
    "node_id": "PRRC_kwDOABII584qagQ_",
    "diff_hunk": "@@ -48,17 +51,63 @@ int main(int argc, char** argv)\n     }\n \n     if (HelpRequested(argsman)) {\n-        std::cout << argsman.GetHelpMessage();\n+        std::cout << \"Usage:  bench_bitcoin [options]\\n\"\n+                     \"\\n\"\n+                     \"Description:\\n\"\n+                     \"\\n\"\n+                     \"  bench_bitcoin executes microbenchmarks. The quality of the benchmark results\\n\"\n+                     \"  highly depend on the stability of the machine. It can sometimes be very\\n\"\n+                     \"  difficult to get repeatable results, so here are a few tips to get stable\\n\"\n+                     \"  results:\\n\"\n+                     \"\\n\"\n+                     \"  * Use pyperf [1] to disable frequency scaling, turbo boost etc. For best\\n\"\n+                     \"    use CPU pinning and CPU isolation (see [2]).\\n\"",
    "path": "src/bench/bench_bitcoin.cpp",
    "position": null,
    "original_position": 42,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "354fbc002275364fefc67fff7447e77fc44dbae1",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "fc2d44dd missing word\r\n```suggestion\r\n                     \"    results, use CPU pinning and CPU isolation (see [2]).\\n\"\r\n```",
    "created_at": "2021-09-18T13:31:19Z",
    "updated_at": "2021-09-18T14:07:53Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711590975",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711590975"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711590975"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711590975/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 64,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711591098",
    "pull_request_review_id": 758061464,
    "id": 711591098,
    "node_id": "PRRC_kwDOABII584qagS6",
    "diff_hunk": "@@ -48,17 +51,63 @@ int main(int argc, char** argv)\n     }\n \n     if (HelpRequested(argsman)) {\n-        std::cout << argsman.GetHelpMessage();\n+        std::cout << \"Usage:  bench_bitcoin [options]\\n\"\n+                     \"\\n\"\n+                     \"Description:\\n\"\n+                     \"\\n\"\n+                     \"  bench_bitcoin executes microbenchmarks. The quality of the benchmark results\\n\"\n+                     \"  highly depend on the stability of the machine. It can sometimes be very\\n\"\n+                     \"  difficult to get repeatable results, so here are a few tips to get stable\\n\"\n+                     \"  results:\\n\"\n+                     \"\\n\"\n+                     \"  * Use pyperf [1] to disable frequency scaling, turbo boost etc. For best\\n\"\n+                     \"    use CPU pinning and CPU isolation (see [2]).\\n\"\n+                     \"\\n\"\n+                     \"  * Each call of run() should do exactly the same work. E.g. inserting into\\n\"\n+                     \"    a std::vector doesn't do that as it will reallocate on certain calls. Make\\n\"\n+                     \"    sure each run has exactly the same preconditions.\\n\"\n+                     \"\\n\"\n+                     \"  * If results are still not reliable increase runtime with e.g.\\n\"\n+                     \"    -min_duration_ms=5000 to let a benchmark run for at least 5 seconds\\n\"",
    "path": "src/bench/bench_bitcoin.cpp",
    "position": null,
    "original_position": 49,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "354fbc002275364fefc67fff7447e77fc44dbae1",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "fc2d44d s/reliable increase/reliable, increase/ and s/seconds/seconds./",
    "created_at": "2021-09-18T13:32:53Z",
    "updated_at": "2021-09-18T14:07:53Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711591098",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711591098"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711591098"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711591098/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 71,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711591578",
    "pull_request_review_id": 758061464,
    "id": 711591578,
    "node_id": "PRRC_kwDOABII584qagaa",
    "diff_hunk": "@@ -41,11 +41,12 @@ using ankerl::nanobench::Bench;\n typedef std::function<void(Bench&)> BenchFunction;\n \n struct Args {\n-    std::string regex_filter;\n     bool is_list_only;\n     std::vector<double> asymptote;\n     std::string output_csv;\n     std::string output_json;\n+    std::string regex_filter;\n+    std::chrono::milliseconds min_duration;",
    "path": "src/bench/bench.h",
    "position": null,
    "original_position": 10,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "354fbc002275364fefc67fff7447e77fc44dbae1",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "f167647 or 3e1a8ca maybe place this line after `bool is_list_only`, as it is a very lightweight data type in terms of packing",
    "created_at": "2021-09-18T13:37:04Z",
    "updated_at": "2021-09-18T14:08:42Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711591578",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711591578"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711591578"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711591578/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 49,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711592387",
    "pull_request_review_id": 758061464,
    "id": 711592387,
    "node_id": "PRRC_kwDOABII584qagnD",
    "diff_hunk": "@@ -13,16 +13,16 @@ static void RollingBloom(benchmark::Bench& bench)\n     uint32_t count = 0;\n     bench.run([&] {\n         count++;\n-        data[0] = count;\n-        data[1] = count >> 8;\n-        data[2] = count >> 16;\n-        data[3] = count >> 24;\n+        data[0] = static_cast<unsigned char>(count);\n+        data[1] = static_cast<unsigned char>(count >> 8);\n+        data[2] = static_cast<unsigned char>(count >> 16);\n+        data[3] = static_cast<unsigned char>(count >> 24);\n         filter.insert(data);\n \n-        data[0] = count >> 24;\n-        data[1] = count >> 16;\n-        data[2] = count >> 8;\n-        data[3] = count;\n+        data[0] = static_cast<unsigned char>(count >> 24);\n+        data[1] = static_cast<unsigned char>(count >> 16);\n+        data[2] = static_cast<unsigned char>(count >> 8);\n+        data[3] = static_cast<unsigned char>(count);",
    "path": "src/bench/rollingbloom.cpp",
    "position": null,
    "original_position": 21,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "354fbc002275364fefc67fff7447e77fc44dbae1",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "354fbc0 Would it be a good idea to instead just make `data` a vector of uint8? There has been ongoing refactoring in the codebase to move from unsigned char to uint8. \r\n```diff\r\n-    std::vector<unsigned char> data(32);\r\n-    uint32_t count = 0;\r\n+    std::vector<uint8_t> data(32);\r\n+    uint8_t count = 0;\r\n```\r\n",
    "created_at": "2021-09-18T13:43:48Z",
    "updated_at": "2021-09-18T14:07:53Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711592387",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711592387"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711592387"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711592387/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 25,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711593437",
    "pull_request_review_id": 758061464,
    "id": 711593437,
    "node_id": "PRRC_kwDOABII584qag3d",
    "diff_hunk": "@@ -48,17 +51,63 @@ int main(int argc, char** argv)\n     }\n \n     if (HelpRequested(argsman)) {\n-        std::cout << argsman.GetHelpMessage();\n+        std::cout << \"Usage:  bench_bitcoin [options]\\n\"\n+                     \"\\n\"\n+                     \"Description:\\n\"\n+                     \"\\n\"\n+                     \"  bench_bitcoin executes microbenchmarks. The quality of the benchmark results\\n\"\n+                     \"  highly depend on the stability of the machine. It can sometimes be very\\n\"\n+                     \"  difficult to get repeatable results, so here are a few tips to get stable\\n\"",
    "path": "src/bench/bench_bitcoin.cpp",
    "position": null,
    "original_position": 38,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "354fbc002275364fefc67fff7447e77fc44dbae1",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "fc2d44dd suggestion\r\n\r\n\"It can sometimes be difficult to get stable, repeatable results, so here are a few tips:\"\r\n",
    "created_at": "2021-09-18T13:53:21Z",
    "updated_at": "2021-09-18T14:07:53Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711593437",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711593437"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711593437"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711593437/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 60,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711593618",
    "pull_request_review_id": 758061464,
    "id": 711593618,
    "node_id": "PRRC_kwDOABII584qag6S",
    "diff_hunk": "@@ -48,17 +51,63 @@ int main(int argc, char** argv)\n     }\n \n     if (HelpRequested(argsman)) {\n-        std::cout << argsman.GetHelpMessage();\n+        std::cout << \"Usage:  bench_bitcoin [options]\\n\"\n+                     \"\\n\"\n+                     \"Description:\\n\"\n+                     \"\\n\"\n+                     \"  bench_bitcoin executes microbenchmarks. The quality of the benchmark results\\n\"\n+                     \"  highly depend on the stability of the machine. It can sometimes be very\\n\"\n+                     \"  difficult to get repeatable results, so here are a few tips to get stable\\n\"\n+                     \"  results:\\n\"\n+                     \"\\n\"\n+                     \"  * Use pyperf [1] to disable frequency scaling, turbo boost etc. For best\\n\"\n+                     \"    use CPU pinning and CPU isolation (see [2]).\\n\"\n+                     \"\\n\"\n+                     \"  * Each call of run() should do exactly the same work. E.g. inserting into\\n\"\n+                     \"    a std::vector doesn't do that as it will reallocate on certain calls. Make\\n\"\n+                     \"    sure each run has exactly the same preconditions.\\n\"\n+                     \"\\n\"\n+                     \"  * If results are still not reliable increase runtime with e.g.\\n\"\n+                     \"    -min_duration_ms=5000 to let a benchmark run for at least 5 seconds\\n\"\n+                     \"\\n\"\n+                     \"  * bench_bitcoin uses nanobench [3] for which there is extensive\\n\"\n+                     \"    documentation available online.\\n\"\n+                     \"\\n\"\n+                     \"Environment Variables:\\n\"\n+                     \"\\n\"\n+                     \"  To attach a profiler you can run a benchmark in endless mode. This can be\\n\"\n+                     \"  done with the environment variable NANOBENCH_ENDLESS. E.g. like so:\\n\"\n+                     \"\\n\"\n+                     \"    NANOBENCH_ENDLESS=MuHash ./bench_bitcoin -filter=MuHash\\n\"\n+                     \"\\n\"\n+                     \"  In rare cases it can be useful to suppress stability warnings. This can be\\n\"\n+                     \"  done with the environment variable NANOBENCH_SUPPRESS_WARNINGS, e.g:\\n\"\n+                     \"\\n\"\n+                     \"    NANOBENCH_SUPPRESS_WARNINGS=1 ./bench_bitcoin\\n\"\n+                     \"\\n\"\n+                  << argsman.GetHelpMessage()",
    "path": "src/bench/bench_bitcoin.cpp",
    "position": null,
    "original_position": 66,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "354fbc002275364fefc67fff7447e77fc44dbae1",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "fc2d44d I think it would be most helpful to begin with the Options, followed by the Description and Notes, as they go together.",
    "created_at": "2021-09-18T13:55:10Z",
    "updated_at": "2021-09-18T14:07:53Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711593618",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711593618"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711593618"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711593618/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 88,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711593977",
    "pull_request_review_id": 758061464,
    "id": 711593977,
    "node_id": "PRRC_kwDOABII584qag_5",
    "diff_hunk": "@@ -4,21 +4,24 @@\n \n #include <bench/bench.h>\n \n+#include <clientversion.h>\n #include <crypto/sha256.h>\n #include <util/strencodings.h>\n #include <util/system.h>\n \n #include <memory>\n \n static const char* DEFAULT_BENCH_FILTER = \".*\";\n+static const int64_t DEFAULT_MIN_DURATION_MS = 10;\n \n static void SetupBenchArgs(ArgsManager& argsman)\n {\n     SetupHelpOptions(argsman);\n \n-    argsman.AddArg(\"-asymptote=n1,n2,n3,...\", \"Test asymptotic growth of the runtime of an algorithm, if supported by the benchmark\", ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n+    argsman.AddArg(\"-asymptote=<n1,n2,n3,...>\", \"Test asymptotic growth of the runtime of an algorithm, if supported by the benchmark\", ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n     argsman.AddArg(\"-filter=<regex>\", strprintf(\"Regular expression filter to select benchmark by name (default: %s)\", DEFAULT_BENCH_FILTER), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n-    argsman.AddArg(\"-list\", \"List benchmarks without executing them\", ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n+    argsman.AddArg(\"-list\", \"List benchmarks without executing them\", ArgsManager::ALLOW_BOOL, OptionsCategory::OPTIONS);\n+    argsman.AddArg(\"-min_duration_ms=<milliseconds>\", strprintf(\"Minimum runtime per benchmark, in milliseconds (default: %d)\", DEFAULT_MIN_DURATION_MS), ArgsManager::ALLOW_INT, OptionsCategory::OPTIONS);",
    "path": "src/bench/bench_bitcoin.cpp",
    "position": null,
    "original_position": 23,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "354fbc002275364fefc67fff7447e77fc44dbae1",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "f167647c consider shortening the argument name to `-min_time` (faster and easier to type!)",
    "created_at": "2021-09-18T13:58:37Z",
    "updated_at": "2021-09-18T14:09:40Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711593977",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711593977"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711593977"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711593977/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 24,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711598161",
    "pull_request_review_id": 758066738,
    "id": 711598161,
    "node_id": "PRRC_kwDOABII584qaiBR",
    "diff_hunk": "@@ -61,6 +59,11 @@ void benchmark::BenchRunner::RunAll(const Args& args)\n \n         Bench bench;\n         bench.name(p.first);\n+        if (args.min_duration > std::chrono::milliseconds::zero()) {\n+            // convert to nanos before dividing to reduce rounding errors\n+            bench.minEpochTime(std::chrono::nanoseconds(args.min_duration) / bench.epochs());",
    "path": "src/bench/bench.cpp",
    "position": null,
    "original_position": 16,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "354fbc002275364fefc67fff7447e77fc44dbae1",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Looking at https://en.cppreference.com/w/cpp/chrono/duration/duration_cast, would something like this be a good idea?\r\n\r\n```cpp\r\n// converting integral duration to integral duration of shorter divisible time unit:\r\n    // no duration_cast needed\r\n    std::chrono::duration<long, std::micro> int_usec = int_ms;\r\n```\r\n\r\nalso line 62, can shorten if preferred\r\n```diff\r\n-        if (args.min_duration > std::chrono::milliseconds::zero()) {\r\n+        if (args.min_duration > 0ms) {\r\n```\r\n\r\nalso, where `std::chrono` is added, look at include headers for `<chrono>` where needed",
    "created_at": "2021-09-18T14:32:52Z",
    "updated_at": "2021-09-18T14:32:53Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711598161",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711598161"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711598161"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711598161/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 64,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711625919",
    "pull_request_review_id": 758083696,
    "id": 711625919,
    "node_id": "PRRC_kwDOABII584qaoy_",
    "diff_hunk": "@@ -48,17 +51,63 @@ int main(int argc, char** argv)\n     }\n \n     if (HelpRequested(argsman)) {\n-        std::cout << argsman.GetHelpMessage();\n+        std::cout << \"Usage:  bench_bitcoin [options]\\n\"\n+                     \"\\n\"\n+                     \"Description:\\n\"\n+                     \"\\n\"\n+                     \"  bench_bitcoin executes microbenchmarks. The quality of the benchmark results\\n\"\n+                     \"  highly depend on the stability of the machine. It can sometimes be very\\n\"\n+                     \"  difficult to get repeatable results, so here are a few tips to get stable\\n\"\n+                     \"  results:\\n\"\n+                     \"\\n\"\n+                     \"  * Use pyperf [1] to disable frequency scaling, turbo boost etc. For best\\n\"\n+                     \"    use CPU pinning and CPU isolation (see [2]).\\n\"\n+                     \"\\n\"\n+                     \"  * Each call of run() should do exactly the same work. E.g. inserting into\\n\"\n+                     \"    a std::vector doesn't do that as it will reallocate on certain calls. Make\\n\"\n+                     \"    sure each run has exactly the same preconditions.\\n\"\n+                     \"\\n\"\n+                     \"  * If results are still not reliable increase runtime with e.g.\\n\"\n+                     \"    -min_duration_ms=5000 to let a benchmark run for at least 5 seconds\\n\"\n+                     \"\\n\"\n+                     \"  * bench_bitcoin uses nanobench [3] for which there is extensive\\n\"\n+                     \"    documentation available online.\\n\"\n+                     \"\\n\"\n+                     \"Environment Variables:\\n\"\n+                     \"\\n\"\n+                     \"  To attach a profiler you can run a benchmark in endless mode. This can be\\n\"\n+                     \"  done with the environment variable NANOBENCH_ENDLESS. E.g. like so:\\n\"\n+                     \"\\n\"\n+                     \"    NANOBENCH_ENDLESS=MuHash ./bench_bitcoin -filter=MuHash\\n\"\n+                     \"\\n\"\n+                     \"  In rare cases it can be useful to suppress stability warnings. This can be\\n\"\n+                     \"  done with the environment variable NANOBENCH_SUPPRESS_WARNINGS, e.g:\\n\"\n+                     \"\\n\"\n+                     \"    NANOBENCH_SUPPRESS_WARNINGS=1 ./bench_bitcoin\\n\"\n+                     \"\\n\"\n+                  << argsman.GetHelpMessage()",
    "path": "src/bench/bench_bitcoin.cpp",
    "position": null,
    "original_position": 66,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "354fbc002275364fefc67fff7447e77fc44dbae1",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Another alternative would be to add this Description and Notes documentation to `doc/benchmarking.md`.",
    "created_at": "2021-09-18T18:41:09Z",
    "updated_at": "2021-09-18T18:41:09Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711625919",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711625919"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711625919"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711625919/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 88,
    "side": "RIGHT",
    "in_reply_to_id": 711593618
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711724830",
    "pull_request_review_id": 758136372,
    "id": 711724830,
    "node_id": "PRRC_kwDOABII584qbA8e",
    "diff_hunk": "@@ -20,19 +20,17 @@ static void EvictionProtectionCommon(\n {\n     using Candidates = std::vector<NodeEvictionCandidate>;\n     FastRandomContext random_context{true};\n-    bench.warmup(100).epochIterations(1100);\n \n     Candidates candidates{GetRandomNodeEvictionCandidates(num_candidates, random_context)};\n     for (auto& c : candidates) {\n         candidate_setup_fn(c);\n     }\n \n-    std::vector<Candidates> copies{\n-        static_cast<size_t>(bench.epochs() * bench.epochIterations()), candidates};\n-    size_t i{0};\n+\n     bench.run([&] {\n-        ProtectEvictionCandidatesByRatio(copies.at(i));\n-        ++i;\n+        // creating a copy has an overhead of about 3%, so it does not influcence the benchmark results much.",
    "path": "src/bench/peer_eviction.cpp",
    "position": null,
    "original_position": 18,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "354fbc002275364fefc67fff7447e77fc44dbae1",
    "user": {
      "login": "martinus",
      "id": 14386,
      "node_id": "MDQ6VXNlcjE0Mzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/martinus",
      "html_url": "https://github.com/martinus",
      "followers_url": "https://api.github.com/users/martinus/followers",
      "following_url": "https://api.github.com/users/martinus/following{/other_user}",
      "gists_url": "https://api.github.com/users/martinus/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/martinus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
      "organizations_url": "https://api.github.com/users/martinus/orgs",
      "repos_url": "https://api.github.com/users/martinus/repos",
      "events_url": "https://api.github.com/users/martinus/events{/privacy}",
      "received_events_url": "https://api.github.com/users/martinus/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "fixed in eb399ab0577dffe7e1080bb497ff642de1c8c359",
    "created_at": "2021-09-19T10:52:48Z",
    "updated_at": "2021-09-19T10:52:49Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711724830",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711724830"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711724830"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711724830/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 31,
    "side": "RIGHT",
    "in_reply_to_id": 711589008
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711724965",
    "pull_request_review_id": 758136431,
    "id": 711724965,
    "node_id": "PRRC_kwDOABII584qbA-l",
    "diff_hunk": "@@ -130,10 +115,20 @@ static void AddrManGood(benchmark::Bench& bench)\n         }\n     };\n \n-    uint64_t i = 0;\n+    // the benchmark is quite slow, so we reduce the number of epochs (measurements) for faster results.\n+    bench.epochs(5);\n+\n     bench.run([&] {\n-        markSomeAsGood(*addrmans.at(i));\n-        ++i;\n+        // To make the benchmark independent of the number of evaluations, we always prepare a new addrman.\n+        // This is necessary because CAddrMan::Good() method modifies theobject, affecting the timing of subsequent calls",
    "path": "src/bench/addrman.cpp",
    "position": null,
    "original_position": 34,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "354fbc002275364fefc67fff7447e77fc44dbae1",
    "user": {
      "login": "martinus",
      "id": 14386,
      "node_id": "MDQ6VXNlcjE0Mzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/martinus",
      "html_url": "https://github.com/martinus",
      "followers_url": "https://api.github.com/users/martinus/followers",
      "following_url": "https://api.github.com/users/martinus/following{/other_user}",
      "gists_url": "https://api.github.com/users/martinus/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/martinus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
      "organizations_url": "https://api.github.com/users/martinus/orgs",
      "repos_url": "https://api.github.com/users/martinus/repos",
      "events_url": "https://api.github.com/users/martinus/events{/privacy}",
      "received_events_url": "https://api.github.com/users/martinus/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "fixed in 652faa16a1410b51a5ad78a3121cf6ab9329f640",
    "created_at": "2021-09-19T10:53:41Z",
    "updated_at": "2021-09-19T10:53:41Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711724965",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711724965"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711724965"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711724965/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 123,
    "side": "RIGHT",
    "in_reply_to_id": 711589771
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711725015",
    "pull_request_review_id": 758136477,
    "id": 711725015,
    "node_id": "PRRC_kwDOABII584qbA_X",
    "diff_hunk": "@@ -4,21 +4,24 @@\n \n #include <bench/bench.h>\n \n+#include <clientversion.h>\n #include <crypto/sha256.h>\n #include <util/strencodings.h>\n #include <util/system.h>\n \n #include <memory>\n \n static const char* DEFAULT_BENCH_FILTER = \".*\";\n+static const int64_t DEFAULT_MIN_DURATION_MS = 10;",
    "path": "src/bench/bench_bitcoin.cpp",
    "position": null,
    "original_position": 12,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "354fbc002275364fefc67fff7447e77fc44dbae1",
    "user": {
      "login": "martinus",
      "id": 14386,
      "node_id": "MDQ6VXNlcjE0Mzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/martinus",
      "html_url": "https://github.com/martinus",
      "followers_url": "https://api.github.com/users/martinus/followers",
      "following_url": "https://api.github.com/users/martinus/following{/other_user}",
      "gists_url": "https://api.github.com/users/martinus/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/martinus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
      "organizations_url": "https://api.github.com/users/martinus/orgs",
      "repos_url": "https://api.github.com/users/martinus/repos",
      "events_url": "https://api.github.com/users/martinus/events{/privacy}",
      "received_events_url": "https://api.github.com/users/martinus/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "fixed in b8f16c323e02c3d06e5ad57b6c0f96196d9b12e0",
    "created_at": "2021-09-19T10:54:20Z",
    "updated_at": "2021-09-19T10:54:20Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711725015",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711725015"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711725015"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711725015/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 15,
    "side": "RIGHT",
    "in_reply_to_id": 711590355
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711725089",
    "pull_request_review_id": 758136530,
    "id": 711725089,
    "node_id": "PRRC_kwDOABII584qbBAh",
    "diff_hunk": "@@ -48,17 +51,63 @@ int main(int argc, char** argv)\n     }\n \n     if (HelpRequested(argsman)) {\n-        std::cout << argsman.GetHelpMessage();\n+        std::cout << \"Usage:  bench_bitcoin [options]\\n\"\n+                     \"\\n\"\n+                     \"Description:\\n\"\n+                     \"\\n\"\n+                     \"  bench_bitcoin executes microbenchmarks. The quality of the benchmark results\\n\"\n+                     \"  highly depend on the stability of the machine. It can sometimes be very\\n\"\n+                     \"  difficult to get repeatable results, so here are a few tips to get stable\\n\"\n+                     \"  results:\\n\"\n+                     \"\\n\"\n+                     \"  * Use pyperf [1] to disable frequency scaling, turbo boost etc. For best\\n\"\n+                     \"    use CPU pinning and CPU isolation (see [2]).\\n\"\n+                     \"\\n\"\n+                     \"  * Each call of run() should do exactly the same work. E.g. inserting into\\n\"\n+                     \"    a std::vector doesn't do that as it will reallocate on certain calls. Make\\n\"\n+                     \"    sure each run has exactly the same preconditions.\\n\"\n+                     \"\\n\"\n+                     \"  * If results are still not reliable increase runtime with e.g.\\n\"\n+                     \"    -min_duration_ms=5000 to let a benchmark run for at least 5 seconds\\n\"",
    "path": "src/bench/bench_bitcoin.cpp",
    "position": null,
    "original_position": 49,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "354fbc002275364fefc67fff7447e77fc44dbae1",
    "user": {
      "login": "martinus",
      "id": 14386,
      "node_id": "MDQ6VXNlcjE0Mzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/martinus",
      "html_url": "https://github.com/martinus",
      "followers_url": "https://api.github.com/users/martinus/followers",
      "following_url": "https://api.github.com/users/martinus/following{/other_user}",
      "gists_url": "https://api.github.com/users/martinus/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/martinus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
      "organizations_url": "https://api.github.com/users/martinus/orgs",
      "repos_url": "https://api.github.com/users/martinus/repos",
      "events_url": "https://api.github.com/users/martinus/events{/privacy}",
      "received_events_url": "https://api.github.com/users/martinus/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "wordings fixed in 57a7a020a87f13c231b44ad1861b0bb6e6f92e70",
    "created_at": "2021-09-19T10:55:01Z",
    "updated_at": "2021-09-19T10:55:01Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711725089",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711725089"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711725089"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711725089/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 71,
    "side": "RIGHT",
    "in_reply_to_id": 711591098
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711725143",
    "pull_request_review_id": 758136547,
    "id": 711725143,
    "node_id": "PRRC_kwDOABII584qbBBX",
    "diff_hunk": "@@ -41,11 +41,12 @@ using ankerl::nanobench::Bench;\n typedef std::function<void(Bench&)> BenchFunction;\n \n struct Args {\n-    std::string regex_filter;\n     bool is_list_only;\n     std::vector<double> asymptote;\n     std::string output_csv;\n     std::string output_json;\n+    std::string regex_filter;\n+    std::chrono::milliseconds min_duration;",
    "path": "src/bench/bench.h",
    "position": null,
    "original_position": 10,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "354fbc002275364fefc67fff7447e77fc44dbae1",
    "user": {
      "login": "martinus",
      "id": 14386,
      "node_id": "MDQ6VXNlcjE0Mzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/martinus",
      "html_url": "https://github.com/martinus",
      "followers_url": "https://api.github.com/users/martinus/followers",
      "following_url": "https://api.github.com/users/martinus/following{/other_user}",
      "gists_url": "https://api.github.com/users/martinus/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/martinus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
      "organizations_url": "https://api.github.com/users/martinus/orgs",
      "repos_url": "https://api.github.com/users/martinus/repos",
      "events_url": "https://api.github.com/users/martinus/events{/privacy}",
      "received_events_url": "https://api.github.com/users/martinus/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "done!",
    "created_at": "2021-09-19T10:55:12Z",
    "updated_at": "2021-09-19T10:55:12Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711725143",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711725143"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711725143"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711725143/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 49,
    "side": "RIGHT",
    "in_reply_to_id": 711591578
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711725279",
    "pull_request_review_id": 758136644,
    "id": 711725279,
    "node_id": "PRRC_kwDOABII584qbBDf",
    "diff_hunk": "@@ -13,16 +13,16 @@ static void RollingBloom(benchmark::Bench& bench)\n     uint32_t count = 0;\n     bench.run([&] {\n         count++;\n-        data[0] = count;\n-        data[1] = count >> 8;\n-        data[2] = count >> 16;\n-        data[3] = count >> 24;\n+        data[0] = static_cast<unsigned char>(count);\n+        data[1] = static_cast<unsigned char>(count >> 8);\n+        data[2] = static_cast<unsigned char>(count >> 16);\n+        data[3] = static_cast<unsigned char>(count >> 24);\n         filter.insert(data);\n \n-        data[0] = count >> 24;\n-        data[1] = count >> 16;\n-        data[2] = count >> 8;\n-        data[3] = count;\n+        data[0] = static_cast<unsigned char>(count >> 24);\n+        data[1] = static_cast<unsigned char>(count >> 16);\n+        data[2] = static_cast<unsigned char>(count >> 8);\n+        data[3] = static_cast<unsigned char>(count);",
    "path": "src/bench/rollingbloom.cpp",
    "position": null,
    "original_position": 21,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "354fbc002275364fefc67fff7447e77fc44dbae1",
    "user": {
      "login": "martinus",
      "id": 14386,
      "node_id": "MDQ6VXNlcjE0Mzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/martinus",
      "html_url": "https://github.com/martinus",
      "followers_url": "https://api.github.com/users/martinus/followers",
      "following_url": "https://api.github.com/users/martinus/following{/other_user}",
      "gists_url": "https://api.github.com/users/martinus/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/martinus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
      "organizations_url": "https://api.github.com/users/martinus/orgs",
      "repos_url": "https://api.github.com/users/martinus/repos",
      "events_url": "https://api.github.com/users/martinus/events{/privacy}",
      "received_events_url": "https://api.github.com/users/martinus/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I can't easily change that because the RollingBloomHash's API uses that and I don't want the change to be too large. I've changed this though to use `& 0xFF` like it's done in many other places in the code. Done in b901174bfb6895c8e332c2b5e280348836398e68",
    "created_at": "2021-09-19T10:56:17Z",
    "updated_at": "2021-09-19T10:56:17Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711725279",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711725279"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711725279"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711725279/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 25,
    "side": "RIGHT",
    "in_reply_to_id": 711592387
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711725337",
    "pull_request_review_id": 758136691,
    "id": 711725337,
    "node_id": "PRRC_kwDOABII584qbBEZ",
    "diff_hunk": "@@ -4,21 +4,24 @@\n \n #include <bench/bench.h>\n \n+#include <clientversion.h>\n #include <crypto/sha256.h>\n #include <util/strencodings.h>\n #include <util/system.h>\n \n #include <memory>\n \n static const char* DEFAULT_BENCH_FILTER = \".*\";\n+static const int64_t DEFAULT_MIN_DURATION_MS = 10;\n \n static void SetupBenchArgs(ArgsManager& argsman)\n {\n     SetupHelpOptions(argsman);\n \n-    argsman.AddArg(\"-asymptote=n1,n2,n3,...\", \"Test asymptotic growth of the runtime of an algorithm, if supported by the benchmark\", ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n+    argsman.AddArg(\"-asymptote=<n1,n2,n3,...>\", \"Test asymptotic growth of the runtime of an algorithm, if supported by the benchmark\", ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n     argsman.AddArg(\"-filter=<regex>\", strprintf(\"Regular expression filter to select benchmark by name (default: %s)\", DEFAULT_BENCH_FILTER), ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n-    argsman.AddArg(\"-list\", \"List benchmarks without executing them\", ArgsManager::ALLOW_ANY, OptionsCategory::OPTIONS);\n+    argsman.AddArg(\"-list\", \"List benchmarks without executing them\", ArgsManager::ALLOW_BOOL, OptionsCategory::OPTIONS);\n+    argsman.AddArg(\"-min_duration_ms=<milliseconds>\", strprintf(\"Minimum runtime per benchmark, in milliseconds (default: %d)\", DEFAULT_MIN_DURATION_MS), ArgsManager::ALLOW_INT, OptionsCategory::OPTIONS);",
    "path": "src/bench/bench_bitcoin.cpp",
    "position": null,
    "original_position": 23,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "354fbc002275364fefc67fff7447e77fc44dbae1",
    "user": {
      "login": "martinus",
      "id": 14386,
      "node_id": "MDQ6VXNlcjE0Mzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/martinus",
      "html_url": "https://github.com/martinus",
      "followers_url": "https://api.github.com/users/martinus/followers",
      "following_url": "https://api.github.com/users/martinus/following{/other_user}",
      "gists_url": "https://api.github.com/users/martinus/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/martinus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
      "organizations_url": "https://api.github.com/users/martinus/orgs",
      "repos_url": "https://api.github.com/users/martinus/repos",
      "events_url": "https://api.github.com/users/martinus/events{/privacy}",
      "received_events_url": "https://api.github.com/users/martinus/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "done in b8f16c323e02c3d06e5ad57b6c0f96196d9b12e0",
    "created_at": "2021-09-19T10:56:52Z",
    "updated_at": "2021-09-19T10:56:52Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711725337",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711725337"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711725337"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711725337/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 24,
    "side": "RIGHT",
    "in_reply_to_id": 711593977
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711725386",
    "pull_request_review_id": 758136729,
    "id": 711725386,
    "node_id": "PRRC_kwDOABII584qbBFK",
    "diff_hunk": "@@ -48,17 +51,63 @@ int main(int argc, char** argv)\n     }\n \n     if (HelpRequested(argsman)) {\n-        std::cout << argsman.GetHelpMessage();\n+        std::cout << \"Usage:  bench_bitcoin [options]\\n\"\n+                     \"\\n\"\n+                     \"Description:\\n\"\n+                     \"\\n\"\n+                     \"  bench_bitcoin executes microbenchmarks. The quality of the benchmark results\\n\"\n+                     \"  highly depend on the stability of the machine. It can sometimes be very\\n\"\n+                     \"  difficult to get repeatable results, so here are a few tips to get stable\\n\"\n+                     \"  results:\\n\"\n+                     \"\\n\"\n+                     \"  * Use pyperf [1] to disable frequency scaling, turbo boost etc. For best\\n\"\n+                     \"    use CPU pinning and CPU isolation (see [2]).\\n\"\n+                     \"\\n\"\n+                     \"  * Each call of run() should do exactly the same work. E.g. inserting into\\n\"\n+                     \"    a std::vector doesn't do that as it will reallocate on certain calls. Make\\n\"\n+                     \"    sure each run has exactly the same preconditions.\\n\"\n+                     \"\\n\"\n+                     \"  * If results are still not reliable increase runtime with e.g.\\n\"\n+                     \"    -min_duration_ms=5000 to let a benchmark run for at least 5 seconds\\n\"\n+                     \"\\n\"\n+                     \"  * bench_bitcoin uses nanobench [3] for which there is extensive\\n\"\n+                     \"    documentation available online.\\n\"\n+                     \"\\n\"\n+                     \"Environment Variables:\\n\"\n+                     \"\\n\"\n+                     \"  To attach a profiler you can run a benchmark in endless mode. This can be\\n\"\n+                     \"  done with the environment variable NANOBENCH_ENDLESS. E.g. like so:\\n\"\n+                     \"\\n\"\n+                     \"    NANOBENCH_ENDLESS=MuHash ./bench_bitcoin -filter=MuHash\\n\"\n+                     \"\\n\"\n+                     \"  In rare cases it can be useful to suppress stability warnings. This can be\\n\"\n+                     \"  done with the environment variable NANOBENCH_SUPPRESS_WARNINGS, e.g:\\n\"\n+                     \"\\n\"\n+                     \"    NANOBENCH_SUPPRESS_WARNINGS=1 ./bench_bitcoin\\n\"\n+                     \"\\n\"\n+                  << argsman.GetHelpMessage()",
    "path": "src/bench/bench_bitcoin.cpp",
    "position": null,
    "original_position": 66,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "354fbc002275364fefc67fff7447e77fc44dbae1",
    "user": {
      "login": "martinus",
      "id": 14386,
      "node_id": "MDQ6VXNlcjE0Mzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/martinus",
      "html_url": "https://github.com/martinus",
      "followers_url": "https://api.github.com/users/martinus/followers",
      "following_url": "https://api.github.com/users/martinus/following{/other_user}",
      "gists_url": "https://api.github.com/users/martinus/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/martinus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
      "organizations_url": "https://api.github.com/users/martinus/orgs",
      "repos_url": "https://api.github.com/users/martinus/repos",
      "events_url": "https://api.github.com/users/martinus/events{/privacy}",
      "received_events_url": "https://api.github.com/users/martinus/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "changed in 57a7a020a87f13c231b44ad1861b0bb6e6f92e70",
    "created_at": "2021-09-19T10:57:15Z",
    "updated_at": "2021-09-19T10:57:15Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711725386",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711725386"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711725386"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711725386/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 88,
    "side": "RIGHT",
    "in_reply_to_id": 711593618
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711725752",
    "pull_request_review_id": 758136930,
    "id": 711725752,
    "node_id": "PRRC_kwDOABII584qbBK4",
    "diff_hunk": "@@ -61,6 +59,11 @@ void benchmark::BenchRunner::RunAll(const Args& args)\n \n         Bench bench;\n         bench.name(p.first);\n+        if (args.min_duration > std::chrono::milliseconds::zero()) {\n+            // convert to nanos before dividing to reduce rounding errors\n+            bench.minEpochTime(std::chrono::nanoseconds(args.min_duration) / bench.epochs());",
    "path": "src/bench/bench.cpp",
    "position": null,
    "original_position": 16,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "354fbc002275364fefc67fff7447e77fc44dbae1",
    "user": {
      "login": "martinus",
      "id": 14386,
      "node_id": "MDQ6VXNlcjE0Mzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/martinus",
      "html_url": "https://github.com/martinus",
      "followers_url": "https://api.github.com/users/martinus/followers",
      "following_url": "https://api.github.com/users/martinus/following{/other_user}",
      "gists_url": "https://api.github.com/users/martinus/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/martinus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
      "organizations_url": "https://api.github.com/users/martinus/orgs",
      "repos_url": "https://api.github.com/users/martinus/repos",
      "events_url": "https://api.github.com/users/martinus/events{/privacy}",
      "received_events_url": "https://api.github.com/users/martinus/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "hm, I think it's fine to use `std::chrono::nanoseconds`, it's basically the same but with `int64_t`. It should be large so there's no easy chance for overflow. I generally try to not use `duration_cast`, because that's a sign that at that place there will be some loss of information due to the casting.\r\n\r\nI've changed  line 64 to 0ms in b8f16c323e02c3d06e5ad57b6c0f96196d9b12e0",
    "created_at": "2021-09-19T10:59:55Z",
    "updated_at": "2021-09-19T10:59:56Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711725752",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711725752"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711725752"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711725752/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 64,
    "side": "RIGHT",
    "in_reply_to_id": 711598161
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711761445",
    "pull_request_review_id": 758160902,
    "id": 711761445,
    "node_id": "PRRC_kwDOABII584qbJ4l",
    "diff_hunk": "@@ -48,17 +51,62 @@ int main(int argc, char** argv)\n     }\n \n     if (HelpRequested(argsman)) {\n-        std::cout << argsman.GetHelpMessage();\n+        std::cout << \"Usage:  bench_bitcoin [options]\\n\"\n+                     \"\\n\"\n+                  << argsman.GetHelpMessage()\n+                  << \"Description:\\n\"\n+                     \"\\n\"\n+                     \"  bench_bitcoin executes microbenchmarks. The quality of the benchmark results\\n\"\n+                     \"  highly depend on the stability of the machine. It can sometimes be difficult\\n\"\n+                     \"  to get stable, repeatable results, so here are a few tips:\\n\"\n+                     \"\\n\"\n+                     \"  * Use pyperf [1] to disable frequency scaling, turbo boost etc. For best\\n\"\n+                     \"    results, use CPU pinning and CPU isolation (see [2]).\\n\"\n+                     \"\\n\"\n+                     \"  * Each call of run() should do exactly the same work. E.g. inserting into\\n\"\n+                     \"    a std::vector doesn't do that as it will reallocate on certain calls. Make\\n\"\n+                     \"    sure each run has exactly the same preconditions.\\n\"\n+                     \"\\n\"\n+                     \"  * If results are still not reliable, increase runtime with e.g.\\n\"\n+                     \"    -min_duration_ms=5000 to let a benchmark run for at least 5 seconds.\\n\"",
    "path": "src/bench/bench_bitcoin.cpp",
    "position": null,
    "original_position": 49,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "b901174bfb6895c8e332c2b5e280348836398e68",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "57a7a02\r\n```suggestion\r\n                     \"    -min_time=5000 to let a benchmark run for at least 5 seconds.\\n\"\r\n```",
    "created_at": "2021-09-19T15:26:19Z",
    "updated_at": "2021-09-19T15:52:16Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711761445",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711761445"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711761445"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711761445/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 71,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711763464",
    "pull_request_review_id": 758160902,
    "id": 711763464,
    "node_id": "PRRC_kwDOABII584qbKYI",
    "diff_hunk": "@@ -61,6 +59,12 @@ void benchmark::BenchRunner::RunAll(const Args& args)\n \n         Bench bench;\n         bench.name(p.first);\n+        if (args.min_time > 0ms) {\n+            // convert to nanos before dividing to reduce rounding errors\n+            std::chrono::nanoseconds min_time_ns = args.min_time;",
    "path": "src/bench/bench.cpp",
    "position": 27,
    "original_position": 16,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "b901174bfb6895c8e332c2b5e280348836398e68",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "b8f16c3\r\n\r\n- per `doc/developer-notes.md`, it looks like `#include <chrono>` should be added to bench.cpp and bench_bitcoin.cpp:\r\n```\r\n- Every `.cpp` and `.h` file should `#include` every header file it directly uses classes, functions or other\r\n  definitions from, even if those headers are already included indirectly through other headers.\r\n\r\n  - *Rationale*: Excluding headers because they are already indirectly included results in compilation\r\n    failures when those indirect dependencies change. Furthermore, it obscures what the real code\r\n    dependencies are.\r\n```\r\n\r\n- pico-nit, feel free to ignore\r\n```suggestion\r\n            const std::chrono::nanoseconds min_time_ns{args.min_time};\r\n```",
    "created_at": "2021-09-19T15:40:39Z",
    "updated_at": "2021-09-19T15:52:16Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711763464",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711763464"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711763464"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711763464/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 73,
    "original_line": 73,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711777746",
    "pull_request_review_id": 758171233,
    "id": 711777746,
    "node_id": "PRRC_kwDOABII584qbN3S",
    "diff_hunk": "@@ -61,6 +59,12 @@ void benchmark::BenchRunner::RunAll(const Args& args)\n \n         Bench bench;\n         bench.name(p.first);\n+        if (args.min_time > 0ms) {\n+            // convert to nanos before dividing to reduce rounding errors\n+            std::chrono::nanoseconds min_time_ns = args.min_time;",
    "path": "src/bench/bench.cpp",
    "position": 27,
    "original_position": 16,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "b901174bfb6895c8e332c2b5e280348836398e68",
    "user": {
      "login": "martinus",
      "id": 14386,
      "node_id": "MDQ6VXNlcjE0Mzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/martinus",
      "html_url": "https://github.com/martinus",
      "followers_url": "https://api.github.com/users/martinus/followers",
      "following_url": "https://api.github.com/users/martinus/following{/other_user}",
      "gists_url": "https://api.github.com/users/martinus/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/martinus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
      "organizations_url": "https://api.github.com/users/martinus/orgs",
      "repos_url": "https://api.github.com/users/martinus/repos",
      "events_url": "https://api.github.com/users/martinus/events{/privacy}",
      "received_events_url": "https://api.github.com/users/martinus/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "hm, that include guideline is a bit hard to follow. There are lots of other missing includes, e.g. `bench_bitcoin.cpp` would need at least chrono, cstdint, vector, sstream, string, iostream. Should I add these as well?\r\n\r\nAbout the constructor, I think that is one of the cases where assignment is better: chrono's assignment is more strict than the constructor, you can't do e.g. `std::chrono::nanoseconds x = 123` but you can do `std::chrono::nanoseconds x{123}`. So with the assignment it's certain that `args.min_time` is actually another chrono type that convertible without loss of information, and not just any number that could represent anything.",
    "created_at": "2021-09-19T17:37:19Z",
    "updated_at": "2021-09-19T17:37:19Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711777746",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711777746"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711777746"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711777746/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 73,
    "original_line": 73,
    "side": "RIGHT",
    "in_reply_to_id": 711763464
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711885691",
    "pull_request_review_id": 758261767,
    "id": 711885691,
    "node_id": "PRRC_kwDOABII584qboN7",
    "diff_hunk": "@@ -48,17 +51,62 @@ int main(int argc, char** argv)\n     }\n \n     if (HelpRequested(argsman)) {\n-        std::cout << argsman.GetHelpMessage();\n+        std::cout << \"Usage:  bench_bitcoin [options]\\n\"\n+                     \"\\n\"\n+                  << argsman.GetHelpMessage()\n+                  << \"Description:\\n\"\n+                     \"\\n\"\n+                     \"  bench_bitcoin executes microbenchmarks. The quality of the benchmark results\\n\"\n+                     \"  highly depend on the stability of the machine. It can sometimes be difficult\\n\"\n+                     \"  to get stable, repeatable results, so here are a few tips:\\n\"\n+                     \"\\n\"\n+                     \"  * Use pyperf [1] to disable frequency scaling, turbo boost etc. For best\\n\"\n+                     \"    results, use CPU pinning and CPU isolation (see [2]).\\n\"\n+                     \"\\n\"\n+                     \"  * Each call of run() should do exactly the same work. E.g. inserting into\\n\"\n+                     \"    a std::vector doesn't do that as it will reallocate on certain calls. Make\\n\"\n+                     \"    sure each run has exactly the same preconditions.\\n\"\n+                     \"\\n\"\n+                     \"  * If results are still not reliable, increase runtime with e.g.\\n\"\n+                     \"    -min_duration_ms=5000 to let a benchmark run for at least 5 seconds.\\n\"",
    "path": "src/bench/bench_bitcoin.cpp",
    "position": null,
    "original_position": 49,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "b901174bfb6895c8e332c2b5e280348836398e68",
    "user": {
      "login": "martinus",
      "id": 14386,
      "node_id": "MDQ6VXNlcjE0Mzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/martinus",
      "html_url": "https://github.com/martinus",
      "followers_url": "https://api.github.com/users/martinus/followers",
      "following_url": "https://api.github.com/users/martinus/following{/other_user}",
      "gists_url": "https://api.github.com/users/martinus/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/martinus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
      "organizations_url": "https://api.github.com/users/martinus/orgs",
      "repos_url": "https://api.github.com/users/martinus/repos",
      "events_url": "https://api.github.com/users/martinus/events{/privacy}",
      "received_events_url": "https://api.github.com/users/martinus/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "damn, forgot that one! Fixed in the latest rebase.",
    "created_at": "2021-09-20T05:31:48Z",
    "updated_at": "2021-09-20T05:31:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711885691",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711885691"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711885691"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711885691/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 71,
    "side": "RIGHT",
    "in_reply_to_id": 711761445
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711885770",
    "pull_request_review_id": 758261864,
    "id": 711885770,
    "node_id": "PRRC_kwDOABII584qboPK",
    "diff_hunk": "@@ -61,6 +59,12 @@ void benchmark::BenchRunner::RunAll(const Args& args)\n \n         Bench bench;\n         bench.name(p.first);\n+        if (args.min_time > 0ms) {\n+            // convert to nanos before dividing to reduce rounding errors\n+            std::chrono::nanoseconds min_time_ns = args.min_time;",
    "path": "src/bench/bench.cpp",
    "position": 27,
    "original_position": 16,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "b901174bfb6895c8e332c2b5e280348836398e68",
    "user": {
      "login": "martinus",
      "id": 14386,
      "node_id": "MDQ6VXNlcjE0Mzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/martinus",
      "html_url": "https://github.com/martinus",
      "followers_url": "https://api.github.com/users/martinus/followers",
      "following_url": "https://api.github.com/users/martinus/following{/other_user}",
      "gists_url": "https://api.github.com/users/martinus/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/martinus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
      "organizations_url": "https://api.github.com/users/martinus/orgs",
      "repos_url": "https://api.github.com/users/martinus/repos",
      "events_url": "https://api.github.com/users/martinus/events{/privacy}",
      "received_events_url": "https://api.github.com/users/martinus/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I've now added the headers in clean up includes commit",
    "created_at": "2021-09-20T05:32:09Z",
    "updated_at": "2021-09-20T05:32:09Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711885770",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711885770"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711885770"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711885770/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 73,
    "original_line": 73,
    "side": "RIGHT",
    "in_reply_to_id": 711763464
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711994199",
    "pull_request_review_id": 758402167,
    "id": 711994199,
    "node_id": "PRRC_kwDOABII584qcCtX",
    "diff_hunk": "@@ -130,10 +115,17 @@ static void AddrManGood(benchmark::Bench& bench)\n         }\n     };\n \n-    uint64_t i = 0;\n     bench.run([&] {\n-        markSomeAsGood(*addrmans.at(i));\n-        ++i;\n+        // To make the benchmark independent of the number of evaluations, we always prepare a new addrman.\n+        // This is necessary because CAddrMan::Good() method modifies the object, affecting the timing of subsequent calls\n+        // to the same method and we want to do the same amount of work in every loop iteration.\n+        //\n+        // This has some overhead (about 8% on my machine), but that overhead is constant so improvements in",
    "path": "src/bench/addrman.cpp",
    "position": null,
    "original_position": 34,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "cf84fc6f4a0e4e45bb080f7df8bb9626e638f52a",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": " Likely going to change with #22974",
    "created_at": "2021-09-20T09:08:38Z",
    "updated_at": "2021-09-20T09:45:37Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711994199",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711994199"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r711994199"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/711994199/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 123,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/712072172",
    "pull_request_review_id": 758504899,
    "id": 712072172,
    "node_id": "PRRC_kwDOABII584qcVvs",
    "diff_hunk": "@@ -130,10 +115,17 @@ static void AddrManGood(benchmark::Bench& bench)\n         }\n     };\n \n-    uint64_t i = 0;\n     bench.run([&] {\n-        markSomeAsGood(*addrmans.at(i));\n-        ++i;\n+        // To make the benchmark independent of the number of evaluations, we always prepare a new addrman.\n+        // This is necessary because CAddrMan::Good() method modifies the object, affecting the timing of subsequent calls\n+        // to the same method and we want to do the same amount of work in every loop iteration.\n+        //\n+        // This has some overhead (about 8% on my machine), but that overhead is constant so improvements in",
    "path": "src/bench/addrman.cpp",
    "position": null,
    "original_position": 34,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "cf84fc6f4a0e4e45bb080f7df8bb9626e638f52a",
    "user": {
      "login": "martinus",
      "id": 14386,
      "node_id": "MDQ6VXNlcjE0Mzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/martinus",
      "html_url": "https://github.com/martinus",
      "followers_url": "https://api.github.com/users/martinus/followers",
      "following_url": "https://api.github.com/users/martinus/following{/other_user}",
      "gists_url": "https://api.github.com/users/martinus/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/martinus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
      "organizations_url": "https://api.github.com/users/martinus/orgs",
      "repos_url": "https://api.github.com/users/martinus/repos",
      "events_url": "https://api.github.com/users/martinus/events{/privacy}",
      "received_events_url": "https://api.github.com/users/martinus/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "hm, I don't know much about what addrman does, but currently `markSomeAsGood` in the benchmark only uses every 32nd element. Can be bumped up to call Good() on every entry, maybe in random order?",
    "created_at": "2021-09-20T11:12:38Z",
    "updated_at": "2021-09-20T11:12:39Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r712072172",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/712072172"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r712072172"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/712072172/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 123,
    "side": "RIGHT",
    "in_reply_to_id": 711994199
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/713006208",
    "pull_request_review_id": 759701657,
    "id": 713006208,
    "node_id": "PRRC_kwDOABII584qf5yA",
    "diff_hunk": "@@ -130,10 +115,17 @@ static void AddrManGood(benchmark::Bench& bench)\n         }\n     };\n \n-    uint64_t i = 0;\n     bench.run([&] {\n-        markSomeAsGood(*addrmans.at(i));\n-        ++i;\n+        // To make the benchmark independent of the number of evaluations, we always prepare a new addrman.\n+        // This is necessary because CAddrMan::Good() method modifies the object, affecting the timing of subsequent calls\n+        // to the same method and we want to do the same amount of work in every loop iteration.\n+        //\n+        // This has some overhead (about 8% on my machine), but that overhead is constant so improvements in",
    "path": "src/bench/addrman.cpp",
    "position": null,
    "original_position": 34,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "cf84fc6f4a0e4e45bb080f7df8bb9626e638f52a",
    "user": {
      "login": "martinus",
      "id": 14386,
      "node_id": "MDQ6VXNlcjE0Mzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/martinus",
      "html_url": "https://github.com/martinus",
      "followers_url": "https://api.github.com/users/martinus/followers",
      "following_url": "https://api.github.com/users/martinus/following{/other_user}",
      "gists_url": "https://api.github.com/users/martinus/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/martinus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
      "organizations_url": "https://api.github.com/users/martinus/orgs",
      "repos_url": "https://api.github.com/users/martinus/repos",
      "events_url": "https://api.github.com/users/martinus/events{/privacy}",
      "received_events_url": "https://api.github.com/users/martinus/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I've rebased because #22974 is already merged, and updated the benchmark in 153e686 so it makes more sense with the much faster `Good()`. Nothing else has changed",
    "created_at": "2021-09-21T12:49:38Z",
    "updated_at": "2021-09-21T12:49:39Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r713006208",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/713006208"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r713006208"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/713006208/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 123,
    "side": "RIGHT",
    "in_reply_to_id": 711994199
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/713040141",
    "pull_request_review_id": 759749061,
    "id": 713040141,
    "node_id": "PRRC_kwDOABII584qgCEN",
    "diff_hunk": "@@ -130,10 +115,17 @@ static void AddrManGood(benchmark::Bench& bench)\n         }\n     };\n \n-    uint64_t i = 0;\n     bench.run([&] {\n-        markSomeAsGood(*addrmans.at(i));\n-        ++i;\n+        // To make the benchmark independent of the number of evaluations, we always prepare a new addrman.\n+        // This is necessary because CAddrMan::Good() method modifies the object, affecting the timing of subsequent calls\n+        // to the same method and we want to do the same amount of work in every loop iteration.\n+        //\n+        // This has some overhead (about 8% on my machine), but that overhead is constant so improvements in",
    "path": "src/bench/addrman.cpp",
    "position": null,
    "original_position": 34,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "cf84fc6f4a0e4e45bb080f7df8bb9626e638f52a",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "If the overhead is now 99%, then changes in the order of -50% or +100% are not noticed. Just asking to make sure the overhead isn't too much.",
    "created_at": "2021-09-21T13:28:10Z",
    "updated_at": "2021-09-21T13:28:10Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r713040141",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/713040141"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r713040141"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/713040141/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 123,
    "side": "RIGHT",
    "in_reply_to_id": 711994199
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/713057764",
    "pull_request_review_id": 759773250,
    "id": 713057764,
    "node_id": "PRRC_kwDOABII584qgGXk",
    "diff_hunk": "@@ -130,10 +115,17 @@ static void AddrManGood(benchmark::Bench& bench)\n         }\n     };\n \n-    uint64_t i = 0;\n     bench.run([&] {\n-        markSomeAsGood(*addrmans.at(i));\n-        ++i;\n+        // To make the benchmark independent of the number of evaluations, we always prepare a new addrman.\n+        // This is necessary because CAddrMan::Good() method modifies the object, affecting the timing of subsequent calls\n+        // to the same method and we want to do the same amount of work in every loop iteration.\n+        //\n+        // This has some overhead (about 8% on my machine), but that overhead is constant so improvements in",
    "path": "src/bench/addrman.cpp",
    "position": null,
    "original_position": 34,
    "commit_id": "e148a5233292d156cda76cb20afb6641fc20f25e",
    "original_commit_id": "cf84fc6f4a0e4e45bb080f7df8bb9626e638f52a",
    "user": {
      "login": "martinus",
      "id": 14386,
      "node_id": "MDQ6VXNlcjE0Mzg2",
      "avatar_url": "https://avatars.githubusercontent.com/u/14386?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/martinus",
      "html_url": "https://github.com/martinus",
      "followers_url": "https://api.github.com/users/martinus/followers",
      "following_url": "https://api.github.com/users/martinus/following{/other_user}",
      "gists_url": "https://api.github.com/users/martinus/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/martinus/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/martinus/subscriptions",
      "organizations_url": "https://api.github.com/users/martinus/orgs",
      "repos_url": "https://api.github.com/users/martinus/repos",
      "events_url": "https://api.github.com/users/martinus/events{/privacy}",
      "received_events_url": "https://api.github.com/users/martinus/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This is what I get when I run `./src/bench/bench_bitcoin -min_time=10000 -filter=\"AddrManAdd.*\"` on my machine:\r\n\r\n|               ns/op |                op/s |    err% |          ins/op |          cyc/op |    IPC |         bra/op |   miss% |     total | benchmark\r\n|--------------------:|--------------------:|--------:|----------------:|----------------:|-------:|---------------:|--------:|----------:|:----------\r\n|       44,370,397.17 |               22.54 |    0.6% |  448,854,352.19 |  141,515,648.83 |  3.172 |  33,913,128.43 |    0.1% |     11.05 | `AddrManAdd`\r\n|      114,389,015.11 |                8.74 |    0.2% |1,201,264,095.33 |  364,837,620.00 |  3.293 |  78,812,510.33 |    0.1% |     10.87 | `AddrManAddThenGood`\r\n\r\nSo with the change it's ~44ms for `AddrManAdd`, ~114ms for `AddrManAddThenGood`, leaving ~70ms for just the Good() part of the benchmark",
    "created_at": "2021-09-21T13:46:33Z",
    "updated_at": "2021-09-21T13:46:34Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r713057764",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/713057764"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/23025#discussion_r713057764"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/23025"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/713057764/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 123,
    "side": "RIGHT",
    "in_reply_to_id": 711994199
  }
]