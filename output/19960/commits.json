[
  {
    "sha": "712f95d3324d02310dd468e7bfd1e1b0df432e77",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3MTJmOTVkMzMyNGQwMjMxMGRkNDY4ZTdiZmQxZTFiMGRmNDMyZTc3",
    "commit": {
      "author": {
        "name": "Aaron Clauson",
        "email": "aaron@sipsorcery.com",
        "date": "2020-09-29T12:48:28Z"
      },
      "committer": {
        "name": "Aaron Clauson",
        "email": "aaron@sipsorcery.com",
        "date": "2020-09-29T12:48:28Z"
      },
      "message": "Update msvc build to use new vcpkg manifest\n\nThe vcpkg tool has introduced a proper way to use manifests, https://devblogs.microsoft.com/cppblog/vcpkg-accelerate-your-team-development-environment-with-binary-caching-and-manifests/. This PR replaces the custom text file mechanism with the new manifest approach.\n\nIt is planned that vckpg manifests will include the ability to version dependencies in the future. Dependency versions would solve a number of issues that currently require workarounds with the appveyor CI.\n\nSet vcpkg manifest version to 1 to avoid any perception it's related to any release or other version numbering.",
      "tree": {
        "sha": "3300602820563f8c97bf87e9d2bf01ede25ce358",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/3300602820563f8c97bf87e9d2bf01ede25ce358"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/712f95d3324d02310dd468e7bfd1e1b0df432e77",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEnTzIanL4SUNC6l/RCkG9w/T6/xwFAl9zLU4ACgkQCkG9w/T6\n/xxBfA/7B52GVu11KKMuwxhYiC9jIaIodoS+ooVBRF3W49x+Vx6IXG8OPnwh0Sm5\nfqxZFGwgkkh0Mzw+Hbup2wk346ObHbCQuqcCGWhPNXbuhYNc64htUv7My446Mc8r\nq24x7x+9Y0XRoAknjVij3bGzpBuzolE+O96FItIb/v0zIpIQu73E0nVaYOPL3Oy1\nN64NIFYgJcGRQv/Tuhssb4VvQ6Y20wDIg37tLBUWbwf8xNuuf8lewHdC5QfjyOSB\nxpubN8TFCSAK4chebn27jn5IpLCak6qUgElj90SbKDwQa3pBRNF67m8JyFDHzZjZ\nHxbZ2qms8xwlJTkCHW6XmynVWDuWFyKDaw5qyXkh6d4trHx7pu7W0+GR2fTkAI3I\nzH4M8qbnRpLe0ivC/H0Pz29Tcr5OWp3XYOCgl+ev0qp3azRNlrmQ4LL932Ig3PkC\nPj7sKYbQFATkz4JVc+ZUDoR0QwBW7LZyarDqiv7Fm28MiL13Bc+89j8Q9WnOnmpY\nvmnIhDuEe7fETRUA/yNH7M3z5AYndgf8TMTCNYEC96/YrvS2TjfNeOIYFvkPlozT\nGyWJfnN3W+hc3C8bUo4LE2I6fvZ1XGYMllvfdVo5HCLL1oE1qLXy05bquzZumt6Y\nAr32RW1bFvWY6CHGbWgn0fbReCBuqPgdciTE1d4uFG4/MTx6Y7U=\n=UtKK\n-----END PGP SIGNATURE-----",
        "payload": "tree 3300602820563f8c97bf87e9d2bf01ede25ce358\nparent 1b313cacc99a1b372238f9036abed5491f9d28f7\nauthor Aaron Clauson <aaron@sipsorcery.com> 1601383708 +0100\ncommitter Aaron Clauson <aaron@sipsorcery.com> 1601383708 +0100\n\nUpdate msvc build to use new vcpkg manifest\n\nThe vcpkg tool has introduced a proper way to use manifests, https://devblogs.microsoft.com/cppblog/vcpkg-accelerate-your-team-development-environment-with-binary-caching-and-manifests/. This PR replaces the custom text file mechanism with the new manifest approach.\n\nIt is planned that vckpg manifests will include the ability to version dependencies in the future. Dependency versions would solve a number of issues that currently require workarounds with the appveyor CI.\n\nSet vcpkg manifest version to 1 to avoid any perception it's related to any release or other version numbering.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/712f95d3324d02310dd468e7bfd1e1b0df432e77",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/712f95d3324d02310dd468e7bfd1e1b0df432e77",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/712f95d3324d02310dd468e7bfd1e1b0df432e77/comments",
    "author": {
      "login": "sipsorcery",
      "id": 197660,
      "node_id": "MDQ6VXNlcjE5NzY2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/197660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipsorcery",
      "html_url": "https://github.com/sipsorcery",
      "followers_url": "https://api.github.com/users/sipsorcery/followers",
      "following_url": "https://api.github.com/users/sipsorcery/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipsorcery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipsorcery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipsorcery/subscriptions",
      "organizations_url": "https://api.github.com/users/sipsorcery/orgs",
      "repos_url": "https://api.github.com/users/sipsorcery/repos",
      "events_url": "https://api.github.com/users/sipsorcery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipsorcery/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sipsorcery",
      "id": 197660,
      "node_id": "MDQ6VXNlcjE5NzY2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/197660?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipsorcery",
      "html_url": "https://github.com/sipsorcery",
      "followers_url": "https://api.github.com/users/sipsorcery/followers",
      "following_url": "https://api.github.com/users/sipsorcery/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipsorcery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipsorcery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipsorcery/subscriptions",
      "organizations_url": "https://api.github.com/users/sipsorcery/orgs",
      "repos_url": "https://api.github.com/users/sipsorcery/repos",
      "events_url": "https://api.github.com/users/sipsorcery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipsorcery/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "1b313cacc99a1b372238f9036abed5491f9d28f7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1b313cacc99a1b372238f9036abed5491f9d28f7",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/1b313cacc99a1b372238f9036abed5491f9d28f7"
      }
    ],
    "stats": {
      "total": 68,
      "additions": 38,
      "deletions": 30
    },
    "files": [
      {
        "sha": "67739916f6e1c5251264a178c1d3493e86ddd597",
        "filename": ".appveyor.yml",
        "status": "modified",
        "additions": 2,
        "deletions": 8,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/712f95d3324d02310dd468e7bfd1e1b0df432e77/.appveyor.yml",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/712f95d3324d02310dd468e7bfd1e1b0df432e77/.appveyor.yml",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/.appveyor.yml?ref=712f95d3324d02310dd468e7bfd1e1b0df432e77",
        "patch": "@@ -11,25 +11,19 @@ environment:\n   QT_DOWNLOAD_HASH: '9a8c6eb20967873785057fdcd329a657c7f922b0af08c5fde105cc597dd37e21'\n   QT_LOCAL_PATH: 'C:\\Qt5.9.8_x64_static_vs2019'\n   VCPKG_INSTALL_PATH: 'C:\\tools\\vcpkg\\installed'\n-  VCPKG_COMMIT_ID: 'f3f329a048eaff759c1992c458f2e12351486bc7'\n+  VCPKG_COMMIT_ID: '13590753fec479c5b0a3d48dd553dde8d49615fc'\n install:\n # Disable zmq test for now since python zmq library on Windows would cause Access violation sometimes.\n # - cmd: pip install zmq\n # Powershell block below is to install the c++ dependencies via vcpkg. The pseudo code is:\n #    a. Checkout the vcpkg source (including port files) for the specific checkout and build the vcpkg binary,\n-#    b. Install the missing packages.\n+#    b. Install the missing packages using the vcpkg manifest.\n - ps: |\n-      $env:PACKAGES = Get-Content -Path build_msvc\\vcpkg-packages.txt\n-      Write-Host \"vcpkg installing packages: $env:PACKAGES\"\n       cd c:\\tools\\vcpkg\n       $env:GIT_REDIRECT_STDERR = '2>&1' # git is writing non-errors to STDERR when doing git pull. Send to STDOUT instead.\n       git pull origin master > $null\n       git -c advice.detachedHead=false checkout $env:VCPKG_COMMIT_ID\n       .\\bootstrap-vcpkg.bat > $null\n-      Add-Content \"C:\\tools\\vcpkg\\triplets\\$env:PLATFORM-windows-static.cmake\" \"set(VCPKG_BUILD_TYPE release)\"\n-      .\\vcpkg install --triplet $env:PLATFORM-windows-static $env:PACKAGES.split() > $null\n-      Write-Host \"vcpkg packages installed successfully.\"\n-      .\\vcpkg integrate install\n       cd \"$env:APPVEYOR_BUILD_FOLDER\"\n before_build:\n # Powershell block below is to download and extract the Qt static libraries. The pseudo code is:"
      },
      {
        "sha": "ae8120fdf3a44ab47700fe40a3a3cd93f3cb8d96",
        "filename": "build_msvc/.gitignore",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/712f95d3324d02310dd468e7bfd1e1b0df432e77/build_msvc/.gitignore",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/712f95d3324d02310dd468e7bfd1e1b0df432e77/build_msvc/.gitignore",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/build_msvc/.gitignore?ref=712f95d3324d02310dd468e7bfd1e1b0df432e77",
        "patch": "@@ -24,3 +24,4 @@ libtest_util/libtest_util.vcxproj\n */Win32\n libbitcoin_qt/QtGeneratedFiles/*\n test_bitcoin-qt/QtGeneratedFiles/*\n+vcpkg_installed\n\\ No newline at end of file"
      },
      {
        "sha": "87ea556a23b31897ac72907ebb5f9ee9516b7a1b",
        "filename": "build_msvc/README.md",
        "status": "modified",
        "additions": 7,
        "deletions": 21,
        "changes": 28,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/712f95d3324d02310dd468e7bfd1e1b0df432e77/build_msvc/README.md",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/712f95d3324d02310dd468e7bfd1e1b0df432e77/build_msvc/README.md",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/build_msvc/README.md?ref=712f95d3324d02310dd468e7bfd1e1b0df432e77",
        "patch": "@@ -3,7 +3,7 @@ Building Bitcoin Core with Visual Studio\n \n Introduction\n ---------------------\n-Solution and project files to build the Bitcoin Core applications `msbuild` or Visual Studio can be found in the build_msvc directory. The build has been tested with Visual Studio 2017 and 2019.\n+Solution and project files to build the Bitcoin Core applications `msbuild` or Visual Studio can be found in the `build_msvc` directory. The build has been tested with Visual Studio 2017 and 2019.\n \n Building with Visual Studio is an alternative to the Linux based [cross-compiler build](https://github.com/bitcoin/bitcoin/blob/master/doc/build-windows.md).\n \n@@ -12,10 +12,9 @@ Quick Start\n The minimal steps required to build Bitcoin Core with the msbuild toolchain are below. More detailed instructions are contained in the following sections.\n \n ```\n-vcpkg install --triplet x64-windows-static berkeleydb boost-filesystem boost-multi-index boost-signals2 boost-test boost-thread libevent[thread] zeromq double-conversion\n-vcpkg integrate install\n-py -3 build_msvc\\msvc-autogen.py\n-msbuild /m build_msvc\\bitcoin.sln /p:Platform=x64 /p:Configuration=Release /t:build\n+cd build_msvc\n+py -3 msvc-autogen.py\n+msbuild /m bitcoin.sln /p:Platform=x64 /p:Configuration=Release /t:build\n ```\n \n Dependencies\n@@ -28,14 +27,7 @@ Options for installing the dependencies in a Visual Studio compatible manner are\n - Download the source code, build each dependency, add the required include paths, link libraries and binary tools to the Visual Studio project files.\n - Use [nuget](https://www.nuget.org/) packages with the understanding that any binary files have been compiled by an untrusted third party.\n \n-The [external dependencies](https://github.com/bitcoin/bitcoin/blob/master/doc/dependencies.md) required for building are:\n-\n-- Berkeley DB\n-- Boost\n-- DoubleConversion\n-- libevent\n-- Qt5\n-- ZeroMQ\n+The [external dependencies](https://github.com/bitcoin/bitcoin/blob/master/doc/dependencies.md) required for building are listed in the `build_msvc/vcpkg.json` file. The `msbuild` project files are configured to automatically install the `vcpkg` dependencies.\n \n Qt\n ---------------------\n@@ -52,20 +44,14 @@ Building\n The instructions below use `vcpkg` to install the dependencies.\n \n - Install [`vcpkg`](https://github.com/Microsoft/vcpkg).\n-- Install the required packages (replace x64 with x86 as required). The list of required packages can be found in the `build_msvc\\vcpkg-packages.txt` file. The PowerShell command below will work if run from the repository root directory and `vcpkg` is in the path. Alternatively the contents of the packages text file can be pasted in place of the `Get-Content` cmdlet.\n-\n-```\n-PS >.\\vcpkg install --triplet x64-windows-static $(Get-Content -Path build_msvc\\vcpkg-packages.txt).split()\n-PS >.\\vcpkg integrate install\n-```\n \n - Use Python to generate `*.vcxproj` from Makefile\n \n ```\n PS >py -3 msvc-autogen.py\n ```\n \n-- An optional step is to adjust the settings in the build_msvc directory and the common.init.vcxproj file. This project file contains settings that are common to all projects such as the runtime library version and target Windows SDK version. The Qt directories can also be set.\n+- An optional step is to adjust the settings in the `build_msvc` directory and the `common.init.vcxproj` file. This project file contains settings that are common to all projects such as the runtime library version and target Windows SDK version. The Qt directories can also be set.\n \n - To build from the command line with the Visual Studio 2017 toolchain use:\n \n@@ -79,7 +65,7 @@ msbuild /m bitcoin.sln /p:Platform=x64 /p:Configuration=Release /p:PlatformTools\n msbuild /m bitcoin.sln /p:Platform=x64 /p:Configuration=Release /t:build\n ```\n \n-- Alternatively open the `build_msvc\\bitcoin.sln` file in Visual Studio.\n+- Alternatively open the `build_msvc/bitcoin.sln` file in Visual Studio.\n \n AppVeyor\n ---------------------"
      },
      {
        "sha": "ed227519ae10181a24145d33e131358e5c49a477",
        "filename": "build_msvc/common.init.vcxproj",
        "status": "modified",
        "additions": 9,
        "deletions": 0,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/712f95d3324d02310dd468e7bfd1e1b0df432e77/build_msvc/common.init.vcxproj",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/712f95d3324d02310dd468e7bfd1e1b0df432e77/build_msvc/common.init.vcxproj",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/build_msvc/common.init.vcxproj?ref=712f95d3324d02310dd468e7bfd1e1b0df432e77",
        "patch": "@@ -9,6 +9,15 @@\n     <UseNativeEnvironment>true</UseNativeEnvironment>\n    </PropertyGroup>\n \n+   <PropertyGroup Label=\"Vcpkg\">\n+    <VcpkgEnabled>true</VcpkgEnabled>\n+    <VcpkgEnableManifest>true</VcpkgEnableManifest>\n+    <VcpkgManifestInstall>true</VcpkgManifestInstall>\n+    <VcpkgUseStatic>true</VcpkgUseStatic>\n+    <VcpkgAutoLink>true</VcpkgAutoLink>\n+    <VcpkgConfiguration>$(Configuration)</VcpkgConfiguration>\n+  </PropertyGroup>\n+\n   <PropertyGroup Condition=\"'$(WindowsTargetPlatformVersion)'=='' and !Exists('$(WindowsSdkDir)\\DesignTime\\CommonConfiguration\\Neutral\\Windows.props')\">\n      <WindowsTargetPlatformVersion_10 Condition=\"'$(WindowsTargetPlatformVersion_10)' == ''\">$(Registry:HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Microsoft SDKs\\Windows\\v10.0@ProductVersion)</WindowsTargetPlatformVersion_10>\n      <WindowsTargetPlatformVersion_10 Condition=\"'$(WindowsTargetPlatformVersion_10)' == ''\">$(Registry:HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Microsoft SDKs\\Windows\\v10.0@ProductVersion)</WindowsTargetPlatformVersion_10>"
      },
      {
        "sha": "edce8576c33185b35094b67d3a3aa4e785850113",
        "filename": "build_msvc/vcpkg-packages.txt",
        "status": "removed",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1b313cacc99a1b372238f9036abed5491f9d28f7/build_msvc/vcpkg-packages.txt",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1b313cacc99a1b372238f9036abed5491f9d28f7/build_msvc/vcpkg-packages.txt",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/build_msvc/vcpkg-packages.txt?ref=1b313cacc99a1b372238f9036abed5491f9d28f7",
        "patch": "@@ -1 +0,0 @@\n-berkeleydb boost-filesystem boost-multi-index boost-process boost-signals2 boost-test boost-thread libevent[thread] zeromq double-conversion"
      },
      {
        "sha": "5d5f94227f8e5cef658ee528cff89bfe8d1f1d90",
        "filename": "build_msvc/vcpkg.json",
        "status": "added",
        "additions": 19,
        "deletions": 0,
        "changes": 19,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/712f95d3324d02310dd468e7bfd1e1b0df432e77/build_msvc/vcpkg.json",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/712f95d3324d02310dd468e7bfd1e1b0df432e77/build_msvc/vcpkg.json",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/build_msvc/vcpkg.json?ref=712f95d3324d02310dd468e7bfd1e1b0df432e77",
        "patch": "@@ -0,0 +1,19 @@\n+{\n+  \"name\": \"bitcoin-core\",\n+  \"version-string\": \"1\",\n+  \"dependencies\": [\n+    \"berkeleydb\",\n+    \"boost-filesystem\",\n+    \"boost-multi-index\",\n+    \"boost-process\",\n+    \"boost-signals2\",\n+    \"boost-test\",\n+    \"boost-thread\",\n+    \"double-conversion\",\n+    {\n+      \"name\": \"libevent\",\n+      \"features\": [\"thread\"]\n+    },\n+    \"zeromq\"\n+  ]\n+}\n\\ No newline at end of file"
      }
    ]
  }
]