[
  {
    "sha": "ec7eb0fa80ce50f0c45c7f764bf4958224721ca0",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplYzdlYjBmYTgwY2U1MGYwYzQ1YzdmNzY0YmY0OTU4MjI0NzIxY2Ew",
    "commit": {
      "author": {
        "name": "Suhas Daftuar",
        "email": "sdaftuar@gmail.com",
        "date": "2014-09-08T17:29:14Z"
      },
      "committer": {
        "name": "Suhas Daftuar",
        "email": "sdaftuar@gmail.com",
        "date": "2014-09-10T17:51:53Z"
      },
      "message": "When reindexing check for file before trying to open (refactored)",
      "tree": {
        "sha": "ce421586d0340a7f10fae45f9f844b0f38301148",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ce421586d0340a7f10fae45f9f844b0f38301148"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ec7eb0fa80ce50f0c45c7f764bf4958224721ca0",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ec7eb0fa80ce50f0c45c7f764bf4958224721ca0",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/ec7eb0fa80ce50f0c45c7f764bf4958224721ca0",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ec7eb0fa80ce50f0c45c7f764bf4958224721ca0/comments",
    "author": {
      "login": "sdaftuar",
      "id": 7463573,
      "node_id": "MDQ6VXNlcjc0NjM1NzM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sdaftuar",
      "html_url": "https://github.com/sdaftuar",
      "followers_url": "https://api.github.com/users/sdaftuar/followers",
      "following_url": "https://api.github.com/users/sdaftuar/following{/other_user}",
      "gists_url": "https://api.github.com/users/sdaftuar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
      "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
      "repos_url": "https://api.github.com/users/sdaftuar/repos",
      "events_url": "https://api.github.com/users/sdaftuar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sdaftuar",
      "id": 7463573,
      "node_id": "MDQ6VXNlcjc0NjM1NzM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sdaftuar",
      "html_url": "https://github.com/sdaftuar",
      "followers_url": "https://api.github.com/users/sdaftuar/followers",
      "following_url": "https://api.github.com/users/sdaftuar/following{/other_user}",
      "gists_url": "https://api.github.com/users/sdaftuar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
      "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
      "repos_url": "https://api.github.com/users/sdaftuar/repos",
      "events_url": "https://api.github.com/users/sdaftuar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "df623d83dad6aa39141b066ebd2f870ee05acf41",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/df623d83dad6aa39141b066ebd2f870ee05acf41",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/df623d83dad6aa39141b066ebd2f870ee05acf41"
      }
    ],
    "stats": {
      "total": 14,
      "additions": 12,
      "deletions": 2
    },
    "files": [
      {
        "sha": "4b95f293655bb1119e3032dd8079f4cd9a96bc0c",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 1,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ec7eb0fa80ce50f0c45c7f764bf4958224721ca0/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ec7eb0fa80ce50f0c45c7f764bf4958224721ca0/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=ec7eb0fa80ce50f0c45c7f764bf4958224721ca0",
        "patch": "@@ -401,9 +401,11 @@ void ThreadImport(std::vector<boost::filesystem::path> vImportFiles)\n         int nFile = 0;\n         while (true) {\n             CDiskBlockPos pos(nFile, 0);\n+            if (!boost::filesystem::exists(GetBlockPosFilename(pos, \"blk\")))\n+                break; // No block files left to reindex\n             FILE *file = OpenBlockFile(pos, true);\n             if (!file)\n-                break;\n+                break; // This error is logged in OpenBlockFile\n             LogPrintf(\"Reindexing block file blk%05u.dat...\\n\", (unsigned int)nFile);\n             LoadExternalBlockFile(file, &pos);\n             nFile++;"
      },
      {
        "sha": "0816e36633fca01b6e234e0703821bb3c09c85da",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 1,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ec7eb0fa80ce50f0c45c7f764bf4958224721ca0/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ec7eb0fa80ce50f0c45c7f764bf4958224721ca0/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=ec7eb0fa80ce50f0c45c7f764bf4958224721ca0",
        "patch": "@@ -2766,7 +2766,7 @@ FILE* OpenDiskFile(const CDiskBlockPos &pos, const char *prefix, bool fReadOnly)\n {\n     if (pos.IsNull())\n         return NULL;\n-    boost::filesystem::path path = GetDataDir() / \"blocks\" / strprintf(\"%s%05u.dat\", prefix, pos.nFile);\n+    boost::filesystem::path path = GetBlockPosFilename(pos, prefix);\n     boost::filesystem::create_directories(path.parent_path());\n     FILE* file = fopen(path.string().c_str(), \"rb+\");\n     if (!file && !fReadOnly)\n@@ -2793,6 +2793,12 @@ FILE* OpenUndoFile(const CDiskBlockPos &pos, bool fReadOnly) {\n     return OpenDiskFile(pos, \"rev\", fReadOnly);\n }\n \n+boost::filesystem::path GetBlockPosFilename(const CDiskBlockPos &pos, const char *prefix)\n+{\n+    boost::filesystem::path path = GetDataDir() / \"blocks\" / strprintf(\"%s%05u.dat\", prefix, pos.nFile);\n+    return path;  \n+}\n+\n CBlockIndex * InsertBlockIndex(uint256 hash)\n {\n     if (hash == 0)"
      },
      {
        "sha": "09de2187c451c1551d5789ff8aa7d67898de5ff1",
        "filename": "src/main.h",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ec7eb0fa80ce50f0c45c7f764bf4958224721ca0/src/main.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ec7eb0fa80ce50f0c45c7f764bf4958224721ca0/src/main.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.h?ref=ec7eb0fa80ce50f0c45c7f764bf4958224721ca0",
        "patch": "@@ -145,6 +145,8 @@ bool CheckDiskSpace(uint64_t nAdditionalBytes = 0);\n FILE* OpenBlockFile(const CDiskBlockPos &pos, bool fReadOnly = false);\n /** Open an undo file (rev?????.dat) */\n FILE* OpenUndoFile(const CDiskBlockPos &pos, bool fReadOnly = false);\n+/** Translation to a filesystem path */\n+boost::filesystem::path GetBlockPosFilename(const CDiskBlockPos &pos, const char *prefix);\n /** Import blocks from an external file */\n bool LoadExternalBlockFile(FILE* fileIn, CDiskBlockPos *dbp = NULL);\n /** Initialize a new block tree database + block data on disk */"
      }
    ]
  },
  {
    "sha": "f7e36370f36ca806076cdcf0cd3ed0c35fd38c42",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmN2UzNjM3MGYzNmNhODA2MDc2Y2RjZjBjZDNlZDBjMzVmZDM4YzQy",
    "commit": {
      "author": {
        "name": "Suhas Daftuar",
        "email": "sdaftuar@gmail.com",
        "date": "2014-09-15T13:56:10Z"
      },
      "committer": {
        "name": "Suhas Daftuar",
        "email": "sdaftuar@gmail.com",
        "date": "2014-09-15T13:56:10Z"
      },
      "message": "Eliminate extra assignment",
      "tree": {
        "sha": "7d0f765d8090d05f29bb3c5c4f46fc9e31ef453f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7d0f765d8090d05f29bb3c5c4f46fc9e31ef453f"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f7e36370f36ca806076cdcf0cd3ed0c35fd38c42",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f7e36370f36ca806076cdcf0cd3ed0c35fd38c42",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/f7e36370f36ca806076cdcf0cd3ed0c35fd38c42",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f7e36370f36ca806076cdcf0cd3ed0c35fd38c42/comments",
    "author": {
      "login": "sdaftuar",
      "id": 7463573,
      "node_id": "MDQ6VXNlcjc0NjM1NzM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sdaftuar",
      "html_url": "https://github.com/sdaftuar",
      "followers_url": "https://api.github.com/users/sdaftuar/followers",
      "following_url": "https://api.github.com/users/sdaftuar/following{/other_user}",
      "gists_url": "https://api.github.com/users/sdaftuar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
      "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
      "repos_url": "https://api.github.com/users/sdaftuar/repos",
      "events_url": "https://api.github.com/users/sdaftuar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sdaftuar",
      "id": 7463573,
      "node_id": "MDQ6VXNlcjc0NjM1NzM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7463573?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sdaftuar",
      "html_url": "https://github.com/sdaftuar",
      "followers_url": "https://api.github.com/users/sdaftuar/followers",
      "following_url": "https://api.github.com/users/sdaftuar/following{/other_user}",
      "gists_url": "https://api.github.com/users/sdaftuar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sdaftuar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sdaftuar/subscriptions",
      "organizations_url": "https://api.github.com/users/sdaftuar/orgs",
      "repos_url": "https://api.github.com/users/sdaftuar/repos",
      "events_url": "https://api.github.com/users/sdaftuar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sdaftuar/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "ec7eb0fa80ce50f0c45c7f764bf4958224721ca0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ec7eb0fa80ce50f0c45c7f764bf4958224721ca0",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/ec7eb0fa80ce50f0c45c7f764bf4958224721ca0"
      }
    ],
    "stats": {
      "total": 3,
      "additions": 1,
      "deletions": 2
    },
    "files": [
      {
        "sha": "7242c3ab5c2779d11417c69ca811edf5d52c914a",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 2,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f7e36370f36ca806076cdcf0cd3ed0c35fd38c42/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f7e36370f36ca806076cdcf0cd3ed0c35fd38c42/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=f7e36370f36ca806076cdcf0cd3ed0c35fd38c42",
        "patch": "@@ -2795,8 +2795,7 @@ FILE* OpenUndoFile(const CDiskBlockPos &pos, bool fReadOnly) {\n \n boost::filesystem::path GetBlockPosFilename(const CDiskBlockPos &pos, const char *prefix)\n {\n-    boost::filesystem::path path = GetDataDir() / \"blocks\" / strprintf(\"%s%05u.dat\", prefix, pos.nFile);\n-    return path;  \n+    return GetDataDir() / \"blocks\" / strprintf(\"%s%05u.dat\", prefix, pos.nFile);\n }\n \n CBlockIndex * InsertBlockIndex(uint256 hash)"
      }
    ]
  }
]