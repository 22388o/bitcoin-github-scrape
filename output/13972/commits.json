[
  {
    "sha": "7e0f25ca1ebe5f3888c574c9373af08274a7d0f9",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3ZTBmMjVjYTFlYmU1ZjM4ODhjNTc0YzkzNzNhZjA4Mjc0YTdkMGY5",
    "commit": {
      "author": {
        "name": "BtcDrak",
        "email": "btcdrak@gmail.com",
        "date": "2019-05-19T11:46:40Z"
      },
      "committer": {
        "name": "BtcDrak",
        "email": "btcdrak@gmail.com",
        "date": "2019-05-19T11:46:40Z"
      },
      "message": "Remove 16 bits from versionbits signalling system (BIP320)",
      "tree": {
        "sha": "9903f7f2e266d0172c23bfdba731aedaf1ae8c84",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9903f7f2e266d0172c23bfdba731aedaf1ae8c84"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7e0f25ca1ebe5f3888c574c9373af08274a7d0f9",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7e0f25ca1ebe5f3888c574c9373af08274a7d0f9",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/7e0f25ca1ebe5f3888c574c9373af08274a7d0f9",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7e0f25ca1ebe5f3888c574c9373af08274a7d0f9/comments",
    "author": {
      "login": "btcdrak",
      "id": 7275704,
      "node_id": "MDQ6VXNlcjcyNzU3MDQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7275704?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/btcdrak",
      "html_url": "https://github.com/btcdrak",
      "followers_url": "https://api.github.com/users/btcdrak/followers",
      "following_url": "https://api.github.com/users/btcdrak/following{/other_user}",
      "gists_url": "https://api.github.com/users/btcdrak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/btcdrak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/btcdrak/subscriptions",
      "organizations_url": "https://api.github.com/users/btcdrak/orgs",
      "repos_url": "https://api.github.com/users/btcdrak/repos",
      "events_url": "https://api.github.com/users/btcdrak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/btcdrak/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "btcdrak",
      "id": 7275704,
      "node_id": "MDQ6VXNlcjcyNzU3MDQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7275704?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/btcdrak",
      "html_url": "https://github.com/btcdrak",
      "followers_url": "https://api.github.com/users/btcdrak/followers",
      "following_url": "https://api.github.com/users/btcdrak/following{/other_user}",
      "gists_url": "https://api.github.com/users/btcdrak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/btcdrak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/btcdrak/subscriptions",
      "organizations_url": "https://api.github.com/users/btcdrak/orgs",
      "repos_url": "https://api.github.com/users/btcdrak/repos",
      "events_url": "https://api.github.com/users/btcdrak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/btcdrak/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "7110d455eb51e78e09f43fabf0b1630ae997d898",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7110d455eb51e78e09f43fabf0b1630ae997d898",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/7110d455eb51e78e09f43fabf0b1630ae997d898"
      }
    ],
    "stats": {
      "total": 49,
      "additions": 29,
      "deletions": 20
    },
    "files": [
      {
        "sha": "ecea5983016b2b29acd24389c16290788ac43091",
        "filename": "src/chainparams.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 3,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7e0f25ca1ebe5f3888c574c9373af08274a7d0f9/src/chainparams.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7e0f25ca1ebe5f3888c574c9373af08274a7d0f9/src/chainparams.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/chainparams.cpp?ref=7e0f25ca1ebe5f3888c574c9373af08274a7d0f9",
        "patch": "@@ -76,7 +76,7 @@ class CMainParams : public CChainParams {\n         consensus.fPowNoRetargeting = false;\n         consensus.nRuleChangeActivationThreshold = 1916; // 95% of 2016\n         consensus.nMinerConfirmationWindow = 2016; // nPowTargetTimespan / nPowTargetSpacing\n-        consensus.vDeployments[Consensus::DEPLOYMENT_TESTDUMMY].bit = 28;\n+        consensus.vDeployments[Consensus::DEPLOYMENT_TESTDUMMY].bit = 12;\n         consensus.vDeployments[Consensus::DEPLOYMENT_TESTDUMMY].nStartTime = 1199145601; // January 1, 2008\n         consensus.vDeployments[Consensus::DEPLOYMENT_TESTDUMMY].nTimeout = 1230767999; // December 31, 2008\n \n@@ -193,7 +193,7 @@ class CTestNetParams : public CChainParams {\n         consensus.fPowNoRetargeting = false;\n         consensus.nRuleChangeActivationThreshold = 1512; // 75% for testchains\n         consensus.nMinerConfirmationWindow = 2016; // nPowTargetTimespan / nPowTargetSpacing\n-        consensus.vDeployments[Consensus::DEPLOYMENT_TESTDUMMY].bit = 28;\n+        consensus.vDeployments[Consensus::DEPLOYMENT_TESTDUMMY].bit = 12;\n         consensus.vDeployments[Consensus::DEPLOYMENT_TESTDUMMY].nStartTime = 1199145601; // January 1, 2008\n         consensus.vDeployments[Consensus::DEPLOYMENT_TESTDUMMY].nTimeout = 1230767999; // December 31, 2008\n \n@@ -288,7 +288,7 @@ class CRegTestParams : public CChainParams {\n         consensus.fPowNoRetargeting = true;\n         consensus.nRuleChangeActivationThreshold = 108; // 75% for testchains\n         consensus.nMinerConfirmationWindow = 144; // Faster than normal for regtest (144 instead of 2016)\n-        consensus.vDeployments[Consensus::DEPLOYMENT_TESTDUMMY].bit = 28;\n+        consensus.vDeployments[Consensus::DEPLOYMENT_TESTDUMMY].bit = 12;\n         consensus.vDeployments[Consensus::DEPLOYMENT_TESTDUMMY].nStartTime = 0;\n         consensus.vDeployments[Consensus::DEPLOYMENT_TESTDUMMY].nTimeout = Consensus::BIP9Deployment::NO_TIMEOUT;\n         consensus.vDeployments[Consensus::DEPLOYMENT_CSV].bit = 0;"
      },
      {
        "sha": "2896dd97aa8e5de743b9a166f58f23dca753abcf",
        "filename": "src/validation.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7e0f25ca1ebe5f3888c574c9373af08274a7d0f9/src/validation.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7e0f25ca1ebe5f3888c574c9373af08274a7d0f9/src/validation.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/validation.cpp?ref=7e0f25ca1ebe5f3888c574c9373af08274a7d0f9",
        "patch": "@@ -2270,7 +2270,7 @@ void static UpdateTip(const CBlockIndex *pindexNew, const CChainParams& chainPar\n         for (int i = 0; i < 100 && pindex != nullptr; i++)\n         {\n             int32_t nExpectedVersion = ComputeBlockVersion(pindex->pprev, chainParams.GetConsensus());\n-            if (pindex->nVersion > VERSIONBITS_LAST_OLD_BLOCK_VERSION && (pindex->nVersion & ~nExpectedVersion) != 0)\n+            if (pindex->nVersion > VERSIONBITS_LAST_OLD_BLOCK_VERSION && (pindex->nVersion & ~nExpectedVersion & VERSIONBITS_IGNORE_MASK) != 0)\n                 ++nUpgraded;\n             pindex = pindex->pprev;\n         }"
      },
      {
        "sha": "957d1ac96997b03a3ed60752e20b45eb17636203",
        "filename": "src/versionbits.h",
        "status": "modified",
        "additions": 3,
        "deletions": 1,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7e0f25ca1ebe5f3888c574c9373af08274a7d0f9/src/versionbits.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7e0f25ca1ebe5f3888c574c9373af08274a7d0f9/src/versionbits.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/versionbits.h?ref=7e0f25ca1ebe5f3888c574c9373af08274a7d0f9",
        "patch": "@@ -15,7 +15,9 @@ static const int32_t VERSIONBITS_TOP_BITS = 0x20000000UL;\n /** What bitmask determines whether versionbits is in use */\n static const int32_t VERSIONBITS_TOP_MASK = 0xE0000000UL;\n /** Total bits available for versionbits */\n-static const int32_t VERSIONBITS_NUM_BITS = 29;\n+static const int32_t VERSIONBITS_NUM_BITS = 13;\n+/** Bitmask for ignored versionbits. It should match VERSIONBITS_NUM_BITS (BIPxxx) */\n+static const int32_t VERSIONBITS_IGNORE_MASK = 0xE0001FFFUL;\n \n enum class ThresholdState {\n     DEFINED,"
      },
      {
        "sha": "047f3598ef0ee67590955b84ff917e2880beb6a0",
        "filename": "test/functional/feature_versionbits_warning.py",
        "status": "modified",
        "additions": 22,
        "deletions": 15,
        "changes": 37,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7e0f25ca1ebe5f3888c574c9373af08274a7d0f9/test/functional/feature_versionbits_warning.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7e0f25ca1ebe5f3888c574c9373af08274a7d0f9/test/functional/feature_versionbits_warning.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/feature_versionbits_warning.py?ref=7e0f25ca1ebe5f3888c574c9373af08274a7d0f9",
        "patch": "@@ -9,6 +9,7 @@\n \"\"\"\n import os\n import re\n+from time import sleep\n \n from test_framework.blocktools import create_block, create_coinbase\n from test_framework.messages import msg_block\n@@ -19,8 +20,9 @@\n VB_PERIOD = 144           # versionbits period length for regtest\n VB_THRESHOLD = 108        # versionbits activation threshold for regtest\n VB_TOP_BITS = 0x20000000\n-VB_UNKNOWN_BIT = 27       # Choose a bit unassigned to any deployment\n+VB_UNKNOWN_BIT = 11       # Choose a bit unassigned to any deployment\n VB_UNKNOWN_VERSION = VB_TOP_BITS | (1 << VB_UNKNOWN_BIT)\n+VB_IGNORE_VERSION = VB_TOP_BITS | 0x1FFFE000\n \n WARN_UNKNOWN_RULES_ACTIVE = \"unknown new rules activated (versionbit {})\".format(VB_UNKNOWN_BIT)\n VB_PATTERN = re.compile(\"Warning: unknown new rules activated.*versionbit\")\n@@ -68,32 +70,37 @@ def run_test(self):\n         # Mine one period worth of blocks\n         node.generatetoaddress(VB_PERIOD, node_deterministic_address)\n \n+        self.log.info(\"Check that there is no warning if previous VB_BLOCKS have VB_PERIOD blocks with ignored versionbits version.\")\n+        # Build one period of blocks with ignored bits\n+        self.send_blocks_with_version(node.p2p, VB_PERIOD, VB_IGNORE_VERSION)\n+        # Mine a period worth of expected blocks\n+        node.generatetoaddress(VB_PERIOD, node_deterministic_address)\n+        # Check that we're not getting any versionbit-related errors in get*info()\n+        assert not VB_PATTERN.match(node.getmininginfo()[\"warnings\"])\n+        assert not VB_PATTERN.match(node.getnetworkinfo()[\"warnings\"])\n+        # Check that the alert file does not the versionbits unknown rules warning\n+        sleep(5)\n+        assert(not self.versionbits_in_alert_file())\n+\n         self.log.info(\"Check that there is no warning if previous VB_BLOCKS have <VB_THRESHOLD blocks with unknown versionbits version.\")\n         # Build one period of blocks with < VB_THRESHOLD blocks signaling some unknown bit\n         self.send_blocks_with_version(node.p2p, VB_THRESHOLD - 1, VB_UNKNOWN_VERSION)\n         node.generatetoaddress(VB_PERIOD - VB_THRESHOLD + 1, node_deterministic_address)\n-\n+        # Mine a period worth of expected blocks\n+        node.generatetoaddress(VB_PERIOD, node_deterministic_address)\n         # Check that we're not getting any versionbit-related errors in get*info()\n         assert not VB_PATTERN.match(node.getmininginfo()[\"warnings\"])\n         assert not VB_PATTERN.match(node.getnetworkinfo()[\"warnings\"])\n+        # Check that the alert file does not the versionbits unknown rules warning\n+        sleep(5)\n+        assert(not self.versionbits_in_alert_file())\n \n+        self.log.info(\"Check that there is a warning if previous VB_BLOCKS have >=VB_THRESHOLD blocks with unknown versionbits version.\")\n         # Build one period of blocks with VB_THRESHOLD blocks signaling some unknown bit\n         self.send_blocks_with_version(node.p2p, VB_THRESHOLD, VB_UNKNOWN_VERSION)\n         node.generatetoaddress(VB_PERIOD - VB_THRESHOLD, node_deterministic_address)\n-\n-        self.log.info(\"Check that there is a warning if previous VB_BLOCKS have >=VB_THRESHOLD blocks with unknown versionbits version.\")\n-        # Mine a period worth of expected blocks so the generic block-version warning\n-        # is cleared. This will move the versionbit state to ACTIVE.\n+        # Mine a period worth of expected blocks to move the versionbit state to ACTIVE.\n         node.generatetoaddress(VB_PERIOD, node_deterministic_address)\n-\n-        # Stop-start the node. This is required because bitcoind will only warn once about unknown versions or unknown rules activating.\n-        self.restart_node(0)\n-\n-        # Generating one block guarantees that we'll get out of IBD\n-        node.generatetoaddress(1, node_deterministic_address)\n-        wait_until(lambda: not node.getblockchaininfo()['initialblockdownload'], timeout=10, lock=mininode_lock)\n-        # Generating one more block will be enough to generate an error.\n-        node.generatetoaddress(1, node_deterministic_address)\n         # Check that get*info() shows the versionbits unknown rules warning\n         assert WARN_UNKNOWN_RULES_ACTIVE in node.getmininginfo()[\"warnings\"]\n         assert WARN_UNKNOWN_RULES_ACTIVE in node.getnetworkinfo()[\"warnings\"]"
      }
    ]
  },
  {
    "sha": "6ac67595eb96bf0205606bc1fcfec37fcf2c99cf",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2YWM2NzU5NWViOTZiZjAyMDU2MDZiYzFmY2ZlYzM3ZmNmMmM5OWNm",
    "commit": {
      "author": {
        "name": "BtcDrak",
        "email": "btcdrak@gmail.com",
        "date": "2019-05-21T02:51:32Z"
      },
      "committer": {
        "name": "BtcDrak",
        "email": "btcdrak@gmail.com",
        "date": "2019-05-21T02:51:32Z"
      },
      "message": "Remove unused import (fixes Lint test)",
      "tree": {
        "sha": "691b3c1d7644465b87a26abe0a16b0667c192f98",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/691b3c1d7644465b87a26abe0a16b0667c192f98"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6ac67595eb96bf0205606bc1fcfec37fcf2c99cf",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6ac67595eb96bf0205606bc1fcfec37fcf2c99cf",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/6ac67595eb96bf0205606bc1fcfec37fcf2c99cf",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6ac67595eb96bf0205606bc1fcfec37fcf2c99cf/comments",
    "author": {
      "login": "btcdrak",
      "id": 7275704,
      "node_id": "MDQ6VXNlcjcyNzU3MDQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7275704?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/btcdrak",
      "html_url": "https://github.com/btcdrak",
      "followers_url": "https://api.github.com/users/btcdrak/followers",
      "following_url": "https://api.github.com/users/btcdrak/following{/other_user}",
      "gists_url": "https://api.github.com/users/btcdrak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/btcdrak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/btcdrak/subscriptions",
      "organizations_url": "https://api.github.com/users/btcdrak/orgs",
      "repos_url": "https://api.github.com/users/btcdrak/repos",
      "events_url": "https://api.github.com/users/btcdrak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/btcdrak/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "btcdrak",
      "id": 7275704,
      "node_id": "MDQ6VXNlcjcyNzU3MDQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7275704?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/btcdrak",
      "html_url": "https://github.com/btcdrak",
      "followers_url": "https://api.github.com/users/btcdrak/followers",
      "following_url": "https://api.github.com/users/btcdrak/following{/other_user}",
      "gists_url": "https://api.github.com/users/btcdrak/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/btcdrak/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/btcdrak/subscriptions",
      "organizations_url": "https://api.github.com/users/btcdrak/orgs",
      "repos_url": "https://api.github.com/users/btcdrak/repos",
      "events_url": "https://api.github.com/users/btcdrak/events{/privacy}",
      "received_events_url": "https://api.github.com/users/btcdrak/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "7e0f25ca1ebe5f3888c574c9373af08274a7d0f9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7e0f25ca1ebe5f3888c574c9373af08274a7d0f9",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/7e0f25ca1ebe5f3888c574c9373af08274a7d0f9"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 1,
      "deletions": 1
    },
    "files": [
      {
        "sha": "fc266752d4c967b1cd5b963d61da45cbf18707b2",
        "filename": "test/functional/feature_versionbits_warning.py",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6ac67595eb96bf0205606bc1fcfec37fcf2c99cf/test/functional/feature_versionbits_warning.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6ac67595eb96bf0205606bc1fcfec37fcf2c99cf/test/functional/feature_versionbits_warning.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/feature_versionbits_warning.py?ref=6ac67595eb96bf0205606bc1fcfec37fcf2c99cf",
        "patch": "@@ -13,7 +13,7 @@\n \n from test_framework.blocktools import create_block, create_coinbase\n from test_framework.messages import msg_block\n-from test_framework.mininode import P2PInterface, mininode_lock\n+from test_framework.mininode import P2PInterface\n from test_framework.test_framework import BitcoinTestFramework\n from test_framework.util import wait_until\n "
      }
    ]
  }
]