[
  {
    "sha": "c4b85ba704a1b5257dc82786a84f676bacb7b027",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpjNGI4NWJhNzA0YTFiNTI1N2RjODI3ODZhODRmNjc2YmFjYjdiMDI3",
    "commit": {
      "author": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2020-08-20T17:41:54Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2020-08-25T16:46:00Z"
      },
      "message": "Bugfix: Define and use HAVE_FDATASYNC correctly outside LevelDB",
      "tree": {
        "sha": "7db5f43275d2cfdb9103cca6569e161792061b39",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/7db5f43275d2cfdb9103cca6569e161792061b39"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c4b85ba704a1b5257dc82786a84f676bacb7b027",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c4b85ba704a1b5257dc82786a84f676bacb7b027",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/c4b85ba704a1b5257dc82786a84f676bacb7b027",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c4b85ba704a1b5257dc82786a84f676bacb7b027/comments",
    "author": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "e9b30126545d6ddd8772363e4079d1e4908ad117",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e9b30126545d6ddd8772363e4079d1e4908ad117",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/e9b30126545d6ddd8772363e4079d1e4908ad117"
      }
    ],
    "stats": {
      "total": 4,
      "additions": 2,
      "deletions": 2
    },
    "files": [
      {
        "sha": "ee6c6962e11851ee0fc8c518c1b69ab43d0e35f3",
        "filename": "configure.ac",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/c4b85ba704a1b5257dc82786a84f676bacb7b027/configure.ac",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/c4b85ba704a1b5257dc82786a84f676bacb7b027/configure.ac",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/configure.ac?ref=c4b85ba704a1b5257dc82786a84f676bacb7b027",
        "patch": "@@ -1039,13 +1039,13 @@ AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[#include <stdint.h>\n  [ AC_MSG_RESULT(no)]\n )\n \n-dnl LevelDB platform checks\n AC_MSG_CHECKING(for fdatasync)\n AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[#include <unistd.h>]],\n  [[ fdatasync(0); ]])],\n  [ AC_MSG_RESULT(yes); HAVE_FDATASYNC=1 ],\n  [ AC_MSG_RESULT(no); HAVE_FDATASYNC=0 ]\n )\n+AC_DEFINE_UNQUOTED([HAVE_FDATASYNC], [$HAVE_FDATASYNC], [Define to 1 if fdatasync is available.])\n \n AC_MSG_CHECKING(for F_FULLFSYNC)\n AC_COMPILE_IFELSE([AC_LANG_PROGRAM([[#include <fcntl.h>]],"
      },
      {
        "sha": "f5931b5ff17b1ff1f31d37513f3330999db5c075",
        "filename": "src/util/system.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/c4b85ba704a1b5257dc82786a84f676bacb7b027/src/util/system.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/c4b85ba704a1b5257dc82786a84f676bacb7b027/src/util/system.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util/system.cpp?ref=c4b85ba704a1b5257dc82786a84f676bacb7b027",
        "patch": "@@ -1025,7 +1025,7 @@ bool FileCommit(FILE *file)\n         return false;\n     }\n #else\n-    #if defined(HAVE_FDATASYNC)\n+    #if HAVE_FDATASYNC\n     if (fdatasync(fileno(file)) != 0 && errno != EINVAL) { // Ignore EINVAL for filesystems that don't support sync\n         LogPrintf(\"%s: fdatasync failed: %d\\n\", __func__, errno);\n         return false;"
      }
    ]
  },
  {
    "sha": "f6cec0bcaf560fa310853ad3fe17022602b63d5f",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmNmNlYzBiY2FmNTYwZmEzMTA4NTNhZDNmZTE3MDIyNjAyYjYzZDVm",
    "commit": {
      "author": {
        "name": "Evan Klitzke",
        "email": "evan@eklitzke.org",
        "date": "2018-03-15T13:54:11Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2020-08-25T16:46:20Z"
      },
      "message": "util: Refactor FileCommit from an #if sequence nested in #else, to a sequence of #elif\n\nThis should not change the actual code generation.",
      "tree": {
        "sha": "ec9bf629ab6e2d5ec52b5ab9a18f28fe2dfe86a1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ec9bf629ab6e2d5ec52b5ab9a18f28fe2dfe86a1"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f6cec0bcaf560fa310853ad3fe17022602b63d5f",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f6cec0bcaf560fa310853ad3fe17022602b63d5f",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/f6cec0bcaf560fa310853ad3fe17022602b63d5f",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f6cec0bcaf560fa310853ad3fe17022602b63d5f/comments",
    "author": {
      "login": "eklitzke",
      "id": 2734,
      "node_id": "MDQ6VXNlcjI3MzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2734?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eklitzke",
      "html_url": "https://github.com/eklitzke",
      "followers_url": "https://api.github.com/users/eklitzke/followers",
      "following_url": "https://api.github.com/users/eklitzke/following{/other_user}",
      "gists_url": "https://api.github.com/users/eklitzke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eklitzke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eklitzke/subscriptions",
      "organizations_url": "https://api.github.com/users/eklitzke/orgs",
      "repos_url": "https://api.github.com/users/eklitzke/repos",
      "events_url": "https://api.github.com/users/eklitzke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eklitzke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "c4b85ba704a1b5257dc82786a84f676bacb7b027",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c4b85ba704a1b5257dc82786a84f676bacb7b027",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/c4b85ba704a1b5257dc82786a84f676bacb7b027"
      }
    ],
    "stats": {
      "total": 8,
      "additions": 3,
      "deletions": 5
    },
    "files": [
      {
        "sha": "2dbf13f6b5b2cc9f673b1f8068a2fd15157bb098",
        "filename": "src/util/system.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 5,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f6cec0bcaf560fa310853ad3fe17022602b63d5f/src/util/system.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f6cec0bcaf560fa310853ad3fe17022602b63d5f/src/util/system.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util/system.cpp?ref=f6cec0bcaf560fa310853ad3fe17022602b63d5f",
        "patch": "@@ -1024,23 +1024,21 @@ bool FileCommit(FILE *file)\n         LogPrintf(\"%s: FlushFileBuffers failed: %d\\n\", __func__, GetLastError());\n         return false;\n     }\n-#else\n-    #if HAVE_FDATASYNC\n+#elif HAVE_FDATASYNC\n     if (fdatasync(fileno(file)) != 0 && errno != EINVAL) { // Ignore EINVAL for filesystems that don't support sync\n         LogPrintf(\"%s: fdatasync failed: %d\\n\", __func__, errno);\n         return false;\n     }\n-    #elif defined(MAC_OSX) && defined(F_FULLFSYNC)\n+#elif defined(MAC_OSX) && defined(F_FULLFSYNC)\n     if (fcntl(fileno(file), F_FULLFSYNC, 0) == -1) { // Manpage says \"value other than -1\" is returned on success\n         LogPrintf(\"%s: fcntl F_FULLFSYNC failed: %d\\n\", __func__, errno);\n         return false;\n     }\n-    #else\n+#else\n     if (fsync(fileno(file)) != 0 && errno != EINVAL) {\n         LogPrintf(\"%s: fsync failed: %d\\n\", __func__, errno);\n         return false;\n     }\n-    #endif\n #endif\n     return true;\n }"
      }
    ]
  },
  {
    "sha": "844d650eea3bd809884cc5dd996a388bdc58314e",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4NDRkNjUwZWVhM2JkODA5ODg0Y2M1ZGQ5OTZhMzg4YmRjNTgzMTRl",
    "commit": {
      "author": {
        "name": "Evan Klitzke",
        "email": "evan@eklitzke.org",
        "date": "2018-03-15T13:54:11Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2020-08-25T16:46:45Z"
      },
      "message": "util: Prefer Mac-specific F_FULLSYNC over fdatasync in FileCommit",
      "tree": {
        "sha": "39848f190757cd8f6706d36206da17cc15739d32",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/39848f190757cd8f6706d36206da17cc15739d32"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/844d650eea3bd809884cc5dd996a388bdc58314e",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/844d650eea3bd809884cc5dd996a388bdc58314e",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/844d650eea3bd809884cc5dd996a388bdc58314e",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/844d650eea3bd809884cc5dd996a388bdc58314e/comments",
    "author": {
      "login": "eklitzke",
      "id": 2734,
      "node_id": "MDQ6VXNlcjI3MzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2734?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eklitzke",
      "html_url": "https://github.com/eklitzke",
      "followers_url": "https://api.github.com/users/eklitzke/followers",
      "following_url": "https://api.github.com/users/eklitzke/following{/other_user}",
      "gists_url": "https://api.github.com/users/eklitzke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eklitzke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eklitzke/subscriptions",
      "organizations_url": "https://api.github.com/users/eklitzke/orgs",
      "repos_url": "https://api.github.com/users/eklitzke/repos",
      "events_url": "https://api.github.com/users/eklitzke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eklitzke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "f6cec0bcaf560fa310853ad3fe17022602b63d5f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f6cec0bcaf560fa310853ad3fe17022602b63d5f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/f6cec0bcaf560fa310853ad3fe17022602b63d5f"
      }
    ],
    "stats": {
      "total": 10,
      "additions": 5,
      "deletions": 5
    },
    "files": [
      {
        "sha": "01c588b0d31eff1fa67f15e9468927ba26f54e3e",
        "filename": "src/util/system.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 5,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/844d650eea3bd809884cc5dd996a388bdc58314e/src/util/system.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/844d650eea3bd809884cc5dd996a388bdc58314e/src/util/system.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util/system.cpp?ref=844d650eea3bd809884cc5dd996a388bdc58314e",
        "patch": "@@ -1024,16 +1024,16 @@ bool FileCommit(FILE *file)\n         LogPrintf(\"%s: FlushFileBuffers failed: %d\\n\", __func__, GetLastError());\n         return false;\n     }\n-#elif HAVE_FDATASYNC\n-    if (fdatasync(fileno(file)) != 0 && errno != EINVAL) { // Ignore EINVAL for filesystems that don't support sync\n-        LogPrintf(\"%s: fdatasync failed: %d\\n\", __func__, errno);\n-        return false;\n-    }\n #elif defined(MAC_OSX) && defined(F_FULLFSYNC)\n     if (fcntl(fileno(file), F_FULLFSYNC, 0) == -1) { // Manpage says \"value other than -1\" is returned on success\n         LogPrintf(\"%s: fcntl F_FULLFSYNC failed: %d\\n\", __func__, errno);\n         return false;\n     }\n+#elif HAVE_FDATASYNC\n+    if (fdatasync(fileno(file)) != 0 && errno != EINVAL) { // Ignore EINVAL for filesystems that don't support sync\n+        LogPrintf(\"%s: fdatasync failed: %d\\n\", __func__, errno);\n+        return false;\n+    }\n #else\n     if (fsync(fileno(file)) != 0 && errno != EINVAL) {\n         LogPrintf(\"%s: fsync failed: %d\\n\", __func__, errno);"
      }
    ]
  },
  {
    "sha": "ce5cbaea63ad4ea78e533bdb14f47f414061ae7f",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpjZTVjYmFlYTYzYWQ0ZWE3OGU1MzNiZGIxNGY0N2Y0MTQwNjFhZTdm",
    "commit": {
      "author": {
        "name": "Evan Klitzke",
        "email": "evan@eklitzke.org",
        "date": "2018-03-15T13:54:11Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2020-08-25T16:46:46Z"
      },
      "message": "util.h: Document FileCommit function",
      "tree": {
        "sha": "4896a139a49842ea7cd7f10c40e5b9ca0d5a01f0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4896a139a49842ea7cd7f10c40e5b9ca0d5a01f0"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ce5cbaea63ad4ea78e533bdb14f47f414061ae7f",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ce5cbaea63ad4ea78e533bdb14f47f414061ae7f",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/ce5cbaea63ad4ea78e533bdb14f47f414061ae7f",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ce5cbaea63ad4ea78e533bdb14f47f414061ae7f/comments",
    "author": {
      "login": "eklitzke",
      "id": 2734,
      "node_id": "MDQ6VXNlcjI3MzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2734?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eklitzke",
      "html_url": "https://github.com/eklitzke",
      "followers_url": "https://api.github.com/users/eklitzke/followers",
      "following_url": "https://api.github.com/users/eklitzke/following{/other_user}",
      "gists_url": "https://api.github.com/users/eklitzke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eklitzke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eklitzke/subscriptions",
      "organizations_url": "https://api.github.com/users/eklitzke/orgs",
      "repos_url": "https://api.github.com/users/eklitzke/repos",
      "events_url": "https://api.github.com/users/eklitzke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eklitzke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "844d650eea3bd809884cc5dd996a388bdc58314e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/844d650eea3bd809884cc5dd996a388bdc58314e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/844d650eea3bd809884cc5dd996a388bdc58314e"
      }
    ],
    "stats": {
      "total": 5,
      "additions": 5,
      "deletions": 0
    },
    "files": [
      {
        "sha": "d2373998dfc514722dd2c42471b31ab946440b33",
        "filename": "src/util/system.h",
        "status": "modified",
        "additions": 5,
        "deletions": 0,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ce5cbaea63ad4ea78e533bdb14f47f414061ae7f/src/util/system.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ce5cbaea63ad4ea78e533bdb14f47f414061ae7f/src/util/system.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util/system.h?ref=ce5cbaea63ad4ea78e533bdb14f47f414061ae7f",
        "patch": "@@ -56,6 +56,11 @@ bool error(const char* fmt, const Args&... args)\n }\n \n void PrintExceptionContinue(const std::exception *pex, const char* pszThread);\n+\n+/**\n+ * Ensure file contents are fully committed to disk, using a platform-specific\n+ * feature analogous to fsync().\n+ */\n bool FileCommit(FILE *file);\n bool TruncateFile(FILE *file, unsigned int length);\n int RaiseFileDescriptorLimit(int nMinFD);"
      }
    ]
  },
  {
    "sha": "220bb16cbee5b91d0bc0fcc6c71560d631295fa5",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyMjBiYjE2Y2JlZTViOTFkMGJjMGZjYzZjNzE1NjBkNjMxMjk1ZmE1",
    "commit": {
      "author": {
        "name": "Evan Klitzke",
        "email": "evan@eklitzke.org",
        "date": "2018-03-15T13:54:11Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2020-08-25T16:46:46Z"
      },
      "message": "util: Introduce DirectoryCommit commit function to sync a directory",
      "tree": {
        "sha": "bc8068b3a2abe2c0a03d1ad5a660e83cc32fb671",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bc8068b3a2abe2c0a03d1ad5a660e83cc32fb671"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/220bb16cbee5b91d0bc0fcc6c71560d631295fa5",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/220bb16cbee5b91d0bc0fcc6c71560d631295fa5",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/220bb16cbee5b91d0bc0fcc6c71560d631295fa5",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/220bb16cbee5b91d0bc0fcc6c71560d631295fa5/comments",
    "author": {
      "login": "eklitzke",
      "id": 2734,
      "node_id": "MDQ6VXNlcjI3MzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2734?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eklitzke",
      "html_url": "https://github.com/eklitzke",
      "followers_url": "https://api.github.com/users/eklitzke/followers",
      "following_url": "https://api.github.com/users/eklitzke/following{/other_user}",
      "gists_url": "https://api.github.com/users/eklitzke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eklitzke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eklitzke/subscriptions",
      "organizations_url": "https://api.github.com/users/eklitzke/orgs",
      "repos_url": "https://api.github.com/users/eklitzke/repos",
      "events_url": "https://api.github.com/users/eklitzke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eklitzke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "ce5cbaea63ad4ea78e533bdb14f47f414061ae7f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ce5cbaea63ad4ea78e533bdb14f47f414061ae7f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/ce5cbaea63ad4ea78e533bdb14f47f414061ae7f"
      }
    ],
    "stats": {
      "total": 16,
      "additions": 16,
      "deletions": 0
    },
    "files": [
      {
        "sha": "43c6ae54ab5ccac2865c44ea5f5f3f7a58596d91",
        "filename": "src/util/system.cpp",
        "status": "modified",
        "additions": 9,
        "deletions": 0,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/220bb16cbee5b91d0bc0fcc6c71560d631295fa5/src/util/system.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/220bb16cbee5b91d0bc0fcc6c71560d631295fa5/src/util/system.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util/system.cpp?ref=220bb16cbee5b91d0bc0fcc6c71560d631295fa5",
        "patch": "@@ -1043,6 +1043,15 @@ bool FileCommit(FILE *file)\n     return true;\n }\n \n+void DirectoryCommit(const fs::path &dirname)\n+{\n+#ifndef WIN32\n+    FILE* file = fsbridge::fopen(dirname, \"r\");\n+    fsync(fileno(file));\n+    fclose(file);\n+#endif\n+}\n+\n bool TruncateFile(FILE *file, unsigned int length) {\n #if defined(WIN32)\n     return _chsize(_fileno(file), length) == 0;"
      },
      {
        "sha": "029204f01e6141973d6262476061a6074e7da069",
        "filename": "src/util/system.h",
        "status": "modified",
        "additions": 7,
        "deletions": 0,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/220bb16cbee5b91d0bc0fcc6c71560d631295fa5/src/util/system.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/220bb16cbee5b91d0bc0fcc6c71560d631295fa5/src/util/system.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util/system.h?ref=220bb16cbee5b91d0bc0fcc6c71560d631295fa5",
        "patch": "@@ -62,6 +62,13 @@ void PrintExceptionContinue(const std::exception *pex, const char* pszThread);\n  * feature analogous to fsync().\n  */\n bool FileCommit(FILE *file);\n+\n+/**\n+ * Sync directory contents. This is required on some environments to ensure that\n+ * newly created files are committed to disk.\n+ */\n+void DirectoryCommit(const fs::path &dirname);\n+\n bool TruncateFile(FILE *file, unsigned int length);\n int RaiseFileDescriptorLimit(int nMinFD);\n void AllocateFileRange(FILE *file, unsigned int offset, unsigned int length);"
      }
    ]
  },
  {
    "sha": "457490403853321d308c6ca6aaa90d6f8f29b4cf",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0NTc0OTA0MDM4NTMzMjFkMzA4YzZjYTZhYWE5MGQ2ZjhmMjliNGNm",
    "commit": {
      "author": {
        "name": "Evan Klitzke",
        "email": "evan@eklitzke.org",
        "date": "2018-03-15T13:54:11Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2020-08-25T16:46:46Z"
      },
      "message": "Fix possible data race when committing block files\n\nIt was recently pointed out to me that calling fsync() or fdatasync() on a new\nfile is not sufficient to ensure it's persisted to disk, a the existence of the\nfile itself is stored in the directory inode. This means that ensuring that a\nnew file is actually committed also requires an fsync() on the parent directory.\n\nThis change ensures that we call fsync() on the blocks directory after\ncommitting new block files.",
      "tree": {
        "sha": "698e6160ccd923c9472a57943671492f4b7ea594",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/698e6160ccd923c9472a57943671492f4b7ea594"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/457490403853321d308c6ca6aaa90d6f8f29b4cf",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/457490403853321d308c6ca6aaa90d6f8f29b4cf",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/457490403853321d308c6ca6aaa90d6f8f29b4cf",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/457490403853321d308c6ca6aaa90d6f8f29b4cf/comments",
    "author": {
      "login": "eklitzke",
      "id": 2734,
      "node_id": "MDQ6VXNlcjI3MzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2734?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/eklitzke",
      "html_url": "https://github.com/eklitzke",
      "followers_url": "https://api.github.com/users/eklitzke/followers",
      "following_url": "https://api.github.com/users/eklitzke/following{/other_user}",
      "gists_url": "https://api.github.com/users/eklitzke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/eklitzke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/eklitzke/subscriptions",
      "organizations_url": "https://api.github.com/users/eklitzke/orgs",
      "repos_url": "https://api.github.com/users/eklitzke/repos",
      "events_url": "https://api.github.com/users/eklitzke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/eklitzke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "220bb16cbee5b91d0bc0fcc6c71560d631295fa5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/220bb16cbee5b91d0bc0fcc6c71560d631295fa5",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/220bb16cbee5b91d0bc0fcc6c71560d631295fa5"
      }
    ],
    "stats": {
      "total": 1,
      "additions": 1,
      "deletions": 0
    },
    "files": [
      {
        "sha": "11cf357f3dd799c1e8e91adefe3f4eae2faddae5",
        "filename": "src/flatfile.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/457490403853321d308c6ca6aaa90d6f8f29b4cf/src/flatfile.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/457490403853321d308c6ca6aaa90d6f8f29b4cf/src/flatfile.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/flatfile.cpp?ref=457490403853321d308c6ca6aaa90d6f8f29b4cf",
        "patch": "@@ -92,6 +92,7 @@ bool FlatFileSeq::Flush(const FlatFilePos& pos, bool finalize)\n         fclose(file);\n         return error(\"%s: failed to commit file %d\", __func__, pos.nFile);\n     }\n+    DirectoryCommit(m_dir);\n \n     fclose(file);\n     return true;"
      }
    ]
  },
  {
    "sha": "ef712298c3f8bc2afdad783f05080443b72b3f77",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplZjcxMjI5OGMzZjhiYzJhZmRhZDc4M2YwNTA4MDQ0M2I3MmIzZjc3",
    "commit": {
      "author": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2018-10-17T08:34:53Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2020-08-25T16:46:46Z"
      },
      "message": "util: Check for file being NULL in DirectoryCommit",
      "tree": {
        "sha": "2b180f7dd2479894d3f8e7e8898d7f4e9129f711",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2b180f7dd2479894d3f8e7e8898d7f4e9129f711"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ef712298c3f8bc2afdad783f05080443b72b3f77",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ef712298c3f8bc2afdad783f05080443b72b3f77",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/ef712298c3f8bc2afdad783f05080443b72b3f77",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ef712298c3f8bc2afdad783f05080443b72b3f77/comments",
    "author": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "457490403853321d308c6ca6aaa90d6f8f29b4cf",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/457490403853321d308c6ca6aaa90d6f8f29b4cf",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/457490403853321d308c6ca6aaa90d6f8f29b4cf"
      }
    ],
    "stats": {
      "total": 6,
      "additions": 4,
      "deletions": 2
    },
    "files": [
      {
        "sha": "2ed9cf70485bbb297bfd42cfb8069007c6fee938",
        "filename": "src/util/system.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 2,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ef712298c3f8bc2afdad783f05080443b72b3f77/src/util/system.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ef712298c3f8bc2afdad783f05080443b72b3f77/src/util/system.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util/system.cpp?ref=ef712298c3f8bc2afdad783f05080443b72b3f77",
        "patch": "@@ -1047,8 +1047,10 @@ void DirectoryCommit(const fs::path &dirname)\n {\n #ifndef WIN32\n     FILE* file = fsbridge::fopen(dirname, \"r\");\n-    fsync(fileno(file));\n-    fclose(file);\n+    if (file) {\n+        fsync(fileno(file));\n+        fclose(file);\n+    }\n #endif\n }\n "
      }
    ]
  }
]