[
  {
    "sha": "fabf3d64ff2bd14f762810316144bb9fd69c517c",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYWJmM2Q2NGZmMmJkMTRmNzYyODEwMzE2MTQ0YmI5ZmQ2OWM1MTdj",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-06-07T17:55:08Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-06-19T13:26:59Z"
      },
      "message": "test: Add FeeFilterRounder test",
      "tree": {
        "sha": "ab606ee3b1cbcb112d4c17d9337a6fbf2bde5d88",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ab606ee3b1cbcb112d4c17d9337a6fbf2bde5d88"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fabf3d64ff2bd14f762810316144bb9fd69c517c",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUiRowv6A2QjjjA17DqbBwIowPAP4hu+XR8woiI9VvlXAPgqyFvBwiuGNASpynwK\n7Yl7x7cLJQLJpS/wtYnr8zg89S5semExVS4QwmmHxkPjBYZ6BNcmiyQhNfr4ig0s\n74V5tnvlXPdwh52HdK7x49mkNTYb4SOh4FDWqnCygnqy4VlzSjzYK7rYGDotoryZ\naZRk5pKXjkArVNO84zJdoET+SL+alOMeyVJ1NhTG2isqLZ77XsNsqRbx/kU3U3CT\nWG+X1pTP4oCL/TGnQSUOLO+N17Oy2EAcUQIx+i1/GtaCS2plNV40lr1jPyLLkBfC\nCVIAws9DorSg8A5dOoq9XOF5w2De0F8tDnsgmvfVSSQfeg5Iri4Fdz93pf7HsPpQ\nmfJtfjFIwxjaH2Ks1/5YBxC5XehItmFAWCH2pVsWFxymol6S3TpkVyugBWIrnqjI\nYGsuNzhv1cDovfAHI5CuPeYy9IINEx85kjpRVPJflTfRD93nSSG/GjmH2A7lh6Ya\na9Pt9/sN\n=aI7a\n-----END PGP SIGNATURE-----",
        "payload": "tree ab606ee3b1cbcb112d4c17d9337a6fbf2bde5d88\nparent 5f72ddb7ee4cc177de31f43c69390ee72687222a\nauthor MarcoFalke <falke.marco@gmail.com> 1591552508 -0400\ncommitter MarcoFalke <falke.marco@gmail.com> 1592573219 -0400\n\ntest: Add FeeFilterRounder test\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fabf3d64ff2bd14f762810316144bb9fd69c517c",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fabf3d64ff2bd14f762810316144bb9fd69c517c",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fabf3d64ff2bd14f762810316144bb9fd69c517c/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "5f72ddb7ee4cc177de31f43c69390ee72687222a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/5f72ddb7ee4cc177de31f43c69390ee72687222a",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/5f72ddb7ee4cc177de31f43c69390ee72687222a"
      }
    ],
    "stats": {
      "total": 35,
      "additions": 35,
      "deletions": 0
    },
    "files": [
      {
        "sha": "acdf9b97bd7c79baafdedb1524d92815c3f049da",
        "filename": "src/Makefile.test.include",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fabf3d64ff2bd14f762810316144bb9fd69c517c/src/Makefile.test.include",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fabf3d64ff2bd14f762810316144bb9fd69c517c/src/Makefile.test.include",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.test.include?ref=fabf3d64ff2bd14f762810316144bb9fd69c517c",
        "patch": "@@ -231,6 +231,7 @@ BITCOIN_TESTS =\\\n   test/net_tests.cpp \\\n   test/netbase_tests.cpp \\\n   test/pmt_tests.cpp \\\n+  test/policy_fee_tests.cpp \\\n   test/policyestimator_tests.cpp \\\n   test/pow_tests.cpp \\\n   test/prevector_tests.cpp \\"
      },
      {
        "sha": "6d8872b11e3e6ffed56e3f0e69efa2327c463205",
        "filename": "src/test/policy_fee_tests.cpp",
        "status": "added",
        "additions": 34,
        "deletions": 0,
        "changes": 34,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fabf3d64ff2bd14f762810316144bb9fd69c517c/src/test/policy_fee_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fabf3d64ff2bd14f762810316144bb9fd69c517c/src/test/policy_fee_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/policy_fee_tests.cpp?ref=fabf3d64ff2bd14f762810316144bb9fd69c517c",
        "patch": "@@ -0,0 +1,34 @@\n+// Copyright (c) 2020 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <amount.h>\n+#include <policy/fees.h>\n+\n+#include <test/util/setup_common.h>\n+\n+#include <boost/test/unit_test.hpp>\n+\n+BOOST_FIXTURE_TEST_SUITE(policy_fee_tests, BasicTestingSetup)\n+\n+BOOST_AUTO_TEST_CASE(FeeRounder)\n+{\n+    FeeFilterRounder fee_rounder{CFeeRate{1000}};\n+\n+    // check that 1000 rounds to 974 or 1071\n+    std::set<CAmount> results;\n+    while (results.size() < 2) {\n+        results.emplace(fee_rounder.round(1000));\n+    }\n+    BOOST_CHECK_EQUAL(*results.begin(), 974);\n+    BOOST_CHECK_EQUAL(*++results.begin(), 1071);\n+\n+    // check that negative amounts rounds to 0\n+    BOOST_CHECK_EQUAL(fee_rounder.round(-0), 0);\n+    BOOST_CHECK_EQUAL(fee_rounder.round(-1), 0);\n+\n+    // check that MAX_MONEY rounds to 9170997\n+    BOOST_CHECK_EQUAL(fee_rounder.round(MAX_MONEY), 9170997);\n+}\n+\n+BOOST_AUTO_TEST_SUITE_END()"
      }
    ]
  },
  {
    "sha": "faba65e696a88e5626e587f4e63fa15500cbe4d0",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYWJhNjVlNjk2YTg4ZTU2MjZlNTg3ZjRlNjNmYTE1NTAwY2JlNGQw",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-06-03T13:55:58Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-06-19T13:27:00Z"
      },
      "message": "Add ChainstateManager::ActiveChainstate",
      "tree": {
        "sha": "467272d5e303b7ed8c0ce0db94df93bc99b27c7d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/467272d5e303b7ed8c0ce0db94df93bc99b27c7d"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/faba65e696a88e5626e587f4e63fa15500cbe4d0",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUhViAv8DSAAY4sQ0RLBxNzFOIgPKWEKUWYIfHaIF1bU9jriDuGwJD2rSW7ftIYC\niNKMND2KwWbLhEglRl4jQjyMetrDHcWKKbg4AV7mr3VzcUFbEaWHAfBgQ4nAUfNM\nW7HbnU11+vxTqjsYWRPzjVouhgiQ7ly3mpEq3jvIKAnvsTBe7inN7cJmCIYoEgv0\ncZV7i1PMq12ajyHm/U53GqjwDU5aEwKPBEjWGOOl4W5OP0+t+2+UNcdZFK7Eopp8\nUOr/Sa4bo6AzFRkH5NIgNPYT+9T9G7m7D+kaWrDFfth2xixvEUJdgmPgBuNTvqYW\n+L3SuqYFNETMY5zS3ht5yar+oOjMzEPbnLe1uoYFnD8+GdU924gkVva2RxeFuaHI\nmMHX4k2mylG/1Wehg9oxSt749/EK1uZkowVlpCcdxkrO4GBvtaP05XUkJNFMQ2D8\n4GAXY19bhqLgJ2Ak4RB+wg+0k+yctjLE6ThI854wvBdCyluyuYFudRw3Nifjs8Vq\nmxUTbynZ\n=jy3W\n-----END PGP SIGNATURE-----",
        "payload": "tree 467272d5e303b7ed8c0ce0db94df93bc99b27c7d\nparent fabf3d64ff2bd14f762810316144bb9fd69c517c\nauthor MarcoFalke <falke.marco@gmail.com> 1591192558 -0400\ncommitter MarcoFalke <falke.marco@gmail.com> 1592573220 -0400\n\nAdd ChainstateManager::ActiveChainstate\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faba65e696a88e5626e587f4e63fa15500cbe4d0",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/faba65e696a88e5626e587f4e63fa15500cbe4d0",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faba65e696a88e5626e587f4e63fa15500cbe4d0/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fabf3d64ff2bd14f762810316144bb9fd69c517c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fabf3d64ff2bd14f762810316144bb9fd69c517c",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fabf3d64ff2bd14f762810316144bb9fd69c517c"
      }
    ],
    "stats": {
      "total": 13,
      "additions": 7,
      "deletions": 6
    },
    "files": [
      {
        "sha": "fcaa62c9b29223f5bbc0cf4a90ffc8b3887c71eb",
        "filename": "src/validation.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faba65e696a88e5626e587f4e63fa15500cbe4d0/src/validation.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faba65e696a88e5626e587f4e63fa15500cbe4d0/src/validation.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/validation.cpp?ref=faba65e696a88e5626e587f4e63fa15500cbe4d0",
        "patch": "@@ -5251,10 +5251,10 @@ CChainState& ChainstateManager::InitializeChainstate(const uint256& snapshot_blo\n     return *to_modify;\n }\n \n-CChain& ChainstateManager::ActiveChain() const\n+CChainState& ChainstateManager::ActiveChainstate() const\n {\n     assert(m_active_chainstate);\n-    return m_active_chainstate->m_chain;\n+    return *m_active_chainstate;\n }\n \n bool ChainstateManager::IsSnapshotActive() const"
      },
      {
        "sha": "58383ad9238e21e20cdb8bc7568eacf4b10ba1ab",
        "filename": "src/validation.h",
        "status": "modified",
        "additions": 5,
        "deletions": 4,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faba65e696a88e5626e587f4e63fa15500cbe4d0/src/validation.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faba65e696a88e5626e587f4e63fa15500cbe4d0/src/validation.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/validation.h?ref=faba65e696a88e5626e587f4e63fa15500cbe4d0",
        "patch": "@@ -799,7 +799,8 @@ class ChainstateManager\n     std::vector<CChainState*> GetAll();\n \n     //! The most-work chain.\n-    CChain& ActiveChain() const;\n+    CChainState& ActiveChainstate() const;\n+    CChain& ActiveChain() const { return ActiveChainstate().m_chain; }\n     int ActiveHeight() const { return ActiveChain().Height(); }\n     CBlockIndex* ActiveTip() const { return ActiveChain().Tip(); }\n \n@@ -879,13 +880,13 @@ class ChainstateManager\n /** DEPRECATED! Please use node.chainman instead. May only be used in validation.cpp internally */\n extern ChainstateManager g_chainman GUARDED_BY(::cs_main);\n \n-/** @returns the most-work valid chainstate. */\n+/** Please prefer the identical ChainstateManager::ActiveChainstate */\n CChainState& ChainstateActive();\n \n-/** @returns the most-work chain. */\n+/** Please prefer the identical ChainstateManager::ActiveChain */\n CChain& ChainActive();\n \n-/** @returns the global block index map. */\n+/** Please prefer the identical ChainstateManager::BlockIndex */\n BlockMap& BlockIndex();\n \n /** Global variable that points to the active block tree (protected by cs_main) */"
      }
    ]
  },
  {
    "sha": "fa06d7e93489e61078cfb95ab767c001536a6e10",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYTA2ZDdlOTM0ODllNjEwNzhjZmI5NWFiNzY3YzAwMTUzNmE2ZTEw",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-06-11T11:49:10Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-06-19T13:27:13Z"
      },
      "message": "refactor: block import implies IsInitialBlockDownload",
      "tree": {
        "sha": "06da150f09129d5af6e37082aea8d0dfe6798693",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/06da150f09129d5af6e37082aea8d0dfe6798693"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa06d7e93489e61078cfb95ab767c001536a6e10",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUg71wwAnMsjyFW5TQABzgoPsjAisH4NbWddO89QH2thda1XSlz4ouzUSzaZZa/p\nE6r2VTc68+WofUF5HNFC5M1TwXH46nJCd/lvOKW7bUNOo111MUruhY86pgLN1k6v\n4nEmULJNKaz7HxIYT8qzxya7PlDTBULr8ssPsjpUH/jAn4tdizFGQ8W57FxDBVZW\nPiNU0YQPduMd+wapGu6pYcMZBS8yjzio2Z9pE9EdueIaw8Eqz5B0ZBsnqEnH5s/9\nWYsf0EnYRwvt59Mi1kEaz1Gooemf93jiL2FJV2q5QrOzsic/2tACz1zb0GYcDIQK\nTcSg21D1BoCgV4M/+vwA4kvecOFIksObtz5nBEm/T3UjuhDXXHxSXPg/uh4okXpo\ncUKv6UxRkcH4MwPX57Nt7hEf6LMGuWOtNB8rWiuIeSviiS5fEiofSFQXDdPwaFm7\n6zhfOk2/T3DmYUKKm0+uSJEXYtk5BrCbsJ82Is/kBRhabp65l+UzxO9TTqtMmF8T\ncW/iDYvi\n=K/sW\n-----END PGP SIGNATURE-----",
        "payload": "tree 06da150f09129d5af6e37082aea8d0dfe6798693\nparent faba65e696a88e5626e587f4e63fa15500cbe4d0\nauthor MarcoFalke <falke.marco@gmail.com> 1591876150 -0400\ncommitter MarcoFalke <falke.marco@gmail.com> 1592573233 -0400\n\nrefactor: block import implies IsInitialBlockDownload\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa06d7e93489e61078cfb95ab767c001536a6e10",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fa06d7e93489e61078cfb95ab767c001536a6e10",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa06d7e93489e61078cfb95ab767c001536a6e10/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "faba65e696a88e5626e587f4e63fa15500cbe4d0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faba65e696a88e5626e587f4e63fa15500cbe4d0",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/faba65e696a88e5626e587f4e63fa15500cbe4d0"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 1,
      "deletions": 1
    },
    "files": [
      {
        "sha": "4fb4e1c120a10245a20303f0c15fdb0cfc5e5e3f",
        "filename": "src/net_processing.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa06d7e93489e61078cfb95ab767c001536a6e10/src/net_processing.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa06d7e93489e61078cfb95ab767c001536a6e10/src/net_processing.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net_processing.cpp?ref=fa06d7e93489e61078cfb95ab767c001536a6e10",
        "patch": "@@ -2576,7 +2576,7 @@ void ProcessMessage(\n                     LogPrint(BCLog::NET, \"transaction (%s) inv sent in violation of protocol, disconnecting peer=%d\\n\", inv.hash.ToString(), pfrom.GetId());\n                     pfrom.fDisconnect = true;\n                     return;\n-                } else if (!fAlreadyHave && !fImporting && !fReindex && !::ChainstateActive().IsInitialBlockDownload()) {\n+                } else if (!fAlreadyHave && !chainman.ActiveChainstate().IsInitialBlockDownload()) {\n                     RequestTx(State(pfrom.GetId()), inv.hash, current_time);\n                 }\n             }"
      }
    ]
  },
  {
    "sha": "fa525e4d1cfda8c1924d2c69f43bd7ae3b98fb72",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYTUyNWU0ZDFjZmRhOGMxOTI0ZDJjNjlmNDNiZDdhZTNiOThmYjcy",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-06-07T16:41:10Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-06-19T13:27:30Z"
      },
      "message": "net: Avoid wasting inv traffic during IBD",
      "tree": {
        "sha": "598164e99a59eb52e640b22e438695cc94a67e31",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/598164e99a59eb52e640b22e438695cc94a67e31"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa525e4d1cfda8c1924d2c69f43bd7ae3b98fb72",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUjkGwwAvR8zCQ7FAf1cexBBFVfK0TLmhAqW8khffP21gvXYg9e9uqlToQL7Uk0G\niB3EflG+rjFg1jU8JfqBzKPyEE9xZaMAjaCkw+E6ATd9AKWBBGTjABYCUsPwmFsJ\nEQUoM0RYF9GIN3VqWnIewztWocmUa4NQLq9C/9v7HU2AI+4+0SewE3RKAYuYe1zb\nfA6rXl4hKr1NUUOba/MW07TH3msELPns8QDaZltCswrJ42x8clmgbmLjwcU/qOf/\njAq8i/+8b/CL8Adv8zjjTAqLrQjpHXIoQIXw27wIQ1BPllMO12vTcGFKDSh+1Kpq\n7y7C7lfcg6gw5kj8RwThcMqC3o3I4XgDZuFyLGB6Ymtg4Qr/tf0hnZIY/zYkkuWJ\nyPA9jsDkxFYbTIDA4LNIkahety8My49P58uKPWCL4LvWjW2mlro4bNjBeT3zuqP7\nJU2GDZIvrmL2nDhMK4qbA/0ZYZPWwQmDeeKdhNebE33Se8fF2dcn2M1IxWMFdYN8\nFW035fJ+\n=uU4o\n-----END PGP SIGNATURE-----",
        "payload": "tree 598164e99a59eb52e640b22e438695cc94a67e31\nparent fa06d7e93489e61078cfb95ab767c001536a6e10\nauthor MarcoFalke <falke.marco@gmail.com> 1591548070 -0400\ncommitter MarcoFalke <falke.marco@gmail.com> 1592573250 -0400\n\nnet: Avoid wasting inv traffic during IBD\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa525e4d1cfda8c1924d2c69f43bd7ae3b98fb72",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fa525e4d1cfda8c1924d2c69f43bd7ae3b98fb72",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa525e4d1cfda8c1924d2c69f43bd7ae3b98fb72/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fa06d7e93489e61078cfb95ab767c001536a6e10",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa06d7e93489e61078cfb95ab767c001536a6e10",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fa06d7e93489e61078cfb95ab767c001536a6e10"
      }
    ],
    "stats": {
      "total": 21,
      "additions": 17,
      "deletions": 4
    },
    "files": [
      {
        "sha": "02ad41ab00073fcc44971035a96dbf111df36059",
        "filename": "src/net_processing.cpp",
        "status": "modified",
        "additions": 14,
        "deletions": 3,
        "changes": 17,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa525e4d1cfda8c1924d2c69f43bd7ae3b98fb72/src/net_processing.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa525e4d1cfda8c1924d2c69f43bd7ae3b98fb72/src/net_processing.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net_processing.cpp?ref=fa525e4d1cfda8c1924d2c69f43bd7ae3b98fb72",
        "patch": "@@ -4392,10 +4392,21 @@ bool PeerLogicValidation::SendMessages(CNode* pto)\n             !pto->HasPermission(PF_FORCERELAY)) {\n             CAmount currentFilter = m_mempool.GetMinFee(gArgs.GetArg(\"-maxmempool\", DEFAULT_MAX_MEMPOOL_SIZE) * 1000000).GetFeePerK();\n             int64_t timeNow = GetTimeMicros();\n+            static FeeFilterRounder g_filter_rounder{CFeeRate{DEFAULT_MIN_RELAY_TX_FEE}};\n+            if (m_chainman.ActiveChainstate().IsInitialBlockDownload()) {\n+                // Received tx-inv messages are discarded when the active\n+                // chainstate is in IBD, so tell the peer to not send them.\n+                currentFilter = MAX_MONEY;\n+            } else {\n+                static const CAmount MAX_FILTER{g_filter_rounder.round(MAX_MONEY)};\n+                if (pto->m_tx_relay->lastSentFeeFilter == MAX_FILTER) {\n+                    // Send the current filter if we sent MAX_FILTER previously\n+                    // and made it out of IBD.\n+                    pto->m_tx_relay->nextSendTimeFeeFilter = timeNow - 1;\n+                }\n+            }\n             if (timeNow > pto->m_tx_relay->nextSendTimeFeeFilter) {\n-                static CFeeRate default_feerate(DEFAULT_MIN_RELAY_TX_FEE);\n-                static FeeFilterRounder filterRounder(default_feerate);\n-                CAmount filterToSend = filterRounder.round(currentFilter);\n+                CAmount filterToSend = g_filter_rounder.round(currentFilter);\n                 // We always have a fee filter of at least minRelayTxFee\n                 filterToSend = std::max(filterToSend, ::minRelayTxFee.GetFeePerK());\n                 if (filterToSend != pto->m_tx_relay->lastSentFeeFilter) {"
      },
      {
        "sha": "ca26152e7e1673fbfef94c9b478026b55f79e739",
        "filename": "test/functional/rpc_net.py",
        "status": "modified",
        "additions": 3,
        "deletions": 1,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa525e4d1cfda8c1924d2c69f43bd7ae3b98fb72/test/functional/rpc_net.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa525e4d1cfda8c1924d2c69f43bd7ae3b98fb72/test/functional/rpc_net.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/rpc_net.py?ref=fa525e4d1cfda8c1924d2c69f43bd7ae3b98fb72",
        "patch": "@@ -46,10 +46,12 @@ class NetTest(BitcoinTestFramework):\n     def set_test_params(self):\n         self.setup_clean_chain = True\n         self.num_nodes = 2\n-        self.extra_args = [[\"-minrelaytxfee=0.00001000\"],[\"-minrelaytxfee=0.00000500\"]]\n+        self.extra_args = [[\"-minrelaytxfee=0.00001000\"], [\"-minrelaytxfee=0.00000500\"]]\n         self.supports_cli = False\n \n     def run_test(self):\n+        self.log.info('Get out of IBD for the minfeefilter test')\n+        self.nodes[0].generate(1)\n         self.log.info('Connect nodes both way')\n         connect_nodes(self.nodes[0], 1)\n         connect_nodes(self.nodes[1], 0)"
      }
    ]
  }
]