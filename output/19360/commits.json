[
  {
    "sha": "bc74a40a56128f81f11151d5966f53b82f19038c",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiYzc0YTQwYTU2MTI4ZjgxZjExMTUxZDU5NjZmNTNiODJmMTkwMzhj",
    "commit": {
      "author": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2020-05-13T16:45:39Z"
      },
      "committer": {
        "name": "Vasil Dimov",
        "email": "vd@FreeBSD.org",
        "date": "2020-07-10T12:58:42Z"
      },
      "message": "net: improve encapsulation of CNetAddr\n\nDo not access `CNetAddr::ip` directly from `CService` methods.\n\nThis improvement will help later when we change the type of\n`CNetAddr::ip` (in the BIP155 implementation).\n\nCo-authored-by: Carl Dong <contact@carldong.me>",
      "tree": {
        "sha": "18d0a729bb932d7806c6ebcd8b743a8429313abb",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/18d0a729bb932d7806c6ebcd8b743a8429313abb"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bc74a40a56128f81f11151d5966f53b82f19038c",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQQzBAABCAAdFiEE5k2NRWFNsHVF2czBVN8G9ktVy78FAl8IZiYACgkQVN8G9ktV\ny79UpSAAnC7TkO2GDjvTtd3Wc9s+uyiraHfA53+R2NUn5FbViyP6ExQNUywPtkD5\nA2hc7KO6WuUKEpTdfFOg0shKi6P2LfGKttWtWrSlORODWLHtkfDQttP0MO4jrTJk\nNrMdx9m2QSWwjuh8uZkQclpUvq4ofZZshQ1R98lGvGjtGwW7hqAgr90AlFYx5ptU\nnAQ6XNdlAN8B9XiEMESApELrzTCo4Vl+VKUEWFm1TuG/3TAzWWm/peh+aeJhZ+Rd\nuC33rXz6fuqdUxMymlQE/3B/u+NUoApStnUlfTpcZAw/wm10ffsLdW3frCMeXQUk\nIZtfk/ncOPq8001fa8ctTWFpM6CIAwTJ1+JM2Y/k5GZHFSEE+eJWTKKzckmcRfwA\nR3tZ9aS8bimhCEI4fY3TiucJhBLdBUcNEi2JrEhChokTd8vahYAagCNiqRuIpA0l\nPuJaRDb/xUpI1rHdmolgqfemWc+q0O/qSDpoQpCF5sZaT87IdCjhEgNWGnMtarVd\npPdxI6TBoa5v+otdUaoesPE2yh1us3/TtN+1/Q7QqYf70Lk3ESulejmvMagLl95G\nUCUkmQbptNbB8+OY/PTOV05+Biug3IuLfHWp5e6rtoqa4X8uc99KbmvR78s3RxGk\noIGiiRCQmvy+xN8QSXk7OjxJkQjzUus2SO18t6azRapBkLWfRgXadVoDsEOgJomp\ndS2EEt2oac0SPyr+JRaHeoZTV/7guYjLMc0T+tds1usLM4iccOGQtvsymAZirI6p\n9DPBnvbXE1F9u96Fs0OiWByjkL1rFXwAanPx7X/ulpW7R/D9MEEJ/UD8jnTKX7Jr\n28/Fq/b+i9+/LPOYah1ZYuMAnkL692TgUeIrbgeaftmvG66aDURRxyGaAQlpX+VZ\n8tBx9E7Zf6kbD7f7K/C4NcIVulcH3IZcO/HVyy3PBO5znDfsIT4oRInf2AN8/cvh\nC0Be/HG1QXnTRl7s1nXtMTqY+nKqxpKgQAXh3UcdUO70VNNYA/vufOcTnne9W3B9\nFs47K783+6kZJI41ijktZST2j8KgPb6EewbKzWkPB55nqrJ50AveW3wI5hGc5ZTV\nb7HeS+cKd+m9q48J6NyyTvznhJzpwWcK2N+xtMBK0+5gAPqmqlGEXG4Ecj4CzBIZ\n1sCynCM5vZsLjJffvMBexeHSjJYNLQs1M/V7xmwmkSjskopr3sSUlckMw05l8q/z\nYNxG8q27Pr/S9e1TGaRRtPNk9kImvLwEG/mKtfc7ISGB0yDiyZ0G5rMrgRVBMY5H\nUBeKfPeGigh2meykFETTNTDE1KF1xUk/qEfL+vVvhSBzckBEgDIvhalKyNO1ezP8\na9G6HgUMsrA+fvgJnAC5S3N9gz6sDA==\n=Zf+A\n-----END PGP SIGNATURE-----",
        "payload": "tree 18d0a729bb932d7806c6ebcd8b743a8429313abb\nparent fd9db45c3ea11e4ee0a610b294496301a051893e\nauthor Vasil Dimov <vd@FreeBSD.org> 1589388339 +0200\ncommitter Vasil Dimov <vd@FreeBSD.org> 1594385922 +0200\n\nnet: improve encapsulation of CNetAddr\n\nDo not access `CNetAddr::ip` directly from `CService` methods.\n\nThis improvement will help later when we change the type of\n`CNetAddr::ip` (in the BIP155 implementation).\n\nCo-authored-by: Carl Dong <contact@carldong.me>\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bc74a40a56128f81f11151d5966f53b82f19038c",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/bc74a40a56128f81f11151d5966f53b82f19038c",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bc74a40a56128f81f11151d5966f53b82f19038c/comments",
    "author": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fd9db45c3ea11e4ee0a610b294496301a051893e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fd9db45c3ea11e4ee0a610b294496301a051893e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fd9db45c3ea11e4ee0a610b294496301a051893e"
      }
    ],
    "stats": {
      "total": 16,
      "additions": 9,
      "deletions": 7
    },
    "files": [
      {
        "sha": "0aaba440b857c3a2feaecc0e62128575f7357b81",
        "filename": "src/netaddress.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 6,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bc74a40a56128f81f11151d5966f53b82f19038c/src/netaddress.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bc74a40a56128f81f11151d5966f53b82f19038c/src/netaddress.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/netaddress.cpp?ref=bc74a40a56128f81f11151d5966f53b82f19038c",
        "patch": "@@ -726,12 +726,10 @@ bool CService::GetSockAddr(struct sockaddr* paddr, socklen_t *addrlen) const\n  */\n std::vector<unsigned char> CService::GetKey() const\n {\n-     std::vector<unsigned char> vKey;\n-     vKey.resize(18);\n-     memcpy(vKey.data(), ip, 16);\n-     vKey[16] = port / 0x100; // most significant byte of our port\n-     vKey[17] = port & 0x0FF; // least significant byte of our port\n-     return vKey;\n+    auto key = GetAddrBytes();\n+    key.push_back(port / 0x100); // most significant byte of our port\n+    key.push_back(port & 0x0FF); // least significant byte of our port\n+    return key;\n }\n \n std::string CService::ToStringPort() const"
      },
      {
        "sha": "f2daad7fb694126da18ef6243b267874f0df17c5",
        "filename": "src/netaddress.h",
        "status": "modified",
        "additions": 5,
        "deletions": 1,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bc74a40a56128f81f11151d5966f53b82f19038c/src/netaddress.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bc74a40a56128f81f11151d5966f53b82f19038c/src/netaddress.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/netaddress.h?ref=bc74a40a56128f81f11151d5966f53b82f19038c",
        "patch": "@@ -160,7 +160,11 @@ class CService : public CNetAddr\n         CService(const struct in6_addr& ipv6Addr, uint16_t port);\n         explicit CService(const struct sockaddr_in6& addr);\n \n-        SERIALIZE_METHODS(CService, obj) { READWRITE(obj.ip, Using<BigEndianFormatter<2>>(obj.port)); }\n+        SERIALIZE_METHODS(CService, obj)\n+        {\n+            READWRITEAS(CNetAddr, obj);\n+            READWRITE(Using<BigEndianFormatter<2>>(obj.port));\n+        }\n };\n \n bool SanityCheckASMap(const std::vector<bool>& asmap);"
      }
    ]
  }
]