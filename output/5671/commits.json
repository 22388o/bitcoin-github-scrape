[
  {
    "sha": "f5ad78b34af8f50e12fab63b331768b96ec2c779",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmNWFkNzhiMzRhZjhmNTBlMTJmYWI2M2IzMzE3NjhiOTZlYzJjNzc5",
    "commit": {
      "author": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2015-01-16T21:03:48Z"
      },
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2015-01-16T21:11:01Z"
      },
      "message": "qt: fonts: allow SubstituteFonts to filter based on user's language\n\nSubstituteFonts() has been moved to after app identification so that QSettings\nare accessible.",
      "tree": {
        "sha": "8c05b12cd3cac1690c733406a5785dd9c387ff03",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8c05b12cd3cac1690c733406a5785dd9c387ff03"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f5ad78b34af8f50e12fab63b331768b96ec2c779",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f5ad78b34af8f50e12fab63b331768b96ec2c779",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/f5ad78b34af8f50e12fab63b331768b96ec2c779",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f5ad78b34af8f50e12fab63b331768b96ec2c779/comments",
    "author": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "9fe53a85e0e50ca82e369b7d29485a0a6f0f8dbf",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9fe53a85e0e50ca82e369b7d29485a0a6f0f8dbf",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/9fe53a85e0e50ca82e369b7d29485a0a6f0f8dbf"
      }
    ],
    "stats": {
      "total": 31,
      "additions": 19,
      "deletions": 12
    },
    "files": [
      {
        "sha": "73c684e4893fc0fd9180be544ecd1b4ad02d45f3",
        "filename": "src/qt/bitcoin.cpp",
        "status": "modified",
        "additions": 17,
        "deletions": 10,
        "changes": 27,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f5ad78b34af8f50e12fab63b331768b96ec2c779/src/qt/bitcoin.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f5ad78b34af8f50e12fab63b331768b96ec2c779/src/qt/bitcoin.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoin.cpp?ref=f5ad78b34af8f50e12fab63b331768b96ec2c779",
        "patch": "@@ -89,10 +89,24 @@ static std::string Translate(const char* psz)\n     return QCoreApplication::translate(\"bitcoin-core\", psz).toStdString();\n }\n \n+static QString GetLangTerritory()\n+{\n+    QSettings settings;\n+    // Get desired locale (e.g. \"de_DE\")\n+    // 1) System default language\n+    QString lang_territory = QLocale::system().name();\n+    // 2) Language from QSettings\n+    QString lang_territory_qsettings = settings.value(\"language\", \"\").toString();\n+    if(!lang_territory_qsettings.isEmpty())\n+        lang_territory = lang_territory_qsettings;\n+    // 3) -lang command line argument\n+    lang_territory = QString::fromStdString(GetArg(\"-lang\", lang_territory.toStdString()));\n+    return lang_territory;\n+}\n+\n /** Set up translations */\n static void initTranslations(QTranslator &qtTranslatorBase, QTranslator &qtTranslator, QTranslator &translatorBase, QTranslator &translator)\n {\n-    QSettings settings;\n \n     // Remove old translators\n     QApplication::removeTranslator(&qtTranslatorBase);\n@@ -102,13 +116,7 @@ static void initTranslations(QTranslator &qtTranslatorBase, QTranslator &qtTrans\n \n     // Get desired locale (e.g. \"de_DE\")\n     // 1) System default language\n-    QString lang_territory = QLocale::system().name();\n-    // 2) Language from QSettings\n-    QString lang_territory_qsettings = settings.value(\"language\", \"\").toString();\n-    if(!lang_territory_qsettings.isEmpty())\n-        lang_territory = lang_territory_qsettings;\n-    // 3) -lang command line argument\n-    lang_territory = QString::fromStdString(GetArg(\"-lang\", lang_territory.toStdString()));\n+    QString lang_territory = GetLangTerritory();\n \n     // Convert to \"de\" only by truncating \"_DE\"\n     QString lang = lang_territory;\n@@ -498,8 +506,6 @@ int main(int argc, char *argv[])\n     Q_INIT_RESOURCE(bitcoin);\n     Q_INIT_RESOURCE(bitcoin_locale);\n \n-    GUIUtil::SubstituteFonts();\n-\n     BitcoinApplication app(argc, argv);\n #if QT_VERSION > 0x050100\n     // Generate high-dpi pixmaps\n@@ -521,6 +527,7 @@ int main(int argc, char *argv[])\n     QApplication::setOrganizationName(QAPP_ORG_NAME);\n     QApplication::setOrganizationDomain(QAPP_ORG_DOMAIN);\n     QApplication::setApplicationName(QAPP_APP_NAME_DEFAULT);\n+    GUIUtil::SubstituteFonts(GetLangTerritory());\n \n     /// 4. Initialization of translations, so that intro dialog is in user's language\n     // Now that QSettings are accessible, initialize translations"
      },
      {
        "sha": "b57025857e7b3a5390d6189be348a0fc84d03ecc",
        "filename": "src/qt/guiutil.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f5ad78b34af8f50e12fab63b331768b96ec2c779/src/qt/guiutil.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f5ad78b34af8f50e12fab63b331768b96ec2c779/src/qt/guiutil.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/guiutil.cpp?ref=f5ad78b34af8f50e12fab63b331768b96ec2c779",
        "patch": "@@ -383,7 +383,7 @@ void openDebugLogfile()\n         QDesktopServices::openUrl(QUrl::fromLocalFile(boostPathToQString(pathDebug)));\n }\n \n-void SubstituteFonts()\n+void SubstituteFonts(const QString& language)\n {\n #if defined(Q_OS_MAC)\n // Background:"
      },
      {
        "sha": "bcbb540c37e4f20cc1dfe9f755b1b3e4bc510c02",
        "filename": "src/qt/guiutil.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f5ad78b34af8f50e12fab63b331768b96ec2c779/src/qt/guiutil.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f5ad78b34af8f50e12fab63b331768b96ec2c779/src/qt/guiutil.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/guiutil.h?ref=f5ad78b34af8f50e12fab63b331768b96ec2c779",
        "patch": "@@ -107,7 +107,7 @@ namespace GUIUtil\n     void openDebugLogfile();\n \n     // Replace invalid default fonts with known good ones\n-    void SubstituteFonts();\n+    void SubstituteFonts(const QString& language);\n \n     /** Qt event filter that intercepts ToolTipChange events, and replaces the tooltip with a rich text\n       representation if needed. This assures that Qt can word-wrap long tooltip messages."
      }
    ]
  },
  {
    "sha": "52954e6efd373c14736237c4c79769bf00f5dfb8",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo1Mjk1NGU2ZWZkMzczYzE0NzM2MjM3YzRjNzk3NjliZjAwZjVkZmI4",
    "commit": {
      "author": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2015-01-14T20:26:40Z"
      },
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2015-01-17T08:31:27Z"
      },
      "message": "qt: fix broken unicode chars on osx 10.10\n\nThe default font changed again.\n\nThe real fix is to compile qt against a >= 10.8 sdk, but this is simple enough\nto backport to 0.10 to avoid having to do that there.\n\nNote: NSAppKitVersionNumber is a double and there's no official value for\nNSAppKitVersionNumber10_10. Since == isn't reliable for doubles, use Apple's\nguidelines for testing versions here:\nhttps://developer.apple.com/library/mac/releasenotes/AppKit/RN-AppKit/\n\nChinese and Japanese fonts have been hard-coded as well, otherwise they fail to\nshow up at all.",
      "tree": {
        "sha": "20e9b71b88bb85c2c223a17dcc83da5b688fe710",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/20e9b71b88bb85c2c223a17dcc83da5b688fe710"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/52954e6efd373c14736237c4c79769bf00f5dfb8",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/52954e6efd373c14736237c4c79769bf00f5dfb8",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/52954e6efd373c14736237c4c79769bf00f5dfb8",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/52954e6efd373c14736237c4c79769bf00f5dfb8/comments",
    "author": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "f5ad78b34af8f50e12fab63b331768b96ec2c779",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f5ad78b34af8f50e12fab63b331768b96ec2c779",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/f5ad78b34af8f50e12fab63b331768b96ec2c779"
      }
    ],
    "stats": {
      "total": 23,
      "additions": 21,
      "deletions": 2
    },
    "files": [
      {
        "sha": "8ad9b30624b60267714efdeefe5189ad88de605a",
        "filename": "src/qt/guiutil.cpp",
        "status": "modified",
        "additions": 21,
        "deletions": 2,
        "changes": 23,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/52954e6efd373c14736237c4c79769bf00f5dfb8/src/qt/guiutil.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/52954e6efd373c14736237c4c79769bf00f5dfb8/src/qt/guiutil.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/guiutil.cpp?ref=52954e6efd373c14736237c4c79769bf00f5dfb8",
        "patch": "@@ -67,6 +67,9 @@ static boost::filesystem::detail::utf8_codecvt_facet utf8;\n \n #if defined(Q_OS_MAC)\n extern double NSAppKitVersionNumber;\n+#if !defined(NSAppKitVersionNumber10_8)\n+#define NSAppKitVersionNumber10_8 1187\n+#endif\n #if !defined(NSAppKitVersionNumber10_9)\n #define NSAppKitVersionNumber10_9 1265\n #endif\n@@ -393,12 +396,28 @@ void SubstituteFonts(const QString& language)\n // If this fallback is not properly loaded, some characters may fail to\n // render correctly.\n //\n+// The same thing happened with 10.10. .Helvetica Neue DeskInterface is now default.\n+//\n // Solution: If building with the 10.7 SDK or lower and the user's platform\n // is 10.9 or higher at runtime, substitute the correct font. This needs to\n // happen before the QApplication is created.\n #if defined(MAC_OS_X_VERSION_MAX_ALLOWED) && MAC_OS_X_VERSION_MAX_ALLOWED < MAC_OS_X_VERSION_10_8\n-    if (floor(NSAppKitVersionNumber) >= NSAppKitVersionNumber10_9)\n-        QFont::insertSubstitution(\".Lucida Grande UI\", \"Lucida Grande\");\n+    if (floor(NSAppKitVersionNumber) > NSAppKitVersionNumber10_8)\n+    {\n+        if (floor(NSAppKitVersionNumber) <= NSAppKitVersionNumber10_9)\n+            /* On a 10.9 - 10.9.x system */\n+            QFont::insertSubstitution(\".Lucida Grande UI\", \"Lucida Grande\");\n+        else\n+        {\n+            /* 10.10 or later system */\n+            if (language == \"zh_CN\" || language == \"zh_TW\" || language == \"zh_HK\") // traditional or simplified Chinese\n+              QFont::insertSubstitution(\".Helvetica Neue DeskInterface\", \"Heiti SC\");\n+            else if (language == \"ja\") // Japanesee\n+              QFont::insertSubstitution(\".Helvetica Neue DeskInterface\", \"Songti SC\");\n+            else\n+              QFont::insertSubstitution(\".Helvetica Neue DeskInterface\", \"Lucida Grande\");\n+        }\n+    }\n #endif\n #endif\n }"
      }
    ]
  },
  {
    "sha": "73cd4edb4f1ff98c20549a609e96fa40834f5e73",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3M2NkNGVkYjRmMWZmOThjMjA1NDlhNjA5ZTk2ZmE0MDgzNGY1ZTcz",
    "commit": {
      "author": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2015-01-16T21:27:12Z"
      },
      "committer": {
        "name": "Cory Fields",
        "email": "cory-nospam-@coryfields.com",
        "date": "2015-01-17T08:31:27Z"
      },
      "message": "qt: avoid hard-coding font names\n\nThey may not contain all necessary characters for a language",
      "tree": {
        "sha": "1f120418e2549434bdc419fd21fe1e2c0163486e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1f120418e2549434bdc419fd21fe1e2c0163486e"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/73cd4edb4f1ff98c20549a609e96fa40834f5e73",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/73cd4edb4f1ff98c20549a609e96fa40834f5e73",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/73cd4edb4f1ff98c20549a609e96fa40834f5e73",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/73cd4edb4f1ff98c20549a609e96fa40834f5e73/comments",
    "author": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "52954e6efd373c14736237c4c79769bf00f5dfb8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/52954e6efd373c14736237c4c79769bf00f5dfb8",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/52954e6efd373c14736237c4c79769bf00f5dfb8"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 1,
      "deletions": 1
    },
    "files": [
      {
        "sha": "e6a7fcaec5db2bfb4a06b2812f35bb9f5719deb9",
        "filename": "src/qt/splashscreen.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/73cd4edb4f1ff98c20549a609e96fa40834f5e73/src/qt/splashscreen.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/73cd4edb4f1ff98c20549a609e96fa40834f5e73/src/qt/splashscreen.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/splashscreen.cpp?ref=73cd4edb4f1ff98c20549a609e96fa40834f5e73",
        "patch": "@@ -42,7 +42,7 @@ SplashScreen::SplashScreen(Qt::WindowFlags f, const NetworkStyle *networkStyle)\n     QString copyrightText   = QChar(0xA9)+QString(\" 2009-%1 \").arg(COPYRIGHT_YEAR) + QString(tr(\"The Bitcoin Core developers\"));\n     QString titleAddText    = networkStyle->getTitleAddText();\n \n-    QString font            = \"Arial\";\n+    QString font            = QApplication::font().toString();\n \n     // create a bitmap according to device pixelratio\n     QSize splashSize(480*devicePixelRatio,320*devicePixelRatio);"
      }
    ]
  }
]