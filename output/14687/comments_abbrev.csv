laanwj,2018-11-12T12:57:20Z,"Looks good to me, but probably needs to be tested by @bitkevin whether it really solves #12754.",https://github.com/bitcoin/bitcoin/pull/14687#issuecomment-437870289,437870289,
mruddy,2018-11-15T13:12:35Z,"> is it possible to enable keepalive globally?\n\nI don't believe it is for Linux or Windows.",https://github.com/bitcoin/bitcoin/pull/14687#issuecomment-439035352,439035352,
promag,2018-11-15T13:15:52Z,"@mruddy thanks, I also don't find evidence that it's possible.",https://github.com/bitcoin/bitcoin/pull/14687#issuecomment-439036235,439036235,
dlogicman,2019-03-13T11:02:23Z,"Tested ACK.\n\nI am running lightningnetwork/lnd in connection with bitcoind on Ubuntu 16.04 and bitcoind dropped the zmq connection always after a few hours (according to output of `ss -panto`). Therefore the status of `synced_to_chain` in lnd switched to `false`.\n\nTo resolve this problem I included this patch into `zmqpublishnotifier.cpp` on top of bitcoind 0.17.1 *and* lowered the tcp_kee",https://github.com/bitcoin/bitcoin/pull/14687#issuecomment-472376878,472376878,
mruddy,2019-03-13T17:34:20Z,"@dlogemann thanks for testing!\n\nI am still happy with this patch as well. I think it's ready to merge.",https://github.com/bitcoin/bitcoin/pull/14687#issuecomment-472527761,472527761,
dannybabbev,2019-05-01T03:53:06Z,"Hi, when will this PR be merged?",https://github.com/bitcoin/bitcoin/pull/14687#issuecomment-488205276,488205276,
jonasschnelli,2019-05-02T08:28:31Z,Needs more review.,https://github.com/bitcoin/bitcoin/pull/14687#issuecomment-488590020,488590020,
DrahtBot,2019-08-16T13:49:03Z,"<!--5d09a71f8925f3f132321140b44b946d-->The last travis run for this pull request was 273 days ago and is thus outdated. To trigger a fresh travis build, this pull request should be closed and re-opened.",https://github.com/bitcoin/bitcoin/pull/14687#issuecomment-522015213,522015213,
Haaroon,2019-12-03T14:14:59Z,So this was never added? Cause there are still issues with zmq and lnd. ,https://github.com/bitcoin/bitcoin/pull/14687#issuecomment-561185936,561185936,
laanwj,2019-12-03T15:14:35Z,"> So this was never added? Cause there are still issues with zmq and lnd. \n\nso help review and test this PR, and post an ACK",https://github.com/bitcoin/bitcoin/pull/14687#issuecomment-561212324,561212324,
Haaroon,2019-12-04T11:37:07Z,"I've cherry picked this up into the latest bitcoind version, been running it for the past 15 hours. So far its working great. My lnd node has stayed synced to the network, channels have been opened and persisted fine. The actual zmq code base changes are minimal so seems ok to be pushed into master. However I've only tested this on ubuntu. ",https://github.com/bitcoin/bitcoin/pull/14687#issuecomment-561606350,561606350,
n-thumann,2020-04-23T11:36:25Z,Tested ACK: Works as expected (sends TCP Keepalive packets every `net.ipv4.tcp_keepalive_time` seconds). I¬¥ve tested on Debian Buster by subscribing with `contrib/zmq/zmq_sub.py` from another server and not sending anything for seven hours behind the NATed connection üëç ,https://github.com/bitcoin/bitcoin/pull/14687#issuecomment-618351031,618351031,
mruddy,2020-05-05T12:09:23Z,"Just adding some notes from my testing with Windows 10 Home Version 1909 OS build 18363.418 that was downloaded from https://www.microsoft.com/en-us/software-download/windows10ISO\n\n```\nsha256sum Win10_1909_English_x64.iso\n01bf1eb643f7e50d0438f4f74fb91468d35cde2c82b07abc1390d47fc6a356be Win10_1909_English_x64.iso\n```\n\nI cross-compiled using the directions at https://github.com/bitcoin",https://github.com/bitcoin/bitcoin/pull/14687#issuecomment-624017131,624017131,
adamjonas,2020-06-17T17:16:10Z,"Just to summarize for those looking to review - as of c276df775914e4e42993c76e172ef159e3b830d4 there are 3 tACKs (n-thumann, Haaroon, and dlogemann), 1 ""looks good to me"" (laanwj) with no NACKs or any show-stopping concerns raised.",https://github.com/bitcoin/bitcoin/pull/14687#issuecomment-645506755,645506755,
adaminsky,2020-08-08T00:29:36Z,"I also cherry picked the changes into the current master branch and tested on macOS 10.15.5. I started bitcoind on regtest and used `python3 contrib/zmq/zmq_sub.py` to subscribe. I changed the keepalive time to one second with `sudo sysctl -w net.inet.tcp.keepidle=1000` and was able to observe with `tcpdump` the keepalive packets every second.\n\nAlso, @adamjonas, I think you mean there were 3 t",https://github.com/bitcoin/bitcoin/pull/14687#issuecomment-670795311,670795311,
adamjonas,2020-08-08T13:14:31Z,@adaminsky updated my previous comment to correct my error. Thanks.,https://github.com/bitcoin/bitcoin/pull/14687#issuecomment-670927854,670927854,
instagibbs,2020-09-02T02:28:05Z,"I think this is ready for merge, unless I'm missing some controversy. ",https://github.com/bitcoin/bitcoin/pull/14687#issuecomment-685247620,685247620,
practicalswift,2018-11-09T10:31:55Z,"""connectivity"" :-)",https://github.com/bitcoin/bitcoin/pull/14687#discussion_r232207812,232207812,doc/zmq.md
mruddy,2018-11-09T11:13:32Z,"fixed, thanks :-)",https://github.com/bitcoin/bitcoin/pull/14687#discussion_r232219699,232219699,doc/zmq.md
promag,2018-11-15T11:30:35Z,"nit, `{` here.",https://github.com/bitcoin/bitcoin/pull/14687#discussion_r233807010,233807010,src/zmq/zmqpublishnotifier.cpp
promag,2018-11-15T11:52:53Z,"Does it make sense to support setting per socket? I mean, allow custom `ZMQ_TCP_KEEPALIVE_IDLE`?",https://github.com/bitcoin/bitcoin/pull/14687#discussion_r233813321,233813321,doc/zmq.md
mruddy,2018-11-15T13:18:47Z,updated the formatting here to be on the same line. i had to force myself to do it because that's what the dev notes say to do. but it was hard because so much of the zmq code is of the other style :),https://github.com/bitcoin/bitcoin/pull/14687#discussion_r233836873,233836873,src/zmq/zmqpublishnotifier.cpp
mruddy,2018-11-15T13:24:53Z,"The best reason that I could think of to support my stance of not wanting to add the extra options, besides adding complexity and configuration bloat, is that these timeouts are environmental and so it seems like once you figure them out, it's best to just set an appropriate value at the system level. This does assume that you're not making these ZMQ connections to a bunch of other external-party ",https://github.com/bitcoin/bitcoin/pull/14687#discussion_r233838885,233838885,doc/zmq.md
luke-jr,2018-12-20T05:19:18Z,"Maybe if it fails to set SO_KEEPALIVE, it should still continue with a warning?",https://github.com/bitcoin/bitcoin/pull/14687#discussion_r243158546,243158546,src/zmq/zmqpublishnotifier.cpp
laanwj,2019-01-08T16:12:56Z,"When does this fail?\nIf `SO_KEEPALIVE` is important, I don't think ignoring errors is a good idea. Not everyone continuously monitors the logs, and it might suddenly result in a return of issue #14687.\n",https://github.com/bitcoin/bitcoin/pull/14687#discussion_r246056773,246056773,src/zmq/zmqpublishnotifier.cpp
jgarzik,2019-01-08T17:15:41Z,"FWIW,\n* The kernel only fails SO_KEEPALIVE setsockopt(2) if there is something assert()-level wrong with the socket (invalid file descriptor; fd is closed; fd is not a socket; basic stuff...)\n* zmq_setsockopt() is not a direct wrapper, but close:  the value is stored, and setsockopt(2) is called later in zmq's src/tcp.cpp.\n* zmq_setsockopt() will only return an error if there's something ass",https://github.com/bitcoin/bitcoin/pull/14687#discussion_r246080027,246080027,src/zmq/zmqpublishnotifier.cpp
luke-jr,2019-01-08T19:30:07Z,I would imagine it fails on (perhaps just hypothetical) systems without SO_KEEPALIVE,https://github.com/bitcoin/bitcoin/pull/14687#discussion_r246123119,246123119,src/zmq/zmqpublishnotifier.cpp
jgarzik,2019-01-08T21:18:14Z,zmq will return 0 (success) on systems without SO_KEEPALIVE,https://github.com/bitcoin/bitcoin/pull/14687#discussion_r246154609,246154609,src/zmq/zmqpublishnotifier.cpp
