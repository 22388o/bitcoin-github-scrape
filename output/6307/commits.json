[
  {
    "sha": "62909f68a087e85475b7fbad6d9a3a8873d0c811",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2MjkwOWY2OGEwODdlODU0NzViN2ZiYWQ2ZDlhM2E4ODczZDBjODEx",
    "commit": {
      "author": {
        "name": "Jonas Schnelli",
        "email": "jonas.schnelli@include7.ch",
        "date": "2015-06-19T11:31:33Z"
      },
      "committer": {
        "name": "Jonas Schnelli",
        "email": "jonas.schnelli@include7.ch",
        "date": "2015-06-19T11:31:33Z"
      },
      "message": "fix missing lock in CNode::ClearBanned()",
      "tree": {
        "sha": "dfbac34fcaaaabaf1cad94a08fa48c4f22343c84",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/dfbac34fcaaaabaf1cad94a08fa48c4f22343c84"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/62909f68a087e85475b7fbad6d9a3a8873d0c811",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/62909f68a087e85475b7fbad6d9a3a8873d0c811",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/62909f68a087e85475b7fbad6d9a3a8873d0c811",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/62909f68a087e85475b7fbad6d9a3a8873d0c811/comments",
    "author": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "40400d53d3a0f5a11907fba610adabbe0975c9db",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/40400d53d3a0f5a11907fba610adabbe0975c9db",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/40400d53d3a0f5a11907fba610adabbe0975c9db"
      }
    ],
    "stats": {
      "total": 1,
      "additions": 1,
      "deletions": 0
    },
    "files": [
      {
        "sha": "0511256e55b4f2c8667658a5f978f471a1d4cafe",
        "filename": "src/net.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/62909f68a087e85475b7fbad6d9a3a8873d0c811/src/net.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/62909f68a087e85475b7fbad6d9a3a8873d0c811/src/net.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.cpp?ref=62909f68a087e85475b7fbad6d9a3a8873d0c811",
        "patch": "@@ -448,6 +448,7 @@ CCriticalSection CNode::cs_setBanned;\n \n void CNode::ClearBanned()\n {\n+    LOCK(cs_setBanned);\n     setBanned.clear();\n }\n "
      }
    ]
  },
  {
    "sha": "932687bc105904e27ee120be95d2c9f1660ecdfa",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo5MzI2ODdiYzEwNTkwNGUyN2VlMTIwYmU5NWQyYzlmMTY2MGVjZGZh",
    "commit": {
      "author": {
        "name": "Jonas Schnelli",
        "email": "jonas.schnelli@include7.ch",
        "date": "2015-06-19T11:51:42Z"
      },
      "committer": {
        "name": "Jonas Schnelli",
        "email": "jonas.schnelli@include7.ch",
        "date": "2015-06-19T11:51:42Z"
      },
      "message": "setban: add IPv6 tests",
      "tree": {
        "sha": "b1f65703b93f1ab14c6bcdaf518731afee9a6c47",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b1f65703b93f1ab14c6bcdaf518731afee9a6c47"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/932687bc105904e27ee120be95d2c9f1660ecdfa",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/932687bc105904e27ee120be95d2c9f1660ecdfa",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/932687bc105904e27ee120be95d2c9f1660ecdfa",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/932687bc105904e27ee120be95d2c9f1660ecdfa/comments",
    "author": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "62909f68a087e85475b7fbad6d9a3a8873d0c811",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/62909f68a087e85475b7fbad6d9a3a8873d0c811",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/62909f68a087e85475b7fbad6d9a3a8873d0c811"
      }
    ],
    "stats": {
      "total": 27,
      "additions": 27,
      "deletions": 0
    },
    "files": [
      {
        "sha": "c38df0ecf3aedca4322deca05c8a2790554eb5b1",
        "filename": "src/test/rpc_tests.cpp",
        "status": "modified",
        "additions": 27,
        "deletions": 0,
        "changes": 27,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/932687bc105904e27ee120be95d2c9f1660ecdfa/src/test/rpc_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/932687bc105904e27ee120be95d2c9f1660ecdfa/src/test/rpc_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/rpc_tests.cpp?ref=932687bc105904e27ee120be95d2c9f1660ecdfa",
        "patch": "@@ -231,6 +231,33 @@ BOOST_AUTO_TEST_CASE(rpc_ban)\n     BOOST_CHECK_NO_THROW(r = CallRPC(string(\"listbanned\")));\n     ar = r.get_array();\n     BOOST_CHECK_EQUAL(ar.size(), 0);\n+\n+\n+    BOOST_CHECK_THROW(r = CallRPC(string(\"setban test add\")), runtime_error); //invalid IP\n+\n+    //IPv6 tests\n+    BOOST_CHECK_NO_THROW(r = CallRPC(string(\"setban FE80:0000:0000:0000:0202:B3FF:FE1E:8329 add\")));\n+    BOOST_CHECK_NO_THROW(r = CallRPC(string(\"listbanned\")));\n+    ar = r.get_array();\n+    o1 = ar[0].get_obj();\n+    adr = find_value(o1, \"address\");\n+    BOOST_CHECK_EQUAL(adr.get_str(), \"fe80::202:b3ff:fe1e:8329/ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff\");\n+\n+    BOOST_CHECK_NO_THROW(CallRPC(string(\"clearbanned\")));\n+    BOOST_CHECK_NO_THROW(r = CallRPC(string(\"setban 2001:db8::/30 add\")));\n+    BOOST_CHECK_NO_THROW(r = CallRPC(string(\"listbanned\")));\n+    ar = r.get_array();\n+    o1 = ar[0].get_obj();\n+    adr = find_value(o1, \"address\");\n+    BOOST_CHECK_EQUAL(adr.get_str(), \"2001:db8::/ffff:fffc:0:0:0:0:0:0\");\n+\n+    BOOST_CHECK_NO_THROW(CallRPC(string(\"clearbanned\")));\n+    BOOST_CHECK_NO_THROW(r = CallRPC(string(\"setban 2001:4d48:ac57:400:cacf:e9ff:fe1d:9c63/128 add\")));\n+    BOOST_CHECK_NO_THROW(r = CallRPC(string(\"listbanned\")));\n+    ar = r.get_array();\n+    o1 = ar[0].get_obj();\n+    adr = find_value(o1, \"address\");\n+    BOOST_CHECK_EQUAL(adr.get_str(), \"2001:4d48:ac57:400:cacf:e9ff:fe1d:9c63/ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff\");\n }\n \n BOOST_AUTO_TEST_SUITE_END()"
      }
    ]
  },
  {
    "sha": "1c043d567230d639fa86afb96575689bfc8abdcd",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxYzA0M2Q1NjcyMzBkNjM5ZmE4NmFmYjk2NTc1Njg5YmZjOGFiZGNk",
    "commit": {
      "author": {
        "name": "Jonas Schnelli",
        "email": "jonas.schnelli@include7.ch",
        "date": "2015-06-19T14:32:22Z"
      },
      "committer": {
        "name": "Jonas Schnelli",
        "email": "jonas.schnelli@include7.ch",
        "date": "2015-06-19T14:32:22Z"
      },
      "message": "fix lock issue for QT node diconnect and RPC disconnectnode",
      "tree": {
        "sha": "8af62d8454edb480c9f1ade5f0e875bae8d61b02",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/8af62d8454edb480c9f1ade5f0e875bae8d61b02"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1c043d567230d639fa86afb96575689bfc8abdcd",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1c043d567230d639fa86afb96575689bfc8abdcd",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/1c043d567230d639fa86afb96575689bfc8abdcd",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1c043d567230d639fa86afb96575689bfc8abdcd/comments",
    "author": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "932687bc105904e27ee120be95d2c9f1660ecdfa",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/932687bc105904e27ee120be95d2c9f1660ecdfa",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/932687bc105904e27ee120be95d2c9f1660ecdfa"
      }
    ],
    "stats": {
      "total": 6,
      "additions": 3,
      "deletions": 3
    },
    "files": [
      {
        "sha": "f828ce25344fa9763fb1a359f32b6045411de527",
        "filename": "src/qt/rpcconsole.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1c043d567230d639fa86afb96575689bfc8abdcd/src/qt/rpcconsole.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1c043d567230d639fa86afb96575689bfc8abdcd/src/qt/rpcconsole.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/rpcconsole.cpp?ref=1c043d567230d639fa86afb96575689bfc8abdcd",
        "patch": "@@ -687,7 +687,7 @@ void RPCConsole::disconnectSelectedNode()\n     QString strNode = GUIUtil::getEntryData(ui->peerWidget, 0, PeerTableModel::Address);\n     // Find the node, disconnect it and clear the selected node\n     if (CNode *bannedNode = FindNode(strNode.toStdString())) {\n-        bannedNode->CloseSocketDisconnect();\n+        bannedNode->fDisconnect = true;\n         clearSelectedNode();\n     }\n }"
      },
      {
        "sha": "1572b16687095000cd7102716acc4dda90a857c7",
        "filename": "src/rpcnet.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1c043d567230d639fa86afb96575689bfc8abdcd/src/rpcnet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1c043d567230d639fa86afb96575689bfc8abdcd/src/rpcnet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpcnet.cpp?ref=1c043d567230d639fa86afb96575689bfc8abdcd",
        "patch": "@@ -231,7 +231,7 @@ UniValue disconnectnode(const UniValue& params, bool fHelp)\n     if (pNode == NULL)\n         throw JSONRPCError(RPC_CLIENT_NODE_NOT_CONNECTED, \"Node not found in connected nodes\");\n \n-    pNode->CloseSocketDisconnect();\n+    pNode->fDisconnect = true;\n \n     return NullUniValue;\n }\n@@ -519,7 +519,7 @@ UniValue setban(const UniValue& params, bool fHelp)\n \n         //disconnect possible nodes\n         while(CNode *bannedNode = (isSubnet ? FindNode(subNet) : FindNode(netAddr)))\n-            bannedNode->CloseSocketDisconnect();\n+            bannedNode->fDisconnect = true;\n     }\n     else if(strCommand == \"remove\")\n     {"
      }
    ]
  }
]