[
  {
    "sha": "e4c8c396324afdbe260468e89e5b4f782903d3ea",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplNGM4YzM5NjMyNGFmZGJlMjYwNDY4ZTg5ZTViNGY3ODI5MDNkM2Vh",
    "commit": {
      "author": {
        "name": "Daniel Edgecumbe",
        "email": "esotericnonsense@danedgecumbe.com",
        "date": "2017-09-07T00:52:17Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2018-11-03T19:00:14Z"
      },
      "message": "RPC: add weight to mempool entry output",
      "tree": {
        "sha": "48a0d3c301d62776bf044eabcae69e286172baeb",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/48a0d3c301d62776bf044eabcae69e286172baeb"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e4c8c396324afdbe260468e89e5b4f782903d3ea",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e4c8c396324afdbe260468e89e5b4f782903d3ea",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/e4c8c396324afdbe260468e89e5b4f782903d3ea",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e4c8c396324afdbe260468e89e5b4f782903d3ea/comments",
    "author": {
      "login": "esotericnonsense",
      "id": 7999704,
      "node_id": "MDQ6VXNlcjc5OTk3MDQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7999704?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/esotericnonsense",
      "html_url": "https://github.com/esotericnonsense",
      "followers_url": "https://api.github.com/users/esotericnonsense/followers",
      "following_url": "https://api.github.com/users/esotericnonsense/following{/other_user}",
      "gists_url": "https://api.github.com/users/esotericnonsense/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/esotericnonsense/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/esotericnonsense/subscriptions",
      "organizations_url": "https://api.github.com/users/esotericnonsense/orgs",
      "repos_url": "https://api.github.com/users/esotericnonsense/repos",
      "events_url": "https://api.github.com/users/esotericnonsense/events{/privacy}",
      "received_events_url": "https://api.github.com/users/esotericnonsense/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "8a9ffec0a257da659ba54c5073bfc820986ae9c1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/8a9ffec0a257da659ba54c5073bfc820986ae9c1",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/8a9ffec0a257da659ba54c5073bfc820986ae9c1"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 2,
      "deletions": 0
    },
    "files": [
      {
        "sha": "96f99897cc2ae0c1cac04c618be90a4417023d5c",
        "filename": "src/rpc/blockchain.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e4c8c396324afdbe260468e89e5b4f782903d3ea/src/rpc/blockchain.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e4c8c396324afdbe260468e89e5b4f782903d3ea/src/rpc/blockchain.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/blockchain.cpp?ref=e4c8c396324afdbe260468e89e5b4f782903d3ea",
        "patch": "@@ -357,6 +357,7 @@ static UniValue getdifficulty(const JSONRPCRequest& request)\n static std::string EntryDescriptionString()\n {\n     return \"    \\\"size\\\" : n,             (numeric) virtual transaction size as defined in BIP 141. This is different from actual serialized size for witness transactions as witness data is discounted.\\n\"\n+           \"    \\\"weight\\\" : n,           (numeric) transaction weight as defined in BIP 141.\\n\"\n            \"    \\\"fee\\\" : n,              (numeric) transaction fee in \" + CURRENCY_UNIT + \" (DEPRECATED)\\n\"\n            \"    \\\"modifiedfee\\\" : n,      (numeric) transaction fee with fee deltas used for mining priority (DEPRECATED)\\n\"\n            \"    \\\"time\\\" : n,             (numeric) local time transaction entered pool in seconds since 1 Jan 1970 GMT\\n\"\n@@ -394,6 +395,7 @@ static void entryToJSON(UniValue &info, const CTxMemPoolEntry &e) EXCLUSIVE_LOCK\n     info.pushKV(\"fees\", fees);\n \n     info.pushKV(\"size\", (int)e.GetTxSize());\n+    info.pushKV(\"weight\", (int)e.GetTxWeight());\n     info.pushKV(\"fee\", ValueFromAmount(e.GetFee()));\n     info.pushKV(\"modifiedfee\", ValueFromAmount(e.GetModifiedFee()));\n     info.pushKV(\"time\", e.GetTime());"
      }
    ]
  },
  {
    "sha": "a250df16024632dae902a6cf0ac3e2a8afaa4cc8",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphMjUwZGYxNjAyNDYzMmRhZTkwMmE2Y2YwYWMzZTJhOGFmYWE0Y2M4",
    "commit": {
      "author": {
        "name": "Daniel Edgecumbe",
        "email": "esotericnonsense@danedgecumbe.com",
        "date": "2017-09-08T19:20:00Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2018-11-03T19:36:25Z"
      },
      "message": "qa: Add RPC tests for weight in mempool entry",
      "tree": {
        "sha": "efb72345c50caa60a0feb410fe44c2aeec067b8d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/efb72345c50caa60a0feb410fe44c2aeec067b8d"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a250df16024632dae902a6cf0ac3e2a8afaa4cc8",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a250df16024632dae902a6cf0ac3e2a8afaa4cc8",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/a250df16024632dae902a6cf0ac3e2a8afaa4cc8",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a250df16024632dae902a6cf0ac3e2a8afaa4cc8/comments",
    "author": {
      "login": "esotericnonsense",
      "id": 7999704,
      "node_id": "MDQ6VXNlcjc5OTk3MDQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7999704?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/esotericnonsense",
      "html_url": "https://github.com/esotericnonsense",
      "followers_url": "https://api.github.com/users/esotericnonsense/followers",
      "following_url": "https://api.github.com/users/esotericnonsense/following{/other_user}",
      "gists_url": "https://api.github.com/users/esotericnonsense/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/esotericnonsense/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/esotericnonsense/subscriptions",
      "organizations_url": "https://api.github.com/users/esotericnonsense/orgs",
      "repos_url": "https://api.github.com/users/esotericnonsense/repos",
      "events_url": "https://api.github.com/users/esotericnonsense/events{/privacy}",
      "received_events_url": "https://api.github.com/users/esotericnonsense/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "e4c8c396324afdbe260468e89e5b4f782903d3ea",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e4c8c396324afdbe260468e89e5b4f782903d3ea",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/e4c8c396324afdbe260468e89e5b4f782903d3ea"
      }
    ],
    "stats": {
      "total": 15,
      "additions": 15,
      "deletions": 0
    },
    "files": [
      {
        "sha": "990ae3b345a274e87f73363f940b85ffbec44406",
        "filename": "test/functional/feature_segwit.py",
        "status": "modified",
        "additions": 15,
        "deletions": 0,
        "changes": 15,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a250df16024632dae902a6cf0ac3e2a8afaa4cc8/test/functional/feature_segwit.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a250df16024632dae902a6cf0ac3e2a8afaa4cc8/test/functional/feature_segwit.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/feature_segwit.py?ref=a250df16024632dae902a6cf0ac3e2a8afaa4cc8",
        "patch": "@@ -204,6 +204,13 @@ def run_test(self):\n         assert(tx.wit.is_null()) # This should not be a segwit input\n         assert(txid1 in self.nodes[0].getrawmempool())\n \n+        tx1_hex = self.nodes[0].gettransaction(txid1)['hex']\n+        tx1 = FromHex(CTransaction(), tx1_hex)\n+\n+        # Check that weight and size (actually vsize) are properly reported in mempool entry (txid1)\n+        assert_equal(self.nodes[0].getmempoolentry(txid1)[\"size\"], (self.nodes[0].getmempoolentry(txid1)[\"weight\"] + 3) // 4)\n+        assert_equal(self.nodes[0].getmempoolentry(txid1)[\"weight\"], len(tx1.serialize_without_witness())*3 + len(tx1.serialize_with_witness()))\n+\n         # Now create tx2, which will spend from txid1.\n         tx = CTransaction()\n         tx.vin.append(CTxIn(COutPoint(int(txid1, 16), 0), b''))\n@@ -213,6 +220,10 @@ def run_test(self):\n         tx = FromHex(CTransaction(), tx2_hex)\n         assert(not tx.wit.is_null())\n \n+        # Check that weight and size (actually vsize) are properly reported in mempool entry (txid2)\n+        assert_equal(self.nodes[0].getmempoolentry(txid2)[\"size\"], (self.nodes[0].getmempoolentry(txid2)[\"weight\"] + 3) // 4)\n+        assert_equal(self.nodes[0].getmempoolentry(txid2)[\"weight\"], len(tx.serialize_without_witness())*3 + len(tx.serialize_with_witness()))\n+\n         # Now create tx3, which will spend from txid2\n         tx = CTransaction()\n         tx.vin.append(CTxIn(COutPoint(int(txid2, 16), 0), b\"\"))\n@@ -240,6 +251,10 @@ def run_test(self):\n         # Check that wtxid is properly reported in mempool entry\n         assert_equal(int(self.nodes[0].getmempoolentry(txid3)[\"wtxid\"], 16), tx.calc_sha256(True))\n \n+        # Check that weight and size (actually vsize) are properly reported in mempool entry (txid3)\n+        assert_equal(self.nodes[0].getmempoolentry(txid3)[\"size\"], (self.nodes[0].getmempoolentry(txid3)[\"weight\"] + 3) // 4)\n+        assert_equal(self.nodes[0].getmempoolentry(txid3)[\"weight\"], len(tx.serialize_without_witness())*3 + len(tx.serialize_with_witness()))\n+\n         # Mine a block to clear the gbt cache again.\n         self.nodes[0].generate(1)\n "
      }
    ]
  },
  {
    "sha": "092defc216c9fe2a6d32bd670a5f5215c143a48c",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzowOTJkZWZjMjE2YzlmZTJhNmQzMmJkNjcwYTVmNTIxNWMxNDNhNDhj",
    "commit": {
      "author": {
        "name": "Daniel Edgecumbe",
        "email": "esotericnonsense@danedgecumbe.com",
        "date": "2017-09-08T19:20:17Z"
      },
      "committer": {
        "name": "Luke Dashjr",
        "email": "luke-jr+git@utopios.org",
        "date": "2018-11-03T19:36:40Z"
      },
      "message": "qa: Add more RPC tests for wtxid in mempool entry, clarify comment",
      "tree": {
        "sha": "ed8ecf594f4db7074ec4a7626e37e9a67d0b4069",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ed8ecf594f4db7074ec4a7626e37e9a67d0b4069"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/092defc216c9fe2a6d32bd670a5f5215c143a48c",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/092defc216c9fe2a6d32bd670a5f5215c143a48c",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/092defc216c9fe2a6d32bd670a5f5215c143a48c",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/092defc216c9fe2a6d32bd670a5f5215c143a48c/comments",
    "author": {
      "login": "esotericnonsense",
      "id": 7999704,
      "node_id": "MDQ6VXNlcjc5OTk3MDQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7999704?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/esotericnonsense",
      "html_url": "https://github.com/esotericnonsense",
      "followers_url": "https://api.github.com/users/esotericnonsense/followers",
      "following_url": "https://api.github.com/users/esotericnonsense/following{/other_user}",
      "gists_url": "https://api.github.com/users/esotericnonsense/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/esotericnonsense/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/esotericnonsense/subscriptions",
      "organizations_url": "https://api.github.com/users/esotericnonsense/orgs",
      "repos_url": "https://api.github.com/users/esotericnonsense/repos",
      "events_url": "https://api.github.com/users/esotericnonsense/events{/privacy}",
      "received_events_url": "https://api.github.com/users/esotericnonsense/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "a250df16024632dae902a6cf0ac3e2a8afaa4cc8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a250df16024632dae902a6cf0ac3e2a8afaa4cc8",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/a250df16024632dae902a6cf0ac3e2a8afaa4cc8"
      }
    ],
    "stats": {
      "total": 8,
      "additions": 7,
      "deletions": 1
    },
    "files": [
      {
        "sha": "92ebcb16988b573a6bea999628648cdef6767c1c",
        "filename": "test/functional/feature_segwit.py",
        "status": "modified",
        "additions": 7,
        "deletions": 1,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/092defc216c9fe2a6d32bd670a5f5215c143a48c/test/functional/feature_segwit.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/092defc216c9fe2a6d32bd670a5f5215c143a48c/test/functional/feature_segwit.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/feature_segwit.py?ref=092defc216c9fe2a6d32bd670a5f5215c143a48c",
        "patch": "@@ -207,6 +207,9 @@ def run_test(self):\n         tx1_hex = self.nodes[0].gettransaction(txid1)['hex']\n         tx1 = FromHex(CTransaction(), tx1_hex)\n \n+        # Check that wtxid is properly reported in mempool entry (txid1)\n+        assert_equal(int(self.nodes[0].getmempoolentry(txid1)[\"wtxid\"], 16), tx1.calc_sha256(True))\n+\n         # Check that weight and size (actually vsize) are properly reported in mempool entry (txid1)\n         assert_equal(self.nodes[0].getmempoolentry(txid1)[\"size\"], (self.nodes[0].getmempoolentry(txid1)[\"weight\"] + 3) // 4)\n         assert_equal(self.nodes[0].getmempoolentry(txid1)[\"weight\"], len(tx1.serialize_without_witness())*3 + len(tx1.serialize_with_witness()))\n@@ -220,6 +223,9 @@ def run_test(self):\n         tx = FromHex(CTransaction(), tx2_hex)\n         assert(not tx.wit.is_null())\n \n+        # Check that wtxid is properly reported in mempool entry (txid2)\n+        assert_equal(int(self.nodes[0].getmempoolentry(txid2)[\"wtxid\"], 16), tx.calc_sha256(True))\n+\n         # Check that weight and size (actually vsize) are properly reported in mempool entry (txid2)\n         assert_equal(self.nodes[0].getmempoolentry(txid2)[\"size\"], (self.nodes[0].getmempoolentry(txid2)[\"weight\"] + 3) // 4)\n         assert_equal(self.nodes[0].getmempoolentry(txid2)[\"weight\"], len(tx.serialize_without_witness())*3 + len(tx.serialize_with_witness()))\n@@ -248,7 +254,7 @@ def run_test(self):\n         assert(txid2 in template_txids)\n         assert(txid3 in template_txids)\n \n-        # Check that wtxid is properly reported in mempool entry\n+        # Check that wtxid is properly reported in mempool entry (txid3)\n         assert_equal(int(self.nodes[0].getmempoolentry(txid3)[\"wtxid\"], 16), tx.calc_sha256(True))\n \n         # Check that weight and size (actually vsize) are properly reported in mempool entry (txid3)"
      }
    ]
  }
]