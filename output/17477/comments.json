[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/553963425",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#issuecomment-553963425",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17477",
    "id": 553963425,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1Mzk2MzQyNQ==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-14T16:21:51Z",
    "updated_at": "2019-11-14T16:23:30Z",
    "author_association": "MEMBER",
    "body": "Request review from @TheBlueMatt and @morcos\r\n\r\n@TheBlueMatt - you introduced the vtxConflicted vector in BlockConnected in 461e49fee2935b1eb4d4ea7bae3023e655c0a6d8 with comment 'This change adds a parameter to BlockConnectedDisconnected which lists the transactions which were removed from mempool due to confliction as a result of this operation. While its somewhat of a shame to make block-validation-logic generate a list of mempool changes to be included in its generated callbacks, fixing this isnt too hard.'\r\n\r\n@morcos - you attempted something similar in #9240",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/553963425/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/554037194",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#issuecomment-554037194",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17477",
    "id": 554037194,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NDAzNzE5NA==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-14T19:16:22Z",
    "updated_at": "2020-03-10T23:52:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #18278 (interfaces: Describe and follow some code conventions by ryanofsky)\n* #17443 (Drop checkFinalTx and use Median Time Past to check finality of wallet transactions by ariard)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/554037194/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/554041672",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#issuecomment-554041672",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17477",
    "id": 554041672,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NDA0MTY3Mg==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-14T19:27:41Z",
    "updated_at": "2019-11-14T19:27:41Z",
    "author_association": "MEMBER",
    "body": "Note that this can change the order of notifications for the wallet. If the node connects block A with conflicted txs a1 a2 and block B with conflicted txs b1 and b2 in one ActivateBestChainStep, the old ordering would be:\r\n\r\n- BlockConnected(A(conflicted=[a1,a2]))\r\n- BlockConnected(B(conflivted=[b1,b2]))\r\n\r\nand the new ordering is:\r\n\r\n- TransactionRemovedFromMempool(a1)\r\n- TransactionRemovedFromMempool(a2)\r\n- TransactionRemovedFromMempool(b1)\r\n- TransactionRemovedFromMempool(b2)\r\n- BlockConnected(A)\r\n- BlockConnected(B)\r\n\r\nI'm pretty sure that's not a problem. Take a look at how the wallet currently handles conflicted transactions in the `BlockConnected()` callback:\r\n\r\nhttps://github.com/bitcoin/bitcoin/blob/cd6cb9745e13a62e130b11f78a13bcc1d424b05e/src/wallet/wallet.cpp#L1084\r\n\r\nAll the `TransactionRemovedFromMempool` does is toggle the `fInMempool` flag to false. ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/554041672/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/554046319",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#issuecomment-554046319",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17477",
    "id": 554046319,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NDA0NjMxOQ==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-14T19:39:21Z",
    "updated_at": "2019-11-14T19:39:21Z",
    "author_association": "MEMBER",
    "body": "> I'm pretty sure that's not a problem\r\n\r\nAre you sure about that? Note that change that is unconfirmed and not in the mempool is not counted toward our balance, so this would open up race conditions where a `send*` might fail when there is no reason for it to fail.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/554046319/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/554184168",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#issuecomment-554184168",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17477",
    "id": 554184168,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NDE4NDE2OA==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-15T02:38:54Z",
    "updated_at": "2019-11-15T02:38:54Z",
    "author_association": "MEMBER",
    "body": "> this would open up race conditions where a send* might fail when there is no reason for it to fail.\r\n\r\nI don't think that's true:\r\n\r\n- Before this change: conflicted transactions are marked as not in the mempool when the wallet hears about them in a `BlockConnected`'s `vtxConflicted` vector.\r\n- After this change: conflicted transactions are marked as not in the mempool slightly earlier when the wallet hears about them in a `TransactionRemovedFromMempool` callback.\r\n\r\nIn both of those cases, the change output is unspendable because it conflicts with a transaction included in the block, but in the current code the wallet doesn't know about it until slightly later. So arguably there's a window condition in the existing code where the wallet might try to spend change that it thinks is in the mempool, but is actually conflicted with the latest block (although in practice this doesn't matter - it's always the case that there might be a better block that conflicts our transactions that we just don't know about yet).\r\n\r\n(If this PR was changing the way we notify the wallet about transactions removed from the mempool because they're included in a block, then I'd agree with you. We don't want to introduce a window where the wallet knows the transaction is no longer in the mempool but doesn't yet know that it's in a block.)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/554184168/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/554358670",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#issuecomment-554358670",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17477",
    "id": 554358670,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NDM1ODY3MA==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-15T13:29:36Z",
    "updated_at": "2019-11-15T13:29:36Z",
    "author_association": "MEMBER",
    "body": "> So arguably there's a window condition in the existing code where the wallet might try to spend change that it thinks is in the mempool, but is actually conflicted with the latest block (although in practice this doesn't matter - it's always the case that there might be a better block that conflicts our transactions that we just don't know about yet).\r\n\r\nWhat if the user set min_conf to 1000 and rbf to false for that tx that spends the change that is only available for a short time erroneously? With those settings, the user should expect to create a transaction that could never possibly fail, no?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/554358670/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/554365732",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#issuecomment-554365732",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17477",
    "id": 554365732,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NDM2NTczMg==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-15T13:51:20Z",
    "updated_at": "2019-11-15T13:51:20Z",
    "author_association": "MEMBER",
    "body": "> What if the user set min_conf to 1000 and rbf to false for that tx that spends the change that is only available for a short time erroneously? With those settings, the user should expect to create a transaction that could never possibly fail, no?\r\n\r\nMaybe I don't fully understand the scenario you're describing, but if the tx is spending change that has been conflicted out of the mempool but the wallet has not yet been notified then that transaction will definitely fail, since it's spending an output that doesn't exist in the main chain.\r\n\r\nEssentially, the difference for the wallet in this PR is that it'll get notified slightly earlier about transactions (and therefore possibly unconfirmed change outputs that it owns) that have been conflicted out of the mempool slightly before it is notified about the block that conflicts them. I can't think of any way that would cause windows of undesirable behaviour.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/554365732/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/554535859",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#issuecomment-554535859",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17477",
    "id": 554535859,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NDUzNTg1OQ==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-15T21:29:42Z",
    "updated_at": "2019-11-15T21:29:42Z",
    "author_association": "MEMBER",
    "body": "@ariard - thanks for the review. I've taken all of your comment suggestions and some of the changes in your branch. I've gone back on changing the `PerBlockConnectTrace` to a `std::pair`. Using `auto` and `std::pair`'s `first` and `second` members makes it difficult to work out what's being done at the call site, so I've just changed `PerBlockConnectTrace` to be a struct with two members and `ConnectTrace` to be a `std::vector`. Take a look and let me know what you think.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/554535859/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/555134603",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#issuecomment-555134603",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17477",
    "id": 555134603,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NTEzNDYwMw==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-18T17:59:20Z",
    "updated_at": "2019-11-18T17:59:20Z",
    "author_association": "MEMBER",
    "body": "@ariard : I think it's possible to actually remove `ConnectTrace` entirely now that it's not necessary to release `cs_main` before firing validation interface signals. Take a look at the branch here: https://github.com/jnewbery/bitcoin/tree/2019-11-remove-connect-trace.\r\n\r\nIf you agree, I'll remove the last two commits from this PR, and then just remove `ConnectTrace` entirely in a follow-up PR.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/555134603/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/557612869",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#issuecomment-557612869",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17477",
    "id": 557612869,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzYxMjg2OQ==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-22T17:04:40Z",
    "updated_at": "2019-11-22T17:04:40Z",
    "author_association": "MEMBER",
    "body": "rebased on master",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/557612869/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/557660785",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#issuecomment-557660785",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17477",
    "id": 557660785,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1NzY2MDc4NQ==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-22T19:23:32Z",
    "updated_at": "2019-11-22T20:42:20Z",
    "author_association": "MEMBER",
    "body": "I've removed the final two commits (which tidied up the `ConnectTrace` class) since I remove that class entirely in PR #17562.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/557660785/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/558323117",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#issuecomment-558323117",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17477",
    "id": 558323117,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1ODMyMzExNw==",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-25T20:18:17Z",
    "updated_at": "2019-11-25T20:18:17Z",
    "author_association": "MEMBER",
    "body": "@jnewbery - your approach is better than the one tried in my aforementioned branch, because you avoid passing back and forth a `std::vector` between `ActivateBestChain`, `ActivateBestChainStep`, `ConnectTip`. Furthermore, it's pretty straightforward on the lock reasoning, given we already do this for `BlockDisconnected` in `DisconnectTip` where we hold `cs_main`",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/558323117/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/558387414",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#issuecomment-558387414",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17477",
    "id": 558387414,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1ODM4NzQxNA==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-25T23:26:10Z",
    "updated_at": "2019-11-25T23:26:10Z",
    "author_association": "MEMBER",
    "body": "Force-pushed a fix for a typo in a commit message. No code change.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/558387414/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/558623499",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#issuecomment-558623499",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17477",
    "id": 558623499,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1ODYyMzQ5OQ==",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?u=4a9af998e1a560b3f49c3827f453e1bcbe6a5cfb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-26T13:17:09Z",
    "updated_at": "2019-11-26T13:17:09Z",
    "author_association": "MEMBER",
    "body": "In master `CWallet::BlockConnected` is \"atomic\" - adds new transactions and updates transaction states and nothing can can \"use\" the wallet in between.\r\n\r\nWith this change \"lots of stuff\" can happen while the wallet state (transactions state really) is updated. So I was checking what can happen and one is: https://github.com/bitcoin/bitcoin/blob/0ee914ba9e5960763c7bb380b566ee481446f97a/src/wallet/wallet.cpp#L1747-L1748\r\n\r\nSo it looks like a transaction can be broadcast again if this runs between `TransactionRemovedFromMempool` and `BlockConnected`. But then I've realised that `BroadcastTransaction` checks this first:\r\nhttps://github.com/bitcoin/bitcoin/blob/0ee914ba9e5960763c7bb380b566ee481446f97a/src/node/transaction.cpp#L28-L38\r\n\r\nSo I think there's no issue in this case.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/558623499/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/558647936",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#issuecomment-558647936",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17477",
    "id": 558647936,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU1ODY0NzkzNg==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-11-26T14:15:21Z",
    "updated_at": "2019-11-26T14:15:21Z",
    "author_association": "MEMBER",
    "body": "> So I think there's no issue in this case.\r\n\r\nI agree, and I think this is similar to Marco's concern earlier and my response: https://github.com/bitcoin/bitcoin/pull/17477#issuecomment-554365732.\r\n\r\nThis PR allows the wallet to be used in a small window between being notified of conflicted transactions from the block and the block itself. However, I don't think it opens any new window conditions in the wallet that don't already exist. Imagine the following scenario in master branch:\r\n\r\n1. a wallet's transaction is removed from the mempool for expiry or size limiting reasons. The wallet is notified via `TransactionRemovedFromMempool`\r\n2. a new block gets mined that contains a transaction that conflicted with the removed transaction and the `BlockConnected` callback is added to the Validation Interface queue (but not fired in the wallet yet)\r\n3. some action happens in the wallet before the `BlockConnected` callback is fired.\r\n\r\nThis is _exactly_ the same behaviour as you describe above, and can already happen in the existing code. The only difference is the mempool removal reason, which is not reported to the wallet.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/558647936/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/573150763",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#issuecomment-573150763",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17477",
    "id": 573150763,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3MzE1MDc2Mw==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-10T18:25:07Z",
    "updated_at": "2020-01-10T18:25:07Z",
    "author_association": "MEMBER",
    "body": "rebased",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/573150763/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577448372",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#issuecomment-577448372",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17477",
    "id": 577448372,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NzQ0ODM3Mg==",
    "user": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?u=348c27f90b6fff8fd72fa27232272651436a2ff0&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-23T00:19:59Z",
    "updated_at": "2020-01-23T00:19:59Z",
    "author_association": "CONTRIBUTOR",
    "body": "Code review ACK 100d5d03f7629e0c4be14239c6c6c3e542c3f34e\r\n\r\nI spent some time thinking about the \"window issue\" and the worst scenario I could come up with is if there are high fees, a full mempool, and we do some automatic RBF-ing, so we replace a tx with a higher fee one immediately if our original is evicted from the Mempool because of low fees. We might try to RBF again although it is already in the block. That's the only scenario I could come up with and it is an edge case with the only bad effect of sending out an RBF tx that gets rejected from every mempool. And fairly easy to prevent on the user side as well. Additionally, developers will be mindful of the window when implementing further changes, but I think that is also not a real argument against the change as it is simplifying things overall.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577448372/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577716934",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#issuecomment-577716934",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17477",
    "id": 577716934,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU3NzcxNjkzNA==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-01-23T14:56:21Z",
    "updated_at": "2020-01-23T14:56:21Z",
    "author_association": "MEMBER",
    "body": "FWIW if anyone is looking at tests, I reverted this change and built\r\n```diff\r\n--- a/src/txmempool.cpp\r\n+++ b/src/txmempool.cpp\r\n@@ -403,7 +403,7 @@ void CTxMemPool::addUnchecked(const CTxMemPoolEntry &entry, setEntries &setAnces\r\n \r\n void CTxMemPool::removeUnchecked(txiter it, MemPoolRemovalReason reason)\r\n {\r\n-    if (reason != MemPoolRemovalReason::BLOCK) {\r\n+    if (reason != MemPoolRemovalReason::BLOCK && reason != MemPoolRemovalReason::CONFLICT) {\r\n         GetMainSignals().TransactionRemovedFromMempool(it->GetSharedTx());\r\n     }\r\n```\r\nand all the unit and functional tests pass except\r\n```\r\n2020-01-23T14:46:58.142000Z TestFramework (INFO): Initializing test directory /dev/shm/bitcoin_func_test_rjrhubgl\r\n2020-01-23T14:46:59.277000Z TestFramework (INFO): Mining blocks...\r\n2020-01-23T14:47:04.035000Z TestFramework (INFO): Running tests\r\n2020-01-23T14:47:16.692000Z TestFramework (ERROR): JSONRPC error\r\nTraceback (most recent call last):\r\n  File \"/home/jon/projects/bitcoin/bitcoin/test/functional/test_framework/test_framework.py\", line 112, in main\r\n    self.run_test()\r\n  File \"test/functional/wallet_bumpfee.py\", line 84, in run_test\r\n    test_unconfirmed_not_spendable(rbf_node, rbf_node_address)\r\n  File \"test/functional/wallet_bumpfee.py\", line 405, in test_unconfirmed_not_spendable\r\n    rbf_node.abandontransaction(bumpid)\r\n  File \"/home/jon/projects/bitcoin/bitcoin/test/functional/test_framework/coverage.py\", line 47, in __call__\r\n    return_val = self.auth_service_proxy_instance.__call__(*args, **kwargs)\r\n  File \"/home/jon/projects/bitcoin/bitcoin/test/functional/test_framework/authproxy.py\", line 141, in __call__\r\n    raise JSONRPCException(response['error'], status)\r\ntest_framework.authproxy.JSONRPCException: Transaction not eligible for abandonment (-5)\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/577716934/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/588401106",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#issuecomment-588401106",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17477",
    "id": 588401106,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU4ODQwMTEwNg==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-02-19T19:23:19Z",
    "updated_at": "2020-02-19T19:23:19Z",
    "author_association": "MEMBER",
    "body": "Rebase, please :)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/588401106/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/594206041",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#issuecomment-594206041",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17477",
    "id": 594206041,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5NDIwNjA0MQ==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-03-03T22:34:00Z",
    "updated_at": "2020-03-03T22:34:00Z",
    "author_association": "MEMBER",
    "body": "Pushed a fix to https://github.com/bitcoin/bitcoin/pull/17477#discussion_r370223948.\r\n\r\nThanks for the re-review @ryanofsky . I intend to address your other comments soon.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/594206041/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/597915505",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#issuecomment-597915505",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17477",
    "id": 597915505,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU5NzkxNTUwNQ==",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2020-03-11T22:40:40Z",
    "updated_at": "2020-03-11T22:40:40Z",
    "author_association": "MEMBER",
    "body": "> It would still be nice to clean up the PR description\r\n\r\n@ryanofsky - done. I've also addressed your inline comment. Let me know what you think.\r\n@kallewoof @fjahr : do you mind rereviewing? It's just a rebase/comment change since your previous ACKs.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/597915505/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346937589",
    "pull_request_review_id": 317770827,
    "id": 346937589,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0NjkzNzU4OQ==",
    "diff_hunk": "@@ -2477,28 +2477,16 @@ struct PerBlockConnectTrace {\n  * Used to track blocks whose transactions were applied to the UTXO state as a\n  * part of a single ActivateBestChainStep call.\n  *\n- * This class also tracks transactions that are removed from the mempool as\n- * conflicts (per block) and can be used to pass all those transactions\n- * through SyncTransaction.\n- *\n- * This class assumes (and asserts) that the conflicted transactions for a given\n- * block are added via mempool callbacks prior to the BlockConnected() associated\n- * with those transactions. If any transactions are marked conflicted, it is\n- * assumed that an associated block will always be added.\n- *\n  * This class is single-use, once you call GetBlocksConnected() you have to throw\n  * it away and make a new one.\n  */\n class ConnectTrace {\n private:\n     std::vector<PerBlockConnectTrace> blocksConnected;\n     CTxMemPool &pool;",
    "path": "src/validation.cpp",
    "position": null,
    "original_position": 19,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "0f17fd9bd5c32eb6c6f4b648f5209f1a223f9e3e",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Commit 0f17fd9. I think after this one CTxMemPool member is no more of any use as it was used by ConnecTrace to connect to mempool signal, can you remove it ?",
    "created_at": "2019-11-15T17:45:09Z",
    "updated_at": "2020-03-11T22:38:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346937589",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346937589"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346937589"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346937589/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2486,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346943451",
    "pull_request_review_id": 317770827,
    "id": 346943451,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0Njk0MzQ1MQ==",
    "diff_hunk": "@@ -92,10 +92,17 @@ class CValidationInterface {\n     /**\n      * Notifies listeners of a transaction leaving mempool.\n      *\n-     * This only fires for transactions which leave mempool because of expiry,\n-     * size limiting, reorg (changes in lock times/coinbase maturity), or\n-     * replacement. This does not include any transactions which are included\n-     * in BlockConnectedDisconnected either in block->vtx or in txnConflicted.\n+     * This notification fires for transactions that are removed from the\n+     * mempool for the following reasons:\n+     *\n+     * - EXPIRY (expired from mempool after -mempoolexpiry hours)\n+     * - SIZELIMIT (removed in size limiting if the mempool exceeds -maxmempool megabytes)\n+     * - REORG (removed during a reorg)",
    "path": "src/validationinterface.h",
    "position": 13,
    "original_position": 13,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "ef6f6ae651b9a9bdbb925b4d7aa46d9ca931d4e7",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: \"removed txn non-final anymore due to a reorg\"",
    "created_at": "2019-11-15T18:00:42Z",
    "updated_at": "2020-03-11T22:38:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346943451",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346943451"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346943451"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346943451/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 100,
    "original_line": 100,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346950264",
    "pull_request_review_id": 317770827,
    "id": 346950264,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0Njk1MDI2NA==",
    "diff_hunk": "@@ -2477,28 +2477,16 @@ struct PerBlockConnectTrace {\n  * Used to track blocks whose transactions were applied to the UTXO state as a\n  * part of a single ActivateBestChainStep call.\n  *\n- * This class also tracks transactions that are removed from the mempool as\n- * conflicts (per block) and can be used to pass all those transactions\n- * through SyncTransaction.\n- *\n- * This class assumes (and asserts) that the conflicted transactions for a given\n- * block are added via mempool callbacks prior to the BlockConnected() associated\n- * with those transactions. If any transactions are marked conflicted, it is\n- * assumed that an associated block will always be added.\n- *",
    "path": "src/validation.cpp",
    "position": 20,
    "original_position": 12,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "0f17fd9bd5c32eb6c6f4b648f5209f1a223f9e3e",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Commit 0f17fd9. Shoulnd't be more logic to remove both comments in previous commit (141f971) as it's the one where you effectively removed conflicted txn insertion and struct, Just looking at this commit atomically you can't make sense of \"This class assumes (and asserts) that the conflicted transactions for a given block are added via mempool callbacks\"",
    "created_at": "2019-11-15T18:19:21Z",
    "updated_at": "2020-03-11T22:38:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346950264",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346950264"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346950264"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346950264/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2523,
    "original_line": 2523,
    "side": "LEFT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346952184",
    "pull_request_review_id": 317770827,
    "id": 346952184,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0Njk1MjE4NA==",
    "diff_hunk": "@@ -70,6 +70,7 @@\n #include <boost/algorithm/string/replace.hpp>\n #include <boost/algorithm/string/split.hpp>\n #include <boost/thread.hpp>\n+#include <boost/signals2/signal.hpp>",
    "path": "src/init.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "f959e4a00304fb4beea3ecd8894ac7cfd74742e3",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "super-nit: signal before thread?",
    "created_at": "2019-11-15T18:24:18Z",
    "updated_at": "2020-03-11T22:38:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346952184",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346952184"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346952184"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346952184/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 77,
    "original_line": 77,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346953291",
    "pull_request_review_id": 317770827,
    "id": 346953291,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0Njk1MzI5MQ==",
    "diff_hunk": "@@ -698,9 +697,6 @@ class CTxMemPool\n \n     size_t DynamicMemoryUsage() const;\n \n-    boost::signals2::signal<void (CTransactionRef)> NotifyEntryAdded;",
    "path": "src/txmempool.h",
    "position": 12,
    "original_position": 12,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "f959e4a00304fb4beea3ecd8894ac7cfd74742e3",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think it can be noted in commit message than `NotifiyEntryAdded` signal didn't have any slot connected to and so was already useless",
    "created_at": "2019-11-15T18:27:03Z",
    "updated_at": "2020-03-11T22:38:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346953291",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346953291"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346953291"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346953291/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 702,
    "original_line": 702,
    "side": "LEFT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346958305",
    "pull_request_review_id": 317770827,
    "id": 346958305,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0Njk1ODMwNQ==",
    "diff_hunk": "@@ -2486,25 +2486,15 @@ class ConnectTrace {\n     CTxMemPool &pool;\n \n public:\n-    explicit ConnectTrace(CTxMemPool &_pool) : blocksConnected(1), pool(_pool) {}\n+    explicit ConnectTrace(CTxMemPool &_pool) : pool(_pool) {}\n \n     void BlockConnected(CBlockIndex* pindex, std::shared_ptr<const CBlock> pblock) {\n-        assert(!blocksConnected.back().pindex);\n         assert(pindex);\n         assert(pblock);\n-        blocksConnected.back().pindex = pindex;\n-        blocksConnected.back().pblock = std::move(pblock);\n-        blocksConnected.emplace_back();\n+        blocksConnected.emplace_back(pindex, std::move(pblock));\n     }\n \n     std::vector<PerBlockConnectTrace>& GetBlocksConnected() {\n-        // We always keep one extra block at the end of our list because\n-        // blocks are added after all the conflicted transactions have\n-        // been filled in. Thus, the last entry should always be an empty\n-        // one waiting for the transactions from the next block. We pop\n-        // the last entry here to make sure the list we return is sane.\n-        assert(!blocksConnected.back().pindex);\n-        blocksConnected.pop_back();",
    "path": "src/validation.cpp",
    "position": 43,
    "original_position": 33,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "793b45c39a1ba80408d293bdec0d313af50f14c0",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Commit 793b45c. I think this comment, assert and pop should also be removed in commit 141f971 as this is the last commit were their logic make sense. Also in `BlockConnected`, the removed assert and emplace_back belonged to same logic.",
    "created_at": "2019-11-15T18:39:47Z",
    "updated_at": "2020-03-11T22:38:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346958305",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346958305"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346958305"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346958305/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2555,
    "original_line": 2555,
    "side": "LEFT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346958873",
    "pull_request_review_id": 317770827,
    "id": 346958873,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0Njk1ODg3Mw==",
    "diff_hunk": "@@ -2468,21 +2468,13 @@ static int64_t nTimeFlush = 0;\n static int64_t nTimeChainState = 0;\n static int64_t nTimePostConnect = 0;\n \n-struct PerBlockConnectTrace {\n-    CBlockIndex* pindex = nullptr;\n-    std::shared_ptr<const CBlock> pblock;\n-    PerBlockConnectTrace(CBlockIndex* pindexIn, std::shared_ptr<const CBlock> pblockIn) : pindex(pindexIn), pblock(pblockIn) {}\n-};\n /**\n- * Used to track blocks whose transactions were applied to the UTXO state as a\n- * part of a single ActivateBestChainStep call.\n- *\n- * This class is single-use, once you call GetBlocksConnected() you have to throw",
    "path": "src/validation.cpp",
    "position": 21,
    "original_position": 13,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "906b478640918b4a2e734499c81c0a0ffb5fe8de",
    "user": {
      "login": "ariard",
      "id": 23310655,
      "node_id": "MDQ6VXNlcjIzMzEwNjU1",
      "avatar_url": "https://avatars.githubusercontent.com/u/23310655?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ariard",
      "html_url": "https://github.com/ariard",
      "followers_url": "https://api.github.com/users/ariard/followers",
      "following_url": "https://api.github.com/users/ariard/following{/other_user}",
      "gists_url": "https://api.github.com/users/ariard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ariard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ariard/subscriptions",
      "organizations_url": "https://api.github.com/users/ariard/orgs",
      "repos_url": "https://api.github.com/users/ariard/repos",
      "events_url": "https://api.github.com/users/ariard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ariard/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Should you keep this comment ? The class is still single-use. ",
    "created_at": "2019-11-15T18:41:14Z",
    "updated_at": "2020-03-11T22:38:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346958873",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346958873"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346958873"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346958873/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2524,
    "original_line": 2524,
    "side": "LEFT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346996128",
    "pull_request_review_id": 317849482,
    "id": 346996128,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0Njk5NjEyOA==",
    "diff_hunk": "@@ -92,10 +92,17 @@ class CValidationInterface {\n     /**\n      * Notifies listeners of a transaction leaving mempool.\n      *\n-     * This only fires for transactions which leave mempool because of expiry,\n-     * size limiting, reorg (changes in lock times/coinbase maturity), or\n-     * replacement. This does not include any transactions which are included\n-     * in BlockConnectedDisconnected either in block->vtx or in txnConflicted.\n+     * This notification fires for transactions that are removed from the\n+     * mempool for the following reasons:\n+     *\n+     * - EXPIRY (expired from mempool after -mempoolexpiry hours)\n+     * - SIZELIMIT (removed in size limiting if the mempool exceeds -maxmempool megabytes)\n+     * - REORG (removed during a reorg)",
    "path": "src/validationinterface.h",
    "position": 13,
    "original_position": 13,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "ef6f6ae651b9a9bdbb925b4d7aa46d9ca931d4e7",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "There are several other reasons a tx could be removed for REORG:\r\n\r\n- a spend from a coinbase output that is no longer mature (>100 confirmations)\r\n- a descendants of non-final and non-mature outputs.\r\n- if the re-org has been deep enough that the disconnect pool has filled up\r\n- if the standardness or consensus rules have changed across the reorg\r\n\r\nI'd rather leave this high level than try to enumerate all the possible reasons for this here.",
    "created_at": "2019-11-15T20:20:57Z",
    "updated_at": "2020-03-11T22:38:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346996128",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346996128"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346996128"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346996128/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 100,
    "original_line": 100,
    "side": "RIGHT",
    "in_reply_to_id": 346943451
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346996854",
    "pull_request_review_id": 317850433,
    "id": 346996854,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0Njk5Njg1NA==",
    "diff_hunk": "@@ -2477,28 +2477,16 @@ struct PerBlockConnectTrace {\n  * Used to track blocks whose transactions were applied to the UTXO state as a\n  * part of a single ActivateBestChainStep call.\n  *\n- * This class also tracks transactions that are removed from the mempool as\n- * conflicts (per block) and can be used to pass all those transactions\n- * through SyncTransaction.\n- *\n- * This class assumes (and asserts) that the conflicted transactions for a given\n- * block are added via mempool callbacks prior to the BlockConnected() associated\n- * with those transactions. If any transactions are marked conflicted, it is\n- * assumed that an associated block will always be added.\n- *",
    "path": "src/validation.cpp",
    "position": 20,
    "original_position": 12,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "0f17fd9bd5c32eb6c6f4b648f5209f1a223f9e3e",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "done",
    "created_at": "2019-11-15T20:23:11Z",
    "updated_at": "2020-03-11T22:38:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346996854",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346996854"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346996854"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346996854/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2523,
    "original_line": 2523,
    "side": "LEFT",
    "in_reply_to_id": 346950264
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346996883",
    "pull_request_review_id": 317850477,
    "id": 346996883,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0Njk5Njg4Mw==",
    "diff_hunk": "@@ -70,6 +70,7 @@\n #include <boost/algorithm/string/replace.hpp>\n #include <boost/algorithm/string/split.hpp>\n #include <boost/thread.hpp>\n+#include <boost/signals2/signal.hpp>",
    "path": "src/init.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "f959e4a00304fb4beea3ecd8894ac7cfd74742e3",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "done",
    "created_at": "2019-11-15T20:23:15Z",
    "updated_at": "2020-03-11T22:38:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346996883",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346996883"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346996883"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346996883/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 77,
    "original_line": 77,
    "side": "RIGHT",
    "in_reply_to_id": 346952184
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346996906",
    "pull_request_review_id": 317850501,
    "id": 346996906,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0Njk5NjkwNg==",
    "diff_hunk": "@@ -698,9 +697,6 @@ class CTxMemPool\n \n     size_t DynamicMemoryUsage() const;\n \n-    boost::signals2::signal<void (CTransactionRef)> NotifyEntryAdded;",
    "path": "src/txmempool.h",
    "position": 12,
    "original_position": 12,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "f959e4a00304fb4beea3ecd8894ac7cfd74742e3",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "done",
    "created_at": "2019-11-15T20:23:20Z",
    "updated_at": "2020-03-11T22:38:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346996906",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346996906"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346996906"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346996906/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 702,
    "original_line": 702,
    "side": "LEFT",
    "in_reply_to_id": 346953291
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346997355",
    "pull_request_review_id": 317851061,
    "id": 346997355,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0Njk5NzM1NQ==",
    "diff_hunk": "@@ -2486,25 +2486,15 @@ class ConnectTrace {\n     CTxMemPool &pool;\n \n public:\n-    explicit ConnectTrace(CTxMemPool &_pool) : blocksConnected(1), pool(_pool) {}\n+    explicit ConnectTrace(CTxMemPool &_pool) : pool(_pool) {}\n \n     void BlockConnected(CBlockIndex* pindex, std::shared_ptr<const CBlock> pblock) {\n-        assert(!blocksConnected.back().pindex);\n         assert(pindex);\n         assert(pblock);\n-        blocksConnected.back().pindex = pindex;\n-        blocksConnected.back().pblock = std::move(pblock);\n-        blocksConnected.emplace_back();\n+        blocksConnected.emplace_back(pindex, std::move(pblock));\n     }\n \n     std::vector<PerBlockConnectTrace>& GetBlocksConnected() {\n-        // We always keep one extra block at the end of our list because\n-        // blocks are added after all the conflicted transactions have\n-        // been filled in. Thus, the last entry should always be an empty\n-        // one waiting for the transactions from the next block. We pop\n-        // the last entry here to make sure the list we return is sane.\n-        assert(!blocksConnected.back().pindex);\n-        blocksConnected.pop_back();",
    "path": "src/validation.cpp",
    "position": 43,
    "original_position": 33,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "793b45c39a1ba80408d293bdec0d313af50f14c0",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I prefer to leave this as a separate commit since I think it's easier to review removing the logic piece-by-piece. If other reviewers agree with you, then I'm happy to squash the commits.",
    "created_at": "2019-11-15T20:24:39Z",
    "updated_at": "2020-03-11T22:38:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346997355",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346997355"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346997355"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346997355/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2555,
    "original_line": 2555,
    "side": "LEFT",
    "in_reply_to_id": 346958305
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346997548",
    "pull_request_review_id": 317851310,
    "id": 346997548,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0Njk5NzU0OA==",
    "diff_hunk": "@@ -2468,21 +2468,13 @@ static int64_t nTimeFlush = 0;\n static int64_t nTimeChainState = 0;\n static int64_t nTimePostConnect = 0;\n \n-struct PerBlockConnectTrace {\n-    CBlockIndex* pindex = nullptr;\n-    std::shared_ptr<const CBlock> pblock;\n-    PerBlockConnectTrace(CBlockIndex* pindexIn, std::shared_ptr<const CBlock> pblockIn) : pindex(pindexIn), pblock(pblockIn) {}\n-};\n /**\n- * Used to track blocks whose transactions were applied to the UTXO state as a\n- * part of a single ActivateBestChainStep call.\n- *\n- * This class is single-use, once you call GetBlocksConnected() you have to throw",
    "path": "src/validation.cpp",
    "position": 21,
    "original_position": 13,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "906b478640918b4a2e734499c81c0a0ffb5fe8de",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "restored",
    "created_at": "2019-11-15T20:25:16Z",
    "updated_at": "2020-03-11T22:38:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346997548",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346997548"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r346997548"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/346997548/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2524,
    "original_line": 2524,
    "side": "LEFT",
    "in_reply_to_id": 346958873
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/347001539",
    "pull_request_review_id": 317856519,
    "id": 347001539,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM0NzAwMTUzOQ==",
    "diff_hunk": "@@ -2477,28 +2477,16 @@ struct PerBlockConnectTrace {\n  * Used to track blocks whose transactions were applied to the UTXO state as a\n  * part of a single ActivateBestChainStep call.\n  *\n- * This class also tracks transactions that are removed from the mempool as\n- * conflicts (per block) and can be used to pass all those transactions\n- * through SyncTransaction.\n- *\n- * This class assumes (and asserts) that the conflicted transactions for a given\n- * block are added via mempool callbacks prior to the BlockConnected() associated\n- * with those transactions. If any transactions are marked conflicted, it is\n- * assumed that an associated block will always be added.\n- *\n  * This class is single-use, once you call GetBlocksConnected() you have to throw\n  * it away and make a new one.\n  */\n class ConnectTrace {\n private:\n     std::vector<PerBlockConnectTrace> blocksConnected;\n     CTxMemPool &pool;",
    "path": "src/validation.cpp",
    "position": null,
    "original_position": 19,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "0f17fd9bd5c32eb6c6f4b648f5209f1a223f9e3e",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "done",
    "created_at": "2019-11-15T20:37:29Z",
    "updated_at": "2020-03-11T22:38:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r347001539",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/347001539"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r347001539"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/347001539/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2486,
    "side": "RIGHT",
    "in_reply_to_id": 346937589
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/350463184",
    "pull_request_review_id": 322629415,
    "id": 350463184,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1MDQ2MzE4NA==",
    "diff_hunk": "@@ -2468,35 +2468,21 @@ static int64_t nTimePostConnect = 0;\n struct PerBlockConnectTrace {\n     CBlockIndex* pindex = nullptr;\n     std::shared_ptr<const CBlock> pblock;\n-    std::shared_ptr<std::vector<CTransactionRef>> conflictedTxs;\n-    PerBlockConnectTrace() : conflictedTxs(std::make_shared<std::vector<CTransactionRef>>()) {}\n+    PerBlockConnectTrace() {}",
    "path": "src/validation.cpp",
    "position": 6,
    "original_position": 6,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "a3526626773b3a90d8865cb35acd03f584a15216",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit, just drop the constructor?",
    "created_at": "2019-11-25T22:47:47Z",
    "updated_at": "2020-03-11T22:38:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r350463184",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/350463184"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r350463184"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/350463184/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2508,
    "original_line": 2508,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/350481254",
    "pull_request_review_id": 322652136,
    "id": 350481254,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1MDQ4MTI1NA==",
    "diff_hunk": "@@ -2468,35 +2468,21 @@ static int64_t nTimePostConnect = 0;\n struct PerBlockConnectTrace {\n     CBlockIndex* pindex = nullptr;\n     std::shared_ptr<const CBlock> pblock;\n-    std::shared_ptr<std::vector<CTransactionRef>> conflictedTxs;\n-    PerBlockConnectTrace() : conflictedTxs(std::make_shared<std::vector<CTransactionRef>>()) {}\n+    PerBlockConnectTrace() {}",
    "path": "src/validation.cpp",
    "position": 6,
    "original_position": 6,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "a3526626773b3a90d8865cb35acd03f584a15216",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I plan to remove `PerBlockConnectTrace()` entirely in #17562.",
    "created_at": "2019-11-25T23:49:31Z",
    "updated_at": "2020-03-11T22:38:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r350481254",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/350481254"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r350481254"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/350481254/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2508,
    "original_line": 2508,
    "side": "RIGHT",
    "in_reply_to_id": 350463184
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/350725914",
    "pull_request_review_id": 322959498,
    "id": 350725914,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1MDcyNTkxNA==",
    "diff_hunk": "@@ -2468,35 +2468,21 @@ static int64_t nTimePostConnect = 0;\n struct PerBlockConnectTrace {\n     CBlockIndex* pindex = nullptr;\n     std::shared_ptr<const CBlock> pblock;\n-    std::shared_ptr<std::vector<CTransactionRef>> conflictedTxs;\n-    PerBlockConnectTrace() : conflictedTxs(std::make_shared<std::vector<CTransactionRef>>()) {}\n+    PerBlockConnectTrace() {}",
    "path": "src/validation.cpp",
    "position": 6,
    "original_position": 6,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "a3526626773b3a90d8865cb35acd03f584a15216",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Sure, but if you happen to push again I still think you could remove this line. ",
    "created_at": "2019-11-26T13:00:07Z",
    "updated_at": "2020-03-11T22:38:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r350725914",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/350725914"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r350725914"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/350725914/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2508,
    "original_line": 2508,
    "side": "RIGHT",
    "in_reply_to_id": 350463184
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/369614511",
    "pull_request_review_id": 346658390,
    "id": 369614511,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM2OTYxNDUxMQ==",
    "diff_hunk": "@@ -70,6 +70,7 @@\n #include <boost/algorithm/string/classification.hpp>\n #include <boost/algorithm/string/replace.hpp>\n #include <boost/algorithm/string/split.hpp>\n+#include <boost/signals2/signal.hpp>",
    "path": "src/init.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "100d5d03f7629e0c4be14239c6c6c3e542c3f34e",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Would this line be better in `src/ui_interface.h` instead? It seems to be where it's used. Build and tests green.",
    "created_at": "2020-01-22T15:06:32Z",
    "updated_at": "2020-03-11T22:38:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r369614511",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/369614511"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r369614511"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/369614511/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 77,
    "original_line": 77,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/370223948",
    "pull_request_review_id": 347437447,
    "id": 370223948,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM3MDIyMzk0OA==",
    "diff_hunk": "@@ -406,7 +406,7 @@ void CTxMemPool::removeUnchecked(txiter it, MemPoolRemovalReason reason)\n {\n     CTransactionRef ptx = it->GetSharedTx();\n     NotifyEntryRemoved(ptx, reason);\n-    if (reason != MemPoolRemovalReason::BLOCK && reason != MemPoolRemovalReason::CONFLICT) {\n+    if (reason != MemPoolRemovalReason::BLOCK) {",
    "path": "src/txmempool.cpp",
    "position": 16,
    "original_position": 5,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "3529e0bc2cba7a9d502de2c0fe9b17ec94a7fd0c",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"[wallet] Notify conflicted transactions in TransactionRemovedFromMempool\" (3529e0bc2cba7a9d502de2c0fe9b17ec94a7fd0c)\r\n\r\nCould you add a comment about why notifications are skipped for BLOCK? I believe it's just for performance because BlockConnected notification provides the same information.",
    "created_at": "2020-01-23T16:30:36Z",
    "updated_at": "2020-03-11T22:38:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r370223948",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/370223948"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r370223948"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/370223948/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 408,
    "original_line": 408,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/386567904",
    "pull_request_review_id": 367423847,
    "id": 386567904,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NjU2NzkwNA==",
    "diff_hunk": "@@ -92,10 +92,17 @@ class CValidationInterface {\n     /**\n      * Notifies listeners of a transaction leaving mempool.\n      *\n-     * This only fires for transactions which leave mempool because of expiry,\n-     * size limiting, reorg (changes in lock times/coinbase maturity), or\n-     * replacement. This does not include any transactions which are included\n-     * in BlockConnectedDisconnected either in block->vtx or in txnConflicted.\n+     * This notification fires for transactions that are removed from the\n+     * mempool for the following reasons:\n+     *\n+     * - EXPIRY (expired from mempool after -mempoolexpiry hours)\n+     * - SIZELIMIT (removed in size limiting if the mempool exceeds -maxmempool megabytes)\n+     * - REORG (removed during a reorg)\n+     * - CONFLICT (removed because it conflicts with in-block transaction)\n+     * - REPLACED (removed due to RBF replacement)\n+     *\n+     * This does not fire for transactions that are removed from the mempool",
    "path": "src/validationinterface.h",
    "position": 17,
    "original_position": 17,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "b75fada45e99dac388e9501b76eba6fe7191520f",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "In commit \"[wallet] Notify conflicted transactions in TransactionRemovedFromMempool\" (72d17a293e32bcf8d4cf9b7744bb67a0a886fb42)\r\n\r\nIt'd be good to add information here from https://github.com/bitcoin/bitcoin/pull/17477#issuecomment-554041672 about order of TransactionRemovedFromMempool and BlockConnected notifications",
    "created_at": "2020-03-02T18:25:56Z",
    "updated_at": "2020-03-11T22:38:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r386567904",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/386567904"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r386567904"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/386567904/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 104,
    "original_line": 104,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/387326230",
    "pull_request_review_id": 368364709,
    "id": 387326230,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzMyNjIzMA==",
    "diff_hunk": "@@ -70,6 +70,7 @@\n #include <boost/algorithm/string/classification.hpp>\n #include <boost/algorithm/string/replace.hpp>\n #include <boost/algorithm/string/split.hpp>\n+#include <boost/signals2/signal.hpp>",
    "path": "src/init.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "100d5d03f7629e0c4be14239c6c6c3e542c3f34e",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "it's used in init.cpp:366: `static boost::signals2::connection rpc_notify_block_change_connection;`\r\n",
    "created_at": "2020-03-03T22:13:05Z",
    "updated_at": "2020-03-11T22:38:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r387326230",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/387326230"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r387326230"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/387326230/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 77,
    "original_line": 77,
    "side": "RIGHT",
    "in_reply_to_id": 369614511
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/387335176",
    "pull_request_review_id": 368375593,
    "id": 387335176,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM4NzMzNTE3Ng==",
    "diff_hunk": "@@ -406,7 +406,7 @@ void CTxMemPool::removeUnchecked(txiter it, MemPoolRemovalReason reason)\n {\n     CTransactionRef ptx = it->GetSharedTx();\n     NotifyEntryRemoved(ptx, reason);\n-    if (reason != MemPoolRemovalReason::BLOCK && reason != MemPoolRemovalReason::CONFLICT) {\n+    if (reason != MemPoolRemovalReason::BLOCK) {",
    "path": "src/txmempool.cpp",
    "position": 16,
    "original_position": 5,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "3529e0bc2cba7a9d502de2c0fe9b17ec94a7fd0c",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "done",
    "created_at": "2020-03-03T22:33:03Z",
    "updated_at": "2020-03-11T22:38:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r387335176",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/387335176"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r387335176"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/387335176/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 408,
    "original_line": 408,
    "side": "RIGHT",
    "in_reply_to_id": 370223948
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/391310332",
    "pull_request_review_id": 373174283,
    "id": 391310332,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTMxMDMzMg==",
    "diff_hunk": "@@ -92,10 +92,17 @@ class CValidationInterface {\n     /**\n      * Notifies listeners of a transaction leaving mempool.\n      *\n-     * This only fires for transactions which leave mempool because of expiry,\n-     * size limiting, reorg (changes in lock times/coinbase maturity), or\n-     * replacement. This does not include any transactions which are included\n-     * in BlockConnectedDisconnected either in block->vtx or in txnConflicted.\n+     * This notification fires for transactions that are removed from the\n+     * mempool for the following reasons:\n+     *\n+     * - EXPIRY (expired from mempool after -mempoolexpiry hours)\n+     * - SIZELIMIT (removed in size limiting if the mempool exceeds -maxmempool megabytes)\n+     * - REORG (removed during a reorg)\n+     * - CONFLICT (removed because it conflicts with in-block transaction)\n+     * - REPLACED (removed due to RBF replacement)\n+     *\n+     * This does not fire for transactions that are removed from the mempool",
    "path": "src/validationinterface.h",
    "position": 17,
    "original_position": 17,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "b75fada45e99dac388e9501b76eba6fe7191520f",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "done",
    "created_at": "2020-03-11T22:39:08Z",
    "updated_at": "2020-03-11T22:39:08Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r391310332",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/391310332"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r391310332"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/391310332/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 104,
    "original_line": 104,
    "side": "RIGHT",
    "in_reply_to_id": 386567904
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/391418753",
    "pull_request_review_id": 373299318,
    "id": 391418753,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM5MTQxODc1Mw==",
    "diff_hunk": "@@ -70,6 +70,7 @@\n #include <boost/algorithm/string/classification.hpp>\n #include <boost/algorithm/string/replace.hpp>\n #include <boost/algorithm/string/split.hpp>\n+#include <boost/signals2/signal.hpp>",
    "path": "src/init.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "e57980b4738c10344baf136de3e050a3cb958ca5",
    "original_commit_id": "100d5d03f7629e0c4be14239c6c6c3e542c3f34e",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "d'oh, thanks -- not sure how I missed that.",
    "created_at": "2020-03-12T06:12:52Z",
    "updated_at": "2020-03-12T06:12:53Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r391418753",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/391418753"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17477#discussion_r391418753"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17477"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/391418753/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 77,
    "original_line": 77,
    "side": "RIGHT",
    "in_reply_to_id": 369614511
  }
]