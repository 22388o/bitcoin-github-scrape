[
  {
    "sha": "965a12442746e99247e5ce0f43fba8e3e149cae4",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo5NjVhMTI0NDI3NDZlOTkyNDdlNWNlMGY0M2ZiYThlM2UxNDljYWU0",
    "commit": {
      "author": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2017-05-05T17:01:27Z"
      },
      "committer": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2017-05-05T17:01:27Z"
      },
      "message": "[tests] Fix abandonconflict.py intermittency",
      "tree": {
        "sha": "123aacc63ebc2c46cef529d66f2de5cba810218e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/123aacc63ebc2c46cef529d66f2de5cba810218e"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/965a12442746e99247e5ce0f43fba8e3e149cae4",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/965a12442746e99247e5ce0f43fba8e3e149cae4",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/965a12442746e99247e5ce0f43fba8e3e149cae4",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/965a12442746e99247e5ce0f43fba8e3e149cae4/comments",
    "author": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "35da2aeed7d4000dde93957c3b6e048ab83c4f2b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/35da2aeed7d4000dde93957c3b6e048ab83c4f2b",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/35da2aeed7d4000dde93957c3b6e048ab83c4f2b"
      }
    ],
    "stats": {
      "total": 9,
      "additions": 4,
      "deletions": 5
    },
    "files": [
      {
        "sha": "974875764168726e56aed0e239007ecd00e6926c",
        "filename": "test/functional/abandonconflict.py",
        "status": "modified",
        "additions": 4,
        "deletions": 5,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/965a12442746e99247e5ce0f43fba8e3e149cae4/test/functional/abandonconflict.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/965a12442746e99247e5ce0f43fba8e3e149cae4/test/functional/abandonconflict.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/abandonconflict.py?ref=965a12442746e99247e5ce0f43fba8e3e149cae4",
        "patch": "@@ -10,10 +10,8 @@\n  which are not included in a block and are not currently in the mempool. It has\n  no effect on transactions which are already conflicted or abandoned.\n \"\"\"\n-\n from test_framework.test_framework import BitcoinTestFramework\n from test_framework.util import *\n-import urllib.parse\n \n class AbandonConflictTest(BitcoinTestFramework):\n     def __init__(self):\n@@ -37,8 +35,8 @@ def run_test(self):\n         assert(balance - newbalance < Decimal(\"0.001\")) #no more than fees lost\n         balance = newbalance\n \n-        url = urllib.parse.urlparse(self.nodes[1].url)\n-        self.nodes[0].disconnectnode(url.hostname+\":\"+str(p2p_port(1)))\n+        # Disconnect nodes so node0's transactions don't get into node1's mempool\n+        disconnect_nodes(self.nodes[0], 1)\n \n         # Identify the 10btc outputs\n         nA = next(i for i, vout in enumerate(self.nodes[0].getrawtransaction(txA, 1)[\"vout\"]) if vout[\"value\"] == Decimal(\"10\"))\n@@ -78,8 +76,9 @@ def run_test(self):\n         stop_node(self.nodes[0],0)\n         self.nodes[0]=start_node(0, self.options.tmpdir, [\"-minrelaytxfee=0.0001\"])\n \n-        # Verify txs no longer in mempool\n+        # Verify txs no longer in either node's mempool\n         assert_equal(len(self.nodes[0].getrawmempool()), 0)\n+        assert_equal(len(self.nodes[1].getrawmempool()), 0)\n \n         # Not in mempool txs from self should only reduce balance\n         # inputs are still spent, but change not received"
      }
    ]
  }
]