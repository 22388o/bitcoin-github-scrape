[
  {
    "sha": "c9e70d4c0a0585a253708a3c01fe4cee50057a63",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpjOWU3MGQ0YzBhMDU4NWEyNTM3MDhhM2MwMWZlNGNlZTUwMDU3YTYz",
    "commit": {
      "author": {
        "name": "Giel van Schijndel",
        "email": "me@mortis.eu",
        "date": "2011-06-24T17:26:47Z"
      },
      "committer": {
        "name": "Giel van Schijndel",
        "email": "me@mortis.eu",
        "date": "2011-06-26T19:07:59Z"
      },
      "message": "rpc server: send '403 Forbidden' to rejected clients\n\nIn order to be a proper HTTP implementation clients that aren't allowed\nto connect to the RPC server (using -rpcallowip), should receive a\nproper HTTP response.  So instead of closing the connection on them send\na '403 Forbidden' status.\n\nSigned-off-by: Giel van Schijndel <me@mortis.eu>",
      "tree": {
        "sha": "4bc87e4c984b82ca289043c0fd535ca82f2caee8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4bc87e4c984b82ca289043c0fd535ca82f2caee8"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c9e70d4c0a0585a253708a3c01fe4cee50057a63",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c9e70d4c0a0585a253708a3c01fe4cee50057a63",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/c9e70d4c0a0585a253708a3c01fe4cee50057a63",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c9e70d4c0a0585a253708a3c01fe4cee50057a63/comments",
    "author": {
      "login": "muggenhor",
      "id": 484066,
      "node_id": "MDQ6VXNlcjQ4NDA2Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/484066?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/muggenhor",
      "html_url": "https://github.com/muggenhor",
      "followers_url": "https://api.github.com/users/muggenhor/followers",
      "following_url": "https://api.github.com/users/muggenhor/following{/other_user}",
      "gists_url": "https://api.github.com/users/muggenhor/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/muggenhor/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/muggenhor/subscriptions",
      "organizations_url": "https://api.github.com/users/muggenhor/orgs",
      "repos_url": "https://api.github.com/users/muggenhor/repos",
      "events_url": "https://api.github.com/users/muggenhor/events{/privacy}",
      "received_events_url": "https://api.github.com/users/muggenhor/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "muggenhor",
      "id": 484066,
      "node_id": "MDQ6VXNlcjQ4NDA2Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/484066?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/muggenhor",
      "html_url": "https://github.com/muggenhor",
      "followers_url": "https://api.github.com/users/muggenhor/followers",
      "following_url": "https://api.github.com/users/muggenhor/following{/other_user}",
      "gists_url": "https://api.github.com/users/muggenhor/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/muggenhor/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/muggenhor/subscriptions",
      "organizations_url": "https://api.github.com/users/muggenhor/orgs",
      "repos_url": "https://api.github.com/users/muggenhor/repos",
      "events_url": "https://api.github.com/users/muggenhor/events{/privacy}",
      "received_events_url": "https://api.github.com/users/muggenhor/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "d0d80170a2ca73004e08fb85007fe055cbf4e411",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d0d80170a2ca73004e08fb85007fe055cbf4e411",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/d0d80170a2ca73004e08fb85007fe055cbf4e411"
      }
    ],
    "stats": {
      "total": 6,
      "additions": 5,
      "deletions": 1
    },
    "files": [
      {
        "sha": "7e0f05c6da512b35f6f2494f0b388958ee2b50b0",
        "filename": "src/rpc.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 1,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/c9e70d4c0a0585a253708a3c01fe4cee50057a63/src/rpc.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/c9e70d4c0a0585a253708a3c01fe4cee50057a63/src/rpc.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc.cpp?ref=c9e70d4c0a0585a253708a3c01fe4cee50057a63",
        "patch": "@@ -1532,7 +1532,7 @@ string rfc1123Time()\n     return string(buffer);\n }\n \n-string HTTPReply(int nStatus, const string& strMsg)\n+static string HTTPReply(int nStatus, const string& strMsg)\n {\n     if (nStatus == 401)\n         return strprintf(\"HTTP/1.0 401 Authorization Required\\r\\n\"\n@@ -1554,6 +1554,7 @@ string HTTPReply(int nStatus, const string& strMsg)\n     string strStatus;\n          if (nStatus == 200) strStatus = \"OK\";\n     else if (nStatus == 400) strStatus = \"Bad Request\";\n+    else if (nStatus == 403) strStatus = \"Forbidden\";\n     else if (nStatus == 404) strStatus = \"Not Found\";\n     else if (nStatus == 500) strStatus = \"Internal Server Error\";\n     return strprintf(\n@@ -1887,7 +1888,10 @@ void ThreadRPCServer2(void* parg)\n \n         // Restrict callers by IP\n         if (!ClientAllowed(peer.address().to_string()))\n+        {\n+            stream << HTTPReply(403, \"\") << std::flush;\n             continue;\n+        }\n \n         map<string, string> mapHeaders;\n         string strRequest;"
      }
    ]
  },
  {
    "sha": "e913574e027d7d75783b9ffc56375b2edc0418f3",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplOTEzNTc0ZTAyN2Q3ZDc1NzgzYjlmZmM1NjM3NWIyZWRjMDQxOGYz",
    "commit": {
      "author": {
        "name": "Giel van Schijndel",
        "email": "me@mortis.eu",
        "date": "2011-06-25T02:31:48Z"
      },
      "committer": {
        "name": "Giel van Schijndel",
        "email": "me@mortis.eu",
        "date": "2011-06-26T19:07:59Z"
      },
      "message": "rpc: don't send 403 when using SSL to prevent DoS\n\nSigned-off-by: Giel van Schijndel <me@mortis.eu>",
      "tree": {
        "sha": "ca96bcdd0fc70c1fe8c520ca30d4c90c4a85ecc6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ca96bcdd0fc70c1fe8c520ca30d4c90c4a85ecc6"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e913574e027d7d75783b9ffc56375b2edc0418f3",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e913574e027d7d75783b9ffc56375b2edc0418f3",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/e913574e027d7d75783b9ffc56375b2edc0418f3",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e913574e027d7d75783b9ffc56375b2edc0418f3/comments",
    "author": {
      "login": "muggenhor",
      "id": 484066,
      "node_id": "MDQ6VXNlcjQ4NDA2Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/484066?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/muggenhor",
      "html_url": "https://github.com/muggenhor",
      "followers_url": "https://api.github.com/users/muggenhor/followers",
      "following_url": "https://api.github.com/users/muggenhor/following{/other_user}",
      "gists_url": "https://api.github.com/users/muggenhor/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/muggenhor/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/muggenhor/subscriptions",
      "organizations_url": "https://api.github.com/users/muggenhor/orgs",
      "repos_url": "https://api.github.com/users/muggenhor/repos",
      "events_url": "https://api.github.com/users/muggenhor/events{/privacy}",
      "received_events_url": "https://api.github.com/users/muggenhor/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "muggenhor",
      "id": 484066,
      "node_id": "MDQ6VXNlcjQ4NDA2Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/484066?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/muggenhor",
      "html_url": "https://github.com/muggenhor",
      "followers_url": "https://api.github.com/users/muggenhor/followers",
      "following_url": "https://api.github.com/users/muggenhor/following{/other_user}",
      "gists_url": "https://api.github.com/users/muggenhor/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/muggenhor/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/muggenhor/subscriptions",
      "organizations_url": "https://api.github.com/users/muggenhor/orgs",
      "repos_url": "https://api.github.com/users/muggenhor/repos",
      "events_url": "https://api.github.com/users/muggenhor/events{/privacy}",
      "received_events_url": "https://api.github.com/users/muggenhor/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "c9e70d4c0a0585a253708a3c01fe4cee50057a63",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c9e70d4c0a0585a253708a3c01fe4cee50057a63",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/c9e70d4c0a0585a253708a3c01fe4cee50057a63"
      }
    ],
    "stats": {
      "total": 4,
      "additions": 3,
      "deletions": 1
    },
    "files": [
      {
        "sha": "780209920ec584626fe15d7ea984c05397cad101",
        "filename": "src/rpc.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 1,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e913574e027d7d75783b9ffc56375b2edc0418f3/src/rpc.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e913574e027d7d75783b9ffc56375b2edc0418f3/src/rpc.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc.cpp?ref=e913574e027d7d75783b9ffc56375b2edc0418f3",
        "patch": "@@ -1889,7 +1889,9 @@ void ThreadRPCServer2(void* parg)\n         // Restrict callers by IP\n         if (!ClientAllowed(peer.address().to_string()))\n         {\n-            stream << HTTPReply(403, \"\") << std::flush;\n+            // Only send a 403 if we're not using SSL to prevent a DoS during the SSL handshake.\n+            if (!fUseSSL)\n+                stream << HTTPReply(403, \"\") << std::flush;\n             continue;\n         }\n "
      }
    ]
  }
]