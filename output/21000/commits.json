[
  {
    "sha": "58232e3ffb319d27b41cfe040cfea8e43a3fb7e9",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo1ODIzMmUzZmZiMzE5ZDI3YjQxY2ZlMDQwY2ZlYThlNDNhM2ZiN2U5",
    "commit": {
      "author": {
        "name": "practicalswift",
        "email": "practicalswift@users.noreply.github.com",
        "date": "2021-01-24T18:45:44Z"
      },
      "committer": {
        "name": "practicalswift",
        "email": "practicalswift@users.noreply.github.com",
        "date": "2021-01-25T20:55:36Z"
      },
      "message": "fuzz: Avoid -fsanitize=integer warnings in fuzzing harnesses",
      "tree": {
        "sha": "f145addb9902c25cbd5d02b2cbc8d609e28dc91b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/f145addb9902c25cbd5d02b2cbc8d609e28dc91b"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/58232e3ffb319d27b41cfe040cfea8e43a3fb7e9",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/58232e3ffb319d27b41cfe040cfea8e43a3fb7e9",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/58232e3ffb319d27b41cfe040cfea8e43a3fb7e9",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/58232e3ffb319d27b41cfe040cfea8e43a3fb7e9/comments",
    "author": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "52d84a45e2fa3def71853cd31d5582ae31ea85d3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/52d84a45e2fa3def71853cd31d5582ae31ea85d3",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/52d84a45e2fa3def71853cd31d5582ae31ea85d3"
      }
    ],
    "stats": {
      "total": 21,
      "additions": 15,
      "deletions": 6
    },
    "files": [
      {
        "sha": "0e1c44cdeda1ff8449f5b28fceabad56b398cf64",
        "filename": "src/test/fuzz/crypto_chacha20_poly1305_aead.cpp",
        "status": "modified",
        "additions": 8,
        "deletions": 2,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/58232e3ffb319d27b41cfe040cfea8e43a3fb7e9/src/test/fuzz/crypto_chacha20_poly1305_aead.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/58232e3ffb319d27b41cfe040cfea8e43a3fb7e9/src/test/fuzz/crypto_chacha20_poly1305_aead.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/crypto_chacha20_poly1305_aead.cpp?ref=58232e3ffb319d27b41cfe040cfea8e43a3fb7e9",
        "patch": "@@ -45,18 +45,24 @@ FUZZ_TARGET(crypto_chacha20_poly1305_aead)\n                 assert(ok);\n             },\n             [&] {\n+                if (AdditionOverflow(seqnr_payload, static_cast<uint64_t>(1))) {\n+                    return;\n+                }\n                 seqnr_payload += 1;\n                 aad_pos += CHACHA20_POLY1305_AEAD_AAD_LEN;\n                 if (aad_pos + CHACHA20_POLY1305_AEAD_AAD_LEN > CHACHA20_ROUND_OUTPUT) {\n                     aad_pos = 0;\n+                    if (AdditionOverflow(seqnr_aad, static_cast<uint64_t>(1))) {\n+                        return;\n+                    }\n                     seqnr_aad += 1;\n                 }\n             },\n             [&] {\n-                seqnr_payload = fuzzed_data_provider.ConsumeIntegral<int>();\n+                seqnr_payload = fuzzed_data_provider.ConsumeIntegral<uint64_t>();\n             },\n             [&] {\n-                seqnr_aad = fuzzed_data_provider.ConsumeIntegral<int>();\n+                seqnr_aad = fuzzed_data_provider.ConsumeIntegral<uint64_t>();\n             },\n             [&] {\n                 is_encrypt = fuzzed_data_provider.ConsumeBool();"
      },
      {
        "sha": "c4348495bfdbfd41eb1cce76ff99b40797acbf56",
        "filename": "src/test/fuzz/pow.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 1,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/58232e3ffb319d27b41cfe040cfea8e43a3fb7e9/src/test/fuzz/pow.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/58232e3ffb319d27b41cfe040cfea8e43a3fb7e9/src/test/fuzz/pow.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/pow.cpp?ref=58232e3ffb319d27b41cfe040cfea8e43a3fb7e9",
        "patch": "@@ -43,7 +43,10 @@ FUZZ_TARGET_INIT(pow, initialize_pow)\n                 current_block.nHeight = current_height;\n             }\n             if (fuzzed_data_provider.ConsumeBool()) {\n-                current_block.nTime = fixed_time + current_height * consensus_params.nPowTargetSpacing;\n+                const uint32_t seconds = current_height * consensus_params.nPowTargetSpacing;\n+                if (!AdditionOverflow(fixed_time, seconds)) {\n+                    current_block.nTime = fixed_time + seconds;\n+                }\n             }\n             if (fuzzed_data_provider.ConsumeBool()) {\n                 current_block.nBits = fixed_bits;"
      },
      {
        "sha": "7fadf36f989796dca69dbac503677a23a7689588",
        "filename": "src/test/fuzz/script.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/58232e3ffb319d27b41cfe040cfea8e43a3fb7e9/src/test/fuzz/script.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/58232e3ffb319d27b41cfe040cfea8e43a3fb7e9/src/test/fuzz/script.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/script.cpp?ref=58232e3ffb319d27b41cfe040cfea8e43a3fb7e9",
        "patch": "@@ -154,13 +154,13 @@ FUZZ_TARGET_INIT(script, initialize_script)\n \n     {\n         WitnessUnknown witness_unknown_1{};\n-        witness_unknown_1.version = fuzzed_data_provider.ConsumeIntegral<int>();\n+        witness_unknown_1.version = fuzzed_data_provider.ConsumeIntegral<uint32_t>();\n         const std::vector<uint8_t> witness_unknown_program_1 = fuzzed_data_provider.ConsumeBytes<uint8_t>(40);\n         witness_unknown_1.length = witness_unknown_program_1.size();\n         std::copy(witness_unknown_program_1.begin(), witness_unknown_program_1.end(), witness_unknown_1.program);\n \n         WitnessUnknown witness_unknown_2{};\n-        witness_unknown_2.version = fuzzed_data_provider.ConsumeIntegral<int>();\n+        witness_unknown_2.version = fuzzed_data_provider.ConsumeIntegral<uint32_t>();\n         const std::vector<uint8_t> witness_unknown_program_2 = fuzzed_data_provider.ConsumeBytes<uint8_t>(40);\n         witness_unknown_2.length = witness_unknown_program_2.size();\n         std::copy(witness_unknown_program_2.begin(), witness_unknown_program_2.end(), witness_unknown_2.program);"
      },
      {
        "sha": "5b8eacf0511272f020148195904d3345fe4b4863",
        "filename": "src/test/fuzz/util.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/58232e3ffb319d27b41cfe040cfea8e43a3fb7e9/src/test/fuzz/util.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/58232e3ffb319d27b41cfe040cfea8e43a3fb7e9/src/test/fuzz/util.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/util.h?ref=58232e3ffb319d27b41cfe040cfea8e43a3fb7e9",
        "patch": "@@ -196,7 +196,7 @@ template <typename WeakEnumType, size_t size>\n         },\n         [&] {\n             WitnessUnknown witness_unknown{};\n-            witness_unknown.version = fuzzed_data_provider.ConsumeIntegral<int>();\n+            witness_unknown.version = fuzzed_data_provider.ConsumeIntegral<uint32_t>();\n             const std::vector<uint8_t> witness_unknown_program_1 = fuzzed_data_provider.ConsumeBytes<uint8_t>(40);\n             witness_unknown.length = witness_unknown_program_1.size();\n             std::copy(witness_unknown_program_1.begin(), witness_unknown_program_1.end(), witness_unknown.program);"
      }
    ]
  },
  {
    "sha": "f0f8b1a076c362c6e26570a2129809f4d6a0abad",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmMGY4YjFhMDc2YzM2MmM2ZTI2NTcwYTIxMjk4MDlmNGQ2YTBhYmFk",
    "commit": {
      "author": {
        "name": "practicalswift",
        "email": "practicalswift@users.noreply.github.com",
        "date": "2021-01-24T18:49:27Z"
      },
      "committer": {
        "name": "practicalswift",
        "email": "practicalswift@users.noreply.github.com",
        "date": "2021-01-25T20:55:36Z"
      },
      "message": "fuzz: Add UBSan suppressions needed for fuzz tests to not warn under -fsanitize=integer",
      "tree": {
        "sha": "d3144b0677ecd39ec481161c7dd72a23b793a8af",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d3144b0677ecd39ec481161c7dd72a23b793a8af"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f0f8b1a076c362c6e26570a2129809f4d6a0abad",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f0f8b1a076c362c6e26570a2129809f4d6a0abad",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/f0f8b1a076c362c6e26570a2129809f4d6a0abad",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f0f8b1a076c362c6e26570a2129809f4d6a0abad/comments",
    "author": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "58232e3ffb319d27b41cfe040cfea8e43a3fb7e9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/58232e3ffb319d27b41cfe040cfea8e43a3fb7e9",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/58232e3ffb319d27b41cfe040cfea8e43a3fb7e9"
      }
    ],
    "stats": {
      "total": 59,
      "additions": 42,
      "deletions": 17
    },
    "files": [
      {
        "sha": "18f1de0926259300fa3e1628beccf99036b6b966",
        "filename": "test/sanitizer_suppressions/ubsan",
        "status": "modified",
        "additions": 42,
        "deletions": 17,
        "changes": 59,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f0f8b1a076c362c6e26570a2129809f4d6a0abad/test/sanitizer_suppressions/ubsan",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f0f8b1a076c362c6e26570a2129809f4d6a0abad/test/sanitizer_suppressions/ubsan",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/sanitizer_suppressions/ubsan?ref=f0f8b1a076c362c6e26570a2129809f4d6a0abad",
        "patch": "@@ -1,3 +1,7 @@\n+# -fsanitize=undefined suppressions\n+# =================================\n+# No suppressions at the moment. Hooray!\n+\n # -fsanitize=integer suppressions\n # ===============================\n # Unsigned integer overflow occurs when the result of an unsigned integer\n@@ -6,7 +10,8 @@\n # contains files in which we expect unsigned integer overflows to occur. The\n # list is used to suppress -fsanitize=integer warnings when running our CI UBSan\n # job.\n-unsigned-integer-overflow:*/include/c++/*/bits/basic_string.tcc\n+unsigned-integer-overflow:*/include/c++/\n+unsigned-integer-overflow:addrman.cpp\n unsigned-integer-overflow:arith_uint256.h\n unsigned-integer-overflow:basic_string.h\n unsigned-integer-overflow:bench/bench.h\n@@ -15,34 +20,41 @@ unsigned-integer-overflow:bloom.cpp\n unsigned-integer-overflow:chain.cpp\n unsigned-integer-overflow:chain.h\n unsigned-integer-overflow:coded_stream.h\n+unsigned-integer-overflow:coins.cpp\n+unsigned-integer-overflow:compressor.cpp\n unsigned-integer-overflow:core_write.cpp\n-unsigned-integer-overflow:crypto/*\n+unsigned-integer-overflow:crypto/\n+# unsigned-integer-overflow in FuzzedDataProvider's ConsumeIntegralInRange\n+unsigned-integer-overflow:FuzzedDataProvider.h\n unsigned-integer-overflow:hash.cpp\n-unsigned-integer-overflow:leveldb/db/log_reader.cc\n-unsigned-integer-overflow:leveldb/util/bloom.cc\n-unsigned-integer-overflow:leveldb/util/crc32c.h\n-unsigned-integer-overflow:leveldb/util/hash.cc\n+unsigned-integer-overflow:leveldb/\n unsigned-integer-overflow:policy/fees.cpp\n unsigned-integer-overflow:prevector.h\n+unsigned-integer-overflow:pubkey.h\n unsigned-integer-overflow:script/interpreter.cpp\n unsigned-integer-overflow:stl_bvector.h\n unsigned-integer-overflow:txmempool.cpp\n unsigned-integer-overflow:util/strencodings.cpp\n unsigned-integer-overflow:validation.cpp\n-\n-implicit-integer-sign-change:*/include/c++/*/bits/*.h\n+implicit-integer-sign-change:*/include/boost/\n+implicit-integer-sign-change:*/include/c++/\n implicit-integer-sign-change:*/new_allocator.h\n-implicit-integer-sign-change:/usr/include/boost/date_time/format_date_parser.hpp\n+implicit-integer-sign-change:addrman.h\n implicit-integer-sign-change:arith_uint256.cpp\n implicit-integer-sign-change:bech32.cpp\n implicit-integer-sign-change:bloom.cpp\n-implicit-integer-sign-change:chain.*\n+implicit-integer-sign-change:chain.cpp\n+implicit-integer-sign-change:chain.h\n implicit-integer-sign-change:coins.h\n implicit-integer-sign-change:compat/stdin.cpp\n implicit-integer-sign-change:compressor.h\n-implicit-integer-sign-change:crypto/*\n+implicit-integer-sign-change:crc32c/\n+implicit-integer-sign-change:crypto/\n+# implicit-integer-sign-change in FuzzedDataProvider's ConsumeIntegralInRange\n+implicit-integer-sign-change:FuzzedDataProvider.h\n implicit-integer-sign-change:key.cpp\n implicit-integer-sign-change:noui.cpp\n+implicit-integer-sign-change:policy/fees.cpp\n implicit-integer-sign-change:prevector.h\n implicit-integer-sign-change:protocol.cpp\n implicit-integer-sign-change:script/bitcoinconsensus.cpp\n@@ -53,24 +65,37 @@ implicit-integer-sign-change:test/coins_tests.cpp\n implicit-integer-sign-change:test/pow_tests.cpp\n implicit-integer-sign-change:test/prevector_tests.cpp\n implicit-integer-sign-change:test/sighash_tests.cpp\n+implicit-integer-sign-change:test/skiplist_tests.cpp\n implicit-integer-sign-change:test/streams_tests.cpp\n implicit-integer-sign-change:test/transaction_tests.cpp\n implicit-integer-sign-change:txmempool.cpp\n-implicit-integer-sign-change:util/strencodings.*\n+implicit-integer-sign-change:util/strencodings.cpp\n+implicit-integer-sign-change:util/strencodings.h\n implicit-integer-sign-change:validation.cpp\n implicit-integer-sign-change:zmq/zmqpublishnotifier.cpp\n implicit-signed-integer-truncation,implicit-integer-sign-change:chain.h\n implicit-signed-integer-truncation,implicit-integer-sign-change:test/skiplist_tests.cpp\n+implicit-signed-integer-truncation:addrman.cpp\n+implicit-signed-integer-truncation:addrman.h\n implicit-signed-integer-truncation:chain.h\n-implicit-signed-integer-truncation:crypto/*\n+implicit-signed-integer-truncation:crypto/\n implicit-signed-integer-truncation:cuckoocache.h\n-implicit-signed-integer-truncation:leveldb/*\n+implicit-signed-integer-truncation:leveldb/\n+implicit-signed-integer-truncation:net.cpp\n+implicit-signed-integer-truncation:net_processing.cpp\n implicit-signed-integer-truncation:streams.h\n implicit-signed-integer-truncation:test/arith_uint256_tests.cpp\n implicit-signed-integer-truncation:test/skiplist_tests.cpp\n implicit-signed-integer-truncation:torcontrol.cpp\n-implicit-unsigned-integer-truncation:crypto/*\n-implicit-unsigned-integer-truncation:leveldb/*\n+implicit-unsigned-integer-truncation:crypto/\n+implicit-unsigned-integer-truncation:leveldb/\n # std::variant warning fixed in https://github.com/gcc-mirror/gcc/commit/074436cf8cdd2a9ce75cadd36deb8301f00e55b9\n implicit-unsigned-integer-truncation:std::__detail::__variant::_Variant_storage\n-implicit-integer-sign-change:crc32c/*\n+shift-base:*/include/c++/\n+shift-base:arith_uint256.cpp\n+shift-base:crypto/\n+shift-base:hash.cpp\n+shift-base:leveldb/\n+shift-base:net_processing.cpp\n+shift-base:streams.h\n+shift-base:util/bip32.cpp"
      }
    ]
  }
]