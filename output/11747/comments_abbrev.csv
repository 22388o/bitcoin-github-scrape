sipa,2017-11-22T01:34:45Z,utACK e1a8ec56c56161be15af1c33067918959e2666de,https://github.com/bitcoin/bitcoin/pull/11747#issuecomment-346215979,346215979,
jonasschnelli,2017-11-22T19:27:44Z,"utACK e1a8ec56c56161be15af1c33067918959e2666de\n\nIs this something that should be backported?\nI guess this can hardly produce corruptions in block files due to always opening in write mode?\nWould the open fail if one symbolic links historical block files from a read only filesystem?",https://github.com/bitcoin/bitcoin/pull/11747#issuecomment-346450749,346450749,
laanwj,2017-11-23T19:19:41Z,"> Would the open fail if one symbolic links historical block files from a read only filesystem?\n\nRight - this is a permissions issue, not a corruption issue, opening a file for writing is harmless if you never write to it.\n\n~~utACK anyhow.~~ (was for previous version of this PR)",https://github.com/bitcoin/bitcoin/pull/11747#issuecomment-346685844,346685844,
Elbandi,2017-11-23T20:16:09Z,"i pushed a new commit with ""merge"" the two fopen as @promag recommended",https://github.com/bitcoin/bitcoin/pull/11747#issuecomment-346692208,346692208,
laanwj,2017-11-28T07:52:49Z,"I'd prefer reverting this to the previous version of the patch which didn't use ""a"".",https://github.com/bitcoin/bitcoin/pull/11747#issuecomment-347441501,347441501,
MarcoFalke,2017-11-28T16:39:54Z,"@Elbandi Mind pushing the previous version (likely e1a8ec5)?\n\n```sh\ngit checkout fix11745\ngit reset --hard ${commit_id_previous_version}\ngit push origin fix11745 -f",https://github.com/bitcoin/bitcoin/pull/11747#issuecomment-347583718,347583718,
promag,2017-11-28T18:20:48Z,"Yes, in any case it's preferable to limit the fix scope. Sorry for the noise, it sounded simpler.",https://github.com/bitcoin/bitcoin/pull/11747#issuecomment-347615730,347615730,
laanwj,2017-11-29T10:59:42Z,Merged e1a8ec5 through e970396,https://github.com/bitcoin/bitcoin/pull/11747#issuecomment-347825814,347825814,
promag,2017-11-22T14:14:16Z,"Isn't the following enough?\n```cpp\nFILE* file = fsbridge::fopen(path, fReadOnly ? ""rb"": ""ab+"");\nif (!file) {\n    LogPrintf(""Unable to open file %s\n"", path.string());\n    return nullptr;\n}\n```\nWhy the second attempt when it's not read only?\n\nEdit: updated example after comment below.",https://github.com/bitcoin/bitcoin/pull/11747#discussion_r152575751,152575751,src/validation.cpp
Elbandi,2017-11-22T15:13:34Z,"""w+"" is not good because it truncates the file.\nIf we want to merge the two fopen, the best write mode is ""ab+""",https://github.com/bitcoin/bitcoin/pull/11747#discussion_r152592909,152592909,src/validation.cpp
promag,2017-11-22T15:54:02Z,"Yes! Saw the manpage, but forgot to change after paste.",https://github.com/bitcoin/bitcoin/pull/11747#discussion_r152605437,152605437,src/validation.cpp
laanwj,2017-11-23T20:23:09Z,"Don't some operating systems enforce the append bit, so that you can really only append?\nFrom the man page:\n```\n       a+     Open for reading and appending (writing at end of file).  The file is created if it does not exist.  The initial  file  position  for\n              reading is at the beginning of the file, but output is always appended to the end of the file.\n```\nI don't think t",https://github.com/bitcoin/bitcoin/pull/11747#discussion_r152867976,152867976,src/validation.cpp
