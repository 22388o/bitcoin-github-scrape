practicalswift,2019-10-30 20:43:23,Concept ACK,https://github.com/bitcoin/bitcoin/pull/17325#issuecomment-548103941,548103941,
hebasto,2019-10-31 17:01:01,All comments have been addressed.,https://github.com/bitcoin/bitcoin/pull/17325#issuecomment-548472394,548472394,
jnewbery,2019-10-31 22:45:23,"Tested ACK 8a0ca5e9de021ce2f722b321f27208a7bc7110f7\n\nIf we wanted to be completely explicit we could log ""Script verification uses main thread and %d dedicated threads\n""",https://github.com/bitcoin/bitcoin/pull/17325#issuecomment-548598405,548598405,
laanwj,2019-11-01 09:47:45,"ACK 8a0ca5e9de021ce2f722b321f27208a7bc7110f7\n\n> If we wanted to be completely explicit we could log ""Script verification uses main thread and %d dedicated threads\n""\n\nI know bitcoin core is lacking in user documentation, but I don't think the debug log is the place for it :smile: \nThe value is now correct, which is good for troubleshooting.\n",https://github.com/bitcoin/bitcoin/pull/17325#issuecomment-548728603,548728603,
laanwj,2019-10-30 20:44:27,"Concept ACK, my only comment would be ~~that `-par=0` and `-par=1` do the same thing (right?)~~, but log different messages.",https://github.com/bitcoin/bitcoin/pull/17325#discussion_r340848291,340848291,src/init.cpp
hebasto,2019-10-30 20:50:56,"Not exactly:\nhttps://github.com/bitcoin/bitcoin/blob/08e29473126d5cc4df6d2b3f368c6f6f641c0bd8/src/init.cpp#L380",https://github.com/bitcoin/bitcoin/pull/17325#discussion_r340851318,340851318,src/init.cpp
laanwj,2019-10-31 08:19:01,"Wait, I'm not really  talking about the input argument, but the already-processed value we end up with here.\n\nIt's doing the same thing in case of `nScriptCheckThreads==0` and `nScriptCheckThreads==1` so should log the same thing.",https://github.com/bitcoin/bitcoin/pull/17325#discussion_r341004229,341004229,src/init.cpp
hebasto,2019-10-31 09:58:31,"After this code\nhttps://github.com/bitcoin/bitcoin/blob/08e29473126d5cc4df6d2b3f368c6f6f641c0bd8/src/init.cpp#L1064-L1071\n\nis executed in `AppInitParameterInteraction()`, `nScriptCheckThreads==1` is an impossible value.",https://github.com/bitcoin/bitcoin/pull/17325#discussion_r341045579,341045579,src/init.cpp
laanwj,2019-10-31 11:33:46,"Ok, so it will never log `Using 1 threads concurrently for script verification`?",https://github.com/bitcoin/bitcoin/pull/17325#discussion_r341087526,341087526,src/init.cpp
hebasto,2019-10-31 11:37:48,Sure.,https://github.com/bitcoin/bitcoin/pull/17325#discussion_r341089094,341089094,src/init.cpp
practicalswift,2019-10-31 12:09:25,"Something feels a bit off with the wording here. What about ""Using one thread for script verification""?",https://github.com/bitcoin/bitcoin/pull/17325#discussion_r341101216,341101216,src/init.cpp
laanwj,2019-10-31 12:15:23,"It's not just any thread though, it's the main thread. No additional threads are spawned. I think that's what he's trying to convey.",https://github.com/bitcoin/bitcoin/pull/17325#discussion_r341103598,341103598,src/init.cpp
practicalswift,2019-10-31 12:28:11,"What about:\n\n""Validation concurrency disabled: using the main thread for script validation.""",https://github.com/bitcoin/bitcoin/pull/17325#discussion_r341108492,341108492,src/init.cpp
hebasto,2019-10-31 12:38:22,"Isn't this the thread:\nhttps://github.com/bitcoin/bitcoin/blob/feb1a8c03aff0d37730d80eee7a05cc7e4729850/src/init.cpp#L1267\n?",https://github.com/bitcoin/bitcoin/pull/17325#discussion_r341112473,341112473,src/init.cpp
laanwj,2019-10-31 12:48:56,"That spawns the scheduler thread, which is unrelated to script verification.",https://github.com/bitcoin/bitcoin/pull/17325#discussion_r341116650,341116650,src/init.cpp
MarcoFalke,2019-10-31 14:33:16,"On `-par=1`, it will inline the calls into the current thread. See also:\n\n```\ngit grep '\-par=' test",https://github.com/bitcoin/bitcoin/pull/17325#discussion_r341171575,341171575,src/init.cpp
MarcoFalke,2019-10-31 14:35:04,"```suggestion\n        LogPrintf(""Script verification is done in the main thread\n"");\n```",https://github.com/bitcoin/bitcoin/pull/17325#discussion_r341172669,341172669,src/init.cpp
laanwj,2019-10-31 15:41:38,"But script verification is always done in the main thread (as well), the other threads are only additional :smile: ",https://github.com/bitcoin/bitcoin/pull/17325#discussion_r341213655,341213655,src/init.cpp
practicalswift,2019-10-31 15:55:15,"""Script verification is done in the main thread only (no validation concurrency)""",https://github.com/bitcoin/bitcoin/pull/17325#discussion_r341222015,341222015,src/init.cpp
laanwj,2019-10-31 15:59:39,"or ""Script verification uses N additional threads"" where N can be 0â€¦ it doesn't have to be a whole story ",https://github.com/bitcoin/bitcoin/pull/17325#discussion_r341224670,341224670,src/init.cpp
MarcoFalke,2019-10-31 16:07:26,"Yeah, let's make it a one-line ""fix""",https://github.com/bitcoin/bitcoin/pull/17325#discussion_r341229093,341229093,src/init.cpp
hebasto,2019-10-31 16:17:22,"> Yeah, let's make it a one-line ""fix""\n\nNot sure about ""one-line fix"" as actual _additional_ threads number is `nScriptCheckThreads-1`.",https://github.com/bitcoin/bitcoin/pull/17325#discussion_r341234655,341234655,src/init.cpp
laanwj,2019-10-31 16:35:51,"shortest would be\n```c++\nLogPrintf(""Script verification uses %d additional threads\m"", std::max(nScriptCheckThreads-1, 0));\n```",https://github.com/bitcoin/bitcoin/pull/17325#discussion_r341244635,341244635,src/init.cpp
hebasto,2019-10-31 16:52:00,"True, it is shorter than conditional operator ;)",https://github.com/bitcoin/bitcoin/pull/17325#discussion_r341252932,341252932,src/init.cpp
jnewbery,2019-10-31 21:42:27,"~I don't think this should be `nScriptCheckThreads-1`. `nScriptCheckThreads` is the number of threads that are dedicated to script checking, so:~\n\n- ~if `nScriptCheckThreads` >= 2, then log ""Script verification uses {nScriptCheckThreads} additional threads""~\n- ~if `nScriptCheckThreads` == 0, then script checking is done on the main thread so log ""Script verification uses 0 additional threads",https://github.com/bitcoin/bitcoin/pull/17325#discussion_r341378185,341378185,src/init.cpp
sipa,2019-10-31 22:16:02,"That's not correct; it should be `LogPrintf(""Script verification uses %d dedicated threads\m"", nScriptCheckThreads - 1);` then, as `nScriptCheckThreads` includes the main thread.",https://github.com/bitcoin/bitcoin/pull/17325#discussion_r341388299,341388299,src/init.cpp
laanwj,2019-11-01 09:48:51,"@sipa The `std::max(nScriptCheckThreads-1, 0)` bound is there because nScriptCheckThreads might be zero at this point.",https://github.com/bitcoin/bitcoin/pull/17325#discussion_r341509120,341509120,src/init.cpp
