mzumsande,2021-04-21 21:13:08,"@jonatack , @amitiuttarwar Thanks a lot for the reviews! I addressed all comments above.\n\n> the commit message for [6041280](https://github.com/bitcoin/bitcoin/commit/604128088ebf7ea0ce795c9683e32ee40daac7ed) says ""[test] Extract setting up addr message into a helper"", but it really extracts _sending_ addr message, with the previous commit extracting the set up. this was my fault, but I just n",https://github.com/bitcoin/bitcoin/pull/21707#issuecomment-824361280,824361280,
amitiuttarwar,2021-04-22 18:03:02,"re-ACK a732ee353c, small diff based on code review \n\n> I agree, the fGetAddr flag preventing this was ... \n\nthanks for that explanation, I'll take a closer look!",https://github.com/bitcoin/bitcoin/pull/21707#issuecomment-825068897,825068897,
jonatack,2021-04-19 13:20:08,"style nit, here and line 202\n```suggestion\n        assert full_outbound_peer.getaddr_received\n```",https://github.com/bitcoin/bitcoin/pull/21707#discussion_r615841194,615841194,test/functional/p2p_addr_relay.py
jonatack,2021-04-19 13:21:51,"We can now use Python f-strings for interpolation (here and e.g. line 70 above).\n```suggestion\n            a = f""{first_octet}.{second_octet}.1.1""\n```",https://github.com/bitcoin/bitcoin/pull/21707#discussion_r615842564,615842564,test/functional/p2p_addr_relay.py
amitiuttarwar,2021-04-20 23:04:24,"```suggestion\n		self.log.info('Check that we send a getaddr message upon connecting to an outbound-full-relay peer')\n```",https://github.com/bitcoin/bitcoin/pull/21707#discussion_r617089977,617089977,test/functional/p2p_addr_relay.py
amitiuttarwar,2021-04-20 23:09:52,"same as previous,\n\n```suggestion\n		self.log.info('Check that we do not send a getaddr message upon connecting to a block-relay-only peer')\n```",https://github.com/bitcoin/bitcoin/pull/21707#discussion_r617091871,617091871,test/functional/p2p_addr_relay.py
amitiuttarwar,2021-04-20 23:12:12,"I didn't know about this endpoint, nice :) ",https://github.com/bitcoin/bitcoin/pull/21707#discussion_r617092786,617092786,test/functional/p2p_addr_relay.py
amitiuttarwar,2021-04-20 23:13:45,"I think this change from 30 min to 5 min makes more sense as part of the 2nd commit, ""[test] Extract setting up addr message into a helper""",https://github.com/bitcoin/bitcoin/pull/21707#discussion_r617093266,617093266,test/functional/p2p_addr_relay.py
amitiuttarwar,2021-04-20 23:19:24,is this `sync_with_ping()` necessary?  ,https://github.com/bitcoin/bitcoin/pull/21707#discussion_r617095257,617095257,test/functional/p2p_addr_relay.py
amitiuttarwar,2021-04-21 02:07:26,"s/further/subsequent? later? \n\nmy brain keeps thinking ""further"" relates to how far the message propagates through network nodes. ",https://github.com/bitcoin/bitcoin/pull/21707#discussion_r617150779,617150779,test/functional/p2p_addr_relay.py
mzumsande,2021-04-21 20:20:44,fixed,https://github.com/bitcoin/bitcoin/pull/21707#discussion_r617850478,617850478,test/functional/p2p_addr_relay.py
mzumsande,2021-04-21 20:22:30,"TIL, nice. Changed the two occurrences where the line is touched anyway.",https://github.com/bitcoin/bitcoin/pull/21707#discussion_r617851426,617851426,test/functional/p2p_addr_relay.py
mzumsande,2021-04-21 20:23:03,done,https://github.com/bitcoin/bitcoin/pull/21707#discussion_r617851714,617851714,test/functional/p2p_addr_relay.py
mzumsande,2021-04-21 20:23:16,done,https://github.com/bitcoin/bitcoin/pull/21707#discussion_r617851824,617851824,test/functional/p2p_addr_relay.py
mzumsande,2021-04-21 20:26:11,"Actually, I copied this block from `p2p_getaddr_caching.py` :smile:",https://github.com/bitcoin/bitcoin/pull/21707#discussion_r617853447,617853447,test/functional/p2p_addr_relay.py
mzumsande,2021-04-21 20:26:39,"done, I agree.",https://github.com/bitcoin/bitcoin/pull/21707#discussion_r617853696,617853696,test/functional/p2p_addr_relay.py
mzumsande,2021-04-21 20:26:57,changed the wording,https://github.com/bitcoin/bitcoin/pull/21707#discussion_r617853893,617853893,test/functional/p2p_addr_relay.py
mzumsande,2021-04-21 20:36:54,"No, the sync is done in `send_addr_msg` in the next line. Removed.",https://github.com/bitcoin/bitcoin/pull/21707#discussion_r617859647,617859647,test/functional/p2p_addr_relay.py
jnewbery,2021-04-26 08:35:27,Any reason not to use the `send_addr_msg()` helper here?,https://github.com/bitcoin/bitcoin/pull/21707#discussion_r620085210,620085210,test/functional/p2p_addr_relay.py
mzumsande,2021-04-26 18:59:51,"I missed this when combining test commits from different branches. \n@amitiuttarwar would you like to apply this refactor in  #21528 when you touch the test again?",https://github.com/bitcoin/bitcoin/pull/21707#discussion_r620568642,620568642,test/functional/p2p_addr_relay.py
MarcoFalke,2021-04-27 09:46:35,"This fails:\n\n* https://cirrus-ci.com/task/4959397244829696?logs=ci#L6318",https://github.com/bitcoin/bitcoin/pull/21707#discussion_r621048952,621048952,test/functional/p2p_addr_relay.py
mzumsande,2021-04-27 10:28:08,"The expected addr message is sent directly after the assert has failed, so it looks like a timing issue:\n` node0 2021-04-27T06:55:10.562357Z (mocktime: 2021-04-27T07:10:08Z) [net.cpp:2967] [PushMessage] sending addr (61 bytes) peer=9 ` (https://cirrus-ci.com/task/4959397244829696?logs=ci#L6320)\nWith `AVG_ADDRESS_BROADCAST_INTERVAL=30s`, I thought that a mocktime of 5 mins should be plenty to p",https://github.com/bitcoin/bitcoin/pull/21707#discussion_r621078686,621078686,test/functional/p2p_addr_relay.py
MarcoFalke,2021-04-27 11:16:30,fixed in #21785,https://github.com/bitcoin/bitcoin/pull/21707#discussion_r621110409,621110409,test/functional/p2p_addr_relay.py
jnewbery,2021-04-29 06:54:39,Done in #21785,https://github.com/bitcoin/bitcoin/pull/21707#discussion_r622778884,622778884,test/functional/p2p_addr_relay.py
