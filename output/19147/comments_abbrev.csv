naumenkogs,2020-06-03 04:28:59,"This is a quite exotic case. As you mention, there are much worse thing that can be done if an attacker (even temporarily) can MitM a connection.\n\nI think it may be a good idea to document this property of BanMan, but I'd prefer to be more brief.\nSomething like this:\n\n``\nBanMan can be exploited by an on-path attacker: not necessarily user's hosting ISP, but any ""critical"" ISP on the wa",https://github.com/bitcoin/bitcoin/pull/19147#issuecomment-637944916,637944916,
ariard,2020-06-05 21:46:31,"Thanks @naumenkogs, updated with your wording with still a reference to Erebus to provide context and threat model comparison.",https://github.com/bitcoin/bitcoin/pull/19147#issuecomment-639839651,639839651,
ariard,2020-06-05 21:47:12,@mzumsande you may be interested based on review club IRC discussion IIRC,https://github.com/bitcoin/bitcoin/pull/19147#issuecomment-639840005,639840005,
naumenkogs,2020-06-06 13:40:05,"Almost ACK the text now. I see some English grammar issues (""pursue with"", and this sentence is just too long). \n\nAlso, I don't understand the part about less efficient attack Also not sure about ""peers can be hijacked"".\nI'd drop that part because:\n1. What do you mean efficient? We don't really now what an actual full attack based on this thing may be, so it's hard to compare.\n2. I feel ",https://github.com/bitcoin/bitcoin/pull/19147#issuecomment-640062897,640062897,
ariard,2020-06-09 06:54:38,"@naumenkogs \n\n>  What do you mean efficient? We don't really now what an actual full attack based on this thing may be, so it's hard to compare.\n \nRight, what I intended by documenting is raising awareness about this potential vector of exploitation. It's hard to compare with the state of your knowledge, so I modified to say that any mitigation deployed for same threat model (e.g Erebus) i",https://github.com/bitcoin/bitcoin/pull/19147#issuecomment-641072805,641072805,
DrahtBot,2020-06-18 15:11:27,<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.,https://github.com/bitcoin/bitcoin/pull/19147#issuecomment-646084449,646084449,
sipa,2020-07-07 18:40:13,This probably needs redoing after the changes from #19219.,https://github.com/bitcoin/bitcoin/pull/19147#issuecomment-655049878,655049878,
ariard,2020-08-29 00:23:11,"Rebased and changed to explicit mention discouragement logic, no more `BanMan`.\n\nThanks @naumenkogs, @jonatack and @sipa for past reviews. I stopped sleeping on this, if you think this is still worthy to get in, I invite you to review again.\n\n@jnewbery it seems your [comment](https://github.com/bitcoin/bitcoin/pull/19147#discussion_r441825225) leans towards a Concept NACK. I understand the",https://github.com/bitcoin/bitcoin/pull/19147#issuecomment-683201224,683201224,
jnewbery,2020-08-31 10:09:24,"> where such documentation should belong ? \n\nMy suggestion was https://github.com/bitcoin-core/bitcoin-devwiki/wiki/P2P-Design-Philosophy",https://github.com/bitcoin/bitcoin/pull/19147#issuecomment-683689623,683689623,
ariard,2020-09-03 19:15:07,"I think that such P2P design philosophy is too high-level when describing the context of one logic in particular as this PR was aiming for. And documentation-around-code is more timeless than documentation-around-external-web-platform. But let's close it, we can still get back to it when we have a more consensual idea on how to effectively organize p2p documentation.",https://github.com/bitcoin/bitcoin/pull/19147#issuecomment-686704221,686704221,
luke-jr,2020-06-05 17:12:17,"""unlawful""?",https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436053295,436053295,src/banman.h
luke-jr,2020-06-05 17:12:41,Couldn't such attackers just block the connection ?,https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436053503,436053503,src/banman.h
ariard,2020-06-05 21:35:54,"Sure, an on-path attacker can drop the connection, but if honest peers have another connection path without him on it, that's still work. I would say banning is more harmful than a connection drop, and so more interesting ?",https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436174733,436174733,src/banman.h
ariard,2020-06-05 21:38:52,"Yes I need a better wording here, with regards to banning a misbehavior is qualified but in reality both peers are honest ?",https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436175777,436175777,src/banman.h
jonatack,2020-06-06 13:51:38,I think you want s/on the way/in the path/ here.,https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436270642,436270642,src/banman.h
jonatack,2020-06-06 13:53:52,"It looks like you're translating from French *sain* directly to ""sane"" but describing the sanity of nodes seems a bit odd. Maybe ""normal"" or ""healthy"", or just omit ""sane"".",https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436270785,436270785,src/banman.h
jonatack,2020-06-06 13:54:23,in a way that is favorable,https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436270809,436270809,src/banman.h
jonatack,2020-06-06 13:55:55,"s/on-path/in-the-path/ ?\n\ns/:/;/\n\nsuggest: s/can/can potentially/ or ""may""",https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436270957,436270957,src/banman.h
jonatack,2020-06-06 13:56:28,s/user's/the user's/,https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436271009,436271009,src/banman.h
jonatack,2020-06-06 13:58:54,"If with ""to pursue with"" you had *poursuivre* in mind, then perhaps s/to pursue with/carrying out/\n\ns/to trigger honest sane nodes banning/triggering honest nodes to ban/",https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436271209,436271209,src/banman.h
jonatack,2020-06-06 14:02:20,"suggest: ""An impersonation attack like this would be less...""",https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436271436,436271436,src/banman.h
naumenkogs,2020-06-06 20:17:09,"Nope, this was my suggestion (see above).\nI use honest + sane to highlight that nodes may be honest but just broken, like due to hardware issues or whatnot. Healthy may be a better alternative",https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436297646,436297646,src/banman.h
jonatack,2020-06-07 06:05:36,"Ok. ""honest but just broken"" is good but an additional meaning that doesn't make sense in this case, IIUC? Perhaps ""honest, otherwise-healthy nodes mistakenly banning each other."" Though honest on its own could be enough, too.",https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436328707,436328707,src/banman.h
naumenkogs,2020-06-07 06:44:57,"Now I agree, just ""honest"" is probably fine.",https://github.com/bitcoin/bitcoin/pull/19147#discussion_r436331369,436331369,src/banman.h
ariard,2020-06-09 06:38:41,On-path attacker has some reference in network security literature so will keep it.,https://github.com/bitcoin/bitcoin/pull/19147#discussion_r437169824,437169824,src/banman.h
ariard,2020-06-09 06:39:05,"Updated to ""between peers""",https://github.com/bitcoin/bitcoin/pull/19147#discussion_r437169974,437169974,src/banman.h
luke-jr,2020-06-09 07:38:06,undesirable?,https://github.com/bitcoin/bitcoin/pull/19147#discussion_r437198410,437198410,src/banman.h
sipa,2020-06-09 08:06:18,"I think this is formulated confusingly: these are attacks on address management in general, and to an extent to banning logic specifically. But it isn't an attack on BanMan, which is just a storage object for keeping track lf bans that were decided elsewhere.",https://github.com/bitcoin/bitcoin/pull/19147#discussion_r437214847,437214847,src/banman.h
jnewbery,2020-06-15 20:25:36,"I agree. This content is interesting, but I don't think it should be a code comment in BanMan. It's describing a consequence of the misbehaviour -> disconnect logic.\n\nNote that peers that are disconnected for misbehaviour are still allowed to reconnect, but are preferred for peer eviction over other peers. There's currently a PR open to change the terminology to 'discouraged' (#19219)",https://github.com/bitcoin/bitcoin/pull/19147#discussion_r440426487,440426487,src/banman.h
ariard,2020-06-17 20:22:26,"@sipa Actually when I look on it at first, current way we store it, i.e by IP address sounds to me a bit insecure, it would let IP spoofing to disconnect UDP-based connections. Using TCP by default, and this protocol mandating a handshake it prevents exploitation by any Internet host. But agree, it should be a comment on address management/banning logic.\n\n@jnewbery do you suggest this code sho",https://github.com/bitcoin/bitcoin/pull/19147#discussion_r441810709,441810709,src/banman.h
jnewbery,2020-06-17 20:48:20,"> do you suggest this code should go around net_processing Misbehaving ? Our disconnect logic isn't encapsulated in a specific location.\n\nI think it's unrealistic to expect code comments to document all the implications of the logic. It can document the general principals, and how the code is implementing them, but any more detailed documentation probably lives outside the codebase, perhaps in",https://github.com/bitcoin/bitcoin/pull/19147#discussion_r441825225,441825225,src/banman.h
sipa,2020-06-17 20:48:27,"@ariard Yes, I completely agree. But this are exploits related to *banning* as a concept; it isn't an exploit of *BanMan* (by stating it this way it sounds like you're talking about a DoS attack on its data structures or something).",https://github.com/bitcoin/bitcoin/pull/19147#discussion_r441825289,441825289,src/banman.h
