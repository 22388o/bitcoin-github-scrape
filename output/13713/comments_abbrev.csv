fanquake,2018-07-21T04:45:36Z,Note previous discussion about `-stopatheight` in #13490.,https://github.com/bitcoin/bitcoin/pull/13713#issuecomment-406770397,406770397,
laanwj,2018-08-31T13:10:50Z,"> Note previous discussion about -stopatheight in #13490.\n\nI tend to agree with @sdaftuar's reasoning that it is undesirable to burden the validation code further with this.\n\nThen again, if we're not going to fix this we should close #13477 (with ""wontfix"" and this reasoning), otherwise people will wasting time trying to fix it.",https://github.com/bitcoin/bitcoin/pull/13713#issuecomment-417659198,417659198,
DrahtBot,2018-09-07T21:00:04Z,"<!--5d09a71f8925f3f132321140b44b946d-->The last travis run for this pull request was 50 days ago and is thus outdated. To trigger a fresh travis build, this pull request should be closed and re-opened.",https://github.com/bitcoin/bitcoin/pull/13713#issuecomment-419564377,419564377,
Sjors,2018-09-08T15:15:24Z,"This change is already a lot smaller than the previous attempt.\n\nBeing able to produce a deterministic UTXO set for a given height, as well as block files and indexes, could be quite useful. There may be other approaches than `-stopatheight`, or perhaps we can fix `-stopatheight` in a less disruptive way, e.g. by rolling back after overshooting.",https://github.com/bitcoin/bitcoin/pull/13713#issuecomment-419650226,419650226,
Sjors,2018-09-10T07:25:58Z,Lightly tested on testnet and it seems to indeed fix the issue.,https://github.com/bitcoin/bitcoin/pull/13713#issuecomment-419814414,419814414,
NicolasDorier,2018-11-28T06:19:09Z,"@jonasschnelli this is not good.\nHere is what I wished I could do:\n\n```bash\nbitcoind -stopatheight 500000\n# Wait it reached it\nbitcoin-cli gettxoutsetinfo\n# Note the UTXOSet hash\nbitcoin-cli stop\ntar xcf ""bitcoin-chainstate-snapshot-500000.tar"" ~/.bitcoin/chainstate\n# Upload the  bitcoin-chainstate-snapshot-500000.tar on a public location\n# Sign the snapshot shasum\n```\n\",https://github.com/bitcoin/bitcoin/pull/13713#issuecomment-442333282,442333282,
Sjors,2018-11-30T11:01:56Z,@NicolasDorier I totally agree your workflow is what we should strive for. However this PR only fixes a bug in the existing behaviour. Let's redefine `-stopatheight` (e.g. by adding a `stop_sync_but_dont_exit` param) in a followup PR.,https://github.com/bitcoin/bitcoin/pull/13713#issuecomment-443169513,443169513,
NicolasDorier,2018-11-30T13:56:25Z,"Ah got it, this is already the current situation. I misunderstood thinking it was changing the behavior.",https://github.com/bitcoin/bitcoin/pull/13713#issuecomment-443210560,443210560,
DrahtBot,2019-03-15T17:31:26Z,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#15948](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15948.html) (refactor: rename chainActive by jamesob)\n\",https://github.com/bitcoin/bitcoin/pull/13713#issuecomment-473376526,473376526,
DrahtBot,2019-05-07T16:07:41Z,<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase,https://github.com/bitcoin/bitcoin/pull/13713#issuecomment-490144991,490144991,
DrahtBot,2019-09-30T13:02:29Z,"<!--5fd3d806e98f4a0ca80977bb178665a0-->There hasn't been much activity lately and the patch still needs rebase, so I am closing this for now. Please let me know when you want to continue working on this, so the pull request can be re-opened.",https://github.com/bitcoin/bitcoin/pull/13713#issuecomment-536550517,536550517,
l2a5b1,2018-07-19T15:27:02Z,"Can you explain the `&& ShutdownRequested()` in the boolean expression?\n\nIf it is here to catch the `StartShutdown()` below, the `do` .. `while` loop is already terminated before it can reach this `if` statement.\n\n```c++\n        if (nStopAtHeight && pindexNewTip && pindexNewTip->nHeight >= nStopAtHeight) {\n            LogPrintf(""-stopatheight target (%d) reached, shutting down\n"", nSto",https://github.com/bitcoin/bitcoin/pull/13713#discussion_r203771068,203771068,src/validation.cpp
jonasschnelli,2018-07-19T19:45:58Z,"The upper if statement with the `ShutdownRequested()` does make sure that on future calls of ActivateBestChain() and after `StartShutdown()` will not process blocks when stopheight is set at a shutdown is triggered.\n\nThe lower if statement is there to trigger the shutdown.",https://github.com/bitcoin/bitcoin/pull/13713#discussion_r203849000,203849000,src/validation.cpp
NicolasDorier,2018-11-30T14:04:21Z,"What I don't understand is that if `ShutdownRequested()` is false, then you will end up processing one more block, and this is not what you want. Removing `ShutdownRequested()` and just call `StartShutdown` at this place?",https://github.com/bitcoin/bitcoin/pull/13713#discussion_r237870403,237870403,src/validation.cpp
