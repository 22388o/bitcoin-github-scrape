[
  {
    "sha": "6b5506a28632b57c0c75c7cc66c0bc35d419b682",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2YjU1MDZhMjg2MzJiNTdjMGM3NWM3Y2M2NmMwYmMzNWQ0MTliNjgy",
    "commit": {
      "author": {
        "name": "Fuzzbawls",
        "email": "fuzzbawls@gmail.com",
        "date": "2018-07-21T06:21:50Z"
      },
      "committer": {
        "name": "Fuzzbawls",
        "email": "fuzzbawls@gmail.com",
        "date": "2018-07-25T20:53:53Z"
      },
      "message": "Fix Qt's rcc determinism for depends/gitian\n\nBackport of https://bugreports.qt.io/browse/QTBUG-62511 to resolve\nlocale determinism during the build process.",
      "tree": {
        "sha": "d1d56cb7777283eafe61ad4ae87e6df680336eae",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d1d56cb7777283eafe61ad4ae87e6df680336eae"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6b5506a28632b57c0c75c7cc66c0bc35d419b682",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEEb5k7JQVX57AWreVxO9zaLYeogdkFAltY42EACgkQO9zaLYeo\ngdlOdg//fYHjv2W5JCHgF0YxsDnQ9FAC9UWnHo+LJoiubSfAKwIuWhgPYYbOkBGO\n0F4Jhggnzthsm5PHK3UKIvja1i72ciGlhZKxUrRQAy0dPRzfoaTCliAOM0DIHMK0\nsGA8I3/BdEKhRWXZD5eEEQEZNRyxz1PpSn4ltUIk6HmENYT4FOe7kFUe1DV2UjbB\nN2v0Yv50aQTadOAH3napxONDbhktjF0K09bFj+XMMszxPlZBftFqe6pwCt6VNDzM\ngLmvzuOn7bmEzdAbZX8OkVQs+ZNTATQnWy9cKgalXB53KcSK28FEJ1wU6NWvA8Fb\nwNi4l0FObFBL6eXfPkwyM0DKvS2LIvJur7dkHMLx8bQ86xuIEGdcrqUyF8vitCKm\nGVoocoV9DNwfabVDrZIAm1VjP3TLCiKLvIh+nfQaPJuelcCOZUNtpwmzKVLi4Olf\neuCkkkAzgnkioFPiOlC3AEh0beGVMqpRUzrZYG5Fub0rWm9aYSBfyI4tx3ipp/FK\n+65KTKWn6xmXN3bqnQs9D1wgeLeblS1F2L7sdLqhqvQCbMmqTbAl0WFCyqib9Hff\nB5rrSfBl4sP8K0PWAZopDCn9Hbuq675kbh35j+zXjcTuXHUZwGisEpJhqUXeN/pw\nntyip4GgOgnNmsB7SXiF+TV6Kt6QqBexwJX8umpNK9wlFf7FqYQ=\n=bkbT\n-----END PGP SIGNATURE-----",
        "payload": "tree d1d56cb7777283eafe61ad4ae87e6df680336eae\nparent 07ce278455757fb46dab95fb9b97a3f6b1b84faf\nauthor Fuzzbawls <fuzzbawls@gmail.com> 1532154110 -0700\ncommitter Fuzzbawls <fuzzbawls@gmail.com> 1532552033 -0700\n\nFix Qt's rcc determinism for depends/gitian\n\nBackport of https://bugreports.qt.io/browse/QTBUG-62511 to resolve\nlocale determinism during the build process.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6b5506a28632b57c0c75c7cc66c0bc35d419b682",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/6b5506a28632b57c0c75c7cc66c0bc35d419b682",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6b5506a28632b57c0c75c7cc66c0bc35d419b682/comments",
    "author": {
      "login": "Fuzzbawls",
      "id": 7393257,
      "node_id": "MDQ6VXNlcjczOTMyNTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7393257?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Fuzzbawls",
      "html_url": "https://github.com/Fuzzbawls",
      "followers_url": "https://api.github.com/users/Fuzzbawls/followers",
      "following_url": "https://api.github.com/users/Fuzzbawls/following{/other_user}",
      "gists_url": "https://api.github.com/users/Fuzzbawls/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Fuzzbawls/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Fuzzbawls/subscriptions",
      "organizations_url": "https://api.github.com/users/Fuzzbawls/orgs",
      "repos_url": "https://api.github.com/users/Fuzzbawls/repos",
      "events_url": "https://api.github.com/users/Fuzzbawls/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Fuzzbawls/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "Fuzzbawls",
      "id": 7393257,
      "node_id": "MDQ6VXNlcjczOTMyNTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7393257?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Fuzzbawls",
      "html_url": "https://github.com/Fuzzbawls",
      "followers_url": "https://api.github.com/users/Fuzzbawls/followers",
      "following_url": "https://api.github.com/users/Fuzzbawls/following{/other_user}",
      "gists_url": "https://api.github.com/users/Fuzzbawls/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Fuzzbawls/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Fuzzbawls/subscriptions",
      "organizations_url": "https://api.github.com/users/Fuzzbawls/orgs",
      "repos_url": "https://api.github.com/users/Fuzzbawls/repos",
      "events_url": "https://api.github.com/users/Fuzzbawls/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Fuzzbawls/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "07ce278455757fb46dab95fb9b97a3f6b1b84faf",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/07ce278455757fb46dab95fb9b97a3f6b1b84faf",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/07ce278455757fb46dab95fb9b97a3f6b1b84faf"
      }
    ],
    "stats": {
      "total": 22,
      "additions": 21,
      "deletions": 1
    },
    "files": [
      {
        "sha": "4255fb0c9a96bc54e18580f52e29f98476093639",
        "filename": "contrib/gitian-descriptors/gitian-linux.yml",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6b5506a28632b57c0c75c7cc66c0bc35d419b682/contrib/gitian-descriptors/gitian-linux.yml",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6b5506a28632b57c0c75c7cc66c0bc35d419b682/contrib/gitian-descriptors/gitian-linux.yml",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/gitian-descriptors/gitian-linux.yml?ref=6b5506a28632b57c0c75c7cc66c0bc35d419b682",
        "patch": "@@ -43,6 +43,7 @@ script: |\n   HOST_LDFLAGS=-static-libstdc++\n \n   export QT_RCC_TEST=1\n+  export QT_RCC_SOURCE_DATE_OVERRIDE=1\n   export GZIP=\"-9n\"\n   export TAR_OPTIONS=\"--mtime=\"$REFERENCE_DATE\\\\\\ $REFERENCE_TIME\"\"\n   export TZ=\"UTC\""
      },
      {
        "sha": "1f24f2c3c3599f6cedfd0f74bb65cd1fa3612ccb",
        "filename": "contrib/gitian-descriptors/gitian-osx.yml",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6b5506a28632b57c0c75c7cc66c0bc35d419b682/contrib/gitian-descriptors/gitian-osx.yml",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6b5506a28632b57c0c75c7cc66c0bc35d419b682/contrib/gitian-descriptors/gitian-osx.yml",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/gitian-descriptors/gitian-osx.yml?ref=6b5506a28632b57c0c75c7cc66c0bc35d419b682",
        "patch": "@@ -40,6 +40,7 @@ script: |\n   FAKETIME_PROGS=\"ar ranlib date dmg genisoimage\"\n \n   export QT_RCC_TEST=1\n+  export QT_RCC_SOURCE_DATE_OVERRIDE=1\n   export GZIP=\"-9n\"\n   export TAR_OPTIONS=\"--mtime=\"$REFERENCE_DATE\\\\\\ $REFERENCE_TIME\"\"\n   export TZ=\"UTC\""
      },
      {
        "sha": "2d48170649cecd2d9646753c329d0fdc56bb5e59",
        "filename": "contrib/gitian-descriptors/gitian-win.yml",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6b5506a28632b57c0c75c7cc66c0bc35d419b682/contrib/gitian-descriptors/gitian-win.yml",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6b5506a28632b57c0c75c7cc66c0bc35d419b682/contrib/gitian-descriptors/gitian-win.yml",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/gitian-descriptors/gitian-win.yml?ref=6b5506a28632b57c0c75c7cc66c0bc35d419b682",
        "patch": "@@ -36,6 +36,7 @@ script: |\n   HOST_CXXFLAGS=\"-O2 -g\"\n \n   export QT_RCC_TEST=1\n+  export QT_RCC_SOURCE_DATE_OVERRIDE=1\n   export GZIP=\"-9n\"\n   export TAR_OPTIONS=\"--mtime=\"$REFERENCE_DATE\\\\\\ $REFERENCE_TIME\"\"\n   export TZ=\"UTC\""
      },
      {
        "sha": "d7598be869dc2ed3fe27bd544828791069776c9c",
        "filename": "depends/packages/qt.mk",
        "status": "modified",
        "additions": 3,
        "deletions": 1,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6b5506a28632b57c0c75c7cc66c0bc35d419b682/depends/packages/qt.mk",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6b5506a28632b57c0c75c7cc66c0bc35d419b682/depends/packages/qt.mk",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/packages/qt.mk?ref=6b5506a28632b57c0c75c7cc66c0bc35d419b682",
        "patch": "@@ -8,7 +8,7 @@ $(package)_dependencies=openssl zlib\n $(package)_linux_dependencies=freetype fontconfig libxcb libX11 xproto libXext\n $(package)_build_subdir=qtbase\n $(package)_qt_libs=corelib network widgets gui plugins testlib\n-$(package)_patches=fix_qt_pkgconfig.patch mac-qmake.conf fix_configure_mac.patch fix_no_printer.patch\n+$(package)_patches=fix_qt_pkgconfig.patch mac-qmake.conf fix_configure_mac.patch fix_no_printer.patch fix_rcc_determinism.patch\n \n $(package)_qttranslations_file_name=qttranslations-$($(package)_suffix)\n $(package)_qttranslations_sha256_hash=9822084f8e2d2939ba39f4af4c0c2320e45d5996762a9423f833055607604ed8\n@@ -94,6 +94,7 @@ $(package)_config_opts_i686_linux  = -xplatform linux-g++-32\n $(package)_config_opts_x86_64_linux = -xplatform linux-g++-64\n $(package)_config_opts_mingw32  = -no-opengl -xplatform win32-g++ -device-option CROSS_COMPILE=\"$(host)-\"\n $(package)_build_env  = QT_RCC_TEST=1\n+$(package)_build_env += QT_RCC_SOURCE_DATE_OVERRIDE=1\n endef\n \n define $(package)_fetch_cmds\n@@ -133,6 +134,7 @@ define $(package)_preprocess_cmds\n   patch -p1 -i $($(package)_patch_dir)/fix_qt_pkgconfig.patch &&\\\n   patch -p1 -i $($(package)_patch_dir)/fix_configure_mac.patch &&\\\n   patch -p1 -i $($(package)_patch_dir)/fix_no_printer.patch &&\\\n+  patch -p1 -i $($(package)_patch_dir)/fix_rcc_determinism.patch &&\\\n   echo \"!host_build: QMAKE_CFLAGS     += $($(package)_cflags) $($(package)_cppflags)\" >> qtbase/mkspecs/common/gcc-base.conf && \\\n   echo \"!host_build: QMAKE_CXXFLAGS   += $($(package)_cxxflags) $($(package)_cppflags)\" >> qtbase/mkspecs/common/gcc-base.conf && \\\n   echo \"!host_build: QMAKE_LFLAGS     += $($(package)_ldflags)\" >> qtbase/mkspecs/common/gcc-base.conf && \\"
      },
      {
        "sha": "c1b07fe23afdbd7a2f204811e2aad132bd2d9dff",
        "filename": "depends/patches/qt/fix_rcc_determinism.patch",
        "status": "added",
        "additions": 15,
        "deletions": 0,
        "changes": 15,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6b5506a28632b57c0c75c7cc66c0bc35d419b682/depends/patches/qt/fix_rcc_determinism.patch",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6b5506a28632b57c0c75c7cc66c0bc35d419b682/depends/patches/qt/fix_rcc_determinism.patch",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/depends/patches/qt/fix_rcc_determinism.patch?ref=6b5506a28632b57c0c75c7cc66c0bc35d419b682",
        "patch": "@@ -0,0 +1,15 @@\n+--- old/qtbase/src/tools/rcc/rcc.cpp\n++++ new/qtbase/src/tools/rcc/rcc.cpp\n+@@ -207,7 +207,11 @@ void RCCFileInfo::writeDataInfo(RCCResourceLibrary &lib)\n+     if (lib.formatVersion() >= 2) {\n+         // last modified time stamp\n+         const QDateTime lastModified = m_fileInfo.lastModified();\n+-        lib.writeNumber8(quint64(lastModified.isValid() ? lastModified.toMSecsSinceEpoch() : 0));\n++        quint64 lastmod = quint64(lastModified.isValid() ? lastModified.toMSecsSinceEpoch() : 0);\n++        static const quint64 sourceDate = 1000 * qgetenv(\"QT_RCC_SOURCE_DATE_OVERRIDE\").toULongLong();\n++        if (sourceDate != 0)\n++            lastmod = sourceDate;\n++        lib.writeNumber8(lastmod);\n+         if (text || pass1)\n+             lib.writeChar('\\n');\n+     }"
      }
    ]
  }
]