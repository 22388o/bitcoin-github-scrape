[
  {
    "sha": "efaf80e9bb0afeca2955720bfe6c225d7864036b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplZmFmODBlOWJiMGFmZWNhMjk1NTcyMGJmZTZjMjI1ZDc4NjQwMzZi",
    "commit": {
      "author": {
        "name": "Michael Dietz",
        "email": "michael.dietz@waya.ai",
        "date": "2020-12-24T19:48:30Z"
      },
      "committer": {
        "name": "Michael Dietz",
        "email": "michael.dietz@waya.ai",
        "date": "2020-12-29T01:31:23Z"
      },
      "message": "fuzz: check that certain script TxoutType are nonstandard",
      "tree": {
        "sha": "5449ac40a755498904584e83630521746b9425c5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5449ac40a755498904584e83630521746b9425c5"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/efaf80e9bb0afeca2955720bfe6c225d7864036b",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEENKwpEUV32QrrIOeYc3/VzfHRRrkFAl/qhu8ACgkQc3/VzfHR\nRrmiKQ//a0ykxYz1Nh6jaVZ5m9gM3mdgQ62tt/eg1crqLgJqOS+qy/EiB3E9qNwv\nWwaR8VuMOvW6L+a1Lis7lPDBwVCNAmuPfjmXsJljQnslW4iw0Nn1zmDqMV9ilSvB\nnLpoQzjz0oBqeeVT5UhUN+twCACLXglR1OtKncDLq8WJ2W6gO1bap1PH1fPKumDX\nv8N4ry7qe9FSYENmAS0KGK+oWtiZmbQtnLA/K7fm9ZMt+Xy7MkDIxuZHc9CiO/Ef\n9Qc33+E8cIpKz+7rYlO5CnKpSXaOwTJ8sKU9OVvvE9jUOzG4xmbEkIz/n1HOQVB3\n/DvH3SzT8HTRvVLCXXJHmPEcU9ar8QoVrfBcKgyH0v6KQ9p3317+kHbMCSfSUsjw\nF8CBGXT2Jb2sI2Q+g629AP5HPYupvwcr23UVOFzed7JD0mS/Uqu/MXiIMLCNGXgN\ni0dI+dULH3avFWnhaqu9ZLz51raSVB4UEW7Te9f1X2hBTi6tJP3kauAa6+7Azav2\nLZm/DyNh27N9nuofmi82VHa37zKqTqKelF+SlizH9ViMLAtO8FqyW/Z7g8wmdXSo\nYqp1u2VqsQTUZxcd538akt+34JcpJSReQFVHhTHJO+1fjM1pWut2su08MtIovhdI\na40iM+3xNJ3XYdWYjv4+xicyQceSAVGxlKYlL4NsN2zYMb1cLsY=\n=hVfj\n-----END PGP SIGNATURE-----",
        "payload": "tree 5449ac40a755498904584e83630521746b9425c5\nparent 43fc7a569c135a9f24db23e6fcbb30b839859094\nauthor Michael Dietz <michael.dietz@waya.ai> 1608839310 -0600\ncommitter Michael Dietz <michael.dietz@waya.ai> 1609205483 -0600\n\nfuzz: check that certain script TxoutType are nonstandard\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/efaf80e9bb0afeca2955720bfe6c225d7864036b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/efaf80e9bb0afeca2955720bfe6c225d7864036b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/efaf80e9bb0afeca2955720bfe6c225d7864036b/comments",
    "author": {
      "login": "mjdietzx",
      "id": 7217256,
      "node_id": "MDQ6VXNlcjcyMTcyNTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7217256?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mjdietzx",
      "html_url": "https://github.com/mjdietzx",
      "followers_url": "https://api.github.com/users/mjdietzx/followers",
      "following_url": "https://api.github.com/users/mjdietzx/following{/other_user}",
      "gists_url": "https://api.github.com/users/mjdietzx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mjdietzx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mjdietzx/subscriptions",
      "organizations_url": "https://api.github.com/users/mjdietzx/orgs",
      "repos_url": "https://api.github.com/users/mjdietzx/repos",
      "events_url": "https://api.github.com/users/mjdietzx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mjdietzx/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "mjdietzx",
      "id": 7217256,
      "node_id": "MDQ6VXNlcjcyMTcyNTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7217256?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mjdietzx",
      "html_url": "https://github.com/mjdietzx",
      "followers_url": "https://api.github.com/users/mjdietzx/followers",
      "following_url": "https://api.github.com/users/mjdietzx/following{/other_user}",
      "gists_url": "https://api.github.com/users/mjdietzx/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mjdietzx/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mjdietzx/subscriptions",
      "organizations_url": "https://api.github.com/users/mjdietzx/orgs",
      "repos_url": "https://api.github.com/users/mjdietzx/repos",
      "events_url": "https://api.github.com/users/mjdietzx/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mjdietzx/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "43fc7a569c135a9f24db23e6fcbb30b839859094",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/43fc7a569c135a9f24db23e6fcbb30b839859094",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/43fc7a569c135a9f24db23e6fcbb30b839859094"
      }
    ],
    "stats": {
      "total": 10,
      "additions": 9,
      "deletions": 1
    },
    "files": [
      {
        "sha": "d883426c81c0219efafed9505f49f0480d2fc2bb",
        "filename": "src/test/fuzz/script.cpp",
        "status": "modified",
        "additions": 9,
        "deletions": 1,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/efaf80e9bb0afeca2955720bfe6c225d7864036b/src/test/fuzz/script.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/efaf80e9bb0afeca2955720bfe6c225d7864036b/src/test/fuzz/script.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/script.cpp?ref=efaf80e9bb0afeca2955720bfe6c225d7864036b",
        "patch": "@@ -71,7 +71,15 @@ FUZZ_TARGET_INIT(script, initialize_script)\n     (void)IsSolvable(signing_provider, script);\n \n     TxoutType which_type;\n-    (void)IsStandard(script, which_type);\n+    bool is_standard_ret = IsStandard(script, which_type);\n+    if (!is_standard_ret) {\n+        assert(which_type == TxoutType::NONSTANDARD ||\n+               which_type == TxoutType::NULL_DATA ||\n+               which_type == TxoutType::MULTISIG);\n+    }\n+    if (which_type == TxoutType::NONSTANDARD) {\n+        assert(!is_standard_ret);\n+    }\n     if (which_type == TxoutType::NULL_DATA) {\n         assert(script.IsUnspendable());\n     }"
      }
    ]
  }
]