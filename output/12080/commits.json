[
  {
    "sha": "c316fdffeca8c49ea20be27e6e007b13f6a9a4c2",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpjMzE2ZmRmZmVjYThjNDllYTIwYmUyN2U2ZTAwN2IxM2Y2YTlhNGMy",
    "commit": {
      "author": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2018-01-03T16:00:18Z"
      },
      "committer": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2018-01-03T16:15:15Z"
      },
      "message": "[qt] Add support to search the address book",
      "tree": {
        "sha": "bd3fa0e078b26cecc502b6b80fc59a8a903629ce",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bd3fa0e078b26cecc502b6b80fc59a8a903629ce"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c316fdffeca8c49ea20be27e6e007b13f6a9a4c2",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c316fdffeca8c49ea20be27e6e007b13f6a9a4c2",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/c316fdffeca8c49ea20be27e6e007b13f6a9a4c2",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c316fdffeca8c49ea20be27e6e007b13f6a9a4c2/comments",
    "author": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "c991b304dee368f506cfee27ddaa333f1f82c518",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c991b304dee368f506cfee27ddaa333f1f82c518",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/c991b304dee368f506cfee27ddaa333f1f82c518"
      }
    ],
    "stats": {
      "total": 68,
      "additions": 49,
      "deletions": 19
    },
    "files": [
      {
        "sha": "78dc9f81dddfed370aa5830b426c284c9d1aa2a5",
        "filename": "src/qt/addressbookpage.cpp",
        "status": "modified",
        "additions": 40,
        "deletions": 17,
        "changes": 57,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/c316fdffeca8c49ea20be27e6e007b13f6a9a4c2/src/qt/addressbookpage.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/c316fdffeca8c49ea20be27e6e007b13f6a9a4c2/src/qt/addressbookpage.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/addressbookpage.cpp?ref=c316fdffeca8c49ea20be27e6e007b13f6a9a4c2",
        "patch": "@@ -21,6 +21,41 @@\n #include <QMessageBox>\n #include <QSortFilterProxyModel>\n \n+class AddressBookSortFilterProxyModel final : public QSortFilterProxyModel\n+{\n+    const QString m_type;\n+\n+public:\n+    AddressBookSortFilterProxyModel(const QString& type, QObject* parent)\n+        : QSortFilterProxyModel(parent)\n+        , m_type(type)\n+    {\n+        setDynamicSortFilter(true);\n+        setFilterCaseSensitivity(Qt::CaseInsensitive);\n+        setSortCaseSensitivity(Qt::CaseInsensitive);\n+    }\n+\n+protected:\n+    bool filterAcceptsRow(int row, const QModelIndex& parent) const\n+    {\n+        auto model = sourceModel();\n+        auto label = model->index(row, AddressTableModel::Label, parent);\n+\n+        if (model->data(label, AddressTableModel::TypeRole).toString() != m_type) {\n+            return false;\n+        }\n+\n+        auto address = model->index(row, AddressTableModel::Address, parent);\n+\n+        if (filterRegExp().indexIn(model->data(address).toString()) < 0 &&\n+            filterRegExp().indexIn(model->data(label).toString()) < 0) {\n+            return false;\n+        }\n+\n+        return true;\n+    }\n+};\n+\n AddressBookPage::AddressBookPage(const PlatformStyle *platformStyle, Mode _mode, Tabs _tab, QWidget *parent) :\n     QDialog(parent),\n     ui(new Ui::AddressBookPage),\n@@ -113,24 +148,12 @@ void AddressBookPage::setModel(AddressTableModel *_model)\n     if(!_model)\n         return;\n \n-    proxyModel = new QSortFilterProxyModel(this);\n+    auto type = tab == ReceivingTab ? AddressTableModel::Receive : AddressTableModel::Send;\n+    proxyModel = new AddressBookSortFilterProxyModel(type, this);\n     proxyModel->setSourceModel(_model);\n-    proxyModel->setDynamicSortFilter(true);\n-    proxyModel->setSortCaseSensitivity(Qt::CaseInsensitive);\n-    proxyModel->setFilterCaseSensitivity(Qt::CaseInsensitive);\n-    switch(tab)\n-    {\n-    case ReceivingTab:\n-        // Receive filter\n-        proxyModel->setFilterRole(AddressTableModel::TypeRole);\n-        proxyModel->setFilterFixedString(AddressTableModel::Receive);\n-        break;\n-    case SendingTab:\n-        // Send filter\n-        proxyModel->setFilterRole(AddressTableModel::TypeRole);\n-        proxyModel->setFilterFixedString(AddressTableModel::Send);\n-        break;\n-    }\n+\n+    connect(ui->searchLineEdit, SIGNAL(textChanged(QString)), proxyModel, SLOT(setFilterWildcard(QString)));\n+\n     ui->tableView->setModel(proxyModel);\n     ui->tableView->sortByColumn(0, Qt::AscendingOrder);\n "
      },
      {
        "sha": "8877d07330add1f600e4728ac9674340e6ffe55f",
        "filename": "src/qt/addressbookpage.h",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/c316fdffeca8c49ea20be27e6e007b13f6a9a4c2/src/qt/addressbookpage.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/c316fdffeca8c49ea20be27e6e007b13f6a9a4c2/src/qt/addressbookpage.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/addressbookpage.h?ref=c316fdffeca8c49ea20be27e6e007b13f6a9a4c2",
        "patch": "@@ -7,6 +7,7 @@\n \n #include <QDialog>\n \n+class AddressBookSortFilterProxyModel;\n class AddressTableModel;\n class PlatformStyle;\n \n@@ -18,7 +19,6 @@ QT_BEGIN_NAMESPACE\n class QItemSelection;\n class QMenu;\n class QModelIndex;\n-class QSortFilterProxyModel;\n QT_END_NAMESPACE\n \n /** Widget that shows a list of sending or receiving addresses.\n@@ -53,7 +53,7 @@ public Q_SLOTS:\n     Mode mode;\n     Tabs tab;\n     QString returnValue;\n-    QSortFilterProxyModel *proxyModel;\n+    AddressBookSortFilterProxyModel *proxyModel;\n     QMenu *contextMenu;\n     QAction *deleteAction; // to be able to explicitly disable it\n     QString newAddressToSelect;"
      },
      {
        "sha": "7ac216286c8d6b36d4f799c30040f74714e32951",
        "filename": "src/qt/forms/addressbookpage.ui",
        "status": "modified",
        "additions": 7,
        "deletions": 0,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/c316fdffeca8c49ea20be27e6e007b13f6a9a4c2/src/qt/forms/addressbookpage.ui",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/c316fdffeca8c49ea20be27e6e007b13f6a9a4c2/src/qt/forms/addressbookpage.ui",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/forms/addressbookpage.ui?ref=c316fdffeca8c49ea20be27e6e007b13f6a9a4c2",
        "patch": "@@ -21,6 +21,13 @@\n      </property>\n     </widget>\n    </item>\n+   <item>\n+    <widget class=\"QLineEdit\" name=\"searchLineEdit\">\n+     <property name=\"placeholderText\">\n+      <string>Enter address or label to search</string>\n+     </property>\n+    </widget>\n+   </item>\n    <item>\n     <widget class=\"QTableView\" name=\"tableView\">\n      <property name=\"contextMenuPolicy\">"
      }
    ]
  }
]