promag,2020-05-12 22:46:37,"Q1 - should this be optional? ðŸ¤”\nQ2 - should include all import calls here? (draft because of this)\n\n@ryanofsky FYI currently using `requestMempoolTransactions`.",https://github.com/bitcoin/bitcoin/pull/18964#issuecomment-627639630,627639630,
promag,2020-05-13 14:00:06,"> Concept ACK.\n> \n> From reading the code, the first commit can never pass tests?\n\nWhy?",https://github.com/bitcoin/bitcoin/pull/18964#issuecomment-628008566,628008566,
MarcoFalke,2020-05-13 14:26:24,"I assumed that the check after `importprivkey` might fail because of the missing rescan, but that might not be the case, as the wallet already knows the tx is in the mempool.",https://github.com/bitcoin/bitcoin/pull/18964#issuecomment-628025638,628025638,
promag,2020-05-13 14:27:33,"> I assumed that the check after `importprivkey` might fail because of the missing rescan, but that might not be the case, as the wallet already knows the tx is in the mempool.\n\nCorrect, that's why the 2nd commit tests `importprivkey` with a fresh wallet.",https://github.com/bitcoin/bitcoin/pull/18964#issuecomment-628026434,628026434,
ryanofsky,2020-05-13 14:50:18,"This looks very good, and should be extended to work with other import rpcs (also maybe in the future `sethdseed`, found I needed a rescan recently there too).\n\nI would probably **not** make this conditioned on the rescan option, just because as a user I can't think of any real world case where I'd want to import a key and not have the wallet detect mempool transactions using that key. This is",https://github.com/bitcoin/bitcoin/pull/18964#issuecomment-628042279,628042279,
MarcoFalke,2020-05-13 14:56:48,"> because rescanning blocks is ridiculously slow\n\nThe mempool can have 100s of MBs of transactions. I haven't crunched the numbers, but we should make sure that import RPCs don't get slow either.",https://github.com/bitcoin/bitcoin/pull/18964#issuecomment-628046953,628046953,
promag,2020-05-13 15:00:30,"Right, and it would be even worse with big wallets.",https://github.com/bitcoin/bitcoin/pull/18964#issuecomment-628049485,628049485,
MarcoFalke,2020-05-14 11:47:43,"Suggested doc fixup:\n\n```diff\ndiff --git a/src/wallet/rpcdump.cpp b/src/wallet/rpcdump.cpp\nindex 7bf3d169c3..4d1ba7ebf5 100644\n--- a/src/wallet/rpcdump.cpp\n+++ b/src/wallet/rpcdump.cpp\n@@ -103,11 +103,13 @@ UniValue importprivkey(const JSONRPCRequest& request)\n                 ""Hint: use importmulti to import more than one private key.\n""\n             ""\nNote: This call can take ",https://github.com/bitcoin/bitcoin/pull/18964#issuecomment-628580719,628580719,
fjahr,2020-05-25 11:32:16,"Concept ACK\n\nI don't have a good feeling for the performance of a large mempool rescan but I do believe it will have a considerable impact for nodes with large, full mempools. So I agree it should be added to the rescan RPC and it should not be run for the `import*` RPCs in case of `rescan=false`.",https://github.com/bitcoin/bitcoin/pull/18964#issuecomment-633527231,633527231,
MarcoFalke,2020-05-13 12:38:47,"Why is this done even when rescan is turned off? I think this should only be run when rescan is on.\n\nIf the user turns off rescan, they know that\n* either no transaction has happened in the past, so rescan is not needed\n* or they do a full rescan later\n\nThis also means that this should be added to the rescan RPC.",https://github.com/bitcoin/bitcoin/pull/18964#discussion_r424403293,424403293,src/wallet/rpcdump.cpp
promag,2020-05-13 14:26:00,"> This also means that this should be added to the rescan RPC.\n\nMight be the best approach, it would cover any import that rescans and also manual rescan. So in practice `ScanForWalletTransactions` where `stop_block.IsNull` would scan mempool too?",https://github.com/bitcoin/bitcoin/pull/18964#discussion_r424480423,424480423,src/wallet/rpcdump.cpp
promag,2020-09-06 17:12:51,"> So in practice `ScanForWalletTransactions` where `stop_block.IsNull` would scan mempool too?\n\n@MarcoFalke is this your suggestion?",https://github.com/bitcoin/bitcoin/pull/18964#discussion_r484093472,484093472,src/wallet/rpcdump.cpp
