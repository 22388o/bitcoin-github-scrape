DrahtBot,2019-06-18 22:00:37,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#16361](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/16361.html) (Remove redundant pre-TopUpKeypool checks by",https://github.com/bitcoin/bitcoin/pull/16237#issuecomment-503328423,503328423,
laanwj,2019-06-27 11:24:06,"Concept ACK\n(my remark was going to be that the wallet should return Destinations, not addresses, but that's exactly that this does)",https://github.com/bitcoin/bitcoin/pull/16237#issuecomment-506306651,506306651,
Sjors,2019-07-09 15:29:41,"Concept ACK.\n\nIn line with @laanwj's comment, maybe rename `GetNew(Change)Address` to `GetNew(Change)Destination`, and `ReserveAddress` to `ReserveDestination`.\n\n`GetReservedAddress` is still used in two places; maybe kill it in this PR?\n\nTravis seems unhappy about a locking issue. On macOS I also get some warnings:\n<img width=""1117"" alt=""Schermafbeelding 2019-07-09 om 16 19 25"" src=",https://github.com/bitcoin/bitcoin/pull/16237#issuecomment-509691051,509691051,
achow101,2019-07-09 18:43:46,"> In line with @laanwj's comment, maybe rename `GetNew(Change)Address` to `GetNew(Change)Destination`, and `ReserveAddress` to `ReserveDestination`.\n\nI've renamed it.\n\n> `GetReservedAddress` is still used in two places; maybe kill it in this PR?\n\nIt is?\n\n> Travis seems unhappy about a locking issue. On macOS I also get some warnings:\n\nShould be fixed now.\n\n",https://github.com/bitcoin/bitcoin/pull/16237#issuecomment-509760220,509760220,
instagibbs,2019-07-09 20:39:14,utACK https://github.com/bitcoin/bitcoin/pull/16237/commits/c84cbd50ce9d0418c6f71d56995e03a3ed7f56bc,https://github.com/bitcoin/bitcoin/pull/16237#issuecomment-509798591,509798591,
instagibbs,2019-07-09 20:48:16,"re-utACK https://github.com/bitcoin/bitcoin/pull/16237/commits/8e7f930828a9f8f9be1c90ff45e3fdfef1980eaf\n\nonly changes are clearing error messages at beginning of `GetNew*`",https://github.com/bitcoin/bitcoin/pull/16237#issuecomment-509801376,509801376,
sipa,2019-07-09 21:39:41,"ACK 8e7f930828a9f8f9be1c90ff45e3fdfef1980eaf. Concept ACK as this gives a much cleaner abstraction to work with, and light code review ACK.\n\nIt's bit confusing that constructing a (filled) ReserveDestination does not actually require a destination type, preventing the interface from being able to select where to draw change from based on the address type desired. Perhaps something for a follow",https://github.com/bitcoin/bitcoin/pull/16237#issuecomment-509820024,509820024,
laanwj,2019-07-10 09:45:24,ACK 8e7f930828a9f8f9be1c90ff45e3fdfef1980eaf,https://github.com/bitcoin/bitcoin/pull/16237#issuecomment-509992028,509992028,
Sjors,2019-07-10 12:59:23,The macOS warnings I saw before are indeed gone now.,https://github.com/bitcoin/bitcoin/pull/16237#issuecomment-510050354,510050354,
promag,2019-06-19 14:11:24,"2010b1a13e6b7eaa681cc62ae58079ccbec72816\n\nThis should be atomic or add `EXCLUSIVE_LOCKS_REQUIRED(cs_wallet)` annotation?\n\nAlso, could make `GetKeyFromPool` private?",https://github.com/bitcoin/bitcoin/pull/16237#discussion_r295319721,295319721,src/wallet/wallet.h
achow101,2019-06-20 16:14:09,Done. Also fixed typo,https://github.com/bitcoin/bitcoin/pull/16237#discussion_r295885621,295885621,src/wallet/wallet.h
MarcoFalke,2019-06-20 17:10:41,"```\ninterfaces/wallet.cpp:146:16: error: calling function 'GetNewAddress' requires holding mutex 'm_wallet->cs_wallet' exclusively [-Werror,-Wthread-safety-analysis]",https://github.com/bitcoin/bitcoin/pull/16237#discussion_r295907944,295907944,src/interfaces/wallet.cpp
achow101,2019-06-20 17:21:58,Fixed,https://github.com/bitcoin/bitcoin/pull/16237#discussion_r295912360,295912360,src/interfaces/wallet.cpp
laanwj,2019-06-27 11:23:03,"nit: the message is translated here, but not in the new occurences. As this looks like a message that will be returned over the RPC interface (referring to a RPC command, at least). Maybe better to not translate it here either?",https://github.com/bitcoin/bitcoin/pull/16237#discussion_r298128149,298128149,src/wallet/wallet.cpp
achow101,2019-07-09 18:46:12,I've made it untranslated.,https://github.com/bitcoin/bitcoin/pull/16237#discussion_r301739329,301739329,src/wallet/wallet.cpp
instagibbs,2019-07-09 19:18:48,micro-nit: can clear `error` here.,https://github.com/bitcoin/bitcoin/pull/16237#discussion_r301752598,301752598,src/wallet/wallet.cpp
instagibbs,2019-07-09 19:22:04,"We're using ""destination"" in `GetReservedDestination` but ""address"" here. We should pick one?",https://github.com/bitcoin/bitcoin/pull/16237#discussion_r301753752,301753752,src/wallet/wallet.cpp
instagibbs,2019-07-09 19:22:08,"We're using ""destination"" in `GetReservedDestination` but ""address"" here. We should pick one?",https://github.com/bitcoin/bitcoin/pull/16237#discussion_r301753778,301753778,src/wallet/wallet.cpp
instagibbs,2019-07-09 19:24:40,nit: same comment about clearing the error string,https://github.com/bitcoin/bitcoin/pull/16237#discussion_r301754699,301754699,src/wallet/wallet.cpp
achow101,2019-07-09 20:28:12,Does it matter?,https://github.com/bitcoin/bitcoin/pull/16237#discussion_r301779012,301779012,src/wallet/wallet.cpp
achow101,2019-07-09 20:34:54,"Whoops, fixed",https://github.com/bitcoin/bitcoin/pull/16237#discussion_r301781730,301781730,src/wallet/wallet.cpp
achow101,2019-07-09 20:35:01,Fixed,https://github.com/bitcoin/bitcoin/pull/16237#discussion_r301781765,301781765,src/wallet/wallet.cpp
instagibbs,2019-07-09 20:35:52,micro-matters in case someone calls the function twice and doesn't clear the error themself? :),https://github.com/bitcoin/bitcoin/pull/16237#discussion_r301782080,301782080,src/wallet/wallet.cpp
achow101,2019-07-09 20:43:18,Done,https://github.com/bitcoin/bitcoin/pull/16237#discussion_r301785062,301785062,src/wallet/wallet.cpp
achow101,2019-07-09 20:44:05,Done,https://github.com/bitcoin/bitcoin/pull/16237#discussion_r301785365,301785365,src/wallet/wallet.cpp
