[
  {
    "sha": "b324b2820903e777f3bbf5bf96686bbe723d8df7",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiMzI0YjI4MjA5MDNlNzc3ZjNiYmY1YmY5NjY4NmJiZTcyM2Q4ZGY3",
    "commit": {
      "author": {
        "name": "Jorge Tim\u00f3n",
        "email": "jtimon@jtimon.cc",
        "date": "2016-11-07T22:31:55Z"
      },
      "committer": {
        "name": "Jorge Tim\u00f3n",
        "email": "jtimon@jtimon.cc",
        "date": "2017-05-18T20:23:10Z"
      },
      "message": "Globals: Pass Consensus::Params through CBlockTreeDB::LoadBlockIndexGuts()",
      "tree": {
        "sha": "1bcdd78a47c367edd3262093e0cf0b3700f912ae",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1bcdd78a47c367edd3262093e0cf0b3700f912ae"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b324b2820903e777f3bbf5bf96686bbe723d8df7",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v2\n\niQIcBAABCAAGBQJZHgKyAAoJEIhmwY6hyUSiNS4QAJb8F2giT8sWWRhB2vqCmlA1\nHcdRAUAmzVur3LgAA54iXcNwKYQL3hDcXd2YeP75n9saWC8lY4R5/NIsDGDcSUyw\nsEdOjGFbzlJWFL81WhXCpkkBiGzC1BuJdfUcP/qZNEjLobIpEElYX8x+PgSF4O+c\netCMs7a31C/ZHK0r24ue8o68BY2VyDNIVHLyF3FYj0VQJeY7UMfDYRJW2eGtmuja\nzEdwFRp+GzmOr924wH99Y76pUzxJiidTRdj39bQKCjMs97dHe3zc/nNeygIEdn8H\npEcM6qX4ed6LTwQt52J2XpG+TnBwc7w4fzPbhytQnwNfSuvvib/oa5Bq7cd0Ydzm\n80lYjn24BmOtSd8JOVY1VukoRsRLxrcu+0NAd+L6FEZiFqFruvH1IdiKhsc8X/F4\nUZjCZWpjHHjDXoauYbDRNcLmRG1HDLTRdVe2GClY3zeXtQSNLFdsg6woSn2FNQlL\nQzv8C7xe6/xidsQkPkbdT1Qs9MPHAiVqgW4py+nycXrAv2txoLZ2S3p1Z+4VKtT5\nbnTHDG+9civRVaapY853QDOjlLqITOEmeq7cFK+/jQf0Q/PvA203lEdqJ4DxubMS\n+P217mUOMvqxQgKCIZwzomsLrNAYeVmUkLelx9V8I6r2Ks/0SVaTY6RhrH+zUzG2\n7SakDXqcKPw/oUXmO4lc\n=IiSz\n-----END PGP SIGNATURE-----",
        "payload": "tree 1bcdd78a47c367edd3262093e0cf0b3700f912ae\nparent ea6fde3f1d2694176a657b69fb0eeb5426e6f309\nauthor Jorge Tim\u00f3n <jtimon@jtimon.cc> 1478557915 +0100\ncommitter Jorge Tim\u00f3n <jtimon@jtimon.cc> 1495138990 +0200\n\nGlobals: Pass Consensus::Params through CBlockTreeDB::LoadBlockIndexGuts()\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b324b2820903e777f3bbf5bf96686bbe723d8df7",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/b324b2820903e777f3bbf5bf96686bbe723d8df7",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b324b2820903e777f3bbf5bf96686bbe723d8df7/comments",
    "author": {
      "login": "jtimon",
      "id": 1008458,
      "node_id": "MDQ6VXNlcjEwMDg0NTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1008458?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtimon",
      "html_url": "https://github.com/jtimon",
      "followers_url": "https://api.github.com/users/jtimon/followers",
      "following_url": "https://api.github.com/users/jtimon/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtimon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtimon/subscriptions",
      "organizations_url": "https://api.github.com/users/jtimon/orgs",
      "repos_url": "https://api.github.com/users/jtimon/repos",
      "events_url": "https://api.github.com/users/jtimon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtimon/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jtimon",
      "id": 1008458,
      "node_id": "MDQ6VXNlcjEwMDg0NTg=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1008458?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jtimon",
      "html_url": "https://github.com/jtimon",
      "followers_url": "https://api.github.com/users/jtimon/followers",
      "following_url": "https://api.github.com/users/jtimon/following{/other_user}",
      "gists_url": "https://api.github.com/users/jtimon/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jtimon/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jtimon/subscriptions",
      "organizations_url": "https://api.github.com/users/jtimon/orgs",
      "repos_url": "https://api.github.com/users/jtimon/repos",
      "events_url": "https://api.github.com/users/jtimon/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jtimon/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "ea6fde3f1d2694176a657b69fb0eeb5426e6f309",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ea6fde3f1d2694176a657b69fb0eeb5426e6f309",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/ea6fde3f1d2694176a657b69fb0eeb5426e6f309"
      }
    ],
    "stats": {
      "total": 12,
      "additions": 6,
      "deletions": 6
    },
    "files": [
      {
        "sha": "07e1340423f379d9517bcdf90c57d0a17332710b",
        "filename": "src/txdb.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 4,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b324b2820903e777f3bbf5bf96686bbe723d8df7/src/txdb.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b324b2820903e777f3bbf5bf96686bbe723d8df7/src/txdb.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/txdb.cpp?ref=b324b2820903e777f3bbf5bf96686bbe723d8df7",
        "patch": "@@ -169,7 +169,7 @@ bool CBlockTreeDB::ReadFlag(const std::string &name, bool &fValue) {\n     return true;\n }\n \n-bool CBlockTreeDB::LoadBlockIndexGuts(std::function<CBlockIndex*(const uint256&)> insertBlockIndex)\n+bool CBlockTreeDB::LoadBlockIndexGuts(const Consensus::Params& consensusParams, std::function<CBlockIndex*(const uint256&)> insertBlockIndex)\n {\n     std::unique_ptr<CDBIterator> pcursor(NewIterator());\n \n@@ -197,12 +197,12 @@ bool CBlockTreeDB::LoadBlockIndexGuts(std::function<CBlockIndex*(const uint256&)\n                 pindexNew->nStatus        = diskindex.nStatus;\n                 pindexNew->nTx            = diskindex.nTx;\n \n-                if (!CheckProofOfWork(pindexNew->GetBlockHash(), pindexNew->nBits, Params().GetConsensus()))\n-                    return error(\"LoadBlockIndex(): CheckProofOfWork failed: %s\", pindexNew->ToString());\n+                if (!CheckProofOfWork(pindexNew->GetBlockHash(), pindexNew->nBits, consensusParams))\n+                    return error(\"%s: CheckProofOfWork failed: %s\", __func__, pindexNew->ToString());\n \n                 pcursor->Next();\n             } else {\n-                return error(\"LoadBlockIndex() : failed to read value\");\n+                return error(\"%s: failed to read value\", __func__);\n             }\n         } else {\n             break;"
      },
      {
        "sha": "97c4e09369ce5cae41fbb7a8975985a7f023ebac",
        "filename": "src/txdb.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b324b2820903e777f3bbf5bf96686bbe723d8df7/src/txdb.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b324b2820903e777f3bbf5bf96686bbe723d8df7/src/txdb.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/txdb.h?ref=b324b2820903e777f3bbf5bf96686bbe723d8df7",
        "patch": "@@ -120,7 +120,7 @@ class CBlockTreeDB : public CDBWrapper\n     bool WriteTxIndex(const std::vector<std::pair<uint256, CDiskTxPos> > &list);\n     bool WriteFlag(const std::string &name, bool fValue);\n     bool ReadFlag(const std::string &name, bool &fValue);\n-    bool LoadBlockIndexGuts(std::function<CBlockIndex*(const uint256&)> insertBlockIndex);\n+    bool LoadBlockIndexGuts(const Consensus::Params& consensusParams, std::function<CBlockIndex*(const uint256&)> insertBlockIndex);\n };\n \n #endif // BITCOIN_TXDB_H"
      },
      {
        "sha": "658a04ed8d3ef036910271be417e64c1c8724d54",
        "filename": "src/validation.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b324b2820903e777f3bbf5bf96686bbe723d8df7/src/validation.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b324b2820903e777f3bbf5bf96686bbe723d8df7/src/validation.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/validation.cpp?ref=b324b2820903e777f3bbf5bf96686bbe723d8df7",
        "patch": "@@ -3246,7 +3246,7 @@ CBlockIndex * InsertBlockIndex(uint256 hash)\n \n bool static LoadBlockIndexDB(const CChainParams& chainparams)\n {\n-    if (!pblocktree->LoadBlockIndexGuts(InsertBlockIndex))\n+    if (!pblocktree->LoadBlockIndexGuts(chainparams.GetConsensus(), InsertBlockIndex))\n         return false;\n \n     boost::this_thread::interruption_point();"
      }
    ]
  }
]