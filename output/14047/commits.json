[
  {
    "sha": "463921bb649d644f79f9d7f0f96f10aa0d165f76",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0NjM5MjFiYjY0OWQ2NDRmNzlmOWQ3ZjBmOTZmMTBhYTBkMTY1Zjc2",
    "commit": {
      "author": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2018-08-13T18:18:25Z"
      },
      "committer": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2019-03-27T12:59:50Z"
      },
      "message": "CKey: add method to negate the key",
      "tree": {
        "sha": "9965daf6e7b984d4435e390d2f5faf67e7644a1f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9965daf6e7b984d4435e390d2f5faf67e7644a1f"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/463921bb649d644f79f9d7f0f96f10aa0d165f76",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyhopCNzi8TB0xizeHrd2uwPHki0FAlybc8YACgkQHrd2uwPH\nki1rmhAAwiI+TqJhMqerDVYxRK4BlnjVOhFfS6tiAXGVkVwT3RQhHAn5sFX23qSA\nlBK+tPKi7BfZ95pP4yofv17bQebwR7NKtuNTu+hazzLd4Jb7QMqU4MIa66gF4uso\nbQl0KnXWLtWw/DPeTrd2WASgdiut6WwWjTr8X5mOC/VMUP9YTlCbJIrInqzgK4Rk\n0CzPqznUs1pYXUC8qPVrfbM4eg1LlfHW57S1YH4q3BstSBqY9bSWdJtnEq0pOHij\n9QwehGhDmyL4bZ3Hzgghl6ezqdYSkrjQXywOkDSMp1vwlOiwz6yPh38FdCHm+erS\nrgtxIT5rHWOAIej0HnTrYbsvX7fzeRxN3SqmC+HmUk8crz+XTcNblgnT0NGx0b9B\nkcJDa/QkRM5BRA2VQeP/p1AIvM5ltqLURFcDl1Z2m9EE2gbmysQCi8c9wuV7NrDw\njS3paxx6HNjJIeAyln+GUOmtHJK0B0tfeovg5BDXaj7OaDl5GTB0VGXzACynTVfC\ntTFSdDa82ZfgTpxwumH4Ind7+ZSnK1OegMdyjcmrlghLf699T7vn9zopyEmKLTYV\nRAsSn7ATsyAPPQaYYtzu3ABU6zHd4iDA6cVp1LoHWt0hNhyy/21Jpmw21hHFOLTH\nHobpH074koKf3acw8Gu+MG/5Rb2ZT4L4gEtoD3qTs85XwmET7bM=\n=eShN\n-----END PGP SIGNATURE-----",
        "payload": "tree 9965daf6e7b984d4435e390d2f5faf67e7644a1f\nparent 848ec5603f72e8ffc8063774fcf3ad7906c3676b\nauthor Jonas Schnelli <dev@jonasschnelli.ch> 1534184305 +0200\ncommitter Jonas Schnelli <dev@jonasschnelli.ch> 1553691590 +0100\n\nCKey: add method to negate the key\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/463921bb649d644f79f9d7f0f96f10aa0d165f76",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/463921bb649d644f79f9d7f0f96f10aa0d165f76",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/463921bb649d644f79f9d7f0f96f10aa0d165f76/comments",
    "author": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "848ec5603f72e8ffc8063774fcf3ad7906c3676b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/848ec5603f72e8ffc8063774fcf3ad7906c3676b",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/848ec5603f72e8ffc8063774fcf3ad7906c3676b"
      }
    ],
    "stats": {
      "total": 9,
      "additions": 9,
      "deletions": 0
    },
    "files": [
      {
        "sha": "c17f6a0ae213bb24c9b5e6bf8b8af1bd8b4e8417",
        "filename": "src/key.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 0,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/463921bb649d644f79f9d7f0f96f10aa0d165f76/src/key.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/463921bb649d644f79f9d7f0f96f10aa0d165f76/src/key.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/key.cpp?ref=463921bb649d644f79f9d7f0f96f10aa0d165f76",
        "patch": "@@ -163,6 +163,12 @@ void CKey::MakeNewKey(bool fCompressedIn) {\n     fCompressed = fCompressedIn;\n }\n \n+bool CKey::Negate()\n+{\n+    assert(fValid);\n+    return secp256k1_ec_privkey_negate(secp256k1_context_sign, keydata.data());\n+}\n+\n CPrivKey CKey::GetPrivKey() const {\n     assert(fValid);\n     CPrivKey privkey;"
      },
      {
        "sha": "67e2cfc094c6b956ce0643f9379491ec0da34f65",
        "filename": "src/key.h",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/463921bb649d644f79f9d7f0f96f10aa0d165f76/src/key.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/463921bb649d644f79f9d7f0f96f10aa0d165f76/src/key.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/key.h?ref=463921bb649d644f79f9d7f0f96f10aa0d165f76",
        "patch": "@@ -98,6 +98,9 @@ class CKey\n     //! Generate a new private key using a cryptographic PRNG.\n     void MakeNewKey(bool fCompressed);\n \n+    //! Negate private key\n+    bool Negate();\n+\n     /**\n      * Convert the private key to a CPrivKey (serialized OpenSSL private key data).\n      * This is expensive."
      }
    ]
  },
  {
    "sha": "3b64f852e400c552f031697d6a86829dc6e74bd6",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozYjY0Zjg1MmU0MDBjNTUyZjAzMTY5N2Q2YTg2ODI5ZGM2ZTc0YmQ2",
    "commit": {
      "author": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2018-08-24T09:04:44Z"
      },
      "committer": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2019-03-27T12:59:53Z"
      },
      "message": "QA: add test for CKey::Negate()",
      "tree": {
        "sha": "536bb3d5f4a7f8aecdee7055c318e85102a4bcac",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/536bb3d5f4a7f8aecdee7055c318e85102a4bcac"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3b64f852e400c552f031697d6a86829dc6e74bd6",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyhopCNzi8TB0xizeHrd2uwPHki0FAlybc8kACgkQHrd2uwPH\nki224A//bO5nuoohIj80e/LkjdNvxf1G12PwzAkjhCKY6rf5KSxvLhnq/HF8LrhA\nMV9Qgmr1+1Gr4CBOGXGNNfGuDgFrwdIZd5li9MEJu/GiuEMsnHi/vei0WC4EwrQm\nE2HMOfZ5+zka6MUDMjjalfnIxu2q78cIluaiSEQ44vc3OUEXT0JRykA6kyrScviH\ni17Nja6jX8MjYukkyQBFUuh3uqgmodXppnmYU8iNDeIyBK4A57Tp5RpoIxsc6Qal\nU2yL/uYHdVo5arOBXFlhJwFHATZFQpcOnee64jv/J0DMoG5ifxdZXVdiVtN848Dk\nkSG5YaK1Y0UvWlPbigSkW4EjVQ0U6h3AX9GDdlyTG4/gZWjkFY8NO9i45C++eR5e\nj7PUepEpdJpa6HJ+DgTx+kw1Ph86HGL1U4qCPqQGHbsZ6h8THh675A24u5L5/KhL\ntMY7ECQ2AbGqjFGrTj+gcyNO1s/9uTcdmrzyWHlkKdOR4UZfoWN5UnK/hw0v/Mji\nP/tmmnW2eaJf2Lf1FaeLTqvPXGYTzqo7MPzcE/dvRtVJIDNKuc0rtiwbnt/pr6Hl\nzr3WSbAY7GFLcMsNlQRq4YUCW1XlMETt8rMzr9vPqLHkgj6D+Egn70msmXIKrcDa\ncEMsKU09t/qbCXirEgLDnuFWATiniO8CNhcucYSXMhSljwbfioo=\n=mI8T\n-----END PGP SIGNATURE-----",
        "payload": "tree 536bb3d5f4a7f8aecdee7055c318e85102a4bcac\nparent 463921bb649d644f79f9d7f0f96f10aa0d165f76\nauthor Jonas Schnelli <dev@jonasschnelli.ch> 1535101484 +0200\ncommitter Jonas Schnelli <dev@jonasschnelli.ch> 1553691593 +0100\n\nQA: add test for CKey::Negate()\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3b64f852e400c552f031697d6a86829dc6e74bd6",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/3b64f852e400c552f031697d6a86829dc6e74bd6",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3b64f852e400c552f031697d6a86829dc6e74bd6/comments",
    "author": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "463921bb649d644f79f9d7f0f96f10aa0d165f76",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/463921bb649d644f79f9d7f0f96f10aa0d165f76",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/463921bb649d644f79f9d7f0f96f10aa0d165f76"
      }
    ],
    "stats": {
      "total": 32,
      "additions": 32,
      "deletions": 0
    },
    "files": [
      {
        "sha": "3d8f64e11506eb9af358a5d897e234d1d2667bc8",
        "filename": "src/test/key_tests.cpp",
        "status": "modified",
        "additions": 32,
        "deletions": 0,
        "changes": 32,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/3b64f852e400c552f031697d6a86829dc6e74bd6/src/test/key_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/3b64f852e400c552f031697d6a86829dc6e74bd6/src/test/key_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/key_tests.cpp?ref=3b64f852e400c552f031697d6a86829dc6e74bd6",
        "patch": "@@ -188,4 +188,36 @@ BOOST_AUTO_TEST_CASE(key_signature_tests)\n     BOOST_CHECK(found_small);\n }\n \n+BOOST_AUTO_TEST_CASE(key_key_negation)\n+{\n+    // create a dummy hash for signature comparison\n+    unsigned char rnd[8];\n+    std::string str = \"Bitcoin key verification\\n\";\n+    GetRandBytes(rnd, sizeof(rnd));\n+    uint256 hash;\n+    CHash256().Write((unsigned char*)str.data(), str.size()).Write(rnd, sizeof(rnd)).Finalize(hash.begin());\n+\n+    // import the static test key\n+    CKey key = DecodeSecret(strSecret1C);\n+\n+    // create a signature\n+    std::vector<unsigned char> vch_sig;\n+    std::vector<unsigned char> vch_sig_cmp;\n+    key.Sign(hash, vch_sig);\n+\n+    // negate the key twice\n+    BOOST_CHECK(key.GetPubKey().data()[0] == 0x03);\n+    key.Negate();\n+    // after the first negation, the signature must be different\n+    key.Sign(hash, vch_sig_cmp);\n+    BOOST_CHECK(vch_sig_cmp != vch_sig);\n+    BOOST_CHECK(key.GetPubKey().data()[0] == 0x02);\n+    key.Negate();\n+    // after the second negation, we should have the original key and thus the\n+    // same signature\n+    key.Sign(hash, vch_sig_cmp);\n+    BOOST_CHECK(vch_sig_cmp == vch_sig);\n+    BOOST_CHECK(key.GetPubKey().data()[0] == 0x03);\n+}\n+\n BOOST_AUTO_TEST_SUITE_END()"
      }
    ]
  },
  {
    "sha": "551d489416339dae8f9d896013cd060a21406e2b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo1NTFkNDg5NDE2MzM5ZGFlOGY5ZDg5NjAxM2NkMDYwYTIxNDA2ZTJi",
    "commit": {
      "author": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2018-08-24T09:10:43Z"
      },
      "committer": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2019-05-11T07:14:07Z"
      },
      "message": "Add HKDF HMAC_SHA256 L=32 implementations",
      "tree": {
        "sha": "feaa935ee4a068218a2559654b11a6338ca4c8ac",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/feaa935ee4a068218a2559654b11a6338ca4c8ac"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/551d489416339dae8f9d896013cd060a21406e2b",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyhopCNzi8TB0xizeHrd2uwPHki0FAlzWdkAACgkQHrd2uwPH\nki381BAAmjVpAwdcxcyaYcY+z5c+1mnIHdlLPrloL3UW4pt7J6yq/rns67icSAl1\n8t3oKy3JV96ajAscow/yJXOe2X5t3hgcRggVs96+i0VDtLKQ4F4z7pUI1KFFpisZ\ng2e5jKwZuqlxtlJXbCMLCrYc7Q/C5eK6/JJz1ZLKmRP9Qj2UXx0D41NE2W/+0HJl\nqrVXpFr/niWeikMpqNE/W8IMfArtpfnYs2GoPiPGF70S3yx6x9Vto5OwE/QV4n0w\nYxHzvXkUe7kh+jSphJzwc1NJyRk3rMUDypvJHyJKRpbOCuUX4XMrWTvlCrDqzR6z\nKJOi5hV7wpmGWrhT+d7rUNDjr2fPNOtAYTu6BNNYJYhvbrVjLY1TcCM40lYlhOEj\nqIxkWoeoJRH6MrcmYXqSEwHprEXibAVKxtwvhfoGAy7yexYgVdrTm/P7E2IuzzaB\npk09r9EQR69jabcbM2SnUn4GRWfswrkGlwOLcMBAVH4bnmUxed2KFN6CERV0sg9h\nwJ4EXt+3WkagNqykzuG8vmWlvTjHNe61OdV9vPKa2ryX7dYpYzgo7FSx52MrTS92\nSSK4cRWKrp7AWiy5Cg9xPVoLxLGYBslEbMiNTzKv8ZnjSaMgimvUCBIvC/fNgp51\n1hKXpxcODcNkleOGVshb/kXcEwpA+txbK07Qsc4V/BAuyZZGO4c=\n=Kp2e\n-----END PGP SIGNATURE-----",
        "payload": "tree feaa935ee4a068218a2559654b11a6338ca4c8ac\nparent 3b64f852e400c552f031697d6a86829dc6e74bd6\nauthor Jonas Schnelli <dev@jonasschnelli.ch> 1535101843 +0200\ncommitter Jonas Schnelli <dev@jonasschnelli.ch> 1557558847 +0200\n\nAdd HKDF HMAC_SHA256 L=32 implementations\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/551d489416339dae8f9d896013cd060a21406e2b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/551d489416339dae8f9d896013cd060a21406e2b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/551d489416339dae8f9d896013cd060a21406e2b/comments",
    "author": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "3b64f852e400c552f031697d6a86829dc6e74bd6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3b64f852e400c552f031697d6a86829dc6e74bd6",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/3b64f852e400c552f031697d6a86829dc6e74bd6"
      }
    ],
    "stats": {
      "total": 48,
      "additions": 48,
      "deletions": 0
    },
    "files": [
      {
        "sha": "3f3487a37b28ba8f565453ebb17bb09886fb1e40",
        "filename": "src/Makefile.am",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/551d489416339dae8f9d896013cd060a21406e2b/src/Makefile.am",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/551d489416339dae8f9d896013cd060a21406e2b/src/Makefile.am",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.am?ref=551d489416339dae8f9d896013cd060a21406e2b",
        "patch": "@@ -342,6 +342,8 @@ crypto_libbitcoin_crypto_base_a_SOURCES = \\\n   crypto/chacha20.h \\\n   crypto/chacha20.cpp \\\n   crypto/common.h \\\n+  crypto/hkdf_sha256_32.cpp \\\n+  crypto/hkdf_sha256_32.h \\\n   crypto/hmac_sha256.cpp \\\n   crypto/hmac_sha256.h \\\n   crypto/hmac_sha512.cpp \\"
      },
      {
        "sha": "9cea5995eca9f0b8093334ca9f15fd3d8fbdd95c",
        "filename": "src/crypto/hkdf_sha256_32.cpp",
        "status": "added",
        "additions": 21,
        "deletions": 0,
        "changes": 21,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/551d489416339dae8f9d896013cd060a21406e2b/src/crypto/hkdf_sha256_32.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/551d489416339dae8f9d896013cd060a21406e2b/src/crypto/hkdf_sha256_32.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/crypto/hkdf_sha256_32.cpp?ref=551d489416339dae8f9d896013cd060a21406e2b",
        "patch": "@@ -0,0 +1,21 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <crypto/hkdf_sha256_32.h>\n+\n+#include <assert.h>\n+#include <string.h>\n+\n+CHKDF_HMAC_SHA256_L32::CHKDF_HMAC_SHA256_L32(const unsigned char* ikm, size_t ikmlen, const std::string& salt)\n+{\n+    CHMAC_SHA256((const unsigned char*)salt.c_str(), salt.size()).Write(ikm, ikmlen).Finalize(m_prk);\n+}\n+\n+void CHKDF_HMAC_SHA256_L32::Expand32(const std::string& info, unsigned char hash[OUTPUT_SIZE])\n+{\n+    // expand a 32byte key (single round)\n+    assert(info.size() <= 128);\n+    static const unsigned char one[1] = {1};\n+    CHMAC_SHA256(m_prk, 32).Write((const unsigned char*)info.data(), info.size()).Write(one, 1).Finalize(hash);\n+}"
      },
      {
        "sha": "fa1e42aec164068b2606235d1cc624c7f80d06f8",
        "filename": "src/crypto/hkdf_sha256_32.h",
        "status": "added",
        "additions": 25,
        "deletions": 0,
        "changes": 25,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/551d489416339dae8f9d896013cd060a21406e2b/src/crypto/hkdf_sha256_32.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/551d489416339dae8f9d896013cd060a21406e2b/src/crypto/hkdf_sha256_32.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/crypto/hkdf_sha256_32.h?ref=551d489416339dae8f9d896013cd060a21406e2b",
        "patch": "@@ -0,0 +1,25 @@\n+// Copyright (c) 2018 The Bitcoin Core developers\n+// Distributed under the MIT software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#ifndef BITCOIN_CRYPTO_HKDF_SHA256_32_H\n+#define BITCOIN_CRYPTO_HKDF_SHA256_32_H\n+\n+#include <crypto/hmac_sha256.h>\n+\n+#include <stdint.h>\n+#include <stdlib.h>\n+\n+/** A rfc5869 HKDF implementation with HMAC_SHA256 and fixed key output length of 32 bytes (L=32) */\n+class CHKDF_HMAC_SHA256_L32\n+{\n+private:\n+    unsigned char m_prk[32];\n+    static const size_t OUTPUT_SIZE = 32;\n+\n+public:\n+    CHKDF_HMAC_SHA256_L32(const unsigned char* ikm, size_t ikmlen, const std::string& salt);\n+    void Expand32(const std::string& info, unsigned char hash[OUTPUT_SIZE]);\n+};\n+\n+#endif // BITCOIN_CRYPTO_HKDF_SHA256_32_H"
      }
    ]
  },
  {
    "sha": "8794a4b3ae4d34a4cd21a7dee9f694eef7726a4f",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4Nzk0YTRiM2FlNGQzNGE0Y2QyMWE3ZGVlOWY2OTRlZWY3NzI2YTRm",
    "commit": {
      "author": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2018-08-24T09:10:57Z"
      },
      "committer": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2019-05-11T07:14:09Z"
      },
      "message": "QA: add test for HKDF HMAC_SHA256 L32",
      "tree": {
        "sha": "09ce344f444c0638db5cd04694e934c87c0aebbb",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/09ce344f444c0638db5cd04694e934c87c0aebbb"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8794a4b3ae4d34a4cd21a7dee9f694eef7726a4f",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyhopCNzi8TB0xizeHrd2uwPHki0FAlzWdkEACgkQHrd2uwPH\nki2baA/+J8U+LecoaWtXF8C6QVpd8A5prjsHDowaq6ElJX3asby0KsLeHTH+ZhWf\nQDEW8hHxSCuuFvkBHUsKY6FexNVaqDgPIKBqo3qbdzxw1gFprCU9UbwBFP7LYBH1\nXGTQ/iZF0d7+OhfGvBgHx/ykQRBVjV+EKD9bwfbFgboerOBBVqdvbz0eW+M4AFRu\nZ9Ij9WE9gqFXoMHZmPI930PRSV53LZvNVEdO44o7pFp1A5hNdraQlojeqNHefP7+\nsZFnOmAwdUr8IhociocDP5U/8KJX3pLvJQazXxS6rIczWPM/u6tSi1TJuJkRElF0\nTqDau9VGH+v4ykNiJidezF1QHAl8gWHDPhZwSIaqZC2gY1PlC2m0V1uTxm6MQLnf\nZ2h7kjHej/tqyxnR0HtqQMyRrNX2rsx5PJFy4MqI+P8k/HlEqZd1K2tnRGP5Yp0h\nwny/VrH/wnLQRJ8zMv8equMQD2Itcn8cuCCQ5UNs64LWsiEXh9owksZer4gCf+gQ\nTAySdvFhix6wjTvPyxDf7SBg7RMfAi2iRzOaMQdsr/xCDrO/KthtTW39X0Rs87iU\nsoyX+6DjqCcIIuc4oCwRm97zIJ0deOT6Syj2KFKrJmPn1HuZAi72gbhGI5YwJ6kT\nd5oXHyfO+dt1+vmaHLY5TFqD5/Hbk9DmuiIaS4MzlXd/YhZPcR8=\n=vS3i\n-----END PGP SIGNATURE-----",
        "payload": "tree 09ce344f444c0638db5cd04694e934c87c0aebbb\nparent 551d489416339dae8f9d896013cd060a21406e2b\nauthor Jonas Schnelli <dev@jonasschnelli.ch> 1535101857 +0200\ncommitter Jonas Schnelli <dev@jonasschnelli.ch> 1557558849 +0200\n\nQA: add test for HKDF HMAC_SHA256 L32\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/8794a4b3ae4d34a4cd21a7dee9f694eef7726a4f",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/8794a4b3ae4d34a4cd21a7dee9f694eef7726a4f",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/8794a4b3ae4d34a4cd21a7dee9f694eef7726a4f/comments",
    "author": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "551d489416339dae8f9d896013cd060a21406e2b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/551d489416339dae8f9d896013cd060a21406e2b",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/551d489416339dae8f9d896013cd060a21406e2b"
      }
    ],
    "stats": {
      "total": 41,
      "additions": 39,
      "deletions": 2
    },
    "files": [
      {
        "sha": "90d78f24bd52d0e81d7208fc174504ef90cfb148",
        "filename": "src/test/crypto_tests.cpp",
        "status": "modified",
        "additions": 39,
        "deletions": 2,
        "changes": 41,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/8794a4b3ae4d34a4cd21a7dee9f694eef7726a4f/src/test/crypto_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/8794a4b3ae4d34a4cd21a7dee9f694eef7726a4f/src/test/crypto_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/crypto_tests.cpp?ref=8794a4b3ae4d34a4cd21a7dee9f694eef7726a4f",
        "patch": "@@ -5,12 +5,13 @@\n #include <crypto/aes.h>\n #include <crypto/chacha20.h>\n #include <crypto/poly1305.h>\n+#include <crypto/hkdf_sha256_32.h>\n+#include <crypto/hmac_sha256.h>\n+#include <crypto/hmac_sha512.h>\n #include <crypto/ripemd160.h>\n #include <crypto/sha1.h>\n #include <crypto/sha256.h>\n #include <crypto/sha512.h>\n-#include <crypto/hmac_sha256.h>\n-#include <crypto/hmac_sha512.h>\n #include <random.h>\n #include <util/strencodings.h>\n #include <test/test_bitcoin.h>\n@@ -212,6 +213,22 @@ static void TestPoly1305(const std::string &hexmessage, const std::string &hexke\n     BOOST_CHECK(tag == tagres);\n }\n \n+static void TestHKDF_SHA256_32(const std::string &ikm_hex, const std::string &salt_hex, const std::string &info_hex, const std::string &okm_check_hex) {\n+    std::vector<unsigned char> initial_key_material = ParseHex(ikm_hex);\n+    std::vector<unsigned char> salt = ParseHex(salt_hex);\n+    std::vector<unsigned char> info = ParseHex(info_hex);\n+\n+\n+    // our implementation only supports strings for the \"info\" and \"salt\", stringify them\n+    std::string salt_stringified(reinterpret_cast<char*>(salt.data()), salt.size());\n+    std::string info_stringified(reinterpret_cast<char*>(info.data()), info.size());\n+\n+    CHKDF_HMAC_SHA256_L32 hkdf32(initial_key_material.data(), initial_key_material.size(), salt_stringified);\n+    unsigned char out[32];\n+    hkdf32.Expand32(info_stringified, out);\n+    BOOST_CHECK(HexStr(out, out + 32) == okm_check_hex);\n+}\n+\n static std::string LongTestString() {\n     std::string ret;\n     for (int i=0; i<200000; i++) {\n@@ -606,6 +623,26 @@ BOOST_AUTO_TEST_CASE(poly1305_testvector)\n                  \"13000000000000000000000000000000\");\n }\n \n+BOOST_AUTO_TEST_CASE(hkdf_hmac_sha256_l32_tests)\n+{\n+    // Use rfc5869 test vectors but trucated to 32 bytes (our implementation only support length 32)\n+    TestHKDF_SHA256_32(\n+                /* IKM */ \"0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b\",\n+                /* salt */ \"000102030405060708090a0b0c\",\n+                /* info */ \"f0f1f2f3f4f5f6f7f8f9\",\n+                /* expected OKM */ \"3cb25f25faacd57a90434f64d0362f2a2d2d0a90cf1a5a4c5db02d56ecc4c5bf\");\n+    TestHKDF_SHA256_32(\n+                \"000102030405060708090a0b0c0d0e0f101112131415161718191a1b1c1d1e1f202122232425262728292a2b2c2d2e2f303132333435363738393a3b3c3d3e3f404142434445464748494a4b4c4d4e4f\",\n+                \"606162636465666768696a6b6c6d6e6f707172737475767778797a7b7c7d7e7f808182838485868788898a8b8c8d8e8f909192939495969798999a9b9c9d9e9fa0a1a2a3a4a5a6a7a8a9aaabacadaeaf\",\n+                \"b0b1b2b3b4b5b6b7b8b9babbbcbdbebfc0c1c2c3c4c5c6c7c8c9cacbcccdcecfd0d1d2d3d4d5d6d7d8d9dadbdcdddedfe0e1e2e3e4e5e6e7e8e9eaebecedeeeff0f1f2f3f4f5f6f7f8f9fafbfcfdfeff\",\n+                \"b11e398dc80327a1c8e7f78c596a49344f012eda2d4efad8a050cc4c19afa97c\");\n+    TestHKDF_SHA256_32(\n+                \"0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b0b\",\n+                \"\",\n+                \"\",\n+                \"8da4e775a563c18f715f802a063c5a31b8a11f5c5ee1879ec3454e5f3c738d2d\");\n+}\n+\n BOOST_AUTO_TEST_CASE(countbits_tests)\n {\n     FastRandomContext ctx;"
      }
    ]
  }
]