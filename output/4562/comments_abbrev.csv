petertodd,2014-07-20T06:26:44Z,"Have you actually benchmarked this? The vast majority of CHECKMULTISIG's are just two signatures, three at most.\n",https://github.com/bitcoin/bitcoin/pull/4562#issuecomment-49538526,49538526,
jtimon,2014-07-22T13:52:44Z,"No we didn't and probably the gains won't be very big.\nThis came up in a conversation when I was pointing out that if we knew the sighash before calling EvalScript, the serialization could be done before and only once per script evaluation (instead of once per CheckSig). EvalScript receives a nHashType parameter but it's only used for checking it is the same as the ones contained at the end of th",https://github.com/bitcoin/bitcoin/pull/4562#issuecomment-49741266,49741266,
petertodd,2014-07-22T19:50:55Z,"#4555 is removing a feature in EvalScript() that lets the callee determine what type of sighashes a scriptSig contains. For instance I might want to verify that a scriptSig only contains SIGHASH_ANYONECANPAY sigs to see if I can add/remove inputs.\n\nAs for why each CHECKSIG can use a different nHashType and thus sighash, that's just flexibility. For instance GreenAddress.it's nLockTime scheme use",https://github.com/bitcoin/bitcoin/pull/4562#issuecomment-49791177,49791177,
jtimon,2014-07-23T02:53:04Z,"I don't understand that use case. Is the refund script signed with anyone can pay and something else at the same time? Is it multisig?\nI don't get it.\nBy ""placed after the signatures"" I mean why they are in vchSig.back() of each checksig call.\nAbout the feature that #4555 removes, it is not currently used by the core nor the wallet, but anyway, if there was only one sighash per evalscript/input",https://github.com/bitcoin/bitcoin/pull/4562#issuecomment-49827501,49827501,
petertodd,2014-07-23T03:57:23Z,"@jtimon Yeah, it's multisig.\n\nThe vchSig.back() bit is just standard conservatism to make sure a signature can't be reused for something unintended. I remember finding a case where that prevented a security issue awhile back, although for the life of me I don't remember the details exactly.\n\nMaking the sighash be a part of the CTxIn structure doesn't really make sense in a system with scripts ",https://github.com/bitcoin/bitcoin/pull/4562#issuecomment-49830472,49830472,
jtimon,2014-07-30T20:27:15Z,"@simondlr see #4498 for style\n@petertodd I'm trying to think of a use case in which you need different sigashes for the same input and nothing comes to mind...sigall and sigsingle at the same time?\nAnyway, my intent wasn't to improve performance but rather improving readability without hurting performance. I found a potential optimization instead, what I wanted to do was to serialize the transac",https://github.com/bitcoin/bitcoin/pull/4562#issuecomment-50674719,50674719,
sipa,2014-07-30T20:43:14Z,"@jtimon That's a bit of a stretch. I wouldn't call it a design flaw just because it's not understood (it adds a tiny bit of complexity, and has no known drawbacks for performance or security). \n",https://github.com/bitcoin/bitcoin/pull/4562#issuecomment-50676786,50676786,
petertodd,2014-07-31T09:19:13Z,"@jtimon reread my answer above pointing out how Green address _already_ makes use of the fact that there can be more than one SIGHASH flag in a deployed, production, application. \n\nPremature optimisation is the root of all evil; the scalability problems Bitcoin has aren't going to be solved with little single digit improvements everywhere at the cost of making the protocol less generic. \n",https://github.com/bitcoin/bitcoin/pull/4562#issuecomment-50736220,50736220,
jtimon,2014-07-31T11:54:40Z,"@sipa I was going to say that it adds some complexity and minimally hurts for no good reason (that I know).\nBut, yes, re-reading @petertodd 's green address example is enough of a reason, even though I'm not convinced that what they're trying to do cannot be better done in another way. No one is talking about Bitcoin's scalability problems, just about small improvements you could have if you coul",https://github.com/bitcoin/bitcoin/pull/4562#issuecomment-50748708,50748708,
petertodd,2014-07-31T22:38:59Z,"@jtimon I'd be inclined to make Bitcoin more generic, not less, in the event of a protocol redesign. That CHECKSIG is multiple operations combined into one is a mistake, not something we should push even further.\n",https://github.com/bitcoin/bitcoin/pull/4562#issuecomment-50828194,50828194,
sipa,2014-08-02T22:27:37Z,"I've rewritten it to use statically allocated hashes rather than an std::map, so it doesn't even have dynamic memory overhead.\n\nI think the improvement is small, but maybe worthwhile. I'm not going to spend more time on it, however.\n",https://github.com/bitcoin/bitcoin/pull/4562#issuecomment-50976363,50976363,
BitcoinPullTester,2014-08-02T22:53:12Z,"Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/p4562_31dd5b37272f162155b3dd944a6f8c2b74c7448c/ for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-te",https://github.com/bitcoin/bitcoin/pull/4562#issuecomment-50976881,50976881,
jtimon,2014-08-05T09:46:30Z,"Initially I thought the optimization was going to be a side effect in some refactorings I'm working on. Thank you @sipa for showing me that this is the best I could do optimization-wise and realizing that wasn't going to be the case.\nI was also interested in understanding why it was allowed to have different sighash in the same script evaluation, thank you @petertodd for pointing out the green ad",https://github.com/bitcoin/bitcoin/pull/4562#issuecomment-51175400,51175400,
sipa,2014-09-10T00:00:46Z,"Needs rebase, and hasn't received any interest. Closing.\n",https://github.com/bitcoin/bitcoin/pull/4562#issuecomment-55054172,55054172,
