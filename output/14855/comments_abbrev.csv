Empact,2018-12-02T10:20:57Z,/cc #8524,https://github.com/bitcoin/bitcoin/pull/14855#issuecomment-443496571,443496571,
laanwj,2019-01-02T13:13:51Z,Re-ping @NicolasDorier @sipa,https://github.com/bitcoin/bitcoin/pull/14855#issuecomment-450860152,450860152,
sipa,2019-01-02T13:29:08Z,"Looks like you can drop `vstream` entirely here, and directly (de)serialize to/from `ssout`?",https://github.com/bitcoin/bitcoin/pull/14855#issuecomment-450863158,450863158,
Empact,2019-01-02T22:21:39Z,"Updated to remove the overrides, and to separately test against PROTOCOL_VERSION and version 0. Because it seemed the original intended to test against 0 but in fact tested against PROTOCOL_VERSION. https://github.com/bitcoin/bitcoin/commit/ab48c5e72156b34300db4a6521cb3c9969be3937#diff-4f6d60b6976522cec2974a0aea9a5ab3R467\n\nThoughts? /cc @NicolasDorier ",https://github.com/bitcoin/bitcoin/pull/14855#issuecomment-451003626,451003626,
Empact,2019-01-02T22:25:36Z,Also removed `WithOrVersion` as this was the only use and shows the function's pitfalls. The other uses of `OverrideStream` are direct.,https://github.com/bitcoin/bitcoin/pull/14855#issuecomment-451004484,451004484,
NicolasDorier,2019-01-03T14:14:12Z,"I don't remember this function at all, ACK to remove it.\n\nOnly point to consider: `test_big_witness_transaction` was quite a slow test... which you are now executing twice. Fine for me though, just mentioning it.",https://github.com/bitcoin/bitcoin/pull/14855#issuecomment-451154432,451154432,
Empact,2019-01-03T17:14:11Z,"Dropped the 0-version test as there is no version-specific behavior in transaction serialization, and if there were, does not seem this would be the place to test it.\n\nMaybe you can weigh in on: is it necessary to do this serialization round-trip at all? Could instantiate the tx from the mtx directly.",https://github.com/bitcoin/bitcoin/pull/14855#issuecomment-451211701,451211701,
NicolasDorier,2019-01-04T05:38:36Z,"The version is used on https://github.com/bitcoin/bitcoin/blob/master/src/primitives/transaction.h#L200\n\nI speculate that the intention of the `WithOrVersion` was to add segwit support to the serialization, because before `PROTOCOL_VERSION` was setting the flag [fAllowWitness](https://github.com/bitcoin/bitcoin/blob/master/src/primitives/transaction.h#L200) to `false`. Now, `PROTOCOL_VERSION` ",https://github.com/bitcoin/bitcoin/pull/14855#issuecomment-451357500,451357500,
NicolasDorier,2019-01-04T05:39:44Z,ACK,https://github.com/bitcoin/bitcoin/pull/14855#issuecomment-451357589,451357589,
MarcoFalke,2019-01-04T11:15:41Z,"> PROTOCOL_VERSION was setting the flag fAllowWitness to false\n\nAre you sure on that? To me it seems that `fAllowWitness` is always true unless `SERIALIZE_TRANSACTION_NO_WITNESS` is flagged in the version.\n\nutACK 75778a0724b73a0cecd99bd2e1c49fbfdb90e194",https://github.com/bitcoin/bitcoin/pull/14855#issuecomment-451417350,451417350,
sipa,2019-01-04T11:16:48Z,utACK,https://github.com/bitcoin/bitcoin/pull/14855#issuecomment-451417556,451417556,
NicolasDorier,2019-01-04T13:57:23Z,"@MarcoFalke yes, that's why I said `was`. Before we had `PROTOCOL_VERSION` + a flag to add witness.\n\nThen it was refactored for having witness in PROTOCOL_VERSION + a flag to **disable** witness. Unsure if it was before the merge or after the merge that this was refactored, but I am now almost sure it was the initial reason behind this weird code.",https://github.com/bitcoin/bitcoin/pull/14855#issuecomment-451450089,451450089,
MarcoFalke,2019-01-04T16:02:18Z,"Oh, I see. Thanks for clarifying.",https://github.com/bitcoin/bitcoin/pull/14855#issuecomment-451485684,451485684,
