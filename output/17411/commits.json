[
  {
    "sha": "adbe15504713ddba6e9c024c59d977675d49e350",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphZGJlMTU1MDQ3MTNkZGJhNmU5YzAyNGM1OWQ5Nzc2NzVkNDllMzUw",
    "commit": {
      "author": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@protonmail.com",
        "date": "2019-11-08T07:33:44Z"
      },
      "committer": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@protonmail.com",
        "date": "2019-11-19T14:13:57Z"
      },
      "message": "doc: Add some better examples for scripted diff\n\nThe current example isn't too great, for example it uses `find` instead\nof `git ls-files`. Add a subsection with suggestions and examples.",
      "tree": {
        "sha": "83a4966da20fd8e58ce81de1f5e616a0eb2efde8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/83a4966da20fd8e58ce81de1f5e616a0eb2efde8"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/adbe15504713ddba6e9c024c59d977675d49e350",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/adbe15504713ddba6e9c024c59d977675d49e350",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/adbe15504713ddba6e9c024c59d977675d49e350",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/adbe15504713ddba6e9c024c59d977675d49e350/comments",
    "author": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "e65b4160e99fa86d6d840dce75cae29334afd1f2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e65b4160e99fa86d6d840dce75cae29334afd1f2",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/e65b4160e99fa86d6d840dce75cae29334afd1f2"
      }
    ],
    "stats": {
      "total": 33,
      "additions": 31,
      "deletions": 2
    },
    "files": [
      {
        "sha": "5f9c18f2f54217306b1be5ce9664fb0a4bc87311",
        "filename": "doc/developer-notes.md",
        "status": "modified",
        "additions": 31,
        "deletions": 2,
        "changes": 33,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/adbe15504713ddba6e9c024c59d977675d49e350/doc/developer-notes.md",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/adbe15504713ddba6e9c024c59d977675d49e350/doc/developer-notes.md",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/doc/developer-notes.md?ref=adbe15504713ddba6e9c024c59d977675d49e350",
        "patch": "@@ -35,6 +35,7 @@ Developer Notes\n     - [GUI](#gui)\n     - [Subtrees](#subtrees)\n     - [Scripted diffs](#scripted-diffs)\n+        - [Suggestions and examples](#suggestions-and-examples)\n     - [Release notes](#release-notes)\n     - [RPC interface guidelines](#rpc-interface-guidelines)\n \n@@ -889,7 +890,7 @@ Scripted diffs\n For reformatting and refactoring commits where the changes can be easily automated using a bash script, we use\n scripted-diff commits. The bash script is included in the commit message and our Travis CI job checks that\n the result of the script is identical to the commit. This aids reviewers since they can verify that the script\n-does exactly what it's supposed to do. It is also helpful for rebasing (since the same script can just be re-run\n+does exactly what it is supposed to do. It is also helpful for rebasing (since the same script can just be re-run\n on the new master commit).\n \n To create a scripted-diff:\n@@ -910,7 +911,35 @@ For development, it might be more convenient to verify all scripted-diffs in a r\n test/lint/commit-script-check.sh origin/master..HEAD\n ```\n \n-Commit [`bb81e173`](https://github.com/bitcoin/bitcoin/commit/bb81e173) is an example of a scripted-diff.\n+### Suggestions and examples\n+\n+If you need to replace in multiple files, prefer `git ls-files` to `find` or globbing, and `git grep` to `grep`, to\n+avoid changing files that are not under version control.\n+\n+For efficient replacement scripts, reduce the selection to the files that potentially need to be modified, so for\n+example, instead of a blanket `git ls-files src | xargs sed -i s/apple/orange/`, use\n+`git grep -l apple src | xargs sed -i s/apple/orange/`.\n+\n+Also, it is good to keep the selection of files as specific as possible \u2014 for example, replace only in directories where\n+you expect replacements \u2014 because it reduces the risk that a rebase of your commit by re-running the script will\n+introduce accidental changes.\n+\n+Some good examples of scripted-diff:\n+\n+- [scripted-diff: Rename InitInterfaces to NodeContext](https://github.com/bitcoin/bitcoin/commit/301bd41a2e6765b185bd55f4c541f9e27aeea29d)\n+uses an elegant script to replace occurences of multiple terms in all source files.\n+\n+- [scripted-diff: Remove g_connman, g_banman globals](https://github.com/bitcoin/bitcoin/commit/301bd41a2e6765b185bd55f4c541f9e27aeea29d)\n+replaces specific terms in a list of specific source files.\n+\n+- [scripted-diff: Replace fprintf with tfm::format](https://github.com/bitcoin/bitcoin/commit/fac03ec43a15ad547161e37e53ea82482cc508f9)\n+does a global replacement but excludes certain directories.\n+\n+To find all previous uses of scripted diffs in the repository, do:\n+\n+```\n+git log --grep=\"-BEGIN VERIFY SCRIPT-\"\n+```\n \n Release notes\n -------------"
      }
    ]
  }
]