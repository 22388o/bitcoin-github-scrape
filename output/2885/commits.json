[
  {
    "sha": "6407dc93a5165aaf016118bad211d8415b92f4e7",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2NDA3ZGM5M2E1MTY1YWFmMDE2MTE4YmFkMjExZDg0MTViOTJmNGU3",
    "commit": {
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2013-08-08T03:09:07Z"
      },
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2013-08-08T03:09:07Z"
      },
      "message": "Reject dust amounts during validation\n\nReplaces the validation check for \"amount == 0\" with an isDust check,\nso very small output amounts are caught before the wallet\nis unlocked, a transaction is created, etc.",
      "tree": {
        "sha": "dd1ec0c42a01c7c2ff90c49273e16497e7a431b8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/dd1ec0c42a01c7c2ff90c49273e16497e7a431b8"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6407dc93a5165aaf016118bad211d8415b92f4e7",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6407dc93a5165aaf016118bad211d8415b92f4e7",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/6407dc93a5165aaf016118bad211d8415b92f4e7",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6407dc93a5165aaf016118bad211d8415b92f4e7/comments",
    "author": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "ddd0e2f616be82fb57d68298be796c34268c6ae9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ddd0e2f616be82fb57d68298be796c34268c6ae9",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/ddd0e2f616be82fb57d68298be796c34268c6ae9"
      }
    ],
    "stats": {
      "total": 32,
      "additions": 20,
      "deletions": 12
    },
    "files": [
      {
        "sha": "c951b21b80c5676dbc0a556c8f70fe8e0ed92db0",
        "filename": "src/qt/guiutil.cpp",
        "status": "modified",
        "additions": 8,
        "deletions": 0,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6407dc93a5165aaf016118bad211d8415b92f4e7/src/qt/guiutil.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6407dc93a5165aaf016118bad211d8415b92f4e7/src/qt/guiutil.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/guiutil.cpp?ref=6407dc93a5165aaf016118bad211d8415b92f4e7",
        "patch": "@@ -148,6 +148,14 @@ bool parseBitcoinURI(QString uri, SendCoinsRecipient *out)\n     return parseBitcoinURI(uriInstance, out);\n }\n \n+bool isDust(const QString& address, qint64 amount)\n+{\n+    CTxDestination dest = CBitcoinAddress(address.toStdString()).Get();\n+    CScript script; script.SetDestination(dest);\n+    CTxOut txOut(amount, script);\n+    return txOut.IsDust(CTransaction::nMinRelayTxFee);\n+}\n+\n QString HtmlEscape(const QString& str, bool fMultiLine)\n {\n #if QT_VERSION < 0x050000"
      },
      {
        "sha": "8472700f48b4ab7a0dbe070278379efc5a8a235a",
        "filename": "src/qt/guiutil.h",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6407dc93a5165aaf016118bad211d8415b92f4e7/src/qt/guiutil.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6407dc93a5165aaf016118bad211d8415b92f4e7/src/qt/guiutil.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/guiutil.h?ref=6407dc93a5165aaf016118bad211d8415b92f4e7",
        "patch": "@@ -36,6 +36,9 @@ namespace GUIUtil\n     bool parseBitcoinURI(const QUrl &uri, SendCoinsRecipient *out);\n     bool parseBitcoinURI(QString uri, SendCoinsRecipient *out);\n \n+    // Returns true if given address+amount meets \"dust\" definition\n+    bool isDust(const QString& address, qint64 amount);\n+\n     // HTML escaping for rich text controls\n     QString HtmlEscape(const QString& str, bool fMultiLine=false);\n     QString HtmlEscape(const std::string& str, bool fMultiLine=false);"
      },
      {
        "sha": "1c54850a037a3dad2f0257b4636c30192ddfef5a",
        "filename": "src/qt/sendcoinsentry.cpp",
        "status": "modified",
        "additions": 9,
        "deletions": 12,
        "changes": 21,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6407dc93a5165aaf016118bad211d8415b92f4e7/src/qt/sendcoinsentry.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6407dc93a5165aaf016118bad211d8415b92f4e7/src/qt/sendcoinsentry.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/sendcoinsentry.cpp?ref=6407dc93a5165aaf016118bad211d8415b92f4e7",
        "patch": "@@ -101,24 +101,21 @@ bool SendCoinsEntry::validate()\n     // Check input validity\n     bool retval = true;\n \n-    if(!ui->payAmount->validate())\n+    if(!ui->payTo->hasAcceptableInput() ||\n+       (model && !model->validateAddress(ui->payTo->text())))\n     {\n+        ui->payTo->setValid(false);\n         retval = false;\n     }\n-    else\n+\n+    if(!ui->payAmount->validate())\n     {\n-        if(ui->payAmount->value() <= 0)\n-        {\n-            // Cannot send 0 coins or less\n-            ui->payAmount->setValid(false);\n-            retval = false;\n-        }\n+        retval = false;\n     }\n \n-    if(!ui->payTo->hasAcceptableInput() ||\n-       (model && !model->validateAddress(ui->payTo->text())))\n-    {\n-        ui->payTo->setValid(false);\n+    // Reject dust outputs:\n+    if (retval && GUIUtil::isDust(ui->payTo->text(), ui->payAmount->value())) {\n+        ui->payAmount->setValid(false);\n         retval = false;\n     }\n "
      }
    ]
  }
]