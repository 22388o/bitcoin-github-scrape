practicalswift,2020-02-20 20:17:32,Concept ACK,https://github.com/bitcoin/bitcoin/pull/18187#issuecomment-589288255,589288255,
jonasschnelli,2020-02-21 14:22:11,"I added the `--timestamp` option.\nMade a manual test run. Could successfully notarize the dmg (see log below).\n\nI manually signed the newest nighly build https://bitcoin.jonasschnelli.ch/gitian/builds/22 by modifying the gitian-osx-signer.yml. All modified files are in the folder [manual_notarization_test](https://bitcoin.jonasschnelli.ch/gitian/builds/22/manual_notarization_test/).\n\n@fa",https://github.com/bitcoin/bitcoin/pull/18187#issuecomment-589673534,589673534,
jonasschnelli,2020-02-21 14:23:27,"<img width=""750"" alt=""Bildschirmfoto 2020-02-21 um 15 22 55"" src=""https://user-images.githubusercontent.com/178464/75042025-0dc8bc00-54be-11ea-81f0-7854dfeeda9d.png"">\n",https://github.com/bitcoin/bitcoin/pull/18187#issuecomment-589674103,589674103,
jonasschnelli,2020-02-24 07:32:25,"@fanquake: you can't notarize .app folders. From the docs: `You can notarize an existing disk image, installer package, or ZIP archive containing your app`. I think that has to do with the fact that an .app bundle is actually a folder (probably not ideal for hashing).",https://github.com/bitcoin/bitcoin/pull/18187#issuecomment-590196605,590196605,
jonasschnelli,2020-02-26 10:21:28,I extended this patch to also include the required stapling actions.,https://github.com/bitcoin/bitcoin/pull/18187#issuecomment-591351145,591351145,
jonasschnelli,2020-02-26 11:56:00,"I tested the process described in the PRs release-notes documentation: https://bitcoin.jonasschnelli.ch/gitian/build/27\nhttps://bitcoin.jonasschnelli.ch/gitian/builds/27/manual_notarization_plus_stapling/\n\nOne can verify the code signature by `codesign -v --strict Bitcoin-Qt.app` and the notarization stapling `xcrun stapler validate Bitcoin-Qt.app`.",https://github.com/bitcoin/bitcoin/pull/18187#issuecomment-591389315,591389315,
Sjors,2020-02-26 12:44:08,"ACK b513774304cc9d8f77d578cc62607f7733d76424. I'm able to verify the code signature and the notarisation of the example build @jonasschnelli uploaded.\n\nI'll keep an eye on it during upcoming gitian releases.\n\nThe stapled signature alleviates my privacy concerns, for now.\n\nIn the release process, I guess this needs to be appended:\n\n> Only once the Windows/macOS builds each have 3 ma",https://github.com/bitcoin/bitcoin/pull/18187#issuecomment-591407347,591407347,
laanwj,2020-02-26 17:48:46,"light code review ACK b513774304cc9d8f77d578cc62607f7733d76424, thanks a lot for working on this.\nWould be nice if @dongcarl or @theuni could take a look at the gitian build changes too.",https://github.com/bitcoin/bitcoin/pull/18187#issuecomment-591555218,591555218,
Sjors,2020-02-27 08:34:42,"@luke-jr e.a. when you extract a DMG file it creates a virtual disk volume with a couple of files that aid installation:\n\n<img width=""504"" alt=""Schermafbeelding 2020-02-27 om 09 30 47"" src=""https://user-images.githubusercontent.com/10217/75425882-da65b180-5943-11ea-873e-61c73ed8333c.png"">\n\n<img width=""190"" alt=""Schermafbeelding 2020-02-27 om 09 31 56"" src=""https://user-images.githubusercon",https://github.com/bitcoin/bitcoin/pull/18187#issuecomment-591847641,591847641,
Sjors,2020-02-27 12:41:33,"On a related note, see https://github.com/bitcoin-core/docs/pull/59",https://github.com/bitcoin/bitcoin/pull/18187#issuecomment-591950591,591950591,
Sjors,2020-02-27 19:25:08,"See IRC meeting, this probably won't make it into v0.19.1 To preserve user privacy against Apple's servers, I suggest that we _don't_ notarise the v0.19.1 release. The user will have to right-click to install, just like v0.19.0. The v0.20.0 release can have the stapled notarization, which hopefully doesn't get sent to any server.",https://github.com/bitcoin/bitcoin/pull/18187#issuecomment-592134266,592134266,
jonasschnelli,2020-02-27 19:27:27,"> To preserve user privacy against Apple's servers, I suggest that we don't notarise the v0.19.1 release\n\nI guess users with default security settings will also face a online check even if it is not notarized? Since the notarization process does not change the binary/installer.\n\nSomeone should really do some test in a VM when and under what settings it checks against the gatekeeper servers",https://github.com/bitcoin/bitcoin/pull/18187#issuecomment-592135464,592135464,
Sjors,2020-02-27 19:32:13,"> I guess users with default security settings will also face a online check even if it is not notarized? Since the notarization process does not change the binary/installer.\n\nThat's a good point. Maybe if it detects lack of runtime hardening it doesn't ping the server.\n\n> Someone should really do some test in a VM when and under what settings it checks against the gatekeeper servers.\n\",https://github.com/bitcoin/bitcoin/pull/18187#issuecomment-592137613,592137613,
Sjors,2020-02-27 19:35:10,See also https://lapcatsoftware.com/articles/notarization-privacy.html,https://github.com/bitcoin/bitcoin/pull/18187#issuecomment-592138956,592138956,
jonasschnelli,2020-02-28 10:35:28,"I just wiresharked a fresh install macOS 10.15 VM where I downloaded the notarized and stapled test build https://bitcoin.jonasschnelli.ch/gitian/builds/27/manual_notarization_plus_stapling/.\n\nIt looks like even with stapling, there is a OSCP request going on.\n\n<img width=""1600"" alt=""Bildschirmfoto 2020-02-28 um 11 28 35"" src=""https://user-images.githubusercontent.com/178464/75541346-0d7c7",https://github.com/bitcoin/bitcoin/pull/18187#issuecomment-592453829,592453829,
Sjors,2020-02-28 10:44:02,"My guess is that they're checking to see if a previously notarized piece of software has been flagged as malware since. Which begs the question what the point of stapling is, just enabling offline installs?\n\nI tend to agree we should stick to ""right-click-open"" for the time being. But let's leave the PR open.",https://github.com/bitcoin/bitcoin/pull/18187#issuecomment-592457249,592457249,
laanwj,2020-03-06 18:15:58,"> It looks like even with stapling, there is a OSCP request going on.\n\nThanks for digging into this!",https://github.com/bitcoin/bitcoin/pull/18187#issuecomment-595894457,595894457,
jonatack,2020-03-26 19:26:23,"Nice investigating, @jonasschnelli! I agree that sticking to the right-click-open and erring on the side of privacy is best, if we can avoid Apple phoning home, along with improving user communication/documentation in the DMG and on the website.",https://github.com/bitcoin/bitcoin/pull/18187#issuecomment-604636600,604636600,
DrahtBot,2020-04-03 12:03:26,<!--cf906140f33d8803c4a75a2196329ecb-->\n🐙 This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).,https://github.com/bitcoin/bitcoin/pull/18187#issuecomment-608395818,608395818,
fanquake,2020-05-02 13:32:27,Giving that we _may_ be doing this at some point in the future; going to close this for now.,https://github.com/bitcoin/bitcoin/pull/18187#issuecomment-622954381,622954381,
fanquake,2020-02-21 00:22:24,"After reading through the [docs](https://developer.apple.com/documentation/xcode/notarizing_macos_software_before_distribution) it seems that passing `--timestamp` here would also be required for notarization; given that we are signing manually?\n\n> Include a secure timestamp with your code-signing signature. (The Xcode distribution workflow includes a secure timestamp by default. For custom wo",https://github.com/bitcoin/bitcoin/pull/18187#discussion_r382333759,382333759,contrib/macdeploy/detached-sig-create.sh
fanquake,2020-02-21 00:35:13,"Is there any reason why we can't pass `--strict` to `codesign` here as well?\n```bash\n     --strict options\n             When validating code, apply additional restrictions beyond the defaults.\n\n             symlinks  Check that symbolic links inside the code bundle point to sealed files inside its bundle.\n                       This means that broken symbolic links are rejected, as are",https://github.com/bitcoin/bitcoin/pull/18187#discussion_r382337371,382337371,contrib/macdeploy/detached-sig-create.sh
jonasschnelli,2020-02-21 13:55:03,Isn't that for validation only?,https://github.com/bitcoin/bitcoin/pull/18187#discussion_r382592506,382592506,contrib/macdeploy/detached-sig-create.sh
jonasschnelli,2020-02-21 14:15:43,Good point. Added.,https://github.com/bitcoin/bitcoin/pull/18187#discussion_r382603069,382603069,contrib/macdeploy/detached-sig-create.sh
fanquake,2020-02-22 02:22:49,Yes that looks correct.,https://github.com/bitcoin/bitcoin/pull/18187#discussion_r382877857,382877857,contrib/macdeploy/detached-sig-create.sh
fanquake,2020-02-24 00:47:20,nit: `notarization`,https://github.com/bitcoin/bitcoin/pull/18187#discussion_r383056909,383056909,doc/release-process.md
jonasschnelli,2020-02-24 07:30:20,Thanks. Fixed.,https://github.com/bitcoin/bitcoin/pull/18187#discussion_r383112705,383112705,doc/release-process.md
luke-jr,2020-02-26 19:25:51,"Is ""resources"" misspelled intentionally?",https://github.com/bitcoin/bitcoin/pull/18187#discussion_r384711792,384711792,doc/release-process.md
luke-jr,2020-02-26 19:26:24,"Can `gitian-osx-signer.yml` do this, so we have gitian signatures on the final DMG?",https://github.com/bitcoin/bitcoin/pull/18187#discussion_r384712093,384712093,doc/release-process.md
luke-jr,2020-02-26 19:27:40,How do we not provide this file? AFAIK anything listed here is required by gitian?,https://github.com/bitcoin/bitcoin/pull/18187#discussion_r384712779,384712779,contrib/gitian-descriptors/gitian-osx-signer.yml
jonasschnelli,2020-02-26 21:14:11,AFAIK it only produces a warning (`sha256sum: signature-osx.tar.gz: No such file or directory`).,https://github.com/bitcoin/bitcoin/pull/18187#discussion_r384768999,384768999,contrib/gitian-descriptors/gitian-osx-signer.yml
jonasschnelli,2020-02-26 21:14:18,Thanks. Fixed.,https://github.com/bitcoin/bitcoin/pull/18187#discussion_r384769047,384769047,doc/release-process.md
jonasschnelli,2020-02-26 21:18:31,"I don't think so since `stapler` is an macOS developer tool. Unsure if this can be made portable.\n\nBut, we have gitian signatures on the final dmg. Everything remains deterministic. It's just the code signature and the notarization ticket that needs to be made manual and centralised.\nThough the notarization ticket is bound to the hash of the dmg (which is built deterministic).\n\nI think t",https://github.com/bitcoin/bitcoin/pull/18187#discussion_r384771730,384771730,doc/release-process.md
luke-jr,2020-02-26 21:42:14,"So we're NOT planning to upload the stapled DMG anywhere?\n",https://github.com/bitcoin/bitcoin/pull/18187#discussion_r384783852,384783852,doc/release-process.md
jonasschnelli,2020-02-27 07:30:42,"We do.\nThe staple command above does create the `CodeResources` file (that actually contains the notarization ticket). The macOS code signer commits that file together with the code signatures. See this example: https://github.com/jonasschnelli/bitcoin-detached-sigs/tree/0.19/osx/dist/Bitcoin-Qt.app/Contents.\n\nThe `detached-sig-apply.sh` takes also that CodeResource file and places it in the",https://github.com/bitcoin/bitcoin/pull/18187#discussion_r384952563,384952563,doc/release-process.md
Sjors,2020-02-27 08:47:52,"It's a bit confusing that there are two `CodeResources` files, that might be worth documenting. There's one in `Bitcoin-Qt.app/Contents/` that you copy below, that's new. And then there's one in `_CodeSignature`, which is bigger.",https://github.com/bitcoin/bitcoin/pull/18187#discussion_r384983500,384983500,doc/release-process.md
