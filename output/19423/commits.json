[
  {
    "sha": "cb31ee01b42af58c64b5d3c0eabae4bcd7fd67cf",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpjYjMxZWUwMWI0MmFmNThjNjRiNWQzYzBlYWJhZTRiY2Q3ZmQ2N2Nm",
    "commit": {
      "author": {
        "name": "gzhao408",
        "email": "gzhao408@berkeley.edu",
        "date": "2020-06-19T16:49:51Z"
      },
      "committer": {
        "name": "gzhao408",
        "email": "gzhao408@berkeley.edu",
        "date": "2020-07-15T23:42:06Z"
      },
      "message": "[test] feefilter during and after IBD\n\nCo-authored-by: Jon Atack <jon@atack.com>",
      "tree": {
        "sha": "6113fbf0c74328617a018cebbf8681588480354b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6113fbf0c74328617a018cebbf8681588480354b"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/cb31ee01b42af58c64b5d3c0eabae4bcd7fd67cf",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/cb31ee01b42af58c64b5d3c0eabae4bcd7fd67cf",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/cb31ee01b42af58c64b5d3c0eabae4bcd7fd67cf",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/cb31ee01b42af58c64b5d3c0eabae4bcd7fd67cf/comments",
    "author": {
      "login": "glozow",
      "id": 25183001,
      "node_id": "MDQ6VXNlcjI1MTgzMDAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/glozow",
      "html_url": "https://github.com/glozow",
      "followers_url": "https://api.github.com/users/glozow/followers",
      "following_url": "https://api.github.com/users/glozow/following{/other_user}",
      "gists_url": "https://api.github.com/users/glozow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/glozow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
      "organizations_url": "https://api.github.com/users/glozow/orgs",
      "repos_url": "https://api.github.com/users/glozow/repos",
      "events_url": "https://api.github.com/users/glozow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/glozow/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "glozow",
      "id": 25183001,
      "node_id": "MDQ6VXNlcjI1MTgzMDAx",
      "avatar_url": "https://avatars.githubusercontent.com/u/25183001?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/glozow",
      "html_url": "https://github.com/glozow",
      "followers_url": "https://api.github.com/users/glozow/followers",
      "following_url": "https://api.github.com/users/glozow/following{/other_user}",
      "gists_url": "https://api.github.com/users/glozow/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/glozow/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/glozow/subscriptions",
      "organizations_url": "https://api.github.com/users/glozow/orgs",
      "repos_url": "https://api.github.com/users/glozow/repos",
      "events_url": "https://api.github.com/users/glozow/events{/privacy}",
      "received_events_url": "https://api.github.com/users/glozow/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "2af56d6d5c387c3208d3d5aae8d428a3d610446f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2af56d6d5c387c3208d3d5aae8d428a3d610446f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/2af56d6d5c387c3208d3d5aae8d428a3d610446f"
      }
    ],
    "stats": {
      "total": 45,
      "additions": 45,
      "deletions": 0
    },
    "files": [
      {
        "sha": "be201e6bc3c4fa7693c906f0d8ba1352ecedc34c",
        "filename": "test/functional/p2p_ibd_txrelay.py",
        "status": "added",
        "additions": 44,
        "deletions": 0,
        "changes": 44,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/cb31ee01b42af58c64b5d3c0eabae4bcd7fd67cf/test/functional/p2p_ibd_txrelay.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/cb31ee01b42af58c64b5d3c0eabae4bcd7fd67cf/test/functional/p2p_ibd_txrelay.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/p2p_ibd_txrelay.py?ref=cb31ee01b42af58c64b5d3c0eabae4bcd7fd67cf",
        "patch": "@@ -0,0 +1,44 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2020 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\"\"\"Test fee filters during and after IBD.\"\"\"\n+\n+from decimal import Decimal\n+\n+from test_framework.messages import COIN\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import assert_equal\n+\n+MAX_FEE_FILTER = Decimal(9170997) / COIN\n+NORMAL_FEE_FILTER = Decimal(100) / COIN\n+\n+\n+class P2PIBDTxRelayTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 2\n+        self.extra_args = [\n+            [\"-minrelaytxfee={}\".format(NORMAL_FEE_FILTER)],\n+            [\"-minrelaytxfee={}\".format(NORMAL_FEE_FILTER)],\n+        ]\n+    def run_test(self):\n+        self.log.info(\"Check that nodes set minfilter to MAX_MONEY while still in IBD\")\n+        for node in self.nodes:\n+            assert node.getblockchaininfo()['initialblockdownload']\n+            for conn_info in node.getpeerinfo():\n+                assert_equal(conn_info['minfeefilter'], MAX_FEE_FILTER)\n+\n+        # Come out of IBD by generating a block\n+        self.nodes[0].generate(1)\n+        self.sync_all()\n+\n+        self.log.info(\"Check that nodes reset minfilter after coming out of IBD\")\n+        for node in self.nodes:\n+            assert not node.getblockchaininfo()['initialblockdownload']\n+            for conn_info in node.getpeerinfo():\n+                assert_equal(conn_info['minfeefilter'], NORMAL_FEE_FILTER)\n+\n+\n+if __name__ == '__main__':\n+    P2PIBDTxRelayTest().main()"
      },
      {
        "sha": "b9e8757497f67557faa23b9fb2db3ade539bfd78",
        "filename": "test/functional/test_runner.py",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/cb31ee01b42af58c64b5d3c0eabae4bcd7fd67cf/test/functional/test_runner.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/cb31ee01b42af58c64b5d3c0eabae4bcd7fd67cf/test/functional/test_runner.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/test_runner.py?ref=cb31ee01b42af58c64b5d3c0eabae4bcd7fd67cf",
        "patch": "@@ -246,6 +246,7 @@\n     'rpc_help.py',\n     'feature_help.py',\n     'feature_shutdown.py',\n+    'p2p_ibd_txrelay.py',\n     # Don't append tests at the end to avoid merge conflicts\n     # Put them in a random line within the section that fits their approximate run-time\n ]"
      }
    ]
  }
]