sdaftuar,2017-08-11T12:21:45Z,ACK,https://github.com/bitcoin/bitcoin/pull/11027#issuecomment-321798704,321798704,
MarcoFalke,2017-08-11T13:21:16Z,"utACK e029c6e, as this is a bug fix. Though, could this potentially break client when `-rpcserialversion=0`? I am thinking about how different json implementations handle duplicate keys in a dict, where each key points to a different value.",https://github.com/bitcoin/bitcoin/pull/11027#issuecomment-321810304,321810304,
achow101,2017-08-11T18:54:51Z,@MarcoFalke Hmm. That might be a problem since `RPCSerializationFlags` are not passed to `EncodeHexTx` in `TxToUniv`.,https://github.com/bitcoin/bitcoin/pull/11027#issuecomment-321892253,321892253,
sipa,2017-08-11T19:00:29Z,"> That might be a problem since `RPCSerializationFlags` are not passed to `EncodeHexTx` in `TxToUniv`.\n\nThat seems to be a bug on its own.",https://github.com/bitcoin/bitcoin/pull/11027#issuecomment-321893521,321893521,
achow101,2017-08-11T19:05:17Z,"Another thing is that not everything that uses `TxToUniv` needs to have hex output, e.g. `decoderawtransaction`",https://github.com/bitcoin/bitcoin/pull/11027#issuecomment-321894569,321894569,
achow101,2017-08-11T19:22:23Z,I added a commit which passes the `RPCSerializationFlags` to `TxToUniv` and a boolean for whether to give `hex` output or not.,https://github.com/bitcoin/bitcoin/pull/11027#issuecomment-321897893,321897893,
MarcoFalke,2017-08-12T00:18:28Z,"> That seems to be a bug on its own.\n\nI don't think so?\n\nAccording to the doc, `-rpcserialversion` sets the serialization of raw transaction or block hex returned in        **non-verbose** mode.",https://github.com/bitcoin/bitcoin/pull/11027#issuecomment-321944342,321944342,
achow101,2017-08-12T00:28:13Z,"@MarcoFalke I interpret that as talking about when verbose mode means that you wouldn't get the hex back, e.g. in `getblock`. If we are returning hex, then I think we should be consistent and all hex should follow whatever the `RPCSerializationFlags` are.",https://github.com/bitcoin/bitcoin/pull/11027#issuecomment-321945098,321945098,
jnewbery,2017-08-17T17:19:17Z,"Strictly speaking, I don't think this is invalid JSON, although client behaviour is undefined if object names are not unique (https://tools.ietf.org/html/rfc7159#section-4). But yes, this is a regression in 0.15 and should be treated as a bug fix.\n\nPerhaps we should add JSON object checking to rpcserver.cpp (in `JSONRPCExecOne()`) and/or authproxy.py (in `__call__()`) to verify the validity of",https://github.com/bitcoin/bitcoin/pull/11027#issuecomment-323138033,323138033,
jnewbery,2017-08-17T17:33:33Z,"Concept ACK\n\n> Another thing is that not everything that uses TxToUniv needs to have hex output, e.g. decoderawtransaction\nI added a commit which passes ... a boolean for whether to give hex output or not.\n\nI don't think you should complicate the interface to `TxToUniv` to specify which fields to return. Either filter them out at the caller, or just return the hex in `decoderawtransactio",https://github.com/bitcoin/bitcoin/pull/11027#issuecomment-323141796,323141796,
achow101,2017-08-17T17:52:59Z,"Swapped the arguments.\n\n>  Either filter them out at the caller\n\nI looked at that but I couldn't find anything in Univalue for removing things from it.\n\n> or just return the hex in `decoderawtransaction`. Is there any harm in returning the hex in that RPC?\n\nSince you are already providing it the hex, it's not useful to be giving the hex back out to the user.",https://github.com/bitcoin/bitcoin/pull/11027#issuecomment-323146751,323146751,
jtimon,2017-08-17T20:41:36Z,"utACK e029c6e\n\n> There are only 2 more calls to TxToUniv so I wonder if it pays to have default arguments.\n\n+1\n",https://github.com/bitcoin/bitcoin/pull/11027#issuecomment-323188236,323188236,
promag,2017-08-17T22:54:51Z,"Wild option ðŸ™„:\n```\nvoid TxToUniv(const CTransaction& tx, const uint256& hashBlock, UniValue& entry);\nvoid TxToUnivWithHex(const CTransaction& tx, const uint256& hashBlock, int serialize_flags, UniValue& entry);\n```",https://github.com/bitcoin/bitcoin/pull/11027#issuecomment-323215814,323215814,
laanwj,2017-08-21T06:41:40Z,"> Since you are already providing it the hex, it's not useful to be giving the hex back out to the user.\n\nI was also really surprised to see the hex being echoed back in `decoderawtransaction` output. That's just a waste of bandwidth especially for large transactions.\n\n>  Either filter them out at the caller\n\nNo, don't do this. univalue objects aren't meant to be written to/processed a",https://github.com/bitcoin/bitcoin/pull/11027#issuecomment-323659189,323659189,
sipa,2017-08-11T20:01:12Z,"Marking a by-value parameter as `const` is redundant. Also, style nit on `serializeFlags`.",https://github.com/bitcoin/bitcoin/pull/11027#discussion_r132772723,132772723,src/core_io.h
achow101,2017-08-11T20:11:49Z,Fixed. It was copy and pasted from two lines above in `EncodeHexTx` :),https://github.com/bitcoin/bitcoin/pull/11027#discussion_r132774417,132774417,src/core_io.h
promag,2017-08-11T23:59:59Z,I think the order should be inverted. There is no need to pass `serialize_flags` if one wants to `include_hex=false`.,https://github.com/bitcoin/bitcoin/pull/11027#discussion_r132803017,132803017,src/core_io.h
laanwj,2017-08-17T16:33:08Z,"~~Don't care about the order, though I'd prefer not using default arguments. Easy enough to just add these on all call sites, there aren't many.~~\n\nEdit: never mind, I think this is a good use of default arguments, just swap them as @promag says.",https://github.com/bitcoin/bitcoin/pull/11027#discussion_r133764507,133764507,src/core_io.h
