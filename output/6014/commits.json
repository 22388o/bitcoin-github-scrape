[
  {
    "sha": "e1756564a404b86a17334bab30c6013864e90f8f",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplMTc1NjU2NGE0MDRiODZhMTczMzRiYWIzMGM2MDEzODY0ZTkwZjhm",
    "commit": {
      "author": {
        "name": "Ivan Pustogarov",
        "email": "ivanpustogarov@users.noreply.github.com",
        "date": "2014-08-12T15:52:28Z"
      },
      "committer": {
        "name": "James Hilliard",
        "email": "james.hilliard1@gmail.com",
        "date": "2015-04-15T02:34:31Z"
      },
      "message": "Add new command line option '-maxoutbound'\n\nWhile there is a command line option to limit the total number of\nconnections ('-maxconnections'), the number of outbound connections is\ncontrolled by a hard-coded constant 'MAX_OUTBOUND_CONNECTIONS=8'.\nThis number (8) of connections has a bad impact on user's privacy. Let's\nkeep the default number of outbound connections (of 8) but allow a user\nto have more privacy by reducing this number (to 3 or 4) using\n'-maxoutbound'.\n\nExplanation: transactions that are first relayed by these 8 entry nodes\nmost probably belong to the same user. In fact, even a subset of these 8\nentry nodes can uniquely identify a user. There is a cheap way for an\nattacker to learn this set of entry nodes and the user's public IP and\nuse it to deanonymize the user (note that users by default advertise\ntheir public IP addresses even when behind NAT).  If the user has 3-4\noutbound connection the success rate of the attack becomes quite low.\n\nConflicts:\n\tsrc/init.cpp",
      "tree": {
        "sha": "1274a09fefada97cda7ab1d389dc8a1d672dbae2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1274a09fefada97cda7ab1d389dc8a1d672dbae2"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e1756564a404b86a17334bab30c6013864e90f8f",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e1756564a404b86a17334bab30c6013864e90f8f",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/e1756564a404b86a17334bab30c6013864e90f8f",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e1756564a404b86a17334bab30c6013864e90f8f/comments",
    "author": {
      "login": "ivanpustogarov",
      "id": 8126617,
      "node_id": "MDQ6VXNlcjgxMjY2MTc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/8126617?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ivanpustogarov",
      "html_url": "https://github.com/ivanpustogarov",
      "followers_url": "https://api.github.com/users/ivanpustogarov/followers",
      "following_url": "https://api.github.com/users/ivanpustogarov/following{/other_user}",
      "gists_url": "https://api.github.com/users/ivanpustogarov/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ivanpustogarov/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ivanpustogarov/subscriptions",
      "organizations_url": "https://api.github.com/users/ivanpustogarov/orgs",
      "repos_url": "https://api.github.com/users/ivanpustogarov/repos",
      "events_url": "https://api.github.com/users/ivanpustogarov/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ivanpustogarov/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jameshilliard",
      "id": 3298484,
      "node_id": "MDQ6VXNlcjMyOTg0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3298484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jameshilliard",
      "html_url": "https://github.com/jameshilliard",
      "followers_url": "https://api.github.com/users/jameshilliard/followers",
      "following_url": "https://api.github.com/users/jameshilliard/following{/other_user}",
      "gists_url": "https://api.github.com/users/jameshilliard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jameshilliard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jameshilliard/subscriptions",
      "organizations_url": "https://api.github.com/users/jameshilliard/orgs",
      "repos_url": "https://api.github.com/users/jameshilliard/repos",
      "events_url": "https://api.github.com/users/jameshilliard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jameshilliard/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "d3eb5ae46a4cc05a0b1dfdba66e704cb5e7886f1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d3eb5ae46a4cc05a0b1dfdba66e704cb5e7886f1",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/d3eb5ae46a4cc05a0b1dfdba66e704cb5e7886f1"
      }
    ],
    "stats": {
      "total": 22,
      "additions": 18,
      "deletions": 4
    },
    "files": [
      {
        "sha": "876f13ede0038e5dad9ac1f01231c25a0e39f6e1",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 13,
        "deletions": 0,
        "changes": 13,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e1756564a404b86a17334bab30c6013864e90f8f/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e1756564a404b86a17334bab30c6013864e90f8f/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=e1756564a404b86a17334bab30c6013864e90f8f",
        "patch": "@@ -69,6 +69,7 @@ enum BindFlags {\n \n static const char* FEE_ESTIMATES_FILENAME=\"fee_estimates.dat\";\n CClientUIInterface uiInterface;\n+const int OUTBOUND_CONNECTIONS_UPPER_LIMIT = 8;\n \n //////////////////////////////////////////////////////////////////////////////\n //\n@@ -299,6 +300,7 @@ std::string HelpMessage(HelpMessageMode mode)\n     strUsage += HelpMessageOpt(\"-forcednsseed\", strprintf(_(\"Always query for peer addresses via DNS lookup (default: %u)\"), 0));\n     strUsage += HelpMessageOpt(\"-listen\", _(\"Accept connections from outside (default: 1 if no -proxy or -connect)\"));\n     strUsage += HelpMessageOpt(\"-maxconnections=<n>\", strprintf(_(\"Maintain at most <n> connections to peers (default: %u)\"), 125));\n+    strUsage += HelpMessageOpt(\"-maxoutbound=<n>\", strprintf(_(\"Establish at most <n> _outbound_ connections to peers (default: %u)\"), 8));\n     strUsage += HelpMessageOpt(\"-maxreceivebuffer=<n>\", strprintf(_(\"Maximum per-connection receive buffer, <n>*1000 bytes (default: %u)\"), 5000));\n     strUsage += HelpMessageOpt(\"-maxsendbuffer=<n>\", strprintf(_(\"Maximum per-connection send buffer, <n>*1000 bytes (default: %u)\"), 1000));\n     strUsage += HelpMessageOpt(\"-onion=<ip:port>\", strprintf(_(\"Use separate SOCKS5 proxy to reach peers via Tor hidden services (default: %s)\"), \"-proxy\"));\n@@ -677,6 +679,17 @@ bool AppInit2(boost::thread_group& threadGroup)\n     if (nFD - MIN_CORE_FILEDESCRIPTORS < nMaxConnections)\n         nMaxConnections = nFD - MIN_CORE_FILEDESCRIPTORS;\n \n+    // Change the default number of outbound connections.  Setting it to more\n+    // than 8 is a bad idea. The number of peers that are able to accept\n+    // incoming connections is about 8,000 ('servers'). The number of peers that\n+    // are behind NAT is about 100,000. If every NATed peer has 8 outgoing\n+    // connections then each server will have 100+8 connections in average.\n+    // This is close to maximum of 125. Increasing '-maxoutbound' to e.g. 10 at\n+    // each client will result in that Bitcoin users will have problems\n+    // connecting to the Bitcoin network.\n+    nMaxOutboundConnections = GetArg(\"-maxoutbound\", 8);\n+    nMaxOutboundConnections = std::max(std::min(OUTBOUND_CONNECTIONS_UPPER_LIMIT,std::min(nMaxOutboundConnections, nMaxConnections)),0);\n+\n     // ********************************************************* Step 3: parameter-to-internal-flags\n \n     fDebug = !mapMultiArgs[\"-debug\"].empty();"
      },
      {
        "sha": "aa4821c0d60f35cba69b7bd243a35c2290cfebc3",
        "filename": "src/net.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 4,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e1756564a404b86a17334bab30c6013864e90f8f/src/net.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e1756564a404b86a17334bab30c6013864e90f8f/src/net.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.cpp?ref=e1756564a404b86a17334bab30c6013864e90f8f",
        "patch": "@@ -53,7 +53,6 @@\n using namespace std;\n \n namespace {\n-    const int MAX_OUTBOUND_CONNECTIONS = 8;\n \n     struct ListenSocket {\n         SOCKET socket;\n@@ -78,6 +77,7 @@ uint64_t nLocalHostNonce = 0;\n static std::vector<ListenSocket> vhListenSocket;\n CAddrMan addrman;\n int nMaxConnections = 125;\n+int nMaxOutboundConnections = 8;\n bool fAddressesInitialized = false;\n \n vector<CNode*> vNodes;\n@@ -821,7 +821,7 @@ void ThreadSocketHandler()\n                     if (nErr != WSAEWOULDBLOCK)\n                         LogPrintf(\"socket error accept failed: %s\\n\", NetworkErrorString(nErr));\n                 }\n-                else if (nInbound >= nMaxConnections - MAX_OUTBOUND_CONNECTIONS)\n+                else if (nInbound >= nMaxConnections - nMaxOutboundConnections)\n                 {\n                     CloseSocket(hSocket);\n                 }\n@@ -1579,7 +1579,7 @@ void StartNode(boost::thread_group& threadGroup)\n \n     if (semOutbound == NULL) {\n         // initialize semaphore\n-        int nMaxOutbound = min(MAX_OUTBOUND_CONNECTIONS, nMaxConnections);\n+        int nMaxOutbound = min(nMaxOutboundConnections, nMaxConnections);\n         semOutbound = new CSemaphore(nMaxOutbound);\n     }\n \n@@ -1621,7 +1621,7 @@ bool StopNode()\n     LogPrintf(\"StopNode()\\n\");\n     MapPort(false);\n     if (semOutbound)\n-        for (int i=0; i<MAX_OUTBOUND_CONNECTIONS; i++)\n+        for (int i=0; i<nMaxOutboundConnections; i++)\n             semOutbound->post();\n \n     if (fAddressesInitialized)"
      },
      {
        "sha": "4f8654f77aee63c9424a085c6174de75bb09699f",
        "filename": "src/net.h",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e1756564a404b86a17334bab30c6013864e90f8f/src/net.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e1756564a404b86a17334bab30c6013864e90f8f/src/net.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.h?ref=e1756564a404b86a17334bab30c6013864e90f8f",
        "patch": "@@ -140,6 +140,7 @@ extern uint64_t nLocalServices;\n extern uint64_t nLocalHostNonce;\n extern CAddrMan addrman;\n extern int nMaxConnections;\n+extern int nMaxOutboundConnections;\n \n extern std::vector<CNode*> vNodes;\n extern CCriticalSection cs_vNodes;"
      }
    ]
  },
  {
    "sha": "502e2da0dafe913ebeab9a4165888cca6b4bd9db",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo1MDJlMmRhMGRhZmU5MTNlYmVhYjlhNDE2NTg4OGNjYTZiNGJkOWRi",
    "commit": {
      "author": {
        "name": "James Hilliard",
        "email": "james.hilliard1@gmail.com",
        "date": "2015-04-15T01:11:19Z"
      },
      "committer": {
        "name": "James Hilliard",
        "email": "james.hilliard1@gmail.com",
        "date": "2015-04-15T04:21:17Z"
      },
      "message": "The option -maxoutbound should only be used by mining pools in order to increase their overall network connectivity. By useing higher quality outbound connections instead of inbound connections pools can propagate blocks faster and reduce orphans.",
      "tree": {
        "sha": "e33edada878af63f0f800549427595d86c0aed20",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e33edada878af63f0f800549427595d86c0aed20"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/502e2da0dafe913ebeab9a4165888cca6b4bd9db",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/502e2da0dafe913ebeab9a4165888cca6b4bd9db",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/502e2da0dafe913ebeab9a4165888cca6b4bd9db",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/502e2da0dafe913ebeab9a4165888cca6b4bd9db/comments",
    "author": {
      "login": "jameshilliard",
      "id": 3298484,
      "node_id": "MDQ6VXNlcjMyOTg0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3298484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jameshilliard",
      "html_url": "https://github.com/jameshilliard",
      "followers_url": "https://api.github.com/users/jameshilliard/followers",
      "following_url": "https://api.github.com/users/jameshilliard/following{/other_user}",
      "gists_url": "https://api.github.com/users/jameshilliard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jameshilliard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jameshilliard/subscriptions",
      "organizations_url": "https://api.github.com/users/jameshilliard/orgs",
      "repos_url": "https://api.github.com/users/jameshilliard/repos",
      "events_url": "https://api.github.com/users/jameshilliard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jameshilliard/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jameshilliard",
      "id": 3298484,
      "node_id": "MDQ6VXNlcjMyOTg0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3298484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jameshilliard",
      "html_url": "https://github.com/jameshilliard",
      "followers_url": "https://api.github.com/users/jameshilliard/followers",
      "following_url": "https://api.github.com/users/jameshilliard/following{/other_user}",
      "gists_url": "https://api.github.com/users/jameshilliard/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jameshilliard/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jameshilliard/subscriptions",
      "organizations_url": "https://api.github.com/users/jameshilliard/orgs",
      "repos_url": "https://api.github.com/users/jameshilliard/repos",
      "events_url": "https://api.github.com/users/jameshilliard/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jameshilliard/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "e1756564a404b86a17334bab30c6013864e90f8f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e1756564a404b86a17334bab30c6013864e90f8f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/e1756564a404b86a17334bab30c6013864e90f8f"
      }
    ],
    "stats": {
      "total": 32,
      "additions": 22,
      "deletions": 10
    },
    "files": [
      {
        "sha": "c421bac98a01e52f03b39317ee1b8a0f629324da",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 22,
        "deletions": 10,
        "changes": 32,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/502e2da0dafe913ebeab9a4165888cca6b4bd9db/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/502e2da0dafe913ebeab9a4165888cca6b4bd9db/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=502e2da0dafe913ebeab9a4165888cca6b4bd9db",
        "patch": "@@ -69,7 +69,6 @@ enum BindFlags {\n \n static const char* FEE_ESTIMATES_FILENAME=\"fee_estimates.dat\";\n CClientUIInterface uiInterface;\n-const int OUTBOUND_CONNECTIONS_UPPER_LIMIT = 8;\n \n //////////////////////////////////////////////////////////////////////////////\n //\n@@ -679,16 +678,29 @@ bool AppInit2(boost::thread_group& threadGroup)\n     if (nFD - MIN_CORE_FILEDESCRIPTORS < nMaxConnections)\n         nMaxConnections = nFD - MIN_CORE_FILEDESCRIPTORS;\n \n-    // Change the default number of outbound connections.  Setting it to more\n-    // than 8 is a bad idea. The number of peers that are able to accept\n-    // incoming connections is about 8,000 ('servers'). The number of peers that\n-    // are behind NAT is about 100,000. If every NATed peer has 8 outgoing\n-    // connections then each server will have 100+8 connections in average.\n-    // This is close to maximum of 125. Increasing '-maxoutbound' to e.g. 10 at\n-    // each client will result in that Bitcoin users will have problems\n-    // connecting to the Bitcoin network.\n+    // This option is useful for mining pools that want faster block propagation.\n+    // Outbound connections will statistically have better overall network connectivity\n+    // than incoming connections. This is due to most nodes that accept these\n+    // outbound connections supporting a maximum of 125 connections.\n+    // Inbound connections are often NAT restricted and will then only support 8\n+    // connections. These NAT restricted connections are less desirable for pools.\n+    // This can be demonstrated using the following example of a pool with 125 connections.\n+    // This example makes the assumption that inbound connections are NAT restricted and \n+    // limited to 8 connections while outbound connections connect to nodes with the\n+    // default connection limit of 125.\n+    // Connection capacity within one hop of pool with default settings:\n+    // (8 outbound connections * 125 connections per node) +\n+    // (117 incoming connections * 8 connections per node) =\n+    // 1936 Connections within one hop of the pool server\n+    // (125 outbound connections * 125 connections per node) =\n+    // 15625 Connections within one hop of the pool server\n+    // Based off of these calculations a pool server can have about 8 times the\n+    // overall network connections within one hop while establishing\n+    // the same amount of connections itself. In reality it will likely be even more\n+    // due to the bitcoin network having far more available connections slots on nodes\n+    // than there are nodes trying to connect to those slots.\n+    // This setting should only be used by pool operators.\n     nMaxOutboundConnections = GetArg(\"-maxoutbound\", 8);\n-    nMaxOutboundConnections = std::max(std::min(OUTBOUND_CONNECTIONS_UPPER_LIMIT,std::min(nMaxOutboundConnections, nMaxConnections)),0);\n \n     // ********************************************************* Step 3: parameter-to-internal-flags\n "
      }
    ]
  }
]