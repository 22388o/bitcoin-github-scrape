[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/300980212",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10391#issuecomment-300980212",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10391",
    "id": 300980212,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMwMDk4MDIxMg==",
    "user": {
      "login": "dcousens",
      "id": 413395,
      "node_id": "MDQ6VXNlcjQxMzM5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/413395?u=034ef1433a0704d9c91b57b993009b0383d6b7c0&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dcousens",
      "html_url": "https://github.com/dcousens",
      "followers_url": "https://api.github.com/users/dcousens/followers",
      "following_url": "https://api.github.com/users/dcousens/following{/other_user}",
      "gists_url": "https://api.github.com/users/dcousens/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dcousens/subscriptions",
      "organizations_url": "https://api.github.com/users/dcousens/orgs",
      "repos_url": "https://api.github.com/users/dcousens/repos",
      "events_url": "https://api.github.com/users/dcousens/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dcousens/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-05-12T04:22:12Z",
    "updated_at": "2017-05-12T04:22:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "https://github.com/luke-jr/bips/blob/bip-0115/bip-0115.mediawiki - for others reference",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/300980212/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/345029367",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10391#issuecomment-345029367",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10391",
    "id": 345029367,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM0NTAyOTM2Nw==",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-11-16T19:05:00Z",
    "updated_at": "2017-11-16T19:05:00Z",
    "author_association": "MEMBER",
    "body": "The BIP needs revising for static analysis compat.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/345029367/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126326593",
    "pull_request_review_id": 48798747,
    "id": 126326593,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyNjMyNjU5Mw==",
    "diff_hunk": "@@ -424,7 +425,36 @@ bool EvalScript(std::vector<std::vector<unsigned char> >& stack, const CScript&\n                     break;\n                 }\n \n-                case OP_NOP1: case OP_NOP4: case OP_NOP5:\n+                case OP_CHECKBLOCKATHEIGHT:\n+                {\n+                    if (!(flags & SCRIPT_VERIFY_CHECKBLOCKATHEIGHT)) {\n+                        // not enabled; treat as a NOP5\n+                        if (flags & SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS) {\n+                            return set_error(serror, SCRIPT_ERR_DISCOURAGE_UPGRADABLE_NOPS);\n+                        }\n+                        break;\n+                    }\n+\n+                    if (stack.size() < 2) {\n+                        return set_error(serror, SCRIPT_ERR_INVALID_STACK_OPERATION);\n+                    }\n+\n+                    // nHeight is a 32-bit signed integer field.\n+                    const int32_t nHeight = CScriptNum(stacktop(-1), true, 4).getint();",
    "path": "src/script/interpreter.cpp",
    "position": 28,
    "original_position": 28,
    "commit_id": "316d727dda71984403475b055ff9e60f0c30795b",
    "original_commit_id": "316d727dda71984403475b055ff9e60f0c30795b",
    "user": {
      "login": "aayanl",
      "id": 10069649,
      "node_id": "MDQ6VXNlcjEwMDY5NjQ5",
      "avatar_url": "https://avatars.githubusercontent.com/u/10069649?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aayanl",
      "html_url": "https://github.com/aayanl",
      "followers_url": "https://api.github.com/users/aayanl/followers",
      "following_url": "https://api.github.com/users/aayanl/following{/other_user}",
      "gists_url": "https://api.github.com/users/aayanl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aayanl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aayanl/subscriptions",
      "organizations_url": "https://api.github.com/users/aayanl/orgs",
      "repos_url": "https://api.github.com/users/aayanl/repos",
      "events_url": "https://api.github.com/users/aayanl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aayanl/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Can this cause a buffer overflow if a block height over 2147483647 occurs?",
    "created_at": "2017-07-10T02:39:43Z",
    "updated_at": "2017-07-10T02:39:43Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10391#discussion_r126326593",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10391",
    "author_association": "NONE",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126326593"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/10391#discussion_r126326593"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10391"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126326593/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 443,
    "original_line": 443,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126329728",
    "pull_request_review_id": 48802026,
    "id": 126329728,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyNjMyOTcyOA==",
    "diff_hunk": "@@ -424,7 +425,36 @@ bool EvalScript(std::vector<std::vector<unsigned char> >& stack, const CScript&\n                     break;\n                 }\n \n-                case OP_NOP1: case OP_NOP4: case OP_NOP5:\n+                case OP_CHECKBLOCKATHEIGHT:\n+                {\n+                    if (!(flags & SCRIPT_VERIFY_CHECKBLOCKATHEIGHT)) {\n+                        // not enabled; treat as a NOP5\n+                        if (flags & SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS) {\n+                            return set_error(serror, SCRIPT_ERR_DISCOURAGE_UPGRADABLE_NOPS);\n+                        }\n+                        break;\n+                    }\n+\n+                    if (stack.size() < 2) {\n+                        return set_error(serror, SCRIPT_ERR_INVALID_STACK_OPERATION);\n+                    }\n+\n+                    // nHeight is a 32-bit signed integer field.\n+                    const int32_t nHeight = CScriptNum(stacktop(-1), true, 4).getint();",
    "path": "src/script/interpreter.cpp",
    "position": 28,
    "original_position": 28,
    "commit_id": "316d727dda71984403475b055ff9e60f0c30795b",
    "original_commit_id": "316d727dda71984403475b055ff9e60f0c30795b",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "No? Why would it?",
    "created_at": "2017-07-10T03:29:29Z",
    "updated_at": "2017-07-10T03:29:29Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10391#discussion_r126329728",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10391",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126329728"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/10391#discussion_r126329728"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10391"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126329728/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 443,
    "original_line": 443,
    "side": "RIGHT",
    "in_reply_to_id": 126326593
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126330442",
    "pull_request_review_id": 48802801,
    "id": 126330442,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyNjMzMDQ0Mg==",
    "diff_hunk": "@@ -424,7 +425,36 @@ bool EvalScript(std::vector<std::vector<unsigned char> >& stack, const CScript&\n                     break;\n                 }\n \n-                case OP_NOP1: case OP_NOP4: case OP_NOP5:\n+                case OP_CHECKBLOCKATHEIGHT:\n+                {\n+                    if (!(flags & SCRIPT_VERIFY_CHECKBLOCKATHEIGHT)) {\n+                        // not enabled; treat as a NOP5\n+                        if (flags & SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS) {\n+                            return set_error(serror, SCRIPT_ERR_DISCOURAGE_UPGRADABLE_NOPS);\n+                        }\n+                        break;\n+                    }\n+\n+                    if (stack.size() < 2) {\n+                        return set_error(serror, SCRIPT_ERR_INVALID_STACK_OPERATION);\n+                    }\n+\n+                    // nHeight is a 32-bit signed integer field.\n+                    const int32_t nHeight = CScriptNum(stacktop(-1), true, 4).getint();",
    "path": "src/script/interpreter.cpp",
    "position": 28,
    "original_position": 28,
    "commit_id": "316d727dda71984403475b055ff9e60f0c30795b",
    "original_commit_id": "316d727dda71984403475b055ff9e60f0c30795b",
    "user": {
      "login": "aayanl",
      "id": 10069649,
      "node_id": "MDQ6VXNlcjEwMDY5NjQ5",
      "avatar_url": "https://avatars.githubusercontent.com/u/10069649?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/aayanl",
      "html_url": "https://github.com/aayanl",
      "followers_url": "https://api.github.com/users/aayanl/followers",
      "following_url": "https://api.github.com/users/aayanl/following{/other_user}",
      "gists_url": "https://api.github.com/users/aayanl/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/aayanl/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/aayanl/subscriptions",
      "organizations_url": "https://api.github.com/users/aayanl/orgs",
      "repos_url": "https://api.github.com/users/aayanl/repos",
      "events_url": "https://api.github.com/users/aayanl/events{/privacy}",
      "received_events_url": "https://api.github.com/users/aayanl/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nHeight is a int32_t, if someone makes a transaction with 2147483648 as the referenced block, it would cause an overflow",
    "created_at": "2017-07-10T03:41:21Z",
    "updated_at": "2017-07-10T03:41:21Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10391#discussion_r126330442",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10391",
    "author_association": "NONE",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126330442"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/10391#discussion_r126330442"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10391"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126330442/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 443,
    "original_line": 443,
    "side": "RIGHT",
    "in_reply_to_id": 126326593
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126333067",
    "pull_request_review_id": 48805686,
    "id": 126333067,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEyNjMzMzA2Nw==",
    "diff_hunk": "@@ -424,7 +425,36 @@ bool EvalScript(std::vector<std::vector<unsigned char> >& stack, const CScript&\n                     break;\n                 }\n \n-                case OP_NOP1: case OP_NOP4: case OP_NOP5:\n+                case OP_CHECKBLOCKATHEIGHT:\n+                {\n+                    if (!(flags & SCRIPT_VERIFY_CHECKBLOCKATHEIGHT)) {\n+                        // not enabled; treat as a NOP5\n+                        if (flags & SCRIPT_VERIFY_DISCOURAGE_UPGRADABLE_NOPS) {\n+                            return set_error(serror, SCRIPT_ERR_DISCOURAGE_UPGRADABLE_NOPS);\n+                        }\n+                        break;\n+                    }\n+\n+                    if (stack.size() < 2) {\n+                        return set_error(serror, SCRIPT_ERR_INVALID_STACK_OPERATION);\n+                    }\n+\n+                    // nHeight is a 32-bit signed integer field.\n+                    const int32_t nHeight = CScriptNum(stacktop(-1), true, 4).getint();",
    "path": "src/script/interpreter.cpp",
    "position": 28,
    "original_position": 28,
    "commit_id": "316d727dda71984403475b055ff9e60f0c30795b",
    "original_commit_id": "316d727dda71984403475b055ff9e60f0c30795b",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Not all overflows are buffer overflows. In this case, CScriptNum explicitly limits the size.",
    "created_at": "2017-07-10T04:25:02Z",
    "updated_at": "2017-07-10T04:25:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/10391#discussion_r126333067",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10391",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126333067"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/10391#discussion_r126333067"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10391"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/126333067/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 443,
    "original_line": 443,
    "side": "RIGHT",
    "in_reply_to_id": 126326593
  }
]