[
  {
    "sha": "23b3cf9d10b8e999c46238631239005f2367a5f9",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyM2IzY2Y5ZDEwYjhlOTk5YzQ2MjM4NjMxMjM5MDA1ZjIzNjdhNWY5",
    "commit": {
      "author": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2012-02-17T14:26:20Z"
      },
      "committer": {
        "name": "Wladimir J. van der Laan",
        "email": "laanwj@gmail.com",
        "date": "2012-02-17T14:32:51Z"
      },
      "message": "Restructure IPC URL handling (fixes #851)",
      "tree": {
        "sha": "80108137c3922024f5f7779ae5436ada4b803a23",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/80108137c3922024f5f7779ae5436ada4b803a23"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/23b3cf9d10b8e999c46238631239005f2367a5f9",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/23b3cf9d10b8e999c46238631239005f2367a5f9",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/23b3cf9d10b8e999c46238631239005f2367a5f9",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/23b3cf9d10b8e999c46238631239005f2367a5f9/comments",
    "author": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "39231e91052bff032525d99dbe890f742b6180fe",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/39231e91052bff032525d99dbe890f742b6180fe",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/39231e91052bff032525d99dbe890f742b6180fe"
      }
    ],
    "stats": {
      "total": 79,
      "additions": 39,
      "deletions": 40
    },
    "files": [
      {
        "sha": "3fad4d9263118fa8f844181af8df996342e312f3",
        "filename": "src/qt/bitcoingui.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 3,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/23b3cf9d10b8e999c46238631239005f2367a5f9/src/qt/bitcoingui.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/23b3cf9d10b8e999c46238631239005f2367a5f9/src/qt/bitcoingui.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoingui.cpp?ref=23b3cf9d10b8e999c46238631239005f2367a5f9",
        "patch": "@@ -723,7 +723,7 @@ void BitcoinGUI::dropEvent(QDropEvent *event)\n         QList<QUrl> urls = event->mimeData()->urls();\n         foreach(const QUrl &url, urls)\n         {\n-            sendCoinsPage->handleURL(&url);\n+            sendCoinsPage->handleURL(url.toString());\n         }\n     }\n \n@@ -733,8 +733,7 @@ void BitcoinGUI::dropEvent(QDropEvent *event)\n void BitcoinGUI::handleURL(QString strURL)\n {\n     gotoSendCoinsPage();\n-    QUrl url = QUrl(strURL);\n-    sendCoinsPage->handleURL(&url);\n+    sendCoinsPage->handleURL(strURL);\n }\n \n void BitcoinGUI::setEncryptionStatus(int status)"
      },
      {
        "sha": "02fc3b670071134fc0847165f486db3dad7a6479",
        "filename": "src/qt/guiutil.cpp",
        "status": "modified",
        "additions": 18,
        "deletions": 4,
        "changes": 22,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/23b3cf9d10b8e999c46238631239005f2367a5f9/src/qt/guiutil.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/23b3cf9d10b8e999c46238631239005f2367a5f9/src/qt/guiutil.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/guiutil.cpp?ref=23b3cf9d10b8e999c46238631239005f2367a5f9",
        "patch": "@@ -49,15 +49,15 @@ void GUIUtil::setupAmountWidget(QLineEdit *widget, QWidget *parent)\n     widget->setAlignment(Qt::AlignRight|Qt::AlignVCenter);\n }\n \n-bool GUIUtil::parseBitcoinURL(const QUrl *url, SendCoinsRecipient *out)\n+bool GUIUtil::parseBitcoinURL(const QUrl &url, SendCoinsRecipient *out)\n {\n-    if(url->scheme() != QString(\"bitcoin\"))\n+    if(url.scheme() != QString(\"bitcoin\"))\n         return false;\n \n     SendCoinsRecipient rv;\n-    rv.address = url->path();\n+    rv.address = url.path();\n     rv.amount = 0;\n-    QList<QPair<QString, QString> > items = url->queryItems();\n+    QList<QPair<QString, QString> > items = url.queryItems();\n     for (QList<QPair<QString, QString> >::iterator i = items.begin(); i != items.end(); i++)\n     {\n         bool fShouldReturnFalse = false;\n@@ -94,6 +94,20 @@ bool GUIUtil::parseBitcoinURL(const QUrl *url, SendCoinsRecipient *out)\n     return true;\n }\n \n+bool GUIUtil::parseBitcoinURL(QString url, SendCoinsRecipient *out)\n+{\n+    // Convert bitcoin:// to bitcoin:\n+    //\n+    //    Cannot handle this later, because bitcoin:// will cause Qt to see the part after // as host,\n+    //    which will lowercase it (and thus invalidate the address).\n+    if(url.startsWith(\"bitcoin://\"))\n+    {\n+        url.replace(0, 10, \"bitcoin:\");\n+    }\n+    QUrl urlInstance(url);\n+    return parseBitcoinURL(urlInstance, out);\n+}\n+\n QString GUIUtil::HtmlEscape(const QString& str, bool fMultiLine)\n {\n     QString escaped = Qt::escape(str);"
      },
      {
        "sha": "0c8b17186f80b1743ce9efb7fe4c588fd317d112",
        "filename": "src/qt/guiutil.h",
        "status": "modified",
        "additions": 2,
        "deletions": 1,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/23b3cf9d10b8e999c46238631239005f2367a5f9/src/qt/guiutil.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/23b3cf9d10b8e999c46238631239005f2367a5f9/src/qt/guiutil.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/guiutil.h?ref=23b3cf9d10b8e999c46238631239005f2367a5f9",
        "patch": "@@ -31,7 +31,8 @@ class GUIUtil\n \n     // Parse \"bitcoin:\" URL into recipient object, return true on succesful parsing\n     // See Bitcoin URL definition discussion here: https://bitcointalk.org/index.php?topic=33490.0\n-    static bool parseBitcoinURL(const QUrl *url, SendCoinsRecipient *out);\n+    static bool parseBitcoinURL(const QUrl &url, SendCoinsRecipient *out);\n+    static bool parseBitcoinURL(QString url, SendCoinsRecipient *out);\n \n     // HTML escaping for rich text controls\n     static QString HtmlEscape(const QString& str, bool fMultiLine=false);"
      },
      {
        "sha": "018461a9b28ab8d0bc6c18f67f1acae88559d74b",
        "filename": "src/qt/qtipcserver.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 20,
        "changes": 22,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/23b3cf9d10b8e999c46238631239005f2367a5f9/src/qt/qtipcserver.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/23b3cf9d10b8e999c46238631239005f2367a5f9/src/qt/qtipcserver.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/qtipcserver.cpp?ref=23b3cf9d10b8e999c46238631239005f2367a5f9",
        "patch": "@@ -30,16 +30,7 @@ void ipcThread(void* parg)\n         ptime d = boost::posix_time::microsec_clock::universal_time() + millisec(100);\n         if(mq->timed_receive(&strBuf, sizeof(strBuf), nSize, nPriority, d))\n         {\n-            strBuf[nSize] = '\\0';\n-            // Convert bitcoin:// URLs to bitcoin: URIs\n-            if (strBuf[8] == '/' && strBuf[9] == '/')\n-            {\n-                for (int i = 8; i < 256; i++)\n-                {\n-                    strBuf[i] = strBuf[i+2];\n-                }\n-            }\n-            ThreadSafeHandleURL(strBuf);\n+            ThreadSafeHandleURL(std::string(strBuf, nSize));\n             Sleep(1000);\n         }\n         if (fShutdown)\n@@ -66,16 +57,7 @@ void ipcInit()\n             ptime d = boost::posix_time::microsec_clock::universal_time() + millisec(1);\n             if(mq->timed_receive(&strBuf, sizeof(strBuf), nSize, nPriority, d))\n             {\n-                strBuf[nSize] = '\\0';\n-                // Convert bitcoin:// URLs to bitcoin: URIs\n-                if (strBuf[8] == '/' && strBuf[9] == '/')\n-                {\n-                    for (int i = 8; i < 256; i++)\n-                    {\n-                        strBuf[i] = strBuf[i+2];\n-                    }\n-                }\n-                ThreadSafeHandleURL(strBuf);\n+                ThreadSafeHandleURL(std::string(strBuf, nSize));\n             }\n             else\n                 break;"
      },
      {
        "sha": "964313ea81d5161456315b02bd0b1ed3ce56acca",
        "filename": "src/qt/sendcoinsdialog.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/23b3cf9d10b8e999c46238631239005f2367a5f9/src/qt/sendcoinsdialog.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/23b3cf9d10b8e999c46238631239005f2367a5f9/src/qt/sendcoinsdialog.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/sendcoinsdialog.cpp?ref=23b3cf9d10b8e999c46238631239005f2367a5f9",
        "patch": "@@ -265,7 +265,7 @@ void SendCoinsDialog::pasteEntry(const SendCoinsRecipient &rv)\n }\n \n \n-void SendCoinsDialog::handleURL(const QUrl *url)\n+void SendCoinsDialog::handleURL(const QString &url)\n {\n     SendCoinsRecipient rv;\n     if(!GUIUtil::parseBitcoinURL(url, &rv))"
      },
      {
        "sha": "4dc3f08bc5d8e781171cf0f4d85dcc5aa9b622d6",
        "filename": "src/qt/sendcoinsdialog.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/23b3cf9d10b8e999c46238631239005f2367a5f9/src/qt/sendcoinsdialog.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/23b3cf9d10b8e999c46238631239005f2367a5f9/src/qt/sendcoinsdialog.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/sendcoinsdialog.h?ref=23b3cf9d10b8e999c46238631239005f2367a5f9",
        "patch": "@@ -30,7 +30,7 @@ class SendCoinsDialog : public QDialog\n     QWidget *setupTabChain(QWidget *prev);\n \n     void pasteEntry(const SendCoinsRecipient &rv);\n-    void handleURL(const QUrl *url);\n+    void handleURL(const QString &url);\n \n public slots:\n     void clear();"
      },
      {
        "sha": "1f11795a9bda5f689a2f02e78a6afa72d00cca17",
        "filename": "src/qt/test/urltests.cpp",
        "status": "modified",
        "additions": 13,
        "deletions": 10,
        "changes": 23,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/23b3cf9d10b8e999c46238631239005f2367a5f9/src/qt/test/urltests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/23b3cf9d10b8e999c46238631239005f2367a5f9/src/qt/test/urltests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/test/urltests.cpp?ref=23b3cf9d10b8e999c46238631239005f2367a5f9",
        "patch": "@@ -18,51 +18,54 @@ void URLTests::urlTests()\n     SendCoinsRecipient rv;\n     QUrl url;\n     url.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?req-dontexist=\"));\n-    QVERIFY(!GUIUtil::parseBitcoinURL(&url, &rv));\n+    QVERIFY(!GUIUtil::parseBitcoinURL(url, &rv));\n \n     url.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?dontexist=\"));\n-    QVERIFY(GUIUtil::parseBitcoinURL(&url, &rv));\n+    QVERIFY(GUIUtil::parseBitcoinURL(url, &rv));\n     QVERIFY(rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\"));\n     QVERIFY(rv.label == QString());\n     QVERIFY(rv.amount == 0);\n \n     url.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?label=Wikipedia Example Address\"));\n-    QVERIFY(GUIUtil::parseBitcoinURL(&url, &rv));\n+    QVERIFY(GUIUtil::parseBitcoinURL(url, &rv));\n     QVERIFY(rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\"));\n     QVERIFY(rv.label == QString(\"Wikipedia Example Address\"));\n     QVERIFY(rv.amount == 0);\n \n     url.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=0.001\"));\n-    QVERIFY(GUIUtil::parseBitcoinURL(&url, &rv));\n+    QVERIFY(GUIUtil::parseBitcoinURL(url, &rv));\n     QVERIFY(rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\"));\n     QVERIFY(rv.label == QString());\n     QVERIFY(rv.amount == 100000);\n \n     url.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=1.001\"));\n-    QVERIFY(GUIUtil::parseBitcoinURL(&url, &rv));\n+    QVERIFY(GUIUtil::parseBitcoinURL(url, &rv));\n     QVERIFY(rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\"));\n     QVERIFY(rv.label == QString());\n     QVERIFY(rv.amount == 100100000);\n \n     url.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=100&label=Wikipedia Example\"));\n-    QVERIFY(GUIUtil::parseBitcoinURL(&url, &rv));\n+    QVERIFY(GUIUtil::parseBitcoinURL(url, &rv));\n     QVERIFY(rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\"));\n     QVERIFY(rv.amount == 10000000000);\n     QVERIFY(rv.label == QString(\"Wikipedia Example\"));\n \n     url.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?message=Wikipedia Example Address\"));\n-    QVERIFY(GUIUtil::parseBitcoinURL(&url, &rv));\n+    QVERIFY(GUIUtil::parseBitcoinURL(url, &rv));\n     QVERIFY(rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\"));\n     QVERIFY(rv.label == QString());\n+\n+    QVERIFY(GUIUtil::parseBitcoinURL(\"bitcoin://175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?message=Wikipedia Example Address\", &rv));\n+    QVERIFY(rv.address == QString(\"175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W\"));\n     QVERIFY(rv.label == QString());\n \n     // We currently dont implement the message paramenter (ok, yea, we break spec...)\n     url.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?req-message=Wikipedia Example Address\"));\n-    QVERIFY(!GUIUtil::parseBitcoinURL(&url, &rv));\n+    QVERIFY(!GUIUtil::parseBitcoinURL(url, &rv));\n \n     url.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=1,000&label=Wikipedia Example\"));\n-    QVERIFY(!GUIUtil::parseBitcoinURL(&url, &rv));\n+    QVERIFY(!GUIUtil::parseBitcoinURL(url, &rv));\n \n     url.setUrl(QString(\"bitcoin:175tWpb8K1S7NmH4Zx6rewF9WQrcZv245W?amount=1,000.0&label=Wikipedia Example\"));\n-    QVERIFY(!GUIUtil::parseBitcoinURL(&url, &rv));\n+    QVERIFY(!GUIUtil::parseBitcoinURL(url, &rv));\n }"
      }
    ]
  }
]