[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/269843583",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-269843583",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 269843583,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2OTg0MzU4Mw==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-31T02:09:17Z",
    "updated_at": "2016-12-31T02:09:17Z",
    "author_association": "MEMBER",
    "body": "@sipa I've spent all day on changing this around some and breaking this up into logical commits in order to satisfy myself (and i hope others) that it's safe. I'll push up a fresh version in a few min, and drop the WIP tag.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/269843583/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/269849078",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-269849078",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 269849078,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI2OTg0OTA3OA==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2016-12-31T04:39:29Z",
    "updated_at": "2016-12-31T07:04:08Z",
    "author_association": "MEMBER",
    "body": "Updated. Don't let the number of commits scare you off, the diffstat isn't too bad.\r\n\r\nI attempted to break this up into small/simple commits, in order to slowly remove the need for cs_vRecvMsg. The last commit actually removes it.\r\n\r\nI'm satisfied that this shouldn't be introducing any new races, as only a handful of vars were actually touched on the SocketHandler thread.\r\n\r\nEdit: time-ordered.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/269849078/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270035728",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-270035728",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 270035728,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDAzNTcyOA==",
    "user": {
      "login": "dcousens",
      "id": 413395,
      "node_id": "MDQ6VXNlcjQxMzM5NQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/413395?u=034ef1433a0704d9c91b57b993009b0383d6b7c0&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/dcousens",
      "html_url": "https://github.com/dcousens",
      "followers_url": "https://api.github.com/users/dcousens/followers",
      "following_url": "https://api.github.com/users/dcousens/following{/other_user}",
      "gists_url": "https://api.github.com/users/dcousens/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/dcousens/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/dcousens/subscriptions",
      "organizations_url": "https://api.github.com/users/dcousens/orgs",
      "repos_url": "https://api.github.com/users/dcousens/repos",
      "events_url": "https://api.github.com/users/dcousens/events{/privacy}",
      "received_events_url": "https://api.github.com/users/dcousens/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-03T00:18:54Z",
    "updated_at": "2017-01-03T00:18:54Z",
    "author_association": "CONTRIBUTOR",
    "body": "@theuni is this worth testing now?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270035728/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270049933",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-270049933",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 270049933,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDA0OTkzMw==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-03T04:16:54Z",
    "updated_at": "2017-01-03T04:16:54Z",
    "author_association": "MEMBER",
    "body": "@dcousens Very much so!",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270049933/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270093178",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-270093178",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 270093178,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDA5MzE3OA==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-03T11:11:40Z",
    "updated_at": "2017-01-03T11:11:40Z",
    "author_association": "CONTRIBUTOR",
    "body": "See IRC discussion:\r\n\r\n```\r\n<BlueMatt> cfields: hmmm, regarding #9441, do we really want to run the entire ProcessMessages loop (calling SendMessages potentially umpteen times) just to process multiple messages from the same node?\r\n<BlueMatt> (ie remove the loop inside ProcessMessages and move it to ThreadProcessMessages)\r\n<sipa> BlueMatt: i was wondering about that too\r\n<sipa> BlueMatt: but there is hardly any (contentious) locking going on anymore in between\r\n<BlueMatt> yea, but SendMessages.....\r\n<sipa> Ah.\r\n<sipa> i hadn't considered that\r\n<sipa> that defeats the purpose\r\n<sipa> hmm, i was about to say that it negatively impacts batching of invs and addrs\r\n<sipa> but since we have explicit random delays for those, i don't think that's really an issue anymore\r\n<BlueMatt> yea, I dont think it breaks anything\r\n<BlueMatt> just repeatedly calls SendMessages to do nothing\r\n<sipa> oh, it won't break anything\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270093178/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270137480",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-270137480",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 270137480,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDEzNzQ4MA==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-03T15:19:43Z",
    "updated_at": "2017-01-03T15:19:43Z",
    "author_association": "MEMBER",
    "body": "@TheBlueMatt If I understand you correctly, as mentioned in the summary, that's the part that was cut out here for simplicity. The next set of changes would combine the loops and move them into net_processing. See here for how it looked in a previous iteration: https://github.com/theuni/bitcoin/commit/1a6b10aea129ac363727c2d68fae809c2861e4da#diff-eff7adeaec73a769788bb78858815c91R271\r\n\r\nI'd be happy to add that here, but I'm afraid it adds a significant review burden to this PR.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270137480/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270152187",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-270152187",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 270152187,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDE1MjE4Nw==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-03T16:15:32Z",
    "updated_at": "2017-01-03T16:15:32Z",
    "author_association": "MEMBER",
    "body": "Also from IRC:\r\n```\r\n<BlueMatt> I assume you didnt touch cs_vSend due to https://github.com/bitcoin/bitcoin/pull/9419/commits/c214d120a363a05ba9afdccff6b4bda6e29ae7c4, cfields?\r\n<cfields> BlueMatt: yes, cs_vSend wasn't touched because of your PR. I've just been operating under the assumption that the lock around SendMessages will be removed by one PR or another.\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270152187/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270185545",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-270185545",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 270185545,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDE4NTU0NQ==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-03T18:27:14Z",
    "updated_at": "2017-01-03T18:27:14Z",
    "author_association": "MEMBER",
    "body": "Digging further into the IRC conversation above, I'd like to clarify that the interaction here between ProcessMessages and SendMessages is _not_ changed substantially in this PR.\r\n\r\n@TheBlueMatt had missed a subtle part of the current behavior, and maybe @sipa too, so I'd just like to explicitly point out the current break here: https://github.com/bitcoin/bitcoin/blob/master/src/net_processing.cpp#L2543, added in https://github.com/bitcoin/bitcoin/pull/3180\r\n\r\nFor the sake of processing in a round-robin fashion, we currently end up running through SendMessages multiple times while draining a node's received message queue. That behavior is _far_ from ideal, and needs to be addressed, but is not changed here*. I have plans to work on this in next steps, but not for 0.14.\r\n\r\n*It's only changed in the case of an invalid header, or bad message checksum.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270185545/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270286007",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-270286007",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 270286007,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDI4NjAwNw==",
    "user": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?u=63e5c438c242094837a9deeda775d77988b508bf&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-04T03:15:58Z",
    "updated_at": "2017-01-04T03:15:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "> <BlueMatt> cfields: hmmm, regarding #9441, do we really want to run the entire ProcessMessages loop (calling SendMessages potentially umpteen times) just to process multiple messages from the same node?\r\n<BlueMatt> (ie remove the loop inside ProcessMessages and move it to ThreadProcessMessages)\r\n\r\nClearly people weren't reading PRs on this or you would have noticed that it only processes one at a time right now.  I actually fixed it to process as many as it could until it encountered lock contention, then specifically pinged people for input on the effect. After no response, I unfixed it because of concern about the latency impact.   Handling multiple messages at a time is good, if they're fast ones... \r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270286007/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270286554",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-270286554",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 270286554,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDI4NjU1NA==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-04T03:21:27Z",
    "updated_at": "2017-01-04T03:21:27Z",
    "author_association": "MEMBER",
    "body": "I certainly noticed it only processed one message at a time. I missed that\nit calls SendMessages between each.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270286554/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270386244",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-270386244",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 270386244,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDM4NjI0NA==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-04T14:42:19Z",
    "updated_at": "2017-01-04T14:42:19Z",
    "author_association": "MEMBER",
    "body": "Needs rebase.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270386244/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270397280",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-270397280",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 270397280,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDM5NzI4MA==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-04T15:25:28Z",
    "updated_at": "2017-01-04T15:25:28Z",
    "author_association": "MEMBER",
    "body": "Rebased, and I believe I addressed all comments so far.\r\n\r\nI did a full mainnet sync last night with these (pre-rebase) changes, with no issues. I had extra logging to observe the recv pausing behavior, and verified that it's working as intended. It is paused quite frequently during IBD. Obviously that's intended, as it signals for the peer to slow down, but it may be worth discussing the consequences of a higher (or lower!) default for -maxreceivebuffer now that our recv is no longer blocked by processing. Out of scope for this PR, though.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270397280/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270496443",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-270496443",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 270496443,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDQ5NjQ0Mw==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-04T21:47:47Z",
    "updated_at": "2017-01-04T21:47:47Z",
    "author_association": "MEMBER",
    "body": "I believe you're correct, that's my reading of it as well. Regardless, I\nwasn't able to track down a path where fDisconnect wouldn't be set as\nnecessary.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270496443/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270923452",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-270923452",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 270923452,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDkyMzQ1Mg==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-06T15:12:03Z",
    "updated_at": "2017-01-06T15:12:03Z",
    "author_association": "MEMBER",
    "body": "From @sipa\r\n> Can you clarify what the rationale is for switching from a ProcessMessages that processes multiple messages to just a single one? I'm not opposed to the change, but I'd like to understand what the reason for the change is.\r\n\r\nIn nearly all cases in the current code, only 1 message is processed. I thought that making this explicit would clarify the situation, but it seems it's only causing confusion in this PR. I'll change this back and we can address that later.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270923452/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270955845",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-270955845",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 270955845,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDk1NTg0NQ==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-06T17:26:56Z",
    "updated_at": "2017-01-06T17:26:56Z",
    "author_association": "MEMBER",
    "body": "@theuni Please ignore my request to keep processing multiple messages at the same time.\r\n\r\n> In nearly all cases in the current code, only 1 message is processed.\r\n\r\nI thought you were trying to say our send buffer was usually full, not that the code actually never loops (which is apparently behaviour that was intentionally changed in #3180).",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270955845/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270963654",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-270963654",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 270963654,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDk2MzY1NA==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-06T18:01:03Z",
    "updated_at": "2017-01-06T18:01:03Z",
    "author_association": "MEMBER",
    "body": "Updated to address feedback. Most of it is just fixing up interim commits to be more correct for easier commit-by-commit review.\r\n\r\nActual changes:\r\n  - Fixed up the condvar as @sipa suggested\r\n  - Completely removed cs_vRecvMsg. See the commit message for more detail.\r\n\r\nDiff from before is here: https://gist.github.com/theuni/9c18405455a2569156671aadcf242500",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270963654/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270989192",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-270989192",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 270989192,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MDk4OTE5Mg==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-06T19:49:12Z",
    "updated_at": "2017-01-06T19:49:12Z",
    "author_association": "MEMBER",
    "body": "@morcos I meant to expand on the commit message for c5b4e31fb87a9819330b83f4ac6cc92066e8337d, but apparently neglected to do so before pushing. I expect that we'll want to add connman.WakeMessageHandler() in a few places to take care of that as a follow-up.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/270989192/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271124533",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-271124533",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 271124533,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MTEyNDUzMw==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-08T02:21:57Z",
    "updated_at": "2017-01-08T02:21:57Z",
    "author_association": "MEMBER",
    "body": "utACK ddac068fa5d6b43925a96149f2d9b81ec736a5e7",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/271124533/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272008534",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-272008534",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 272008534,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjAwODUzNA==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-11T21:58:08Z",
    "updated_at": "2017-01-11T21:58:08Z",
    "author_association": "MEMBER",
    "body": "Addressed outstanding nits, will squash at the end.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272008534/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272133975",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-272133975",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 272133975,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjEzMzk3NQ==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-12T10:54:55Z",
    "updated_at": "2017-01-12T10:54:55Z",
    "author_association": "MEMBER",
    "body": "(Lightly) tested ACK 1c779a8. This is an older version but it's been running stable on a busy node for a week.\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272133975/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272175357",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-272175357",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 272175357,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjE3NTM1Nw==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-12T14:23:22Z",
    "updated_at": "2017-01-12T14:23:22Z",
    "author_association": "MEMBER",
    "body": "@TheBlueMatt @sipa @morcos care to re-ACK before final squash?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272175357/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272183451",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-272183451",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 272183451,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjE4MzQ1MQ==",
    "user": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?u=b7dd63827227d69794b5fe28797b1bd107b930dd&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-12T14:54:42Z",
    "updated_at": "2017-01-12T14:54:42Z",
    "author_association": "MEMBER",
    "body": "utACK and ran on some nodes without error for several days ddac068\r\nutACK 7b44e18",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272183451/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272278780",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-272278780",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 272278780,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjI3ODc4MA==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-12T20:47:30Z",
    "updated_at": "2017-01-12T20:47:30Z",
    "author_association": "CONTRIBUTOR",
    "body": "Dont think its actually possible due to the sizes involved, but, theoretically, PushMessage could increment nSendSize to be > nSendBufferMaxSize, set fPauseSend to true, and then call opportunistic SocketSendData, which flushed the entire buffer, but didnt reset fPauseSend. I'd suggest moving the fPauseSend update to right beside the nSendSize decrement as it is for the increment.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272278780/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272292726",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-272292726",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 272292726,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjI5MjcyNg==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-12T21:41:47Z",
    "updated_at": "2017-01-12T21:41:47Z",
    "author_association": "CONTRIBUTOR",
    "body": "utACK 7b44e18b2f3a39657699adff5dd39dcfde24f1fb if 975fc9dd6f55a87f7d0db62898e58169b2816baf is reverted and the fPauseSend updates are all placed directly beside the nSendSize updates.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272292726/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272328264",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-272328264",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 272328264,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjMyODI2NA==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-13T00:37:12Z",
    "updated_at": "2017-01-13T00:37:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "utACK 0168bea73772a707c53952956a364262cea63cd3 (+/- squash-needed).",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272328264/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272360130",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-272360130",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 272360130,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjM2MDEzMA==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-13T04:45:23Z",
    "updated_at": "2017-01-13T04:45:23Z",
    "author_association": "MEMBER",
    "body": "Squashed, and I believe this is now merge-ready.\r\n\r\n@sipa / @morcos See https://github.com/theuni/bitcoin/tree/connman-locks-tmp for the unsquashed version if you'd like. It's codewise-identical to e60360e139852c655930e99d4bb4db554cd8385e.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272360130/reactions",
      "total_count": 4,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 4,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272473940",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-272473940",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 272473940,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjQ3Mzk0MA==",
    "user": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?u=b7dd63827227d69794b5fe28797b1bd107b930dd&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-13T15:43:30Z",
    "updated_at": "2017-01-13T15:43:30Z",
    "author_association": "MEMBER",
    "body": "re-utACK e60360e\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272473940/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272485728",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-272485728",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 272485728,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjQ4NTcyOA==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-13T16:48:08Z",
    "updated_at": "2017-01-13T16:48:08Z",
    "author_association": "CONTRIBUTOR",
    "body": "Confirmed there is no diff-tree to e60360e139852c655930e99d4bb4db554cd8385e from my previous utACK",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272485728/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272501888",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-272501888",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/9441",
    "id": 272501888,
    "node_id": "MDEyOklzc3VlQ29tbWVudDI3MjUwMTg4OA==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-01-13T17:50:44Z",
    "updated_at": "2017-01-13T17:50:44Z",
    "author_association": "MEMBER",
    "body": "utACK e60360e139852c655930e99d4bb4db554cd8385e",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/272501888/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94154588",
    "pull_request_review_id": 14685561,
    "id": 94154588,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0MTU0NTg4",
    "diff_hunk": "@@ -2438,48 +2438,53 @@ bool ProcessMessages(CNode* pfrom, CConnman& connman)\n     //  (4) checksum\n     //  (x) data\n     //\n-    bool fOk = true;\n+    bool fMoreWork = false;\n \n     if (!pfrom->vRecvGetData.empty())\n-        ProcessGetData(pfrom, chainparams.GetConsensus(), connman);\n+        ProcessGetData(pfrom, chainparams.GetConsensus(), connman, interruptMsgProc);\n \n     // this maintains the order of responses\n-    if (!pfrom->vRecvGetData.empty()) return fOk;\n+    if (!pfrom->vRecvGetData.empty()) return true;\n+\n+    if (pfrom->fDisconnect)\n+        return false;\n \n-    std::deque<CNetMessage>::iterator it = pfrom->vRecvMsg.begin();\n-    while (!pfrom->fDisconnect && it != pfrom->vRecvMsg.end()) {\n         // Don't bother if send buffer is too full to respond anyway",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 121,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "65e916c499658e656a6e23455f22666fb0068edc",
    "user": {
      "login": "rebroad",
      "id": 1530283,
      "node_id": "MDQ6VXNlcjE1MzAyODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1530283?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rebroad",
      "html_url": "https://github.com/rebroad",
      "followers_url": "https://api.github.com/users/rebroad/followers",
      "following_url": "https://api.github.com/users/rebroad/following{/other_user}",
      "gists_url": "https://api.github.com/users/rebroad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rebroad/subscriptions",
      "organizations_url": "https://api.github.com/users/rebroad/orgs",
      "repos_url": "https://api.github.com/users/rebroad/repos",
      "events_url": "https://api.github.com/users/rebroad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rebroad/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I'm not sure if github is messing with the formatting, but this line looks unnecessarily indented.",
    "created_at": "2016-12-29T16:37:40Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94154588",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94154588"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94154588"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94154588/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2452,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94155625",
    "pull_request_review_id": 14686611,
    "id": 94155625,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0MTU1NjI1",
    "diff_hunk": "@@ -2438,48 +2438,53 @@ bool ProcessMessages(CNode* pfrom, CConnman& connman)\n     //  (4) checksum\n     //  (x) data\n     //\n-    bool fOk = true;\n+    bool fMoreWork = false;\n \n     if (!pfrom->vRecvGetData.empty())\n-        ProcessGetData(pfrom, chainparams.GetConsensus(), connman);\n+        ProcessGetData(pfrom, chainparams.GetConsensus(), connman, interruptMsgProc);\n \n     // this maintains the order of responses\n-    if (!pfrom->vRecvGetData.empty()) return fOk;\n+    if (!pfrom->vRecvGetData.empty()) return true;\n+\n+    if (pfrom->fDisconnect)\n+        return false;\n \n-    std::deque<CNetMessage>::iterator it = pfrom->vRecvMsg.begin();\n-    while (!pfrom->fDisconnect && it != pfrom->vRecvMsg.end()) {\n         // Don't bother if send buffer is too full to respond anyway",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 121,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "65e916c499658e656a6e23455f22666fb0068edc",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes, the indentation was just kept to avoid creating a huge whitespace diff. This can be cleaned up in a move-only commit as a next step.",
    "created_at": "2016-12-29T16:47:43Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94155625",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94155625"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94155625"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94155625/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2452,
    "side": "RIGHT",
    "in_reply_to_id": 94154588
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94270487",
    "pull_request_review_id": 14801377,
    "id": 94270487,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0MjcwNDg3",
    "diff_hunk": "@@ -1243,9 +1243,10 @@ void CConnman::ThreadSocketHandler()\n                             bool notify = false;\n                             if (!pnode->ReceiveMsgBytes(pchBuf, nBytes, notify))\n                                 pnode->CloseSocketDisconnect();\n+                            RecordBytesRecv(nBytes);\n                             if(notify)\n                                 condMsgProc.notify_one();\n-                            RecordBytesRecv(nBytes);\n+                            }",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 8,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "3ab40f619dd1b9f3ff4140510e807a9e1fb577c8",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Whoops, rebase gone bad here. It ends up right in the end. Will fix.",
    "created_at": "2016-12-31T07:39:29Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94270487",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94270487"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94270487"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94270487/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1249,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94270593",
    "pull_request_review_id": 14801483,
    "id": 94270593,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0MjcwNTkz",
    "diff_hunk": "@@ -2439,44 +2439,44 @@ bool ProcessMessages(CNode* pfrom, CConnman& connman, std::atomic<bool>& interru\n     //  (4) checksum\n     //  (x) data\n     //\n-    bool fOk = true;\n+    bool fMoreWork = false;\n \n     if (!pfrom->vRecvGetData.empty())\n         ProcessGetData(pfrom, chainparams.GetConsensus(), connman, interruptMsgProc);\n \n     // this maintains the order of responses\n-    if (!pfrom->vRecvGetData.empty()) return fOk;\n+    if (!pfrom->vRecvGetData.empty()) return true;\n \n     auto it = pfrom->vRecvMsg.begin();\n-    while (!pfrom->fDisconnect && it != pfrom->vRecvMsg.end()) {\n+    if (!pfrom->fDisconnect && it != pfrom->vRecvMsg.end()) {",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 16,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "99599884147ea4db3f960b0e706b039ba1553c80",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Need to clarify in the commit message: It was almost always the case that only one message was processed in this while loop. See the break at line 2538.\r\n\r\nThis commit changes the behavior so that it's _always_ one message processed per-loop. The only messages that show different behavior are the ones that used to \"continue\" the loop. I think it's perfectly reasonable to skip to the next node for processing in that case.",
    "created_at": "2016-12-31T07:57:52Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94270593",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94270593"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94270593"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94270593/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2451,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94386537",
    "pull_request_review_id": 14911886,
    "id": 94386537,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0Mzg2NTM3",
    "diff_hunk": "@@ -682,18 +674,27 @@ bool CNode::ReceiveMsgBytes(const char *pch, unsigned int nBytes, bool& complete\n         pch += handled;\n         nBytes -= handled;\n \n-        if (msg.complete()) {\n+        if (msg.complete())\n+            complete = true;\n+    }\n+\n+    int64_t nTime = GetTimeMicros();\n+    LOCK(cs_vRecvMsg);\n+    nRecvBytes += nBytes;\n+    nLastRecv = nTime * 1000;",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 50,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "b1b6772240f5135745e9c0b09be2155944c12f0a",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think you meant /, not * here?",
    "created_at": "2017-01-03T10:48:47Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94386537",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94386537"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94386537"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94386537/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 684,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94386795",
    "pull_request_review_id": 14912139,
    "id": 94386795,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0Mzg2Nzk1",
    "diff_hunk": "@@ -682,18 +674,27 @@ bool CNode::ReceiveMsgBytes(const char *pch, unsigned int nBytes, bool& complete\n         pch += handled;\n         nBytes -= handled;\n \n-        if (msg.complete()) {\n+        if (msg.complete())\n+            complete = true;\n+    }\n+\n+    int64_t nTime = GetTimeMicros();\n+    LOCK(cs_vRecvMsg);\n+    nRecvBytes += nBytes;",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 49,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "b1b6772240f5135745e9c0b09be2155944c12f0a",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It might be nice in the RPC for mapRecvBytesPerMsgCmd to add up to nRecvBytes (ie to increment this in the loop per-msg instead of after receiving (which would also mean no api change)).",
    "created_at": "2017-01-03T10:51:06Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94386795",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94386795"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94386795"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94386795/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 683,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94419909",
    "pull_request_review_id": 14946635,
    "id": 94419909,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0NDE5OTA5",
    "diff_hunk": "@@ -682,18 +674,27 @@ bool CNode::ReceiveMsgBytes(const char *pch, unsigned int nBytes, bool& complete\n         pch += handled;\n         nBytes -= handled;\n \n-        if (msg.complete()) {\n+        if (msg.complete())\n+            complete = true;\n+    }\n+\n+    int64_t nTime = GetTimeMicros();\n+    LOCK(cs_vRecvMsg);\n+    nRecvBytes += nBytes;\n+    nLastRecv = nTime * 1000;",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 50,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "b1b6772240f5135745e9c0b09be2155944c12f0a",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Heh, sure did",
    "created_at": "2017-01-03T15:11:55Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94419909",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94419909"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94419909"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94419909/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 684,
    "side": "RIGHT",
    "in_reply_to_id": 94386537
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94420177",
    "pull_request_review_id": 14946908,
    "id": 94420177,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0NDIwMTc3",
    "diff_hunk": "@@ -682,18 +674,27 @@ bool CNode::ReceiveMsgBytes(const char *pch, unsigned int nBytes, bool& complete\n         pch += handled;\n         nBytes -= handled;\n \n-        if (msg.complete()) {\n+        if (msg.complete())\n+            complete = true;\n+    }\n+\n+    int64_t nTime = GetTimeMicros();\n+    LOCK(cs_vRecvMsg);\n+    nRecvBytes += nBytes;",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 49,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "b1b6772240f5135745e9c0b09be2155944c12f0a",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Sure, that just means more locking. Though this is completely uncontested now, so that's not really a problem.",
    "created_at": "2017-01-03T15:13:30Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94420177",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94420177"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94420177"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94420177/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 683,
    "side": "RIGHT",
    "in_reply_to_id": 94386795
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94670409",
    "pull_request_review_id": 15203555,
    "id": 94670409,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0NjcwNDA5",
    "diff_hunk": "@@ -1051,8 +1051,7 @@ void CConnman::ThreadSocketHandler()\n             std::vector<CNode*> vNodesCopy = vNodes;\n             BOOST_FOREACH(CNode* pnode, vNodesCopy)\n             {\n-                if (pnode->fDisconnect ||\n-                    (pnode->GetRefCount() <= 0 && pnode->vRecvMsg.empty() && pnode->nSendSize == 0))",
    "path": "src/net.cpp",
    "position": 64,
    "original_position": 5,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "f6315e07f9383f3f43e37ada0d6a835810d610b9",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Is it just me, or were these always impossible to hit? Both ConnectNode and AcceptConnection do a AddRef() which is only countered by the Release a few lines further down here.",
    "created_at": "2017-01-04T21:38:55Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94670409",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94670409"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94670409"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94670409/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1055,
    "original_line": 1055,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94670463",
    "pull_request_review_id": 15203613,
    "id": 94670463,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0NjcwNDYz",
    "diff_hunk": "@@ -1051,8 +1051,7 @@ void CConnman::ThreadSocketHandler()\n             std::vector<CNode*> vNodesCopy = vNodes;\n             BOOST_FOREACH(CNode* pnode, vNodesCopy)\n             {\n-                if (pnode->fDisconnect ||\n-                    (pnode->GetRefCount() <= 0 && pnode->vRecvMsg.empty() && pnode->nSendSize == 0))",
    "path": "src/net.cpp",
    "position": 64,
    "original_position": 5,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "f6315e07f9383f3f43e37ada0d6a835810d610b9",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "(obviously not an issue, just checking my logic).",
    "created_at": "2017-01-04T21:39:17Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94670463",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94670463"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94670463"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94670463/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1055,
    "original_line": 1055,
    "side": "RIGHT",
    "in_reply_to_id": 94670409
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94674801",
    "pull_request_review_id": 15208077,
    "id": 94674801,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0Njc0ODAx",
    "diff_hunk": "@@ -649,16 +644,19 @@ void CNode::copyStats(CNodeStats &stats)\n }\n #undef X\n \n-// requires LOCK(cs_vRecvMsg)\n bool CNode::ReceiveMsgBytes(const char *pch, unsigned int nBytes, bool& complete)\n {\n+    LOCK(cs_vRecvMsg);\n     complete = false;\n+    int64_t nTime = GetTimeMicros();\n+    nLastRecv = nTime / 1000;",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 22,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "1c779a8cfefb45f55f0686de3fccba5285f5cd7b",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think you actually meant / 1000 / 1000 :p",
    "created_at": "2017-01-04T22:03:41Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94674801",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94674801"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94674801"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94674801/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 1,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 652,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94840361",
    "pull_request_review_id": 15380505,
    "id": 94840361,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0ODQwMzYx",
    "diff_hunk": "@@ -649,16 +644,19 @@ void CNode::copyStats(CNodeStats &stats)\n }\n #undef X\n \n-// requires LOCK(cs_vRecvMsg)\n bool CNode::ReceiveMsgBytes(const char *pch, unsigned int nBytes, bool& complete)\n {\n+    LOCK(cs_vRecvMsg);\n     complete = false;\n+    int64_t nTime = GetTimeMicros();\n+    nLastRecv = nTime / 1000;",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 22,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "1c779a8cfefb45f55f0686de3fccba5285f5cd7b",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I completely missed that this was a full-second value. Thanks for catching this (twice!). Will fix.",
    "created_at": "2017-01-05T20:00:27Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94840361",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94840361"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94840361"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94840361/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 652,
    "side": "RIGHT",
    "in_reply_to_id": 94674801
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94848354",
    "pull_request_review_id": 15389104,
    "id": 94848354,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0ODQ4MzU0",
    "diff_hunk": "@@ -1882,10 +1878,9 @@ void CConnman::ThreadMessageHandler()\n                 pnode->Release();\n         }\n \n-        if (fSleep) {\n-            std::unique_lock<std::mutex> lock(mutexMsgProc);\n-            condMsgProc.wait_until(lock, std::chrono::steady_clock::now() + std::chrono::milliseconds(100));\n-        }\n+        std::unique_lock<std::mutex> lock(mutexMsgProc);\n+        condMsgProc.wait_until(lock, std::chrono::steady_clock::now() + std::chrono::milliseconds(100), [this, &fMoreWork] { return fMoreWork || fMsgProcWake; });",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 48,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "4157c99cd81c57dbc934beadfdaf2a48a6110bd0",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It seems that during this wait, fMoreWork will never change (and it isn't covered by the lock either), so this line could instead be written as\r\n```c++\r\nif (!fMoreWork) {\r\n    condMsgProc.wait_until(lock, std::chrono::steady_clock::now() + std::chrono::milliseconds(100), [this] { return fMsgProcWake; });\r\n}\r\n```\r\n",
    "created_at": "2017-01-05T20:50:11Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94848354",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94848354"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94848354"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94848354/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1882,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94849266",
    "pull_request_review_id": 15389104,
    "id": 94849266,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0ODQ5MjY2",
    "diff_hunk": "@@ -2439,44 +2439,44 @@ bool ProcessMessages(CNode* pfrom, CConnman& connman, std::atomic<bool>& interru\n     //  (4) checksum\n     //  (x) data\n     //\n-    bool fOk = true;\n+    bool fMoreWork = false;\n \n     if (!pfrom->vRecvGetData.empty())\n         ProcessGetData(pfrom, chainparams.GetConsensus(), connman, interruptMsgProc);\n \n     // this maintains the order of responses\n-    if (!pfrom->vRecvGetData.empty()) return fOk;\n+    if (!pfrom->vRecvGetData.empty()) return true;\n \n     auto it = pfrom->vRecvMsg.begin();\n-    while (!pfrom->fDisconnect && it != pfrom->vRecvMsg.end()) {\n+    if (!pfrom->fDisconnect && it != pfrom->vRecvMsg.end()) {",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 16,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "99599884147ea4db3f960b0e706b039ba1553c80",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Can you clarify what the rationale is for switching from a `ProcessMessages` that processes multiple messages to just a single one? I'm not opposed to the change, but I'd like to understand what the reason for the change is.",
    "created_at": "2017-01-05T20:55:03Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94849266",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94849266"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94849266"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94849266/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2451,
    "side": "RIGHT",
    "in_reply_to_id": 94270593
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94849846",
    "pull_request_review_id": 15389104,
    "id": 94849846,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0ODQ5ODQ2",
    "diff_hunk": "@@ -1239,8 +1239,18 @@ void CConnman::ThreadSocketHandler()\n                             if (!pnode->ReceiveMsgBytes(pchBuf, nBytes, notify))\n                                 pnode->CloseSocketDisconnect();\n                             RecordBytesRecv(nBytes);\n-                            if (notify)\n+                            if (notify) {\n+                                auto it(pnode->vRecvMsg.begin());\n+                                for (; it != pnode->vRecvMsg.end(); ++it) {",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 7,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "b5ea4f2199b66fdf2da844b884742b1d97448aab",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I find it generally more readable to write something like this as\r\n```c++\r\nwhile (it != pnode->vRecvMsg.end() && it->complete()) ++it;\r\n```\r\n\r\nAlso, isn't iterating backwards more efficient?",
    "created_at": "2017-01-05T20:58:08Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94849846",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94849846"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94849846"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94849846/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1231,
    "original_line": 1244,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94852093",
    "pull_request_review_id": 15392904,
    "id": 94852093,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0ODUyMDkz",
    "diff_hunk": "@@ -2439,44 +2439,44 @@ bool ProcessMessages(CNode* pfrom, CConnman& connman, std::atomic<bool>& interru\n     //  (4) checksum\n     //  (x) data\n     //\n-    bool fOk = true;\n+    bool fMoreWork = false;\n \n     if (!pfrom->vRecvGetData.empty())\n         ProcessGetData(pfrom, chainparams.GetConsensus(), connman, interruptMsgProc);\n \n     // this maintains the order of responses\n-    if (!pfrom->vRecvGetData.empty()) return fOk;\n+    if (!pfrom->vRecvGetData.empty()) return true;\n \n     auto it = pfrom->vRecvMsg.begin();\n-    while (!pfrom->fDisconnect && it != pfrom->vRecvMsg.end()) {\n+    if (!pfrom->fDisconnect && it != pfrom->vRecvMsg.end()) {",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 16,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "99599884147ea4db3f960b0e706b039ba1553c80",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Point is this is not a change. See https://github.com/bitcoin/bitcoin/pull/9441#issuecomment-270185545",
    "created_at": "2017-01-05T21:10:46Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94852093",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94852093"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94852093"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94852093/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2451,
    "side": "RIGHT",
    "in_reply_to_id": 94270593
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94853525",
    "pull_request_review_id": 15394370,
    "id": 94853525,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0ODUzNTI1",
    "diff_hunk": "@@ -2453,44 +2453,44 @@ bool ProcessMessages(CNode* pfrom, CConnman& connman, std::atomic<bool>& interru\n     //  (4) checksum\n     //  (x) data\n     //\n-    bool fOk = true;\n+    bool fMoreWork = false;\n \n     if (!pfrom->vRecvGetData.empty())\n         ProcessGetData(pfrom, chainparams.GetConsensus(), connman, interruptMsgProc);\n \n     // this maintains the order of responses\n-    if (!pfrom->vRecvGetData.empty()) return fOk;\n+    if (!pfrom->vRecvGetData.empty()) return true;\n \n     auto it = pfrom->vRecvMsg.begin();\n-    while (!pfrom->fDisconnect && it != pfrom->vRecvMsg.end()) {\n+    if (!pfrom->fDisconnect && it != pfrom->vRecvMsg.end()) {\n         // Don't bother if send buffer is too full to respond anyway\n         if (pfrom->nSendSize >= nMaxSendBufferSize)\n-            break;\n-\n-        // get next message\n-        CNetMessage& msg = *it;\n+            return false;\n \n         // end, if an incomplete message is found\n-        if (!msg.complete())\n-            break;\n+        if (!it->complete())\n+            return false;\n+\n+        // get next message\n+        CNetMessage msg = std::move(*it);\n \n         // at this point, any failure means we can delete the current message\n-        it++;\n+        pfrom->vRecvMsg.erase(pfrom->vRecvMsg.begin());\n \n         msg.SetVersion(pfrom->GetRecvVersion());\n         // Scan for message start\n         if (memcmp(msg.hdr.pchMessageStart, chainparams.MessageStart(), CMessageHeader::MESSAGE_START_SIZE) != 0) {\n             LogPrintf(\"PROCESSMESSAGE: INVALID MESSAGESTART %s peer=%d\\n\", SanitizeString(msg.hdr.GetCommand()), pfrom->id);\n-            fOk = false;\n-            break;\n+            pfrom->fDisconnect = true;\n+            return false;\n         }\n \n         // Read header\n         CMessageHeader& hdr = msg.hdr;\n         if (!hdr.IsValid(chainparams.MessageStart()))\n         {\n             LogPrintf(\"PROCESSMESSAGE: ERRORS IN HEADER %s peer=%d\\n\", SanitizeString(hdr.GetCommand()), pfrom->id);\n-            continue;\n+            return fMoreWork;",
    "path": "src/net_processing.cpp",
    "position": 121,
    "original_position": 54,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "4157c99cd81c57dbc934beadfdaf2a48a6110bd0",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This is always false here.",
    "created_at": "2017-01-05T21:19:07Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94853525",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94853525"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94853525"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94853525/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2494,
    "original_line": 2493,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94853574",
    "pull_request_review_id": 15394421,
    "id": 94853574,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0ODUzNTc0",
    "diff_hunk": "@@ -1239,8 +1239,18 @@ void CConnman::ThreadSocketHandler()\n                             if (!pnode->ReceiveMsgBytes(pchBuf, nBytes, notify))\n                                 pnode->CloseSocketDisconnect();\n                             RecordBytesRecv(nBytes);\n-                            if (notify)\n+                            if (notify) {\n+                                auto it(pnode->vRecvMsg.begin());\n+                                for (; it != pnode->vRecvMsg.end(); ++it) {",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 7,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "b5ea4f2199b66fdf2da844b884742b1d97448aab",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Sure, will change it to a while.\r\n\r\nIterating backwards would be preferable, but we end up hitting each msg anyway later (to add up message sizes) in a later commit, so i didn't bother (see https://github.com/bitcoin/bitcoin/pull/9441/commits/a109f7bd1801392bf99994a7165d495200156c4a#diff-9a82240fe7dfe86564178691cc57f2f1R1246). The sizes are added ahead of time in order to avoid iterating the list under cs_vProcessMsg.",
    "created_at": "2017-01-05T21:19:22Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94853574",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94853574"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94853574"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94853574/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1231,
    "original_line": 1244,
    "side": "RIGHT",
    "in_reply_to_id": 94849846
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94853866",
    "pull_request_review_id": 15394723,
    "id": 94853866,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0ODUzODY2",
    "diff_hunk": "@@ -1882,10 +1878,9 @@ void CConnman::ThreadMessageHandler()\n                 pnode->Release();\n         }\n \n-        if (fSleep) {\n-            std::unique_lock<std::mutex> lock(mutexMsgProc);\n-            condMsgProc.wait_until(lock, std::chrono::steady_clock::now() + std::chrono::milliseconds(100));\n-        }\n+        std::unique_lock<std::mutex> lock(mutexMsgProc);\n+        condMsgProc.wait_until(lock, std::chrono::steady_clock::now() + std::chrono::milliseconds(100), [this, &fMoreWork] { return fMoreWork || fMsgProcWake; });",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 48,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "4157c99cd81c57dbc934beadfdaf2a48a6110bd0",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yep. Will fix.",
    "created_at": "2017-01-05T21:21:03Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94853866",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94853866"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94853866"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94853866/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1882,
    "side": "RIGHT",
    "in_reply_to_id": 94848354
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94854980",
    "pull_request_review_id": 15395874,
    "id": 94854980,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0ODU0OTgw",
    "diff_hunk": "@@ -2453,44 +2453,44 @@ bool ProcessMessages(CNode* pfrom, CConnman& connman, std::atomic<bool>& interru\n     //  (4) checksum\n     //  (x) data\n     //\n-    bool fOk = true;\n+    bool fMoreWork = false;\n \n     if (!pfrom->vRecvGetData.empty())\n         ProcessGetData(pfrom, chainparams.GetConsensus(), connman, interruptMsgProc);\n \n     // this maintains the order of responses\n-    if (!pfrom->vRecvGetData.empty()) return fOk;\n+    if (!pfrom->vRecvGetData.empty()) return true;\n \n     auto it = pfrom->vRecvMsg.begin();\n-    while (!pfrom->fDisconnect && it != pfrom->vRecvMsg.end()) {\n+    if (!pfrom->fDisconnect && it != pfrom->vRecvMsg.end()) {\n         // Don't bother if send buffer is too full to respond anyway\n         if (pfrom->nSendSize >= nMaxSendBufferSize)\n-            break;\n-\n-        // get next message\n-        CNetMessage& msg = *it;\n+            return false;\n \n         // end, if an incomplete message is found\n-        if (!msg.complete())\n-            break;\n+        if (!it->complete())\n+            return false;\n+\n+        // get next message\n+        CNetMessage msg = std::move(*it);\n \n         // at this point, any failure means we can delete the current message\n-        it++;\n+        pfrom->vRecvMsg.erase(pfrom->vRecvMsg.begin());\n \n         msg.SetVersion(pfrom->GetRecvVersion());\n         // Scan for message start\n         if (memcmp(msg.hdr.pchMessageStart, chainparams.MessageStart(), CMessageHeader::MESSAGE_START_SIZE) != 0) {\n             LogPrintf(\"PROCESSMESSAGE: INVALID MESSAGESTART %s peer=%d\\n\", SanitizeString(msg.hdr.GetCommand()), pfrom->id);\n-            fOk = false;\n-            break;\n+            pfrom->fDisconnect = true;\n+            return false;\n         }\n \n         // Read header\n         CMessageHeader& hdr = msg.hdr;\n         if (!hdr.IsValid(chainparams.MessageStart()))\n         {\n             LogPrintf(\"PROCESSMESSAGE: ERRORS IN HEADER %s peer=%d\\n\", SanitizeString(hdr.GetCommand()), pfrom->id);\n-            continue;\n+            return fMoreWork;",
    "path": "src/net_processing.cpp",
    "position": 121,
    "original_position": 54,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "4157c99cd81c57dbc934beadfdaf2a48a6110bd0",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This is unclear due to rebasing. In the end-result, this will return true if there are more messages.\r\n\r\nIn this commit, there's an interim chunk that's missing. line 2479 should have:\r\n```c++\r\nfMoreWork = !pfrom->vRecvMsg.empty()\r\n```\r\nI'll fix it in the next rebase so that it's more clear.",
    "created_at": "2017-01-05T21:27:11Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94854980",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94854980"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94854980"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94854980/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2494,
    "original_line": 2493,
    "side": "RIGHT",
    "in_reply_to_id": 94853525
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94857821",
    "pull_request_review_id": 15398798,
    "id": 94857821,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0ODU3ODIx",
    "diff_hunk": "@@ -650,6 +651,7 @@ class CNode\n     const NodeId id;\n \n     const uint64_t nKeyedNetGroup;\n+    std::atomic_bool fPauseRecv;",
    "path": "src/net.h",
    "position": 73,
    "original_position": 12,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "a109f7bd1801392bf99994a7165d495200156c4a",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This is never set to true until a later commit. I'm generally ok with this, but it is a bit strange.",
    "created_at": "2017-01-05T21:43:00Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94857821",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94857821"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94857821"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94857821/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 652,
    "original_line": 654,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94859040",
    "pull_request_review_id": 15400063,
    "id": 94859040,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0ODU5MDQw",
    "diff_hunk": "@@ -1239,8 +1239,18 @@ void CConnman::ThreadSocketHandler()\n                             if (!pnode->ReceiveMsgBytes(pchBuf, nBytes, notify))\n                                 pnode->CloseSocketDisconnect();\n                             RecordBytesRecv(nBytes);\n-                            if (notify)\n+                            if (notify) {\n+                                auto it(pnode->vRecvMsg.begin());",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "b5ea4f2199b66fdf2da844b884742b1d97448aab",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "You're not holding cs_vRecvMsg here, which hyou need to access vRecvMsg.",
    "created_at": "2017-01-05T21:50:05Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94859040",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94859040"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94859040"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94859040/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1230,
    "original_line": 1243,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94859110",
    "pull_request_review_id": 15400144,
    "id": 94859110,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0ODU5MTEw",
    "diff_hunk": "@@ -650,6 +651,7 @@ class CNode\n     const NodeId id;\n \n     const uint64_t nKeyedNetGroup;\n+    std::atomic_bool fPauseRecv;",
    "path": "src/net.h",
    "position": 73,
    "original_position": 12,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "a109f7bd1801392bf99994a7165d495200156c4a",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Grr, another artifact of breaking up an end-result into smaller commits. I'll add this where it belongs in the next rebase.",
    "created_at": "2017-01-05T21:50:33Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94859110",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94859110"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94859110"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94859110/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 652,
    "original_line": 654,
    "side": "RIGHT",
    "in_reply_to_id": 94857821
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94861479",
    "pull_request_review_id": 15402708,
    "id": 94861479,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0ODYxNDc5",
    "diff_hunk": "@@ -1239,8 +1239,18 @@ void CConnman::ThreadSocketHandler()\n                             if (!pnode->ReceiveMsgBytes(pchBuf, nBytes, notify))\n                                 pnode->CloseSocketDisconnect();\n                             RecordBytesRecv(nBytes);\n-                            if (notify)\n+                            if (notify) {\n+                                auto it(pnode->vRecvMsg.begin());",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "b5ea4f2199b66fdf2da844b884742b1d97448aab",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "vRecvMsg no longer needs cs_vRecvMsg starting here. It's only ever used on this thread. In reality, cs_vRecvMsg isn't needed at all, so it would probably be more clear to just remove it. copyStats is the only thing that accesses some of these vars, but it already operates without any locks, so the situation isn't changed from before.",
    "created_at": "2017-01-05T22:03:46Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94861479",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94861479"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94861479"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94861479/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1230,
    "original_line": 1243,
    "side": "RIGHT",
    "in_reply_to_id": 94859040
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94863381",
    "pull_request_review_id": 15404644,
    "id": 94863381,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0ODYzMzgx",
    "diff_hunk": "@@ -1239,8 +1239,18 @@ void CConnman::ThreadSocketHandler()\n                             if (!pnode->ReceiveMsgBytes(pchBuf, nBytes, notify))\n                                 pnode->CloseSocketDisconnect();\n                             RecordBytesRecv(nBytes);\n-                            if (notify)\n+                            if (notify) {\n+                                auto it(pnode->vRecvMsg.begin());",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "b5ea4f2199b66fdf2da844b884742b1d97448aab",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Hum, ok, can you just add a comment somewhere to note that cs_vRecvMsg no longer protects vRecvMsg, and instead protects other stuff.",
    "created_at": "2017-01-05T22:14:56Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94863381",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94863381"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94863381"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94863381/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1230,
    "original_line": 1243,
    "side": "RIGHT",
    "in_reply_to_id": 94859040
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94996847",
    "pull_request_review_id": 15542366,
    "id": 94996847,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk0OTk2ODQ3",
    "diff_hunk": "@@ -1167,10 +1159,7 @@ void CConnman::ThreadSocketHandler()\n                     }\n                 }\n                 {\n-                    TRY_LOCK(pnode->cs_vRecvMsg, lockRecv);\n-                    if (lockRecv && (\n-                        pnode->vRecvMsg.empty() || !pnode->vRecvMsg.front().complete() ||\n-                        pnode->GetTotalRecvSize() <= GetReceiveFloodSize()))\n+                    if (!pnode->fPauseRecv)",
    "path": "src/net.cpp",
    "position": 111,
    "original_position": 74,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "ddac068fa5d6b43925a96149f2d9b81ec736a5e7",
    "user": {
      "login": "morcos",
      "id": 4360349,
      "node_id": "MDQ6VXNlcjQzNjAzNDk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4360349?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/morcos",
      "html_url": "https://github.com/morcos",
      "followers_url": "https://api.github.com/users/morcos/followers",
      "following_url": "https://api.github.com/users/morcos/following{/other_user}",
      "gists_url": "https://api.github.com/users/morcos/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/morcos/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/morcos/subscriptions",
      "organizations_url": "https://api.github.com/users/morcos/orgs",
      "repos_url": "https://api.github.com/users/morcos/repos",
      "events_url": "https://api.github.com/users/morcos/events{/privacy}",
      "received_events_url": "https://api.github.com/users/morcos/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The comment above this code section describing the logic could be updated.",
    "created_at": "2017-01-06T18:44:47Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94996847",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94996847"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r94996847"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/94996847/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1158,
    "original_line": 1162,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95403337",
    "pull_request_review_id": 15956592,
    "id": 95403337,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk1NDAzMzM3",
    "diff_hunk": "@@ -648,6 +648,9 @@ void CNode::copyStats(CNodeStats &stats)\n bool CNode::ReceiveMsgBytes(const char *pch, unsigned int nBytes, bool& complete)\n {\n     complete = false;\n+    int64_t nTime = GetTimeMicros();",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "f39dd534702a00ee46e9bdf2633bbc32f21c99f0",
    "user": {
      "login": "pstratem",
      "id": 620611,
      "node_id": "MDQ6VXNlcjYyMDYxMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pstratem",
      "html_url": "https://github.com/pstratem",
      "followers_url": "https://api.github.com/users/pstratem/followers",
      "following_url": "https://api.github.com/users/pstratem/following{/other_user}",
      "gists_url": "https://api.github.com/users/pstratem/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
      "organizations_url": "https://api.github.com/users/pstratem/orgs",
      "repos_url": "https://api.github.com/users/pstratem/repos",
      "events_url": "https://api.github.com/users/pstratem/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pstratem/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It would be nice if this was nTimeMicros instead of nTime",
    "created_at": "2017-01-10T16:37:02Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r95403337",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95403337"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r95403337"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95403337/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 651,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95406662",
    "pull_request_review_id": 15960011,
    "id": 95406662,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk1NDA2NjYy",
    "diff_hunk": "@@ -1882,10 +1878,10 @@ void CConnman::ThreadMessageHandler()\n                 pnode->Release();\n         }\n \n-        if (fSleep) {\n-            std::unique_lock<std::mutex> lock(mutexMsgProc);\n-            condMsgProc.wait_until(lock, std::chrono::steady_clock::now() + std::chrono::milliseconds(100));\n-        }\n+        std::unique_lock<std::mutex> lock(mutexMsgProc);\n+        if (!fMoreWork)",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 48,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "ba4cae284f6acac4bbbfe08c89dcb8c2ace5da83",
    "user": {
      "login": "pstratem",
      "id": 620611,
      "node_id": "MDQ6VXNlcjYyMDYxMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pstratem",
      "html_url": "https://github.com/pstratem",
      "followers_url": "https://api.github.com/users/pstratem/followers",
      "following_url": "https://api.github.com/users/pstratem/following{/other_user}",
      "gists_url": "https://api.github.com/users/pstratem/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
      "organizations_url": "https://api.github.com/users/pstratem/orgs",
      "repos_url": "https://api.github.com/users/pstratem/repos",
      "events_url": "https://api.github.com/users/pstratem/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pstratem/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Please add the {} back even though it's now 1 line",
    "created_at": "2017-01-10T16:50:49Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r95406662",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95406662"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r95406662"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95406662/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1882,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95407030",
    "pull_request_review_id": 15960398,
    "id": 95407030,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk1NDA3MDMw",
    "diff_hunk": "@@ -2453,44 +2453,51 @@ bool ProcessMessages(CNode* pfrom, CConnman& connman, std::atomic<bool>& interru\n     //  (4) checksum\n     //  (x) data\n     //\n-    bool fOk = true;\n+    bool fMoreWork = false;\n \n     if (!pfrom->vRecvGetData.empty())\n         ProcessGetData(pfrom, chainparams.GetConsensus(), connman, interruptMsgProc);\n \n     // this maintains the order of responses\n-    if (!pfrom->vRecvGetData.empty()) return fOk;\n+    if (!pfrom->vRecvGetData.empty()) return true;",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 12,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "ba4cae284f6acac4bbbfe08c89dcb8c2ace5da83",
    "user": {
      "login": "pstratem",
      "id": 620611,
      "node_id": "MDQ6VXNlcjYyMDYxMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pstratem",
      "html_url": "https://github.com/pstratem",
      "followers_url": "https://api.github.com/users/pstratem/followers",
      "following_url": "https://api.github.com/users/pstratem/following{/other_user}",
      "gists_url": "https://api.github.com/users/pstratem/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
      "organizations_url": "https://api.github.com/users/pstratem/orgs",
      "repos_url": "https://api.github.com/users/pstratem/repos",
      "events_url": "https://api.github.com/users/pstratem/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pstratem/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Probably should swap these around.",
    "created_at": "2017-01-10T16:52:29Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r95407030",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95407030"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r95407030"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95407030/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2462,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95409501",
    "pull_request_review_id": 15962998,
    "id": 95409501,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk1NDA5NTAx",
    "diff_hunk": "@@ -2453,44 +2453,44 @@ bool ProcessMessages(CNode* pfrom, CConnman& connman, std::atomic<bool>& interru\n     //  (4) checksum\n     //  (x) data\n     //\n-    bool fOk = true;\n+    bool fMoreWork = false;\n \n     if (!pfrom->vRecvGetData.empty())\n         ProcessGetData(pfrom, chainparams.GetConsensus(), connman, interruptMsgProc);\n \n     // this maintains the order of responses\n-    if (!pfrom->vRecvGetData.empty()) return fOk;\n+    if (!pfrom->vRecvGetData.empty()) return true;\n \n     auto it = pfrom->vRecvMsg.begin();\n-    while (!pfrom->fDisconnect && it != pfrom->vRecvMsg.end()) {\n+    if (!pfrom->fDisconnect && it != pfrom->vRecvMsg.end()) {\n         // Don't bother if send buffer is too full to respond anyway\n         if (pfrom->nSendSize >= nMaxSendBufferSize)\n-            break;\n-\n-        // get next message\n-        CNetMessage& msg = *it;\n+            return false;\n \n         // end, if an incomplete message is found\n-        if (!msg.complete())\n-            break;\n+        if (!it->complete())\n+            return false;\n+\n+        // get next message\n+        CNetMessage msg = std::move(*it);\n \n         // at this point, any failure means we can delete the current message\n-        it++;\n+        pfrom->vRecvMsg.erase(pfrom->vRecvMsg.begin());\n \n         msg.SetVersion(pfrom->GetRecvVersion());\n         // Scan for message start\n         if (memcmp(msg.hdr.pchMessageStart, chainparams.MessageStart(), CMessageHeader::MESSAGE_START_SIZE) != 0) {\n             LogPrintf(\"PROCESSMESSAGE: INVALID MESSAGESTART %s peer=%d\\n\", SanitizeString(msg.hdr.GetCommand()), pfrom->id);\n-            fOk = false;\n-            break;\n+            pfrom->fDisconnect = true;\n+            return false;\n         }\n \n         // Read header\n         CMessageHeader& hdr = msg.hdr;\n         if (!hdr.IsValid(chainparams.MessageStart()))\n         {\n             LogPrintf(\"PROCESSMESSAGE: ERRORS IN HEADER %s peer=%d\\n\", SanitizeString(hdr.GetCommand()), pfrom->id);\n-            continue;\n+            return fMoreWork;",
    "path": "src/net_processing.cpp",
    "position": 121,
    "original_position": 54,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "4157c99cd81c57dbc934beadfdaf2a48a6110bd0",
    "user": {
      "login": "pstratem",
      "id": 620611,
      "node_id": "MDQ6VXNlcjYyMDYxMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/620611?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/pstratem",
      "html_url": "https://github.com/pstratem",
      "followers_url": "https://api.github.com/users/pstratem/followers",
      "following_url": "https://api.github.com/users/pstratem/following{/other_user}",
      "gists_url": "https://api.github.com/users/pstratem/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/pstratem/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/pstratem/subscriptions",
      "organizations_url": "https://api.github.com/users/pstratem/orgs",
      "repos_url": "https://api.github.com/users/pstratem/repos",
      "events_url": "https://api.github.com/users/pstratem/events{/privacy}",
      "received_events_url": "https://api.github.com/users/pstratem/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This should set fDisconnect and return false unconditionally actually.\r\n\r\n(Yeah that changes the current behavior)",
    "created_at": "2017-01-10T17:03:33Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r95409501",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95409501"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r95409501"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95409501/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2494,
    "original_line": 2493,
    "side": "RIGHT",
    "in_reply_to_id": 94853525
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95439862",
    "pull_request_review_id": 15994665,
    "id": 95439862,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk1NDM5ODYy",
    "diff_hunk": "@@ -2453,44 +2453,51 @@ bool ProcessMessages(CNode* pfrom, CConnman& connman, std::atomic<bool>& interru\n     //  (4) checksum\n     //  (x) data\n     //\n-    bool fOk = true;\n+    bool fMoreWork = false;\n \n     if (!pfrom->vRecvGetData.empty())\n         ProcessGetData(pfrom, chainparams.GetConsensus(), connman, interruptMsgProc);\n \n     // this maintains the order of responses\n-    if (!pfrom->vRecvGetData.empty()) return fOk;\n+    if (!pfrom->vRecvGetData.empty()) return true;",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 12,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "ba4cae284f6acac4bbbfe08c89dcb8c2ace5da83",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "ok",
    "created_at": "2017-01-10T19:34:44Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r95439862",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95439862"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r95439862"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95439862/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2462,
    "side": "RIGHT",
    "in_reply_to_id": 95407030
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95439882",
    "pull_request_review_id": 15994680,
    "id": 95439882,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk1NDM5ODgy",
    "diff_hunk": "@@ -1882,10 +1878,10 @@ void CConnman::ThreadMessageHandler()\n                 pnode->Release();\n         }\n \n-        if (fSleep) {\n-            std::unique_lock<std::mutex> lock(mutexMsgProc);\n-            condMsgProc.wait_until(lock, std::chrono::steady_clock::now() + std::chrono::milliseconds(100));\n-        }\n+        std::unique_lock<std::mutex> lock(mutexMsgProc);\n+        if (!fMoreWork)",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 48,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "ba4cae284f6acac4bbbfe08c89dcb8c2ace5da83",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "will do",
    "created_at": "2017-01-10T19:34:51Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r95439882",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95439882"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r95439882"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95439882/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1882,
    "side": "RIGHT",
    "in_reply_to_id": 95406662
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95439915",
    "pull_request_review_id": 15994713,
    "id": 95439915,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk1NDM5OTE1",
    "diff_hunk": "@@ -648,6 +648,9 @@ void CNode::copyStats(CNodeStats &stats)\n bool CNode::ReceiveMsgBytes(const char *pch, unsigned int nBytes, bool& complete)\n {\n     complete = false;\n+    int64_t nTime = GetTimeMicros();",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "f39dd534702a00ee46e9bdf2633bbc32f21c99f0",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "will do",
    "created_at": "2017-01-10T19:35:00Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r95439915",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95439915"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r95439915"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95439915/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 651,
    "side": "RIGHT",
    "in_reply_to_id": 95403337
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95440528",
    "pull_request_review_id": 15995345,
    "id": 95440528,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk1NDQwNTI4",
    "diff_hunk": "@@ -2453,44 +2453,44 @@ bool ProcessMessages(CNode* pfrom, CConnman& connman, std::atomic<bool>& interru\n     //  (4) checksum\n     //  (x) data\n     //\n-    bool fOk = true;\n+    bool fMoreWork = false;\n \n     if (!pfrom->vRecvGetData.empty())\n         ProcessGetData(pfrom, chainparams.GetConsensus(), connman, interruptMsgProc);\n \n     // this maintains the order of responses\n-    if (!pfrom->vRecvGetData.empty()) return fOk;\n+    if (!pfrom->vRecvGetData.empty()) return true;\n \n     auto it = pfrom->vRecvMsg.begin();\n-    while (!pfrom->fDisconnect && it != pfrom->vRecvMsg.end()) {\n+    if (!pfrom->fDisconnect && it != pfrom->vRecvMsg.end()) {\n         // Don't bother if send buffer is too full to respond anyway\n         if (pfrom->nSendSize >= nMaxSendBufferSize)\n-            break;\n-\n-        // get next message\n-        CNetMessage& msg = *it;\n+            return false;\n \n         // end, if an incomplete message is found\n-        if (!msg.complete())\n-            break;\n+        if (!it->complete())\n+            return false;\n+\n+        // get next message\n+        CNetMessage msg = std::move(*it);\n \n         // at this point, any failure means we can delete the current message\n-        it++;\n+        pfrom->vRecvMsg.erase(pfrom->vRecvMsg.begin());\n \n         msg.SetVersion(pfrom->GetRecvVersion());\n         // Scan for message start\n         if (memcmp(msg.hdr.pchMessageStart, chainparams.MessageStart(), CMessageHeader::MESSAGE_START_SIZE) != 0) {\n             LogPrintf(\"PROCESSMESSAGE: INVALID MESSAGESTART %s peer=%d\\n\", SanitizeString(msg.hdr.GetCommand()), pfrom->id);\n-            fOk = false;\n-            break;\n+            pfrom->fDisconnect = true;\n+            return false;\n         }\n \n         // Read header\n         CMessageHeader& hdr = msg.hdr;\n         if (!hdr.IsValid(chainparams.MessageStart()))\n         {\n             LogPrintf(\"PROCESSMESSAGE: ERRORS IN HEADER %s peer=%d\\n\", SanitizeString(hdr.GetCommand()), pfrom->id);\n-            continue;\n+            return fMoreWork;",
    "path": "src/net_processing.cpp",
    "position": 121,
    "original_position": 54,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "4157c99cd81c57dbc934beadfdaf2a48a6110bd0",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes, that would be a change of behavior, and I'm not entirely sure that we want it changed.\r\nPresumably this was done to avoid partitioning the network in the event that the header structure (or magic bytes) ever needs to change.",
    "created_at": "2017-01-10T19:38:14Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r95440528",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95440528"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r95440528"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95440528/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2494,
    "original_line": 2493,
    "side": "RIGHT",
    "in_reply_to_id": 94853525
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95884670",
    "pull_request_review_id": 16455191,
    "id": 95884670,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk1ODg0Njcw",
    "diff_hunk": "@@ -1239,20 +1239,16 @@ void CConnman::ThreadSocketHandler()\n                             RecordBytesRecv(nBytes);\n                             if (notify) {\n                                 size_t nSizeAdded = 0;\n+                                std::list<CNetMessage> completeMessages;\n                                 auto it(pnode->vRecvMsg.begin());\n                                 for (; it != pnode->vRecvMsg.end(); ++it) {\n                                     if (!it->complete())\n                                         break;\n                                     nSizeAdded += it->vRecv.size() + CMessageHeader::HEADER_SIZE;\n                                 }\n-                                {\n-                                    LOCK(pnode->cs_vProcessMsg);\n-                                    pnode->vProcessMsg.splice(pnode->vProcessMsg.end(), pnode->vRecvMsg, pnode->vRecvMsg.begin(), it);\n-                                    pnode->nProcessQueueSize += nSizeAdded;\n-                                    if (pnode->nProcessQueueSize >= nReceiveFloodSize)\n-                                        pnode->fPauseRecv = true;\n-                                }\n-                                WakeMessageHandler();\n+                                completeMessages.splice(completeMessages.end(), pnode->vRecvMsg, pnode->vRecvMsg.begin(), it);\n+                                if (!QueueReceivedMessages(pnode, std::move(completeMessages), nSizeAdded))\n+                                    pnode->fPauseRecv = true;",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 21,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "975fc9dd6f55a87f7d0db62898e58169b2816baf",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "By moving the setting of fPauseRecv outside of the cs_vProcessMsg lock you've introduced a race where the message processing thread may have already taken the next message and set fPauseRecv to false before this line (seems pretty unlikely, but its not unheard of). I'd suggest simply dropping this commit.",
    "created_at": "2017-01-12T21:06:41Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r95884670",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95884670"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r95884670"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95884670/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1251,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95888318",
    "pull_request_review_id": 16459143,
    "id": 95888318,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDk1ODg4MzE4",
    "diff_hunk": "@@ -1239,20 +1239,16 @@ void CConnman::ThreadSocketHandler()\n                             RecordBytesRecv(nBytes);\n                             if (notify) {\n                                 size_t nSizeAdded = 0;\n+                                std::list<CNetMessage> completeMessages;\n                                 auto it(pnode->vRecvMsg.begin());\n                                 for (; it != pnode->vRecvMsg.end(); ++it) {\n                                     if (!it->complete())\n                                         break;\n                                     nSizeAdded += it->vRecv.size() + CMessageHeader::HEADER_SIZE;\n                                 }\n-                                {\n-                                    LOCK(pnode->cs_vProcessMsg);\n-                                    pnode->vProcessMsg.splice(pnode->vProcessMsg.end(), pnode->vRecvMsg, pnode->vRecvMsg.begin(), it);\n-                                    pnode->nProcessQueueSize += nSizeAdded;\n-                                    if (pnode->nProcessQueueSize >= nReceiveFloodSize)\n-                                        pnode->fPauseRecv = true;\n-                                }\n-                                WakeMessageHandler();\n+                                completeMessages.splice(completeMessages.end(), pnode->vRecvMsg, pnode->vRecvMsg.begin(), it);\n+                                if (!QueueReceivedMessages(pnode, std::move(completeMessages), nSizeAdded))\n+                                    pnode->fPauseRecv = true;",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 21,
    "commit_id": "e60360e139852c655930e99d4bb4db554cd8385e",
    "original_commit_id": "975fc9dd6f55a87f7d0db62898e58169b2816baf",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Good catch!",
    "created_at": "2017-01-12T21:27:19Z",
    "updated_at": "2017-01-13T04:40:26Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r95888318",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95888318"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/9441#discussion_r95888318"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/9441"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/95888318/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1251,
    "side": "RIGHT",
    "in_reply_to_id": 95884670
  }
]