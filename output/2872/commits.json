[
  {
    "sha": "dbc0a6aba2cf94aa1b167145a18e0b9c671aef5b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkYmMwYTZhYmEyY2Y5NGFhMWIxNjcxNDVhMThlMGI5YzY3MWFlZjVi",
    "commit": {
      "author": {
        "name": "Philip Kaufmann",
        "email": "phil.kaufmann@t-online.de",
        "date": "2013-08-02T11:53:03Z"
      },
      "committer": {
        "name": "Philip Kaufmann",
        "email": "phil.kaufmann@t-online.de",
        "date": "2013-08-23T07:10:31Z"
      },
      "message": "Bitcoin-Qt: tweak Qt walletXXX.cpp/h code\n\nWalletView:\n- add new signal showNormalIfMinimized()\n- emit the new signal in handleURI() to fix a bug, preventing the main\n  window to show up when using bitcoin: URIs\n\nWalletStack:\n- connect the showNormalIfMinimized() signal from WalletView with the\n  showNormalIfMinimized() slot in BitcoinGUI\n- rework setCurrentWallet() to return a bool\n- add check for valid walletModel in addWallet()\n- add missing gui attribute initialisation in constructor\n\nWalletFrame:\n- remove unused or unneded class attributes gui and clientModel\n- add a check for valid clientModel in setClientModel()\n\nGeneral:\n- small code formatting changes",
      "tree": {
        "sha": "88a2ba112bc8c6fb3353327c5579c830f7868ff4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/88a2ba112bc8c6fb3353327c5579c830f7868ff4"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dbc0a6aba2cf94aa1b167145a18e0b9c671aef5b",
      "comment_count": 3,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dbc0a6aba2cf94aa1b167145a18e0b9c671aef5b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/dbc0a6aba2cf94aa1b167145a18e0b9c671aef5b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dbc0a6aba2cf94aa1b167145a18e0b9c671aef5b/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "e62f8d72f349aec0865268c089ae99fedd314af1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e62f8d72f349aec0865268c089ae99fedd314af1",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/e62f8d72f349aec0865268c089ae99fedd314af1"
      }
    ],
    "stats": {
      "total": 66,
      "additions": 42,
      "deletions": 24
    },
    "files": [
      {
        "sha": "99a6647a65ca1899d3568a3c0c31e0648e3f56d9",
        "filename": "src/qt/walletframe.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 8,
        "changes": 13,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/dbc0a6aba2cf94aa1b167145a18e0b9c671aef5b/src/qt/walletframe.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/dbc0a6aba2cf94aa1b167145a18e0b9c671aef5b/src/qt/walletframe.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/walletframe.cpp?ref=dbc0a6aba2cf94aa1b167145a18e0b9c671aef5b",
        "patch": "@@ -12,15 +12,13 @@\n #include <QMessageBox>\n \n WalletFrame::WalletFrame(BitcoinGUI *_gui) :\n-    QFrame(_gui),\n-    gui(_gui),\n-    clientModel(0)\n+    QFrame(_gui)\n {\n     // Leave HBox hook for adding a list view later\n     QHBoxLayout *walletFrameLayout = new QHBoxLayout(this);\n     setContentsMargins(0,0,0,0);\n     walletStack = new WalletStack(this);\n-    walletStack->setBitcoinGUI(gui);\n+    walletStack->setBitcoinGUI(_gui);\n     walletFrameLayout->setContentsMargins(0,0,0,0);\n     walletFrameLayout->addWidget(walletStack);\n }\n@@ -31,8 +29,8 @@ WalletFrame::~WalletFrame()\n \n void WalletFrame::setClientModel(ClientModel *clientModel)\n {\n-    this->clientModel = clientModel;\n-    walletStack->setClientModel(clientModel);\n+    if (clientModel)\n+        walletStack->setClientModel(clientModel);\n }\n \n bool WalletFrame::addWallet(const QString& name, WalletModel *walletModel)\n@@ -43,8 +41,7 @@ bool WalletFrame::addWallet(const QString& name, WalletModel *walletModel)\n bool WalletFrame::setCurrentWallet(const QString& name)\n {\n     // TODO: Check if valid name\n-    walletStack->setCurrentWallet(name);\n-    return true;\n+    return walletStack->setCurrentWallet(name);\n }\n \n void WalletFrame::removeAllWallets()"
      },
      {
        "sha": "eaae053ccd5659bc8099dcda9310d0149c2ea355",
        "filename": "src/qt/walletframe.h",
        "status": "modified",
        "additions": 0,
        "deletions": 2,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/dbc0a6aba2cf94aa1b167145a18e0b9c671aef5b/src/qt/walletframe.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/dbc0a6aba2cf94aa1b167145a18e0b9c671aef5b/src/qt/walletframe.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/walletframe.h?ref=dbc0a6aba2cf94aa1b167145a18e0b9c671aef5b",
        "patch": "@@ -35,8 +35,6 @@ class WalletFrame : public QFrame\n     void showOutOfSyncWarning(bool fShow);\n \n private:\n-    BitcoinGUI *gui;\n-    ClientModel *clientModel;\n     WalletStack *walletStack;\n \n public slots:"
      },
      {
        "sha": "4ef87aed52645574a1e12d5a48c1043b5d4a0a87",
        "filename": "src/qt/walletstack.cpp",
        "status": "modified",
        "additions": 30,
        "deletions": 12,
        "changes": 42,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/dbc0a6aba2cf94aa1b167145a18e0b9c671aef5b/src/qt/walletstack.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/dbc0a6aba2cf94aa1b167145a18e0b9c671aef5b/src/qt/walletstack.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/walletstack.cpp?ref=dbc0a6aba2cf94aa1b167145a18e0b9c671aef5b",
        "patch": "@@ -13,6 +13,7 @@\n \n WalletStack::WalletStack(QWidget *parent) :\n     QStackedWidget(parent),\n+    gui(0),\n     clientModel(0),\n     bOutOfSync(true)\n {\n@@ -25,7 +26,7 @@ WalletStack::~WalletStack()\n \n bool WalletStack::addWallet(const QString& name, WalletModel *walletModel)\n {\n-    if (!gui || !clientModel || mapWalletViews.count(name) > 0)\n+    if (!gui || !clientModel || !walletModel || mapWalletViews.count(name) > 0)\n         return false;\n \n     WalletView *walletView = new WalletView(this, gui);\n@@ -35,12 +36,18 @@ bool WalletStack::addWallet(const QString& name, WalletModel *walletModel)\n     walletView->showOutOfSyncWarning(bOutOfSync);\n     addWidget(walletView);\n     mapWalletViews[name] = walletView;\n+\n+    // Ensure a walletView is able to show the main window\n+\tconnect(walletView, SIGNAL(showNormalIfMinimized()), gui, SLOT(showNormalIfMinimized()));\n+\n     return true;\n }\n \n bool WalletStack::removeWallet(const QString& name)\n {\n-    if (mapWalletViews.count(name) == 0) return false;\n+    if (mapWalletViews.count(name) == 0)\n+        return false;\n+\n     WalletView *walletView = mapWalletViews.take(name);\n     removeWidget(walletView);\n     return true;\n@@ -57,7 +64,8 @@ void WalletStack::removeAllWallets()\n bool WalletStack::handlePaymentRequest(const SendCoinsRecipient &recipient)\n {\n     WalletView *walletView = (WalletView*)currentWidget();\n-    if (!walletView) return false;\n+    if (!walletView)\n+        return false;\n \n     return walletView->handlePaymentRequest(recipient);\n }\n@@ -108,49 +116,59 @@ void WalletStack::gotoSendCoinsPage(QString addr)\n void WalletStack::gotoSignMessageTab(QString addr)\n {\n     WalletView *walletView = (WalletView*)currentWidget();\n-    if (walletView) walletView->gotoSignMessageTab(addr);\n+    if (walletView)\n+        walletView->gotoSignMessageTab(addr);\n }\n \n void WalletStack::gotoVerifyMessageTab(QString addr)\n {\n     WalletView *walletView = (WalletView*)currentWidget();\n-    if (walletView) walletView->gotoVerifyMessageTab(addr);\n+    if (walletView)\n+        walletView->gotoVerifyMessageTab(addr);\n }\n \n void WalletStack::encryptWallet(bool status)\n {\n     WalletView *walletView = (WalletView*)currentWidget();\n-    if (walletView) walletView->encryptWallet(status);\n+    if (walletView)\n+        walletView->encryptWallet(status);\n }\n \n void WalletStack::backupWallet()\n {\n     WalletView *walletView = (WalletView*)currentWidget();\n-    if (walletView) walletView->backupWallet();\n+    if (walletView)\n+        walletView->backupWallet();\n }\n \n void WalletStack::changePassphrase()\n {\n     WalletView *walletView = (WalletView*)currentWidget();\n-    if (walletView) walletView->changePassphrase();\n+    if (walletView)\n+        walletView->changePassphrase();\n }\n \n void WalletStack::unlockWallet()\n {\n     WalletView *walletView = (WalletView*)currentWidget();\n-    if (walletView) walletView->unlockWallet();\n+    if (walletView)\n+        walletView->unlockWallet();\n }\n \n void WalletStack::setEncryptionStatus()\n {\n     WalletView *walletView = (WalletView*)currentWidget();\n-    if (walletView) walletView->setEncryptionStatus();\n+    if (walletView)\n+        walletView->setEncryptionStatus();\n }\n \n-void WalletStack::setCurrentWallet(const QString& name)\n+bool WalletStack::setCurrentWallet(const QString& name)\n {\n-    if (mapWalletViews.count(name) == 0) return;\n+    if (mapWalletViews.count(name) == 0)\n+        return false;\n+\n     WalletView *walletView = mapWalletViews.value(name);\n     setCurrentWidget(walletView);\n     walletView->setEncryptionStatus();\n+    return true;\n }"
      },
      {
        "sha": "74b9f0908172dc1b7a225003770b616abf2605da",
        "filename": "src/qt/walletstack.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/dbc0a6aba2cf94aa1b167145a18e0b9c671aef5b/src/qt/walletstack.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/dbc0a6aba2cf94aa1b167145a18e0b9c671aef5b/src/qt/walletstack.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/walletstack.h?ref=dbc0a6aba2cf94aa1b167145a18e0b9c671aef5b",
        "patch": "@@ -67,7 +67,7 @@ class WalletStack : public QStackedWidget\n     bool bOutOfSync;\n \n public slots:\n-    void setCurrentWallet(const QString& name);\n+    bool setCurrentWallet(const QString& name);\n \n     /** Switch to overview (home) page */\n     void gotoOverviewPage();"
      },
      {
        "sha": "efb74efaa0194e4c4cb4c0c0fd2447486f1741cf",
        "filename": "src/qt/walletview.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 1,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/dbc0a6aba2cf94aa1b167145a18e0b9c671aef5b/src/qt/walletview.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/dbc0a6aba2cf94aa1b167145a18e0b9c671aef5b/src/qt/walletview.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/walletview.cpp?ref=dbc0a6aba2cf94aa1b167145a18e0b9c671aef5b",
        "patch": "@@ -137,7 +137,7 @@ void WalletView::setWalletModel(WalletModel *walletModel)\n void WalletView::incomingTransaction(const QModelIndex& parent, int start, int /*end*/)\n {\n     // Prevent balloon-spam when initial block download is in progress\n-    if(!walletModel || !clientModel || clientModel->inInitialBlockDownload())\n+    if (!walletModel || !clientModel || clientModel->inInitialBlockDownload())\n         return;\n \n     TransactionTableModel *ttm = walletModel->getTransactionTableModel();\n@@ -207,6 +207,7 @@ bool WalletView::handlePaymentRequest(const SendCoinsRecipient& recipient)\n     if (sendCoinsPage->handlePaymentRequest(recipient))\n     {\n         gotoSendCoinsPage();\n+        emit showNormalIfMinimized();\n         return true;\n     }\n     else"
      },
      {
        "sha": "ce4e0510985dfdfcca3e19e8e158d6fdb12db0c2",
        "filename": "src/qt/walletview.h",
        "status": "modified",
        "additions": 4,
        "deletions": 0,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/dbc0a6aba2cf94aa1b167145a18e0b9c671aef5b/src/qt/walletview.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/dbc0a6aba2cf94aa1b167145a18e0b9c671aef5b/src/qt/walletview.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/walletview.h?ref=dbc0a6aba2cf94aa1b167145a18e0b9c671aef5b",
        "patch": "@@ -100,6 +100,10 @@ public slots:\n     void unlockWallet();\n \n     void setEncryptionStatus();\n+\n+signals:\n+    /** Signal that we want to show the main window */\n+    void showNormalIfMinimized();\n };\n \n #endif // WALLETVIEW_H"
      }
    ]
  }
]