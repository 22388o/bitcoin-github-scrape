promag,2019-09-18 23:13:03,"Concept ACK, this reverts to the original check - just check the hash. This might improve loading time if it's a big wallet and the majority of transactions have lots of inputs.",https://github.com/bitcoin/bitcoin/pull/16911#issuecomment-532901592,532901592,
promag,2019-09-18 23:16:19,"For reference, the call to `CheckTransaction` was added [here](https://github.com/bitcoin/bitcoin/pull/1895/files#diff-3b5a9b7d780ff672241548edf2888fcdR206) and before [was](https://github.com/bitcoin/bitcoin/pull/1895/files#diff-3b5a9b7d780ff672241548edf2888fcdL244).",https://github.com/bitcoin/bitcoin/pull/16911#issuecomment-532902340,532902340,
DrahtBot,2019-09-19 00:54:47,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#15921](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15921.html) (validation: Tidy up ValidationState interfa",https://github.com/bitcoin/bitcoin/pull/16911#issuecomment-532920851,532920851,
achow101,2019-09-19 22:09:29,"Using my big wallet environment (same one as in #16910), I did 1000 of my wallet loading benchmark (from https://github.com/bitcoin/bitcoin/pull/16910#issuecomment-532886444) and found the mean loading time on master to be 18408.14423 ms, while the mean loading time with this PR is 17870.51767 ms. This is about 0.5 second faster, which is ~3% performance improvement. So removing this check does ac",https://github.com/bitcoin/bitcoin/pull/16911#issuecomment-533327639,533327639,
MarcoFalke,2019-09-20 15:11:58,ACK cd68594dcdadc195bd2ea9394fa04edfdbdf1149,https://github.com/bitcoin/bitcoin/pull/16911#issuecomment-533593873,533593873,
MarcoFalke,2019-09-20 15:26:37,"Whenever a consensus-invalid tx has made it into the wallet (e.g. CVE-2010-5139), the db layer is not the right place to deal with it.\n\nAlso, stuff like this should probably be tested: https://github.com/bitcoin/bitcoin/blame/f8b0b190aa9d13e93ebfe34b5655dbe8ed8df3d3/src/wallet/walletdb.cpp#L484",https://github.com/bitcoin/bitcoin/pull/16911#issuecomment-533599938,533599938,
luke-jr,2019-09-20 23:42:55,"> Whenever a consensus-invalid tx has made it into the wallet (e.g. CVE-2010-5139), the db layer is not the right place to deal with it.\n\nYet it should probably be dealt with somewhere.\n\nHow does the behaviour change here affect it?\n\n(a CVE might not be the best example to use - this would be triggered by any unconfirmed transaction becoming invalid in any softfork)",https://github.com/bitcoin/bitcoin/pull/16911#issuecomment-533745391,533745391,
achow101,2019-09-21 00:14:23,"> > Whenever a consensus-invalid tx has made it into the wallet (e.g. CVE-2010-5139), the db layer is not the right place to deal with it.\n> \n> Yet it should probably be dealt with somewhere.\n> \n> How does the behaviour change here affect it?\n> \n> (a CVE might not be the best example to use - this would be triggered by any unconfirmed transaction becoming invalid in any softfork)\n\n",https://github.com/bitcoin/bitcoin/pull/16911#issuecomment-533749770,533749770,
achow101,2019-09-21 10:57:24,"Did some further investigating on the invalid transaction thing.\n\nInvalid transactions won't be shown in any transaction lists, they aren't added to mapWallet. With this change, such transactions would be added to mapWallet and will thus affect balances and available coins for coin selection.\n\nBut an important thing to note is that CheckTransaction doesn't fully check a transaction for val",https://github.com/bitcoin/bitcoin/pull/16911#issuecomment-533788594,533788594,
laanwj,2019-10-23 10:05:32,"ACK cd68594dcdadc195bd2ea9394fa04edfdbdf1149\n\nA hash is enough to check integrity.\n\nI think CVEs and potential softforks that invalidate transactions retroactively can be dealt with when they arise.\n",https://github.com/bitcoin/bitcoin/pull/16911#issuecomment-545369803,545369803,
MarcoFalke,2019-09-18 22:27:06,please remove the consensus #includes as well   ,https://github.com/bitcoin/bitcoin/pull/16911#discussion_r325919492,325919492,src/wallet/walletdb.cpp
MarcoFalke,2019-09-20 12:23:15,@achow101 ^,https://github.com/bitcoin/bitcoin/pull/16911#discussion_r326602347,326602347,src/wallet/walletdb.cpp
promag,2019-09-20 13:53:15,"```diff\n #include <wallet/walletdb.h>\n\n-#include <consensus/tx_check.h>\n-#include <consensus/validation.h>\n #include <fs.h>\n #include <key_io.h>\n #include <protocol.h>\n```",https://github.com/bitcoin/bitcoin/pull/16911#discussion_r326638607,326638607,src/wallet/walletdb.cpp
achow101,2019-09-20 14:11:12,Done,https://github.com/bitcoin/bitcoin/pull/16911#discussion_r326647024,326647024,src/wallet/walletdb.cpp
