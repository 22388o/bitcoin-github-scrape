[
  {
    "sha": "0dd127a791127e72661cb78efec26a2fdd4ec4ba",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzowZGQxMjdhNzkxMTI3ZTcyNjYxY2I3OGVmZWMyNmEyZmRkNGVjNGJh",
    "commit": {
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2013-10-11T01:33:27Z"
      },
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2013-10-11T04:50:02Z"
      },
      "message": "Rework pull-tester scripts, disable blockchain tester\n\nRe-organize the pull-tester scripts a bit.\n\nAnd disables running the blockchain tester, it is not working properly\non the pull-tester machine for reasons I cannot explain (fails to start).",
      "tree": {
        "sha": "70649d8e0b7edc9e78b1ff2d2ffeeb352dadd997",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/70649d8e0b7edc9e78b1ff2d2ffeeb352dadd997"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/0dd127a791127e72661cb78efec26a2fdd4ec4ba",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0dd127a791127e72661cb78efec26a2fdd4ec4ba",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/0dd127a791127e72661cb78efec26a2fdd4ec4ba",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0dd127a791127e72661cb78efec26a2fdd4ec4ba/comments",
    "author": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "26002aa444d4ee4986d623e0ad45cca02e803bc5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/26002aa444d4ee4986d623e0ad45cca02e803bc5",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/26002aa444d4ee4986d623e0ad45cca02e803bc5"
      }
    ],
    "stats": {
      "total": 58,
      "additions": 45,
      "deletions": 13
    },
    "files": [
      {
        "sha": "6ae9e9606ac55ec20a504429fdf27b3d504001f0",
        "filename": "qa/pull-tester/build-tests.sh.in",
        "status": "modified",
        "additions": 36,
        "deletions": 6,
        "changes": 42,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/0dd127a791127e72661cb78efec26a2fdd4ec4ba/qa/pull-tester/build-tests.sh.in",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/0dd127a791127e72661cb78efec26a2fdd4ec4ba/qa/pull-tester/build-tests.sh.in",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/qa/pull-tester/build-tests.sh.in?ref=0dd127a791127e72661cb78efec26a2fdd4ec4ba",
        "patch": "@@ -3,44 +3,74 @@\n # Param2: Path to java comparison tool\n # Param3: Number of make jobs. Defaults to 1.\n \n+# Exit immediately if anything fails:\n set -e\n set -o xtrace\n \n MINGWPREFIX=$1\n JAVA_COMPARISON_TOOL=$2\n JOBS=${3-1}\n+OUT_DIR=${4-}\n \n if [ $# -lt 2 ]; then\n-  echo \"Usage: $0 [mingw-prefix] [java-comparison-tool] <make jobs>\"\n+  echo \"Usage: $0 [mingw-prefix] [java-comparison-tool] <make jobs> <save output dir>\"\n   exit 1\n fi\n \n DISTDIR=@PACKAGE@-@VERSION@\n \n-# Test win32 build first (it breaks the most often)\n+# Cross-compile for windows first (breaking the mingw/windows build is most common)\n cd @abs_top_srcdir@\n make distdir\n mv $DISTDIR win32-build\n cd win32-build\n ./configure --disable-silent-rules --disable-ccache --prefix=$MINGWPREFIX --host=i586-mingw32msvc --with-qt-bindir=$MINGWPREFIX/host/bin --with-qt-plugindir=$MINGWPREFIX/plugins --with-qt-incdir=$MINGWPREFIX/include --with-boost=$MINGWPREFIX --with-protoc-bindir=$MINGWPREFIX/host/bin CPPFLAGS=-I$MINGWPREFIX/include LDFLAGS=-L$MINGWPREFIX/lib\n make -j$JOBS\n-make check\n \n-# ... then linux build, with blockchain-tester:\n+# And compile for Linux:\n cd @abs_top_srcdir@\n make distdir\n mv $DISTDIR linux-build\n cd linux-build\n-./configure --disable-silent-rules --disable-ccache --with-comparison-tool=\"$JAVA_COMPARISON_TOOL\"\n+# TODO: re-enable blockchain tester tool, as of 11 Oct 2013 is it not working properly\n+# on the pull-tester machine.\n+#./configure --disable-silent-rules --disable-ccache --with-comparison-tool=\"$JAVA_COMPARISON_TOOL\"\n+./configure --disable-silent-rules --disable-ccache\n make -j$JOBS\n+\n+# link interesting binaries to parent out/ directory, if it exists. Do this before\n+# running unit tests (we want bad binaries to be easy to find)\n+if [ -d \"$OUT_DIR\" -a -w \"$OUT_DIR\" ]; then\n+  set +e\n+  # Windows:\n+  cp @abs_top_srcdir@/win32-build/src/bitcoind.exe $OUT_DIR/bitcoind.exe\n+  cp @abs_top_srcdir@/win32-build/src/test/test_bitcoin.exe $OUT_DIR/test_bitcoin.exe\n+  cp @abs_top_srcdir@/win32-build/src/qt/bitcoind-qt.exe $OUT_DIR/bitcoin-qt.exe\n+  # Linux:\n+  cp @abs_top_srcdir@/linux-build/src/bitcoind $OUT_DIR/bitcoind\n+  cp @abs_top_srcdir@/linux-build/src/test/test_bitcoin $OUT_DIR/test_bitcoin\n+  cp @abs_top_srcdir@/linux-build/src/qt/bitcoind-qt $OUT_DIR/bitcoin-qt\n+  set -e\n+fi\n+\n+# Run unit tests and blockchain-tester on Linux:\n+cd @abs_top_srcdir@/linux-build\n make check\n \n+# Clean up builds (pull-tester machine doesn't have infinite disk space)\n+cd @abs_top_srcdir@/linux-build\n+make clean\n+cd @abs_top_srcdir@/win32-build\n+make clean\n+\n # Test code coverage\n cd @abs_top_srcdir@\n make distdir\n mv $DISTDIR linux-coverage-build\n cd linux-coverage-build\n-./configure --enable-lcov --with-comparison-tool=\"$JAVA_COMPARISON_TOOL\"\n+# TODO: re-enable blockchain tester tool\n+#./configure --enable-lcov --with-comparison-tool=\"$JAVA_COMPARISON_TOOL\"\n+./configure --enable-lcov\n make -j$JOBS\n make cov\n "
      },
      {
        "sha": "34dd74c7e0ccd57303019cf7c17498d9a3fbed57",
        "filename": "qa/pull-tester/pull-tester.py",
        "status": "modified",
        "additions": 9,
        "deletions": 7,
        "changes": 16,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/0dd127a791127e72661cb78efec26a2fdd4ec4ba/qa/pull-tester/pull-tester.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/0dd127a791127e72661cb78efec26a2fdd4ec4ba/qa/pull-tester/pull-tester.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/qa/pull-tester/pull-tester.py?ref=0dd127a791127e72661cb78efec26a2fdd4ec4ba",
        "patch": "@@ -38,7 +38,7 @@ def checkout_pull(clone_url, commit, out):\n     # Init\n     build_dir=os.environ[\"BUILD_DIR\"]\n     run(\"umount ${CHROOT_COPY}/proc\", fail_hard=False)\n-    run(\"rsync --delete -apv ${CHROOT_MASTER} ${CHROOT_COPY}\")\n+    run(\"rsync --delete -apv ${CHROOT_MASTER}/ ${CHROOT_COPY}\")\n     run(\"rm -rf ${CHROOT_COPY}${SCRIPTS_DIR}\")\n     run(\"cp -a ${SCRIPTS_DIR} ${CHROOT_COPY}${SCRIPTS_DIR}\")\n     # Merge onto upstream/master\n@@ -108,17 +108,18 @@ def testpull(number, comment_url, clone_url, commit):\n         open(os.environ[\"TESTED_DB\"], \"a\").write(commit + \"\\n\")\n         return\n \n-    # New: pull-tester.sh script(s) are in the tree:\n+    run(\"rm -rf ${CHROOT_COPY}/${OUT_DIR}\", fail_hard=False);\n+    run(\"mkdir -p ${CHROOT_COPY}/${OUT_DIR}\", fail_hard=False);\n+    run(\"chown -R ${BUILD_USER}:${BUILD_GROUP} ${CHROOT_COPY}/${OUT_DIR}\", fail_hard=False)\n+\n     script = os.environ[\"BUILD_PATH\"]+\"/qa/pull-tester/pull-tester.sh\"\n-    script += \" ${BUILD_PATH} ${MINGW_DEPS_DIR} ${SCRIPTS_DIR}/BitcoindComparisonTool.jar 1\"\n+    script += \" ${BUILD_PATH} ${MINGW_DEPS_DIR} ${SCRIPTS_DIR}/BitcoindComparisonTool.jar 6 ${OUT_DIR}\"\n     returncode = run(\"chroot ${CHROOT_COPY} sudo -u ${BUILD_USER} -H timeout ${TEST_TIMEOUT} \"+script,\n                      fail_hard=False, stdout=out, stderr=out)\n \n+    run(\"mv ${CHROOT_COPY}/${OUT_DIR} \" + dir)\n     run(\"mv ${BUILD_DIR} \" + dir)\n-    # TODO: FIXME \n-    # Idea: have run-script save interesting output...\n-    #    run(\"cp /mnt/chroot-tmp/home/ubuntu/.bitcoin/regtest/debug.log \" + dir)\n-    #    os.system(\"chmod +r \" + dir + \"/debug.log\")\n+\n     if returncode == 42:\n         print(\"Successfully tested pull (needs tests) - sending comment to: \" + comment_url)\n         commentOn(comment_url, True, False, True, resultsurl)\n@@ -147,6 +148,7 @@ def environ_default(setting, value):\n environ_default(\"SCRIPTS_DIR\", \"/mnt/test-scripts\")\n environ_default(\"CHROOT_COPY\", \"/mnt/chroot-tmp\")\n environ_default(\"CHROOT_MASTER\", \"/mnt/chroot\")\n+environ_default(\"OUT_DIR\", \"/mnt/out\")\n environ_default(\"BUILD_PATH\", \"/mnt/bitcoin\")\n os.environ[\"BUILD_DIR\"] = os.environ[\"CHROOT_COPY\"] + os.environ[\"BUILD_PATH\"]\n environ_default(\"RESULTS_DIR\", \"/mnt/www/pull-tester\")"
      }
    ]
  },
  {
    "sha": "38a94488cebffc41ae57d3519bc253938b75aa44",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozOGE5NDQ4OGNlYmZmYzQxYWU1N2QzNTE5YmMyNTM5MzhiNzVhYTQ0",
    "commit": {
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2013-10-11T02:32:17Z"
      },
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2013-10-11T04:50:02Z"
      },
      "message": "Disable code-coverage builds for now\n\nNot working on the pull-tester machine, 'make cov' hangs there.",
      "tree": {
        "sha": "eafc69bfbbf2e7ded8bf37f591c5e31ebe2bc6ee",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/eafc69bfbbf2e7ded8bf37f591c5e31ebe2bc6ee"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/38a94488cebffc41ae57d3519bc253938b75aa44",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/38a94488cebffc41ae57d3519bc253938b75aa44",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/38a94488cebffc41ae57d3519bc253938b75aa44",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/38a94488cebffc41ae57d3519bc253938b75aa44/comments",
    "author": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "0dd127a791127e72661cb78efec26a2fdd4ec4ba",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0dd127a791127e72661cb78efec26a2fdd4ec4ba",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/0dd127a791127e72661cb78efec26a2fdd4ec4ba"
      }
    ],
    "stats": {
      "total": 20,
      "additions": 9,
      "deletions": 11
    },
    "files": [
      {
        "sha": "461e7be0486835fa8e5c7cc3425f34bd528b5118",
        "filename": "qa/pull-tester/build-tests.sh.in",
        "status": "modified",
        "additions": 9,
        "deletions": 11,
        "changes": 20,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/38a94488cebffc41ae57d3519bc253938b75aa44/qa/pull-tester/build-tests.sh.in",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/38a94488cebffc41ae57d3519bc253938b75aa44/qa/pull-tester/build-tests.sh.in",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/qa/pull-tester/build-tests.sh.in?ref=38a94488cebffc41ae57d3519bc253938b75aa44",
        "patch": "@@ -63,14 +63,12 @@ make clean\n cd @abs_top_srcdir@/win32-build\n make clean\n \n-# Test code coverage\n-cd @abs_top_srcdir@\n-make distdir\n-mv $DISTDIR linux-coverage-build\n-cd linux-coverage-build\n-# TODO: re-enable blockchain tester tool\n-#./configure --enable-lcov --with-comparison-tool=\"$JAVA_COMPARISON_TOOL\"\n-./configure --enable-lcov\n-make -j$JOBS\n-make cov\n-\n+# TODO: Fix code coverage builds on pull-tester machine\n+# # Test code coverage\n+# cd @abs_top_srcdir@\n+# make distdir\n+# mv $DISTDIR linux-coverage-build\n+# cd linux-coverage-build\n+# ./configure --enable-lcov --disable-silent-rules --disable-ccache --with-comparison-tool=\"$JAVA_COMPARISON_TOOL\"\n+# make -j$JOBS\n+# make cov"
      }
    ]
  }
]