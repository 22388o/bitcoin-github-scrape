[
  {
    "sha": "faf40810d7b7f42f3588bfa8a663095aa24001b1",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYWY0MDgxMGQ3YjdmNDJmMzU4OGJmYThhNjYzMDk1YWEyNDAwMWIx",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-01-23T14:02:02Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-01-23T13:59:51Z"
      },
      "message": "test: Make msg_tx a witness tx",
      "tree": {
        "sha": "ab32c95777c3f4f24d8a55a6299459f1302638a6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/ab32c95777c3f4f24d8a55a6299459f1302638a6"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/faf40810d7b7f42f3588bfa8a663095aa24001b1",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUgMMAv+LGb1Fgkx0Npjs8lc3bQI3YUmOQYSsgCzQK71DTAObeHaLjbB4ZUBw7io\nOtyRhZkcOYLne5tVOGsriMVWA2UYwj5agOrhDrnuvqpW812Md/UYyEWWsrinFQ+X\noAZr/2hBndzfzVkz1ItdUiKiwJLpBKeqhzI5LbM/PwC4WK5bbE0Gk1/zKE8rCkkg\n0MM43caocOcKSMtVgy2D9y6pPtO32hoPJWvmJJ6GFZSYN/TPYAi2XosWXSqbliQn\nVeYQeU9IEOVm+iYZYgDzsk694m+vaQFks//veGusGj1wiWmGMJ9XLHenTDvVpqOz\nX+SNH6ebZzw1dy1LljSYMEypFoHIKK9Hh8o8Cn0VoasTk/50QDFiGX4Dqn9ZUiqH\nluX8Ic66hhoy8Hj9ytELyVLGEx1g+ZSnqnYLUFCMo6fODN3pMRINu/zWi3M0JBon\nzpPl9SygeTgv6nf9x+neGMTQvLDOC18WEVfROY1Di887YrwPmKZZy0ZgVPg+z8AY\ngw3lfhJj\n=RNqx\n-----END PGP SIGNATURE-----",
        "payload": "tree ab32c95777c3f4f24d8a55a6299459f1302638a6\nparent 7a311fa54a936ea611d47204ba4530ffd4529981\nauthor MarcoFalke <falke.marco@gmail.com> 1579788122 -0500\ncommitter MarcoFalke <falke.marco@gmail.com> 1579787991 -0500\n\ntest: Make msg_tx a witness tx\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faf40810d7b7f42f3588bfa8a663095aa24001b1",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/faf40810d7b7f42f3588bfa8a663095aa24001b1",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faf40810d7b7f42f3588bfa8a663095aa24001b1/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "7a311fa54a936ea611d47204ba4530ffd4529981",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7a311fa54a936ea611d47204ba4530ffd4529981",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/7a311fa54a936ea611d47204ba4530ffd4529981"
      }
    ],
    "stats": {
      "total": 15,
      "additions": 8,
      "deletions": 7
    },
    "files": [
      {
        "sha": "3223c27e0b1bf2011b6e6ebe16235cbb825af0ec",
        "filename": "test/functional/p2p_segwit.py",
        "status": "modified",
        "additions": 5,
        "deletions": 4,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faf40810d7b7f42f3588bfa8a663095aa24001b1/test/functional/p2p_segwit.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faf40810d7b7f42f3588bfa8a663095aa24001b1/test/functional/p2p_segwit.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/p2p_segwit.py?ref=faf40810d7b7f42f3588bfa8a663095aa24001b1",
        "patch": "@@ -31,7 +31,7 @@\n     msg_inv,\n     msg_tx,\n     msg_block,\n-    msg_witness_tx,\n+    msg_no_witness_tx,\n     ser_uint256,\n     ser_vector,\n     sha256,\n@@ -125,10 +125,11 @@ def test_transaction_acceptance(node, p2p, tx, with_witness, accepted, reason=No\n     - use the getrawmempool rpc to check for acceptance.\"\"\"\n     reason = [reason] if reason else []\n     with node.assert_debug_log(expected_msgs=reason):\n-        p2p.send_message(msg_witness_tx(tx) if with_witness else msg_tx(tx))\n+        p2p.send_message(msg_tx(tx) if with_witness else msg_no_witness_tx(tx))\n         p2p.sync_with_ping()\n         assert_equal(tx.hash in node.getrawmempool(), accepted)\n \n+\n def test_witness_block(node, p2p, block, accepted, with_witness=True, reason=None):\n     \"\"\"Send a block to the node and check that it's accepted\n \n@@ -311,9 +312,9 @@ def test_non_witness_transaction(self):\n \n         # Check that serializing it with or without witness is the same\n         # This is a sanity check of our testing framework.\n-        assert_equal(msg_tx(tx).serialize(), msg_witness_tx(tx).serialize())\n+        assert_equal(msg_no_witness_tx(tx).serialize(), msg_tx(tx).serialize())\n \n-        self.test_node.send_message(msg_witness_tx(tx))\n+        self.test_node.send_message(msg_tx(tx))\n         self.test_node.sync_with_ping()  # make sure the tx was processed\n         assert tx.hash in self.nodes[0].getrawmempool()\n         # Save this transaction for later"
      },
      {
        "sha": "4f7a9a8b1313896719c0aadb0bc98431bb69fd7b",
        "filename": "test/functional/test_framework/messages.py",
        "status": "modified",
        "additions": 3,
        "deletions": 3,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faf40810d7b7f42f3588bfa8a663095aa24001b1/test/functional/test_framework/messages.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faf40810d7b7f42f3588bfa8a663095aa24001b1/test/functional/test_framework/messages.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/test_framework/messages.py?ref=faf40810d7b7f42f3588bfa8a663095aa24001b1",
        "patch": "@@ -1105,17 +1105,17 @@ def deserialize(self, f):\n         self.tx.deserialize(f)\n \n     def serialize(self):\n-        return self.tx.serialize_without_witness()\n+        return self.tx.serialize_with_witness()\n \n     def __repr__(self):\n         return \"msg_tx(tx=%s)\" % (repr(self.tx))\n \n \n-class msg_witness_tx(msg_tx):\n+class msg_no_witness_tx(msg_tx):\n     __slots__ = ()\n \n     def serialize(self):\n-        return self.tx.serialize_with_witness()\n+        return self.tx.serialize_without_witness()\n \n \n class msg_block:"
      }
    ]
  },
  {
    "sha": "fa6b57bcaaf4dc65d78316353033b03d171a3beb",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYTZiNTdiY2FhZjRkYzY1ZDc4MzE2MzUzMDMzYjAzZDE3MWEzYmVi",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-01-22T20:36:44Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-01-23T14:00:20Z"
      },
      "message": "test: Fix whitespace in p2p_permissions.py",
      "tree": {
        "sha": "1d2acb9b54c40f93728ec2f39f5ccec887a71e1b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1d2acb9b54c40f93728ec2f39f5ccec887a71e1b"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa6b57bcaaf4dc65d78316353033b03d171a3beb",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUiqjAwAreMr0Vayv0hd4uESDCg6nCrP8QTF20uFbmNwj1mJlhwdL0eNgHH8ksBr\nFxBN9cmFmYzuF9OjSd9vvnH33DZUQ1+c/TZKjSzjbdq1UvObfk92+N0YStZvTwJl\noMzk8W2OG3s7xFbJBqfYG8jXEpAHl+37koqwi/pVD7yTCDM0hCe+UeDImri2sBRc\nz5cpiQENhPQt74LyM2YzDnA4VqGSjgngyvoSEnF+e/pZyrL6YP8p3OTqZtthMJt3\nZlU4vCAxz647ThfKwumKDpdOlOqwvRmfIC7fKp8MRjQOGOmXZtmOa7dtYPzIc3uT\n1aTBHn4qHXBrjkUszdJcT5vGF1sXJOjAkfO0hd/ggYa25PIHj5JaoZ//LVvLfeOD\nWDbHaUGF8+IJh+UP9uwuZY1pvRUOJwol8fIpSViE0HFCuoUOObZ8NpuBCtBe+2Gv\nXcrNSBQagMiN64OGb/EAEonZKCIVu/YzNCyf7pyo8Zxvmg0Uu8ldUZvphHjR5uO0\nMApiqriP\n=PTcb\n-----END PGP SIGNATURE-----",
        "payload": "tree 1d2acb9b54c40f93728ec2f39f5ccec887a71e1b\nparent faf40810d7b7f42f3588bfa8a663095aa24001b1\nauthor MarcoFalke <falke.marco@gmail.com> 1579725404 -0500\ncommitter MarcoFalke <falke.marco@gmail.com> 1579788020 -0500\n\ntest: Fix whitespace in p2p_permissions.py\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa6b57bcaaf4dc65d78316353033b03d171a3beb",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fa6b57bcaaf4dc65d78316353033b03d171a3beb",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa6b57bcaaf4dc65d78316353033b03d171a3beb/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "faf40810d7b7f42f3588bfa8a663095aa24001b1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faf40810d7b7f42f3588bfa8a663095aa24001b1",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/faf40810d7b7f42f3588bfa8a663095aa24001b1"
      }
    ],
    "stats": {
      "total": 7,
      "additions": 4,
      "deletions": 3
    },
    "files": [
      {
        "sha": "fd38201621df13ea219dff5b57f393e6fb72e2ad",
        "filename": "test/functional/p2p_permissions.py",
        "status": "modified",
        "additions": 4,
        "deletions": 3,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa6b57bcaaf4dc65d78316353033b03d171a3beb/test/functional/p2p_permissions.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa6b57bcaaf4dc65d78316353033b03d171a3beb/test/functional/p2p_permissions.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/p2p_permissions.py?ref=fa6b57bcaaf4dc65d78316353033b03d171a3beb",
        "patch": "@@ -48,9 +48,9 @@ def run_test(self):\n         ip_port = \"127.0.0.1:{}\".format(p2p_port(1))\n         self.replaceinconfig(1, \"bind=127.0.0.1\", \"whitebind=bloomfilter,forcerelay@\" + ip_port)\n         self.checkpermission(\n-            [\"-whitelist=noban@127.0.0.1\" ],\n+            [\"-whitelist=noban@127.0.0.1\"],\n             # Check parameter interaction forcerelay should activate relay\n-            [\"noban\", \"bloomfilter\", \"forcerelay\", \"relay\" ],\n+            [\"noban\", \"bloomfilter\", \"forcerelay\", \"relay\"],\n             False)\n         self.replaceinconfig(1, \"whitebind=bloomfilter,forcerelay@\" + ip_port, \"bind=127.0.0.1\")\n \n@@ -95,9 +95,10 @@ def checkpermission(self, args, expectedPermissions, whitelisted):\n \n     def replaceinconfig(self, nodeid, old, new):\n         with open(self.nodes[nodeid].bitcoinconf, encoding=\"utf8\") as f:\n-            newText=f.read().replace(old, new)\n+            newText = f.read().replace(old, new)\n         with open(self.nodes[nodeid].bitcoinconf, 'w', encoding=\"utf8\") as f:\n             f.write(newText)\n \n+\n if __name__ == '__main__':\n     P2PPermissionsTests().main()"
      }
    ]
  },
  {
    "sha": "aaaae4d0ebd5ef34d81997a73ab9839ba7b4b9e4",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphYWFhZTRkMGViZDVlZjM0ZDgxOTk3YTczYWI5ODM5YmE3YjRiOWU0",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-01-22T20:27:14Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2020-01-23T14:01:37Z"
      },
      "message": "test: Add p2p test for forcerelay permission",
      "tree": {
        "sha": "eee3d68bcd86e4822dae1a75baac2f6ead2a67be",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/eee3d68bcd86e4822dae1a75baac2f6ead2a67be"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/aaaae4d0ebd5ef34d81997a73ab9839ba7b4b9e4",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUgVhgwArOJhRE7FJuI/xLYbEDlB6n/gT2EWStNTsb+9gWM5CpUfExAhQSGIomaa\nPE1LERl5MqrSYBsKi6t2dCW61Pxnwlp+Pm6q31oAQoEjyKeBMvW93be3fam089TR\nu2OKqeQAhI+s+iaxIBevksH4ks3cR2cKLnqXdieUXTOvfjhve602Clykl7S1DIq4\npJvLvTlRYyIKM/u6FiDFXftBXObWDpx0r9m+b3aH+lh9guxw06PXsSNPHpJOUh8k\nkC7OoyhsCB4DpX59s5LXDQfHkSbEQKyhwQRfk61exFqMz0iwXIkZ2gn89zlb4IHn\nh9lXkYhYPIhL/nc5nNJ8stz2ujapSN6vsYe53+pS/k1JhqFmaPrz2T3up0hgN9cb\nAYV+Omo7N7cSdVAil7Wv3zKAp5D7281wDnrC/m3LxzpwLXL0n3Wa1dZ29VxMWC1B\nbu3ZbQPkgIXchx3C8JvCn1f66FW2CpCQOG5tBL5cGasqu+boh8c7GhlgSGAD1Dh1\nolDGxtbZ\n=ZpXm\n-----END PGP SIGNATURE-----",
        "payload": "tree eee3d68bcd86e4822dae1a75baac2f6ead2a67be\nparent fa6b57bcaaf4dc65d78316353033b03d171a3beb\nauthor MarcoFalke <falke.marco@gmail.com> 1579724834 -0500\ncommitter MarcoFalke <falke.marco@gmail.com> 1579788097 -0500\n\ntest: Add p2p test for forcerelay permission\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/aaaae4d0ebd5ef34d81997a73ab9839ba7b4b9e4",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/aaaae4d0ebd5ef34d81997a73ab9839ba7b4b9e4",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/aaaae4d0ebd5ef34d81997a73ab9839ba7b4b9e4/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fa6b57bcaaf4dc65d78316353033b03d171a3beb",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa6b57bcaaf4dc65d78316353033b03d171a3beb",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fa6b57bcaaf4dc65d78316353033b03d171a3beb"
      }
    ],
    "stats": {
      "total": 53,
      "additions": 52,
      "deletions": 1
    },
    "files": [
      {
        "sha": "93e2957fd0130d494197d1311080cf79ded1504a",
        "filename": "test/functional/p2p_permissions.py",
        "status": "modified",
        "additions": 50,
        "deletions": 1,
        "changes": 51,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/aaaae4d0ebd5ef34d81997a73ab9839ba7b4b9e4/test/functional/p2p_permissions.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/aaaae4d0ebd5ef34d81997a73ab9839ba7b4b9e4/test/functional/p2p_permissions.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/p2p_permissions.py?ref=aaaae4d0ebd5ef34d81997a73ab9839ba7b4b9e4",
        "patch": "@@ -7,21 +7,35 @@\n Test that permissions are correctly calculated and applied\n \"\"\"\n \n+from test_framework.address import ADDRESS_BCRT1_P2WSH_OP_TRUE\n+from test_framework.messages import (\n+    CTransaction,\n+    CTxInWitness,\n+    FromHex,\n+)\n+from test_framework.mininode import P2PDataStore\n+from test_framework.script import (\n+    CScript,\n+    OP_TRUE,\n+)\n from test_framework.test_node import ErrorMatch\n from test_framework.test_framework import BitcoinTestFramework\n from test_framework.util import (\n     assert_equal,\n     connect_nodes,\n     p2p_port,\n+    wait_until,\n )\n \n+\n class P2PPermissionsTests(BitcoinTestFramework):\n     def set_test_params(self):\n         self.num_nodes = 2\n         self.setup_clean_chain = True\n-        self.extra_args = [[],[]]\n \n     def run_test(self):\n+        self.check_tx_relay()\n+\n         self.checkpermission(\n             # default permissions (no specific permissions)\n             [\"-whitelist=127.0.0.1\"],\n@@ -83,6 +97,41 @@ def run_test(self):\n         self.nodes[1].assert_start_raises_init_error([\"-whitelist=noban@127.0.0.1:230\"], \"Invalid netmask specified in\", match=ErrorMatch.PARTIAL_REGEX)\n         self.nodes[1].assert_start_raises_init_error([\"-whitebind=noban@127.0.0.1/10\"], \"Cannot resolve -whitebind address\", match=ErrorMatch.PARTIAL_REGEX)\n \n+    def check_tx_relay(self):\n+        block_op_true = self.nodes[0].getblock(self.nodes[0].generatetoaddress(100, ADDRESS_BCRT1_P2WSH_OP_TRUE)[0])\n+        self.sync_all()\n+\n+        self.log.debug(\"Create a connection from a whitelisted wallet that rebroadcasts raw txs\")\n+        # A python mininode is needed to send the raw transaction directly. If a full node was used, it could only\n+        # rebroadcast via the inv-getdata mechanism. However, even for whitelisted connections, a full node would\n+        # currently not request a txid that is already in the mempool.\n+        self.restart_node(1, extra_args=[\"-whitelist=forcerelay@127.0.0.1\"])\n+        p2p_rebroadcast_wallet = self.nodes[1].add_p2p_connection(P2PDataStore())\n+\n+        self.log.debug(\"Send a tx from the wallet initially\")\n+        tx = FromHex(\n+            CTransaction(),\n+            self.nodes[0].createrawtransaction(\n+                inputs=[{\n+                    'txid': block_op_true['tx'][0],\n+                    'vout': 0,\n+                }], outputs=[{\n+                    ADDRESS_BCRT1_P2WSH_OP_TRUE: 5,\n+                }]),\n+        )\n+        tx.wit.vtxinwit = [CTxInWitness()]\n+        tx.wit.vtxinwit[0].scriptWitness.stack = [CScript([OP_TRUE])]\n+        txid = tx.rehash()\n+\n+        self.log.debug(\"Wait until tx is in node[1]'s mempool\")\n+        p2p_rebroadcast_wallet.send_txs_and_test([tx], self.nodes[1])\n+\n+        self.log.debug(\"Check that node[1] will send the tx to node[0] even though it is already in the mempool\")\n+        connect_nodes(self.nodes[1], 0)\n+        with self.nodes[1].assert_debug_log([\"Force relaying tx {} from whitelisted peer=0\".format(txid)]):\n+            p2p_rebroadcast_wallet.send_txs_and_test([tx], self.nodes[1])\n+            wait_until(lambda: txid in self.nodes[0].getrawmempool())\n+\n     def checkpermission(self, args, expectedPermissions, whitelisted):\n         self.restart_node(1, args)\n         connect_nodes(self.nodes[0], 1)"
      },
      {
        "sha": "6a7e91216a89f62f90e515f193ae72e71ec4b64e",
        "filename": "test/functional/test_framework/address.py",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/aaaae4d0ebd5ef34d81997a73ab9839ba7b4b9e4/test/functional/test_framework/address.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/aaaae4d0ebd5ef34d81997a73ab9839ba7b4b9e4/test/functional/test_framework/address.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/test_framework/address.py?ref=aaaae4d0ebd5ef34d81997a73ab9839ba7b4b9e4",
        "patch": "@@ -13,6 +13,8 @@\n \n ADDRESS_BCRT1_UNSPENDABLE = 'bcrt1qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq3xueyj'\n ADDRESS_BCRT1_UNSPENDABLE_DESCRIPTOR = 'addr(bcrt1qqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq3xueyj)#juyq9d97'\n+# Coins sent to this address can be spent with a witness stack of just OP_TRUE\n+ADDRESS_BCRT1_P2WSH_OP_TRUE = 'bcrt1qft5p2uhsdcdc3l2ua4ap5qqfg4pjaqlp250x7us7a8qqhrxrxfsqseac85'\n \n \n class AddressType(enum.Enum):"
      }
    ]
  }
]