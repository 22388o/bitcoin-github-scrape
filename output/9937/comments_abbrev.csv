sipa,2017-03-07T08:54:23Z,concept ACK,https://github.com/bitcoin/bitcoin/pull/9937#issuecomment-284660032,284660032,
jonasschnelli,2017-03-07T08:55:08Z,"Important fix.\nutACK 1307cd79b859f01a35d68dea9a674e56451f75f5.\nIMO this is a backport candidate.",https://github.com/bitcoin/bitcoin/pull/9937#issuecomment-284660205,284660205,
MarcoFalke,2017-03-07T09:01:03Z,utACK 1307cd79b859f01a35d68dea9a674e56451f75f5,https://github.com/bitcoin/bitcoin/pull/9937#issuecomment-284661445,284661445,
paveljanik,2017-03-07T09:10:19Z,The change as written now allows to test the existence of any file.,https://github.com/bitcoin/bitcoin/pull/9937#issuecomment-284663604,284663604,
gmaxwell,2017-03-07T09:18:03Z,"only downside I see to this is an in automated backup that leaves files behind, your backup will stop and you might not notice. (I think that is a preferable failure mode to what we have now)",https://github.com/bitcoin/bitcoin/pull/9937#issuecomment-284665410,284665410,
laanwj,2017-03-07T09:24:16Z,"> The change as written now allows to test the existence of any file.\n\nThat seems preferable to overwriting any file, right? I tend to agree that being able to write arbitrary non-existing files is still a security risk, but it is tons better than what we have now.\n\nDo you have a suggestion that would avoid this usage but still offers the same functionality?\n\n> only downside I see to t",https://github.com/bitcoin/bitcoin/pull/9937#issuecomment-284666868,284666868,
laanwj,2017-03-07T09:31:09Z,"Updated the RPC help, too.",https://github.com/bitcoin/bitcoin/pull/9937#issuecomment-284668539,284668539,
laanwj,2017-03-07T09:39:53Z,"> Do you have a suggestion that would avoid this usage but still offers the same functionality?\n\nWe could make the check even stricter, only allowing writing of files within the data directory, or even better a `dumpwallet` directory within the data directory. It could even come up with its own unique filename and return that (e.g. #9740). But that has a much larger impact to the API. Could do",https://github.com/bitcoin/bitcoin/pull/9937#issuecomment-284670591,284670591,
paveljanik,2017-03-07T10:05:18Z,"What about this: if there is a file already present, add a timestamp to the file name and save.",https://github.com/bitcoin/bitcoin/pull/9937#issuecomment-284677064,284677064,
laanwj,2017-03-07T10:14:23Z,Yeah that could work...,https://github.com/bitcoin/bitcoin/pull/9937#issuecomment-284679259,284679259,
laanwj,2017-03-07T10:14:48Z,"Closing this, feel free to implement a different solution, have no time for this at the moment.",https://github.com/bitcoin/bitcoin/pull/9937#issuecomment-284679358,284679358,
laanwj,2017-09-22T11:45:06Z,"Reopening this and rebasing, I think this is basically a good fix, and was closed for unimportant concerns (compared to the problem it solves), and no one picked it up subsequently.",https://github.com/bitcoin/bitcoin/pull/9937#issuecomment-331425065,331425065,
sdaftuar,2017-09-22T13:15:00Z,Concept ACK,https://github.com/bitcoin/bitcoin/pull/9937#issuecomment-331443245,331443245,
promag,2017-09-22T14:03:03Z,"And there is also the option to make the filename optional, where the default value is `/some/base/path/ + wallet-name + some-timestamp + .extension` and return the filename.",https://github.com/bitcoin/bitcoin/pull/9937#issuecomment-331455749,331455749,
laanwj,2017-09-26T14:07:51Z,"> And there is also the option to make the filename optional, where the default value is /some/base/path/ + wallet-name + some-timestamp + .extension and return the filename.\n\nYes, many other things are possible. I'm not going to do that here. That's the reason I closed this before. **However** I only want to solve the overwrite problem here, which is not solved by making up filenames, only by",https://github.com/bitcoin/bitcoin/pull/9937#issuecomment-332209877,332209877,
jnewbery,2017-09-26T14:31:29Z,Tested ACK 0cd9273fd959c6742574259d026039f7da0309a2,https://github.com/bitcoin/bitcoin/pull/9937#issuecomment-332217557,332217557,
jnewbery,2017-09-26T14:59:10Z,"Requires release notes (although this is fixing up undefined behaviour, there may be users who currently rely on that behaviour)",https://github.com/bitcoin/bitcoin/pull/9937#issuecomment-332226814,332226814,
laanwj,2017-10-04T13:00:41Z,"> Requires release notes (although this is fixing up undefined behaviour, there may be users who currently rely on that behaviour)\n\nA release notes change is already part of the PR.",https://github.com/bitcoin/bitcoin/pull/9937#issuecomment-334147243,334147243,
MarcoFalke,2017-10-04T13:14:45Z,@laanwj I also pushed this to the backports pull for 0.15.1,https://github.com/bitcoin/bitcoin/pull/9937#issuecomment-334151031,334151031,
promag,2017-09-22T12:48:23Z,"What if a `dumpwallet` is executed after this check with the same filename, or the filename is created by other means? IMO we should use `fopen` with `wx` mode where `x` stands for:\n\n> File access mode flag ""x"" can optionally be appended to ""w"" or ""w+"" specifiers. This flag forces the function to fail if the file exists, instead of overwriting it. (C11)\n\nand drop `exists()` test.",https://github.com/bitcoin/bitcoin/pull/9937#discussion_r140484284,140484284,src/wallet/rpcdump.cpp
jnewbery,2017-09-22T15:02:52Z,"This help text is misleading. The relative path is relative to the directory from where bitcoind was started.\n\n(really I think we should disallow relative paths entirely unless they're relative to some fixed point like the datadir)",https://github.com/bitcoin/bitcoin/pull/9937#discussion_r140517632,140517632,src/wallet/rpcdump.cpp
jnewbery,2017-09-22T15:02:56Z,nit: I don't think this needs such a long comment. Just say we don't allow files to be overwritten for safety.,https://github.com/bitcoin/bitcoin/pull/9937#discussion_r140517655,140517655,src/wallet/rpcdump.cpp
jnewbery,2017-09-22T15:02:59Z,`filename` should be `filepath`?,https://github.com/bitcoin/bitcoin/pull/9937#discussion_r140517669,140517669,src/wallet/rpcdump.cpp
laanwj,2017-09-26T14:07:44Z,"I agree relative paths should ideally be relative to the datadir (or refused altogether - at the least we should be **consistent** about them). However I am not changing that functionality here, and am also not touching this comment here.",https://github.com/bitcoin/bitcoin/pull/9937#discussion_r141067046,141067046,src/wallet/rpcdump.cpp
laanwj,2017-09-26T14:08:06Z,"Meh, better too long than too short.",https://github.com/bitcoin/bitcoin/pull/9937#discussion_r141067152,141067152,src/wallet/rpcdump.cpp
laanwj,2017-09-26T14:09:11Z,"I'm not terribly worried about race conditions here, just about overwriting existing files such as the wallet.",https://github.com/bitcoin/bitcoin/pull/9937#discussion_r141067466,141067466,src/wallet/rpcdump.cpp
laanwj,2017-09-26T14:09:22Z,"Yes, that'd make sense.",https://github.com/bitcoin/bitcoin/pull/9937#discussion_r141067528,141067528,src/wallet/rpcdump.cpp
promag,2017-09-26T14:26:41Z,"Yes, the comment should have paranoia label..",https://github.com/bitcoin/bitcoin/pull/9937#discussion_r141073024,141073024,src/wallet/rpcdump.cpp
