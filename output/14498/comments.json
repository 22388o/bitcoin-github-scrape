[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430488232",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14498#issuecomment-430488232",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14498",
    "id": 430488232,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMDQ4ODIzMg==",
    "user": {
      "login": "NicolasDorier",
      "id": 3020646,
      "node_id": "MDQ6VXNlcjMwMjA2NDY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3020646?u=256d78207f88d303d61b62060a309657276cf6cb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/NicolasDorier",
      "html_url": "https://github.com/NicolasDorier",
      "followers_url": "https://api.github.com/users/NicolasDorier/followers",
      "following_url": "https://api.github.com/users/NicolasDorier/following{/other_user}",
      "gists_url": "https://api.github.com/users/NicolasDorier/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/NicolasDorier/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/NicolasDorier/subscriptions",
      "organizations_url": "https://api.github.com/users/NicolasDorier/orgs",
      "repos_url": "https://api.github.com/users/NicolasDorier/repos",
      "events_url": "https://api.github.com/users/NicolasDorier/events{/privacy}",
      "received_events_url": "https://api.github.com/users/NicolasDorier/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-17T04:47:28Z",
    "updated_at": "2018-10-17T04:47:28Z",
    "author_association": "CONTRIBUTOR",
    "body": "Concept ACK I needed that long ago.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430488232/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430513379",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14498#issuecomment-430513379",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14498",
    "id": 430513379,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMDUxMzM3OQ==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-17T07:03:18Z",
    "updated_at": "2018-10-17T07:03:18Z",
    "author_association": "MEMBER",
    "body": "NACK, transactions don't have from addresses in the model our wallet exposes.\r\n\r\nIt may make sense to have a separate simpler transaction watcher, which is similar to the wallet, but doesn't have all the accounting logic. However, for our current wallet, I believe this is feature creep and confusing.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430513379/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430533065",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14498#issuecomment-430533065",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14498",
    "id": 430533065,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMDUzMzA2NQ==",
    "user": {
      "login": "rodentrabies",
      "id": 7646953,
      "node_id": "MDQ6VXNlcjc2NDY5NTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7646953?u=0f8ba0e87c0f4ca2738675377da8a0982d13d923&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rodentrabies",
      "html_url": "https://github.com/rodentrabies",
      "followers_url": "https://api.github.com/users/rodentrabies/followers",
      "following_url": "https://api.github.com/users/rodentrabies/following{/other_user}",
      "gists_url": "https://api.github.com/users/rodentrabies/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rodentrabies/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rodentrabies/subscriptions",
      "organizations_url": "https://api.github.com/users/rodentrabies/orgs",
      "repos_url": "https://api.github.com/users/rodentrabies/repos",
      "events_url": "https://api.github.com/users/rodentrabies/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rodentrabies/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-17T08:13:45Z",
    "updated_at": "2018-10-17T08:13:45Z",
    "author_association": "CONTRIBUTOR",
    "body": "Fair point on feature creep:) I opened this more as a continuation of discussion in #10599 than as a new feature to merge, so please close the PR if there are no strong arguments for this.\r\n\r\nBy a separate simpler transaction watcher you mean a part of core or an external tool?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/430533065/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431566477",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14498#issuecomment-431566477",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14498",
    "id": 431566477,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMTU2NjQ3Nw==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-20T09:54:21Z",
    "updated_at": "2018-10-20T09:54:21Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->Reviewers, this pull request conflicts with the following ones:\n\n* #14437 (Refactor: Start to separate wallet from node by ryanofsky)\n* #11634 (wallet: Add missing cs_wallet/cs_KeyStore locks to wallet by practicalswift)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/431566477/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/432587640",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14498#issuecomment-432587640",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14498",
    "id": 432587640,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMjU4NzY0MA==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-24T09:40:03Z",
    "updated_at": "2018-10-24T09:40:03Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/432587640/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/435692904",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14498#issuecomment-435692904",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14498",
    "id": 435692904,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNTY5MjkwNA==",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?u=4a9af998e1a560b3f49c3827f453e1bcbe6a5cfb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-04T18:18:22Z",
    "updated_at": "2018-11-04T18:18:22Z",
    "author_association": "MEMBER",
    "body": "@mrwhythat agree in closing?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/435692904/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/435694942",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14498#issuecomment-435694942",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14498",
    "id": 435694942,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNTY5NDk0Mg==",
    "user": {
      "login": "rodentrabies",
      "id": 7646953,
      "node_id": "MDQ6VXNlcjc2NDY5NTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7646953?u=0f8ba0e87c0f4ca2738675377da8a0982d13d923&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rodentrabies",
      "html_url": "https://github.com/rodentrabies",
      "followers_url": "https://api.github.com/users/rodentrabies/followers",
      "following_url": "https://api.github.com/users/rodentrabies/following{/other_user}",
      "gists_url": "https://api.github.com/users/rodentrabies/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rodentrabies/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rodentrabies/subscriptions",
      "organizations_url": "https://api.github.com/users/rodentrabies/orgs",
      "repos_url": "https://api.github.com/users/rodentrabies/repos",
      "events_url": "https://api.github.com/users/rodentrabies/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rodentrabies/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-04T18:44:43Z",
    "updated_at": "2018-11-04T18:44:43Z",
    "author_association": "CONTRIBUTOR",
    "body": "@promag, yup, closing.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/435694942/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225981161",
    "pull_request_review_id": 165694732,
    "id": 225981161,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNTk4MTE2MQ==",
    "diff_hunk": "@@ -1160,26 +1161,55 @@ static UniValue ListReceived(CWallet * const pwallet, const UniValue& params, bo\n         if (nDepth < nMinDepth)\n             continue;\n \n-        for (const CTxOut& txout : wtx.tx->vout)\n+        if (received)\n         {\n-            CTxDestination address;\n-            if (!ExtractDestination(txout.scriptPubKey, address))\n-                continue;\n+            for (const CTxOut& txout : wtx.tx->vout)\n+            {\n+                CTxDestination address;\n+                if (!ExtractDestination(txout.scriptPubKey, address))\n+                    continue;\n+\n+                if (has_filtered_address && !(filtered_address == address)) {\n+                    continue;\n+                }\n+\n+                isminefilter mine = IsMine(*pwallet, address);\n+                if(!(mine & filter))\n+                    continue;\n \n-            if (has_filtered_address && !(filtered_address == address)) {\n-                continue;\n+                tallyitem& item = mapTally[address];\n+                item.nAmount += txout.nValue;\n+                item.nConf = std::min(item.nConf, nDepth);\n+                item.txids.push_back(wtx.GetHash());\n+                if (mine & ISMINE_WATCH_ONLY)\n+                    item.fIsWatchonly = true;\n             }\n+        }\n+        else\n+        {\n+            for (const CTxIn& txin : wtx.tx->vin)\n+            {\n+                const COutPoint& prevout = txin.prevout;\n+                const CTxOut& txout = pwallet->GetWalletTx(prevout.hash)->tx->vout[prevout.n];",
    "path": "src/wallet/rpcwallet.cpp",
    "position": 49,
    "original_position": 49,
    "commit_id": "afd2f777bdb1ff795396c33382fe5b93ce179594",
    "original_commit_id": "afd2f777bdb1ff795396c33382fe5b93ce179594",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Are you sure about this?",
    "created_at": "2018-10-17T15:28:19Z",
    "updated_at": "2018-10-17T15:28:20Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14498#discussion_r225981161",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14498",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225981161"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14498#discussion_r225981161"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14498"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/225981161/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1193,
    "original_line": 1193,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226023665",
    "pull_request_review_id": 165747519,
    "id": 226023665,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNjAyMzY2NQ==",
    "diff_hunk": "@@ -1160,26 +1161,55 @@ static UniValue ListReceived(CWallet * const pwallet, const UniValue& params, bo\n         if (nDepth < nMinDepth)\n             continue;\n \n-        for (const CTxOut& txout : wtx.tx->vout)\n+        if (received)\n         {\n-            CTxDestination address;\n-            if (!ExtractDestination(txout.scriptPubKey, address))\n-                continue;\n+            for (const CTxOut& txout : wtx.tx->vout)\n+            {\n+                CTxDestination address;\n+                if (!ExtractDestination(txout.scriptPubKey, address))\n+                    continue;\n+\n+                if (has_filtered_address && !(filtered_address == address)) {\n+                    continue;\n+                }\n+\n+                isminefilter mine = IsMine(*pwallet, address);\n+                if(!(mine & filter))\n+                    continue;\n \n-            if (has_filtered_address && !(filtered_address == address)) {\n-                continue;\n+                tallyitem& item = mapTally[address];\n+                item.nAmount += txout.nValue;\n+                item.nConf = std::min(item.nConf, nDepth);\n+                item.txids.push_back(wtx.GetHash());\n+                if (mine & ISMINE_WATCH_ONLY)\n+                    item.fIsWatchonly = true;\n             }\n+        }\n+        else\n+        {\n+            for (const CTxIn& txin : wtx.tx->vin)\n+            {\n+                const COutPoint& prevout = txin.prevout;\n+                const CTxOut& txout = pwallet->GetWalletTx(prevout.hash)->tx->vout[prevout.n];",
    "path": "src/wallet/rpcwallet.cpp",
    "position": 49,
    "original_position": 49,
    "commit_id": "afd2f777bdb1ff795396c33382fe5b93ce179594",
    "original_commit_id": "afd2f777bdb1ff795396c33382fe5b93ce179594",
    "user": {
      "login": "rodentrabies",
      "id": 7646953,
      "node_id": "MDQ6VXNlcjc2NDY5NTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7646953?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rodentrabies",
      "html_url": "https://github.com/rodentrabies",
      "followers_url": "https://api.github.com/users/rodentrabies/followers",
      "following_url": "https://api.github.com/users/rodentrabies/following{/other_user}",
      "gists_url": "https://api.github.com/users/rodentrabies/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rodentrabies/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rodentrabies/subscriptions",
      "organizations_url": "https://api.github.com/users/rodentrabies/orgs",
      "repos_url": "https://api.github.com/users/rodentrabies/repos",
      "events_url": "https://api.github.com/users/rodentrabies/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rodentrabies/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Well, after @sipa's comment I'm not sure about this PR in general, but I adapted some tests from `rpc_listreceivedby.py` and it seems to be working. I may be missing something deep here though.",
    "created_at": "2018-10-17T17:24:39Z",
    "updated_at": "2018-10-17T17:24:39Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14498#discussion_r226023665",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14498",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226023665"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14498#discussion_r226023665"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14498"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226023665/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1193,
    "original_line": 1193,
    "side": "RIGHT",
    "in_reply_to_id": 225981161
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226136385",
    "pull_request_review_id": 165886832,
    "id": 226136385,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNjEzNjM4NQ==",
    "diff_hunk": "@@ -1160,26 +1161,55 @@ static UniValue ListReceived(CWallet * const pwallet, const UniValue& params, bo\n         if (nDepth < nMinDepth)\n             continue;\n \n-        for (const CTxOut& txout : wtx.tx->vout)\n+        if (received)\n         {\n-            CTxDestination address;\n-            if (!ExtractDestination(txout.scriptPubKey, address))\n-                continue;\n+            for (const CTxOut& txout : wtx.tx->vout)\n+            {\n+                CTxDestination address;\n+                if (!ExtractDestination(txout.scriptPubKey, address))\n+                    continue;\n+\n+                if (has_filtered_address && !(filtered_address == address)) {\n+                    continue;\n+                }\n+\n+                isminefilter mine = IsMine(*pwallet, address);\n+                if(!(mine & filter))\n+                    continue;\n \n-            if (has_filtered_address && !(filtered_address == address)) {\n-                continue;\n+                tallyitem& item = mapTally[address];\n+                item.nAmount += txout.nValue;\n+                item.nConf = std::min(item.nConf, nDepth);\n+                item.txids.push_back(wtx.GetHash());\n+                if (mine & ISMINE_WATCH_ONLY)\n+                    item.fIsWatchonly = true;\n             }\n+        }\n+        else\n+        {\n+            for (const CTxIn& txin : wtx.tx->vin)\n+            {\n+                const COutPoint& prevout = txin.prevout;\n+                const CTxOut& txout = pwallet->GetWalletTx(prevout.hash)->tx->vout[prevout.n];",
    "path": "src/wallet/rpcwallet.cpp",
    "position": 49,
    "original_position": 49,
    "commit_id": "afd2f777bdb1ff795396c33382fe5b93ce179594",
    "original_commit_id": "afd2f777bdb1ff795396c33382fe5b93ce179594",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "There are no tests here. Anyway `CWallet::GetWalletTx` only returns wallet transactions and so this would fail when `wtx` in an incoming transaction.",
    "created_at": "2018-10-18T00:26:01Z",
    "updated_at": "2018-10-18T00:26:02Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14498#discussion_r226136385",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14498",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226136385"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14498#discussion_r226136385"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14498"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226136385/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1193,
    "original_line": 1193,
    "side": "RIGHT",
    "in_reply_to_id": 225981161
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226270456",
    "pull_request_review_id": 166048913,
    "id": 226270456,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNjI3MDQ1Ng==",
    "diff_hunk": "@@ -1160,26 +1161,55 @@ static UniValue ListReceived(CWallet * const pwallet, const UniValue& params, bo\n         if (nDepth < nMinDepth)\n             continue;\n \n-        for (const CTxOut& txout : wtx.tx->vout)\n+        if (received)\n         {\n-            CTxDestination address;\n-            if (!ExtractDestination(txout.scriptPubKey, address))\n-                continue;\n+            for (const CTxOut& txout : wtx.tx->vout)\n+            {\n+                CTxDestination address;\n+                if (!ExtractDestination(txout.scriptPubKey, address))\n+                    continue;\n+\n+                if (has_filtered_address && !(filtered_address == address)) {\n+                    continue;\n+                }\n+\n+                isminefilter mine = IsMine(*pwallet, address);\n+                if(!(mine & filter))\n+                    continue;\n \n-            if (has_filtered_address && !(filtered_address == address)) {\n-                continue;\n+                tallyitem& item = mapTally[address];\n+                item.nAmount += txout.nValue;\n+                item.nConf = std::min(item.nConf, nDepth);\n+                item.txids.push_back(wtx.GetHash());\n+                if (mine & ISMINE_WATCH_ONLY)\n+                    item.fIsWatchonly = true;\n             }\n+        }\n+        else\n+        {\n+            for (const CTxIn& txin : wtx.tx->vin)\n+            {\n+                const COutPoint& prevout = txin.prevout;\n+                const CTxOut& txout = pwallet->GetWalletTx(prevout.hash)->tx->vout[prevout.n];",
    "path": "src/wallet/rpcwallet.cpp",
    "position": 49,
    "original_position": 49,
    "commit_id": "afd2f777bdb1ff795396c33382fe5b93ce179594",
    "original_commit_id": "afd2f777bdb1ff795396c33382fe5b93ce179594",
    "user": {
      "login": "rodentrabies",
      "id": 7646953,
      "node_id": "MDQ6VXNlcjc2NDY5NTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7646953?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rodentrabies",
      "html_url": "https://github.com/rodentrabies",
      "followers_url": "https://api.github.com/users/rodentrabies/followers",
      "following_url": "https://api.github.com/users/rodentrabies/following{/other_user}",
      "gists_url": "https://api.github.com/users/rodentrabies/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rodentrabies/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rodentrabies/subscriptions",
      "organizations_url": "https://api.github.com/users/rodentrabies/orgs",
      "repos_url": "https://api.github.com/users/rodentrabies/repos",
      "events_url": "https://api.github.com/users/rodentrabies/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rodentrabies/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I assumed there's no need for tests since this got a NACK.\r\n\r\nI was going to check it with tests, but if I undersand it correctly, since we're interested only in wallet transactions, checking if result of `GetWalletTx` is non-`nullptr`would be enough? \r\n```suggestion\r\n                const CWalletTx* iwtx = pwallet->GetWalletTx(prevout.hash);\r\n                if (!iwtx) continue;\r\n                const CTxOut& txout = iwtx->tx->vout[prevout.n];\r\n```\r\nOr am I missing something again?\r\n",
    "created_at": "2018-10-18T11:38:29Z",
    "updated_at": "2018-10-18T11:38:29Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14498#discussion_r226270456",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14498",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226270456"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14498#discussion_r226270456"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14498"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226270456/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1193,
    "original_line": 1193,
    "side": "RIGHT",
    "in_reply_to_id": 225981161
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226273015",
    "pull_request_review_id": 166052343,
    "id": 226273015,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNjI3MzAxNQ==",
    "diff_hunk": "@@ -1160,26 +1161,55 @@ static UniValue ListReceived(CWallet * const pwallet, const UniValue& params, bo\n         if (nDepth < nMinDepth)\n             continue;\n \n-        for (const CTxOut& txout : wtx.tx->vout)\n+        if (received)\n         {\n-            CTxDestination address;\n-            if (!ExtractDestination(txout.scriptPubKey, address))\n-                continue;\n+            for (const CTxOut& txout : wtx.tx->vout)\n+            {\n+                CTxDestination address;\n+                if (!ExtractDestination(txout.scriptPubKey, address))\n+                    continue;\n+\n+                if (has_filtered_address && !(filtered_address == address)) {\n+                    continue;\n+                }\n+\n+                isminefilter mine = IsMine(*pwallet, address);\n+                if(!(mine & filter))\n+                    continue;\n \n-            if (has_filtered_address && !(filtered_address == address)) {\n-                continue;\n+                tallyitem& item = mapTally[address];\n+                item.nAmount += txout.nValue;\n+                item.nConf = std::min(item.nConf, nDepth);\n+                item.txids.push_back(wtx.GetHash());\n+                if (mine & ISMINE_WATCH_ONLY)\n+                    item.fIsWatchonly = true;\n             }\n+        }\n+        else\n+        {\n+            for (const CTxIn& txin : wtx.tx->vin)\n+            {\n+                const COutPoint& prevout = txin.prevout;\n+                const CTxOut& txout = pwallet->GetWalletTx(prevout.hash)->tx->vout[prevout.n];",
    "path": "src/wallet/rpcwallet.cpp",
    "position": 49,
    "original_position": 49,
    "commit_id": "afd2f777bdb1ff795396c33382fe5b93ce179594",
    "original_commit_id": "afd2f777bdb1ff795396c33382fe5b93ce179594",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think that is correct.",
    "created_at": "2018-10-18T11:48:57Z",
    "updated_at": "2018-10-18T12:04:31Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14498#discussion_r226273015",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14498",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226273015"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14498#discussion_r226273015"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14498"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226273015/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1193,
    "original_line": 1193,
    "side": "RIGHT",
    "in_reply_to_id": 225981161
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226274784",
    "pull_request_review_id": 166052343,
    "id": 226274784,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIyNjI3NDc4NA==",
    "diff_hunk": "@@ -1160,26 +1161,55 @@ static UniValue ListReceived(CWallet * const pwallet, const UniValue& params, bo\n         if (nDepth < nMinDepth)\n             continue;\n \n-        for (const CTxOut& txout : wtx.tx->vout)\n+        if (received)\n         {\n-            CTxDestination address;\n-            if (!ExtractDestination(txout.scriptPubKey, address))\n-                continue;\n+            for (const CTxOut& txout : wtx.tx->vout)\n+            {\n+                CTxDestination address;\n+                if (!ExtractDestination(txout.scriptPubKey, address))\n+                    continue;\n+\n+                if (has_filtered_address && !(filtered_address == address)) {\n+                    continue;\n+                }\n+\n+                isminefilter mine = IsMine(*pwallet, address);\n+                if(!(mine & filter))\n+                    continue;\n \n-            if (has_filtered_address && !(filtered_address == address)) {\n-                continue;\n+                tallyitem& item = mapTally[address];\n+                item.nAmount += txout.nValue;\n+                item.nConf = std::min(item.nConf, nDepth);\n+                item.txids.push_back(wtx.GetHash());\n+                if (mine & ISMINE_WATCH_ONLY)\n+                    item.fIsWatchonly = true;\n             }\n+        }\n+        else\n+        {\n+            for (const CTxIn& txin : wtx.tx->vin)\n+            {\n+                const COutPoint& prevout = txin.prevout;\n+                const CTxOut& txout = pwallet->GetWalletTx(prevout.hash)->tx->vout[prevout.n];\n+                CTxDestination address;\n+                if (!ExtractDestination(txout.scriptPubKey, address))\n+                    continue;\n+\n+                if (has_filtered_address && !(filtered_address == address)) {\n+                    continue;\n+                }\n \n-            isminefilter mine = IsMine(*pwallet, address);\n-            if(!(mine & filter))\n-                continue;\n+                isminefilter mine = IsMine(*pwallet, address);",
    "path": "src/wallet/rpcwallet.cpp",
    "position": 61,
    "original_position": 61,
    "commit_id": "afd2f777bdb1ff795396c33382fe5b93ce179594",
    "original_commit_id": "afd2f777bdb1ff795396c33382fe5b93ce179594",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This can be avoided when `has_filtered_address`:\r\n\r\nabove before the loop:\r\n```cpp\r\nconst isminefilter is_mine_filtered_address = has_filtered_address ? IsMine(*pwallet, filtered_address) : ISMINE_NO;\r\n```\r\nand here:\r\n```cpp\r\nisminefilter mine = has_filtered_address ? is_mine_filtered_address : IsMine(*pwallet, address);\r\n```",
    "created_at": "2018-10-18T11:55:41Z",
    "updated_at": "2018-10-18T12:07:13Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14498#discussion_r226274784",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14498",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226274784"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14498#discussion_r226274784"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14498"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/226274784/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1202,
    "original_line": 1202,
    "side": "RIGHT"
  }
]