[
  {
    "sha": "fa37116c820f6a84642d57ce709a5977fd5616c4",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYTM3MTE2YzgyMGY2YTg0NjQyZDU3Y2U3MDlhNTk3N2ZkNTYxNmM0",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-04-28T06:14:22Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-04-28T06:13:05Z"
      },
      "message": "test: Use self.send_addr_msg",
      "tree": {
        "sha": "638d411780d9aca581c3ebc5859029381ff6d659",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/638d411780d9aca581c3ebc5859029381ff6d659"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa37116c820f6a84642d57ce709a5977fd5616c4",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUj4XAwAw+r19siA/SB8ahh9i9jwQHNz2NGERaTVGlnmSka9lXVF8PKxptibrQ8M\nS1yfy/E6a9Kt8aIGua/bliQselmYsrEx6bMB4RER0yMMd2tHbd4CVV/ozVHpjc78\nO4+303V6hs4hep2UB7jeVkHrsWTJ7eVVg0ApQTGlkHOTJ96S4O8FAu4lFk2Z6eZt\n/aOmumFEZHc+ED2Yl4tSGjOnVB4aVuJuLiReXl9MXIdzxdU6pPpZAWwpBw3ABAy+\nW9ZM95P1EWE/sZBsS2wrrOLTlfDiGtwQDHHh09Hq2nzej0R1FILZmqeTk005qivI\ncnPEhNjs3DO/wU8JOkY5OzCd1aIHQKNKAyWk9zGcqoN1gasvM1Qo2hx269Xao7Ed\nbtdrxrqXNS2mpWZ0SOi9ataafX9sVhZQtAqKkbpH8xkSksprHusHCe6+Y+OQwUtX\nHNH2adpa+BXcvMOA2Ry2NtW2a4LI0mkzjAd5OXbOgwSI5QP+z9YjgOtVSJLmXyNp\nV05uFBsm\n=JoXw\n-----END PGP SIGNATURE-----",
        "payload": "tree 638d411780d9aca581c3ebc5859029381ff6d659\nparent 19a56d1519fb493c3e1bd5cad55360b6b80fa52b\nauthor MarcoFalke <falke.marco@gmail.com> 1619590462 +0200\ncommitter MarcoFalke <falke.marco@gmail.com> 1619590385 +0200\n\ntest: Use self.send_addr_msg\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa37116c820f6a84642d57ce709a5977fd5616c4",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fa37116c820f6a84642d57ce709a5977fd5616c4",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa37116c820f6a84642d57ce709a5977fd5616c4/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "19a56d1519fb493c3e1bd5cad55360b6b80fa52b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/19a56d1519fb493c3e1bd5cad55360b6b80fa52b",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/19a56d1519fb493c3e1bd5cad55360b6b80fa52b"
      }
    ],
    "stats": {
      "total": 5,
      "additions": 1,
      "deletions": 4
    },
    "files": [
      {
        "sha": "d07c1c2d76dae70721803eb43f60132298e0f2a7",
        "filename": "test/functional/p2p_addr_relay.py",
        "status": "modified",
        "additions": 1,
        "deletions": 4,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa37116c820f6a84642d57ce709a5977fd5616c4/test/functional/p2p_addr_relay.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa37116c820f6a84642d57ce709a5977fd5616c4/test/functional/p2p_addr_relay.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/p2p_addr_relay.py?ref=fa37116c820f6a84642d57ce709a5977fd5616c4",
        "patch": "@@ -203,10 +203,7 @@ def blocksonly_mode_tests(self):\n         self.log.info('Check that we relay address messages')\n         addr_source = self.nodes[0].add_p2p_connection(P2PInterface())\n         msg = self.setup_addr_msg(2)\n-        addr_source.send_and_ping(msg)\n-        self.mocktime += 5 * 60\n-        self.nodes[0].setmocktime(self.mocktime)\n-        full_outbound_peer.sync_with_ping()\n+        self.send_addr_msg(addr_source, msg, [full_outbound_peer])\n         assert_equal(full_outbound_peer.num_ipv4_received, 2)\n \n         self.nodes[0].disconnect_p2ps()"
      }
    ]
  },
  {
    "sha": "faa51ef4d33034f8c14cfd18f1c01c90883a1bb4",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYWE1MWVmNGQzMzAzNGY4YzE0Y2ZkMThmMWMwMWM5MDg4M2ExYmI0",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-04-27T11:32:23Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-04-28T06:16:29Z"
      },
      "message": "test: Fix intermittent issue in p2p_addr_relay.py",
      "tree": {
        "sha": "fc99d13079acbab38be723e68b3391b73371081f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/fc99d13079acbab38be723e68b3391b73371081f"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/faa51ef4d33034f8c14cfd18f1c01c90883a1bb4",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUg5nQwAu5exp4/0NlAs1K/Nwhh2kRyKqiJYJYV4I3qt+94wq2jTPYqniHMfZZ9k\ndlCtrKRCT4lqZcavKwv03NxrtfSKH883L4WJ5skXha7d2q+gQ+SQ77LyQ4O1g/ud\nNgYrPrtNl4DWBOQ7R958TLuzlzY1JcQichfQWZO5BoMr8PxnB6sGfKz03/lw/Fo6\nw0Cxm08Z759bq75UzJ5beRvliL0VNxdkFswNwuWiSRPPxpwEUf0BvoICIppLQOiP\n+LHcf1nJZIcG3gdxqdsxPdVknc0xn9CKE9UQXstC/GM18eyJ5AdAgz1WNwnzsw6B\nDo5YN8vn7KK2XuLAwCX4EldzZM2a+/+gvdf2TkQmHYDStrE9twtCxNCx/MBCA9jF\nCvKC5d10+JTHrqwQyZ3xC8lzQzwThOmbuL3AGQq8TgCB9jbF0zuYN5qgiXlGqPra\nDVW2kdWefuMQOYVNkmy4TjZLnXLMtTOv+jA3UUV3qEeoqvweqVkVn2HGkyGdk4vO\njVbDMqzW\n=/tgD\n-----END PGP SIGNATURE-----",
        "payload": "tree fc99d13079acbab38be723e68b3391b73371081f\nparent fa37116c820f6a84642d57ce709a5977fd5616c4\nauthor MarcoFalke <falke.marco@gmail.com> 1619523143 +0200\ncommitter MarcoFalke <falke.marco@gmail.com> 1619590589 +0200\n\ntest: Fix intermittent issue in p2p_addr_relay.py\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faa51ef4d33034f8c14cfd18f1c01c90883a1bb4",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/faa51ef4d33034f8c14cfd18f1c01c90883a1bb4",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/faa51ef4d33034f8c14cfd18f1c01c90883a1bb4/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fa37116c820f6a84642d57ce709a5977fd5616c4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa37116c820f6a84642d57ce709a5977fd5616c4",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fa37116c820f6a84642d57ce709a5977fd5616c4"
      }
    ],
    "stats": {
      "total": 21,
      "additions": 12,
      "deletions": 9
    },
    "files": [
      {
        "sha": "87297989baf7588fbeda1ed9e7d5f7cb9f2c2234",
        "filename": "test/functional/p2p_addr_relay.py",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faa51ef4d33034f8c14cfd18f1c01c90883a1bb4/test/functional/p2p_addr_relay.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faa51ef4d33034f8c14cfd18f1c01c90883a1bb4/test/functional/p2p_addr_relay.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/p2p_addr_relay.py?ref=faa51ef4d33034f8c14cfd18f1c01c90883a1bb4",
        "patch": "@@ -82,7 +82,7 @@ def send_addr_msg(self, source, msg, receivers):\n         self.mocktime += 5 * 60\n         self.nodes[0].setmocktime(self.mocktime)\n         for peer in receivers:\n-            peer.sync_with_ping()\n+            peer.sync_send_with_ping()\n \n     def oversized_addr_test(self):\n         self.log.info('Send an addr message that is too large')"
      },
      {
        "sha": "445cea6186db72466a56d0f0031d133be6e97595",
        "filename": "test/functional/p2p_blocksonly.py",
        "status": "modified",
        "additions": 1,
        "deletions": 5,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faa51ef4d33034f8c14cfd18f1c01c90883a1bb4/test/functional/p2p_blocksonly.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faa51ef4d33034f8c14cfd18f1c01c90883a1bb4/test/functional/p2p_blocksonly.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/p2p_blocksonly.py?ref=faa51ef4d33034f8c14cfd18f1c01c90883a1bb4",
        "patch": "@@ -89,11 +89,7 @@ def blocks_relay_conn_tests(self):\n         # Bump time forward to ensure nNextInvSend timer pops\n         self.nodes[0].setmocktime(int(time.time()) + 60)\n \n-        # Calling sync_with_ping twice requires that the node calls\n-        # `ProcessMessage` twice, and thus ensures `SendMessages` must have\n-        # been called at least once\n-        conn.sync_with_ping()\n-        conn.sync_with_ping()\n+        conn.sync_send_with_ping()\n         assert(int(txid, 16) not in conn.get_invs())\n \n     def check_p2p_tx_violation(self, index=1):"
      },
      {
        "sha": "359cfb9c346ef0d66c6920fba06ee0383dfda176",
        "filename": "test/functional/p2p_filter.py",
        "status": "modified",
        "additions": 1,
        "deletions": 2,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faa51ef4d33034f8c14cfd18f1c01c90883a1bb4/test/functional/p2p_filter.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faa51ef4d33034f8c14cfd18f1c01c90883a1bb4/test/functional/p2p_filter.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/p2p_filter.py?ref=faa51ef4d33034f8c14cfd18f1c01c90883a1bb4",
        "patch": "@@ -174,8 +174,7 @@ def test_filter(self, filter_peer):\n         filter_peer.merkleblock_received = False\n         filter_peer.tx_received = False\n         self.nodes[0].sendtoaddress(self.nodes[0].getnewaddress(), 90)\n-        filter_peer.sync_with_ping()\n-        filter_peer.sync_with_ping()\n+        filter_peer.sync_send_with_ping()\n         assert not filter_peer.merkleblock_received\n         assert not filter_peer.tx_received\n "
      },
      {
        "sha": "cc80b543cd74909187d108d6682722b3c06f59f7",
        "filename": "test/functional/test_framework/p2p.py",
        "status": "modified",
        "additions": 9,
        "deletions": 1,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/faa51ef4d33034f8c14cfd18f1c01c90883a1bb4/test/functional/test_framework/p2p.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/faa51ef4d33034f8c14cfd18f1c01c90883a1bb4/test/functional/test_framework/p2p.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/test_framework/p2p.py?ref=faa51ef4d33034f8c14cfd18f1c01c90883a1bb4",
        "patch": "@@ -539,8 +539,16 @@ def send_and_ping(self, message, timeout=60):\n         self.send_message(message)\n         self.sync_with_ping(timeout=timeout)\n \n-    # Sync up with the node\n+    def sync_send_with_ping(self, timeout=60):\n+        \"\"\"Ensure SendMessages is called on this connection\"\"\"\n+        # Calling sync_with_ping twice requires that the node calls\n+        # `ProcessMessage` twice, and thus ensures `SendMessages` must have\n+        # been called at least once\n+        self.sync_with_ping()\n+        self.sync_with_ping()\n+\n     def sync_with_ping(self, timeout=60):\n+        \"\"\"Ensure ProcessMessages is called on this connection\"\"\"\n         self.send_message(msg_ping(nonce=self.ping_counter))\n \n         def test_function():"
      }
    ]
  }
]