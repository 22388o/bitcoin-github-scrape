[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/326841655",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/11227#issuecomment-326841655",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/11227",
    "id": 326841655,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNjg0MTY1NQ==",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-04T00:16:34Z",
    "updated_at": "2017-09-04T00:16:34Z",
    "author_association": "MEMBER",
    "body": "I believe that the proxy_test failure is a false-positive.\r\n\r\nLooks like the issue is that disconnection happens so quickly now after an error that the testnode fails.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/326841655/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/327315068",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/11227#issuecomment-327315068",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/11227",
    "id": 327315068,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMyNzMxNTA2OA==",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-09-05T21:56:02Z",
    "updated_at": "2017-09-05T21:56:02Z",
    "author_association": "MEMBER",
    "body": "Concept ACK, woohoo!",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/327315068/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/337731082",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/11227#issuecomment-337731082",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/11227",
    "id": 337731082,
    "node_id": "MDEyOklzc3VlQ29tbWVudDMzNzczMTA4Mg==",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?u=4a9af998e1a560b3f49c3827f453e1bcbe6a5cfb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2017-10-18T21:19:35Z",
    "updated_at": "2017-10-18T21:19:35Z",
    "author_association": "MEMBER",
    "body": "Needs rebase.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/337731082/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/437192644",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/11227#issuecomment-437192644",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/11227",
    "id": 437192644,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNzE5MjY0NA==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-08T23:20:41Z",
    "updated_at": "2018-11-08T23:20:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--5fd3d806e98f4a0ca80977bb178665a0-->There hasn't been much activity lately and the patch still needs rebase, so I am closing this for now. Please let me know when you want to continue working on this, so the pull request can be re-opened.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/437192644/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136741410",
    "pull_request_review_id": 60320773,
    "id": 136741410,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEzNjc0MTQxMA==",
    "diff_hunk": "@@ -454,7 +454,7 @@ void CConnman::DumpBanlist()\n \n void CNode::CloseSocketDisconnect()\n {\n-    fDisconnect = true;\n+    Disconnect();",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "77cee166e17e355306d2ca1a1d360e71c12d8350",
    "original_commit_id": "82625c5a40e9698b509a926ec0bd6a5a9c93cf68",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It looks like this could be a scripted diff, `s/fDisconnect = true/Disconnect()/g`.",
    "created_at": "2017-09-04T04:07:32Z",
    "updated_at": "2017-09-20T20:41:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r136741410",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136741410"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r136741410"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136741410/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 457,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136750497",
    "pull_request_review_id": 60320773,
    "id": 136750497,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEzNjc1MDQ5Nw==",
    "diff_hunk": "@@ -914,12 +914,7 @@ size_t CConnman::SocketSendData(CNode *pnode) const\n     while (it != pnode->vSendMsg.end()) {\n         const auto &data = *it;\n         assert(data.size() > pnode->nSendOffset);\n-        int nBytes = 0;\n-        {\n-            if (pnode->hSocket == INVALID_SOCKET)",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "77cee166e17e355306d2ca1a1d360e71c12d8350",
    "original_commit_id": "f7ff0a794fbdc9cd744de8e8d41e5081567cadce",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This test is no longer needed?",
    "created_at": "2017-09-04T06:20:24Z",
    "updated_at": "2017-12-30T11:11:25Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r136750497",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136750497"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r136750497"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136750497/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 875,
    "side": "LEFT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136752250",
    "pull_request_review_id": 60320773,
    "id": 136752250,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEzNjc1MjI1MA==",
    "diff_hunk": "@@ -1205,11 +1302,14 @@ void CConnman::AcceptConnection(const SOCKET& listen_socket, bool whitelisted) {\n         return;\n     }\n \n-    if (!IsSelectableSocket(hSocket))\n-    {\n-        LogPrintf(\"connection from %s dropped: non-selectable socket\\n\", addr.ToString());\n-        CloseSocket(hSocket);\n-        return;\n+    const char* method = event_base_get_method(m_event_base);\n+    if (!method || (strncmp(method, \"select\", 6) == 0)) {",
    "path": "src/net.cpp",
    "position": 650,
    "original_position": 221,
    "commit_id": "77cee166e17e355306d2ca1a1d360e71c12d8350",
    "original_commit_id": "fa64f69c37f9ea3aee77ccad0cca8a13ec802fa6",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Heh, I'd have hoped that this restriction wouldn't be needed anymore with libevent.",
    "created_at": "2017-09-04T06:37:05Z",
    "updated_at": "2017-12-30T11:11:25Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r136752250",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136752250"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r136752250"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136752250/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1400,
    "original_line": 1400,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136756884",
    "pull_request_review_id": 60320773,
    "id": 136756884,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEzNjc1Njg4NA==",
    "diff_hunk": "@@ -2397,6 +2370,9 @@ bool CConnman::Start(CScheduler& scheduler, const Options& connOptions)\n         LOCK(m_cs_interrupt_event);\n         m_interrupt_event = event_new(m_event_base, -1, 0, [](evutil_socket_t, short, void* data) {static_cast<CConnman*>(data)->InterruptEvents();}, (this));\n     }\n+    m_event_timeout = timeval{60, 0};\n+    const timeval* common_timeout = event_base_init_common_timeout(m_event_base, &m_event_timeout);\n+    memcpy(&m_event_timeout, common_timeout, sizeof(m_event_timeout));",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 514,
    "commit_id": "77cee166e17e355306d2ca1a1d360e71c12d8350",
    "original_commit_id": "fa64f69c37f9ea3aee77ccad0cca8a13ec802fa6",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The documentation on `event_base_init_common_timeout` says \"To do this, call this function with the common duration. It will return a pointer to a different, opaque timeout value. (Don't depend on its actual contents!)\".\r\n\r\nI'm not sure whether that means you need to use the exact pointer returned, or just a copy of its value (as this code does).",
    "created_at": "2017-09-04T07:16:31Z",
    "updated_at": "2017-09-20T20:41:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r136756884",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136756884"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r136756884"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136756884/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2491,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136757653",
    "pull_request_review_id": 60320773,
    "id": 136757653,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEzNjc1NzY1Mw==",
    "diff_hunk": "@@ -456,7 +471,14 @@ void CConnman::DumpBanlist()\n \n void CNode::CloseSocketDisconnect()\n {\n-    Disconnect();\n+    if (m_write_event) {",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 34,
    "commit_id": "77cee166e17e355306d2ca1a1d360e71c12d8350",
    "original_commit_id": "fa64f69c37f9ea3aee77ccad0cca8a13ec802fa6",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I would prefer it if you could have some RAII wrappers around the libevent structures before adding all this.",
    "created_at": "2017-09-04T07:22:11Z",
    "updated_at": "2017-09-20T20:41:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r136757653",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136757653"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r136757653"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136757653/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 526,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136792970",
    "pull_request_review_id": 60380058,
    "id": 136792970,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEzNjc5Mjk3MA==",
    "diff_hunk": "@@ -454,7 +454,7 @@ void CConnman::DumpBanlist()\n \n void CNode::CloseSocketDisconnect()\n {\n-    fDisconnect = true;\n+    Disconnect();",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "77cee166e17e355306d2ca1a1d360e71c12d8350",
    "original_commit_id": "82625c5a40e9698b509a926ec0bd6a5a9c93cf68",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Probably so, will give it a shot.",
    "created_at": "2017-09-04T10:34:46Z",
    "updated_at": "2017-09-20T20:41:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r136792970",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136792970"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r136792970"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136792970/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 457,
    "side": "RIGHT",
    "in_reply_to_id": 136741410
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136793387",
    "pull_request_review_id": 60380520,
    "id": 136793387,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEzNjc5MzM4Nw==",
    "diff_hunk": "@@ -914,12 +914,7 @@ size_t CConnman::SocketSendData(CNode *pnode) const\n     while (it != pnode->vSendMsg.end()) {\n         const auto &data = *it;\n         assert(data.size() > pnode->nSendOffset);\n-        int nBytes = 0;\n-        {\n-            if (pnode->hSocket == INVALID_SOCKET)",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "77cee166e17e355306d2ca1a1d360e71c12d8350",
    "original_commit_id": "f7ff0a794fbdc9cd744de8e8d41e5081567cadce",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I believe all of these are gone by the end of the change set, the removal may make more sense in an earlier commit, though.",
    "created_at": "2017-09-04T10:37:08Z",
    "updated_at": "2017-12-30T11:11:25Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r136793387",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136793387"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r136793387"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136793387/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 875,
    "side": "LEFT",
    "in_reply_to_id": 136750497
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136793461",
    "pull_request_review_id": 60380578,
    "id": 136793461,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEzNjc5MzQ2MQ==",
    "diff_hunk": "@@ -456,7 +471,14 @@ void CConnman::DumpBanlist()\n \n void CNode::CloseSocketDisconnect()\n {\n-    Disconnect();\n+    if (m_write_event) {",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 34,
    "commit_id": "77cee166e17e355306d2ca1a1d360e71c12d8350",
    "original_commit_id": "fa64f69c37f9ea3aee77ccad0cca8a13ec802fa6",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Agreed, see PR description :)",
    "created_at": "2017-09-04T10:37:29Z",
    "updated_at": "2017-09-20T20:41:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r136793461",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136793461"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r136793461"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136793461/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 526,
    "side": "RIGHT",
    "in_reply_to_id": 136757653
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136793635",
    "pull_request_review_id": 60380818,
    "id": 136793635,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEzNjc5MzYzNQ==",
    "diff_hunk": "@@ -1205,11 +1302,14 @@ void CConnman::AcceptConnection(const SOCKET& listen_socket, bool whitelisted) {\n         return;\n     }\n \n-    if (!IsSelectableSocket(hSocket))\n-    {\n-        LogPrintf(\"connection from %s dropped: non-selectable socket\\n\", addr.ToString());\n-        CloseSocket(hSocket);\n-        return;\n+    const char* method = event_base_get_method(m_event_base);\n+    if (!method || (strncmp(method, \"select\", 6) == 0)) {",
    "path": "src/net.cpp",
    "position": 650,
    "original_position": 221,
    "commit_id": "77cee166e17e355306d2ca1a1d360e71c12d8350",
    "original_commit_id": "fa64f69c37f9ea3aee77ccad0cca8a13ec802fa6",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It's only needed if select ends up being used, which should be very unlikely on most platforms. I'll add a comment here, and print something to the log so that it's clear which back-end is being used.",
    "created_at": "2017-09-04T10:38:44Z",
    "updated_at": "2017-12-30T11:11:25Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r136793635",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136793635"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r136793635"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136793635/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1400,
    "original_line": 1400,
    "side": "RIGHT",
    "in_reply_to_id": 136752250
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136794167",
    "pull_request_review_id": 60381406,
    "id": 136794167,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEzNjc5NDE2Nw==",
    "diff_hunk": "@@ -2397,6 +2370,9 @@ bool CConnman::Start(CScheduler& scheduler, const Options& connOptions)\n         LOCK(m_cs_interrupt_event);\n         m_interrupt_event = event_new(m_event_base, -1, 0, [](evutil_socket_t, short, void* data) {static_cast<CConnman*>(data)->InterruptEvents();}, (this));\n     }\n+    m_event_timeout = timeval{60, 0};\n+    const timeval* common_timeout = event_base_init_common_timeout(m_event_base, &m_event_timeout);\n+    memcpy(&m_event_timeout, common_timeout, sizeof(m_event_timeout));",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 514,
    "commit_id": "77cee166e17e355306d2ca1a1d360e71c12d8350",
    "original_commit_id": "fa64f69c37f9ea3aee77ccad0cca8a13ec802fa6",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Good eye! I wasn't sure how to store this properly either. This usage is taken from the official documentation. I'll add a comment about its sanity and a link to the docs.",
    "created_at": "2017-09-04T10:41:36Z",
    "updated_at": "2017-09-20T20:41:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r136794167",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136794167"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r136794167"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/136794167/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2491,
    "side": "RIGHT",
    "in_reply_to_id": 136756884
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137125533",
    "pull_request_review_id": 60752966,
    "id": 137125533,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEzNzEyNTUzMw==",
    "diff_hunk": "@@ -1205,11 +1302,14 @@ void CConnman::AcceptConnection(const SOCKET& listen_socket, bool whitelisted) {\n         return;\n     }\n \n-    if (!IsSelectableSocket(hSocket))\n-    {\n-        LogPrintf(\"connection from %s dropped: non-selectable socket\\n\", addr.ToString());\n-        CloseSocket(hSocket);\n-        return;\n+    const char* method = event_base_get_method(m_event_base);\n+    if (!method || (strncmp(method, \"select\", 6) == 0)) {",
    "path": "src/net.cpp",
    "position": 650,
    "original_position": 221,
    "commit_id": "77cee166e17e355306d2ca1a1d360e71c12d8350",
    "original_commit_id": "fa64f69c37f9ea3aee77ccad0cca8a13ec802fa6",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "We could just bail out if select is being used. But not sure what platforms would be affected.",
    "created_at": "2017-09-05T21:57:12Z",
    "updated_at": "2017-12-30T11:11:25Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r137125533",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137125533"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r137125533"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137125533/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1400,
    "original_line": 1400,
    "side": "RIGHT",
    "in_reply_to_id": 136752250
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137135950",
    "pull_request_review_id": 60733609,
    "id": 137135950,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEzNzEzNTk1MA==",
    "diff_hunk": "@@ -841,36 +872,126 @@ const uint256& CNetMessage::GetMessageHash() const\n \n \n \n+size_t CConnman::SocketReceiveData(CNode* pnode)\n+{\n+    // typical socket buffer is 8K-64K\n+    char pchBuf[0x10000];\n+    int nBytes = recv(pnode->hSocket, pchBuf, sizeof(pchBuf), MSG_DONTWAIT);\n+    if (nBytes > 0)\n+    {\n+        bool notify = false;\n+        if (!pnode->ReceiveMsgBytes(pchBuf, nBytes, notify))\n+            pnode->Disconnect();\n \n+        auto it(pnode->vRecvMsg.begin());\n+        size_t nSizeAdded = 0;\n+        {\n+            LOCK(pnode->cs_vRecv);\n+            int64_t nTimeMicros = GetTimeMicros();\n+            pnode->nLastRecv = nTimeMicros / 1000000;\n+            pnode->nRecvBytes += nBytes;\n+            if (notify) {\n+                for (; it != pnode->vRecvMsg.end(); ++it) {\n+                    const auto& msg = *it;\n+                    if (!msg.complete())\n+                        break;\n+                    nSizeAdded += msg.vRecv.size() + CMessageHeader::HEADER_SIZE;\n+                    mapMsgCmdSize::iterator mapit = pnode->mapRecvBytesPerMsgCmd.find(msg.hdr.pchCommand);\n+                    if (mapit == pnode->mapRecvBytesPerMsgCmd.end())\n+                        mapit = pnode->mapRecvBytesPerMsgCmd.find(NET_MESSAGE_COMMAND_OTHER);\n+                    assert(mapit != pnode->mapRecvBytesPerMsgCmd.end());\n+                    mapit->second += msg.vRecv.size() + CMessageHeader::HEADER_SIZE;\n+                }\n+            }\n+        }\n+        if (it != pnode->vRecvMsg.begin()) {\n+            LOCK(pnode->cs_vProcessMsg);\n+            pnode->vProcessMsg.splice(pnode->vProcessMsg.end(), pnode->vRecvMsg, pnode->vRecvMsg.begin(), it);\n+            pnode->nProcessQueueSize += nSizeAdded;\n+            if (pnode->nProcessQueueSize > nReceiveFloodSize) {\n+                LogPrint(BCLog::NET, \"Disabling receive due to oversized process queue of size: %lu. peer=%i\\n\", pnode->nProcessQueueSize, pnode->GetId());\n+                pnode->fPauseRecv = true;\n+                event_del(pnode->m_read_event);\n+            }\n \n+        }\n+        WakeMessageHandler();",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 164,
    "commit_id": "77cee166e17e355306d2ca1a1d360e71c12d8350",
    "original_commit_id": "7274a18dc3b438b090b1423fff442c760ae1c851",
    "user": {
      "login": "jimpo",
      "id": 881253,
      "node_id": "MDQ6VXNlcjg4MTI1Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/881253?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jimpo",
      "html_url": "https://github.com/jimpo",
      "followers_url": "https://api.github.com/users/jimpo/followers",
      "following_url": "https://api.github.com/users/jimpo/following{/other_user}",
      "gists_url": "https://api.github.com/users/jimpo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jimpo/subscriptions",
      "organizations_url": "https://api.github.com/users/jimpo/orgs",
      "repos_url": "https://api.github.com/users/jimpo/repos",
      "events_url": "https://api.github.com/users/jimpo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jimpo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Should this be moved into the above `if` block? (It used to be inside the `if (notify)` statement)",
    "created_at": "2017-09-05T23:00:14Z",
    "updated_at": "2017-09-20T20:41:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r137135950",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137135950"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r137135950"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137135950/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 918,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137138600",
    "pull_request_review_id": 60767227,
    "id": 137138600,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEzNzEzODYwMA==",
    "diff_hunk": "@@ -1150,7 +1150,7 @@ void CConnman::AcceptConnection(const ListenSocket& hListenSocket) {\n         }\n     }\n \n-    bool whitelisted = hListenSocket.whitelisted || IsWhitelistedRange(addr);\n+    whitelisted = whitelisted || IsWhitelistedRange(addr);",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 18,
    "commit_id": "77cee166e17e355306d2ca1a1d360e71c12d8350",
    "original_commit_id": "0d08cb3d896703d1435a3c2520635a1d79e7cf22",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> ||=\r\n\r\nI don't think such an operator exists in C++.",
    "created_at": "2017-09-05T23:18:10Z",
    "updated_at": "2017-09-20T20:41:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r137138600",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137138600"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r137138600"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137138600/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1321,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137139010",
    "pull_request_review_id": 60767653,
    "id": 137139010,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEzNzEzOTAxMA==",
    "diff_hunk": "@@ -1150,7 +1150,7 @@ void CConnman::AcceptConnection(const ListenSocket& hListenSocket) {\n         }\n     }\n \n-    bool whitelisted = hListenSocket.whitelisted || IsWhitelistedRange(addr);\n+    whitelisted = whitelisted || IsWhitelistedRange(addr);",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 18,
    "commit_id": "77cee166e17e355306d2ca1a1d360e71c12d8350",
    "original_commit_id": "0d08cb3d896703d1435a3c2520635a1d79e7cf22",
    "user": {
      "login": "jimpo",
      "id": 881253,
      "node_id": "MDQ6VXNlcjg4MTI1Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/881253?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jimpo",
      "html_url": "https://github.com/jimpo",
      "followers_url": "https://api.github.com/users/jimpo/followers",
      "following_url": "https://api.github.com/users/jimpo/following{/other_user}",
      "gists_url": "https://api.github.com/users/jimpo/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jimpo/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jimpo/subscriptions",
      "organizations_url": "https://api.github.com/users/jimpo/orgs",
      "repos_url": "https://api.github.com/users/jimpo/repos",
      "events_url": "https://api.github.com/users/jimpo/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jimpo/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Oops, you're right. Should have checked.",
    "created_at": "2017-09-05T23:21:19Z",
    "updated_at": "2017-09-20T20:41:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r137139010",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137139010"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r137139010"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137139010/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1321,
    "side": "RIGHT",
    "in_reply_to_id": 137138600
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137144026",
    "pull_request_review_id": 60773387,
    "id": 137144026,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEzNzE0NDAyNg==",
    "diff_hunk": "@@ -841,36 +872,126 @@ const uint256& CNetMessage::GetMessageHash() const\n \n \n \n+size_t CConnman::SocketReceiveData(CNode* pnode)\n+{\n+    // typical socket buffer is 8K-64K\n+    char pchBuf[0x10000];\n+    int nBytes = recv(pnode->hSocket, pchBuf, sizeof(pchBuf), MSG_DONTWAIT);\n+    if (nBytes > 0)\n+    {\n+        bool notify = false;\n+        if (!pnode->ReceiveMsgBytes(pchBuf, nBytes, notify))\n+            pnode->Disconnect();\n \n+        auto it(pnode->vRecvMsg.begin());\n+        size_t nSizeAdded = 0;\n+        {\n+            LOCK(pnode->cs_vRecv);\n+            int64_t nTimeMicros = GetTimeMicros();\n+            pnode->nLastRecv = nTimeMicros / 1000000;\n+            pnode->nRecvBytes += nBytes;\n+            if (notify) {\n+                for (; it != pnode->vRecvMsg.end(); ++it) {\n+                    const auto& msg = *it;\n+                    if (!msg.complete())\n+                        break;\n+                    nSizeAdded += msg.vRecv.size() + CMessageHeader::HEADER_SIZE;\n+                    mapMsgCmdSize::iterator mapit = pnode->mapRecvBytesPerMsgCmd.find(msg.hdr.pchCommand);\n+                    if (mapit == pnode->mapRecvBytesPerMsgCmd.end())\n+                        mapit = pnode->mapRecvBytesPerMsgCmd.find(NET_MESSAGE_COMMAND_OTHER);\n+                    assert(mapit != pnode->mapRecvBytesPerMsgCmd.end());\n+                    mapit->second += msg.vRecv.size() + CMessageHeader::HEADER_SIZE;\n+                }\n+            }\n+        }\n+        if (it != pnode->vRecvMsg.begin()) {\n+            LOCK(pnode->cs_vProcessMsg);\n+            pnode->vProcessMsg.splice(pnode->vProcessMsg.end(), pnode->vRecvMsg, pnode->vRecvMsg.begin(), it);\n+            pnode->nProcessQueueSize += nSizeAdded;\n+            if (pnode->nProcessQueueSize > nReceiveFloodSize) {\n+                LogPrint(BCLog::NET, \"Disabling receive due to oversized process queue of size: %lu. peer=%i\\n\", pnode->nProcessQueueSize, pnode->GetId());\n+                pnode->fPauseRecv = true;\n+                event_del(pnode->m_read_event);\n+            }\n \n+        }\n+        WakeMessageHandler();",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 164,
    "commit_id": "77cee166e17e355306d2ca1a1d360e71c12d8350",
    "original_commit_id": "7274a18dc3b438b090b1423fff442c760ae1c851",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes, thank you.",
    "created_at": "2017-09-06T00:02:58Z",
    "updated_at": "2017-09-20T20:41:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r137144026",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137144026"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r137144026"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137144026/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 918,
    "side": "RIGHT",
    "in_reply_to_id": 137135950
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137144255",
    "pull_request_review_id": 60773619,
    "id": 137144255,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEzNzE0NDI1NQ==",
    "diff_hunk": "@@ -1150,7 +1150,7 @@ void CConnman::AcceptConnection(const ListenSocket& hListenSocket) {\n         }\n     }\n \n-    bool whitelisted = hListenSocket.whitelisted || IsWhitelistedRange(addr);\n+    whitelisted = whitelisted || IsWhitelistedRange(addr);",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 18,
    "commit_id": "77cee166e17e355306d2ca1a1d360e71c12d8350",
    "original_commit_id": "0d08cb3d896703d1435a3c2520635a1d79e7cf22",
    "user": {
      "login": "theuni",
      "id": 417043,
      "node_id": "MDQ6VXNlcjQxNzA0Mw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/417043?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theuni",
      "html_url": "https://github.com/theuni",
      "followers_url": "https://api.github.com/users/theuni/followers",
      "following_url": "https://api.github.com/users/theuni/following{/other_user}",
      "gists_url": "https://api.github.com/users/theuni/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theuni/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theuni/subscriptions",
      "organizations_url": "https://api.github.com/users/theuni/orgs",
      "repos_url": "https://api.github.com/users/theuni/repos",
      "events_url": "https://api.github.com/users/theuni/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theuni/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I can say for certain that the operator doesn't exist because I tried it first :)",
    "created_at": "2017-09-06T00:04:50Z",
    "updated_at": "2017-09-20T20:41:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r137144255",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137144255"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r137144255"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137144255/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1321,
    "side": "RIGHT",
    "in_reply_to_id": 137138600
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137347641",
    "pull_request_review_id": 61002663,
    "id": 137347641,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDEzNzM0NzY0MQ==",
    "diff_hunk": "@@ -1150,7 +1150,7 @@ void CConnman::AcceptConnection(const ListenSocket& hListenSocket) {\n         }\n     }\n \n-    bool whitelisted = hListenSocket.whitelisted || IsWhitelistedRange(addr);\n+    whitelisted = whitelisted || IsWhitelistedRange(addr);",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 18,
    "commit_id": "77cee166e17e355306d2ca1a1d360e71c12d8350",
    "original_commit_id": "0d08cb3d896703d1435a3c2520635a1d79e7cf22",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Hehe I also remember it doesn't exist - I looked it up a long time ago and IIRC the rationale is that's because `|=` is the same when using only booleans. In any case this is ok as it is.",
    "created_at": "2017-09-06T18:12:37Z",
    "updated_at": "2017-09-20T20:41:35Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r137347641",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137347641"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/11227#discussion_r137347641"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/11227"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/137347641/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1321,
    "side": "RIGHT",
    "in_reply_to_id": 137138600
  }
]