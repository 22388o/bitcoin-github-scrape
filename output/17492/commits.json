[
  {
    "sha": "e3b19d869612b637f8bb702add0c363afe8adb8f",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplM2IxOWQ4Njk2MTJiNjM3ZjhiYjcwMmFkZDBjMzYzYWZlOGFkYjhm",
    "commit": {
      "author": {
        "name": "Gregory Sanders",
        "email": "gsanders87@gmail.com",
        "date": "2019-11-22T20:32:09Z"
      },
      "committer": {
        "name": "Gregory Sanders",
        "email": "gsanders87@gmail.com",
        "date": "2020-01-07T21:48:37Z"
      },
      "message": "QT: bump fee returns PSBT on clipboard for watchonly-only wallets",
      "tree": {
        "sha": "03f41218e048ff3e25d1751c6457ddfd62ae3790",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/03f41218e048ff3e25d1751c6457ddfd62ae3790"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e3b19d869612b637f8bb702add0c363afe8adb8f",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e3b19d869612b637f8bb702add0c363afe8adb8f",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/e3b19d869612b637f8bb702add0c363afe8adb8f",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e3b19d869612b637f8bb702add0c363afe8adb8f/comments",
    "author": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "45f151913ef5c7d4f7fb0f81e442fb6377dad353",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/45f151913ef5c7d4f7fb0f81e442fb6377dad353",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/45f151913ef5c7d4f7fb0f81e442fb6377dad353"
      }
    ],
    "stats": {
      "total": 20,
      "additions": 19,
      "deletions": 1
    },
    "files": [
      {
        "sha": "b8ba29a6e6cbfce5ecaabeb4427d7681752d42f6",
        "filename": "src/qt/walletmodel.cpp",
        "status": "modified",
        "additions": 19,
        "deletions": 1,
        "changes": 20,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e3b19d869612b637f8bb702add0c363afe8adb8f/src/qt/walletmodel.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e3b19d869612b637f8bb702add0c363afe8adb8f/src/qt/walletmodel.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/walletmodel.cpp?ref=e3b19d869612b637f8bb702add0c363afe8adb8f",
        "patch": "@@ -10,6 +10,7 @@\n \n #include <qt/addresstablemodel.h>\n #include <qt/guiconstants.h>\n+#include <qt/guiutil.h>\n #include <qt/optionsmodel.h>\n #include <qt/paymentserver.h>\n #include <qt/recentrequeststablemodel.h>\n@@ -487,8 +488,10 @@ bool WalletModel::bumpFee(uint256 hash, uint256& new_hash)\n          return false;\n     }\n \n+    const bool create_psbt = privateKeysDisabled();\n+\n     // allow a user based fee verification\n-    QString questionString = tr(\"Do you want to increase the fee?\");\n+    QString questionString = create_psbt ? tr(\"Do you want to draft a transaction with fee increase?\") : tr(\"Do you want to increase the fee?\");\n     questionString.append(\"<br />\");\n     questionString.append(\"<table style=\\\"text-align: left;\\\">\");\n     questionString.append(\"<tr><td>\");\n@@ -519,6 +522,21 @@ bool WalletModel::bumpFee(uint256 hash, uint256& new_hash)\n         return false;\n     }\n \n+    // Short-circuit if we are returning a bumped transaction PSBT to clipboard\n+    if (create_psbt) {\n+        PartiallySignedTransaction psbtx(mtx);\n+        bool complete = false;\n+        const TransactionError err = wallet().fillPSBT(psbtx, complete, SIGHASH_ALL, false /* sign */, true /* bip32derivs */);\n+        assert(!complete);\n+        assert(err == TransactionError::OK);\n+        // Serialize the PSBT\n+        CDataStream ssTx(SER_NETWORK, PROTOCOL_VERSION);\n+        ssTx << psbtx;\n+        GUIUtil::setClipboard(EncodeBase64(ssTx.str()).c_str());\n+        Q_EMIT message(tr(\"PSBT copied\"), \"Copied to clipboard\", CClientUIInterface::MSG_INFORMATION);\n+        return true;\n+    }\n+\n     // sign bumped transaction\n     if (!m_wallet->signBumpTransaction(mtx)) {\n         QMessageBox::critical(nullptr, tr(\"Fee bump error\"), tr(\"Can't sign transaction.\"));"
      }
    ]
  },
  {
    "sha": "3c30d7118a5d5cb40c3686e0da884d3928caaeba",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozYzMwZDcxMThhNWQ1Y2I0MGMzNjg2ZTBkYTg4NGQzOTI4Y2FhZWJh",
    "commit": {
      "author": {
        "name": "Gregory Sanders",
        "email": "gsanders87@gmail.com",
        "date": "2020-01-14T14:27:08Z"
      },
      "committer": {
        "name": "Gregory Sanders",
        "email": "gsanders87@gmail.com",
        "date": "2020-01-15T15:51:01Z"
      },
      "message": "QT: Change bumpFee asserts to simple error message",
      "tree": {
        "sha": "c0f7dc4e2f3b1468b5c7ac02af4f2652a10998e4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c0f7dc4e2f3b1468b5c7ac02af4f2652a10998e4"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3c30d7118a5d5cb40c3686e0da884d3928caaeba",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3c30d7118a5d5cb40c3686e0da884d3928caaeba",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/3c30d7118a5d5cb40c3686e0da884d3928caaeba",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3c30d7118a5d5cb40c3686e0da884d3928caaeba/comments",
    "author": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "e3b19d869612b637f8bb702add0c363afe8adb8f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e3b19d869612b637f8bb702add0c363afe8adb8f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/e3b19d869612b637f8bb702add0c363afe8adb8f"
      }
    ],
    "stats": {
      "total": 6,
      "additions": 4,
      "deletions": 2
    },
    "files": [
      {
        "sha": "6c3a06f3a2c15dfa519eb1c6191aa142ad8fcdc9",
        "filename": "src/qt/walletmodel.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 2,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/3c30d7118a5d5cb40c3686e0da884d3928caaeba/src/qt/walletmodel.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/3c30d7118a5d5cb40c3686e0da884d3928caaeba/src/qt/walletmodel.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/walletmodel.cpp?ref=3c30d7118a5d5cb40c3686e0da884d3928caaeba",
        "patch": "@@ -527,8 +527,10 @@ bool WalletModel::bumpFee(uint256 hash, uint256& new_hash)\n         PartiallySignedTransaction psbtx(mtx);\n         bool complete = false;\n         const TransactionError err = wallet().fillPSBT(psbtx, complete, SIGHASH_ALL, false /* sign */, true /* bip32derivs */);\n-        assert(!complete);\n-        assert(err == TransactionError::OK);\n+        if (err != TransactionError::OK || complete) {\n+            QMessageBox::critical(nullptr, tr(\"Fee bump error\"), tr(\"Can't draft transaction.\"));\n+            return false;\n+        }\n         // Serialize the PSBT\n         CDataStream ssTx(SER_NETWORK, PROTOCOL_VERSION);\n         ssTx << psbtx;"
      }
    ]
  }
]