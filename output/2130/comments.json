[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/11837016",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/2130#issuecomment-11837016",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/2130",
    "id": 11837016,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExODM3MDE2",
    "user": {
      "login": "BitcoinPullTester",
      "id": 2110907,
      "node_id": "MDQ6VXNlcjIxMTA5MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2110907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BitcoinPullTester",
      "html_url": "https://github.com/BitcoinPullTester",
      "followers_url": "https://api.github.com/users/BitcoinPullTester/followers",
      "following_url": "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
      "gists_url": "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BitcoinPullTester/subscriptions",
      "organizations_url": "https://api.github.com/users/BitcoinPullTester/orgs",
      "repos_url": "https://api.github.com/users/BitcoinPullTester/repos",
      "events_url": "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BitcoinPullTester/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-01-03T08:01:08Z",
    "updated_at": "2013-01-03T08:01:08Z",
    "author_association": "NONE",
    "body": "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/943e7768f33a7c766d1be5db8aea64a46e37253b for binaries and test log.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/11837016/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/11922368",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/2130#issuecomment-11922368",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/2130",
    "id": 11922368,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExOTIyMzY4",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-01-06T00:43:34Z",
    "updated_at": "2013-01-06T00:43:34Z",
    "author_association": "MEMBER",
    "body": "Many of your TODO's look like todo's for yourself rather than concrete plans for changes in the source code - leave those out. If there is a concrete plan, and it's obvious: just add a commit that actually implements the change. If it's something big you'd rather leave for a follow-up pull request, a TODO in the code is fine.\n\nAlso, squash some commits together. \"Indentation fix\" certainly doesn't require a separate commit.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/11922368/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/11922553",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/2130#issuecomment-11922553",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/2130",
    "id": 11922553,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExOTIyNTUz",
    "user": {
      "login": "mikegogulski",
      "id": 118625,
      "node_id": "MDQ6VXNlcjExODYyNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/118625?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mikegogulski",
      "html_url": "https://github.com/mikegogulski",
      "followers_url": "https://api.github.com/users/mikegogulski/followers",
      "following_url": "https://api.github.com/users/mikegogulski/following{/other_user}",
      "gists_url": "https://api.github.com/users/mikegogulski/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mikegogulski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mikegogulski/subscriptions",
      "organizations_url": "https://api.github.com/users/mikegogulski/orgs",
      "repos_url": "https://api.github.com/users/mikegogulski/repos",
      "events_url": "https://api.github.com/users/mikegogulski/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mikegogulski/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-01-06T01:00:38Z",
    "updated_at": "2013-01-06T01:00:38Z",
    "author_association": "NONE",
    "body": "Okay, I stripped out the todos. Should I squash everything in this branch down to one commit in order to get it pulled? (total git noob here)\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/11922553/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/11922709",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/2130#issuecomment-11922709",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/2130",
    "id": 11922709,
    "node_id": "MDEyOklzc3VlQ29tbWVudDExOTIyNzA5",
    "user": {
      "login": "BitcoinPullTester",
      "id": 2110907,
      "node_id": "MDQ6VXNlcjIxMTA5MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2110907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BitcoinPullTester",
      "html_url": "https://github.com/BitcoinPullTester",
      "followers_url": "https://api.github.com/users/BitcoinPullTester/followers",
      "following_url": "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
      "gists_url": "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BitcoinPullTester/subscriptions",
      "organizations_url": "https://api.github.com/users/BitcoinPullTester/orgs",
      "repos_url": "https://api.github.com/users/BitcoinPullTester/repos",
      "events_url": "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BitcoinPullTester/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-01-06T01:17:09Z",
    "updated_at": "2013-01-06T01:17:09Z",
    "author_association": "NONE",
    "body": "Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/4debb8059a3d29a88b72b2bc61a4e0f6bfc7e522 for binaries and test log.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/11922709/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/12636933",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/2130#issuecomment-12636933",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/2130",
    "id": 12636933,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyNjM2OTMz",
    "user": {
      "login": "BitcoinPullTester",
      "id": 2110907,
      "node_id": "MDQ6VXNlcjIxMTA5MDc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2110907?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/BitcoinPullTester",
      "html_url": "https://github.com/BitcoinPullTester",
      "followers_url": "https://api.github.com/users/BitcoinPullTester/followers",
      "following_url": "https://api.github.com/users/BitcoinPullTester/following{/other_user}",
      "gists_url": "https://api.github.com/users/BitcoinPullTester/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/BitcoinPullTester/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/BitcoinPullTester/subscriptions",
      "organizations_url": "https://api.github.com/users/BitcoinPullTester/orgs",
      "repos_url": "https://api.github.com/users/BitcoinPullTester/repos",
      "events_url": "https://api.github.com/users/BitcoinPullTester/events{/privacy}",
      "received_events_url": "https://api.github.com/users/BitcoinPullTester/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-01-24T04:38:47Z",
    "updated_at": "2013-01-24T04:38:47Z",
    "author_association": "NONE",
    "body": "Automatic sanity-testing: FAILED MERGE, see http://jenkins.bluematt.me/pull-tester/4debb8059a3d29a88b72b2bc61a4e0f6bfc7e522 for test log.\n\nThis pull does not merge cleanly onto current master\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/12636933/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/12904881",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/2130#issuecomment-12904881",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/2130",
    "id": 12904881,
    "node_id": "MDEyOklzc3VlQ29tbWVudDEyOTA0ODgx",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-01-30T18:36:34Z",
    "updated_at": "2013-01-30T18:36:34Z",
    "author_association": "MEMBER",
    "body": "Rebase needed\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/12904881/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/19703713",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/2130#issuecomment-19703713",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/2130",
    "id": 19703713,
    "node_id": "MDEyOklzc3VlQ29tbWVudDE5NzAzNzEz",
    "user": {
      "login": "jgarzik",
      "id": 494411,
      "node_id": "MDQ6VXNlcjQ5NDQxMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/494411?u=0b02049ec38b6bb7d55c5c66d9bbeb0d4b822129&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jgarzik",
      "html_url": "https://github.com/jgarzik",
      "followers_url": "https://api.github.com/users/jgarzik/followers",
      "following_url": "https://api.github.com/users/jgarzik/following{/other_user}",
      "gists_url": "https://api.github.com/users/jgarzik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jgarzik/subscriptions",
      "organizations_url": "https://api.github.com/users/jgarzik/orgs",
      "repos_url": "https://api.github.com/users/jgarzik/repos",
      "events_url": "https://api.github.com/users/jgarzik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jgarzik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-06-19T18:27:48Z",
    "updated_at": "2013-06-19T18:27:48Z",
    "author_association": "CONTRIBUTOR",
    "body": "Poke @mikegogulski \n\nThe general sentiment towards these changes seems positive.  Let's rebase and get this moving, or close.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/19703713/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/21090978",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/2130#issuecomment-21090978",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/2130",
    "id": 21090978,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIxMDkwOTc4",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-07-17T04:09:48Z",
    "updated_at": "2013-07-17T04:09:48Z",
    "author_association": "MEMBER",
    "body": "I've rebased this as my mikegogulski_walletencap3 branch. It does, however, create a dependency from wallet.cpp -> main.h; I don't see any obvious way to fix this, considering that IsFinalTx is not tied to any class.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/21090978/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/23221198",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/2130#issuecomment-23221198",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/2130",
    "id": 23221198,
    "node_id": "MDEyOklzc3VlQ29tbWVudDIzMjIxMTk4",
    "user": {
      "login": "jgarzik",
      "id": 494411,
      "node_id": "MDQ6VXNlcjQ5NDQxMQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/494411?u=0b02049ec38b6bb7d55c5c66d9bbeb0d4b822129&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jgarzik",
      "html_url": "https://github.com/jgarzik",
      "followers_url": "https://api.github.com/users/jgarzik/followers",
      "following_url": "https://api.github.com/users/jgarzik/following{/other_user}",
      "gists_url": "https://api.github.com/users/jgarzik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jgarzik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jgarzik/subscriptions",
      "organizations_url": "https://api.github.com/users/jgarzik/orgs",
      "repos_url": "https://api.github.com/users/jgarzik/repos",
      "events_url": "https://api.github.com/users/jgarzik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jgarzik/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2013-08-25T03:25:01Z",
    "updated_at": "2013-08-25T03:25:01Z",
    "author_association": "CONTRIBUTOR",
    "body": "Closing - non-responsive.  Feel free to rebase and reopen.\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/23221198/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2508898",
    "pull_request_review_id": null,
    "id": 2508898,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MDg4OTg=",
    "diff_hunk": "@@ -1804,3 +1804,124 @@ void CWallet::ListLockedCoins(std::vector<COutPoint>& vOutpts)\n     }\n }\n \n+CTxDestination CWallet::GetAccountAddress(const std::string strAccount, bool bForceNew=false)\n+{\n+    CWalletDB walletdb(strWalletFile);\n+    CAccount account;\n+    walletdb.ReadAccount(strAccount, account);\n+    bool bKeyUsed = false;\n+\n+    // Check if the current key has been used\n+    if (account.vchPubKey.IsValid())\n+    {\n+        CScript scriptPubKey;\n+        scriptPubKey.SetDestination(account.vchPubKey.GetID());\n+        // TODO: Is this IsValid() check really necessary here?\n+        for (map<uint256, CWalletTx>::iterator it = mapWallet.begin();\n+             it != mapWallet.end() && account.vchPubKey.IsValid() && !bKeyUsed;\n+             ++it)\n+        {\n+            //const CWalletTx& wtx = (*it).second;\n+            BOOST_FOREACH(const CTxOut& txout, (*it).second.vout)\n+                if (txout.scriptPubKey == scriptPubKey)\n+                {\n+                    bKeyUsed = true;\n+                    break;\n+                }\n+        }\n+    }\n+\n+    // Generate a new key\n+    if (!account.vchPubKey.IsValid() || bForceNew || bKeyUsed)\n+    {\n+        // Caller must check validity to detect keypool depletion\n+        if (!GetKeyFromPool(account.vchPubKey, false))\n+            return CTxDestination();\n+\n+        // TODO: Do something with the return code\n+        SetAddressBookName(account.vchPubKey.GetID(), strAccount);\n+        walletdb.WriteAccount(strAccount, account);\n+    }\n+\n+    return CTxDestination(account.vchPubKey.GetID());\n+}\n+\n+bool CWallet::SetAccount(const CTxDestination& dest, const std::string strAccount)\n+{\n+    // Detect when changing the account of an address that is the 'unused current key' of another account:\n+    if (mapAddressBook.count(dest))\n+    {\n+        string strOldAccount = mapAddressBook[dest];\n+        if (dest == GetAccountAddress(strOldAccount, false) && !CBitcoinAddress(GetAccountAddress(strOldAccount, true)).IsValid())\n+            return false;\n+    }\n+\n+    return SetAddressBookName(dest, strAccount);\n+}\n+\n+bool CWallet::IsMine(const CBitcoinAddress& address) const",
    "path": "src/wallet.cpp",
    "position": null,
    "original_position": 59,
    "commit_id": "4debb8059a3d29a88b72b2bc61a4e0f6bfc7e522",
    "original_commit_id": "603970d71ec9ca99fd0100179b9ff7c1a2f4c116",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Here's still a CBitcoinAddress left.\n",
    "created_at": "2012-12-27T14:05:17Z",
    "updated_at": "2013-01-06T00:58:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/2130#discussion_r2508898",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/2130",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2508898"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/2130#discussion_r2508898"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/2130"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2508898/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1862,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2508909",
    "pull_request_review_id": null,
    "id": 2508909,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1MDg5MDk=",
    "diff_hunk": "@@ -1804,3 +1804,124 @@ void CWallet::ListLockedCoins(std::vector<COutPoint>& vOutpts)\n     }\n }\n \n+CTxDestination CWallet::GetAccountAddress(const std::string strAccount, bool bForceNew=false)\n+{\n+    CWalletDB walletdb(strWalletFile);\n+    CAccount account;\n+    walletdb.ReadAccount(strAccount, account);\n+    bool bKeyUsed = false;\n+\n+    // Check if the current key has been used\n+    if (account.vchPubKey.IsValid())\n+    {\n+        CScript scriptPubKey;\n+        scriptPubKey.SetDestination(account.vchPubKey.GetID());\n+        // TODO: Is this IsValid() check really necessary here?\n+        for (map<uint256, CWalletTx>::iterator it = mapWallet.begin();\n+             it != mapWallet.end() && account.vchPubKey.IsValid() && !bKeyUsed;\n+             ++it)\n+        {\n+            //const CWalletTx& wtx = (*it).second;\n+            BOOST_FOREACH(const CTxOut& txout, (*it).second.vout)\n+                if (txout.scriptPubKey == scriptPubKey)\n+                {\n+                    bKeyUsed = true;\n+                    break;\n+                }\n+        }\n+    }\n+\n+    // Generate a new key\n+    if (!account.vchPubKey.IsValid() || bForceNew || bKeyUsed)\n+    {\n+        // Caller must check validity to detect keypool depletion\n+        if (!GetKeyFromPool(account.vchPubKey, false))\n+            return CTxDestination();\n+\n+        // TODO: Do something with the return code\n+        SetAddressBookName(account.vchPubKey.GetID(), strAccount);\n+        walletdb.WriteAccount(strAccount, account);\n+    }\n+\n+    return CTxDestination(account.vchPubKey.GetID());\n+}\n+\n+bool CWallet::SetAccount(const CTxDestination& dest, const std::string strAccount)\n+{\n+    // Detect when changing the account of an address that is the 'unused current key' of another account:\n+    if (mapAddressBook.count(dest))\n+    {\n+        string strOldAccount = mapAddressBook[dest];\n+        if (dest == GetAccountAddress(strOldAccount, false) && !CBitcoinAddress(GetAccountAddress(strOldAccount, true)).IsValid())\n+            return false;\n+    }\n+\n+    return SetAddressBookName(dest, strAccount);\n+}\n+\n+bool CWallet::IsMine(const CBitcoinAddress& address) const",
    "path": "src/wallet.cpp",
    "position": null,
    "original_position": 59,
    "commit_id": "4debb8059a3d29a88b72b2bc61a4e0f6bfc7e522",
    "original_commit_id": "603970d71ec9ca99fd0100179b9ff7c1a2f4c116",
    "user": {
      "login": "mikegogulski",
      "id": 118625,
      "node_id": "MDQ6VXNlcjExODYyNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/118625?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mikegogulski",
      "html_url": "https://github.com/mikegogulski",
      "followers_url": "https://api.github.com/users/mikegogulski/followers",
      "following_url": "https://api.github.com/users/mikegogulski/following{/other_user}",
      "gists_url": "https://api.github.com/users/mikegogulski/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mikegogulski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mikegogulski/subscriptions",
      "organizations_url": "https://api.github.com/users/mikegogulski/orgs",
      "repos_url": "https://api.github.com/users/mikegogulski/repos",
      "events_url": "https://api.github.com/users/mikegogulski/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mikegogulski/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I need to hunt that one down yet since I think it's used outside of rpc*.cpp. I'll post a new commit working on that soon.\n",
    "created_at": "2012-12-27T14:07:34Z",
    "updated_at": "2013-01-06T00:58:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/2130#discussion_r2508909",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/2130",
    "author_association": "NONE",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2508909"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/2130#discussion_r2508909"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/2130"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2508909/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1862,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2559153",
    "pull_request_review_id": null,
    "id": 2559153,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1NTkxNTM=",
    "diff_hunk": "@@ -166,46 +129,32 @@ Value getaccountaddress(const Array& params, bool fHelp)\n \n     // Parse the account first so we don't generate a key if there's an error\n     string strAccount = AccountFromValue(params[0]);\n-\n-    Value ret;\n-\n-    ret = GetAccountAddress(strAccount).ToString();\n-\n-    return ret;\n+    CBitcoinAddress address = CBitcoinAddress(pwalletMain->GetAccountAddress(strAccount, false));\n+    if (address.IsValid())\n+    \treturn address.ToString();\n+    throw JSONRPCError(RPC_WALLET_KEYPOOL_RAN_OUT, \"Error: Keypool ran out, please call keypoolrefill first\");\n }\n \n-\n-\n Value setaccount(const Array& params, bool fHelp)\n {\n     if (fHelp || params.size() < 1 || params.size() > 2)\n         throw runtime_error(\n-            \"setaccount <bitcoinaddress> <account>\\n\"\n-            \"Sets the account associated with the given address.\");\n+            \"setaccount <bitcoinaddress> [account]\\n\"\n+            \"Sets the address's account to [account] or \\\"\\\".\");\n \n     CBitcoinAddress address(params[0].get_str());\n     if (!address.IsValid())\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid Bitcoin address\");\n \n-\n     string strAccount;\n     if (params.size() > 1)\n         strAccount = AccountFromValue(params[1]);\n \n-    // Detect when changing the account of an address that is the 'unused current key' of another account:\n-    if (pwalletMain->mapAddressBook.count(address.Get()))\n-    {\n-        string strOldAccount = pwalletMain->mapAddressBook[address.Get()];\n-        if (address == GetAccountAddress(strOldAccount))\n-            GetAccountAddress(strOldAccount, true);\n-    }\n-\n-    pwalletMain->SetAddressBookName(address.Get(), strAccount);\n-\n+    // TODO: Use the return code for something",
    "path": "src/rpcwallet.cpp",
    "position": null,
    "original_position": 146,
    "commit_id": "4debb8059a3d29a88b72b2bc61a4e0f6bfc7e522",
    "original_commit_id": "943e7768f33a7c766d1be5db8aea64a46e37253b",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Why is this a TODO?\n",
    "created_at": "2013-01-06T00:27:50Z",
    "updated_at": "2013-01-06T00:58:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/2130#discussion_r2559153",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/2130",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2559153"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/2130#discussion_r2559153"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/2130"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2559153/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 153,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2559168",
    "pull_request_review_id": null,
    "id": 2559168,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI1NTkxNjg=",
    "diff_hunk": "@@ -166,46 +129,32 @@ Value getaccountaddress(const Array& params, bool fHelp)\n \n     // Parse the account first so we don't generate a key if there's an error\n     string strAccount = AccountFromValue(params[0]);\n-\n-    Value ret;\n-\n-    ret = GetAccountAddress(strAccount).ToString();\n-\n-    return ret;\n+    CBitcoinAddress address = CBitcoinAddress(pwalletMain->GetAccountAddress(strAccount, false));\n+    if (address.IsValid())\n+    \treturn address.ToString();\n+    throw JSONRPCError(RPC_WALLET_KEYPOOL_RAN_OUT, \"Error: Keypool ran out, please call keypoolrefill first\");\n }\n \n-\n-\n Value setaccount(const Array& params, bool fHelp)\n {\n     if (fHelp || params.size() < 1 || params.size() > 2)\n         throw runtime_error(\n-            \"setaccount <bitcoinaddress> <account>\\n\"\n-            \"Sets the account associated with the given address.\");\n+            \"setaccount <bitcoinaddress> [account]\\n\"\n+            \"Sets the address's account to [account] or \\\"\\\".\");\n \n     CBitcoinAddress address(params[0].get_str());\n     if (!address.IsValid())\n         throw JSONRPCError(RPC_INVALID_ADDRESS_OR_KEY, \"Invalid Bitcoin address\");\n \n-\n     string strAccount;\n     if (params.size() > 1)\n         strAccount = AccountFromValue(params[1]);\n \n-    // Detect when changing the account of an address that is the 'unused current key' of another account:\n-    if (pwalletMain->mapAddressBook.count(address.Get()))\n-    {\n-        string strOldAccount = pwalletMain->mapAddressBook[address.Get()];\n-        if (address == GetAccountAddress(strOldAccount))\n-            GetAccountAddress(strOldAccount, true);\n-    }\n-\n-    pwalletMain->SetAddressBookName(address.Get(), strAccount);\n-\n+    // TODO: Use the return code for something",
    "path": "src/rpcwallet.cpp",
    "position": null,
    "original_position": 146,
    "commit_id": "4debb8059a3d29a88b72b2bc61a4e0f6bfc7e522",
    "original_commit_id": "943e7768f33a7c766d1be5db8aea64a46e37253b",
    "user": {
      "login": "mikegogulski",
      "id": 118625,
      "node_id": "MDQ6VXNlcjExODYyNQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/118625?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/mikegogulski",
      "html_url": "https://github.com/mikegogulski",
      "followers_url": "https://api.github.com/users/mikegogulski/followers",
      "following_url": "https://api.github.com/users/mikegogulski/following{/other_user}",
      "gists_url": "https://api.github.com/users/mikegogulski/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/mikegogulski/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/mikegogulski/subscriptions",
      "organizations_url": "https://api.github.com/users/mikegogulski/orgs",
      "repos_url": "https://api.github.com/users/mikegogulski/repos",
      "events_url": "https://api.github.com/users/mikegogulski/events{/privacy}",
      "received_events_url": "https://api.github.com/users/mikegogulski/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I saw a method returning bool and the return value being ignored, so I put in that note. Looking around the codebase now I see that it's hardly ever used, so maybe it can be ignored. Want a new commit?\n",
    "created_at": "2013-01-06T00:38:27Z",
    "updated_at": "2013-01-06T00:58:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/2130#discussion_r2559168",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/2130",
    "author_association": "NONE",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2559168"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/2130#discussion_r2559168"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/2130"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/2559168/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 153,
    "side": "RIGHT"
  }
]