[
  {
    "sha": "fa33ed4b3fe422d6a6949cec04d2e14efc9ba3ca",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYTMzZWQ0YjNmZTQyMmQ2YTY5NDljZWMwNGQyZTE0ZWZjOWJhM2Nh",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-07-15T10:58:40Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-07-15T10:36:55Z"
      },
      "message": "fuzz: Limit max ops in tx_pool fuzz targets",
      "tree": {
        "sha": "9f9b192c91cd771829cca6e1cb1a435555408b71",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9f9b192c91cd771829cca6e1cb1a435555408b71"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa33ed4b3fe422d6a6949cec04d2e14efc9ba3ca",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUh8KAwAx4SrOW4NR3jS1AdN5mfW4y3vRSa9BB3bR2LdhiRksx+KdHRrKpV2ewhn\nvoQk6ovPF3X2TKn624zoGcSziS50btqQgGcDlqSHV7j6kCPG6unTLvF3Pzj/cCGW\n6lYLGvGfQNs6hR6JPuMgwpzafQkxeQ/P3lF1HtUmeM/eeIE1bk7tXEtoMDWJ/eq2\nBPQnkQQk1SJT3p73qJ8LzEaIymQ75Wfc8vgKyFkOFOj02+va+8F+srKBTE4Hh/AC\nS28CpMDP1LydV5IhFowXd//zBOlIt8MKjqVW2ca+ghnav4mrXjXQhTIOE095ndbb\nNE3NcQONP8SEaqZfV+egZ5pac+FA7gIzWnJPustz98fzb68aZqi/dd3vuJl1CDOX\nzisOMX4NFJ5055ZNwVye6bGZnFD4gCN9Huw8yA71n8NVcl1efJFw+u3Cnvr2adyc\nhMGQdwKyUbwTLgkv7VH1dxksS/xk3oQgpS+zi9+T+TSY8H2Xj+1uNeuc0O33BK4t\nS4gFMKkf\n=0iYC\n-----END PGP SIGNATURE-----",
        "payload": "tree 9f9b192c91cd771829cca6e1cb1a435555408b71\nparent 97153a702600430bdaf6af4f6f4eb8593e32819f\nauthor MarcoFalke <falke.marco@gmail.com> 1626346720 +0200\ncommitter MarcoFalke <falke.marco@gmail.com> 1626345415 +0200\n\nfuzz: Limit max ops in tx_pool fuzz targets\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa33ed4b3fe422d6a6949cec04d2e14efc9ba3ca",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fa33ed4b3fe422d6a6949cec04d2e14efc9ba3ca",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa33ed4b3fe422d6a6949cec04d2e14efc9ba3ca/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "97153a702600430bdaf6af4f6f4eb8593e32819f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/97153a702600430bdaf6af4f6f4eb8593e32819f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/97153a702600430bdaf6af4f6f4eb8593e32819f"
      }
    ],
    "stats": {
      "total": 12,
      "additions": 10,
      "deletions": 2
    },
    "files": [
      {
        "sha": "dadf772bc1f23cf8fe0a9a53476309729e65827a",
        "filename": "src/test/fuzz/tx_pool.cpp",
        "status": "modified",
        "additions": 10,
        "deletions": 2,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa33ed4b3fe422d6a6949cec04d2e14efc9ba3ca/src/test/fuzz/tx_pool.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa33ed4b3fe422d6a6949cec04d2e14efc9ba3ca/src/test/fuzz/tx_pool.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/tx_pool.cpp?ref=fa33ed4b3fe422d6a6949cec04d2e14efc9ba3ca",
        "patch": "@@ -112,6 +112,10 @@ void MockTime(FuzzedDataProvider& fuzzed_data_provider, const CChainState& chain\n \n FUZZ_TARGET_INIT(tx_pool_standard, initialize_tx_pool)\n {\n+    // Pick an arbitrary upper bound to limit the runtime and avoid timeouts on\n+    // inputs.\n+    int limit_max_ops{300};\n+\n     FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n     const auto& node = g_setup->m_node;\n     auto& chainstate = node.chainman->ActiveChainstate();\n@@ -142,7 +146,7 @@ FUZZ_TARGET_INIT(tx_pool_standard, initialize_tx_pool)\n         return c.out.nValue;\n     };\n \n-    while (fuzzed_data_provider.ConsumeBool()) {\n+    while (--limit_max_ops >= 0 && fuzzed_data_provider.ConsumeBool()) {\n         {\n             // Total supply is the mempool fee + all outpoints\n             CAmount supply_now{WITH_LOCK(tx_pool.cs, return tx_pool.GetTotalFee())};\n@@ -285,6 +289,10 @@ FUZZ_TARGET_INIT(tx_pool_standard, initialize_tx_pool)\n \n FUZZ_TARGET_INIT(tx_pool, initialize_tx_pool)\n {\n+    // Pick an arbitrary upper bound to limit the runtime and avoid timeouts on\n+    // inputs.\n+    int limit_max_ops{300};\n+\n     FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n     const auto& node = g_setup->m_node;\n     auto& chainstate = node.chainman->ActiveChainstate();\n@@ -305,7 +313,7 @@ FUZZ_TARGET_INIT(tx_pool, initialize_tx_pool)\n     CTxMemPool tx_pool_{/* estimator */ nullptr, /* check_ratio */ 1};\n     MockedTxPool& tx_pool = *static_cast<MockedTxPool*>(&tx_pool_);\n \n-    while (fuzzed_data_provider.ConsumeBool()) {\n+    while (--limit_max_ops >= 0 && fuzzed_data_provider.ConsumeBool()) {\n         const auto mut_tx = ConsumeTransaction(fuzzed_data_provider, txids);\n \n         if (fuzzed_data_provider.ConsumeBool()) {"
      }
    ]
  }
]