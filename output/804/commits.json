[
  {
    "sha": "7bf8b7c25c944110dbe85ef9e4eebd858da34158",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3YmY4YjdjMjVjOTQ0MTEwZGJlODVlZjllNGVlYmQ4NThkYTM0MTU4",
    "commit": {
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2012-02-06T20:48:00Z"
      },
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2012-02-06T21:27:05Z"
      },
      "message": "-bip16 option (default: 1) to support / not support BIP 16. And bumped default BIP16 switchover date from Feb 15 to Mar 1",
      "tree": {
        "sha": "943799640b2ceab894852cb1cd54158c582ec577",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/943799640b2ceab894852cb1cd54158c582ec577"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7bf8b7c25c944110dbe85ef9e4eebd858da34158",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7bf8b7c25c944110dbe85ef9e4eebd858da34158",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/7bf8b7c25c944110dbe85ef9e4eebd858da34158",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7bf8b7c25c944110dbe85ef9e4eebd858da34158/comments",
    "author": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "0b9a05a2bc1c1c6a86cdd9f25d43ab7224fd8731",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/0b9a05a2bc1c1c6a86cdd9f25d43ab7224fd8731",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/0b9a05a2bc1c1c6a86cdd9f25d43ab7224fd8731"
      }
    ],
    "stats": {
      "total": 49,
      "additions": 34,
      "deletions": 15
    },
    "files": [
      {
        "sha": "97f5ce7ec0dc003bfb65e22883bfbb3b6826d85d",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 26,
        "deletions": 7,
        "changes": 33,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7bf8b7c25c944110dbe85ef9e4eebd858da34158/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7bf8b7c25c944110dbe85ef9e4eebd858da34158/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=7bf8b7c25c944110dbe85ef9e4eebd858da34158",
        "patch": "@@ -474,19 +474,38 @@ bool AppInit2(int argc, char* argv[])\n     bool fTor = (fUseProxy && addrProxy.GetPort() == 9050);\n     if (fTor)\n     {\n-        // Use SoftSetArg here so user can override any of these if they wish.\n+        // Use SoftSetBoolArg here so user can override any of these if they wish.\n         // Note: the GetBoolArg() calls for all of these must happen later.\n-        SoftSetArg(\"-nolisten\", true);\n-        SoftSetArg(\"-noirc\", true);\n-        SoftSetArg(\"-nodnsseed\", true);\n-        SoftSetArg(\"-noupnp\", true);\n-        SoftSetArg(\"-upnp\", false);\n-        SoftSetArg(\"-dns\", false);\n+        SoftSetBoolArg(\"-nolisten\", true);\n+        SoftSetBoolArg(\"-noirc\", true);\n+        SoftSetBoolArg(\"-nodnsseed\", true);\n+        SoftSetBoolArg(\"-noupnp\", true);\n+        SoftSetBoolArg(\"-upnp\", false);\n+        SoftSetBoolArg(\"-dns\", false);\n     }\n \n     fAllowDNS = GetBoolArg(\"-dns\");\n     fNoListen = GetBoolArg(\"-nolisten\");\n \n+    // This code can be removed once a super-majority of the network has upgraded.\n+    if (GetBoolArg(\"-bip16\", true))\n+    {\n+        if (fTestNet)\n+            SoftSetArg(\"-paytoscripthashtime\", \"1329264000\"); // Feb 15\n+        else\n+            SoftSetArg(\"-paytoscripthashtime\", \"1330578000\"); // Mar 1\n+\n+        // Put \"/P2SH/\" in the coinbase so everybody can tell when\n+        // a majority of miners support it\n+        const char* pszP2SH = \"/P2SH/\";\n+        COINBASE_FLAGS << std::vector<unsigned char>(pszP2SH, pszP2SH+strlen(pszP2SH));\n+    }\n+    else\n+    {\n+        const char* pszP2SH = \"NOP2SH\";\n+        COINBASE_FLAGS << std::vector<unsigned char>(pszP2SH, pszP2SH+strlen(pszP2SH));\n+    }\n+\n     // Command-line args override in-wallet settings:\n     if (mapArgs.count(\"-upnp\"))\n         fUseUPnP = GetBoolArg(\"-upnp\");"
      },
      {
        "sha": "9e5f743b69382677ce84ce50f5fa1c9714725df8",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 2,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7bf8b7c25c944110dbe85ef9e4eebd858da34158/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7bf8b7c25c944110dbe85ef9e4eebd858da34158/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=7bf8b7c25c944110dbe85ef9e4eebd858da34158",
        "patch": "@@ -52,6 +52,8 @@ multimap<uint256, CBlock*> mapOrphanBlocksByPrev;\n map<uint256, CDataStream*> mapOrphanTransactions;\n multimap<uint256, CDataStream*> mapOrphanTransactionsByPrev;\n \n+// Constant stuff for coinbase transactions we create:\n+CScript COINBASE_FLAGS;\n \n const string strMessageMagic = \"Bitcoin Signed Message:\\n\";\n \n@@ -1213,8 +1215,9 @@ bool CBlock::ConnectBlock(CTxDB& txdb, CBlockIndex* pindex)\n \n     // To avoid being on the short end of a block-chain split,\n     // don't do secondary validation of pay-to-script-hash transactions\n-    // until blocks with timestamps after paytoscripthashtime:\n-    int64 nEvalSwitchTime = GetArg(\"-paytoscripthashtime\", 1329264000); // Feb 15, 2012\n+    // until blocks with timestamps after paytoscripthashtime (see init.cpp for default).\n+    // This code can be removed once a super-majority of the network has upgraded.\n+    int64 nEvalSwitchTime = GetArg(\"-paytoscripthashtime\", std::numeric_limits<int64_t>::max());\n     bool fStrictPayToScriptHash = (pindex->nTime >= nEvalSwitchTime);\n \n     //// issue here: it doesn't know the version"
      },
      {
        "sha": "38cdd81fcc16bb85a62c56b0c6ceb7b6343c9be8",
        "filename": "src/main.h",
        "status": "modified",
        "additions": 1,
        "deletions": 4,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7bf8b7c25c944110dbe85ef9e4eebd858da34158/src/main.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7bf8b7c25c944110dbe85ef9e4eebd858da34158/src/main.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.h?ref=7bf8b7c25c944110dbe85ef9e4eebd858da34158",
        "patch": "@@ -49,10 +49,7 @@ static const int fHaveUPnP = false;\n #endif\n \n \n-// Put \"/P2SH/\" in the coinbase so everybody can tell when\n-// a majority of miners support it\n-static const char* pszP2SH = \"/P2SH/\";\n-static const CScript COINBASE_FLAGS = CScript() << std::vector<unsigned char>(pszP2SH, pszP2SH+strlen(pszP2SH));\n+extern CScript COINBASE_FLAGS;\n \n \n "
      },
      {
        "sha": "049297706c59d6da743e0616f1f346bd11fd4e15",
        "filename": "src/util.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7bf8b7c25c944110dbe85ef9e4eebd858da34158/src/util.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7bf8b7c25c944110dbe85ef9e4eebd858da34158/src/util.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util.cpp?ref=7bf8b7c25c944110dbe85ef9e4eebd858da34158",
        "patch": "@@ -488,7 +488,7 @@ bool SoftSetArg(const std::string& strArg, const std::string& strValue)\n     return true;\n }\n \n-bool SoftSetArg(const std::string& strArg, bool fValue)\n+bool SoftSetBoolArg(const std::string& strArg, bool fValue)\n {\n     if (fValue)\n         return SoftSetArg(strArg, std::string(\"1\"));"
      },
      {
        "sha": "8f86ba01804aa8c56ebd15b4ffde73b5e72e3804",
        "filename": "src/util.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7bf8b7c25c944110dbe85ef9e4eebd858da34158/src/util.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7bf8b7c25c944110dbe85ef9e4eebd858da34158/src/util.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util.h?ref=7bf8b7c25c944110dbe85ef9e4eebd858da34158",
        "patch": "@@ -442,7 +442,7 @@ bool SoftSetArg(const std::string& strArg, const std::string& strValue);\n  * @param fValue Value (e.g. false)\n  * @return true if argument gets set, false if it already had a value\n  */\n-bool SoftSetArg(const std::string& strArg, bool fValue);\n+bool SoftSetBoolArg(const std::string& strArg, bool fValue);\n \n \n "
      }
    ]
  }
]