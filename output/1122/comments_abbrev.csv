laanwj,2012-04-18T05:25:40Z,"The 'signed char' doesn't really make me happy. We use 'char' with the implicit assumption that it's signed all over the code base. Many programs do this. We make worse assumptions about data types (see #888). Changing this assumptions will require quite some thought especially in serialize.h.\n\nWhy not just pass `-fsigned-char` for now?\n\nACK on adding an entry/comma, good catch\n",https://github.com/bitcoin/bitcoin/pull/1122#issuecomment-5192114,5192114,
dlitz,2012-04-18T05:46:47Z,Assuming that 'char' is signed is a bug; ISO C and C++ leave it undefined.  The fact that Satoshi's prototype was a little bit sloppy isn't much of a reason to never fix these bugs.\n\nIs -fsigned-char portable?  (Does clang support it?)  What happens when you link against a library that defines char differently?\n\nSince I've already put in the effort of finding these and submitting a patch to fi,https://github.com/bitcoin/bitcoin/pull/1122#issuecomment-5192297,5192297,
laanwj,2012-04-18T05:50:51Z,"Yes, clang supports that option. So does MSVC2010. Linking against a library that defines char otherwise should not be a problem as the in-memory representation is the same.\n\nI agree that it's no reason to never fix these, but have you checked all other places where char is used? Are you sure that unsigned chars won't break on some obscure serialization cases? (that are currently not covered by ",https://github.com/bitcoin/bitcoin/pull/1122#issuecomment-5192331,5192331,
laanwj,2012-04-18T06:02:41Z,"Eventually the fix would be to forbid the usage of plain `char` completely, and define our own typedefs for signed and unsigned char (or use posix `uint8_t` / `int8_t`, even better as we assume 8-bitness?), and force the use of those everywhere. \n\nEdit: but don't get me wrong, I'm not opposed to accepting this. I'm just wary that it might not solve the entire issue.\n",https://github.com/bitcoin/bitcoin/pull/1122#issuecomment-5192436,5192436,
dlitz,2012-04-18T13:41:20Z,"Actually, not every use of `char` needs to be changed.  Cases where `char` refers to the characters of a human-readable string should be left as-is (since things like `open` use `const char *`).\n\nI searched for every instance of `char`, and skipped anything that looked like it was just ordinary string handling.  GCC was helpful, because it gave warnings where `>= 0` checks were being done on an ",https://github.com/bitcoin/bitcoin/pull/1122#issuecomment-5198669,5198669,
laanwj,2012-04-19T07:04:06Z,I don't have specific suggestions. If you check(ed) all occurrences of char it should be OK.\n,https://github.com/bitcoin/bitcoin/pull/1122#issuecomment-5216045,5216045,
sipa,2012-04-20T14:08:44Z,"All changes to unsigned seem safe to me, and changes to signed will not influence any current;y supported platform. ACK.\n",https://github.com/bitcoin/bitcoin/pull/1122#issuecomment-5244737,5244737,
luke-jr,2012-04-20T15:20:45Z,"I concur with sipa on a read-over basis, but comparing the object files produced (on x86) reveal some disturbing (to me, as someone who isn't familiar with x86 assembly) differences...\n\nThe following object files are changed: bitcoinrpc, checkpoints, main, script, Checkpoints_tests, miner_tests\n\nHere is a diff of the assembly in script: http://paste.pocoo.org/show/584682/\n",https://github.com/bitcoin/bitcoin/pull/1122#issuecomment-5246432,5246432,
laanwj,2012-04-20T15:29:04Z,"@luke-jr: a lot of those seem different function names to calls? (but same binary representation)\n\nIf you want a fair comparison you should remove the ',' from phexdigit, so that the array will stay 255 bytes. (don't know if you did that already)\n\nAlso gcc tends to be quite weird, in that small unrelated changes can seemingly randomly change how certain optimizations are done.\n\nEdit: I'm try",https://github.com/bitcoin/bitcoin/pull/1122#issuecomment-5246633,5246633,
luke-jr,2012-04-20T15:51:37Z,I was only comparing the tip of this pullreq.\n,https://github.com/bitcoin/bitcoin/pull/1122#issuecomment-5247217,5247217,
dlitz,2012-04-20T16:07:05Z,"@luke-jr  That's weird.  On my machine, I only see these differences for script.o: http://paste.pocoo.org/show/584704/\n",https://github.com/bitcoin/bitcoin/pull/1122#issuecomment-5247582,5247582,
laanwj,2012-04-20T16:24:18Z,"The `callq  50 <CScript::DecodeOP_N(opcodetype)+0x50>` must be the call to `__assert_fail` (called if eax<=0x50 or >0x60, which matches the `opcode >= OP_1 && opcode <= OP_16` expression ). So a different argument is passed when the assert fails, we can live with that, I guess.\n\nEdit: objdump -rCd confirms this suspicion. The argument that differs is the line number. Pretty boring :)\nEdit.2: th",https://github.com/bitcoin/bitcoin/pull/1122#issuecomment-5247951,5247951,
sipa,2012-04-20T16:55:50Z,ACK\n,https://github.com/bitcoin/bitcoin/pull/1122#issuecomment-5248528,5248528,
dlitz,2012-04-21T16:04:31Z,"Thanks, guys!\n",https://github.com/bitcoin/bitcoin/pull/1122#issuecomment-5261492,5261492,
