paveljanik,2016-10-23T16:19:41Z,"Concept ACK\n\nWhile trying to test this, I have got:\n\n```\nAssertion failed: (nMaxInbound > 0), function AcceptConnection, file net.cpp, line 973.\n```\n\nalmost immediately I pressed the network toggle icon.\n\nWhen the network is toggled off, the icon is hidden and I can't turn the network back on without trying to click in the empty space...\n",https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-255597649,255597649,
paveljanik,2016-10-23T16:39:37Z,"There is a commit for RPC `togglenetwork` (f83a1e2bd83625997916963fe8b1942e504070ab), but it is renamed later, so commits do not match.\n\nThe RPC test is still named `togglenetwork` (https://github.com/bitcoin/bitcoin/pull/8996/files#diff-b89234789a9a9ee29cb0758f69a73133R87).\n",https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-255598783,255598783,
paveljanik,2016-10-23T16:48:05Z,"During startup, when there is 1 outgoing connection only:\n\n```\n2016-10-23 16:44:42 SetNetworkActive: false\n2016-10-23 16:44:42 disconnecting peer=1\n2016-10-23 16:44:42 socket select error Bad file descriptor (9)\n2016-10-23 16:44:42 disconnecting peer=2\nnMaxConnections = 8\nnMaxFeeler = 1\nnMaxOutbound = 8\nnMaxInbound = -1\nAssertion failed: (nMaxInbound > 0), function AcceptConnection, fil",https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-255599302,255599302,
luke-jr,2016-10-23T17:05:54Z,"> `Assertion failed: (nMaxInbound > 0), function AcceptConnection, file net.cpp, line 973.`\n\nI don't believe this can be related to this PR...\n\n> When the network is toggled off, the icon is hidden and I can't turn the network back on without trying to click in the empty space...\n\nSounds like a build system problem - it didn't update the resources with the new icon?\n\n> There is a commit fo",https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-255600344,255600344,
paveljanik,2016-10-23T17:33:59Z,"The missing icon issue was local one, yes (solved by clean build). Sorry for confusion.\n\nThe icon should probably contain some visual reference to the network (compare with the no-HD icon). I can't create screenshot because it aborts almost immediately here.\n",https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-255601894,255601894,
paveljanik,2016-10-24T17:06:51Z,"It works as designed. Icon in the UI flips on RPC calls, can be clicked, nice tooltips, it works.\n\nWhen the network is disabled, it looks like this (with non-HD wallet):\n\n<img width=""94"" alt=""screen shot 2016-10-24 at 18 58 52"" src=""https://cloud.githubusercontent.com/assets/6848764/19655388/f7ce6568-9a1b-11e6-96b1-7d56ef992ab9.png"">\n\nI still think that it should be done in 2 commits instead",https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-255801972,255801972,
EthanHeilman,2016-10-24T22:53:07Z,"@paveljanik At the risk of stating the obvious if nMaxConnections is set to 8 then nMaxInbound will be set to -1 triggering the assert.\n\n``` c++\nint nMaxInbound = nMaxConnections - (nMaxOutbound + nMaxFeeler);\nassert(nMaxInbound > 0);\n```\n\nThe value nMaxConnections is typically set to 125, I don't understand how it is getting set to 8, perhaps the system is running low on available sockets?",https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-255888768,255888768,
sipa,2016-10-24T22:55:57Z,@EthanHeilman nMaxConnections is user configurable. I typically set it to 3 on low-memory devices.\n,https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-255889255,255889255,
luke-jr,2016-10-25T01:58:19Z,I think the assert failure with a low maxconnections is an issue unrelated to this PR.\n,https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-255915358,255915358,
sipa,2016-10-25T04:45:40Z,"@luke-jr @EthanHeilman Indeed, let's move to #9007.\n",https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-255935418,255935418,
paveljanik,2016-11-04T18:52:59Z,I think this is very useful function for some users. Please review.\n,https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-258517991,258517991,
paveljanik,2016-11-10T08:37:40Z,"@jonasschnelli Jonas, can you please have a look?\n",https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-259631596,259631596,
jonasschnelli,2016-11-10T08:42:57Z,"The reason why I'm waiting for this are the conceptual NACK's on the previous attempt to get this in: https://github.com/bitcoin/bitcoin/pull/5314\n\nSome devs where claiming that we need a better solution then just disabling the network connection. Ideally, this mode should connect to the p2p network in case you have uncommitted wtxs.\n\nI'd like to get more Concept ACKs from others.\nI always li",https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-259632638,259632638,
paveljanik,2016-11-10T08:49:46Z,"The previous NACK (there was one ;-) was about `togglenetwork` interface. This was removed.\n\nWallet showing wrong info without network is the current state anyway. We could slide the ""gray overlay"" up as we do during IBD to make it clear!\n",https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-259633886,259633886,
paveljanik,2016-11-10T21:09:26Z,"Some more thoughts about this: it depends how you look at this. So far, my view was as simple as follows. I do not care at all about the displayed stuff in the GUI, I just want GUI to immediately stop all communication. Be it if I plan to connect to the untrusted network, or slow network at parents', or limited usage network where every eight connections to the outside mean that no one else being ",https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-259808151,259808151,
jonasschnelli,2016-11-11T10:11:50Z,"Tested ACK 19f46f177ec5e1913f9be5b257dad95bc7a57c38.\n\nWould be nice if we would at least add a tooltip ""Press to enable/disable network activity"" over the connection statusbar icon. From the GUI perspective, it's kind of a hidden feature right now.\n",https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-259925277,259925277,
jonasschnelli,2016-11-11T19:21:58Z,Sorry. This merge was a little bit pro active.\n,https://github.com/bitcoin/bitcoin/pull/8996#issuecomment-260034540,260034540,
paveljanik,2016-10-23T17:31:47Z,`_clientModel` please to prevent shadowing.\n,https://github.com/bitcoin/bitcoin/pull/8996#discussion_r84600124,84600124,src/qt/bitcoingui.cpp
luke-jr,2016-10-24T07:34:50Z,done\n,https://github.com/bitcoin/bitcoin/pull/8996#discussion_r84633065,84633065,src/qt/bitcoingui.cpp
sipa,2016-11-11T12:53:45Z,No locking?\n,https://github.com/bitcoin/bitcoin/pull/8996#discussion_r87583724,87583724,src/net.cpp
jonasschnelli,2016-11-11T12:55:25Z,"Oh! I though this was a `std::atomic<bool>`, but it's a plain bool.\n",https://github.com/bitcoin/bitcoin/pull/8996#discussion_r87583927,87583927,src/net.cpp
