MarcoFalke,2016-09-04T12:28:22Z,"Please squash your commits according to https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#squashing-commits\n\nAlso, I was wondering how much is left until we can enable Wshadow\n",https://github.com/bitcoin/bitcoin/pull/8655#issuecomment-244600812,244600812,
paveljanik,2016-09-04T12:31:09Z,"I can squash when the review is finished, no problem. I think it is much easier reviewing separately.\n",https://github.com/bitcoin/bitcoin/pull/8655#issuecomment-244600965,244600965,
MarcoFalke,2016-09-04T21:14:54Z,@paveljanik The diff is just 20 lines and I think trying to compile before/after and compare the objdump is sufficient to review. (Maybe skim over the diff once)\nThis is achieved easily when there is only one commit.\n,https://github.com/bitcoin/bitcoin/pull/8655#issuecomment-244629172,244629172,
paveljanik,2016-09-05T05:09:58Z,Squashed.\n,https://github.com/bitcoin/bitcoin/pull/8655#issuecomment-244659894,244659894,
paveljanik,2016-09-15T07:28:29Z,Please review.\n,https://github.com/bitcoin/bitcoin/pull/8655#issuecomment-247256593,247256593,
paveljanik,2016-09-19T13:15:20Z,`pagelocker` going to be removed in #8753...\n,https://github.com/bitcoin/bitcoin/pull/8655#issuecomment-247989599,247989599,
paveljanik,2016-09-26T15:10:06Z,Squashed.\n,https://github.com/bitcoin/bitcoin/pull/8655#issuecomment-249598713,249598713,
laanwj,2016-09-27T06:50:16Z,"Two functions differ:\n\n```\nLockedPageManagerBase<MemoryPageLocker>::LockedPageManagerBase(unsigned long)\nTorController::TorController(event_base*, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&)\n```\n\nFrom a quick look at the assembly differences it looks like the same problem as before.\n",https://github.com/bitcoin/bitcoin/pull/8655#issuecomment-249780921,249780921,
paveljanik,2016-09-27T07:02:15Z,The first one is clear (`page_size` in the body to `_page_size`). The second one `target` -> `_target`.\nBoth are stupid to be done IMO 8)\n,https://github.com/bitcoin/bitcoin/pull/8655#issuecomment-249782820,249782820,
paveljanik,2016-09-27T07:25:49Z,But done... And squashed. The diff is a bit longer now.\n,https://github.com/bitcoin/bitcoin/pull/8655#issuecomment-249786832,249786832,
MarcoFalke,2016-09-27T09:00:47Z,Identical binaries ACK 4731cab\n,https://github.com/bitcoin/bitcoin/pull/8655#issuecomment-249807487,249807487,
fanquake,2016-09-27T09:49:12Z,@MarcoFalke What tool are you using to generate the identical binary results?\n,https://github.com/bitcoin/bitcoin/pull/8655#issuecomment-249818586,249818586,
laanwj,2016-09-27T10:01:07Z,"I've put up my script here: https://github.com/laanwj/bitcoin-maintainer-tools\n\nBTW: I don't get identical `bitcoind` binaries for 2f71490 and 4731cab but don't see any function-level differences, will investigate further.\n",https://github.com/bitcoin/bitcoin/pull/8655#issuecomment-249821287,249821287,
laanwj,2016-09-27T10:15:12Z,"OK, found the reason:\n\n``` patch\n-2f71490.o/src/support/libbitcoin_util_a-pagelocker.o:     file format elf64-x86-64\n+4731cab.o/src/support/libbitcoin_util_a-pagelocker.o:     file format elf64-x86-64\n\n Contents of section .group:\n  0000 01000000 57000000                    ....W...        \n@@ -314,9 +314,9 @@\n  0000 626f6f73 743a3a20 6d757465 7820636f  boost:: mutex co\n  0010 6e737472 7",https://github.com/bitcoin/bitcoin/pull/8655#issuecomment-249824329,249824329,
MarcoFalke,2016-09-27T12:13:42Z,"Huh, I did not disable assertions. Just building as usual and making sure that the clientversion does not influence the binaries. Then calling `objdump -d` and diff the output.\n",https://github.com/bitcoin/bitcoin/pull/8655#issuecomment-249847270,249847270,
laanwj,2016-09-27T13:14:35Z,"> Then calling objdump -d and diff the output.\n\nOk, that explains it, because that doesn't detect changes in data sections. I always diff the assembly as well as comparing sha256sums of the stripped executables just in case.\n",https://github.com/bitcoin/bitcoin/pull/8655#issuecomment-249861064,249861064,
MarcoFalke,2016-09-15T10:25:39Z,I think this patch changes the binaries.\n,https://github.com/bitcoin/bitcoin/pull/8655#discussion_r78932552,78932552,src/reverselock.h
paveljanik,2016-09-15T11:35:20Z,"Interesting. I do not see why it should change binaries, but will investigate.\n",https://github.com/bitcoin/bitcoin/pull/8655#discussion_r78943491,78943491,src/reverselock.h
paveljanik,2016-09-22T18:08:00Z,Wladimir investigated in #8793. It changes the binaries.\n\nTechnically it can be done by changing `lock` to `_lock` in the body of the function. But we decided that it is wrong to do that.\n,https://github.com/bitcoin/bitcoin/pull/8655#discussion_r80101564,80101564,src/reverselock.h
laanwj,2016-09-26T13:48:41Z,"Well in the case of the GUI that was the decision, as an exception.\n\nAs I said there, for the consensus code I would require the binaries to be the same. This is much closer to that.\n",https://github.com/bitcoin/bitcoin/pull/8655#discussion_r80478206,80478206,src/reverselock.h
paveljanik,2016-09-26T14:48:49Z,"OK then, going to add squashme commit fixing this.\n",https://github.com/bitcoin/bitcoin/pull/8655#discussion_r80492180,80492180,src/reverselock.h
MarcoFalke,2016-09-26T14:52:44Z,Can you also squash it? Otherwise no one can start review to check if the binaries are the same.\n,https://github.com/bitcoin/bitcoin/pull/8655#discussion_r80493166,80493166,src/reverselock.h
paveljanik,2016-09-26T14:55:51Z,Why you can't start to check if it is not squashed? I do not understand...\n,https://github.com/bitcoin/bitcoin/pull/8655#discussion_r80493913,80493913,src/reverselock.h
paveljanik,2016-09-26T14:56:30Z,Having the squashme commit clearly marked enables us to discuss the change needed.\n,https://github.com/bitcoin/bitcoin/pull/8655#discussion_r80494064,80494064,src/reverselock.h
paveljanik,2016-09-26T14:58:51Z,"And if you need all-in-one diff, you can use https://patch-diff.githubusercontent.com/raw/bitcoin/bitcoin/pull/8655.diff\n",https://github.com/bitcoin/bitcoin/pull/8655#discussion_r80494726,80494726,src/reverselock.h
paveljanik,2016-09-26T15:00:08Z,"In this particular case, the requirement for same-binary makes the diff longer than needed. But I agree that in this case, it is better to have the same binary just to be sure.\n",https://github.com/bitcoin/bitcoin/pull/8655#discussion_r80495100,80495100,src/reverselock.h
MarcoFalke,2016-09-26T15:01:17Z,"Well, I don't want to redo the check a third time when you squash.\n",https://github.com/bitcoin/bitcoin/pull/8655#discussion_r80495368,80495368,src/reverselock.h
paveljanik,2016-09-26T15:07:06Z,I understand this ;-)\n,https://github.com/bitcoin/bitcoin/pull/8655#discussion_r80496696,80496696,src/reverselock.h
MarcoFalke,2016-09-26T20:03:10Z,"Thanks. Though, it seems I still don't get identical binaries. Could you try to create a pull with a single commit and combine #8655 + #8808 with all the changes that don't change the binary? Then we could evaluate the remaining (problematic) hunks separate from those.\n",https://github.com/bitcoin/bitcoin/pull/8655#discussion_r80559884,80559884,src/reverselock.h
paveljanik,2016-09-26T20:11:35Z,@laanwj Can ask you to do your different-binary-function analysis on this PR? Or better: can you publish your tool? ;-)\n,https://github.com/bitcoin/bitcoin/pull/8655#discussion_r80561625,80561625,src/reverselock.h
laanwj,2016-09-27T06:46:52Z,"I'll take a look. Aand maybe release the script, though it's a Chthonic monstriosity with tentacles spreading to other unpublished tools, so I have to figure out what to collect along the way.\n",https://github.com/bitcoin/bitcoin/pull/8655#discussion_r80628693,80628693,src/reverselock.h
