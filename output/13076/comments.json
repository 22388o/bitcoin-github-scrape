[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/385424120",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#issuecomment-385424120",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13076",
    "id": 385424120,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTQyNDEyMA==",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?u=a1574ca2038ff1dfaa9a7764c59ea5ff4f305b5d&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-30T14:56:45Z",
    "updated_at": "2018-04-30T14:56:45Z",
    "author_association": "MEMBER",
    "body": "Dropped explicit values and type from `ScanResult` enum.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/385424120/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/386373196",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#issuecomment-386373196",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13076",
    "id": 386373196,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NjM3MzE5Ng==",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?u=a1574ca2038ff1dfaa9a7764c59ea5ff4f305b5d&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-03T17:27:51Z",
    "updated_at": "2018-05-03T17:27:51Z",
    "author_association": "MEMBER",
    "body": "Rebased and updated to accommodate #12507.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/386373196/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/390325991",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#issuecomment-390325991",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13076",
    "id": 390325991,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MDMyNTk5MQ==",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?u=a1574ca2038ff1dfaa9a7764c59ea5ff4f305b5d&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-18T20:39:55Z",
    "updated_at": "2018-05-18T20:39:55Z",
    "author_association": "MEMBER",
    "body": "Rebased and moved the shutdown / abort handling inline.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/390325991/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/408684612",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#issuecomment-408684612",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13076",
    "id": 408684612,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQwODY4NDYxMg==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-07-29T15:16:54Z",
    "updated_at": "2018-12-07T00:27:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#14711](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14711.html) (Remove uses of chainActive and mapBlockIndex in wallet code by ryanofsky)\n* [#14624](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14624.html) (Some simple improvements to the RNG code by sipa)\n* [#10973](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/10973.html) (Refactor: separate wallet from node by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/408684612/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/436755220",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#issuecomment-436755220",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13076",
    "id": 436755220,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNjc1NTIyMA==",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?u=a1574ca2038ff1dfaa9a7764c59ea5ff4f305b5d&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-07T19:51:50Z",
    "updated_at": "2018-11-07T19:51:50Z",
    "author_association": "MEMBER",
    "body": "Rebased. @MarcoFalke could you remove \"Up for grabs\"?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/436755220/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/437672072",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#issuecomment-437672072",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13076",
    "id": 437672072,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNzY3MjA3Mg==",
    "user": {
      "login": "meshcollider",
      "id": 3211283,
      "node_id": "MDQ6VXNlcjMyMTEyODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3211283?u=447cdc9e2966cbee415545c8ff452954ee1209af&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/meshcollider",
      "html_url": "https://github.com/meshcollider",
      "followers_url": "https://api.github.com/users/meshcollider/followers",
      "following_url": "https://api.github.com/users/meshcollider/following{/other_user}",
      "gists_url": "https://api.github.com/users/meshcollider/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/meshcollider/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/meshcollider/subscriptions",
      "organizations_url": "https://api.github.com/users/meshcollider/orgs",
      "repos_url": "https://api.github.com/users/meshcollider/repos",
      "events_url": "https://api.github.com/users/meshcollider/events{/privacy}",
      "received_events_url": "https://api.github.com/users/meshcollider/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-11T13:54:27Z",
    "updated_at": "2018-11-11T13:55:34Z",
    "author_association": "MEMBER",
    "body": "Concept ACK / light-utACK https://github.com/bitcoin/bitcoin/pull/13076/commits/b52abc7164ba6403124e409af2e3ee2e2dad7f24\r\n\r\nI agree with Marco that returning the last successful block is probably a good idea, but with that and the other comments, at least this doesn't appear to make things worse, so it could be addressed in follow-ups if not here :)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/437672072/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/437687206",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#issuecomment-437687206",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13076",
    "id": 437687206,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNzY4NzIwNg==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-11T17:12:12Z",
    "updated_at": "2018-11-11T17:12:12Z",
    "author_association": "CONTRIBUTOR",
    "body": "> I agree with Marco that returning the last successful block is probably a good idea\r\n\r\nReturning the last failed block instead of the last successful block is needed for importmulti. Importmulti uses the last failed block to return success for keys with birthdays after that block, and failures for keys with older birthdays.\r\n\r\nI tried to clarify this in #12275 by returning both values (`last_scanned` and `last_failed`):\r\n\r\n```c++\r\n    struct ScanResult\r\n    {\r\n        const CBlockIndex* first_scanned = nullptr;\r\n        const CBlockIndex* last_scanned = nullptr;\r\n        const CBlockIndex* first_failed = nullptr;\r\n        const CBlockIndex* last_failed = nullptr;\r\n    };\r\n```\r\n\r\nWhich I still think would be an improvement over the current code.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/437687206/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/437718184",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#issuecomment-437718184",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13076",
    "id": 437718184,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNzcxODE4NA==",
    "user": {
      "login": "meshcollider",
      "id": 3211283,
      "node_id": "MDQ6VXNlcjMyMTEyODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3211283?u=447cdc9e2966cbee415545c8ff452954ee1209af&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/meshcollider",
      "html_url": "https://github.com/meshcollider",
      "followers_url": "https://api.github.com/users/meshcollider/followers",
      "following_url": "https://api.github.com/users/meshcollider/following{/other_user}",
      "gists_url": "https://api.github.com/users/meshcollider/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/meshcollider/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/meshcollider/subscriptions",
      "organizations_url": "https://api.github.com/users/meshcollider/orgs",
      "repos_url": "https://api.github.com/users/meshcollider/repos",
      "events_url": "https://api.github.com/users/meshcollider/events{/privacy}",
      "received_events_url": "https://api.github.com/users/meshcollider/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-12T00:02:04Z",
    "updated_at": "2018-11-12T00:02:04Z",
    "author_association": "MEMBER",
    "body": "@ryanofsky I think I mis-explained, I mean in the case of success - the failure case behaviour should remain unchanged",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/437718184/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/438214691",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#issuecomment-438214691",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13076",
    "id": 438214691,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzODIxNDY5MQ==",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?u=a1574ca2038ff1dfaa9a7764c59ea5ff4f305b5d&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-13T10:25:41Z",
    "updated_at": "2018-11-13T10:25:41Z",
    "author_association": "MEMBER",
    "body": "@MarcoFalke see the stop_block commit above. Any idea where the test failures are coming from? I don\u2019t see the connection.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/438214691/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/446321844",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#issuecomment-446321844",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13076",
    "id": 446321844,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NjMyMTg0NA==",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?u=eab5d0cdbb6cc25087cb61d4ca4a6f85255f42a7&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-11T19:04:17Z",
    "updated_at": "2018-12-11T19:04:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "utACK bd3b0361d840bff95988a048abf70ade94d80524",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/446321844/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/446334894",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#issuecomment-446334894",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13076",
    "id": 446334894,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NjMzNDg5NA==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-11T19:41:15Z",
    "updated_at": "2018-12-11T19:41:15Z",
    "author_association": "MEMBER",
    "body": "utACK bd3b0361d8",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/446334894/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/446462701",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#issuecomment-446462701",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13076",
    "id": 446462701,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ0NjQ2MjcwMQ==",
    "user": {
      "login": "meshcollider",
      "id": 3211283,
      "node_id": "MDQ6VXNlcjMyMTEyODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3211283?u=447cdc9e2966cbee415545c8ff452954ee1209af&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/meshcollider",
      "html_url": "https://github.com/meshcollider",
      "followers_url": "https://api.github.com/users/meshcollider/followers",
      "following_url": "https://api.github.com/users/meshcollider/following{/other_user}",
      "gists_url": "https://api.github.com/users/meshcollider/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/meshcollider/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/meshcollider/subscriptions",
      "organizations_url": "https://api.github.com/users/meshcollider/orgs",
      "repos_url": "https://api.github.com/users/meshcollider/repos",
      "events_url": "https://api.github.com/users/meshcollider/events{/privacy}",
      "received_events_url": "https://api.github.com/users/meshcollider/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-12-12T05:00:05Z",
    "updated_at": "2018-12-12T05:00:05Z",
    "author_association": "MEMBER",
    "body": "utACK https://github.com/bitcoin/bitcoin/pull/13076/commits/bd3b0361d840bff95988a048abf70ade94d80524",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/446462701/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184197927",
    "pull_request_review_id": 115344796,
    "id": 184197927,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDE5NzkyNw==",
    "diff_hunk": "@@ -3767,16 +3767,13 @@ UniValue rescanblockchain(const JSONRPCRequest& request)\n         }\n     }\n \n-    CBlockIndex *stopBlock = pwallet->ScanForWalletTransactions(pindexStart, pindexStop, reserver, true);\n-    if (!stopBlock) {\n-        if (pwallet->IsAbortingRescan()) {\n-            throw JSONRPCError(RPC_MISC_ERROR, \"Rescan aborted.\");\n-        }\n-        // if we got a nullptr returned, ScanForWalletTransactions did rescan up to the requested stopindex\n+    const CBlockIndex* stopBlock = nullptr;\n+    if (pwallet->ScanForWalletTransactions(pindexStart, pindexStop, stopBlock, reserver, true)) {\n         stopBlock = pindexStop ? pindexStop : pChainTip;\n-    }\n-    else {\n-        throw JSONRPCError(RPC_MISC_ERROR, \"Rescan failed. Potentially corrupted data files.\");\n+    } else if (pwallet->IsAbortingRescan()) {\n+        throw JSONRPCError(RPC_MISC_ERROR, \"Rescan aborted.\");\n+    } else {\n+        throw JSONRPCError(RPC_MISC_ERROR, strprintf(\"Rescan failed. Potentially corrupted data files. Failed at height %i.\", stopBlock->nHeight));",
    "path": "src/wallet/rpcwallet.cpp",
    "position": null,
    "original_position": 19,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "25a588ac2f66d658accf4dc9bc0f2710efab61ba",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Note I added the failure height here. Happy to remove, but I assume it could be helpful.",
    "created_at": "2018-04-25T20:37:14Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184197927",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184197927"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184197927"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184197927/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3737,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184198224",
    "pull_request_review_id": 115345173,
    "id": 184198224,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDE5ODIyNA==",
    "diff_hunk": "@@ -4167,11 +4167,11 @@ CWallet* CWallet::CreateWalletFromFile(const std::string& name, const fs::path&\n         nStart = GetTimeMillis();\n         {\n             WalletRescanReserver reserver(walletInstance);\n-            if (!reserver.reserve()) {\n+            const CBlockIndex* stop_block = nullptr;\n+            if (!reserver.reserve() || !walletInstance->ScanForWalletTransactions(pindexRescan, nullptr, stop_block, reserver, true)) {",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 61,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "25a588ac2f66d658accf4dc9bc0f2710efab61ba",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Note this did not previously fail when ScanForWalletTransactions failed, so this removes a silent failure.",
    "created_at": "2018-04-25T20:38:19Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184198224",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184198224"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184198224"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184198224/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 4172,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184207815",
    "pull_request_review_id": 115357055,
    "id": 184207815,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDIwNzgxNQ==",
    "diff_hunk": "@@ -1791,7 +1791,7 @@ CBlockIndex* CWallet::ScanForWalletTransactions(CBlockIndex* pindexStart, CBlock\n         }\n         ShowProgress(_(\"Rescanning...\"), 100); // hide progress dialog in GUI\n     }\n-    return ret;\n+    return (!fAbortRescan && !failed_block);",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 62,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "821c955a15f21865d37fa84e68df99539ad1438a",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Alternatively, this could be `(!pindex && !failed_block)`",
    "created_at": "2018-04-25T21:14:19Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184207815",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184207815"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184207815"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184207815/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1795,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184241541",
    "pull_request_review_id": 115396841,
    "id": 184241541,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDI0MTU0MQ==",
    "diff_hunk": "@@ -1763,14 +1764,14 @@ CBlockIndex* CWallet::ScanForWalletTransactions(CBlockIndex* pindexStart, CBlock\n                 if (pindex && !chainActive.Contains(pindex)) {\n                     // Abort scan if current block is no longer active, to prevent\n                     // marking transactions as coming from the wrong block.\n-                    ret = pindex;\n+                    failed_block = pindex;",
    "path": "src/wallet/wallet.cpp",
    "position": 68,
    "original_position": 48,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "2c4bc0018bbf41c5f853ca24759a1ee4b0dd5a76",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think you might want to drop this line and just return true here, to fix the regression described here: https://github.com/bitcoin/bitcoin/pull/12275#issuecomment-360864576.",
    "created_at": "2018-04-26T00:17:38Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184241541",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184241541"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184241541"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184241541/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1693,
    "original_line": 1691,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184296308",
    "pull_request_review_id": 115461321,
    "id": 184296308,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDI5NjMwOA==",
    "diff_hunk": "@@ -1708,9 +1709,10 @@ int64_t CWallet::RescanFromTime(int64_t startTime, const WalletRescanReserver& r\n  * from or to us. If fUpdate is true, found transactions that already\n  * exist in the wallet will be updated.\n  *\n- * Returns null if scan was successful. Otherwise, if a complete rescan was not\n- * possible (due to pruning or corruption), returns pointer to the most recent\n- * block that could not be scanned.\n+ * Returns true if scan was successful. If a complete rescan was not\n+ * possible (due to pruning or corruption), returns false and sets failed_block\n+ * to the most recent block that could not be scanned. If the rescan was aborted\n+ * before it could complete, returns false and does not set failed_block.",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 20,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "2c4bc0018bbf41c5f853ca24759a1ee4b0dd5a76",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Not sure if in this PR, but would it make sense to just return an `enum` to better distinct between `fail`, `ok` and `user-aborted`?",
    "created_at": "2018-04-26T07:43:41Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184296308",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184296308"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184296308"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184296308/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1715,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184324009",
    "pull_request_review_id": 115494020,
    "id": 184324009,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDMyNDAwOQ==",
    "diff_hunk": "@@ -1719,7 +1721,7 @@ int64_t CWallet::RescanFromTime(int64_t startTime, const WalletRescanReserver& r\n  * the main chain after to the addition of any new keys you want to detect\n  * transactions for.\n  */\n-CBlockIndex* CWallet::ScanForWalletTransactions(CBlockIndex* pindexStart, CBlockIndex* pindexStop, const WalletRescanReserver &reserver, bool fUpdate)\n+bool CWallet::ScanForWalletTransactions(const CBlockIndex* const pindexStart, const CBlockIndex* const pindexStop, const CBlockIndex*& failed_block, const WalletRescanReserver& reserver, bool fUpdate)",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 29,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "2c4bc0018bbf41c5f853ca24759a1ee4b0dd5a76",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "*Output* arguments could be last?",
    "created_at": "2018-04-26T09:23:11Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184324009",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184324009"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184324009"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184324009/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1724,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184324842",
    "pull_request_review_id": 115494020,
    "id": 184324842,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDMyNDg0Mg==",
    "diff_hunk": "@@ -1708,9 +1709,10 @@ int64_t CWallet::RescanFromTime(int64_t startTime, const WalletRescanReserver& r\n  * from or to us. If fUpdate is true, found transactions that already\n  * exist in the wallet will be updated.\n  *\n- * Returns null if scan was successful. Otherwise, if a complete rescan was not\n- * possible (due to pruning or corruption), returns pointer to the most recent\n- * block that could not be scanned.\n+ * Returns true if scan was successful. If a complete rescan was not\n+ * possible (due to pruning or corruption), returns false and sets failed_block\n+ * to the most recent block that could not be scanned. If the rescan was aborted\n+ * before it could complete, returns false and does not set failed_block.",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 20,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "2c4bc0018bbf41c5f853ca24759a1ee4b0dd5a76",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Could be done here IMO, not a big change and would be a lot better IMO.",
    "created_at": "2018-04-26T09:25:56Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184324842",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184324842"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184324842"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184324842/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1715,
    "side": "RIGHT",
    "in_reply_to_id": 184296308
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184325684",
    "pull_request_review_id": 115494020,
    "id": 184325684,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDMyNTY4NA==",
    "diff_hunk": "@@ -156,7 +156,8 @@ void TestGUI()\n         LOCK(cs_main);\n         WalletRescanReserver reserver(&wallet);\n         reserver.reserve();\n-        wallet.ScanForWalletTransactions(chainActive.Genesis(), nullptr, reserver, true);\n+        const CBlockIndex* stop_block = nullptr;\n+        wallet.ScanForWalletTransactions(chainActive.Genesis(), nullptr, stop_block, reserver, true);",
    "path": "src/qt/test/wallettests.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "2c4bc0018bbf41c5f853ca24759a1ee4b0dd5a76",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Could assert return value and `stop_block` value?",
    "created_at": "2018-04-26T09:28:55Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184325684",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184325684"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184325684"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184325684/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 160,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184326932",
    "pull_request_review_id": 115494020,
    "id": 184326932,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDMyNjkzMg==",
    "diff_hunk": "@@ -4167,11 +4167,11 @@ CWallet* CWallet::CreateWalletFromFile(const std::string& name, const fs::path&\n         nStart = GetTimeMillis();\n         {\n             WalletRescanReserver reserver(walletInstance);\n-            if (!reserver.reserve()) {\n+            const CBlockIndex* stop_block = nullptr;\n+            if (!reserver.reserve() || !walletInstance->ScanForWalletTransactions(pindexRescan, nullptr, stop_block, reserver, true)) {",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 61,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "25a588ac2f66d658accf4dc9bc0f2710efab61ba",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think this is ok. This just adds another case where `walletInstance` is leaked on error.",
    "created_at": "2018-04-26T09:33:12Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184326932",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184326932"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184326932"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184326932/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 4172,
    "side": "RIGHT",
    "in_reply_to_id": 184198224
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184414467",
    "pull_request_review_id": 115606121,
    "id": 184414467,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDQxNDQ2Nw==",
    "diff_hunk": "@@ -4167,11 +4167,11 @@ CWallet* CWallet::CreateWalletFromFile(const std::string& name, const fs::path&\n         nStart = GetTimeMillis();\n         {\n             WalletRescanReserver reserver(walletInstance);\n-            if (!reserver.reserve()) {\n+            const CBlockIndex* stop_block = nullptr;\n+            if (!reserver.reserve() || !walletInstance->ScanForWalletTransactions(pindexRescan, nullptr, stop_block, reserver, true)) {",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 61,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "25a588ac2f66d658accf4dc9bc0f2710efab61ba",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Should we be switching `walletInstance` to RAII then?",
    "created_at": "2018-04-26T14:40:58Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184414467",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184414467"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184414467"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184414467/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 4172,
    "side": "RIGHT",
    "in_reply_to_id": 184198224
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184416962",
    "pull_request_review_id": 115609299,
    "id": 184416962,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDQxNjk2Mg==",
    "diff_hunk": "@@ -4167,11 +4167,11 @@ CWallet* CWallet::CreateWalletFromFile(const std::string& name, const fs::path&\n         nStart = GetTimeMillis();\n         {\n             WalletRescanReserver reserver(walletInstance);\n-            if (!reserver.reserve()) {\n+            const CBlockIndex* stop_block = nullptr;\n+            if (!reserver.reserve() || !walletInstance->ScanForWalletTransactions(pindexRescan, nullptr, stop_block, reserver, true)) {",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 61,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "25a588ac2f66d658accf4dc9bc0f2710efab61ba",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@Empact done in #13063.",
    "created_at": "2018-04-26T14:47:46Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184416962",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184416962"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184416962"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184416962/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 4172,
    "side": "RIGHT",
    "in_reply_to_id": 184198224
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184887895",
    "pull_request_review_id": 116171339,
    "id": 184887895,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDg4Nzg5NQ==",
    "diff_hunk": "@@ -1763,14 +1764,14 @@ CBlockIndex* CWallet::ScanForWalletTransactions(CBlockIndex* pindexStart, CBlock\n                 if (pindex && !chainActive.Contains(pindex)) {\n                     // Abort scan if current block is no longer active, to prevent\n                     // marking transactions as coming from the wrong block.\n-                    ret = pindex;\n+                    failed_block = pindex;",
    "path": "src/wallet/wallet.cpp",
    "position": 68,
    "original_position": 48,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "2c4bc0018bbf41c5f853ca24759a1ee4b0dd5a76",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Not sure about that - my inclination is to maintain stricter checking at the risk of spurious failures over less strict checking at the risk of silent failure. How about opening a separate PR for that so it can be considered separately?\r\n",
    "created_at": "2018-04-29T16:11:35Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184887895",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184887895"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184887895"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184887895/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1693,
    "original_line": 1691,
    "side": "RIGHT",
    "in_reply_to_id": 184241541
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184888349",
    "pull_request_review_id": 116171857,
    "id": 184888349,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDg4ODM0OQ==",
    "diff_hunk": "@@ -1695,8 +1695,9 @@ int64_t CWallet::RescanFromTime(int64_t startTime, const WalletRescanReserver& r\n     }\n \n     if (startBlock) {\n-        const CBlockIndex* const failedBlock = ScanForWalletTransactions(startBlock, nullptr, reserver, update);\n-        if (failedBlock) {\n+        const CBlockIndex* failedBlock = nullptr;\n+        // TODO: this should take into account failure by ScanResult::USER_ABORTED",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 7,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "620581fca13cd4e0c72de0fafc1e071c8b144faf",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I'll address this todo in a follow-up.",
    "created_at": "2018-04-29T16:31:54Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184888349",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184888349"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184888349"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184888349/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1699,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184888353",
    "pull_request_review_id": 116171866,
    "id": 184888353,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDg4ODM1Mw==",
    "diff_hunk": "@@ -1708,9 +1709,10 @@ int64_t CWallet::RescanFromTime(int64_t startTime, const WalletRescanReserver& r\n  * from or to us. If fUpdate is true, found transactions that already\n  * exist in the wallet will be updated.\n  *\n- * Returns null if scan was successful. Otherwise, if a complete rescan was not\n- * possible (due to pruning or corruption), returns pointer to the most recent\n- * block that could not be scanned.\n+ * Returns true if scan was successful. If a complete rescan was not\n+ * possible (due to pruning or corruption), returns false and sets failed_block\n+ * to the most recent block that could not be scanned. If the rescan was aborted\n+ * before it could complete, returns false and does not set failed_block.",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 20,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "2c4bc0018bbf41c5f853ca24759a1ee4b0dd5a76",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Updated to return an enum.",
    "created_at": "2018-04-29T16:32:09Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184888353",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184888353"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184888353"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184888353/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1715,
    "side": "RIGHT",
    "in_reply_to_id": 184296308
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184913248",
    "pull_request_review_id": 116199064,
    "id": 184913248,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDkxMzI0OA==",
    "diff_hunk": "@@ -1719,7 +1721,7 @@ int64_t CWallet::RescanFromTime(int64_t startTime, const WalletRescanReserver& r\n  * the main chain after to the addition of any new keys you want to detect\n  * transactions for.\n  */\n-CBlockIndex* CWallet::ScanForWalletTransactions(CBlockIndex* pindexStart, CBlockIndex* pindexStop, const WalletRescanReserver &reserver, bool fUpdate)\n+bool CWallet::ScanForWalletTransactions(const CBlockIndex* const pindexStart, const CBlockIndex* const pindexStop, const CBlockIndex*& failed_block, const WalletRescanReserver& reserver, bool fUpdate)",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 29,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "2c4bc0018bbf41c5f853ca24759a1ee4b0dd5a76",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Made it second-to-last due to default value for update arg.",
    "created_at": "2018-04-30T05:29:22Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184913248",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184913248"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184913248"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184913248/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1724,
    "side": "RIGHT",
    "in_reply_to_id": 184324009
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184969265",
    "pull_request_review_id": 116266005,
    "id": 184969265,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDk2OTI2NQ==",
    "diff_hunk": "@@ -914,7 +914,13 @@ class CWallet final : public CCryptoKeyStore, public CValidationInterface\n     void BlockDisconnected(const std::shared_ptr<const CBlock>& pblock) override;\n     bool AddToWalletIfInvolvingMe(const CTransactionRef& tx, const CBlockIndex* pIndex, int posInBlock, bool fUpdate);\n     int64_t RescanFromTime(int64_t startTime, const WalletRescanReserver& reserver, bool update);\n-    CBlockIndex* ScanForWalletTransactions(CBlockIndex* pindexStart, CBlockIndex* pindexStop, const WalletRescanReserver& reserver, bool fUpdate = false);\n+\n+    enum class ScanResult : int {\n+        SUCCESS = 0,",
    "path": "src/wallet/wallet.h",
    "position": null,
    "original_position": 7,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "a4f3cb2f8305bbc89b98ef46e347a39fd2279fdc",
    "user": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: not sure if SUCCESS should use a non C-ish, non null positive value (1 probably)",
    "created_at": "2018-04-30T12:09:57Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184969265",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184969265"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184969265"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184969265/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 919,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184973014",
    "pull_request_review_id": 116270247,
    "id": 184973014,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDk3MzAxNA==",
    "diff_hunk": "@@ -914,7 +914,13 @@ class CWallet final : public CCryptoKeyStore, public CValidationInterface\n     void BlockDisconnected(const std::shared_ptr<const CBlock>& pblock) override;\n     bool AddToWalletIfInvolvingMe(const CTransactionRef& tx, const CBlockIndex* pIndex, int posInBlock, bool fUpdate);\n     int64_t RescanFromTime(int64_t startTime, const WalletRescanReserver& reserver, bool update);\n-    CBlockIndex* ScanForWalletTransactions(CBlockIndex* pindexStart, CBlockIndex* pindexStop, const WalletRescanReserver& reserver, bool fUpdate = false);\n+\n+    enum class ScanResult : int {\n+        SUCCESS = 0,",
    "path": "src/wallet/wallet.h",
    "position": null,
    "original_position": 7,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "a4f3cb2f8305bbc89b98ef46e347a39fd2279fdc",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "note that there is no need for an `enum class` to derive from int or even specify values for the members.",
    "created_at": "2018-04-30T12:29:54Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184973014",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184973014"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r184973014"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184973014/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 919,
    "side": "RIGHT",
    "in_reply_to_id": 184969265
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230922658",
    "pull_request_review_id": 171772694,
    "id": 230922658,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMDkyMjY1OA==",
    "diff_hunk": "@@ -3912,16 +3912,19 @@ UniValue rescanblockchain(const JSONRPCRequest& request)\n         }\n     }\n \n-    CBlockIndex *stopBlock = pwallet->ScanForWalletTransactions(pindexStart, pindexStop, reserver, true);\n-    if (!stopBlock) {\n-        if (pwallet->IsAbortingRescan()) {\n-            throw JSONRPCError(RPC_MISC_ERROR, \"Rescan aborted.\");\n-        }\n-        // if we got a nullptr returned, ScanForWalletTransactions did rescan up to the requested stopindex\n+    const CBlockIndex* stopBlock = nullptr;\n+    CWallet::ScanResult result =\n+        pwallet->ScanForWalletTransactions(pindexStart, pindexStop, reserver, stopBlock, true);\n+    switch (result) {\n+    case CWallet::ScanResult::SUCCESS:\n         stopBlock = pindexStop ? pindexStop : pChainTip;\n-    }\n-    else {\n+        break;\n+    case CWallet::ScanResult::FAILURE:\n         throw JSONRPCError(RPC_MISC_ERROR, \"Rescan failed. Potentially corrupted data files.\");\n+    case CWallet::ScanResult::USER_ABORT:\n+        throw JSONRPCError(RPC_MISC_ERROR, \"Rescan aborted.\");\n+    default:\n+        throw JSONRPCError(RPC_MISC_ERROR, strprintf(\"Unexpected rescan result: %i.\", static_cast<int>(result)));",
    "path": "src/wallet/rpcwallet.cpp",
    "position": null,
    "original_position": 24,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "c50f3d559ca3869cc0ed4856e1ff60f3e484579a",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Should remove the default case, so instead of a runtime-error the compiler can warn about missing cases.\r\n```suggestion\r\n        // no default case, so the compiler can warn about missing cases\r\n```",
    "created_at": "2018-11-05T21:39:41Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r230922658",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230922658"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r230922658"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230922658/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3927,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231662215",
    "pull_request_review_id": 172680455,
    "id": 231662215,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMTY2MjIxNQ==",
    "diff_hunk": "@@ -144,7 +144,12 @@ void TestGUI()\n         LOCK(cs_main);\n         WalletRescanReserver reserver(wallet.get());\n         reserver.reserve();\n-        wallet->ScanForWalletTransactions(chainActive.Genesis(), nullptr, reserver, true);\n+        const CBlockIndex* const null_block = nullptr;\n+        const CBlockIndex* stop_block = nullptr;",
    "path": "src/qt/test/wallettests.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "b52abc7164ba6403124e409af2e3ee2e2dad7f24",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: No need to initialize a return value. In fact this might look like you are passing in something.\r\n\r\nAlso could inline nullptr for null_block below for brevity.",
    "created_at": "2018-11-07T20:18:00Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r231662215",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231662215"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r231662215"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231662215/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 148,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231662560",
    "pull_request_review_id": 172680455,
    "id": 231662560,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMTY2MjU2MA==",
    "diff_hunk": "@@ -3297,16 +3297,18 @@ UniValue rescanblockchain(const JSONRPCRequest& request)\n         }\n     }\n \n-    const CBlockIndex* stopBlock = pwallet->ScanForWalletTransactions(pindexStart, pindexStop, reserver, true);\n-    if (!stopBlock) {\n-        if (pwallet->IsAbortingRescan()) {\n-            throw JSONRPCError(RPC_MISC_ERROR, \"Rescan aborted.\");\n-        }\n-        // if we got a nullptr returned, ScanForWalletTransactions did rescan up to the requested stopindex\n+    const CBlockIndex* stopBlock = nullptr;",
    "path": "src/wallet/rpcwallet.cpp",
    "position": null,
    "original_position": 10,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "b52abc7164ba6403124e409af2e3ee2e2dad7f24",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: No need to initialize a return value. In fact this might look like you are passing in something.",
    "created_at": "2018-11-07T20:19:02Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r231662560",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231662560"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r231662560"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231662560/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3300,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231663814",
    "pull_request_review_id": 172680455,
    "id": 231663814,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMTY2MzgxNA==",
    "diff_hunk": "@@ -3297,16 +3297,18 @@ UniValue rescanblockchain(const JSONRPCRequest& request)\n         }\n     }\n \n-    const CBlockIndex* stopBlock = pwallet->ScanForWalletTransactions(pindexStart, pindexStop, reserver, true);\n-    if (!stopBlock) {\n-        if (pwallet->IsAbortingRescan()) {\n-            throw JSONRPCError(RPC_MISC_ERROR, \"Rescan aborted.\");\n-        }\n-        // if we got a nullptr returned, ScanForWalletTransactions did rescan up to the requested stopindex\n+    const CBlockIndex* stopBlock = nullptr;\n+    CWallet::ScanResult result =\n+        pwallet->ScanForWalletTransactions(pindexStart, pindexStop, reserver, stopBlock, true);\n+    switch (result) {\n+    case CWallet::ScanResult::SUCCESS:\n         stopBlock = pindexStop ? pindexStop : pChainTip;",
    "path": "src/wallet/rpcwallet.cpp",
    "position": null,
    "original_position": 15,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "b52abc7164ba6403124e409af2e3ee2e2dad7f24",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Why are you overriding the return value?",
    "created_at": "2018-11-07T20:23:21Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r231663814",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231663814"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r231663814"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231663814/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3340,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231664323",
    "pull_request_review_id": 172680455,
    "id": 231664323,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMTY2NDMyMw==",
    "diff_hunk": "@@ -50,7 +50,9 @@ BOOST_FIXTURE_TEST_CASE(rescan, TestChain100Setup)\n         AddKey(wallet, coinbaseKey);\n         WalletRescanReserver reserver(&wallet);\n         reserver.reserve();\n-        BOOST_CHECK_EQUAL(nullBlock, wallet.ScanForWalletTransactions(oldTip, nullptr, reserver));\n+        const CBlockIndex* stop_block = nullptr;\n+        BOOST_CHECK_EQUAL(wallet.ScanForWalletTransactions(oldTip, nullptr, reserver, stop_block), CWallet::ScanResult::SUCCESS);\n+        BOOST_CHECK_EQUAL(nullBlock, stop_block);",
    "path": "src/wallet/test/wallet_tests.cpp",
    "position": null,
    "original_position": 7,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "b52abc7164ba6403124e409af2e3ee2e2dad7f24",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "pIndexStop was nullptr, so this should be tip instead?",
    "created_at": "2018-11-07T20:25:05Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r231664323",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231664323"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r231664323"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231664323/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 55,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231664619",
    "pull_request_review_id": 172680455,
    "id": 231664619,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMTY2NDYxOQ==",
    "diff_hunk": "@@ -279,7 +283,10 @@ class ListCoinsTestingSetup : public TestChain100Setup\n         AddKey(*wallet, coinbaseKey);\n         WalletRescanReserver reserver(wallet.get());\n         reserver.reserve();\n-        wallet->ScanForWalletTransactions(chainActive.Genesis(), nullptr, reserver);\n+        const CBlockIndex* const null_block = nullptr;\n+        const CBlockIndex* stop_block = nullptr;\n+        BOOST_CHECK_EQUAL(wallet->ScanForWalletTransactions(chainActive.Genesis(), nullptr, reserver, stop_block), CWallet::ScanResult::SUCCESS);\n+        BOOST_CHECK_EQUAL(stop_block, null_block);",
    "path": "src/wallet/test/wallet_tests.cpp",
    "position": null,
    "original_position": 30,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "b52abc7164ba6403124e409af2e3ee2e2dad7f24",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Should be tip instead of null_block?",
    "created_at": "2018-11-07T20:26:13Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r231664619",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231664619"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r231664619"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231664619/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 296,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231666975",
    "pull_request_review_id": 172680455,
    "id": 231666975,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMTY2Njk3NQ==",
    "diff_hunk": "@@ -1619,18 +1620,20 @@ int64_t CWallet::RescanFromTime(int64_t startTime, const WalletRescanReserver& r\n  * from or to us. If fUpdate is true, found transactions that already\n  * exist in the wallet will be updated.\n  *\n- * Returns null if scan was successful. Otherwise, if a complete rescan was not\n- * possible (due to pruning or corruption), returns pointer to the most recent\n- * block that could not be scanned.\n+ * @param[in] pindexStop if not a nullptr, the scan will stop at this block-index\n+ * @param[out] failed_block if FAILURE is returned, will be set to the most\n+ *    recent block that could not be scanned.",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 21,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "b52abc7164ba6403124e409af2e3ee2e2dad7f24",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: could return `last_block`, which will either be \"the most recent block that could not be scanned\" (failure/abort) or \"pindexStop/::chainActive.Tip()\" (success)",
    "created_at": "2018-11-07T20:34:23Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r231666975",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231666975"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r231666975"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231666975/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1625,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232062789",
    "pull_request_review_id": 173174914,
    "id": 232062789,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjA2Mjc4OQ==",
    "diff_hunk": "@@ -3297,16 +3297,18 @@ UniValue rescanblockchain(const JSONRPCRequest& request)\n         }\n     }\n \n-    const CBlockIndex* stopBlock = pwallet->ScanForWalletTransactions(pindexStart, pindexStop, reserver, true);\n-    if (!stopBlock) {\n-        if (pwallet->IsAbortingRescan()) {\n-            throw JSONRPCError(RPC_MISC_ERROR, \"Rescan aborted.\");\n-        }\n-        // if we got a nullptr returned, ScanForWalletTransactions did rescan up to the requested stopindex\n+    const CBlockIndex* stopBlock = nullptr;\n+    CWallet::ScanResult result =\n+        pwallet->ScanForWalletTransactions(pindexStart, pindexStop, reserver, stopBlock, true);\n+    switch (result) {\n+    case CWallet::ScanResult::SUCCESS:\n         stopBlock = pindexStop ? pindexStop : pChainTip;",
    "path": "src/wallet/rpcwallet.cpp",
    "position": null,
    "original_position": 15,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "b52abc7164ba6403124e409af2e3ee2e2dad7f24",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This has been the behavior since the rpc's introduction in c77170fbdb",
    "created_at": "2018-11-08T21:14:50Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r232062789",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232062789"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r232062789"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232062789/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3340,
    "side": "RIGHT",
    "in_reply_to_id": 231663814
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232066384",
    "pull_request_review_id": 173179508,
    "id": 232066384,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjA2NjM4NA==",
    "diff_hunk": "@@ -3297,16 +3297,18 @@ UniValue rescanblockchain(const JSONRPCRequest& request)\n         }\n     }\n \n-    const CBlockIndex* stopBlock = pwallet->ScanForWalletTransactions(pindexStart, pindexStop, reserver, true);\n-    if (!stopBlock) {\n-        if (pwallet->IsAbortingRescan()) {\n-            throw JSONRPCError(RPC_MISC_ERROR, \"Rescan aborted.\");\n-        }\n-        // if we got a nullptr returned, ScanForWalletTransactions did rescan up to the requested stopindex\n+    const CBlockIndex* stopBlock = nullptr;\n+    CWallet::ScanResult result =\n+        pwallet->ScanForWalletTransactions(pindexStart, pindexStop, reserver, stopBlock, true);\n+    switch (result) {\n+    case CWallet::ScanResult::SUCCESS:\n         stopBlock = pindexStop ? pindexStop : pChainTip;",
    "path": "src/wallet/rpcwallet.cpp",
    "position": null,
    "original_position": 15,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "b52abc7164ba6403124e409af2e3ee2e2dad7f24",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Which doesn't mean it is correct. (The tip can change when you don't hold cs_main)",
    "created_at": "2018-11-08T21:26:26Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r232066384",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232066384"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r232066384"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232066384/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3340,
    "side": "RIGHT",
    "in_reply_to_id": 231663814
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232066868",
    "pull_request_review_id": 173180115,
    "id": 232066868,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjA2Njg2OA==",
    "diff_hunk": "@@ -3297,16 +3297,18 @@ UniValue rescanblockchain(const JSONRPCRequest& request)\n         }\n     }\n \n-    const CBlockIndex* stopBlock = pwallet->ScanForWalletTransactions(pindexStart, pindexStop, reserver, true);\n-    if (!stopBlock) {\n-        if (pwallet->IsAbortingRescan()) {\n-            throw JSONRPCError(RPC_MISC_ERROR, \"Rescan aborted.\");\n-        }\n-        // if we got a nullptr returned, ScanForWalletTransactions did rescan up to the requested stopindex\n+    const CBlockIndex* stopBlock = nullptr;\n+    CWallet::ScanResult result =\n+        pwallet->ScanForWalletTransactions(pindexStart, pindexStop, reserver, stopBlock, true);\n+    switch (result) {\n+    case CWallet::ScanResult::SUCCESS:\n         stopBlock = pindexStop ? pindexStop : pChainTip;",
    "path": "src/wallet/rpcwallet.cpp",
    "position": null,
    "original_position": 15,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "b52abc7164ba6403124e409af2e3ee2e2dad7f24",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Buf if we switch to returning the last block in `stopBlock` on success, this replacement won't be necessary.",
    "created_at": "2018-11-08T21:27:46Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r232066868",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232066868"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r232066868"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232066868/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3340,
    "side": "RIGHT",
    "in_reply_to_id": 231663814
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232066870",
    "pull_request_review_id": 173180116,
    "id": 232066870,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjA2Njg3MA==",
    "diff_hunk": "@@ -3297,16 +3297,18 @@ UniValue rescanblockchain(const JSONRPCRequest& request)\n         }\n     }\n \n-    const CBlockIndex* stopBlock = pwallet->ScanForWalletTransactions(pindexStart, pindexStop, reserver, true);\n-    if (!stopBlock) {\n-        if (pwallet->IsAbortingRescan()) {\n-            throw JSONRPCError(RPC_MISC_ERROR, \"Rescan aborted.\");\n-        }\n-        // if we got a nullptr returned, ScanForWalletTransactions did rescan up to the requested stopindex\n+    const CBlockIndex* stopBlock = nullptr;\n+    CWallet::ScanResult result =\n+        pwallet->ScanForWalletTransactions(pindexStart, pindexStop, reserver, stopBlock, true);\n+    switch (result) {\n+    case CWallet::ScanResult::SUCCESS:\n         stopBlock = pindexStop ? pindexStop : pChainTip;",
    "path": "src/wallet/rpcwallet.cpp",
    "position": null,
    "original_position": 15,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "b52abc7164ba6403124e409af2e3ee2e2dad7f24",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Since you rework what the function returns, you might as well make it return the last successfully scanned block.",
    "created_at": "2018-11-08T21:27:46Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r232066870",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232066870"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r232066870"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232066870/reactions",
      "total_count": 2,
      "+1": 2,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3340,
    "side": "RIGHT",
    "in_reply_to_id": 231663814
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232394798",
    "pull_request_review_id": 173592357,
    "id": 232394798,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjM5NDc5OA==",
    "diff_hunk": "@@ -3297,16 +3297,18 @@ UniValue rescanblockchain(const JSONRPCRequest& request)\n         }\n     }\n \n-    const CBlockIndex* stopBlock = pwallet->ScanForWalletTransactions(pindexStart, pindexStop, reserver, true);\n-    if (!stopBlock) {\n-        if (pwallet->IsAbortingRescan()) {\n-            throw JSONRPCError(RPC_MISC_ERROR, \"Rescan aborted.\");\n-        }\n-        // if we got a nullptr returned, ScanForWalletTransactions did rescan up to the requested stopindex\n+    const CBlockIndex* stopBlock = nullptr;\n+    CWallet::ScanResult result =\n+        pwallet->ScanForWalletTransactions(pindexStart, pindexStop, reserver, stopBlock, true);\n+    switch (result) {\n+    case CWallet::ScanResult::SUCCESS:\n         stopBlock = pindexStop ? pindexStop : pChainTip;",
    "path": "src/wallet/rpcwallet.cpp",
    "position": null,
    "original_position": 15,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "b52abc7164ba6403124e409af2e3ee2e2dad7f24",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I can pick this up and address my feedback middle of next week. (Let me know if you are currently busy or want to take a stab at this.)",
    "created_at": "2018-11-09T21:11:03Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r232394798",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232394798"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r232394798"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232394798/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 3340,
    "side": "RIGHT",
    "in_reply_to_id": 231663814
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232488701",
    "pull_request_review_id": 173698782,
    "id": 232488701,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjQ4ODcwMQ==",
    "diff_hunk": "@@ -50,7 +50,9 @@ BOOST_FIXTURE_TEST_CASE(rescan, TestChain100Setup)\n         AddKey(wallet, coinbaseKey);\n         WalletRescanReserver reserver(&wallet);\n         reserver.reserve();\n-        BOOST_CHECK_EQUAL(nullBlock, wallet.ScanForWalletTransactions(oldTip, nullptr, reserver));\n+        const CBlockIndex* stop_block = nullptr;\n+        BOOST_CHECK_EQUAL(wallet.ScanForWalletTransactions(oldTip, nullptr, reserver, stop_block), CWallet::ScanResult::SUCCESS);\n+        BOOST_CHECK_EQUAL(nullBlock, stop_block);",
    "path": "src/wallet/test/wallet_tests.cpp",
    "position": null,
    "original_position": 7,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "b52abc7164ba6403124e409af2e3ee2e2dad7f24",
    "user": {
      "login": "meshcollider",
      "id": 3211283,
      "node_id": "MDQ6VXNlcjMyMTEyODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3211283?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/meshcollider",
      "html_url": "https://github.com/meshcollider",
      "followers_url": "https://api.github.com/users/meshcollider/followers",
      "following_url": "https://api.github.com/users/meshcollider/following{/other_user}",
      "gists_url": "https://api.github.com/users/meshcollider/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/meshcollider/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/meshcollider/subscriptions",
      "organizations_url": "https://api.github.com/users/meshcollider/orgs",
      "repos_url": "https://api.github.com/users/meshcollider/repos",
      "events_url": "https://api.github.com/users/meshcollider/events{/privacy}",
      "received_events_url": "https://api.github.com/users/meshcollider/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@MarcoFalke `stop_block` is only set if the scan failed, it isn't set to tip if the scan succeeds",
    "created_at": "2018-11-11T13:49:54Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r232488701",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232488701"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r232488701"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232488701/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 55,
    "side": "RIGHT",
    "in_reply_to_id": 231664323
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232488725",
    "pull_request_review_id": 173698812,
    "id": 232488725,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjQ4ODcyNQ==",
    "diff_hunk": "@@ -279,7 +283,10 @@ class ListCoinsTestingSetup : public TestChain100Setup\n         AddKey(*wallet, coinbaseKey);\n         WalletRescanReserver reserver(wallet.get());\n         reserver.reserve();\n-        wallet->ScanForWalletTransactions(chainActive.Genesis(), nullptr, reserver);\n+        const CBlockIndex* const null_block = nullptr;\n+        const CBlockIndex* stop_block = nullptr;\n+        BOOST_CHECK_EQUAL(wallet->ScanForWalletTransactions(chainActive.Genesis(), nullptr, reserver, stop_block), CWallet::ScanResult::SUCCESS);\n+        BOOST_CHECK_EQUAL(stop_block, null_block);",
    "path": "src/wallet/test/wallet_tests.cpp",
    "position": null,
    "original_position": 30,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "b52abc7164ba6403124e409af2e3ee2e2dad7f24",
    "user": {
      "login": "meshcollider",
      "id": 3211283,
      "node_id": "MDQ6VXNlcjMyMTEyODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3211283?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/meshcollider",
      "html_url": "https://github.com/meshcollider",
      "followers_url": "https://api.github.com/users/meshcollider/followers",
      "following_url": "https://api.github.com/users/meshcollider/following{/other_user}",
      "gists_url": "https://api.github.com/users/meshcollider/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/meshcollider/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/meshcollider/subscriptions",
      "organizations_url": "https://api.github.com/users/meshcollider/orgs",
      "repos_url": "https://api.github.com/users/meshcollider/repos",
      "events_url": "https://api.github.com/users/meshcollider/events{/privacy}",
      "received_events_url": "https://api.github.com/users/meshcollider/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Same here as the other case :)",
    "created_at": "2018-11-11T13:50:29Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r232488725",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232488725"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r232488725"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232488725/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 296,
    "side": "RIGHT",
    "in_reply_to_id": 231664619
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232854808",
    "pull_request_review_id": 174145638,
    "id": 232854808,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjg1NDgwOA==",
    "diff_hunk": "@@ -144,7 +144,12 @@ void TestGUI()\n         LOCK(cs_main);\n         WalletRescanReserver reserver(wallet.get());\n         reserver.reserve();\n-        wallet->ScanForWalletTransactions(chainActive.Genesis(), nullptr, reserver, true);\n+        const CBlockIndex* const null_block = nullptr;\n+        const CBlockIndex* stop_block = nullptr;",
    "path": "src/qt/test/wallettests.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "b52abc7164ba6403124e409af2e3ee2e2dad7f24",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Removed the initialization of the out var, though this required setting the out var to null in the method for consistent behavior under test. Seems like a good change to me as this seems more predictable.\r\n\r\nCan't inline the `null_block` vars as that results in template ambiguity around `<ostream, nullptr_t>`",
    "created_at": "2018-11-13T00:09:04Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r232854808",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232854808"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r232854808"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232854808/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 148,
    "side": "RIGHT",
    "in_reply_to_id": 231662215
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232905965",
    "pull_request_review_id": 174203787,
    "id": 232905965,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMjkwNTk2NQ==",
    "diff_hunk": "@@ -1695,8 +1695,9 @@ int64_t CWallet::RescanFromTime(int64_t startTime, const WalletRescanReserver& r\n     }\n \n     if (startBlock) {\n-        const CBlockIndex* const failedBlock = ScanForWalletTransactions(startBlock, nullptr, reserver, update);\n-        if (failedBlock) {\n+        const CBlockIndex* failedBlock = nullptr;\n+        // TODO: this should take into account failure by ScanResult::USER_ABORTED",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 7,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "620581fca13cd4e0c72de0fafc1e071c8b144faf",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Follow-up is here, I'll wait to open until this is accepted:\r\nhttps://github.com/Empact/bitcoin/tree/rescan-from-time",
    "created_at": "2018-11-13T05:58:06Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r232905965",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232905965"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r232905965"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/232905965/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1699,
    "side": "RIGHT",
    "in_reply_to_id": 184888349
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/233134556",
    "pull_request_review_id": 174478512,
    "id": 233134556,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMzEzNDU1Ng==",
    "diff_hunk": "@@ -146,7 +146,13 @@ void TestGUI()\n         auto locked_chain = wallet->chain().lock();\n         WalletRescanReserver reserver(wallet.get());\n         reserver.reserve();\n-        wallet->ScanForWalletTransactions(chainActive.Genesis(), nullptr, reserver, true);\n+        const CBlockIndex* const null_block = nullptr;\n+        const CBlockIndex *stop_block, *failed_block;\n+        QCOMPARE(\n+            wallet->ScanForWalletTransactions(chainActive.Genesis(), nullptr, reserver, failed_block, stop_block, true /* fUpdate */),\n+            CWallet::ScanResult::SUCCESS);\n+        QCOMPARE(stop_block, null_block);",
    "path": "src/qt/test/wallettests.cpp",
    "position": null,
    "original_position": 10,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "981adda5cc072fd6f073e0730ceaab0093bc4033",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Travis failure:\r\n\r\n```\r\n********* Start testing of WalletTests *********\r\nConfig: Using QtTest library 5.9.6, Qt 5.9.6 (i386-little_endian-ilp32 static release build; by GCC 7.3.0)\r\nPASS   : WalletTests::initTestCase()\r\nFAIL!  : WalletTests::walletTests() Compared pointers are not the same\r\n   Loc: [qt/test/wallettests.cpp(154)]\r\nPASS   : WalletTests::cleanupTestCase()\r\nTotals: 2 passed, 1 failed, 0 skipped, 0 blacklisted, 245ms\r\n********* Finished testing of WalletTests *********",
    "created_at": "2018-11-13T17:00:09Z",
    "updated_at": "2018-11-13T17:51:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r233134556",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/233134556"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r233134556"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/233134556/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 154,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/233254604",
    "pull_request_review_id": 174627126,
    "id": 233254604,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMzI1NDYwNA==",
    "diff_hunk": "@@ -146,7 +146,13 @@ void TestGUI()\n         auto locked_chain = wallet->chain().lock();\n         WalletRescanReserver reserver(wallet.get());\n         reserver.reserve();\n-        wallet->ScanForWalletTransactions(chainActive.Genesis(), nullptr, reserver, true);\n+        const CBlockIndex* const null_block = nullptr;\n+        const CBlockIndex *stop_block, *failed_block;\n+        QCOMPARE(\n+            wallet->ScanForWalletTransactions(chainActive.Genesis(), nullptr, reserver, failed_block, stop_block, true /* fUpdate */),\n+            CWallet::ScanResult::SUCCESS);\n+        QCOMPARE(stop_block, null_block);",
    "path": "src/qt/test/wallettests.cpp",
    "position": null,
    "original_position": 10,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "981adda5cc072fd6f073e0730ceaab0093bc4033",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Thanks! Solved.",
    "created_at": "2018-11-13T22:53:32Z",
    "updated_at": "2018-11-13T22:53:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r233254604",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/233254604"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r233254604"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/233254604/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 154,
    "side": "RIGHT",
    "in_reply_to_id": 233134556
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/241565738",
    "pull_request_review_id": 184874209,
    "id": 241565738,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0MTU2NTczOA==",
    "diff_hunk": "@@ -1647,8 +1652,8 @@ CBlockIndex* CWallet::ScanForWalletTransactions(CBlockIndex* pindexStart, CBlock\n         assert(pindexStop->nHeight >= pindexStart->nHeight);\n     }\n \n-    CBlockIndex* pindex = pindexStart;\n-    CBlockIndex* ret = nullptr;\n+    const CBlockIndex* pindex = pindexStart;\n+    failed_block = nullptr;\n ",
    "path": "src/wallet/wallet.cpp",
    "position": 50,
    "original_position": 50,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Code is not setting `stop_block` null here, which seems unintended and could lead to uninitialized variables. Would be good to fix this or add documentation if it was done intentionally.",
    "created_at": "2018-12-13T21:21:44Z",
    "updated_at": "2018-12-13T21:21:44Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r241565738",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/241565738"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r241565738"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/241565738/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1657,
    "original_line": 1657,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/241652030",
    "pull_request_review_id": 184978065,
    "id": 241652030,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0MTY1MjAzMA==",
    "diff_hunk": "@@ -1695,8 +1695,9 @@ int64_t CWallet::RescanFromTime(int64_t startTime, const WalletRescanReserver& r\n     }\n \n     if (startBlock) {\n-        const CBlockIndex* const failedBlock = ScanForWalletTransactions(startBlock, nullptr, reserver, update);\n-        if (failedBlock) {\n+        const CBlockIndex* failedBlock = nullptr;\n+        // TODO: this should take into account failure by ScanResult::USER_ABORTED",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 7,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "620581fca13cd4e0c72de0fafc1e071c8b144faf",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "#14942",
    "created_at": "2018-12-14T06:09:52Z",
    "updated_at": "2018-12-14T06:09:53Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r241652030",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/241652030"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r241652030"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/241652030/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1699,
    "side": "RIGHT",
    "in_reply_to_id": 184888349
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/241660906",
    "pull_request_review_id": 184989470,
    "id": 241660906,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0MTY2MDkwNg==",
    "diff_hunk": "@@ -1647,8 +1652,8 @@ CBlockIndex* CWallet::ScanForWalletTransactions(CBlockIndex* pindexStart, CBlock\n         assert(pindexStop->nHeight >= pindexStart->nHeight);\n     }\n \n-    CBlockIndex* pindex = pindexStart;\n-    CBlockIndex* ret = nullptr;\n+    const CBlockIndex* pindex = pindexStart;\n+    failed_block = nullptr;\n ",
    "path": "src/wallet/wallet.cpp",
    "position": 50,
    "original_position": 50,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Ah, right, the code does contradict the comments on line 1634. Will open a PR.",
    "created_at": "2018-12-14T07:15:22Z",
    "updated_at": "2018-12-14T07:17:14Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r241660906",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/241660906"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r241660906"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/241660906/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1657,
    "original_line": 1657,
    "side": "RIGHT",
    "in_reply_to_id": 241565738
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/241662607",
    "pull_request_review_id": 184991602,
    "id": 241662607,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDI0MTY2MjYwNw==",
    "diff_hunk": "@@ -1647,8 +1652,8 @@ CBlockIndex* CWallet::ScanForWalletTransactions(CBlockIndex* pindexStart, CBlock\n         assert(pindexStop->nHeight >= pindexStart->nHeight);\n     }\n \n-    CBlockIndex* pindex = pindexStart;\n-    CBlockIndex* ret = nullptr;\n+    const CBlockIndex* pindex = pindexStart;\n+    failed_block = nullptr;\n ",
    "path": "src/wallet/wallet.cpp",
    "position": 50,
    "original_position": 50,
    "commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "original_commit_id": "bd3b0361d840bff95988a048abf70ade94d80524",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "#14957",
    "created_at": "2018-12-14T07:25:53Z",
    "updated_at": "2018-12-14T07:25:53Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r241662607",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/241662607"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13076#discussion_r241662607"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13076"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/241662607/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1657,
    "original_line": 1657,
    "side": "RIGHT",
    "in_reply_to_id": 241565738
  }
]