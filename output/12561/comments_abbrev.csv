laanwj,2018-03-01T07:13:05Z,"For context: I had a node go into an infinite loop, when a bit flip in a transaction in the block file caused the merkle root check to fail. It kept printing the same message, pegging the CPU at 100% but without advancing:\n```\n2018-02-27 07:47:02 ERROR: ConnectBlock: Consensus::CheckBlock: bad-txnmrklroot,\n hashMerkleRoot mismatch (code 16)\n2018-02-27 07:47:02 ERROR: ConnectTip(): ConnectB",https://github.com/bitcoin/bitcoin/pull/12561#issuecomment-369498460,369498460,
sdaftuar,2018-03-05T02:16:55Z,"> I'm not sure removing the check is the best way forward. I'm happy that the corruption was detected as early as possible so I could take action and fix the CPU cooler. However, it could stop trying after one time, then give up. Or am I misunderstanding what this does?\n\nYeah it's not clear to me what is best.  With my current proposal here, we skip the CheckBlock check altogether and go strai",https://github.com/bitcoin/bitcoin/pull/12561#issuecomment-370291093,370291093,
sdaftuar,2018-03-05T15:48:49Z,@laanwj I changed this to just shut down if we encounter a corrupt block in ConnectBlock().,https://github.com/bitcoin/bitcoin/pull/12561#issuecomment-370462825,370462825,
laanwj,2018-03-05T17:45:24Z,"utACK https://github.com/bitcoin/bitcoin/pull/12561/commits/0e7c52dc6cbb8fd881a0dd57a6167a812fe71dc4 looks good to me now\n(will try to test this once I get home, as I still have the corrupted file)",https://github.com/bitcoin/bitcoin/pull/12561#issuecomment-370502480,370502480,
sdaftuar,2018-03-07T14:10:25Z,"Updated OP to reflect what this PR is doing, since those get included in our merge commits.  Original OP for posterity:\n\n> The call to CheckBlock() in ConnectBlock() was largely redundant -- the case it tried to protect against was one where we have somehow previously stored an invalid block (eg with different software, presumably).  However, there are other ways that we could get invalid bloc",https://github.com/bitcoin/bitcoin/pull/12561#issuecomment-371149663,371149663,
laanwj,2018-04-08T09:07:46Z,Going to merge this; it's an improvement to error handing either way. Additional information can be added in future PRs.,https://github.com/bitcoin/bitcoin/pull/12561#issuecomment-379534009,379534009,
MarcoFalke,2018-04-08T15:51:58Z,"Marking ""up for grabs"" to add the logprint",https://github.com/bitcoin/bitcoin/pull/12561#issuecomment-379560471,379560471,
eklitzke,2018-03-11T02:37:39Z,"You should log the block hash as well, as that is useful information for anyone who wants to try to dig deeper (and is the first thing any developer would want to know). It looks like `AbortNode()` directs the user to check `debug.log`, so you can add a `LogPrintf()` statement before returning the error.",https://github.com/bitcoin/bitcoin/pull/12561#discussion_r173641395,173641395,src/validation.cpp
