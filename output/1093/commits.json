[
  {
    "sha": "9925d34a496b1d61a7d9976a385aa8122b1a4778",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo5OTI1ZDM0YTQ5NmIxZDYxYTdkOTk3NmEzODVhYTgxMjJiMWE0Nzc4",
    "commit": {
      "author": {
        "name": "Jeff Garzik",
        "email": "jeff@garzik.org",
        "date": "2012-04-13T21:48:15Z"
      },
      "committer": {
        "name": "Jeff Garzik",
        "email": "jgarzik@redhat.com",
        "date": "2012-04-13T21:48:15Z"
      },
      "message": "Database micro-optimization for \"tx\" network message\n\nOpen database once per \"tx\" message, rather than multiple times,\nin the case of orphan transaction presence.\n\nAs a side effect, a now-unused CTransaction::AcceptToMemoryPool()\nvariant is removed.",
      "tree": {
        "sha": "1e18e8afcbffd964eab7e633937aad746c12e1c7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1e18e8afcbffd964eab7e633937aad746c12e1c7"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9925d34a496b1d61a7d9976a385aa8122b1a4778",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9925d34a496b1d61a7d9976a385aa8122b1a4778",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/9925d34a496b1d61a7d9976a385aa8122b1a4778",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9925d34a496b1d61a7d9976a385aa8122b1a4778/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "6b8e7eefccf8d27c145d2e694037c2e10984f748",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6b8e7eefccf8d27c145d2e694037c2e10984f748",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/6b8e7eefccf8d27c145d2e694037c2e10984f748"
      }
    ],
    "stats": {
      "total": 12,
      "additions": 3,
      "deletions": 9
    },
    "files": [
      {
        "sha": "a6393a5c838c979f56affbb7562f4350b8b91814",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 8,
        "changes": 11,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/9925d34a496b1d61a7d9976a385aa8122b1a4778/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/9925d34a496b1d61a7d9976a385aa8122b1a4778/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=9925d34a496b1d61a7d9976a385aa8122b1a4778",
        "patch": "@@ -592,12 +592,6 @@ bool CTransaction::AcceptToMemoryPool(CTxDB& txdb, bool fCheckInputs, bool* pfMi\n     return true;\n }\n \n-bool CTransaction::AcceptToMemoryPool(bool fCheckInputs, bool* pfMissingInputs)\n-{\n-    CTxDB txdb(\"r\");\n-    return AcceptToMemoryPool(txdb, fCheckInputs, pfMissingInputs);\n-}\n-\n uint64 nPooledTx = 0;\n \n bool CTransaction::AddToMemoryPoolUnchecked()\n@@ -2522,14 +2516,15 @@ bool static ProcessMessage(CNode* pfrom, string strCommand, CDataStream& vRecv)\n     {\n         vector<uint256> vWorkQueue;\n         CDataStream vMsg(vRecv);\n+        CTxDB txdb(\"r\");\n         CTransaction tx;\n         vRecv >> tx;\n \n         CInv inv(MSG_TX, tx.GetHash());\n         pfrom->AddInventoryKnown(inv);\n \n         bool fMissingInputs = false;\n-        if (tx.AcceptToMemoryPool(true, &fMissingInputs))\n+        if (tx.AcceptToMemoryPool(txdb, true, &fMissingInputs))\n         {\n             SyncWithWallets(tx, NULL, true);\n             RelayMessage(inv, vMsg);\n@@ -2549,7 +2544,7 @@ bool static ProcessMessage(CNode* pfrom, string strCommand, CDataStream& vRecv)\n                     CDataStream(vMsg) >> tx;\n                     CInv inv(MSG_TX, tx.GetHash());\n \n-                    if (tx.AcceptToMemoryPool(true))\n+                    if (tx.AcceptToMemoryPool(txdb, true))\n                     {\n                         printf(\"   accepted orphan tx %s\\n\", inv.hash.ToString().substr(0,10).c_str());\n                         SyncWithWallets(tx, NULL, true);"
      },
      {
        "sha": "723f4e150c19cf2f8964ac48fcc73aa2f4cc0b19",
        "filename": "src/main.h",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/9925d34a496b1d61a7d9976a385aa8122b1a4778/src/main.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/9925d34a496b1d61a7d9976a385aa8122b1a4778/src/main.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.h?ref=9925d34a496b1d61a7d9976a385aa8122b1a4778",
        "patch": "@@ -684,7 +684,6 @@ class CTransaction\n     bool ClientConnectInputs();\n     bool CheckTransaction() const;\n     bool AcceptToMemoryPool(CTxDB& txdb, bool fCheckInputs=true, bool* pfMissingInputs=NULL);\n-    bool AcceptToMemoryPool(bool fCheckInputs=true, bool* pfMissingInputs=NULL);\n \n protected:\n     const CTxOut& GetOutputFor(const CTxIn& input, const MapPrevTx& inputs) const;"
      }
    ]
  }
]