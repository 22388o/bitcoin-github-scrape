[
  {
    "sha": "2a06b69caa2a9b5c70a6d22faef1eb0963f160ec",
    "node_id": "C_kwDOABII59oAKDJhMDZiNjljYWEyYTliNWM3MGE2ZDIyZmFlZjFlYjA5NjNmMTYwZWM",
    "commit": {
      "author": {
        "name": "brunoerg",
        "email": "brunoely.gc@gmail.com",
        "date": "2021-11-09T10:36:29Z"
      },
      "committer": {
        "name": "brunoerg",
        "email": "brunoely.gc@gmail.com",
        "date": "2021-11-18T10:48:53Z"
      },
      "message": "wallet: add -prioritizenochange command",
      "tree": {
        "sha": "1908fcdac4a6c021618e16bea01525b2873acb87",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1908fcdac4a6c021618e16bea01525b2873acb87"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2a06b69caa2a9b5c70a6d22faef1eb0963f160ec",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2a06b69caa2a9b5c70a6d22faef1eb0963f160ec",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/2a06b69caa2a9b5c70a6d22faef1eb0963f160ec",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2a06b69caa2a9b5c70a6d22faef1eb0963f160ec/comments",
    "author": {
      "login": "brunoerg",
      "id": 19480819,
      "node_id": "MDQ6VXNlcjE5NDgwODE5",
      "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brunoerg",
      "html_url": "https://github.com/brunoerg",
      "followers_url": "https://api.github.com/users/brunoerg/followers",
      "following_url": "https://api.github.com/users/brunoerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/brunoerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
      "organizations_url": "https://api.github.com/users/brunoerg/orgs",
      "repos_url": "https://api.github.com/users/brunoerg/repos",
      "events_url": "https://api.github.com/users/brunoerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brunoerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "brunoerg",
      "id": 19480819,
      "node_id": "MDQ6VXNlcjE5NDgwODE5",
      "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brunoerg",
      "html_url": "https://github.com/brunoerg",
      "followers_url": "https://api.github.com/users/brunoerg/followers",
      "following_url": "https://api.github.com/users/brunoerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/brunoerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
      "organizations_url": "https://api.github.com/users/brunoerg/orgs",
      "repos_url": "https://api.github.com/users/brunoerg/repos",
      "events_url": "https://api.github.com/users/brunoerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brunoerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "2efc8c0999a4b99cfe3076f7312806e83e778261",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2efc8c0999a4b99cfe3076f7312806e83e778261",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/2efc8c0999a4b99cfe3076f7312806e83e778261"
      }
    ],
    "stats": {
      "total": 4,
      "additions": 4,
      "deletions": 0
    },
    "files": [
      {
        "sha": "a34380bb46893f7f2f29f8da8a1933eab2162e14",
        "filename": "src/dummywallet.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/2a06b69caa2a9b5c70a6d22faef1eb0963f160ec/src/dummywallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/2a06b69caa2a9b5c70a6d22faef1eb0963f160ec/src/dummywallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/dummywallet.cpp?ref=2a06b69caa2a9b5c70a6d22faef1eb0963f160ec",
        "patch": "@@ -52,6 +52,7 @@ void DummyWalletInit::AddWalletOptions(ArgsManager& argsman) const\n         \"-privdb\",\n         \"-walletrejectlongchains\",\n         \"-unsafesqlitesync\",\n+        \"-prioritizenochange\"\n     });\n }\n "
      },
      {
        "sha": "c8807f98bc27a229c4c069ce03b0e8caacdc3e26",
        "filename": "src/wallet/init.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/2a06b69caa2a9b5c70a6d22faef1eb0963f160ec/src/wallet/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/2a06b69caa2a9b5c70a6d22faef1eb0963f160ec/src/wallet/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/init.cpp?ref=2a06b69caa2a9b5c70a6d22faef1eb0963f160ec",
        "patch": "@@ -62,6 +62,7 @@ void WalletInit::AddWalletOptions(ArgsManager& argsman) const\n                                                             CURRENCY_UNIT, FormatMoney(DEFAULT_TRANSACTION_MINFEE)), ArgsManager::ALLOW_ANY, OptionsCategory::WALLET);\n     argsman.AddArg(\"-paytxfee=<amt>\", strprintf(\"Fee rate (in %s/kvB) to add to transactions you send (default: %s)\",\n                                                             CURRENCY_UNIT, FormatMoney(CFeeRate{DEFAULT_PAY_TX_FEE}.GetFeePerK())), ArgsManager::ALLOW_ANY, OptionsCategory::WALLET);\n+    argsman.AddArg(\"-prioritizenochange\", strprintf(\"Prioritize a solution that doesn't generate change in coin selection\"), ArgsManager::ALLOW_ANY, OptionsCategory::WALLET);\n #ifdef ENABLE_EXTERNAL_SIGNER\n     argsman.AddArg(\"-signer=<cmd>\", \"External signing tool, see doc/external-signer.md\", ArgsManager::ALLOW_ANY, OptionsCategory::WALLET);\n #endif"
      },
      {
        "sha": "1f86ef451aaffb6235cc47403e51b51549c45556",
        "filename": "src/wallet/wallet.h",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/2a06b69caa2a9b5c70a6d22faef1eb0963f160ec/src/wallet/wallet.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/2a06b69caa2a9b5c70a6d22faef1eb0963f160ec/src/wallet/wallet.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/wallet.h?ref=2a06b69caa2a9b5c70a6d22faef1eb0963f160ec",
        "patch": "@@ -103,6 +103,8 @@ constexpr CAmount HIGH_TX_FEE_PER_KB{COIN / 100};\n constexpr CAmount HIGH_MAX_TX_FEE{100 * HIGH_TX_FEE_PER_KB};\n //! Pre-calculated constants for input size estimation in *virtual size*\n static constexpr size_t DUMMY_NESTED_P2WPKH_INPUT_SIZE = 91;\n+//! Default for -prioritizenochange\n+static const bool DEFAULT_PRIORITIZE_NO_CHANGE = false;\n \n class CCoinControl;\n class COutput;"
      }
    ]
  },
  {
    "sha": "83e33d5c2a81e4671fc69d59d4e31ec721b8bb66",
    "node_id": "C_kwDOABII59oAKDgzZTMzZDVjMmE4MWU0NjcxZmM2OWQ1OWQ0ZTMxZWM3MjFiOGJiNjY",
    "commit": {
      "author": {
        "name": "brunoerg",
        "email": "brunoely.gc@gmail.com",
        "date": "2021-11-09T10:37:13Z"
      },
      "committer": {
        "name": "brunoerg",
        "email": "brunoely.gc@gmail.com",
        "date": "2021-11-18T10:48:53Z"
      },
      "message": "wallet: prioritize BnB solution when -prioritizenochange is set",
      "tree": {
        "sha": "53a2c650874ea60addec752e141c8322277ec2ac",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/53a2c650874ea60addec752e141c8322277ec2ac"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/83e33d5c2a81e4671fc69d59d4e31ec721b8bb66",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/83e33d5c2a81e4671fc69d59d4e31ec721b8bb66",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/83e33d5c2a81e4671fc69d59d4e31ec721b8bb66",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/83e33d5c2a81e4671fc69d59d4e31ec721b8bb66/comments",
    "author": {
      "login": "brunoerg",
      "id": 19480819,
      "node_id": "MDQ6VXNlcjE5NDgwODE5",
      "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brunoerg",
      "html_url": "https://github.com/brunoerg",
      "followers_url": "https://api.github.com/users/brunoerg/followers",
      "following_url": "https://api.github.com/users/brunoerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/brunoerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
      "organizations_url": "https://api.github.com/users/brunoerg/orgs",
      "repos_url": "https://api.github.com/users/brunoerg/repos",
      "events_url": "https://api.github.com/users/brunoerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brunoerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "brunoerg",
      "id": 19480819,
      "node_id": "MDQ6VXNlcjE5NDgwODE5",
      "avatar_url": "https://avatars.githubusercontent.com/u/19480819?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brunoerg",
      "html_url": "https://github.com/brunoerg",
      "followers_url": "https://api.github.com/users/brunoerg/followers",
      "following_url": "https://api.github.com/users/brunoerg/following{/other_user}",
      "gists_url": "https://api.github.com/users/brunoerg/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brunoerg/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brunoerg/subscriptions",
      "organizations_url": "https://api.github.com/users/brunoerg/orgs",
      "repos_url": "https://api.github.com/users/brunoerg/repos",
      "events_url": "https://api.github.com/users/brunoerg/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brunoerg/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "2a06b69caa2a9b5c70a6d22faef1eb0963f160ec",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2a06b69caa2a9b5c70a6d22faef1eb0963f160ec",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/2a06b69caa2a9b5c70a6d22faef1eb0963f160ec"
      }
    ],
    "stats": {
      "total": 6,
      "additions": 6,
      "deletions": 0
    },
    "files": [
      {
        "sha": "0669f30232d49fc5b10ac2a0e6857ef41b4850ef",
        "filename": "src/wallet/spend.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 0,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/83e33d5c2a81e4671fc69d59d4e31ec721b8bb66/src/wallet/spend.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/83e33d5c2a81e4671fc69d59d4e31ec721b8bb66/src/wallet/spend.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/spend.cpp?ref=83e33d5c2a81e4671fc69d59d4e31ec721b8bb66",
        "patch": "@@ -388,6 +388,12 @@ bool AttemptSelection(const CWallet& wallet, const CAmount& nTargetValue, const\n     std::set<CInputCoin> bnb_coins;\n     CAmount bnb_value;\n     if (SelectCoinsBnB(positive_groups, nTargetValue, coin_selection_params.m_cost_of_change, bnb_coins, bnb_value)) {\n+        if (gArgs.GetBoolArg(\"-prioritizenochange\", DEFAULT_PRIORITIZE_NO_CHANGE)) {\n+            setCoinsRet = std::move(bnb_coins);\n+            nValueRet = bnb_value;\n+            return true;\n+        }\n+\n         const auto waste = GetSelectionWaste(bnb_coins, /* cost of change */ CAmount(0), nTargetValue, !coin_selection_params.m_subtract_fee_outputs);\n         results.emplace_back(std::make_tuple(waste, std::move(bnb_coins), bnb_value));\n     }"
      }
    ]
  }
]