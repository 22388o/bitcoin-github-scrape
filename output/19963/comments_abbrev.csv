naumenkogs,2020-09-17 07:14:03,"1. What's ""NB""?\n2. This part of the test is confusing in the first place: it should have nothing to do with ""forcerelay"". It's about ""relay"" permission. It works just because ""forcerelay"" enables ""relay"" permission automatically. Can you modify this chunk of the test to talk about ""relay""?\n3. I would prefer to expand the following description: ""first_peer would never send us transactions since",https://github.com/bitcoin/bitcoin/pull/19963#issuecomment-694018515,694018515,
t-bast,2020-09-17 13:26:30,"Done, let me know if that's better.",https://github.com/bitcoin/bitcoin/pull/19963#issuecomment-694231737,694231737,
naumenkogs,2020-09-18 10:52:40,"Still no idea what's ""NB"" :)\nOtherwise looks good if you see my new suggestion.",https://github.com/bitcoin/bitcoin/pull/19963#issuecomment-694799575,694799575,
t-bast,2020-09-18 11:15:10,"> Still no idea what's ""NB"" :)\n\nHeh, it's ""Nota Bene"", we probably use that latin abbreviation too often in France :)",https://github.com/bitcoin/bitcoin/pull/19963#issuecomment-694808699,694808699,
DrahtBot,2020-09-19 13:27:47,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19770 (RPC: getpeerinfo: Deprecate ""whitelisted"" field (replaced by ""permissions"") by luke-jr)\n* #19315 ([tests] Allow o",https://github.com/bitcoin/bitcoin/pull/19963#issuecomment-695213506,695213506,
naumenkogs,2020-09-21 06:31:55,"We normally don't commit ""fixup fixup"" like that, so please squash into 1 commit after you address marco's comments :)",https://github.com/bitcoin/bitcoin/pull/19963#issuecomment-695927451,695927451,
naumenkogs,2020-09-21 09:16:30,ACK e15344889aac50aadee9211ac34e466867d5862b,https://github.com/bitcoin/bitcoin/pull/19963#issuecomment-695997691,695997691,
michaelfolkson,2020-09-16 13:23:47,nit: s/forward/forwards,https://github.com/bitcoin/bitcoin/pull/19963#discussion_r489433313,489433313,test/functional/p2p_blocksonly.py
t-bast,2020-09-16 15:43:03,"My thinking was that `forward` was going in pair with `bypass` (both infinitive), but I'm not a native speaker, I can definitely apply that.",https://github.com/bitcoin/bitcoin/pull/19963#discussion_r489539109,489539109,test/functional/p2p_blocksonly.py
michaelfolkson,2020-09-16 15:50:21,Yeah first_peer is running a modified version of Bitcoin Core to bypass relay checks. Once it has done that the first_peer forwards the transactions. But as I said I don't think we are fussy on grammar for comments on this project and I wouldn't want to put people like you off from adding comments in future! So feel free to leave it. We'll see if Gleb has more substantial suggestions.,https://github.com/bitcoin/bitcoin/pull/19963#discussion_r489544220,489544220,test/functional/p2p_blocksonly.py
naumenkogs,2020-09-18 10:51:23,"""Forcerelay' clearly meant a peer with FORCERELAY permission.\nNow that you call it ""relay"", it's not clear it's about permissions, because we commonly use ""relay"" in many contexts. I would prefer ""RELAY-whitelisted"" or something like that hereinafter.",https://github.com/bitcoin/bitcoin/pull/19963#discussion_r490864501,490864501,test/functional/p2p_blocksonly.py
t-bast,2020-09-18 11:14:11,"You're right, that was confusing. Fixed in https://github.com/bitcoin/bitcoin/pull/19963/commits/3abe9f866c17fb4fde623d410d59f269b673645f",https://github.com/bitcoin/bitcoin/pull/19963#discussion_r490876098,490876098,test/functional/p2p_blocksonly.py
MarcoFalke,2020-09-20 07:16:10,"Can't this be written shorter as:\n\n```suggestion\n        self.restart_node(0, [""-persistmempool=0"", ""-whitelist=relay@127.0.0.1"", ""-blocksonly""])\n```",https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491662392,491662392,test/functional/p2p_blocksonly.py
MarcoFalke,2020-09-20 07:17:09,"```suggestion\n        self.log.info('Check that txs from peers with relay-permission are not rejected and relayed to others')\n```\n\nWould prefer to use lowercase (identical to the flag name for the whitelist setting)",https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491662468,491662468,test/functional/p2p_blocksonly.py
MarcoFalke,2020-09-20 07:18:33,I think pep-8 wants two lines here,https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491662547,491662547,test/functional/p2p_blocksonly.py
t-bast,2020-09-21 06:30:37,Done,https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491816153,491816153,test/functional/p2p_blocksonly.py
t-bast,2020-09-21 06:30:45,Done,https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491816213,491816213,test/functional/p2p_blocksonly.py
naumenkogs,2020-09-21 06:31:24,"I agree with Marco even though it was my suggestion to use the uppercase.\nWe definitely use lowercase for permissions, I was just referring to the enum, which has less prio in this case.",https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491816448,491816448,test/functional/p2p_blocksonly.py
t-bast,2020-09-21 06:32:20,"I thought so too, but interestingly it doesn't work.\nWhen setting `whitelist=relay@127.0.0.1` and doing a `getpeerinfo`, the `permissions` are correctly set to `relay`, but `whitelisted` is set to `false`...",https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491816767,491816767,test/functional/p2p_blocksonly.py
naumenkogs,2020-09-21 06:56:44,"`whitelisted` is there for backward compatibility only:\n`// If this flag is present, the user probably expect that RPC and QT report it as whitelisted (backward compatibility)`.\n\nYour test should still work even after marco's suggestion? You just have to update the following stuff too: drop the legacy `assert_equal(peer_1_info['whitelisted'], True)` stuff",https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491825386,491825386,test/functional/p2p_blocksonly.py
naumenkogs,2020-09-21 06:57:03,(I'm fine keeping it as is too),https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491825482,491825482,test/functional/p2p_blocksonly.py
t-bast,2020-09-21 06:59:22,"Great, thanks for the explanation, the rest of the test indeed works fine once changed.\nI'll remove that check if that is a deprecated flag, it can be misleading for newcomers.",https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491826298,491826298,test/functional/p2p_blocksonly.py
t-bast,2020-09-21 07:01:15,Done in https://github.com/bitcoin/bitcoin/pull/19963/commits/f59681ecc422bbfe32d470ef96bbd25199ec14d0,https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491827031,491827031,test/functional/p2p_blocksonly.py
naumenkogs,2020-09-21 07:28:16,still uppercase :),https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491838231,491838231,test/functional/p2p_blocksonly.py
t-bast,2020-09-21 07:48:05,"Woops sorry, fixed in https://github.com/bitcoin/bitcoin/pull/19963/commits/a44ad7cfbe8ba89edfb7642e72d1938413021ed5",https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491848035,491848035,test/functional/p2p_blocksonly.py
naumenkogs,2020-09-21 08:01:45,"Ready to ack, please squash :)",https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491855142,491855142,test/functional/p2p_blocksonly.py
t-bast,2020-09-21 08:16:53,Done!,https://github.com/bitcoin/bitcoin/pull/19963#discussion_r491862922,491862922,test/functional/p2p_blocksonly.py
