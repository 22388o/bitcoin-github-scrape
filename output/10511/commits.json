[
  {
    "sha": "c8914b9dbbf6106dac3c62769f7ce3bacd8fbf9b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpjODkxNGI5ZGJiZjYxMDZkYWMzYzYyNzY5ZjdjZTNiYWNkOGZiZjli",
    "commit": {
      "author": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2017-06-02T21:13:08Z"
      },
      "committer": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2017-06-07T21:19:01Z"
      },
      "message": "Have `make cov` optionally include branch coverage statistics\n\nAdded an option to configure to allow for branch coverage statistics gathering.\n\nDisabled logprint macro when coverage testing is on so that unnecessary branches are not analyzed.",
      "tree": {
        "sha": "1d15ff6d2d3a98b41b5266cb68f1f7f1c02aa35c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/1d15ff6d2d3a98b41b5266cb68f1f7f1c02aa35c"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/c8914b9dbbf6106dac3c62769f7ce3bacd8fbf9b",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c8914b9dbbf6106dac3c62769f7ce3bacd8fbf9b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/c8914b9dbbf6106dac3c62769f7ce3bacd8fbf9b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c8914b9dbbf6106dac3c62769f7ce3bacd8fbf9b/comments",
    "author": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "46311e792f4e4a53b7dc418215b03d890d0594d5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/46311e792f4e4a53b7dc418215b03d890d0594d5",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/46311e792f4e4a53b7dc418215b03d890d0594d5"
      }
    ],
    "stats": {
      "total": 56,
      "additions": 40,
      "deletions": 16
    },
    "files": [
      {
        "sha": "27d9f5af81db38520415d3c499cff2a13ef0775e",
        "filename": "Makefile.am",
        "status": "modified",
        "additions": 16,
        "deletions": 16,
        "changes": 32,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/c8914b9dbbf6106dac3c62769f7ce3bacd8fbf9b/Makefile.am",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/c8914b9dbbf6106dac3c62769f7ce3bacd8fbf9b/Makefile.am",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/Makefile.am?ref=c8914b9dbbf6106dac3c62769f7ce3bacd8fbf9b",
        "patch": "@@ -171,47 +171,47 @@ baseline.info:\n \t$(LCOV) -c -i -d $(abs_builddir)/src -o $@\n \n baseline_filtered.info: baseline.info\n-\t$(LCOV) -r $< \"/usr/include/*\" -o $@\n+\t$(LCOV) -r $< \"/usr/include/*\" $(LCOV_OPTS) -o $@\n \n leveldb_baseline.info: baseline_filtered.info\n \t$(LCOV) -c -i -d $(abs_builddir)/src/leveldb -b $(abs_builddir)/src/leveldb -o $@\n \n leveldb_baseline_filtered.info: leveldb_baseline.info\n-\t$(LCOV) -r $< \"/usr/include/*\" -o $@\n+\t$(LCOV) -r $< \"/usr/include/*\" $(LCOV_OPTS) -o $@\n \n baseline_filtered_combined.info: leveldb_baseline_filtered.info baseline_filtered.info\n-\t$(LCOV) -a leveldb_baseline_filtered.info -a baseline_filtered.info -o $@\n+\t$(LCOV) -a $(LCOV_OPTS) leveldb_baseline_filtered.info -a baseline_filtered.info -o $@\n \n test_bitcoin.info: baseline_filtered_combined.info\n \t$(MAKE) -C src/ check\n-\t$(LCOV) -c -d $(abs_builddir)/src -t test_bitcoin -o $@\n-\t$(LCOV) -z -d $(abs_builddir)/src\n-\t$(LCOV) -z -d $(abs_builddir)/src/leveldb\n+\t$(LCOV) -c $(LCOV_OPTS) -d $(abs_builddir)/src -t test_bitcoin -o $@\n+\t$(LCOV) -z $(LCOV_OPTS) -d $(abs_builddir)/src\n+\t$(LCOV) -z $(LCOV_OPTS) -d $(abs_builddir)/src/leveldb\n \n test_bitcoin_filtered.info: test_bitcoin.info\n-\t$(LCOV) -r $< \"/usr/include/*\" -o $@\n+\t$(LCOV) -r $< \"/usr/include/*\" $(LCOV_OPTS) -o $@\n \n functional_test.info: test_bitcoin_filtered.info\n-\t-@TIMEOUT=15 python test/functional/test_runner.py $(EXTENDED_FUNCTIONAL_TESTS)\n-\t$(LCOV) -c -d $(abs_builddir)/src --t functional-tests -o $@\n-\t$(LCOV) -z -d $(abs_builddir)/src\n-\t$(LCOV) -z -d $(abs_builddir)/src/leveldb\n+\t-@TIMEOUT=15 test/functional/test_runner.py $(EXTENDED_FUNCTIONAL_TESTS)\n+\t$(LCOV) -c $(LCOV_OPTS) -d $(abs_builddir)/src --t functional-tests -o $@\n+\t$(LCOV) -z $(LCOV_OPTS) -d $(abs_builddir)/src\n+\t$(LCOV) -z $(LCOV_OPTS) -d $(abs_builddir)/src/leveldb\n \n functional_test_filtered.info: functional_test.info\n-\t$(LCOV) -r $< \"/usr/include/*\" -o $@\n+\t$(LCOV) -r $< \"/usr/include/*\" $(LCOV_OPTS) -o $@\n \n test_bitcoin_coverage.info: baseline_filtered_combined.info test_bitcoin_filtered.info\n-\t$(LCOV) -a baseline_filtered.info -a leveldb_baseline_filtered.info -a test_bitcoin_filtered.info -o $@\n+\t$(LCOV) -a $(LCOV_OPTS) baseline_filtered.info -a leveldb_baseline_filtered.info -a test_bitcoin_filtered.info -o $@\n \n total_coverage.info: baseline_filtered_combined.info test_bitcoin_filtered.info functional_test_filtered.info\n-\t$(LCOV) -a baseline_filtered.info -a leveldb_baseline_filtered.info -a test_bitcoin_filtered.info -a functional_test_filtered.info -o $@ | $(GREP) \"\\%\" | $(AWK) '{ print substr($$3,2,50) \"/\" $$5 }' > coverage_percent.txt\n+\t$(LCOV) -a $(LCOV_OPTS) baseline_filtered.info -a leveldb_baseline_filtered.info -a test_bitcoin_filtered.info -a functional_test_filtered.info -o $@ | $(GREP) \"\\%\" | $(AWK) '{ print substr($$3,2,50) \"/\" $$5 }' > coverage_percent.txt\n \n test_bitcoin.coverage/.dirstamp:  test_bitcoin_coverage.info\n-\t$(GENHTML) -s $< -o $(@D)\n+\t$(GENHTML) -s $(LCOV_OPTS) $< -o $(@D)\n \t@touch $@\n \n total.coverage/.dirstamp: total_coverage.info\n-\t$(GENHTML) -s $< -o $(@D)\n+\t$(GENHTML) -s $(LCOV_OPTS) $< -o $(@D)\n \t@touch $@\n \n cov: test_bitcoin.coverage/.dirstamp total.coverage/.dirstamp"
      },
      {
        "sha": "0f6149ea62d8f98a433af65fb21f1595b097b000",
        "filename": "configure.ac",
        "status": "modified",
        "additions": 12,
        "deletions": 0,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/c8914b9dbbf6106dac3c62769f7ce3bacd8fbf9b/configure.ac",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/c8914b9dbbf6106dac3c62769f7ce3bacd8fbf9b/configure.ac",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/configure.ac?ref=c8914b9dbbf6106dac3c62769f7ce3bacd8fbf9b",
        "patch": "@@ -158,6 +158,12 @@ AC_ARG_ENABLE([lcov],\n   [enable lcov testing (default is no)])],\n   [use_lcov=yes],\n   [use_lcov=no])\n+  \n+AC_ARG_ENABLE([lcov-branch-coverage],\n+  [AS_HELP_STRING([--enable-lcov-branch-coverage],\n+  [enable lcov testing branch coverage (default is no)])],\n+  [use_lcov_branch=yes],\n+  [use_lcov_branch=no])\n \n AC_ARG_ENABLE([glibc-back-compat],\n   [AS_HELP_STRING([--enable-glibc-back-compat],\n@@ -436,6 +442,12 @@ if test x$use_lcov = xyes; then\n     [AC_MSG_ERROR(\"lcov testing requested but --coverage linker flag does not work\")])\n   AX_CHECK_COMPILE_FLAG([--coverage],[CXXFLAGS=\"$CXXFLAGS --coverage\"],\n     [AC_MSG_ERROR(\"lcov testing requested but --coverage flag does not work\")])\n+  AC_DEFINE(USE_COVERAGE, 1, [Define this symbol if coverage is enabled])\n+  CXXFLAGS=\"$CXXFLAGS -Og\"\n+fi\n+\n+if test x$use_lcov_branch != xno; then\n+  AC_SUBST(LCOV_OPTS, \"$LCOV_OPTS --rc lcov_branch_coverage=1\")\n fi\n \n dnl Check for endianness"
      },
      {
        "sha": "a1c59bbd10e5dc0cd3666fe99687c543e7336d80",
        "filename": "src/util.h",
        "status": "modified",
        "additions": 12,
        "deletions": 0,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/c8914b9dbbf6106dac3c62769f7ce3bacd8fbf9b/src/util.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/c8914b9dbbf6106dac3c62769f7ce3bacd8fbf9b/src/util.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/util.h?ref=c8914b9dbbf6106dac3c62769f7ce3bacd8fbf9b",
        "patch": "@@ -123,6 +123,17 @@ int LogPrintStr(const std::string &str);\n /** Get format string from VA_ARGS for error reporting */\n template<typename... Args> std::string FormatStringFromLogArgs(const char *fmt, const Args&... args) { return fmt; }\n \n+static inline void MarkUsed() {}\n+template<typename T, typename... Args> static inline void MarkUsed(const T& t, const Args&... args)\n+{\n+    (void)t;\n+    MarkUsed(args...);\n+}\n+\n+#ifdef USE_COVERAGE\n+#define LogPrintf(...) do { MarkUsed(__VA_ARGS__); } while(0)\n+#define LogPrint(category, ...) do { MarkUsed(__VA_ARGS__); } while(0)\n+#else\n #define LogPrintf(...) do { \\\n     std::string _log_msg_; /* Unlikely name to avoid shadowing variables */ \\\n     try { \\\n@@ -139,6 +150,7 @@ template<typename... Args> std::string FormatStringFromLogArgs(const char *fmt,\n         LogPrintf(__VA_ARGS__); \\\n     } \\\n } while(0)\n+#endif\n \n template<typename... Args>\n bool error(const char* fmt, const Args&... args)"
      }
    ]
  },
  {
    "sha": "368c10d1251fb79eeb3f26a426edb4333e22d48b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozNjhjMTBkMTI1MWZiNzllZWIzZjI2YTQyNmVkYjQzMzNlMjJkNDhi",
    "commit": {
      "author": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2017-06-07T00:26:56Z"
      },
      "committer": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2017-06-13T17:51:06Z"
      },
      "message": "Replace lcov -r commands with faster way\n\nInstead of using lcov -r (which is extremely slow), first use a python script to perform bulk cleanup of the /usr/include/* coverage. Then use lcov -a to remove the duplicate entries. This has the same effect of lcov -r but runs significantly faster",
      "tree": {
        "sha": "b548849150ec548fa36aeb984ef9bd772bceee64",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/b548849150ec548fa36aeb984ef9bd772bceee64"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/368c10d1251fb79eeb3f26a426edb4333e22d48b",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/368c10d1251fb79eeb3f26a426edb4333e22d48b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/368c10d1251fb79eeb3f26a426edb4333e22d48b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/368c10d1251fb79eeb3f26a426edb4333e22d48b/comments",
    "author": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "c8914b9dbbf6106dac3c62769f7ce3bacd8fbf9b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c8914b9dbbf6106dac3c62769f7ce3bacd8fbf9b",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/c8914b9dbbf6106dac3c62769f7ce3bacd8fbf9b"
      }
    ],
    "stats": {
      "total": 39,
      "additions": 35,
      "deletions": 4
    },
    "files": [
      {
        "sha": "88879b9e42070ada3e33027040b65b7ef5efa313",
        "filename": "Makefile.am",
        "status": "modified",
        "additions": 8,
        "deletions": 4,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/368c10d1251fb79eeb3f26a426edb4333e22d48b/Makefile.am",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/368c10d1251fb79eeb3f26a426edb4333e22d48b/Makefile.am",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/Makefile.am?ref=368c10d1251fb79eeb3f26a426edb4333e22d48b",
        "patch": "@@ -171,13 +171,15 @@ baseline.info:\n \t$(LCOV) -c -i -d $(abs_builddir)/src -o $@\n \n baseline_filtered.info: baseline.info\n-\t$(LCOV) -r $< \"/usr/include/*\" $(LCOV_OPTS) -o $@\n+\t$(abs_builddir)/contrib/filter-lcov.py \"/usr/include/\" $< $@\n+\t$(LCOV) -a $@ $(LCOV_OPTS) -o $@\n \n leveldb_baseline.info: baseline_filtered.info\n \t$(LCOV) -c -i -d $(abs_builddir)/src/leveldb -b $(abs_builddir)/src/leveldb -o $@\n \n leveldb_baseline_filtered.info: leveldb_baseline.info\n-\t$(LCOV) -r $< \"/usr/include/*\" $(LCOV_OPTS) -o $@\n+\t$(abs_builddir)/contrib/filter-lcov.py \"/usr/include/\" $< $@\n+\t$(LCOV) -a $@ $(LCOV_OPTS) -o $@\n \n baseline_filtered_combined.info: leveldb_baseline_filtered.info baseline_filtered.info\n \t$(LCOV) -a $(LCOV_OPTS) leveldb_baseline_filtered.info -a baseline_filtered.info -o $@\n@@ -189,7 +191,8 @@ test_bitcoin.info: baseline_filtered_combined.info\n \t$(LCOV) -z $(LCOV_OPTS) -d $(abs_builddir)/src/leveldb\n \n test_bitcoin_filtered.info: test_bitcoin.info\n-\t$(LCOV) -r $< \"/usr/include/*\" $(LCOV_OPTS) -o $@\n+\t$(abs_builddir)/contrib/filter-lcov.py \"/usr/include/\" $< $@\n+\t$(LCOV) -a $@ $(LCOV_OPTS) -o $@\n \n functional_test.info: test_bitcoin_filtered.info\n \t-@TIMEOUT=15 test/functional/test_runner.py $(EXTENDED_FUNCTIONAL_TESTS)\n@@ -198,7 +201,8 @@ functional_test.info: test_bitcoin_filtered.info\n \t$(LCOV) -z $(LCOV_OPTS) -d $(abs_builddir)/src/leveldb\n \n functional_test_filtered.info: functional_test.info\n-\t$(LCOV) -r $< \"/usr/include/*\" $(LCOV_OPTS) -o $@\n+\t$(abs_builddir)/contrib/filter-lcov.py \"/usr/include/\" $< $@\n+\t$(LCOV) -a $@ $(LCOV_OPTS) -o $@\n \n test_bitcoin_coverage.info: baseline_filtered_combined.info test_bitcoin_filtered.info\n \t$(LCOV) -a $(LCOV_OPTS) baseline_filtered.info -a leveldb_baseline_filtered.info -a test_bitcoin_filtered.info -o $@"
      },
      {
        "sha": "c65787b1b60ffd13c39b2c71ff4dc8909f53cfcb",
        "filename": "contrib/filter-lcov.py",
        "status": "added",
        "additions": 27,
        "deletions": 0,
        "changes": 27,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/368c10d1251fb79eeb3f26a426edb4333e22d48b/contrib/filter-lcov.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/368c10d1251fb79eeb3f26a426edb4333e22d48b/contrib/filter-lcov.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/filter-lcov.py?ref=368c10d1251fb79eeb3f26a426edb4333e22d48b",
        "patch": "@@ -0,0 +1,27 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 Bitcoin Core Developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+import argparse\n+\n+parser = argparse.ArgumentParser(description='Remove the coverage data from a tracefile for all files matching the pattern.')\n+parser.add_argument('pattern', help='the pattern of files to remove')\n+parser.add_argument('tracefile', help='the tracefile to remove the coverage data from')\n+parser.add_argument('outfile', help='filename for the output to be written to')\n+\n+args = parser.parse_args()\n+tracefile = args.tracefile\n+pattern = args.pattern\n+outfile = args.outfile\n+\n+in_remove = False\n+with open(tracefile, 'r') as f:\n+    with open(outfile, 'w') as wf:\n+        for line in f:\n+            if line.startswith(\"SF:\") and pattern in line:\n+                in_remove = True\n+            if not in_remove:\n+                wf.write(line)\n+            if line == 'end_of_record\\n':\n+                in_remove = False"
      }
    ]
  }
]