[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/432389031",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#issuecomment-432389031",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14552",
    "id": 432389031,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMjM4OTAzMQ==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-23T19:36:09Z",
    "updated_at": "2018-10-23T19:36:09Z",
    "author_association": "CONTRIBUTOR",
    "body": "Would prefer to check this at database level, rather than in higher level wallet code. I think it's better if high level code just passes along wallet paths and isn't concerned with how data is stored in them.\r\n\r\nI posted a tweaked version of this PR at 40a6475e59950838be532b0a2c58f4359eae5625 which moves the check. @ken2812221, could you incorporate 40a6475e59950838be532b0a2c58f4359eae5625 into this PR if you think it makes sense?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/432389031/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/432409103",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#issuecomment-432409103",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14552",
    "id": 432409103,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMjQwOTEwMw==",
    "user": {
      "login": "ken2812221",
      "id": 11154118,
      "node_id": "MDQ6VXNlcjExMTU0MTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/11154118?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ken2812221",
      "html_url": "https://github.com/ken2812221",
      "followers_url": "https://api.github.com/users/ken2812221/followers",
      "following_url": "https://api.github.com/users/ken2812221/following{/other_user}",
      "gists_url": "https://api.github.com/users/ken2812221/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ken2812221/subscriptions",
      "organizations_url": "https://api.github.com/users/ken2812221/orgs",
      "repos_url": "https://api.github.com/users/ken2812221/repos",
      "events_url": "https://api.github.com/users/ken2812221/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ken2812221/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-23T20:34:11Z",
    "updated_at": "2018-10-24T09:05:27Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ryanofsky The element in mapDb is not always exist.\r\n\r\nFor example:\r\n1. Load wallet `dir/w1`\r\n2. Load wallet `dir/w2`\r\n3. Unload wallet `dir/w1`\r\n\r\nNow mapDb contains neither `dir/w1` nor `dir/w2` because it would flush all wallet files that share same BerkeleyEnvironment\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/432409103/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/432437568",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#issuecomment-432437568",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14552",
    "id": 432437568,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMjQzNzU2OA==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-23T22:01:03Z",
    "updated_at": "2018-11-05T20:10:52Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#11911](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/11911.html) (Free BerkeleyEnvironment instances when not in use by ryanofsky)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/432437568/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/432826947",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#issuecomment-432826947",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14552",
    "id": 432826947,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzMjgyNjk0Nw==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-10-24T21:02:11Z",
    "updated_at": "2018-10-24T21:02:11Z",
    "author_association": "CONTRIBUTOR",
    "body": "> @ryanofsky The element in mapDb is not always exist.\r\n\r\nGood catch. I think a small refactoring could fix this: 9c945d011abde24f8649d877e694d392e1a5727e. And then the fix would change slightly to aef19be5851ceb3b324fd80756060a00aad8e61c.\r\n\r\nI pushed a branch with these two commits to: https://github.com/ryanofsky/bitcoin/commits/pr/bloaded\r\n\r\nI think this is a better than checking for wallet.dat files outside the database layer, but let me know what you think, and feel free to use the code or commits in this PR if you think this approach makes sense.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/432826947/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/435873156",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#issuecomment-435873156",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14552",
    "id": 435873156,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNTg3MzE1Ng==",
    "user": {
      "login": "ken2812221",
      "id": 11154118,
      "node_id": "MDQ6VXNlcjExMTU0MTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/11154118?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ken2812221",
      "html_url": "https://github.com/ken2812221",
      "followers_url": "https://api.github.com/users/ken2812221/followers",
      "following_url": "https://api.github.com/users/ken2812221/following{/other_user}",
      "gists_url": "https://api.github.com/users/ken2812221/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ken2812221/subscriptions",
      "organizations_url": "https://api.github.com/users/ken2812221/orgs",
      "repos_url": "https://api.github.com/users/ken2812221/repos",
      "events_url": "https://api.github.com/users/ken2812221/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ken2812221/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-05T13:28:25Z",
    "updated_at": "2018-11-05T13:28:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "Rebased",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/435873156/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/435925125",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#issuecomment-435925125",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14552",
    "id": 435925125,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNTkyNTEyNQ==",
    "user": {
      "login": "ken2812221",
      "id": 11154118,
      "node_id": "MDQ6VXNlcjExMTU0MTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/11154118?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ken2812221",
      "html_url": "https://github.com/ken2812221",
      "followers_url": "https://api.github.com/users/ken2812221/followers",
      "following_url": "https://api.github.com/users/ken2812221/following{/other_user}",
      "gists_url": "https://api.github.com/users/ken2812221/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ken2812221/subscriptions",
      "organizations_url": "https://api.github.com/users/ken2812221/orgs",
      "repos_url": "https://api.github.com/users/ken2812221/repos",
      "events_url": "https://api.github.com/users/ken2812221/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ken2812221/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-05T15:51:10Z",
    "updated_at": "2018-11-05T15:51:10Z",
    "author_association": "CONTRIBUTOR",
    "body": "@ryanofsky Thanks for your review. I would take your suggestion.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/435925125/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/436202696",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#issuecomment-436202696",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14552",
    "id": 436202696,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNjIwMjY5Ng==",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?u=4a9af998e1a560b3f49c3827f453e1bcbe6a5cfb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-06T10:20:33Z",
    "updated_at": "2018-11-06T10:20:33Z",
    "author_association": "MEMBER",
    "body": "utACK 15c93f0.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/436202696/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/437061444",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#issuecomment-437061444",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14552",
    "id": 437061444,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNzA2MTQ0NA==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-08T16:33:17Z",
    "updated_at": "2018-11-08T16:33:17Z",
    "author_association": "CONTRIBUTOR",
    "body": "utACK 591203149f1700f594f781862e88cbbfe83d8d37. Just minor tweaks since last review: replacing map::at exception with assert, adding IsDatabaseLoaded.\r\n\r\n@promag and @MarcoFalke, I've noticed that in your recent reviews you've been advocating replacing exceptions with asserts or return codes. Maybe one of you can write up some guidelines about when to use exceptions in the developer guide. Personally, I tend to like exceptions and think that whatever drawbacks they have will be fixed by new c++ features like `throws`/`std::error` in \r\nhttp://www.open-std.org/jtc1/sc22/wg21/docs/papers/2018/p0709r0.pdf (see \u00a74.1.1 \"Elevator Pitch\")",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/437061444/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/437361617",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#issuecomment-437361617",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14552",
    "id": 437361617,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzNzM2MTYxNw==",
    "user": {
      "login": "meshcollider",
      "id": 3211283,
      "node_id": "MDQ6VXNlcjMyMTEyODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3211283?u=447cdc9e2966cbee415545c8ff452954ee1209af&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/meshcollider",
      "html_url": "https://github.com/meshcollider",
      "followers_url": "https://api.github.com/users/meshcollider/followers",
      "following_url": "https://api.github.com/users/meshcollider/following{/other_user}",
      "gists_url": "https://api.github.com/users/meshcollider/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/meshcollider/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/meshcollider/subscriptions",
      "organizations_url": "https://api.github.com/users/meshcollider/orgs",
      "repos_url": "https://api.github.com/users/meshcollider/repos",
      "events_url": "https://api.github.com/users/meshcollider/events{/privacy}",
      "received_events_url": "https://api.github.com/users/meshcollider/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-09T13:37:36Z",
    "updated_at": "2018-11-09T13:37:36Z",
    "author_association": "MEMBER",
    "body": "utACK https://github.com/bitcoin/bitcoin/pull/14552/commits/591203149f1700f594f781862e88cbbfe83d8d37, looks good",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/437361617/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/439125552",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#issuecomment-439125552",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14552",
    "id": 439125552,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzOTEyNTU1Mg==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-15T17:35:41Z",
    "updated_at": "2018-11-15T17:35:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "Can this be merged? It fixes an ugly bug and has some refactoring changes I want to build on. If it can't be merged, maybe it could be added to https://github.com/bitcoin/bitcoin/projects/8",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/439125552/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/439140212",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#issuecomment-439140212",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14552",
    "id": 439140212,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzOTE0MDIxMg==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-15T18:21:13Z",
    "updated_at": "2018-11-15T18:21:13Z",
    "author_association": "MEMBER",
    "body": "Is this for backport?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/439140212/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/439142609",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#issuecomment-439142609",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/14552",
    "id": 439142609,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQzOTE0MjYwOQ==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-11-15T18:28:48Z",
    "updated_at": "2018-11-15T18:31:25Z",
    "author_association": "CONTRIBUTOR",
    "body": "> Is this for backport?\r\n\r\nI don't have a great sense for which changes get backported and which changes don't. I would guess it could be backported, but I don't think it's important to backport. Original bug #14538 reporter @chernyshev might have an opinion.\r\n\r\nNote: related fix https://github.com/bitcoin/bitcoin/pull/14320#issuecomment-425159822 does not appear to have been backported.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/439142609/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230800120",
    "pull_request_review_id": 171619030,
    "id": 230800120,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMDgwMDEyMA==",
    "diff_hunk": "@@ -463,7 +463,8 @@ BerkeleyBatch::BerkeleyBatch(BerkeleyDatabase& database, const char* pszMode, bo\n         if (!env->Open(false /* retry */))\n             throw std::runtime_error(\"BerkeleyBatch: Failed to open database environment.\");\n \n-        pdb = env->mapDb[strFilename];\n+        BerkeleyDatabase& database = env->m_databases.at(strFilename).get();",
    "path": "src/wallet/db.cpp",
    "position": null,
    "original_position": 24,
    "commit_id": "591203149f1700f594f781862e88cbbfe83d8d37",
    "original_commit_id": "1a2b9223662f1a9458d53d1c8f7c0fcf8e37a7e9",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Some comments here:\r\n - there's a slight change when replacing `map::operator[]` with `map::at`, maybe worth a comemnt or an assertion?\r\n - also, isn't this equivalent to the above `database` argument?\r\n - if this is really necessary then you could avoid shadowing `database`.",
    "created_at": "2018-11-05T15:47:40Z",
    "updated_at": "2018-11-08T03:54:46Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r230800120",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230800120"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r230800120"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230800120/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 466,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230800921",
    "pull_request_review_id": 171619030,
    "id": 230800921,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMDgwMDkyMQ==",
    "diff_hunk": "@@ -115,13 +117,22 @@ class BerkeleyDatabase\n         nUpdateCounter(0), nLastSeen(0), nLastFlushed(0), nLastWalletUpdate(0)\n     {\n         env = GetWalletEnv(wallet_path, strFile);\n+        auto inserted = env->m_databases.emplace(strFile, std::ref(*this));\n+        assert(inserted.second);\n         if (mock) {\n             env->Close();\n             env->Reset();\n             env->MakeMock();\n         }\n     }\n \n+    ~BerkeleyDatabase() {",
    "path": "src/wallet/db.h",
    "position": 49,
    "original_position": 31,
    "commit_id": "591203149f1700f594f781862e88cbbfe83d8d37",
    "original_commit_id": "1a2b9223662f1a9458d53d1c8f7c0fcf8e37a7e9",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit, could add `final` to class since this is not virtual.",
    "created_at": "2018-11-05T15:49:20Z",
    "updated_at": "2018-11-08T03:54:46Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r230800921",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230800921"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r230800921"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230800921/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 133,
    "original_line": 132,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230802798",
    "pull_request_review_id": 171619030,
    "id": 230802798,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMDgwMjc5OA==",
    "diff_hunk": "@@ -56,9 +56,8 @@ bool WalletDatabaseFileId::operator==(const WalletDatabaseFileId& rhs) const\n     return memcmp(value, &rhs.value, sizeof(value)) == 0;\n }\n \n-BerkeleyEnvironment* GetWalletEnv(const fs::path& wallet_path, std::string& database_filename)\n+void SplitWalletPath(const fs::path& wallet_path, fs::path& env_directory, std::string& database_filename)",
    "path": "src/wallet/db.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "591203149f1700f594f781862e88cbbfe83d8d37",
    "original_commit_id": "b0375538375eb0c419b308d1015723ab64d53294",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Could be `static`?",
    "created_at": "2018-11-05T15:53:44Z",
    "updated_at": "2018-11-08T03:54:46Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r230802798",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230802798"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r230802798"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230802798/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 59,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230808159",
    "pull_request_review_id": 171629140,
    "id": 230808159,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMDgwODE1OQ==",
    "diff_hunk": "@@ -463,7 +463,8 @@ BerkeleyBatch::BerkeleyBatch(BerkeleyDatabase& database, const char* pszMode, bo\n         if (!env->Open(false /* retry */))\n             throw std::runtime_error(\"BerkeleyBatch: Failed to open database environment.\");\n \n-        pdb = env->mapDb[strFilename];\n+        BerkeleyDatabase& database = env->m_databases.at(strFilename).get();",
    "path": "src/wallet/db.cpp",
    "position": null,
    "original_position": 24,
    "commit_id": "591203149f1700f594f781862e88cbbfe83d8d37",
    "original_commit_id": "1a2b9223662f1a9458d53d1c8f7c0fcf8e37a7e9",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "re: https://github.com/bitcoin/bitcoin/pull/14552#discussion_r230800120\r\n\r\nOh, I didn't even realize there was a `database` argument being shadowed above. Should just delete this line and use the existing `database`, which points to the same thing.",
    "created_at": "2018-11-05T16:06:02Z",
    "updated_at": "2018-11-08T03:54:46Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r230808159",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230808159"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r230808159"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230808159/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 466,
    "side": "RIGHT",
    "in_reply_to_id": 230800120
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230810096",
    "pull_request_review_id": 171631637,
    "id": 230810096,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMDgxMDA5Ng==",
    "diff_hunk": "@@ -563,12 +581,11 @@ void BerkeleyEnvironment::CloseDb(const std::string& strFile)\n {\n     {\n         LOCK(cs_db);\n-        if (mapDb[strFile] != nullptr) {\n+        BerkeleyDatabase& database = m_databases.at(strFile).get();",
    "path": "src/wallet/db.cpp",
    "position": null,
    "original_position": 79,
    "commit_id": "591203149f1700f594f781862e88cbbfe83d8d37",
    "original_commit_id": "b0375538375eb0c419b308d1015723ab64d53294",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Same as above, there's a slight change when replacing `map::operator[]` with `map::at`, maybe worth a comment or an assertion?",
    "created_at": "2018-11-05T16:11:01Z",
    "updated_at": "2018-11-08T03:54:46Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r230810096",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230810096"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r230810096"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230810096/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 584,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230825166",
    "pull_request_review_id": 171650318,
    "id": 230825166,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMDgyNTE2Ng==",
    "diff_hunk": "@@ -115,13 +117,22 @@ class BerkeleyDatabase\n         nUpdateCounter(0), nLastSeen(0), nLastFlushed(0), nLastWalletUpdate(0)\n     {\n         env = GetWalletEnv(wallet_path, strFile);\n+        auto inserted = env->m_databases.emplace(strFile, std::ref(*this));\n+        assert(inserted.second);\n         if (mock) {\n             env->Close();\n             env->Reset();\n             env->MakeMock();\n         }\n     }\n \n+    ~BerkeleyDatabase() {",
    "path": "src/wallet/db.h",
    "position": 49,
    "original_position": 31,
    "commit_id": "591203149f1700f594f781862e88cbbfe83d8d37",
    "original_commit_id": "1a2b9223662f1a9458d53d1c8f7c0fcf8e37a7e9",
    "user": {
      "login": "ken2812221",
      "id": 11154118,
      "node_id": "MDQ6VXNlcjExMTU0MTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/11154118?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ken2812221",
      "html_url": "https://github.com/ken2812221",
      "followers_url": "https://api.github.com/users/ken2812221/followers",
      "following_url": "https://api.github.com/users/ken2812221/following{/other_user}",
      "gists_url": "https://api.github.com/users/ken2812221/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ken2812221/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ken2812221/subscriptions",
      "organizations_url": "https://api.github.com/users/ken2812221/orgs",
      "repos_url": "https://api.github.com/users/ken2812221/repos",
      "events_url": "https://api.github.com/users/ken2812221/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ken2812221/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`final` can only be added to virtual method.",
    "created_at": "2018-11-05T16:46:40Z",
    "updated_at": "2018-11-08T03:54:46Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r230825166",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230825166"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r230825166"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230825166/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 133,
    "original_line": 132,
    "side": "RIGHT",
    "in_reply_to_id": 230800921
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230825935",
    "pull_request_review_id": 171651339,
    "id": 230825935,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMDgyNTkzNQ==",
    "diff_hunk": "@@ -115,13 +117,22 @@ class BerkeleyDatabase\n         nUpdateCounter(0), nLastSeen(0), nLastFlushed(0), nLastWalletUpdate(0)\n     {\n         env = GetWalletEnv(wallet_path, strFile);\n+        auto inserted = env->m_databases.emplace(strFile, std::ref(*this));\n+        assert(inserted.second);\n         if (mock) {\n             env->Close();\n             env->Reset();\n             env->MakeMock();\n         }\n     }\n \n+    ~BerkeleyDatabase() {",
    "path": "src/wallet/db.h",
    "position": 49,
    "original_position": 31,
    "commit_id": "591203149f1700f594f781862e88cbbfe83d8d37",
    "original_commit_id": "1a2b9223662f1a9458d53d1c8f7c0fcf8e37a7e9",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@ken2812221 I mean `class BerkeleyDatabase final`.",
    "created_at": "2018-11-05T16:48:37Z",
    "updated_at": "2018-11-08T03:54:46Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r230825935",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230825935"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r230825935"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230825935/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 133,
    "original_line": 132,
    "side": "RIGHT",
    "in_reply_to_id": 230800921
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230838723",
    "pull_request_review_id": 171667387,
    "id": 230838723,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMDgzODcyMw==",
    "diff_hunk": "@@ -115,13 +117,22 @@ class BerkeleyDatabase\n         nUpdateCounter(0), nLastSeen(0), nLastFlushed(0), nLastWalletUpdate(0)\n     {\n         env = GetWalletEnv(wallet_path, strFile);\n+        auto inserted = env->m_databases.emplace(strFile, std::ref(*this));\n+        assert(inserted.second);\n         if (mock) {\n             env->Close();\n             env->Reset();\n             env->MakeMock();\n         }\n     }\n \n+    ~BerkeleyDatabase() {",
    "path": "src/wallet/db.h",
    "position": 49,
    "original_position": 31,
    "commit_id": "591203149f1700f594f781862e88cbbfe83d8d37",
    "original_commit_id": "1a2b9223662f1a9458d53d1c8f7c0fcf8e37a7e9",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Change would be unrelated to this PR, and IMO, it's better only to use final when you have virtual methods and actual optimizations this would allow or bugs it would prevent. There's a core guideline that touches on this: http://isocpp.github.io/CppCoreGuidelines/CppCoreGuidelines#Rh-final",
    "created_at": "2018-11-05T17:23:06Z",
    "updated_at": "2018-11-08T03:54:46Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r230838723",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230838723"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r230838723"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230838723/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 133,
    "original_line": 132,
    "side": "RIGHT",
    "in_reply_to_id": 230800921
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230841325",
    "pull_request_review_id": 171670650,
    "id": 230841325,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMDg0MTMyNQ==",
    "diff_hunk": "@@ -115,13 +117,22 @@ class BerkeleyDatabase\n         nUpdateCounter(0), nLastSeen(0), nLastFlushed(0), nLastWalletUpdate(0)\n     {\n         env = GetWalletEnv(wallet_path, strFile);\n+        auto inserted = env->m_databases.emplace(strFile, std::ref(*this));\n+        assert(inserted.second);\n         if (mock) {\n             env->Close();\n             env->Reset();\n             env->MakeMock();\n         }\n     }\n \n+    ~BerkeleyDatabase() {",
    "path": "src/wallet/db.h",
    "position": 49,
    "original_position": 31,
    "commit_id": "591203149f1700f594f781862e88cbbfe83d8d37",
    "original_commit_id": "1a2b9223662f1a9458d53d1c8f7c0fcf8e37a7e9",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Nice thanks.",
    "created_at": "2018-11-05T17:30:38Z",
    "updated_at": "2018-11-08T03:54:46Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r230841325",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230841325"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r230841325"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/230841325/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 133,
    "original_line": 132,
    "side": "RIGHT",
    "in_reply_to_id": 230800921
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231096324",
    "pull_request_review_id": 171984230,
    "id": 231096324,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMTA5NjMyNA==",
    "diff_hunk": "@@ -71,6 +70,24 @@ BerkeleyEnvironment* GetWalletEnv(const fs::path& wallet_path, std::string& data\n         env_directory = wallet_path;\n         database_filename = \"wallet.dat\";\n     }\n+}\n+\n+bool IsWalletLoaded(const fs::path& wallet_path)\n+{\n+    fs::path env_directory;\n+    std::string database_filename;\n+    SplitWalletPath(wallet_path, env_directory, database_filename);\n+    LOCK(cs_db);\n+    auto env = g_dbenvs.find(env_directory.string());\n+    if (env == g_dbenvs.end()) return false;\n+    auto db = env->second.m_databases.find(database_filename);",
    "path": "src/wallet/db.cpp",
    "position": null,
    "original_position": 25,
    "commit_id": "591203149f1700f594f781862e88cbbfe83d8d37",
    "original_commit_id": "15c93f075a881deb3ad7b1dd8a4516a9b06e5e11",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think this is leaking the implementation detail of `m_databases`, wouldn't checking whether a database exists ideally be a responsibility of the database environment. e.g. add a `bool IsDatabaseLoaded(name)` on `DBenv`?",
    "created_at": "2018-11-06T12:01:40Z",
    "updated_at": "2018-11-08T03:54:46Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r231096324",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231096324"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r231096324"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231096324/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 83,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231099786",
    "pull_request_review_id": 171988725,
    "id": 231099786,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMTA5OTc4Ng==",
    "diff_hunk": "@@ -71,6 +70,24 @@ BerkeleyEnvironment* GetWalletEnv(const fs::path& wallet_path, std::string& data\n         env_directory = wallet_path;\n         database_filename = \"wallet.dat\";\n     }\n+}\n+\n+bool IsWalletLoaded(const fs::path& wallet_path)\n+{\n+    fs::path env_directory;\n+    std::string database_filename;\n+    SplitWalletPath(wallet_path, env_directory, database_filename);\n+    LOCK(cs_db);\n+    auto env = g_dbenvs.find(env_directory.string());\n+    if (env == g_dbenvs.end()) return false;\n+    auto db = env->second.m_databases.find(database_filename);",
    "path": "src/wallet/db.cpp",
    "position": null,
    "original_position": 25,
    "commit_id": "591203149f1700f594f781862e88cbbfe83d8d37",
    "original_commit_id": "15c93f075a881deb3ad7b1dd8a4516a9b06e5e11",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Note that `BerkeleyEnvironment::mapDb` is currently used outside. I consider this a bugfix so any improvement/refactor could come next.",
    "created_at": "2018-11-06T12:15:05Z",
    "updated_at": "2018-11-08T03:54:46Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r231099786",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231099786"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r231099786"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231099786/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 83,
    "side": "RIGHT",
    "in_reply_to_id": 231096324
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231968260",
    "pull_request_review_id": 173055063,
    "id": 231968260,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzMTk2ODI2MA==",
    "diff_hunk": "@@ -71,6 +70,24 @@ BerkeleyEnvironment* GetWalletEnv(const fs::path& wallet_path, std::string& data\n         env_directory = wallet_path;\n         database_filename = \"wallet.dat\";\n     }\n+}\n+\n+bool IsWalletLoaded(const fs::path& wallet_path)\n+{\n+    fs::path env_directory;\n+    std::string database_filename;\n+    SplitWalletPath(wallet_path, env_directory, database_filename);\n+    LOCK(cs_db);\n+    auto env = g_dbenvs.find(env_directory.string());\n+    if (env == g_dbenvs.end()) return false;\n+    auto db = env->second.m_databases.find(database_filename);",
    "path": "src/wallet/db.cpp",
    "position": null,
    "original_position": 25,
    "commit_id": "591203149f1700f594f781862e88cbbfe83d8d37",
    "original_commit_id": "15c93f075a881deb3ad7b1dd8a4516a9b06e5e11",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This is now resolved (by adding `IsDatabaseLoaded`)",
    "created_at": "2018-11-08T16:34:03Z",
    "updated_at": "2018-11-08T16:34:33Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r231968260",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231968260"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r231968260"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/231968260/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 83,
    "side": "RIGHT",
    "in_reply_to_id": 231096324
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/234812302",
    "pull_request_review_id": 176535062,
    "id": 234812302,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDIzNDgxMjMwMg==",
    "diff_hunk": "@@ -43,7 +45,7 @@ class BerkeleyEnvironment\n public:\n     std::unique_ptr<DbEnv> dbenv;\n     std::map<std::string, int> mapFileUseCount;\n-    std::map<std::string, Db*> mapDb;\n+    std::map<std::string, std::reference_wrapper<BerkeleyDatabase>> m_databases;",
    "path": "src/wallet/db.h",
    "position": 14,
    "original_position": 14,
    "commit_id": "591203149f1700f594f781862e88cbbfe83d8d37",
    "original_commit_id": "591203149f1700f594f781862e88cbbfe83d8d37",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Shouldn't this be guarded by `cs_db`?",
    "created_at": "2018-11-19T22:51:39Z",
    "updated_at": "2018-11-19T22:51:39Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r234812302",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/234812302"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/14552#discussion_r234812302"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/14552"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/234812302/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 48,
    "original_line": 48,
    "side": "RIGHT"
  }
]