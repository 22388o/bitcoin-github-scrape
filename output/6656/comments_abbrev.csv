dcousens,2015-09-10T02:45:08Z,"For those unaware,  you can view the diff without whitespace changes by adding `?w=0` to the [url](https://github.com/bitcoin/bitcoin/pull/6656/files?w=0).\n\nutACK.\n",https://github.com/bitcoin/bitcoin/pull/6656#issuecomment-139100657,139100657,
btcdrak,2015-09-10T09:18:20Z,utACK\n,https://github.com/bitcoin/bitcoin/pull/6656#issuecomment-139178921,139178921,
sdaftuar,2015-09-10T13:42:13Z,What do you think about moving the calls to `mempool.removeForReorg()` that are inside `ActivateBestChainStep()` to `ActivateBestChain()`?  I think that would probably make things a bit cleaner.\n,https://github.com/bitcoin/bitcoin/pull/6656#issuecomment-139237628,139237628,
TheBlueMatt,2015-09-10T23:24:44Z,"@sdaftuar I'd feel bad calling removeForReorg and iterating over the mempool after each new block (instead of only if we actually called Disconnect). It would simplify the code some, but not much? I dunno, do you think its worth it?\n",https://github.com/bitcoin/bitcoin/pull/6656#issuecomment-139410088,139410088,
sipa,2015-09-10T23:28:13Z,"It should be in Step, I think. In between the calls to Step cs_main is released, so the result is observable. I don't think we want to release cs_main while the mempool is in an inconsistent state.\n",https://github.com/bitcoin/bitcoin/pull/6656#issuecomment-139410524,139410524,
TheBlueMatt,2015-09-10T23:31:02Z,I believe @sdaftuar meant to put the call before cs_main was released in ActivateBestChain so that you dont have to do it before every return statement.\n,https://github.com/bitcoin/bitcoin/pull/6656#issuecomment-139410871,139410871,
sipa,2015-09-10T23:31:41Z,"Ah, no opinion.\n",https://github.com/bitcoin/bitcoin/pull/6656#issuecomment-139410943,139410943,
sdaftuar,2015-09-11T00:43:43Z,"Yeah that's what I had in mind, except my thought was to continue to use the blocksDisconnected bool to signal the caller it should make the call to mempool.removeForReorg() (ie pass in a new bool by reference and populate it in ActivateBestChainStep).  It just seems less error prone for future changes to the code to not have to guard every place ActivateBestChainStep returns (and since ActivateBe",https://github.com/bitcoin/bitcoin/pull/6656#issuecomment-139419587,139419587,
sdaftuar,2015-09-11T14:48:10Z,"@TheBlueMatt: this is what I had in mind:  https://github.com/sdaftuar/bitcoin/commit/cc4b7b0959c8fe3e12337cb1bfd642ad7f042449\n\nEh, maybe it's just personal taste which formulation is better, you can take it or leave it.  I'll think about additional testing.\n",https://github.com/bitcoin/bitcoin/pull/6656#issuecomment-139565286,139565286,
petertodd,2015-09-21T17:42:54Z,Looks like this needs a rebase now that #6654 is merged.\n,https://github.com/bitcoin/bitcoin/pull/6656#issuecomment-142055780,142055780,
TheBlueMatt,2015-09-26T00:26:05Z,"This needs a more involved rebase, because it requires a more thourough checking that it is still correct. Closing for now, someone can come along and fix it again later.\n",https://github.com/bitcoin/bitcoin/pull/6656#issuecomment-143382882,143382882,
