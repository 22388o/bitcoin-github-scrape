[
  {
    "sha": "a369b3deccd24ac9eb3fb5dee90a859ee408134f",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphMzY5YjNkZWNjZDI0YWM5ZWIzZmI1ZGVlOTBhODU5ZWU0MDgxMzRm",
    "commit": {
      "author": {
        "name": "imharrywu",
        "email": "imharrywu@users.noreply.github.com",
        "date": "2014-09-28T09:08:38Z"
      },
      "committer": {
        "name": "imharrywu",
        "email": "imharrywu@users.noreply.github.com",
        "date": "2014-09-28T09:08:38Z"
      },
      "message": "null pointer of pindexPrev crash.\n\ni use bitcoind to mine, and if BitcoinMiner() is started before ConnectTip(), pindexPrev will be null pointer, and bitcoind will crash.\r\nmaybe this fix is the optimized fix, although i have test it on my gentoobox and i seems working now.\r\n\r\nhere are logs and stack:\r\n\r\nStarting program: /root/harrywu/build/tmp/native/run-0.9.99/bitcoind -datadir=/root/harrywu/build/tmp/native/run/data -conf=bitcoin.conf -server -gen -debug -checkpoints=0 -txindex=1 -reindex\r\nwarning: Could not load shared library symbols for linux-gate.so.1.\r\nDo you need \"set solib-search-path\" or \"set sysroot\"?\r\n[Thread debugging using libthread_db enabled]\r\nUsing host libthread_db library \"/lib/libthread_db.so.1\".\r\n[New Thread 0xb7cc8b40 (LWP 25005)]\r\n[New Thread 0xb72ffb40 (LWP 25006)]\r\n[New Thread 0xb6afeb40 (LWP 25007)]\r\n[New Thread 0xb60ffb40 (LWP 25008)]\r\n[New Thread 0xb4ac0b40 (LWP 25009)]\r\n[New Thread 0xb40d6b40 (LWP 25010)]\r\n[New Thread 0xb38d5b40 (LWP 25011)]\r\n[New Thread 0xb2effb40 (LWP 25012)]\r\n[New Thread 0xb24ffb40 (LWP 25013)]\r\n[New Thread 0xb1cfeb40 (LWP 25014)]\r\n[New Thread 0xb14fdb40 (LWP 25015)]\r\n[New Thread 0xb0cfcb40 (LWP 25016)]\r\n[New Thread 0xb04fbb40 (LWP 25017)]\r\n[New Thread 0xafcfab40 (LWP 25018)]\r\n[New Thread 0xaf4f9b40 (LWP 25019)]\r\n[New Thread 0xaecf8b40 (LWP 25020)]\r\n[New Thread 0xae4f7b40 (LWP 25021)]\r\n[New Thread 0xadcf6b40 (LWP 25022)]\r\n\r\nProgram received signal SIGSEGV, Segmentation fault.\r\n[Switching to Thread 0xae4f7b40 (LWP 25021)]\r\nIncrementExtraNonce (pblock=0xb2501828, pindexPrev=0x0, nExtraNonce=@0xae4f6fc0: 1) at miner.cpp:338\r\n338\t    unsigned int nHeight = pindexPrev->nHeight+1; // Height first in coinbase required for block.version=2\r\n(gdb) bt\r\n#0  IncrementExtraNonce (pblock=0xb2501828, pindexPrev=0x0, nExtraNonce=@0xae4f6fc0: 1) at miner.cpp:338\r\n#1  0x80110240 in BitcoinMiner (pwallet=0x807c6a20) at miner.cpp:461\r\n#2  0x80111c73 in operator()<void (*)(CWallet*), boost::_bi::list0> (this=0x80e18360, f=<optimized out>, a=...)\r\n    at /root/harrywu/build/3rd/boost-1.53/include/boost/bind/bind.hpp:253\r\n#3  operator() (this=0x80e1835c) at /root/harrywu/build/3rd/boost-1.53/include/boost/bind/bind_template.hpp:20\r\n#4  boost::detail::thread_data<boost::_bi::bind_t<void, void (*)(CWallet*), boost::_bi::list1<boost::_bi::value<CWallet*> > > >::run (this=0x80e18240)\r\n    at /root/harrywu/build/3rd/boost-1.53/include/boost/thread/detail/thread.hpp:117\r\n#5  0x80324ebe in thread_proxy ()\r\n#6  0xb7cd3d9f in start_thread () from /lib/libpthread.so.0\r\n#7  0xb7dd4c8e in clone () from /lib/libc.so.6\r\n(gdb) \r\n\r\n\r\n\r\n2014-09-28 08:30:17 \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n2014-09-28 08:30:17 Bitcoin version v0.9.99.0-gae9966e (Sun, 21 Sep 2014 21:25:25 +0200)\r\n2014-09-28 08:30:17 Using OpenSSL version OpenSSL 1.0.1g 7 Apr 2014\r\n2014-09-28 08:30:17 Using BerkeleyDB version Berkeley DB 4.8.30: (April  9, 2010)\r\n2014-09-28 08:30:17 Default data directory /root/.bitcoin\r\n2014-09-28 08:30:17 Using data directory /root/harrywu/build/tmp/native/run/data\r\n2014-09-28 08:30:17 Using config file /root/harrywu/build/tmp/native/run/data/bitcoin.conf\r\n2014-09-28 08:30:17 Using at most 125 connections (1024 file descriptors available)\r\n2014-09-28 08:30:17 Using 4 threads for script verification\r\n2014-09-28 08:30:17 Using wallet wallet.dat\r\n2014-09-28 08:30:17 init message: Verifying wallet...\r\n2014-09-28 08:30:17 CDBEnv::Open : LogDir=/root/harrywu/build/tmp/native/run/data/database ErrorFile=/root/harrywu/build/tmp/native/run/data/db.log\r\n2014-09-28 08:30:17 Bound to [::]:7333\r\n2014-09-28 08:30:17 Bound to 0.0.0.0:7333\r\n2014-09-28 08:30:17 init message: Loading block index...\r\n2014-09-28 08:30:17 Wiping LevelDB in /root/harrywu/build/tmp/native/run/data/blocks/index\r\n2014-09-28 08:30:17 Opening LevelDB in /root/harrywu/build/tmp/native/run/data/blocks/index\r\n2014-09-28 08:30:17 Opened LevelDB successfully\r\n2014-09-28 08:30:17 Wiping LevelDB in /root/harrywu/build/tmp/native/run/data/chainstate\r\n2014-09-28 08:30:17 Opening LevelDB in /root/harrywu/build/tmp/native/run/data/chainstate\r\n2014-09-28 08:30:17 Opened LevelDB successfully\r\n2014-09-28 08:30:17 Initializing databases...\r\n2014-09-28 08:30:17 init message: Verifying blocks...\r\n2014-09-28 08:30:17  block index              10ms\r\n2014-09-28 08:30:17 init message: Loading wallet...\r\n2014-09-28 08:30:17 nFileVersion = 99900\r\n2014-09-28 08:30:17 Keys: 105 plaintext, 0 encrypted, 105 w/ metadata, 105 total\r\n2014-09-28 08:30:17  wallet                   90ms\r\n2014-09-28 08:30:17 init message: Loading addresses...\r\n2014-09-28 08:30:17 Reindexing block file blk00000.dat...\r\n2014-09-28 08:30:17 Loaded 1 addresses from peers.dat  0ms\r\n2014-09-28 08:30:17 mapBlockIndex.size() = 0\r\n2014-09-28 08:30:17 nBestHeight = -1\r\n2014-09-28 08:30:17 setKeyPool.size() = 102\r\n2014-09-28 08:30:17 mapWallet.size() = 2\r\n2014-09-28 08:30:17 mapAddressBook.size() = 1\r\n2014-09-28 08:30:17 Added connection peer=0\r\n2014-09-28 08:30:17 ext-ip thread start\r\n2014-09-28 08:30:17 dnsseed thread start\r\n2014-09-28 08:30:17 net thread start\r\n2014-09-28 08:30:17 addcon thread start\r\n2014-09-28 08:30:17 opencon thread start\r\n2014-09-28 08:30:17 trying connection 10.12.23.47:7333 lastseen=364414.7hrs\r\n2014-09-28 08:30:17 msghand thread start\r\n2014-09-28 08:30:17 dumpaddr thread start\r\n2014-09-28 08:30:17 Allowing RPC connections from: 127.0.0.0/255.0.0.0 ::1/ffff:ffff:ffff:ffff:ffff:ffff:ffff:ffff \r\n2014-09-28 08:30:17 Added connection peer=1\r\n2014-09-28 08:30:17 send version message: version 70002, blocks=-1, us=0.0.0.0:0, peer=1\r\n2014-09-28 08:30:17 Binding RPC on address ::1 port 8332 (IPv4+IPv6 bind any: 0)\r\n2014-09-28 08:30:17 sending: version (102 bytes) peer=1\r\n2014-09-28 08:30:17 Binding RPC on address 127.0.0.1 port 8332 (IPv4+IPv6 bind any: 0)\r\n2014-09-28 08:30:17   - Load block from disk: 0.00ms [0.00s]\r\n2014-09-28 08:30:17   - Connect total: 0.00ms [0.00s]\r\n2014-09-28 08:30:17 init message: Done loading\r\n2014-09-28 08:30:17 BitcoinMiner started\r\n2014-09-28 08:30:17   - Flush: 0.00ms [0.00s]\r\n2014-09-28 08:30:17 keypool reserve 4\r\n2014-09-28 08:30:17   - Writing chainstate: 0.00ms [0.00s]\r\n2014-09-28 08:30:17 UpdateTip: new best=0000000061b1aca334b059920fed7bace2336ea4d23d63428c7aee04da49e942  height=0  log2_work=32.000022  tx=1  date=2014-09-25 17:32:11 progress=0.000000\r\n2014-09-28 08:30:17   - Connect postprocess: 0.00ms [0.00s]\r\n2014-09-28 08:30:17 - Connect block: 0.00ms [0.00s]\r\n2014-09-28 08:30:17   - Load block from disk: 0.00ms [0.00s]\r\n2014-09-28 08:30:17       - Connect 1 transactions: 0.00ms (0.000ms/tx, 0.000ms/txin) [0.00s]\r\n2014-09-28 08:30:17     - Verify 0 txins: 0.00ms (0.000ms/txin) [0.00s]\r\n2014-09-28 08:30:17 Pre-allocating up to position 0x100000 in rev00000.dat\r\n2014-09-28 08:30:17     - Index writing: 0.00ms [0.00s]\r\n2014-09-28 08:30:17     - Callbacks: 0.00ms [0.00s]\r\n2014-09-28 08:30:17   - Connect total: 0.00ms [0.00s]\r\n2014-09-28 08:30:17   - Flush: 0.00ms [0.00s]\r\n2014-09-28 08:30:17   - Writing chainstate: 0.00ms [0.00s]\r\n2014-09-28 08:30:17 UpdateTip: new best=00000000923c935006272f11b781421bb9c40670aec27ed716eedb48b3790e38  height=1  log2_work=33.000022  tx=2  date=2014-09-26 02:34:14 progress=0.000000\r\n2014-09-28 08:30:17   - Connect postprocess: 0.00ms [0.00s]\r\n2014-09-28 08:30:17 - Connect block: 0.00ms [0.00s]\r\n2014-09-28 08:30:17 CreateNewBlock(): total size 1000\r\n2014-09-28 08:30:17       - Connect 1 transactions: 0.00ms (0.000ms/tx, 0.000ms/txin) [0.00s]\r\n2014-09-28 08:30:17     - Verify 0 txins: 0.00ms (0.000ms/txin) [0.00s]",
      "tree": {
        "sha": "089ff1c2a20d3533b4d0253a008a524bf4a219c0",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/089ff1c2a20d3533b4d0253a008a524bf4a219c0"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a369b3deccd24ac9eb3fb5dee90a859ee408134f",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a369b3deccd24ac9eb3fb5dee90a859ee408134f",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/a369b3deccd24ac9eb3fb5dee90a859ee408134f",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a369b3deccd24ac9eb3fb5dee90a859ee408134f/comments",
    "author": {
      "login": "imharrywu",
      "id": 7483782,
      "node_id": "MDQ6VXNlcjc0ODM3ODI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7483782?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/imharrywu",
      "html_url": "https://github.com/imharrywu",
      "followers_url": "https://api.github.com/users/imharrywu/followers",
      "following_url": "https://api.github.com/users/imharrywu/following{/other_user}",
      "gists_url": "https://api.github.com/users/imharrywu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/imharrywu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/imharrywu/subscriptions",
      "organizations_url": "https://api.github.com/users/imharrywu/orgs",
      "repos_url": "https://api.github.com/users/imharrywu/repos",
      "events_url": "https://api.github.com/users/imharrywu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/imharrywu/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "imharrywu",
      "id": 7483782,
      "node_id": "MDQ6VXNlcjc0ODM3ODI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7483782?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/imharrywu",
      "html_url": "https://github.com/imharrywu",
      "followers_url": "https://api.github.com/users/imharrywu/followers",
      "following_url": "https://api.github.com/users/imharrywu/following{/other_user}",
      "gists_url": "https://api.github.com/users/imharrywu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/imharrywu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/imharrywu/subscriptions",
      "organizations_url": "https://api.github.com/users/imharrywu/orgs",
      "repos_url": "https://api.github.com/users/imharrywu/repos",
      "events_url": "https://api.github.com/users/imharrywu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/imharrywu/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "a38eaea082692d0dac6996dcace2084cd7f29179",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a38eaea082692d0dac6996dcace2084cd7f29179",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/a38eaea082692d0dac6996dcace2084cd7f29179"
      }
    ],
    "stats": {
      "total": 4,
      "additions": 4,
      "deletions": 0
    },
    "files": [
      {
        "sha": "b644494b9884bb2081d789c82a800230fb2b46af",
        "filename": "src/miner.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 0,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a369b3deccd24ac9eb3fb5dee90a859ee408134f/src/miner.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a369b3deccd24ac9eb3fb5dee90a859ee408134f/src/miner.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/miner.cpp?ref=a369b3deccd24ac9eb3fb5dee90a859ee408134f",
        "patch": "@@ -450,6 +450,10 @@ void static BitcoinMiner(CWallet *pwallet)\n             //\n             unsigned int nTransactionsUpdatedLast = mempool.GetTransactionsUpdated();\n             CBlockIndex* pindexPrev = chainActive.Tip();\n+            if (NULL == pindexPrev) {\n+                MilliSleep(1000);\n+                continue ;\n+            }\n \n             auto_ptr<CBlockTemplate> pblocktemplate(CreateNewBlockWithKey(reservekey));\n             if (!pblocktemplate.get())"
      }
    ]
  },
  {
    "sha": "b4d1881ca4b939dd3cecb221fb4b3c65d8f23021",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiNGQxODgxY2E0YjkzOWRkM2NlY2IyMjFmYjRiM2M2NWQ4ZjIzMDIx",
    "commit": {
      "author": {
        "name": "imharrywu",
        "email": "imharrywu@users.noreply.github.com",
        "date": "2014-09-29T03:53:03Z"
      },
      "committer": {
        "name": "imharrywu",
        "email": "imharrywu@users.noreply.github.com",
        "date": "2014-09-29T03:53:03Z"
      },
      "message": "update pull request with consistent coding style",
      "tree": {
        "sha": "2739461b150f35ce8ff983368b2b5eb461a18b0e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2739461b150f35ce8ff983368b2b5eb461a18b0e"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b4d1881ca4b939dd3cecb221fb4b3c65d8f23021",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b4d1881ca4b939dd3cecb221fb4b3c65d8f23021",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/b4d1881ca4b939dd3cecb221fb4b3c65d8f23021",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b4d1881ca4b939dd3cecb221fb4b3c65d8f23021/comments",
    "author": {
      "login": "imharrywu",
      "id": 7483782,
      "node_id": "MDQ6VXNlcjc0ODM3ODI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7483782?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/imharrywu",
      "html_url": "https://github.com/imharrywu",
      "followers_url": "https://api.github.com/users/imharrywu/followers",
      "following_url": "https://api.github.com/users/imharrywu/following{/other_user}",
      "gists_url": "https://api.github.com/users/imharrywu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/imharrywu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/imharrywu/subscriptions",
      "organizations_url": "https://api.github.com/users/imharrywu/orgs",
      "repos_url": "https://api.github.com/users/imharrywu/repos",
      "events_url": "https://api.github.com/users/imharrywu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/imharrywu/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "imharrywu",
      "id": 7483782,
      "node_id": "MDQ6VXNlcjc0ODM3ODI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7483782?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/imharrywu",
      "html_url": "https://github.com/imharrywu",
      "followers_url": "https://api.github.com/users/imharrywu/followers",
      "following_url": "https://api.github.com/users/imharrywu/following{/other_user}",
      "gists_url": "https://api.github.com/users/imharrywu/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/imharrywu/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/imharrywu/subscriptions",
      "organizations_url": "https://api.github.com/users/imharrywu/orgs",
      "repos_url": "https://api.github.com/users/imharrywu/repos",
      "events_url": "https://api.github.com/users/imharrywu/events{/privacy}",
      "received_events_url": "https://api.github.com/users/imharrywu/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "a369b3deccd24ac9eb3fb5dee90a859ee408134f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a369b3deccd24ac9eb3fb5dee90a859ee408134f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/a369b3deccd24ac9eb3fb5dee90a859ee408134f"
      }
    ],
    "stats": {
      "total": 4,
      "additions": 2,
      "deletions": 2
    },
    "files": [
      {
        "sha": "f370b33166c30d483691fac4e275bf49123086f8",
        "filename": "src/miner.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b4d1881ca4b939dd3cecb221fb4b3c65d8f23021/src/miner.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b4d1881ca4b939dd3cecb221fb4b3c65d8f23021/src/miner.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/miner.cpp?ref=b4d1881ca4b939dd3cecb221fb4b3c65d8f23021",
        "patch": "@@ -450,9 +450,9 @@ void static BitcoinMiner(CWallet *pwallet)\n             //\n             unsigned int nTransactionsUpdatedLast = mempool.GetTransactionsUpdated();\n             CBlockIndex* pindexPrev = chainActive.Tip();\n-            if (NULL == pindexPrev) {\n+            if (!pindexPrev) {\n                 MilliSleep(1000);\n-                continue ;\n+                continue;\n             }\n \n             auto_ptr<CBlockTemplate> pblocktemplate(CreateNewBlockWithKey(reservekey));"
      }
    ]
  }
]