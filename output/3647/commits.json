[
  {
    "sha": "d8136022c23aa6fe38a672109ee4eac83ee707de",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkODEzNjAyMmMyM2FhNmZlMzhhNjcyMTA5ZWU0ZWFjODNlZTcwN2Rl",
    "commit": {
      "author": {
        "name": "Cozz Lovan",
        "email": "cozzlovan@yahoo.com",
        "date": "2014-02-07T02:56:29Z"
      },
      "committer": {
        "name": "Cozz Lovan",
        "email": "cozzlovan@yahoo.com",
        "date": "2014-02-22T16:29:10Z"
      },
      "message": "[Qt] show fee warnings in optionsdialog",
      "tree": {
        "sha": "5161d3ac786cbfe1771aed32dbb5e7a0847a44c7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/5161d3ac786cbfe1771aed32dbb5e7a0847a44c7"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/d8136022c23aa6fe38a672109ee4eac83ee707de",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d8136022c23aa6fe38a672109ee4eac83ee707de",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/d8136022c23aa6fe38a672109ee4eac83ee707de",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/d8136022c23aa6fe38a672109ee4eac83ee707de/comments",
    "author": {
      "login": "cozz",
      "id": 2814559,
      "node_id": "MDQ6VXNlcjI4MTQ1NTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2814559?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cozz",
      "html_url": "https://github.com/cozz",
      "followers_url": "https://api.github.com/users/cozz/followers",
      "following_url": "https://api.github.com/users/cozz/following{/other_user}",
      "gists_url": "https://api.github.com/users/cozz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cozz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cozz/subscriptions",
      "organizations_url": "https://api.github.com/users/cozz/orgs",
      "repos_url": "https://api.github.com/users/cozz/repos",
      "events_url": "https://api.github.com/users/cozz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cozz/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "cozz",
      "id": 2814559,
      "node_id": "MDQ6VXNlcjI4MTQ1NTk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2814559?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/cozz",
      "html_url": "https://github.com/cozz",
      "followers_url": "https://api.github.com/users/cozz/followers",
      "following_url": "https://api.github.com/users/cozz/following{/other_user}",
      "gists_url": "https://api.github.com/users/cozz/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/cozz/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/cozz/subscriptions",
      "organizations_url": "https://api.github.com/users/cozz/orgs",
      "repos_url": "https://api.github.com/users/cozz/repos",
      "events_url": "https://api.github.com/users/cozz/events{/privacy}",
      "received_events_url": "https://api.github.com/users/cozz/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "39fae6cfddb78d2aefa81a48472f885253cc42f1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/39fae6cfddb78d2aefa81a48472f885253cc42f1",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/39fae6cfddb78d2aefa81a48472f885253cc42f1"
      }
    ],
    "stats": {
      "total": 387,
      "additions": 252,
      "deletions": 135
    },
    "files": [
      {
        "sha": "93182af5844cccc20153264c3d84e9a89fcc0403",
        "filename": "src/qt/forms/optionsdialog.ui",
        "status": "modified",
        "additions": 218,
        "deletions": 135,
        "changes": 353,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d8136022c23aa6fe38a672109ee4eac83ee707de/src/qt/forms/optionsdialog.ui",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d8136022c23aa6fe38a672109ee4eac83ee707de/src/qt/forms/optionsdialog.ui",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/forms/optionsdialog.ui?ref=d8136022c23aa6fe38a672109ee4eac83ee707de",
        "patch": "@@ -7,7 +7,7 @@\n     <x>0</x>\n     <y>0</y>\n     <width>560</width>\n-    <height>400</height>\n+    <height>420</height>\n    </rect>\n   </property>\n   <property name=\"windowTitle\">\n@@ -28,101 +28,123 @@\n       </attribute>\n       <layout class=\"QVBoxLayout\" name=\"verticalLayout_Main\">\n        <item>\n-        <widget class=\"QCheckBox\" name=\"bitcoinAtStartup\">\n-         <property name=\"toolTip\">\n-          <string>Automatically start Bitcoin after logging in to the system.</string>\n+        <widget class=\"QFrame\" name=\"frame_2\">\n+         <property name=\"frameShape\">\n+          <enum>QFrame::NoFrame</enum>\n          </property>\n-         <property name=\"text\">\n-          <string>&amp;Start Bitcoin on system login</string>\n+         <property name=\"frameShadow\">\n+          <enum>QFrame::Sunken</enum>\n+         </property>\n+         <property name=\"lineWidth\">\n+          <number>1</number>\n+         </property>\n+         <property name=\"midLineWidth\">\n+          <number>0</number>\n          </property>\n+         <layout class=\"QVBoxLayout\" name=\"verticalLayout_4\">\n+          <property name=\"leftMargin\">\n+           <number>0</number>\n+          </property>\n+          <property name=\"topMargin\">\n+           <number>0</number>\n+          </property>\n+          <property name=\"rightMargin\">\n+           <number>0</number>\n+          </property>\n+          <property name=\"bottomMargin\">\n+           <number>0</number>\n+          </property>\n+          <item>\n+           <layout class=\"QFormLayout\" name=\"formLayout\">\n+            <property name=\"fieldGrowthPolicy\">\n+             <enum>QFormLayout::ExpandingFieldsGrow</enum>\n+            </property>\n+            <property name=\"labelAlignment\">\n+             <set>Qt::AlignLeading|Qt::AlignLeft|Qt::AlignVCenter</set>\n+            </property>\n+            <property name=\"horizontalSpacing\">\n+             <number>20</number>\n+            </property>\n+            <property name=\"leftMargin\">\n+             <number>0</number>\n+            </property>\n+            <property name=\"rightMargin\">\n+             <number>0</number>\n+            </property>\n+            <item row=\"0\" column=\"0\">\n+             <widget class=\"QCheckBox\" name=\"bitcoinAtStartup\">\n+              <property name=\"toolTip\">\n+               <string>Automatically start Bitcoin after logging in to the system.</string>\n+              </property>\n+              <property name=\"text\">\n+               <string>&amp;Start Bitcoin on system login</string>\n+              </property>\n+             </widget>\n+            </item>\n+            <item row=\"1\" column=\"0\">\n+             <widget class=\"QLabel\" name=\"databaseCacheLabel\">\n+              <property name=\"text\">\n+               <string>Size of &amp;database cache</string>\n+              </property>\n+              <property name=\"textFormat\">\n+               <enum>Qt::PlainText</enum>\n+              </property>\n+              <property name=\"buddy\">\n+               <cstring>databaseCache</cstring>\n+              </property>\n+             </widget>\n+            </item>\n+            <item row=\"1\" column=\"1\">\n+             <layout class=\"QHBoxLayout\" name=\"horizontalLayout_2_Main\">\n+              <property name=\"spacing\">\n+               <number>5</number>\n+              </property>\n+              <item>\n+               <widget class=\"QSpinBox\" name=\"databaseCache\"/>\n+              </item>\n+              <item>\n+               <widget class=\"QLabel\" name=\"databaseCacheUnitLabel\">\n+                <property name=\"text\">\n+                 <string>MB</string>\n+                </property>\n+                <property name=\"textFormat\">\n+                 <enum>Qt::PlainText</enum>\n+                </property>\n+               </widget>\n+              </item>\n+             </layout>\n+            </item>\n+            <item row=\"2\" column=\"0\">\n+             <widget class=\"QLabel\" name=\"threadsScriptVerifLabel\">\n+              <property name=\"text\">\n+               <string>Number of script &amp;verification threads</string>\n+              </property>\n+              <property name=\"textFormat\">\n+               <enum>Qt::PlainText</enum>\n+              </property>\n+              <property name=\"buddy\">\n+               <cstring>threadsScriptVerif</cstring>\n+              </property>\n+             </widget>\n+            </item>\n+            <item row=\"2\" column=\"1\">\n+             <widget class=\"QSpinBox\" name=\"threadsScriptVerif\">\n+              <property name=\"toolTip\">\n+               <string>Set the number of script verification threads (up to 16, 0 = auto, &lt;0 = leave that many cores free, default: 0)</string>\n+              </property>\n+              <property name=\"minimum\">\n+               <number>-16</number>\n+              </property>\n+              <property name=\"maximum\">\n+               <number>16</number>\n+              </property>\n+             </widget>\n+            </item>\n+           </layout>\n+          </item>\n+         </layout>\n         </widget>\n        </item>\n-       <item>\n-        <layout class=\"QHBoxLayout\" name=\"horizontalLayout_2_Main\">\n-         <item>\n-          <widget class=\"QLabel\" name=\"databaseCacheLabel\">\n-           <property name=\"text\">\n-            <string>Size of &amp;database cache</string>\n-           </property>\n-           <property name=\"textFormat\">\n-            <enum>Qt::PlainText</enum>\n-           </property>\n-           <property name=\"buddy\">\n-            <cstring>databaseCache</cstring>\n-           </property>\n-          </widget>\n-         </item>\n-         <item>\n-          <widget class=\"QSpinBox\" name=\"databaseCache\"/>\n-         </item>\n-         <item>\n-          <widget class=\"QLabel\" name=\"databaseCacheUnitLabel\">\n-           <property name=\"text\">\n-            <string>MB</string>\n-           </property>\n-           <property name=\"textFormat\">\n-            <enum>Qt::PlainText</enum>\n-           </property>\n-          </widget>\n-         </item>\n-         <item>\n-          <spacer name=\"horizontalSpacer_2_Main\">\n-           <property name=\"orientation\">\n-            <enum>Qt::Horizontal</enum>\n-           </property>\n-           <property name=\"sizeHint\" stdset=\"0\">\n-            <size>\n-             <width>40</width>\n-             <height>20</height>\n-            </size>\n-           </property>\n-          </spacer>\n-         </item>\n-        </layout>\n-       </item>\n-       <item>\n-        <layout class=\"QHBoxLayout\" name=\"horizontalLayout_3_Main\">\n-         <item>\n-          <widget class=\"QLabel\" name=\"threadsScriptVerifLabel\">\n-           <property name=\"text\">\n-            <string>Number of script &amp;verification threads</string>\n-           </property>\n-           <property name=\"textFormat\">\n-            <enum>Qt::PlainText</enum>\n-           </property>\n-           <property name=\"buddy\">\n-            <cstring>threadsScriptVerif</cstring>\n-           </property>\n-          </widget>\n-         </item>\n-         <item>\n-          <widget class=\"QSpinBox\" name=\"threadsScriptVerif\">\n-           <property name=\"toolTip\">\n-            <string>Set the number of script verification threads (up to 16, 0 = auto, &lt;0 = leave that many cores free, default: 0)</string>\n-           </property>\n-           <property name=\"minimum\">\n-            <number>-16</number>\n-           </property>\n-           <property name=\"maximum\">\n-            <number>16</number>\n-           </property>\n-          </widget>\n-         </item>\n-         <item>\n-          <spacer name=\"horizontalSpacer_3_Main\">\n-           <property name=\"orientation\">\n-            <enum>Qt::Horizontal</enum>\n-           </property>\n-           <property name=\"sizeHint\" stdset=\"0\">\n-            <size>\n-             <width>40</width>\n-             <height>20</height>\n-            </size>\n-           </property>\n-          </spacer>\n-         </item>\n-        </layout>\n-       </item>\n        <item>\n         <spacer name=\"verticalSpacer_Main\">\n          <property name=\"orientation\">\n@@ -131,7 +153,7 @@\n          <property name=\"sizeHint\" stdset=\"0\">\n           <size>\n            <width>20</width>\n-           <height>40</height>\n+           <height>5</height>\n           </size>\n          </property>\n         </spacer>\n@@ -144,51 +166,106 @@\n       </attribute>\n       <layout class=\"QVBoxLayout\" name=\"verticalLayout_Wallet\">\n        <item>\n-        <widget class=\"QLabel\" name=\"transactionFeeInfoLabel\">\n-         <property name=\"text\">\n-          <string>Optional transaction fee per kB that helps make sure your transactions are processed quickly. Most transactions are 1 kB.</string>\n-         </property>\n-         <property name=\"textFormat\">\n-          <enum>Qt::PlainText</enum>\n-         </property>\n-         <property name=\"wordWrap\">\n-          <bool>true</bool>\n+        <widget class=\"QGroupBox\" name=\"groupBoxFee\">\n+         <property name=\"title\">\n+          <string>Fee</string>\n          </property>\n+         <layout class=\"QVBoxLayout\" name=\"verticalLayout_2\">\n+          <item>\n+           <widget class=\"QLabel\" name=\"transactionFeeInfoLabel\">\n+            <property name=\"text\">\n+             <string>Transaction fee per kB that is paid to bitcoin miners for confirming your transactions. Most transactions are 1 kB.</string>\n+            </property>\n+            <property name=\"textFormat\">\n+             <enum>Qt::PlainText</enum>\n+            </property>\n+            <property name=\"wordWrap\">\n+             <bool>true</bool>\n+            </property>\n+           </widget>\n+          </item>\n+          <item>\n+           <widget class=\"QLabel\" name=\"labelCurrentDefaultFee\">\n+            <property name=\"text\">\n+             <string/>\n+            </property>\n+            <property name=\"wordWrap\">\n+             <bool>true</bool>\n+            </property>\n+            <property name=\"textInteractionFlags\">\n+             <set>Qt::LinksAccessibleByMouse|Qt::TextSelectableByKeyboard|Qt::TextSelectableByMouse</set>\n+            </property>\n+           </widget>\n+          </item>\n+          <item>\n+           <layout class=\"QHBoxLayout\" name=\"horizontalLayout_1_Wallet\">\n+            <item>\n+             <widget class=\"QLabel\" name=\"transactionFeeLabel\">\n+              <property name=\"text\">\n+               <string>Pay transaction &amp;fee</string>\n+              </property>\n+              <property name=\"textFormat\">\n+               <enum>Qt::PlainText</enum>\n+              </property>\n+              <property name=\"buddy\">\n+               <cstring>transactionFee</cstring>\n+              </property>\n+             </widget>\n+            </item>\n+            <item>\n+             <widget class=\"BitcoinAmountField\" name=\"transactionFee\"/>\n+            </item>\n+            <item>\n+             <spacer name=\"horizontalSpacer_1_Wallet\">\n+              <property name=\"orientation\">\n+               <enum>Qt::Horizontal</enum>\n+              </property>\n+              <property name=\"sizeHint\" stdset=\"0\">\n+               <size>\n+                <width>40</width>\n+                <height>20</height>\n+               </size>\n+              </property>\n+             </spacer>\n+            </item>\n+           </layout>\n+          </item>\n+          <item>\n+           <layout class=\"QHBoxLayout\" name=\"horizontalLayout_4_Main\">\n+            <item>\n+             <widget class=\"QLabel\" name=\"labelFeeWarningHead\">\n+              <property name=\"sizePolicy\">\n+               <sizepolicy hsizetype=\"Maximum\" vsizetype=\"Preferred\">\n+                <horstretch>0</horstretch>\n+                <verstretch>0</verstretch>\n+               </sizepolicy>\n+              </property>\n+              <property name=\"styleSheet\">\n+               <string notr=\"true\">color:red;</string>\n+              </property>\n+              <property name=\"text\">\n+               <string>Warning:</string>\n+              </property>\n+              <property name=\"alignment\">\n+               <set>Qt::AlignLeading|Qt::AlignLeft|Qt::AlignTop</set>\n+              </property>\n+             </widget>\n+            </item>\n+            <item>\n+             <widget class=\"QLabel\" name=\"labelFeeWarning\">\n+              <property name=\"text\">\n+               <string>You currently pay zero transaction fee. This may result in very long confirmation times.</string>\n+              </property>\n+              <property name=\"wordWrap\">\n+               <bool>true</bool>\n+              </property>\n+             </widget>\n+            </item>\n+           </layout>\n+          </item>\n+         </layout>\n         </widget>\n        </item>\n-       <item>\n-        <layout class=\"QHBoxLayout\" name=\"horizontalLayout_1_Wallet\">\n-         <item>\n-          <widget class=\"QLabel\" name=\"transactionFeeLabel\">\n-           <property name=\"text\">\n-            <string>Pay transaction &amp;fee</string>\n-           </property>\n-           <property name=\"textFormat\">\n-            <enum>Qt::PlainText</enum>\n-           </property>\n-           <property name=\"buddy\">\n-            <cstring>transactionFee</cstring>\n-           </property>\n-          </widget>\n-         </item>\n-         <item>\n-          <widget class=\"BitcoinAmountField\" name=\"transactionFee\"/>\n-         </item>\n-         <item>\n-          <spacer name=\"horizontalSpacer_1_Wallet\">\n-           <property name=\"orientation\">\n-            <enum>Qt::Horizontal</enum>\n-           </property>\n-           <property name=\"sizeHint\" stdset=\"0\">\n-            <size>\n-             <width>40</width>\n-             <height>20</height>\n-            </size>\n-           </property>\n-          </spacer>\n-         </item>\n-        </layout>\n-       </item>\n        <item>\n         <widget class=\"QLabel\" name=\"spendZeroConfChangeInfoLabel\">\n          <property name=\"text\">\n@@ -498,6 +575,12 @@\n    <item>\n     <widget class=\"QFrame\" name=\"frame\">\n      <layout class=\"QVBoxLayout\" name=\"verticalLayout_Bottom\">\n+      <property name=\"topMargin\">\n+       <number>0</number>\n+      </property>\n+      <property name=\"bottomMargin\">\n+       <number>0</number>\n+      </property>\n       <item>\n        <layout class=\"QHBoxLayout\" name=\"horizontalLayout_Bottom\">\n         <item>"
      },
      {
        "sha": "d80697064f0fe93ac16d79e73c8290485c37704c",
        "filename": "src/qt/optionsdialog.cpp",
        "status": "modified",
        "additions": 32,
        "deletions": 0,
        "changes": 32,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d8136022c23aa6fe38a672109ee4eac83ee707de/src/qt/optionsdialog.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d8136022c23aa6fe38a672109ee4eac83ee707de/src/qt/optionsdialog.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/optionsdialog.cpp?ref=d8136022c23aa6fe38a672109ee4eac83ee707de",
        "patch": "@@ -138,11 +138,15 @@ void OptionsDialog::setModel(OptionsModel *model)\n     /* update the display unit, to not use the default (\"BTC\") */\n     updateDisplayUnit();\n \n+    /* show warning if fee is too low or too high */\n+    updateFeeWarning();\n+\n     /* warn when one of the following settings changes by user action (placed here so init via mapper doesn't trigger them) */\n \n     /* Main */\n     connect(ui->databaseCache, SIGNAL(valueChanged(int)), this, SLOT(showRestartWarning()));\n     connect(ui->threadsScriptVerif, SIGNAL(valueChanged(int)), this, SLOT(showRestartWarning()));\n+    connect(ui->transactionFee, SIGNAL(textChanged()), this, SLOT(updateFeeWarning()));\n     /* Network */\n     connect(ui->connectSocks, SIGNAL(clicked(bool)), this, SLOT(showRestartWarning()));\n     /* Display */\n@@ -255,6 +259,8 @@ void OptionsDialog::updateDisplayUnit()\n     {\n         /* Update transactionFee with the current unit */\n         ui->transactionFee->setDisplayUnit(model->getDisplayUnit());\n+\n+        updateCurrentDefaultFee();\n     }\n }\n \n@@ -291,3 +297,29 @@ bool OptionsDialog::eventFilter(QObject *object, QEvent *event)\n     }\n     return QDialog::eventFilter(object, event);\n }\n+\n+void OptionsDialog::updateCurrentDefaultFee()\n+{\n+    if(model)\n+        ui->labelCurrentDefaultFee->setText(tr(\"The recommended default fee per kB is currently <b>%1</b>.\").arg(BitcoinUnits::formatWithUnit(model->getDisplayUnit(), CTransaction::nMinTxFee)));\n+}\n+\n+void OptionsDialog::updateFeeWarning()\n+{\n+    bool fShowWarning = true;\n+    int64_t nFee = (int64_t)ui->transactionFee->value();\n+\n+    if (mapArgs.count(\"-mintxfee\")) // dont show warning if the user has messed with nMinTxFee\n+        fShowWarning = false;\n+    else if (nFee == 0)\n+        ui->labelFeeWarning->setText(tr(\"You currently pay zero transaction fee. This may result in very long confirmation times.\"));\n+    else if (nFee < CTransaction::nMinTxFee)\n+        ui->labelFeeWarning->setText(tr(\"Fees below the recommended default fee are considered zero fee by bitcoin miners. This may result in very long confirmation times.\"));\n+    else if (nFee >= CTransaction::nMinTxFee * 5)\n+        ui->labelFeeWarning->setText(tr(\"Your fee is much higher than the recommended default fee. Please double-check your setting.\"));\n+    else\n+        fShowWarning = false;\n+\n+    ui->labelFeeWarningHead->setVisible(fShowWarning);\n+    ui->labelFeeWarning->setVisible(fShowWarning);\n+}"
      },
      {
        "sha": "30e90c89c27de6d6fa6e9471b32fde98430aa059",
        "filename": "src/qt/optionsdialog.h",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/d8136022c23aa6fe38a672109ee4eac83ee707de/src/qt/optionsdialog.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/d8136022c23aa6fe38a672109ee4eac83ee707de/src/qt/optionsdialog.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/optionsdialog.h?ref=d8136022c23aa6fe38a672109ee4eac83ee707de",
        "patch": "@@ -45,6 +45,7 @@ private slots:\n     void clearStatusLabel();\n     void updateDisplayUnit();\n     void doProxyIpChecks(QValidatedLineEdit *pUiProxyIp, int nProxyPort);\n+    void updateFeeWarning();\n \n signals:\n     void proxyIpChecks(QValidatedLineEdit *pUiProxyIp, int nProxyPort);\n@@ -54,6 +55,7 @@ private slots:\n     OptionsModel *model;\n     MonitoredDataMapper *mapper;\n     bool fProxyIpValid;\n+    void updateCurrentDefaultFee();\n };\n \n #endif // OPTIONSDIALOG_H"
      }
    ]
  }
]