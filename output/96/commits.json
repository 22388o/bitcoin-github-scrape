[
  {
    "sha": "dda48ccd0f7c7dd13486a580880390a43382d340",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkZGE0OGNjZDBmN2M3ZGQxMzQ4NmE1ODA4ODAzOTBhNDMzODJkMzQw",
    "commit": {
      "author": {
        "name": "tcatm",
        "email": "tcatm@gawab.com",
        "date": "2011-03-03T21:26:00Z"
      },
      "committer": {
        "name": "tcatm",
        "email": "tcatm@gawab.com",
        "date": "2011-03-03T21:26:00Z"
      },
      "message": "fix -daemon switch",
      "tree": {
        "sha": "cb4360682f05a1fdce7201640c885a3693d02689",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/cb4360682f05a1fdce7201640c885a3693d02689"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dda48ccd0f7c7dd13486a580880390a43382d340",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dda48ccd0f7c7dd13486a580880390a43382d340",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/dda48ccd0f7c7dd13486a580880390a43382d340",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dda48ccd0f7c7dd13486a580880390a43382d340/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "411493b1f70d1493b1203bce847baa9f41e79f91",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/411493b1f70d1493b1203bce847baa9f41e79f91",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/411493b1f70d1493b1203bce847baa9f41e79f91"
      }
    ],
    "stats": {
      "total": 66,
      "additions": 39,
      "deletions": 27
    },
    "files": [
      {
        "sha": "a9b7a7d2f96437d81ff4b2394c0bbd9e646b3557",
        "filename": "init.cpp",
        "status": "modified",
        "additions": 37,
        "deletions": 27,
        "changes": 64,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/dda48ccd0f7c7dd13486a580880390a43382d340/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/dda48ccd0f7c7dd13486a580880390a43382d340/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/init.cpp?ref=dda48ccd0f7c7dd13486a580880390a43382d340",
        "patch": "@@ -74,32 +74,11 @@ void HandleSIGTERM(int)\n #ifndef GUI\n int main(int argc, char* argv[])\n {\n-    for (int i = 1; i < argc; i++)\n-        if (!IsSwitchChar(argv[i][0]))\n-            fCommandLine = true;\n-    fDaemon = !fCommandLine;\n-\n-#ifdef __WXGTK__\n-    if (!fCommandLine)\n-    {\n-        // Daemonize\n-        pid_t pid = fork();\n-        if (pid < 0)\n-        {\n-            fprintf(stderr, \"Error: fork() returned %d errno %d\\n\", pid, errno);\n-            return 1;\n-        }\n-        if (pid > 0)\n-            pthread_exit((void*)0);\n-    }\n-#endif\n-\n-    if (!AppInit(argc, argv))\n-        return 1;\n+    bool fRet = false;\n+    fRet = AppInit(argc, argv);\n \n-    while (!fShutdown)\n-        Sleep(1000000);\n-    return 0;\n+    if (fRet && fDaemon)\n+        pthread_exit((void*)0);\n }\n #endif\n \n@@ -113,7 +92,7 @@ bool AppInit(int argc, char* argv[])\n     catch (std::exception& e) {\n         PrintException(&e, \"AppInit()\");\n     } catch (...) {\n-        PrintException(NULL, \"AppInit()\");\n+\t    PrintException(NULL, \"AppInit()\");\n     }\n     if (!fRet)\n         Shutdown(NULL);\n@@ -213,19 +192,50 @@ bool AppInit2(int argc, char* argv[])\n \n     fDebug = GetBoolArg(\"-debug\");\n \n+    fDaemon = GetBoolArg(\"-daemon\");\n+\n+    if (fDaemon)\n+        fServer = true;\n+    else\n+        fServer = GetBoolArg(\"-server\");\n+\n+    /* force fServer when running without GUI */\n+#ifndef GUI\n+    fServer = true;\n+#endif\n+\n     fPrintToConsole = GetBoolArg(\"-printtoconsole\");\n     fPrintToDebugger = GetBoolArg(\"-printtodebugger\");\n \n     fTestNet = GetBoolArg(\"-testnet\");\n     \n     fNoListen = GetBoolArg(\"-nolisten\");\n \n+    for (int i = 1; i < argc; i++)\n+        if (!IsSwitchChar(argv[i][0]))\n+            fCommandLine = true;\n+\n     if (fCommandLine)\n     {\n         int ret = CommandLineRPC(argc, argv);\n         exit(ret);\n     }\n \n+#ifndef GUI\n+    if (fDaemon)\n+    {\n+        // Daemonize\n+        pid_t pid = fork();\n+        if (pid < 0)\n+        {\n+            fprintf(stderr, \"Error: fork() returned %d errno %d\\n\", pid, errno);\n+            return false;\n+        }\n+        if (pid > 0)\n+            return true;\n+    }\n+#endif\n+\n     if (!fDebug && !pszSetDataDir[0])\n         ShrinkDebugFile();\n     printf(\"\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\");\n@@ -443,7 +453,7 @@ bool AppInit2(int argc, char* argv[])\n     if (!CreateThread(StartNode, NULL))\n         wxMessageBox(\"Error: CreateThread(StartNode) failed\", \"Bitcoin\");\n \n-    if (GetBoolArg(\"-server\") || fDaemon)\n+    if (fServer)\n         CreateThread(ThreadRPCServer, NULL);\n \n #if defined(__WXMSW__) && defined(GUI)"
      },
      {
        "sha": "124174bd9da84184602d603836892d7e2e402b18",
        "filename": "util.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/dda48ccd0f7c7dd13486a580880390a43382d340/util.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/dda48ccd0f7c7dd13486a580880390a43382d340/util.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/util.cpp?ref=dda48ccd0f7c7dd13486a580880390a43382d340",
        "patch": "@@ -14,6 +14,7 @@ char pszSetDataDir[MAX_PATH] = \"\";\n bool fRequestShutdown = false;\n bool fShutdown = false;\n bool fDaemon = false;\n+bool fServer = false;\n bool fCommandLine = false;\n string strMiscWarning;\n bool fTestNet = false;"
      },
      {
        "sha": "1b780d552087591fa00595c54b9d093184309785",
        "filename": "util.h",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/dda48ccd0f7c7dd13486a580880390a43382d340/util.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/dda48ccd0f7c7dd13486a580880390a43382d340/util.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/util.h?ref=dda48ccd0f7c7dd13486a580880390a43382d340",
        "patch": "@@ -143,6 +143,7 @@ extern char pszSetDataDir[MAX_PATH];\n extern bool fRequestShutdown;\n extern bool fShutdown;\n extern bool fDaemon;\n+extern bool fServer;\n extern bool fCommandLine;\n extern string strMiscWarning;\n extern bool fTestNet;"
      }
    ]
  },
  {
    "sha": "a79409afa9c552eb5117d3474ba8dde1a649ce08",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphNzk0MDlhZmE5YzU1MmViNTExN2QzNDc0YmE4ZGRlMWE2NDljZTA4",
    "commit": {
      "author": {
        "name": "tcatm",
        "email": "tcatm@gawab.com",
        "date": "2011-03-03T21:27:20Z"
      },
      "committer": {
        "name": "tcatm",
        "email": "tcatm@gawab.com",
        "date": "2011-03-03T21:27:20Z"
      },
      "message": "fix whitespace",
      "tree": {
        "sha": "eb24fc9320c3745ca709dc35e1a3e22e0fe06e2e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/eb24fc9320c3745ca709dc35e1a3e22e0fe06e2e"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a79409afa9c552eb5117d3474ba8dde1a649ce08",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a79409afa9c552eb5117d3474ba8dde1a649ce08",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/a79409afa9c552eb5117d3474ba8dde1a649ce08",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a79409afa9c552eb5117d3474ba8dde1a649ce08/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "dda48ccd0f7c7dd13486a580880390a43382d340",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dda48ccd0f7c7dd13486a580880390a43382d340",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/dda48ccd0f7c7dd13486a580880390a43382d340"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 1,
      "deletions": 1
    },
    "files": [
      {
        "sha": "0548accb058d6bd00de160eb0246be2c9626bc70",
        "filename": "init.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a79409afa9c552eb5117d3474ba8dde1a649ce08/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a79409afa9c552eb5117d3474ba8dde1a649ce08/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/init.cpp?ref=a79409afa9c552eb5117d3474ba8dde1a649ce08",
        "patch": "@@ -92,7 +92,7 @@ bool AppInit(int argc, char* argv[])\n     catch (std::exception& e) {\n         PrintException(&e, \"AppInit()\");\n     } catch (...) {\n-\t    PrintException(NULL, \"AppInit()\");\n+        PrintException(NULL, \"AppInit()\");\n     }\n     if (!fRet)\n         Shutdown(NULL);"
      }
    ]
  },
  {
    "sha": "ea7cd317516a6ec911e6a29bc0407a42a2534251",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplYTdjZDMxNzUxNmE2ZWM5MTFlNmEyOWJjMDQwN2E0MmEyNTM0MjUx",
    "commit": {
      "author": {
        "name": "tcatm",
        "email": "tcatm@gawab.com",
        "date": "2011-03-03T21:31:44Z"
      },
      "committer": {
        "name": "tcatm",
        "email": "tcatm@gawab.com",
        "date": "2011-03-03T21:31:44Z"
      },
      "message": "force fDaemon in bitcoind",
      "tree": {
        "sha": "44e91984912caca2dd7cf4b02c7cc318e25a5de5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/44e91984912caca2dd7cf4b02c7cc318e25a5de5"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ea7cd317516a6ec911e6a29bc0407a42a2534251",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ea7cd317516a6ec911e6a29bc0407a42a2534251",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/ea7cd317516a6ec911e6a29bc0407a42a2534251",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ea7cd317516a6ec911e6a29bc0407a42a2534251/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "a79409afa9c552eb5117d3474ba8dde1a649ce08",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a79409afa9c552eb5117d3474ba8dde1a649ce08",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/a79409afa9c552eb5117d3474ba8dde1a649ce08"
      }
    ],
    "stats": {
      "total": 3,
      "additions": 2,
      "deletions": 1
    },
    "files": [
      {
        "sha": "f3ec28ba3d9ebdbaa8c4f6f25bfb8f16295fe7d0",
        "filename": "init.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 1,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ea7cd317516a6ec911e6a29bc0407a42a2534251/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ea7cd317516a6ec911e6a29bc0407a42a2534251/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/init.cpp?ref=ea7cd317516a6ec911e6a29bc0407a42a2534251",
        "patch": "@@ -199,9 +199,10 @@ bool AppInit2(int argc, char* argv[])\n     else\n         fServer = GetBoolArg(\"-server\");\n \n-    /* force fServer when running without GUI */\n+    /* force fServer and fDaemon when running without GUI */\n #ifndef GUI\n     fServer = true;\n+    fDaemon = true;\n #endif\n \n     fPrintToConsole = GetBoolArg(\"-printtoconsole\");"
      }
    ]
  },
  {
    "sha": "e1205e4d15403fdbb9b8d081aa7a9c3190529262",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplMTIwNWU0ZDE1NDAzZmRiYjliOGQwODFhYTdhOWMzMTkwNTI5MjYy",
    "commit": {
      "author": {
        "name": "tcatm",
        "email": "tcatm@gawab.com",
        "date": "2011-03-03T21:34:13Z"
      },
      "committer": {
        "name": "tcatm",
        "email": "tcatm@gawab.com",
        "date": "2011-03-03T21:34:13Z"
      },
      "message": "-help: do not show -server and -daemon in bitcoind",
      "tree": {
        "sha": "d5cb78a86ca6b47d787ccb7c0a19a7514d22beed",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d5cb78a86ca6b47d787ccb7c0a19a7514d22beed"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e1205e4d15403fdbb9b8d081aa7a9c3190529262",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e1205e4d15403fdbb9b8d081aa7a9c3190529262",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/e1205e4d15403fdbb9b8d081aa7a9c3190529262",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e1205e4d15403fdbb9b8d081aa7a9c3190529262/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "ea7cd317516a6ec911e6a29bc0407a42a2534251",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ea7cd317516a6ec911e6a29bc0407a42a2534251",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/ea7cd317516a6ec911e6a29bc0407a42a2534251"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 2,
      "deletions": 0
    },
    "files": [
      {
        "sha": "ac2721db63fcd1df1cb57c9e07916a271902e4da",
        "filename": "init.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e1205e4d15403fdbb9b8d081aa7a9c3190529262/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e1205e4d15403fdbb9b8d081aa7a9c3190529262/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/init.cpp?ref=e1205e4d15403fdbb9b8d081aa7a9c3190529262",
        "patch": "@@ -156,8 +156,10 @@ bool AppInit2(int argc, char* argv[])\n             \"  -connect=<ip>    \\t\\t  \" + _(\"Connect only to the specified node\\n\") +\n             \"  -nolisten        \\t  \"   + _(\"Don't accept connections from outside\\n\") +\n             \"  -paytxfee=<amt>  \\t  \"   + _(\"Fee per KB to add to transactions you send\\n\") +\n+#ifdef GUI\n             \"  -server          \\t\\t  \" + _(\"Accept command line and JSON-RPC commands\\n\") +\n             \"  -daemon          \\t\\t  \" + _(\"Run in the background as a daemon and accept commands\\n\") +\n+#endif\n             \"  -testnet         \\t\\t  \" + _(\"Use the test network\\n\") +\n             \"  -rpcuser=<user>  \\t  \"   + _(\"Username for JSON-RPC connections\\n\") +\n             \"  -rpcpassword=<pw>\\t  \"   + _(\"Password for JSON-RPC connections\\n\") +"
      }
    ]
  }
]