[
  {
    "sha": "7d263571bee8c36fbe3c854b69c6f31cf1ee3b9b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3ZDI2MzU3MWJlZThjMzZmYmUzYzg1NGI2OWM2ZjMxY2YxZWUzYjli",
    "commit": {
      "author": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2019-12-11T22:11:20Z"
      },
      "committer": {
        "name": "Andrew Chow",
        "email": "achow101-github@achow101.com",
        "date": "2019-12-11T22:19:33Z"
      },
      "message": "rpc: require second argument only for scantxoutset start action\n\nThe second argument of scanobjects is only required for the start action.\nStop and abort actions do not need this.",
      "tree": {
        "sha": "4d3677942bf18879fef67aedc4707f91e8875094",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/4d3677942bf18879fef67aedc4707f91e8875094"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7d263571bee8c36fbe3c854b69c6f31cf1ee3b9b",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7d263571bee8c36fbe3c854b69c6f31cf1ee3b9b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/7d263571bee8c36fbe3c854b69c6f31cf1ee3b9b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7d263571bee8c36fbe3c854b69c6f31cf1ee3b9b/comments",
    "author": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "7da9e3a8171f976a9e01ee55ab9fe79bd1f033d1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7da9e3a8171f976a9e01ee55ab9fe79bd1f033d1",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/7da9e3a8171f976a9e01ee55ab9fe79bd1f033d1"
      }
    ],
    "stats": {
      "total": 14,
      "additions": 13,
      "deletions": 1
    },
    "files": [
      {
        "sha": "caec316cd4e1aca94ac53ad51bc6d8ff0636e0e2",
        "filename": "src/rpc/blockchain.cpp",
        "status": "modified",
        "additions": 6,
        "deletions": 1,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7d263571bee8c36fbe3c854b69c6f31cf1ee3b9b/src/rpc/blockchain.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7d263571bee8c36fbe3c854b69c6f31cf1ee3b9b/src/rpc/blockchain.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/blockchain.cpp?ref=7d263571bee8c36fbe3c854b69c6f31cf1ee3b9b",
        "patch": "@@ -2055,7 +2055,7 @@ UniValue scantxoutset(const JSONRPCRequest& request)\n             \"                                      \\\"start\\\" for starting a scan\\n\"\n             \"                                      \\\"abort\\\" for aborting the current scan (returns true when abort was successful)\\n\"\n             \"                                      \\\"status\\\" for progress report (in %) of the current scan\"},\n-                    {\"scanobjects\", RPCArg::Type::ARR, RPCArg::Optional::NO, \"Array of scan objects\\n\"\n+                    {\"scanobjects\", RPCArg::Type::ARR, RPCArg::Optional::OMITTED, \"Array of scan objects. Required for \\\"start\\\" action\\n\"\n             \"                                  Every scan object is either a string descriptor or an object:\",\n                         {\n                             {\"descriptor\", RPCArg::Type::STR, RPCArg::Optional::OMITTED, \"An output descriptor\"},\n@@ -2115,6 +2115,11 @@ UniValue scantxoutset(const JSONRPCRequest& request)\n         if (!reserver.reserve()) {\n             throw JSONRPCError(RPC_INVALID_PARAMETER, \"Scan already in progress, use action \\\"abort\\\" or \\\"status\\\"\");\n         }\n+\n+        if (request.params.size() < 2) {\n+            throw JSONRPCError(RPC_MISC_ERROR, \"scanobjects argument is required for the start action\");\n+        }\n+\n         std::set<CScript> needles;\n         std::map<CScript, std::string> descriptors;\n         CAmount total_in = 0;"
      },
      {
        "sha": "f31e4f43bd8060a605c293c8be40986523813e41",
        "filename": "test/functional/rpc_scantxoutset.py",
        "status": "modified",
        "additions": 7,
        "deletions": 0,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7d263571bee8c36fbe3c854b69c6f31cf1ee3b9b/test/functional/rpc_scantxoutset.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7d263571bee8c36fbe3c854b69c6f31cf1ee3b9b/test/functional/rpc_scantxoutset.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/rpc_scantxoutset.py?ref=7d263571bee8c36fbe3c854b69c6f31cf1ee3b9b",
        "patch": "@@ -116,5 +116,12 @@ def run_test(self):\n         assert_equal(descriptors(self.nodes[0].scantxoutset(\"start\", [ \"combo(tprv8ZgxMBicQKsPd7Uf69XL1XwhmjHopUGep8GuEiJDZmbQz6o58LninorQAfcKZWARbtRtfnLcJ5MQ2AtHcQJCCRUcMRvmDUjyEmNUWwx8UbK/1/1/0)\"])), [\"pkh([0c5f9a1e/1/1/0]03e1c5b6e650966971d7e71ef2674f80222752740fc1dfd63bbbd220d2da9bd0fb)#cxmct4w8\"])\n         assert_equal(descriptors(self.nodes[0].scantxoutset(\"start\", [ {\"desc\": \"combo(tpubD6NzVbkrYhZ4WaWSyoBvQwbpLkojyoTZPRsgXELWz3Popb3qkjcJyJUGLnL4qHHoQvao8ESaAstxYSnhyswJ76uZPStJRJCTKvosUCJZL5B/1/1/*)\", \"range\": 1500}])), ['pkh([0c5f9a1e/1/1/0]03e1c5b6e650966971d7e71ef2674f80222752740fc1dfd63bbbd220d2da9bd0fb)#cxmct4w8', 'pkh([0c5f9a1e/1/1/1500]03832901c250025da2aebae2bfb38d5c703a57ab66ad477f9c578bfbcd78abca6f)#vchwd07g', 'pkh([0c5f9a1e/1/1/1]030d820fc9e8211c4169be8530efbc632775d8286167afd178caaf1089b77daba7)#z2t3ypsa'])\n \n+        # Check that status and abort don't need second arg\n+        assert_equal(self.nodes[0].scantxoutset(\"status\"), None)\n+        assert_equal(self.nodes[0].scantxoutset(\"abort\"), False)\n+\n+        # Check that second arg is needed for start\n+        assert_raises_rpc_error(-1, \"scanobjects argument is required for the start action\", self.nodes[0].scantxoutset, \"start\")\n+\n if __name__ == '__main__':\n     ScantxoutsetTest().main()"
      }
    ]
  }
]