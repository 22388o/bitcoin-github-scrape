[
  {
    "sha": "f8213c05f087e5fbb5d92a291f766b0baebc798f",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmODIxM2MwNWYwODdlNWZiYjVkOTJhMjkxZjc2NmIwYmFlYmM3OThm",
    "commit": {
      "author": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2020-06-09T13:50:45Z"
      },
      "committer": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2020-06-11T12:49:39Z"
      },
      "message": "Add means to handle negative capabilities in thread safety annotations",
      "tree": {
        "sha": "37ef4f10f4c84aca2cec499bb1b268c493a2239b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/37ef4f10f4c84aca2cec499bb1b268c493a2239b"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f8213c05f087e5fbb5d92a291f766b0baebc798f",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE0dvyxLlvLev0wWZUQQEIES5+qB8FAl7iKGUACgkQQQEIES5+\nqB9kaQ/9E84HU/XoadPx5q+Iqn8JTG3qHuHbHzr6Tkyz4E7rHyUtKn81JAhMADeA\nWg8L0d+ydF9XeMErg3SGDMSHVOMoPlcV9oZ/peZyN0KeEsY+pcKSSBq9iyNhdOeH\npvPgod3vv3LJklOVvenUvXJnnKxm+UEpGOUUsTS1lUTQOLpmKRus3S6JWd5glhbP\nkuT4sPUxw+JiwExlcOnWc3XHFEs26gDKkDeFQdwXwPovETEcS9T6e/INtqY8NhQs\nvRCD5O4/zGBPZaertkQJbmD8yL9TrlCt4WZ5clgmJGABiXTiD5JBt2005XUluWrM\nvuKK7HVcT+ZKa/4+zRJGo89KmzH0ba31RuaVF3t2RzSKkxyz9eXvQkA0O/bCi2e4\nV8QHXiHjXW3Gi1JcY61vn8NMrGATVamSHFUnL39GE/G9h3NZUNP5Mc9lMpdFdKQw\nh8MBVVkFNlfnDlN82L79LqoxttnRk3TyDtTkqpaWhHjkQ+e3xxyiIYEjYAmsB4Vn\n3Tp91YNeUirDmQvPU5Ww0xjBas9Ak9Tv5A5fe2m97WP9D/4/PfUUJ6MxoWmF5Ly1\nee9gulloVIkmrGWj1s5FZ0CXBYR3xExs5VbQnN8gI+b3y6IKVyRWWvX7HtmVybgO\n/E3nbiw2kJbJKyq1Xf9LcI8e3B4i8Qctm/RmJE/Ax1FKyOpcvnw=\n=D5eU\n-----END PGP SIGNATURE-----",
        "payload": "tree 37ef4f10f4c84aca2cec499bb1b268c493a2239b\nparent 45a6811d36fc59ce0d7e2be7a848059a05b0486e\nauthor Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1591710645 +0300\ncommitter Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1591879779 +0300\n\nAdd means to handle negative capabilities in thread safety annotations\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f8213c05f087e5fbb5d92a291f766b0baebc798f",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/f8213c05f087e5fbb5d92a291f766b0baebc798f",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f8213c05f087e5fbb5d92a291f766b0baebc798f/comments",
    "author": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "45a6811d36fc59ce0d7e2be7a848059a05b0486e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/45a6811d36fc59ce0d7e2be7a848059a05b0486e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/45a6811d36fc59ce0d7e2be7a848059a05b0486e"
      }
    ],
    "stats": {
      "total": 13,
      "additions": 13,
      "deletions": 0
    },
    "files": [
      {
        "sha": "77327d8bfe69f0f5ae65680068e11f335823c97f",
        "filename": "src/sync.h",
        "status": "modified",
        "additions": 6,
        "deletions": 0,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f8213c05f087e5fbb5d92a291f766b0baebc798f/src/sync.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f8213c05f087e5fbb5d92a291f766b0baebc798f/src/sync.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/sync.h?ref=f8213c05f087e5fbb5d92a291f766b0baebc798f",
        "patch": "@@ -103,6 +103,12 @@ class LOCKABLE AnnotatedMixin : public PARENT\n     }\n \n     using UniqueLock = std::unique_lock<PARENT>;\n+#ifdef __clang__\n+    //! For negative capabilities in the Clang Thread Safety Analysis.\n+    //! A negative requirement uses the EXCLUSIVE_LOCKS_REQUIRED attribute, in conjunction\n+    //! with the ! operator, to indicate that a mutex should not be held.\n+    const AnnotatedMixin& operator!() const { return *this; }\n+#endif // __clang__\n };\n \n /**"
      },
      {
        "sha": "5f2c40bac6274c254473f012ccab042526138a85",
        "filename": "src/threadsafety.h",
        "status": "modified",
        "additions": 7,
        "deletions": 0,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f8213c05f087e5fbb5d92a291f766b0baebc798f/src/threadsafety.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f8213c05f087e5fbb5d92a291f766b0baebc798f/src/threadsafety.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/threadsafety.h?ref=f8213c05f087e5fbb5d92a291f766b0baebc798f",
        "patch": "@@ -60,6 +60,13 @@\n // and should only be used when sync.h Mutex/LOCK/etc are not usable.\n class LOCKABLE StdMutex : public std::mutex\n {\n+public:\n+#ifdef __clang__\n+    //! For negative capabilities in the Clang Thread Safety Analysis.\n+    //! A negative requirement uses the EXCLUSIVE_LOCKS_REQUIRED attribute, in conjunction\n+    //! with the ! operator, to indicate that a mutex should not be held.\n+    const StdMutex& operator!() const { return *this; }\n+#endif // __clang__\n };\n \n // StdLockGuard provides an annotated version of std::lock_guard for us,"
      }
    ]
  }
]