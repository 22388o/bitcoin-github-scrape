instagibbs,2019-12-05 17:09:35,"cc @achow101 @Sjors \n\nconversation ensued on IRC after reading https://github.com/bitcoin/bitcoin/pull/16373#discussion_r354411199 since this pattern should be followed in each place we use this behavior for LegacyScriptPubKeyMan",https://github.com/bitcoin/bitcoin/pull/17677#issuecomment-562222909,562222909,
achow101,2019-12-06 17:10:54,"This isn't quite what I was thinking.\n\nThe thought was that you would do either checking for LegacyScrriptPubKeyMan or ISMINE_ALL, not both. Since ISMINE_WATCHONLY is not intended to be used outside of LegacyScriptPubKeyMan, you could just check for whether it's LegacySPKM and set ISMINE_WATCHONLY if it is. Otherwise you just use ISMINE_SPENDABLE.\n\nAlternatively, because ISMINE_ALL  is `IS",https://github.com/bitcoin/bitcoin/pull/17677#issuecomment-562658287,562658287,
instagibbs,2019-12-06 17:15:54,"If I have to choose, I'll stick with the Legacy check + ISMINE_WATCH_ONLY since it's easier for me to understand the purpose/scope of the code. Updated.",https://github.com/bitcoin/bitcoin/pull/17677#issuecomment-562660059,562660059,
achow101,2019-12-06 18:30:03,ACK 6beb900c0cdf86f40ca5e75f3c77b3d0461ea7a3,https://github.com/bitcoin/bitcoin/pull/17677#issuecomment-562686433,562686433,
DrahtBot,2019-12-07 03:09:09,<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.,https://github.com/bitcoin/bitcoin/pull/17677#issuecomment-562808108,562808108,
instagibbs,2019-12-10 14:29:35,"Reduced changes as per discussion to just affecting the ismine filter, rather than `fAllowWatchOnly`.",https://github.com/bitcoin/bitcoin/pull/17677#issuecomment-564058051,564058051,
achow101,2019-12-10 16:37:14,ACK e1e1442f3eadc1d139380e71c1b60b86d8d6bdee,https://github.com/bitcoin/bitcoin/pull/17677#issuecomment-564119322,564119322,
jonatack,2019-12-16 17:14:23,"This smaller diff in e1e1442f3eadc1d139380e71c1b60b86d8d6bdee seems good and the build/tests pass. Started looking at a test which, per @instagibbs suggestion, would define a new spk_man, add watchonly coins, then check they aren't returned by ListCoins.",https://github.com/bitcoin/bitcoin/pull/17677#issuecomment-566154878,566154878,
Sjors,2019-12-06 11:21:15,"Note to other reviewers: `ISMINE_ALL = ISMINE_WATCH_ONLY | ISMINE_SPENDABLE`. When `WALLET_FLAG_DISABLE_PRIVATE_KEYS` is set, no coins can be `ISMINE_SPENDABLE`. Therefore `ISMINE_ALL` leads to the same behavior as `ISMINE_WATCH_ONLY `",https://github.com/bitcoin/bitcoin/pull/17677#discussion_r354785799,354785799,src/wallet/wallet.cpp
jonatack,2019-12-08 18:53:47,"Suggestion:\n```diff\n-    // Include watch-only for wallets without private key\n+    // Include watch-only for LegacyScriptPubKeyMan wallets without private keys.\n```\n",https://github.com/bitcoin/bitcoin/pull/17677#discussion_r355206604,355206604,src/qt/sendcoinsdialog.cpp
jonatack,2019-12-08 18:55:55,"In addition to here in `SendCoinsDialog::useAvailableBalance()`, should this be updated in `SendCoinsDialog::updateCoinControlState()` as well? https://github.com/bitcoin/bitcoin/blob/6beb900c0cdf86f40ca5e75f3c77b3d0461ea7a3/src/qt/sendcoinsdialog.cpp#L711",https://github.com/bitcoin/bitcoin/pull/17677#discussion_r355206747,355206747,src/qt/sendcoinsdialog.cpp
jonatack,2019-12-08 18:59:20,"Suggestion:\n```diff\n-    // Include watch-only for wallets without private keys\n+    // Include watch-only for LegacyScriptPubKeyMan wallets without private keys.\n```",https://github.com/bitcoin/bitcoin/pull/17677#discussion_r355206965,355206965,src/wallet/wallet.cpp
instagibbs,2019-12-09 14:07:56,"oh, good catch. Will update.\n\nDo we want to also do similar gating in https://github.com/bitcoin/bitcoin/pull/16944/files#diff-76b18bd21ccf64e256f029a8198ecdd7R190 ?\n\ncc @achow101 ",https://github.com/bitcoin/bitcoin/pull/17677#discussion_r355467843,355467843,src/qt/sendcoinsdialog.cpp
achow101,2019-12-09 18:15:16,Gating should really only apply to anything that guards ismine filters. We want to have the watch only behavior apply to any watch only wallet. The gating is just to use the correct ismine filters.,https://github.com/bitcoin/bitcoin/pull/17677#discussion_r355603851,355603851,src/qt/sendcoinsdialog.cpp
instagibbs,2019-12-09 18:25:08,"to be clear, you are saying we should *remove* the change above at line 656, rather than add another check at 711?",https://github.com/bitcoin/bitcoin/pull/17677#discussion_r355608575,355608575,src/qt/sendcoinsdialog.cpp
achow101,2019-12-09 19:12:55,"After looking at everywhere that `fAllowWatchOnly` is being used, yes, I think we should remove this change. Instead we need to check everywhere that we conditionally set a filter for `ISMINE_WATCHONLY` and add a check for LegacySPKM at each place.",https://github.com/bitcoin/bitcoin/pull/17677#discussion_r355631829,355631829,src/qt/sendcoinsdialog.cpp
