[
  {
    "sha": "81bbd32a2c755482c6e8ef049a59de672715b545",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4MWJiZDMyYTJjNzU1NDgyYzZlOGVmMDQ5YTU5ZGU2NzI3MTViNTQ1",
    "commit": {
      "author": {
        "name": "practicalswift",
        "email": "practicalswift@users.noreply.github.com",
        "date": "2018-06-03T19:33:32Z"
      },
      "committer": {
        "name": "practicalswift",
        "email": "practicalswift@users.noreply.github.com",
        "date": "2018-06-04T08:08:08Z"
      },
      "message": "build: Guard against accidental introduction of new Boost dependencies",
      "tree": {
        "sha": "bacca9ac201ac8cd36204572a76328cebc42f39a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bacca9ac201ac8cd36204572a76328cebc42f39a"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/81bbd32a2c755482c6e8ef049a59de672715b545",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/81bbd32a2c755482c6e8ef049a59de672715b545",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/81bbd32a2c755482c6e8ef049a59de672715b545",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/81bbd32a2c755482c6e8ef049a59de672715b545/comments",
    "author": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "2722a1f8e935df86e698d717a35e7ffef65e6e02",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2722a1f8e935df86e698d717a35e7ffef65e6e02",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/2722a1f8e935df86e698d717a35e7ffef65e6e02"
      }
    ],
    "stats": {
      "total": 68,
      "additions": 68,
      "deletions": 0
    },
    "files": [
      {
        "sha": "7cab0ca4d19480947067e79908243161c60e6c65",
        "filename": "test/lint/lint-includes.sh",
        "status": "modified",
        "additions": 68,
        "deletions": 0,
        "changes": 68,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/81bbd32a2c755482c6e8ef049a59de672715b545/test/lint/lint-includes.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/81bbd32a2c755482c6e8ef049a59de672715b545/test/lint/lint-includes.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/lint/lint-includes.sh?ref=81bbd32a2c755482c6e8ef049a59de672715b545",
        "patch": "@@ -5,12 +5,14 @@\n # file COPYING or http://www.opensource.org/licenses/mit-license.php.\n #\n # Check for duplicate includes.\n+# Guard against accidental introduction of new Boost dependencies.\n \n filter_suffix() {\n     git ls-files | grep -E \"^src/.*\\.${1}\"'$' | grep -Ev \"/(leveldb|secp256k1|univalue)/\"\n }\n \n EXIT_CODE=0\n+\n for HEADER_FILE in $(filter_suffix h); do\n     DUPLICATE_INCLUDES_IN_HEADER_FILE=$(grep -E \"^#include \" < \"${HEADER_FILE}\" | sort | uniq -d)\n     if [[ ${DUPLICATE_INCLUDES_IN_HEADER_FILE} != \"\" ]]; then\n@@ -20,6 +22,7 @@ for HEADER_FILE in $(filter_suffix h); do\n         EXIT_CODE=1\n     fi\n done\n+\n for CPP_FILE in $(filter_suffix cpp); do\n     DUPLICATE_INCLUDES_IN_CPP_FILE=$(grep -E \"^#include \" < \"${CPP_FILE}\" | sort | uniq -d)\n     if [[ ${DUPLICATE_INCLUDES_IN_CPP_FILE} != \"\" ]]; then\n@@ -29,4 +32,69 @@ for CPP_FILE in $(filter_suffix cpp); do\n         EXIT_CODE=1\n     fi\n done\n+\n+EXPECTED_BOOST_INCLUDES=(\n+    boost/algorithm/string.hpp\n+    boost/algorithm/string/case_conv.hpp\n+    boost/algorithm/string/classification.hpp\n+    boost/algorithm/string/join.hpp\n+    boost/algorithm/string/predicate.hpp\n+    boost/algorithm/string/replace.hpp\n+    boost/algorithm/string/split.hpp\n+    boost/assign/std/vector.hpp\n+    boost/bind.hpp\n+    boost/chrono/chrono.hpp\n+    boost/date_time/posix_time/posix_time.hpp\n+    boost/filesystem.hpp\n+    boost/filesystem/detail/utf8_codecvt_facet.hpp\n+    boost/filesystem/fstream.hpp\n+    boost/interprocess/sync/file_lock.hpp\n+    boost/multi_index/hashed_index.hpp\n+    boost/multi_index/ordered_index.hpp\n+    boost/multi_index/sequenced_index.hpp\n+    boost/multi_index_container.hpp\n+    boost/optional.hpp\n+    boost/preprocessor/cat.hpp\n+    boost/preprocessor/stringize.hpp\n+    boost/program_options/detail/config_file.hpp\n+    boost/scoped_array.hpp\n+    boost/signals2/connection.hpp\n+    boost/signals2/last_value.hpp\n+    boost/signals2/signal.hpp\n+    boost/test/unit_test.hpp\n+    boost/thread.hpp\n+    boost/thread/condition_variable.hpp\n+    boost/thread/mutex.hpp\n+    boost/thread/thread.hpp\n+    boost/variant.hpp\n+    boost/variant/apply_visitor.hpp\n+    boost/variant/static_visitor.hpp\n+)\n+\n+for BOOST_INCLUDE in $(git grep '^#include <boost/' -- \"*.cpp\" \"*.h\" | cut -f2 -d: | cut -f2 -d'<' | cut -f1 -d'>' | sort -u); do\n+    IS_EXPECTED_INCLUDE=0\n+    for EXPECTED_BOOST_INCLUDE in \"${EXPECTED_BOOST_INCLUDES[@]}\"; do\n+        if [[ \"${BOOST_INCLUDE}\" == \"${EXPECTED_BOOST_INCLUDE}\" ]]; then\n+            IS_EXPECTED_INCLUDE=1\n+            break\n+        fi\n+    done\n+    if [[ ${IS_EXPECTED_INCLUDE} == 0 ]]; then\n+        EXIT_CODE=1\n+        echo \"A new Boost dependency in the form of \\\"${BOOST_INCLUDE}\\\" appears to have been introduced:\"\n+        git grep \"${BOOST_INCLUDE}\" -- \"*.cpp\" \"*.h\"\n+        echo\n+    fi\n+done\n+\n+for EXPECTED_BOOST_INCLUDE in \"${EXPECTED_BOOST_INCLUDES[@]}\"; do\n+    if ! git grep -q \"^#include <${EXPECTED_BOOST_INCLUDE}>\" -- \"*.cpp\" \"*.h\"; then\n+        echo \"Good job! The Boost dependency \\\"${EXPECTED_BOOST_INCLUDE}\\\" is no longer used.\"\n+        echo \"Please remove it from EXPECTED_BOOST_INCLUDES in $0\"\n+        echo \"to make sure this dependency is not accidentally reintroduced.\"\n+        echo\n+        EXIT_CODE=1\n+    fi\n+done\n+\n exit ${EXIT_CODE}"
      }
    ]
  }
]