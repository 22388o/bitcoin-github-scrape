[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356132774",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-356132774",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 356132774,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NjEzMjc3NA==",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?u=4a9af998e1a560b3f49c3827f453e1bcbe6a5cfb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-08T23:44:57Z",
    "updated_at": "2018-01-08T23:44:57Z",
    "author_association": "MEMBER",
    "body": "Does it forces bech32 addresses in the wallet without consent?\r\n\r\n\r\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356132774/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356238217",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-356238217",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 356238217,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NjIzODIxNw==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-09T10:05:37Z",
    "updated_at": "2018-01-09T10:05:37Z",
    "author_association": "MEMBER",
    "body": "@promag for change addresses yes, so that could be an objection.\r\n\r\nMore conservative approaches could be:\r\n1) have another UI check box to send change to a bech32 address; this could be checked by default if all destinations are bech32. This won't work for RPC users, but those can be expected to use the `-changeaddress` flag.\r\n\r\n2) add an additional constraint that at least one of the the from addresses is bech32.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356238217/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356238760",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-356238760",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 356238760,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NjIzODc2MA==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-09T10:07:42Z",
    "updated_at": "2018-01-09T10:07:42Z",
    "author_association": "MEMBER",
    "body": "Creating a change output AFAIK does not add any address to the wallet.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356238760/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356239182",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-356239182",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 356239182,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NjIzOTE4Mg==",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?u=4a9af998e1a560b3f49c3827f453e1bcbe6a5cfb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-09T10:09:15Z",
    "updated_at": "2018-01-09T10:09:15Z",
    "author_association": "MEMBER",
    "body": "@sipa they are listed in `listunspent` right?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356239182/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356239905",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-356239905",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 356239905,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NjIzOTkwNQ==",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?u=4a9af998e1a560b3f49c3827f453e1bcbe6a5cfb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-09T10:11:59Z",
    "updated_at": "2018-01-09T10:11:59Z",
    "author_association": "MEMBER",
    "body": "@Sjors IMO the `-changetype` is enough, eventually it will default to bech32 I guess.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356239905/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356845504",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-356845504",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 356845504,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1Njg0NTUwNA==",
    "user": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?u=63e5c438c242094837a9deeda775d77988b508bf&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-11T07:08:31Z",
    "updated_at": "2018-01-11T07:08:31Z",
    "author_association": "CONTRIBUTOR",
    "body": "General concept ACK-- but I would suggest that it only do this if the change type is at least p2sh segwit:  There might be some compatibility reason that someone is avoiding creating segwit outputs for some reason.  That doesn't hold if they're already asking for p2sh output...  privacy was the major reason the sw wallet support didn't go 100% native change from the start... but that is even more an argument for this.  In fact, I think it's an argument that we should use native change if any (or no more strict than 'most') outputs are native and not just require all.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356845504/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356881113",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-356881113",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 356881113,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1Njg4MTExMw==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-11T09:45:42Z",
    "updated_at": "2018-01-11T09:45:42Z",
    "author_association": "MEMBER",
    "body": "@gmaxwell it now uses a bech32 change address if change type is p2sh-segwit and any of the outputs are bech32.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356881113/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356891888",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-356891888",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 356891888,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1Njg5MTg4OA==",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-11T10:25:49Z",
    "updated_at": "2018-01-11T10:25:49Z",
    "author_association": "MEMBER",
    "body": "Seems to me if the user is explicitly setting a change type, we should respect that.\r\n\r\nInstead, I suggest turning OUTPUT_TYPE_DEFAULT into a real value, and handling it specially for change here. Eg, https://github.com/luke-jr/bitcoin/commits/bech32-change",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356891888/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356895800",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-356895800",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 356895800,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1Njg5NTgwMA==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-11T10:41:09Z",
    "updated_at": "2018-01-11T10:41:09Z",
    "author_association": "MEMBER",
    "body": "@luke-jr I like the idea of having OUTPUT_TYPE_DEFAULT so we can distinguish between `-changetype` being absent or set to `p2sh-segwit`. Can you make d4e51351 a PR that I can rebase this on? ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356895800/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356896373",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-356896373",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 356896373,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1Njg5NjM3Mw==",
    "user": {
      "login": "luke-jr",
      "id": 1095675,
      "node_id": "MDQ6VXNlcjEwOTU2NzU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1095675?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/luke-jr",
      "html_url": "https://github.com/luke-jr",
      "followers_url": "https://api.github.com/users/luke-jr/followers",
      "following_url": "https://api.github.com/users/luke-jr/following{/other_user}",
      "gists_url": "https://api.github.com/users/luke-jr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/luke-jr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/luke-jr/subscriptions",
      "organizations_url": "https://api.github.com/users/luke-jr/orgs",
      "repos_url": "https://api.github.com/users/luke-jr/repos",
      "events_url": "https://api.github.com/users/luke-jr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/luke-jr/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-11T10:43:30Z",
    "updated_at": "2018-01-11T10:43:30Z",
    "author_association": "MEMBER",
    "body": "It seems a bit pointless to stand on its own in a PR. It would be better to just include it as a separate commit here (and in another PR I'm about to open).\r\n\r\nTo get it in your own branch as-is, switch to it and do:\r\n```\r\ngit fetch git://github.com/luke-jr/bitcoin bech32-change && git reset --hard 5efd54745c34ff329d9c75f2f5ee852930b21231\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356896373/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356915438",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-356915438",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 356915438,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NjkxNTQzOA==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-11T12:05:57Z",
    "updated_at": "2018-01-11T12:05:57Z",
    "author_association": "MEMBER",
    "body": "@luke-jr I'll wait a little bit to see if your commit needs more changes.\r\n\r\nI do think it's worth it's own PR, but applied to all launch flags where absence or presence can cause ambiguity about user intention. I've run into this general problem several times now, e.g. with #9527. ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/356915438/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357019868",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-357019868",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 357019868,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NzAxOTg2OA==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-11T18:34:46Z",
    "updated_at": "2018-01-11T18:34:46Z",
    "author_association": "MEMBER",
    "body": ">  Should check inputs instead?\r\n\r\nOr even check if any input or any output is bech32?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357019868/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357028850",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-357028850",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 357028850,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NzAyODg1MA==",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-11T19:06:11Z",
    "updated_at": "2018-01-11T19:06:11Z",
    "author_association": "MEMBER",
    "body": "agreed with @TheBlueMatt just check if it's set",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357028850/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357033789",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-357033789",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 357033789,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NzAzMzc4OQ==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-11T19:23:59Z",
    "updated_at": "2018-01-11T19:23:59Z",
    "author_association": "MEMBER",
    "body": "I can't reproduce this Travis failure on MacOS or Ubuntu 14.04 (I didn't use the depends system).",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357033789/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357053281",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-357053281",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 357053281,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NzA1MzI4MQ==",
    "user": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?u=63e5c438c242094837a9deeda775d77988b508bf&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-11T20:35:35Z",
    "updated_at": "2018-01-11T23:15:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "It seemed like people in the IRC meeting liked:  \"If the configured change type is not legacy, use p2wpkh if any of the outputs are p2wpkh\".",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357053281/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357056748",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-357056748",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 357056748,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NzA1Njc0OA==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-11T20:49:01Z",
    "updated_at": "2018-01-11T20:49:01Z",
    "author_association": "MEMBER",
    "body": "@gmaxwell by \"legacy\" you mean `p2sh-segwit`? `-changetype=legacy` means p2pkh (in which case we also don't want to use bech32). Maybe we should also rename that `legacy` option, because the term seems overloaded.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357056748/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357092710",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-357092710",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 357092710,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NzA5MjcxMA==",
    "user": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?u=63e5c438c242094837a9deeda775d77988b508bf&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-11T23:14:41Z",
    "updated_at": "2018-01-11T23:14:41Z",
    "author_association": "CONTRIBUTOR",
    "body": "By legacy I mean p2pkh. We should not create native segwit change if the user has specifically asked for non-segwit change.  If a user is setting legacy then it's likely that they really don't want segwit outputs for some reason (for example, compatibility with older software).\r\n\r\nThat argument doesn't apply for p2sh-segwit. The only reason to ever use p2sh-segwit change is for change distinguishability privacy, which, as you note-- doesn't apply when there are segwit outputs.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357092710/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357093139",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-357093139",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 357093139,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NzA5MzEzOQ==",
    "user": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?u=63e5c438c242094837a9deeda775d77988b508bf&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-11T23:16:38Z",
    "updated_at": "2018-01-11T23:16:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "As a pedantic aside, it's a mistake to say \"bech32\" -- there is no address involved with change, so no bech32 involved here at all.  The question here is to use p2sh-p2wpkh or p2wpkh, which would exist no less even if bech32 had never been specified.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357093139/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357127353",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-357127353",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 357127353,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NzEyNzM1Mw==",
    "user": {
      "login": "achow101",
      "id": 3782274,
      "node_id": "MDQ6VXNlcjM3ODIyNzQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3782274?u=9791e96cd4268d48e3517bac41eaf2b1d09759fd&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/achow101",
      "html_url": "https://github.com/achow101",
      "followers_url": "https://api.github.com/users/achow101/followers",
      "following_url": "https://api.github.com/users/achow101/following{/other_user}",
      "gists_url": "https://api.github.com/users/achow101/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/achow101/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/achow101/subscriptions",
      "organizations_url": "https://api.github.com/users/achow101/orgs",
      "repos_url": "https://api.github.com/users/achow101/repos",
      "events_url": "https://api.github.com/users/achow101/events{/privacy}",
      "received_events_url": "https://api.github.com/users/achow101/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-12T02:43:24Z",
    "updated_at": "2018-01-12T02:43:24Z",
    "author_association": "MEMBER",
    "body": "Concept ACK",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357127353/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357221725",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-357221725",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 357221725,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NzIyMTcyNQ==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-12T12:04:16Z",
    "updated_at": "2018-01-12T12:04:16Z",
    "author_association": "MEMBER",
    "body": "@gmaxwell I know there's no spoon, but block explorers will display a spoon :-)",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357221725/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357283449",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-357283449",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 357283449,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NzI4MzQ0OQ==",
    "user": {
      "login": "sneurlax",
      "id": 4107993,
      "node_id": "MDQ6VXNlcjQxMDc5OTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4107993?u=247e4efecc63542935445b938f73fba4b4d3b89e&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sneurlax",
      "html_url": "https://github.com/sneurlax",
      "followers_url": "https://api.github.com/users/sneurlax/followers",
      "following_url": "https://api.github.com/users/sneurlax/following{/other_user}",
      "gists_url": "https://api.github.com/users/sneurlax/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sneurlax/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sneurlax/subscriptions",
      "organizations_url": "https://api.github.com/users/sneurlax/orgs",
      "repos_url": "https://api.github.com/users/sneurlax/repos",
      "events_url": "https://api.github.com/users/sneurlax/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sneurlax/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-12T16:19:41Z",
    "updated_at": "2018-01-12T16:19:41Z",
    "author_association": "NONE",
    "body": "If this is merged, I think it ought to be paired with #12146.  It's a good, off-by-default option to have available for strange edge cases that want to run the latest full node software but have what would otherwise be an infuriating need to remain compatible with legacy systems.\r\n\r\nJust my 2 bits.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357283449/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357284596",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-357284596",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 357284596,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NzI4NDU5Ng==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-12T16:23:42Z",
    "updated_at": "2018-01-12T16:23:42Z",
    "author_association": "MEMBER",
    "body": "This should be ready for review, pending Travis' blessing.\r\n\r\n@sneurlax there's no need for that. Those who would use #12146 would also launch with `-addresstype=legacy`, which prevents the behavior this PR adds.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357284596/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357287565",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-357287565",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 357287565,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NzI4NzU2NQ==",
    "user": {
      "login": "sneurlax",
      "id": 4107993,
      "node_id": "MDQ6VXNlcjQxMDc5OTM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/4107993?u=247e4efecc63542935445b938f73fba4b4d3b89e&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sneurlax",
      "html_url": "https://github.com/sneurlax",
      "followers_url": "https://api.github.com/users/sneurlax/followers",
      "following_url": "https://api.github.com/users/sneurlax/following{/other_user}",
      "gists_url": "https://api.github.com/users/sneurlax/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sneurlax/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sneurlax/subscriptions",
      "organizations_url": "https://api.github.com/users/sneurlax/orgs",
      "repos_url": "https://api.github.com/users/sneurlax/repos",
      "events_url": "https://api.github.com/users/sneurlax/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sneurlax/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-12T16:34:08Z",
    "updated_at": "2018-01-12T16:34:52Z",
    "author_association": "NONE",
    "body": "I must still misunderstand their relation, then.  Sorry for piping up.\r\n\r\nDoes `-changetype=bech32` also prevent the behavior this PR adds?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357287565/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357290095",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-357290095",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 357290095,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NzI5MDA5NQ==",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-12T16:43:08Z",
    "updated_at": "2018-01-12T16:43:08Z",
    "author_association": "MEMBER",
    "body": "concept ACK",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357290095/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357294802",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-357294802",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 357294802,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NzI5NDgwMg==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-12T16:59:29Z",
    "updated_at": "2018-01-12T16:59:29Z",
    "author_association": "MEMBER",
    "body": "@sneurlax yes. If you set `-changetype` it will honor that. Only if you don't set `-changetype` and you don't set `-addresstype=legacy` it will use the following rule: use a native segwit change output* if any destination is a native segwit address.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357294802/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357697093",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-357697093",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 357697093,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NzY5NzA5Mw==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-15T14:26:25Z",
    "updated_at": "2018-01-15T14:26:25Z",
    "author_association": "MEMBER",
    "body": "@TheBlueMatt test failure seems indeterministic. Afaik I only added a comment since the last time Travis was happy. We'll see what happens with this indentation fix.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357697093/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357707934",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-357707934",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 357707934,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NzcwNzkzNA==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-15T15:06:06Z",
    "updated_at": "2018-01-15T15:06:06Z",
    "author_association": "MEMBER",
    "body": "`net.py` fails on Travis, but passes locally. I'll rebase because there are some new test related fixes on master.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357707934/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357728968",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-357728968",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 357728968,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NzcyODk2OA==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-15T16:21:19Z",
    "updated_at": "2018-01-15T16:21:19Z",
    "author_association": "MEMBER",
    "body": "Rebase made Travis happy.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357728968/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357939402",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-357939402",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 357939402,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1NzkzOTQwMg==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-16T12:00:41Z",
    "updated_at": "2018-01-16T12:00:41Z",
    "author_association": "MEMBER",
    "body": "`g_change_type` is no longer based on `-addresstype`. Functions that use `g_change_type` need to handle `OUTPUT_TYPE_NONE`, which I've done everywhere with: `g_change_type ? g_change_type : g_address_type`.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357939402/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357982763",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-357982763",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 357982763,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1Nzk4Mjc2Mw==",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?u=7999a16349f0df0fb273fffa18e5a955c9d3f11c&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-16T14:47:15Z",
    "updated_at": "2018-01-16T14:47:15Z",
    "author_association": "MEMBER",
    "body": "utACK 327634f97e5921815c30e50d076cde0f6ff51aaf\r\n\r\nI think the code can be made a bit cleaner by introducing an explicit P2SH_SEGWIT_BUT_NATIVE_WHEN_NATIVE_DESTINATION or so type in `OutputType`, but let's do that later.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/357982763/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/358577908",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-358577908",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 358577908,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1ODU3NzkwOA==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-18T08:48:06Z",
    "updated_at": "2018-01-18T08:48:06Z",
    "author_association": "MEMBER",
    "body": "Interesting how Github put @ryanofsky's review above @MarcoFalke's even though it's more recent.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/358577908/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/358805079",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-358805079",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 358805079,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1ODgwNTA3OQ==",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?u=4a9af998e1a560b3f49c3827f453e1bcbe6a5cfb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-18T22:37:41Z",
    "updated_at": "2018-01-18T22:37:41Z",
    "author_association": "MEMBER",
    "body": "> I think the code can be made a bit cleaner by introducing an explicit P2SH_SEGWIT_BUT_NATIVE_WHEN_NATIVE_DESTINATION or so type in OutputType, but let's do that later.\r\n\r\n@sipa but `-addresstype` could have that value?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/358805079/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/359100547",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-359100547",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 359100547,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1OTEwMDU0Nw==",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-19T21:56:53Z",
    "updated_at": "2018-01-19T22:00:20Z",
    "author_association": "CONTRIBUTOR",
    "body": "I just realized this PR doesn't currently update the `-changetype` help text, so I withdraw my ACK until that is done. (The current text says `default is same as -addresstype`, which is no longer accurate.)\r\n\r\nConditional utACK 0ee841a21aaea880e3af1e93b53d373295d1f829 if help is updated.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/359100547/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/359172020",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-359172020",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 359172020,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1OTE3MjAyMA==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-20T13:36:16Z",
    "updated_at": "2018-01-20T13:36:16Z",
    "author_association": "MEMBER",
    "body": "> current text says `default is same as -addresstype`, which is no longer accurate\r\n\r\nMaybe I can change it to: \"Default is same as -addresstype, except when sending to a native segwit address and -addresstype is p2sh-segwit\"?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/359172020/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/359459874",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-359459874",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 359459874,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1OTQ1OTg3NA==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-22T15:33:52Z",
    "updated_at": "2018-01-22T15:33:52Z",
    "author_association": "MEMBER",
    "body": "Updated help text:\r\n<img width=\"509\" alt=\"schermafbeelding 2018-01-22 om 15 41 28\" src=\"https://user-images.githubusercontent.com/10217/35226167-c438fac6-ff8a-11e7-83c3-6adc90047236.png\">\r\n\r\n@promag added the `const` you suggested, as well as explicit `== OUTPUT_TYPE_NONE` in both places (@ajtowns).\r\n\r\n> This can be avoided/skipped if there is a custom address in coin control. Move it below to where any_destination_native_segwit is needed.\r\n\r\nDone (which involved another loop over `vecSend`, but I assume that's trivially fast).",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/359459874/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/359827900",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-359827900",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 359827900,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1OTgyNzkwMA==",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?u=4a9af998e1a560b3f49c3827f453e1bcbe6a5cfb&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-23T15:33:38Z",
    "updated_at": "2018-01-23T15:33:38Z",
    "author_association": "MEMBER",
    "body": "utACK dc2812f.\r\n\r\nThe only thing that bothers me is the fact that `g_address_type = OUTPUT_TYPE_NONE` is an error and now `g_change_type = OUTPUT_TYPE_NONE` is not.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/359827900/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/359936480",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-359936480",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/12119",
    "id": 359936480,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM1OTkzNjQ4MA==",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?u=0691974eedcc2ab5366cc1080fb1c030e87244c2&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-01-23T21:28:01Z",
    "updated_at": "2018-01-23T21:28:01Z",
    "author_association": "MEMBER",
    "body": "utACK 596c44633fd03e76cc12f2fd37452e223ba43115",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/359936480/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160982806",
    "pull_request_review_id": 88195958,
    "id": 160982806,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MDk4MjgwNg==",
    "diff_hunk": "@@ -2661,6 +2662,14 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n \n         if (recipient.fSubtractFeeFromAmount)\n             nSubtractFeeFromAmount++;\n+\n+        // Check if the destination doesn't contain a witness program, in which\n+        // case the addresstype for this destination is not bech32:\n+        int witnessversion = 0;\n+        std::vector<unsigned char> witnessprogram;\n+        if (recipient.scriptPubKey.IsWitnessProgram(witnessversion, witnessprogram)) {\n+          anyDestinationBech32 = true;",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 18,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "c3bc3f6a19f77ac39ccd95190932b4317febf8c2",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Wrong indentation. Also `any_destination_bech32`?",
    "created_at": "2018-01-11T15:02:19Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r160982806",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160982806"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r160982806"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160982806/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2671,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160982870",
    "pull_request_review_id": 88195958,
    "id": 160982870,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MDk4Mjg3MA==",
    "diff_hunk": "@@ -2739,8 +2748,15 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n                     return false;\n                 }\n \n-                LearnRelatedScripts(vchPubKey, g_change_type);\n-                scriptChange = GetScriptForDestination(GetDestinationForKey(vchPubKey, g_change_type));\n+                // If g_change_type is p2sh_segwit, use bech32 for the change\n+                // address if any destination is bech32.\n+                OutputType change_type = g_change_type;\n+                if (g_change_type == OUTPUT_TYPE_P2SH_SEGWIT && anyDestinationBech32) {\n+                  change_type = OUTPUT_TYPE_BECH32;",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 33,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "c3bc3f6a19f77ac39ccd95190932b4317febf8c2",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Wrong indentation.",
    "created_at": "2018-01-11T15:02:31Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r160982870",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160982870"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r160982870"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/160982870/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2755,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161038291",
    "pull_request_review_id": 88262479,
    "id": 161038291,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MTAzODI5MQ==",
    "diff_hunk": "@@ -2661,6 +2662,14 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n \n         if (recipient.fSubtractFeeFromAmount)\n             nSubtractFeeFromAmount++;\n+\n+        // Check if the destination doesn't contain a witness program, in which\n+        // case the addresstype for this destination is not bech32:\n+        int witnessversion = 0;\n+        std::vector<unsigned char> witnessprogram;\n+        if (recipient.scriptPubKey.IsWitnessProgram(witnessversion, witnessprogram)) {\n+          anyDestinationBech32 = true;",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 18,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "c3bc3f6a19f77ac39ccd95190932b4317febf8c2",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Will fix indentation and check variable name, thanks.",
    "created_at": "2018-01-11T18:32:29Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161038291",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161038291"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161038291"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161038291/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2671,
    "side": "RIGHT",
    "in_reply_to_id": 160982806
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161257090",
    "pull_request_review_id": 88520049,
    "id": 161257090,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MTI1NzA5MA==",
    "diff_hunk": "@@ -2661,6 +2662,14 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n \n         if (recipient.fSubtractFeeFromAmount)\n             nSubtractFeeFromAmount++;\n+\n+        // Check if the destination doesn't contain a witness program, in which\n+        // case the addresstype for this destination is not bech32:\n+        int witnessversion = 0;\n+        std::vector<unsigned char> witnessprogram;\n+        if (recipient.scriptPubKey.IsWitnessProgram(witnessversion, witnessprogram)) {\n+          anyDestinationBech32 = true;",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 18,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "c3bc3f6a19f77ac39ccd95190932b4317febf8c2",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Fixed.",
    "created_at": "2018-01-12T15:53:13Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161257090",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161257090"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161257090"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161257090/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2671,
    "side": "RIGHT",
    "in_reply_to_id": 160982806
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161261687",
    "pull_request_review_id": 88525644,
    "id": 161261687,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MTI2MTY4Nw==",
    "diff_hunk": "@@ -2661,6 +2662,13 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n \n         if (recipient.fSubtractFeeFromAmount)\n             nSubtractFeeFromAmount++;\n+\n+        // Check if any destination contains a witness program:\n+        int witnessversion = 0;\n+        std::vector<unsigned char> witnessprogram;\n+        if (recipient.scriptPubKey.IsWitnessProgram(witnessversion, witnessprogram)) {",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 16,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "6349a3005375066de984c1f359fb166fa1c82fad",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Should probably check/track witness version here? It shouldn't be >0 unless we update, but probably more future-safe.",
    "created_at": "2018-01-12T16:10:21Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161261687",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161261687"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161261687"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161261687/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2669,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161262071",
    "pull_request_review_id": 88525644,
    "id": 161262071,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MTI2MjA3MQ==",
    "diff_hunk": "@@ -2739,8 +2747,16 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n                     return false;\n                 }\n \n-                LearnRelatedScripts(vchPubKey, g_change_type);\n-                scriptChange = GetScriptForDestination(GetDestinationForKey(vchPubKey, g_change_type));\n+                // If -changetype is not specified and g_address_type is not legacy,\n+                // and any destination is (P2SH-)P2WPKH, use P2WPKH for the change ",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 29,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "6349a3005375066de984c1f359fb166fa1c82fad",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`and any destination is (P2SH-)P2WPKH,` I don't think this is correct? should just be `P2WPKH`",
    "created_at": "2018-01-12T16:11:56Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161262071",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161262071"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161262071"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161262071/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2751,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161269039",
    "pull_request_review_id": 88525644,
    "id": 161269039,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MTI2OTAzOQ==",
    "diff_hunk": "@@ -195,5 +225,40 @@ def run_test(self):\n                 to_node %= 4\n                 assert_equal(new_balances[to_node], old_balances[to_node] + to_send * 10 * (2 + n))\n \n+        # Get one p2sh/segwit address from node2 and two bech32 addresses from node3:\n+        to_address_p2sh = self.nodes[2].getnewaddress()\n+        to_address_bech32_1 = self.nodes[3].getnewaddress()\n+        to_address_bech32_2 = self.nodes[3].getnewaddress()\n+\n+        # Fund node 4:\n+        self.nodes[5].sendtoaddress(self.nodes[4].getnewaddress(), Decimal(\"1\"))\n+        self.nodes[5].generate(1)\n+        sync_blocks(self.nodes)\n+\n+        assert_equal(self.nodes[4].getbalance(), 1)\n+\n+        self.log.debug(\"Nodes with change_type=bech32 always use a P2WPKH change output:\")\n+        self.test_change_output_type(2, [to_address_bech32_1], 'bech32')\n+        self.test_change_output_type(2, [to_address_p2sh], 'bech32')\n+\n+        self.log.debug(\"Nodes with addresstype=bech32 always use a P2WPKH change output:\")\n+        self.test_change_output_type(3, [to_address_bech32_1], 'bech32')\n+        self.test_change_output_type(3, [to_address_p2sh], 'bech32')",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 102,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "6349a3005375066de984c1f359fb166fa1c82fad",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I don't see why this is the case. No payment here is native segwit?",
    "created_at": "2018-01-12T16:38:57Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161269039",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161269039"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161269039"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161269039/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 278,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161298191",
    "pull_request_review_id": 88569986,
    "id": 161298191,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MTI5ODE5MQ==",
    "diff_hunk": "@@ -2661,6 +2662,13 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n \n         if (recipient.fSubtractFeeFromAmount)\n             nSubtractFeeFromAmount++;\n+\n+        // Check if any destination contains a witness program:\n+        int witnessversion = 0;\n+        std::vector<unsigned char> witnessprogram;\n+        if (recipient.scriptPubKey.IsWitnessProgram(witnessversion, witnessprogram)) {",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 16,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "6349a3005375066de984c1f359fb166fa1c82fad",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Would new witness versions require different change address behavior?",
    "created_at": "2018-01-12T18:48:55Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161298191",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161298191"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161298191"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161298191/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2669,
    "side": "RIGHT",
    "in_reply_to_id": 161261687
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161299063",
    "pull_request_review_id": 88571058,
    "id": 161299063,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MTI5OTA2Mw==",
    "diff_hunk": "@@ -195,5 +225,40 @@ def run_test(self):\n                 to_node %= 4\n                 assert_equal(new_balances[to_node], old_balances[to_node] + to_send * 10 * (2 + n))\n \n+        # Get one p2sh/segwit address from node2 and two bech32 addresses from node3:\n+        to_address_p2sh = self.nodes[2].getnewaddress()\n+        to_address_bech32_1 = self.nodes[3].getnewaddress()\n+        to_address_bech32_2 = self.nodes[3].getnewaddress()\n+\n+        # Fund node 4:\n+        self.nodes[5].sendtoaddress(self.nodes[4].getnewaddress(), Decimal(\"1\"))\n+        self.nodes[5].generate(1)\n+        sync_blocks(self.nodes)\n+\n+        assert_equal(self.nodes[4].getbalance(), 1)\n+\n+        self.log.debug(\"Nodes with change_type=bech32 always use a P2WPKH change output:\")\n+        self.test_change_output_type(2, [to_address_bech32_1], 'bech32')\n+        self.test_change_output_type(2, [to_address_p2sh], 'bech32')\n+\n+        self.log.debug(\"Nodes with addresstype=bech32 always use a P2WPKH change output:\")\n+        self.test_change_output_type(3, [to_address_bech32_1], 'bech32')\n+        self.test_change_output_type(3, [to_address_p2sh], 'bech32')",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 102,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "6349a3005375066de984c1f359fb166fa1c82fad",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`addresstype` implicitly sets `changetype`:\r\n\r\n`g_change_type = ParseOutputType(gArgs.GetArg(\"-changetype\", \"\"), g_address_type)`\r\n\r\nIf the user overrides `changetype` it will use that, so I could change the word \"always\" in the comment to reflect that better.",
    "created_at": "2018-01-12T18:53:03Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161299063",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161299063"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161299063"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161299063/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 278,
    "side": "RIGHT",
    "in_reply_to_id": 161269039
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161305747",
    "pull_request_review_id": 88579155,
    "id": 161305747,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MTMwNTc0Nw==",
    "diff_hunk": "@@ -195,5 +225,40 @@ def run_test(self):\n                 to_node %= 4\n                 assert_equal(new_balances[to_node], old_balances[to_node] + to_send * 10 * (2 + n))\n \n+        # Get one p2sh/segwit address from node2 and two bech32 addresses from node3:\n+        to_address_p2sh = self.nodes[2].getnewaddress()\n+        to_address_bech32_1 = self.nodes[3].getnewaddress()\n+        to_address_bech32_2 = self.nodes[3].getnewaddress()\n+\n+        # Fund node 4:\n+        self.nodes[5].sendtoaddress(self.nodes[4].getnewaddress(), Decimal(\"1\"))\n+        self.nodes[5].generate(1)\n+        sync_blocks(self.nodes)\n+\n+        assert_equal(self.nodes[4].getbalance(), 1)\n+\n+        self.log.debug(\"Nodes with change_type=bech32 always use a P2WPKH change output:\")\n+        self.test_change_output_type(2, [to_address_bech32_1], 'bech32')\n+        self.test_change_output_type(2, [to_address_p2sh], 'bech32')\n+\n+        self.log.debug(\"Nodes with addresstype=bech32 always use a P2WPKH change output:\")\n+        self.test_change_output_type(3, [to_address_bech32_1], 'bech32')\n+        self.test_change_output_type(3, [to_address_p2sh], 'bech32')",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 102,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "6349a3005375066de984c1f359fb166fa1c82fad",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "riiiiiiiiiiight. Could you just write that? I actually forgot this and I've reviewed all the PRs so far :(",
    "created_at": "2018-01-12T19:24:54Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161305747",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161305747"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161305747"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161305747/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 278,
    "side": "RIGHT",
    "in_reply_to_id": 161269039
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161306395",
    "pull_request_review_id": 88579972,
    "id": 161306395,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MTMwNjM5NQ==",
    "diff_hunk": "@@ -2661,6 +2662,13 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n \n         if (recipient.fSubtractFeeFromAmount)\n             nSubtractFeeFromAmount++;\n+\n+        // Check if any destination contains a witness program:\n+        int witnessversion = 0;\n+        std::vector<unsigned char> witnessprogram;\n+        if (recipient.scriptPubKey.IsWitnessProgram(witnessversion, witnessprogram)) {",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 16,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "6349a3005375066de984c1f359fb166fa1c82fad",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Let's say you send to a v1, you wouldn't want to accidentally make a v0 to \"copy\" it. Perhaps more appropriate for an assert here.",
    "created_at": "2018-01-12T19:27:54Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161306395",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161306395"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161306395"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161306395/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2669,
    "side": "RIGHT",
    "in_reply_to_id": 161261687
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161307005",
    "pull_request_review_id": 88580710,
    "id": 161307005,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MTMwNzAwNQ==",
    "diff_hunk": "@@ -195,5 +225,40 @@ def run_test(self):\n                 to_node %= 4\n                 assert_equal(new_balances[to_node], old_balances[to_node] + to_send * 10 * (2 + n))\n \n+        # Get one p2sh/segwit address from node2 and two bech32 addresses from node3:\n+        to_address_p2sh = self.nodes[2].getnewaddress()\n+        to_address_bech32_1 = self.nodes[3].getnewaddress()\n+        to_address_bech32_2 = self.nodes[3].getnewaddress()\n+\n+        # Fund node 4:\n+        self.nodes[5].sendtoaddress(self.nodes[4].getnewaddress(), Decimal(\"1\"))\n+        self.nodes[5].generate(1)\n+        sync_blocks(self.nodes)\n+\n+        assert_equal(self.nodes[4].getbalance(), 1)\n+\n+        self.log.debug(\"Nodes with change_type=bech32 always use a P2WPKH change output:\")\n+        self.test_change_output_type(2, [to_address_bech32_1], 'bech32')\n+        self.test_change_output_type(2, [to_address_p2sh], 'bech32')\n+\n+        self.log.debug(\"Nodes with addresstype=bech32 always use a P2WPKH change output:\")\n+        self.test_change_output_type(3, [to_address_bech32_1], 'bech32')\n+        self.test_change_output_type(3, [to_address_p2sh], 'bech32')",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 102,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "6349a3005375066de984c1f359fb166fa1c82fad",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "add at end of above comment \"unless changetype is set otherwise\"",
    "created_at": "2018-01-12T19:30:38Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161307005",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161307005"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161307005"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161307005/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 278,
    "side": "RIGHT",
    "in_reply_to_id": 161269039
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161321827",
    "pull_request_review_id": 88599183,
    "id": 161321827,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MTMyMTgyNw==",
    "diff_hunk": "@@ -195,5 +225,40 @@ def run_test(self):\n                 to_node %= 4\n                 assert_equal(new_balances[to_node], old_balances[to_node] + to_send * 10 * (2 + n))\n \n+        # Get one p2sh/segwit address from node2 and two bech32 addresses from node3:\n+        to_address_p2sh = self.nodes[2].getnewaddress()\n+        to_address_bech32_1 = self.nodes[3].getnewaddress()\n+        to_address_bech32_2 = self.nodes[3].getnewaddress()\n+\n+        # Fund node 4:\n+        self.nodes[5].sendtoaddress(self.nodes[4].getnewaddress(), Decimal(\"1\"))\n+        self.nodes[5].generate(1)\n+        sync_blocks(self.nodes)\n+\n+        assert_equal(self.nodes[4].getbalance(), 1)\n+\n+        self.log.debug(\"Nodes with change_type=bech32 always use a P2WPKH change output:\")\n+        self.test_change_output_type(2, [to_address_bech32_1], 'bech32')\n+        self.test_change_output_type(2, [to_address_p2sh], 'bech32')\n+\n+        self.log.debug(\"Nodes with addresstype=bech32 always use a P2WPKH change output:\")\n+        self.test_change_output_type(3, [to_address_bech32_1], 'bech32')\n+        self.test_change_output_type(3, [to_address_p2sh], 'bech32')",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 102,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "6349a3005375066de984c1f359fb166fa1c82fad",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done",
    "created_at": "2018-01-12T20:48:53Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161321827",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161321827"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161321827"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161321827/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 278,
    "side": "RIGHT",
    "in_reply_to_id": 161269039
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161323276",
    "pull_request_review_id": 88600993,
    "id": 161323276,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MTMyMzI3Ng==",
    "diff_hunk": "@@ -2661,6 +2662,13 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n \n         if (recipient.fSubtractFeeFromAmount)\n             nSubtractFeeFromAmount++;\n+\n+        // Check if any destination contains a witness program:\n+        int witnessversion = 0;\n+        std::vector<unsigned char> witnessprogram;\n+        if (recipient.scriptPubKey.IsWitnessProgram(witnessversion, witnessprogram)) {",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 16,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "6349a3005375066de984c1f359fb166fa1c82fad",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It might be assertophobia, but I'm not sure what you mean by that example. If you send coins to a future v1 segwit address, the change has to go somewhere right? So the change would just go to a v0 witness derived from the next available key in the pool.\r\n\r\nNote that `IsWitnessProgram` writes to `witnessversion`, not the other way around. And `witnessversion` isn't used when the change address is created.\r\n\r\nIt depends on what the intention of v1 is whether change can safely go to a v1 address. But I don't see how it would be unsafe to send to a v0 address. Of course maybe there is a reason, or future us will find a reason. So an assert would force them to think about that. Is that what you mean? ",
    "created_at": "2018-01-12T20:56:14Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161323276",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161323276"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161323276"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161323276/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2669,
    "side": "RIGHT",
    "in_reply_to_id": 161261687
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161326063",
    "pull_request_review_id": 88604436,
    "id": 161326063,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MTMyNjA2Mw==",
    "diff_hunk": "@@ -2661,6 +2662,13 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n \n         if (recipient.fSubtractFeeFromAmount)\n             nSubtractFeeFromAmount++;\n+\n+        // Check if any destination contains a witness program:\n+        int witnessversion = 0;\n+        std::vector<unsigned char> witnessprogram;\n+        if (recipient.scriptPubKey.IsWitnessProgram(witnessversion, witnessprogram)) {",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 16,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "6349a3005375066de984c1f359fb166fa1c82fad",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Not unsafe, but defeats the privacy logic that this enables, I think.\r\n\r\nMaybe I'm making too much hay of this.",
    "created_at": "2018-01-12T21:10:49Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161326063",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161326063"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161326063"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161326063/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2669,
    "side": "RIGHT",
    "in_reply_to_id": 161261687
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161328143",
    "pull_request_review_id": 88606966,
    "id": 161328143,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MTMyODE0Mw==",
    "diff_hunk": "@@ -195,5 +225,40 @@ def run_test(self):\n                 to_node %= 4\n                 assert_equal(new_balances[to_node], old_balances[to_node] + to_send * 10 * (2 + n))\n \n+        # Get one p2sh/segwit address from node2 and two bech32 addresses from node3:\n+        to_address_p2sh = self.nodes[2].getnewaddress()\n+        to_address_bech32_1 = self.nodes[3].getnewaddress()\n+        to_address_bech32_2 = self.nodes[3].getnewaddress()\n+\n+        # Fund node 4:\n+        self.nodes[5].sendtoaddress(self.nodes[4].getnewaddress(), Decimal(\"1\"))\n+        self.nodes[5].generate(1)\n+        sync_blocks(self.nodes)\n+\n+        assert_equal(self.nodes[4].getbalance(), 1)\n+\n+        self.log.debug(\"Nodes with change_type=bech32 always use a P2WPKH change output:\")\n+        self.test_change_output_type(2, [to_address_bech32_1], 'bech32')\n+        self.test_change_output_type(2, [to_address_p2sh], 'bech32')\n+\n+        self.log.debug(\"Nodes with addresstype=bech32 always use a P2WPKH change output:\")\n+        self.test_change_output_type(3, [to_address_bech32_1], 'bech32')\n+        self.test_change_output_type(3, [to_address_p2sh], 'bech32')",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 102,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "6349a3005375066de984c1f359fb166fa1c82fad",
    "user": {
      "login": "sipa",
      "id": 548488,
      "node_id": "MDQ6VXNlcjU0ODQ4OA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/548488?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sipa",
      "html_url": "https://github.com/sipa",
      "followers_url": "https://api.github.com/users/sipa/followers",
      "following_url": "https://api.github.com/users/sipa/following{/other_user}",
      "gists_url": "https://api.github.com/users/sipa/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sipa/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sipa/subscriptions",
      "organizations_url": "https://api.github.com/users/sipa/orgs",
      "repos_url": "https://api.github.com/users/sipa/repos",
      "events_url": "https://api.github.com/users/sipa/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sipa/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think we can discuss what to do with v1 witnesses when the time comes.",
    "created_at": "2018-01-12T21:21:44Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161328143",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161328143"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161328143"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161328143/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 278,
    "side": "RIGHT",
    "in_reply_to_id": 161269039
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161405681",
    "pull_request_review_id": 88690321,
    "id": 161405681,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MTQwNTY4MQ==",
    "diff_hunk": "@@ -2661,6 +2662,13 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n \n         if (recipient.fSubtractFeeFromAmount)\n             nSubtractFeeFromAmount++;\n+\n+        // Check if any destination contains a witness program:\n+        int witnessversion = 0;\n+        std::vector<unsigned char> witnessprogram;\n+        if (recipient.scriptPubKey.IsWitnessProgram(witnessversion, witnessprogram)) {\n+          any_destination_native_segwit = true;",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 17,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "de8ea9c68a69aa2c61abbe26d62e47c3b321fe78",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "short indent here.",
    "created_at": "2018-01-14T18:18:07Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161405681",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161405681"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161405681"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161405681/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2670,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161405829",
    "pull_request_review_id": 88690321,
    "id": 161405829,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MTQwNTgyOQ==",
    "diff_hunk": "@@ -2661,6 +2662,13 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n \n         if (recipient.fSubtractFeeFromAmount)\n             nSubtractFeeFromAmount++;\n+\n+        // Check if any destination contains a witness program:\n+        int witnessversion = 0;\n+        std::vector<unsigned char> witnessprogram;\n+        if (recipient.scriptPubKey.IsWitnessProgram(witnessversion, witnessprogram)) {",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 16,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "6349a3005375066de984c1f359fb166fa1c82fad",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Really not sure what the point is here - we definitely should allowe sending to >v0 witness versions, its not our job to make sure someone giving us an address gives us something that is currently safe (ie has been forked to have some meaning), and we shouldn't need an update just to send to a newly-defined segwit version.",
    "created_at": "2018-01-14T18:25:14Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161405829",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161405829"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161405829"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161405829/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2669,
    "side": "RIGHT",
    "in_reply_to_id": 161261687
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161531689",
    "pull_request_review_id": 88835295,
    "id": 161531689,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MTUzMTY4OQ==",
    "diff_hunk": "@@ -2661,6 +2662,13 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n \n         if (recipient.fSubtractFeeFromAmount)\n             nSubtractFeeFromAmount++;\n+\n+        // Check if any destination contains a witness program:\n+        int witnessversion = 0;\n+        std::vector<unsigned char> witnessprogram;\n+        if (recipient.scriptPubKey.IsWitnessProgram(witnessversion, witnessprogram)) {\n+          any_destination_native_segwit = true;",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 17,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "de8ea9c68a69aa2c61abbe26d62e47c3b321fe78",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Fixed",
    "created_at": "2018-01-15T14:24:34Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161531689",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161531689"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161531689"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161531689/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2670,
    "side": "RIGHT",
    "in_reply_to_id": 161405681
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161533605",
    "pull_request_review_id": 88837550,
    "id": 161533605,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MTUzMzYwNQ==",
    "diff_hunk": "@@ -2661,6 +2662,13 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n \n         if (recipient.fSubtractFeeFromAmount)\n             nSubtractFeeFromAmount++;\n+\n+        // Check if any destination contains a witness program:\n+        int witnessversion = 0;\n+        std::vector<unsigned char> witnessprogram;\n+        if (recipient.scriptPubKey.IsWitnessProgram(witnessversion, witnessprogram)) {",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 16,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "6349a3005375066de984c1f359fb166fa1c82fad",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@TheBlueMatt Why are we having the wallet make v0 change outputs if the receiving address is v1+? Makes no sense to me.",
    "created_at": "2018-01-15T14:31:57Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161533605",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161533605"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161533605"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161533605/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2669,
    "side": "RIGHT",
    "in_reply_to_id": 161261687
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161570617",
    "pull_request_review_id": 88881306,
    "id": 161570617,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MTU3MDYxNw==",
    "diff_hunk": "@@ -2739,8 +2747,16 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n                     return false;\n                 }\n \n-                LearnRelatedScripts(vchPubKey, g_change_type);\n-                scriptChange = GetScriptForDestination(GetDestinationForKey(vchPubKey, g_change_type));\n+                // If -changetype is not specified and g_address_type is not legacy,\n+                // and any destination is (P2SH-)P2WPKH, use P2WPKH for the change\n+                // output.\n+                OutputType change_type = g_change_type;\n+                if (!gArgs.IsArgSet(\"-changetype\") && g_address_type != OUTPUT_TYPE_LEGACY && any_destination_native_segwit) {",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 32,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "2324577b76e45e2f67c786338a562a49fb436f45",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Suggestion: test g_address_type against OUTPUT_TYPE_DEFAULT, instead of touching `gArgs` here. \r\n\r\nIf that is not possible, please move the `gArgs.IsArgSet(\"-changetype\")` to `wallet/init.cpp` and set a global boolean `g_changetype_is_default` or such - don't spread the handling for one option over two separate places.",
    "created_at": "2018-01-15T16:49:58Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161570617",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161570617"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161570617"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161570617/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2754,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161660342",
    "pull_request_review_id": 88985053,
    "id": 161660342,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MTY2MDM0Mg==",
    "diff_hunk": "@@ -2661,6 +2662,13 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n \n         if (recipient.fSubtractFeeFromAmount)\n             nSubtractFeeFromAmount++;\n+\n+        // Check if any destination contains a witness program:\n+        int witnessversion = 0;\n+        std::vector<unsigned char> witnessprogram;\n+        if (recipient.scriptPubKey.IsWitnessProgram(witnessversion, witnessprogram)) {",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 16,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "6349a3005375066de984c1f359fb166fa1c82fad",
    "user": {
      "login": "gmaxwell",
      "id": 858454,
      "node_id": "MDQ6VXNlcjg1ODQ1NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/858454?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gmaxwell",
      "html_url": "https://github.com/gmaxwell",
      "followers_url": "https://api.github.com/users/gmaxwell/followers",
      "following_url": "https://api.github.com/users/gmaxwell/following{/other_user}",
      "gists_url": "https://api.github.com/users/gmaxwell/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gmaxwell/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gmaxwell/subscriptions",
      "organizations_url": "https://api.github.com/users/gmaxwell/orgs",
      "repos_url": "https://api.github.com/users/gmaxwell/repos",
      "events_url": "https://api.github.com/users/gmaxwell/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gmaxwell/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@instagibbs  since we don't support v1  there is no 'private' option possible for us,  so given that privacy is impossible, we should at least choose the most efficient!\r\n\r\nThe only reason we initially defaulted to do anything but produce native change is because under the assumption that most payments would be non-native that would be pretty bad for privacy.  But that privacy argument only holds when the decision results in us matching. \r\n\r\nPerhaps in the future if we support both v0 and v1 and have no particular reason to choose between them (e.g. they're both about equally efficient, and our wallet's policy doesn't demand one vs the other), we would just match whatever we're paying... but we can't do that now.",
    "created_at": "2018-01-16T04:50:05Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161660342",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161660342"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161660342"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161660342/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2669,
    "side": "RIGHT",
    "in_reply_to_id": 161261687
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161724493",
    "pull_request_review_id": 89057843,
    "id": 161724493,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MTcyNDQ5Mw==",
    "diff_hunk": "@@ -2739,8 +2747,16 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n                     return false;\n                 }\n \n-                LearnRelatedScripts(vchPubKey, g_change_type);\n-                scriptChange = GetScriptForDestination(GetDestinationForKey(vchPubKey, g_change_type));\n+                // If -changetype is not specified and g_address_type is not legacy,\n+                // and any destination is (P2SH-)P2WPKH, use P2WPKH for the change\n+                // output.\n+                OutputType change_type = g_change_type;\n+                if (!gArgs.IsArgSet(\"-changetype\") && g_address_type != OUTPUT_TYPE_LEGACY && any_destination_native_segwit) {",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 32,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "2324577b76e45e2f67c786338a562a49fb436f45",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`OUTPUT_TYPE_DEFAULT` is used for the help message and is defined as `OUTPUT_TYPE_P2SH_SEGWIT`. I'll try (something along the lines of) @luke-jr's 5efd54745. ",
    "created_at": "2018-01-16T11:03:19Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161724493",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161724493"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161724493"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161724493/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2754,
    "side": "RIGHT",
    "in_reply_to_id": 161570617
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161844931",
    "pull_request_review_id": 89199411,
    "id": 161844931,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MTg0NDkzMQ==",
    "diff_hunk": "@@ -2739,8 +2747,16 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n                     return false;\n                 }\n \n-                LearnRelatedScripts(vchPubKey, g_change_type);\n-                scriptChange = GetScriptForDestination(GetDestinationForKey(vchPubKey, g_change_type));\n+                // If -changetype is not specified and g_address_type is not legacy,\n+                // and any destination is (P2SH-)P2WPKH, use P2WPKH for the change",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 29,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "327634f97e5921815c30e50d076cde0f6ff51aaf",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "shouldn't this read:\r\n>// and any destination is P2WPKH, use P2WPKH for the change",
    "created_at": "2018-01-16T18:27:35Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161844931",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161844931"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161844931"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161844931/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2751,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161865943",
    "pull_request_review_id": 89224139,
    "id": 161865943,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MTg2NTk0Mw==",
    "diff_hunk": "@@ -2739,8 +2747,16 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n                     return false;\n                 }\n \n-                LearnRelatedScripts(vchPubKey, g_change_type);\n-                scriptChange = GetScriptForDestination(GetDestinationForKey(vchPubKey, g_change_type));\n+                // If -changetype is not specified and g_address_type is not legacy,\n+                // and any destination is (P2SH-)P2WPKH, use P2WPKH for the change",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 29,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "327634f97e5921815c30e50d076cde0f6ff51aaf",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Actually I meant P2WPKH or P2WSH. Fixed.",
    "created_at": "2018-01-16T19:42:34Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161865943",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161865943"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r161865943"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/161865943/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2751,
    "side": "RIGHT",
    "in_reply_to_id": 161844931
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162027651",
    "pull_request_review_id": 89412532,
    "id": 162027651,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MjAyNzY1MQ==",
    "diff_hunk": "@@ -643,8 +643,9 @@ void PaymentServer::fetchPaymentACK(CWallet* wallet, const SendCoinsRecipient& r\n         // use for change. Despite an actual payment and not change, this is a close match:\n         // it's the output type we use subject to privacy issues, but not restricted by what\n         // other software supports.\n-        wallet->LearnRelatedScripts(newKey, g_change_type);\n-        CTxDestination dest = GetDestinationForKey(newKey, g_change_type);\n+        OutputType change_type = g_change_type ? g_change_type : g_address_type;",
    "path": "src/qt/paymentserver.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "d2c2be7200307d1ed9b6291745b34d5db2c645a4",
    "user": {
      "login": "ajtowns",
      "id": 127186,
      "node_id": "MDQ6VXNlcjEyNzE4Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/127186?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ajtowns",
      "html_url": "https://github.com/ajtowns",
      "followers_url": "https://api.github.com/users/ajtowns/followers",
      "following_url": "https://api.github.com/users/ajtowns/following{/other_user}",
      "gists_url": "https://api.github.com/users/ajtowns/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ajtowns/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ajtowns/subscriptions",
      "organizations_url": "https://api.github.com/users/ajtowns/orgs",
      "repos_url": "https://api.github.com/users/ajtowns/repos",
      "events_url": "https://api.github.com/users/ajtowns/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ajtowns/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Shouldn't this compare explicitly? ie `change_type = g_change_type != OUTPUT_TYPE_NONE ? g_change_type : g_address_type`",
    "created_at": "2018-01-17T11:51:07Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162027651",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162027651"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162027651"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162027651/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 646,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162039648",
    "pull_request_review_id": 89426424,
    "id": 162039648,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MjAzOTY0OA==",
    "diff_hunk": "@@ -643,8 +643,9 @@ void PaymentServer::fetchPaymentACK(CWallet* wallet, const SendCoinsRecipient& r\n         // use for change. Despite an actual payment and not change, this is a close match:\n         // it's the output type we use subject to privacy issues, but not restricted by what\n         // other software supports.\n-        wallet->LearnRelatedScripts(newKey, g_change_type);\n-        CTxDestination dest = GetDestinationForKey(newKey, g_change_type);\n+        OutputType change_type = g_change_type ? g_change_type : g_address_type;",
    "path": "src/qt/paymentserver.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "d2c2be7200307d1ed9b6291745b34d5db2c645a4",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I wanted to keep it short for readability and leverage that OUTPUT_TYPE_NONE is 0. I can change that if you think it's unsafe.",
    "created_at": "2018-01-17T12:43:19Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162039648",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162039648"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162039648"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162039648/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 646,
    "side": "RIGHT",
    "in_reply_to_id": 162027651
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162059376",
    "pull_request_review_id": 89450958,
    "id": 162059376,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MjA1OTM3Ng==",
    "diff_hunk": "@@ -643,8 +643,9 @@ void PaymentServer::fetchPaymentACK(CWallet* wallet, const SendCoinsRecipient& r\n         // use for change. Despite an actual payment and not change, this is a close match:\n         // it's the output type we use subject to privacy issues, but not restricted by what\n         // other software supports.\n-        wallet->LearnRelatedScripts(newKey, g_change_type);\n-        CTxDestination dest = GetDestinationForKey(newKey, g_change_type);\n+        OutputType change_type = g_change_type ? g_change_type : g_address_type;",
    "path": "src/qt/paymentserver.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "d2c2be7200307d1ed9b6291745b34d5db2c645a4",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think it should be changed (in the future). The whole enum should be a c++11 enum class to be type safe. Though, that will touch all the code, so maybe too late for 0.16...",
    "created_at": "2018-01-17T14:08:45Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162059376",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162059376"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162059376"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162059376/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 646,
    "side": "RIGHT",
    "in_reply_to_id": 162027651
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162062952",
    "pull_request_review_id": 89455416,
    "id": 162062952,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MjA2Mjk1Mg==",
    "diff_hunk": "@@ -104,10 +112,32 @@ def test_address(self, node, address, multisig, typ):\n             # Unknown type\n             assert(False)\n \n+    def test_change_output_type(self, node_sender, destinations, expected_type):\n+        txid = self.nodes[node_sender].sendmany(\"\",  dict.fromkeys(destinations, 0.001))\n+        raw_tx = self.nodes[node_sender].getrawtransaction(txid)\n+        tx = self.nodes[node_sender].decoderawtransaction(raw_tx)\n+\n+        # Make sure the transaction has change:\n+        assert_equal(len(tx[\"vout\"]), len(destinations) + 1)\n+\n+        output_addresses = list(map(lambda vout: vout['scriptPubKey']['addresses'][0], tx[\"vout\"]))\n+\n+        # Make sure the destinations are included, and remove it:\n+        for destination in destinations:\n+            output_addresses.pop(output_addresses.index(destination))\n+\n+        assert_equal(len(output_addresses), 1)\n+",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 56,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "d2c2be7200307d1ed9b6291745b34d5db2c645a4",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "style-nit: heh, you are excessively using new lines in python code",
    "created_at": "2018-01-17T14:22:05Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162062952",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162062952"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162062952"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162062952/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 157,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162063432",
    "pull_request_review_id": 89455416,
    "id": 162063432,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MjA2MzQzMg==",
    "diff_hunk": "@@ -104,10 +112,32 @@ def test_address(self, node, address, multisig, typ):\n             # Unknown type\n             assert(False)\n \n+    def test_change_output_type(self, node_sender, destinations, expected_type):\n+        txid = self.nodes[node_sender].sendmany(\"\",  dict.fromkeys(destinations, 0.001))\n+        raw_tx = self.nodes[node_sender].getrawtransaction(txid)\n+        tx = self.nodes[node_sender].decoderawtransaction(raw_tx)\n+\n+        # Make sure the transaction has change:\n+        assert_equal(len(tx[\"vout\"]), len(destinations) + 1)\n+\n+        output_addresses = list(map(lambda vout: vout['scriptPubKey']['addresses'][0], tx[\"vout\"]))\n+\n+        # Make sure the destinations are included, and remove it:\n+        for destination in destinations:\n+            output_addresses.pop(output_addresses.index(destination))\n+\n+        assert_equal(len(output_addresses), 1)\n+\n+        change_address = output_addresses[0]\n+\n+        self.log.debug(\"Check if change address \" +  change_address + \" is \" + expected_type)\n+\n+        self.test_address(node_sender, change_address, False, expected_type)",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 61,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "d2c2be7200307d1ed9b6291745b34d5db2c645a4",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "style-nit: Should probably use named args, as it is not clear what \"False\" refers to.",
    "created_at": "2018-01-17T14:23:52Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162063432",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162063432"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162063432"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162063432/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 135,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162114601",
    "pull_request_review_id": 89515860,
    "id": 162114601,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MjExNDYwMQ==",
    "diff_hunk": "@@ -104,10 +112,32 @@ def test_address(self, node, address, multisig, typ):\n             # Unknown type\n             assert(False)\n \n+    def test_change_output_type(self, node_sender, destinations, expected_type):\n+        txid = self.nodes[node_sender].sendmany(\"\",  dict.fromkeys(destinations, 0.001))\n+        raw_tx = self.nodes[node_sender].getrawtransaction(txid)\n+        tx = self.nodes[node_sender].decoderawtransaction(raw_tx)\n+\n+        # Make sure the transaction has change:\n+        assert_equal(len(tx[\"vout\"]), len(destinations) + 1)\n+\n+        output_addresses = list(map(lambda vout: vout['scriptPubKey']['addresses'][0], tx[\"vout\"]))\n+\n+        # Make sure the destinations are included, and remove it:\n+        for destination in destinations:\n+            output_addresses.pop(output_addresses.index(destination))\n+\n+        assert_equal(len(output_addresses), 1)\n+\n+        change_address = output_addresses[0]\n+\n+        self.log.debug(\"Check if change address \" +  change_address + \" is \" + expected_type)\n+\n+        self.test_address(node_sender, change_address, False, expected_type)",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 61,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "d2c2be7200307d1ed9b6291745b34d5db2c645a4",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Fixed",
    "created_at": "2018-01-17T17:01:14Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162114601",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162114601"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162114601"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162114601/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 135,
    "side": "RIGHT",
    "in_reply_to_id": 162063432
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162114607",
    "pull_request_review_id": 89515868,
    "id": 162114607,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MjExNDYwNw==",
    "diff_hunk": "@@ -104,10 +112,32 @@ def test_address(self, node, address, multisig, typ):\n             # Unknown type\n             assert(False)\n \n+    def test_change_output_type(self, node_sender, destinations, expected_type):\n+        txid = self.nodes[node_sender].sendmany(\"\",  dict.fromkeys(destinations, 0.001))\n+        raw_tx = self.nodes[node_sender].getrawtransaction(txid)\n+        tx = self.nodes[node_sender].decoderawtransaction(raw_tx)\n+\n+        # Make sure the transaction has change:\n+        assert_equal(len(tx[\"vout\"]), len(destinations) + 1)\n+\n+        output_addresses = list(map(lambda vout: vout['scriptPubKey']['addresses'][0], tx[\"vout\"]))\n+\n+        # Make sure the destinations are included, and remove it:\n+        for destination in destinations:\n+            output_addresses.pop(output_addresses.index(destination))\n+\n+        assert_equal(len(output_addresses), 1)\n+",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 56,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "d2c2be7200307d1ed9b6291745b34d5db2c645a4",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Removed a few blank lines...",
    "created_at": "2018-01-17T17:01:16Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162114607",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162114607"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162114607"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162114607/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 157,
    "side": "RIGHT",
    "in_reply_to_id": 162062952
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162171610",
    "pull_request_review_id": 89217488,
    "id": 162171610,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MjE3MTYxMA==",
    "diff_hunk": "@@ -182,9 +182,11 @@ bool WalletParameterInteraction()\n         return InitError(strprintf(_(\"Unknown address type '%s'\"), gArgs.GetArg(\"-addresstype\", \"\")));\n     }\n \n-    g_change_type = ParseOutputType(gArgs.GetArg(\"-changetype\", \"\"), g_address_type);",
    "path": "src/wallet/init.cpp",
    "position": 13,
    "original_position": 4,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "b9f211c6d3a96fa003732a0a21d7d04ecf80501c",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Suggest writing this as:\r\n\r\n```c++\r\ng_change_type = ParseOutputType(gArgs.GetArg(\"-changetype\", \"\"), OUTPUT_TYPE_NONE);\r\nif (g_change_type == OUTPUT_TYPE_NONE && gArgs.IsArgSet(\"-changetype\")) {\r\n      return InitError(strprintf(_(\"Unknown change type '%s'\"), gArgs.GetArg(\"-changetype\", \"\")));\r\n}\r\n```\r\n\r\nReasons:\r\n\r\n- More consistent with `g_address_type` code above\r\n- Smaller diff, less code, less nesting\r\n- Doesn't leave `g_change_type` set to indeterminate value if `!IsArgSet`.\r\n\r\nYou may additionally want to replace `gArgs.IsArgSet(\"-changetype\")` with `!gArgs.GetArg(\"-changetype\", \"\").empty()`, so passing the empty string is the same as not passing a value, and will not trigger an error. This would be more consistent with addresstype parsing above, and might be practically useful, e.g. if somebody has an initial value set in a config file but wants to reset it on the command line.",
    "created_at": "2018-01-17T20:37:31Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162171610",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162171610"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162171610"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162171610/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 185,
    "original_line": 185,
    "side": "LEFT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162174440",
    "pull_request_review_id": 89217488,
    "id": 162174440,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MjE3NDQ0MA==",
    "diff_hunk": "@@ -256,9 +256,9 @@ UniValue getrawchangeaddress(const JSONRPCRequest& request)\n         pwallet->TopUpKeyPool();\n     }\n \n-    OutputType output_type = g_change_type;\n+    OutputType output_type = g_change_type ? g_change_type : g_address_type;\n     if (!request.params[0].isNull()) {\n-        output_type = ParseOutputType(request.params[0].get_str(), g_change_type);\n+        output_type = ParseOutputType(request.params[0].get_str(), OUTPUT_TYPE_NONE);",
    "path": "src/wallet/rpcwallet.cpp",
    "position": null,
    "original_position": 8,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "b9f211c6d3a96fa003732a0a21d7d04ecf80501c",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This is introducing an inconsistency between `getnewaddress` and `getrawchangeaddress`. Former will continue treating empty string like null, and latter will now treat the empty string as an error. Would suggest either passing `output_type` here to continue treating empty string like null both places, or passing `OUTPUT_TYPE_NONE` in `getnewaddress` to now raise an error both places.",
    "created_at": "2018-01-17T20:49:13Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162174440",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162174440"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162174440"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162174440/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 261,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162175280",
    "pull_request_review_id": 89217488,
    "id": 162175280,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MjE3NTI4MA==",
    "diff_hunk": "@@ -104,10 +109,28 @@ def test_address(self, node, address, multisig, typ):\n             # Unknown type\n             assert(False)\n \n+    def test_change_output_type(self, node_sender, destinations, expected_type):\n+        txid = self.nodes[node_sender].sendmany(\"\",  dict.fromkeys(destinations, 0.001))\n+        raw_tx = self.nodes[node_sender].getrawtransaction(txid)\n+        tx = self.nodes[node_sender].decoderawtransaction(raw_tx)\n+\n+        # Make sure the transaction has change:\n+        assert_equal(len(tx[\"vout\"]), len(destinations) + 1)\n+\n+        # Make sure the destinations are included, and remove them:\n+        output_addresses = list(map(lambda vout: vout['scriptPubKey']['addresses'][0], tx[\"vout\"]))",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 47,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "b9f211c6d3a96fa003732a0a21d7d04ecf80501c",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "May be easier to read as\r\n\r\n```\r\noutput_addresses = [vout['scriptPubKey']['addresses'][0] for vout in tx[\"vout\"]]\r\n```\r\n",
    "created_at": "2018-01-17T20:52:25Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162175280",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162175280"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162175280"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162175280/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 121,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162175368",
    "pull_request_review_id": 89217488,
    "id": 162175368,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MjE3NTM2OA==",
    "diff_hunk": "@@ -104,10 +109,28 @@ def test_address(self, node, address, multisig, typ):\n             # Unknown type\n             assert(False)\n \n+    def test_change_output_type(self, node_sender, destinations, expected_type):\n+        txid = self.nodes[node_sender].sendmany(\"\",  dict.fromkeys(destinations, 0.001))\n+        raw_tx = self.nodes[node_sender].getrawtransaction(txid)\n+        tx = self.nodes[node_sender].decoderawtransaction(raw_tx)\n+\n+        # Make sure the transaction has change:\n+        assert_equal(len(tx[\"vout\"]), len(destinations) + 1)\n+\n+        # Make sure the destinations are included, and remove them:\n+        output_addresses = list(map(lambda vout: vout['scriptPubKey']['addresses'][0], tx[\"vout\"]))\n+        for destination in destinations:\n+            output_addresses.pop(output_addresses.index(destination))",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 49,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "b9f211c6d3a96fa003732a0a21d7d04ecf80501c",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Could simplify to `output_addresses.remove(destination)`. Another alternative could be\r\n\r\n```python\r\nchange_addresses = [d for d in output_addresses if d not in destinations]\r\n```",
    "created_at": "2018-01-17T20:52:50Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162175368",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162175368"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162175368"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162175368/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 123,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162176966",
    "pull_request_review_id": 89217488,
    "id": 162176966,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MjE3Njk2Ng==",
    "diff_hunk": "@@ -2739,8 +2747,16 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n                     return false;\n                 }\n \n-                LearnRelatedScripts(vchPubKey, g_change_type);\n-                scriptChange = GetScriptForDestination(GetDestinationForKey(vchPubKey, g_change_type));\n+                // If -changetype is not specified and g_address_type is not legacy,\n+                // and any destination is P2WPKH or P2WSH, use P2WPKH for the change\n+                // output.\n+                OutputType change_type = g_change_type ? g_change_type : g_address_type;\n+                if (g_change_type == OUTPUT_TYPE_NONE && g_address_type != OUTPUT_TYPE_LEGACY && any_destination_native_segwit) {\n+                    change_type = OUTPUT_TYPE_BECH32;\n+                }",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 34,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "b9f211c6d3a96fa003732a0a21d7d04ecf80501c",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Just a suggestion, but perhaps this would be simpler as\r\n\r\n```c++\r\nOutputType change_type =\r\n    g_change_type != OUTPUT_TYPE_NONE ? g_change_type :\r\n    g_address_type != OUTPUT_TYPE_LEGACY && any_destination_native_segwit ? OUTPUT_TYPE_BECH32 :\r\n    g_address_type;\r\n```",
    "created_at": "2018-01-17T20:59:33Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162176966",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162176966"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162176966"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162176966/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2756,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162277984",
    "pull_request_review_id": 89705105,
    "id": 162277984,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MjI3Nzk4NA==",
    "diff_hunk": "@@ -182,9 +182,11 @@ bool WalletParameterInteraction()\n         return InitError(strprintf(_(\"Unknown address type '%s'\"), gArgs.GetArg(\"-addresstype\", \"\")));\n     }\n \n-    g_change_type = ParseOutputType(gArgs.GetArg(\"-changetype\", \"\"), g_address_type);",
    "path": "src/wallet/init.cpp",
    "position": 13,
    "original_position": 4,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "b9f211c6d3a96fa003732a0a21d7d04ecf80501c",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Being able to override config file seems quite useful, I'll try your suggestion.",
    "created_at": "2018-01-18T08:45:14Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162277984",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162277984"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162277984"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162277984/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 185,
    "original_line": 185,
    "side": "LEFT",
    "in_reply_to_id": 162171610
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162328431",
    "pull_request_review_id": 89765060,
    "id": 162328431,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MjMyODQzMQ==",
    "diff_hunk": "@@ -182,9 +182,11 @@ bool WalletParameterInteraction()\n         return InitError(strprintf(_(\"Unknown address type '%s'\"), gArgs.GetArg(\"-addresstype\", \"\")));\n     }\n \n-    g_change_type = ParseOutputType(gArgs.GetArg(\"-changetype\", \"\"), g_address_type);",
    "path": "src/wallet/init.cpp",
    "position": 13,
    "original_position": 4,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "b9f211c6d3a96fa003732a0a21d7d04ecf80501c",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@ryanofsky setting `changetype=...` in the config file makes `gArgs.IsArgSet(\"-changetype\"` evaluate to true. The config file value is ignored if a parameter overrides it. I still like your shorter notation, so using that now.\r\n",
    "created_at": "2018-01-18T12:33:36Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162328431",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162328431"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162328431"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162328431/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 185,
    "original_line": 185,
    "side": "LEFT",
    "in_reply_to_id": 162171610
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162328435",
    "pull_request_review_id": 89765067,
    "id": 162328435,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MjMyODQzNQ==",
    "diff_hunk": "@@ -256,9 +256,9 @@ UniValue getrawchangeaddress(const JSONRPCRequest& request)\n         pwallet->TopUpKeyPool();\n     }\n \n-    OutputType output_type = g_change_type;\n+    OutputType output_type = g_change_type ? g_change_type : g_address_type;\n     if (!request.params[0].isNull()) {\n-        output_type = ParseOutputType(request.params[0].get_str(), g_change_type);\n+        output_type = ParseOutputType(request.params[0].get_str(), OUTPUT_TYPE_NONE);",
    "path": "src/wallet/rpcwallet.cpp",
    "position": null,
    "original_position": 8,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "b9f211c6d3a96fa003732a0a21d7d04ecf80501c",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "There was a bug there: `OutputType output_type = g_change_type ? g_change_type : g_address_type` above is overridden in this line. I added some tests for `getrawchangeaddress`.",
    "created_at": "2018-01-18T12:33:38Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162328435",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162328435"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162328435"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162328435/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 261,
    "side": "RIGHT",
    "in_reply_to_id": 162174440
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162328443",
    "pull_request_review_id": 89765076,
    "id": 162328443,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MjMyODQ0Mw==",
    "diff_hunk": "@@ -2739,8 +2747,16 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n                     return false;\n                 }\n \n-                LearnRelatedScripts(vchPubKey, g_change_type);\n-                scriptChange = GetScriptForDestination(GetDestinationForKey(vchPubKey, g_change_type));\n+                // If -changetype is not specified and g_address_type is not legacy,\n+                // and any destination is P2WPKH or P2WSH, use P2WPKH for the change\n+                // output.\n+                OutputType change_type = g_change_type ? g_change_type : g_address_type;\n+                if (g_change_type == OUTPUT_TYPE_NONE && g_address_type != OUTPUT_TYPE_LEGACY && any_destination_native_segwit) {\n+                    change_type = OUTPUT_TYPE_BECH32;\n+                }",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 34,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "b9f211c6d3a96fa003732a0a21d7d04ecf80501c",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Nice! Done.",
    "created_at": "2018-01-18T12:33:41Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162328443",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162328443"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162328443"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162328443/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2756,
    "side": "RIGHT",
    "in_reply_to_id": 162176966
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162328448",
    "pull_request_review_id": 89765083,
    "id": 162328448,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MjMyODQ0OA==",
    "diff_hunk": "@@ -104,10 +109,28 @@ def test_address(self, node, address, multisig, typ):\n             # Unknown type\n             assert(False)\n \n+    def test_change_output_type(self, node_sender, destinations, expected_type):\n+        txid = self.nodes[node_sender].sendmany(\"\",  dict.fromkeys(destinations, 0.001))\n+        raw_tx = self.nodes[node_sender].getrawtransaction(txid)\n+        tx = self.nodes[node_sender].decoderawtransaction(raw_tx)\n+\n+        # Make sure the transaction has change:\n+        assert_equal(len(tx[\"vout\"]), len(destinations) + 1)\n+\n+        # Make sure the destinations are included, and remove them:\n+        output_addresses = list(map(lambda vout: vout['scriptPubKey']['addresses'][0], tx[\"vout\"]))",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 47,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "b9f211c6d3a96fa003732a0a21d7d04ecf80501c",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "It is, done.",
    "created_at": "2018-01-18T12:33:42Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162328448",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162328448"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162328448"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162328448/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 121,
    "side": "RIGHT",
    "in_reply_to_id": 162175280
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162328462",
    "pull_request_review_id": 89765096,
    "id": 162328462,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MjMyODQ2Mg==",
    "diff_hunk": "@@ -104,10 +109,28 @@ def test_address(self, node, address, multisig, typ):\n             # Unknown type\n             assert(False)\n \n+    def test_change_output_type(self, node_sender, destinations, expected_type):\n+        txid = self.nodes[node_sender].sendmany(\"\",  dict.fromkeys(destinations, 0.001))\n+        raw_tx = self.nodes[node_sender].getrawtransaction(txid)\n+        tx = self.nodes[node_sender].decoderawtransaction(raw_tx)\n+\n+        # Make sure the transaction has change:\n+        assert_equal(len(tx[\"vout\"]), len(destinations) + 1)\n+\n+        # Make sure the destinations are included, and remove them:\n+        output_addresses = list(map(lambda vout: vout['scriptPubKey']['addresses'][0], tx[\"vout\"]))\n+        for destination in destinations:\n+            output_addresses.pop(output_addresses.index(destination))",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 49,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "b9f211c6d3a96fa003732a0a21d7d04ecf80501c",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "That's what happens if you write javascript for a few years... :-)\r\n\r\nFixed",
    "created_at": "2018-01-18T12:33:44Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162328462",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162328462"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162328462"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162328462/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 123,
    "side": "RIGHT",
    "in_reply_to_id": 162175368
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162708605",
    "pull_request_review_id": 90216500,
    "id": 162708605,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MjcwODYwNQ==",
    "diff_hunk": "@@ -182,9 +182,11 @@ bool WalletParameterInteraction()\n         return InitError(strprintf(_(\"Unknown address type '%s'\"), gArgs.GetArg(\"-addresstype\", \"\")));\n     }\n \n-    g_change_type = ParseOutputType(gArgs.GetArg(\"-changetype\", \"\"), g_address_type);",
    "path": "src/wallet/init.cpp",
    "position": 13,
    "original_position": 4,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "b9f211c6d3a96fa003732a0a21d7d04ecf80501c",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162171610\r\n\r\n> @ryanofsky setting changetype=... in the config file makes gArgs.IsArgSet(\"-changetype\" evaluate to true\r\n\r\nYes, that's the reason I also suggested replacing `gArgs.IsArgSet(\"-changetype\")` with `!gArgs.GetArg(\"-changetype\", \"\").empty()`\r\n",
    "created_at": "2018-01-19T19:18:00Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162708605",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162708605"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162708605"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162708605/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 185,
    "original_line": 185,
    "side": "LEFT",
    "in_reply_to_id": 162171610
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162784075",
    "pull_request_review_id": 90305290,
    "id": 162784075,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2Mjc4NDA3NQ==",
    "diff_hunk": "@@ -643,8 +643,9 @@ void PaymentServer::fetchPaymentACK(CWallet* wallet, const SendCoinsRecipient& r\n         // use for change. Despite an actual payment and not change, this is a close match:\n         // it's the output type we use subject to privacy issues, but not restricted by what\n         // other software supports.\n-        wallet->LearnRelatedScripts(newKey, g_change_type);\n-        CTxDestination dest = GetDestinationForKey(newKey, g_change_type);\n+        OutputType change_type = g_change_type ? g_change_type : g_address_type;",
    "path": "src/qt/paymentserver.cpp",
    "position": null,
    "original_position": 6,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "d2c2be7200307d1ed9b6291745b34d5db2c645a4",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Agree with @ajtowns. Nit, `const OutputType ....`. Suggestion:\r\n```cpp\r\nconst OutputType change_type = g_change_type == OUTPUT_TYPE_NONE ? g_address_type : g_change_type;\r\n```",
    "created_at": "2018-01-20T14:38:59Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162784075",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162784075"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162784075"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162784075/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 646,
    "side": "RIGHT",
    "in_reply_to_id": 162027651
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162784617",
    "pull_request_review_id": 90305290,
    "id": 162784617,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2Mjc4NDYxNw==",
    "diff_hunk": "@@ -2661,6 +2662,13 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n \n         if (recipient.fSubtractFeeFromAmount)\n             nSubtractFeeFromAmount++;\n+\n+        // Check if any destination contains a witness program:\n+        int witnessversion = 0;\n+        std::vector<unsigned char> witnessprogram;\n+        if (recipient.scriptPubKey.IsWitnessProgram(witnessversion, witnessprogram)) {",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 16,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "6349a3005375066de984c1f359fb166fa1c82fad",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This can be avoided/skipped if there is a custom address in coin control. Move it below to where `any_destination_native_segwit` is needed.",
    "created_at": "2018-01-20T15:05:10Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162784617",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162784617"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162784617"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162784617/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2669,
    "side": "RIGHT",
    "in_reply_to_id": 161261687
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162784913",
    "pull_request_review_id": 90305290,
    "id": 162784913,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2Mjc4NDkxMw==",
    "diff_hunk": "@@ -2739,8 +2747,16 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n                     return false;\n                 }\n \n-                LearnRelatedScripts(vchPubKey, g_change_type);\n-                scriptChange = GetScriptForDestination(GetDestinationForKey(vchPubKey, g_change_type));\n+                // If -changetype is not specified and g_address_type is not legacy,\n+                // and any destination is P2WPKH or P2WSH, use P2WPKH for the change\n+                // output.\n+                OutputType change_type =\n+                    g_change_type != OUTPUT_TYPE_NONE ? g_change_type :\n+                    g_address_type != OUTPUT_TYPE_LEGACY && any_destination_native_segwit ? OUTPUT_TYPE_BECH32 :\n+                    g_address_type;\n+\n+                LearnRelatedScripts(vchPubKey, change_type);",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 36,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "0ee841a21aaea880e3af1e93b53d373295d1f829",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I know this was here before but shouldn't this be called by CReserveKey only if the key isn't returned to the pool?",
    "created_at": "2018-01-20T15:18:59Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162784913",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162784913"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162784913"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162784913/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2772,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162785050",
    "pull_request_review_id": 90305290,
    "id": 162785050,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2Mjc4NTA1MA==",
    "diff_hunk": "@@ -2739,8 +2747,16 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n                     return false;\n                 }\n \n-                LearnRelatedScripts(vchPubKey, g_change_type);\n-                scriptChange = GetScriptForDestination(GetDestinationForKey(vchPubKey, g_change_type));\n+                // If -changetype is not specified and g_address_type is not legacy,\n+                // and any destination is P2WPKH or P2WSH, use P2WPKH for the change\n+                // output.\n+                OutputType change_type =",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 31,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "0ee841a21aaea880e3af1e93b53d373295d1f829",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "IMO should avoid long expressions. Suggestion:\r\n```cpp\r\nOutputType change_type = g_change_type;\r\nif (change_type == OUTPUT_TYPE_NONE) {\r\n    if (any_destination_native_segwit && g_address_type != OUTPUT_TYPE_LEGAC) {\r\n        change_type = OUTPUT_TYPE_BECH32;\r\n    } else {\r\n        change_type = g_address_type;\r\n    }\r\n}\r\n```\r\n\r\nAlso, `CreateTransaction` is already a rather long function, could you factor out this to a new function? Then add tests for that in `src/wallet/test/wallet_tests.cpp`.",
    "created_at": "2018-01-20T15:23:26Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162785050",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162785050"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162785050"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162785050/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2753,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162971714",
    "pull_request_review_id": 90512782,
    "id": 162971714,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2Mjk3MTcxNA==",
    "diff_hunk": "@@ -182,9 +182,11 @@ bool WalletParameterInteraction()\n         return InitError(strprintf(_(\"Unknown address type '%s'\"), gArgs.GetArg(\"-addresstype\", \"\")));\n     }\n \n-    g_change_type = ParseOutputType(gArgs.GetArg(\"-changetype\", \"\"), g_address_type);",
    "path": "src/wallet/init.cpp",
    "position": 13,
    "original_position": 4,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "b9f211c6d3a96fa003732a0a21d7d04ecf80501c",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Oh wait, now I get it. So if the config file says `changetype=bech32` the user could unset it with `-changetype=`. Fixed.",
    "created_at": "2018-01-22T15:33:35Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162971714",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162971714"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162971714"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162971714/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 185,
    "original_line": 185,
    "side": "LEFT",
    "in_reply_to_id": 162171610
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162971760",
    "pull_request_review_id": 90512833,
    "id": 162971760,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2Mjk3MTc2MA==",
    "diff_hunk": "@@ -2739,8 +2747,16 @@ bool CWallet::CreateTransaction(const std::vector<CRecipient>& vecSend, CWalletT\n                     return false;\n                 }\n \n-                LearnRelatedScripts(vchPubKey, g_change_type);\n-                scriptChange = GetScriptForDestination(GetDestinationForKey(vchPubKey, g_change_type));\n+                // If -changetype is not specified and g_address_type is not legacy,\n+                // and any destination is P2WPKH or P2WSH, use P2WPKH for the change\n+                // output.\n+                OutputType change_type =",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 31,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "0ee841a21aaea880e3af1e93b53d373295d1f829",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Switched to your version.\r\n\r\nI extracted the change type stuff to a new function. I made a note to add tests later.",
    "created_at": "2018-01-22T15:33:42Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162971760",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162971760"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r162971760"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/162971760/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2753,
    "side": "RIGHT",
    "in_reply_to_id": 162785050
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163077600",
    "pull_request_review_id": 90637318,
    "id": 163077600,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzA3NzYwMA==",
    "diff_hunk": "@@ -2644,6 +2644,31 @@ bool CWallet::FundTransaction(CMutableTransaction& tx, CAmount& nFeeRet, int& nC\n     return true;\n }\n \n+OutputType CWallet::TransactionChangeType(const std::vector<CRecipient>& vecSend)\n+{\n+    // If -changetype is not specified and g_address_type is not legacy,\n+    // and any destination is P2WPKH or P2WSH, use P2WPKH for the change\n+    // output.\n+    bool any_destination_native_segwit = false;\n+    for (const auto& recipient : vecSend) {\n+        // Check if any destination contains a witness program:\n+        int witnessversion = 0;\n+        std::vector<unsigned char> witnessprogram;\n+        if (recipient.scriptPubKey.IsWitnessProgram(witnessversion, witnessprogram)) {\n+            any_destination_native_segwit = true;\n+        }",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 16,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Performance improvement:\r\n```cpp\r\n    any_destination_native_segwit = true;\r\n    break;\r\n```",
    "created_at": "2018-01-22T21:44:57Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163077600",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163077600"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163077600"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163077600/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2668,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163078828",
    "pull_request_review_id": 90637318,
    "id": 163078828,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzA3ODgyOA==",
    "diff_hunk": "@@ -2644,6 +2644,31 @@ bool CWallet::FundTransaction(CMutableTransaction& tx, CAmount& nFeeRet, int& nC\n     return true;\n }\n \n+OutputType CWallet::TransactionChangeType(const std::vector<CRecipient>& vecSend)",
    "path": "src/wallet/wallet.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Suggestions, for now, keep static and not a `CWallet` member:\r\n```cpp\r\nstatic OutputType GetChangeTypeForRecipients(const std::vector<CRecipient>& recipients)\r\n{\r\n```\r\nAnd below:\r\n```cpp\r\nconst OutputType change_type = GetChangeTypeForRecipients(vecSend);\r\n```\r\n*don't mind the function name.* ",
    "created_at": "2018-01-22T21:50:04Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163078828",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163078828"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163078828"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163078828/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2647,
    "original_line": 2647,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163263340",
    "pull_request_review_id": 90846570,
    "id": 163263340,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzI2MzM0MA==",
    "diff_hunk": "@@ -2644,6 +2644,31 @@ bool CWallet::FundTransaction(CMutableTransaction& tx, CAmount& nFeeRet, int& nC\n     return true;\n }\n \n+OutputType CWallet::TransactionChangeType(const std::vector<CRecipient>& vecSend)",
    "path": "src/wallet/wallet.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "What's the advantage of making it static? Especially if the longer term aim is to specify launch options for individual wallets (and presumably replace references to `g_change_type` with a `CWallet` member).",
    "created_at": "2018-01-23T14:44:40Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163263340",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163263340"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163263340"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163263340/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2647,
    "original_line": 2647,
    "side": "RIGHT",
    "in_reply_to_id": 163078828
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163268093",
    "pull_request_review_id": 90852345,
    "id": 163268093,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzI2ODA5Mw==",
    "diff_hunk": "@@ -2644,6 +2644,31 @@ bool CWallet::FundTransaction(CMutableTransaction& tx, CAmount& nFeeRet, int& nC\n     return true;\n }\n \n+OutputType CWallet::TransactionChangeType(const std::vector<CRecipient>& vecSend)\n+{\n+    // If -changetype is not specified and g_address_type is not legacy,\n+    // and any destination is P2WPKH or P2WSH, use P2WPKH for the change\n+    // output.\n+    bool any_destination_native_segwit = false;\n+    for (const auto& recipient : vecSend) {\n+        // Check if any destination contains a witness program:\n+        int witnessversion = 0;\n+        std::vector<unsigned char> witnessprogram;\n+        if (recipient.scriptPubKey.IsWitnessProgram(witnessversion, witnessprogram)) {\n+            any_destination_native_segwit = true;\n+        }",
    "path": "src/wallet/wallet.cpp",
    "position": null,
    "original_position": 16,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done",
    "created_at": "2018-01-23T14:59:02Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163268093",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163268093"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163268093"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163268093/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2668,
    "side": "RIGHT",
    "in_reply_to_id": 163077600
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163271465",
    "pull_request_review_id": 90856447,
    "id": 163271465,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzI3MTQ2NQ==",
    "diff_hunk": "@@ -2644,6 +2644,31 @@ bool CWallet::FundTransaction(CMutableTransaction& tx, CAmount& nFeeRet, int& nC\n     return true;\n }\n \n+OutputType CWallet::TransactionChangeType(const std::vector<CRecipient>& vecSend)",
    "path": "src/wallet/wallet.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I just think it's too soon to *expose* this in the `CWallet`. Feel free to leave as it is.",
    "created_at": "2018-01-23T15:09:21Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163271465",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163271465"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163271465"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163271465/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2647,
    "original_line": 2647,
    "side": "RIGHT",
    "in_reply_to_id": 163078828
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163282074",
    "pull_request_review_id": 90869057,
    "id": 163282074,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzI4MjA3NA==",
    "diff_hunk": "@@ -2644,6 +2644,31 @@ bool CWallet::FundTransaction(CMutableTransaction& tx, CAmount& nFeeRet, int& nC\n     return true;\n }\n \n+OutputType CWallet::TransactionChangeType(const std::vector<CRecipient>& vecSend)",
    "path": "src/wallet/wallet.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This is perhaps just personal taste, but I prefer early function return if we already know what change address we'll use without having to look at the outputs. That also means we can remove the local variables `any_destination_native_segwit` and `change_type`. It'd look something like:\r\n\r\n```\r\n    // If -changetype is specified, always use that change type.\r\n    if (g_change_type != OUTPUT_TYPE_NONE) {\r\n        return g_change_type;\r\n    }\r\n\r\n    // if g_address_type is legacy, use legacy address as change (even\r\n    // if some of the outputs are P2WPKH or P2WSH).\r\n    if (g_address_type == OUTPUT_TYPE_LEGACY) {\r\n        return OUTPUT_TYPE_LEGACY;\r\n    }\r\n\r\n    // if any destination is P2WPKH or P2WSH, use P2WPKH for the change\r\n    // output.\r\n    for (const auto& recipient : vecSend) {\r\n        // Check if any destination contains a witness program:\r\n        int witnessversion = 0;\r\n        std::vector<unsigned char> witnessprogram;\r\n        if (recipient.scriptPubKey.IsWitnessProgram(witnessversion, witnessprogram)) {\r\n            return OUTPUT_TYPE_BECH32;\r\n        }\r\n    }\r\n\r\n    // else use g_address_type for change\r\n    return g_address_type;\r\n```",
    "created_at": "2018-01-23T15:40:05Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163282074",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163282074"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163282074"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163282074/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2647,
    "original_line": 2647,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163282385",
    "pull_request_review_id": 90869057,
    "id": 163282385,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzI4MjM4NQ==",
    "diff_hunk": "@@ -10,7 +10,7 @@\n     - node2 uses p2sh/segwit addresses and bech32 addresses for change\n     - node3 uses bech32 addresses\n \n-node4 exists to generate new blocks.\n+node5 exists to generate new blocks.",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 5,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "please update the lines above to say there are 5 nodes under test, and describe what node4 is for.",
    "created_at": "2018-01-23T15:40:58Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163282385",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163282385"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163282385"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163282385/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 14,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163283684",
    "pull_request_review_id": 90869057,
    "id": 163283684,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzI4MzY4NA==",
    "diff_hunk": "@@ -104,10 +116,26 @@ def test_address(self, node, address, multisig, typ):\n             # Unknown type\n             assert(False)\n \n+    def test_change_output_type(self, node_sender, destinations, expected_type):\n+        txid = self.nodes[node_sender].sendmany(\"\",  dict.fromkeys(destinations, 0.001))\n+        raw_tx = self.nodes[node_sender].getrawtransaction(txid)\n+        tx = self.nodes[node_sender].decoderawtransaction(raw_tx)\n+\n+        # Make sure the transaction has change:\n+        assert_equal(len(tx[\"vout\"]), len(destinations) + 1)\n+\n+        # Make sure the destinations are included, and remove them:\n+        output_addresses = [vout['scriptPubKey']['addresses'][0] for vout in tx[\"vout\"]]\n+        change_addresses = [d for d in output_addresses if d not in destinations]\n+        assert_equal(len(change_addresses), 1)\n+\n+        self.log.debug(\"Check if change address \" +  change_addresses[0] + \" is \" + expected_type)\n+        self.test_address(node_sender, change_addresses[0], multisig=False, typ=expected_type)\n+\n     def run_test(self):\n         # Mine 101 blocks on node4 to bring nodes out of IBD and make sure that",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 65,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "update comment: `on node5`",
    "created_at": "2018-01-23T15:44:36Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163283684",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163283684"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163283684"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163283684/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 136,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163284201",
    "pull_request_review_id": 90869057,
    "id": 163284201,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzI4NDIwMQ==",
    "diff_hunk": "@@ -183,7 +211,7 @@ def run_test(self):\n                 assert_equal(unconf_balances[to_node], to_send * 10 * (2 + n))\n \n             # node4 collects fee and block subsidy to keep accounting simple",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 75,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "update comment",
    "created_at": "2018-01-23T15:46:08Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163284201",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163284201"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163284201"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163284201/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 213,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163287999",
    "pull_request_review_id": 90869057,
    "id": 163287999,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzI4Nzk5OQ==",
    "diff_hunk": "@@ -104,10 +116,26 @@ def test_address(self, node, address, multisig, typ):\n             # Unknown type\n             assert(False)\n \n+    def test_change_output_type(self, node_sender, destinations, expected_type):\n+        txid = self.nodes[node_sender].sendmany(\"\",  dict.fromkeys(destinations, 0.001))",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 49,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "unnecessary double space",
    "created_at": "2018-01-23T15:56:41Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163287999",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163287999"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163287999"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163287999/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 120,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163288051",
    "pull_request_review_id": 90869057,
    "id": 163288051,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzI4ODA1MQ==",
    "diff_hunk": "@@ -104,10 +116,26 @@ def test_address(self, node, address, multisig, typ):\n             # Unknown type\n             assert(False)\n \n+    def test_change_output_type(self, node_sender, destinations, expected_type):\n+        txid = self.nodes[node_sender].sendmany(\"\",  dict.fromkeys(destinations, 0.001))\n+        raw_tx = self.nodes[node_sender].getrawtransaction(txid)\n+        tx = self.nodes[node_sender].decoderawtransaction(raw_tx)\n+\n+        # Make sure the transaction has change:\n+        assert_equal(len(tx[\"vout\"]), len(destinations) + 1)\n+\n+        # Make sure the destinations are included, and remove them:\n+        output_addresses = [vout['scriptPubKey']['addresses'][0] for vout in tx[\"vout\"]]\n+        change_addresses = [d for d in output_addresses if d not in destinations]\n+        assert_equal(len(change_addresses), 1)\n+\n+        self.log.debug(\"Check if change address \" +  change_addresses[0] + \" is \" + expected_type)",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 61,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "unnecessary double space",
    "created_at": "2018-01-23T15:56:50Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163288051",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163288051"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163288051"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163288051/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 132,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163288383",
    "pull_request_review_id": 90869057,
    "id": 163288383,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzI4ODM4Mw==",
    "diff_hunk": "@@ -24,18 +24,30 @@\n multisig addresses. In a second iteration, the same is done, but with explicit address_type\n parameters passed to getnewaddress and getrawchangeaddress. Node0 and node3 send to p2sh,\n node 1 sends to bech32, and node2 sends to legacy. As every node sends coins after receiving,\n-this also verifies that spending coins sent to all these address types works.\"\"\"\n+this also verifies that spending coins sent to all these address types works.\n+\n+Test that node1 uses a bech32 addresses for change if any destination address is\n+bech32. Test that node0 always uses a legacy change address. Test that node4 uses\n+p2sh/segwit output for change.\n+\"\"\"",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 19,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think the whole docstring could be updated to reflect better what the test is actually doing:\r\n\r\n```\r\n\"\"\"Test that the wallet can send and receive using all combinations of address types.\r\n\r\nThere are 5 nodes-under-test:\r\n    - node0 uses legacy addresses\r\n    - node1 uses p2sh/segwit addresses\r\n    - node2 uses p2sh/segwit addresses and bech32 addresses for change\r\n    - node3 uses bech32 addresses\r\n    - node4 uses p2sh/segwit addresses for change\r\n\r\nnode5 exists to generate new blocks.\r\n\r\n## Multisig address test\r\n\r\nTest that adding a multisig address with:\r\n    - an uncompressed pubkey always gives a legacy address\r\n    - only compressed pubkeys gives the an `-addresstype` address\r\n\r\n## Sending to address types test\r\n\r\nA series of tests, iterating over node0-node4. In each iteration of the test, one node sends:\r\n    - 10/101th of its balance to itself (using getrawchangeaddress for single key addresses)\r\n    - 20/101th to the next node\r\n    - 30/101th to the node after that\r\n    - 40/101th to the remaining node\r\n    - 1/101th remains as fee+change\r\n\r\nIterate over each node for single key addresses, and then over each node for\r\nmultisig addresses.\r\n\r\nRepeat test, but with explicit address_type parameters passed to getnewaddress\r\nand getrawchangeaddress:\r\n    - node0 and node3 send to p2sh.\r\n    - node1 sends to bech32.\r\n    - node2 sends to legacy.\r\n\r\nAs every node sends coins after receiving, this also\r\nverifies that spending coins sent to all these address types works.\r\n\r\n## Change type test\r\n\r\nTest that the nodes generate the correct change address type:\r\n    - node0 always uses a legacy change address.\r\n    - node1 uses a bech32 addresses for change if any destination address is bech32.\r\n    - node4 always uses p2sh/segwit output for change.\r\n\"\"\"\r\n```",
    "created_at": "2018-01-23T15:57:46Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163288383",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163288383"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163288383"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163288383/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 51,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163292563",
    "pull_request_review_id": 90869057,
    "id": 163292563,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzI5MjU2Mw==",
    "diff_hunk": "@@ -195,5 +223,47 @@ def run_test(self):\n                 to_node %= 4\n                 assert_equal(new_balances[to_node], old_balances[to_node] + to_send * 10 * (2 + n))\n \n+        # Get one p2sh/segwit address from node2 and two bech32 addresses from node3:\n+        to_address_p2sh = self.nodes[2].getnewaddress()\n+        to_address_bech32_1 = self.nodes[3].getnewaddress()\n+        to_address_bech32_2 = self.nodes[3].getnewaddress()\n+\n+        # Fund node 4:\n+        self.nodes[5].sendtoaddress(self.nodes[4].getnewaddress(), Decimal(\"1\"))\n+        self.nodes[5].generate(1)\n+        sync_blocks(self.nodes)\n+        assert_equal(self.nodes[4].getbalance(), 1)\n+\n+        self.log.debug(\"Nodes with change_type=bech32 always use a P2WPKH change output:\")",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 96,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Suggest you make all of these logs `INFO` level",
    "created_at": "2018-01-23T16:09:18Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163292563",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163292563"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163292563"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163292563/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 237,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163292737",
    "pull_request_review_id": 90869057,
    "id": 163292737,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzI5MjczNw==",
    "diff_hunk": "@@ -104,10 +116,26 @@ def test_address(self, node, address, multisig, typ):\n             # Unknown type\n             assert(False)\n \n+    def test_change_output_type(self, node_sender, destinations, expected_type):\n+        txid = self.nodes[node_sender].sendmany(\"\",  dict.fromkeys(destinations, 0.001))",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 49,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "suggest you make these named arguments so it's clear what the `\"\"` is for.",
    "created_at": "2018-01-23T16:09:49Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163292737",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163292737"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163292737"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163292737/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 120,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163292876",
    "pull_request_review_id": 90869057,
    "id": 163292876,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzI5Mjg3Ng==",
    "diff_hunk": "@@ -24,18 +24,30 @@\n multisig addresses. In a second iteration, the same is done, but with explicit address_type\n parameters passed to getnewaddress and getrawchangeaddress. Node0 and node3 send to p2sh,\n node 1 sends to bech32, and node2 sends to legacy. As every node sends coins after receiving,\n-this also verifies that spending coins sent to all these address types works.\"\"\"\n+this also verifies that spending coins sent to all these address types works.\n+\n+Test that node1 uses a bech32 addresses for change if any destination address is\n+bech32. Test that node0 always uses a legacy change address. Test that node4 uses\n+p2sh/segwit output for change.\n+\"\"\"\n \n from decimal import Decimal\n import itertools\n \n from test_framework.test_framework import BitcoinTestFramework\n-from test_framework.util import assert_equal, assert_greater_than, connect_nodes_bi, sync_blocks, sync_mempools\n+from test_framework.util import (\n+    assert_equal,\n+    assert_greater_than,\n+    assert_raises_rpc_error,\n+    connect_nodes_bi,\n+    sync_blocks,\n+    sync_mempools,\n+)\n \n class AddressTypeTest(BitcoinTestFramework):\n     def set_test_params(self):\n-        self.num_nodes = 5\n-        self.extra_args = [[\"-addresstype=legacy\"], [\"-addresstype=p2sh-segwit\"], [\"-addresstype=p2sh-segwit\", \"-changetype=bech32\"], [\"-addresstype=bech32\"], []]\n+        self.num_nodes = 6\n+        self.extra_args = [[\"-addresstype=legacy\"], [\"-addresstype=p2sh-segwit\"], [\"-addresstype=p2sh-segwit\", \"-changetype=bech32\"], [\"-addresstype=bech32\"], [\"-changetype=p2sh-segwit\"], []]",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 40,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Perhaps clearer as:\r\n\r\n```\r\n        self.extra_args = [[\"-addresstype=legacy\"],                             # node0\r\n                           [\"-addresstype=p2sh-segwit\"],                        # node1\r\n                           [\"-addresstype=p2sh-segwit\", \"-changetype=bech32\"],  # node2\r\n                           [\"-addresstype=bech32\"],                             # node3\r\n                           [\"-changetype=p2sh-segwit\"],                         # node4\r\n                           []]                                                  # node5\r\n```",
    "created_at": "2018-01-23T16:10:17Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163292876",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163292876"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163292876"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163292876/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 50,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163294136",
    "pull_request_review_id": 90869057,
    "id": 163294136,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzI5NDEzNg==",
    "diff_hunk": "@@ -195,5 +223,47 @@ def run_test(self):\n                 to_node %= 4\n                 assert_equal(new_balances[to_node], old_balances[to_node] + to_send * 10 * (2 + n))\n \n+        # Get one p2sh/segwit address from node2 and two bech32 addresses from node3:\n+        to_address_p2sh = self.nodes[2].getnewaddress()\n+        to_address_bech32_1 = self.nodes[3].getnewaddress()\n+        to_address_bech32_2 = self.nodes[3].getnewaddress()\n+\n+        # Fund node 4:\n+        self.nodes[5].sendtoaddress(self.nodes[4].getnewaddress(), Decimal(\"1\"))\n+        self.nodes[5].generate(1)\n+        sync_blocks(self.nodes)\n+        assert_equal(self.nodes[4].getbalance(), 1)\n+\n+        self.log.debug(\"Nodes with change_type=bech32 always use a P2WPKH change output:\")\n+        self.test_change_output_type(2, [to_address_bech32_1], 'bech32')\n+        self.test_change_output_type(2, [to_address_p2sh], 'bech32')\n+\n+        self.log.debug(\"Nodes with addresstype=bech32 always use a P2WPKH change output (unless changetype is set otherwise):\")\n+        self.test_change_output_type(3, [to_address_bech32_1], 'bech32')\n+        self.test_change_output_type(3, [to_address_p2sh], 'bech32')\n+\n+        self.log.debug('getrawchangeaddress defaults to addresstype if -changetype is not set and argument is absent')\n+        self.test_address(3, self.nodes[3].getrawchangeaddress(), multisig=False, typ='bech32')\n+\n+        self.log.debug('getrawchangeaddress fails with invalid changetype argument')\n+        assert_raises_rpc_error(-5, \"Unknown address type 'bech23'\", self.nodes[3].getrawchangeaddress, 'bech23')\n+\n+        self.log.debug(\"Nodes with addresstype=p2sh-segwit only use a P2WPKH change output \" +\n+                       \"if any destination address is bech32:\")",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 111,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think it's fine to join these lines",
    "created_at": "2018-01-23T16:14:00Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163294136",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163294136"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163294136"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163294136/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 252,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306253",
    "pull_request_review_id": 90898006,
    "id": 163306253,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzMwNjI1Mw==",
    "diff_hunk": "@@ -2644,6 +2644,31 @@ bool CWallet::FundTransaction(CMutableTransaction& tx, CAmount& nFeeRet, int& nC\n     return true;\n }\n \n+OutputType CWallet::TransactionChangeType(const std::vector<CRecipient>& vecSend)",
    "path": "src/wallet/wallet.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I find your version more readable as well, so switched to that.",
    "created_at": "2018-01-23T16:49:32Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163306253",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306253"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163306253"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306253/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2647,
    "original_line": 2647,
    "side": "RIGHT",
    "in_reply_to_id": 163282074
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306282",
    "pull_request_review_id": 90898049,
    "id": 163306282,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzMwNjI4Mg==",
    "diff_hunk": "@@ -10,7 +10,7 @@\n     - node2 uses p2sh/segwit addresses and bech32 addresses for change\n     - node3 uses bech32 addresses\n \n-node4 exists to generate new blocks.\n+node5 exists to generate new blocks.",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 5,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Fixed.",
    "created_at": "2018-01-23T16:49:39Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163306282",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306282"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163306282"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306282/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 14,
    "side": "RIGHT",
    "in_reply_to_id": 163282385
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306313",
    "pull_request_review_id": 90898096,
    "id": 163306313,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzMwNjMxMw==",
    "diff_hunk": "@@ -24,18 +24,30 @@\n multisig addresses. In a second iteration, the same is done, but with explicit address_type\n parameters passed to getnewaddress and getrawchangeaddress. Node0 and node3 send to p2sh,\n node 1 sends to bech32, and node2 sends to legacy. As every node sends coins after receiving,\n-this also verifies that spending coins sent to all these address types works.\"\"\"\n+this also verifies that spending coins sent to all these address types works.\n+\n+Test that node1 uses a bech32 addresses for change if any destination address is\n+bech32. Test that node0 always uses a legacy change address. Test that node4 uses\n+p2sh/segwit output for change.\n+\"\"\"",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 19,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "That's much clearer, thanks. I also ordered the change address tests by node id added node 2 and 3 to the description. ",
    "created_at": "2018-01-23T16:49:45Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163306313",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306313"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163306313"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306313/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 51,
    "side": "RIGHT",
    "in_reply_to_id": 163288383
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306330",
    "pull_request_review_id": 90898117,
    "id": 163306330,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzMwNjMzMA==",
    "diff_hunk": "@@ -24,18 +24,30 @@\n multisig addresses. In a second iteration, the same is done, but with explicit address_type\n parameters passed to getnewaddress and getrawchangeaddress. Node0 and node3 send to p2sh,\n node 1 sends to bech32, and node2 sends to legacy. As every node sends coins after receiving,\n-this also verifies that spending coins sent to all these address types works.\"\"\"\n+this also verifies that spending coins sent to all these address types works.\n+\n+Test that node1 uses a bech32 addresses for change if any destination address is\n+bech32. Test that node0 always uses a legacy change address. Test that node4 uses\n+p2sh/segwit output for change.\n+\"\"\"\n \n from decimal import Decimal\n import itertools\n \n from test_framework.test_framework import BitcoinTestFramework\n-from test_framework.util import assert_equal, assert_greater_than, connect_nodes_bi, sync_blocks, sync_mempools\n+from test_framework.util import (\n+    assert_equal,\n+    assert_greater_than,\n+    assert_raises_rpc_error,\n+    connect_nodes_bi,\n+    sync_blocks,\n+    sync_mempools,\n+)\n \n class AddressTypeTest(BitcoinTestFramework):\n     def set_test_params(self):\n-        self.num_nodes = 5\n-        self.extra_args = [[\"-addresstype=legacy\"], [\"-addresstype=p2sh-segwit\"], [\"-addresstype=p2sh-segwit\", \"-changetype=bech32\"], [\"-addresstype=bech32\"], []]\n+        self.num_nodes = 6\n+        self.extra_args = [[\"-addresstype=legacy\"], [\"-addresstype=p2sh-segwit\"], [\"-addresstype=p2sh-segwit\", \"-changetype=bech32\"], [\"-addresstype=bech32\"], [\"-changetype=p2sh-segwit\"], []]",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 40,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Fixed",
    "created_at": "2018-01-23T16:49:49Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163306330",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306330"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163306330"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306330/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 50,
    "side": "RIGHT",
    "in_reply_to_id": 163292876
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306341",
    "pull_request_review_id": 90898132,
    "id": 163306341,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzMwNjM0MQ==",
    "diff_hunk": "@@ -104,10 +116,26 @@ def test_address(self, node, address, multisig, typ):\n             # Unknown type\n             assert(False)\n \n+    def test_change_output_type(self, node_sender, destinations, expected_type):\n+        txid = self.nodes[node_sender].sendmany(\"\",  dict.fromkeys(destinations, 0.001))",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 49,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Fixed",
    "created_at": "2018-01-23T16:49:51Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163306341",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306341"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163306341"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306341/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 120,
    "side": "RIGHT",
    "in_reply_to_id": 163287999
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306373",
    "pull_request_review_id": 90898168,
    "id": 163306373,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzMwNjM3Mw==",
    "diff_hunk": "@@ -104,10 +116,26 @@ def test_address(self, node, address, multisig, typ):\n             # Unknown type\n             assert(False)\n \n+    def test_change_output_type(self, node_sender, destinations, expected_type):\n+        txid = self.nodes[node_sender].sendmany(\"\",  dict.fromkeys(destinations, 0.001))",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 49,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done",
    "created_at": "2018-01-23T16:49:57Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163306373",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306373"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163306373"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306373/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 120,
    "side": "RIGHT",
    "in_reply_to_id": 163292737
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306388",
    "pull_request_review_id": 90898186,
    "id": 163306388,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzMwNjM4OA==",
    "diff_hunk": "@@ -104,10 +116,26 @@ def test_address(self, node, address, multisig, typ):\n             # Unknown type\n             assert(False)\n \n+    def test_change_output_type(self, node_sender, destinations, expected_type):\n+        txid = self.nodes[node_sender].sendmany(\"\",  dict.fromkeys(destinations, 0.001))\n+        raw_tx = self.nodes[node_sender].getrawtransaction(txid)\n+        tx = self.nodes[node_sender].decoderawtransaction(raw_tx)\n+\n+        # Make sure the transaction has change:\n+        assert_equal(len(tx[\"vout\"]), len(destinations) + 1)\n+\n+        # Make sure the destinations are included, and remove them:\n+        output_addresses = [vout['scriptPubKey']['addresses'][0] for vout in tx[\"vout\"]]\n+        change_addresses = [d for d in output_addresses if d not in destinations]\n+        assert_equal(len(change_addresses), 1)\n+\n+        self.log.debug(\"Check if change address \" +  change_addresses[0] + \" is \" + expected_type)",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 61,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Fixed",
    "created_at": "2018-01-23T16:49:59Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163306388",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306388"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163306388"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306388/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 132,
    "side": "RIGHT",
    "in_reply_to_id": 163288051
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306404",
    "pull_request_review_id": 90898206,
    "id": 163306404,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzMwNjQwNA==",
    "diff_hunk": "@@ -104,10 +116,26 @@ def test_address(self, node, address, multisig, typ):\n             # Unknown type\n             assert(False)\n \n+    def test_change_output_type(self, node_sender, destinations, expected_type):\n+        txid = self.nodes[node_sender].sendmany(\"\",  dict.fromkeys(destinations, 0.001))\n+        raw_tx = self.nodes[node_sender].getrawtransaction(txid)\n+        tx = self.nodes[node_sender].decoderawtransaction(raw_tx)\n+\n+        # Make sure the transaction has change:\n+        assert_equal(len(tx[\"vout\"]), len(destinations) + 1)\n+\n+        # Make sure the destinations are included, and remove them:\n+        output_addresses = [vout['scriptPubKey']['addresses'][0] for vout in tx[\"vout\"]]\n+        change_addresses = [d for d in output_addresses if d not in destinations]\n+        assert_equal(len(change_addresses), 1)\n+\n+        self.log.debug(\"Check if change address \" +  change_addresses[0] + \" is \" + expected_type)\n+        self.test_address(node_sender, change_addresses[0], multisig=False, typ=expected_type)\n+\n     def run_test(self):\n         # Mine 101 blocks on node4 to bring nodes out of IBD and make sure that",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 65,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Fixed",
    "created_at": "2018-01-23T16:50:02Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163306404",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306404"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163306404"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306404/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 136,
    "side": "RIGHT",
    "in_reply_to_id": 163283684
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306429",
    "pull_request_review_id": 90898238,
    "id": 163306429,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzMwNjQyOQ==",
    "diff_hunk": "@@ -183,7 +211,7 @@ def run_test(self):\n                 assert_equal(unconf_balances[to_node], to_send * 10 * (2 + n))\n \n             # node4 collects fee and block subsidy to keep accounting simple",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 75,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Fixed",
    "created_at": "2018-01-23T16:50:05Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163306429",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306429"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163306429"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306429/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 213,
    "side": "RIGHT",
    "in_reply_to_id": 163284201
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306459",
    "pull_request_review_id": 90898270,
    "id": 163306459,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzMwNjQ1OQ==",
    "diff_hunk": "@@ -195,5 +223,47 @@ def run_test(self):\n                 to_node %= 4\n                 assert_equal(new_balances[to_node], old_balances[to_node] + to_send * 10 * (2 + n))\n \n+        # Get one p2sh/segwit address from node2 and two bech32 addresses from node3:\n+        to_address_p2sh = self.nodes[2].getnewaddress()\n+        to_address_bech32_1 = self.nodes[3].getnewaddress()\n+        to_address_bech32_2 = self.nodes[3].getnewaddress()\n+\n+        # Fund node 4:\n+        self.nodes[5].sendtoaddress(self.nodes[4].getnewaddress(), Decimal(\"1\"))\n+        self.nodes[5].generate(1)\n+        sync_blocks(self.nodes)\n+        assert_equal(self.nodes[4].getbalance(), 1)\n+\n+        self.log.debug(\"Nodes with change_type=bech32 always use a P2WPKH change output:\")",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 96,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done",
    "created_at": "2018-01-23T16:50:10Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163306459",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306459"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163306459"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306459/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 237,
    "side": "RIGHT",
    "in_reply_to_id": 163292563
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306473",
    "pull_request_review_id": 90898289,
    "id": 163306473,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzMwNjQ3Mw==",
    "diff_hunk": "@@ -195,5 +223,47 @@ def run_test(self):\n                 to_node %= 4\n                 assert_equal(new_balances[to_node], old_balances[to_node] + to_send * 10 * (2 + n))\n \n+        # Get one p2sh/segwit address from node2 and two bech32 addresses from node3:\n+        to_address_p2sh = self.nodes[2].getnewaddress()\n+        to_address_bech32_1 = self.nodes[3].getnewaddress()\n+        to_address_bech32_2 = self.nodes[3].getnewaddress()\n+\n+        # Fund node 4:\n+        self.nodes[5].sendtoaddress(self.nodes[4].getnewaddress(), Decimal(\"1\"))\n+        self.nodes[5].generate(1)\n+        sync_blocks(self.nodes)\n+        assert_equal(self.nodes[4].getbalance(), 1)\n+\n+        self.log.debug(\"Nodes with change_type=bech32 always use a P2WPKH change output:\")\n+        self.test_change_output_type(2, [to_address_bech32_1], 'bech32')\n+        self.test_change_output_type(2, [to_address_p2sh], 'bech32')\n+\n+        self.log.debug(\"Nodes with addresstype=bech32 always use a P2WPKH change output (unless changetype is set otherwise):\")\n+        self.test_change_output_type(3, [to_address_bech32_1], 'bech32')\n+        self.test_change_output_type(3, [to_address_p2sh], 'bech32')\n+\n+        self.log.debug('getrawchangeaddress defaults to addresstype if -changetype is not set and argument is absent')\n+        self.test_address(3, self.nodes[3].getrawchangeaddress(), multisig=False, typ='bech32')\n+\n+        self.log.debug('getrawchangeaddress fails with invalid changetype argument')\n+        assert_raises_rpc_error(-5, \"Unknown address type 'bech23'\", self.nodes[3].getrawchangeaddress, 'bech23')\n+\n+        self.log.debug(\"Nodes with addresstype=p2sh-segwit only use a P2WPKH change output \" +\n+                       \"if any destination address is bech32:\")",
    "path": "test/functional/address_types.py",
    "position": null,
    "original_position": 111,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done",
    "created_at": "2018-01-23T16:50:13Z",
    "updated_at": "2018-01-23T16:56:32Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163306473",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306473"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163306473"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163306473/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 252,
    "side": "RIGHT",
    "in_reply_to_id": 163294136
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163334775",
    "pull_request_review_id": 90932095,
    "id": 163334775,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzMzNDc3NQ==",
    "diff_hunk": "@@ -2644,6 +2644,34 @@ bool CWallet::FundTransaction(CMutableTransaction& tx, CAmount& nFeeRet, int& nC\n     return true;\n }\n \n+OutputType CWallet::TransactionChangeType(const std::vector<CRecipient>& vecSend)",
    "path": "src/wallet/wallet.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`TransactionChangeType()` doesn't really need to be a class member function on `CWallet`, and could be a utility function in walletutil.cpp. In general, it'd be nice to start making the wallet class and wallet.cpp a bit smaller, but that's probably a tidy-up for another day.",
    "created_at": "2018-01-23T18:31:15Z",
    "updated_at": "2018-01-23T18:31:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163334775",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163334775"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163334775"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163334775/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2647,
    "original_line": 2647,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163345596",
    "pull_request_review_id": 90944498,
    "id": 163345596,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzM0NTU5Ng==",
    "diff_hunk": "@@ -2644,6 +2644,31 @@ bool CWallet::FundTransaction(CMutableTransaction& tx, CAmount& nFeeRet, int& nC\n     return true;\n }\n \n+OutputType CWallet::TransactionChangeType(const std::vector<CRecipient>& vecSend)",
    "path": "src/wallet/wallet.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "629fa755b821add57ed81818a1d42acf6dc8f2d4",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "cc @jnewbery given your last comment. I'll leave it as is, but useful to know what the future direction shouldl be.",
    "created_at": "2018-01-23T19:08:43Z",
    "updated_at": "2018-01-23T19:08:43Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163345596",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163345596"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163345596"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163345596/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2647,
    "original_line": 2647,
    "side": "RIGHT",
    "in_reply_to_id": 163078828
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163347383",
    "pull_request_review_id": 90946620,
    "id": 163347383,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzM0NzM4Mw==",
    "diff_hunk": "@@ -2644,6 +2644,34 @@ bool CWallet::FundTransaction(CMutableTransaction& tx, CAmount& nFeeRet, int& nC\n     return true;\n }\n \n+OutputType CWallet::TransactionChangeType(const std::vector<CRecipient>& vecSend)",
    "path": "src/wallet/wallet.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "+1",
    "created_at": "2018-01-23T19:14:58Z",
    "updated_at": "2018-01-23T19:14:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163347383",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163347383"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163347383"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163347383/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2647,
    "original_line": 2647,
    "side": "RIGHT",
    "in_reply_to_id": 163334775
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163560224",
    "pull_request_review_id": 91190992,
    "id": 163560224,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzU2MDIyNA==",
    "diff_hunk": "@@ -2644,6 +2644,34 @@ bool CWallet::FundTransaction(CMutableTransaction& tx, CAmount& nFeeRet, int& nC\n     return true;\n }\n \n+OutputType CWallet::TransactionChangeType(const std::vector<CRecipient>& vecSend)",
    "path": "src/wallet/wallet.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Agree, this should be moved at some point.",
    "created_at": "2018-01-24T14:23:18Z",
    "updated_at": "2018-01-24T14:23:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163560224",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163560224"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163560224"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163560224/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2647,
    "original_line": 2647,
    "side": "RIGHT",
    "in_reply_to_id": 163334775
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163582303",
    "pull_request_review_id": 91217672,
    "id": 163582303,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzU4MjMwMw==",
    "diff_hunk": "@@ -2644,6 +2644,34 @@ bool CWallet::FundTransaction(CMutableTransaction& tx, CAmount& nFeeRet, int& nC\n     return true;\n }\n \n+OutputType CWallet::TransactionChangeType(const std::vector<CRecipient>& vecSend)\n+{\n+    // If -changetype is specified, always use that change type.\n+    if (g_change_type != OUTPUT_TYPE_NONE) {",
    "path": "src/wallet/wallet.cpp",
    "position": 7,
    "original_position": 7,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "user": {
      "login": "ryanofsky",
      "id": 7133040,
      "node_id": "MDQ6VXNlcjcxMzMwNDA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7133040?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/ryanofsky",
      "html_url": "https://github.com/ryanofsky",
      "followers_url": "https://api.github.com/users/ryanofsky/followers",
      "following_url": "https://api.github.com/users/ryanofsky/following{/other_user}",
      "gists_url": "https://api.github.com/users/ryanofsky/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/ryanofsky/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/ryanofsky/subscriptions",
      "organizations_url": "https://api.github.com/users/ryanofsky/orgs",
      "repos_url": "https://api.github.com/users/ryanofsky/repos",
      "events_url": "https://api.github.com/users/ryanofsky/events{/privacy}",
      "received_events_url": "https://api.github.com/users/ryanofsky/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "For the future, it might be a good idea add `change_type` and `address_type` fields to CoinControl class, and have this method accept a CoinControl argument, instead of relying on the globals. This would make it easier to ensure that when an RPC is being called that has address type options, that they will take precedence over the globals.\r\n\r\nPieter's suggestion of adding a separate `P2SH_SEGWIT_BUT_NATIVE_WHEN_NATIVE_DESTINATION` enum value instead of assigning multiple meanings to `OUTPUT_TYPE_NONE` is also a good idea https://github.com/bitcoin/bitcoin/pull/12119#issuecomment-357982763.\r\n\r\nOther cleanups are also possible. I think a nice refactoring PR that didn't change behavior could be submitted that:\r\n\r\n* Changed OutputType from enum to enum class.\r\n* Got rid of `DEFAULT` enum value and just set P2SH_SEGWIT as default during initialization.\r\n* Got rid of `NONE` enum value, replacing it with `PARSE_ERROR` and `P2SH_SEGWIT_BUT_NATIVE_WHEN_NATIVE_DESTINATION` (or something shorter like `MATCH_OTHER_OUTPUTS`).",
    "created_at": "2018-01-24T15:34:27Z",
    "updated_at": "2018-01-24T15:34:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163582303",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163582303"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163582303"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163582303/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2650,
    "original_line": 2650,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163583872",
    "pull_request_review_id": 91219534,
    "id": 163583872,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE2MzU4Mzg3Mg==",
    "diff_hunk": "@@ -2644,6 +2644,34 @@ bool CWallet::FundTransaction(CMutableTransaction& tx, CAmount& nFeeRet, int& nC\n     return true;\n }\n \n+OutputType CWallet::TransactionChangeType(const std::vector<CRecipient>& vecSend)\n+{\n+    // If -changetype is specified, always use that change type.\n+    if (g_change_type != OUTPUT_TYPE_NONE) {",
    "path": "src/wallet/wallet.cpp",
    "position": 7,
    "original_position": 7,
    "commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "original_commit_id": "596c44633fd03e76cc12f2fd37452e223ba43115",
    "user": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Nice wrap up @ryanofsky. In #12194 I'm adding change type to coin control, however I'm not passing coin control here.",
    "created_at": "2018-01-24T15:39:08Z",
    "updated_at": "2018-01-24T15:39:09Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163583872",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163583872"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/12119#discussion_r163583872"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/12119"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/163583872/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 2650,
    "original_line": 2650,
    "side": "RIGHT",
    "in_reply_to_id": 163582303
  }
]