DrahtBot,2020-01-08 23:22:35,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#14053](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/14053.html) (Add address-based index (attempt 4?) by mar",https://github.com/bitcoin/bitcoin/pull/17897#issuecomment-572306584,572306584,
jimpo,2020-01-10 00:52:19,"Thanks @promag, fixed.",https://github.com/bitcoin/bitcoin/pull/17897#issuecomment-572824104,572824104,
promag,2020-01-10 10:51:52,"Looks good now, this time I'll test.",https://github.com/bitcoin/bitcoin/pull/17897#issuecomment-572986822,572986822,
jimpo,2020-01-10 22:00:51,@promag I don't think so. Why?,https://github.com/bitcoin/bitcoin/pull/17897#issuecomment-573222171,573222171,
promag,2020-01-14 09:53:26,"Actually I think it's fine, I was missing the `!m_synced` check.\n\nI was seeing this order of events:\n - `Interrupt()` is called which asynchronously stops the loop in `ThreadSync()`\n - before `UnregisterValidationInterface` is called,  validation notifications can be delivered, which can't be handled.\n\nBut now I see the `m_synced` flag to guard against this case.\n\nAnyway, would be ",https://github.com/bitcoin/bitcoin/pull/17897#issuecomment-574093378,574093378,
paulyc,2020-01-21 05:27:38,"> Actually I think it's fine, I was missing the `!m_synced` check.\n> \n> I was seeing this order of events:\n> \n> * `Interrupt()` is called which asynchronously stops the loop in `ThreadSync()`\n> * before `UnregisterValidationInterface` is called,  validation notifications can be delivered, which can't be handled.\n> \n> But now I see the `m_synced` flag to guard against this case.\n> ",https://github.com/bitcoin/bitcoin/pull/17897#issuecomment-576523914,576523914,
promag,2020-01-21 14:40:48,"Thanks @paulyc, I have done that but didn't wait for that block count.",https://github.com/bitcoin/bitcoin/pull/17897#issuecomment-576711708,576711708,
fjahr,2020-01-22 00:09:37,"tested ACK 9dd58ca611f6f2b59c25d727a4e955333525d345\n\nTested as described by @paulyc. Also ran tests locally.",https://github.com/bitcoin/bitcoin/pull/17897#issuecomment-576946410,576946410,
kallewoof,2020-01-22 06:59:49,"Tested ACK 9dd58ca611f6f2b59c25d727a4e955333525d345\n\n<details>\n  <summary>master branch showing txindex sync begins at block 0 upon restart</summary>\n\n  ```\n$ ./bitcoind -txindex=1 -datadir=oij\n[...]\n2020-01-22T06:11:44Z Shutdown: In progress...\n2020-01-22T06:11:44Z net thread exit\n2020-01-22T06:11:44Z UpdateTip: new best=000000000000035010292db86f97a207d96a4106af108fcb016550de",https://github.com/bitcoin/bitcoin/pull/17897#issuecomment-577037170,577037170,
fanquake,2020-01-22 09:29:38,"Looks good. I've tested master (742f84d0de79fcaf17578f9c3376be248c3259bc) vs this PR (9dd58ca611f6f2b59c25d727a4e955333525d345) and am seeing the same fixed behaviour. Thanks @promag, @fjahr, @kallewoof and @paulyc for testing.\n\n#### master\n```bash\n2020-01-22T08:56:22Z UpdateTip: new best=0000000000002d533ff0e59ee25496b4f403d8ce7b4b7fcd9181dadad8f625b3 height=118827 version=0x00000001 log2",https://github.com/bitcoin/bitcoin/pull/17897#issuecomment-577090538,577090538,
fanquake,2020-01-22 10:27:55,This has been backported to the 0.19 branch in 9d980c1f7f6fd0eb686d3cc94ba4698547f151c2.,https://github.com/bitcoin/bitcoin/pull/17897#issuecomment-577115395,577115395,
promag,2020-01-09 15:56:19,"nit, a similar comment could be added in `BaseIndex::Stop`.",https://github.com/bitcoin/bitcoin/pull/17897#discussion_r364818758,364818758,src/init.cpp
jimpo,2020-01-09 16:36:17,"Good point, though I think a better solution is to just call `Commit` from inside `BaseIndex::Stop` because I don't see much of a downside and it puts less of a burden on the caller.",https://github.com/bitcoin/bitcoin/pull/17897#discussion_r364841208,364841208,src/init.cpp
