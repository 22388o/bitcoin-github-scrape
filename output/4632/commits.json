[
  {
    "sha": "3a56de7fc318a45a7096cd318e2f2d7f8124ce24",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozYTU2ZGU3ZmMzMThhNDVhNzA5NmNkMzE4ZTJmMmQ3ZjgxMjRjZTI0",
    "commit": {
      "author": {
        "name": "Jeff Garzik",
        "email": "jgarzik@bitpay.com",
        "date": "2014-08-18T20:50:39Z"
      },
      "committer": {
        "name": "Jeff Garzik",
        "email": "jgarzik@bitpay.com",
        "date": "2014-08-18T20:50:39Z"
      },
      "message": "addrman: Do not propagate obviously poor addresses onto the network",
      "tree": {
        "sha": "20c10f164c038a4d32f883ddfcecb7206fb55457",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/20c10f164c038a4d32f883ddfcecb7206fb55457"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3a56de7fc318a45a7096cd318e2f2d7f8124ce24",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3a56de7fc318a45a7096cd318e2f2d7f8124ce24",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/3a56de7fc318a45a7096cd318e2f2d7f8124ce24",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3a56de7fc318a45a7096cd318e2f2d7f8124ce24/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "a4f151f714d67da7850d94d44b824944d3f0d74d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a4f151f714d67da7850d94d44b824944d3f0d74d",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/a4f151f714d67da7850d94d44b824944d3f0d74d"
      }
    ],
    "stats": {
      "total": 14,
      "additions": 10,
      "deletions": 4
    },
    "files": [
      {
        "sha": "704766dbf85868926e302062fe8f2a1f07fb4cb7",
        "filename": "src/addrman.cpp",
        "status": "modified",
        "additions": 10,
        "deletions": 4,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/3a56de7fc318a45a7096cd318e2f2d7f8124ce24/src/addrman.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/3a56de7fc318a45a7096cd318e2f2d7f8124ce24/src/addrman.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/addrman.cpp?ref=3a56de7fc318a45a7096cd318e2f2d7f8124ce24",
        "patch": "@@ -492,17 +492,23 @@ int CAddrMan::Check_()\n \n void CAddrMan::GetAddr_(std::vector<CAddress> &vAddr)\n {\n-    int nNodes = ADDRMAN_GETADDR_MAX_PCT*vRandom.size()/100;\n+    unsigned int nNodes = ADDRMAN_GETADDR_MAX_PCT * vRandom.size() / 100;\n     if (nNodes > ADDRMAN_GETADDR_MAX)\n         nNodes = ADDRMAN_GETADDR_MAX;\n \n-    // perform a random shuffle over the first nNodes elements of vRandom (selecting from all)\n-    for (int n = 0; n<nNodes; n++)\n+    // gather a list of random nodes, skipping those of low quality\n+    for (unsigned int n = 0; n < vRandom.size(); n++)\n     {\n+        if (vAddr.size() >= nNodes)\n+            break;\n+\n         int nRndPos = GetRandInt(vRandom.size() - n) + n;\n         SwapRandom(n, nRndPos);\n         assert(mapInfo.count(vRandom[n]) == 1);\n-        vAddr.push_back(mapInfo[vRandom[n]]);\n+\n+        const CAddrInfo& ai = mapInfo[vRandom[n]];\n+        if (!ai.IsTerrible())\n+            vAddr.push_back(ai);\n     }\n }\n "
      }
    ]
  }
]