[
  {
    "sha": "984849bddca13f0bd3063ce0df2c065e12698ae1",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo5ODQ4NDliZGRjYTEzZjBiZDMwNjNjZTBkZjJjMDY1ZTEyNjk4YWUx",
    "commit": {
      "author": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2017-05-10T20:03:58Z"
      },
      "committer": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2017-05-10T20:03:58Z"
      },
      "message": "Make sure we disable NODE_BLOOM when pruning is enabled",
      "tree": {
        "sha": "25dfe8841d824459542500b1c7742de854af0799",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/25dfe8841d824459542500b1c7742de854af0799"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/984849bddca13f0bd3063ce0df2c065e12698ae1",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyhopCNzi8TB0xizeHrd2uwPHki0FAlkTckUACgkQHrd2uwPH\nki31NhAAjvQJUoulaLuTiHOfKyg0axDHSLTegTjuZpw0yeMBoN/CU78bn0vmzErk\nKwSzhOANcGLfe7jxyQqxyOfqyLC1Ex/hrz+efZo/GYQxS+6N4p6ziaDR6TuG2PtS\n1VG8RlUpZ8I+w7E8ZWAma3qh7lR1pfx8R889gAnIsoQcguiQZV/rpj9I58LPY7B3\nkdB+K/NdQt5qrBOc6ssEeifPs8x5n1bXI/G86IsLQ1XhGYFyvhWGMWm19Y6UXdI7\n1Vb9DxhXNSFPV5U6J8q0gAwzT/T+r65IDtwfx2zZxutrV2bobUMQrIZQ6g5GlmKj\n18mG9YXbr9aKwwZQ5GAWbcLeHfCVck5HjfsmNDI5Yxwyguc99X5rVyLNhug/y0+3\ncf0JA8xBFDLIXEj7HQEf/kPLBUwLND2UpSj2vNOKwyMt+9Gx7ZqxsJ3ha/YGZ6y1\nOSRLQnIH8kvgpR1FC2bADqvdevRHRsDjQdo08Vg00DASWPjV1dvYdHsTxAMOxGQ9\nnFJKLWI52AIfeI92cVw1xGSpV+dHJqjEj4R3TcHg0Bi+2wINMZO48gB0IuxNO/mn\nRc1+LST+fnKNeICcVQaPmJsT6EeehTYpZN8eyO4c3IGFaITeQNMY3gdi8CtaSqWx\nqvlJ688/izo7Xo4erV1qIdSLVA8nZ2swyfTA8bDFb7NB/Irg83Q=\n=reYR\n-----END PGP SIGNATURE-----",
        "payload": "tree 25dfe8841d824459542500b1c7742de854af0799\nparent a26280bc14158b6972297e06418c9ee1c5653743\nauthor Jonas Schnelli <dev@jonasschnelli.ch> 1494446638 +0200\ncommitter Jonas Schnelli <dev@jonasschnelli.ch> 1494446638 +0200\n\nMake sure we disable NODE_BLOOM when pruning is enabled\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/984849bddca13f0bd3063ce0df2c065e12698ae1",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/984849bddca13f0bd3063ce0df2c065e12698ae1",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/984849bddca13f0bd3063ce0df2c065e12698ae1/comments",
    "author": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "a26280bc14158b6972297e06418c9ee1c5653743",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a26280bc14158b6972297e06418c9ee1c5653743",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/a26280bc14158b6972297e06418c9ee1c5653743"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 1,
      "deletions": 1
    },
    "files": [
      {
        "sha": "ab674de7be8705ebfff4d81e02f50ccbefb8990d",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/984849bddca13f0bd3063ce0df2c065e12698ae1/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/984849bddca13f0bd3063ce0df2c065e12698ae1/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=984849bddca13f0bd3063ce0df2c065e12698ae1",
        "patch": "@@ -1579,7 +1579,7 @@ bool AppInitMain(boost::thread_group& threadGroup, CScheduler& scheduler)\n     // after any wallet rescanning has taken place.\n     if (fPruneMode) {\n         LogPrintf(\"Unsetting NODE_NETWORK on prune mode\\n\");\n-        nLocalServices = ServiceFlags(nLocalServices & ~NODE_NETWORK);\n+        nLocalServices = ServiceFlags(nLocalServices & ~NODE_NETWORK & ~NODE_BLOOM);\n         if (!fReindex) {\n             uiInterface.InitMessage(_(\"Pruning blockstore...\"));\n             PruneAndFlush();"
      }
    ]
  },
  {
    "sha": "b9b3a7577abcc4b5592a472b086023b7e3ddb398",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiOWIzYTc1NzdhYmNjNGI1NTkyYTQ3MmIwODYwMjNiN2UzZGRiMzk4",
    "commit": {
      "author": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2017-05-10T20:04:27Z"
      },
      "committer": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2017-05-10T20:07:31Z"
      },
      "message": "[QA] add service flags test (in conjunction with prune)",
      "tree": {
        "sha": "9819b292be8ff63f8e899d49f49adf0f1eef9ac2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9819b292be8ff63f8e899d49f49adf0f1eef9ac2"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b9b3a7577abcc4b5592a472b086023b7e3ddb398",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyhopCNzi8TB0xizeHrd2uwPHki0FAlkTcwMACgkQHrd2uwPH\nki0P/hAAgQHobGoJrbkyX1owUVMXiCgekVMjkzsKY63lDK5KJSsyS2OnaFGUO5UI\nhbw8EhBayiBzm42zHBhZVcBaSqDZD9F144psrWUYNslJNbGtds1KTl2p0h3LI4iz\nbA2aUYJ7b56o3YfDUvoW3rcR3h57i3s+h7NSZ1PLwHTnH5ddOcHdANhcIrpousww\nqWb3hXvAvmgHoWM6v5P27KA5eSKXT9n68yr995wYbuPZoXG12GPq1QtdoEOk8uBC\nETtjYHgShHL3tQRoiaiMcb1KRR70vEFAeTrsSCcW/Y9CBUveSUYK9lZYLK7TKl/L\nk8RXq56Hh7hYodRc8+CwuYeLSoxP771rtp4rviudnyKXkCdm28eF9jhOv70/w0bu\n1VA0DnDo2495cY4Oqh/IlCc4rbNJI3OvUg7DkAMr4+lssvlOCdiiz259y2DOPoSH\nVQZIWwC1S7XE0d0V+dkwqyRlZju/YBX9eaPZYQmTo3FDkwIF5f7Kh5trpqTby5GD\n63sHeFuJzz/blhy898wKZKTnskJ1glKrcn6FSrLsnWhcn1pkTuFMlE93DXJDgFPz\naF8CLuv2cn3o3ybe1GVq/21K0cDVI96S6onzl/Tsuhzhot/k+A+hYb5Tw1zrIUvJ\np+AxGgsJxxSY2VFDzwbz/uEhPkoEFRtLWQeH6ohG1UPTY48l79U=\n=bXYM\n-----END PGP SIGNATURE-----",
        "payload": "tree 9819b292be8ff63f8e899d49f49adf0f1eef9ac2\nparent 984849bddca13f0bd3063ce0df2c065e12698ae1\nauthor Jonas Schnelli <dev@jonasschnelli.ch> 1494446667 +0200\ncommitter Jonas Schnelli <dev@jonasschnelli.ch> 1494446851 +0200\n\n[QA] add service flags test (in conjunction with prune)\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b9b3a7577abcc4b5592a472b086023b7e3ddb398",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/b9b3a7577abcc4b5592a472b086023b7e3ddb398",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b9b3a7577abcc4b5592a472b086023b7e3ddb398/comments",
    "author": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "984849bddca13f0bd3063ce0df2c065e12698ae1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/984849bddca13f0bd3063ce0df2c065e12698ae1",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/984849bddca13f0bd3063ce0df2c065e12698ae1"
      }
    ],
    "stats": {
      "total": 39,
      "additions": 39,
      "deletions": 0
    },
    "files": [
      {
        "sha": "6115069e7005f4df20b4fc5679372b422e3a6d78",
        "filename": "test/functional/prune_service.py",
        "status": "added",
        "additions": 38,
        "deletions": 0,
        "changes": 38,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b9b3a7577abcc4b5592a472b086023b7e3ddb398/test/functional/prune_service.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b9b3a7577abcc4b5592a472b086023b7e3ddb398/test/functional/prune_service.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/prune_service.py?ref=b9b3a7577abcc4b5592a472b086023b7e3ddb398",
        "patch": "@@ -0,0 +1,38 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import *\n+from test_framework.mininode import (NetworkThread,\n+                                     NodeConn,\n+                                     NodeConnCB)\n+\n+class BaseNode(NodeConnCB):\n+    def on_version(self, conn, message):\n+        assert_equal(message.nServices, 8) # make sure NODE_BLOOM is disabled\n+        pass\n+        \n+class PruneServiceFlagsTest(BitcoinTestFramework):\n+    def __init__(self):\n+        super().__init__()\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+        self.extra_args = [['-prune=550']]\n+\n+    def setup_network(self):\n+        self.nodes = start_nodes(1, self.options.tmpdir, self.extra_args[:1])\n+\n+\n+    def run_test(self):\n+        # Connect to node0\n+        node0 = BaseNode()\n+        connections = []\n+        connections.append(NodeConn('127.0.0.1', p2p_port(0), self.nodes[0], node0))\n+        node0.add_connection(connections[0])\n+        NetworkThread().start() \n+        node0.wait_for_verack()\n+\n+\n+if __name__ == '__main__':\n+    PruneServiceFlagsTest().main()"
      },
      {
        "sha": "9fd185784dc4873db3de6da676b0f17e2cc85ffd",
        "filename": "test/functional/test_runner.py",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b9b3a7577abcc4b5592a472b086023b7e3ddb398/test/functional/test_runner.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b9b3a7577abcc4b5592a472b086023b7e3ddb398/test/functional/test_runner.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/test_runner.py?ref=b9b3a7577abcc4b5592a472b086023b7e3ddb398",
        "patch": "@@ -110,6 +110,7 @@\n     'rpcnamedargs.py',\n     'listsinceblock.py',\n     'p2p-leaktests.py',\n+    'prune_service.py',\n ]\n \n EXTENDED_SCRIPTS = ["
      }
    ]
  }
]