Saibato,2020-09-16 09:18:41,"Pls feel free to grab from  https://github.com/bitcoin/bitcoin/commit/654dc04b67a44199352a1b25494c9d617cd090bc\n\nThen I can strip this from #19358 and rename that and re push\nAs.\n**torcontrol :do not override with default proxy settings in hidden service, if the user has chosen otherwise according with the wording in the docs .**\n\nSince we until now notoriously in disrespect override th",https://github.com/bitcoin/bitcoin/pull/19961#issuecomment-693283192,693283192,
jonatack,2020-09-16 09:25:10,"@Saibato thanks, I'll look at testing and pulling in that commit. In any case I need to verify and improve this draft. @RiccardoMasutti thanks.",https://github.com/bitcoin/bitcoin/pull/19961#issuecomment-693286445,693286445,
vasild,2020-09-23 08:31:16,Maybe split the white-space changes in a separate commit to ease further reviewers.,https://github.com/bitcoin/bitcoin/pull/19961#issuecomment-697217279,697217279,
Willtech,2020-10-05 20:14:24,"> Few things that we can add in the updates:\n> \n> Examples to run Bitcoin as onion service, use of tor bridges and safe ways to connect over tor: #19923\n> \n> We can mention ""How to check onion address""? : #19924\n\nI have replied on each FR where it is appropriate.",https://github.com/bitcoin/bitcoin/pull/19961#issuecomment-703863711,703863711,
jonatack,2020-10-15 10:18:51,Thanks everyone for the feedback. There are quite a few updates to do to bring this doc up-to-date. Will bring it out of draft status soon.,https://github.com/bitcoin/bitcoin/pull/19961#issuecomment-709092743,709092743,
Rspigler,2020-12-14 21:53:28,"Thanks for taking this on! My concern is that the doc doesn't really help the most common end users.  \n\n> Connecting to Tor's control socket API requires one of two authentication methods to be configured. It also requires the control socket to be enabled, e.g. put ControlPort 9051 in torrc config file. For cookie authentication the user running bitcoind must have read access to the CookieAuth",https://github.com/bitcoin/bitcoin/pull/19961#issuecomment-744733984,744733984,
jonatack,2020-12-14 22:01:07,I have a number of updates written that I haven't yet pushed. My concern is that they are changing too much and will discourage review and not be merged. It's on my list to scale them down and push soon.,https://github.com/bitcoin/bitcoin/pull/19961#issuecomment-744737562,744737562,
prayank23,2020-12-14 22:02:41,"> I think our docs could do a much better job explaining to the layperson how to do so.\n\nAgree. I think adding screenshots and examples could help.\n",https://github.com/bitcoin/bitcoin/pull/19961#issuecomment-744738288,744738288,
jonatack,2020-12-14 22:05:26,"> I think our docs could do a much better job explaining to the layperson how to do so.\n\nI don't know if a tutorial for non-technical people is the kind of doc that should be in the source code repository, but it is indeed beyond the scope of what I planned to propose (which I'm scaling down to be reviewable).\n\n",https://github.com/bitcoin/bitcoin/pull/19961#issuecomment-744739694,744739694,
Rspigler,2020-12-14 22:10:49,@jonatack That makes sense.  Maybe that's something I'll work on updating for the BitcoinWiki after the recent tor/GUI changes get merged.,https://github.com/bitcoin/bitcoin/pull/19961#issuecomment-744742302,744742302,
jonatack,2020-12-16 15:19:29,"Updated. If everyone can review today, maybe this can still be in 0.21 as rc4 is being finalised. \n\nIt may be easiest to review each commit separately. Happy to drop the last commit if it's too much to review.",https://github.com/bitcoin/bitcoin/pull/19961#issuecomment-746460918,746460918,
jonatack,2020-12-16 15:21:50,"I also recommend viewing the diff by clicking on the ""Display the rich diff"" button at top right.",https://github.com/bitcoin/bitcoin/pull/19961#issuecomment-746464872,746464872,
Saibato,2020-12-16 16:47:02,"@jonatack \nfor some config and setup hints to add u could add,  u might want to look into\nhttps://github.com/ElementsProject/lightning/blob/master/doc/TOR.md\npls also note that the Torcontrol and onlynet bug fix PR;s are not merged in 0.21\nso maybe some hint her fro the user to be not surprised by unexpected behavior might be a good idea.\nref. https://github.com/bitcoin/bitcoin/commit/65",https://github.com/bitcoin/bitcoin/pull/19961#issuecomment-746614022,746614022,
jonatack,2020-12-16 22:04:42,"> for some config and setup hints to add u could add, u might want to look into\n> [https://github.com/ElementsProject/lightning/blob/master/doc/TOR.md](https://github.com/ElementsProject/lightning/blob/master/doc/TOR.md?rgh-link-date=2020-12-16T16%3A47%3A02Z)\n> pls also note that the Torcontrol and onlynet bug fix PR;s are not merged in 0.21\n> so maybe some hint her fro the user to be not su",https://github.com/bitcoin/bitcoin/pull/19961#issuecomment-747068625,747068625,
jonatack,2020-12-16 22:15:49,"> Thanks for taking this on! My concern is that the doc doesn't really help the most common end users.\n> \n> > Connecting to Tor's control socket API requires one of two authentication methods to be configured. It also requires the control socket to be enabled, e.g. put ControlPort 9051 in torrc config file. For cookie authentication the user running bitcoind must have read access to the Cookie",https://github.com/bitcoin/bitcoin/pull/19961#issuecomment-747073331,747073331,
jonatack,2020-12-16 23:28:23,"@Rspigler Great! Could you add a line to your comment, that says: `ACK 39858289583cc11fdcefbc8e8716ff09855049a7`\n\n(That's the official approval format; thanks!)",https://github.com/bitcoin/bitcoin/pull/19961#issuecomment-747102535,747102535,
jonatack,2020-12-17 10:07:51,"Dropped the last two commits to reduce the scope to have this merged in time for rc4. I think they were good but they can be proposed in another PR.\n\nCan everyone please ACK?",https://github.com/bitcoin/bitcoin/pull/19961#issuecomment-747341663,747341663,
laanwj,2020-12-17 10:39:38,ACK a34eceb4cc054b4233e7321de927e8a7a2146301,https://github.com/bitcoin/bitcoin/pull/19961#issuecomment-747358625,747358625,
vasild,2020-12-17 11:02:39,ACK a34eceb,https://github.com/bitcoin/bitcoin/pull/19961#issuecomment-747370132,747370132,
Rspigler,2020-12-17 18:48:40,Post-merge ACK a34eceb4cc054b4233e7321de927e8a7a2146301,https://github.com/bitcoin/bitcoin/pull/19961#issuecomment-747628106,747628106,
Willtech,2020-12-18 06:50:13,"FYI: There is a reviewed tutorial here for using Bitcoin Core with Tor that seems to have a permalink, albeit the tutorial deliberately steps over many things in Tor that a user could benefit from having a detailed explanation of, such as participation in the tor network, https://bitcoin.stackexchange.com/q/70069/75001",https://github.com/bitcoin/bitcoin/pull/19961#issuecomment-747905150,747905150,
hebasto,2020-09-22 19:26:28,"When a hidden service is created via tor-control, `/var/lib/tor/bitcoin-service/hostname` is not created (credits to @vasild).",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r492980674,492980674,doc/tor.md
vasild,2020-09-23 07:48:29,"But this new text reads:\n\n> Given the above configuration ...\n\nand just a few lines above it says how to configure the hidden service via `torrc`:\n\n> HiddenServiceDir /var/lib/tor/bitcoin-service/\n> HiddenServicePort 8333 127.0.0.1:8333\n> HiddenServicePort 18333 127.0.0.1:18333\n\nSo it is ok to mention `/var/lib/tor/bitcoin-service/hostname`.\n\nI would suggest to drop the las",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r493269587,493269587,doc/tor.md
hebasto,2020-09-23 08:36:08,Does `bitcoind` configure its onion service via `torrc`?,https://github.com/bitcoin/bitcoin/pull/19961#discussion_r493314813,493314813,doc/tor.md
vasild,2020-12-16 16:04:09,"nit: it is not proper to say ""since Prog1 version X, Prog2 does this..."". It should be ""Since Bitcoin Core version 1.2.3 we make use of..."".\n\nI guess it is ok to just drop ""Since Tor version 0.2.7.1, "".",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544420730,544420730,doc/tor.md
vasild,2020-12-16 16:10:05,Just suggest `chmod -R 777 .` - it always helps with filesystem permissions problems.,https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544425685,544425685,doc/tor.md
vasild,2020-12-16 16:16:19,"Hmm, https://tb-manual.torproject.org is the Tor _Browser_ manual. Would https://www.torproject.org/docs/tor-manual.html.en be more appropriate?",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544430807,544430807,doc/tor.md
Saibato,2020-12-16 16:41:27,"> Hmm, \n\nor\nhttps://2019.www.torproject.org/docs/tor-onion-service.html.en\n",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544450677,544450677,doc/tor.md
Saibato,2020-12-16 17:04:25,"suggstetion i.e from https://github.com/ElementsProject/lightning/blob/master/doc/TOR.md\n```\n---\nYou also need to make your user a member of the Tor group. ""Your user"" here is whatever user will run lightningd. On Debian-derived systems, the Tor group will most likely be debian-tor. You can try listing all groups with the below command, and check for a debian-tor or tor groupname.\n\ngeten",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544468451,544468451,doc/tor.md
Rspigler,2020-12-16 19:16:48,"""it can configured"" -> ""it can be configured""",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544557422,544557422,doc/tor.md
jonatack,2020-12-16 22:02:00,"good eye, fixed",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544654495,544654495,doc/tor.md
jonatack,2020-12-16 22:02:14,"thanks, done",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544654635,544654635,doc/tor.md
jonatack,2020-12-16 22:02:51,"rewrote the section based on this, thanks @Saibato ",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544654981,544654981,doc/tor.md
jonatack,2020-12-16 22:03:08,"dropped, thanks",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544655122,544655122,doc/tor.md
Rspigler,2020-12-16 23:36:47,"Does this mean `onlynet=ipv4` `onion=0` does not disable onion connections? This seems confusing.\n\n`-noonion` or `onion=0` is always needed to explicitly disable outbound onion access, as described in the `-proxy` and `onion` section?",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544700961,544700961,doc/tor.md
Rspigler,2020-12-16 23:40:36,"(I missed this last commit, glad you asked for the clarification.  I ACKd 42e61805734c36da7a11586aabc7fd5742dba267)",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544702444,544702444,doc/tor.md
Saibato,2020-12-17 08:50:46,"> Does this mean onlynet=ipv4 onion=0 does not disable onion connections? This seems confusing.\n\nYes and No , a default fallback outbound pure .onion not IP name resolving proxy just for onion address will be created by default even without -proxy definition  if  ̶o̶n̶i̶o̶n̶!̶=̶0̶ ̶ ̶ to be precise if -onion== """" and regardless of -onlynet= if -listenonion=1 ( default) if the inbound Tor onion",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544912964,544912964,doc/tor.md
vasild,2020-12-17 09:19:21,"What does it mean ""If SOCKS5 is selected""? How does one select SOCKS5 or what other options are there to select from?\n\nI think this should be removed:\n\n```suggestion\n      -proxy=ip:port  Set a proxy server. This proxy\n```\n\nas `-proxy=` only supports SOCKS5 proxies.",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544931629,544931629,doc/tor.md
Saibato,2020-12-17 09:23:01,"@jonatack  did edit the comment text to be more precise, so please review ur thumbs up ;-)",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544934156,544934156,doc/tor.md
vasild,2020-12-17 09:38:28,"Huh! :-( This is indeed a strange behavior, but I think something like the following belongs to `bitcoind -help` rather than `doc/tor.md`:\n\n> If -onlynet= is used with other networks and -onlynet=onion is not among them, but -onion= or -proxy is provided then outbound onion connections will still be made! Use -noonion or -onion=0 to disable outbound onion connections in this case.\n\nGiven t",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544944918,544944918,doc/tor.md
vasild,2020-12-17 09:51:56,"I think this is excessive and should be removed.\n\n* the ""sort"" in the getent command is unneeded and on my computer the entire thing prints:\n\n```\noperator\n_tor\nYou have new mail in /home/toolame/mailbox\n```\n\nso, if I am a dummy user, how do I know which is the tor group?\n\n* stat gives me error:\n```\n$ stat -c '%G' /run/tor/control.authcookie\nstat: illegal option -- c\",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544954251,544954251,doc/tor.md
jonatack,2020-12-17 09:58:28,"I can drop this, but it was existing before this PR.",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544958678,544958678,doc/tor.md
jonatack,2020-12-17 10:00:20,Are you using a Debian-based system?,https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544960062,544960062,doc/tor.md
jonatack,2020-12-17 10:03:12,Dropped the commit.,https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544962033,544962033,doc/tor.md
jonatack,2020-12-17 10:03:36,Dropped the commit completely.,https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544962252,544962252,doc/tor.md
jonatack,2020-12-17 10:03:50,Dropping this commit.,https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544962396,544962396,doc/tor.md
jonatack,2020-12-17 10:04:04,Dropping this commit.,https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544962545,544962545,doc/tor.md
Saibato,2020-12-17 10:40:19,"@jonatack  i am almost certain there will be an rc5 and some backport's ping @luke-jr, so no time to rush here and have another release that is not precise in what the options and Tor-controller does.\n\nDo u need a detailed descriiption and  log to show the real behavior?   ",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r544986571,544986571,doc/tor.md
Saibato,2020-12-17 11:21:17,"@Rspigler tyi, only explicit -nonion or -onion=0 can prevent outbound onion connections, solely -onllynet=pv4/ipv6 is not sufficient to disable that.\n\nthat what is said in the PR now dropped.\n\n```\nPlease use -noonion or -onion=0 if you want to be sure to have no\noutbound onion connections over the default proxy or your defined proxy..\n```\n\nhttps://github.com/bitcoin/bitcoin/commi",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r545012903,545012903,doc/tor.md
jonatack,2020-12-17 11:35:34,"@Saibato I might propose the dropped commits, including yours, in a new PR and make some of the changes suggested by @vasild.",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r545021632,545021632,doc/tor.md
Saibato,2020-12-17 12:26:59,"@vasild \n> -onlynet=onion  Make outgoing connections only to .onion addresses. Incoming\n        connections are not affected by this option.\n\nI guess its hard to grasp and i was :woman_facepalming:  too when i stumbled about, but what we believed the code does from src comments or doc and almost any post i am aware about bitcoin and Tor and social media is\nnot what really happens when as",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r545051534,545051534,doc/tor.md
Rspigler,2020-12-17 18:47:58,"@Saibato thanks for the explanation/edits.  Although now dropped, would ACK in a new PR",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r545321570,545321570,doc/tor.md
jonatack,2020-12-23 20:29:29,"> @Saibato thanks for the explanation/edits. Although now dropped, would ACK in a new PR\n\nDone in #20757, please add suggestions or ACKs there.",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r548210419,548210419,doc/tor.md
jonatack,2020-12-23 20:30:10,"Brought back the commits and added also to the -onlynet help in #20757, please add suggestions or ACKs there.",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r548210859,548210859,doc/tor.md
jonatack,2020-12-23 20:30:56,Revived without the `sort` and with a mention that the command is for Debian in #20757.,https://github.com/bitcoin/bitcoin/pull/19961#discussion_r548211441,548211441,doc/tor.md
Willtech,2021-01-06 17:22:06,"https://github.com/bitcoin/bitcoin/pull/19961#discussion_r492980674\nEven given the above configuration, you make a point to consider we are talking about the operation of the parameter.\n\n\nIf the hidden service is created via tor-control and you need to discover it please check you debug.log for lines similar to the following, it should automatically be added as AddLocal\n```\n2020-08-11T",https://github.com/bitcoin/bitcoin/pull/19961#discussion_r552829849,552829849,doc/tor.md
