practicalswift,2020-12-11 06:53:08,"Concept ACK: high quality life is better than low quality life\n\nThanks for improving things! :)",https://github.com/bitcoin/bitcoin/pull/20619#issuecomment-743011847,743011847,
laanwj,2020-12-11 09:14:56,"Thanks, going to test this.",https://github.com/bitcoin/bitcoin/pull/20619#issuecomment-743074097,743074097,
hebasto,2020-12-11 09:35:13,Concept ACK.,https://github.com/bitcoin/bitcoin/pull/20619#issuecomment-743085785,743085785,
DrahtBot,2020-12-11 11:58:16,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #17920 (guix: Build support for macOS by dongcarl)\n\nIf you consider this pull request important, please also help to rev",https://github.com/bitcoin/bitcoin/pull/20619#issuecomment-743152713,743152713,
laanwj,2020-12-12 03:40:27,"I was a bit confused by `/bitcoin` in the following error, I think it would be better if it showed the full path.\n```\nuser@guix:~/bitcoin$ ./contrib/guix/guix-build.sh\nmake: Entering directory '/home/user/bitcoin/depends'\n…\nAt most 8 jobs will run at once...\nDISTSRC directory '/bitcoin/distsrc-x86_64-linux-gnu' exists, probably because of previous builds... Aborting...\n```\n\nEdit:",https://github.com/bitcoin/bitcoin/pull/20619#issuecomment-743695254,743695254,
laanwj,2020-12-12 13:54:06,"Something that would be nice to mention (I don't think it's mentioned in the documentation, but maybe read over it) is which files can be cached. It mentions ""start from a clean bitcoin core tree"" but I'm sure e.g. `depends/sources` can be cached to save some time and bandwidth downloading, for example.",https://github.com/bitcoin/bitcoin/pull/20619#issuecomment-743759496,743759496,
MarcoFalke,2020-12-12 16:38:32,"While `depends/sources` can be cached, `depends` needs to be cached under a key lookup that hashes at least the compiler version. See  #17248 . @DrahtBot does this.",https://github.com/bitcoin/bitcoin/pull/20619#issuecomment-743781378,743781378,
laanwj,2020-12-12 16:57:47,"> While depends/sources can be cached, depends needs to be cached under a key lookup that hashes at least the compiler version. See #17248 . @DrahtBot does this.\n\nHmf, it seems this is something that the guix build wrapper itself knows better than the user.\n",https://github.com/bitcoin/bitcoin/pull/20619#issuecomment-743783759,743783759,
dongcarl,2020-12-12 21:02:10,"So there are two caches for `depends`:\n1. `SOURCES_PATH` (`depends/sources`), which is already honored by `guix-build.sh` ([doc](https://github.com/bitcoin/bitcoin/blob/master/contrib/guix/README.md#recognized-environment-variables)).\n2. `BASE_CACHE` (where the build results go), which is not yet honored by `guix-build.sh`.\n\nHonoring `BASE_CACHE` is a bit more tricky, as we want to avoid c",https://github.com/bitcoin/bitcoin/pull/20619#issuecomment-743867112,743867112,
dongcarl,2020-12-12 21:05:32,"> I think it would be better if it showed the full path.\n\nYou're right! For this particular case, I will see if I can do the check before execing into the container so that we have the full path.\n\nIn general though, I found that `-ffile-prefix-map=` hasn't reliably produced reproducible output in the past, this is why I do the rename when bind mounting. I might give `-ffile-prefix-map=` an",https://github.com/bitcoin/bitcoin/pull/20619#issuecomment-743870757,743870757,
DrahtBot,2020-12-13 07:56:07,<!--9cd9c72976c961c55c7acef8f6ba82cd-->\n### Guix builds\n\n| File | commit b18978066d875707af8e15edf225d3e52b5ade05<br>(master) | commit 3cdcf06ed844e031fce0c3554c769064d59859c1<br>(master and this pull) |\n|--|--|--|\n| *-aarch64-linux-gnu-debug.tar.gz | [`7f03c6b17e599f56...`](https://drahtbot.space/guix/bitcoin/bitcoin/b18978066d875707af8e15edf225d3e52b5ade05/bitcoin-b18978066d87-aarch64-linux,https://github.com/bitcoin/bitcoin/pull/20619#issuecomment-743970315,743970315,
laanwj,2020-12-13 19:19:19,"I deterministically get the following output when building this commit:\n```\n3952acb71553cd300b6055a8be8799be570e459e9492b353da52bf2029979655  ./bitcoin-29359b904f40-aarch64-linux-gnu-debug.tar.gz\nb3cb1886585fa2fb0698e52c8432df9fef3f1c3dafd8da78a326dc6620e02f10  ./bitcoin-29359b904f40-aarch64-linux-gnu.tar.gz\n0e74c62318182d8d2c8abb9fde2ce9b7fdc0cdb17ef1135ed94b87d491c606db  ./bitcoin-29359b",https://github.com/bitcoin/bitcoin/pull/20619#issuecomment-744055075,744055075,
dongcarl,2020-12-14 00:47:00,"I was unable to reproduce these results, but I think I know exactly what's causing the non-reproducibility. I have recently fixed this in the macOS PR (https://github.com/bitcoin/bitcoin/pull/17920/commits/dc42abf94c98eb9d774fa6ac657ba854c11740d1) and will cherry-pick it here tomorrow. Depending on what PR gets merged first, we'll just rebase the other one on top!",https://github.com/bitcoin/bitcoin/pull/20619#issuecomment-744102721,744102721,
laanwj,2020-12-14 09:44:27,"> Depending on what PR gets merged first, we'll just rebase the other one on top!\n\nFWIW my build is in a clean Ubuntu 20.04 VM, no git configuration file. So I'm not sure the hash length change matters. But we'll see. It can't hurt at least.\nOh right … the default ""short"" hash length also depends on disambiguation (it's longer if it's somehow ambiguous) depending on what other commits are kn",https://github.com/bitcoin/bitcoin/pull/20619#issuecomment-744316694,744316694,
laanwj,2020-12-14 11:17:29,"I think the section name ""Using a version of Guix with `guix time-machine` capabilities"" is slightly confusing, as (at least what I understand) it's about upgrading *to* a version of Guix. Maybe ""Upgrading to a version of Guix with `guix time-machine` capabilities"" would be a better title. Or maybe, as it looks like recent installs don't need this, delete/move it to a footnote?",https://github.com/bitcoin/bitcoin/pull/20619#issuecomment-744371905,744371905,
DrahtBot,2020-12-14 19:12:47,<!--4a62be1de6b64f3ed646cdc7932c8cf5-->\n🕵️ @harding has been requested to review this pull request as specified in the REVIEWERS file.,https://github.com/bitcoin/bitcoin/pull/20619#issuecomment-744649895,744649895,
dongcarl,2020-12-22 20:03:38,"Pushed 29359b904f40805842447d4efa680bcc45bfdb57 -> 235cb967130fd33cc5413fe19fb8917def6a6388\n\n- Textually point to contrib/guix/README.md from doc/guix.md instead of using a symlink\n- Added rev-parse length specification for reproducibility\n- Added a few more sanity checks to guix-build.sh\n- Fail as soon as possible when DISTSRC directories already exist, and make the check outside the co",https://github.com/bitcoin/bitcoin/pull/20619#issuecomment-749750143,749750143,
dongcarl,2021-01-08 16:41:02,"Pushed 235cb967130fd33cc5413fe19fb8917def6a6388 -> 570e43fe72e13e0a82e25f7145704f62b2c2cc52\n- Rebased on top of master",https://github.com/bitcoin/bitcoin/pull/20619#issuecomment-756860769,756860769,
hebasto,2020-12-11 09:51:31,"29359b904f40805842447d4efa680bcc45bfdb57\nNot sure if symlinking works in the GH GUI.",https://github.com/bitcoin/bitcoin/pull/20619#discussion_r540823153,540823153,doc/guix.md
laanwj,2020-12-11 11:43:30,"Right, sorry, our tooling cannot handle this at the moment.\n```\n$ ../devtools/github-merge.py 20619\nERROR: File doc/guix.md was a symlink\n```",https://github.com/bitcoin/bitcoin/pull/20619#discussion_r540889066,540889066,doc/guix.md
