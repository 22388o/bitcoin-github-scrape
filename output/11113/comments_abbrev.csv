TheBlueMatt,2017-08-22T21:44:47Z,"Hmm, we should also handle the case where they have orphans in their locator similarly (ie parse their locator further back to find the first locator entry that is on our main chain).",https://github.com/bitcoin/bitcoin/pull/11113#issuecomment-324160641,324160641,
jimpo,2017-08-22T22:03:38Z,@TheBlueMatt This is the case where the locator is empty and only the stopHash is set. It's a special case request for a particular header by hash.,https://github.com/bitcoin/bitcoin/pull/11113#issuecomment-324164657,324164657,
TheBlueMatt,2017-08-22T22:13:11Z,"@jimpo yes, sorry, I had since edited my comment to note that we should do something similar for locator-present requests.",https://github.com/bitcoin/bitcoin/pull/11113#issuecomment-324166578,324166578,
sdaftuar,2017-08-24T20:49:09Z,"Concept ACK, good catch.  Would be great to have a p2p test case for this too.",https://github.com/bitcoin/bitcoin/pull/11113#issuecomment-324753419,324753419,
jimpo,2017-08-26T00:26:17Z,@sdaftuar Added a test with 58bc23d.,https://github.com/bitcoin/bitcoin/pull/11113#issuecomment-325063036,325063036,
sdaftuar,2017-08-26T02:07:13Z,"Code review ACK, and thanks for writing the test!  I just looked at the travis failure, and it appears to be a subtle merge conflict because the semantics of `wait_until` was just changed in master, see #11068.",https://github.com/bitcoin/bitcoin/pull/11113#issuecomment-325073512,325073512,
sipa,2017-08-27T19:30:37Z,utACK fed7483751cc94a7ce27fc6057a2080af8178223. Only had a casual look at the tests.,https://github.com/bitcoin/bitcoin/pull/11113#issuecomment-325219111,325219111,
sdaftuar,2017-08-30T19:10:19Z,ACK 3d61d72,https://github.com/bitcoin/bitcoin/pull/11113#issuecomment-326089822,326089822,
gmaxwell,2017-09-08T18:35:52Z,"utACK.\n\nPerhaps a small test nit, if I'm not misreading the test, I think the test would pass if it started failing for all really old headers even if they're on the active chain.  We should have a check that that is still successful.   We should also include a note in the tests that we don't test both criteria (both time and PET) as those tests would be good to add later.\n\nobNitpickSummon",https://github.com/bitcoin/bitcoin/pull/11113#issuecomment-328181819,328181819,
jimpo,2017-09-08T20:21:15Z,"@gmaxwell Thanks, added another test for that case. What do you mean by PET?\n\nAlso, yeah, I don't like the term orphan block (because it's ambiguous). Is stale block the preferred term now? I originally named it ""side block"" but I hear no one else calls it that.\n\nEDIT: Nevermind, PET = Proof (of work) Equivalent Time. Will add the comment.",https://github.com/bitcoin/bitcoin/pull/11113#issuecomment-328204347,328204347,
theuni,2017-09-19T18:41:31Z,"utACK, though I would prefer to see the AssertLockHeld added as @promag suggested.",https://github.com/bitcoin/bitcoin/pull/11113#issuecomment-330632976,330632976,
jimpo,2017-09-19T18:48:36Z,@theuni Added.,https://github.com/bitcoin/bitcoin/pull/11113#issuecomment-330634971,330634971,
TheBlueMatt,2017-09-21T01:41:52Z,utACK non-test parts of 8e57e82942c6ccb6ac905bd44d0d476bcf1651ec,https://github.com/bitcoin/bitcoin/pull/11113#issuecomment-331026865,331026865,
promag,2017-09-25T20:37:53Z,utACK modulus periods in commit messages and PR title ðŸ˜›.,https://github.com/bitcoin/bitcoin/pull/11113#issuecomment-332004832,332004832,
jonasschnelli,2017-09-27T17:53:55Z,@promag: can you retest/re-ack if the requested changes are ok?,https://github.com/bitcoin/bitcoin/pull/11113#issuecomment-332603773,332603773,
laanwj,2017-09-28T11:15:59Z,"> obNitpickSummoning: @sipa you're okay with calling this function 'orphanblock' rather than something like 'staleblock'? :)\n\nYes, a small nit regarding language: there is some ambiguity with regard to ""orphan"". Sometimes this is used for disconnected blocks/transactions (of which the parent is not known), sometimes for blocks/transactions outside the active chain. ""stale"" would be more specif",https://github.com/bitcoin/bitcoin/pull/11113#issuecomment-332805896,332805896,
promag,2017-09-28T13:19:20Z,"utACK 00ec5a3. Nits and other possible improvements can be worked out later.\n\n",https://github.com/bitcoin/bitcoin/pull/11113#issuecomment-332833601,332833601,
TheBlueMatt,2017-08-22T22:24:03Z,"Generally referred to as ""Orphans"" not ""SideBlocks"".",https://github.com/bitcoin/bitcoin/pull/11113#discussion_r134616874,134616874,src/net_processing.cpp
meshcollider,2017-09-04T22:13:42Z,Constants should be caps with snake case,https://github.com/bitcoin/bitcoin/pull/11113#discussion_r136873279,136873279,src/net_processing.cpp
meshcollider,2017-09-04T22:15:00Z,snake_case argument names,https://github.com/bitcoin/bitcoin/pull/11113#discussion_r136873326,136873326,src/net_processing.cpp
jimpo,2017-09-07T02:09:24Z,"`consensusParams` is camelCase everywhere else in the file, so I think it's better to leave as is. Feel free to replace everywhere in a separate PR.",https://github.com/bitcoin/bitcoin/pull/11113#discussion_r137432772,137432772,src/net_processing.cpp
meshcollider,2017-09-08T21:19:00Z,"Style-only PRs are highly discouraged, developer guide says to use the style in all new code regardless of style around it, because eventually it will all be replaced",https://github.com/bitcoin/bitcoin/pull/11113#discussion_r137891976,137891976,src/net_processing.cpp
promag,2017-09-18T22:19:48Z,Specify unit.,https://github.com/bitcoin/bitcoin/pull/11113#discussion_r139555336,139555336,src/net_processing.cpp
promag,2017-09-18T22:19:56Z,Specify unit.,https://github.com/bitcoin/bitcoin/pull/11113#discussion_r139555363,139555363,src/net_processing.cpp
promag,2017-09-18T22:20:44Z,Just `params`?,https://github.com/bitcoin/bitcoin/pull/11113#discussion_r139555500,139555500,src/net_processing.cpp
promag,2017-09-18T22:30:46Z,"Just?\n```py\n    def __init__(self, headers=[]):\n        self.headers = headers\n```",https://github.com/bitcoin/bitcoin/pull/11113#discussion_r139557154,139557154,test/functional/test_framework/mininode.py
promag,2017-09-18T22:31:26Z,"Nit, I also prefer periods, but at least be consistent, remove?",https://github.com/bitcoin/bitcoin/pull/11113#discussion_r139557256,139557256,test/functional/p2p-fingerprint.py
promag,2017-09-18T22:32:35Z,"Nit\n```py\nfrom time import (sleep, time)\n```",https://github.com/bitcoin/bitcoin/pull/11113#discussion_r139557464,139557464,test/functional/p2p-fingerprint.py
promag,2017-09-18T22:36:42Z,Missing `AssertLockHeld` because of `pindexBestHeader`?,https://github.com/bitcoin/bitcoin/pull/11113#discussion_r139558059,139558059,src/net_processing.cpp
jimpo,2017-09-19T17:32:43Z,"@promag The variable is referred to as `consensusParams` everywhere else, probably to differentiate from an instance of `CChainParams`.",https://github.com/bitcoin/bitcoin/pull/11113#discussion_r139762647,139762647,src/net_processing.cpp
jimpo,2017-09-19T17:34:35Z,That is not safe in Python: http://docs.python-guide.org/en/latest/writing/gotchas/#mutable-default-arguments.,https://github.com/bitcoin/bitcoin/pull/11113#discussion_r139763178,139763178,test/functional/test_framework/mininode.py
jimpo,2017-09-19T17:40:21Z,"If other people feel strongly, I'm willing to change it, but I prefer to [only import packages and modules](https://google.github.io/styleguide/pyguide.html?showone=Imports#Imports), not values. This makes it a bit more clear where the function is coming from.",https://github.com/bitcoin/bitcoin/pull/11113#discussion_r139764713,139764713,test/functional/p2p-fingerprint.py
theuni,2017-09-19T18:40:46Z,+1,https://github.com/bitcoin/bitcoin/pull/11113#discussion_r139780508,139780508,src/net_processing.cpp
promag,2017-09-25T20:34:54Z,"Oh! nice, ty!",https://github.com/bitcoin/bitcoin/pull/11113#discussion_r140890209,140890209,test/functional/test_framework/mininode.py
promag,2017-09-27T22:52:36Z,Inline lambdas in `wait_until`? ,https://github.com/bitcoin/bitcoin/pull/11113#discussion_r141488406,141488406,test/functional/p2p-fingerprint.py
promag,2017-09-27T23:00:12Z,Also use `wait_until` instead of fixed sleep?,https://github.com/bitcoin/bitcoin/pull/11113#discussion_r141489518,141489518,test/functional/p2p-fingerprint.py
promag,2017-09-27T23:04:54Z,Same as above.,https://github.com/bitcoin/bitcoin/pull/11113#discussion_r141490128,141490128,test/functional/p2p-fingerprint.py
promag,2017-09-27T23:06:59Z,"Nit, remove above `height` and:\n```python\nblock_hash = block_hashes[-3]\n```",https://github.com/bitcoin/bitcoin/pull/11113#discussion_r141490421,141490421,test/functional/p2p-fingerprint.py
promag,2017-09-27T23:23:27Z,Determine `prev_height` and `prev_median_time` here and simplify code below.,https://github.com/bitcoin/bitcoin/pull/11113#discussion_r141492533,141492533,test/functional/p2p-fingerprint.py
jimpo,2017-09-27T23:35:40Z,That doesn't work. We're waiting to make sure a change does not happen.,https://github.com/bitcoin/bitcoin/pull/11113#discussion_r141494036,141494036,test/functional/p2p-fingerprint.py
jimpo,2017-09-27T23:36:25Z,I don't understand. Example code?,https://github.com/bitcoin/bitcoin/pull/11113#discussion_r141494130,141494130,test/functional/p2p-fingerprint.py
jimpo,2017-09-27T23:36:47Z,I'd rather not.,https://github.com/bitcoin/bitcoin/pull/11113#discussion_r141494166,141494166,test/functional/p2p-fingerprint.py
jimpo,2017-09-27T23:37:24Z,"I think this better represents my intent as is. Also, height is used two lines below.",https://github.com/bitcoin/bitcoin/pull/11113#discussion_r141494264,141494264,test/functional/p2p-fingerprint.py
promag,2017-09-28T08:32:21Z,"I mean something like:\n```python\ndef build_chain(self, nblocks, prev_hash):\n    header = self.nodes[0].getblockheader(prev_hash)\n    height = header[""height""]\n    cur_time = header[""mediantime""]\n\n    blocks = []\n    for _ in range(nblocks):\n        height += 1\n        cur_time += 1\n        \n        coinbase = create_coinbase(height)\n        block = create_block(int(prev_h",https://github.com/bitcoin/bitcoin/pull/11113#discussion_r141556292,141556292,test/functional/p2p-fingerprint.py
