[
  {
    "sha": "a51d0ad2de89b9757d158df95ddeba2bfcb23935",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphNTFkMGFkMmRlODliOTc1N2QxNThkZjk1ZGRlYmEyYmZjYjIzOTM1",
    "commit": {
      "author": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2020-08-10T22:01:53Z"
      },
      "committer": {
        "name": "Fabian Jahr",
        "email": "fjahr@protonmail.com",
        "date": "2020-08-11T12:04:02Z"
      },
      "message": "rpc: Improve addnode remove command error message\n\nThis also adds test coverage for the remove command which was uncovered before.",
      "tree": {
        "sha": "c7dde24190e668e26b2e86cd88ca4d8f251e18d1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c7dde24190e668e26b2e86cd88ca4d8f251e18d1"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a51d0ad2de89b9757d158df95ddeba2bfcb23935",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\nComment: GPGTools - https://gpgtools.org\n\niQJJBAABCgAzFiEEtFq20ghhrCHSdrgm8T0enYkHmM0FAl8yiTMVHGZqYWhyQHBy\nb3Rvbm1haWwuY29tAAoJEPE9Hp2JB5jN9PwP/2CfgiC9O3n9vuqhvMYaqamd6kUD\nIIbOMEqJBP8exMm8oiBHxlH4hUrgH4Ugc6oORFle1coRsjyUAMx6zWUDAxkfcK7n\nfZaGvJT3K/bGWlLz/4aaY4Odrqp8cGUhNbB7QHobS8bTUttVljkizZ44BCrwkINI\nhjhu3LzBGhfqctGVfH7P1m046odV089zSCrXnQMJLu72TVRbax/F+rYXZ1v5l9M5\nw2lRJOo2tiuxbmJRUqkWp4VVI7JqaX80i6gozJBFPFSQ0iFuPrsWbehV+KJP+H+h\nsT/hngE5uhscrUN4ZZzIxD5uwJMttWWxzA9JeGq1Th9f7yaD38vH2HQW9aE0Sv9z\nDuLKJ6+3Q8yjzAkQ/8W8n4+f3qfKwnXAf0NZXtSmF5fQeKKJ3otA56URdiW5RByp\nsMNbSUiRhkQapK5F6K2ZMMlpFXSmKxe+7Ogfc0QvFXa2VLVz/43QLvIgWDVZufZk\neSAdQBgd90dpjDQzzK9Jq5PGRnse6iuUjuxbK14zR+OsunTR4oa8EZH5T1jGVk0z\nCMEnGJaVLojXYqDM3Ktn9jdCOAfp9KIlcQIDZFXtNpUZlrsqs1E2+A8+9Y2+mP15\nj2ylTHvkhcjalgzcow/CVuUZdD7z7JGzkboRHMJGgC8vojzRsQ/CwKEcjjwiErPJ\n+pbGXOsXVlvtduWz\n=H7id\n-----END PGP SIGNATURE-----",
        "payload": "tree c7dde24190e668e26b2e86cd88ca4d8f251e18d1\nparent f306384f5a9006307eec7ace9fc8433aa1a8ed84\nauthor Fabian Jahr <fjahr@protonmail.com> 1597096913 +0200\ncommitter Fabian Jahr <fjahr@protonmail.com> 1597147442 +0200\n\nrpc: Improve addnode remove command error message\n\nThis also adds test coverage for the remove command which was uncovered before.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a51d0ad2de89b9757d158df95ddeba2bfcb23935",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/a51d0ad2de89b9757d158df95ddeba2bfcb23935",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a51d0ad2de89b9757d158df95ddeba2bfcb23935/comments",
    "author": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "fjahr",
      "id": 1322187,
      "node_id": "MDQ6VXNlcjEzMjIxODc=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1322187?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fjahr",
      "html_url": "https://github.com/fjahr",
      "followers_url": "https://api.github.com/users/fjahr/followers",
      "following_url": "https://api.github.com/users/fjahr/following{/other_user}",
      "gists_url": "https://api.github.com/users/fjahr/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fjahr/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fjahr/subscriptions",
      "organizations_url": "https://api.github.com/users/fjahr/orgs",
      "repos_url": "https://api.github.com/users/fjahr/repos",
      "events_url": "https://api.github.com/users/fjahr/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fjahr/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "f306384f5a9006307eec7ace9fc8433aa1a8ed84",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f306384f5a9006307eec7ace9fc8433aa1a8ed84",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/f306384f5a9006307eec7ace9fc8433aa1a8ed84"
      }
    ],
    "stats": {
      "total": 9,
      "additions": 8,
      "deletions": 1
    },
    "files": [
      {
        "sha": "7e9c78d2f2a5f7c1a9e2d65028a4fe043b0ce4b6",
        "filename": "src/rpc/net.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a51d0ad2de89b9757d158df95ddeba2bfcb23935/src/rpc/net.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a51d0ad2de89b9757d158df95ddeba2bfcb23935/src/rpc/net.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/net.cpp?ref=a51d0ad2de89b9757d158df95ddeba2bfcb23935",
        "patch": "@@ -276,7 +276,7 @@ static UniValue addnode(const JSONRPCRequest& request)\n     else if(strCommand == \"remove\")\n     {\n         if(!node.connman->RemoveAddedNode(strNode))\n-            throw JSONRPCError(RPC_CLIENT_NODE_NOT_ADDED, \"Error: Node has not been added.\");\n+            throw JSONRPCError(RPC_CLIENT_NODE_NOT_ADDED, \"Error: Node could not be removed. It has not been added previously.\");\n     }\n \n     return NullUniValue;"
      },
      {
        "sha": "674e034809a198031224df7061ee9a4ac05e1f9f",
        "filename": "test/functional/rpc_net.py",
        "status": "modified",
        "additions": 7,
        "deletions": 0,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a51d0ad2de89b9757d158df95ddeba2bfcb23935/test/functional/rpc_net.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a51d0ad2de89b9757d158df95ddeba2bfcb23935/test/functional/rpc_net.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/rpc_net.py?ref=a51d0ad2de89b9757d158df95ddeba2bfcb23935",
        "patch": "@@ -131,6 +131,13 @@ def _test_getaddednodeinfo(self):\n         added_nodes = self.nodes[0].getaddednodeinfo(ip_port)\n         assert_equal(len(added_nodes), 1)\n         assert_equal(added_nodes[0]['addednode'], ip_port)\n+        # check that node cannot be added again\n+        assert_raises_rpc_error(-23, \"Node already added\", self.nodes[0].addnode, node=ip_port, command='add')\n+        # check that node can be removed\n+        self.nodes[0].addnode(node=ip_port, command='remove')\n+        assert_equal(self.nodes[0].getaddednodeinfo(), [])\n+        # check that trying to remove the node again returns an error\n+        assert_raises_rpc_error(-24, \"Node could not be removed\", self.nodes[0].addnode, node=ip_port, command='remove')\n         # check that a non-existent node returns an error\n         assert_raises_rpc_error(-24, \"Node has not been added\", self.nodes[0].getaddednodeinfo, '1.1.1.1')\n "
      }
    ]
  }
]