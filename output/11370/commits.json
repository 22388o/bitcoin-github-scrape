[
  {
    "sha": "fd8f45fe88c7f34785ee0724b875cf14e8a29e07",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmZDhmNDVmZTg4YzdmMzQ3ODVlZTA3MjRiODc1Y2YxNGU4YTI5ZTA3",
    "commit": {
      "author": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2017-09-20T14:00:28Z"
      },
      "committer": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2017-09-20T14:38:09Z"
      },
      "message": "[test] Add restart_node to BitcoinTestFramework",
      "tree": {
        "sha": "9ca579e875bc237c5ef560b0b0f8bd3b67b16ff1",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/9ca579e875bc237c5ef560b0b0f8bd3b67b16ff1"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fd8f45fe88c7f34785ee0724b875cf14e8a29e07",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fd8f45fe88c7f34785ee0724b875cf14e8a29e07",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fd8f45fe88c7f34785ee0724b875cf14e8a29e07",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fd8f45fe88c7f34785ee0724b875cf14e8a29e07/comments",
    "author": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "4f7e37e26c5d1ca5421bb070e583aaa6b0c93d03",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4f7e37e26c5d1ca5421bb070e583aaa6b0c93d03",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/4f7e37e26c5d1ca5421bb070e583aaa6b0c93d03"
      }
    ],
    "stats": {
      "total": 5,
      "additions": 5,
      "deletions": 0
    },
    "files": [
      {
        "sha": "381513ab9ed2fedb8d38c2d969e809b1b397bc6f",
        "filename": "test/functional/test_framework/test_framework.py",
        "status": "modified",
        "additions": 5,
        "deletions": 0,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fd8f45fe88c7f34785ee0724b875cf14e8a29e07/test/functional/test_framework/test_framework.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fd8f45fe88c7f34785ee0724b875cf14e8a29e07/test/functional/test_framework/test_framework.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/test_framework/test_framework.py?ref=fd8f45fe88c7f34785ee0724b875cf14e8a29e07",
        "patch": "@@ -273,6 +273,11 @@ def stop_nodes(self):\n             # Wait for nodes to stop\n             node.wait_until_stopped()\n \n+    def restart_node(self, i, extra_args=None):\n+        \"\"\"Stop and start a test node\"\"\"\n+        self.stop_node(i)\n+        self.start_node(i, extra_args)\n+\n     def assert_start_raises_init_error(self, i, extra_args=None, expected_msg=None):\n         with tempfile.SpooledTemporaryFile(max_size=2**16) as log_stderr:\n             try:"
      }
    ]
  },
  {
    "sha": "f6ffb143679aa7e89ad3c3342ceba5e5aaf71a0e",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmNmZmYjE0MzY3OWFhN2U4OWFkM2MzMzQyY2ViYTVlNWFhZjcxYTBl",
    "commit": {
      "author": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2017-09-19T23:45:39Z"
      },
      "committer": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2017-09-20T14:38:09Z"
      },
      "message": "[test] Add getblockchaininfo functional test",
      "tree": {
        "sha": "6ff33811c8f8e4e0d6143475a6407fad8f0fbc57",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6ff33811c8f8e4e0d6143475a6407fad8f0fbc57"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f6ffb143679aa7e89ad3c3342ceba5e5aaf71a0e",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f6ffb143679aa7e89ad3c3342ceba5e5aaf71a0e",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/f6ffb143679aa7e89ad3c3342ceba5e5aaf71a0e",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f6ffb143679aa7e89ad3c3342ceba5e5aaf71a0e/comments",
    "author": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fd8f45fe88c7f34785ee0724b875cf14e8a29e07",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fd8f45fe88c7f34785ee0724b875cf14e8a29e07",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fd8f45fe88c7f34785ee0724b875cf14e8a29e07"
      }
    ],
    "stats": {
      "total": 30,
      "additions": 29,
      "deletions": 1
    },
    "files": [
      {
        "sha": "63c56d0e9b55c328cbac695708912c0b6d0528b9",
        "filename": "test/functional/blockchain.py",
        "status": "modified",
        "additions": 29,
        "deletions": 1,
        "changes": 30,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f6ffb143679aa7e89ad3c3342ceba5e5aaf71a0e/test/functional/blockchain.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f6ffb143679aa7e89ad3c3342ceba5e5aaf71a0e/test/functional/blockchain.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/blockchain.py?ref=f6ffb143679aa7e89ad3c3342ceba5e5aaf71a0e",
        "patch": "@@ -33,9 +33,10 @@\n class BlockchainTest(BitcoinTestFramework):\n     def set_test_params(self):\n         self.num_nodes = 1\n-        self.extra_args = [['-stopatheight=207']]\n+        self.extra_args = [['-stopatheight=207', '-prune=1']]\n \n     def run_test(self):\n+        self._test_getblockchaininfo()\n         self._test_getchaintxstats()\n         self._test_gettxoutsetinfo()\n         self._test_getblockheader()\n@@ -44,6 +45,33 @@ def run_test(self):\n         self._test_stopatheight()\n         assert self.nodes[0].verifychain(4, 0)\n \n+    def _test_getblockchaininfo(self):\n+        self.log.info(\"Test getblockchaininfo\")\n+\n+        keys = [\n+            'bestblockhash',\n+            'bip9_softforks',\n+            'blocks',\n+            'chain',\n+            'chainwork',\n+            'difficulty',\n+            'headers',\n+            'mediantime',\n+            'pruned',\n+            'softforks',\n+            'verificationprogress',\n+        ]\n+        res = self.nodes[0].getblockchaininfo()\n+        # result should have pruneheight and default keys if pruning is enabled\n+        assert_equal(sorted(res.keys()), sorted(['pruneheight'] + keys))\n+        # pruneheight should be greater or equal to 0\n+        assert res['pruneheight'] >= 0\n+\n+        self.restart_node(0, ['-stopatheight=207'])\n+        res = self.nodes[0].getblockchaininfo()\n+        # should have exact keys\n+        assert_equal(sorted(res.keys()), keys)\n+\n     def _test_getchaintxstats(self):\n         chaintxstats = self.nodes[0].getchaintxstats(1)\n         # 200 txs plus genesis tx"
      }
    ]
  }
]