midnightmagic,2020-07-03 03:30:23,"At commit a24806c25d7a81a9c436de58eb5778d93abab16b, gmake check is now working just fine on my NetBSD test machine with the configure.ac changes in this PR..",https://github.com/bitcoin/bitcoin/pull/19430#issuecomment-653321580,653321580,
DrahtBot,2020-08-20 22:04:12,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19803 (Bugfix: Define and use HAVE_FDATASYNC correctly outside LevelDB by luke-jr)\n* #14501 (Fix possible data race when",https://github.com/bitcoin/bitcoin/pull/19430#issuecomment-677930142,677930142,
DrahtBot,2020-08-31 06:08:01,"<!--cf906140f33d8803c4a75a2196329ecb-->\nüêô This pull request conflicts with the target branch and [needs rebase](https://github.com/bitcoin/bitcoin/blob/master/CONTRIBUTING.md#rebasing-changes).\n\n<sub>Want to unsubscribe from rebase notifications on this pull request? Just convert this pull request to a ""draft"".</sub>",https://github.com/bitcoin/bitcoin/pull/19430#issuecomment-683579071,683579071,
midnightmagic,2021-04-01 15:51:42,"It was required at the time, yes. I no longer have machines on which this can be tested. It will have to wait until I have rebuilt that section of my infrastructure.",https://github.com/bitcoin/bitcoin/pull/19430#issuecomment-812001571,812001571,
fanquake,2021-05-31 06:31:37,"@midnightmagic if you get back to testing this, let us know, and this can be reopened. I'm going to close this for now.",https://github.com/bitcoin/bitcoin/pull/19430#issuecomment-851225405,851225405,
laanwj,2020-07-09 12:42:21,Why are you canging this around? In general we prefer putting the environment variables after the `./configure` because then they are retained if configure is automatically re-run by the build system (e.g. after a git pul lthat changes one of the build system files).,https://github.com/bitcoin/bitcoin/pull/19430#discussion_r452188202,452188202,doc/build-netbsd.md
midnightmagic,2020-07-09 19:31:12,"I'm not stuck on why particular way, or order, of anything. It's entirely a habit born of porting stuff to NetBSD, idea being to keep changes as unobtrusive and light as possible, and to leave the onus on the NetBSD side to maintain/make changes that are specific to NetBSD. I can switch it up if you think that's better. I don't think any of these things will (presumably) ever be run on anything bu",https://github.com/bitcoin/bitcoin/pull/19430#discussion_r452443066,452443066,doc/build-netbsd.md
laanwj,2020-07-15 12:28:03,"I'd prefer to keep it as-is, it's the convention that we use everywhere and if there is no need to deviate from it on NetBSD, it's better to keep it more or less the same. This makes maintenance easier for us.",https://github.com/bitcoin/bitcoin/pull/19430#discussion_r455012655,455012655,doc/build-netbsd.md
luke-jr,2020-07-23 23:44:43,Isn't there a better way to detect this condition?,https://github.com/bitcoin/bitcoin/pull/19430#discussion_r459787510,459787510,configure.ac
luke-jr,2020-07-23 23:46:13,"We use `fdatasync` on files in `FileCommit`. Currently, it checks `__linux__ || __NetBSD__`, but it really should be using `HAVE_FDATASYNC` defined here.\n\nSome other solution seems desirable...",https://github.com/bitcoin/bitcoin/pull/19430#discussion_r459787959,459787959,configure.ac
krytarowski,2020-07-24 01:32:07,Is this a NetBSD bug?,https://github.com/bitcoin/bitcoin/pull/19430#discussion_r459813237,459813237,configure.ac
midnightmagic,2020-07-24 02:46:47,"Yes; we can detect it by running fdatasync() on a directory that we know exists and observing the result. I'd be glad to rewrite it into an autoconf run-program, but things like includes are disparate across platforms for this and a generic program would likely only be functional on tested platforms. A check for the name of the platform (programmed logic) rather than detected behaviour was simpler",https://github.com/bitcoin/bitcoin/pull/19430#discussion_r459828055,459828055,configure.ac
midnightmagic,2020-07-24 02:48:52,"This is not a NetBSD bug. The POSIX/SUSvX whatever it is now is being more liberally interpreted by Linux as supporting directory fdatasync, but arguably this is incorrect. NetBSD interprets conditions and/or functionality like this quite a bit more strictly than Linux does, and does so (somewhat) independently and without working to be compatible with Linux. (At least, it has in the past. I have ",https://github.com/bitcoin/bitcoin/pull/19430#discussion_r459828401,459828401,configure.ac
midnightmagic,2020-07-24 03:02:47,"Yeah sure thing. I'm completely fine with that. Technically no need whatsoever. Purely habit.\n",https://github.com/bitcoin/bitcoin/pull/19430#discussion_r459831012,459831012,doc/build-netbsd.md
luke-jr,2020-07-24 05:35:47,"I considered that, but it won't work if we're cross-compiling.\n\nBTW, *how* does it break LevelDB?",https://github.com/bitcoin/bitcoin/pull/19430#discussion_r459859769,459859769,configure.ac
midnightmagic,2020-08-02 21:27:20,"LevelDB, if HAVE_FDATASYNC is enabled, attempts it on full directories. When bitcoind attempts to commit data to (any) leveldb it issues fdatasync on a directory, which fails and generates an incomprehensible error for the user. bitcoind then exits. Without invasive changes in the leveldb code which special-case NetBSD (or.. platforms where fdatasync on a directory won't work) then addressing this",https://github.com/bitcoin/bitcoin/pull/19430#discussion_r464125325,464125325,configure.ac
fanquake,2021-04-01 14:06:04,I think you can drop this addition as well.,https://github.com/bitcoin/bitcoin/pull/19430#discussion_r605686008,605686008,doc/build-netbsd.md
