laanwj,2014-02-12T14:36:03Z,"```\n2014-02-12 14:32:44 init message: Zapping all transactions from wallet...\n2014-02-12 14:32:44 init message: Loading wallet...\n```\n\nWorked for me on regtest.\nBefore: wallet with two unconfirmed mutated transactions\nAfter: wallet with only confirmed transactions\n\n(Did not test with dependent chains of unconfirmed transactions, just direct duplicates)\n",https://github.com/bitcoin/bitcoin/pull/3659#issuecomment-34873953,34873953,
Diapolo,2014-02-12T15:21:01Z,What does this really do or help with which problem? From the description and comments in the code I don't understand it's purpose ;).\n,https://github.com/bitcoin/bitcoin/pull/3659#issuecomment-34878560,34878560,
laanwj,2014-02-12T15:25:12Z,@Diapolo This gets rid of all unconfirmed transactions. Currently used for cleaning up extra transactions inserted by the malleability DOS. It's less drastic than -salvagewallet which also loses all label information and other metadata.\n,https://github.com/bitcoin/bitcoin/pull/3659#issuecomment-34878999,34878999,
Diapolo,2014-02-12T15:56:03Z,"So it ""just"" clears (for Qt) the list of unconfirmed transactions? Does this also remove unconfirmed ones that a users created by himself but where the TX fee was too low for example? IMHO the description for the switch should be a little more user friendly/descriptive perhaps.\n",https://github.com/bitcoin/bitcoin/pull/3659#issuecomment-34882365,34882365,
jgarzik,2014-02-12T15:58:20Z,All transactions are removed.  Confirmed transactions are then added.\n\nNo unconfirmed transactions will be present after this is run.\n\nIt might be best just to not document this in command line help.  It's a rare-use utility.\n,https://github.com/bitcoin/bitcoin/pull/3659#issuecomment-34882597,34882597,
laanwj,2014-02-12T15:58:46Z,@diapolo It's not meant for willy-nilly use. Wrong use of this feature can result in double-spending (transactions that you get rid of in this way may still be in the mempool somewhere else and get mined at some point). It's only meant to get rid of transactions that _can_ never confirm.\n,https://github.com/bitcoin/bitcoin/pull/3659#issuecomment-34882652,34882652,
sipa,2014-02-12T16:00:17Z,Does this clear the vfSpent flag in other transactions? Otherwise it seems pretty useless...\n,https://github.com/bitcoin/bitcoin/pull/3659#issuecomment-34882845,34882845,
laanwj,2014-02-12T16:03:18Z,@sipa It removes _all_ transactions and forces a rescan.\n,https://github.com/bitcoin/bitcoin/pull/3659#issuecomment-34883197,34883197,
cozz,2014-02-12T16:17:55Z,"As far as I see does this also remove the information of CWalletTx.strFromAccount.\nSo we should store all strFromAccount by txhash and then restore this information after rescan.\n\nAlso I dont like the name and description of the parameter.\nThey are really very confusing in several ways.\n(If even we are confused, how can a normal user understand this?)\nMy suggestion is ""-cleanwallet"".\nWe alr",https://github.com/bitcoin/bitcoin/pull/3659#issuecomment-34884804,34884804,
sipa,2014-02-12T17:26:08Z,So how is this different from -salvagewallet?\n,https://github.com/bitcoin/bitcoin/pull/3659#issuecomment-34892875,34892875,
laanwj,2014-02-12T17:27:39Z,"@sipa It doesn't lose label information. It keeps everything but transactions, instead of only keys. But yes, maybe it could be defined as a mode of salvagewallet instead of a seperate option.\n",https://github.com/bitcoin/bitcoin/pull/3659#issuecomment-34893040,34893040,
sipa,2014-02-12T17:36:26Z,"Got it. Sounds useful indeed, as salvagewallet is overkill here...\n",https://github.com/bitcoin/bitcoin/pull/3659#issuecomment-34893950,34893950,
gmaxwell,2014-02-14T05:00:32Z,"Salvage wallet currently totally corrupts my testnet wallet. I don't know why. Start off with a zillion tnbtc, salvage, end up with a balance of 150 and a wallet that won't unlock. God knows what abusive things I've done to this walletâ€” I'm not aware of anyone having a similar issue with salvage.\n\nZapwallet works fine on it. ACK.\n",https://github.com/bitcoin/bitcoin/pull/3659#issuecomment-35056022,35056022,
maaku,2014-02-14T06:51:39Z,"Armchair architecting here but... when I saw the pull request name I thought it would be a JSON-RPC command to surgically remove a specific unconfirmed transaction (identified by hash). Which, btw, is probably a good feature to have but is a separate issue. Maybe zapwallettx should be renamed just zapwallet or flushwallet to avoid the confusion?\n",https://github.com/bitcoin/bitcoin/pull/3659#issuecomment-35060591,35060591,
laanwj,2014-02-14T07:08:33Z,"@maaku IMO, plural -zapwallettxes would be best. Just -zapwallet would imply the whole wallet is desintegrated.\n",https://github.com/bitcoin/bitcoin/pull/3659#issuecomment-35061284,35061284,
laanwj,2014-02-14T16:21:00Z,ACK in any case\n,https://github.com/bitcoin/bitcoin/pull/3659#issuecomment-35098414,35098414,
jgarzik,2014-02-14T16:35:40Z,"Updated to use -zapwallettxes, and collapse bug fixes into the main commit.  Given ACKs, will merge, once pull tester is happy.\n",https://github.com/bitcoin/bitcoin/pull/3659#issuecomment-35099935,35099935,
ghost,2014-02-14T16:54:00Z,"I think the plural of tx is more likely to be txs, so -zapwallettxs\n",https://github.com/bitcoin/bitcoin/pull/3659#issuecomment-35101843,35101843,
BitcoinPullTester,2014-02-14T17:08:58Z,"Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/518f3bdae3415fdb60cef984b69b36f2633c1fe1 for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/cu",https://github.com/bitcoin/bitcoin/pull/3659#issuecomment-35103283,35103283,
laanwj,2014-02-12T14:53:50Z,"Please don't log/display this message if not zapping, it caught me unaware for a minute\n",https://github.com/bitcoin/bitcoin/pull/3659#discussion_r9669566,9669566,src/init.cpp
jgarzik,2014-02-12T15:00:50Z,"heh, whoops!\n",https://github.com/bitcoin/bitcoin/pull/3659#discussion_r9669878,9669878,src/init.cpp
promag,2017-12-18T02:40:08Z,`fNoncriticalErrors` is always `false` as such this is dead code. Cleaned in #11923.,https://github.com/bitcoin/bitcoin/pull/3659#discussion_r157392236,157392236,src/walletdb.cpp
