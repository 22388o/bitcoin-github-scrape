[
  {
    "sha": "356e1753725072a113be8662e9c5bef523208eee",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozNTZlMTc1MzcyNTA3MmExMTNiZTg2NjJlOWM1YmVmNTIzMjA4ZWVl",
    "commit": {
      "author": {
        "name": "Pavel Jan\u00edk",
        "email": "Pavel@Janik.cz",
        "date": "2016-04-05T07:32:40Z"
      },
      "committer": {
        "name": "Pavel Jan\u00edk",
        "email": "Pavel@Janik.cz",
        "date": "2016-04-05T16:42:03Z"
      },
      "message": "Refactor AlertNotifyOnce out of UpdateTip",
      "tree": {
        "sha": "e667eb4ae7d44c8b6e2cf81a43ed7e430bc1d336",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e667eb4ae7d44c8b6e2cf81a43ed7e430bc1d336"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/356e1753725072a113be8662e9c5bef523208eee",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/356e1753725072a113be8662e9c5bef523208eee",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/356e1753725072a113be8662e9c5bef523208eee",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/356e1753725072a113be8662e9c5bef523208eee/comments",
    "author": {
      "login": "paveljanik",
      "id": 6848764,
      "node_id": "MDQ6VXNlcjY4NDg3NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6848764?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paveljanik",
      "html_url": "https://github.com/paveljanik",
      "followers_url": "https://api.github.com/users/paveljanik/followers",
      "following_url": "https://api.github.com/users/paveljanik/following{/other_user}",
      "gists_url": "https://api.github.com/users/paveljanik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paveljanik/subscriptions",
      "organizations_url": "https://api.github.com/users/paveljanik/orgs",
      "repos_url": "https://api.github.com/users/paveljanik/repos",
      "events_url": "https://api.github.com/users/paveljanik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paveljanik/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "paveljanik",
      "id": 6848764,
      "node_id": "MDQ6VXNlcjY4NDg3NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6848764?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paveljanik",
      "html_url": "https://github.com/paveljanik",
      "followers_url": "https://api.github.com/users/paveljanik/followers",
      "following_url": "https://api.github.com/users/paveljanik/following{/other_user}",
      "gists_url": "https://api.github.com/users/paveljanik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paveljanik/subscriptions",
      "organizations_url": "https://api.github.com/users/paveljanik/orgs",
      "repos_url": "https://api.github.com/users/paveljanik/repos",
      "events_url": "https://api.github.com/users/paveljanik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paveljanik/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "30c2dd8d0598afac9319d3a813a89a682b9c0d34",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/30c2dd8d0598afac9319d3a813a89a682b9c0d34",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/30c2dd8d0598afac9319d3a813a89a682b9c0d34"
      }
    ],
    "stats": {
      "total": 26,
      "additions": 14,
      "deletions": 12
    },
    "files": [
      {
        "sha": "66f535096ffdbe4e07ee916352329ba904471195",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 14,
        "deletions": 12,
        "changes": 26,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/356e1753725072a113be8662e9c5bef523208eee/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/356e1753725072a113be8662e9c5bef523208eee/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=356e1753725072a113be8662e9c5bef523208eee",
        "patch": "@@ -1590,6 +1590,18 @@ static void AlertNotify(const std::string& strMessage, bool fThread)\n         runCommand(strCmd);\n }\n \n+static void AlertNotifyOnce(const std::string& strMessage, bool fThread)\n+{\n+    static bool fWarned = false;\n+\n+    if (!fWarned) {\n+      // strMiscWarning is read by GetWarnings(), called by Qt and the JSON-RPC code to warn the user\n+      strMiscWarning = strMessage;\n+      AlertNotify(strMessage, fThread);\n+      fWarned = true;\n+    }\n+}\n+\n void CheckForkWarningConditions()\n {\n     AssertLockHeld(cs_main);\n@@ -2564,7 +2576,6 @@ void static UpdateTip(CBlockIndex *pindexNew) {\n     cvBlockChange.notify_all();\n \n     // Check the version of the last 100 blocks to see if we need to upgrade:\n-    static bool fWarned = false;\n     if (!IsInitialBlockDownload())\n     {\n         int nUpgraded = 0;\n@@ -2574,11 +2585,7 @@ void static UpdateTip(CBlockIndex *pindexNew) {\n             ThresholdState state = checker.GetStateFor(pindex, chainParams.GetConsensus(), warningcache[bit]);\n             if (state == THRESHOLD_ACTIVE || state == THRESHOLD_LOCKED_IN) {\n                 if (state == THRESHOLD_ACTIVE) {\n-                    strMiscWarning = strprintf(_(\"Warning: unknown new rules activated (versionbit %i)\"), bit);\n-                    if (!fWarned) {\n-                        AlertNotify(strMiscWarning, true);\n-                        fWarned = true;\n-                    }\n+                    AlertNotifyOnce(strprintf(_(\"Warning: unknown new rules activated (versionbit %i)\"), bit), true);\n                 } else {\n                     LogPrintf(\"%s: unknown new rules are about to activate (versionbit %i)\\n\", __func__, bit);\n                 }\n@@ -2595,12 +2602,7 @@ void static UpdateTip(CBlockIndex *pindexNew) {\n             LogPrintf(\"%s: %d of last 100 blocks have unexpected version\\n\", __func__, nUpgraded);\n         if (nUpgraded > 100/2)\n         {\n-            // strMiscWarning is read by GetWarnings(), called by Qt and the JSON-RPC code to warn the user:\n-            strMiscWarning = _(\"Warning: Unknown block versions being mined! It's possible unknown rules are in effect\");\n-            if (!fWarned) {\n-                AlertNotify(strMiscWarning, true);\n-                fWarned = true;\n-            }\n+            AlertNotifyOnce(_(\"Warning: Unknown block versions being mined! It's possible unknown rules are in effect\"), true);\n         }\n     }\n }"
      }
    ]
  },
  {
    "sha": "2540dc408a60622a68dafb86a5cb12dc46242e24",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyNTQwZGM0MDhhNjA2MjJhNjhkYWZiODZhNWNiMTJkYzQ2MjQyZTI0",
    "commit": {
      "author": {
        "name": "Pavel Jan\u00edk",
        "email": "Pavel@Janik.cz",
        "date": "2016-04-25T14:48:19Z"
      },
      "committer": {
        "name": "Pavel Jan\u00edk",
        "email": "Pavel@Janik.cz",
        "date": "2016-04-25T14:48:19Z"
      },
      "message": "[squashme] Remove always-true argument.",
      "tree": {
        "sha": "94aab993fcbc29953389521962d8a192dfc7cbf6",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/94aab993fcbc29953389521962d8a192dfc7cbf6"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2540dc408a60622a68dafb86a5cb12dc46242e24",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2540dc408a60622a68dafb86a5cb12dc46242e24",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/2540dc408a60622a68dafb86a5cb12dc46242e24",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2540dc408a60622a68dafb86a5cb12dc46242e24/comments",
    "author": {
      "login": "paveljanik",
      "id": 6848764,
      "node_id": "MDQ6VXNlcjY4NDg3NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6848764?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paveljanik",
      "html_url": "https://github.com/paveljanik",
      "followers_url": "https://api.github.com/users/paveljanik/followers",
      "following_url": "https://api.github.com/users/paveljanik/following{/other_user}",
      "gists_url": "https://api.github.com/users/paveljanik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paveljanik/subscriptions",
      "organizations_url": "https://api.github.com/users/paveljanik/orgs",
      "repos_url": "https://api.github.com/users/paveljanik/repos",
      "events_url": "https://api.github.com/users/paveljanik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paveljanik/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "paveljanik",
      "id": 6848764,
      "node_id": "MDQ6VXNlcjY4NDg3NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6848764?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paveljanik",
      "html_url": "https://github.com/paveljanik",
      "followers_url": "https://api.github.com/users/paveljanik/followers",
      "following_url": "https://api.github.com/users/paveljanik/following{/other_user}",
      "gists_url": "https://api.github.com/users/paveljanik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paveljanik/subscriptions",
      "organizations_url": "https://api.github.com/users/paveljanik/orgs",
      "repos_url": "https://api.github.com/users/paveljanik/repos",
      "events_url": "https://api.github.com/users/paveljanik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paveljanik/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "356e1753725072a113be8662e9c5bef523208eee",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/356e1753725072a113be8662e9c5bef523208eee",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/356e1753725072a113be8662e9c5bef523208eee"
      }
    ],
    "stats": {
      "total": 19,
      "additions": 8,
      "deletions": 11
    },
    "files": [
      {
        "sha": "4628fb267c6a044369aba76358e47ecee9a25077",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 8,
        "deletions": 11,
        "changes": 19,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/2540dc408a60622a68dafb86a5cb12dc46242e24/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/2540dc408a60622a68dafb86a5cb12dc46242e24/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=2540dc408a60622a68dafb86a5cb12dc46242e24",
        "patch": "@@ -1570,7 +1570,7 @@ bool fLargeWorkForkFound = false;\n bool fLargeWorkInvalidChainFound = false;\n CBlockIndex *pindexBestForkTip = NULL, *pindexBestForkBase = NULL;\n \n-static void AlertNotify(const std::string& strMessage, bool fThread)\n+static void AlertNotify(const std::string& strMessage)\n {\n     uiInterface.NotifyAlertChanged();\n     std::string strCmd = GetArg(\"-alertnotify\", \"\");\n@@ -1584,20 +1584,17 @@ static void AlertNotify(const std::string& strMessage, bool fThread)\n     safeStatus = singleQuote+safeStatus+singleQuote;\n     boost::replace_all(strCmd, \"%s\", safeStatus);\n \n-    if (fThread)\n-        boost::thread t(runCommand, strCmd); // thread runs free\n-    else\n-        runCommand(strCmd);\n+    boost::thread t(runCommand, strCmd); // thread runs free\n }\n \n-static void AlertNotifyOnce(const std::string& strMessage, bool fThread)\n+static void AlertNotifyOnce(const std::string& strMessage)\n {\n     static bool fWarned = false;\n \n     if (!fWarned) {\n       // strMiscWarning is read by GetWarnings(), called by Qt and the JSON-RPC code to warn the user\n       strMiscWarning = strMessage;\n-      AlertNotify(strMessage, fThread);\n+      AlertNotify(strMessage);\n       fWarned = true;\n     }\n }\n@@ -1621,7 +1618,7 @@ void CheckForkWarningConditions()\n         {\n             std::string warning = std::string(\"'Warning: Large-work fork detected, forking after block \") +\n                 pindexBestForkBase->phashBlock->ToString() + std::string(\"'\");\n-            AlertNotify(warning, true);\n+            AlertNotify(warning);\n         }\n         if (pindexBestForkTip && pindexBestForkBase)\n         {\n@@ -2152,7 +2149,7 @@ void PartitionCheck(bool (*initialDownloadCheck)(), CCriticalSection& cs, const\n     if (!strWarning.empty())\n     {\n         strMiscWarning = strWarning;\n-        AlertNotify(strWarning, true);\n+        AlertNotify(strWarning);\n         lastAlertTime = now;\n     }\n }\n@@ -2585,7 +2582,7 @@ void static UpdateTip(CBlockIndex *pindexNew) {\n             ThresholdState state = checker.GetStateFor(pindex, chainParams.GetConsensus(), warningcache[bit]);\n             if (state == THRESHOLD_ACTIVE || state == THRESHOLD_LOCKED_IN) {\n                 if (state == THRESHOLD_ACTIVE) {\n-                    AlertNotifyOnce(strprintf(_(\"Warning: unknown new rules activated (versionbit %i)\"), bit), true);\n+                    AlertNotifyOnce(strprintf(_(\"Warning: unknown new rules activated (versionbit %i)\"), bit));\n                 } else {\n                     LogPrintf(\"%s: unknown new rules are about to activate (versionbit %i)\\n\", __func__, bit);\n                 }\n@@ -2602,7 +2599,7 @@ void static UpdateTip(CBlockIndex *pindexNew) {\n             LogPrintf(\"%s: %d of last 100 blocks have unexpected version\\n\", __func__, nUpgraded);\n         if (nUpgraded > 100/2)\n         {\n-            AlertNotifyOnce(_(\"Warning: Unknown block versions being mined! It's possible unknown rules are in effect\"), true);\n+            AlertNotifyOnce(_(\"Warning: Unknown block versions being mined! It's possible unknown rules are in effect\"));\n         }\n     }\n }"
      }
    ]
  },
  {
    "sha": "84171383bc63d1905f28be3ffbaf0b677e98b629",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4NDE3MTM4M2JjNjNkMTkwNWYyOGJlM2ZmYmFmMGI2NzdlOThiNjI5",
    "commit": {
      "author": {
        "name": "Pavel Jan\u00edk",
        "email": "Pavel@Janik.cz",
        "date": "2016-04-25T15:00:29Z"
      },
      "committer": {
        "name": "Pavel Jan\u00edk",
        "email": "Pavel@Janik.cz",
        "date": "2016-04-25T15:00:29Z"
      },
      "message": "[squashme] Set strMiscWarning directly from AlertNotify",
      "tree": {
        "sha": "73b484ed4c56265bad7aa5c05ddf9febf0cdde7d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/73b484ed4c56265bad7aa5c05ddf9febf0cdde7d"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/84171383bc63d1905f28be3ffbaf0b677e98b629",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/84171383bc63d1905f28be3ffbaf0b677e98b629",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/84171383bc63d1905f28be3ffbaf0b677e98b629",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/84171383bc63d1905f28be3ffbaf0b677e98b629/comments",
    "author": {
      "login": "paveljanik",
      "id": 6848764,
      "node_id": "MDQ6VXNlcjY4NDg3NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6848764?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paveljanik",
      "html_url": "https://github.com/paveljanik",
      "followers_url": "https://api.github.com/users/paveljanik/followers",
      "following_url": "https://api.github.com/users/paveljanik/following{/other_user}",
      "gists_url": "https://api.github.com/users/paveljanik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paveljanik/subscriptions",
      "organizations_url": "https://api.github.com/users/paveljanik/orgs",
      "repos_url": "https://api.github.com/users/paveljanik/repos",
      "events_url": "https://api.github.com/users/paveljanik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paveljanik/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "paveljanik",
      "id": 6848764,
      "node_id": "MDQ6VXNlcjY4NDg3NjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6848764?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/paveljanik",
      "html_url": "https://github.com/paveljanik",
      "followers_url": "https://api.github.com/users/paveljanik/followers",
      "following_url": "https://api.github.com/users/paveljanik/following{/other_user}",
      "gists_url": "https://api.github.com/users/paveljanik/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/paveljanik/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/paveljanik/subscriptions",
      "organizations_url": "https://api.github.com/users/paveljanik/orgs",
      "repos_url": "https://api.github.com/users/paveljanik/repos",
      "events_url": "https://api.github.com/users/paveljanik/events{/privacy}",
      "received_events_url": "https://api.github.com/users/paveljanik/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "2540dc408a60622a68dafb86a5cb12dc46242e24",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2540dc408a60622a68dafb86a5cb12dc46242e24",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/2540dc408a60622a68dafb86a5cb12dc46242e24"
      }
    ],
    "stats": {
      "total": 6,
      "additions": 3,
      "deletions": 3
    },
    "files": [
      {
        "sha": "9ccac8ddc1b4607f9531c3424f7094a9ab79583d",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 3,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/84171383bc63d1905f28be3ffbaf0b677e98b629/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/84171383bc63d1905f28be3ffbaf0b677e98b629/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=84171383bc63d1905f28be3ffbaf0b677e98b629",
        "patch": "@@ -1572,6 +1572,9 @@ CBlockIndex *pindexBestForkTip = NULL, *pindexBestForkBase = NULL;\n \n static void AlertNotify(const std::string& strMessage)\n {\n+    // strMiscWarning is read by GetWarnings(), called by Qt and the JSON-RPC code to warn the user\n+    strMiscWarning = strMessage;\n+\n     uiInterface.NotifyAlertChanged();\n     std::string strCmd = GetArg(\"-alertnotify\", \"\");\n     if (strCmd.empty()) return;\n@@ -1592,8 +1595,6 @@ static void AlertNotifyOnce(const std::string& strMessage)\n     static bool fWarned = false;\n \n     if (!fWarned) {\n-      // strMiscWarning is read by GetWarnings(), called by Qt and the JSON-RPC code to warn the user\n-      strMiscWarning = strMessage;\n       AlertNotify(strMessage);\n       fWarned = true;\n     }\n@@ -2148,7 +2149,6 @@ void PartitionCheck(bool (*initialDownloadCheck)(), CCriticalSection& cs, const\n     }\n     if (!strWarning.empty())\n     {\n-        strMiscWarning = strWarning;\n         AlertNotify(strWarning);\n         lastAlertTime = now;\n     }"
      }
    ]
  }
]