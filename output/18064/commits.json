[
  {
    "sha": "bbb33d6431d13a0ae244ab2beca506126a6430e7",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiYmIzM2Q2NDMxZDEzYTBhZTI0NGFiMmJlY2E1MDYxMjZhNjQzMGU3",
    "commit": {
      "author": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2020-02-03T21:53:19Z"
      },
      "committer": {
        "name": "Jo\u00e3o Barbosa",
        "email": "joao.paulo.barbosa@gmail.com",
        "date": "2020-02-04T13:52:52Z"
      },
      "message": "gui: Drop WalletModel dependency to RecentRequestsTableModel",
      "tree": {
        "sha": "e5ac3ba85a226048c1a5571ef162a61981515af7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e5ac3ba85a226048c1a5571ef162a61981515af7"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bbb33d6431d13a0ae244ab2beca506126a6430e7",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bbb33d6431d13a0ae244ab2beca506126a6430e7",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/bbb33d6431d13a0ae244ab2beca506126a6430e7",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bbb33d6431d13a0ae244ab2beca506126a6430e7/comments",
    "author": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "promag",
      "id": 3534524,
      "node_id": "MDQ6VXNlcjM1MzQ1MjQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/3534524?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/promag",
      "html_url": "https://github.com/promag",
      "followers_url": "https://api.github.com/users/promag/followers",
      "following_url": "https://api.github.com/users/promag/following{/other_user}",
      "gists_url": "https://api.github.com/users/promag/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/promag/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/promag/subscriptions",
      "organizations_url": "https://api.github.com/users/promag/orgs",
      "repos_url": "https://api.github.com/users/promag/repos",
      "events_url": "https://api.github.com/users/promag/events{/privacy}",
      "received_events_url": "https://api.github.com/users/promag/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "02fafdd12ccad91d4fdebb010134d84a31c055f3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/02fafdd12ccad91d4fdebb010134d84a31c055f3",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/02fafdd12ccad91d4fdebb010134d84a31c055f3"
      }
    ],
    "stats": {
      "total": 45,
      "additions": 19,
      "deletions": 26
    },
    "files": [
      {
        "sha": "46e7038780d135e2699c7f3c78088787c2a27577",
        "filename": "src/qt/receivecoinsdialog.cpp",
        "status": "modified",
        "additions": 13,
        "deletions": 13,
        "changes": 26,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bbb33d6431d13a0ae244ab2beca506126a6430e7/src/qt/receivecoinsdialog.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bbb33d6431d13a0ae244ab2beca506126a6430e7/src/qt/receivecoinsdialog.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/receivecoinsdialog.cpp?ref=bbb33d6431d13a0ae244ab2beca506126a6430e7",
        "patch": "@@ -70,15 +70,17 @@ void ReceiveCoinsDialog::setModel(WalletModel *_model)\n \n     if(_model && _model->getOptionsModel())\n     {\n-        _model->getRecentRequestsTableModel()->sort(RecentRequestsTableModel::Date, Qt::DescendingOrder);\n+        assert(m_recent_requests_table_model == nullptr);\n+        m_recent_requests_table_model = new RecentRequestsTableModel(_model);\n+        m_recent_requests_table_model->sort(RecentRequestsTableModel::Date, Qt::DescendingOrder);\n         connect(_model->getOptionsModel(), &OptionsModel::displayUnitChanged, this, &ReceiveCoinsDialog::updateDisplayUnit);\n         updateDisplayUnit();\n \n         QTableView* tableView = ui->recentRequestsView;\n \n         tableView->verticalHeader()->hide();\n         tableView->setHorizontalScrollBarPolicy(Qt::ScrollBarAlwaysOff);\n-        tableView->setModel(_model->getRecentRequestsTableModel());\n+        tableView->setModel(m_recent_requests_table_model);\n         tableView->setAlternatingRowColors(true);\n         tableView->setSelectionBehavior(QAbstractItemView::SelectRows);\n         tableView->setSelectionMode(QAbstractItemView::ContiguousSelection);\n@@ -141,7 +143,7 @@ void ReceiveCoinsDialog::updateDisplayUnit()\n \n void ReceiveCoinsDialog::on_receiveButton_clicked()\n {\n-    if(!model || !model->getOptionsModel() || !model->getAddressTableModel() || !model->getRecentRequestsTableModel())\n+    if(!model || !model->getOptionsModel() || !model->getAddressTableModel() || !m_recent_requests_table_model)\n         return;\n \n     QString address;\n@@ -167,15 +169,14 @@ void ReceiveCoinsDialog::on_receiveButton_clicked()\n     clear();\n \n     /* Store request for later reference */\n-    model->getRecentRequestsTableModel()->addNewRequest(info);\n+    m_recent_requests_table_model->addNewRequest(info);\n }\n \n void ReceiveCoinsDialog::on_recentRequestsView_doubleClicked(const QModelIndex &index)\n {\n-    const RecentRequestsTableModel *submodel = model->getRecentRequestsTableModel();\n     ReceiveRequestDialog *dialog = new ReceiveRequestDialog(this);\n     dialog->setModel(model);\n-    dialog->setInfo(submodel->entry(index.row()).recipient);\n+    dialog->setInfo(m_recent_requests_table_model->entry(index.row()).recipient);\n     dialog->setAttribute(Qt::WA_DeleteOnClose);\n     dialog->show();\n }\n@@ -190,7 +191,7 @@ void ReceiveCoinsDialog::recentRequestsView_selectionChanged(const QItemSelectio\n \n void ReceiveCoinsDialog::on_showRequestButton_clicked()\n {\n-    if(!model || !model->getRecentRequestsTableModel() || !ui->recentRequestsView->selectionModel())\n+    if(!model || !m_recent_requests_table_model || !ui->recentRequestsView->selectionModel())\n         return;\n     QModelIndexList selection = ui->recentRequestsView->selectionModel()->selectedRows();\n \n@@ -201,14 +202,14 @@ void ReceiveCoinsDialog::on_showRequestButton_clicked()\n \n void ReceiveCoinsDialog::on_removeRequestButton_clicked()\n {\n-    if(!model || !model->getRecentRequestsTableModel() || !ui->recentRequestsView->selectionModel())\n+    if(!model || !m_recent_requests_table_model || !ui->recentRequestsView->selectionModel())\n         return;\n     QModelIndexList selection = ui->recentRequestsView->selectionModel()->selectedRows();\n     if(selection.empty())\n         return;\n     // correct for selection mode ContiguousSelection\n     QModelIndex firstIndex = selection.at(0);\n-    model->getRecentRequestsTableModel()->removeRows(firstIndex.row(), selection.length(), firstIndex.parent());\n+    m_recent_requests_table_model->removeRows(firstIndex.row(), selection.length(), firstIndex.parent());\n }\n \n // We override the virtual resizeEvent of the QWidget to adjust tables column\n@@ -237,7 +238,7 @@ void ReceiveCoinsDialog::keyPressEvent(QKeyEvent *event)\n \n QModelIndex ReceiveCoinsDialog::selectedRow()\n {\n-    if(!model || !model->getRecentRequestsTableModel() || !ui->recentRequestsView->selectionModel())\n+    if(!model || !m_recent_requests_table_model || !ui->recentRequestsView->selectionModel())\n         return QModelIndex();\n     QModelIndexList selection = ui->recentRequestsView->selectionModel()->selectedRows();\n     if(selection.empty())\n@@ -254,7 +255,7 @@ void ReceiveCoinsDialog::copyColumnToClipboard(int column)\n     if (!firstIndex.isValid()) {\n         return;\n     }\n-    GUIUtil::setClipboard(model->getRecentRequestsTableModel()->index(firstIndex.row(), column).data(Qt::EditRole).toString());\n+    GUIUtil::setClipboard(m_recent_requests_table_model->index(firstIndex.row(), column).data(Qt::EditRole).toString());\n }\n \n // context menu\n@@ -274,8 +275,7 @@ void ReceiveCoinsDialog::copyURI()\n         return;\n     }\n \n-    const RecentRequestsTableModel * const submodel = model->getRecentRequestsTableModel();\n-    const QString uri = GUIUtil::formatBitcoinURI(submodel->entry(sel.row()).recipient);\n+    const QString uri = GUIUtil::formatBitcoinURI(m_recent_requests_table_model->entry(sel.row()).recipient);\n     GUIUtil::setClipboard(uri);\n }\n "
      },
      {
        "sha": "e400129f798a0942aa2d31c6177176842cded621",
        "filename": "src/qt/receivecoinsdialog.h",
        "status": "modified",
        "additions": 4,
        "deletions": 0,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bbb33d6431d13a0ae244ab2beca506126a6430e7/src/qt/receivecoinsdialog.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bbb33d6431d13a0ae244ab2beca506126a6430e7/src/qt/receivecoinsdialog.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/receivecoinsdialog.h?ref=bbb33d6431d13a0ae244ab2beca506126a6430e7",
        "patch": "@@ -16,6 +16,7 @@\n #include <QVariant>\n \n class PlatformStyle;\n+class RecentRequestsTableModel;\n class WalletModel;\n \n namespace Ui {\n@@ -44,6 +45,8 @@ class ReceiveCoinsDialog : public QDialog\n \n     void setModel(WalletModel *model);\n \n+    RecentRequestsTableModel* recentRequestsTableModel() const { return m_recent_requests_table_model; }\n+\n public Q_SLOTS:\n     void clear();\n     void reject();\n@@ -56,6 +59,7 @@ public Q_SLOTS:\n     Ui::ReceiveCoinsDialog *ui;\n     GUIUtil::TableViewLastColumnResizingFixer *columnResizingFixer;\n     WalletModel *model;\n+    RecentRequestsTableModel* m_recent_requests_table_model{nullptr};\n     QMenu *contextMenu;\n     const PlatformStyle *platformStyle;\n "
      },
      {
        "sha": "c15b1c0d698468ea26055d45824a6bc267dc2226",
        "filename": "src/qt/test/wallettests.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 1,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bbb33d6431d13a0ae244ab2beca506126a6430e7/src/qt/test/wallettests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bbb33d6431d13a0ae244ab2beca506126a6430e7/src/qt/test/wallettests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/test/wallettests.cpp?ref=bbb33d6431d13a0ae244ab2beca506126a6430e7",
        "patch": "@@ -212,7 +212,8 @@ void TestGUI(interfaces::Node& node)\n     // Check Request Payment button\n     ReceiveCoinsDialog receiveCoinsDialog(platformStyle.get());\n     receiveCoinsDialog.setModel(&walletModel);\n-    RecentRequestsTableModel* requestTableModel = walletModel.getRecentRequestsTableModel();\n+    RecentRequestsTableModel* requestTableModel = receiveCoinsDialog.recentRequestsTableModel();\n+    assert(requestTableModel);\n \n     // Label input\n     QLineEdit* labelInput = receiveCoinsDialog.findChild<QLineEdit*>(\"reqLabel\");"
      },
      {
        "sha": "90d03ec1738c31281b7209d7e7be9e6d17a21f10",
        "filename": "src/qt/walletmodel.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 8,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bbb33d6431d13a0ae244ab2beca506126a6430e7/src/qt/walletmodel.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bbb33d6431d13a0ae244ab2beca506126a6430e7/src/qt/walletmodel.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/walletmodel.cpp?ref=bbb33d6431d13a0ae244ab2beca506126a6430e7",
        "patch": "@@ -13,7 +13,6 @@\n #include <qt/guiutil.h>\n #include <qt/optionsmodel.h>\n #include <qt/paymentserver.h>\n-#include <qt/recentrequeststablemodel.h>\n #include <qt/sendcoinsdialog.h>\n #include <qt/transactiontablemodel.h>\n \n@@ -36,14 +35,12 @@\n WalletModel::WalletModel(std::unique_ptr<interfaces::Wallet> wallet, interfaces::Node& node, const PlatformStyle *platformStyle, OptionsModel *_optionsModel, QObject *parent) :\n     QObject(parent), m_wallet(std::move(wallet)), m_node(node), optionsModel(_optionsModel), addressTableModel(nullptr),\n     transactionTableModel(nullptr),\n-    recentRequestsTableModel(nullptr),\n     cachedEncryptionStatus(Unencrypted),\n     cachedNumBlocks(0)\n {\n     fHaveWatchOnly = m_wallet->haveWatchOnly();\n     addressTableModel = new AddressTableModel(this);\n     transactionTableModel = new TransactionTableModel(platformStyle, this);\n-    recentRequestsTableModel = new RecentRequestsTableModel(this);\n \n     subscribeToCoreSignals();\n }\n@@ -276,11 +273,6 @@ TransactionTableModel *WalletModel::getTransactionTableModel()\n     return transactionTableModel;\n }\n \n-RecentRequestsTableModel *WalletModel::getRecentRequestsTableModel()\n-{\n-    return recentRequestsTableModel;\n-}\n-\n WalletModel::EncryptionStatus WalletModel::getEncryptionStatus() const\n {\n     if(!m_wallet->isCrypted())"
      },
      {
        "sha": "3066ed611ae0be8ee39675d0156d30ec1cd45ec5",
        "filename": "src/qt/walletmodel.h",
        "status": "modified",
        "additions": 0,
        "deletions": 3,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bbb33d6431d13a0ae244ab2beca506126a6430e7/src/qt/walletmodel.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bbb33d6431d13a0ae244ab2beca506126a6430e7/src/qt/walletmodel.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/walletmodel.h?ref=bbb33d6431d13a0ae244ab2beca506126a6430e7",
        "patch": "@@ -26,7 +26,6 @@ enum class OutputType;\n class AddressTableModel;\n class OptionsModel;\n class PlatformStyle;\n-class RecentRequestsTableModel;\n class SendCoinsRecipient;\n class TransactionTableModel;\n class WalletModelTransaction;\n@@ -78,7 +77,6 @@ class WalletModel : public QObject\n     OptionsModel *getOptionsModel();\n     AddressTableModel *getAddressTableModel();\n     TransactionTableModel *getTransactionTableModel();\n-    RecentRequestsTableModel *getRecentRequestsTableModel();\n \n     EncryptionStatus getEncryptionStatus() const;\n \n@@ -172,7 +170,6 @@ class WalletModel : public QObject\n \n     AddressTableModel *addressTableModel;\n     TransactionTableModel *transactionTableModel;\n-    RecentRequestsTableModel *recentRequestsTableModel;\n \n     // Cache some values to be able to detect changes\n     interfaces::WalletBalances m_cached_balances;"
      },
      {
        "sha": "fbea48f2c35dd13dce94e9d0b97f4ef77125f600",
        "filename": "test/lint/lint-circular-dependencies.sh",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bbb33d6431d13a0ae244ab2beca506126a6430e7/test/lint/lint-circular-dependencies.sh",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bbb33d6431d13a0ae244ab2beca506126a6430e7/test/lint/lint-circular-dependencies.sh",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/lint/lint-circular-dependencies.sh?ref=bbb33d6431d13a0ae244ab2beca506126a6430e7",
        "patch": "@@ -14,7 +14,6 @@ EXPECTED_CIRCULAR_DEPENDENCIES=(\n     \"policy/fees -> txmempool -> policy/fees\"\n     \"qt/addresstablemodel -> qt/walletmodel -> qt/addresstablemodel\"\n     \"qt/bitcoingui -> qt/walletframe -> qt/bitcoingui\"\n-    \"qt/recentrequeststablemodel -> qt/walletmodel -> qt/recentrequeststablemodel\"\n     \"qt/sendcoinsdialog -> qt/walletmodel -> qt/sendcoinsdialog\"\n     \"qt/transactiontablemodel -> qt/walletmodel -> qt/transactiontablemodel\"\n     \"txmempool -> validation -> txmempool\""
      }
    ]
  }
]