jgarzik,2013-06-12T13:46:08Z,"ACK code change.  Administrivia:\n\n1) git commit message should include text such as ""fixes #2534"" or similar.  Your pull request text included information that should be archived permanently inside the commit message.  In general, commit messages should be more informative than this.\n\n2) We are currently deployed with a buggy BIP 37 interpretation.  We should consider whether it warrants bumpi",https://github.com/bitcoin/bitcoin/pull/2763#issuecomment-19326245,19326245,
BitcoinPullTester,2013-06-12T23:23:28Z,"Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/c87f462b74fe94ddf7ac1018c399bb9772776e16 for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/cu",https://github.com/bitcoin/bitcoin/pull/2763#issuecomment-19362165,19362165,
mikehearn,2013-06-13T11:59:31Z,"It's not really a protocol change, is it? It's just a change in the reference client implementation.\n",https://github.com/bitcoin/bitcoin/pull/2763#issuecomment-19387151,19387151,
ghost,2013-06-13T12:03:12Z,It is a bug fix but might answer the question if protocol > reference implementation :) \n,https://github.com/bitcoin/bitcoin/pull/2763#issuecomment-19387308,19387308,
sipa,2013-06-13T12:05:06Z,"All fields in the version message except for the first ones are optional - clients need to be prepared for both missing fields or more fields than they know, as this is exchanged before the protocol version is negotiated. Because of that, it cannot be a protocol change, and it's not a bug fix either.\n\nI'm in favor of this however, it makes behaviour more consistent across clients.\n",https://github.com/bitcoin/bitcoin/pull/2763#issuecomment-19387381,19387381,
ghost,2013-06-13T12:06:30Z,I doubt series of fields can be optional since they are not identified by the serialization. How to parse then if we add more?\n,https://github.com/bitcoin/bitcoin/pull/2763#issuecomment-19387445,19387445,
mikehearn,2013-06-13T12:08:41Z,"LGTM\n\nIt's in the code - you don't have to add the last field, but if you do, you have to add all the preceding fields too.\n\nSipa is right, we should merge this, although it's a fairly minor thing.\n",https://github.com/bitcoin/bitcoin/pull/2763#issuecomment-19387540,19387540,
sipa,2013-06-13T12:10:00Z,"This is how the reference client parses it: https://github.com/bitcoin/bitcoin/blob/v0.8.2/src/main.cpp#L3201\n\nEssentially by checking whether we're at the end of the message already. And yes it must be optional, as you're parsing/sending this before you know which version the peer supports.\n",https://github.com/bitcoin/bitcoin/pull/2763#issuecomment-19387592,19387592,
ghost,2013-06-13T12:24:38Z,"Since the version number is preceding this in the message, optionality is not mandatory but chosen. I think it would be more future proof and flexible to decide on the structure by version read and not by checking the length. I believe the current way of parsing is ugly, but agree is sustainable.\n",https://github.com/bitcoin/bitcoin/pull/2763#issuecomment-19388161,19388161,
sipa,2013-06-13T12:27:35Z,"The version isn't acked by the peer yet, so you don't know whether they'll support it. But indeed that's just a problem in one direction, not both. And yes, it's ugly. For more complex extensions later a separate message may be more appropriate...\n",https://github.com/bitcoin/bitcoin/pull/2763#issuecomment-19388298,19388298,
sipa,2013-06-14T10:25:35Z,ACK\n,https://github.com/bitcoin/bitcoin/pull/2763#issuecomment-19449786,19449786,
mikehearn,2013-06-17T08:13:44Z,This has two ACKs so should be mergeable now.\n,https://github.com/bitcoin/bitcoin/pull/2763#issuecomment-19531424,19531424,
jgarzik,2013-06-17T14:31:08Z,"IRC user reports this change causes a remote node (ver 32200) over Tor to drop them (socket error 104, connection reset by peer).  Reverting this change fixes the issue.\n",https://github.com/bitcoin/bitcoin/pull/2763#issuecomment-19548658,19548658,
mikehearn,2013-06-17T15:01:53Z,"Ver 32200 has been/will be hard forked off, so I'm not sure why we should care?\n",https://github.com/bitcoin/bitcoin/pull/2763#issuecomment-19550812,19550812,
sipa,2013-06-17T15:19:05Z,"Yes, that is true, but because of a reason completely unrelated to the P2P protocol, so we should at least find out why this results in not accepting these version messages - who knows which other versions are involved?\n",https://github.com/bitcoin/bitcoin/pull/2763#issuecomment-19551992,19551992,
ghost,2013-06-17T15:23:09Z,"It is wise to investigate, it however would mean that the flag would not be optional but must be absent to work.\n",https://github.com/bitcoin/bitcoin/pull/2763#issuecomment-19552276,19552276,
gmaxwell,2013-06-17T15:26:39Z,Or there is just some broken alternative implementation sending that version string which is intolerant of the flag.\n,https://github.com/bitcoin/bitcoin/pull/2763#issuecomment-19552523,19552523,
mikehearn,2013-06-17T15:29:40Z,That sounds like a more reasonable explanation.\n,https://github.com/bitcoin/bitcoin/pull/2763#issuecomment-19552749,19552749,
