laanwj,2017-01-12T11:06:22Z,"> Currently pruneblockchain(0) will call StateFlushToDisk. This might not be required/wanted.\n\nIf it doesn't cause an error or corruption, I'd prefer not to add a special case for it. There is no reason for calling it with 0 so if there is a slight performance overhead when that's done, that's too bad.",https://github.com/bitcoin/bitcoin/pull/9524#issuecomment-272136312,272136312,
MarcoFalke,2017-01-12T11:12:30Z,"The thing is that it clashes with the default value of FlushStateToDisk(nManualPruneHeight=0), which is used to indicate ""legacy"" pruning. It might cause unwanted bugs if someone refactors the code in the future.",https://github.com/bitcoin/bitcoin/pull/9524#issuecomment-272137391,272137391,
laanwj,2017-01-12T11:22:19Z,"Okay, true. On one hand this is adding belt and suspenders it's just that I prefer the underlying code to be robust to cases like this instead of catching potential errors on the RPC interface. But yes you have a point too, I don't know...\n",https://github.com/bitcoin/bitcoin/pull/9524#issuecomment-272139274,272139274,
laanwj,2017-02-17T08:18:04Z,"> The thing is that it clashes with the default value of FlushStateToDisk(nManualPruneHeight=0), which is used to indicate ""legacy"" pruning. It might cause unwanted bugs if someone refactors the code in the future.\n\nIt seems that in that case there will also be automatic problems. On IRC yesterday there was a discussion about this, and there are more paths through which it will get into `Flush",https://github.com/bitcoin/bitcoin/pull/9524#issuecomment-280584502,280584502,
laanwj,2017-04-19T08:32:50Z,"Ok, I still stand by what I said above, the code in question should be refactored as there are various paths where this could theoretically go wrong, catching this at the RPC call site will only solve one entry point, and for the right might hide eventual problems further. \n\nE.g. let's say we added a test that calls pruneblockchain(0) and verifies that it does nothing would no longer test anyt",https://github.com/bitcoin/bitcoin/pull/9524#issuecomment-295163324,295163324,
