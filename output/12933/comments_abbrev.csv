ryanofsky,2018-04-10T19:10:23Z,Also @sipa since this is changing the guideline added in #10575.,https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380214612,380214612,
laanwj,2018-04-10T19:11:02Z,I agree. I think we went overboard with this.,https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380214806,380214806,
MarcoFalke,2018-04-10T19:16:11Z,"> I think the checks the script does within source files are useful and not a burden\n\nI don't think having a duplicate include will ever happen. Even if it does happen, there is no harm and it can be easily fixed once every couple of years.",https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380216321,380216321,
practicalswift,2018-04-10T20:07:25Z,"@MarcoFalke The PR title feels a bit misleading since the main part of this PR is the policy change (the policy introduced by @sipa in #10575). The linting is just a ""regression test"" for that policy.\n\nWhat about changing the title to ""Change #include policy"" or similar?",https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380230011,380230011,
practicalswift,2018-04-10T20:12:53Z,"NACK\n\nI think the header include policy introduced by @sipa in #10575 is reasonable.\n\nAssuming that we keep @sipa:s policy then having a regression test for it in Travis to guard against newly introduced violations seems reasonable as well.\n\nHaving a Travis check for developer note violations will avoid having human reviewers point out nits/violations that could have be addressed pre-h",https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380231525,380231525,
MarcoFalke,2018-04-10T20:14:20Z,"> What about changing the title to ""Change #include policy"" or similar?\n\nThanks, done.",https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380231917,380231917,
MarcoFalke,2018-04-10T21:56:58Z,"@practicalswift I am only aware of three cases of actual duplicate includes in the last three years ( #10840, #10561 and #6187) and I don't think it is worth to keep the lint check, since there is no harm in having those.",https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380260634,380260634,
MarcoFalke,2018-04-10T21:59:11Z,"Ok, whatever. Kept the duplicate include check.",https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380261177,380261177,
practicalswift,2018-04-11T05:59:19Z,"@MarcoFalke If the suggested policy is that we should have Travis checks only for things that cause harm in a strict technical sense, then it follows that we should remove `lint-whitespace.sh` and some of the other linters too?",https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380336646,380336646,
kallewoof,2018-04-11T07:52:33Z,"I honestly don't understand the desire to limit automated testing. Is this because we expect the linters to cause false positives and/or to break so often that we need to actively maintain them? If a linter causes false positives, it should simply be removed, period, and I have a hard time seeing a simple shell script breaking very often.\n\nPersonally I think we should automate anything that ca",https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380361509,380361509,
MarcoFalke,2018-04-11T12:22:22Z,"> @MarcoFalke If the suggested policy is that we should have Travis checks only for things that cause harm in a strict technical sense, then it follows that we should remove lint-whitespace.sh and some of the other linters too?\n\nChecking for trailing whitespace is done, since some code editors remove that whenever you open/close a file. That burdens the developers that have this setting turned",https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380432388,380432388,
MarcoFalke,2018-04-11T12:24:20Z,@kallewoof The current changes in this pull *keep*  the duplicate include check linter. I am no longer removing it.,https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380432901,380432901,
MarcoFalke,2018-04-11T14:48:29Z,"Going to merge this to fix annoying travis failures for some develpers, since my merge of #11878 was too quick apparently.\n\nFurther refinement of the policy or linter scripts can be done in follow up pull requests.",https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380479749,380479749,
jnewbery,2018-04-11T20:51:30Z,"> Going to merge this\n\nPremature in my opinion. This changes the style policy and had one ACK and one NACK. Better to wait until consensus is clear.",https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380591570,380591570,
MarcoFalke,2018-04-11T21:06:44Z,"@jnewbery I see 3 ACKS (laanwj, ryanofsky, and myself) and one NACK (practicalswift). kallewoof seemed to have some general disagreement about removing linters and I assumed it was related to a previous version of my pull request, which removed the whole linter script.\n\nSince my merge of #11878 caused issues for any dev using iwyu, I wanted to get in the travis fix rather sooner than later. Wi",https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380595803,380595803,
jnewbery,2018-04-11T21:11:11Z,"> I see 3 ACKS (laanwj, ryanofsky, and myself)\n\nwumpus's ACK was prior to your last commit changing the policy, and a PR author's ACK doesn't usually count :)\n\nNote that this also partially reverts #10575, which had many more ACKs.\n\nI'm not saying merging this is the wrong move, just that it's premature without wider consensus.",https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380596996,380596996,
randolf,2018-04-11T23:12:46Z,@jnewbery Do you think it could be possible to find a solution that satisfies the NACKs at the same time?,https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380624229,380624229,
kallewoof,2018-04-12T00:38:05Z,"@MarcoFalke Yes, I should have clarified. I was talking about the general aversion for automated linters and tests to make the code more uniform, not this particular PR.\n\nI also think in general a PR should not be merged by its author if it is contentious in any way, to ensure that people are in agreement.",https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380638119,380638119,
sipa,2018-04-12T01:25:48Z,"There are 3 different questions here:\n1. What the header include guideline should be.\n2. Whether that guideline is to be enforced as a policy for all PRs.\n3. Whether that policy should be automatically enforced by a linter.\n\nMy impression is that this PR seems to have been created out of a displeasure with (3), and overreacting by changing (1) and (2) as well.\n\nAs for the guideline i",https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380645232,380645232,
MarcoFalke,2018-04-12T01:26:10Z,"I want to apologize if this change was not in agreement or controversial. I primarily wanted a quick fix after I realized that #11878 was breaking existing workflows and resulted in confusing travis failures.\n\nIs there anything I could do to address peoples dislike of my merge?",https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380645286,380645286,
MarcoFalke,2018-04-12T01:28:32Z,"@sipa Thanks for your input.\n\nWould everyone be happy if my changes to the developer guidelines are reverted, but the additional travis linter check left out (for now at least)?",https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380645709,380645709,
ryanofsky,2018-04-12T01:46:47Z,"> Would everyone be happy if my changes to the developer guidelines are reverted, but the additional travis linter check left out (for now at least)?\n\nI'd be unhappy about this (but obviously could live with it) because I like to use the iwyu tool which is incompatible with it, and also because I think previous developer guideline was very strange. I've been writing c++ a long time, and ""inclu",https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380648418,380648418,
MarcoFalke,2018-04-12T01:53:57Z,"@ryanofsky The wording seems to be lax about it and doesn't forbid iwyu or requires linters to be run. \n\n> Every `.cpp` and `.h` file ***should*** `#include` every header file it directly uses classes, functions or other definitions from, even if those headers are already included indirectly through other headers. One exception is that a `.cpp` file ***does not need*** to re-include the includ",https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380649543,380649543,
MarcoFalke,2018-04-12T01:54:33Z,Please provide further feedback and review in #12960,https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380649615,380649615,
jnewbery,2018-04-12T14:28:46Z,"> I primarily wanted a quick fix...\n\nThat's understood. I certainly didn't mean to question your reasons for merging - I just wanted to point out that in my opinion it wasn't necessary to merge quite so quickly since there was an outstanding concern from one of the regular contributors.",https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-380825292,380825292,
skeees,2018-04-13T14:44:20Z,At the risk of complicating this further - should the guidelines attempt to specify if/when a forward declare is preferable over an include - there are a bunch of existing forward declares and these notes seem to suggest that an include should always be preferable,https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-381158082,381158082,
MarcoFalke,2018-04-13T15:09:38Z,"@skeees I think you are free to use forward declares whenever they are sufficient and it helps to reduce the number of headers that are included in that header (and thus in the places where the header is used). Though, I think it is not worth to enforce this in any way.",https://github.com/bitcoin/bitcoin/pull/12933#issuecomment-381166299,381166299,
practicalswift,2018-04-10T20:33:12Z,Please don't extend the scope beyond what is needed for your suggested policy change. No need to touch anything beyond `DUPLICATE_INCLUDES_IN_HEADER_AND_CPP_FILES` if we're switching to a new policy.,https://github.com/bitcoin/bitcoin/pull/12933#discussion_r180558425,180558425,contrib/devtools/lint-includes.sh
ryanofsky,2018-04-11T14:38:46Z,Possible followup (for a future pr) could be merge h/cpp loops since the files are treated the same now.,https://github.com/bitcoin/bitcoin/pull/12933#discussion_r180778112,180778112,contrib/devtools/lint-includes.sh
