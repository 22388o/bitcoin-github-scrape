DrahtBot,2020-12-15 07:40:38,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19952 (build, ci: Add file-based logging for individual packages by hebasto)\n\nIf you consider this pull request importa",https://github.com/bitcoin/bitcoin/pull/20658#issuecomment-745113533,745113533,
hebasto,2020-12-15 18:18:59,Concept ACK.,https://github.com/bitcoin/bitcoin/pull/20658#issuecomment-745473553,745473553,
MarcoFalke,2020-12-16 06:26:07,ACK 739d39022d2959c1114c14a0065daebf4fe812c1,https://github.com/bitcoin/bitcoin/pull/20658#issuecomment-745795057,745795057,
dhruv,2020-12-17 06:29:00,Ready for re-review.,https://github.com/bitcoin/bitcoin/pull/20658#issuecomment-747239479,747239479,
MarcoFalke,2020-12-17 08:04:15,ACK 4045a6722c884be779e86016313061ac6ff80808,https://github.com/bitcoin/bitcoin/pull/20658#issuecomment-747279977,747279977,
hebasto,2020-12-17 13:41:37,"On my personal account having some _""fatal: Not a valid object name master""_ warnings:\n- https://cirrus-ci.com/task/5075924871806976?command=lint#L49\n- https://cirrus-ci.com/task/5075924871806976?command=lint#L93",https://github.com/bitcoin/bitcoin/pull/20658#issuecomment-747445563,747445563,
hebasto,2020-12-17 13:57:34,"Also in the merge commit, https://cirrus-ci.com/task/6086189209878528?command=lint#L50:\n```\nSkipping shell linting since shellcheck is not installed.\n```\n",https://github.com/bitcoin/bitcoin/pull/20658#issuecomment-747454167,747454167,
MarcoFalke,2020-12-17 14:17:07,Missing packages are installed in #20682 ,https://github.com/bitcoin/bitcoin/pull/20658#issuecomment-747464817,747464817,
dhruv,2020-12-17 15:14:43,"Thanks for catching those, @hebasto. I should've looked closer.",https://github.com/bitcoin/bitcoin/pull/20658#issuecomment-747500044,747500044,
MarcoFalke,2020-12-15 07:01:56,"The linter scripts heavily depend on the ci platform because they use $TRAVIS or $CIRRUS env vars, so I think the script here can just be inlined into the platform.yml ",https://github.com/bitcoin/bitcoin/pull/20658#discussion_r543094235,543094235,ci/lint/lint_run_all.sh
MarcoFalke,2020-12-15 07:02:44,why?,https://github.com/bitcoin/bitcoin/pull/20658#discussion_r543094589,543094589,ci/lint/05_before_script.sh
MarcoFalke,2020-12-15 07:03:06,"there is `./ci/retry`, which can be used instead",https://github.com/bitcoin/bitcoin/pull/20658#discussion_r543094740,543094740,ci/lint/04_install.sh
MarcoFalke,2020-12-15 07:05:46,"Please re-add the comment here that says \n\n```\n    For   python: '3.6' # Oldest supported version according to doc/dependencies.md",https://github.com/bitcoin/bitcoin/pull/20658#discussion_r543096052,543096052,.cirrus.yml
MarcoFalke,2020-12-15 07:07:31,"Is this really needed? I somehow supspect that setting up the cache and fetching from it is slower than fetching from the pip servers directly. Or at the least, it is not measurable and we don't care about a few milliseconds here or there anyway.",https://github.com/bitcoin/bitcoin/pull/20658#discussion_r543096885,543096885,.cirrus.yml
MarcoFalke,2020-12-15 07:08:22,Maybe move this to a `GLOBAL_BASE_TEMPLATE` to avoid duplication?,https://github.com/bitcoin/bitcoin/pull/20658#discussion_r543097249,543097249,.cirrus.yml
MarcoFalke,2020-12-15 07:10:58,"Could run the linters with compute credits? The most frustrating thing is waiting for the linters to fail (or pass)\n\n\n```\n  # For faster CI feedback, immediately schedule the linters. https://cirrus-ci.org/pricing/#compute-credits\n  use_compute_credits: $CIRRUS_REPO_FULL_NAME == 'bitcoin/bitcoin'",https://github.com/bitcoin/bitcoin/pull/20658#discussion_r543098469,543098469,.cirrus.yml
dhruv,2020-12-15 17:36:07,"On Cirrus-CI, I received:\n\n`fatal: --unshallow on a complete repository does not make sense`",https://github.com/bitcoin/bitcoin/pull/20658#discussion_r543547365,543547365,ci/lint/05_before_script.sh
MarcoFalke,2020-12-15 17:49:44,`merge_base_script` should also be part of the base template,https://github.com/bitcoin/bitcoin/pull/20658#discussion_r543557372,543557372,.cirrus.yml
MarcoFalke,2020-12-15 17:50:21,"```suggestion\ntask:\n```\n\nCan be shorter (because you provided a `name:` )",https://github.com/bitcoin/bitcoin/pull/20658#discussion_r543557802,543557802,.cirrus.yml
MarcoFalke,2020-12-15 17:51:49,Can reduce the cpu to `1` to cut the bill in half?,https://github.com/bitcoin/bitcoin/pull/20658#discussion_r543558888,543558888,.cirrus.yml
MarcoFalke,2020-12-15 17:52:43,Can each line be a separate script?,https://github.com/bitcoin/bitcoin/pull/20658#discussion_r543559589,543559589,.cirrus.yml
MarcoFalke,2020-12-15 17:56:02,the retry missing here?,https://github.com/bitcoin/bitcoin/pull/20658#discussion_r543561992,543561992,ci/lint/06_script.sh
dhruv,2020-12-15 19:09:07,"```yaml \ncontainer:\n   image: ubuntu:bionic # For python 3.6, oldest supported version according to doc/dependencies.md\n   cpu: 1.0 # Cut the bill in half\n```\n\nResulted in:\n```\nFailed to start an instance: INVALID_ARGUMENT: Bad Request.\n```\n\nCould you share a pointer on how to do this? I found nothing except [this](https://cirrus-ci.org/guide/writing-tasks/#additional-contain",https://github.com/bitcoin/bitcoin/pull/20658#discussion_r543613848,543613848,.cirrus.yml
MarcoFalke,2020-12-16 06:24:47,"cpu can only be integral, not floating point.\n\nAlso, you might have to move this hunk into the GLOBAL_TASK_TEMPLATE to avoid collisions:\n\n```\ntimeout_in: 120m  # https://cirrus-ci.org/faq/#instance-timed-out\ncontainer:\n  # https://cirrus-ci.org/faq/#are-there-any-limits\n  # Each project has 16 CPU in total, assign 2 to each container, so that 8 tasks run in parallel\n  cpu: 2\n  ",https://github.com/bitcoin/bitcoin/pull/20658#discussion_r544020334,544020334,.cirrus.yml
MarcoFalke,2020-12-16 06:28:18,You can also leave it as is for now. Can be addressed later (or in a new commit),https://github.com/bitcoin/bitcoin/pull/20658#discussion_r544022826,544022826,.cirrus.yml
dhruv,2020-12-17 01:55:19,That seems to have done the trick. I've added a commit: 4045a67. ,https://github.com/bitcoin/bitcoin/pull/20658#discussion_r544752914,544752914,.cirrus.yml
MarcoFalke,2020-12-17 07:46:18,"No need for that comment. Can remove or just say 1 is sufficient\n\n```suggestion\n    cpu: 1\n```\n\n```suggestion\n    cpu: 1  # No need for more CPUs\n```",https://github.com/bitcoin/bitcoin/pull/20658#discussion_r544875845,544875845,.cirrus.yml
MarcoFalke,2020-12-17 07:47:28,"btw, based on this plot https://cirrus-ci.com/task/4624095184683008\n\nmemory can also be set to 1",https://github.com/bitcoin/bitcoin/pull/20658#discussion_r544876495,544876495,.cirrus.yml
