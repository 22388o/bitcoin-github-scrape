luke-jr,2017-08-20T21:59:37Z,"NACK, these are not sensible. If anything, they should be reduced.",https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-323614718,323614718,
laanwj,2017-08-21T07:59:10Z,"Please, not again, no more defaults fighting...\n",https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-323673693,323673693,
gmaxwell,2017-08-23T00:17:00Z,"ACK. The current settings are reprehensible: They result in _guaranteed_ income reduction for anyone who follows them for almost no measurable benefit-- because as we see almost everyone maxes them out regardless.   The losses are also not trivial, but are often about 5% of mining income-- which wasn't the case when they were last discussed but is now.\n\nLuke's argument rests on an unlikely and",https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-324185973,324185973,
laanwj,2017-08-23T10:31:06Z,"Previous discussion was here (possibly more, but these I could find in a quick search):\n\n- Increase DEFAULT_BLOCK_MAX_SIZE to 1MB #6231\n- Increase DEFAULT_BLOCK_MAX_SIZE to 1MB #7622\n- Updating default max block size #8268\n\nAs we know all miners will override the defaults, and for other users the value doesn't matter, I think this is a pointless waste of energy, creating angry discussi",https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-324289110,324289110,
janbraiins,2017-08-24T06:10:30Z,"Hi,\nthis make sense to me. From pool operator's prospective, we set this to max for the reasons stated by Greg. What is confusing is that without researching the code, it is not quite clear how each of the limits influence each other. A sane default for us was just to set blockmaxweight, having the core derive the blockmaxsize.\nJan ",https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-324542738,324542738,
gmaxwell,2017-08-24T08:53:19Z,"@honzik666 Right, the correct settings are to remove any mention of blockmaxsize from your configuration and set only blockmaxweight=4000000.\n\nBlockmaxsize is a legacy option that wasn't even existent at first in the segwit settings. It doesn't make sense to use it, setting it (at least to anything other than the maximum of 4 million) will just lower your income.\n",https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-324575290,324575290,
TheBlueMatt,2017-08-24T15:42:17Z,"Pushed a new commit to hopefully help address the confusion that a few people have had on these options, which also fixes a bug or two in the process.",https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-324674358,324674358,
meshcollider,2017-08-24T19:25:08Z,Concept ACK as discussed in meeting,https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-324732731,324732731,
morcos,2017-08-24T19:33:42Z,Concept ACK,https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-324734714,324734714,
luke-jr,2017-08-24T19:37:37Z,"Miners have in recent years maxed out 1 MB. That is completely different from 4 MB, and does not prove they will increase to 4 MB immediately in any sense.\n\n> Luke's argument rests on an unlikely and now conclusively disproven theory that miners will individually act against their own short term economic best interests to preserve the usability of the network. \n\nIt has not been disproven. ",https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-324735610,324735610,
jameshilliard,2017-08-24T20:22:09Z,"ACK\n\n> Block propagation has been ""solved"" by centralised relay networks (FIBRE) and SPV mining, both of which are harmful to the network and not real solutions.\n\nEven without FIBRE or SPV mining it makes individual economic sense for miners to mine max weight blocks due to relatively high transaction fees and compact blocks having a significant improvement on propagation.",https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-324746479,324746479,
luke-jr,2017-08-24T20:49:16Z,"There are real use-cases to set both blockmaxsize and blockmaxweight: one might want to mine a block that has at most a weight of 3M, but never more than 1 MB for example.",https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-324753458,324753458,
jtimon,2017-08-24T23:30:02Z,"As commented on IRC blockmaxsize doesn't make sense after segwit activation. I wouldn't even bother with the deprecation step, I would go straight to removal and just document it in the release notes once.\nBut if we're going to maintain both simultaneously for any longer I agree the 2 constants for the defaults and forbidding using both at the same time (ie like you can't use -testnet and -regte",https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-324784694,324784694,
jnewbery,2017-08-25T02:18:36Z,Concept ACK. Will review soon.,https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-324806291,324806291,
jnewbery,2017-08-25T16:35:16Z,utACK faeafe2f20fa046f8a974940b42968dff05cd89c. Looks great.,https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-324972346,324972346,
sipa,2017-08-25T16:39:40Z,utACK faeafe2f20fa046f8a974940b42968dff05cd89c,https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-324973438,324973438,
luke-jr,2017-08-25T17:52:29Z,"Again, hard **NACK** for all the unrefuted reasons already given.",https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-324992563,324992563,
sdaftuar,2017-08-30T18:46:05Z,"> There are real use-cases to set both blockmaxsize and blockmaxweight: one might want to mine a block that has at most a weight of 3M, but never more than 1 MB for example.\n\n@luke-jr I am doubtful that what you describe is a ""real"" use case, but even if we accept that assumption -- you haven't responded to @TheBlueMatt's observation that this can be done by gbt callers simply by truncating th",https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-326083348,326083348,
luke-jr,2017-09-02T06:55:37Z,"Outsourcing this to callers is obviously unreasonable.\n\n> More broadly, the `-blockmaxsize` option is deceptive and confusing to users, since the code doesn't try to optimize for fee-per-serialized-byte. If someone really wants to mine based on number of serialized bytes (which I doubt), they should use different software; this software is optimized for fee-per-weight.\n\nIt's not deceptive ",https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-326726852,326726852,
sipa,2017-09-11T18:00:38Z,"> It's not deceptive at all. It limits the max size of blocks produced.\n\nAt the very least, 'size' is ambiguous. At least some people believed it refers to stripped size, and feared setting it higher than 1M.\n\nAnd there is no need for that extra complication. We don't have options to limit the number of sigops, the maximum number of inputs, or the maximum change in UTXO set size. I believe",https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-328609135,328609135,
sipa,2017-09-11T18:11:46Z,@TheBlueMatt `mining.py` fails (conflict introduced by #11150).,https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-328612083,328612083,
TheBlueMatt,2017-09-11T19:52:06Z,Rebased and fixed conflict.,https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-328639775,328639775,
luke-jr,2017-09-19T03:13:03Z,"> I do think it should be project policy to focus on features that matter. And an option that everyone overrides serves nobody.\n\nThat assumes everyone sets it to the absolute no-op maximum. There is no evidence of this.\n\nThis PR is contentious, should not have been merged, and should be reverted.",https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-330416103,330416103,
sdaftuar,2017-10-26T15:15:47Z,I think this should be tagged for backport.,https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-339699801,339699801,
gmaxwell,2017-11-02T06:48:50Z,ACK for backport.,https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-341332432,341332432,
MarcoFalke,2017-11-02T17:00:31Z,Moved to 0.15.0.2 milestone for the convenience of miners.,https://github.com/bitcoin/bitcoin/pull/11100#issuecomment-341489285,341489285,
sipa,2017-08-24T16:16:24Z,delete instead?,https://github.com/bitcoin/bitcoin/pull/11100#discussion_r135061868,135061868,src/policy/policy.h
TheBlueMatt,2017-08-24T18:43:57Z,Done.,https://github.com/bitcoin/bitcoin/pull/11100#discussion_r135098224,135098224,src/policy/policy.h
sipa,2017-08-24T19:27:21Z,"Add an `else` branch here that gives an error ""-blockmaxsize and -blockmaxweight cannot be set simultaneously"".",https://github.com/bitcoin/bitcoin/pull/11100#discussion_r135108409,135108409,src/miner.cpp
sdaftuar,2017-08-24T20:32:04Z,The comment above needs to be updated to remove reference to serialized size.,https://github.com/bitcoin/bitcoin/pull/11100#discussion_r135122709,135122709,src/miner.cpp
sdaftuar,2017-08-24T20:37:48Z,Isn't the `- 4000` unnecessary here?  We already separately reserve space for the coinbase in CreateNewBlock.,https://github.com/bitcoin/bitcoin/pull/11100#discussion_r135124178,135124178,src/policy/policy.h
TheBlueMatt,2017-08-24T21:30:51Z,"We've always had it and I'm skeptical of just removing it...I could absolutely see people accidentally building invalid blocks if we just remove it and they dont notice (which, given how much people appear to read release notes.......)",https://github.com/bitcoin/bitcoin/pull/11100#discussion_r135136034,135136034,src/policy/policy.h
TheBlueMatt,2017-08-24T21:35:18Z,Fixed.,https://github.com/bitcoin/bitcoin/pull/11100#discussion_r135136915,135136915,src/miner.cpp
TheBlueMatt,2017-08-24T21:35:19Z,Done.,https://github.com/bitcoin/bitcoin/pull/11100#discussion_r135136917,135136917,src/miner.cpp
promag,2017-08-25T03:21:58Z,Add warn about deprecation?,https://github.com/bitcoin/bitcoin/pull/11100#discussion_r135177330,135177330,src/miner.cpp
promag,2017-08-25T03:25:06Z,"Breaking change, needs release note.",https://github.com/bitcoin/bitcoin/pull/11100#discussion_r135177542,135177542,src/rpc/mining.cpp
jnewbery,2017-08-25T14:37:00Z,"yes, this should be included in release notes.\n\nAlso, please remove `currentblocksize` from help text (currently L198)",https://github.com/bitcoin/bitcoin/pull/11100#discussion_r135274083,135274083,src/rpc/mining.cpp
jnewbery,2017-08-25T14:56:42Z,There's a call below to `GetSerializeSize()` for logging the block size. We should remove that potentially expensive call and update the log to not print size as part of this PR.,https://github.com/bitcoin/bitcoin/pull/11100#discussion_r135278958,135278958,src/miner.cpp
jnewbery,2017-08-25T15:00:22Z,Agree. A deprecation warning here would be helpful.,https://github.com/bitcoin/bitcoin/pull/11100#discussion_r135279942,135279942,src/miner.cpp
TheBlueMatt,2017-08-25T15:01:35Z,"I'd prefer to not add more garbage to init, if possible (and printing every time a BlockAssembler is created also sucks, though it will do that now if you set both :( ). I think its fine, and since we're changing the defaults to something reasonable, removing the option a release later likely won't break anything.",https://github.com/bitcoin/bitcoin/pull/11100#discussion_r135280214,135280214,src/miner.cpp
TheBlueMatt,2017-08-25T15:31:26Z,Done and done.,https://github.com/bitcoin/bitcoin/pull/11100#discussion_r135287748,135287748,src/rpc/mining.cpp
TheBlueMatt,2017-08-25T15:31:33Z,Removed.,https://github.com/bitcoin/bitcoin/pull/11100#discussion_r135287790,135287790,src/miner.cpp
jnewbery,2017-08-25T15:45:32Z,Then add the `LogPrintf()`s to `InitParameterInteraction()` in init.cpp instead.,https://github.com/bitcoin/bitcoin/pull/11100#discussion_r135291173,135291173,src/miner.cpp
jnewbery,2017-08-25T15:48:04Z,"This is good, but I think the removal of `currentblocksize` in `getmininginfo` should [also?] go in a **Low-level RPC changes** section.",https://github.com/bitcoin/bitcoin/pull/11100#discussion_r135291757,135291757,doc/release-notes.md
ajtowns,2017-08-25T15:48:25Z,"DEFAULT_BLOCK_MAX_WEIGHT is used to initialise the nBlockMaxWeight field in BlockAssembler::Options, but that's then used as BlockAssembler::nBlockMaxWeight = max(4000, min(MAX_BLOCK_WEIGHT-4000, options.nBlockMaxWeight)) in the BlockAssembler constructor, so it will already be trimmed.\n\nSo I think the ""- 4000"" here is a no op since min(MBW-4000,MBW) = min(MBW-4000,MBW-4000) = MBW-4000...",https://github.com/bitcoin/bitcoin/pull/11100#discussion_r135291828,135291828,src/policy/policy.h
TheBlueMatt,2017-08-25T16:07:16Z,"Ugh, fine.",https://github.com/bitcoin/bitcoin/pull/11100#discussion_r135295860,135295860,src/miner.cpp
TheBlueMatt,2017-08-25T16:07:23Z,Done.,https://github.com/bitcoin/bitcoin/pull/11100#discussion_r135295878,135295878,doc/release-notes.md
TheBlueMatt,2017-08-25T16:07:54Z,"Ah, I see your point. Still, it feels misleading to print in the help text that the default value is 4000000 if thats outside the acceptable range.",https://github.com/bitcoin/bitcoin/pull/11100#discussion_r135295969,135295969,src/policy/policy.h
sdaftuar,2017-08-30T18:47:07Z,"Yeah actually what I meant was that we also start off our block counter at a weight of 4000, so limiting to MAX_BLOCK_WEIGHT-4000 (both here and in `BlockAssembler::BlockAssembler()`) causes us to limit block sizes more than we probably intend.  But not necessary to change here.",https://github.com/bitcoin/bitcoin/pull/11100#discussion_r136157411,136157411,src/policy/policy.h
