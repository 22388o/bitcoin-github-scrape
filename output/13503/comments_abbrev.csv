fanquake,2018-06-19T14:14:14Z,"So this was originally applied in #2695:\n> When compiling on FreeBSD, the calculation here returns an unsigned int. This causes a compile-time error with std::min, which cannot compare signed with unsigned integers.\nThis pull inserts an explicit cast, treating the calculated value as signed, keeping the compiler happy.\n\nThen reverted in #9598 to:\n> Improve readability by removing redunda",https://github.com/bitcoin/bitcoin/pull/13503#issuecomment-398414017,398414017,
practicalswift,2018-06-19T14:20:16Z,@fanquake @ken2812221 Sorry about the bashism :-)  Not fixed!,https://github.com/bitcoin/bitcoin/pull/13503#issuecomment-398416205,398416205,
practicalswift,2018-06-19T14:23:01Z,"@fanquake Good question regarding FreeBSD version. @anton48, what FreeBSD version are you running?",https://github.com/bitcoin/bitcoin/pull/13503#issuecomment-398417167,398417167,
practicalswift,2018-06-19T14:25:16Z,If this is fixed in FreeBSD 11.1 I'm not sure we have a problem to solve :-),https://github.com/bitcoin/bitcoin/pull/13503#issuecomment-398417975,398417975,
practicalswift,2018-06-19T14:28:01Z,"Closing this temporarily while waiting for input from @anton48.\n\nIf we can reproduce under FreeBSD 11.1 I'll re-open.",https://github.com/bitcoin/bitcoin/pull/13503#issuecomment-398419010,398419010,
anton48,2018-06-19T20:42:59Z,"@practicalswift @fanquake the source of the problem is not a version of FreeBSD itself, but version of clang. currently there are two production versions of FreeBSD: 11.1 and 10.4. former contains clang 4, latter clang 3.4. ""new"" code in init.cpp can be compiled with clang 4, but not with 3.4.\n\n@practicalswift your patch with ""if defined(__FreeBSD__)"" works for me at 10.3, 10.4 and 11.1. ",https://github.com/bitcoin/bitcoin/pull/13503#issuecomment-398538778,398538778,
fanquake,2018-06-21T01:39:55Z,"Thanks for following up @anton48.\n\nNot sure if we want to add a FreeBSD specific ""work around"", or if we should just revert the init.cpp change from #9598.",https://github.com/bitcoin/bitcoin/pull/13503#issuecomment-398949207,398949207,
MarcoFalke,2018-06-21T01:54:25Z,"Agree with @fanquake.\n\nHaving different code for each platform makes testing a nightmare. Btw. I believe you can specify the function template you want to call with `std::min<type>(a,b)`",https://github.com/bitcoin/bitcoin/pull/13503#issuecomment-398951349,398951349,
practicalswift,2018-06-21T07:33:39Z,"@fanquake @MarcoFalke Thanks for reviewing. Feedback addressed. Please re-review :-)\n\n@anton48 Can you confirm that the updated version works as expected for you?",https://github.com/bitcoin/bitcoin/pull/13503#issuecomment-399005049,399005049,
anton48,2018-06-21T07:55:22Z,"@practicalswift by updated version you mean `nMaxConnections = std::max(std::min<int>(nMaxConnections, FD_SETSIZE - nBind - MIN_CORE_FILEDESCRIPTORS - MAX_ADDNODE_CONNECTIONS), 0);`? yes, it can be compiled without errors on FreeBSD (tested on 10 and 11 versions).",https://github.com/bitcoin/bitcoin/pull/13503#issuecomment-399010598,399010598,
practicalswift,2018-06-21T08:13:15Z,"@anton48 Yes, that's the new version. Thanks for confirming.",https://github.com/bitcoin/bitcoin/pull/13503#issuecomment-399015570,399015570,
laanwj,2018-06-24T14:05:16Z,"I'm confused. I build bitcoin core on FreeBSD all the time and have never needed this.\n#2695 is *ancient*.",https://github.com/bitcoin/bitcoin/pull/13503#issuecomment-399759103,399759103,
MarcoFalke,2018-06-24T14:18:59Z,"The cast to int was only recently removed in master and I believe it only fails on FreeBSD 10, not 11.",https://github.com/bitcoin/bitcoin/pull/13503#issuecomment-399760018,399760018,
MarcoFalke,2018-06-24T21:18:23Z,utACK 629a47a1543a6e77cbf9c73917e2e419669b04df,https://github.com/bitcoin/bitcoin/pull/13503#issuecomment-399788394,399788394,
sipa,2018-06-27T01:03:53Z,utACK 629a47a1543a6e77cbf9c73917e2e419669b04df,https://github.com/bitcoin/bitcoin/pull/13503#issuecomment-400510105,400510105,
fanquake,2018-06-27T08:12:49Z,"utACK 629a47a for fixing the FreeBSD 10.x build.\nAs noted above, the issue comes from Clang 3.4",https://github.com/bitcoin/bitcoin/pull/13503#issuecomment-400582759,400582759,
ken2812221,2018-06-19T14:15:00Z,This is not bash script :),https://github.com/bitcoin/bitcoin/pull/13503#discussion_r196441779,196441779,src/init.cpp
