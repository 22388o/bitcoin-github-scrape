DrahtBot,2020-07-13 05:52:52,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #20275 (wallet: List SQLite wallets in non-SQLite builds by ryanofsky)\n\nIf you consider this pull request important, ple",https://github.com/bitcoin/bitcoin/pull/19502#issuecomment-657373763,657373763,
jonatack,2020-07-14 04:05:54,ACK 4f0cbc4,https://github.com/bitcoin/bitcoin/pull/19502#issuecomment-657953915,657953915,
luke-jr,2020-10-12 15:53:29,Rebased,https://github.com/bitcoin/bitcoin/pull/19502#issuecomment-707202800,707202800,
Saibato,2020-10-13 08:14:21,"nit: Before merge please note; this  ( #19502 and  ( #20080  or #19933 ) should merged together, since they vice versa would create new issues, like shorted wallet names.\n\nIf we have boost cononical best first #20080 and then this.\n",https://github.com/bitcoin/bitcoin/pull/19502#issuecomment-707573444,707573444,
luke-jr,2020-10-13 12:11:27,I don't see what new issues (aside from rebasing) would be created by merging them separately?,https://github.com/bitcoin/bitcoin/pull/19502#issuecomment-707696358,707696358,
Saibato,2020-10-13 18:07:28,"> I don't see what new issues (aside from rebasing) would be created by merging them separately?\n\niirc this a fix for the boost link problem and  ( evil wallet ) and makes #18095 obsolete.  \n\n̶B̶u̶t̶ ̶i̶f̶ ̶t̶h̶i̶s̶ ̶g̶e̶t̶ ̶m̶e̶r̶g̶e̶d̶ ̶f̶i̶r̶s̶t̶,̶ ̶t̶h̶e̶n̶ ̶r̶e̶a̶l̶ ̶s̶h̶o̶r̶t̶ ̶f̶i̶l̶e̶n̶a̶m̶e̶s̶ ̶w̶a̶l̶l̶e̶t̶s̶ ̶f̶r̶o̶m̶ ̶t̶h̶e̶ ̶l̶a̶t̶e̶r̶ ̶f̶o̶u̶n̶d̶ ̶b̶u̶g̶ ̶c̶o̶u̶l̶d̶ ̶b̶e̶ ̶c̶r",https://github.com/bitcoin/bitcoin/pull/19502#issuecomment-707916707,707916707,
Saibato,2020-10-14 13:02:53,"> But if this get merged first, then real short filenames wallets from the later found bug could be created from a bogus dirname on disk for real.\n\n@luke-jr \nRechecked complies from the sources:  To open non exitsting files,  is no longer the case with current master and knots so no merge sequence preferences here any longer. Was only a problem short after those errors where found and exits ",https://github.com/bitcoin/bitcoin/pull/19502#issuecomment-708387197,708387197,
luke-jr,2020-10-15 19:33:22,Rebased again,https://github.com/bitcoin/bitcoin/pull/19502#issuecomment-709545767,709545767,
hebasto,2020-10-20 22:01:52,"I revoke my ACK as this change makes possible an infinity loop.\nTo reproduce the bug, one could create a directory without access permissions, e.g.:\n```\n$ ls -l /home/hebasto/bitcoin-data-dir/wallets\ntotal 1456\ndrwx------ 3 hebasto hebasto    4096 Oct  3 11:16 20191109-main\ndrwx------ 2 root    root       4096 Oct 20 23:58 crash\n-rw-r--r-- 1 hebasto hebasto       0 Mar  5  2020 db.lo",https://github.com/bitcoin/bitcoin/pull/19502#issuecomment-713165606,713165606,
luke-jr,2020-10-29 19:04:28,"@hebasto Couldn't reproduce, but it did cause listwallets to miss other wallets. Added a fix and test.",https://github.com/bitcoin/bitcoin/pull/19502#issuecomment-718959641,718959641,
hebasto,2020-10-29 20:31:20,"Tested 49cc6919c4f9ef5a33ad5948a1b43496b454fab0, still able to reproduce an infinite loop:\n```\ncd <path-to-wallet-dir>\nsudo mkdir crash\nsudo chown 0700 crash\n```\n\nthen start a node, and initiate a `ListWalletDir` call in any way.",https://github.com/bitcoin/bitcoin/pull/19502#issuecomment-719004065,719004065,
jonatack,2020-07-13 05:49:34,"Verified that this does cause the test to fail at line 79 without the changes in this PR.\n\nCould also assert that the new logging is taking place with this at line 79 or just after:\n```python3\nwith self.nodes[0].assert_debug_log(expected_msgs=['Too many levels of symbolic links', 'Error scanning']):\n    self.nodes[0].listwalletdir()['wallets']\n```",https://github.com/bitcoin/bitcoin/pull/19502#discussion_r453447710,453447710,test/functional/wallet_multiwallet.py
jonatack,2020-07-13 05:54:38,"(or combined with the existing line 79 to share the same listwalletdir call)\n```diff\n-        assert_equal(sorted(map(lambda w: w['name'], self.nodes[0].listwalletdir()['wallets'])), ['', os.path.join('sub', 'w5'), 'w', 'w1', 'w2', 'w3', 'w7', 'w7_symlink', 'w8'])\n+        with self.nodes[0].assert_debug_log(expected_msgs=['Too many levels of symbolic links', 'Error scanning']):\n+         ",https://github.com/bitcoin/bitcoin/pull/19502#discussion_r453449135,453449135,test/functional/wallet_multiwallet.py
hebasto,2020-10-29 20:57:33,"44c0bc31f4fadc932877d9764402644c84f3be4c\n\nIf this line is commented out, the test still passing.",https://github.com/bitcoin/bitcoin/pull/19502#discussion_r514562067,514562067,test/functional/wallet_multiwallet.py
luke-jr,2020-10-29 21:21:04,???,https://github.com/bitcoin/bitcoin/pull/19502#discussion_r514574906,514574906,test/functional/wallet_multiwallet.py
hebasto,2020-10-29 21:29:25,"If initial state is changed, i.e., the `no_access` directory actually has access, the test should fail, right?",https://github.com/bitcoin/bitcoin/pull/19502#discussion_r514579270,514579270,test/functional/wallet_multiwallet.py
luke-jr,2020-10-30 01:21:39,"No, it's just there to make sure it doesn't break things. We're testing bitcoind, not the OS...\n\n(And in fact, chmod won't work to deny read access on Windows)",https://github.com/bitcoin/bitcoin/pull/19502#discussion_r514662450,514662450,test/functional/wallet_multiwallet.py
promag,2020-11-07 12:09:13,"nice, TIL",https://github.com/bitcoin/bitcoin/pull/19502#discussion_r519171061,519171061,src/wallet/walletutil.cpp
