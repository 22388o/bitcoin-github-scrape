[
  {
    "sha": "bd0f41387783ee91623d7fac15e89e57db37df82",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiZDBmNDEzODc3ODNlZTkxNjIzZDdmYWMxNWU4OWU1N2RiMzdkZjgy",
    "commit": {
      "author": {
        "name": "Jonas Nick",
        "email": "jonasd.nick@gmail.com",
        "date": "2016-05-30T09:43:53Z"
      },
      "committer": {
        "name": "Jonas Nick",
        "email": "jonasd.nick@gmail.com",
        "date": "2016-05-30T09:43:53Z"
      },
      "message": "Reduce unnecessary hashing in signrawtransaction",
      "tree": {
        "sha": "60716a914b6c814a274cc2dca0112213c57aa792",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/60716a914b6c814a274cc2dca0112213c57aa792"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bd0f41387783ee91623d7fac15e89e57db37df82",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bd0f41387783ee91623d7fac15e89e57db37df82",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/bd0f41387783ee91623d7fac15e89e57db37df82",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bd0f41387783ee91623d7fac15e89e57db37df82/comments",
    "author": {
      "login": "jonasnick",
      "id": 2582071,
      "node_id": "MDQ6VXNlcjI1ODIwNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasnick",
      "html_url": "https://github.com/jonasnick",
      "followers_url": "https://api.github.com/users/jonasnick/followers",
      "following_url": "https://api.github.com/users/jonasnick/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasnick/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasnick/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasnick/orgs",
      "repos_url": "https://api.github.com/users/jonasnick/repos",
      "events_url": "https://api.github.com/users/jonasnick/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasnick/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonasnick",
      "id": 2582071,
      "node_id": "MDQ6VXNlcjI1ODIwNzE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2582071?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasnick",
      "html_url": "https://github.com/jonasnick",
      "followers_url": "https://api.github.com/users/jonasnick/followers",
      "following_url": "https://api.github.com/users/jonasnick/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasnick/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasnick/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasnick/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasnick/orgs",
      "repos_url": "https://api.github.com/users/jonasnick/repos",
      "events_url": "https://api.github.com/users/jonasnick/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasnick/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "6ff2c8d29f6b5a5c2ce63f0a16f3bb0dbd049451",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6ff2c8d29f6b5a5c2ce63f0a16f3bb0dbd049451",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/6ff2c8d29f6b5a5c2ce63f0a16f3bb0dbd049451"
      }
    ],
    "stats": {
      "total": 7,
      "additions": 5,
      "deletions": 2
    },
    "files": [
      {
        "sha": "1bc31c4e3cac1dc2f11cd59641641d73417843e9",
        "filename": "src/rpc/rawtransaction.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 2,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bd0f41387783ee91623d7fac15e89e57db37df82/src/rpc/rawtransaction.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bd0f41387783ee91623d7fac15e89e57db37df82/src/rpc/rawtransaction.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/rawtransaction.cpp?ref=bd0f41387783ee91623d7fac15e89e57db37df82",
        "patch": "@@ -743,6 +743,9 @@ UniValue signrawtransaction(const UniValue& params, bool fHelp)\n     // Script verification errors\n     UniValue vErrors(UniValue::VARR);\n \n+    // Use CTransaction for the constant parts of the\n+    // transaction to avoid rehashing.\n+    const CTransaction txConst(mergedTx);\n     // Sign what we can:\n     for (unsigned int i = 0; i < mergedTx.vin.size(); i++) {\n         CTxIn& txin = mergedTx.vin[i];\n@@ -760,10 +763,10 @@ UniValue signrawtransaction(const UniValue& params, bool fHelp)\n \n         // ... and merge in other signatures:\n         BOOST_FOREACH(const CMutableTransaction& txv, txVariants) {\n-            txin.scriptSig = CombineSignatures(prevPubKey, mergedTx, i, txin.scriptSig, txv.vin[i].scriptSig);\n+            txin.scriptSig = CombineSignatures(prevPubKey, txConst, i, txin.scriptSig, txv.vin[i].scriptSig);\n         }\n         ScriptError serror = SCRIPT_ERR_OK;\n-        if (!VerifyScript(txin.scriptSig, prevPubKey, STANDARD_SCRIPT_VERIFY_FLAGS, MutableTransactionSignatureChecker(&mergedTx, i), &serror)) {\n+        if (!VerifyScript(txin.scriptSig, prevPubKey, STANDARD_SCRIPT_VERIFY_FLAGS, TransactionSignatureChecker(&txConst, i), &serror)) {\n             TxInErrorToJSON(txin, vErrors, ScriptErrorString(serror));\n         }\n     }"
      }
    ]
  }
]