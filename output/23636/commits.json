[
  {
    "sha": "fa815f8473c56df66302340c5961d18226a60e6f",
    "node_id": "C_kwDOABII59oAKGZhODE1Zjg0NzNjNTZkZjY2MzAyMzQwYzU5NjFkMTgyMjZhNjBlNmY",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-11-30T13:49:43Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-11-30T13:46:16Z"
      },
      "message": "Replace addrman.h include with forward decl in net.h\n\nAlso, add missing addrman.h includes",
      "tree": {
        "sha": "118fda19c523e1837dcc2efc4756ead957f3ed34",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/118fda19c523e1837dcc2efc4756ead957f3ed34"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa815f8473c56df66302340c5961d18226a60e6f",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUgerQwAmoDXR7GG6rGKNHNqYg7+nCqdVod6kEtGJ97+5OYccYpFTcTc0ST12QIr\nKb8WBj1kqe1HsFkTTfhsHUH/6U/9jIUfh4gAKxRuhGVZbAx0p/JiLhid8dzZg8wx\n6K4XGin6YBgTDeZAAb5mn8ROTrQjyCCsPUtkMOpber3kk0mVhuN30dh0DKczrZfJ\nM2RxPqNHLkihDK0Acf6soNlpghhXslU/Xo0kz35BwCDq74ZTnRZqZvCw2c1MRJ1V\nEtOjMgwII5/phfl2fgDUpaCePxNCLc+jO46C/F2n1/1VGWotbyPd0HLcRZqlGEng\nh5LJf029j7QKMjF0d38drsNA6qgh/jGTzSd9fp2ESo3g5JS/84OXUy6IB267mlAy\n0Vp5huasuqBNPFJoG1m/kAj0CL0H8eIHmrIRM1/uYaMMUbKymRzE7WJ7lFzSy2jT\nIIehBYlNcnuczH8xGxCdaQiOCJwIOzjvaPyq0wDLSlGo81YodpXPfGY46HjYHkRs\n3mYYzXXe\n=ULzj\n-----END PGP SIGNATURE-----",
        "payload": "tree 118fda19c523e1837dcc2efc4756ead957f3ed34\nparent ffdf8ee43e2440ab59b85846ab98854b17e49e49\nauthor MarcoFalke <falke.marco@gmail.com> 1638280183 +0100\ncommitter MarcoFalke <falke.marco@gmail.com> 1638279976 +0100\n\nReplace addrman.h include with forward decl in net.h\n\nAlso, add missing addrman.h includes\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa815f8473c56df66302340c5961d18226a60e6f",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fa815f8473c56df66302340c5961d18226a60e6f",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa815f8473c56df66302340c5961d18226a60e6f/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "ffdf8ee43e2440ab59b85846ab98854b17e49e49",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ffdf8ee43e2440ab59b85846ab98854b17e49e49",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/ffdf8ee43e2440ab59b85846ab98854b17e49e49"
      }
    ],
    "stats": {
      "total": 9,
      "additions": 6,
      "deletions": 3
    },
    "files": [
      {
        "sha": "b112b8d233660c4d0f3d96163d0e0413fdce264a",
        "filename": "src/net.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa815f8473c56df66302340c5961d18226a60e6f/src/net.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa815f8473c56df66302340c5961d18226a60e6f/src/net.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.cpp?ref=fa815f8473c56df66302340c5961d18226a60e6f",
        "patch": "@@ -10,6 +10,7 @@\n #include <net.h>\n \n #include <addrdb.h>\n+#include <addrman.h>\n #include <banman.h>\n #include <clientversion.h>\n #include <compat.h>"
      },
      {
        "sha": "e9baa57a9b71a3328ca7c8f6dd264c6c93abf46e",
        "filename": "src/net.h",
        "status": "modified",
        "additions": 3,
        "deletions": 3,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa815f8473c56df66302340c5961d18226a60e6f/src/net.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa815f8473c56df66302340c5961d18226a60e6f/src/net.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.h?ref=fa815f8473c56df66302340c5961d18226a60e6f",
        "patch": "@@ -6,7 +6,6 @@\n #ifndef BITCOIN_NET_H\n #define BITCOIN_NET_H\n \n-#include <addrman.h>\n #include <chainparams.h>\n #include <common/bloom.h>\n #include <compat.h>\n@@ -37,9 +36,10 @@\n #include <thread>\n #include <vector>\n \n-class CScheduler;\n-class CNode;\n+class AddrMan;\n class BanMan;\n+class CNode;\n+class CScheduler;\n struct bilingual_str;\n \n /** Default for -whitelistrelay. */"
      },
      {
        "sha": "f4456bebc53f3fbb233a6ca701c80ed11f01152f",
        "filename": "src/rpc/net.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa815f8473c56df66302340c5961d18226a60e6f/src/rpc/net.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa815f8473c56df66302340c5961d18226a60e6f/src/rpc/net.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpc/net.cpp?ref=fa815f8473c56df66302340c5961d18226a60e6f",
        "patch": "@@ -4,6 +4,7 @@\n \n #include <rpc/server.h>\n \n+#include <addrman.h>\n #include <banman.h>\n #include <chainparams.h>\n #include <clientversion.h>"
      },
      {
        "sha": "fc5cd664dc34237632b71569becfcba5c0699b0c",
        "filename": "src/test/fuzz/connman.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa815f8473c56df66302340c5961d18226a60e6f/src/test/fuzz/connman.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa815f8473c56df66302340c5961d18226a60e6f/src/test/fuzz/connman.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/fuzz/connman.cpp?ref=fa815f8473c56df66302340c5961d18226a60e6f",
        "patch": "@@ -2,6 +2,7 @@\n // Distributed under the MIT software license, see the accompanying\n // file COPYING or http://www.opensource.org/licenses/mit-license.php.\n \n+#include <addrman.h>\n #include <chainparams.h>\n #include <chainparamsbase.h>\n #include <net.h>"
      }
    ]
  },
  {
    "sha": "fa551b3bdd380bcaa8fa929b378b3b6c81a6f65c",
    "node_id": "C_kwDOABII59oAKGZhNTUxYjNiZGQzODBiY2FhOGZhOTI5YjM3OGIzYjZjODFhNmY2NWM",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-11-30T15:03:55Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-11-30T16:19:49Z"
      },
      "message": "Remove GetAdjustedTime from init.cpp",
      "tree": {
        "sha": "c273f4d3f26d2bc918d1d2d9c733e908cc6dd47d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c273f4d3f26d2bc918d1d2d9c733e908cc6dd47d"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa551b3bdd380bcaa8fa929b378b3b6c81a6f65c",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUiL4wv/esa1vvx5vsxxTLIoQUC5vx8TGB8eTqSUCmUCv9q7VDrq1l3f5eKZmbH+\n/eB5o2MaYrGa/EMoXZwpVEEKSAGWU/u0XlYx2axw4IE7u2YfqZb3b/LS/Metrri5\nvUHEn5jRH0/tRqoaY+mKHrFVd2qb7ZTMyEq74fX/bZ0C+bwiMHsShVHlNg04Jp0D\nVJSJLxNTzXHL8NvcIiWkWoRQGTG+IP7s/VaxqLy8ybRq/fHLvtfIW4NAcdiLKBcZ\nWYd0Fa+vaH8ittz8Vq56FkS38abD1W1tEQNhA0ZN30G+l4ATILjh5SoMcr4KvKTL\nRi5anHLuwBBQ1/aGK/n73UMwRPOHnSQvDUxJ1x3o/GnJNmGLYoocCUnFfhMkb8Sw\nFUuaUpcl/QVyqlz7cCRulOLs7iIiBowww0zcUG8seTCNAzerrytJ+f2msDSYKnZ4\nl9ILVz1B10rMDJKP7YwWoAdwU477vcVDsn2lXrTOagsApIBlXB4B1ZL9Eblt3FQU\noxEPUEcm\n=J+Z9\n-----END PGP SIGNATURE-----",
        "payload": "tree c273f4d3f26d2bc918d1d2d9c733e908cc6dd47d\nparent fa815f8473c56df66302340c5961d18226a60e6f\nauthor MarcoFalke <falke.marco@gmail.com> 1638284635 +0100\ncommitter MarcoFalke <falke.marco@gmail.com> 1638289189 +0100\n\nRemove GetAdjustedTime from init.cpp\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa551b3bdd380bcaa8fa929b378b3b6c81a6f65c",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fa551b3bdd380bcaa8fa929b378b3b6c81a6f65c",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa551b3bdd380bcaa8fa929b378b3b6c81a6f65c/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fa815f8473c56df66302340c5961d18226a60e6f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa815f8473c56df66302340c5961d18226a60e6f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fa815f8473c56df66302340c5961d18226a60e6f"
      }
    ],
    "stats": {
      "total": 25,
      "additions": 21,
      "deletions": 4
    },
    "files": [
      {
        "sha": "22c0d928b5a33c53509ad9ceff2d103eb36e742f",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa551b3bdd380bcaa8fa929b378b3b6c81a6f65c/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa551b3bdd380bcaa8fa929b378b3b6c81a6f65c/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=fa551b3bdd380bcaa8fa929b378b3b6c81a6f65c",
        "patch": "@@ -1561,7 +1561,7 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n \n                         const CBlockIndex* tip = chainstate->m_chain.Tip();\n                         RPCNotifyBlockChange(tip);\n-                        if (tip && tip->nTime > GetAdjustedTime() + 2 * 60 * 60) {\n+                        if (tip && tip->nTime > GetTime() + MAX_FUTURE_BLOCK_TIME) {\n                             strLoadError = _(\"The block database contains a block which appears to be from the future. \"\n                                     \"This may be due to your computer's date and time being set incorrectly. \"\n                                     \"Only rebuild the block database if you are sure that your computer's date and time are correct\");"
      },
      {
        "sha": "710f3d93e11c2f881d0858c0d790e8b6446ca324",
        "filename": "test/functional/p2p_invalid_block.py",
        "status": "modified",
        "additions": 1,
        "deletions": 2,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa551b3bdd380bcaa8fa929b378b3b6c81a6f65c/test/functional/p2p_invalid_block.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa551b3bdd380bcaa8fa929b378b3b6c81a6f65c/test/functional/p2p_invalid_block.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/p2p_invalid_block.py?ref=fa551b3bdd380bcaa8fa929b378b3b6c81a6f65c",
        "patch": "@@ -16,6 +16,7 @@\n import time\n \n from test_framework.blocktools import (\n+    MAX_FUTURE_BLOCK_TIME,\n     create_block,\n     create_coinbase,\n     create_tx_with_script,\n@@ -26,8 +27,6 @@\n from test_framework.test_framework import BitcoinTestFramework\n from test_framework.util import assert_equal\n \n-MAX_FUTURE_BLOCK_TIME = 2 * 60 * 60\n-\n \n class InvalidBlockRequestTest(BitcoinTestFramework):\n     def set_test_params(self):"
      },
      {
        "sha": "8f7d5114fadfb17a7ba8a050011593cfea6f4122",
        "filename": "test/functional/rpc_blockchain.py",
        "status": "modified",
        "additions": 17,
        "deletions": 1,
        "changes": 18,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa551b3bdd380bcaa8fa929b378b3b6c81a6f65c/test/functional/rpc_blockchain.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa551b3bdd380bcaa8fa929b378b3b6c81a6f65c/test/functional/rpc_blockchain.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/rpc_blockchain.py?ref=fa551b3bdd380bcaa8fa929b378b3b6c81a6f65c",
        "patch": "@@ -26,9 +26,10 @@\n import subprocess\n \n from test_framework.blocktools import (\n+    MAX_FUTURE_BLOCK_TIME,\n+    TIME_GENESIS_BLOCK,\n     create_block,\n     create_coinbase,\n-    TIME_GENESIS_BLOCK,\n )\n from test_framework.messages import (\n     CBlockHeader,\n@@ -53,6 +54,7 @@\n HEIGHT = 200  # blocks mined\n TIME_RANGE_STEP = 600  # ten-minute steps\n TIME_RANGE_MTP = TIME_GENESIS_BLOCK + (HEIGHT - 6) * TIME_RANGE_STEP\n+TIME_RANGE_TIP = TIME_GENESIS_BLOCK + (HEIGHT - 1) * TIME_RANGE_STEP\n TIME_RANGE_END = TIME_GENESIS_BLOCK + HEIGHT * TIME_RANGE_STEP\n \n \n@@ -65,6 +67,7 @@ def set_test_params(self):\n     def run_test(self):\n         self.wallet = MiniWallet(self.nodes[0])\n         self.mine_chain()\n+        self._test_max_future_block_time()\n         self.restart_node(0, extra_args=['-stopatheight=207', '-prune=1'])  # Set extra args with pruning after rescan is complete\n \n         self._test_getblockchaininfo()\n@@ -85,6 +88,19 @@ def mine_chain(self):\n             self.generate(self.wallet, 1)\n         assert_equal(self.nodes[0].getblockchaininfo()['blocks'], HEIGHT)\n \n+    def _test_max_future_block_time(self):\n+        self.stop_node(0)\n+        self.log.info(\"A block tip of more than MAX_FUTURE_BLOCK_TIME in the future raises an error\")\n+        self.nodes[0].assert_start_raises_init_error(\n+            extra_args=[f\"-mocktime={TIME_RANGE_TIP - MAX_FUTURE_BLOCK_TIME - 1}\"],\n+            expected_msg=\": The block database contains a block which appears to be from the future.\"\n+            \" This may be due to your computer's date and time being set incorrectly.\"\n+            f\" Only rebuild the block database if you are sure that your computer's date and time are correct.{os.linesep}\"\n+            \"Please restart with -reindex or -reindex-chainstate to recover.\",\n+        )\n+        self.log.info(\"A block tip of MAX_FUTURE_BLOCK_TIME in the future is fine\")\n+        self.start_node(0, extra_args=[f\"-mocktime={TIME_RANGE_TIP - MAX_FUTURE_BLOCK_TIME}\"])\n+\n     def _test_getblockchaininfo(self):\n         self.log.info(\"Test getblockchaininfo\")\n "
      },
      {
        "sha": "caa9b8696966feaacbfad4b5c73b427d9f08c32e",
        "filename": "test/functional/test_framework/blocktools.py",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa551b3bdd380bcaa8fa929b378b3b6c81a6f65c/test/functional/test_framework/blocktools.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa551b3bdd380bcaa8fa929b378b3b6c81a6f65c/test/functional/test_framework/blocktools.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/test_framework/blocktools.py?ref=fa551b3bdd380bcaa8fa929b378b3b6c81a6f65c",
        "patch": "@@ -50,6 +50,8 @@\n # Genesis block time (regtest)\n TIME_GENESIS_BLOCK = 1296688602\n \n+MAX_FUTURE_BLOCK_TIME = 2 * 60 * 60\n+\n # Coinbase transaction outputs can only be spent after this number of new blocks (network rule)\n COINBASE_MATURITY = 100\n "
      }
    ]
  }
]