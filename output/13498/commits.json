[
  {
    "sha": "e209184101e3de9138452fb973e2f379f9eacdc8",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplMjA5MTg0MTAxZTNkZTkxMzg0NTJmYjk3M2UyZjM3OWY5ZWFjZGM4",
    "commit": {
      "author": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2018-06-18T16:17:22Z"
      },
      "committer": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2018-06-18T16:33:15Z"
      },
      "message": "[wallet] deprecate sendfrom RPC method.",
      "tree": {
        "sha": "19be5605c438d4b516b9a30952dd59d029cd7a32",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/19be5605c438d4b516b9a30952dd59d029cd7a32"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e209184101e3de9138452fb973e2f379f9eacdc8",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e209184101e3de9138452fb973e2f379f9eacdc8",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/e209184101e3de9138452fb973e2f379f9eacdc8",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e209184101e3de9138452fb973e2f379f9eacdc8/comments",
    "author": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "450055bdbdcbf4c1ce16cdca00fc4499a6994bc7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/450055bdbdcbf4c1ce16cdca00fc4499a6994bc7",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/450055bdbdcbf4c1ce16cdca00fc4499a6994bc7"
      }
    ],
    "stats": {
      "total": 19,
      "additions": 14,
      "deletions": 5
    },
    "files": [
      {
        "sha": "357ed16a1708c5fb29695df6c3566d9ff754e07b",
        "filename": "src/wallet/rpcwallet.cpp",
        "status": "modified",
        "additions": 9,
        "deletions": 1,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e209184101e3de9138452fb973e2f379f9eacdc8/src/wallet/rpcwallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e209184101e3de9138452fb973e2f379f9eacdc8/src/wallet/rpcwallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/rpcwallet.cpp?ref=e209184101e3de9138452fb973e2f379f9eacdc8",
        "patch": "@@ -1017,6 +1017,14 @@ static UniValue sendfrom(const JSONRPCRequest& request)\n         return NullUniValue;\n     }\n \n+    if (!IsDeprecatedRPCEnabled(\"accounts\")) {\n+        if (request.fHelp) {\n+            throw std::runtime_error(\"sendfrom (Deprecated, will be removed in V0.18. To use this command, start bitcoind with -deprecatedrpc=accounts)\");\n+        }\n+        throw JSONRPCError(RPC_METHOD_DEPRECATED, \"sendfrom is deprecated and will be removed in V0.18. To use this command, start bitcoind with -deprecatedrpc=accounts.\");\n+    }\n+\n+\n     if (request.fHelp || request.params.size() < 3 || request.params.size() > 6)\n         throw std::runtime_error(\n             \"sendfrom \\\"fromaccount\\\" \\\"toaddress\\\" amount ( minconf \\\"comment\\\" \\\"comment_to\\\" )\\n\"\n@@ -4376,7 +4384,6 @@ static const CRPCCommand commands[] =\n     { \"wallet\",             \"listwallets\",                      &listwallets,                   {} },\n     { \"wallet\",             \"loadwallet\",                       &loadwallet,                    {\"filename\"} },\n     { \"wallet\",             \"lockunspent\",                      &lockunspent,                   {\"unlock\",\"transactions\"} },\n-    { \"wallet\",             \"sendfrom\",                         &sendfrom,                      {\"fromaccount\",\"toaddress\",\"amount\",\"minconf\",\"comment\",\"comment_to\"} },\n     { \"wallet\",             \"sendmany\",                         &sendmany,                      {\"fromaccount|dummy\",\"amounts\",\"minconf\",\"comment\",\"subtractfeefrom\",\"replaceable\",\"conf_target\",\"estimate_mode\"} },\n     { \"wallet\",             \"sendtoaddress\",                    &sendtoaddress,                 {\"address\",\"amount\",\"comment\",\"comment_to\",\"subtractfeefromamount\",\"replaceable\",\"conf_target\",\"estimate_mode\"} },\n     { \"wallet\",             \"settxfee\",                         &settxfee,                      {\"amount\"} },\n@@ -4397,6 +4404,7 @@ static const CRPCCommand commands[] =\n     { \"wallet\",             \"listaccounts\",                     &listaccounts,                  {\"minconf\",\"include_watchonly\"} },\n     { \"wallet\",             \"listreceivedbyaccount\",            &listreceivedbylabel,           {\"minconf\",\"include_empty\",\"include_watchonly\"} },\n     { \"wallet\",             \"setaccount\",                       &setlabel,                      {\"address\",\"account\"} },\n+    { \"wallet\",             \"sendfrom\",                         &sendfrom,                      {\"fromaccount\",\"toaddress\",\"amount\",\"minconf\",\"comment\",\"comment_to\"} },\n     { \"wallet\",             \"move\",                             &movecmd,                       {\"fromaccount\",\"toaccount\",\"amount\",\"minconf\",\"comment\"} },\n \n     /** Label functions (to replace non-balance account functions) */"
      },
      {
        "sha": "cc0a5175d54be15a274c5a7ac4d65ce6eee6c493",
        "filename": "test/functional/wallet_fallbackfee.py",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e209184101e3de9138452fb973e2f379f9eacdc8/test/functional/wallet_fallbackfee.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e209184101e3de9138452fb973e2f379f9eacdc8/test/functional/wallet_fallbackfee.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/wallet_fallbackfee.py?ref=e209184101e3de9138452fb973e2f379f9eacdc8",
        "patch": "@@ -21,7 +21,6 @@ def run_test(self):\n         self.restart_node(0, extra_args=[\"-fallbackfee=0\"])\n         assert_raises_rpc_error(-4, \"Fee estimation failed\", lambda: self.nodes[0].sendtoaddress(self.nodes[0].getnewaddress(), 1))\n         assert_raises_rpc_error(-4, \"Fee estimation failed\", lambda: self.nodes[0].fundrawtransaction(self.nodes[0].createrawtransaction([], {self.nodes[0].getnewaddress(): 1})))\n-        assert_raises_rpc_error(-4, \"Fee estimation failed\", lambda: self.nodes[0].sendfrom(\"\", self.nodes[0].getnewaddress(), 1))\n         assert_raises_rpc_error(-6, \"Fee estimation failed\", lambda: self.nodes[0].sendmany(\"\", {self.nodes[0].getnewaddress(): 1}))\n \n if __name__ == '__main__':"
      },
      {
        "sha": "8d961fb34aeb0e0267b9774c8953fee95e77e034",
        "filename": "test/functional/wallet_labels.py",
        "status": "modified",
        "additions": 5,
        "deletions": 3,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e209184101e3de9138452fb973e2f379f9eacdc8/test/functional/wallet_labels.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e209184101e3de9138452fb973e2f379f9eacdc8/test/functional/wallet_labels.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/wallet_labels.py?ref=e209184101e3de9138452fb973e2f379f9eacdc8",
        "patch": "@@ -85,7 +85,8 @@ def _run_subtest(self, accounts_api, node):\n         # we want to reset so that the \"\" label has what's expected.\n         # otherwise we're off by exactly the fee amount as that's mined\n         # and matures in the next 100 blocks\n-        node.sendfrom(\"\", common_address, fee)\n+        if accounts_api:\n+            node.sendfrom(\"\", common_address, fee)\n         amount_to_send = 1.0\n \n         # Create labels and make sure subsequent label API calls\n@@ -125,7 +126,7 @@ def _run_subtest(self, accounts_api, node):\n             if accounts_api:\n                 node.sendfrom(label.name, to_label.receive_address, amount_to_send)\n             else:\n-                node.sendfrom(label.name, to_label.addresses[0], amount_to_send)\n+                node.sendtoaddress(to_label.addresses[0], amount_to_send)\n         node.generate(1)\n         for label in labels:\n             if accounts_api:\n@@ -166,7 +167,8 @@ def _run_subtest(self, accounts_api, node):\n             label.add_address(multisig_address)\n             label.purpose[multisig_address] = \"send\"\n             label.verify(node)\n-            node.sendfrom(\"\", multisig_address, 50)\n+            if accounts_api:\n+                node.sendfrom(\"\", multisig_address, 50)\n         node.generate(101)\n         if accounts_api:\n             for label in labels:"
      }
    ]
  },
  {
    "sha": "df10f07db178d84b3def9f0b99d9b7c92e4227a9",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkZjEwZjA3ZGIxNzhkODRiM2RlZjlmMGI5OWQ5YjdjOTJlNDIyN2E5",
    "commit": {
      "author": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2018-06-18T16:17:42Z"
      },
      "committer": {
        "name": "John Newbery",
        "email": "john@johnnewbery.com",
        "date": "2018-06-18T16:33:16Z"
      },
      "message": "[wallet] Don't use accounts when checking balance in sendmany",
      "tree": {
        "sha": "6b380478508dc1be8941de009581fcda024e99b7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6b380478508dc1be8941de009581fcda024e99b7"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/df10f07db178d84b3def9f0b99d9b7c92e4227a9",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/df10f07db178d84b3def9f0b99d9b7c92e4227a9",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/df10f07db178d84b3def9f0b99d9b7c92e4227a9",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/df10f07db178d84b3def9f0b99d9b7c92e4227a9/comments",
    "author": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "e209184101e3de9138452fb973e2f379f9eacdc8",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e209184101e3de9138452fb973e2f379f9eacdc8",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/e209184101e3de9138452fb973e2f379f9eacdc8"
      }
    ],
    "stats": {
      "total": 6,
      "additions": 4,
      "deletions": 2
    },
    "files": [
      {
        "sha": "0aabf261089c159454011ff00d08cbf576e1dfa3",
        "filename": "src/wallet/rpcwallet.cpp",
        "status": "modified",
        "additions": 4,
        "deletions": 2,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/df10f07db178d84b3def9f0b99d9b7c92e4227a9/src/wallet/rpcwallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/df10f07db178d84b3def9f0b99d9b7c92e4227a9/src/wallet/rpcwallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/rpcwallet.cpp?ref=df10f07db178d84b3def9f0b99d9b7c92e4227a9",
        "patch": "@@ -1263,9 +1263,11 @@ static UniValue sendmany(const JSONRPCRequest& request)\n     EnsureWalletIsUnlocked(pwallet);\n \n     // Check funds\n-    CAmount nBalance = pwallet->GetLegacyBalance(ISMINE_SPENDABLE, nMinDepth, &strAccount);\n-    if (totalAmount > nBalance)\n+    if (IsDeprecatedRPCEnabled(\"accounts\") && totalAmount > pwallet->GetLegacyBalance(ISMINE_SPENDABLE, nMinDepth, &strAccount)) {\n         throw JSONRPCError(RPC_WALLET_INSUFFICIENT_FUNDS, \"Account has insufficient funds\");\n+    } else if (!IsDeprecatedRPCEnabled(\"accounts\") && totalAmount > pwallet->GetLegacyBalance(ISMINE_SPENDABLE, nMinDepth, nullptr)) {\n+        throw JSONRPCError(RPC_WALLET_INSUFFICIENT_FUNDS, \"Wallet has insufficient funds\");\n+    }\n \n     // Shuffle recipient list\n     std::shuffle(vecSend.begin(), vecSend.end(), FastRandomContext());"
      }
    ]
  }
]