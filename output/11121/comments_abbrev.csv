jnewbery,2017-08-24T16:36:36Z,"@MarcoFalke @kallewoof - thanks for the review. I think I've responded to all your comments.\n\nNew commits pushed, and rebased on master.",https://github.com/bitcoin/bitcoin/pull/11121#issuecomment-324689264,324689264,
kallewoof,2017-08-25T01:04:03Z,utACK df824a9,https://github.com/bitcoin/bitcoin/pull/11121#issuecomment-324796691,324796691,
jnewbery,2017-08-25T15:23:52Z,"Thanks for the reivew @promag \n\n> Have you thought of not having any node started automatically? There are some tests that start with stop_node(0)\n\nTests that don't need their nodes to start should override the `setup_network()` or `setup_nodes()` methods. The vast majority of tests require nodes to be started at the top of the test, so that's the default.\n\n> setup_clean_chain would be",https://github.com/bitcoin/bitcoin/pull/11121#issuecomment-324953006,324953006,
jnewbery,2017-09-01T16:32:26Z,Thanks @MarcoFalke . Review comments addressed.,https://github.com/bitcoin/bitcoin/pull/11121#issuecomment-326626127,326626127,
MarcoFalke,2017-09-01T16:44:22Z,re-utACK 7148b74dc39110f53c665b94fa9d994c6ad6dc1c,https://github.com/bitcoin/bitcoin/pull/11121#issuecomment-326628970,326628970,
MarcoFalke,2017-08-23T21:24:18Z,I prefer to explicitly set the network topology and initial state of the chain.,https://github.com/bitcoin/bitcoin/pull/11121#discussion_r134874934,134874934,test/functional/txn_clone.py
MarcoFalke,2017-08-23T21:26:51Z,should raise `RuntimeError('Not implemented')` to enforce the docstring.,https://github.com/bitcoin/bitcoin/pull/11121#discussion_r134875521,134875521,test/functional/test_framework/test_framework.py
kallewoof,2017-08-24T07:53:13Z,"Since `self` knows about `self.options.tmpdir`, and all calls to `self.add_nodes` passes `self.options.tmpdir` as `dirname` argument, it seems clean to just give it a default `None` and to set to `self.options.tmpdir if None` in `add_nodes`.\nOr perhaps remove it entirely and always use `self.options.tmpdir`. Will it ever be anything else?",https://github.com/bitcoin/bitcoin/pull/11121#discussion_r134948693,134948693,test/functional/test_framework/test_framework.py
kallewoof,2017-08-24T07:53:55Z,"`extra_args=None, stderr=None` maybe?",https://github.com/bitcoin/bitcoin/pull/11121#discussion_r134948830,134948830,test/functional/test_framework/test_node.py
kallewoof,2017-08-24T07:55:57Z,"Faint agreement. It's easy to forget and start up 4 nodes when you only really need 2, for example. Not seeing the number of nodes makes that even harder to remember.",https://github.com/bitcoin/bitcoin/pull/11121#discussion_r134949165,134949165,test/functional/txn_clone.py
kallewoof,2017-08-24T08:00:35Z,"Why does it not just `add_nodes(3, ..)` here and then add/start/connect the fourth node below? That would remove a lot of necessary `[self.nodes[0:3]]` stuff.",https://github.com/bitcoin/bitcoin/pull/11121#discussion_r134950110,134950110,test/functional/wallet.py
jnewbery,2017-08-24T16:32:21Z,"Sounds good. I've added a new commit that makes setting `self.num_nodes` mandatory. I haven't done the same for `self.setup_clean_chain`, since I think it makes more sense for that to have a default. If people feel strongly, it can be added in a future commit.",https://github.com/bitcoin/bitcoin/pull/11121#discussion_r135066057,135066057,test/functional/txn_clone.py
jnewbery,2017-08-24T16:32:27Z,Yes - done,https://github.com/bitcoin/bitcoin/pull/11121#discussion_r135066087,135066087,test/functional/test_framework/test_framework.py
jnewbery,2017-08-24T16:32:55Z,Good point. Thanks! Added this in a new commit.,https://github.com/bitcoin/bitcoin/pull/11121#discussion_r135066194,135066194,test/functional/test_framework/test_framework.py
jnewbery,2017-08-24T16:33:48Z,"`TestNode.start` is only ever called by `TestFramework.start_node`, which has its own default for `extra_args`, so not strictly necessary, but I agree having a default here makes it clearer. Added.",https://github.com/bitcoin/bitcoin/pull/11121#discussion_r135066386,135066386,test/functional/test_framework/test_node.py
jnewbery,2017-08-24T16:35:16Z,"Because there's not currently a method to add a single node. The model after this PR is to add all nodes at the top of the test and then start/stop them as required during the test.\n\nWe could potentially add an `add_node()` method to be called during the test, but lets leave that for a future PR.",https://github.com/bitcoin/bitcoin/pull/11121#discussion_r135066746,135066746,test/functional/wallet.py
promag,2017-08-25T14:05:41Z,It seems there are more `setup_clean_chain = True` so why not make it the default?,https://github.com/bitcoin/bitcoin/pull/11121#discussion_r135266417,135266417,test/functional/assumevalid.py
jnewbery,2017-08-25T15:23:06Z,"I haven't made any changes to `setup_clean_chain`. See earlier comment:\n\n> I haven't done the same for self.setup_clean_chain, since I think it makes more sense for that to have a default. If people feel strongly, it can be added in a future commit.\n\nFeel free to open a PR to change/remove the default if you think that's necessary. I don't think it's required for this PR.",https://github.com/bitcoin/bitcoin/pull/11121#discussion_r135285612,135285612,test/functional/assumevalid.py
MarcoFalke,2017-08-30T10:40:59Z,"This is already done by `setup_network`.\n\nSame for the line below.",https://github.com/bitcoin/bitcoin/pull/11121#discussion_r136033058,136033058,test/functional/bumpfee.py
jnewbery,2017-08-30T14:11:18Z,"L41 stops node 1 (the `encryptwallet` RPC shuts down the node), so I believe all the p2p connections are lost and we need to reconnect the nodes after restarting node 1.\n\nI've tested removing these two lines and the test fails (the next call to `sync_all()` fails)",https://github.com/bitcoin/bitcoin/pull/11121#discussion_r136079025,136079025,test/functional/bumpfee.py
MarcoFalke,2017-08-30T14:13:54Z,"Sorry, missed that the node shuts down.",https://github.com/bitcoin/bitcoin/pull/11121#discussion_r136079813,136079813,test/functional/bumpfee.py
MarcoFalke,2017-09-01T15:23:58Z,You are removing `timewait=900` from all calls but the first. I assume this does not cause issues?,https://github.com/bitcoin/bitcoin/pull/11121#discussion_r136600547,136600547,test/functional/pruning.py
MarcoFalke,2017-09-01T15:40:02Z,debug statement?,https://github.com/bitcoin/bitcoin/pull/11121#discussion_r136604254,136604254,test/functional/wallet.py
MarcoFalke,2017-09-01T15:40:11Z,debug statement?,https://github.com/bitcoin/bitcoin/pull/11121#discussion_r136604279,136604279,test/functional/wallet.py
MarcoFalke,2017-09-01T15:42:37Z,why not `self.nodes[:3]`?,https://github.com/bitcoin/bitcoin/pull/11121#discussion_r136604781,136604781,test/functional/wallet.py
MarcoFalke,2017-09-01T15:42:42Z,why not `self.nodes[:3]`?,https://github.com/bitcoin/bitcoin/pull/11121#discussion_r136604807,136604807,test/functional/wallet.py
MarcoFalke,2017-09-01T15:56:55Z,why is this changed in a refactoring commit?,https://github.com/bitcoin/bitcoin/pull/11121#discussion_r136608277,136608277,test/functional/zapwallettxes.py
jnewbery,2017-09-01T16:19:35Z,"`rpc_timeout` is a property of `TestNode` set when instantiating the python object, not when starting up the bitcoind node.",https://github.com/bitcoin/bitcoin/pull/11121#discussion_r136613059,136613059,test/functional/pruning.py
jnewbery,2017-09-01T16:21:24Z,derp. Fixed,https://github.com/bitcoin/bitcoin/pull/11121#discussion_r136613442,136613442,test/functional/wallet.py
jnewbery,2017-09-01T16:21:29Z,yep,https://github.com/bitcoin/bitcoin/pull/11121#discussion_r136613456,136613456,test/functional/wallet.py
jnewbery,2017-09-01T16:32:06Z,fixed,https://github.com/bitcoin/bitcoin/pull/11121#discussion_r136615556,136615556,test/functional/wallet.py
jnewbery,2017-09-01T16:32:11Z,fixed,https://github.com/bitcoin/bitcoin/pull/11121#discussion_r136615574,136615574,test/functional/wallet.py
jnewbery,2017-09-01T16:32:13Z,fixed,https://github.com/bitcoin/bitcoin/pull/11121#discussion_r136615585,136615585,test/functional/zapwallettxes.py
