[
  {
    "sha": "60833778d4b8b6136e9e9b4d4916e27b85d08199",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2MDgzMzc3OGQ0YjhiNjEzNmU5ZTliNGQ0OTE2ZTI3Yjg1ZDA4MTk5",
    "commit": {
      "author": {
        "name": "Jeff Garzik",
        "email": "jgarzik@exmulti.com",
        "date": "2012-09-27T19:51:06Z"
      },
      "committer": {
        "name": "Jeff Garzik",
        "email": "jgarzik@redhat.com",
        "date": "2012-09-27T19:51:06Z"
      },
      "message": "Add \"getbestchain\" P2P request, and \"bestchain\" reply",
      "tree": {
        "sha": "30fed999eadc9dce69aace14fda7babe8e9a2a0a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/30fed999eadc9dce69aace14fda7babe8e9a2a0a"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/60833778d4b8b6136e9e9b4d4916e27b85d08199",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/60833778d4b8b6136e9e9b4d4916e27b85d08199",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/60833778d4b8b6136e9e9b4d4916e27b85d08199",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/60833778d4b8b6136e9e9b4d4916e27b85d08199/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "14ac0adcc7c0224a467e38bbd4ebf39d824ada8d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/14ac0adcc7c0224a467e38bbd4ebf39d824ada8d",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/14ac0adcc7c0224a467e38bbd4ebf39d824ada8d"
      }
    ],
    "stats": {
      "total": 53,
      "additions": 52,
      "deletions": 1
    },
    "files": [
      {
        "sha": "1891f6064aa4b1bf593b37fd90c7646d2d43772d",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 0,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/60833778d4b8b6136e9e9b4d4916e27b85d08199/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/60833778d4b8b6136e9e9b4d4916e27b85d08199/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=60833778d4b8b6136e9e9b4d4916e27b85d08199",
        "patch": "@@ -3021,6 +3021,13 @@ bool static ProcessMessage(CNode* pfrom, string strCommand, CDataStream& vRecv)\n     }\n \n \n+    else if (strCommand == \"getbestchain\")\n+    {\n+        CBestChain bc(hashBestChain, nBestHeight);\n+        pfrom->PushMessage(\"bestchain\", bc);\n+    }\n+\n+\n     else\n     {\n         // Ignore unknown commands for extensibility"
      },
      {
        "sha": "c73a31fd2c724f97ba98d23acd48656a5335a463",
        "filename": "src/main.h",
        "status": "modified",
        "additions": 41,
        "deletions": 0,
        "changes": 41,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/60833778d4b8b6136e9e9b4d4916e27b85d08199/src/main.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/60833778d4b8b6136e9e9b4d4916e27b85d08199/src/main.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.h?ref=60833778d4b8b6136e9e9b4d4916e27b85d08199",
        "patch": "@@ -168,6 +168,47 @@ class CDiskTxPos\n };\n \n \n+/** CBestChain - a network data structure describing the best chain */\n+class CBestChain\n+{\n+public:\n+    uint256 hash;\n+    unsigned int nHeight;\n+\n+    CBestChain() { SetNull(); }\n+    CBestChain(uint256 hashIn, unsigned int nIn) { hash = hashIn; nHeight = nIn; }\n+    IMPLEMENT_SERIALIZE( READWRITE(FLATDATA(*this)); )\n+    void SetNull() { hash = 0; nHeight = (unsigned int) -1; }\n+    bool IsNull() const { return (hash == 0 && nHeight == (unsigned int) -1); }\n+\n+    friend bool operator<(const CBestChain& a, const CBestChain& b)\n+    {\n+        return (a.hash < b.hash || (a.hash == b.hash && a.nHeight < b.nHeight));\n+    }\n+\n+    friend bool operator==(const CBestChain& a, const CBestChain& b)\n+    {\n+        return (a.hash == b.hash && a.nHeight == b.nHeight);\n+    }\n+\n+    friend bool operator!=(const CBestChain& a, const CBestChain& b)\n+    {\n+        return !(a == b);\n+    }\n+\n+    std::string ToString() const\n+    {\n+        return strprintf(\"CBestChain(%s, %u)\", hash.ToString().substr(0,10).c_str(), nHeight);\n+    }\n+\n+    void print() const\n+    {\n+        printf(\"%s\\n\", ToString().c_str());\n+    }\n+};\n+\n+\n+\n \n /** An inpoint - a combination of a transaction and an index n into its vin */\n class CInPoint"
      },
      {
        "sha": "b6e5cc682db3506d74be9dbebf4e3786965a8941",
        "filename": "src/version.h",
        "status": "modified",
        "additions": 4,
        "deletions": 1,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/60833778d4b8b6136e9e9b4d4916e27b85d08199/src/version.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/60833778d4b8b6136e9e9b4d4916e27b85d08199/src/version.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/version.h?ref=60833778d4b8b6136e9e9b4d4916e27b85d08199",
        "patch": "@@ -25,7 +25,7 @@ extern const std::string CLIENT_DATE;\n // network protocol versioning\n //\n \n-static const int PROTOCOL_VERSION = 60002;\n+static const int PROTOCOL_VERSION = 60003;\n \n // earlier versions not supported as of Feb 2012, and are disconnected\n static const int MIN_PROTO_VERSION = 209;\n@@ -44,4 +44,7 @@ static const int BIP0031_VERSION = 60000;\n // \"mempool\" command, enhanced \"getdata\" behavior starts with this version:\n static const int MEMPOOL_GD_VERSION = 60002;\n \n+// \"getbestchain\" command starts with this version\n+static const int GETBESTCHAIN_VERSION = 60003;\n+\n #endif"
      }
    ]
  }
]