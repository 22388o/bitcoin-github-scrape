[
  {
    "sha": "7caba38568bf13ff898d58662fe7ed72d91ecce3",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo3Y2FiYTM4NTY4YmYxM2ZmODk4ZDU4NjYyZmU3ZWQ3MmQ5MWVjY2Uz",
    "commit": {
      "author": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2017-05-10T07:35:36Z"
      },
      "committer": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2017-12-05T21:03:59Z"
      },
      "message": "Add NODE_NETWORK_LIMITED flags and min block amount constants",
      "tree": {
        "sha": "d26feb58a560258f54796b4fa5a36ddb451f56bd",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d26feb58a560258f54796b4fa5a36ddb451f56bd"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/7caba38568bf13ff898d58662fe7ed72d91ecce3",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyhopCNzi8TB0xizeHrd2uwPHki0FAlonCb8ACgkQHrd2uwPH\nki0MKxAAqgEHxZXSWsW9DL7r2qOg5gkAtPB1KkcbCGpgRemeyktr9wgN/HdUAeU0\nmM3E5xoMQadJPQL01J0NpCmuMGdxrkkJTBpIoVQjmyo6opz2mmJ99jvpjIZgEIPe\ny7iM1eQxZt4hH9f3Tyzc63dnzi6Rmhzzi8zrDFWF0ZruXc1TI4iyJYOGxoYzqzkx\n8jn2hp2/pOiwrl4AGgvyOEOK0hwegELqp/Lrxnzk3uI7rd5efEjpGCn+mcIolNUY\nl+sgEnnhg235W34Q6foXsm3jNuyU+xNXH7oKuTCGyYmkuffWwzm5PtaOKwgVHej+\n1Hd5ebFoe6y7zCmHMXrpjRce8pE286/pqDcHkMv88bKa84aN7lnxU4gzZmNrbokm\n4raLCyQPRQG2cIpBuB1vEV9/a7YNxLtuIVcRBpXxOE+W5doOwzDJ9hMVl5sYRDxw\niTlPN/zB6benGoKs+l2ALYgzMQy7Q4YrUF2v1m1cGcwBBFi7qTWcrT+qLgTc7SOr\nYpBm6iB6mTXGkPIaP1A23nVLta3+WBygEXSAtamesgNIRs58SIPE9o4L6tj7Qi7M\n22cLmgFjPlgcR6O6TY8uyUEtXnCB7vzPmiA9nmTnZei9WvaDbdE60HwNyAtSUwYP\nZjW/ll3bltPZd+R4viDf7lk+hz5IRHnTBK7nOA73HOy9emfFAMo=\n=N/01\n-----END PGP SIGNATURE-----",
        "payload": "tree d26feb58a560258f54796b4fa5a36ddb451f56bd\nparent 91eeaa03354bbb4ee79d6defaffaef2b32ecbe29\nauthor Jonas Schnelli <dev@jonasschnelli.ch> 1494401736 +0200\ncommitter Jonas Schnelli <dev@jonasschnelli.ch> 1512507839 -1000\n\nAdd NODE_NETWORK_LIMITED flags and min block amount constants\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7caba38568bf13ff898d58662fe7ed72d91ecce3",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/7caba38568bf13ff898d58662fe7ed72d91ecce3",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7caba38568bf13ff898d58662fe7ed72d91ecce3/comments",
    "author": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "91eeaa03354bbb4ee79d6defaffaef2b32ecbe29",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/91eeaa03354bbb4ee79d6defaffaef2b32ecbe29",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/91eeaa03354bbb4ee79d6defaffaef2b32ecbe29"
      }
    ],
    "stats": {
      "total": 11,
      "additions": 8,
      "deletions": 3
    },
    "files": [
      {
        "sha": "cf1d40db7765aeab7d92e8f2da0ddd72b60ed206",
        "filename": "src/protocol.h",
        "status": "modified",
        "additions": 6,
        "deletions": 3,
        "changes": 9,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7caba38568bf13ff898d58662fe7ed72d91ecce3/src/protocol.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7caba38568bf13ff898d58662fe7ed72d91ecce3/src/protocol.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/protocol.h?ref=7caba38568bf13ff898d58662fe7ed72d91ecce3",
        "patch": "@@ -246,9 +246,8 @@ const std::vector<std::string> &getAllNetMessageTypes();\n enum ServiceFlags : uint64_t {\n     // Nothing\n     NODE_NONE = 0,\n-    // NODE_NETWORK means that the node is capable of serving the block chain. It is currently\n-    // set by all Bitcoin Core nodes, and is unset by SPV clients or other peers that just want\n-    // network services but don't provide them.\n+    // NODE_NETWORK means that the node is capable of serving the complete block chain. It is currently\n+    // set by all Bitcoin Core non pruned nodes, and is unset by SPV clients or other light clients.\n     NODE_NETWORK = (1 << 0),\n     // NODE_GETUTXO means the node is capable of responding to the getutxo protocol request.\n     // Bitcoin Core does not support this but a patch set called Bitcoin XT does.\n@@ -264,6 +263,10 @@ enum ServiceFlags : uint64_t {\n     // NODE_XTHIN means the node supports Xtreme Thinblocks\n     // If this is turned off then the node will not service nor make xthin requests\n     NODE_XTHIN = (1 << 4),\n+    // NODE_NETWORK_LIMITED means the same as NODE_NETWORK with the limitation of only\n+    // serving the last 288 (2 day) blocks\n+    // See BIP159 for details on how this is implemented.\n+    NODE_NETWORK_LIMITED = (1 << 10),\n \n     // Bits 24-31 are reserved for temporary experiments. Just pick a bit that\n     // isn't getting used, or one not being used much, and notify the"
      },
      {
        "sha": "0d22a82ffc1ebfb495ce8df47e3c2f79fdb2742c",
        "filename": "src/validation.h",
        "status": "modified",
        "additions": 2,
        "deletions": 0,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/7caba38568bf13ff898d58662fe7ed72d91ecce3/src/validation.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/7caba38568bf13ff898d58662fe7ed72d91ecce3/src/validation.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/validation.h?ref=7caba38568bf13ff898d58662fe7ed72d91ecce3",
        "patch": "@@ -203,6 +203,8 @@ extern bool fPruneMode;\n extern uint64_t nPruneTarget;\n /** Block files containing a block-height within MIN_BLOCKS_TO_KEEP of chainActive.Tip() will not be pruned. */\n static const unsigned int MIN_BLOCKS_TO_KEEP = 288;\n+/** Minimum blocks required to signal NODE_NETWORK_LIMITED */\n+static const unsigned int NODE_NETWORK_LIMITED_MIN_BLOCKS = 288;\n \n static const signed int DEFAULT_CHECKBLOCKS = 6;\n static const unsigned int DEFAULT_CHECKLEVEL = 3;"
      }
    ]
  },
  {
    "sha": "27df193efdac8a7c4d3d4bbe8a29c8d79c6ce623",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyN2RmMTkzZWZkYWM4YTdjNGQzZDRiYmU4YTI5YzhkNzljNmNlNjIz",
    "commit": {
      "author": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2017-10-01T03:33:58Z"
      },
      "committer": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2017-12-05T21:03:59Z"
      },
      "message": "Always set NODE_NETWORK_LIMITED bit\n\nThe current pruning implementation does ensure to always conform to BIP159",
      "tree": {
        "sha": "926c0369475967045b58605317bc35977a7ce704",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/926c0369475967045b58605317bc35977a7ce704"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/27df193efdac8a7c4d3d4bbe8a29c8d79c6ce623",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyhopCNzi8TB0xizeHrd2uwPHki0FAlonCb8ACgkQHrd2uwPH\nki1Lvw//XmrIgJa7D6RRXGQQmw2/o2rNUHmLQ1wco4heTu3MaBAmUN1Ybvgktnjl\nVtgzWWeCj8tzaQKiAP3l7hu6uug2bhzCAIav5XFwvQfR828S9tTWN60gHxDZ8EiR\n7H3sqBXZxX5jAISWraoqqrB5jJp70OaIgQWZ6R2lNMOVEPTAGkeeasNQs4mUkzq7\nasahtH8aF2B8ZVx4AJGDAxLjDp0npExJ9ij9p+5cI+Hmr4Zx7Z9t4YxX7L5GKS1/\n5h+veKaQMVPhlbpqd70snyPD1zemCYzQzLe4VRtHFLlscGXRgvknYNvS1XzPDhYd\nk8DXaJBrL0oX2Fvn3BvjsTP9HtQHDec9QRm1Vd9/X6dUYRP+bknAXO47dlEot3RW\n1yZnpRVZ3CBhGXvGD+rFnk/McjOCBxa9iIn0pF8jrcOrxpRVL8MnntbHDNfcpFuq\nMwe2U6egvbpl5U36FW7lHZRCk9n6AFWIhBwrqH5mSH9wTwLegGrxa4HFj2bSKiSC\n0hdI7VHY0R/IArgIjt7hiWxbMC6VAUzUnnzuDrGkWH6hxIEBRE3mUuuoC3ni8R4I\nEBkGaR1V9+cJ7vnDTNjHwv6VJACurDXruuY81OxrZ5+dof9sWdwP2+TCk7uZuyHu\nFLrM0Kd9T1tNH9K1aeEJAzr6WHvY8DiMLACC8RKiFqdXiII+LIs=\n=ecft\n-----END PGP SIGNATURE-----",
        "payload": "tree 926c0369475967045b58605317bc35977a7ce704\nparent 7caba38568bf13ff898d58662fe7ed72d91ecce3\nauthor Jonas Schnelli <dev@jonasschnelli.ch> 1506828838 -0700\ncommitter Jonas Schnelli <dev@jonasschnelli.ch> 1512507839 -1000\n\nAlways set NODE_NETWORK_LIMITED bit\n\nThe current pruning implementation does ensure to always conform to BIP159\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/27df193efdac8a7c4d3d4bbe8a29c8d79c6ce623",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/27df193efdac8a7c4d3d4bbe8a29c8d79c6ce623",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/27df193efdac8a7c4d3d4bbe8a29c8d79c6ce623/comments",
    "author": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "7caba38568bf13ff898d58662fe7ed72d91ecce3",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/7caba38568bf13ff898d58662fe7ed72d91ecce3",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/7caba38568bf13ff898d58662fe7ed72d91ecce3"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 1,
      "deletions": 1
    },
    "files": [
      {
        "sha": "67e01c9ba9ec55fdec41bd32b5b5276c22164a3a",
        "filename": "src/init.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/27df193efdac8a7c4d3d4bbe8a29c8d79c6ce623/src/init.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/27df193efdac8a7c4d3d4bbe8a29c8d79c6ce623/src/init.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/init.cpp?ref=27df193efdac8a7c4d3d4bbe8a29c8d79c6ce623",
        "patch": "@@ -816,7 +816,7 @@ namespace { // Variables internal to initialization process only\n int nMaxConnections;\n int nUserMaxConnections;\n int nFD;\n-ServiceFlags nLocalServices = NODE_NETWORK;\n+ServiceFlags nLocalServices = ServiceFlags(NODE_NETWORK | NODE_NETWORK_LIMITED);\n \n } // namespace\n "
      }
    ]
  },
  {
    "sha": "bd0941652444df09c32eb552952fd3705d03fd6a",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiZDA5NDE2NTI0NDRkZjA5YzMyZWI1NTI5NTJmZDM3MDVkMDNmZDZh",
    "commit": {
      "author": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2017-08-11T18:59:24Z"
      },
      "committer": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2017-12-05T21:08:34Z"
      },
      "message": "Avoid leaking the prune height through getdata (fingerprinting countermeasure)",
      "tree": {
        "sha": "aebbfcee2e17a0deffbde9d66697268d2a8c7e37",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/aebbfcee2e17a0deffbde9d66697268d2a8c7e37"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/bd0941652444df09c32eb552952fd3705d03fd6a",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyhopCNzi8TB0xizeHrd2uwPHki0FAlonCtgACgkQHrd2uwPH\nki1XAhAAuMn1vyDiZgBInWnUkNovN7nIfzn4k0fCARBoVDxmuTaGwk6qsZLrHADq\n2xiKTcyuqTW5mwyulpIode7uMb7WKeSDA4K0z0rzBp01m+BlXoqHt+2RZ0FgPKxr\npL3GXZF2E2IPxxt58Vl5MXYqxaXFlOzU1C4fFz+q+G9ZlwoM4Pftb00soAIi3+QI\nO7zo3Ts0nzQvfGEo9jnsGT3bLQAspbsduZ+FasJNultAHEFsvZpqOqS/9D7iH21J\nzZwZ62BNmFT+72XXizh1YUasBAMcwmnwzrw3BYZfdUbmTgkObu0ZesqyJfsAZ+Df\nzOfGjSL4CGpSZSMgnst/heMe0nBtMxNPcgCfqr05d2limbMr2qedrSey1MtXpspO\n/UlGsJ10FVdrDBA4xlaTbuZ05Mb28zTUK03F9wNVJpw6jf//twtjFopkYYcoT7S7\nyBhCq9V1ZAYfbJ68uXduOlx/+ednB5zsxapaBuV0dgZQ3jLTQ+DW3KoC6J576VwN\nFbHoQCmBKh3QFM0RN3eiMuKntdst00LGhfRdqAdnChNRM+7FBIkkQonjQuQ2VoFR\n7vEkCrguyMctGAHdtySkd0ub2x5LcCSwEEzUkjFTHlEKZV2GZYSyCwDABS/BjcYq\nultyHKaE7lb1GQtBJYy6c1VAVM3A9dWFfBK9eJaCOdKiqa59RxY=\n=Z2yV\n-----END PGP SIGNATURE-----",
        "payload": "tree aebbfcee2e17a0deffbde9d66697268d2a8c7e37\nparent 27df193efdac8a7c4d3d4bbe8a29c8d79c6ce623\nauthor Jonas Schnelli <dev@jonasschnelli.ch> 1502477964 +0200\ncommitter Jonas Schnelli <dev@jonasschnelli.ch> 1512508114 -1000\n\nAvoid leaking the prune height through getdata (fingerprinting countermeasure)\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bd0941652444df09c32eb552952fd3705d03fd6a",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/bd0941652444df09c32eb552952fd3705d03fd6a",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bd0941652444df09c32eb552952fd3705d03fd6a/comments",
    "author": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "27df193efdac8a7c4d3d4bbe8a29c8d79c6ce623",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/27df193efdac8a7c4d3d4bbe8a29c8d79c6ce623",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/27df193efdac8a7c4d3d4bbe8a29c8d79c6ce623"
      }
    ],
    "stats": {
      "total": 10,
      "additions": 10,
      "deletions": 0
    },
    "files": [
      {
        "sha": "85e6d9c73dae6cf4bbfdd8153797b6207d79f263",
        "filename": "src/net_processing.cpp",
        "status": "modified",
        "additions": 10,
        "deletions": 0,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/bd0941652444df09c32eb552952fd3705d03fd6a/src/net_processing.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/bd0941652444df09c32eb552952fd3705d03fd6a/src/net_processing.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net_processing.cpp?ref=bd0941652444df09c32eb552952fd3705d03fd6a",
        "patch": "@@ -1091,6 +1091,16 @@ void static ProcessGetData(CNode* pfrom, const Consensus::Params& consensusParam\n                     pfrom->fDisconnect = true;\n                     send = false;\n                 }\n+                // Avoid leaking prune-height by never sending blocks below the NODE_NETWORK_LIMITED threshold\n+                if (send && !pfrom->fWhitelisted && (\n+                        (((pfrom->GetLocalServices() & NODE_NETWORK_LIMITED) == NODE_NETWORK_LIMITED) && ((pfrom->GetLocalServices() & NODE_NETWORK) != NODE_NETWORK) && (chainActive.Tip()->nHeight - mi->second->nHeight > (int)NODE_NETWORK_LIMITED_MIN_BLOCKS + 2 /* add two blocks buffer extension for possible races */) )\n+                   )) {\n+                    LogPrint(BCLog::NET, \"Ignore block request below NODE_NETWORK_LIMITED threshold from peer=%d\\n\", pfrom->GetId());\n+\n+                    //disconnect node and prevent it from stalling (would otherwise wait for the missing block)\n+                    pfrom->fDisconnect = true;\n+                    send = false;\n+                }\n                 // Pruned nodes may have deleted the block, so check whether\n                 // it's available before trying to send.\n                 if (send && (mi->second->nStatus & BLOCK_HAVE_DATA))"
      }
    ]
  },
  {
    "sha": "e054d0e532cdb587193952a629e94c669eff95f5",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplMDU0ZDBlNTMyY2RiNTg3MTkzOTUyYTYyOWU5NGM2NjllZmY5NWY1",
    "commit": {
      "author": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2017-11-20T20:57:34Z"
      },
      "committer": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2017-12-07T07:13:48Z"
      },
      "message": "[QA] Add node_network_limited test",
      "tree": {
        "sha": "bf816d4c9f66d7f5689cefa6b178d41ce7a67e36",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bf816d4c9f66d7f5689cefa6b178d41ce7a67e36"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e054d0e532cdb587193952a629e94c669eff95f5",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyhopCNzi8TB0xizeHrd2uwPHki0FAloo6i0ACgkQHrd2uwPH\nki250xAAmwYik6yp00KV0SYpONFvm23j/W74eFZr5z3giQlNJeRldpNxnJ2mn7QL\nRonXELY1RJF2K283gy00NZ0kiToFlQWC4HyJSRH8AELKf/WDppaQf+IUa8x7SpCY\ngXeaSSzz3VBxQrEh0jz+CzjgaD6Fu81rG8MtI7p5TMtIddvetEM4VtWgJT3hu1Mn\nwhRBmu9a0mvo+v8sJnBnxPSoPYfnWa6EJdy1y3HKfOSmP/1Fo3oU8HHAg9ymwuui\n0xxRLO+rjMKq/QV0Mbv/e7gsPOgzVEGXuWqOOk/xTKddEiFCigVafEJBMgrQ5hxp\nZvxkh7p0YcHTrU3nVgC/L1oIBPt41V/mIxJco7IUTSvhqSD3ZgsFBqwW+b3ZYmuN\nk4H8ODDAlJzfilSWm5u7+wts8Bxos9nFK1LsDSgshzBa2m2iRdc9G11msdLRcBda\n1FP0xsN1T+0hzf2V47FNHrVkftPTZQ6lEtUd4ybA7D46kekBBqAbhnX6X9H7GEcl\nmlKed2r7oWMO38iUi+FMAtuMM5VAMDemQEhAlwelY4rwiowfSJ0dWRGorRMFC2O3\nghZce4uEoCVIWgI+C/JtDX2knnWWyfUVLyaZ/cy9K4e/1bx4IWS542602Lo+pHjW\nXpKu4FtAa9INIIDPLxlpPecxCKiTZp3gapw0mc8VuuXmyYYtBHw=\n=TCsv\n-----END PGP SIGNATURE-----",
        "payload": "tree bf816d4c9f66d7f5689cefa6b178d41ce7a67e36\nparent bd0941652444df09c32eb552952fd3705d03fd6a\nauthor Jonas Schnelli <dev@jonasschnelli.ch> 1511211454 -1000\ncommitter Jonas Schnelli <dev@jonasschnelli.ch> 1512630828 -1000\n\n[QA] Add node_network_limited test\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e054d0e532cdb587193952a629e94c669eff95f5",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/e054d0e532cdb587193952a629e94c669eff95f5",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e054d0e532cdb587193952a629e94c669eff95f5/comments",
    "author": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "bd0941652444df09c32eb552952fd3705d03fd6a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/bd0941652444df09c32eb552952fd3705d03fd6a",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/bd0941652444df09c32eb552952fd3705d03fd6a"
      }
    ],
    "stats": {
      "total": 82,
      "additions": 82,
      "deletions": 0
    },
    "files": [
      {
        "sha": "6d1bf7ced284b9b0621991566d93bbc1bb2f1e3d",
        "filename": "test/functional/node_network_limited.py",
        "status": "added",
        "additions": 81,
        "deletions": 0,
        "changes": 81,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e054d0e532cdb587193952a629e94c669eff95f5/test/functional/node_network_limited.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e054d0e532cdb587193952a629e94c669eff95f5/test/functional/node_network_limited.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/node_network_limited.py?ref=e054d0e532cdb587193952a629e94c669eff95f5",
        "patch": "@@ -0,0 +1,81 @@\n+#!/usr/bin/env python3\n+# Copyright (c) 2017 The Bitcoin Core developers\n+# Distributed under the MIT software license, see the accompanying\n+# file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+from test_framework.test_framework import BitcoinTestFramework\n+from test_framework.util import *\n+from test_framework.mininode import *\n+\n+class BaseNode(P2PInterface):\n+    nServices = 0\n+    firstAddrnServices = 0\n+    def on_version(self, message):\n+        self.nServices = message.nServices\n+\n+class NodeNetworkLimitedTest(BitcoinTestFramework):\n+    def set_test_params(self):\n+        self.setup_clean_chain = True\n+        self.num_nodes = 1\n+        self.extra_args = [['-prune=550']]\n+\n+    def getSignaledServiceFlags(self):\n+        node = self.nodes[0].add_p2p_connection(BaseNode())\n+        NetworkThread().start()\n+        node.wait_for_verack()\n+        services = node.nServices\n+        self.nodes[0].disconnect_p2ps()\n+        node.wait_for_disconnect()\n+        return services\n+\n+    def tryGetBlockViaGetData(self, blockhash, must_disconnect):\n+        node = self.nodes[0].add_p2p_connection(BaseNode())\n+        NetworkThread().start()\n+        node.wait_for_verack()\n+        node.send_message(msg_verack())\n+        getdata_request = msg_getdata()\n+        getdata_request.inv.append(CInv(2, int(blockhash, 16)))\n+        node.send_message(getdata_request)\n+\n+        if (must_disconnect):\n+            #ensure we get disconnected\n+            node.wait_for_disconnect(5)\n+        else:\n+            # check if the peer sends us the requested block\n+            node.wait_for_block(int(blockhash, 16), 3)\n+            self.nodes[0].disconnect_p2ps()\n+            node.wait_for_disconnect()\n+\n+    def run_test(self):\n+        #NODE_BLOOM & NODE_WITNESS & NODE_NETWORK_LIMITED must now be signaled\n+        assert_equal(self.getSignaledServiceFlags(), 1036) #1036 == 0x40C == 0100 0000 1100\n+#                                                                              |        ||\n+#                                                                              |        |^--- NODE_BLOOM\n+#                                                                              |        ^---- NODE_WITNESS\n+#                                                                              ^-- NODE_NETWORK_LIMITED\n+\n+        #now mine some blocks over the NODE_NETWORK_LIMITED + 2(racy buffer ext.) target\n+        firstblock = self.nodes[0].generate(1)[0]\n+        blocks = self.nodes[0].generate(292)\n+        blockWithinLimitedRange = blocks[-1]\n+\n+        #make sure we can max retrive block at tip-288\n+        #requesting block at height 2 (tip-289) must fail (ignored)\n+        self.tryGetBlockViaGetData(firstblock, True) #first block must lead to disconnect\n+        self.tryGetBlockViaGetData(blocks[1], False) #last block in valid range\n+        self.tryGetBlockViaGetData(blocks[0], True) #first block outside of the 288+2 limit\n+\n+        #NODE_NETWORK_LIMITED must still be signaled after restart\n+        self.restart_node(0)\n+        assert_equal(self.getSignaledServiceFlags(), 1036)\n+\n+        #test the RPC service flags\n+        assert_equal(self.nodes[0].getnetworkinfo()['localservices'], \"000000000000040c\")\n+\n+        # getdata a block above the NODE_NETWORK_LIMITED threshold must be possible\n+        self.tryGetBlockViaGetData(blockWithinLimitedRange, False)\n+\n+        # getdata a block below the NODE_NETWORK_LIMITED threshold must be ignored\n+        self.tryGetBlockViaGetData(firstblock, True)\n+\n+if __name__ == '__main__':\n+    NodeNetworkLimitedTest().main()"
      },
      {
        "sha": "58faec521d74f9c8d1722edbb9ce7251420b05f3",
        "filename": "test/functional/test_runner.py",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e054d0e532cdb587193952a629e94c669eff95f5/test/functional/test_runner.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e054d0e532cdb587193952a629e94c669eff95f5/test/functional/test_runner.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/test/functional/test_runner.py?ref=e054d0e532cdb587193952a629e94c669eff95f5",
        "patch": "@@ -128,6 +128,7 @@\n     'uacomment.py',\n     'p2p-acceptblock.py',\n     'feature_logging.py',\n+    'node_network_limited.py',\n ]\n \n EXTENDED_SCRIPTS = ["
      }
    ]
  },
  {
    "sha": "de74c625833bba8d8171a2d0dd6ede2e9d5da88b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkZTc0YzYyNTgzM2JiYThkODE3MWEyZDBkZDZlZGUyZTlkNWRhODhi",
    "commit": {
      "author": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2017-08-08T20:46:33Z"
      },
      "committer": {
        "name": "Jonas Schnelli",
        "email": "dev@jonasschnelli.ch",
        "date": "2017-12-07T07:13:53Z"
      },
      "message": "[Doc] Update bip.md, add support for BIP 159",
      "tree": {
        "sha": "6d57789cc6a4004b26524a61483dc8dcea809484",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/6d57789cc6a4004b26524a61483dc8dcea809484"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/de74c625833bba8d8171a2d0dd6ede2e9d5da88b",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCAAdFiEEyhopCNzi8TB0xizeHrd2uwPHki0FAloo6jEACgkQHrd2uwPH\nki1rhRAAkG98gH1IQ8mmSboJXBVNZd2hm3+RL/+SqI0ALx5ITmq9hqtDYAJm5T8/\nMy2GBvQs+Nk8o6mpPQDkgsapAuoLF31JJftAIyBUETvbLOHnTTcDtNmKknmExyth\n5DxF7D9iKwzaFBRnBFBs1WFuK91P2KP1bmQ9DMBV+TU/74zZWZ91L4kOxTpjI3q9\n3OolyOs1Usxk5XXFrafFlZotjb7WGDwx6VWeacnvbQ0J1OBSlH3N2v/wwrqpqbVE\nWCx8ljNXc/yExB5k6QPU9Kw31fTbD2lixu3pEZbS96JQYE3XLQ4/H5yJ3itm94br\n2zmAnhAiN5IAGjW60UfDXsJj+ZES5EyR1FHGv+z58fhUzZa+WlT7W+bIjaR1Y/76\nASlHqrboMGEZCVbvWCMOnSEH33mAJ2Jk9xt4/nQ6poeKpv5Y+9h+mCGFV383IZHy\npc86i9NLSqUibjffUf08HhnrKg+lsRMrmu4A3jjPY4xpID/tE3Br/AC+Z5EbtDEt\nukPdBJu6KDn3P33GLCUw2FBJErpNFCiHQ4vFkZqnrI2lrgizqSXH8gXFTLRjAVz6\nthwhbl7jp6dcdXChd7luZXMcEyqzU+ywRnyQfiXs52afHOjoR//CELt30PHD97mO\nNUW4nVaNrUdBnZ6GvlvtT58aAwdM3fOHUHdCg7OOW64GTZGGmOw=\n=n2ld\n-----END PGP SIGNATURE-----",
        "payload": "tree 6d57789cc6a4004b26524a61483dc8dcea809484\nparent e054d0e532cdb587193952a629e94c669eff95f5\nauthor Jonas Schnelli <dev@jonasschnelli.ch> 1502225193 +0200\ncommitter Jonas Schnelli <dev@jonasschnelli.ch> 1512630833 -1000\n\n[Doc] Update bip.md, add support for BIP 159\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/de74c625833bba8d8171a2d0dd6ede2e9d5da88b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/de74c625833bba8d8171a2d0dd6ede2e9d5da88b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/de74c625833bba8d8171a2d0dd6ede2e9d5da88b/comments",
    "author": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "jonasschnelli",
      "id": 178464,
      "node_id": "MDQ6VXNlcjE3ODQ2NA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/178464?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonasschnelli",
      "html_url": "https://github.com/jonasschnelli",
      "followers_url": "https://api.github.com/users/jonasschnelli/followers",
      "following_url": "https://api.github.com/users/jonasschnelli/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonasschnelli/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonasschnelli/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonasschnelli/subscriptions",
      "organizations_url": "https://api.github.com/users/jonasschnelli/orgs",
      "repos_url": "https://api.github.com/users/jonasschnelli/repos",
      "events_url": "https://api.github.com/users/jonasschnelli/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonasschnelli/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "e054d0e532cdb587193952a629e94c669eff95f5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e054d0e532cdb587193952a629e94c669eff95f5",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/e054d0e532cdb587193952a629e94c669eff95f5"
      }
    ],
    "stats": {
      "total": 1,
      "additions": 1,
      "deletions": 0
    },
    "files": [
      {
        "sha": "fbff94a329a316417de4bd374c38f95f607d70ff",
        "filename": "doc/bips.md",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/de74c625833bba8d8171a2d0dd6ede2e9d5da88b/doc/bips.md",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/de74c625833bba8d8171a2d0dd6ede2e9d5da88b/doc/bips.md",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/doc/bips.md?ref=de74c625833bba8d8171a2d0dd6ede2e9d5da88b",
        "patch": "@@ -33,3 +33,4 @@ BIPs that are implemented by Bitcoin Core (up-to-date up to **v0.13.0**):\n * [`BIP 145`](https://github.com/bitcoin/bips/blob/master/bip-0145.mediawiki): getblocktemplate updates for Segregated Witness as of **v0.13.0** ([PR 8149](https://github.com/bitcoin/bitcoin/pull/8149)).\n * [`BIP 147`](https://github.com/bitcoin/bips/blob/master/bip-0147.mediawiki): NULLDUMMY softfork as of **v0.13.1** ([PR 8636](https://github.com/bitcoin/bitcoin/pull/8636) and [PR 8937](https://github.com/bitcoin/bitcoin/pull/8937)).\n * [`BIP 152`](https://github.com/bitcoin/bips/blob/master/bip-0152.mediawiki): Compact block transfer and related optimizations are used as of **v0.13.0** ([PR 8068](https://github.com/bitcoin/bitcoin/pull/8068)).\n+* [`BIP 159`](https://github.com/bitcoin/bips/blob/master/bip-0159.mediawiki): NODE_NETWORK_LIMITED service bit [signaling only] is supported as of **v0.16.0** ([PR 10740](https://github.com/bitcoin/bitcoin/pull/10740))."
      }
    ]
  }
]