[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/565196211",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#issuecomment-565196211",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17732",
    "id": 565196211,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NTE5NjIxMQ==",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?u=3f68150a5f30acd541d1ed279376cd20b78046b1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-12T21:32:26Z",
    "updated_at": "2019-12-12T21:32:26Z",
    "author_association": "MEMBER",
    "body": "Partial tested ACK 9a61f78\r\n\r\nAfter removing valgrind:\r\n```bash\r\n$ test/functional/tool_wallet.py  --valgrind\r\n2019-12-12T21:23:04.053000Z TestFramework (INFO): Initializing test directory /tmp/bitcoin_func_test_0212zhle\r\n2019-12-12T21:23:04.054000Z TestFramework (ERROR): Unexpected exception caught during testing\r\nTraceback (most recent call last):\r\n  File \"/home/jon/projects/bitcoin/bitcoin/test/functional/test_framework/test_framework.py\", line 111, in main\r\n    self.setup()\r\n  File \"/home/jon/projects/bitcoin/bitcoin/test/functional/test_framework/test_framework.py\", line 226, in setup\r\n    self.setup_network()\r\n  File \"/home/jon/projects/bitcoin/bitcoin/test/functional/test_framework/test_framework.py\", line 315, in setup_network\r\n    self.setup_nodes()\r\n  File \"/home/jon/projects/bitcoin/bitcoin/test/functional/test_framework/test_framework.py\", line 339, in setup_nodes\r\n    self.add_nodes(self.num_nodes, extra_args)\r\n  File \"/home/jon/projects/bitcoin/bitcoin/test/functional/test_framework/test_framework.py\", line 403, in add_nodes\r\n    use_valgrind=self.options.valgrind,\r\n  File \"/home/jon/projects/bitcoin/bitcoin/test/functional/test_framework/test_node.py\", line 104, in __init__\r\n    raise Exception('Valgrind not present')\r\nException: Valgrind not present\r\n```\r\nAfter reinstalling valgrind 3.14 and adding this `print` statement to the bottom of the `if use_valgrind` block:\r\n```python\r\nprint(\"Running tests with valgrind {} and flag {}\"\r\n      .format(valgrind_version, self.valgrind_early_exit(valgrind_version)))\r\n```\r\n```bash\r\n$ test/functional/tool_wallet.py  --valgrind\r\n2019-12-12T21:24:04.216000Z TestFramework (INFO): Initializing test directory /tmp/bitcoin_func_test_w4dpyzgc\r\nRunning tests with valgrind (3, 14) and flag --exit-on-first-error=yes\r\n```\r\nNot tested: running tests with valgrind version < 3.14.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/565196211/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/566046977",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#issuecomment-566046977",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17732",
    "id": 566046977,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NjA0Njk3Nw==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-16T12:48:45Z",
    "updated_at": "2019-12-16T12:48:45Z",
    "author_association": "MEMBER",
    "body": "On macOS I'm seeing the right error when valgrind is missing, but then it goes into an infinite recursion:\r\n\r\n```\r\n2019-12-16T12:47:33.219000Z TestFramework (ERROR): Unexpected exception caught during testing\r\nTraceback (most recent call last):\r\n  File \"/Users/sjors/dev/bitcoin/test/functional/test_framework/test_framework.py\", line 111, in main\r\n    self.setup()\r\n  File \"/Users/sjors/dev/bitcoin/test/functional/test_framework/test_framework.py\", line 226, in setup\r\n    self.setup_network()\r\n  File \"test/functional/wallet_dump.py\", line 98, in setup_network\r\n    self.add_nodes(self.num_nodes, extra_args=self.extra_args)\r\n  File \"/Users/sjors/dev/bitcoin/test/functional/test_framework/test_framework.py\", line 403, in add_nodes\r\n    use_valgrind=self.options.valgrind,\r\n  File \"/Users/sjors/dev/bitcoin/test/functional/test_framework/test_node.py\", line 104, in __init__\r\n    raise Exception('Valgrind not present')\r\nException: Valgrind not present\r\nException ignored in: <bound method TestNode.__del__ of <test_framework.test_node.TestNode object at 0x103280be0>>\r\nTraceback (most recent call last):\r\n  File \"/Users/sjors/dev/bitcoin/test/functional/test_framework/test_node.py\", line 182, in __del__\r\n    if self.process and self.cleanup_on_exit:\r\n  File \"/Users/sjors/dev/bitcoin/test/functional/test_framework/test_node.py\", line 191, in __getattr__\r\n    if self.use_cli:\r\n  File \"/Users/sjors/dev/bitcoin/test/functional/test_framework/test_node.py\", line 191, in __getattr__\r\n    if self.use_cli:\r\n...\r\n  File \"/Users/sjors/dev/bitcoin/test/functional/test_framework/test_node.py\", line 191, in __getattr__\r\n    if self.use_cli:\r\nRecursionError: maximum recursion depth exceeded\r\n2019-12-16T12:47:33.302000Z TestFramework (INFO): Stopping nodes\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/566046977/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/566097989",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#issuecomment-566097989",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17732",
    "id": 566097989,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2NjA5Nzk4OQ==",
    "user": {
      "login": "brakmic",
      "id": 56779,
      "node_id": "MDQ6VXNlcjU2Nzc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/56779?u=17d35db6d21a792a73c54469705cff5da63abe5f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brakmic",
      "html_url": "https://github.com/brakmic",
      "followers_url": "https://api.github.com/users/brakmic/followers",
      "following_url": "https://api.github.com/users/brakmic/following{/other_user}",
      "gists_url": "https://api.github.com/users/brakmic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brakmic/subscriptions",
      "organizations_url": "https://api.github.com/users/brakmic/orgs",
      "repos_url": "https://api.github.com/users/brakmic/repos",
      "events_url": "https://api.github.com/users/brakmic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brakmic/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-16T15:01:26Z",
    "updated_at": "2019-12-16T15:25:38Z",
    "author_association": "CONTRIBUTOR",
    "body": "> On macOS I'm seeing the right error when valgrind is missing, but then it goes into an infinite recursion:\r\n>\r\n>   File \"/Users/sjors/dev/bitcoin/test/functional/test_framework/test_node.py\", line 191, in __getattr__\r\n>     if self.use_cli:\r\n> RecursionError: maximum recursion depth exceeded\r\n> 2019-12-16T12:47:33.302000Z TestFramework (INFO): Stopping nodes\r\n> ```\r\n\r\nThe **__ del __** method doesn't have a try-catch block. When I put one it prevents the recursion. Not sure if I should change unrelated code here. Maybe I should wait for input from people who coded it in the first place?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/566097989/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/568196144",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#issuecomment-568196144",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/17732",
    "id": 568196144,
    "node_id": "MDEyOklzc3VlQ29tbWVudDU2ODE5NjE0NA==",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-12-21T17:05:00Z",
    "updated_at": "2019-12-21T17:05:00Z",
    "author_association": "MEMBER",
    "body": "@jnewbery?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/568196144/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357124904",
    "pull_request_review_id": 331203403,
    "id": 357124904,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEyNDkwNA==",
    "diff_hunk": "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 15,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "perhaps construct this string outside of the arg array assignment, or do:\r\n```python3\r\n \"--exit-on-first-error={}\".format(\"yes\" if exit_on_first_error else \"no\"),\r\n```",
    "created_at": "2019-12-12T12:45:28Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357124904",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357124904"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357124904"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357124904/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 109,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357126002",
    "pull_request_review_id": 331204844,
    "id": 357126002,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEyNjAwMg==",
    "diff_hunk": "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 5,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This won't throw an error if `--valgrind` is used on a system without valgrind.",
    "created_at": "2019-12-12T12:48:12Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357126002",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357126002"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357126002"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357126002/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 100,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357126161",
    "pull_request_review_id": 331203403,
    "id": 357126161,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEyNjE2MQ==",
    "diff_hunk": "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",\n                          \"--error-exitcode=1\", \"--quiet\"] + self.args",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 16,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: suggestion for readability, format the args array like in line 90 above:\r\n```diff\r\n-            self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\r\n-                         \"--gen-suppressions=all\",\r\n-                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",\r\n-                         \"--error-exitcode=1\", \"--quiet\"] + self.args\r\n+            self.args = [\r\n+                \"valgrind\",\r\n+                \"--suppressions={}\".format(suppressions_file),\r\n+                \"--gen-suppressions=all\",\r\n+                \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",\r\n+                \"--error-exitcode=1\",\r\n+                \"--quiet\",\r\n+            ] + self.args\r\n```",
    "created_at": "2019-12-12T12:48:35Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357126161",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357126161"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357126161"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357126161/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 110,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357126725",
    "pull_request_review_id": 331204844,
    "id": 357126725,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEyNjcyNQ==",
    "diff_hunk": "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 15,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I haven't tested this, but I expect `--exit-on-first-error=no` to throw an error on versions that don't have this option.",
    "created_at": "2019-12-12T12:49:58Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357126725",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357126725"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357126725"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357126725/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 109,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357127399",
    "pull_request_review_id": 331204844,
    "id": 357127399,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEyNzM5OQ==",
    "diff_hunk": "@@ -140,6 +142,29 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def is_valgrind_present(self):\n+        \"\"\"Check for valgrind presence\"\"\"\n+        try:\n+          version = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\")\n+          if version.find(\"valgrind\", 0, 10) > -1:\n+              return True\n+          else:\n+              return False\n+        except OSError:\n+          return False\n+\n+    def should_exit_valgrind_on_first_error(self):\n+        \"\"\"Determine if valgrind should run with --exit-on-first-error flag (>=3.15 runs with it while older versions don't)\"\"\"",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 35,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I believe this was added in 3.14: https://stackoverflow.com/a/50289059",
    "created_at": "2019-12-12T12:51:22Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357127399",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357127399"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357127399"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357127399/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 157,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357127816",
    "pull_request_review_id": 331203403,
    "id": 357127816,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEyNzgxNg==",
    "diff_hunk": "@@ -140,6 +142,29 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def is_valgrind_present(self):\n+        \"\"\"Check for valgrind presence\"\"\"\n+        try:\n+          version = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\")\n+          if version.find(\"valgrind\", 0, 10) > -1:\n+              return True\n+          else:\n+              return False\n+        except OSError:\n+          return False\n+\n+    def should_exit_valgrind_on_first_error(self):\n+        \"\"\"Determine if valgrind should run with --exit-on-first-error flag (>=3.15 runs with it while older versions don't)\"\"\"\n+        version_regex = re.compile('[.bv]')\n+        version_info = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\").rstrip().split(\"valgrind-\")[1:][0]",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 37,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "suggest wrapping long lines like here and the docstring just above",
    "created_at": "2019-12-12T12:52:19Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357127816",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357127816"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357127816"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357127816/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 159,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357128396",
    "pull_request_review_id": 331203403,
    "id": 357128396,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEyODM5Ng==",
    "diff_hunk": "@@ -140,6 +142,29 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def is_valgrind_present(self):\n+        \"\"\"Check for valgrind presence\"\"\"\n+        try:\n+          version = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\")\n+          if version.find(\"valgrind\", 0, 10) > -1:\n+              return True\n+          else:\n+              return False\n+        except OSError:\n+          return False\n+\n+    def should_exit_valgrind_on_first_error(self):\n+        \"\"\"Determine if valgrind should run with --exit-on-first-error flag (>=3.15 runs with it while older versions don't)\"\"\"\n+        version_regex = re.compile('[.bv]')\n+        version_info = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\").rstrip().split(\"valgrind-\")[1:][0]\n+        version_array = re.split(version_regex, version_info)\n+        major = int(version_array[0])\n+        minor = int(version_array[1])\n+        if major >=3 and minor >=15:",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 41,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "suggest hoisting these two magic values to constants",
    "created_at": "2019-12-12T12:53:37Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357128396",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357128396"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357128396"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357128396/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 163,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357129740",
    "pull_request_review_id": 331209556,
    "id": 357129740,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEyOTc0MA==",
    "diff_hunk": "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 15,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "brakmic",
      "id": 56779,
      "node_id": "MDQ6VXNlcjU2Nzc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/56779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brakmic",
      "html_url": "https://github.com/brakmic",
      "followers_url": "https://api.github.com/users/brakmic/followers",
      "following_url": "https://api.github.com/users/brakmic/following{/other_user}",
      "gists_url": "https://api.github.com/users/brakmic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brakmic/subscriptions",
      "organizations_url": "https://api.github.com/users/brakmic/orgs",
      "repos_url": "https://api.github.com/users/brakmic/repos",
      "events_url": "https://api.github.com/users/brakmic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brakmic/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Many thanks! I am going through the comments and will adapt the code accordingly. ",
    "created_at": "2019-12-12T12:56:57Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357129740",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357129740"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357129740"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357129740/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 109,
    "side": "RIGHT",
    "in_reply_to_id": 357124904
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357129905",
    "pull_request_review_id": 331209809,
    "id": 357129905,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEyOTkwNQ==",
    "diff_hunk": "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",\n                          \"--error-exitcode=1\", \"--quiet\"] + self.args",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 16,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "brakmic",
      "id": 56779,
      "node_id": "MDQ6VXNlcjU2Nzc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/56779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brakmic",
      "html_url": "https://github.com/brakmic",
      "followers_url": "https://api.github.com/users/brakmic/followers",
      "following_url": "https://api.github.com/users/brakmic/following{/other_user}",
      "gists_url": "https://api.github.com/users/brakmic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brakmic/subscriptions",
      "organizations_url": "https://api.github.com/users/brakmic/orgs",
      "repos_url": "https://api.github.com/users/brakmic/repos",
      "events_url": "https://api.github.com/users/brakmic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brakmic/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes! Thanks :)",
    "created_at": "2019-12-12T12:57:24Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357129905",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357129905"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357129905"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357129905/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 110,
    "side": "RIGHT",
    "in_reply_to_id": 357126161
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357130330",
    "pull_request_review_id": 331210391,
    "id": 357130330,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEzMDMzMA==",
    "diff_hunk": "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 15,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "brakmic",
      "id": 56779,
      "node_id": "MDQ6VXNlcjU2Nzc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/56779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brakmic",
      "html_url": "https://github.com/brakmic",
      "followers_url": "https://api.github.com/users/brakmic/followers",
      "following_url": "https://api.github.com/users/brakmic/following{/other_user}",
      "gists_url": "https://api.github.com/users/brakmic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brakmic/subscriptions",
      "organizations_url": "https://api.github.com/users/brakmic/orgs",
      "repos_url": "https://api.github.com/users/brakmic/repos",
      "events_url": "https://api.github.com/users/brakmic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brakmic/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Will test it on my macOS Catalina, because valgrind can't be installed there. :)",
    "created_at": "2019-12-12T12:58:24Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357130330",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357130330"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357130330"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357130330/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 109,
    "side": "RIGHT",
    "in_reply_to_id": 357126725
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357130419",
    "pull_request_review_id": 331210524,
    "id": 357130419,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEzMDQxOQ==",
    "diff_hunk": "@@ -140,6 +142,29 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def is_valgrind_present(self):\n+        \"\"\"Check for valgrind presence\"\"\"\n+        try:\n+          version = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\")\n+          if version.find(\"valgrind\", 0, 10) > -1:\n+              return True\n+          else:\n+              return False\n+        except OSError:\n+          return False\n+\n+    def should_exit_valgrind_on_first_error(self):\n+        \"\"\"Determine if valgrind should run with --exit-on-first-error flag (>=3.15 runs with it while older versions don't)\"\"\"",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 35,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "brakmic",
      "id": 56779,
      "node_id": "MDQ6VXNlcjU2Nzc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/56779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brakmic",
      "html_url": "https://github.com/brakmic",
      "followers_url": "https://api.github.com/users/brakmic/followers",
      "following_url": "https://api.github.com/users/brakmic/following{/other_user}",
      "gists_url": "https://api.github.com/users/brakmic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brakmic/subscriptions",
      "organizations_url": "https://api.github.com/users/brakmic/orgs",
      "repos_url": "https://api.github.com/users/brakmic/repos",
      "events_url": "https://api.github.com/users/brakmic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brakmic/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Will adapt!",
    "created_at": "2019-12-12T12:58:37Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357130419",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357130419"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357130419"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357130419/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 157,
    "side": "RIGHT",
    "in_reply_to_id": 357127399
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357137164",
    "pull_request_review_id": 331219376,
    "id": 357137164,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEzNzE2NA==",
    "diff_hunk": "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 15,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "You mean the previous comment? This one is easiest to test on e.g. a fresh Ubuntu 18.04 machine, which has valgrind 3.13. You can then compile it from source and install 3.15 to see the difference. ",
    "created_at": "2019-12-12T13:14:07Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357137164",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357137164"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357137164"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357137164/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 109,
    "side": "RIGHT",
    "in_reply_to_id": 357126725
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357138153",
    "pull_request_review_id": 331220578,
    "id": 357138153,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzEzODE1Mw==",
    "diff_hunk": "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 15,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "brakmic",
      "id": 56779,
      "node_id": "MDQ6VXNlcjU2Nzc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/56779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brakmic",
      "html_url": "https://github.com/brakmic",
      "followers_url": "https://api.github.com/users/brakmic/followers",
      "following_url": "https://api.github.com/users/brakmic/following{/other_user}",
      "gists_url": "https://api.github.com/users/brakmic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brakmic/subscriptions",
      "organizations_url": "https://api.github.com/users/brakmic/orgs",
      "repos_url": "https://api.github.com/users/brakmic/repos",
      "events_url": "https://api.github.com/users/brakmic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brakmic/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yeah, I have one cheap VPS running, with Ubuntu 18.04. Will follow your recommendation. Thanks!",
    "created_at": "2019-12-12T13:16:05Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357138153",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357138153"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357138153"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357138153/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 109,
    "side": "RIGHT",
    "in_reply_to_id": 357126725
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357159574",
    "pull_request_review_id": 331248517,
    "id": 357159574,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE1OTU3NA==",
    "diff_hunk": "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 15,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`--exit-on-first-error=yes` should always be used if the option `--exit-on-first-error` is supported :)",
    "created_at": "2019-12-12T14:00:57Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357159574",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357159574"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357159574"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357159574/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 109,
    "side": "RIGHT",
    "in_reply_to_id": 357124904
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357160270",
    "pull_request_review_id": 331249480,
    "id": 357160270,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE2MDI3MA==",
    "diff_hunk": "@@ -140,6 +142,29 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def is_valgrind_present(self):\n+        \"\"\"Check for valgrind presence\"\"\"\n+        try:\n+          version = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\")\n+          if version.find(\"valgrind\", 0, 10) > -1:\n+              return True\n+          else:\n+              return False\n+        except OSError:\n+          return False\n+\n+    def should_exit_valgrind_on_first_error(self):\n+        \"\"\"Determine if valgrind should run with --exit-on-first-error flag (>=3.15 runs with it while older versions don't)\"\"\"",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 35,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "brakmic",
      "id": 56779,
      "node_id": "MDQ6VXNlcjU2Nzc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/56779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brakmic",
      "html_url": "https://github.com/brakmic",
      "followers_url": "https://api.github.com/users/brakmic/followers",
      "following_url": "https://api.github.com/users/brakmic/following{/other_user}",
      "gists_url": "https://api.github.com/users/brakmic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brakmic/subscriptions",
      "organizations_url": "https://api.github.com/users/brakmic/orgs",
      "repos_url": "https://api.github.com/users/brakmic/repos",
      "events_url": "https://api.github.com/users/brakmic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brakmic/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Will then simply produce an empty string if the flag should not be active, because it's \"no\" anyway for versions that support it.\r\n\r\nLike: **\"--exit-on-first-error=yes\" if exit_on_first_error else \"\"**",
    "created_at": "2019-12-12T14:02:22Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357160270",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357160270"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357160270"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357160270/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 157,
    "side": "RIGHT",
    "in_reply_to_id": 357127399
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357160662",
    "pull_request_review_id": 331250064,
    "id": 357160662,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE2MDY2Mg==",
    "diff_hunk": "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 5,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This will create an unnecessary `valgrind` execution in the normal case when Valgrind is not used (no `--valgrind`).\r\n\r\nBetter to do it as `if use_valgrind and \u2026` instead :)",
    "created_at": "2019-12-12T14:03:13Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357160662",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357160662"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357160662"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357160662/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 100,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357160744",
    "pull_request_review_id": 331250206,
    "id": 357160744,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE2MDc0NA==",
    "diff_hunk": "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 15,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "brakmic",
      "id": 56779,
      "node_id": "MDQ6VXNlcjU2Nzc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/56779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brakmic",
      "html_url": "https://github.com/brakmic",
      "followers_url": "https://api.github.com/users/brakmic/followers",
      "following_url": "https://api.github.com/users/brakmic/following{/other_user}",
      "gists_url": "https://api.github.com/users/brakmic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brakmic/subscriptions",
      "organizations_url": "https://api.github.com/users/brakmic/orgs",
      "repos_url": "https://api.github.com/users/brakmic/repos",
      "events_url": "https://api.github.com/users/brakmic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brakmic/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "@jonatack \r\nWould prefer your solution, but because not all old versions support this flag I'll have to stick with the other variant. Will basically return an empty string when the flag should not be active, because this is the default for some older versions anyway.",
    "created_at": "2019-12-12T14:03:26Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357160744",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357160744"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357160744"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357160744/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 109,
    "side": "RIGHT",
    "in_reply_to_id": 357124904
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357161041",
    "pull_request_review_id": 331250614,
    "id": 357161041,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE2MTA0MQ==",
    "diff_hunk": "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 5,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "brakmic",
      "id": 56779,
      "node_id": "MDQ6VXNlcjU2Nzc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/56779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brakmic",
      "html_url": "https://github.com/brakmic",
      "followers_url": "https://api.github.com/users/brakmic/followers",
      "following_url": "https://api.github.com/users/brakmic/following{/other_user}",
      "gists_url": "https://api.github.com/users/brakmic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brakmic/subscriptions",
      "organizations_url": "https://api.github.com/users/brakmic/orgs",
      "repos_url": "https://api.github.com/users/brakmic/repos",
      "events_url": "https://api.github.com/users/brakmic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brakmic/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes, indeed. Thanks!",
    "created_at": "2019-12-12T14:04:03Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357161041",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357161041"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357161041"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357161041/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 100,
    "side": "RIGHT",
    "in_reply_to_id": 357160662
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357161586",
    "pull_request_review_id": 331251357,
    "id": 357161586,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE2MTU4Ng==",
    "diff_hunk": "@@ -140,6 +142,29 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def is_valgrind_present(self):\n+        \"\"\"Check for valgrind presence\"\"\"\n+        try:\n+          version = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\")\n+          if version.find(\"valgrind\", 0, 10) > -1:",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 27,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`if version.startswith(\"valgrind-\")` :)",
    "created_at": "2019-12-12T14:05:16Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357161586",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357161586"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357161586"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357161586/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 149,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357162045",
    "pull_request_review_id": 331251884,
    "id": 357162045,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE2MjA0NQ==",
    "diff_hunk": "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 15,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "brakmic",
      "id": 56779,
      "node_id": "MDQ6VXNlcjU2Nzc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/56779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brakmic",
      "html_url": "https://github.com/brakmic",
      "followers_url": "https://api.github.com/users/brakmic/followers",
      "following_url": "https://api.github.com/users/brakmic/following{/other_user}",
      "gists_url": "https://api.github.com/users/brakmic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brakmic/subscriptions",
      "organizations_url": "https://api.github.com/users/brakmic/orgs",
      "repos_url": "https://api.github.com/users/brakmic/repos",
      "events_url": "https://api.github.com/users/brakmic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brakmic/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> `--exit-on-first-error=yes` should always be used if the option `--exit-on-first-error` is supported :)\r\n\r\nBut the original discussion was about disabling it for v3.15. Or am I missing something?",
    "created_at": "2019-12-12T14:06:04Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357162045",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357162045"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357162045"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357162045/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 109,
    "side": "RIGHT",
    "in_reply_to_id": 357124904
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357162358",
    "pull_request_review_id": 331252300,
    "id": 357162358,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE2MjM1OA==",
    "diff_hunk": "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 15,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I'd rename `exit_on_first_error` to `supports_exit_on_first_error` for clarity.",
    "created_at": "2019-12-12T14:06:43Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357162358",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357162358"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357162358"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357162358/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 109,
    "side": "RIGHT",
    "in_reply_to_id": 357124904
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357162705",
    "pull_request_review_id": 331252802,
    "id": 357162705,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE2MjcwNQ==",
    "diff_hunk": "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 15,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "brakmic",
      "id": 56779,
      "node_id": "MDQ6VXNlcjU2Nzc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/56779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brakmic",
      "html_url": "https://github.com/brakmic",
      "followers_url": "https://api.github.com/users/brakmic/followers",
      "following_url": "https://api.github.com/users/brakmic/following{/other_user}",
      "gists_url": "https://api.github.com/users/brakmic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brakmic/subscriptions",
      "organizations_url": "https://api.github.com/users/brakmic/orgs",
      "repos_url": "https://api.github.com/users/brakmic/repos",
      "events_url": "https://api.github.com/users/brakmic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brakmic/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done!",
    "created_at": "2019-12-12T14:07:27Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357162705",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357162705"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357162705"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357162705/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 109,
    "side": "RIGHT",
    "in_reply_to_id": 357124904
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357164663",
    "pull_request_review_id": 331255444,
    "id": 357164663,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE2NDY2Mw==",
    "diff_hunk": "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 15,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "brakmic",
      "id": 56779,
      "node_id": "MDQ6VXNlcjU2Nzc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/56779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brakmic",
      "html_url": "https://github.com/brakmic",
      "followers_url": "https://api.github.com/users/brakmic/followers",
      "following_url": "https://api.github.com/users/brakmic/following{/other_user}",
      "gists_url": "https://api.github.com/users/brakmic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brakmic/subscriptions",
      "organizations_url": "https://api.github.com/users/brakmic/orgs",
      "repos_url": "https://api.github.com/users/brakmic/repos",
      "events_url": "https://api.github.com/users/brakmic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brakmic/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> I'd rename `exit_on_first_error` to `supports_exit_on_first_error` for clarity.\r\n\r\nThen I will also put the expected version (major, minor) to 3.14, ok?\r\nIf I understand @practicalswift correctly, every version that supports this flag should also have it activated by default.",
    "created_at": "2019-12-12T14:11:07Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357164663",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357164663"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357164663"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357164663/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 109,
    "side": "RIGHT",
    "in_reply_to_id": 357124904
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357167630",
    "pull_request_review_id": 331251357,
    "id": 357167630,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE2NzYzMA==",
    "diff_hunk": "@@ -140,6 +142,29 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def is_valgrind_present(self):\n+        \"\"\"Check for valgrind presence\"\"\"\n+        try:\n+          version = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\")\n+          if version.find(\"valgrind\", 0, 10) > -1:\n+              return True\n+          else:\n+              return False\n+        except OSError:\n+          return False\n+\n+    def should_exit_valgrind_on_first_error(self):\n+        \"\"\"Determine if valgrind should run with --exit-on-first-error flag (>=3.15 runs with it while older versions don't)\"\"\"\n+        version_regex = re.compile('[.bv]')\n+        version_info = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\").rstrip().split(\"valgrind-\")[1:][0]",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 37,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think this can be simplified. Only one execution of `valgrind --version` should be needed to a.) check if Valgrind is present and b.) to parse what version it is, so try to merge the logic of `is_valgrind_present` and `should_exit_valgrind_on_first_error`.\r\n\r\nI suggest `get_valgrind_version` which could return the tuple `(valgrind_major, valgrind_minor)` if `valgrind` is installed or `None` otherwise.\r\n\r\nSomething like this:\r\n\r\n```\r\nvalgrind_version = get_valgrind_version()\r\nif valgrind_version and valgrind_version >= (3, 14):\r\n    # add --exit-on-first-error=true\r\n```\r\n\r\n:)",
    "created_at": "2019-12-12T14:16:39Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357167630",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357167630"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357167630"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357167630/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 1,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 159,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357169751",
    "pull_request_review_id": 331262277,
    "id": 357169751,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE2OTc1MQ==",
    "diff_hunk": "@@ -140,6 +142,29 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def is_valgrind_present(self):\n+        \"\"\"Check for valgrind presence\"\"\"\n+        try:\n+          version = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\")\n+          if version.find(\"valgrind\", 0, 10) > -1:",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 27,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "brakmic",
      "id": 56779,
      "node_id": "MDQ6VXNlcjU2Nzc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/56779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brakmic",
      "html_url": "https://github.com/brakmic",
      "followers_url": "https://api.github.com/users/brakmic/followers",
      "following_url": "https://api.github.com/users/brakmic/following{/other_user}",
      "gists_url": "https://api.github.com/users/brakmic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brakmic/subscriptions",
      "organizations_url": "https://api.github.com/users/brakmic/orgs",
      "repos_url": "https://api.github.com/users/brakmic/repos",
      "events_url": "https://api.github.com/users/brakmic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brakmic/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Believe it or not, I was just typing the same changes. Thanks!",
    "created_at": "2019-12-12T14:20:24Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357169751",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357169751"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357169751"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357169751/reactions",
      "total_count": 2,
      "+1": 1,
      "-1": 0,
      "laugh": 1,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 149,
    "side": "RIGHT",
    "in_reply_to_id": 357161586
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357170012",
    "pull_request_review_id": 331262602,
    "id": 357170012,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE3MDAxMg==",
    "diff_hunk": "@@ -97,14 +97,16 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n-        if use_valgrind:\n+        if self.is_valgrind_present() and use_valgrind:\n+            exit_on_first_error = self.should_exit_valgrind_on_first_error()\n             default_suppressions_file = os.path.join(\n                 os.path.dirname(os.path.realpath(__file__)),\n                 \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n                                           default_suppressions_file)\n             self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n+                         \"--gen-suppressions=all\",\n+                         \"--exit-on-first-error=yes\" if exit_on_first_error else \"--exit-on-first-error=no\",",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 15,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "> If I understand @practicalswift correctly, every version that supports this flag should also have it activated by default.\r\n\r\nCorrect! :)\r\n\r\nIt is supported by Valgrind 3.14 and above.\r\n\r\n(Unfortunately I said the wrong version number in the linked issue. I've now corrected that. Sorry for the confusion :))",
    "created_at": "2019-12-12T14:20:52Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357170012",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357170012"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357170012"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357170012/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 109,
    "side": "RIGHT",
    "in_reply_to_id": 357124904
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357192327",
    "pull_request_review_id": 331292017,
    "id": 357192327,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE5MjMyNw==",
    "diff_hunk": "@@ -140,6 +142,29 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def is_valgrind_present(self):\n+        \"\"\"Check for valgrind presence\"\"\"\n+        try:\n+          version = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\")\n+          if version.find(\"valgrind\", 0, 10) > -1:\n+              return True\n+          else:\n+              return False\n+        except OSError:\n+          return False\n+\n+    def should_exit_valgrind_on_first_error(self):\n+        \"\"\"Determine if valgrind should run with --exit-on-first-error flag (>=3.15 runs with it while older versions don't)\"\"\"",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 35,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes, I have valgrind-3.14.0 installed on debian, and valgrind --help does have the option for `--exit-on-first-error=no|yes`. Will test the updated version of this PR!",
    "created_at": "2019-12-12T15:00:30Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357192327",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357192327"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357192327"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357192327/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 157,
    "side": "RIGHT",
    "in_reply_to_id": 357127399
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357194203",
    "pull_request_review_id": 331294462,
    "id": 357194203,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE5NDIwMw==",
    "diff_hunk": "@@ -140,6 +142,29 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def is_valgrind_present(self):\n+        \"\"\"Check for valgrind presence\"\"\"\n+        try:\n+          version = subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE).stdout.decode(\"utf-8\")\n+          if version.find(\"valgrind\", 0, 10) > -1:\n+              return True\n+          else:\n+              return False\n+        except OSError:\n+          return False\n+\n+    def should_exit_valgrind_on_first_error(self):\n+        \"\"\"Determine if valgrind should run with --exit-on-first-error flag (>=3.15 runs with it while older versions don't)\"\"\"",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 35,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "d9b5bd7372e873baa158a065147f4ddfe59eb5fd",
    "user": {
      "login": "brakmic",
      "id": 56779,
      "node_id": "MDQ6VXNlcjU2Nzc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/56779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brakmic",
      "html_url": "https://github.com/brakmic",
      "followers_url": "https://api.github.com/users/brakmic/followers",
      "following_url": "https://api.github.com/users/brakmic/following{/other_user}",
      "gists_url": "https://api.github.com/users/brakmic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brakmic/subscriptions",
      "organizations_url": "https://api.github.com/users/brakmic/orgs",
      "repos_url": "https://api.github.com/users/brakmic/repos",
      "events_url": "https://api.github.com/users/brakmic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brakmic/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Just force pushed changes. :)",
    "created_at": "2019-12-12T15:03:53Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357194203",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357194203"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357194203"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357194203/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 157,
    "side": "RIGHT",
    "in_reply_to_id": 357127399
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357194353",
    "pull_request_review_id": 331294647,
    "id": 357194353,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE5NDM1Mw==",
    "diff_hunk": "@@ -34,7 +34,8 @@\n )\n \n BITCOIND_PROC_WAIT_TIMEOUT = 60\n-\n+VALGRIND_VERSION_MAJOR = 3",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 5,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "f59541707e47918526daa3c5b714f1f79ac1438f",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: `VALGRIND_MINIMUM_VERSION_MAJOR`",
    "created_at": "2019-12-12T15:04:08Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357194353",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357194353"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357194353"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357194353/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 37,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357195971",
    "pull_request_review_id": 331294647,
    "id": 357195971,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE5NTk3MQ==",
    "diff_hunk": "@@ -140,6 +149,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def get_valgrind_version(self):\n+        \"\"\"Returns valgrind version (major, minor) in a tuple\"\"\"",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 42,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "28eabc865301a1a6f2fae21f3385e9e7a99ef021",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: \"or None if not found\"",
    "created_at": "2019-12-12T15:06:55Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357195971",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357195971"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357195971"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357195971/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 153,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357197095",
    "pull_request_review_id": 331294647,
    "id": 357197095,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE5NzA5NQ==",
    "diff_hunk": "@@ -97,15 +98,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n+        valgrind_version = self.get_valgrind_version()",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 14,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "28eabc865301a1a6f2fae21f3385e9e7a99ef021",
    "user": {
      "login": "Sjors",
      "id": 10217,
      "node_id": "MDQ6VXNlcjEwMjE3",
      "avatar_url": "https://avatars.githubusercontent.com/u/10217?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Sjors",
      "html_url": "https://github.com/Sjors",
      "followers_url": "https://api.github.com/users/Sjors/followers",
      "following_url": "https://api.github.com/users/Sjors/following{/other_user}",
      "gists_url": "https://api.github.com/users/Sjors/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Sjors/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Sjors/subscriptions",
      "organizations_url": "https://api.github.com/users/Sjors/orgs",
      "repos_url": "https://api.github.com/users/Sjors/repos",
      "events_url": "https://api.github.com/users/Sjors/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Sjors/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I'd move all this below `if use_valgrind`. Don't forget to throw if `valgrind_version == None`",
    "created_at": "2019-12-12T15:08:54Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357197095",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357197095"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357197095"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357197095/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 101,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357198887",
    "pull_request_review_id": 331300555,
    "id": 357198887,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE5ODg4Nw==",
    "diff_hunk": "@@ -34,7 +34,8 @@\n )\n \n BITCOIND_PROC_WAIT_TIMEOUT = 60\n-\n+VALGRIND_VERSION_MAJOR = 3\n+VALGRIND_VERSION_MINOR = 14",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 6,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "28eabc865301a1a6f2fae21f3385e9e7a99ef021",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The scope can be narrowed for these and the meaning could be clarified by doing it like this on L103 instead :)\r\n\r\n```\r\nMIN_VALGRIND_VERSION_EARLY_EXIT = (3, 14)\r\nif valgrind_version and valgrind_version >= MIN_VALGRIND_VERSION_EARLY_EXIT:\r\n```",
    "created_at": "2019-12-12T15:11:58Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357198887",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357198887"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357198887"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357198887/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 38,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357199855",
    "pull_request_review_id": 331301862,
    "id": 357199855,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzE5OTg1NQ==",
    "diff_hunk": "@@ -97,15 +98,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-debugexclude=leveldb\",\n             \"-uacomment=testnode%d\" % i,\n         ]\n+        valgrind_version = self.get_valgrind_version()",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 14,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "28eabc865301a1a6f2fae21f3385e9e7a99ef021",
    "user": {
      "login": "brakmic",
      "id": 56779,
      "node_id": "MDQ6VXNlcjU2Nzc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/56779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brakmic",
      "html_url": "https://github.com/brakmic",
      "followers_url": "https://api.github.com/users/brakmic/followers",
      "following_url": "https://api.github.com/users/brakmic/following{/other_user}",
      "gists_url": "https://api.github.com/users/brakmic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brakmic/subscriptions",
      "organizations_url": "https://api.github.com/users/brakmic/orgs",
      "repos_url": "https://api.github.com/users/brakmic/repos",
      "events_url": "https://api.github.com/users/brakmic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brakmic/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Ok, will do it. Many thanks!",
    "created_at": "2019-12-12T15:13:44Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357199855",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357199855"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357199855"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357199855/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 101,
    "side": "RIGHT",
    "in_reply_to_id": 357197095
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357200114",
    "pull_request_review_id": 331300555,
    "id": 357200114,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzIwMDExNA==",
    "diff_hunk": "@@ -140,6 +149,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def get_valgrind_version(self):\n+        \"\"\"Returns valgrind version (major, minor) in a tuple\"\"\"\n+        try:\n+          rc = subprocess.call(['which', 'valgrind'],",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 44,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "28eabc865301a1a6f2fae21f3385e9e7a99ef021",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Use `shutil.which(\"valgrind\")` to avoid shelling out unnecessarily :)",
    "created_at": "2019-12-12T15:14:11Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357200114",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357200114"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357200114"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357200114/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 157,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357204519",
    "pull_request_review_id": 331300555,
    "id": 357204519,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzIwNDUxOQ==",
    "diff_hunk": "@@ -140,6 +151,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def get_valgrind_version(self):\n+        \"\"\"Returns valgrind version (major, minor) in a tuple or None if not found\"\"\"\n+        try:\n+          rc = subprocess.call(['which', 'valgrind'],\n+                                     stdout=subprocess.PIPE,\n+                                     stderr=subprocess.PIPE)\n+          if rc == 0:\n+            version_regex = re.compile('[.bv]')",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 54,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "1c2f07c8137aabad98d2f41746d9a904439406ab",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "1. Have you seen instances where the Valgrind version identifier contains `b` or `v`? :) If not, perhaps the simpler `version_info.split(\".\")` could do?\r\n\r\n2. Check the indentation here so that it matches the four spaces used in the rest of this file :)  Applies throughout this PR.",
    "created_at": "2019-12-12T15:21:53Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357204519",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357204519"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357204519"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357204519/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 157,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357205478",
    "pull_request_review_id": 331309254,
    "id": 357205478,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzIwNTQ3OA==",
    "diff_hunk": "@@ -140,6 +149,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def get_valgrind_version(self):\n+        \"\"\"Returns valgrind version (major, minor) in a tuple\"\"\"\n+        try:\n+          rc = subprocess.call(['which', 'valgrind'],",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 44,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "28eabc865301a1a6f2fae21f3385e9e7a99ef021",
    "user": {
      "login": "brakmic",
      "id": 56779,
      "node_id": "MDQ6VXNlcjU2Nzc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/56779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brakmic",
      "html_url": "https://github.com/brakmic",
      "followers_url": "https://api.github.com/users/brakmic/followers",
      "following_url": "https://api.github.com/users/brakmic/following{/other_user}",
      "gists_url": "https://api.github.com/users/brakmic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brakmic/subscriptions",
      "organizations_url": "https://api.github.com/users/brakmic/orgs",
      "repos_url": "https://api.github.com/users/brakmic/repos",
      "events_url": "https://api.github.com/users/brakmic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brakmic/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yup, much better!",
    "created_at": "2019-12-12T15:23:37Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357205478",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357205478"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357205478"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357205478/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 157,
    "side": "RIGHT",
    "in_reply_to_id": 357200114
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357207838",
    "pull_request_review_id": 331312415,
    "id": 357207838,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzIwNzgzOA==",
    "diff_hunk": "@@ -140,6 +151,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def get_valgrind_version(self):\n+        \"\"\"Returns valgrind version (major, minor) in a tuple or None if not found\"\"\"\n+        try:\n+          rc = subprocess.call(['which', 'valgrind'],\n+                                     stdout=subprocess.PIPE,\n+                                     stderr=subprocess.PIPE)\n+          if rc == 0:\n+            version_regex = re.compile('[.bv]')",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 54,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "1c2f07c8137aabad98d2f41746d9a904439406ab",
    "user": {
      "login": "brakmic",
      "id": 56779,
      "node_id": "MDQ6VXNlcjU2Nzc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/56779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brakmic",
      "html_url": "https://github.com/brakmic",
      "followers_url": "https://api.github.com/users/brakmic/followers",
      "following_url": "https://api.github.com/users/brakmic/following{/other_user}",
      "gists_url": "https://api.github.com/users/brakmic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brakmic/subscriptions",
      "organizations_url": "https://api.github.com/users/brakmic/orgs",
      "repos_url": "https://api.github.com/users/brakmic/repos",
      "events_url": "https://api.github.com/users/brakmic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brakmic/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I must admit that I wasn't sure abut valgrind's versioning. But I will adapt the code of course.\r\nWill also update the indentations.",
    "created_at": "2019-12-12T15:27:46Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357207838",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357207838"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357207838"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357207838/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 157,
    "side": "RIGHT",
    "in_reply_to_id": 357204519
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357216948",
    "pull_request_review_id": 331321558,
    "id": 357216948,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzIxNjk0OA==",
    "diff_hunk": "@@ -98,14 +98,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-uacomment=testnode%d\" % i,\n         ]\n         if use_valgrind:\n-            default_suppressions_file = os.path.join(\n-                os.path.dirname(os.path.realpath(__file__)),\n-                \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n-            suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n-                                          default_suppressions_file)\n-            self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n-                         \"--error-exitcode=1\", \"--quiet\"] + self.args\n+            valgrind_version = self.get_valgrind_version()\n+            exit_on_first_error_flag = \"\"\n+            if valgrind_version and valgrind_version >= MIN_VALGRIND_VERSION_EARLY_EXIT:",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 23,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "130435997931f7086229f057df968f41d845efd5",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think the logic is wrong here. This will only run `valgrind` if `valgrind_version >= MIN_VALGRIND_VERSION_EARLY_EXIT` :)\r\n\r\nThe only impact `valgrind_version >= MIN_VALGRIND_VERSION_EARLY_EXIT` should have is to enable `--exit-on-first-error=yes`. `self.args` should be set both for old and new versions of Valgrind :)",
    "created_at": "2019-12-12T15:43:24Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357216948",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357216948"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357216948"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357216948/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 106,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357218254",
    "pull_request_review_id": 331321558,
    "id": 357218254,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzIxODI1NA==",
    "diff_hunk": "@@ -98,14 +98,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-uacomment=testnode%d\" % i,\n         ]\n         if use_valgrind:\n-            default_suppressions_file = os.path.join(\n-                os.path.dirname(os.path.realpath(__file__)),\n-                \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n-            suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n-                                          default_suppressions_file)\n-            self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n-                         \"--error-exitcode=1\", \"--quiet\"] + self.args\n+            valgrind_version = self.get_valgrind_version()\n+            exit_on_first_error_flag = \"\"\n+            if valgrind_version and valgrind_version >= MIN_VALGRIND_VERSION_EARLY_EXIT:\n+                exit_on_first_error_flag = \"--exit-on-first-error=yes\"\n+                default_suppressions_file = os.path.join(\n+                    os.path.dirname(os.path.realpath(__file__)),\n+                    \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n+                suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n+                    default_suppressions_file)\n+                self.args = [\"valgrind\",\n+                             \"--suppressions={}\".format(suppressions_file),\n+                             \"--gen-suppressions=all\",\n+                             exit_on_first_error_flag,\n+                             \"--error-exitcode=1\",\n+                             \"--quiet\"] + self.args\n+            elif valgrind_version == None:",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 36,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "130435997931f7086229f057df968f41d845efd5",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think you want to do this check right after `valgrind_version = self.get_valgrind_version()`. With the current logic the exception will be thrown also in the case where `valgrind` is present (but with an older version).\r\n\r\nI suggest testing the PR with the following alternatives to make sure all code paths are working as expected:\r\n\r\n1.) Without `valgrind` in `PATH`\r\n2.) With new `valgrind` version (>= 3.14) in `PATH`\r\n3.) With old `valgrind` version (< 3.14) in `PATH`\r\n\r\n:)",
    "created_at": "2019-12-12T15:45:16Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357218254",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357218254"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357218254"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357218254/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 116,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357224013",
    "pull_request_review_id": 331321558,
    "id": 357224013,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzIyNDAxMw==",
    "diff_hunk": "@@ -140,6 +149,20 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def get_valgrind_version(self):",
    "path": "test/functional/test_framework/test_node.py",
    "position": 50,
    "original_position": 45,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "130435997931f7086229f057df968f41d845efd5",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Suggested alternative:\r\n\r\n```\r\ndef get_valgrind_version(self):\r\n    \"\"\"Returns valgrind version tuple (major, minor), or None if valgrind is not found\"\"\"\r\n    if not shutil.which(\"valgrind\"):\r\n        return None\r\n    version = (\r\n        subprocess.run([\"valgrind\", \"--version\"], stdout=subprocess.PIPE)\r\n        .stdout.decode(\"utf-8\")\r\n        .rstrip()\r\n        .split(\"valgrind-\")[1:][0]\r\n    )\r\n    return tuple(int(i) for i in version.split(\".\")[:2])\r\n```",
    "created_at": "2019-12-12T15:54:43Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357224013",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357224013"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357224013"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357224013/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 159,
    "original_line": 159,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357229136",
    "pull_request_review_id": 331339896,
    "id": 357229136,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzIyOTEzNg==",
    "diff_hunk": "@@ -98,14 +98,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-uacomment=testnode%d\" % i,\n         ]\n         if use_valgrind:\n-            default_suppressions_file = os.path.join(\n-                os.path.dirname(os.path.realpath(__file__)),\n-                \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n-            suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n-                                          default_suppressions_file)\n-            self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n-                         \"--error-exitcode=1\", \"--quiet\"] + self.args\n+            valgrind_version = self.get_valgrind_version()\n+            exit_on_first_error_flag = \"\"\n+            if valgrind_version and valgrind_version >= MIN_VALGRIND_VERSION_EARLY_EXIT:",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 23,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "130435997931f7086229f057df968f41d845efd5",
    "user": {
      "login": "brakmic",
      "id": 56779,
      "node_id": "MDQ6VXNlcjU2Nzc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/56779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brakmic",
      "html_url": "https://github.com/brakmic",
      "followers_url": "https://api.github.com/users/brakmic/followers",
      "following_url": "https://api.github.com/users/brakmic/following{/other_user}",
      "gists_url": "https://api.github.com/users/brakmic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brakmic/subscriptions",
      "organizations_url": "https://api.github.com/users/brakmic/orgs",
      "repos_url": "https://api.github.com/users/brakmic/repos",
      "events_url": "https://api.github.com/users/brakmic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brakmic/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yeah, just saw it. Will reorganize the code.",
    "created_at": "2019-12-12T16:02:52Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357229136",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357229136"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357229136"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357229136/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 106,
    "side": "RIGHT",
    "in_reply_to_id": 357216948
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357229756",
    "pull_request_review_id": 331340742,
    "id": 357229756,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzIyOTc1Ng==",
    "diff_hunk": "@@ -140,6 +149,20 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def get_valgrind_version(self):",
    "path": "test/functional/test_framework/test_node.py",
    "position": 50,
    "original_position": 45,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "130435997931f7086229f057df968f41d845efd5",
    "user": {
      "login": "brakmic",
      "id": 56779,
      "node_id": "MDQ6VXNlcjU2Nzc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/56779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brakmic",
      "html_url": "https://github.com/brakmic",
      "followers_url": "https://api.github.com/users/brakmic/followers",
      "following_url": "https://api.github.com/users/brakmic/following{/other_user}",
      "gists_url": "https://api.github.com/users/brakmic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brakmic/subscriptions",
      "organizations_url": "https://api.github.com/users/brakmic/orgs",
      "repos_url": "https://api.github.com/users/brakmic/repos",
      "events_url": "https://api.github.com/users/brakmic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brakmic/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Much better.",
    "created_at": "2019-12-12T16:04:00Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357229756",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357229756"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357229756"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357229756/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 159,
    "original_line": 159,
    "side": "RIGHT",
    "in_reply_to_id": 357224013
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357240183",
    "pull_request_review_id": 331354844,
    "id": 357240183,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzI0MDE4Mw==",
    "diff_hunk": "@@ -98,14 +99,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-uacomment=testnode%d\" % i,\n         ]\n         if use_valgrind:\n+            valgrind_version = self.get_valgrind_version()\n+            if not valgrind_version:\n+                raise Exception('Valgrind not present')\n+            exit_on_first_error_flag = \"\"\n+            if valgrind_version and valgrind_version >= MIN_VALGRIND_VERSION_EARLY_EXIT:",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 25,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "3ed9706357126ac7d65c7e0f023b497c1749b2fa",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This can be reduced to `if valgrind_version >= MIN_VALGRIND_VERSION_EARLY_EXIT:` since the `not valgrind_version` case is handled on L103.\r\n",
    "created_at": "2019-12-12T16:23:06Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357240183",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357240183"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357240183"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357240183/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 106,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357299481",
    "pull_request_review_id": 331432026,
    "id": 357299481,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzI5OTQ4MQ==",
    "diff_hunk": "@@ -20,6 +20,7 @@\n import collections\n import shlex\n import sys\n+import shutil",
    "path": "test/functional/test_framework/test_node.py",
    "position": 4,
    "original_position": 4,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "f10ca181b6958d6a78eb6eab1d884536ff36c601",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: alphabetical order",
    "created_at": "2019-12-12T18:24:07Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357299481",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357299481"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357299481"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357299481/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 22,
    "original_line": 22,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357316477",
    "pull_request_review_id": 331432026,
    "id": 357316477,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzMxNjQ3Nw==",
    "diff_hunk": "@@ -98,14 +99,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-uacomment=testnode%d\" % i,\n         ]\n         if use_valgrind:\n+            valgrind_version = self.get_valgrind_version()\n+            if not valgrind_version:\n+                raise Exception('Valgrind not present')\n+            exit_on_first_error_flag = \"\"\n+            if valgrind_version >= MIN_VALGRIND_VERSION_EARLY_EXIT:\n+                exit_on_first_error_flag = \"--exit-on-first-error=yes\"",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 26,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "f10ca181b6958d6a78eb6eab1d884536ff36c601",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "consider extracting this to a function like below, or just put  `\"--exit-on-first-error=yes\" if version >= MIN_VALGRIND_VERSION_EARLY_EXIT else \"\"` in the array after all :)\r\n```diff\r\n-            exit_on_first_error_flag = \"\"\r\n-            if valgrind_version >= MIN_VALGRIND_VERSION_EARLY_EXIT:\r\n-                exit_on_first_error_flag = \"--exit-on-first-error=yes\"\r\n\r\n             self.args = [\"valgrind\",\r\n                             \"--suppressions={}\".format(suppressions_file),\r\n                             \"--gen-suppressions=all\",\r\n-                            exit_on_first_error_flag,\r\n+                            self.valgrind_early_exit(valgrind_version),\r\n \r\n+    def valgrind_early_exit(self, version):\r\n+        return \"--exit-on-first-error=yes\" if version >= MIN_VALGRIND_VERSION_EARLY_EXIT else \"\"\r\n```",
    "created_at": "2019-12-12T19:01:22Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357316477",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357316477"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357316477"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357316477/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 107,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357343980",
    "pull_request_review_id": 331432026,
    "id": 357343980,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzM0Mzk4MA==",
    "diff_hunk": "@@ -98,14 +99,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-uacomment=testnode%d\" % i,\n         ]\n         if use_valgrind:\n+            valgrind_version = self.get_valgrind_version()\n+            if not valgrind_version:\n+                raise Exception('Valgrind not present')\n+            exit_on_first_error_flag = \"\"\n+            if valgrind_version >= MIN_VALGRIND_VERSION_EARLY_EXIT:\n+                exit_on_first_error_flag = \"--exit-on-first-error=yes\"\n             default_suppressions_file = os.path.join(\n-                os.path.dirname(os.path.realpath(__file__)),\n-                \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n+                    os.path.dirname(os.path.realpath(__file__)),\n+                    \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n-                                          default_suppressions_file)\n-            self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n-                         \"--error-exitcode=1\", \"--quiet\"] + self.args\n+                default_suppressions_file)\n+            self.args = [\"valgrind\",\n+                            \"--suppressions={}\".format(suppressions_file),\n+                            \"--gen-suppressions=all\",\n+                            exit_on_first_error_flag,\n+                            \"--error-exitcode=1\",\n+                            \"--quiet\"] + self.args",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 43,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "f10ca181b6958d6a78eb6eab1d884536ff36c601",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Suggest:\r\n```diff\r\n-            self.args = [\"valgrind\",\r\n-                            \"--suppressions={}\".format(suppressions_file),\r\n-                            \"--gen-suppressions=all\",\r\n-                            exit_on_first_error_flag,\r\n-                            \"--error-exitcode=1\",\r\n-                            \"--quiet\"] + self.args\r\n+            self.args = [\r\n+                \"valgrind\",\r\n+                \"--suppressions={}\".format(suppressions_file),\r\n+                \"--gen-suppressions=all\",\r\n+                self.valgrind_early_exit(valgrind_version),\r\n+                \"--error-exitcode=1\",\r\n+                \"--quiet\",\r\n+            ] + self.args\r\n```",
    "created_at": "2019-12-12T20:01:09Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357343980",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357343980"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357343980"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357343980/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 115,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357349478",
    "pull_request_review_id": 331432026,
    "id": 357349478,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzM0OTQ3OA==",
    "diff_hunk": "@@ -140,6 +150,17 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def get_valgrind_version(self):\n+        \"\"\"Returns valgrind version (major, minor) in a tuple or None if not found\"\"\"",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 52,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "f10ca181b6958d6a78eb6eab1d884536ff36c601",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: s/Returns/Return/ like the other docstrings",
    "created_at": "2019-12-12T20:14:21Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357349478",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357349478"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357349478"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357349478/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 153,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357356648",
    "pull_request_review_id": 331506084,
    "id": 357356648,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzM1NjY0OA==",
    "diff_hunk": "@@ -98,14 +99,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-uacomment=testnode%d\" % i,\n         ]\n         if use_valgrind:\n+            valgrind_version = self.get_valgrind_version()\n+            if not valgrind_version:\n+                raise Exception('Valgrind not present')\n+            exit_on_first_error_flag = \"\"\n+            if valgrind_version >= MIN_VALGRIND_VERSION_EARLY_EXIT:\n+                exit_on_first_error_flag = \"--exit-on-first-error=yes\"",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 26,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "f10ca181b6958d6a78eb6eab1d884536ff36c601",
    "user": {
      "login": "brakmic",
      "id": 56779,
      "node_id": "MDQ6VXNlcjU2Nzc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/56779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brakmic",
      "html_url": "https://github.com/brakmic",
      "followers_url": "https://api.github.com/users/brakmic/followers",
      "following_url": "https://api.github.com/users/brakmic/following{/other_user}",
      "gists_url": "https://api.github.com/users/brakmic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brakmic/subscriptions",
      "organizations_url": "https://api.github.com/users/brakmic/orgs",
      "repos_url": "https://api.github.com/users/brakmic/repos",
      "events_url": "https://api.github.com/users/brakmic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brakmic/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Ok, let's change it! :)",
    "created_at": "2019-12-12T20:31:37Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357356648",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357356648"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357356648"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357356648/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 107,
    "side": "RIGHT",
    "in_reply_to_id": 357316477
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357357665",
    "pull_request_review_id": 331507475,
    "id": 357357665,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzM1NzY2NQ==",
    "diff_hunk": "@@ -98,14 +99,23 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             \"-uacomment=testnode%d\" % i,\n         ]\n         if use_valgrind:\n+            valgrind_version = self.get_valgrind_version()\n+            if not valgrind_version:\n+                raise Exception('Valgrind not present')\n+            exit_on_first_error_flag = \"\"\n+            if valgrind_version >= MIN_VALGRIND_VERSION_EARLY_EXIT:\n+                exit_on_first_error_flag = \"--exit-on-first-error=yes\"\n             default_suppressions_file = os.path.join(\n-                os.path.dirname(os.path.realpath(__file__)),\n-                \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n+                    os.path.dirname(os.path.realpath(__file__)),\n+                    \"..\", \"..\", \"..\", \"contrib\", \"valgrind.supp\")\n             suppressions_file = os.getenv(\"VALGRIND_SUPPRESSIONS_FILE\",\n-                                          default_suppressions_file)\n-            self.args = [\"valgrind\", \"--suppressions={}\".format(suppressions_file),\n-                         \"--gen-suppressions=all\", \"--exit-on-first-error=yes\",\n-                         \"--error-exitcode=1\", \"--quiet\"] + self.args\n+                default_suppressions_file)\n+            self.args = [\"valgrind\",\n+                            \"--suppressions={}\".format(suppressions_file),\n+                            \"--gen-suppressions=all\",\n+                            exit_on_first_error_flag,\n+                            \"--error-exitcode=1\",\n+                            \"--quiet\"] + self.args",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 43,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "f10ca181b6958d6a78eb6eab1d884536ff36c601",
    "user": {
      "login": "brakmic",
      "id": 56779,
      "node_id": "MDQ6VXNlcjU2Nzc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/56779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brakmic",
      "html_url": "https://github.com/brakmic",
      "followers_url": "https://api.github.com/users/brakmic/followers",
      "following_url": "https://api.github.com/users/brakmic/following{/other_user}",
      "gists_url": "https://api.github.com/users/brakmic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brakmic/subscriptions",
      "organizations_url": "https://api.github.com/users/brakmic/orgs",
      "repos_url": "https://api.github.com/users/brakmic/repos",
      "events_url": "https://api.github.com/users/brakmic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brakmic/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Also done. Will do another force push. :)",
    "created_at": "2019-12-12T20:34:08Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357357665",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357357665"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357357665"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357357665/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 115,
    "side": "RIGHT",
    "in_reply_to_id": 357343980
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357358681",
    "pull_request_review_id": 331508760,
    "id": 357358681,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDM1NzM1ODY4MQ==",
    "diff_hunk": "@@ -140,6 +150,17 @@ def __init__(self, i, datadir, *, chain, rpchost, timewait, bitcoind, bitcoin_cl\n             AddressKeyPair('mzRe8QZMfGi58KyWCse2exxEFry2sfF2Y7', 'cPiRWE8KMjTRxH1MWkPerhfoHFn5iHPWVK5aPqjW8NxmdwenFinJ'),\n     ]\n \n+    def get_valgrind_version(self):\n+        \"\"\"Returns valgrind version (major, minor) in a tuple or None if not found\"\"\"",
    "path": "test/functional/test_framework/test_node.py",
    "position": null,
    "original_position": 52,
    "commit_id": "98d03f0346ec8856987dda37ab3d99a9f886f409",
    "original_commit_id": "f10ca181b6958d6a78eb6eab1d884536ff36c601",
    "user": {
      "login": "brakmic",
      "id": 56779,
      "node_id": "MDQ6VXNlcjU2Nzc5",
      "avatar_url": "https://avatars.githubusercontent.com/u/56779?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/brakmic",
      "html_url": "https://github.com/brakmic",
      "followers_url": "https://api.github.com/users/brakmic/followers",
      "following_url": "https://api.github.com/users/brakmic/following{/other_user}",
      "gists_url": "https://api.github.com/users/brakmic/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/brakmic/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/brakmic/subscriptions",
      "organizations_url": "https://api.github.com/users/brakmic/orgs",
      "repos_url": "https://api.github.com/users/brakmic/repos",
      "events_url": "https://api.github.com/users/brakmic/events{/privacy}",
      "received_events_url": "https://api.github.com/users/brakmic/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Ok :)",
    "created_at": "2019-12-12T20:36:40Z",
    "updated_at": "2020-05-10T07:40:27Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357358681",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357358681"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/17732#discussion_r357358681"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/17732"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/357358681/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 153,
    "side": "RIGHT",
    "in_reply_to_id": 357349478
  }
]