gavinandresen,2013-03-13T15:36:01Z,"Rebased, and added -rpcthreads to --help output.\n\nBut the SIGTERM handler is not working properly, which is why the pull tester is upset...\n",https://github.com/bitcoin/bitcoin/pull/2357#issuecomment-14848430,14848430,
Diapolo,2013-03-19T22:40:18Z,"I really like the reduced complexity of the code, I didn't test it out yet though.\n",https://github.com/bitcoin/bitcoin/pull/2357#issuecomment-15148140,15148140,
gavinandresen,2013-03-20T20:10:05Z,"I can't reproduce the pull-tester issue in an Ubuntu VM, but I did fix a compiler warning.\n",https://github.com/bitcoin/bitcoin/pull/2357#issuecomment-15200339,15200339,
Diapolo,2013-03-20T21:16:37Z,"Let's see what pull-tester is doing now, seems the old entries are gone and I wanted to also take a look :).\n",https://github.com/bitcoin/bitcoin/pull/2357#issuecomment-15204077,15204077,
jgarzik,2013-03-22T17:58:07Z,ACK (with some inline minor nits mentioned)\n,https://github.com/bitcoin/bitcoin/pull/2357#issuecomment-15311905,15311905,
sipa,2013-03-23T00:35:46Z,"I really like this change (except the polling to check whether someone interrupted... i wonder if one can call a condition variable's notify in a signal handler...). I haven't gone through the code in detail, but I see nothing terrible.\n\nI've tested both bitcoind and bitcoin-qt under valgrind, with several ways of causing exit. All seems good.\n",https://github.com/bitcoin/bitcoin/pull/2357#issuecomment-15328020,15328020,
denis2342,2013-03-23T03:14:48Z,"I tested it under OSX 10.8.3 with a command line build of bitcoind and it does not stop when I send the ""stop"" rpc command.\n",https://github.com/bitcoin/bitcoin/pull/2357#issuecomment-15330882,15330882,
gavinandresen,2013-03-23T17:55:40Z,"There is definitely a bug with the signal handler / RPC stop on OSX at least, if I try to stop shortly after startup the ""stop"" get swallowed and further stops have no effect.\n",https://github.com/bitcoin/bitcoin/pull/2357#issuecomment-15341449,15341449,
gavinandresen,2013-03-24T00:22:00Z,"Fixed two issues, and made one improvement:\n1. Running -daemon, the shutdown detection thread was being started before the fork(). Oops. I moved the -daemon code to run earlier, in AppInit() (which has the added benefit of simplifying the code a bit).\n2. A request to shutdown during AppInit2() startup could get lost. I fixed that by making the detect shutdown thread run and repeatedly interrupt ",https://github.com/bitcoin/bitcoin/pull/2357#issuecomment-15348823,15348823,
denis2342,2013-03-29T10:39:23Z,on freebsd I needed to the add boost_timer lib to the linker\n,https://github.com/bitcoin/bitcoin/pull/2357#issuecomment-15635977,15635977,
denis2342,2013-03-29T16:19:57Z,"right now I got this while closing with ""stop"":\n\nAssertion failed: (!pthread_mutex_lock(&m)), function lock, file /usr/local/include/boost/thread/pthread/recursive_mutex.hpp\n",https://github.com/bitcoin/bitcoin/pull/2357#issuecomment-15648266,15648266,
gavinandresen,2013-03-29T17:28:54Z,"@denis2342 : when you say ""right now"", do you mean with this patch or without it?\n",https://github.com/bitcoin/bitcoin/pull/2357#issuecomment-15651219,15651219,
denis2342,2013-03-30T10:21:41Z,"yes, with the patch.\n\nsorry for the delay, I am on the road.\n\ndenis\n\nSent from my iPhone\n\nOn 29.03.2013, at 18:29, Gavin Andresen notifications@github.com wrote:\n\n> @denis2342 : when you say ""right now"", do you mean with this patch or without it?\n> \n> â€”\n> Reply to this email directly or view it on GitHub.\n",https://github.com/bitcoin/bitcoin/pull/2357#issuecomment-15672363,15672363,
sipa,2013-03-31T11:11:20Z,"@laanwj No, Sleep() (as opposed to sleep()) was an own function in util.cpp that takes milliseconds as argument. I'm in favor of renaming it to MilliSleep() to reduce confusion.\n",https://github.com/bitcoin/bitcoin/pull/2357#issuecomment-15689983,15689983,
laanwj,2013-03-31T11:36:40Z,"Yes, agreed. This is certainly an improvement in naming, then.\n",https://github.com/bitcoin/bitcoin/pull/2357#issuecomment-15690227,15690227,
gavinandresen,2013-04-01T21:52:15Z,"Squashed a few commits, rebased, and changed unsigned constants from 'u' to 'U'.\n\nI'm still puzzled as to why shutdown isn't happening immediately on the pull-tester machine, I can't reproduce that problem on either my Mac or a debian VM.  I'll debug directly on the pull-tester machine next.\n",https://github.com/bitcoin/bitcoin/pull/2357#issuecomment-15739635,15739635,
denis2342,2013-04-02T14:39:53Z,"got it again with the latest changes while using ""stop"":\n\n> ./bitcoind stop\n> Bitcoin server stopping\n> Assertion failed: (!pthread_mutex_lock(&m)), function lock, file /usr/local/include/boost/thread/pthread/recursive_mutex.hpp, line 105.\n",https://github.com/bitcoin/bitcoin/pull/2357#issuecomment-15778996,15778996,
gavinandresen,2013-04-02T16:02:14Z,"@denis2342 can you run under a debugger and get a call stack for that assertion? I'm guessing something is being called after main() exits, but I'm just guessing...\n",https://github.com/bitcoin/bitcoin/pull/2357#issuecomment-15784574,15784574,
gavinandresen,2013-04-03T17:30:03Z,Sigh. That took way too long to figure out.\n\nBoost 1.40 (running on pull-tester) versus 1.53 (running on my machine) difference; boost 1.40's thread_group cannot interrupt_all() if another thread is waiting on join_all().\n\nI'll rework the code to be boost 1.40-compatible.\n,https://github.com/bitcoin/bitcoin/pull/2357#issuecomment-15851107,15851107,
Diapolo,2013-04-03T20:41:27Z,@gavinandresen Why are we supporting such an ancient Boost version anyway? I don't get that :).\n,https://github.com/bitcoin/bitcoin/pull/2357#issuecomment-15863195,15863195,
BitcoinPullTester,2013-04-04T00:37:08Z,"Automatic sanity-testing: PASSED, see http://jenkins.bluematt.me/pull-tester/723035bb6839c5d65bfee96d501a8c54814778e3 for binaries and test log.\nThis test script verifies pulls every time they are updated. It, however, dies sometimes and fails to test properly.  If you are waiting on a test, please check timestamps to verify that the test.log is moving at http://jenkins.bluematt.me/pull-tester/cu",https://github.com/bitcoin/bitcoin/pull/2357#issuecomment-15874183,15874183,
gavinandresen,2013-04-04T01:24:54Z,"I'm going to pull this, I suspect @denis2342 is seeing the same intermittent crash-at-shutdown problems that we saw before on OSX (or are you seeing them on freebsd?)\n",https://github.com/bitcoin/bitcoin/pull/2357#issuecomment-15875391,15875391,
sipa,2013-03-21T13:59:30Z,mean?\n,https://github.com/bitcoin/bitcoin/pull/2357#discussion_r3470652,3470652,src/init.cpp
Diapolo,2013-03-21T14:08:55Z,"^^ I vote for `Set the number of threads to service RPC calls (1-16, 0=auto, default: 0)` and we should perhaps consider the same routine as you added for the -par switch then.\n\n<pre>\n// -rpcthreads=0 means autodetect, but nRPCThreads==0 means no concurrency\n    nRPCThreads = GetArg(""-rpcthreads"", 0);\n    if (nRPCThreads == 0)\n        nRPCThreads = boost::thread::hardware_concurrency();\n   ",https://github.com/bitcoin/bitcoin/pull/2357#discussion_r3470822,3470822,src/init.cpp
gavinandresen,2013-03-21T14:11:20Z,"No.\n\nMore RPC threads is not better, because RPC calls are normally single-threaded anyway due to lock contention.\n",https://github.com/bitcoin/bitcoin/pull/2357#discussion_r3470873,3470873,src/init.cpp
Diapolo,2013-03-21T14:13:41Z,"Okay, didn't know that, but the message should be in a similar format and some checks for min / max would be also nice IMHO.\n",https://github.com/bitcoin/bitcoin/pull/2357#discussion_r3470918,3470918,src/init.cpp
laanwj,2013-03-31T11:05:51Z,"It looks like the Sleep calls were directly replaced by MilliSleep calls. Sleep, however, takes seconds. Was it intended to multiply with a factor 1000 too?\n",https://github.com/bitcoin/bitcoin/pull/2357#discussion_r3596442,3596442,src/walletdb.cpp
rebroad,2013-04-01T01:25:41Z,"""Use this mean threads"" doesn't appear to me to be English.\n",https://github.com/bitcoin/bitcoin/pull/2357#discussion_r3597671,3597671,src/init.cpp
