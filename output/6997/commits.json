[
  {
    "sha": "227861eda63937ca4b760d36d7fb25d2539259ba",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyMjc4NjFlZGE2MzkzN2NhNGI3NjBkMzZkN2ZiMjVkMjUzOTI1OWJh",
    "commit": {
      "author": {
        "name": "Sturle Sunde",
        "email": "sturle@bitmynt.no",
        "date": "2015-11-12T11:14:19Z"
      },
      "committer": {
        "name": "Sturle Sunde",
        "email": "sturle@bitmynt.no",
        "date": "2015-11-12T11:14:19Z"
      },
      "message": "Don't use hard-coded AllowFree, as this is usually far too low.  Try to\nfind a better estimate within the next few confirmation targets, or just\nfail back to add a fee if unsuccessful.",
      "tree": {
        "sha": "150fc4936a72cee725183a07ff99badcfd0e4eb2",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/150fc4936a72cee725183a07ff99badcfd0e4eb2"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/227861eda63937ca4b760d36d7fb25d2539259ba",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/227861eda63937ca4b760d36d7fb25d2539259ba",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/227861eda63937ca4b760d36d7fb25d2539259ba",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/227861eda63937ca4b760d36d7fb25d2539259ba/comments",
    "author": {
      "login": "sturles",
      "id": 15728135,
      "node_id": "MDQ6VXNlcjE1NzI4MTM1",
      "avatar_url": "https://avatars.githubusercontent.com/u/15728135?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sturles",
      "html_url": "https://github.com/sturles",
      "followers_url": "https://api.github.com/users/sturles/followers",
      "following_url": "https://api.github.com/users/sturles/following{/other_user}",
      "gists_url": "https://api.github.com/users/sturles/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sturles/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sturles/subscriptions",
      "organizations_url": "https://api.github.com/users/sturles/orgs",
      "repos_url": "https://api.github.com/users/sturles/repos",
      "events_url": "https://api.github.com/users/sturles/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sturles/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "sturles",
      "id": 15728135,
      "node_id": "MDQ6VXNlcjE1NzI4MTM1",
      "avatar_url": "https://avatars.githubusercontent.com/u/15728135?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/sturles",
      "html_url": "https://github.com/sturles",
      "followers_url": "https://api.github.com/users/sturles/followers",
      "following_url": "https://api.github.com/users/sturles/following{/other_user}",
      "gists_url": "https://api.github.com/users/sturles/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/sturles/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/sturles/subscriptions",
      "organizations_url": "https://api.github.com/users/sturles/orgs",
      "repos_url": "https://api.github.com/users/sturles/repos",
      "events_url": "https://api.github.com/users/sturles/events{/privacy}",
      "received_events_url": "https://api.github.com/users/sturles/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "5fcc14ee0562faff2ace17082f664e60c375b334",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/5fcc14ee0562faff2ace17082f664e60c375b334",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/5fcc14ee0562faff2ace17082f664e60c375b334"
      }
    ],
    "stats": {
      "total": 8,
      "additions": 5,
      "deletions": 3
    },
    "files": [
      {
        "sha": "4cf7b9713fdbc751715d7f552b198d691262e0bb",
        "filename": "src/wallet/wallet.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 3,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/227861eda63937ca4b760d36d7fb25d2539259ba/src/wallet/wallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/227861eda63937ca4b760d36d7fb25d2539259ba/src/wallet/wallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet/wallet.cpp?ref=227861eda63937ca4b760d36d7fb25d2539259ba",
        "patch": "@@ -2034,9 +2034,11 @@ bool CWallet::CreateTransaction(const vector<CRecipient>& vecSend, CWalletTx& wt\n                 {\n                     // Not enough fee: enough priority?\n                     double dPriorityNeeded = mempool.estimatePriority(nTxConfirmTarget);\n-                    // Not enough mempool history to estimate: use hard-coded AllowFree.\n-                    if (dPriorityNeeded <= 0 && AllowFree(dPriority))\n-                        break;\n+                    // Not enough mempool history to estimate: use first available estimate (within limits).\n+\t\t    unsigned int i = 0;\n+                    while (i++ < 5  && dPriorityNeeded <= 0) {\n+\t\t\tdPriorityNeeded = mempool.estimatePriority(nTxConfirmTarget + i);\n+\t\t    }\n \n                     // Small enough, and priority high enough, to send for free\n                     if (dPriorityNeeded > 0 && dPriority >= dPriorityNeeded)"
      }
    ]
  }
]