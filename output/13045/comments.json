[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/383292218",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#issuecomment-383292218",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13045",
    "id": 383292218,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MzI5MjIxOA==",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-21T12:43:07Z",
    "updated_at": "2018-04-21T12:43:07Z",
    "author_association": "MEMBER",
    "body": "@practicalswift fixed",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/383292218/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/383335960",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#issuecomment-383335960",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13045",
    "id": 383335960,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MzMzNTk2MA==",
    "user": {
      "login": "rebroad",
      "id": 1530283,
      "node_id": "MDQ6VXNlcjE1MzAyODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1530283?u=6a4a31aaddbc438e053c52d084a698a5f622f1ea&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rebroad",
      "html_url": "https://github.com/rebroad",
      "followers_url": "https://api.github.com/users/rebroad/followers",
      "following_url": "https://api.github.com/users/rebroad/following{/other_user}",
      "gists_url": "https://api.github.com/users/rebroad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rebroad/subscriptions",
      "organizations_url": "https://api.github.com/users/rebroad/orgs",
      "repos_url": "https://api.github.com/users/rebroad/repos",
      "events_url": "https://api.github.com/users/rebroad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rebroad/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-21T22:16:34Z",
    "updated_at": "2018-04-21T22:16:34Z",
    "author_association": "CONTRIBUTOR",
    "body": "why not simply request the compact block rather than a full block?",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/383335960/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/383338354",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#issuecomment-383338354",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13045",
    "id": 383338354,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MzMzODM1NA==",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-21T22:55:49Z",
    "updated_at": "2018-04-21T22:55:49Z",
    "author_association": "CONTRIBUTOR",
    "body": "Should mark the block as in flight if it wasn't already and we requested it. Probably should be checking if it's in flight from the same peer too (which would be required if you mark it, and should probably have been done either way).\n\n@promag because the mempool reconstruction will be useless so it'll be worse than a normal request.\n\nOn April 21, 2018 10:16:43 PM UTC, Rebroad <notifications@github.com> wrote:\n>why not simply request the compact block rather than a full block?\n>\n>-- \n>You are receiving this because you are subscribed to this thread.\n>Reply to this email directly or view it on GitHub:\n>https://github.com/bitcoin/bitcoin/pull/13045#issuecomment-383335960\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/383338354/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/383588477",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#issuecomment-383588477",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13045",
    "id": 383588477,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4MzU4ODQ3Nw==",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-23T14:09:12Z",
    "updated_at": "2018-04-23T14:09:12Z",
    "author_association": "MEMBER",
    "body": "@TheBlueMatt Added the filter-by-sender and marking block as in flight.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/383588477/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/384315155",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#issuecomment-384315155",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13045",
    "id": 384315155,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NDMxNTE1NQ==",
    "user": {
      "login": "rebroad",
      "id": 1530283,
      "node_id": "MDQ6VXNlcjE1MzAyODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1530283?u=6a4a31aaddbc438e053c52d084a698a5f622f1ea&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rebroad",
      "html_url": "https://github.com/rebroad",
      "followers_url": "https://api.github.com/users/rebroad/followers",
      "following_url": "https://api.github.com/users/rebroad/following{/other_user}",
      "gists_url": "https://api.github.com/users/rebroad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rebroad/subscriptions",
      "organizations_url": "https://api.github.com/users/rebroad/orgs",
      "repos_url": "https://api.github.com/users/rebroad/repos",
      "events_url": "https://api.github.com/users/rebroad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rebroad/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-25T14:50:16Z",
    "updated_at": "2018-04-25T14:50:16Z",
    "author_association": "CONTRIBUTOR",
    "body": "would it be worth keeping the txs that went into the latest block to hand\nfor this situation so that compact blocks can be used? what if the previous\ncompact block received had only one transaction in it, whereas this\ncompeting block has many transactions? by requesting a full block we would\nbe favouring the empty block when it would be better for the network to\nfavour the full block. therefore I'd still argue it's better to request a\ncompact block so to not give empty blocks an unfair advantage.\n\nOn Sat, 21 Apr 2018, 23:56 Matt Corallo, <notifications@github.com> wrote:\n\n> because the mempool reconstruction will be useless so it'll be worse than\n> a normal request.\n>\n",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/384315155/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/384316891",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#issuecomment-384316891",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13045",
    "id": 384316891,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NDMxNjg5MQ==",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-25T14:54:48Z",
    "updated_at": "2018-04-25T14:54:48Z",
    "author_association": "MEMBER",
    "body": "@rebroad I think this goes a bit off-topic to incentives. As-is it would likely take a lot of work to support it, and I'd have no idea how to do it safely.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/384316891/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/385393537",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#issuecomment-385393537",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13045",
    "id": 385393537,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM4NTM5MzUzNw==",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-04-30T13:10:43Z",
    "updated_at": "2018-04-30T13:10:43Z",
    "author_association": "MEMBER",
    "body": "Comments addressed",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/385393537/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/390691911",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#issuecomment-390691911",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13045",
    "id": 390691911,
    "node_id": "MDEyOklzc3VlQ29tbWVudDM5MDY5MTkxMQ==",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2018-05-21T15:37:32Z",
    "updated_at": "2018-05-21T15:37:32Z",
    "author_association": "MEMBER",
    "body": "@Empact comments addressed",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/390691911/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/473383985",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#issuecomment-473383985",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13045",
    "id": 473383985,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ3MzM4Mzk4NQ==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-03-15T17:52:36Z",
    "updated_at": "2019-05-03T23:48:15Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* [#15948](https://drahtbot.github.io/bitcoin_core_issue_redirect/r/15948.html) (refactor: rename chainActive by jamesob)\n\nIf you consider this pull request important, please also help to review the conflicting pull requests. Ideally, start with the one that should be merged first.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/473383985/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/487407232",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#issuecomment-487407232",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13045",
    "id": 487407232,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ4NzQwNzIzMg==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-04-28T19:11:58Z",
    "updated_at": "2019-04-28T19:11:58Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--5d09a71f8925f3f132321140b44b946d-->The last travis run for this pull request was 279 days ago and is thus outdated. To trigger a fresh travis build, this pull request should be closed and re-opened.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/487407232/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/490145178",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#issuecomment-490145178",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13045",
    "id": 490145178,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5MDE0NTE3OA==",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-07T16:08:07Z",
    "updated_at": "2019-05-07T16:08:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--cf906140f33d8803c4a75a2196329ecb-->Needs rebase",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/490145178/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/490146753",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#issuecomment-490146753",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/13045",
    "id": 490146753,
    "node_id": "MDEyOklzc3VlQ29tbWVudDQ5MDE0Njc1Mw==",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2019-05-07T16:12:12Z",
    "updated_at": "2019-05-07T16:12:12Z",
    "author_association": "MEMBER",
    "body": "I don't think anyone remaining who would review cares about this, closing.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/490146753/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183207203",
    "pull_request_review_id": 114169961,
    "id": 183207203,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4MzIwNzIwMw==",
    "diff_hunk": "@@ -2406,10 +2406,11 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n         if (pindex->nStatus & BLOCK_HAVE_DATA) // Nothing to do here\n             return true;\n \n-        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know something better\n+        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know same or better better",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "8d3fe87523ffc86f164ae94da10a84ce0ca06412",
    "original_commit_id": "64025e11d565f16debc928247ee0f5b2f68eae7e",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Nit: \"better better\" should be something else? :-)",
    "created_at": "2018-04-21T11:03:13Z",
    "updated_at": "2018-05-22T15:15:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r183207203",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183207203"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r183207203"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183207203/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2409,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183544144",
    "pull_request_review_id": 114563577,
    "id": 183544144,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4MzU0NDE0NA==",
    "diff_hunk": "@@ -2406,11 +2406,15 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n         if (pindex->nStatus & BLOCK_HAVE_DATA) // Nothing to do here\n             return true;\n \n-        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know something better\n+        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know same or better\n                 pindex->nTx != 0) { // We had this block at some point, but pruned it\n-            if (fAlreadyInFlight) {\n-                // We requested this block for some reason, but our mempool will probably be useless\n+            if ((fAlreadyInFlight && blockInFlightIt->second.first == pfrom->GetId())",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 9,
    "commit_id": "8d3fe87523ffc86f164ae94da10a84ce0ca06412",
    "original_commit_id": "a61ea427d59432c9d2e163fa4ccda026fb85a57d",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: how about unpacking `blockInFlightIt->second.first` to a local like `inFlightNodeId` or the like? It's used one other place in the file and is relatively inscrutable.",
    "created_at": "2018-04-23T21:31:15Z",
    "updated_at": "2018-05-22T15:15:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r183544144",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183544144"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r183544144"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183544144/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2411,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183732526",
    "pull_request_review_id": 114785420,
    "id": 183732526,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4MzczMjUyNg==",
    "diff_hunk": "@@ -2406,11 +2406,15 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n         if (pindex->nStatus & BLOCK_HAVE_DATA) // Nothing to do here\n             return true;\n \n-        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know something better\n+        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know same or better\n                 pindex->nTx != 0) { // We had this block at some point, but pruned it\n-            if (fAlreadyInFlight) {\n-                // We requested this block for some reason, but our mempool will probably be useless\n+            if ((fAlreadyInFlight && blockInFlightIt->second.first == pfrom->GetId())",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 9,
    "commit_id": "8d3fe87523ffc86f164ae94da10a84ce0ca06412",
    "original_commit_id": "a61ea427d59432c9d2e163fa4ccda026fb85a57d",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I cached the \"from same peer\" logic instead since it's used twice.",
    "created_at": "2018-04-24T13:38:31Z",
    "updated_at": "2018-05-22T15:15:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r183732526",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183732526"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r183732526"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/183732526/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2411,
    "side": "RIGHT",
    "in_reply_to_id": 183544144
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184387279",
    "pull_request_review_id": 115572444,
    "id": 184387279,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDM4NzI3OQ==",
    "diff_hunk": "@@ -2402,15 +2402,20 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n \n         std::map<uint256, std::pair<NodeId, std::list<QueuedBlock>::iterator> >::iterator blockInFlightIt = mapBlocksInFlight.find(pindex->GetBlockHash());\n         bool fAlreadyInFlight = blockInFlightIt != mapBlocksInFlight.end();\n+        bool in_flight_from_same_peer = fAlreadyInFlight ? blockInFlightIt->second.first == pfrom->GetId() : false;\n \n         if (pindex->nStatus & BLOCK_HAVE_DATA) // Nothing to do here\n             return true;\n \n-        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know something better\n+        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know same or better\n                 pindex->nTx != 0) { // We had this block at some point, but pruned it\n-            if (fAlreadyInFlight) {\n-                // We requested this block for some reason, but our mempool will probably be useless\n+            if ((fAlreadyInFlight && in_flight_from_same_peer)\n+                    || pindex->nChainWork == chainActive.Tip()->nChainWork) {",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 15,
    "commit_id": "8d3fe87523ffc86f164ae94da10a84ce0ca06412",
    "original_commit_id": "b45a45672c29616782db6231f0e7d727c026fd35",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I think this will actually request the full block that *is* the known chaintip. Probably need to check it isn't in chainActive first. It already is being checked that it connects, so this is all that is likely needed.",
    "created_at": "2018-04-26T13:25:20Z",
    "updated_at": "2018-05-22T15:15:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r184387279",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184387279"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r184387279"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184387279/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2413,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184396953",
    "pull_request_review_id": 115584204,
    "id": 184396953,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDM5Njk1Mw==",
    "diff_hunk": "@@ -2402,15 +2402,20 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n \n         std::map<uint256, std::pair<NodeId, std::list<QueuedBlock>::iterator> >::iterator blockInFlightIt = mapBlocksInFlight.find(pindex->GetBlockHash());\n         bool fAlreadyInFlight = blockInFlightIt != mapBlocksInFlight.end();\n+        bool in_flight_from_same_peer = fAlreadyInFlight ? blockInFlightIt->second.first == pfrom->GetId() : false;\n \n         if (pindex->nStatus & BLOCK_HAVE_DATA) // Nothing to do here\n             return true;\n \n-        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know something better\n+        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know same or better\n                 pindex->nTx != 0) { // We had this block at some point, but pruned it\n-            if (fAlreadyInFlight) {\n-                // We requested this block for some reason, but our mempool will probably be useless\n+            if ((fAlreadyInFlight && in_flight_from_same_peer)\n+                    || pindex->nChainWork == chainActive.Tip()->nChainWork) {",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 15,
    "commit_id": "8d3fe87523ffc86f164ae94da10a84ce0ca06412",
    "original_commit_id": "b45a45672c29616782db6231f0e7d727c026fd35",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "oh, maybe not. two lines or so above we have this check:\r\n```\r\nif (pindex->nStatus & BLOCK_HAVE_DATA) // Nothing to do here\r\n            return true;\r\n```",
    "created_at": "2018-04-26T13:52:37Z",
    "updated_at": "2018-05-22T15:15:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r184396953",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184396953"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r184396953"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184396953/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2413,
    "side": "RIGHT",
    "in_reply_to_id": 184387279
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184836150",
    "pull_request_review_id": 116117497,
    "id": 184836150,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDgzNjE1MA==",
    "diff_hunk": "@@ -2402,15 +2402,20 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n \n         std::map<uint256, std::pair<NodeId, std::list<QueuedBlock>::iterator> >::iterator blockInFlightIt = mapBlocksInFlight.find(pindex->GetBlockHash());\n         bool fAlreadyInFlight = blockInFlightIt != mapBlocksInFlight.end();\n+        bool in_flight_from_same_peer = fAlreadyInFlight ? blockInFlightIt->second.first == pfrom->GetId() : false;\n \n         if (pindex->nStatus & BLOCK_HAVE_DATA) // Nothing to do here\n             return true;\n \n-        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know something better\n+        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know same or better\n                 pindex->nTx != 0) { // We had this block at some point, but pruned it\n-            if (fAlreadyInFlight) {\n-                // We requested this block for some reason, but our mempool will probably be useless\n+            if ((fAlreadyInFlight && in_flight_from_same_peer)\n+                    || pindex->nChainWork == chainActive.Tip()->nChainWork) {",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 15,
    "commit_id": "8d3fe87523ffc86f164ae94da10a84ce0ca06412",
    "original_commit_id": "b45a45672c29616782db6231f0e7d727c026fd35",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I dont think we want to request the block if its already in flight from another peer, even if it has equal work with our tip.",
    "created_at": "2018-04-28T02:06:50Z",
    "updated_at": "2018-05-22T15:15:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r184836150",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184836150"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r184836150"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184836150/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2413,
    "side": "RIGHT",
    "in_reply_to_id": 184387279
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184836307",
    "pull_request_review_id": 116117497,
    "id": 184836307,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDgzNjMwNw==",
    "diff_hunk": "@@ -2402,15 +2402,20 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n \n         std::map<uint256, std::pair<NodeId, std::list<QueuedBlock>::iterator> >::iterator blockInFlightIt = mapBlocksInFlight.find(pindex->GetBlockHash());\n         bool fAlreadyInFlight = blockInFlightIt != mapBlocksInFlight.end();\n+        bool in_flight_from_same_peer = fAlreadyInFlight ? blockInFlightIt->second.first == pfrom->GetId() : false;\n \n         if (pindex->nStatus & BLOCK_HAVE_DATA) // Nothing to do here\n             return true;\n \n-        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know something better\n+        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know same or better\n                 pindex->nTx != 0) { // We had this block at some point, but pruned it\n-            if (fAlreadyInFlight) {\n-                // We requested this block for some reason, but our mempool will probably be useless\n+            if ((fAlreadyInFlight && in_flight_from_same_peer)\n+                    || pindex->nChainWork == chainActive.Tip()->nChainWork) {\n+                // We requested this block for some reason from the same peer\n+                // or just want same height block, but our mempool will probably be useless\n                 // so we just grab the block via normal getdata\n+                std::list<QueuedBlock>::iterator* queuedBlockIt = nullptr;",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 19,
    "commit_id": "8d3fe87523ffc86f164ae94da10a84ce0ca06412",
    "original_commit_id": "b45a45672c29616782db6231f0e7d727c026fd35",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This appears to be unused. That said, I think we should consider handling if peer accidentally sends us the block twice, thus queuedBlockIt->partialBlock is set after we call MarkBlockAsInFlight (probably by just wiping the partialBlock).",
    "created_at": "2018-04-28T02:12:23Z",
    "updated_at": "2018-05-22T15:15:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r184836307",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184836307"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r184836307"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184836307/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2417,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184981709",
    "pull_request_review_id": 116280709,
    "id": 184981709,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4NDk4MTcwOQ==",
    "diff_hunk": "@@ -2402,15 +2402,20 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n \n         std::map<uint256, std::pair<NodeId, std::list<QueuedBlock>::iterator> >::iterator blockInFlightIt = mapBlocksInFlight.find(pindex->GetBlockHash());\n         bool fAlreadyInFlight = blockInFlightIt != mapBlocksInFlight.end();\n+        bool in_flight_from_same_peer = fAlreadyInFlight ? blockInFlightIt->second.first == pfrom->GetId() : false;\n \n         if (pindex->nStatus & BLOCK_HAVE_DATA) // Nothing to do here\n             return true;\n \n-        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know something better\n+        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know same or better\n                 pindex->nTx != 0) { // We had this block at some point, but pruned it\n-            if (fAlreadyInFlight) {\n-                // We requested this block for some reason, but our mempool will probably be useless\n+            if ((fAlreadyInFlight && in_flight_from_same_peer)\n+                    || pindex->nChainWork == chainActive.Tip()->nChainWork) {\n+                // We requested this block for some reason from the same peer\n+                // or just want same height block, but our mempool will probably be useless\n                 // so we just grab the block via normal getdata\n+                std::list<QueuedBlock>::iterator* queuedBlockIt = nullptr;",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 19,
    "commit_id": "8d3fe87523ffc86f164ae94da10a84ce0ca06412",
    "original_commit_id": "b45a45672c29616782db6231f0e7d727c026fd35",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Ok, replicated the logic from a few lines below covering the same case.",
    "created_at": "2018-04-30T13:10:27Z",
    "updated_at": "2018-05-22T15:15:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r184981709",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184981709"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r184981709"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/184981709/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2417,
    "side": "RIGHT",
    "in_reply_to_id": 184836307
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188112641",
    "pull_request_review_id": 120026933,
    "id": 188112641,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4ODExMjY0MQ==",
    "diff_hunk": "@@ -2402,15 +2402,28 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n \n         std::map<uint256, std::pair<NodeId, std::list<QueuedBlock>::iterator> >::iterator blockInFlightIt = mapBlocksInFlight.find(pindex->GetBlockHash());\n         bool fAlreadyInFlight = blockInFlightIt != mapBlocksInFlight.end();\n+        bool in_flight_from_same_peer = fAlreadyInFlight ? blockInFlightIt->second.first == pfrom->GetId() : false;\n \n         if (pindex->nStatus & BLOCK_HAVE_DATA) // Nothing to do here\n             return true;\n \n-        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know something better\n+        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know same or better\n                 pindex->nTx != 0) { // We had this block at some point, but pruned it\n-            if (fAlreadyInFlight) {\n-                // We requested this block for some reason, but our mempool will probably be useless\n+            if ((fAlreadyInFlight && in_flight_from_same_peer)\n+                    || (!fAlreadyInFlight && pindex->nChainWork == chainActive.Tip()->nChainWork)) {\n+                // We requested this block for some reason from the same peer\n+                // or just want same height block, but our mempool will probably be useless\n                 // so we just grab the block via normal getdata\n+                std::list<QueuedBlock>::iterator* queuedBlockIt = nullptr;\n+                if (!MarkBlockAsInFlight(pfrom->GetId(), pindex->GetBlockHash(), pindex, &queuedBlockIt)) {\n+                    if (!(*queuedBlockIt)->partialBlock) {\n+                        (*queuedBlockIt)->partialBlock.reset(new PartiallyDownloadedBlock(&mempool));",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 22,
    "commit_id": "8d3fe87523ffc86f164ae94da10a84ce0ca06412",
    "original_commit_id": "b4a3207f3f4f0a7dc098b209a6301aaeb14e3bab",
    "user": {
      "login": "TheBlueMatt",
      "id": 649246,
      "node_id": "MDQ6VXNlcjY0OTI0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/649246?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/TheBlueMatt",
      "html_url": "https://github.com/TheBlueMatt",
      "followers_url": "https://api.github.com/users/TheBlueMatt/followers",
      "following_url": "https://api.github.com/users/TheBlueMatt/following{/other_user}",
      "gists_url": "https://api.github.com/users/TheBlueMatt/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/TheBlueMatt/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/TheBlueMatt/subscriptions",
      "organizations_url": "https://api.github.com/users/TheBlueMatt/orgs",
      "repos_url": "https://api.github.com/users/TheBlueMatt/repos",
      "events_url": "https://api.github.com/users/TheBlueMatt/events{/privacy}",
      "received_events_url": "https://api.github.com/users/TheBlueMatt/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "You want to reset to nullptr here, as we're about to fetch via non-compact-blocks.",
    "created_at": "2018-05-14T22:04:00Z",
    "updated_at": "2018-05-22T15:15:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r188112641",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188112641"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r188112641"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188112641/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 1,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2420,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188479264",
    "pull_request_review_id": 120465670,
    "id": 188479264,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4ODQ3OTI2NA==",
    "diff_hunk": "@@ -2402,15 +2402,28 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n \n         std::map<uint256, std::pair<NodeId, std::list<QueuedBlock>::iterator> >::iterator blockInFlightIt = mapBlocksInFlight.find(pindex->GetBlockHash());\n         bool fAlreadyInFlight = blockInFlightIt != mapBlocksInFlight.end();\n+        bool in_flight_from_same_peer = fAlreadyInFlight ? blockInFlightIt->second.first == pfrom->GetId() : false;\n \n         if (pindex->nStatus & BLOCK_HAVE_DATA) // Nothing to do here\n             return true;\n \n-        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know something better\n+        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know same or better\n                 pindex->nTx != 0) { // We had this block at some point, but pruned it\n-            if (fAlreadyInFlight) {\n-                // We requested this block for some reason, but our mempool will probably be useless\n+            if ((fAlreadyInFlight && in_flight_from_same_peer)\n+                    || (!fAlreadyInFlight && pindex->nChainWork == chainActive.Tip()->nChainWork)) {\n+                // We requested this block for some reason from the same peer\n+                // or just want same height block, but our mempool will probably be useless\n                 // so we just grab the block via normal getdata\n+                std::list<QueuedBlock>::iterator* queuedBlockIt = nullptr;\n+                if (!MarkBlockAsInFlight(pfrom->GetId(), pindex->GetBlockHash(), pindex, &queuedBlockIt)) {\n+                    if (!(*queuedBlockIt)->partialBlock) {\n+                        (*queuedBlockIt)->partialBlock.reset(new PartiallyDownloadedBlock(&mempool));",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 22,
    "commit_id": "8d3fe87523ffc86f164ae94da10a84ce0ca06412",
    "original_commit_id": "b4a3207f3f4f0a7dc098b209a6301aaeb14e3bab",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "done",
    "created_at": "2018-05-16T01:09:46Z",
    "updated_at": "2018-05-22T15:15:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r188479264",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188479264"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r188479264"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188479264/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2420,
    "side": "RIGHT",
    "in_reply_to_id": 188112641
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188491800",
    "pull_request_review_id": 120479951,
    "id": 188491800,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4ODQ5MTgwMA==",
    "diff_hunk": "@@ -2402,15 +2402,28 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n \n         std::map<uint256, std::pair<NodeId, std::list<QueuedBlock>::iterator> >::iterator blockInFlightIt = mapBlocksInFlight.find(pindex->GetBlockHash());\n         bool fAlreadyInFlight = blockInFlightIt != mapBlocksInFlight.end();\n+        bool in_flight_from_same_peer = fAlreadyInFlight ? blockInFlightIt->second.first == pfrom->GetId() : false;",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 4,
    "commit_id": "8d3fe87523ffc86f164ae94da10a84ce0ca06412",
    "original_commit_id": "8f8eea2e3d0e1adcc54538c4e86b4901fcd262db",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "`&&` over `?` here",
    "created_at": "2018-05-16T03:01:54Z",
    "updated_at": "2018-05-22T15:15:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r188491800",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188491800"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r188491800"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188491800/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2405,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188491936",
    "pull_request_review_id": 120480105,
    "id": 188491936,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4ODQ5MTkzNg==",
    "diff_hunk": "@@ -2402,15 +2402,28 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n \n         std::map<uint256, std::pair<NodeId, std::list<QueuedBlock>::iterator> >::iterator blockInFlightIt = mapBlocksInFlight.find(pindex->GetBlockHash());\n         bool fAlreadyInFlight = blockInFlightIt != mapBlocksInFlight.end();\n+        bool in_flight_from_same_peer = fAlreadyInFlight ? blockInFlightIt->second.first == pfrom->GetId() : false;\n \n         if (pindex->nStatus & BLOCK_HAVE_DATA) // Nothing to do here\n             return true;\n \n-        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know something better\n+        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know same or better\n                 pindex->nTx != 0) { // We had this block at some point, but pruned it\n-            if (fAlreadyInFlight) {\n-                // We requested this block for some reason, but our mempool will probably be useless\n+            if ((fAlreadyInFlight && in_flight_from_same_peer)",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 14,
    "commit_id": "8d3fe87523ffc86f164ae94da10a84ce0ca06412",
    "original_commit_id": "8f8eea2e3d0e1adcc54538c4e86b4901fcd262db",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Redundant `fAlreadyInFlight` check",
    "created_at": "2018-05-16T03:03:09Z",
    "updated_at": "2018-05-22T15:15:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r188491936",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188491936"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r188491936"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188491936/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2412,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188492042",
    "pull_request_review_id": 120480225,
    "id": 188492042,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4ODQ5MjA0Mg==",
    "diff_hunk": "@@ -2402,15 +2402,28 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n \n         std::map<uint256, std::pair<NodeId, std::list<QueuedBlock>::iterator> >::iterator blockInFlightIt = mapBlocksInFlight.find(pindex->GetBlockHash());\n         bool fAlreadyInFlight = blockInFlightIt != mapBlocksInFlight.end();\n+        bool in_flight_from_same_peer = fAlreadyInFlight ? blockInFlightIt->second.first == pfrom->GetId() : false;\n \n         if (pindex->nStatus & BLOCK_HAVE_DATA) // Nothing to do here\n             return true;\n \n-        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know something better\n+        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know same or better\n                 pindex->nTx != 0) { // We had this block at some point, but pruned it\n-            if (fAlreadyInFlight) {\n-                // We requested this block for some reason, but our mempool will probably be useless\n+            if ((fAlreadyInFlight && in_flight_from_same_peer)\n+                    || (!fAlreadyInFlight && pindex->nChainWork == chainActive.Tip()->nChainWork)) {\n+                // We requested this block for some reason from the same peer\n+                // or just want same height block, but our mempool will probably be useless\n                 // so we just grab the block via normal getdata\n+                std::list<QueuedBlock>::iterator* queuedBlockIt = nullptr;",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 19,
    "commit_id": "8d3fe87523ffc86f164ae94da10a84ce0ca06412",
    "original_commit_id": "8f8eea2e3d0e1adcc54538c4e86b4901fcd262db",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: snake_case for new vars",
    "created_at": "2018-05-16T03:04:23Z",
    "updated_at": "2018-05-22T15:15:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r188492042",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188492042"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r188492042"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188492042/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2417,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188492169",
    "pull_request_review_id": 120480373,
    "id": 188492169,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4ODQ5MjE2OQ==",
    "diff_hunk": "@@ -2432,7 +2445,7 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n         // possibilities in compact block processing...\n         if (pindex->nHeight <= chainActive.Height() + 2) {\n             if ((!fAlreadyInFlight && nodestate->nBlocksInFlight < MAX_BLOCKS_IN_TRANSIT_PER_PEER) ||\n-                 (fAlreadyInFlight && blockInFlightIt->second.first == pfrom->GetId())) {\n+                 (fAlreadyInFlight && in_flight_from_same_peer)) {",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 37,
    "commit_id": "8d3fe87523ffc86f164ae94da10a84ce0ca06412",
    "original_commit_id": "8f8eea2e3d0e1adcc54538c4e86b4901fcd262db",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Redundant `fAlreadyInFlight` check",
    "created_at": "2018-05-16T03:05:49Z",
    "updated_at": "2018-05-22T15:15:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r188492169",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188492169"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r188492169"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/188492169/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2448,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/189671678",
    "pull_request_review_id": 121896519,
    "id": 189671678,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4OTY3MTY3OA==",
    "diff_hunk": "@@ -2402,15 +2402,28 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n \n         std::map<uint256, std::pair<NodeId, std::list<QueuedBlock>::iterator> >::iterator blockInFlightIt = mapBlocksInFlight.find(pindex->GetBlockHash());\n         bool fAlreadyInFlight = blockInFlightIt != mapBlocksInFlight.end();\n+        bool in_flight_from_same_peer = fAlreadyInFlight && blockInFlightIt->second.first == pfrom->GetId();\n \n         if (pindex->nStatus & BLOCK_HAVE_DATA) // Nothing to do here\n             return true;\n \n-        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know something better\n+        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know same or better\n                 pindex->nTx != 0) { // We had this block at some point, but pruned it\n-            if (fAlreadyInFlight) {\n-                // We requested this block for some reason, but our mempool will probably be useless\n+            if ((in_flight_from_same_peer)",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 14,
    "commit_id": "8d3fe87523ffc86f164ae94da10a84ce0ca06412",
    "original_commit_id": "9fc77a9d8f001d7c43790109a1c4e95395d269b7",
    "user": {
      "login": "Empact",
      "id": 5470,
      "node_id": "MDQ6VXNlcjU0NzA=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5470?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Empact",
      "html_url": "https://github.com/Empact",
      "followers_url": "https://api.github.com/users/Empact/followers",
      "following_url": "https://api.github.com/users/Empact/following{/other_user}",
      "gists_url": "https://api.github.com/users/Empact/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Empact/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Empact/subscriptions",
      "organizations_url": "https://api.github.com/users/Empact/orgs",
      "repos_url": "https://api.github.com/users/Empact/repos",
      "events_url": "https://api.github.com/users/Empact/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Empact/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: unnecessary parens",
    "created_at": "2018-05-21T18:19:31Z",
    "updated_at": "2018-05-22T15:15:45Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r189671678",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/189671678"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r189671678"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/189671678/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2412,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/189961477",
    "pull_request_review_id": 122242262,
    "id": 189961477,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDE4OTk2MTQ3Nw==",
    "diff_hunk": "@@ -2402,15 +2402,28 @@ bool static ProcessMessage(CNode* pfrom, const std::string& strCommand, CDataStr\n \n         std::map<uint256, std::pair<NodeId, std::list<QueuedBlock>::iterator> >::iterator blockInFlightIt = mapBlocksInFlight.find(pindex->GetBlockHash());\n         bool fAlreadyInFlight = blockInFlightIt != mapBlocksInFlight.end();\n+        bool in_flight_from_same_peer = fAlreadyInFlight && blockInFlightIt->second.first == pfrom->GetId();\n \n         if (pindex->nStatus & BLOCK_HAVE_DATA) // Nothing to do here\n             return true;\n \n-        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know something better\n+        if (pindex->nChainWork <= chainActive.Tip()->nChainWork || // We know same or better\n                 pindex->nTx != 0) { // We had this block at some point, but pruned it\n-            if (fAlreadyInFlight) {\n-                // We requested this block for some reason, but our mempool will probably be useless\n+            if ((in_flight_from_same_peer)",
    "path": "src/net_processing.cpp",
    "position": null,
    "original_position": 14,
    "commit_id": "8d3fe87523ffc86f164ae94da10a84ce0ca06412",
    "original_commit_id": "9fc77a9d8f001d7c43790109a1c4e95395d269b7",
    "user": {
      "login": "instagibbs",
      "id": 5767891,
      "node_id": "MDQ6VXNlcjU3Njc4OTE=",
      "avatar_url": "https://avatars.githubusercontent.com/u/5767891?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/instagibbs",
      "html_url": "https://github.com/instagibbs",
      "followers_url": "https://api.github.com/users/instagibbs/followers",
      "following_url": "https://api.github.com/users/instagibbs/following{/other_user}",
      "gists_url": "https://api.github.com/users/instagibbs/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/instagibbs/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/instagibbs/subscriptions",
      "organizations_url": "https://api.github.com/users/instagibbs/orgs",
      "repos_url": "https://api.github.com/users/instagibbs/repos",
      "events_url": "https://api.github.com/users/instagibbs/events{/privacy}",
      "received_events_url": "https://api.github.com/users/instagibbs/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "done",
    "created_at": "2018-05-22T16:07:37Z",
    "updated_at": "2018-05-22T16:07:38Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r189961477",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/189961477"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/13045#discussion_r189961477"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/13045"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/189961477/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2412,
    "side": "RIGHT",
    "in_reply_to_id": 189671678
  }
]