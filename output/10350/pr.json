{
  "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10350",
  "id": 119321844,
  "node_id": "MDExOlB1bGxSZXF1ZXN0MTE5MzIxODQ0",
  "html_url": "https://github.com/bitcoin/bitcoin/pull/10350",
  "diff_url": "https://github.com/bitcoin/bitcoin/pull/10350.diff",
  "patch_url": "https://github.com/bitcoin/bitcoin/pull/10350.patch",
  "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10350",
  "number": 10350,
  "state": "closed",
  "locked": false,
  "title": "Added support for MSG_FILTERED_WITNESS_BLOCK messages.",
  "user": {
    "login": "CodeShark",
    "id": 894059,
    "node_id": "MDQ6VXNlcjg5NDA1OQ==",
    "avatar_url": "https://avatars.githubusercontent.com/u/894059?v=4",
    "gravatar_id": "",
    "url": "https://api.github.com/users/CodeShark",
    "html_url": "https://github.com/CodeShark",
    "followers_url": "https://api.github.com/users/CodeShark/followers",
    "following_url": "https://api.github.com/users/CodeShark/following{/other_user}",
    "gists_url": "https://api.github.com/users/CodeShark/gists{/gist_id}",
    "starred_url": "https://api.github.com/users/CodeShark/starred{/owner}{/repo}",
    "subscriptions_url": "https://api.github.com/users/CodeShark/subscriptions",
    "organizations_url": "https://api.github.com/users/CodeShark/orgs",
    "repos_url": "https://api.github.com/users/CodeShark/repos",
    "events_url": "https://api.github.com/users/CodeShark/events{/privacy}",
    "received_events_url": "https://api.github.com/users/CodeShark/received_events",
    "type": "User",
    "site_admin": false
  },
  "body": "After much deliberation and a few attempts at other approaches to provide a workable near-term sync mechanism for thin clients that require witness data, I decided to just go with the simplest short-term path with the least amount of complications expecting BIP37 to be completely replaced eventually - hopefully in the not-very-distant future.\r\n\r\nI believe the approach of filtering blocks on the client is a simpler and superior approach for most use cases than requiring the server to perform the filtering. I believe @Roasbeef has something written up for this that he's using for lnd. I would love to see that approach used in Bitcoin Core as well.\r\n\r\nBut given the good likelihood of nearterm SegWit activation on the Bitcoin mainnet, I believe this solution will suffice for all essential use cases of BIP37 for now - and I don't believe it's worth the effort to try to make more complex additions to BIP37 since it will eventually be entirely replaced.\r\n\r\nPeers can request MSG_FILTERED_WITNESS_BLOCK and will receive a merkleblock structure with transactions serialized with witnesses. The merkle proof for the witnesses is not supplied. This means that the client cannot verify that the witness data is what's actually in the block. However, the attack vectors here given the actual intended use cases seem extremely slim for several reasons:\r\n\r\n1) The witness data contains signatures which the client can still verify. Spoofing the witness would require supplying signatures that still redeem the output, meaning that only parties that can sign for the output could produce false witness data.\r\n\r\n2) In order to use BIP37 with any real degree of privacy and security, you need to connect to a trusted node. If this is your setup, adding merkle proofs for witnesses is an unnecessary complication.\r\n\r\n3) The foreseen intended use cases here are wallets that support multisignature scripts or scripts with multiple execution paths where you want to be able to check which signatures are provided or which execution path has been taken. In anticipated use cases, there is not much an attacker could gain from a transaction being signed in two different ways - and typically, the attacker would be easily identifiable.",
  "created_at": "2017-05-07T00:59:39Z",
  "updated_at": "2019-10-24T16:51:37Z",
  "closed_at": "2018-08-25T16:32:14Z",
  "merged_at": null,
  "merge_commit_sha": "04f0fb7a683e85de3037b625f7b7bad40626f2b4",
  "assignee": null,
  "assignees": [],
  "requested_reviewers": [],
  "requested_teams": [],
  "labels": [
    {
      "id": 98298007,
      "node_id": "MDU6TGFiZWw5ODI5ODAwNw==",
      "url": "https://api.github.com/repos/bitcoin/bitcoin/labels/P2P",
      "name": "P2P",
      "color": "006b75",
      "default": false,
      "description": null
    }
  ],
  "milestone": null,
  "draft": false,
  "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10350/commits",
  "review_comments_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10350/comments",
  "review_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments{/number}",
  "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/10350/comments",
  "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/fcf7d60071dcde32353b410a6d2e0ea238887aad",
  "head": {
    "label": "CodeShark:MSG_FILTERED_WITNESS_BLOCK_2",
    "ref": "MSG_FILTERED_WITNESS_BLOCK_2",
    "sha": "fcf7d60071dcde32353b410a6d2e0ea238887aad",
    "user": {
      "login": "CodeShark",
      "id": 894059,
      "node_id": "MDQ6VXNlcjg5NDA1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/894059?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/CodeShark",
      "html_url": "https://github.com/CodeShark",
      "followers_url": "https://api.github.com/users/CodeShark/followers",
      "following_url": "https://api.github.com/users/CodeShark/following{/other_user}",
      "gists_url": "https://api.github.com/users/CodeShark/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/CodeShark/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/CodeShark/subscriptions",
      "organizations_url": "https://api.github.com/users/CodeShark/orgs",
      "repos_url": "https://api.github.com/users/CodeShark/repos",
      "events_url": "https://api.github.com/users/CodeShark/events{/privacy}",
      "received_events_url": "https://api.github.com/users/CodeShark/received_events",
      "type": "User",
      "site_admin": false
    },
    "repo": {
      "id": 7239671,
      "node_id": "MDEwOlJlcG9zaXRvcnk3MjM5Njcx",
      "name": "bitcoin",
      "full_name": "CodeShark/bitcoin",
      "private": false,
      "owner": {
        "login": "CodeShark",
        "id": 894059,
        "node_id": "MDQ6VXNlcjg5NDA1OQ==",
        "avatar_url": "https://avatars.githubusercontent.com/u/894059?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/CodeShark",
        "html_url": "https://github.com/CodeShark",
        "followers_url": "https://api.github.com/users/CodeShark/followers",
        "following_url": "https://api.github.com/users/CodeShark/following{/other_user}",
        "gists_url": "https://api.github.com/users/CodeShark/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/CodeShark/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/CodeShark/subscriptions",
        "organizations_url": "https://api.github.com/users/CodeShark/orgs",
        "repos_url": "https://api.github.com/users/CodeShark/repos",
        "events_url": "https://api.github.com/users/CodeShark/events{/privacy}",
        "received_events_url": "https://api.github.com/users/CodeShark/received_events",
        "type": "User",
        "site_admin": false
      },
      "html_url": "https://github.com/CodeShark/bitcoin",
      "description": "Bitcoin integration/staging tree",
      "fork": true,
      "url": "https://api.github.com/repos/CodeShark/bitcoin",
      "forks_url": "https://api.github.com/repos/CodeShark/bitcoin/forks",
      "keys_url": "https://api.github.com/repos/CodeShark/bitcoin/keys{/key_id}",
      "collaborators_url": "https://api.github.com/repos/CodeShark/bitcoin/collaborators{/collaborator}",
      "teams_url": "https://api.github.com/repos/CodeShark/bitcoin/teams",
      "hooks_url": "https://api.github.com/repos/CodeShark/bitcoin/hooks",
      "issue_events_url": "https://api.github.com/repos/CodeShark/bitcoin/issues/events{/number}",
      "events_url": "https://api.github.com/repos/CodeShark/bitcoin/events",
      "assignees_url": "https://api.github.com/repos/CodeShark/bitcoin/assignees{/user}",
      "branches_url": "https://api.github.com/repos/CodeShark/bitcoin/branches{/branch}",
      "tags_url": "https://api.github.com/repos/CodeShark/bitcoin/tags",
      "blobs_url": "https://api.github.com/repos/CodeShark/bitcoin/git/blobs{/sha}",
      "git_tags_url": "https://api.github.com/repos/CodeShark/bitcoin/git/tags{/sha}",
      "git_refs_url": "https://api.github.com/repos/CodeShark/bitcoin/git/refs{/sha}",
      "trees_url": "https://api.github.com/repos/CodeShark/bitcoin/git/trees{/sha}",
      "statuses_url": "https://api.github.com/repos/CodeShark/bitcoin/statuses/{sha}",
      "languages_url": "https://api.github.com/repos/CodeShark/bitcoin/languages",
      "stargazers_url": "https://api.github.com/repos/CodeShark/bitcoin/stargazers",
      "contributors_url": "https://api.github.com/repos/CodeShark/bitcoin/contributors",
      "subscribers_url": "https://api.github.com/repos/CodeShark/bitcoin/subscribers",
      "subscription_url": "https://api.github.com/repos/CodeShark/bitcoin/subscription",
      "commits_url": "https://api.github.com/repos/CodeShark/bitcoin/commits{/sha}",
      "git_commits_url": "https://api.github.com/repos/CodeShark/bitcoin/git/commits{/sha}",
      "comments_url": "https://api.github.com/repos/CodeShark/bitcoin/comments{/number}",
      "issue_comment_url": "https://api.github.com/repos/CodeShark/bitcoin/issues/comments{/number}",
      "contents_url": "https://api.github.com/repos/CodeShark/bitcoin/contents/{+path}",
      "compare_url": "https://api.github.com/repos/CodeShark/bitcoin/compare/{base}...{head}",
      "merges_url": "https://api.github.com/repos/CodeShark/bitcoin/merges",
      "archive_url": "https://api.github.com/repos/CodeShark/bitcoin/{archive_format}{/ref}",
      "downloads_url": "https://api.github.com/repos/CodeShark/bitcoin/downloads",
      "issues_url": "https://api.github.com/repos/CodeShark/bitcoin/issues{/number}",
      "pulls_url": "https://api.github.com/repos/CodeShark/bitcoin/pulls{/number}",
      "milestones_url": "https://api.github.com/repos/CodeShark/bitcoin/milestones{/number}",
      "notifications_url": "https://api.github.com/repos/CodeShark/bitcoin/notifications{?since,all,participating}",
      "labels_url": "https://api.github.com/repos/CodeShark/bitcoin/labels{/name}",
      "releases_url": "https://api.github.com/repos/CodeShark/bitcoin/releases{/id}",
      "deployments_url": "https://api.github.com/repos/CodeShark/bitcoin/deployments",
      "created_at": "2012-12-19T11:35:37Z",
      "updated_at": "2020-10-16T02:27:16Z",
      "pushed_at": "2017-09-10T19:00:43Z",
      "git_url": "git://github.com/CodeShark/bitcoin.git",
      "ssh_url": "git@github.com:CodeShark/bitcoin.git",
      "clone_url": "https://github.com/CodeShark/bitcoin.git",
      "svn_url": "https://github.com/CodeShark/bitcoin",
      "homepage": "http://www.bitcoin.org",
      "size": 82016,
      "stargazers_count": 4,
      "watchers_count": 4,
      "language": "C++",
      "has_issues": false,
      "has_projects": true,
      "has_downloads": false,
      "has_wiki": false,
      "has_pages": false,
      "forks_count": 0,
      "mirror_url": null,
      "archived": false,
      "disabled": false,
      "open_issues_count": 0,
      "license": {
        "key": "mit",
        "name": "MIT License",
        "spdx_id": "MIT",
        "url": "https://api.github.com/licenses/mit",
        "node_id": "MDc6TGljZW5zZTEz"
      },
      "allow_forking": true,
      "is_template": false,
      "topics": [],
      "visibility": "public",
      "forks": 0,
      "open_issues": 0,
      "watchers": 4,
      "default_branch": "master"
    }
  },
  "base": {
    "label": "bitcoin:master",
    "ref": "master",
    "sha": "efae3663a772169f9ef5172d76f938e0bb02eca4",
    "user": {
      "login": "bitcoin",
      "id": 528860,
      "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/bitcoin",
      "html_url": "https://github.com/bitcoin",
      "followers_url": "https://api.github.com/users/bitcoin/followers",
      "following_url": "https://api.github.com/users/bitcoin/following{/other_user}",
      "gists_url": "https://api.github.com/users/bitcoin/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/bitcoin/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
      "organizations_url": "https://api.github.com/users/bitcoin/orgs",
      "repos_url": "https://api.github.com/users/bitcoin/repos",
      "events_url": "https://api.github.com/users/bitcoin/events{/privacy}",
      "received_events_url": "https://api.github.com/users/bitcoin/received_events",
      "type": "Organization",
      "site_admin": false
    },
    "repo": {
      "id": 1181927,
      "node_id": "MDEwOlJlcG9zaXRvcnkxMTgxOTI3",
      "name": "bitcoin",
      "full_name": "bitcoin/bitcoin",
      "private": false,
      "owner": {
        "login": "bitcoin",
        "id": 528860,
        "node_id": "MDEyOk9yZ2FuaXphdGlvbjUyODg2MA==",
        "avatar_url": "https://avatars.githubusercontent.com/u/528860?v=4",
        "gravatar_id": "",
        "url": "https://api.github.com/users/bitcoin",
        "html_url": "https://github.com/bitcoin",
        "followers_url": "https://api.github.com/users/bitcoin/followers",
        "following_url": "https://api.github.com/users/bitcoin/following{/other_user}",
        "gists_url": "https://api.github.com/users/bitcoin/gists{/gist_id}",
        "starred_url": "https://api.github.com/users/bitcoin/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/bitcoin/subscriptions",
        "organizations_url": "https://api.github.com/users/bitcoin/orgs",
        "repos_url": "https://api.github.com/users/bitcoin/repos",
        "events_url": "https://api.github.com/users/bitcoin/events{/privacy}",
        "received_events_url": "https://api.github.com/users/bitcoin/received_events",
        "type": "Organization",
        "site_admin": false
      },
      "html_url": "https://github.com/bitcoin/bitcoin",
      "description": "Bitcoin Core integration/staging tree",
      "fork": false,
      "url": "https://api.github.com/repos/bitcoin/bitcoin",
      "forks_url": "https://api.github.com/repos/bitcoin/bitcoin/forks",
      "keys_url": "https://api.github.com/repos/bitcoin/bitcoin/keys{/key_id}",
      "collaborators_url": "https://api.github.com/repos/bitcoin/bitcoin/collaborators{/collaborator}",
      "teams_url": "https://api.github.com/repos/bitcoin/bitcoin/teams",
      "hooks_url": "https://api.github.com/repos/bitcoin/bitcoin/hooks",
      "issue_events_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/events{/number}",
      "events_url": "https://api.github.com/repos/bitcoin/bitcoin/events",
      "assignees_url": "https://api.github.com/repos/bitcoin/bitcoin/assignees{/user}",
      "branches_url": "https://api.github.com/repos/bitcoin/bitcoin/branches{/branch}",
      "tags_url": "https://api.github.com/repos/bitcoin/bitcoin/tags",
      "blobs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/blobs{/sha}",
      "git_tags_url": "https://api.github.com/repos/bitcoin/bitcoin/git/tags{/sha}",
      "git_refs_url": "https://api.github.com/repos/bitcoin/bitcoin/git/refs{/sha}",
      "trees_url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees{/sha}",
      "statuses_url": "https://api.github.com/repos/bitcoin/bitcoin/statuses/{sha}",
      "languages_url": "https://api.github.com/repos/bitcoin/bitcoin/languages",
      "stargazers_url": "https://api.github.com/repos/bitcoin/bitcoin/stargazers",
      "contributors_url": "https://api.github.com/repos/bitcoin/bitcoin/contributors",
      "subscribers_url": "https://api.github.com/repos/bitcoin/bitcoin/subscribers",
      "subscription_url": "https://api.github.com/repos/bitcoin/bitcoin/subscription",
      "commits_url": "https://api.github.com/repos/bitcoin/bitcoin/commits{/sha}",
      "git_commits_url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits{/sha}",
      "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/comments{/number}",
      "issue_comment_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments{/number}",
      "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/{+path}",
      "compare_url": "https://api.github.com/repos/bitcoin/bitcoin/compare/{base}...{head}",
      "merges_url": "https://api.github.com/repos/bitcoin/bitcoin/merges",
      "archive_url": "https://api.github.com/repos/bitcoin/bitcoin/{archive_format}{/ref}",
      "downloads_url": "https://api.github.com/repos/bitcoin/bitcoin/downloads",
      "issues_url": "https://api.github.com/repos/bitcoin/bitcoin/issues{/number}",
      "pulls_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls{/number}",
      "milestones_url": "https://api.github.com/repos/bitcoin/bitcoin/milestones{/number}",
      "notifications_url": "https://api.github.com/repos/bitcoin/bitcoin/notifications{?since,all,participating}",
      "labels_url": "https://api.github.com/repos/bitcoin/bitcoin/labels{/name}",
      "releases_url": "https://api.github.com/repos/bitcoin/bitcoin/releases{/id}",
      "deployments_url": "https://api.github.com/repos/bitcoin/bitcoin/deployments",
      "created_at": "2010-12-19T15:16:43Z",
      "updated_at": "2021-12-03T09:32:23Z",
      "pushed_at": "2021-12-03T09:30:42Z",
      "git_url": "git://github.com/bitcoin/bitcoin.git",
      "ssh_url": "git@github.com:bitcoin/bitcoin.git",
      "clone_url": "https://github.com/bitcoin/bitcoin.git",
      "svn_url": "https://github.com/bitcoin/bitcoin",
      "homepage": "https://bitcoincore.org/en/download",
      "size": 188367,
      "stargazers_count": 59765,
      "watchers_count": 59765,
      "language": "C++",
      "has_issues": true,
      "has_projects": true,
      "has_downloads": false,
      "has_wiki": false,
      "has_pages": false,
      "forks_count": 30723,
      "mirror_url": null,
      "archived": false,
      "disabled": false,
      "open_issues_count": 1017,
      "license": {
        "key": "mit",
        "name": "MIT License",
        "spdx_id": "MIT",
        "url": "https://api.github.com/licenses/mit",
        "node_id": "MDc6TGljZW5zZTEz"
      },
      "allow_forking": true,
      "is_template": false,
      "topics": [
        "bitcoin",
        "c-plus-plus",
        "cryptocurrency",
        "cryptography",
        "p2p"
      ],
      "visibility": "public",
      "forks": 30723,
      "open_issues": 1017,
      "watchers": 59765,
      "default_branch": "master"
    }
  },
  "_links": {
    "self": {
      "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10350"
    },
    "html": {
      "href": "https://github.com/bitcoin/bitcoin/pull/10350"
    },
    "issue": {
      "href": "https://api.github.com/repos/bitcoin/bitcoin/issues/10350"
    },
    "comments": {
      "href": "https://api.github.com/repos/bitcoin/bitcoin/issues/10350/comments"
    },
    "review_comments": {
      "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10350/comments"
    },
    "review_comment": {
      "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments{/number}"
    },
    "commits": {
      "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/10350/commits"
    },
    "statuses": {
      "href": "https://api.github.com/repos/bitcoin/bitcoin/statuses/fcf7d60071dcde32353b410a6d2e0ea238887aad"
    }
  },
  "author_association": "CONTRIBUTOR",
  "auto_merge": null,
  "active_lock_reason": null,
  "merged": false,
  "mergeable": false,
  "rebaseable": false,
  "mergeable_state": "dirty",
  "merged_by": null,
  "comments": 8,
  "review_comments": 0,
  "maintainer_can_modify": false,
  "commits": 2,
  "additions": 9,
  "deletions": 6,
  "changed_files": 2
}