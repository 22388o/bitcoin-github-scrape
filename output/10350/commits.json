[
  {
    "sha": "b75d60a0252452fe990d9f71a2f0a7a8d4b3c9d4",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiNzVkNjBhMDI1MjQ1MmZlOTkwZDlmNzFhMmYwYTdhOGQ0YjNjOWQ0",
    "commit": {
      "author": {
        "name": "Eric Lombrozo",
        "email": "elombrozo@gmail.com",
        "date": "2017-05-07T00:45:05Z"
      },
      "committer": {
        "name": "Eric Lombrozo",
        "email": "elombrozo@gmail.com",
        "date": "2017-08-12T12:38:28Z"
      },
      "message": "Handle MSG_FILTERED_WITNESS_BLOCK messages",
      "tree": {
        "sha": "aa19d72576d06d02da3e2ff9a6553f3ec99801ef",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/aa19d72576d06d02da3e2ff9a6553f3ec99801ef"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b75d60a0252452fe990d9f71a2f0a7a8d4b3c9d4",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b75d60a0252452fe990d9f71a2f0a7a8d4b3c9d4",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/b75d60a0252452fe990d9f71a2f0a7a8d4b3c9d4",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b75d60a0252452fe990d9f71a2f0a7a8d4b3c9d4/comments",
    "author": {
      "login": "CodeShark",
      "id": 894059,
      "node_id": "MDQ6VXNlcjg5NDA1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/894059?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/CodeShark",
      "html_url": "https://github.com/CodeShark",
      "followers_url": "https://api.github.com/users/CodeShark/followers",
      "following_url": "https://api.github.com/users/CodeShark/following{/other_user}",
      "gists_url": "https://api.github.com/users/CodeShark/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/CodeShark/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/CodeShark/subscriptions",
      "organizations_url": "https://api.github.com/users/CodeShark/orgs",
      "repos_url": "https://api.github.com/users/CodeShark/repos",
      "events_url": "https://api.github.com/users/CodeShark/events{/privacy}",
      "received_events_url": "https://api.github.com/users/CodeShark/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "CodeShark",
      "id": 894059,
      "node_id": "MDQ6VXNlcjg5NDA1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/894059?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/CodeShark",
      "html_url": "https://github.com/CodeShark",
      "followers_url": "https://api.github.com/users/CodeShark/followers",
      "following_url": "https://api.github.com/users/CodeShark/following{/other_user}",
      "gists_url": "https://api.github.com/users/CodeShark/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/CodeShark/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/CodeShark/subscriptions",
      "organizations_url": "https://api.github.com/users/CodeShark/orgs",
      "repos_url": "https://api.github.com/users/CodeShark/repos",
      "events_url": "https://api.github.com/users/CodeShark/events{/privacy}",
      "received_events_url": "https://api.github.com/users/CodeShark/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "aeb31756276034dd506fdf97c8aaade0e7e584f5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/aeb31756276034dd506fdf97c8aaade0e7e584f5",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/aeb31756276034dd506fdf97c8aaade0e7e584f5"
      }
    ],
    "stats": {
      "total": 10,
      "additions": 5,
      "deletions": 5
    },
    "files": [
      {
        "sha": "6d1460a4eb022ba731d864cda663f8062b68fef0",
        "filename": "src/net_processing.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 5,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b75d60a0252452fe990d9f71a2f0a7a8d4b3c9d4/src/net_processing.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b75d60a0252452fe990d9f71a2f0a7a8d4b3c9d4/src/net_processing.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net_processing.cpp?ref=b75d60a0252452fe990d9f71a2f0a7a8d4b3c9d4",
        "patch": "@@ -974,7 +974,7 @@ void static ProcessGetData(CNode* pfrom, const Consensus::Params& consensusParam\n \n             it++;\n \n-            if (inv.type == MSG_BLOCK || inv.type == MSG_FILTERED_BLOCK || inv.type == MSG_CMPCT_BLOCK || inv.type == MSG_WITNESS_BLOCK)\n+            if (inv.type == MSG_BLOCK || inv.type == MSG_FILTERED_BLOCK || inv.type == MSG_CMPCT_BLOCK || inv.type == MSG_WITNESS_BLOCK || inv.type == MSG_FILTERED_WITNESS_BLOCK)\n             {\n                 bool send = false;\n                 BlockMap::iterator mi = mapBlockIndex.find(inv.hash);\n@@ -1017,7 +1017,7 @@ void static ProcessGetData(CNode* pfrom, const Consensus::Params& consensusParam\n                 // disconnect node in case we have reached the outbound limit for serving historical blocks\n                 // never disconnect whitelisted nodes\n                 static const int nOneWeek = 7 * 24 * 60 * 60; // assume > 1 week = historical\n-                if (send && connman.OutboundTargetReached(true) && ( ((pindexBestHeader != NULL) && (pindexBestHeader->GetBlockTime() - mi->second->GetBlockTime() > nOneWeek)) || inv.type == MSG_FILTERED_BLOCK) && !pfrom->fWhitelisted)\n+                if (send && connman.OutboundTargetReached(true) && ( ((pindexBestHeader != NULL) && (pindexBestHeader->GetBlockTime() - mi->second->GetBlockTime() > nOneWeek)) || inv.type == MSG_FILTERED_BLOCK || MSG_FILTERED_WITNESS_BLOCK) && !pfrom->fWhitelisted)\n                 {\n                     LogPrint(BCLog::NET, \"historical block serving limit reached, disconnect peer=%d\\n\", pfrom->GetId());\n \n@@ -1043,7 +1043,7 @@ void static ProcessGetData(CNode* pfrom, const Consensus::Params& consensusParam\n                         connman.PushMessage(pfrom, msgMaker.Make(SERIALIZE_TRANSACTION_NO_WITNESS, NetMsgType::BLOCK, *pblock));\n                     else if (inv.type == MSG_WITNESS_BLOCK)\n                         connman.PushMessage(pfrom, msgMaker.Make(NetMsgType::BLOCK, *pblock));\n-                    else if (inv.type == MSG_FILTERED_BLOCK)\n+                    else if (inv.type == MSG_FILTERED_BLOCK || inv.type == MSG_FILTERED_WITNESS_BLOCK)\n                     {\n                         bool sendMerkleBlock = false;\n                         CMerkleBlock merkleBlock;\n@@ -1064,7 +1064,7 @@ void static ProcessGetData(CNode* pfrom, const Consensus::Params& consensusParam\n                             // however we MUST always provide at least what the remote peer needs\n                             typedef std::pair<unsigned int, uint256> PairType;\n                             for (PairType& pair : merkleBlock.vMatchedTxn)\n-                                connman.PushMessage(pfrom, msgMaker.Make(SERIALIZE_TRANSACTION_NO_WITNESS, NetMsgType::TX, *pblock->vtx[pair.first]));\n+                                connman.PushMessage(pfrom, msgMaker.Make(inv.type == MSG_FILTERED_WITNESS_BLOCK ? 0 : SERIALIZE_TRANSACTION_NO_WITNESS, NetMsgType::TX, *pblock->vtx[pair.first]));\n                         }\n                         // else\n                             // no response\n@@ -1128,7 +1128,7 @@ void static ProcessGetData(CNode* pfrom, const Consensus::Params& consensusParam\n             // Track requests for our stuff.\n             GetMainSignals().Inventory(inv.hash);\n \n-            if (inv.type == MSG_BLOCK || inv.type == MSG_FILTERED_BLOCK || inv.type == MSG_CMPCT_BLOCK || inv.type == MSG_WITNESS_BLOCK)\n+            if (inv.type == MSG_BLOCK || inv.type == MSG_FILTERED_BLOCK || inv.type == MSG_CMPCT_BLOCK || inv.type == MSG_WITNESS_BLOCK || inv.type == MSG_FILTERED_WITNESS_BLOCK)\n                 break;\n         }\n     }"
      }
    ]
  },
  {
    "sha": "fcf7d60071dcde32353b410a6d2e0ea238887aad",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmY2Y3ZDYwMDcxZGNkZTMyMzUzYjQxMGE2ZDJlMGVhMjM4ODg3YWFk",
    "commit": {
      "author": {
        "name": "Eric Lombrozo",
        "email": "elombrozo@gmail.com",
        "date": "2017-05-07T00:52:03Z"
      },
      "committer": {
        "name": "Eric Lombrozo",
        "email": "elombrozo@gmail.com",
        "date": "2017-08-12T12:38:50Z"
      },
      "message": "Protocol version bump for MSG_FILTERED_WITNESS_BLOCK",
      "tree": {
        "sha": "26e5613a7ca026797252b4904a341517ae09576b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/26e5613a7ca026797252b4904a341517ae09576b"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fcf7d60071dcde32353b410a6d2e0ea238887aad",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fcf7d60071dcde32353b410a6d2e0ea238887aad",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fcf7d60071dcde32353b410a6d2e0ea238887aad",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fcf7d60071dcde32353b410a6d2e0ea238887aad/comments",
    "author": {
      "login": "CodeShark",
      "id": 894059,
      "node_id": "MDQ6VXNlcjg5NDA1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/894059?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/CodeShark",
      "html_url": "https://github.com/CodeShark",
      "followers_url": "https://api.github.com/users/CodeShark/followers",
      "following_url": "https://api.github.com/users/CodeShark/following{/other_user}",
      "gists_url": "https://api.github.com/users/CodeShark/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/CodeShark/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/CodeShark/subscriptions",
      "organizations_url": "https://api.github.com/users/CodeShark/orgs",
      "repos_url": "https://api.github.com/users/CodeShark/repos",
      "events_url": "https://api.github.com/users/CodeShark/events{/privacy}",
      "received_events_url": "https://api.github.com/users/CodeShark/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "CodeShark",
      "id": 894059,
      "node_id": "MDQ6VXNlcjg5NDA1OQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/894059?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/CodeShark",
      "html_url": "https://github.com/CodeShark",
      "followers_url": "https://api.github.com/users/CodeShark/followers",
      "following_url": "https://api.github.com/users/CodeShark/following{/other_user}",
      "gists_url": "https://api.github.com/users/CodeShark/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/CodeShark/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/CodeShark/subscriptions",
      "organizations_url": "https://api.github.com/users/CodeShark/orgs",
      "repos_url": "https://api.github.com/users/CodeShark/repos",
      "events_url": "https://api.github.com/users/CodeShark/events{/privacy}",
      "received_events_url": "https://api.github.com/users/CodeShark/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "b75d60a0252452fe990d9f71a2f0a7a8d4b3c9d4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b75d60a0252452fe990d9f71a2f0a7a8d4b3c9d4",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/b75d60a0252452fe990d9f71a2f0a7a8d4b3c9d4"
      }
    ],
    "stats": {
      "total": 5,
      "additions": 4,
      "deletions": 1
    },
    "files": [
      {
        "sha": "0b37be5e753d17d567aedcb01637ecfb2cdd419b",
        "filename": "src/version.h",
        "status": "modified",
        "additions": 4,
        "deletions": 1,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fcf7d60071dcde32353b410a6d2e0ea238887aad/src/version.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fcf7d60071dcde32353b410a6d2e0ea238887aad/src/version.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/version.h?ref=fcf7d60071dcde32353b410a6d2e0ea238887aad",
        "patch": "@@ -9,7 +9,7 @@\n  * network protocol versioning\n  */\n \n-static const int PROTOCOL_VERSION = 70015;\n+static const int PROTOCOL_VERSION = 70016;\n \n //! initial proto version, to be increased after version/verack negotiation\n static const int INIT_PROTO_VERSION = 209;\n@@ -42,4 +42,7 @@ static const int SHORT_IDS_BLOCKS_VERSION = 70014;\n //! not banning for invalid compact blocks starts with this version\n static const int INVALID_CB_NO_BAN_VERSION = 70015;\n \n+//! MSG_FILTERED_MERKLE_BLOCK support starts with this version\n+static const int FILTERED_MERKLE_BLOCK_VERSION = 70016;\n+\n #endif // BITCOIN_VERSION_H"
      }
    ]
  }
]