[
  {
    "sha": "ef14d90172e2278b362171763805ac41a6d7779e",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplZjE0ZDkwMTcyZTIyNzhiMzYyMTcxNzYzODA1YWM0MWE2ZDc3Nzll",
    "commit": {
      "author": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2021-02-10T09:38:38Z"
      },
      "committer": {
        "name": "Hennadii Stepanov",
        "email": "32963518+hebasto@users.noreply.github.com",
        "date": "2021-02-10T20:44:50Z"
      },
      "message": "script: Drop KVM support in gitian-build.py\n\nThe python-vm-builder package, which is required for KVM-based builds,\nis not available in distros after bionic.",
      "tree": {
        "sha": "e82477633af910fadd8a107a1a49664092237929",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e82477633af910fadd8a107a1a49664092237929"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ef14d90172e2278b362171763805ac41a6d7779e",
      "comment_count": 0,
      "verification": {
        "verified": true,
        "reason": "valid",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQIzBAABCgAdFiEE0dvyxLlvLev0wWZUQQEIES5+qB8FAmAkRcIACgkQQQEIES5+\nqB8oSg/9HJTb3xie/X2/9HzlmuOYJAUwgbil6bKVE/PWjSYu/h3rtUMVE+4MA84W\np1Zy3DRWZNzLhf6fG5SobF1oZeAI3m6aC2UDccpm1JS7pIuHooTdxIOmKGhaViow\njVYlUYQVGDad3khV3+zMDcUvAD8qzwR0OzXjxVagOYvFsILGT8idRGOwGgVew6vo\nfcJ/zqu2L/x0uTT84OO2C7lCBbkbkrOobloQkgVYc34AwlXqvMZybsY3GLddmfG/\nm1/UVZAQnsviTxQbwBZou1mIsEJoynTt9ncc68WKiB9PyT5Pm2770zOjhYWhO0KC\n/OD8+BpQKQ49YPrdNPRWYeKKtMU2QQHE/zH8B+FqCecFBAe0s9A1b+kwx6bBwDzw\nqNT/k3qjGOVhv2e9pwtqFEZd3P219d3BmjNOg0uKNaGKSrljQ7R1lMXUd6lZ2cgp\nBHHD3d8g5kpfN6UBf0iXss71y1Uwb66gcIbtipXuFECr3z80W8+P0dNDdefrHRDm\nLjhARUtRHBUNwM+4cU/EnjvoVh3NmGdvT21YSyyMs7js1+uDTqzdBLuXPnNW5TNb\nw9ftmpOGszlGwHDMbqb6XDhqcuOM5u8kXcJzZdyjFQFx+Cxx2sr751rvcyHvZ2i4\nB0MGen01GD1I20GHtA1olp+zCUcz2In+gTxQCCBi4pi3p7QgpI4=\n=8Fsx\n-----END PGP SIGNATURE-----",
        "payload": "tree e82477633af910fadd8a107a1a49664092237929\nparent deb185d2fdcd1327d40791ebf6621aed0ebd443d\nauthor Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1612949918 +0200\ncommitter Hennadii Stepanov <32963518+hebasto@users.noreply.github.com> 1612989890 +0200\n\nscript: Drop KVM support in gitian-build.py\n\nThe python-vm-builder package, which is required for KVM-based builds,\nis not available in distros after bionic.\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ef14d90172e2278b362171763805ac41a6d7779e",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/ef14d90172e2278b362171763805ac41a6d7779e",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ef14d90172e2278b362171763805ac41a6d7779e/comments",
    "author": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "hebasto",
      "id": 32963518,
      "node_id": "MDQ6VXNlcjMyOTYzNTE4",
      "avatar_url": "https://avatars.githubusercontent.com/u/32963518?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/hebasto",
      "html_url": "https://github.com/hebasto",
      "followers_url": "https://api.github.com/users/hebasto/followers",
      "following_url": "https://api.github.com/users/hebasto/following{/other_user}",
      "gists_url": "https://api.github.com/users/hebasto/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/hebasto/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/hebasto/subscriptions",
      "organizations_url": "https://api.github.com/users/hebasto/orgs",
      "repos_url": "https://api.github.com/users/hebasto/repos",
      "events_url": "https://api.github.com/users/hebasto/events{/privacy}",
      "received_events_url": "https://api.github.com/users/hebasto/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "deb185d2fdcd1327d40791ebf6621aed0ebd443d",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/deb185d2fdcd1327d40791ebf6621aed0ebd443d",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/deb185d2fdcd1327d40791ebf6621aed0ebd443d"
      }
    ],
    "stats": {
      "total": 14,
      "additions": 4,
      "deletions": 10
    },
    "files": [
      {
        "sha": "073cc722ff18c0a15d2840bb51a44155cbaa0267",
        "filename": "contrib/gitian-build.py",
        "status": "modified",
        "additions": 4,
        "deletions": 10,
        "changes": 14,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ef14d90172e2278b362171763805ac41a6d7779e/contrib/gitian-build.py",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ef14d90172e2278b362171763805ac41a6d7779e/contrib/gitian-build.py",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/gitian-build.py?ref=ef14d90172e2278b362171763805ac41a6d7779e",
        "patch": "@@ -11,9 +11,7 @@\n def setup():\n     global args, workdir\n     programs = ['ruby', 'git', 'make', 'wget', 'curl']\n-    if args.kvm:\n-        programs += ['apt-cacher-ng', 'python-vm-builder', 'qemu-kvm', 'qemu-utils']\n-    elif args.docker:\n+    if args.docker:\n         if not os.path.isfile('/lib/systemd/system/docker.service'):\n             dockers = ['docker.io', 'docker-ce']\n             for i in dockers:\n@@ -38,11 +36,11 @@ def setup():\n     make_image_prog = ['bin/make-base-vm', '--suite', 'focal', '--arch', 'amd64']\n     if args.docker:\n         make_image_prog += ['--docker']\n-    elif not args.kvm:\n+    else:\n         make_image_prog += ['--lxc', '--disksize', '13000']\n     subprocess.check_call(make_image_prog)\n     os.chdir(workdir)\n-    if args.is_focal and not args.kvm and not args.docker:\n+    if args.is_focal and not args.docker:\n         subprocess.check_call(['sudo', 'sed', '-i', 's/lxcbr0/br0/', '/etc/default/lxc-net'])\n         print('Reboot is required')\n         sys.exit(0)\n@@ -165,7 +163,6 @@ def main():\n     parser.add_argument('-o', '--os', dest='os', default='lwm', help='Specify which Operating Systems the build is for. Default is %(default)s. l for Linux, w for Windows, m for MacOS')\n     parser.add_argument('-j', '--jobs', dest='jobs', default='2', help='Number of processes to use. Default %(default)s')\n     parser.add_argument('-m', '--memory', dest='memory', default='2000', help='Memory to allocate in MiB. Default %(default)s')\n-    parser.add_argument('-k', '--kvm', action='store_true', dest='kvm', help='Use KVM instead of LXC')\n     parser.add_argument('-d', '--docker', action='store_true', dest='docker', help='Use Docker instead of LXC')\n     parser.add_argument('-S', '--setup', action='store_true', dest='setup', help='Set up the Gitian building environment. Only works on Debian-based systems (Ubuntu, Debian)')\n     parser.add_argument('-D', '--detach-sign', action='store_true', dest='detach_sign', help='Create the assert file for detached signing. Will not commit anything.')\n@@ -178,17 +175,14 @@ def main():\n \n     args.is_focal = b'focal' in subprocess.check_output(['lsb_release', '-cs'])\n \n-    if args.kvm and args.docker:\n-        raise Exception('Error: cannot have both kvm and docker')\n-\n     # Ensure no more than one environment variable for gitian-builder (USE_LXC, USE_VBOX, USE_DOCKER) is set as they\n     # can interfere (e.g., USE_LXC being set shadows USE_DOCKER; for details see gitian-builder/libexec/make-clean-vm).\n     os.environ['USE_LXC'] = ''\n     os.environ['USE_VBOX'] = ''\n     os.environ['USE_DOCKER'] = ''\n     if args.docker:\n         os.environ['USE_DOCKER'] = '1'\n-    elif not args.kvm:\n+    else:\n         os.environ['USE_LXC'] = '1'\n         if 'GITIAN_HOST_IP' not in os.environ.keys():\n             os.environ['GITIAN_HOST_IP'] = '10.0.3.1'"
      }
    ]
  }
]