laanwj,2012-04-15T08:00:08Z,"IMO this is less ugly instead of more ugly than #1102. All non-implementation information about RPC commands is conveniently in one place, in table vRpcCommands. You could in principle add the help message as well. And there's no long registration function that has to be kept up to date when new commands added, just a simple one.\n\nOne remark though: can you move the RegisterRPCCommands() call to",https://github.com/bitcoin/bitcoin/pull/1103#issuecomment-5137633,5137633,
sipa,2012-04-15T12:03:42Z,"You could have an RPCDIspatcher class with a singleton object, which uses RegisterRPCCommands as constructor.\n",https://github.com/bitcoin/bitcoin/pull/1103#issuecomment-5138742,5138742,
laanwj,2012-04-15T12:09:26Z,"As I understand it we currently simply take both mutexes for all RPC commands? (which is inefficient, but very safe) Did that change with this commit?\n",https://github.com/bitcoin/bitcoin/pull/1103#issuecomment-5138771,5138771,
sipa,2012-04-15T12:11:45Z,"Oh right - I confused safe mode with ""requires extra locking"". I removed the part of the comment about that.\n",https://github.com/bitcoin/bitcoin/pull/1103#issuecomment-5138788,5138788,
jgarzik,2012-04-15T14:39:48Z,"BTW, I am looking for suggestions on how to best encapsulate the parameter parsing in CommandLineRPC().  That is the last area where there is a long ""if command==foo, do X"" decision table, containing per-RPC-command logic.\n\nIt would be nice to move that parameter parsing into the vRPCCommand table.\n",https://github.com/bitcoin/bitcoin/pull/1103#issuecomment-5139633,5139633,
laanwj,2012-04-15T14:53:59Z,"I'm not entirely sure about that. IMO it would be nice to separate client and server concerns as far as possible, even into separate implementation files.\n- The server logic is a box that accepts JSON and produces JSON data structures. It knows nothing of argument parsing, formatting, just handles commands. \n- The client logic takes a command name and list of (string) arguments, and produces a s",https://github.com/bitcoin/bitcoin/pull/1103#issuecomment-5139721,5139721,
jgarzik,2012-04-15T15:44:18Z,"RE @laanwj ""And there's no long registration function that has to be kept up to date when new commands added, just a simple one""\n\nWell, the long registration function is replaced with a long table.  As the saying goes, ""six of one, half-dozen of the other""  In both this pull request and #1102, there is one (1) place that contains a master list of RPC commands.  In this pull request it is vRPCCom",https://github.com/bitcoin/bitcoin/pull/1103#issuecomment-5140037,5140037,
gavinandresen,2012-04-16T23:53:39Z,"ACK. I like this one better.\n\nI like data-driven programming, so describing argument types in a std::map<string method, std::map<int argNumber, ...something... argType> > or something instead of the current big long ""if/else..."" appeals to me. But that's such a low priority I probably wouldn't bother.\n",https://github.com/bitcoin/bitcoin/pull/1103#issuecomment-5165352,5165352,
sipa,2012-04-18T20:47:56Z,I've extended the encapsulation a bit further (while fixing the initialization issue) in #1124.\n,https://github.com/bitcoin/bitcoin/pull/1103#issuecomment-5208409,5208409,
sipa,2012-04-21T23:50:01Z,Included in #1124\n,https://github.com/bitcoin/bitcoin/pull/1103#issuecomment-5264481,5264481,
