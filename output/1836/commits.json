[
  {
    "sha": "3731f5788e87c601718f27ad6b8d149bde59b952",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozNzMxZjU3ODhlODdjNjAxNzE4ZjI3YWQ2YjhkMTQ5YmRlNTliOTUy",
    "commit": {
      "author": {
        "name": "kjj2",
        "email": "github@jerviss.org",
        "date": "2012-09-19T02:54:43Z"
      },
      "committer": {
        "name": "kjj2",
        "email": "github@jerviss.org",
        "date": "2012-09-22T23:17:29Z"
      },
      "message": "Adds a stopdetach <detach> RPC command.  <detach> defaults to true.  Works just like stop, but overrides the commandline/config file\n-detachdb option.  Useful for upgrading, for example.  Lets you use fast stops usually, but force a detach when needed.  Also, allows\nyou to do a fast stop in a system normally configured for fast stops.",
      "tree": {
        "sha": "c1ffcf9e172b642e074c193d419445bde96f7911",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c1ffcf9e172b642e074c193d419445bde96f7911"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/3731f5788e87c601718f27ad6b8d149bde59b952",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3731f5788e87c601718f27ad6b8d149bde59b952",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/3731f5788e87c601718f27ad6b8d149bde59b952",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/3731f5788e87c601718f27ad6b8d149bde59b952/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "6cbae37667f504d9ecd6173e1eff817d2b7aaf0c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6cbae37667f504d9ecd6173e1eff817d2b7aaf0c",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/6cbae37667f504d9ecd6173e1eff817d2b7aaf0c"
      }
    ],
    "stats": {
      "total": 11,
      "additions": 8,
      "deletions": 3
    },
    "files": [
      {
        "sha": "40ffc57fea09cdbc935a7df6c13fb45c8c3cdb1b",
        "filename": "src/bitcoinrpc.cpp",
        "status": "modified",
        "additions": 8,
        "deletions": 3,
        "changes": 11,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/3731f5788e87c601718f27ad6b8d149bde59b952/src/bitcoinrpc.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/3731f5788e87c601718f27ad6b8d149bde59b952/src/bitcoinrpc.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoinrpc.cpp?ref=3731f5788e87c601718f27ad6b8d149bde59b952",
        "patch": "@@ -9,6 +9,7 @@\n #include \"ui_interface.h\"\n #include \"base58.h\"\n #include \"bitcoinrpc.h\"\n+#include \"db.h\"\n \n #undef printf\n #include <boost/asio.hpp>\n@@ -173,11 +174,14 @@ Value help(const Array& params, bool fHelp)\n \n Value stop(const Array& params, bool fHelp)\n {\n-    if (fHelp || params.size() != 0)\n+    if (fHelp || params.size() > 1)\n         throw runtime_error(\n-            \"stop\\n\"\n-            \"Stop Bitcoin server.\");\n+            \"stop <detach>\\n\"\n+            \"<detach> is true or false to detach the database or not for this stop only\\n\"\n+            \"Stop Bitcoin server (and possibly override the detachdb config value).\");\n     // Shutdown will take long enough that the response should get back\n+    if (params.size() > 0)\n+        bitdb.SetDetach(params[0].get_bool());\n     StartShutdown();\n     return \"Bitcoin server stopping\";\n }\n@@ -1126,6 +1130,7 @@ Array RPCConvertValues(const std::string &strMethod, const std::vector<std::stri\n     //\n     // Special case non-string parameter types\n     //\n+    if (strMethod == \"stop\"                   && n > 0) ConvertTo<bool>(params[0]);\n     if (strMethod == \"setgenerate\"            && n > 0) ConvertTo<bool>(params[0]);\n     if (strMethod == \"setgenerate\"            && n > 1) ConvertTo<boost::int64_t>(params[1]);\n     if (strMethod == \"sendtoaddress\"          && n > 1) ConvertTo<double>(params[1]);"
      }
    ]
  }
]