Krellan,2014-11-18T07:33:56Z,"Refactored, after conversation with gmaxwell on #bitcoin-dev.\n\nDefault of whiteconnections is now 4 (if user isn't using whitelist feature at all, default is 0).\n\nNow acts to essentially reserve slots for exclusive use by whitelisted peers, against the given maxconnections limit, instead of increasing the maxconnections limit.\n\nWarning message given if whiteconnections value is so high that ",https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-63432405,63432405,
sipa,2014-11-18T13:43:18Z,"Tested that whitelisted connections are restricted to the whitelisted reserved count, and that the implicit + 4 without specified -maxconnections works as intended.\n",https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-63472172,63472172,
Krellan,2014-11-19T07:43:12Z,"Thanks, sipa, I added a comment showing some of the theory of operation behind nMaxConnections and nWhiteConnections.\n",https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-63603056,63603056,
Krellan,2014-12-28T00:09:15Z,"Rebased against the latest, no changes were necessary :)\n",https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-68194228,68194228,
Krellan,2015-02-09T20:52:10Z,"Thanks, will update it.\n",https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-73587616,73587616,
ghost,2015-03-11T07:04:09Z,utAck. Is the pending update keeping the merge up?\n,https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-78214593,78214593,
Krellan,2015-03-11T09:10:19Z,Yikes!  Forgot about this.  Will update ASAP.\n,https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-78227631,78227631,
Krellan,2015-03-12T09:47:17Z,"There, got it merged with latest master, and made the requested documentation cleanup changes!\n\nThe Travis build still fails for the ""no wallet"" case, but the same thing happens right now for the latest upstream master....\n",https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-78449971,78449971,
Krellan,2015-03-12T18:09:13Z,"No code change, just rebased with latest master to pick up the Travis build fix.\n",https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-78550869,78550869,
ghost,2015-03-12T22:28:28Z,Thanks!\n,https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-78658519,78658519,
Krellan,2015-03-18T22:32:32Z,"Good to point out!  I will change it so that the ""User is using whitelist feature"" test matches on either `-whitelist` or `-whitebind` options.\n",https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-83210357,83210357,
Krellan,2015-03-18T23:30:02Z,"There, updated it as described (both `whitelist` and `whitebind` will work to trigger the nMaxConnections fixup).  Also rebased against latest master.\n",https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-83223897,83223897,
Krellan,2015-03-20T06:33:20Z,"I thought about that as well, during initial implementation thoughts over IRC.  Talked about it with a few others.  Tried to avoid surprise and unintended behavior as best as possible, and this was a compromise.\n\nIf the increase was done always, then it would be surprising to the user, because it would look like we were blatantly disobeying their given `maxconnections` limit.\n\nIf user doesn't ",https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-83933430,83933430,
ghost,2015-03-24T21:59:11Z,Changing from utAck to tAck.\n,https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-85710314,85710314,
ghost,2015-04-21T23:11:36Z,I am not sure what's been keeping the PR open?\n,https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-94968580,94968580,
Krellan,2015-04-22T01:30:44Z,I'm not sure either.  I'm hoping there is no issue preventing this from being merged.\n,https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-94993476,94993476,
Krellan,2015-04-25T07:33:45Z,Trivial change to keep up with latest upstream.\n,https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-96145882,96145882,
sipa,2015-04-26T21:25:24Z,@Krellan There are several unaddressed comments?\n,https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-96436732,96436732,
Krellan,2015-04-26T21:38:45Z,@sipa Which comments? Thought I addressed all concerns.\n,https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-96438102,96438102,
sipa,2015-04-26T21:41:36Z,"Sorry, I missed that you answered in the PR rather than on the commits.\n",https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-96438224,96438224,
sipa,2015-04-27T12:27:03Z,"The ""increase the maxconnections if not specified, don't if it is"" is fine, I think, but I wonder if the -whiteconnections default = 4 is needed. An existing user of one of the white\* features won't expect a change in behaviour.\n\nI wonder if this isn't a concise way to specify it:\n- -whiteconnections defaults to 0, no matter what\n- -maxconnections defaults to 125 + [-whiteconnections](or what",https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-96631501,96631501,
Krellan,2015-05-08T06:35:15Z,"Good point.  I will make it default to 0 instead of 4, so that the default behavior is to change nothing at all.\n",https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-100117930,100117930,
Krellan,2015-05-26T09:03:35Z,"There, as requested, changed the default from 4 to 0.  Made no other code changes, just these constants.  Also rebased to latest upstream.\n\nSo, the behavior is now unchanged, by default.  If the user wants the benefit of reserved slots for their whitelisted incoming connections, they will have to explicitly specify how many slots they want to reserve.\n",https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-105456746,105456746,
laanwj,2015-06-12T15:10:42Z,utACK apart from nit (but needs rebase)\n,https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-111521695,111521695,
Krellan,2015-06-14T08:57:31Z,Rebased.\n,https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-111801503,111801503,
Krellan,2015-06-14T09:20:49Z,"Addressed the nit, good catch.\n\nAlso found another place where the default was still 4, changed to 0.\n",https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-111805734,111805734,
sipa,2015-06-14T13:06:49Z,Untested ACK\n,https://github.com/bitcoin/bitcoin/pull/5288#issuecomment-111825011,111825011,
sipa,2014-11-18T13:34:56Z,Can you add a comment here saying that this number is the _reserved_ number of connections for white connections?\n,https://github.com/bitcoin/bitcoin/pull/5288#discussion_r20504680,20504680,src/net.h
fanquake,2015-02-02T12:57:44Z,Could you update this to use our doxygen comment format.\n,https://github.com/bitcoin/bitcoin/pull/5288#discussion_r23922567,23922567,src/net.h
laanwj,2015-03-18T13:49:08Z,What if the user is using `whitebind` instead? \n,https://github.com/bitcoin/bitcoin/pull/5288#discussion_r26663550,26663550,src/init.cpp
laanwj,2015-03-19T12:37:02Z,"This inner `if()` seems a bit overcomplicated. I think this addition should either be always done (when whitelisting is used), or never at all. To me it doesn't hold up to the principle of least surprise to do this only to the default `-maxconnections` but not when the user provides one. Too much parameter interaction...\n",https://github.com/bitcoin/bitcoin/pull/5288#discussion_r26749341,26749341,src/init.cpp
laanwj,2015-06-12T15:08:10Z,"Slightly preferred for readability:\n\n``` c++\nnMaxConnections = std::min(nFD - MIN_CORE_FILEDESCRIPTORS, nMaxConnections);\n```\n",https://github.com/bitcoin/bitcoin/pull/5288#discussion_r32323832,32323832,src/init.cpp
laanwj,2015-06-12T15:10:16Z,It's not easy to integrate a 'floating' comment like this into doxygen.\nOne way would be to group nMaxConnections and nWhiteConnections using `@{` `@}` and add it as doxygen comment of the group.\n,https://github.com/bitcoin/bitcoin/pull/5288#discussion_r32324045,32324045,src/net.h
