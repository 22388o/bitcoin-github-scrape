[
  {
    "sha": "fa56245898b9fbadedae77869b5ef7e124c593ba",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYTU2MjQ1ODk4YjlmYmFkZWRhZTc3ODY5YjVlZjdlMTI0YzU5M2Jh",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-04-23T09:07:46Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-04-23T09:10:59Z"
      },
      "message": "test: Run SetupEnvironment first\n\nThis is also run first in the main() function of bitcoind",
      "tree": {
        "sha": "a293252e8d16800145d9342d7c2b18420735771b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a293252e8d16800145d9342d7c2b18420735771b"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa56245898b9fbadedae77869b5ef7e124c593ba",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUh33QwAiJZn7ez3JZUVScL6mvwZLxgznFnG0+/n/N/Gw5obboNfaa26whgDc1R9\n7XI8Kq+/Tv+L/IhVj0WrjuZ2iyCn7PnrVu9ttZvgy8yV8IMuBupJz6rj0/vkC9Vq\nzk51sAo8E4Mn92lV2lZvjMPBxlJORI7uRT+KuG2ZReIHfdGCD+Uh+ayhBqO9bXMI\nBuocKW6CvhIVVmXxNe8NowPPOLNc+Nj+ZpR+LFZndpUBlPa3NFPuD5SXf2dWSKk0\nYHjzWipw003UERTMvttK5xGvaGF/oFbDo32mplccQUR1jsAqpNa8fvq30GXdII2o\nVTBygARjzgllo96MC+c2qRFehzY3T70Mz7J+QJgj76xDOGTxRbDqxVqnMAkgrE7p\nJNNUftS9/reY+95gubeoF2nWHOlyv/sN4QY4cOyNI69RlAWK09bwV/86oqJkLLrr\nDqbQffyVc8qFtzVFhhCsjOwu7SXmgKRZ54RXtJKXliOQ4P9Y0PnYZKQzx02iMRv8\nSSCGxq/T\n=qPKt\n-----END PGP SIGNATURE-----",
        "payload": "tree a293252e8d16800145d9342d7c2b18420735771b\nparent 66fd3b28e85c167f3955b5603496daf8d91abcad\nauthor MarcoFalke <falke.marco@gmail.com> 1619168866 +0200\ncommitter MarcoFalke <falke.marco@gmail.com> 1619169059 +0200\n\ntest: Run SetupEnvironment first\n\nThis is also run first in the main() function of bitcoind\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa56245898b9fbadedae77869b5ef7e124c593ba",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fa56245898b9fbadedae77869b5ef7e124c593ba",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa56245898b9fbadedae77869b5ef7e124c593ba/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "66fd3b28e85c167f3955b5603496daf8d91abcad",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/66fd3b28e85c167f3955b5603496daf8d91abcad",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/66fd3b28e85c167f3955b5603496daf8d91abcad"
      }
    ],
    "stats": {
      "total": 2,
      "additions": 1,
      "deletions": 1
    },
    "files": [
      {
        "sha": "02411bce9f6a7152d25b74ea3b0d0d593b4579fb",
        "filename": "src/test/util/setup_common.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa56245898b9fbadedae77869b5ef7e124c593ba/src/test/util/setup_common.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa56245898b9fbadedae77869b5ef7e124c593ba/src/test/util/setup_common.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/util/setup_common.cpp?ref=fa56245898b9fbadedae77869b5ef7e124c593ba",
        "patch": "@@ -86,6 +86,7 @@ BasicTestingSetup::BasicTestingSetup(const std::string& chainName, const std::ve\n             \"-debugexclude=leveldb\",\n         },\n         extra_args);\n+    SetupEnvironment();\n     util::ThreadRename(\"test\");\n     fs::create_directories(m_path_root);\n     m_args.ForceSetArg(\"-datadir\", m_path_root.string());\n@@ -106,7 +107,6 @@ BasicTestingSetup::BasicTestingSetup(const std::string& chainName, const std::ve\n     LogInstance().StartLogging();\n     SHA256AutoDetect();\n     ECC_Start();\n-    SetupEnvironment();\n     SetupNetworking();\n     InitSignatureCache();\n     InitScriptExecutionCache();"
      }
    ]
  },
  {
    "sha": "fa8145af797a6dac2cff049399fc8d85fd30fe0b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmYTgxNDVhZjc5N2E2ZGFjMmNmZjA0OTM5OWZjOGQ4NWZkMzBmZTBi",
    "commit": {
      "author": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-04-23T09:16:08Z"
      },
      "committer": {
        "name": "MarcoFalke",
        "email": "falke.marco@gmail.com",
        "date": "2021-04-23T09:23:12Z"
      },
      "message": "test: Run AppInitSanityChecks before all tests",
      "tree": {
        "sha": "e5625018b85d737bc082dce85a3d85ca1c72f329",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e5625018b85d737bc082dce85a3d85ca1c72f329"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fa8145af797a6dac2cff049399fc8d85fd30fe0b",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unknown_key",
        "signature": "-----BEGIN PGP SIGNATURE-----\n\niQGzBAABCgAdFiEE+rVPoUahrI9sLGYTzit1aX5ppUgFAlwqrYAACgkQzit1aX5p\npUiqhwv/QVJOY18uI6JzfTGvkf3l+s5CMuafmXIlbX5Cq859m1OACaHnUmOBj1H7\nbcd+qucRmxWLD9SBeyS6/ZDa4om7+IIymW792QJW1YbM7Ocu1TPCYHY+pVJ1kVpC\n7qE0RJCz6gCbvrom2wBS/E1u1t+Rtek+wBT8bhqAa45N5u28VU1yCT7qrCHUirum\nPB8Y067ZUtJSrshNajnBriduZqemuT5eR2brh0kdHr8Dk4DqSptzjzjUBPtBvHUx\nNgDUJR21y/GfP6pu+ErBdb2A11lkvwxYxqbqKgBHVF8YuRAX2BJ6x3RL5+5dQWvr\nPoMIcYDg/lw9w+i1KK/0SKYlX+jAbdVo4vcLa5kwf1yiIdR97lCmu/mSR4iyl1oS\nDNCQxciAki0kop9JxLz1YmSlvdLWYI2OnGdbxJ/eSrTWREZ0K7gK00qQ+4Zb/O/V\n6sYsr0aJRVZSJF80jhae2gjrEuRMtvCG7w/eIfrtvA+G0hvBMEqy3mBE6UoXcP26\nTU59IVK7\n=Q9Ie\n-----END PGP SIGNATURE-----",
        "payload": "tree e5625018b85d737bc082dce85a3d85ca1c72f329\nparent fa56245898b9fbadedae77869b5ef7e124c593ba\nauthor MarcoFalke <falke.marco@gmail.com> 1619169368 +0200\ncommitter MarcoFalke <falke.marco@gmail.com> 1619169792 +0200\n\ntest: Run AppInitSanityChecks before all tests\n"
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa8145af797a6dac2cff049399fc8d85fd30fe0b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fa8145af797a6dac2cff049399fc8d85fd30fe0b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa8145af797a6dac2cff049399fc8d85fd30fe0b/comments",
    "author": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fa56245898b9fbadedae77869b5ef7e124c593ba",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fa56245898b9fbadedae77869b5ef7e124c593ba",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fa56245898b9fbadedae77869b5ef7e124c593ba"
      }
    ],
    "stats": {
      "total": 34,
      "additions": 5,
      "deletions": 29
    },
    "files": [
      {
        "sha": "6efee00b49442af45a46674d6a3c67e98f362254",
        "filename": "src/Makefile.test.include",
        "status": "modified",
        "additions": 0,
        "deletions": 1,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa8145af797a6dac2cff049399fc8d85fd30fe0b/src/Makefile.test.include",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa8145af797a6dac2cff049399fc8d85fd30fe0b/src/Makefile.test.include",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/Makefile.test.include?ref=fa8145af797a6dac2cff049399fc8d85fd30fe0b",
        "patch": "@@ -114,7 +114,6 @@ BITCOIN_TESTS =\\\n   test/random_tests.cpp \\\n   test/reverselock_tests.cpp \\\n   test/rpc_tests.cpp \\\n-  test/sanity_tests.cpp \\\n   test/scheduler_tests.cpp \\\n   test/script_p2sh_tests.cpp \\\n   test/script_tests.cpp \\"
      },
      {
        "sha": "496292875da0ff2c23a8a4a6f90e393727dcfca9",
        "filename": "src/test/sanity_tests.cpp",
        "status": "removed",
        "additions": 0,
        "deletions": 21,
        "changes": 21,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa56245898b9fbadedae77869b5ef7e124c593ba/src/test/sanity_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa56245898b9fbadedae77869b5ef7e124c593ba/src/test/sanity_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/sanity_tests.cpp?ref=fa56245898b9fbadedae77869b5ef7e124c593ba",
        "patch": "@@ -1,21 +0,0 @@\n-// Copyright (c) 2012-2020 The Bitcoin Core developers\n-// Distributed under the MIT software license, see the accompanying\n-// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n-\n-#include <compat/sanity.h>\n-#include <key.h>\n-#include <test/util/setup_common.h>\n-#include <util/time.h>\n-\n-#include <boost/test/unit_test.hpp>\n-\n-BOOST_FIXTURE_TEST_SUITE(sanity_tests, BasicTestingSetup)\n-\n-BOOST_AUTO_TEST_CASE(basic_sanity)\n-{\n-  BOOST_CHECK_MESSAGE(glibcxx_sanity_test() == true, \"stdlib sanity test\");\n-  BOOST_CHECK_MESSAGE(ECC_InitSanityCheck() == true, \"secp256k1 sanity test\");\n-  BOOST_CHECK_MESSAGE(ChronoSanityCheck() == true, \"chrono epoch test\");\n-}\n-\n-BOOST_AUTO_TEST_SUITE_END()"
      },
      {
        "sha": "761b69fea9e883aef038cb3d3e8247e759ee0ed7",
        "filename": "src/test/util/setup_common.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 3,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa8145af797a6dac2cff049399fc8d85fd30fe0b/src/test/util/setup_common.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa8145af797a6dac2cff049399fc8d85fd30fe0b/src/test/util/setup_common.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/util/setup_common.cpp?ref=fa8145af797a6dac2cff049399fc8d85fd30fe0b",
        "patch": "@@ -12,6 +12,7 @@\n #include <consensus/validation.h>\n #include <crypto/sha256.h>\n #include <init.h>\n+#include <init/common.h>\n #include <interfaces/chain.h>\n #include <miner.h>\n #include <net.h>\n@@ -104,9 +105,8 @@ BasicTestingSetup::BasicTestingSetup(const std::string& chainName, const std::ve\n     if (G_TEST_LOG_FUN) LogInstance().PushBackCallback(G_TEST_LOG_FUN);\n     InitLogging(*m_node.args);\n     AppInitParameterInteraction(*m_node.args);\n+    Assert(AppInitSanityChecks());\n     LogInstance().StartLogging();\n-    SHA256AutoDetect();\n-    ECC_Start();\n     SetupNetworking();\n     InitSignatureCache();\n     InitScriptExecutionCache();\n@@ -126,7 +126,7 @@ BasicTestingSetup::~BasicTestingSetup()\n     LogInstance().DisconnectTestLogger();\n     fs::remove_all(m_path_root);\n     gArgs.ClearArgs();\n-    ECC_Stop();\n+    init::UnsetGlobals();\n }\n \n ChainTestingSetup::ChainTestingSetup(const std::string& chainName, const std::vector<const char*>& extra_args)"
      },
      {
        "sha": "dd30ede1545f8bff2d40c72744ba25bcd7f06198",
        "filename": "src/test/util/setup_common.h",
        "status": "modified",
        "additions": 2,
        "deletions": 4,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fa8145af797a6dac2cff049399fc8d85fd30fe0b/src/test/util/setup_common.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fa8145af797a6dac2cff049399fc8d85fd30fe0b/src/test/util/setup_common.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/util/setup_common.h?ref=fa8145af797a6dac2cff049399fc8d85fd30fe0b",
        "patch": "@@ -8,16 +8,15 @@\n #include <chainparamsbase.h>\n #include <fs.h>\n #include <key.h>\n-#include <util/system.h>\n #include <node/context.h>\n-#include <pubkey.h>\n #include <random.h>\n-#include <stdexcept>\n #include <txmempool.h>\n #include <util/check.h>\n #include <util/string.h>\n+#include <util/system.h>\n #include <util/vector.h>\n \n+#include <stdexcept>\n #include <type_traits>\n #include <vector>\n \n@@ -74,7 +73,6 @@ static constexpr CAmount CENT{1000000};\n  * This just configures logging, data dir and chain parameters.\n  */\n struct BasicTestingSetup {\n-    ECCVerifyHandle globalVerifyHandle;\n     NodeContext m_node;\n \n     explicit BasicTestingSetup(const std::string& chainName = CBaseChainParams::MAIN, const std::vector<const char*>& extra_args = {});"
      }
    ]
  }
]