luke-jr,2020-07-10 15:59:19,"What's the point if we can't advertise the address?\n\nAlso, shouldn't it be possible to have both v2 and v3 addresses?",https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-656751436,656751436,
Saibato,2020-07-10 16:17:36,"> What's the point if we can't advertise the address?\n> \n> Also, shouldn't it be possible to have both v2 and v3 addresses?\n\nIf BIP155 get merged...  ?\nI have a working patch for @vasild Tor v3/ADDRv2  implementation that i will  post him now.\n\nBtw. I use for myself a patch to tunnel V3 in V2 ADDR message that works ̶ ̶r̶i̶g̶h̶t̶ ̶n̶o̶w̶ ̶w̶i̶t̶h̶ ̶c̶u̶r̶r̶e̶n̶t̶ ̶m̶a̶s̶t̶e̶r̶.̶ on t",https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-656760845,656760845,
luke-jr,2020-07-10 16:30:07,">It uses FC00/7 address that we ignore and resembles on the end to a v3 address to drop in and out from the peers.dat,\nThat should not even need a BIP since its fully transparent to the actual implementation, although a bit ugly and stealth.\n\nI don't know why it wouldn't need a BIP... it's a protocol change at the p2p layer still.",https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-656766884,656766884,
Saibato,2020-07-10 16:50:27,"> I don't know why it wouldn't need a BIP... it's a protocol change at the p2p layer ...\n\nSo then we propose this ?\nI posted this tunnel  patch in the comment as diff.\n\nThis v3 tunnel protocol is unrelated to this PR , Here we just create the service descriptor and do effectively none with it, but sure you can i.e.\npost the new v3 address grabbed from the log to your counterpart node a",https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-656776257,656776257,
DrahtBot,2020-07-11 00:20:28,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #19991 (net: Use alternative port for incoming Tor connections by hebasto)\n* #19954 (tor: complete the TORv3 implementati",https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-656947713,656947713,
Saibato,2020-07-11 00:25:44,"To add some fish here this POC tor v3 patch is in line with the current piggy pack of v2 onions in ipv6 <details><summary>Click here, to see the full diff of the POC ADDRv1 compatible tor v3 support  </summary>\n\n``` Diff\ndiff --git a/src/addrman.h b/src/addrman.h\nindex 8e82020df..4a810e53f 100644\n--- a/src/addrman.h\n+++ b/src/addrman.h\n@@ -61,6 +61,7 @@ public:\n     SERIALIZE_METHO",https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-656948716,656948716,
laanwj,2020-07-15 12:12:47,"Concept ACK. I thought about advertising both kinds of addresses for a bit and I think it does make sense. Tor that is unable to connect to v3 addresses is sufficiently old that running it is a security risk in itself, so that's not a valid reason to keep suporting v2 addresses, However with regard to advertising *on the bitcoin P2P network* it makes sense during the transition period to `addrv2` ",https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-658731686,658731686,
jonatack,2020-07-20 04:30:18,Concept ACK. Would you mind adding test coverage (and perhaps clang-format the changes)?,https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-660795052,660795052,
Saibato,2020-07-23 10:52:39,fixup-update: clang-format source,https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-662941075,662941075,
Saibato,2020-07-28 18:14:52,"fixup:\nAdd -ephemeraltoronion option,to generate v3 onions that are ADDRv2 prepared.\nNow we can generate ephemeral tor v3 onion addresses on node reboot.\n\nedit@saibato\nNow a single PR  #19635 ",https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-665196198,665196198,
Saibato,2020-07-30 09:31:48,"@luke-jr yes, quite ugly and just works and in the side show comments a little bit maxwell style ;-).\n",https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-666258865,666258865,
Rspigler,2020-07-31 17:21:35,"Tor is planning to deprecate v2 onion addresses by September 15th, no longer support by July 15th 2021 (0.4.6), and disable by October 15th 2021.\n\nhttps://blog.torproject.org/v2-deprecation-timeline\n",https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-667239737,667239737,
Saibato,2020-07-31 18:55:43,"> Tor is planning to deprecate v2 onion addresses by September 15th, no longer support by July\n\n@Rspigler yes we have some work here, the plan was to have from now on v3 and v2 in parallel and by that allow easy testing the transition. And then fade out v2 by change v3 to default.  And then way later refactor.  \n",https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-667299893,667299893,
Saibato,2020-08-15 12:38:27,rebased https://github.com/bitcoin/bitcoin/pull/19485/commits/cb8f28a8f8c967bbb11dc6ee412c52bb2b0a56fa,https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-674391711,674391711,
Saibato,2020-09-11 13:23:57,"> Concept ACK. Would you mind adding test coverage ...\n\n@jonatack In general i thnk the coder who wrote a feature should not write the test.\n\nThere is a. lot of success bias and b. ""Most makers are bad breakers"",    :haircut_woman:  \n\n",https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-691092964,691092964,
laanwj,2020-09-30 11:48:39,"I'm closing this in favor of #19954, which seems to include the same behvavior.",https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-701339712,701339712,
Saibato,2020-10-01 11:00:03,"> I'm closing this in favor of #19954, which seems to include the same behvavior.\n\nIt does not, when 19954 get merged as is, some old Tor only nodes will startup if updated without v2 and will not be reachable for some time inbound, before there new v3 is widely known\nAFAICS u and @Sjors where in favor of a dual stack i.e. with option to select for some time, but what is partly acked now is ",https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-702057309,702057309,
Sjors,2020-10-01 12:32:41,"I'm not opposed to dual stack. It might be worth discussing in a separate issue / PR. But it generally takes a while for people to upgrade their Bitcoin node, so I suspect there'll be plenty of v2 nodes left when that's shut down.",https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-702102523,702102523,
Saibato,2020-10-01 14:10:51,"> I'm not opposed to dual stack. It might be worth discussing in a separate issue / PR\n\nBut, this PR here is a dual stack and provides Tor v2 and v3 in parallel and @vasild what is so complicated to just grab from here and do this from day one?\nSo that i can close this here.\nI could live with this better if u could also add an option -useonlyv3service, that we then deprecate later to defau",https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-702163046,702163046,
Saibato,2021-01-10 14:03:36,"Probably no one ever reads that, but I still can only urge to have a dual stack as long as possible and all issues in Tor V3 are fixed and proven mature stable.\nThe effect on the consensus is a know issue but who knows what else is there not disclosed yet.\nDon't be reckless.  \nFirst 2021 full V3 Tor address outage.\n\nhttps://bitcoinhackers.org/web/statuses/105531638557051583\n\nhttps://",https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-757481499,757481499,
Rspigler,2021-01-10 22:35:38,I agree that having `peers.dat` backwards incompatible seems less of a conservative approach than is usually taken.  A dual stack (advertising both addresses) seems supported by @laanwj (https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-658731686) as well.,https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-757556062,757556062,
vasild,2021-01-11 10:32:09,"With current `master`, one can have his node behind the old, Tor v2 address by:\n\n* Configure the onion service in `torrc` and run bitcoind with `-listenonion=0 -bind=127.0.0.1:8334=onion`, `torrc`:\n```\nHiddenServiceDir /var/db/tor/bitcoind-torv2/\nHiddenServiceVersion 2               \nHiddenServicePort 8333 127.0.0.1:8334\n```\nor\n\n* Copy the old (v2) `onion_private_key` over `oni",https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-757861665,757861665,
jonatack,2021-01-11 12:58:33,"FWIW, the 0.21 release notes draft is at https://github.com/bitcoin-core/bitcoin-devwiki/wiki/0.21.0-Release-Notes-Draft and currently states:\n\n""The Tor onion service that is automatically created by setting the -listenonion configuration parameter will now be created as a Tor v3 service instead of Tor v2. The private key that was used for Tor v2 (if any) will be left untouched in the onion_pr",https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-757935563,757935563,
Saibato,2021-01-11 14:48:30,"> With current master, one can have his node behind the old, Tor v2 address by:\n\nsure, most experienced user will have Tor anyway defined pure in torrc.and use multiple externalip= and addnode in conf  and not expose the Tor service api anyway.\n\nBut if the mantra is that average Joe must not get screwed and not run into i..e. eclipse like things, we should keep v2 also in torcontrol as lon",https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-757998768,757998768,
sipa,2021-01-11 21:15:10,"I don't think there is anything to do here. By the time current master is released, TorV2 will be dead and gone.",https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-758229223,758229223,
Saibato,2021-01-12 09:48:38,"> I don't think there is anything to do here. By the time current master is released, TorV2 will be dead and gone.\n\nI know they say i am hard to understand and often vage.but let me repharse with no intend of **if a than b** I don't  and will not.\n\nBut, if u don;t Ithink there is anything to do here. By the time  v0.21.0  is released, TorV3 will be dead and gone.",https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-758538446,758538446,
sipa,2021-01-12 15:32:15,Current master will become 22.0. 0.21.0 will be out imminently.,https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-758737128,758737128,
Saibato,2021-01-12 17:02:21,"> 0.21.0 will be out imminently.\n\nrc6 anyway...?\n\nbtw we should skip 22 and 23 to obvious or misleading how about 24,0?",https://github.com/bitcoin/bitcoin/pull/19485#issuecomment-758799993,758799993,
