jnewbery,2017-04-18T20:18:00Z,"Thanks for the excellent review @jimmysong . I've responded to most of your points. I'm just running the extended test suite locally before pushing up to github.\n\nI've decided to remove the `sync()` method from NodeConnCB entirely for now, since it's just duplicating the functionality of `wait_until()` and doesn't actually need to be a method. I'm still not entirely happy with `wait_until()`, ",https://github.com/bitcoin/bitcoin/pull/10169#issuecomment-294967889,294967889,
jnewbery,2017-04-18T20:34:09Z,"rebased, review comments addressed and pushed",https://github.com/bitcoin/bitcoin/pull/10169#issuecomment-294972967,294972967,
jimmysong,2017-04-18T21:45:18Z,ACK 2a52ae63bfdde948250df1c876dcdd5af99f03b5,https://github.com/bitcoin/bitcoin/pull/10169#issuecomment-294992812,294992812,
jimmysong,2017-04-17T19:11:47Z,"This function seems to duplicate a lot of what `wait_until` above does. Maybe it makes sense to do something like:\n\n    def sync(self, test_function, timeout=60):\n        if not wait_until(test_function, timeout=timeout):\n            AssertionError(""Sync failed to complete"")\n",https://github.com/bitcoin/bitcoin/pull/10169#discussion_r111800001,111800001,test/functional/test_framework/mininode.py
jimmysong,2017-04-17T19:17:55Z,Also looks like it should use `self.sync` instead and maybe get rid of the `if not success` below.,https://github.com/bitcoin/bitcoin/pull/10169#discussion_r111801053,111801053,test/functional/test_framework/mininode.py
jimmysong,2017-04-17T19:22:12Z,"Any reason not to return the value like this?\n\n    return all(node.wait_for_verack() for node in self.test_nodes)\n\n",https://github.com/bitcoin/bitcoin/pull/10169#discussion_r111801707,111801707,test/functional/test_framework/comptool.py
jimmysong,2017-04-17T19:34:17Z,Any reason to get rid of this and the one 5 lines below? I expected `self.last_message.pop`.,https://github.com/bitcoin/bitcoin/pull/10169#discussion_r111803781,111803781,test/functional/sendheaders.py
jimmysong,2017-04-17T19:36:39Z,how about `getheaders`?,https://github.com/bitcoin/bitcoin/pull/10169#discussion_r111804160,111804160,test/functional/p2p-segwit.py
jimmysong,2017-04-17T19:39:43Z,Why did the constant change from 15000 to 15001?,https://github.com/bitcoin/bitcoin/pull/10169#discussion_r111804710,111804710,test/functional/p2p-feefilter.py
jimmysong,2017-04-17T19:41:36Z,"Please let me know if this is inappropriate, but the object attribute `set_announced_blockhashes` is a bit confusing. Would changing the name to something like `announced_blockhashes_set` be appropriate here?",https://github.com/bitcoin/bitcoin/pull/10169#discussion_r111805087,111805087,test/functional/p2p-compactblocks.py
jimmysong,2017-04-17T19:42:39Z,Why `pop` instead of `get` for the inv message?,https://github.com/bitcoin/bitcoin/pull/10169#discussion_r111805255,111805255,test/functional/p2p-compactblocks.py
jimmysong,2017-04-17T19:46:26Z,Am I correct in assuming you're creating 1 node instead of 3 because the other two aren't being used?,https://github.com/bitcoin/bitcoin/pull/10169#discussion_r111805963,111805963,test/functional/maxuploadtarget.py
jnewbery,2017-04-18T18:05:09Z,"correct. I was altering this line anyway, so I thought I'd optimize while I was here.",https://github.com/bitcoin/bitcoin/pull/10169#discussion_r112023795,112023795,test/functional/maxuploadtarget.py
jnewbery,2017-04-18T18:08:02Z,"Yes, agreed. Absolutely fine to point this out even though the variable name wasn't changed by this PR. I've gone ahead and changed it to `announced_blockhashes`. No need for the variable name to contain the name of the data structure.",https://github.com/bitcoin/bitcoin/pull/10169#discussion_r112024546,112024546,test/functional/p2p-compactblocks.py
jnewbery,2017-04-18T18:09:16Z,"bad search-and-replace I think. It doesn't really matter, since this block would only get executed if the assert failed, in which case the test case has failed. I've fixed it anyway.",https://github.com/bitcoin/bitcoin/pull/10169#discussion_r112024839,112024839,test/functional/p2p-compactblocks.py
jnewbery,2017-04-18T18:09:33Z,bah. My mistake. Fixed,https://github.com/bitcoin/bitcoin/pull/10169#discussion_r112024907,112024907,test/functional/p2p-feefilter.py
jnewbery,2017-04-18T18:12:40Z,Yes. My mistake. Fixed,https://github.com/bitcoin/bitcoin/pull/10169#discussion_r112025814,112025814,test/functional/p2p-segwit.py
jnewbery,2017-04-18T18:16:22Z,"because we're never testing `last_getheaders` after this, so these lines are just setting a variable that never gets used.",https://github.com/bitcoin/bitcoin/pull/10169#discussion_r112026717,112026717,test/functional/sendheaders.py
jnewbery,2017-04-18T18:18:02Z,"yes, that's much better. Changed, thanks.",https://github.com/bitcoin/bitcoin/pull/10169#discussion_r112027098,112027098,test/functional/test_framework/comptool.py
jimmysong,2017-04-18T21:03:45Z,makes sense.,https://github.com/bitcoin/bitcoin/pull/10169#discussion_r112063492,112063492,test/functional/sendheaders.py
jimmysong,2017-04-18T21:08:06Z,I don't see this yet? Maybe missing a changeset or I'm missing something?,https://github.com/bitcoin/bitcoin/pull/10169#discussion_r112064436,112064436,test/functional/p2p-feefilter.py
jnewbery,2017-04-18T21:20:44Z,argh! Fixed now,https://github.com/bitcoin/bitcoin/pull/10169#discussion_r112067269,112067269,test/functional/p2p-feefilter.py
MarcoFalke,2017-05-02T18:26:16Z,@jnewbery Can you explain why the second operand is `!=` and not `==`?,https://github.com/bitcoin/bitcoin/pull/10169#discussion_r114389770,114389770,test/functional/test_framework/mininode.py
jnewbery,2017-05-02T20:37:50Z,"This was a code move from p2p-segwit.py to here, but you're right that this is a bug.\n\nFix here: #10318",https://github.com/bitcoin/bitcoin/pull/10169#discussion_r114419023,114419023,test/functional/test_framework/mininode.py
