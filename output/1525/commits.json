[
  {
    "sha": "e69a7979901d1df8f0d90fcd4e1a21eb1fd38602",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzplNjlhNzk3OTkwMWQxZGY4ZjBkOTBmY2Q0ZTFhMjFlYjFmZDM4NjAy",
    "commit": {
      "author": {
        "name": "R E Broadley",
        "email": "rebroad+github@gmail.com",
        "date": "2012-05-14T18:39:50Z"
      },
      "committer": {
        "name": "R E Broadley",
        "email": "rebroad+github@gmail.com",
        "date": "2012-05-29T19:11:37Z"
      },
      "message": "Show the timestamp for the block.\n\nwrap lines",
      "tree": {
        "sha": "d576e0ad79d5f222fed90eac439569958624cbec",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d576e0ad79d5f222fed90eac439569958624cbec"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/e69a7979901d1df8f0d90fcd4e1a21eb1fd38602",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e69a7979901d1df8f0d90fcd4e1a21eb1fd38602",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/e69a7979901d1df8f0d90fcd4e1a21eb1fd38602",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e69a7979901d1df8f0d90fcd4e1a21eb1fd38602/comments",
    "author": {
      "login": "rebroad",
      "id": 1530283,
      "node_id": "MDQ6VXNlcjE1MzAyODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1530283?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rebroad",
      "html_url": "https://github.com/rebroad",
      "followers_url": "https://api.github.com/users/rebroad/followers",
      "following_url": "https://api.github.com/users/rebroad/following{/other_user}",
      "gists_url": "https://api.github.com/users/rebroad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rebroad/subscriptions",
      "organizations_url": "https://api.github.com/users/rebroad/orgs",
      "repos_url": "https://api.github.com/users/rebroad/repos",
      "events_url": "https://api.github.com/users/rebroad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rebroad/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "rebroad",
      "id": 1530283,
      "node_id": "MDQ6VXNlcjE1MzAyODM=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1530283?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/rebroad",
      "html_url": "https://github.com/rebroad",
      "followers_url": "https://api.github.com/users/rebroad/followers",
      "following_url": "https://api.github.com/users/rebroad/following{/other_user}",
      "gists_url": "https://api.github.com/users/rebroad/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/rebroad/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/rebroad/subscriptions",
      "organizations_url": "https://api.github.com/users/rebroad/orgs",
      "repos_url": "https://api.github.com/users/rebroad/repos",
      "events_url": "https://api.github.com/users/rebroad/events{/privacy}",
      "received_events_url": "https://api.github.com/users/rebroad/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "f6521b66f7d4e7c3d55e0fd1d006fd6311afc18f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f6521b66f7d4e7c3d55e0fd1d006fd6311afc18f",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/f6521b66f7d4e7c3d55e0fd1d006fd6311afc18f"
      }
    ],
    "stats": {
      "total": 17,
      "additions": 13,
      "deletions": 4
    },
    "files": [
      {
        "sha": "2928eff0063db8613fe4f12934eb67bc2dee9362",
        "filename": "src/db.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 1,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e69a7979901d1df8f0d90fcd4e1a21eb1fd38602/src/db.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e69a7979901d1df8f0d90fcd4e1a21eb1fd38602/src/db.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/db.cpp?ref=e69a7979901d1df8f0d90fcd4e1a21eb1fd38602",
        "patch": "@@ -570,7 +570,9 @@ bool CTxDB::LoadBlockIndex()\n     pindexBest = mapBlockIndex[hashBestChain];\n     nBestHeight = pindexBest->nHeight;\n     bnBestChainWork = pindexBest->bnChainWork;\n-    printf(\"LoadBlockIndex(): hashBestChain=%s  height=%d\\n\", hashBestChain.ToString().substr(0,20).c_str(), nBestHeight);\n+    printf(\"LoadBlockIndex(): hashBestChain=%s  height=%d  date=%s\\n\",\n+      hashBestChain.ToString().substr(0,20).c_str(), nBestHeight,\n+      DateTimeStrFormat(\"%x %H:%M:%S\", pindexBest->GetBlockTime()).c_str());\n \n     // Load bnBestInvalidWork, OK if it doesn't exist\n     ReadBestInvalidWork(bnBestInvalidWork);"
      },
      {
        "sha": "8de01c1a6ca375c730bf1bff515631455c85328c",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 10,
        "deletions": 3,
        "changes": 13,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/e69a7979901d1df8f0d90fcd4e1a21eb1fd38602/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/e69a7979901d1df8f0d90fcd4e1a21eb1fd38602/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=e69a7979901d1df8f0d90fcd4e1a21eb1fd38602",
        "patch": "@@ -962,8 +962,13 @@ void static InvalidChainFound(CBlockIndex* pindexNew)\n         CTxDB().WriteBestInvalidWork(bnBestInvalidWork);\n         uiInterface.NotifyBlocksChanged();\n     }\n-    printf(\"InvalidChainFound: invalid block=%s  height=%d  work=%s\\n\", pindexNew->GetBlockHash().ToString().substr(0,20).c_str(), pindexNew->nHeight, pindexNew->bnChainWork.ToString().c_str());\n-    printf(\"InvalidChainFound:  current best=%s  height=%d  work=%s\\n\", hashBestChain.ToString().substr(0,20).c_str(), nBestHeight, bnBestChainWork.ToString().c_str());\n+    printf(\"InvalidChainFound: invalid block=%s  height=%d  work=%s  date=%s\\n\",\n+      pindexNew->GetBlockHash().ToString().substr(0,20).c_str(), pindexNew->nHeight,\n+      pindexNew->bnChainWork.ToString().c_str(), DateTimeStrFormat(\"%x %H:%M:%S\",\n+      pindexNew->GetBlockTime()).c_str());\n+    printf(\"InvalidChainFound:  current best=%s  height=%d  work=%s  date=%s\\n\",\n+      hashBestChain.ToString().substr(0,20).c_str(), nBestHeight, bnBestChainWork.ToString().c_str(),\n+      DateTimeStrFormat(\"%x %H:%M:%S\", pindexBest->GetBlockTime()).c_str());\n     if (pindexBest && bnBestInvalidWork > bnBestChainWork + pindexBest->GetBlockWork() * 6)\n         printf(\"InvalidChainFound: WARNING: Displayed transactions may not be correct!  You may need to upgrade, or other nodes may need to upgrade.\\n\");\n }\n@@ -1606,7 +1611,9 @@ bool CBlock::SetBestChain(CTxDB& txdb, CBlockIndex* pindexNew)\n     bnBestChainWork = pindexNew->bnChainWork;\n     nTimeBestReceived = GetTime();\n     nTransactionsUpdated++;\n-    printf(\"SetBestChain: new best=%s  height=%d  work=%s\\n\", hashBestChain.ToString().substr(0,20).c_str(), nBestHeight, bnBestChainWork.ToString().c_str());\n+    printf(\"SetBestChain: new best=%s  height=%d  work=%s  date=%s\\n\",\n+      hashBestChain.ToString().substr(0,20).c_str(), nBestHeight, bnBestChainWork.ToString().c_str(),\n+      DateTimeStrFormat(\"%x %H:%M:%S\", pindexBest->GetBlockTime()).c_str());\n \n     std::string strCmd = GetArg(\"-blocknotify\", \"\");\n "
      }
    ]
  },
  {
    "sha": "39471861d59866f7f2abadc27ed139b3eecca236",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozOTQ3MTg2MWQ1OTg2NmY3ZjJhYmFkYzI3ZWQxMzliM2VlY2NhMjM2",
    "commit": {
      "author": {
        "name": "Matt Corallo",
        "email": "matt@bluematt.me",
        "date": "2012-06-09T23:50:54Z"
      },
      "committer": {
        "name": "Matt Corallo",
        "email": "matt@bluematt.me",
        "date": "2012-06-15T15:15:37Z"
      },
      "message": "Upgrade to Boost 1.49 on Win32",
      "tree": {
        "sha": "aa00a1c3ed688447efb66a193dbcb1775dd97ffe",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/aa00a1c3ed688447efb66a193dbcb1775dd97ffe"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/39471861d59866f7f2abadc27ed139b3eecca236",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/39471861d59866f7f2abadc27ed139b3eecca236",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/39471861d59866f7f2abadc27ed139b3eecca236",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/39471861d59866f7f2abadc27ed139b3eecca236/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "194ea3186a3331768650629826a9c6db6db84e82",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/194ea3186a3331768650629826a9c6db6db84e82",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/194ea3186a3331768650629826a9c6db6db84e82"
      }
    ],
    "stats": {
      "total": 34,
      "additions": 17,
      "deletions": 17
    },
    "files": [
      {
        "sha": "2af91d1edb8f1dffa96b5271c16ee8b1fdc4a230",
        "filename": "contrib/gitian-descriptors/boost-win32.yml",
        "status": "modified",
        "additions": 5,
        "deletions": 5,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/39471861d59866f7f2abadc27ed139b3eecca236/contrib/gitian-descriptors/boost-win32.yml",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/39471861d59866f7f2abadc27ed139b3eecca236/contrib/gitian-descriptors/boost-win32.yml",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/gitian-descriptors/boost-win32.yml?ref=39471861d59866f7f2abadc27ed139b3eecca236",
        "patch": "@@ -11,12 +11,12 @@ packages:\n reference_datetime: \"2011-01-30 00:00:00\"\n remotes: []\n files:\n-- \"boost_1_47_0.tar.bz2\"\n+- \"boost_1_49_0.tar.bz2\"\n script: |\n   TMPDIR=\"$HOME/tmpdir\"\n   mkdir -p $TMPDIR/bin/$GBUILD_BITS $TMPDIR/include\n-  tar xjf boost_1_47_0.tar.bz2\n-  cd boost_1_47_0\n+  tar xjf boost_1_49_0.tar.bz2\n+  cd boost_1_49_0\n   echo \"using gcc : 4.4 : i586-mingw32msvc-g++\n         :\n         <rc>i586-mingw32msvc-windres\n@@ -34,5 +34,5 @@ script: |\n   cd $TMPDIR\n   export LD_PRELOAD=/usr/lib/faketime/libfaketime.so.1\n   export FAKETIME=$REFERENCE_DATETIME\n-  zip -r boost-win32-1.47.0-gitian.zip *\n-  cp boost-win32-1.47.0-gitian.zip $OUTDIR\n+  zip -r boost-win32-1.49.0-gitian.zip *\n+  cp boost-win32-1.49.0-gitian.zip $OUTDIR"
      },
      {
        "sha": "21b03b3873f64f70d2a19e3f4d14bfa2c8250627",
        "filename": "contrib/gitian-descriptors/gitian-win32.yml",
        "status": "modified",
        "additions": 4,
        "deletions": 4,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/39471861d59866f7f2abadc27ed139b3eecca236/contrib/gitian-descriptors/gitian-win32.yml",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/39471861d59866f7f2abadc27ed139b3eecca236/contrib/gitian-descriptors/gitian-win32.yml",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/gitian-descriptors/gitian-win32.yml?ref=39471861d59866f7f2abadc27ed139b3eecca236",
        "patch": "@@ -16,7 +16,7 @@ remotes:\n   \"dir\": \"bitcoin\"\n files:\n - \"qt-win32-4.7.4-gitian.zip\"\n-- \"boost-win32-1.47.0-gitian.zip\"\n+- \"boost-win32-1.49.0-gitian.zip\"\n - \"bitcoin-deps-0.0.4.zip\"\n script: |\n   #\n@@ -26,10 +26,10 @@ script: |\n   cd $HOME/build/\n   export PATH=$PATH:$HOME/qt/bin/\n   #\n-  mkdir boost_1_47_0\n-  cd boost_1_47_0\n+  mkdir boost_1_49_0\n+  cd boost_1_49_0\n   mkdir -p stage/lib\n-  unzip ../boost-win32-1.47.0-gitian.zip\n+  unzip ../boost-win32-1.49.0-gitian.zip\n   cd bin/$GBUILD_BITS\n   for lib in *; do\n     i586-mingw32msvc-ar rc ../../stage/lib/libboost_${lib}-mt-s.a $lib/*.o"
      },
      {
        "sha": "3e7b301cad5badfec9c8d33784e1123928e8536d",
        "filename": "src/makefile.linux-mingw",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/39471861d59866f7f2abadc27ed139b3eecca236/src/makefile.linux-mingw",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/39471861d59866f7f2abadc27ed139b3eecca236/src/makefile.linux-mingw",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/makefile.linux-mingw?ref=39471861d59866f7f2abadc27ed139b3eecca236",
        "patch": "@@ -7,14 +7,14 @@ DEPSDIR:=/usr/i586-mingw32msvc\n USE_UPNP:=0\n \n INCLUDEPATHS= \\\n- -I\"$(DEPSDIR)/boost_1_47_0\" \\\n+ -I\"$(DEPSDIR)/boost_1_49_0\" \\\n  -I\"$(DEPSDIR)/db-4.8.30.NC/build_unix\" \\\n  -I\"$(DEPSDIR)/openssl-1.0.1b/include\" \\\n  -I\"$(DEPSDIR)\" \\\n  -I\"$(CURDIR)\"/obj \\\n \n LIBPATHS= \\\n- -L\"$(DEPSDIR)/boost_1_47_0/stage/lib\" \\\n+ -L\"$(DEPSDIR)/boost_1_49_0/stage/lib\" \\\n  -L\"$(DEPSDIR)/db-4.8.30.NC/build_unix\" \\\n  -L\"$(DEPSDIR)/openssl-1.0.1b\"\n "
      },
      {
        "sha": "92dfa3b164d692e4ef0907bfdeaa7b6cfcc5abd7",
        "filename": "src/makefile.mingw",
        "status": "modified",
        "additions": 6,
        "deletions": 6,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/39471861d59866f7f2abadc27ed139b3eecca236/src/makefile.mingw",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/39471861d59866f7f2abadc27ed139b3eecca236/src/makefile.mingw",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/makefile.mingw?ref=39471861d59866f7f2abadc27ed139b3eecca236",
        "patch": "@@ -5,20 +5,20 @@\n USE_UPNP:=0\n \n INCLUDEPATHS= \\\n- -I\"C:\\boost-1.47.0-mgw\" \\\n+ -I\"C:\\boost-1.49.0-mgw\" \\\n  -I\"C:\\db-4.8.30.NC-mgw\\build_unix\" \\\n  -I\"C:\\openssl-1.0.0d-mgw\\include\"\n \n LIBPATHS= \\\n- -L\"C:\\boost-1.47.0-mgw\\stage\\lib\" \\\n+ -L\"C:\\boost-1.49.0-mgw\\stage\\lib\" \\\n  -L\"C:\\db-4.8.30.NC-mgw\\build_unix\" \\\n  -L\"C:\\openssl-1.0.0d-mgw\"\n \n LIBS= \\\n- -l boost_system-mgw45-mt-s-1_47 \\\n- -l boost_filesystem-mgw45-mt-s-1_47 \\\n- -l boost_program_options-mgw45-mt-s-1_47 \\\n- -l boost_thread-mgw45-mt-s-1_47 \\\n+ -l boost_system-mgw45-mt-s-1_49 \\\n+ -l boost_filesystem-mgw45-mt-s-1_49 \\\n+ -l boost_program_options-mgw45-mt-s-1_49 \\\n+ -l boost_thread-mgw45-mt-s-1_49 \\\n  -l db_cxx \\\n  -l ssl \\\n  -l crypto"
      }
    ]
  },
  {
    "sha": "1d42878adb5809218b1f329221ef46121674cb1a",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoxZDQyODc4YWRiNTgwOTIxOGIxZjMyOTIyMWVmNDYxMjE2NzRjYjFh",
    "commit": {
      "author": {
        "name": "Matt Corallo",
        "email": "matt@bluematt.me",
        "date": "2012-03-25T20:17:39Z"
      },
      "committer": {
        "name": "Matt Corallo",
        "email": "matt@bluematt.me",
        "date": "2012-06-15T15:19:09Z"
      },
      "message": "Fix #956 the Boost 1.49 way.",
      "tree": {
        "sha": "bcb8a3e781b882061f9c312e999011894402e251",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/bcb8a3e781b882061f9c312e999011894402e251"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/1d42878adb5809218b1f329221ef46121674cb1a",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1d42878adb5809218b1f329221ef46121674cb1a",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/1d42878adb5809218b1f329221ef46121674cb1a",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1d42878adb5809218b1f329221ef46121674cb1a/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "39471861d59866f7f2abadc27ed139b3eecca236",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/39471861d59866f7f2abadc27ed139b3eecca236",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/39471861d59866f7f2abadc27ed139b3eecca236"
      }
    ],
    "stats": {
      "total": 29,
      "additions": 25,
      "deletions": 4
    },
    "files": [
      {
        "sha": "d9a0bed539b0d701734e0d48762e40df7c6ae76c",
        "filename": "contrib/gitian-descriptors/boost-win32.yml",
        "status": "modified",
        "additions": 18,
        "deletions": 2,
        "changes": 20,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1d42878adb5809218b1f329221ef46121674cb1a/contrib/gitian-descriptors/boost-win32.yml",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1d42878adb5809218b1f329221ef46121674cb1a/contrib/gitian-descriptors/boost-win32.yml",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/gitian-descriptors/boost-win32.yml?ref=1d42878adb5809218b1f329221ef46121674cb1a",
        "patch": "@@ -17,6 +17,22 @@ script: |\n   mkdir -p $TMPDIR/bin/$GBUILD_BITS $TMPDIR/include\n   tar xjf boost_1_49_0.tar.bz2\n   cd boost_1_49_0\n+  echo \"--- tmp_dir_helpers.orig.hpp\t2012-06-10 01:39:25.403268210 +0200\n++++ tmp_dir_helpers.hpp\t2012-06-10 01:41:14.653823479 +0200\n+@@ -19,9 +19,9 @@\n+ #include <string>\n+ \n+ #if defined(BOOST_INTERPROCESS_WINDOWS)\n+-   //#define BOOST_INTERPROCESS_HAS_WINDOWS_KERNEL_BOOTTIME\n+-   //#define BOOST_INTERPROCESS_HAS_KERNEL_BOOTTIME\n+-   //#include <boost/interprocess/detail/win32_api.hpp>\n++   #define BOOST_INTERPROCESS_HAS_WINDOWS_KERNEL_BOOTTIME\n++   #define BOOST_INTERPROCESS_HAS_KERNEL_BOOTTIME\n++   #include <boost/interprocess/detail/win32_api.hpp>\n+ #elif defined(__FreeBSD__) || defined(__NetBSD__) || defined(__OpenBSD__) || defined(__APPLE__)\n+    //#include <sys/sysctl.h>\n+    //#if defined(CTL_KERN) && defined (KERN_BOOTTIME)\" > useboottime.patch\n+  patch boost/interprocess/detail/tmp_dir_helpers.hpp useboottime.patch\n   echo \"using gcc : 4.4 : i586-mingw32msvc-g++\n         :\n         <rc>i586-mingw32msvc-windres\n@@ -34,5 +50,5 @@ script: |\n   cd $TMPDIR\n   export LD_PRELOAD=/usr/lib/faketime/libfaketime.so.1\n   export FAKETIME=$REFERENCE_DATETIME\n-  zip -r boost-win32-1.49.0-gitian.zip *\n-  cp boost-win32-1.49.0-gitian.zip $OUTDIR\n+  zip -r boost-win32-1.49.0-gitian2.zip *\n+  cp boost-win32-1.49.0-gitian2.zip $OUTDIR"
      },
      {
        "sha": "6e2eff15f3ecd95b7399e88f91aad8568a9aacb6",
        "filename": "contrib/gitian-descriptors/gitian-win32.yml",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1d42878adb5809218b1f329221ef46121674cb1a/contrib/gitian-descriptors/gitian-win32.yml",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1d42878adb5809218b1f329221ef46121674cb1a/contrib/gitian-descriptors/gitian-win32.yml",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/gitian-descriptors/gitian-win32.yml?ref=1d42878adb5809218b1f329221ef46121674cb1a",
        "patch": "@@ -16,7 +16,7 @@ remotes:\n   \"dir\": \"bitcoin\"\n files:\n - \"qt-win32-4.7.4-gitian.zip\"\n-- \"boost-win32-1.49.0-gitian.zip\"\n+- \"boost-win32-1.49.0-gitian2.zip\"\n - \"bitcoin-deps-0.0.4.zip\"\n script: |\n   #\n@@ -29,7 +29,7 @@ script: |\n   mkdir boost_1_49_0\n   cd boost_1_49_0\n   mkdir -p stage/lib\n-  unzip ../boost-win32-1.49.0-gitian.zip\n+  unzip ../boost-win32-1.49.0-gitian2.zip\n   cd bin/$GBUILD_BITS\n   for lib in *; do\n     i586-mingw32msvc-ar rc ../../stage/lib/libboost_${lib}-mt-s.a $lib/*.o"
      },
      {
        "sha": "2ffc20c2ecb892ec6990b691c34e5455db5350de",
        "filename": "src/qt/qtipcserver.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 0,
        "changes": 5,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/1d42878adb5809218b1f329221ef46121674cb1a/src/qt/qtipcserver.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/1d42878adb5809218b1f329221ef46121674cb1a/src/qt/qtipcserver.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/qtipcserver.cpp?ref=1d42878adb5809218b1f329221ef46121674cb1a",
        "patch": "@@ -6,6 +6,11 @@\n #include <boost/interprocess/ipc/message_queue.hpp>\n #include <boost/tokenizer.hpp>\n #include <boost/date_time/posix_time/posix_time.hpp>\n+#include <boost/version.hpp>\n+\n+#if defined(WIN32) && (!defined(BOOST_INTERPROCESS_HAS_WINDOWS_KERNEL_BOOTTIME) || !defined(BOOST_INTERPROCESS_HAS_KERNEL_BOOTTIME) || BOOST_VERSION < 104900)\n+#warning Compiling without BOOST_INTERPROCESS_HAS_WINDOWS_KERNEL_BOOTTIME and BOOST_INTERPROCESS_HAS_KERNEL_BOOTTIME uncommented in boost/interprocess/detail/tmp_dir_helpers.hpp or using a boost version before 1.49 may have unintended results see svn.boost.org/trac/boost/ticket/5392\n+#endif\n \n #include \"ui_interface.h\"\n #include \"qtipcserver.h\""
      }
    ]
  },
  {
    "sha": "ad5f29b7437fbdf6b25c4a5823b3dea0ac68b3ff",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphZDVmMjliNzQzN2ZiZGY2YjI1YzRhNTgyM2IzZGVhMGFjNjhiM2Zm",
    "commit": {
      "author": {
        "name": "Matt Corallo",
        "email": "matt@bluematt.me",
        "date": "2012-06-10T00:04:15Z"
      },
      "committer": {
        "name": "Matt Corallo",
        "email": "matt@bluematt.me",
        "date": "2012-06-15T15:19:13Z"
      },
      "message": "Revert \"Disable bitcoin: URI handling on Windows for the 0.6 release\"\n\nThis reverts commit 7b90edb5a6cada7176012d09d748847b5f966585.",
      "tree": {
        "sha": "e8d4c45447a5e2f70488b907541c81e88108930c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/e8d4c45447a5e2f70488b907541c81e88108930c"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/ad5f29b7437fbdf6b25c4a5823b3dea0ac68b3ff",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ad5f29b7437fbdf6b25c4a5823b3dea0ac68b3ff",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/ad5f29b7437fbdf6b25c4a5823b3dea0ac68b3ff",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ad5f29b7437fbdf6b25c4a5823b3dea0ac68b3ff/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "1d42878adb5809218b1f329221ef46121674cb1a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/1d42878adb5809218b1f329221ef46121674cb1a",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/1d42878adb5809218b1f329221ef46121674cb1a"
      }
    ],
    "stats": {
      "total": 24,
      "additions": 5,
      "deletions": 19
    },
    "files": [
      {
        "sha": "c0bc880a5675b0a451a408c8ac1f85392b6d446f",
        "filename": "share/setup.nsi",
        "status": "modified",
        "additions": 4,
        "deletions": 6,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ad5f29b7437fbdf6b25c4a5823b3dea0ac68b3ff/share/setup.nsi",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ad5f29b7437fbdf6b25c4a5823b3dea0ac68b3ff/share/setup.nsi",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/share/setup.nsi?ref=ad5f29b7437fbdf6b25c4a5823b3dea0ac68b3ff",
        "patch": "@@ -98,12 +98,10 @@ Section -post SEC0001\n     WriteRegStr HKCU \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\$(^Name)\" UninstallString $INSTDIR\\uninstall.exe\r\n     WriteRegDWORD HKCU \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\$(^Name)\" NoModify 1\r\n     WriteRegDWORD HKCU \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\$(^Name)\" NoRepair 1\r\n-\r\n-    # bitcoin: URI handling disabled for 0.6.0\r\n-    #    WriteRegStr HKCR \"bitcoin\" \"URL Protocol\" \"\"\r\n-    #    WriteRegStr HKCR \"bitcoin\" \"\" \"URL:Bitcoin\"\r\n-    #    WriteRegStr HKCR \"bitcoin\\DefaultIcon\" \"\" $INSTDIR\\bitcoin-qt.exe\r\n-    #    WriteRegStr HKCR \"bitcoin\\shell\\open\\command\" \"\" '\"$INSTDIR\\bitcoin-qt.exe\" \"$$1\"'\r\n+    WriteRegStr HKCR \"bitcoin\" \"URL Protocol\" \"\"\r\n+    WriteRegStr HKCR \"bitcoin\" \"\" \"URL:Bitcoin\"\r\n+    WriteRegStr HKCR \"bitcoin\\DefaultIcon\" \"\" $INSTDIR\\bitcoin-qt.exe\r\n+    WriteRegStr HKCR \"bitcoin\\shell\\open\\command\" \"\" '\"$INSTDIR\\bitcoin-qt.exe\" \"$$1\"'\r\n SectionEnd\r\n \r\n # Macro for selecting uninstaller sections\r"
      },
      {
        "sha": "bac6dc4ce36cd53a8631c466d6634ac2f0ffc072",
        "filename": "src/qt/bitcoin.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 7,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ad5f29b7437fbdf6b25c4a5823b3dea0ac68b3ff/src/qt/bitcoin.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ad5f29b7437fbdf6b25c4a5823b3dea0ac68b3ff/src/qt/bitcoin.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoin.cpp?ref=ad5f29b7437fbdf6b25c4a5823b3dea0ac68b3ff",
        "patch": "@@ -116,9 +116,6 @@ static void handleRunawayException(std::exception *e)\n #ifndef BITCOIN_QT_TEST\n int main(int argc, char *argv[])\n {\n-#if !defined(MAC_OSX) && !defined(WIN32)\n-// TODO: implement qtipcserver.cpp for Mac and Windows\n-\n     // Do this early as we don't want to bother initializing if we are just calling IPC\n     for (int i = 1; i < argc; i++)\n     {\n@@ -137,7 +134,6 @@ int main(int argc, char *argv[])\n             }\n         }\n     }\n-#endif\n \n     // Internal string conversion is all UTF-8\n     QTextCodec::setCodecForTr(QTextCodec::codecForName(\"UTF-8\"));\n@@ -262,8 +258,6 @@ int main(int argc, char *argv[])\n                 {\n                     window.show();\n                 }\n-#if !defined(MAC_OSX) && !defined(WIN32)\n-// TODO: implement qtipcserver.cpp for Mac and Windows\n \n                 // Place this here as guiref has to be defined if we dont want to lose URIs\n                 ipcInit();\n@@ -282,7 +276,7 @@ int main(int argc, char *argv[])\n                         }\n                     }\n                 }\n-#endif\n+\n                 app.exec();\n \n                 window.hide();"
      },
      {
        "sha": "a887456855fcdda80942eaf27ef66a8b3d32f616",
        "filename": "src/qt/qtipcserver.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 6,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/ad5f29b7437fbdf6b25c4a5823b3dea0ac68b3ff/src/qt/qtipcserver.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/ad5f29b7437fbdf6b25c4a5823b3dea0ac68b3ff/src/qt/qtipcserver.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/qtipcserver.cpp?ref=ad5f29b7437fbdf6b25c4a5823b3dea0ac68b3ff",
        "patch": "@@ -54,12 +54,6 @@ void ipcInit()\n     // TODO: implement bitcoin: URI handling the Mac Way\n     return;\n #endif\n-#ifdef WIN32\n-    // TODO: THOROUGHLY test boost::interprocess fix,\n-    // and make sure there are no Windows argument-handling exploitable\n-    // problems.\n-    return;\n-#endif\n \n     message_queue* mq;\n     char strBuf[257];"
      }
    ]
  },
  {
    "sha": "4d9c55da72e2bcf40f79a9d818dcef04e8308b35",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo0ZDljNTVkYTcyZTJiY2Y0MGY3OWE5ZDgxOGRjZWYwNGU4MzA4YjM1",
    "commit": {
      "author": {
        "name": "Matt Corallo",
        "email": "matt@bluematt.me",
        "date": "2012-07-03T15:30:43Z"
      },
      "committer": {
        "name": "Matt Corallo",
        "email": "matt@bluematt.me",
        "date": "2012-07-03T15:50:35Z"
      },
      "message": "Work around a distcc bug where -MMD output isn't copied.",
      "tree": {
        "sha": "a358bb48c256284cccd03f0b6f135c343752579a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/a358bb48c256284cccd03f0b6f135c343752579a"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/4d9c55da72e2bcf40f79a9d818dcef04e8308b35",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4d9c55da72e2bcf40f79a9d818dcef04e8308b35",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/4d9c55da72e2bcf40f79a9d818dcef04e8308b35",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4d9c55da72e2bcf40f79a9d818dcef04e8308b35/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "da1103f4f8288cffc9ea475254fdeb258f04de77",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/da1103f4f8288cffc9ea475254fdeb258f04de77",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/da1103f4f8288cffc9ea475254fdeb258f04de77"
      }
    ],
    "stats": {
      "total": 8,
      "additions": 4,
      "deletions": 4
    },
    "files": [
      {
        "sha": "44e648d677ac5d131efd818bdb2ae99601637201",
        "filename": "src/makefile.osx",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4d9c55da72e2bcf40f79a9d818dcef04e8308b35/src/makefile.osx",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4d9c55da72e2bcf40f79a9d818dcef04e8308b35/src/makefile.osx",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/makefile.osx?ref=4d9c55da72e2bcf40f79a9d818dcef04e8308b35",
        "patch": "@@ -113,7 +113,7 @@ version.cpp: obj/build.h\n DEFS += -DHAVE_BUILD_INFO\n \n obj/%.o: %.cpp\n-\t$(CXX) -c $(CFLAGS) -MMD -o $@ $<\n+\t$(CXX) -c $(CFLAGS) -MMD -MF $(@:%.o=%.d) -o $@ $<\n \t@cp $(@:%.o=%.d) $(@:%.o=%.P); \\\n \t  sed -e 's/#.*//' -e 's/^[^:]*: *//' -e 's/ *\\\\$$//' \\\n \t      -e '/^$$/ d' -e 's/$$/ :/' < $(@:%.o=%.d) >> $(@:%.o=%.P); \\\n@@ -125,7 +125,7 @@ bitcoind: $(OBJS:obj/%=obj/%)\n TESTOBJS := $(patsubst test/%.cpp,obj-test/%.o,$(wildcard test/*.cpp))\n \n obj-test/%.o: test/%.cpp\n-\t$(CXX) -c $(TESTDEFS) $(CFLAGS) -MMD -o $@ $<\n+\t$(CXX) -c $(TESTDEFS) $(CFLAGS) -MMD -MF $(@:%.o=%.d) -o $@ $<\n \t@cp $(@:%.o=%.d) $(@:%.o=%.P); \\\n \t  sed -e 's/#.*//' -e 's/^[^:]*: *//' -e 's/ *\\\\$$//' \\\n \t      -e '/^$$/ d' -e 's/$$/ :/' < $(@:%.o=%.d) >> $(@:%.o=%.P); \\"
      },
      {
        "sha": "6d9bf276dfeb59508e4dcc9335ca665d43043696",
        "filename": "src/makefile.unix",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/4d9c55da72e2bcf40f79a9d818dcef04e8308b35/src/makefile.unix",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/4d9c55da72e2bcf40f79a9d818dcef04e8308b35/src/makefile.unix",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/makefile.unix?ref=4d9c55da72e2bcf40f79a9d818dcef04e8308b35",
        "patch": "@@ -125,7 +125,7 @@ version.cpp: obj/build.h\n DEFS += -DHAVE_BUILD_INFO\n \n obj/%.o: %.cpp\n-\t$(CXX) -c $(xCXXFLAGS) -MMD -o $@ $<\n+\t$(CXX) -c $(xCXXFLAGS) -MMD -MF $(@:%.o=%.d) -o $@ $<\n \t@cp $(@:%.o=%.d) $(@:%.o=%.P); \\\n \t  sed -e 's/#.*//' -e 's/^[^:]*: *//' -e 's/ *\\\\$$//' \\\n \t      -e '/^$$/ d' -e 's/$$/ :/' < $(@:%.o=%.d) >> $(@:%.o=%.P); \\\n@@ -137,7 +137,7 @@ bitcoind: $(OBJS:obj/%=obj/%)\n TESTOBJS := $(patsubst test/%.cpp,obj-test/%.o,$(wildcard test/*.cpp))\n \n obj-test/%.o: test/%.cpp\n-\t$(CXX) -c $(TESTDEFS) $(xCXXFLAGS) -MMD -o $@ $<\n+\t$(CXX) -c $(TESTDEFS) $(xCXXFLAGS) -MMD -MF $(@:%.o=%.d) -o $@ $<\n \t@cp $(@:%.o=%.d) $(@:%.o=%.P); \\\n \t  sed -e 's/#.*//' -e 's/^[^:]*: *//' -e 's/ *\\\\$$//' \\\n \t      -e '/^$$/ d' -e 's/$$/ :/' < $(@:%.o=%.d) >> $(@:%.o=%.P); \\"
      }
    ]
  },
  {
    "sha": "96929a5515bb0ffee67aab7283b5ae9fcc1641d5",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo5NjkyOWE1NTE1YmIwZmZlZTY3YWFiNzI4M2I1YWU5ZmNjMTY0MWQ1",
    "commit": {
      "author": {
        "name": "Matt Corallo",
        "email": "matt@bluematt.me",
        "date": "2012-07-04T04:04:57Z"
      },
      "committer": {
        "name": "Jeff Garzik",
        "email": "jgarzik@redhat.com",
        "date": "2012-07-04T04:04:57Z"
      },
      "message": "Remove duplicate GetHash() in ConnectBlock",
      "tree": {
        "sha": "66215f6328fd1a9fc6cc6c5d0a8b847b6b4653ce",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/66215f6328fd1a9fc6cc6c5d0a8b847b6b4653ce"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/96929a5515bb0ffee67aab7283b5ae9fcc1641d5",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/96929a5515bb0ffee67aab7283b5ae9fcc1641d5",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/96929a5515bb0ffee67aab7283b5ae9fcc1641d5",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/96929a5515bb0ffee67aab7283b5ae9fcc1641d5/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "c729dbb6d2b63d9c0b32e3937be0ebf528d4c753",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c729dbb6d2b63d9c0b32e3937be0ebf528d4c753",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/c729dbb6d2b63d9c0b32e3937be0ebf528d4c753"
      }
    ],
    "stats": {
      "total": 28,
      "additions": 14,
      "deletions": 14
    },
    "files": [
      {
        "sha": "c1ca96bfd2f2a82b53aea015aa6f74bfbcc76f75",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 14,
        "deletions": 14,
        "changes": 28,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/96929a5515bb0ffee67aab7283b5ae9fcc1641d5/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/96929a5515bb0ffee67aab7283b5ae9fcc1641d5/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=96929a5515bb0ffee67aab7283b5ae9fcc1641d5",
        "patch": "@@ -1325,19 +1325,8 @@ bool CBlock::ConnectBlock(CTxDB& txdb, CBlockIndex* pindex)\n     // This logic is not necessary for memory pool transactions, as AcceptToMemoryPool\n     // already refuses previously-known transaction id's entirely.\n     // This rule applies to all blocks whose timestamp is after March 15, 2012, 0:00 UTC.\n-    if (pindex->nTime > 1331769600)\n-    {\n-        BOOST_FOREACH(CTransaction& tx, vtx)\n-        {\n-            CTxIndex txindexOld;\n-            if (txdb.ReadTxIndex(tx.GetHash(), txindexOld))\n-            {\n-                BOOST_FOREACH(CDiskTxPos &pos, txindexOld.vSpent)\n-                    if (pos.IsNull())\n-                        return false;\n-            }\n-        }\n-    }\n+    int64 nBIP30SwitchTime = 1331769600;\n+    bool fEnforceBIP30 = (pindex->nTime > nBIP30SwitchTime);\n \n     // BIP16 didn't become active until Apr 1 2012\n     int64 nBIP16SwitchTime = 1333238400;\n@@ -1351,6 +1340,17 @@ bool CBlock::ConnectBlock(CTxDB& txdb, CBlockIndex* pindex)\n     unsigned int nSigOps = 0;\n     BOOST_FOREACH(CTransaction& tx, vtx)\n     {\n+        uint256 hashTx = tx.GetHash();\n+\n+        if (fEnforceBIP30) {\n+            CTxIndex txindexOld;\n+            if (txdb.ReadTxIndex(hashTx, txindexOld)) {\n+                BOOST_FOREACH(CDiskTxPos &pos, txindexOld.vSpent)\n+                    if (pos.IsNull())\n+                        return false;\n+            }\n+        }\n+\n         nSigOps += tx.GetLegacySigOpCount();\n         if (nSigOps > MAX_BLOCK_SIGOPS)\n             return DoS(100, error(\"ConnectBlock() : too many sigops\"));\n@@ -1381,7 +1381,7 @@ bool CBlock::ConnectBlock(CTxDB& txdb, CBlockIndex* pindex)\n                 return false;\n         }\n \n-        mapQueuedChanges[tx.GetHash()] = CTxIndex(posThisTx, tx.vout.size());\n+        mapQueuedChanges[hashTx] = CTxIndex(posThisTx, tx.vout.size());\n     }\n \n     // Write queued txindex changes"
      }
    ]
  },
  {
    "sha": "f77654a0e9424f13cad04f82c014abd78fbb5e38",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmNzc2NTRhMGU5NDI0ZjEzY2FkMDRmODJjMDE0YWJkNzhmYmI1ZTM4",
    "commit": {
      "author": {
        "name": "Jeff Garzik",
        "email": "jgarzik@exmulti.com",
        "date": "2012-07-04T05:12:44Z"
      },
      "committer": {
        "name": "Jeff Garzik",
        "email": "jgarzik@redhat.com",
        "date": "2012-07-04T05:12:44Z"
      },
      "message": "CTxMemPool: eliminate redundant lock, GetHash() call\n\n::addUnchecked()'s only caller already takes the necessary lock,\nand has already calculated the TX's hash.",
      "tree": {
        "sha": "29b9dd80f03edde949c5a7abdf3a5913cd91e889",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/29b9dd80f03edde949c5a7abdf3a5913cd91e889"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/f77654a0e9424f13cad04f82c014abd78fbb5e38",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f77654a0e9424f13cad04f82c014abd78fbb5e38",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/f77654a0e9424f13cad04f82c014abd78fbb5e38",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f77654a0e9424f13cad04f82c014abd78fbb5e38/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "96929a5515bb0ffee67aab7283b5ae9fcc1641d5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/96929a5515bb0ffee67aab7283b5ae9fcc1641d5",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/96929a5515bb0ffee67aab7283b5ae9fcc1641d5"
      }
    ],
    "stats": {
      "total": 8,
      "additions": 3,
      "deletions": 5
    },
    "files": [
      {
        "sha": "8e1deac4bbfbc0270459e1b17a2eece0557635a4",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 2,
        "deletions": 4,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f77654a0e9424f13cad04f82c014abd78fbb5e38/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f77654a0e9424f13cad04f82c014abd78fbb5e38/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=f77654a0e9424f13cad04f82c014abd78fbb5e38",
        "patch": "@@ -600,7 +600,7 @@ bool CTxMemPool::accept(CTxDB& txdb, CTransaction &tx, bool fCheckInputs,\n             printf(\"CTxMemPool::accept() : replacing tx %s with new version\\n\", ptxOld->GetHash().ToString().c_str());\n             remove(*ptxOld);\n         }\n-        addUnchecked(tx);\n+        addUnchecked(hash, tx);\n     }\n \n     ///// are we sure this is ok when loading transactions or restoring block txes\n@@ -619,13 +619,11 @@ bool CTransaction::AcceptToMemoryPool(CTxDB& txdb, bool fCheckInputs, bool* pfMi\n     return mempool.accept(txdb, *this, fCheckInputs, pfMissingInputs);\n }\n \n-bool CTxMemPool::addUnchecked(CTransaction &tx)\n+bool CTxMemPool::addUnchecked(const uint256& hash, CTransaction &tx)\n {\n     // Add to memory pool without checking anything.  Don't call this directly,\n     // call CTxMemPool::accept to properly check the transaction first.\n     {\n-        LOCK(cs);\n-        uint256 hash = tx.GetHash();\n         mapTx[hash] = tx;\n         for (unsigned int i = 0; i < tx.vin.size(); i++)\n             mapNextTx[tx.vin[i].prevout] = CInPoint(&mapTx[hash], i);"
      },
      {
        "sha": "c841fdaf18aa136b8532be10b19b2842c9e6010a",
        "filename": "src/main.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/f77654a0e9424f13cad04f82c014abd78fbb5e38/src/main.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/f77654a0e9424f13cad04f82c014abd78fbb5e38/src/main.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.h?ref=f77654a0e9424f13cad04f82c014abd78fbb5e38",
        "patch": "@@ -1602,7 +1602,7 @@ class CTxMemPool\n \n     bool accept(CTxDB& txdb, CTransaction &tx,\n                 bool fCheckInputs, bool* pfMissingInputs);\n-    bool addUnchecked(CTransaction &tx);\n+    bool addUnchecked(const uint256& hash, CTransaction &tx);\n     bool remove(CTransaction &tx);\n     void queryHashes(std::vector<uint256>& vtxid);\n "
      }
    ]
  },
  {
    "sha": "8a05341cf5543eec18f3a1380a0098dbd314e351",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4YTA1MzQxY2Y1NTQzZWVjMThmM2ExMzgwYTAwOThkYmQzMTRlMzUx",
    "commit": {
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2012-07-04T14:46:44Z"
      },
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2012-07-04T14:46:44Z"
      },
      "message": "Merge branch 'buildupdates' of https://github.com/TheBlueMatt/bitcoin",
      "tree": {
        "sha": "2a6b699ab247fb8bd913ca0fbc6e01e8a297ee4a",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2a6b699ab247fb8bd913ca0fbc6e01e8a297ee4a"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/8a05341cf5543eec18f3a1380a0098dbd314e351",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/8a05341cf5543eec18f3a1380a0098dbd314e351",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/8a05341cf5543eec18f3a1380a0098dbd314e351",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/8a05341cf5543eec18f3a1380a0098dbd314e351/comments",
    "author": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "c729dbb6d2b63d9c0b32e3937be0ebf528d4c753",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/c729dbb6d2b63d9c0b32e3937be0ebf528d4c753",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/c729dbb6d2b63d9c0b32e3937be0ebf528d4c753"
      },
      {
        "sha": "4d9c55da72e2bcf40f79a9d818dcef04e8308b35",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/4d9c55da72e2bcf40f79a9d818dcef04e8308b35",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/4d9c55da72e2bcf40f79a9d818dcef04e8308b35"
      }
    ],
    "stats": {
      "total": 8,
      "additions": 4,
      "deletions": 4
    },
    "files": [
      {
        "sha": "44e648d677ac5d131efd818bdb2ae99601637201",
        "filename": "src/makefile.osx",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/8a05341cf5543eec18f3a1380a0098dbd314e351/src/makefile.osx",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/8a05341cf5543eec18f3a1380a0098dbd314e351/src/makefile.osx",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/makefile.osx?ref=8a05341cf5543eec18f3a1380a0098dbd314e351",
        "patch": "@@ -113,7 +113,7 @@ version.cpp: obj/build.h\n DEFS += -DHAVE_BUILD_INFO\n \n obj/%.o: %.cpp\n-\t$(CXX) -c $(CFLAGS) -MMD -o $@ $<\n+\t$(CXX) -c $(CFLAGS) -MMD -MF $(@:%.o=%.d) -o $@ $<\n \t@cp $(@:%.o=%.d) $(@:%.o=%.P); \\\n \t  sed -e 's/#.*//' -e 's/^[^:]*: *//' -e 's/ *\\\\$$//' \\\n \t      -e '/^$$/ d' -e 's/$$/ :/' < $(@:%.o=%.d) >> $(@:%.o=%.P); \\\n@@ -125,7 +125,7 @@ bitcoind: $(OBJS:obj/%=obj/%)\n TESTOBJS := $(patsubst test/%.cpp,obj-test/%.o,$(wildcard test/*.cpp))\n \n obj-test/%.o: test/%.cpp\n-\t$(CXX) -c $(TESTDEFS) $(CFLAGS) -MMD -o $@ $<\n+\t$(CXX) -c $(TESTDEFS) $(CFLAGS) -MMD -MF $(@:%.o=%.d) -o $@ $<\n \t@cp $(@:%.o=%.d) $(@:%.o=%.P); \\\n \t  sed -e 's/#.*//' -e 's/^[^:]*: *//' -e 's/ *\\\\$$//' \\\n \t      -e '/^$$/ d' -e 's/$$/ :/' < $(@:%.o=%.d) >> $(@:%.o=%.P); \\"
      },
      {
        "sha": "6d9bf276dfeb59508e4dcc9335ca665d43043696",
        "filename": "src/makefile.unix",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/8a05341cf5543eec18f3a1380a0098dbd314e351/src/makefile.unix",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/8a05341cf5543eec18f3a1380a0098dbd314e351/src/makefile.unix",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/makefile.unix?ref=8a05341cf5543eec18f3a1380a0098dbd314e351",
        "patch": "@@ -125,7 +125,7 @@ version.cpp: obj/build.h\n DEFS += -DHAVE_BUILD_INFO\n \n obj/%.o: %.cpp\n-\t$(CXX) -c $(xCXXFLAGS) -MMD -o $@ $<\n+\t$(CXX) -c $(xCXXFLAGS) -MMD -MF $(@:%.o=%.d) -o $@ $<\n \t@cp $(@:%.o=%.d) $(@:%.o=%.P); \\\n \t  sed -e 's/#.*//' -e 's/^[^:]*: *//' -e 's/ *\\\\$$//' \\\n \t      -e '/^$$/ d' -e 's/$$/ :/' < $(@:%.o=%.d) >> $(@:%.o=%.P); \\\n@@ -137,7 +137,7 @@ bitcoind: $(OBJS:obj/%=obj/%)\n TESTOBJS := $(patsubst test/%.cpp,obj-test/%.o,$(wildcard test/*.cpp))\n \n obj-test/%.o: test/%.cpp\n-\t$(CXX) -c $(TESTDEFS) $(xCXXFLAGS) -MMD -o $@ $<\n+\t$(CXX) -c $(TESTDEFS) $(xCXXFLAGS) -MMD -MF $(@:%.o=%.d) -o $@ $<\n \t@cp $(@:%.o=%.d) $(@:%.o=%.P); \\\n \t  sed -e 's/#.*//' -e 's/^[^:]*: *//' -e 's/ *\\\\$$//' \\\n \t      -e '/^$$/ d' -e 's/$$/ :/' < $(@:%.o=%.d) >> $(@:%.o=%.P); \\"
      }
    ]
  },
  {
    "sha": "fe70b09c428585166f1040e9023251c9c250e894",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpmZTcwYjA5YzQyODU4NTE2NmYxMDQwZTkwMjMyNTFjOWMyNTBlODk0",
    "commit": {
      "author": {
        "name": "Jeff Garzik",
        "email": "jgarzik@exmulti.com",
        "date": "2012-07-04T15:34:11Z"
      },
      "committer": {
        "name": "Jeff Garzik",
        "email": "jgarzik@exmulti.com",
        "date": "2012-07-04T15:34:11Z"
      },
      "message": "Merge pull request #1555 from TheBlueMatt/warnings\n\nFix remaining compile warnings.",
      "tree": {
        "sha": "31b5dfc6515d922b9abc8f82eb4c97c2a8d0675c",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/31b5dfc6515d922b9abc8f82eb4c97c2a8d0675c"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/fe70b09c428585166f1040e9023251c9c250e894",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fe70b09c428585166f1040e9023251c9c250e894",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/fe70b09c428585166f1040e9023251c9c250e894",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fe70b09c428585166f1040e9023251c9c250e894/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "8a05341cf5543eec18f3a1380a0098dbd314e351",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/8a05341cf5543eec18f3a1380a0098dbd314e351",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/8a05341cf5543eec18f3a1380a0098dbd314e351"
      },
      {
        "sha": "24154ed64b70ac3c9fdceb6b53f1746b91e53bfa",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/24154ed64b70ac3c9fdceb6b53f1746b91e53bfa",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/24154ed64b70ac3c9fdceb6b53f1746b91e53bfa"
      }
    ],
    "stats": {
      "total": 18,
      "additions": 13,
      "deletions": 5
    },
    "files": [
      {
        "sha": "fccb5d10f93b25d67a0020b534d66b3760efb626",
        "filename": "src/net.h",
        "status": "modified",
        "additions": 3,
        "deletions": 3,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fe70b09c428585166f1040e9023251c9c250e894/src/net.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fe70b09c428585166f1040e9023251c9c250e894/src/net.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/net.h?ref=fe70b09c428585166f1040e9023251c9c250e894",
        "patch": "@@ -371,14 +371,14 @@ class CNode\n \n         // Set the size\n         unsigned int nSize = vSend.size() - nMessageStart;\n-        memcpy((char*)&vSend[nHeaderStart] + offsetof(CMessageHeader, nMessageSize), &nSize, sizeof(nSize));\n+        memcpy((char*)&vSend[nHeaderStart] + CMessageHeader::MESSAGE_SIZE_OFFSET, &nSize, sizeof(nSize));\n \n         // Set the checksum\n         uint256 hash = Hash(vSend.begin() + nMessageStart, vSend.end());\n         unsigned int nChecksum = 0;\n         memcpy(&nChecksum, &hash, sizeof(nChecksum));\n-        assert(nMessageStart - nHeaderStart >= offsetof(CMessageHeader, nChecksum) + sizeof(nChecksum));\n-        memcpy((char*)&vSend[nHeaderStart] + offsetof(CMessageHeader, nChecksum), &nChecksum, sizeof(nChecksum));\n+        assert(nMessageStart - nHeaderStart >= CMessageHeader::CHECKSUM_OFFSET + sizeof(nChecksum));\n+        memcpy((char*)&vSend[nHeaderStart] + CMessageHeader::CHECKSUM_OFFSET, &nChecksum, sizeof(nChecksum));\n \n         if (fDebug) {\n             printf(\"(%d bytes)\\n\", nSize);"
      },
      {
        "sha": "36f8b144cd7ae8cb1726a87f2df38e47f675a793",
        "filename": "src/protocol.h",
        "status": "modified",
        "additions": 10,
        "deletions": 2,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/fe70b09c428585166f1040e9023251c9c250e894/src/protocol.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/fe70b09c428585166f1040e9023251c9c250e894/src/protocol.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/protocol.h?ref=fe70b09c428585166f1040e9023251c9c250e894",
        "patch": "@@ -49,8 +49,16 @@ class CMessageHeader\n \n     // TODO: make private (improves encapsulation)\n     public:\n-        enum { COMMAND_SIZE=12 };\n-        char pchMessageStart[sizeof(::pchMessageStart)];\n+        enum {\n+            MESSAGE_START_SIZE=sizeof(::pchMessageStart),\n+            COMMAND_SIZE=12,\n+            MESSAGE_SIZE_SIZE=sizeof(int),\n+            CHECKSUM_SIZE=sizeof(int),\n+\n+            MESSAGE_SIZE_OFFSET=MESSAGE_START_SIZE+COMMAND_SIZE,\n+            CHECKSUM_OFFSET=MESSAGE_SIZE_OFFSET+MESSAGE_SIZE_SIZE\n+        };\n+        char pchMessageStart[MESSAGE_START_SIZE];\n         char pchCommand[COMMAND_SIZE];\n         unsigned int nMessageSize;\n         unsigned int nChecksum;"
      }
    ]
  },
  {
    "sha": "9a6ab7f1420691267e78e302ff224076945e9133",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo5YTZhYjdmMTQyMDY5MTI2N2U3OGUzMDJmZjIyNDA3Njk0NWU5MTMz",
    "commit": {
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2012-06-24T21:04:50Z"
      },
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2012-07-05T16:42:25Z"
      },
      "message": "Rework gettransaction / getblock RPC calls\n\nThis PULL reworks new (post-0.6.*) features of the\ngettransaction/getblock RPC calls as follows:\n\nIt removes the 'decompositions' object argument from getblock,\nreplacing it just a list of transaction hashes; equivalent\n(I believe) of passing the {\"tx\":\"hash\"} decomposition.\n\nIt replaces the 'decompositions' object argument of\ngettransaction with a boolean flag; if true, returns\nthe same stuff that the {\"script\":\"obj\"} decomposition\nwould return (txins/txouts as hex, disassembled, and bitcoin\naddresses).\n\nIt adds a \"rawtx\" field to the output of gettransaction,\nthat is the entire transaction serialized and hex-encoded.\n\nIt removes the \"size\" field from gettransaction, since the size\nis trivial to compute from the \"rawtx\" field (either take the\nlength after hex-decoding, or just compute it as hex-length/2).",
      "tree": {
        "sha": "932408e289103a55f057eb34751cae5fcca2b2a5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/932408e289103a55f057eb34751cae5fcca2b2a5"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/9a6ab7f1420691267e78e302ff224076945e9133",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9a6ab7f1420691267e78e302ff224076945e9133",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/9a6ab7f1420691267e78e302ff224076945e9133",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9a6ab7f1420691267e78e302ff224076945e9133/comments",
    "author": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "fe70b09c428585166f1040e9023251c9c250e894",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/fe70b09c428585166f1040e9023251c9c250e894",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/fe70b09c428585166f1040e9023251c9c250e894"
      }
    ],
    "stats": {
      "total": 292,
      "additions": 28,
      "deletions": 264
    },
    "files": [
      {
        "sha": "19815ef0fe780d5c364dbb18bc7fb6603301d450",
        "filename": "src/bitcoinrpc.cpp",
        "status": "modified",
        "additions": 28,
        "deletions": 264,
        "changes": 292,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/9a6ab7f1420691267e78e302ff224076945e9133/src/bitcoinrpc.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/9a6ab7f1420691267e78e302ff224076945e9133/src/bitcoinrpc.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoinrpc.cpp?ref=9a6ab7f1420691267e78e302ff224076945e9133",
        "patch": "@@ -137,33 +137,6 @@ EnsureWalletIsUnlocked()\n         throw JSONRPCError(-13, \"Error: Please enter the wallet passphrase with walletpassphrase first.\");\n }\n \n-enum DecomposeMode {\n-    DM_NONE = 0,\n-    DM_HASH,\n-    DM_HEX,\n-    DM_ASM,\n-    DM_OBJ,\n-};\n-\n-enum DecomposeMode\n-FindDecompose(const Object& decompositions, const char* pcType, const char* pcDefault)\n-{\n-    Value val = find_value(decompositions, pcType);\n-    std::string strDecompose = (val.type() == null_type) ? pcDefault : val.get_str();\n-\n-    if (strDecompose == \"no\")\n-        return DM_NONE;\n-    if (strDecompose == \"hash\")\n-        return DM_HASH;\n-    if (strDecompose == \"hex\")\n-        return DM_HEX;\n-    if (strDecompose == \"asm\")\n-        return DM_ASM;\n-    if (strDecompose == \"obj\")\n-        return DM_OBJ;\n-    throw JSONRPCError(-18, \"Invalid decomposition\");\n-}\n-\n void WalletTxToJSON(const CWalletTx& wtx, Object& entry)\n {\n     int confirms = wtx.GetDepthInMainChain();\n@@ -179,141 +152,6 @@ void WalletTxToJSON(const CWalletTx& wtx, Object& entry)\n         entry.push_back(Pair(item.first, item.second));\n }\n \n-void\n-ScriptSigToJSON(const CTxIn& txin, Object& out)\n-{\n-    out.push_back(Pair(\"asm\", txin.scriptSig.ToString()));\n-    out.push_back(Pair(\"hex\", HexStr(txin.scriptSig.begin(), txin.scriptSig.end())));\n-\n-    CTransaction txprev;\n-    uint256 hashTxprevBlock;\n-    if (!GetTransaction(txin.prevout.hash, txprev, hashTxprevBlock))\n-        return;\n-\n-    txnouttype type;\n-    vector<CTxDestination> addresses;\n-    int nRequired;\n-\n-    if (!ExtractDestinations(txprev.vout[txin.prevout.n].scriptPubKey, type,\n-                          addresses, nRequired))\n-    {\n-        out.push_back(Pair(\"type\", GetTxnOutputType(TX_NONSTANDARD)));\n-        return;\n-    }\n-\n-    out.push_back(Pair(\"type\", GetTxnOutputType(type)));\n-    if (type == TX_MULTISIG)\n-    {\n-        // TODO: Need to handle this specially since not all input addresses are required...\n-        return;\n-    }\n-\n-    Array a;\n-    BOOST_FOREACH(const CTxDestination& addr, addresses)\n-        a.push_back(CBitcoinAddress(addr).ToString());\n-    out.push_back(Pair(\"addresses\", a));\n-}\n-\n-void\n-ScriptPubKeyToJSON(const CScript& scriptPubKey, Object& out)\n-{\n-    txnouttype type;\n-    vector<CTxDestination> addresses;\n-    int nRequired;\n-\n-    out.push_back(Pair(\"asm\", scriptPubKey.ToString()));\n-    out.push_back(Pair(\"hex\", HexStr(scriptPubKey.begin(), scriptPubKey.end())));\n-\n-    if (!ExtractDestinations(scriptPubKey, type, addresses, nRequired))\n-    {\n-        out.push_back(Pair(\"type\", GetTxnOutputType(TX_NONSTANDARD)));\n-        return;\n-    }\n-\n-    out.push_back(Pair(\"reqSigs\", nRequired));\n-    out.push_back(Pair(\"type\", GetTxnOutputType(type)));\n-\n-    Array a;\n-    BOOST_FOREACH(const CTxDestination& addr, addresses)\n-        a.push_back(CBitcoinAddress(addr).ToString());\n-    out.push_back(Pair(\"addresses\", a));\n-}\n-\n-void TxToJSON(const CTransaction &tx, Object& entry, const Object& decompositions)\n-{\n-    entry.push_back(Pair(\"version\", tx.nVersion));\n-    entry.push_back(Pair(\"locktime\", (boost::int64_t)tx.nLockTime));\n-    entry.push_back(Pair(\"size\", (boost::int64_t)::GetSerializeSize(tx, SER_NETWORK, PROTOCOL_VERSION)));\n-\n-    enum DecomposeMode decomposeScript = FindDecompose(decompositions, \"script\", \"asm\");\n-\n-    Array vin;\n-    BOOST_FOREACH(const CTxIn& txin, tx.vin)\n-    {\n-        Object in;\n-        if (tx.IsCoinBase())\n-            in.push_back(Pair(\"coinbase\", HexStr(txin.scriptSig.begin(), txin.scriptSig.end())));\n-        else\n-        {\n-            Object prevout;\n-            prevout.push_back(Pair(\"hash\", txin.prevout.hash.GetHex()));\n-            prevout.push_back(Pair(\"n\", (boost::int64_t)txin.prevout.n));\n-            in.push_back(Pair(\"prevout\", prevout));\n-            switch (decomposeScript) {\n-            case DM_NONE:\n-                break;\n-            case DM_HEX:\n-                in.push_back(Pair(\"scriptSig\", HexStr(txin.scriptSig.begin(), txin.scriptSig.end())));\n-                break;\n-            case DM_ASM:\n-                in.push_back(Pair(\"scriptSig\", txin.scriptSig.ToString()));\n-                break;\n-            case DM_OBJ:\n-            {\n-                Object o;\n-                ScriptSigToJSON(txin, o);\n-                in.push_back(Pair(\"scriptSig\", o));\n-                break;\n-            }\n-            default:\n-                throw JSONRPCError(-18, \"Invalid script decomposition\");\n-            }\n-        }\n-        in.push_back(Pair(\"sequence\", (boost::int64_t)txin.nSequence));\n-        vin.push_back(in);\n-    }\n-    entry.push_back(Pair(\"vin\", vin));\n-    Array vout;\n-    BOOST_FOREACH(const CTxOut& txout, tx.vout)\n-    {\n-        Object out;\n-        out.push_back(Pair(\"value\", ValueFromAmount(txout.nValue)));\n-        switch (decomposeScript) {\n-        case DM_NONE:\n-            break;\n-        case DM_HEX:\n-            out.push_back(Pair(\"scriptPubKey\", HexStr(txout.scriptPubKey.begin(), txout.scriptPubKey.end())));\n-            break;\n-        case DM_ASM:\n-            out.push_back(Pair(\"scriptPubKey\", txout.scriptPubKey.ToString()));\n-            break;\n-        case DM_OBJ:\n-        {\n-            Object o;\n-            ScriptPubKeyToJSON(txout.scriptPubKey, o);\n-            out.push_back(Pair(\"scriptPubKey\", o));\n-            break;\n-        }\n-        default:\n-            throw JSONRPCError(-18, \"Invalid script decomposition\");\n-        }\n-        vout.push_back(out);\n-    }\n-    entry.push_back(Pair(\"vout\", vout));\n-}\n-\n-void AnyTxToJSON(const uint256 hash, const CTransaction* ptx, Object& entry, const Object& decompositions);\n-\n string AccountFromValue(const Value& value)\n {\n     string strAccount = value.get_str();\n@@ -322,7 +160,7 @@ string AccountFromValue(const Value& value)\n     return strAccount;\n }\n \n-Object blockToJSON(const CBlock& block, const CBlockIndex* blockindex, const Object& decompositions)\n+Object blockToJSON(const CBlock& block, const CBlockIndex* blockindex)\n {\n     Object result;\n     result.push_back(Pair(\"hash\", block.GetHash().GetHex()));\n@@ -333,43 +171,15 @@ Object blockToJSON(const CBlock& block, const CBlockIndex* blockindex, const Obj\n     result.push_back(Pair(\"height\", blockindex->nHeight));\n     result.push_back(Pair(\"version\", block.nVersion));\n     result.push_back(Pair(\"merkleroot\", block.hashMerkleRoot.GetHex()));\n+    Array txs;\n+    BOOST_FOREACH(const CTransaction&tx, block.vtx)\n+        txs.push_back(tx.GetHash().GetHex());\n+    result.push_back(Pair(\"tx\", txs));\n     result.push_back(Pair(\"time\", (boost::int64_t)block.GetBlockTime()));\n     result.push_back(Pair(\"nonce\", (boost::uint64_t)block.nNonce));\n     result.push_back(Pair(\"bits\", HexBits(block.nBits)));\n     result.push_back(Pair(\"difficulty\", GetDifficulty(blockindex)));\n \n-    enum DecomposeMode decomposeTxn = FindDecompose(decompositions, \"tx\", \"hash\");\n-    if (decomposeTxn)\n-    {\n-        Array txs;\n-        switch (decomposeTxn) {\n-        case DM_OBJ:\n-            BOOST_FOREACH (const CTransaction&tx, block.vtx)\n-            {\n-                Object entry;\n-                AnyTxToJSON(tx.GetHash(), &tx, entry, decompositions);\n-                txs.push_back(entry);\n-            }\n-            break;\n-        case DM_HEX:\n-            BOOST_FOREACH (const CTransaction&tx, block.vtx)\n-            {\n-                CDataStream ssTx(SER_NETWORK, PROTOCOL_VERSION);\n-                ssTx << tx;\n-\n-                txs.push_back(HexStr(ssTx.begin(), ssTx.end()));\n-            }\n-            break;\n-        case DM_HASH:\n-            BOOST_FOREACH (const CTransaction&tx, block.vtx)\n-                txs.push_back(tx.GetHash().GetHex());\n-            break;\n-        default:\n-            throw JSONRPCError(-18, \"Invalid transaction decomposition\");\n-        }\n-        result.push_back(Pair(\"tx\", txs));\n-    }\n-\n     if (blockindex->pprev)\n         result.push_back(Pair(\"previousblockhash\", blockindex->pprev->GetBlockHash().GetHex()));\n     if (blockindex->pnext)\n@@ -1651,78 +1461,35 @@ Value listsinceblock(const Array& params, bool fHelp)\n     return ret;\n }\n \n-void\n-AnyTxToJSON(const uint256 hash, const CTransaction* ptx, Object& entry, const Object& decompositions)\n-{\n-    if (pwalletMain->mapWallet.count(hash))\n-    {\n-        const CWalletTx& wtx = pwalletMain->mapWallet[hash];\n-\n-        TxToJSON(wtx, entry, decompositions);\n-\n-        int64 nCredit = wtx.GetCredit();\n-        int64 nDebit = wtx.GetDebit();\n-        int64 nNet = nCredit - nDebit;\n-        int64 nFee = (wtx.IsFromMe() ? wtx.GetValueOut() - nDebit : 0);\n-\n-        entry.push_back(Pair(\"amount\", ValueFromAmount(nNet - nFee)));\n-        if (wtx.IsFromMe())\n-            entry.push_back(Pair(\"fee\", ValueFromAmount(nFee)));\n-\n-        WalletTxToJSON(wtx, entry);\n-\n-        Array details;\n-        ListTransactions(pwalletMain->mapWallet[hash], \"*\", 0, false, details);\n-        entry.push_back(Pair(\"details\", details));\n-    }\n-    else\n-    {\n-        CTransaction tx;\n-        uint256 hashBlock = 0;\n-        if ((!ptx) && GetTransaction(hash, tx, hashBlock))\n-            ptx = &tx;\n-        if (ptx)\n-        {\n-            entry.push_back(Pair(\"txid\", hash.GetHex()));\n-            TxToJSON(*ptx, entry, decompositions);\n-            if (hashBlock == 0)\n-                entry.push_back(Pair(\"confirmations\", 0));\n-            else\n-            {\n-                entry.push_back(Pair(\"blockhash\", hashBlock.GetHex()));\n-                map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(hashBlock);\n-                if (mi != mapBlockIndex.end() && (*mi).second)\n-                {\n-                    CBlockIndex* pindex = (*mi).second;\n-                    if (pindex->IsInMainChain())\n-                    {\n-                        entry.push_back(Pair(\"confirmations\", 1 + nBestHeight - pindex->nHeight));\n-                        entry.push_back(Pair(\"time\", (boost::int64_t)pindex->nTime));\n-                    }\n-                    else\n-                        entry.push_back(Pair(\"confirmations\", 0));\n-                }\n-            }\n-        }\n-        else\n-            throw JSONRPCError(-5, \"No information available about transaction\");\n-    }\n-}\n-\n Value gettransaction(const Array& params, bool fHelp)\n {\n-    if (fHelp || params.size() < 1 || params.size() > 2)\n+    if (fHelp || params.size() != 1)\n         throw runtime_error(\n-            \"gettransaction <txid> [decompositions]\\n\"\n-            \"Get detailed information about <txid>\");\n+            \"gettransaction <txid>\\n\"\n+            \"Get detailed information about in-wallet transaction <txid>\");\n \n     uint256 hash;\n     hash.SetHex(params[0].get_str());\n \n     Object entry;\n+    if (!pwalletMain->mapWallet.count(hash))\n+        throw JSONRPCError(-5, \"Invalid or non-wallet transaction id\");\n+    const CWalletTx& wtx = pwalletMain->mapWallet[hash];\n+\n+    int64 nCredit = wtx.GetCredit();\n+    int64 nDebit = wtx.GetDebit();\n+    int64 nNet = nCredit - nDebit;\n+    int64 nFee = (wtx.IsFromMe() ? wtx.GetValueOut() - nDebit : 0);\n+\n+    entry.push_back(Pair(\"amount\", ValueFromAmount(nNet - nFee)));\n+    if (wtx.IsFromMe())\n+        entry.push_back(Pair(\"fee\", ValueFromAmount(nFee)));\n \n-    AnyTxToJSON(hash, NULL, entry,\n-                (params.size() > 1) ? params[1].get_obj() : emptyobj);\n+    WalletTxToJSON(wtx, entry);\n+\n+    Array details;\n+    ListTransactions(wtx, \"*\", 0, false, details);\n+    entry.push_back(Pair(\"details\", details));\n \n     return entry;\n }\n@@ -2226,9 +1993,9 @@ Value getblockhash(const Array& params, bool fHelp)\n \n Value getblock(const Array& params, bool fHelp)\n {\n-    if (fHelp || params.size() < 1 || params.size() > 2)\n+    if (fHelp || params.size() != 1)\n         throw runtime_error(\n-            \"getblock <hash> [decompositions]\\n\"\n+            \"getblock <hash>\\n\"\n             \"Returns details of a block with given block-hash.\");\n \n     std::string strHash = params[0].get_str();\n@@ -2241,8 +2008,7 @@ Value getblock(const Array& params, bool fHelp)\n     CBlockIndex* pblockindex = mapBlockIndex[hash];\n     block.ReadFromDisk(pblockindex, true);\n \n-    return blockToJSON(block, pblockindex,\n-                       (params.size() > 1) ? params[1].get_obj() : emptyobj);\n+    return blockToJSON(block, pblockindex);\n }\n \n Value sendrawtx(const Array& params, bool fHelp)\n@@ -3204,9 +2970,7 @@ Array RPCConvertValues(const std::string &strMethod, const std::vector<std::stri\n     if (strMethod == \"listreceivedbyaccount\"  && n > 0) ConvertTo<boost::int64_t>(params[0]);\n     if (strMethod == \"listreceivedbyaccount\"  && n > 1) ConvertTo<bool>(params[1]);\n     if (strMethod == \"getbalance\"             && n > 1) ConvertTo<boost::int64_t>(params[1]);\n-    if (strMethod == \"getblock\"               && n > 1) ConvertTo<Object>(params[1]);\n     if (strMethod == \"getblockhash\"           && n > 0) ConvertTo<boost::int64_t>(params[0]);\n-    if (strMethod == \"gettransaction\"         && n > 1) ConvertTo<Object>(params[1]);\n     if (strMethod == \"move\"                   && n > 2) ConvertTo<double>(params[2]);\n     if (strMethod == \"move\"                   && n > 3) ConvertTo<boost::int64_t>(params[3]);\n     if (strMethod == \"sendfrom\"               && n > 2) ConvertTo<double>(params[2]);"
      }
    ]
  },
  {
    "sha": "34420d655d8c1cf15e53803ca85e0ac2a2a62fe9",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzozNDQyMGQ2NTVkOGMxY2YxNWU1MzgwM2NhODVlMGFjMmEyYTYyZmU5",
    "commit": {
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2012-06-21T21:05:42Z"
      },
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2012-07-05T16:42:25Z"
      },
      "message": "Refactor: SignSignature/VerifyScript\n\nMinor refactor to support signrawtx signing/verifying transactions\nwhen it might only have the previous transaction's txid and\ntxOut.",
      "tree": {
        "sha": "df152867d93162ab6a5a6a52097bbeecc279c705",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/df152867d93162ab6a5a6a52097bbeecc279c705"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/34420d655d8c1cf15e53803ca85e0ac2a2a62fe9",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/34420d655d8c1cf15e53803ca85e0ac2a2a62fe9",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/34420d655d8c1cf15e53803ca85e0ac2a2a62fe9",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/34420d655d8c1cf15e53803ca85e0ac2a2a62fe9/comments",
    "author": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "9a6ab7f1420691267e78e302ff224076945e9133",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/9a6ab7f1420691267e78e302ff224076945e9133",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/9a6ab7f1420691267e78e302ff224076945e9133"
      }
    ],
    "stats": {
      "total": 30,
      "additions": 17,
      "deletions": 13
    },
    "files": [
      {
        "sha": "1451747fa27cc63f2d8f913353c40a385eccf6c1",
        "filename": "src/script.cpp",
        "status": "modified",
        "additions": 14,
        "deletions": 13,
        "changes": 27,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/34420d655d8c1cf15e53803ca85e0ac2a2a62fe9/src/script.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/34420d655d8c1cf15e53803ca85e0ac2a2a62fe9/src/script.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script.cpp?ref=34420d655d8c1cf15e53803ca85e0ac2a2a62fe9",
        "patch": "@@ -1590,19 +1590,17 @@ bool VerifyScript(const CScript& scriptSig, const CScript& scriptPubKey, const C\n }\n \n \n-bool SignSignature(const CKeyStore &keystore, const CTransaction& txFrom, CTransaction& txTo, unsigned int nIn, int nHashType)\n+bool SignSignature(const CKeyStore &keystore, const CScript& fromPubKey, CTransaction& txTo, unsigned int nIn, int nHashType)\n {\n     assert(nIn < txTo.vin.size());\n     CTxIn& txin = txTo.vin[nIn];\n-    assert(txin.prevout.n < txFrom.vout.size());\n-    const CTxOut& txout = txFrom.vout[txin.prevout.n];\n \n     // Leave out the signature from the hash, since a signature can't sign itself.\n     // The checksig op will also drop the signatures from its hash.\n-    uint256 hash = SignatureHash(txout.scriptPubKey, txTo, nIn, nHashType);\n+    uint256 hash = SignatureHash(fromPubKey, txTo, nIn, nHashType);\n \n     txnouttype whichType;\n-    if (!Solver(keystore, txout.scriptPubKey, hash, nHashType, txin.scriptSig, whichType))\n+    if (!Solver(keystore, fromPubKey, hash, nHashType, txin.scriptSig, whichType))\n         return false;\n \n     if (whichType == TX_SCRIPTHASH)\n@@ -1623,12 +1621,18 @@ bool SignSignature(const CKeyStore &keystore, const CTransaction& txFrom, CTrans\n     }\n \n     // Test solution\n-    if (!VerifyScript(txin.scriptSig, txout.scriptPubKey, txTo, nIn, true, 0))\n-        return false;\n-\n-    return true;\n+    return VerifyScript(txin.scriptSig, fromPubKey, txTo, nIn, true, 0);\n }\n \n+bool SignSignature(const CKeyStore &keystore, const CTransaction& txFrom, CTransaction& txTo, unsigned int nIn, int nHashType)\n+{\n+    assert(nIn < txTo.vin.size());\n+    CTxIn& txin = txTo.vin[nIn];\n+    assert(txin.prevout.n < txFrom.vout.size());\n+    const CTxOut& txout = txFrom.vout[txin.prevout.n];\n+\n+    return SignSignature(keystore, txout.scriptPubKey, txTo, nIn, nHashType);\n+}\n \n bool VerifySignature(const CTransaction& txFrom, const CTransaction& txTo, unsigned int nIn, bool fValidatePayToScriptHash, int nHashType)\n {\n@@ -1641,10 +1645,7 @@ bool VerifySignature(const CTransaction& txFrom, const CTransaction& txTo, unsig\n     if (txin.prevout.hash != txFrom.GetHash())\n         return false;\n \n-    if (!VerifyScript(txin.scriptSig, txout.scriptPubKey, txTo, nIn, fValidatePayToScriptHash, nHashType))\n-        return false;\n-\n-    return true;\n+    return VerifyScript(txin.scriptSig, txout.scriptPubKey, txTo, nIn, fValidatePayToScriptHash, nHashType);\n }\n \n unsigned int CScript::GetSigOpCount(bool fAccurate) const"
      },
      {
        "sha": "38f346936493cfb1a11650476857e44d30b92630",
        "filename": "src/script.h",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/34420d655d8c1cf15e53803ca85e0ac2a2a62fe9/src/script.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/34420d655d8c1cf15e53803ca85e0ac2a2a62fe9/src/script.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script.h?ref=34420d655d8c1cf15e53803ca85e0ac2a2a62fe9",
        "patch": "@@ -591,7 +591,10 @@ bool IsMine(const CKeyStore& keystore, const CScript& scriptPubKey);\n bool IsMine(const CKeyStore& keystore, const CTxDestination &dest);\n bool ExtractDestination(const CScript& scriptPubKey, CTxDestination& addressRet);\n bool ExtractDestinations(const CScript& scriptPubKey, txnouttype& typeRet, std::vector<CTxDestination>& addressRet, int& nRequiredRet);\n+bool SignSignature(const CKeyStore& keystore, const CScript& fromPubKey, CTransaction& txTo, unsigned int nIn, int nHashType=SIGHASH_ALL);\n bool SignSignature(const CKeyStore& keystore, const CTransaction& txFrom, CTransaction& txTo, unsigned int nIn, int nHashType=SIGHASH_ALL);\n+bool VerifyScript(const CScript& scriptSig, const CScript& scriptPubKey, const CTransaction& txTo, unsigned int nIn,\n+                  bool fValidatePayToScriptHash, int nHashType);\n bool VerifySignature(const CTransaction& txFrom, const CTransaction& txTo, unsigned int nIn, bool fValidatePayToScriptHash, int nHashType);\n \n #endif"
      }
    ]
  },
  {
    "sha": "899d373b3ccb3003f8f6e518ba4cf7ba4028e58b",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo4OTlkMzczYjNjY2IzMDAzZjhmNmU1MThiYTRjZjdiYTQwMjhlNThi",
    "commit": {
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2012-06-22T22:36:42Z"
      },
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2012-07-05T16:42:25Z"
      },
      "message": "RPCTypeCheck method to make type-checking JSON Arrays easier.",
      "tree": {
        "sha": "2e35daa5f4d32a335fee22b6a8a1b28a5a0df768",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/2e35daa5f4d32a335fee22b6a8a1b28a5a0df768"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/899d373b3ccb3003f8f6e518ba4cf7ba4028e58b",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/899d373b3ccb3003f8f6e518ba4cf7ba4028e58b",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/899d373b3ccb3003f8f6e518ba4cf7ba4028e58b",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/899d373b3ccb3003f8f6e518ba4cf7ba4028e58b/comments",
    "author": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "34420d655d8c1cf15e53803ca85e0ac2a2a62fe9",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/34420d655d8c1cf15e53803ca85e0ac2a2a62fe9",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/34420d655d8c1cf15e53803ca85e0ac2a2a62fe9"
      }
    ],
    "stats": {
      "total": 52,
      "additions": 52,
      "deletions": 0
    },
    "files": [
      {
        "sha": "c9413a5b29724b2c1a854c762a0df803d20535ee",
        "filename": "src/bitcoinrpc.cpp",
        "status": "modified",
        "additions": 37,
        "deletions": 0,
        "changes": 37,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/899d373b3ccb3003f8f6e518ba4cf7ba4028e58b/src/bitcoinrpc.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/899d373b3ccb3003f8f6e518ba4cf7ba4028e58b/src/bitcoinrpc.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoinrpc.cpp?ref=899d373b3ccb3003f8f6e518ba4cf7ba4028e58b",
        "patch": "@@ -63,6 +63,43 @@ Object JSONRPCError(int code, const string& message)\n     return error;\n }\n \n+void RPCTypeCheck(const Array& params,\n+                  const list<Value_type>& typesExpected)\n+{\n+    int i = 0;\n+    BOOST_FOREACH(Value_type t, typesExpected)\n+    {\n+        if (params.size() <= i)\n+            break;\n+\n+       const Value& v = params[i];\n+        if (v.type() != t)\n+        {\n+            string err = strprintf(\"Expected type %s, got %s\",\n+                                   Value_type_name[t], Value_type_name[v.type()]);\n+            throw JSONRPCError(-3, err);\n+        }\n+        i++;\n+    }\n+}\n+\n+void RPCTypeCheck(const Object& o,\n+                  const map<string, Value_type>& typesExpected)\n+{\n+    BOOST_FOREACH(const PAIRTYPE(string, Value_type)& t, typesExpected)\n+    {\n+        const Value& v = find_value(o, t.first);\n+        if (v.type() == null_type)\n+            throw JSONRPCError(-3, strprintf(\"Missing %s\", t.first.c_str()));\n+        if (v.type() != t.second)\n+        {\n+            string err = strprintf(\"Expected type %s for %s, got %s\",\n+                                   Value_type_name[t.second], t.first.c_str(), Value_type_name[v.type()]);\n+            throw JSONRPCError(-3, err);\n+        }\n+    }\n+}\n+\n double GetDifficulty(const CBlockIndex* blockindex = NULL)\n {\n     // Floating point number that is a multiple of the minimum difficulty,"
      },
      {
        "sha": "b71d17ef29f19651a98a87417393d54f20a18a38",
        "filename": "src/bitcoinrpc.h",
        "status": "modified",
        "additions": 15,
        "deletions": 0,
        "changes": 15,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/899d373b3ccb3003f8f6e518ba4cf7ba4028e58b/src/bitcoinrpc.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/899d373b3ccb3003f8f6e518ba4cf7ba4028e58b/src/bitcoinrpc.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoinrpc.h?ref=899d373b3ccb3003f8f6e518ba4cf7ba4028e58b",
        "patch": "@@ -7,6 +7,7 @@\n #define _BITCOINRPC_H_ 1\n \n #include <string>\n+#include <list>\n #include <map>\n \n #include \"json/json_spirit_reader_template.h\"\n@@ -21,6 +22,20 @@ int CommandLineRPC(int argc, char *argv[]);\n /** Convert parameter values for RPC call from strings to command-specific JSON objects. */\n json_spirit::Array RPCConvertValues(const std::string &strMethod, const std::vector<std::string> &strParams);\n \n+/*\n+  Type-check arguments; throws JSONRPCError if wrong type given. Does not check that\n+  the right number of arguments are passed, just that any passed are the correct type.\n+  Use like:  RPCTypeCheck(params, boost::assign::list_of(str_type)(int_type)(obj_type));\n+*/\n+void RPCTypeCheck(const json_spirit::Array& params,\n+                  const std::list<json_spirit::Value_type>& typesExpected);\n+/*\n+  Check for expected keys/value types in an Object.\n+  Use like: RPCTypeCheck(object, boost::assign::map_list_of(\"name\", str_type)(\"value\", int_type));\n+*/\n+void RPCTypeCheck(const json_spirit::Object& o,\n+                  const std::map<std::string, json_spirit::Value_type>& typesExpected);\n+\n typedef json_spirit::Value(*rpcfn_type)(const json_spirit::Array& params, bool fHelp);\n \n class CRPCCommand"
      }
    ]
  },
  {
    "sha": "a2709fad7f57b000333371954016045e12fc4bed",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzphMjcwOWZhZDdmNTdiMDAwMzMzMzcxOTU0MDE2MDQ1ZTEyZmM0YmVk",
    "commit": {
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2012-05-31T20:01:16Z"
      },
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2012-07-05T16:50:09Z"
      },
      "message": "Implement raw transaction RPC calls\n\nImplement listunspent / getrawtransaction / createrawtransaction /\nsignrawtransaction, to support creation and\nsigning-on-multiple-device multisignature transactions.",
      "tree": {
        "sha": "378022e0c8b67dbd02a138b792bdb7be777e5822",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/378022e0c8b67dbd02a138b792bdb7be777e5822"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/a2709fad7f57b000333371954016045e12fc4bed",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a2709fad7f57b000333371954016045e12fc4bed",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/a2709fad7f57b000333371954016045e12fc4bed",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a2709fad7f57b000333371954016045e12fc4bed/comments",
    "author": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "899d373b3ccb3003f8f6e518ba4cf7ba4028e58b",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/899d373b3ccb3003f8f6e518ba4cf7ba4028e58b",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/899d373b3ccb3003f8f6e518ba4cf7ba4028e58b"
      }
    ],
    "stats": {
      "total": 806,
      "additions": 750,
      "deletions": 56
    },
    "files": [
      {
        "sha": "22f624d59c1cec936f26cdaf2fd2378a7987987a",
        "filename": "bitcoin-qt.pro",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a2709fad7f57b000333371954016045e12fc4bed/bitcoin-qt.pro",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a2709fad7f57b000333371954016045e12fc4bed/bitcoin-qt.pro",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/bitcoin-qt.pro?ref=a2709fad7f57b000333371954016045e12fc4bed",
        "patch": "@@ -207,6 +207,7 @@ SOURCES += src/qt/bitcoin.cpp src/qt/bitcoingui.cpp \\\n     src/bitcoinrpc.cpp \\\n     src/rpcdump.cpp \\\n     src/rpcnet.cpp \\\n+    src/rpcrawtransaction.cpp \\\n     src/qt/overviewpage.cpp \\\n     src/qt/csvmodelwriter.cpp \\\n     src/crypter.cpp \\"
      },
      {
        "sha": "adcf359c9f1f2f4ccd2270d49c51ca7f05258547",
        "filename": "src/bitcoinrpc.cpp",
        "status": "modified",
        "additions": 23,
        "deletions": 43,
        "changes": 66,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a2709fad7f57b000333371954016045e12fc4bed/src/bitcoinrpc.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a2709fad7f57b000333371954016045e12fc4bed/src/bitcoinrpc.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoinrpc.cpp?ref=a2709fad7f57b000333371954016045e12fc4bed",
        "patch": "@@ -46,10 +46,16 @@ static std::string strRPCUserColonPass;\n static int64 nWalletUnlockTime;\n static CCriticalSection cs_nWalletUnlockTime;\n \n-extern Value getconnectioncount(const Array& params, bool fHelp);\n+extern Value getconnectioncount(const Array& params, bool fHelp); // in rpcnet.cpp\n extern Value getpeerinfo(const Array& params, bool fHelp);\n-extern Value dumpprivkey(const Array& params, bool fHelp);\n+extern Value dumpprivkey(const Array& params, bool fHelp); // in rpcdump.cpp\n extern Value importprivkey(const Array& params, bool fHelp);\n+extern Value getrawtransaction(const Array& params, bool fHelp); // in rcprawtransaction.cpp\n+extern Value listunspent(const Array& params, bool fHelp);\n+extern Value createrawtransaction(const Array& params, bool fHelp);\n+extern Value decoderawtransaction(const Array& params, bool fHelp);\n+extern Value signrawtransaction(const Array& params, bool fHelp);\n+extern Value sendrawtransaction(const Array& params, bool fHelp);\n \n const Object emptyobj;\n \n@@ -159,15 +165,15 @@ HexBits(unsigned int nBits)\n     return HexStr(BEGIN(uBits.cBits), END(uBits.cBits));\n }\n \n-static std::string\n+std::string\n HelpRequiringPassphrase()\n {\n     return pwalletMain->IsCrypted()\n         ? \"\\nrequires wallet passphrase to be set with walletpassphrase first\"\n         : \"\";\n }\n \n-static inline void\n+void\n EnsureWalletIsUnlocked()\n {\n     if (pwalletMain->IsLocked())\n@@ -2048,44 +2054,6 @@ Value getblock(const Array& params, bool fHelp)\n     return blockToJSON(block, pblockindex);\n }\n \n-Value sendrawtx(const Array& params, bool fHelp)\n-{\n-    if (fHelp || params.size() < 1 || params.size() > 1)\n-        throw runtime_error(\n-            \"sendrawtx <hex string>\\n\"\n-            \"Submits raw transaction (serialized, hex-encoded) to local node and network.\");\n-\n-    // parse hex string from parameter\n-    vector<unsigned char> txData(ParseHex(params[0].get_str()));\n-    CDataStream ssData(txData, SER_NETWORK, PROTOCOL_VERSION);\n-    CTransaction tx;\n-\n-    // deserialize binary data stream\n-    try {\n-        ssData >> tx;\n-    }\n-    catch (std::exception &e) {\n-        throw JSONRPCError(-22, \"TX decode failed\");\n-    }\n-\n-    // push to local node\n-    CTxDB txdb(\"r\");\n-    if (!tx.AcceptToMemoryPool(txdb))\n-        throw JSONRPCError(-22, \"TX rejected\");\n-\n-    SyncWithWallets(tx, NULL, true);\n-\n-    // relay to network\n-    CInv inv(MSG_TX, tx.GetHash());\n-    RelayInventory(inv);\n-\n-    return tx.GetHash().GetHex();\n-}\n-\n-\n-\n-\n-\n \n \n \n@@ -2147,7 +2115,12 @@ static const CRPCCommand vRPCCommands[] =\n     { \"listsinceblock\",         &listsinceblock,         false },\n     { \"dumpprivkey\",            &dumpprivkey,            false },\n     { \"importprivkey\",          &importprivkey,          false },\n-    { \"sendrawtx\",              &sendrawtx,              false },\n+    { \"listunspent\",            &listunspent,            false },\n+    { \"getrawtransaction\",      &getrawtransaction,      false },\n+    { \"createrawtransaction\",   &createrawtransaction,   false },\n+    { \"decoderawtransaction\",   &decoderawtransaction,   false },\n+    { \"signrawtransaction\",     &signrawtransaction,     false },\n+    { \"sendrawtransaction\",     &sendrawtransaction,     false },\n };\n \n CRPCTable::CRPCTable()\n@@ -3021,6 +2994,13 @@ Array RPCConvertValues(const std::string &strMethod, const std::vector<std::stri\n     if (strMethod == \"sendmany\"               && n > 2) ConvertTo<boost::int64_t>(params[2]);\n     if (strMethod == \"addmultisigaddress\"     && n > 0) ConvertTo<boost::int64_t>(params[0]);\n     if (strMethod == \"addmultisigaddress\"     && n > 1) ConvertTo<Array>(params[1]);\n+    if (strMethod == \"listunspent\"            && n > 0) ConvertTo<boost::int64_t>(params[0]);\n+    if (strMethod == \"listunspent\"            && n > 1) ConvertTo<boost::int64_t>(params[1]);\n+    if (strMethod == \"getrawtransaction\"      && n > 1) ConvertTo<boost::int64_t>(params[1]);\n+    if (strMethod == \"createrawtransaction\"   && n > 0) ConvertTo<Array>(params[0]);\n+    if (strMethod == \"createrawtransaction\"   && n > 1) ConvertTo<Object>(params[1]);\n+    if (strMethod == \"signrawtransaction\"     && n > 1) ConvertTo<Array>(params[1]);\n+    if (strMethod == \"signrawtransaction\"     && n > 2) ConvertTo<Array>(params[2]);\n \n     return params;\n }"
      },
      {
        "sha": "e7cbb47046b1426666ec4ead8ea1bc3c81c63c9a",
        "filename": "src/makefile.linux-mingw",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a2709fad7f57b000333371954016045e12fc4bed/src/makefile.linux-mingw",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a2709fad7f57b000333371954016045e12fc4bed/src/makefile.linux-mingw",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/makefile.linux-mingw?ref=a2709fad7f57b000333371954016045e12fc4bed",
        "patch": "@@ -61,6 +61,7 @@ OBJS= \\\n     obj/bitcoinrpc.o \\\n     obj/rpcdump.o \\\n     obj/rpcnet.o \\\n+    obj/rpcrawtransaction.o \\\n     obj/script.o \\\n     obj/sync.o \\\n     obj/util.o \\"
      },
      {
        "sha": "e60b3201ff3d3368dcf95cd455b534f9969ac622",
        "filename": "src/makefile.mingw",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a2709fad7f57b000333371954016045e12fc4bed/src/makefile.mingw",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a2709fad7f57b000333371954016045e12fc4bed/src/makefile.mingw",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/makefile.mingw?ref=a2709fad7f57b000333371954016045e12fc4bed",
        "patch": "@@ -58,6 +58,7 @@ OBJS= \\\n     obj/bitcoinrpc.o \\\n     obj/rpcdump.o \\\n     obj/rpcnet.o \\\n+    obj/rpcrawtransaction.o \\\n     obj/script.o \\\n     obj/sync.o \\\n     obj/util.o \\"
      },
      {
        "sha": "f9f28267bed664679f83c2fb8104c001e7a532ec",
        "filename": "src/makefile.osx",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a2709fad7f57b000333371954016045e12fc4bed/src/makefile.osx",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a2709fad7f57b000333371954016045e12fc4bed/src/makefile.osx",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/makefile.osx?ref=a2709fad7f57b000333371954016045e12fc4bed",
        "patch": "@@ -85,6 +85,7 @@ OBJS= \\\n     obj/bitcoinrpc.o \\\n     obj/rpcdump.o \\\n     obj/rpcnet.o \\\n+    obj/rpcrawtransaction.o \\\n     obj/script.o \\\n     obj/sync.o \\\n     obj/util.o \\"
      },
      {
        "sha": "2784335a20cfd764ef44168a40025ef4ca62024e",
        "filename": "src/makefile.unix",
        "status": "modified",
        "additions": 1,
        "deletions": 0,
        "changes": 1,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a2709fad7f57b000333371954016045e12fc4bed/src/makefile.unix",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a2709fad7f57b000333371954016045e12fc4bed/src/makefile.unix",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/makefile.unix?ref=a2709fad7f57b000333371954016045e12fc4bed",
        "patch": "@@ -105,6 +105,7 @@ OBJS= \\\n     obj/bitcoinrpc.o \\\n     obj/rpcdump.o \\\n     obj/rpcnet.o \\\n+    obj/rpcrawtransaction.o \\\n     obj/script.o \\\n     obj/sync.o \\\n     obj/util.o \\"
      },
      {
        "sha": "0e8c806834c5a9f5f9f4e5c35f3a257a39fe9968",
        "filename": "src/rpcrawtransaction.cpp",
        "status": "added",
        "additions": 470,
        "deletions": 0,
        "changes": 470,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a2709fad7f57b000333371954016045e12fc4bed/src/rpcrawtransaction.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a2709fad7f57b000333371954016045e12fc4bed/src/rpcrawtransaction.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpcrawtransaction.cpp?ref=a2709fad7f57b000333371954016045e12fc4bed",
        "patch": "@@ -0,0 +1,470 @@\n+// Copyright (c) 2010 Satoshi Nakamoto\n+// Copyright (c) 2009-2012 The Bitcoin developers\n+// Distributed under the MIT/X11 software license, see the accompanying\n+// file COPYING or http://www.opensource.org/licenses/mit-license.php.\n+\n+#include <boost/assign/list_of.hpp>\n+\n+#include \"base58.h\"\n+#include \"bitcoinrpc.h\"\n+#include \"db.h\"\n+#include \"init.h\"\n+#include \"main.h\"\n+#include \"wallet.h\"\n+\n+using namespace std;\n+using namespace boost;\n+using namespace boost::assign;\n+using namespace json_spirit;\n+\n+// These are all in bitcoinrpc.cpp:\n+extern Object JSONRPCError(int code, const string& message);\n+extern int64 AmountFromValue(const Value& value);\n+extern Value ValueFromAmount(int64 amount);\n+extern std::string HelpRequiringPassphrase();\n+extern void EnsureWalletIsUnlocked();\n+\n+void\n+ScriptPubKeyToJSON(const CScript& scriptPubKey, Object& out)\n+{\n+    txnouttype type;\n+    vector<CTxDestination> addresses;\n+    int nRequired;\n+\n+    out.push_back(Pair(\"asm\", scriptPubKey.ToString()));\n+    out.push_back(Pair(\"hex\", HexStr(scriptPubKey.begin(), scriptPubKey.end())));\n+\n+    if (!ExtractDestinations(scriptPubKey, type, addresses, nRequired))\n+    {\n+        out.push_back(Pair(\"type\", GetTxnOutputType(TX_NONSTANDARD)));\n+        return;\n+    }\n+\n+    out.push_back(Pair(\"reqSigs\", nRequired));\n+    out.push_back(Pair(\"type\", GetTxnOutputType(type)));\n+\n+    Array a;\n+    BOOST_FOREACH(const CTxDestination& addr, addresses)\n+        a.push_back(CBitcoinAddress(addr).ToString());\n+    out.push_back(Pair(\"addresses\", a));\n+}\n+\n+void\n+TxToJSON(const CTransaction& tx, const uint256 hashBlock, Object& entry)\n+{\n+    entry.push_back(Pair(\"txid\", tx.GetHash().GetHex()));\n+    entry.push_back(Pair(\"version\", tx.nVersion));\n+    entry.push_back(Pair(\"locktime\", (boost::int64_t)tx.nLockTime));\n+    Array vin;\n+    BOOST_FOREACH(const CTxIn& txin, tx.vin)\n+    {\n+        Object in;\n+        if (tx.IsCoinBase())\n+            in.push_back(Pair(\"coinbase\", HexStr(txin.scriptSig.begin(), txin.scriptSig.end())));\n+        else\n+        {\n+            in.push_back(Pair(\"txid\", txin.prevout.hash.GetHex()));\n+            in.push_back(Pair(\"vout\", (boost::int64_t)txin.prevout.n));\n+            Object o;\n+            o.push_back(Pair(\"asm\", txin.scriptSig.ToString()));\n+            o.push_back(Pair(\"hex\", HexStr(txin.scriptSig.begin(), txin.scriptSig.end())));\n+            in.push_back(Pair(\"scriptSig\", o));\n+        }\n+        in.push_back(Pair(\"sequence\", (boost::int64_t)txin.nSequence));\n+        vin.push_back(in);\n+    }\n+    entry.push_back(Pair(\"vin\", vin));\n+    Array vout;\n+    for (int i = 0; i < tx.vout.size(); i++)\n+    {\n+        const CTxOut& txout = tx.vout[i];\n+        Object out;\n+        out.push_back(Pair(\"value\", ValueFromAmount(txout.nValue)));\n+        out.push_back(Pair(\"n\", i));\n+        Object o;\n+        ScriptPubKeyToJSON(txout.scriptPubKey, o);\n+        out.push_back(Pair(\"scriptPubKey\", o));\n+        vout.push_back(out);\n+    }\n+    entry.push_back(Pair(\"vout\", vout));\n+\n+    if (hashBlock != 0)\n+    {\n+        entry.push_back(Pair(\"blockhash\", hashBlock.GetHex()));\n+        map<uint256, CBlockIndex*>::iterator mi = mapBlockIndex.find(hashBlock);\n+        if (mi != mapBlockIndex.end() && (*mi).second)\n+        {\n+            CBlockIndex* pindex = (*mi).second;\n+            if (pindex->IsInMainChain())\n+            {\n+                entry.push_back(Pair(\"confirmations\", 1 + nBestHeight - pindex->nHeight));\n+                entry.push_back(Pair(\"time\", (boost::int64_t)pindex->nTime));\n+            }\n+            else\n+                entry.push_back(Pair(\"confirmations\", 0));\n+        }\n+    }\n+}\n+\n+Value getrawtransaction(const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size() < 1 || params.size() > 2)\n+        throw runtime_error(\n+            \"getrawtransaction <txid> [verbose=0]\\n\"\n+            \"If verbose=0, returns a string that is\\n\"\n+            \"serialized, hex-encoded data for <txid>.\\n\"\n+            \"If verbose is non-zero, returns an Object\\n\"\n+            \"with information about <txid>.\");\n+\n+    uint256 hash;\n+    hash.SetHex(params[0].get_str());\n+\n+    bool fVerbose = false;\n+    if (params.size() > 1)\n+        fVerbose = (params[1].get_int() != 0);\n+\n+    CTransaction tx;\n+    uint256 hashBlock = 0;\n+    if (!GetTransaction(hash, tx, hashBlock))\n+        throw JSONRPCError(-5, \"No information available about transaction\");\n+\n+    CDataStream ssTx(SER_NETWORK, PROTOCOL_VERSION);\n+    ssTx << tx;\n+    string strHex = HexStr(ssTx.begin(), ssTx.end());\n+\n+    if (!fVerbose)\n+        return strHex;\n+\n+    Object result;\n+    result.push_back(Pair(\"hex\", strHex));\n+    TxToJSON(tx, hashBlock, result);\n+    return result;\n+}\n+\n+Value listunspent(const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size() > 2)\n+        throw runtime_error(\n+            \"listunspent [minconf=1] [maxconf=999999]\\n\"\n+            \"Returns array of unspent transaction outputs\\n\"\n+            \"with between minconf and maxconf (inclusive) confirmations.\\n\"\n+            \"Results are an array of Objects, each of which has:\\n\"\n+            \"{txid, vout, scriptPubKey, amount, confirmations}\");\n+\n+    RPCTypeCheck(params, list_of(int_type)(int_type));\n+\n+    int nMinDepth = 1;\n+    if (params.size() > 0)\n+        nMinDepth = params[0].get_int();\n+\n+    int nMaxDepth = 999999;\n+    if (params.size() > 1)\n+        nMaxDepth = params[1].get_int();\n+\n+    Array results;\n+    vector<COutput> vecOutputs;\n+    pwalletMain->AvailableCoins(vecOutputs, false);\n+    BOOST_FOREACH(const COutput& out, vecOutputs)\n+    {\n+        if (out.nDepth < nMinDepth || out.nDepth > nMaxDepth)\n+            continue;\n+\n+        int64 nValue = out.tx->vout[out.i].nValue;\n+        const CScript& pk = out.tx->vout[out.i].scriptPubKey;\n+        Object entry;\n+        entry.push_back(Pair(\"txid\", out.tx->GetHash().GetHex()));\n+        entry.push_back(Pair(\"vout\", out.i));\n+        entry.push_back(Pair(\"scriptPubKey\", HexStr(pk.begin(), pk.end())));\n+        entry.push_back(Pair(\"amount\",ValueFromAmount(nValue)));\n+        entry.push_back(Pair(\"confirmations\",out.nDepth));\n+        results.push_back(entry);\n+    }\n+\n+    return results;\n+}\n+\n+Value createrawtransaction(const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size() != 2)\n+        throw runtime_error(\n+            \"createrawtransaction [{\\\"txid\\\":txid,\\\"vout\\\":n},...] {address:amount,...}\\n\"\n+            \"Create a transaction spending given inputs\\n\"\n+            \"(array of objects containing transaction id and output number),\\n\"\n+            \"sending to given address(es).\\n\"\n+            \"Returns hex-encoded raw transaction.\\n\"\n+            \"Note that the transaction's inputs are not signed, and\\n\"\n+            \"it is not stored in the wallet or transmitted to the network.\");\n+\n+    RPCTypeCheck(params, list_of(array_type)(obj_type));\n+\n+    Array inputs = params[0].get_array();\n+    Object sendTo = params[1].get_obj();\n+\n+    CTransaction rawTx;\n+\n+    BOOST_FOREACH(Value& input, inputs)\n+    {\n+        const Object& o = input.get_obj();\n+\n+        const Value& txid_v = find_value(o, \"txid\");\n+        if (txid_v.type() != str_type)\n+            throw JSONRPCError(-8, \"Invalid parameter, missing txid key\");\n+        string txid = txid_v.get_str();\n+        if (!IsHex(txid))\n+            throw JSONRPCError(-8, \"Invalid parameter, expected hex txid\");\n+\n+        const Value& vout_v = find_value(o, \"vout\");\n+        if (vout_v.type() != int_type)\n+            throw JSONRPCError(-8, \"Invalid parameter, missing vout key\");\n+        int nOutput = vout_v.get_int();\n+        if (nOutput < 0)\n+            throw JSONRPCError(-8, \"Invalid parameter, vout must be positive\");\n+\n+        CTxIn in(COutPoint(uint256(txid), nOutput));\n+        rawTx.vin.push_back(in);\n+    }\n+\n+    set<CBitcoinAddress> setAddress;\n+    BOOST_FOREACH(const Pair& s, sendTo)\n+    {\n+        CBitcoinAddress address(s.name_);\n+        if (!address.IsValid())\n+            throw JSONRPCError(-5, string(\"Invalid Bitcoin address:\")+s.name_);\n+\n+        if (setAddress.count(address))\n+            throw JSONRPCError(-8, string(\"Invalid parameter, duplicated address: \")+s.name_);\n+        setAddress.insert(address);\n+\n+        CScript scriptPubKey;\n+        scriptPubKey.SetDestination(address.Get());\n+        int64 nAmount = AmountFromValue(s.value_);\n+\n+        CTxOut out(nAmount, scriptPubKey);\n+        rawTx.vout.push_back(out);\n+    }\n+\n+    CDataStream ss(SER_NETWORK, PROTOCOL_VERSION);\n+    ss << rawTx;\n+    return HexStr(ss.begin(), ss.end());\n+}\n+\n+Value decoderawtransaction(const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size() != 1)\n+        throw runtime_error(\n+            \"decoderawtransaction <hex string>\\n\"\n+            \"Return a JSON object representing the serialized, hex-encoded transaction.\");\n+\n+    RPCTypeCheck(params, list_of(str_type));\n+\n+    vector<unsigned char> txData(ParseHex(params[0].get_str()));\n+    CDataStream ssData(txData, SER_NETWORK, PROTOCOL_VERSION);\n+    CTransaction tx;\n+    try {\n+        ssData >> tx;\n+    }\n+    catch (std::exception &e) {\n+        throw JSONRPCError(-22, \"TX decode failed\");\n+    }\n+\n+    Object result;\n+    TxToJSON(tx, 0, result);\n+\n+    return result;\n+}\n+\n+Value signrawtransaction(const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size() < 1 || params.size() > 3)\n+        throw runtime_error(\n+            \"signrawtransaction <hex string> [{\\\"txid\\\":txid,\\\"vout\\\":n,\\\"scriptPubKey\\\":hex},...] [<privatekey1>,...]\\n\"\n+            \"Sign inputs for raw transaction (serialized, hex-encoded).\\n\"\n+            \"Second optional argument is an array of previous transaction outputs that\\n\"\n+            \"this transaction depends on but may not yet be in the blockchain.\\n\"\n+            \"Third optional argument is an array of base58-encoded private\\n\"\n+            \"keys that, if given, will be the only keys used to sign the transaction.\\n\"\n+            \"Returns json object with keys:\\n\"\n+            \"  hex : raw transaction with signature(s) (hex-encoded string)\\n\"\n+            \"  complete : 1 if transaction has a complete set of signature (0 if not)\"\n+            + HelpRequiringPassphrase());\n+\n+    if (params.size() < 3)\n+        EnsureWalletIsUnlocked();\n+\n+    RPCTypeCheck(params, list_of(str_type)(array_type)(array_type));\n+\n+    vector<unsigned char> txData(ParseHex(params[0].get_str()));\n+    CDataStream ssData(txData, SER_NETWORK, PROTOCOL_VERSION);\n+    vector<CTransaction> txVariants;\n+    while (!ssData.empty())\n+    {\n+        try {\n+            CTransaction tx;\n+            ssData >> tx;\n+            txVariants.push_back(tx);\n+        }\n+        catch (std::exception &e) {\n+            throw JSONRPCError(-22, \"TX decode failed\");\n+        }\n+    }\n+\n+    if (txVariants.empty())\n+        throw JSONRPCError(-22, \"Missing transaction\");\n+\n+    // mergedTx will end up with all the signatures; it\n+    // starts as a clone of the rawtx:\n+    CTransaction mergedTx(txVariants[0]);\n+    bool fComplete = true;\n+\n+    // Fetch previous transactions (inputs):\n+    map<COutPoint, CScript> mapPrevOut;\n+    {\n+        MapPrevTx mapPrevTx;\n+        CTxDB txdb(\"r\");\n+        map<uint256, CTxIndex> unused;\n+        bool fInvalid;\n+        mergedTx.FetchInputs(txdb, unused, false, false, mapPrevTx, fInvalid);\n+\n+        // Copy results into mapPrevOut:\n+        BOOST_FOREACH(const CTxIn& txin, mergedTx.vin)\n+        {\n+            const uint256& prevHash = txin.prevout.hash;\n+            if (mapPrevTx.count(prevHash))\n+                mapPrevOut[txin.prevout] = mapPrevTx[prevHash].second.vout[txin.prevout.n].scriptPubKey;\n+        }\n+    }\n+\n+    // Add previous txouts given in the RPC call:\n+    if (params.size() > 1)\n+    {\n+        Array prevTxs = params[1].get_array();\n+        BOOST_FOREACH(Value& p, prevTxs)\n+        {\n+            if (p.type() != obj_type)\n+                throw JSONRPCError(-22, \"expected object with {\\\"txid'\\\",\\\"vout\\\",\\\"scriptPubKey\\\"}\");\n+\n+            Object prevOut = p.get_obj();\n+\n+            RPCTypeCheck(prevOut, map_list_of(\"txid\", str_type)(\"vout\", int_type)(\"scriptPubKey\", str_type));\n+\n+            string txidHex = find_value(prevOut, \"txid\").get_str();\n+            if (!IsHex(txidHex))\n+                throw JSONRPCError(-22, \"txid must be hexadecimal\");\n+            uint256 txid;\n+            txid.SetHex(txidHex);\n+\n+            int nOut = find_value(prevOut, \"vout\").get_int();\n+            if (nOut < 0)\n+                throw JSONRPCError(-22, \"vout must be positive\");\n+\n+            string pkHex = find_value(prevOut, \"scriptPubKey\").get_str();\n+            if (!IsHex(pkHex))\n+                throw JSONRPCError(-22, \"scriptPubKey must be hexadecimal\");\n+            vector<unsigned char> pkData(ParseHex(pkHex));\n+            CScript scriptPubKey(pkData.begin(), pkData.end());\n+\n+            COutPoint outpoint(txid, nOut);\n+            if (mapPrevOut.count(outpoint))\n+            {\n+                // Complain if scriptPubKey doesn't match\n+                if (mapPrevOut[outpoint] != scriptPubKey)\n+                {\n+                    string err(\"Previous output scriptPubKey mismatch:\\n\");\n+                    err = err + mapPrevOut[outpoint].ToString() + \"\\nvs:\\n\"+\n+                        scriptPubKey.ToString();\n+                    throw JSONRPCError(-22, err);\n+                }\n+            }\n+            else\n+                mapPrevOut[outpoint] = scriptPubKey;\n+        }\n+    }\n+\n+    bool fGivenKeys = false;\n+    CBasicKeyStore tempKeystore;\n+    if (params.size() > 2)\n+    {\n+        fGivenKeys = true;\n+        Array keys = params[2].get_array();\n+        BOOST_FOREACH(Value k, keys)\n+        {\n+            CBitcoinSecret vchSecret;\n+            bool fGood = vchSecret.SetString(k.get_str());\n+            if (!fGood)\n+                throw JSONRPCError(-5,\"Invalid private key\");\n+            CKey key;\n+            bool fCompressed;\n+            CSecret secret = vchSecret.GetSecret(fCompressed);\n+            key.SetSecret(secret, fCompressed);\n+            tempKeystore.AddKey(key);\n+        }\n+    }\n+    const CKeyStore& keystore = (fGivenKeys ? tempKeystore : *pwalletMain);\n+\n+    // Sign what we can:\n+    for (int i = 0; i < mergedTx.vin.size(); i++)\n+    {\n+        CTxIn& txin = mergedTx.vin[i];\n+        if (mapPrevOut.count(txin.prevout) == 0)\n+        {\n+            fComplete = false;\n+            continue;\n+        }\n+        const CScript& prevPubKey = mapPrevOut[txin.prevout];\n+\n+        txin.scriptSig.clear();\n+        SignSignature(keystore, prevPubKey, mergedTx, i);\n+\n+        // ... and merge in other signatures:\n+        BOOST_FOREACH(const CTransaction& txv, txVariants)\n+        {\n+            txin.scriptSig = CombineSignatures(prevPubKey, mergedTx, i, txin.scriptSig, txv.vin[i].scriptSig);\n+        }\n+        if (!VerifyScript(txin.scriptSig, prevPubKey, mergedTx, i, true, 0))\n+            fComplete = false;\n+    }\n+\n+    Object result;\n+    CDataStream ssTx(SER_NETWORK, PROTOCOL_VERSION);\n+    ssTx << mergedTx;\n+    result.push_back(Pair(\"hex\", HexStr(ssTx.begin(), ssTx.end())));\n+    result.push_back(Pair(\"complete\", fComplete));\n+\n+    return result;\n+}\n+\n+Value sendrawtransaction(const Array& params, bool fHelp)\n+{\n+    if (fHelp || params.size() < 1 || params.size() > 1)\n+        throw runtime_error(\n+            \"sendrawtransaction <hex string>\\n\"\n+            \"Submits raw transaction (serialized, hex-encoded) to local node and network.\");\n+\n+    RPCTypeCheck(params, list_of(str_type));\n+\n+    // parse hex string from parameter\n+    vector<unsigned char> txData(ParseHex(params[0].get_str()));\n+    CDataStream ssData(txData, SER_NETWORK, PROTOCOL_VERSION);\n+    CTransaction tx;\n+\n+    // deserialize binary data stream\n+    try {\n+        ssData >> tx;\n+    }\n+    catch (std::exception &e) {\n+        throw JSONRPCError(-22, \"TX decode failed\");\n+    }\n+\n+    // push to local node\n+    CTxDB txdb(\"r\");\n+    if (!tx.AcceptToMemoryPool(txdb))\n+        throw JSONRPCError(-22, \"TX rejected\");\n+\n+    SyncWithWallets(tx, NULL, true);\n+\n+    // relay to network\n+    CInv inv(MSG_TX, tx.GetHash());\n+    RelayInventory(inv);\n+\n+    return tx.GetHash().GetHex();\n+}"
      },
      {
        "sha": "103fc0e422fc04cb47b541d525f65bea032f51cf",
        "filename": "src/script.cpp",
        "status": "modified",
        "additions": 129,
        "deletions": 10,
        "changes": 139,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a2709fad7f57b000333371954016045e12fc4bed/src/script.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a2709fad7f57b000333371954016045e12fc4bed/src/script.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script.cpp?ref=a2709fad7f57b000333371954016045e12fc4bed",
        "patch": "@@ -1331,15 +1331,12 @@ bool SignN(const vector<valtype>& multisigdata, const CKeyStore& keystore, uint2\n {\n     int nSigned = 0;\n     int nRequired = multisigdata.front()[0];\n-    for (vector<valtype>::const_iterator it = multisigdata.begin()+1; it != multisigdata.begin()+multisigdata.size()-1; it++)\n+    for (int i = 1; i < multisigdata.size()-1 && nSigned < nRequired; i++)\n     {\n-        const valtype& pubkey = *it;\n+        const valtype& pubkey = multisigdata[i];\n         CKeyID keyID = CPubKey(pubkey).GetID();\n         if (Sign1(keyID, keystore, hash, nHashType, scriptSigRet))\n-        {\n             ++nSigned;\n-            if (nSigned == nRequired) break;\n-        }\n     }\n     return nSigned==nRequired;\n }\n@@ -1612,12 +1609,13 @@ bool SignSignature(const CKeyStore &keystore, const CScript& fromPubKey, CTransa\n \n         // Recompute txn hash using subscript in place of scriptPubKey:\n         uint256 hash2 = SignatureHash(subscript, txTo, nIn, nHashType);\n+\n         txnouttype subType;\n-        if (!Solver(keystore, subscript, hash2, nHashType, txin.scriptSig, subType))\n-            return false;\n-        if (subType == TX_SCRIPTHASH)\n-            return false;\n-        txin.scriptSig << static_cast<valtype>(subscript); // Append serialized subscript\n+        bool fSolved =\n+            Solver(keystore, subscript, hash2, nHashType, txin.scriptSig, subType) && subType != TX_SCRIPTHASH;\n+        // Append serialized subscript whether or not it is completely signed:\n+        txin.scriptSig << static_cast<valtype>(subscript);\n+        if (!fSolved) return false;\n     }\n \n     // Test solution\n@@ -1648,6 +1646,127 @@ bool VerifySignature(const CTransaction& txFrom, const CTransaction& txTo, unsig\n     return VerifyScript(txin.scriptSig, txout.scriptPubKey, txTo, nIn, fValidatePayToScriptHash, nHashType);\n }\n \n+static CScript PushAll(const vector<valtype>& values)\n+{\n+    CScript result;\n+    BOOST_FOREACH(const valtype& v, values)\n+        result << v;\n+    return result;\n+}\n+\n+static CScript CombineMultisig(CScript scriptPubKey, const CTransaction& txTo, unsigned int nIn,\n+                               const vector<valtype>& vSolutions,\n+                               vector<valtype>& sigs1, vector<valtype>& sigs2)\n+{\n+    // Combine all the signatures we've got:\n+    set<valtype> allsigs;\n+    BOOST_FOREACH(const valtype& v, sigs1)\n+    {\n+        if (!v.empty())\n+            allsigs.insert(v);\n+    }\n+    BOOST_FOREACH(const valtype& v, sigs2)\n+    {\n+        if (!v.empty())\n+            allsigs.insert(v);\n+    }\n+\n+    // Build a map of pubkey -> signature by matching sigs to pubkeys:\n+    int nSigsRequired = vSolutions.front()[0];\n+    int nPubKeys = vSolutions.size()-2;\n+    map<valtype, valtype> sigs;\n+    BOOST_FOREACH(const valtype& sig, allsigs)\n+    {\n+        for (int i = 0; i < nPubKeys; i++)\n+        {\n+            const valtype& pubkey = vSolutions[i+1];\n+            if (sigs.count(pubkey))\n+                continue; // Already got a sig for this pubkey\n+\n+            if (CheckSig(sig, pubkey, scriptPubKey, txTo, nIn, 0))\n+            {\n+                sigs[pubkey] = sig;\n+                break;\n+            }\n+        }\n+    }\n+    // Now build a merged CScript:\n+    unsigned int nSigsHave = 0;\n+    CScript result; result << OP_0; // pop-one-too-many workaround\n+    for (int i = 0; i < nPubKeys && nSigsHave < nSigsRequired; i++)\n+    {\n+        if (sigs.count(vSolutions[i+1]))\n+        {\n+            result << sigs[vSolutions[i+1]];\n+            ++nSigsHave;\n+        }\n+    }\n+    // Fill any missing with OP_0:\n+    for (int i = nSigsHave; i < nSigsRequired; i++)\n+        result << OP_0;\n+\n+    return result;\n+}\n+\n+static CScript CombineSignatures(CScript scriptPubKey, const CTransaction& txTo, unsigned int nIn,\n+                                 const txnouttype txType, const vector<valtype>& vSolutions,\n+                                 vector<valtype>& sigs1, vector<valtype>& sigs2)\n+{\n+    switch (txType)\n+    {\n+    case TX_NONSTANDARD:\n+        // Don't know anything about this, assume bigger one is correct:\n+        if (sigs1.size() >= sigs2.size())\n+            return PushAll(sigs1);\n+        return PushAll(sigs2);\n+    case TX_PUBKEY:\n+    case TX_PUBKEYHASH:\n+        // Signatures are bigger than placeholders or empty scripts:\n+        if (sigs1.empty() || sigs1[0].empty())\n+            return PushAll(sigs2);\n+        return PushAll(sigs1);\n+    case TX_SCRIPTHASH:\n+        if (sigs1.empty() || sigs1.back().empty())\n+            return PushAll(sigs2);\n+        else if (sigs2.empty() || sigs2.back().empty())\n+            return PushAll(sigs1);\n+        else\n+        {\n+            // Recurse to combine:\n+            valtype spk = sigs1.back();\n+            CScript pubKey2(spk.begin(), spk.end());\n+\n+            txnouttype txType2;\n+            vector<vector<unsigned char> > vSolutions2;\n+            Solver(pubKey2, txType2, vSolutions2);\n+            sigs1.pop_back();\n+            sigs2.pop_back();\n+            CScript result = CombineSignatures(pubKey2, txTo, nIn, txType2, vSolutions2, sigs1, sigs2);\n+            result << spk;\n+            return result;\n+        }\n+    case TX_MULTISIG:\n+        return CombineMultisig(scriptPubKey, txTo, nIn, vSolutions, sigs1, sigs2);\n+    }\n+\n+    return CScript();\n+}\n+\n+CScript CombineSignatures(CScript scriptPubKey, const CTransaction& txTo, unsigned int nIn,\n+                          const CScript& scriptSig1, const CScript& scriptSig2)\n+{\n+    txnouttype txType;\n+    vector<vector<unsigned char> > vSolutions;\n+    Solver(scriptPubKey, txType, vSolutions);\n+\n+    vector<valtype> stack1;\n+    EvalScript(stack1, scriptSig1, CTransaction(), 0, 0);\n+    vector<valtype> stack2;\n+    EvalScript(stack2, scriptSig2, CTransaction(), 0, 0);\n+\n+    return CombineSignatures(scriptPubKey, txTo, nIn, txType, vSolutions, stack1, stack2);\n+}\n+\n unsigned int CScript::GetSigOpCount(bool fAccurate) const\n {\n     unsigned int n = 0;"
      },
      {
        "sha": "f4db112dd69fd71c1975ed43870b02020f118f4c",
        "filename": "src/script.h",
        "status": "modified",
        "additions": 4,
        "deletions": 0,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a2709fad7f57b000333371954016045e12fc4bed/src/script.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a2709fad7f57b000333371954016045e12fc4bed/src/script.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script.h?ref=a2709fad7f57b000333371954016045e12fc4bed",
        "patch": "@@ -597,4 +597,8 @@ bool VerifyScript(const CScript& scriptSig, const CScript& scriptPubKey, const C\n                   bool fValidatePayToScriptHash, int nHashType);\n bool VerifySignature(const CTransaction& txFrom, const CTransaction& txTo, unsigned int nIn, bool fValidatePayToScriptHash, int nHashType);\n \n+// Given two sets of signatures for scriptPubKey, possibly with OP_0 placeholders,\n+// combine them intelligently and return the result.\n+CScript CombineSignatures(CScript scriptPubKey, const CTransaction& txTo, unsigned int nIn, const CScript& scriptSig1, const CScript& scriptSig2);\n+\n #endif"
      },
      {
        "sha": "61d9a64eebb2dc3158386402250072ed0182cbe5",
        "filename": "src/test/script_tests.cpp",
        "status": "modified",
        "additions": 113,
        "deletions": 0,
        "changes": 113,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a2709fad7f57b000333371954016045e12fc4bed/src/test/script_tests.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a2709fad7f57b000333371954016045e12fc4bed/src/test/script_tests.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/test/script_tests.cpp?ref=a2709fad7f57b000333371954016045e12fc4bed",
        "patch": "@@ -328,5 +328,118 @@ BOOST_AUTO_TEST_CASE(script_CHECKMULTISIG23)\n     BOOST_CHECK(!VerifyScript(badsig6, scriptPubKey23, txTo23, 0, true, 0));\n }    \n \n+BOOST_AUTO_TEST_CASE(script_combineSigs)\n+{\n+    // Test the CombineSignatures function\n+    CBasicKeyStore keystore;\n+    vector<CKey> keys;\n+    for (int i = 0; i < 3; i++)\n+    {\n+        CKey key;\n+        key.MakeNewKey(i%2 == 1);\n+        keys.push_back(key);\n+        keystore.AddKey(key);\n+    }\n+\n+    CTransaction txFrom;\n+    txFrom.vout.resize(1);\n+    txFrom.vout[0].scriptPubKey.SetDestination(keys[0].GetPubKey().GetID());\n+    CScript& scriptPubKey = txFrom.vout[0].scriptPubKey;\n+    CTransaction txTo;\n+    txTo.vin.resize(1);\n+    txTo.vout.resize(1);\n+    txTo.vin[0].prevout.n = 0;\n+    txTo.vin[0].prevout.hash = txFrom.GetHash();\n+    CScript& scriptSig = txTo.vin[0].scriptSig;\n+    txTo.vout[0].nValue = 1;\n+\n+    CScript empty;\n+    CScript combined = CombineSignatures(scriptPubKey, txTo, 0, empty, empty);\n+    BOOST_CHECK(combined.empty());\n+\n+    // Single signature case:\n+    SignSignature(keystore, txFrom, txTo, 0); // changes scriptSig\n+    combined = CombineSignatures(scriptPubKey, txTo, 0, scriptSig, empty);\n+    BOOST_CHECK(combined == scriptSig);\n+    combined = CombineSignatures(scriptPubKey, txTo, 0, empty, scriptSig);\n+    BOOST_CHECK(combined == scriptSig);\n+    CScript scriptSigCopy = scriptSig;\n+    // Signing again will give a different, valid signature:\n+    SignSignature(keystore, txFrom, txTo, 0);\n+    combined = CombineSignatures(scriptPubKey, txTo, 0, scriptSigCopy, scriptSig);\n+    BOOST_CHECK(combined == scriptSigCopy || combined == scriptSig);\n+\n+    // P2SH, single-signature case:\n+    CScript pkSingle; pkSingle << keys[0].GetPubKey() << OP_CHECKSIG;\n+    keystore.AddCScript(pkSingle);\n+    scriptPubKey.SetDestination(pkSingle.GetID());\n+    SignSignature(keystore, txFrom, txTo, 0);\n+    combined = CombineSignatures(scriptPubKey, txTo, 0, scriptSig, empty);\n+    BOOST_CHECK(combined == scriptSig);\n+    combined = CombineSignatures(scriptPubKey, txTo, 0, empty, scriptSig);\n+    BOOST_CHECK(combined == scriptSig);\n+    scriptSigCopy = scriptSig;\n+    SignSignature(keystore, txFrom, txTo, 0);\n+    combined = CombineSignatures(scriptPubKey, txTo, 0, scriptSigCopy, scriptSig);\n+    BOOST_CHECK(combined == scriptSigCopy || combined == scriptSig);\n+    // dummy scriptSigCopy with placeholder, should always choose non-placeholder:\n+    scriptSigCopy = CScript() << OP_0 << static_cast<vector<unsigned char> >(pkSingle);\n+    combined = CombineSignatures(scriptPubKey, txTo, 0, scriptSigCopy, scriptSig);\n+    BOOST_CHECK(combined == scriptSig);\n+    combined = CombineSignatures(scriptPubKey, txTo, 0, scriptSig, scriptSigCopy);\n+    BOOST_CHECK(combined == scriptSig);\n+\n+    // Hardest case:  Multisig 2-of-3\n+    scriptPubKey.SetMultisig(2, keys);\n+    keystore.AddCScript(scriptPubKey);\n+    SignSignature(keystore, txFrom, txTo, 0);\n+    combined = CombineSignatures(scriptPubKey, txTo, 0, scriptSig, empty);\n+    BOOST_CHECK(combined == scriptSig);\n+    combined = CombineSignatures(scriptPubKey, txTo, 0, empty, scriptSig);\n+    BOOST_CHECK(combined == scriptSig);\n+\n+    // A couple of partially-signed versions:\n+    vector<unsigned char> sig1;\n+    uint256 hash1 = SignatureHash(scriptPubKey, txTo, 0, SIGHASH_ALL);\n+    BOOST_CHECK(keys[0].Sign(hash1, sig1));\n+    sig1.push_back(SIGHASH_ALL);\n+    vector<unsigned char> sig2;\n+    uint256 hash2 = SignatureHash(scriptPubKey, txTo, 0, SIGHASH_NONE);\n+    BOOST_CHECK(keys[1].Sign(hash2, sig2));\n+    sig2.push_back(SIGHASH_NONE);\n+    vector<unsigned char> sig3;\n+    uint256 hash3 = SignatureHash(scriptPubKey, txTo, 0, SIGHASH_SINGLE);\n+    BOOST_CHECK(keys[2].Sign(hash3, sig3));\n+    sig3.push_back(SIGHASH_SINGLE);\n+\n+    // Not fussy about order (or even existence) of placeholders or signatures:\n+    CScript partial1a = CScript() << OP_0 << sig1 << OP_0;\n+    CScript partial1b = CScript() << OP_0 << OP_0 << sig1;\n+    CScript partial2a = CScript() << OP_0 << sig2;\n+    CScript partial2b = CScript() << sig2 << OP_0;\n+    CScript partial3a = CScript() << sig3;\n+    CScript partial3b = CScript() << OP_0 << OP_0 << sig3;\n+    CScript partial3c = CScript() << OP_0 << sig3 << OP_0;\n+    CScript complete12 = CScript() << OP_0 << sig1 << sig2;\n+    CScript complete13 = CScript() << OP_0 << sig1 << sig3;\n+    CScript complete23 = CScript() << OP_0 << sig2 << sig3;\n+\n+    combined = CombineSignatures(scriptPubKey, txTo, 0, partial1a, partial1b);\n+    BOOST_CHECK(combined == partial1a);\n+    combined = CombineSignatures(scriptPubKey, txTo, 0, partial1a, partial2a);\n+    BOOST_CHECK(combined == complete12);\n+    combined = CombineSignatures(scriptPubKey, txTo, 0, partial2a, partial1a);\n+    BOOST_CHECK(combined == complete12);\n+    combined = CombineSignatures(scriptPubKey, txTo, 0, partial1b, partial2b);\n+    BOOST_CHECK(combined == complete12);\n+    combined = CombineSignatures(scriptPubKey, txTo, 0, partial3b, partial1b);\n+    BOOST_CHECK(combined == complete13);\n+    combined = CombineSignatures(scriptPubKey, txTo, 0, partial2a, partial3a);\n+    BOOST_CHECK(combined == complete23);\n+    combined = CombineSignatures(scriptPubKey, txTo, 0, partial3b, partial2b);\n+    BOOST_CHECK(combined == complete23);\n+    combined = CombineSignatures(scriptPubKey, txTo, 0, partial3b, partial3a);\n+    BOOST_CHECK(combined == partial3c);\n+}\n \n BOOST_AUTO_TEST_SUITE_END()"
      },
      {
        "sha": "4d99ce656050cc5ff9d80297a418cb8d950cbe00",
        "filename": "src/wallet.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 2,
        "changes": 7,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a2709fad7f57b000333371954016045e12fc4bed/src/wallet.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a2709fad7f57b000333371954016045e12fc4bed/src/wallet.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet.cpp?ref=a2709fad7f57b000333371954016045e12fc4bed",
        "patch": "@@ -899,7 +899,7 @@ int64 CWallet::GetImmatureBalance() const\n }\n \n // populate vCoins with vector of spendable COutputs\n-void CWallet::AvailableCoins(vector<COutput>& vCoins) const\n+void CWallet::AvailableCoins(vector<COutput>& vCoins, bool fOnlyConfirmed) const\n {\n     vCoins.clear();\n \n@@ -909,7 +909,10 @@ void CWallet::AvailableCoins(vector<COutput>& vCoins) const\n         {\n             const CWalletTx* pcoin = &(*it).second;\n \n-            if (!pcoin->IsFinal() || !pcoin->IsConfirmed())\n+            if (!pcoin->IsFinal())\n+                continue;\n+\n+            if (fOnlyConfirmed && !pcoin->IsConfirmed())\n                 continue;\n \n             if (pcoin->IsCoinBase() && pcoin->GetBlocksToMaturity() > 0)"
      },
      {
        "sha": "5bf38699ef31f1ce873d5262d544fd12cda615aa",
        "filename": "src/wallet.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/a2709fad7f57b000333371954016045e12fc4bed/src/wallet.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/a2709fad7f57b000333371954016045e12fc4bed/src/wallet.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/wallet.h?ref=a2709fad7f57b000333371954016045e12fc4bed",
        "patch": "@@ -61,7 +61,6 @@ class CKeyPool\n class CWallet : public CCryptoKeyStore\n {\n private:\n-    void AvailableCoins(std::vector<COutput>& vCoins) const;\n     bool SelectCoins(int64 nTargetValue, std::set<std::pair<const CWalletTx*,unsigned int> >& setCoinsRet, int64& nValueRet) const;\n \n     CWalletDB *pwalletdbEncryption;\n@@ -113,6 +112,7 @@ class CWallet : public CCryptoKeyStore\n     // check whether we are allowed to upgrade (or already support) to the named feature\n     bool CanSupportFeature(enum WalletFeature wf) { return nWalletMaxVersion >= wf; }\n \n+    void AvailableCoins(std::vector<COutput>& vCoins, bool fOnlyConfirmed=true) const;\n     bool SelectCoinsMinConf(int64 nTargetValue, int nConfMine, int nConfTheirs, std::vector<COutput> vCoins, std::set<std::pair<const CWalletTx*,unsigned int> >& setCoinsRet, int64& nValueRet) const;\n \n     // keystore implementation"
      }
    ]
  },
  {
    "sha": "b47d2bc164bd21d4bec988fa8abfecc74d5ce5da",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpiNDdkMmJjMTY0YmQyMWQ0YmVjOTg4ZmE4YWJmZWNjNzRkNWNlNWRh",
    "commit": {
      "author": {
        "name": "Jeff Garzik",
        "email": "jgarzik@exmulti.com",
        "date": "2012-07-05T17:06:55Z"
      },
      "committer": {
        "name": "Jeff Garzik",
        "email": "jgarzik@exmulti.com",
        "date": "2012-07-05T17:06:55Z"
      },
      "message": "Merge pull request #1554 from jgarzik/dup-gethash\n\nRemove duplicate GetHash() in ConnectBlock",
      "tree": {
        "sha": "d774fba77702003137e81d5a20d29d9ea558b05e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/d774fba77702003137e81d5a20d29d9ea558b05e"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/b47d2bc164bd21d4bec988fa8abfecc74d5ce5da",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b47d2bc164bd21d4bec988fa8abfecc74d5ce5da",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/b47d2bc164bd21d4bec988fa8abfecc74d5ce5da",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b47d2bc164bd21d4bec988fa8abfecc74d5ce5da/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "a2709fad7f57b000333371954016045e12fc4bed",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/a2709fad7f57b000333371954016045e12fc4bed",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/a2709fad7f57b000333371954016045e12fc4bed"
      },
      {
        "sha": "f77654a0e9424f13cad04f82c014abd78fbb5e38",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/f77654a0e9424f13cad04f82c014abd78fbb5e38",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/f77654a0e9424f13cad04f82c014abd78fbb5e38"
      }
    ],
    "stats": {
      "total": 36,
      "additions": 17,
      "deletions": 19
    },
    "files": [
      {
        "sha": "8e1deac4bbfbc0270459e1b17a2eece0557635a4",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 16,
        "deletions": 18,
        "changes": 34,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b47d2bc164bd21d4bec988fa8abfecc74d5ce5da/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b47d2bc164bd21d4bec988fa8abfecc74d5ce5da/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=b47d2bc164bd21d4bec988fa8abfecc74d5ce5da",
        "patch": "@@ -600,7 +600,7 @@ bool CTxMemPool::accept(CTxDB& txdb, CTransaction &tx, bool fCheckInputs,\n             printf(\"CTxMemPool::accept() : replacing tx %s with new version\\n\", ptxOld->GetHash().ToString().c_str());\n             remove(*ptxOld);\n         }\n-        addUnchecked(tx);\n+        addUnchecked(hash, tx);\n     }\n \n     ///// are we sure this is ok when loading transactions or restoring block txes\n@@ -619,13 +619,11 @@ bool CTransaction::AcceptToMemoryPool(CTxDB& txdb, bool fCheckInputs, bool* pfMi\n     return mempool.accept(txdb, *this, fCheckInputs, pfMissingInputs);\n }\n \n-bool CTxMemPool::addUnchecked(CTransaction &tx)\n+bool CTxMemPool::addUnchecked(const uint256& hash, CTransaction &tx)\n {\n     // Add to memory pool without checking anything.  Don't call this directly,\n     // call CTxMemPool::accept to properly check the transaction first.\n     {\n-        LOCK(cs);\n-        uint256 hash = tx.GetHash();\n         mapTx[hash] = tx;\n         for (unsigned int i = 0; i < tx.vin.size(); i++)\n             mapNextTx[tx.vin[i].prevout] = CInPoint(&mapTx[hash], i);\n@@ -1325,19 +1323,8 @@ bool CBlock::ConnectBlock(CTxDB& txdb, CBlockIndex* pindex)\n     // This logic is not necessary for memory pool transactions, as AcceptToMemoryPool\n     // already refuses previously-known transaction id's entirely.\n     // This rule applies to all blocks whose timestamp is after March 15, 2012, 0:00 UTC.\n-    if (pindex->nTime > 1331769600)\n-    {\n-        BOOST_FOREACH(CTransaction& tx, vtx)\n-        {\n-            CTxIndex txindexOld;\n-            if (txdb.ReadTxIndex(tx.GetHash(), txindexOld))\n-            {\n-                BOOST_FOREACH(CDiskTxPos &pos, txindexOld.vSpent)\n-                    if (pos.IsNull())\n-                        return false;\n-            }\n-        }\n-    }\n+    int64 nBIP30SwitchTime = 1331769600;\n+    bool fEnforceBIP30 = (pindex->nTime > nBIP30SwitchTime);\n \n     // BIP16 didn't become active until Apr 1 2012\n     int64 nBIP16SwitchTime = 1333238400;\n@@ -1351,6 +1338,17 @@ bool CBlock::ConnectBlock(CTxDB& txdb, CBlockIndex* pindex)\n     unsigned int nSigOps = 0;\n     BOOST_FOREACH(CTransaction& tx, vtx)\n     {\n+        uint256 hashTx = tx.GetHash();\n+\n+        if (fEnforceBIP30) {\n+            CTxIndex txindexOld;\n+            if (txdb.ReadTxIndex(hashTx, txindexOld)) {\n+                BOOST_FOREACH(CDiskTxPos &pos, txindexOld.vSpent)\n+                    if (pos.IsNull())\n+                        return false;\n+            }\n+        }\n+\n         nSigOps += tx.GetLegacySigOpCount();\n         if (nSigOps > MAX_BLOCK_SIGOPS)\n             return DoS(100, error(\"ConnectBlock() : too many sigops\"));\n@@ -1381,7 +1379,7 @@ bool CBlock::ConnectBlock(CTxDB& txdb, CBlockIndex* pindex)\n                 return false;\n         }\n \n-        mapQueuedChanges[tx.GetHash()] = CTxIndex(posThisTx, tx.vout.size());\n+        mapQueuedChanges[hashTx] = CTxIndex(posThisTx, tx.vout.size());\n     }\n \n     // Write queued txindex changes"
      },
      {
        "sha": "c841fdaf18aa136b8532be10b19b2842c9e6010a",
        "filename": "src/main.h",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/b47d2bc164bd21d4bec988fa8abfecc74d5ce5da/src/main.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/b47d2bc164bd21d4bec988fa8abfecc74d5ce5da/src/main.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.h?ref=b47d2bc164bd21d4bec988fa8abfecc74d5ce5da",
        "patch": "@@ -1602,7 +1602,7 @@ class CTxMemPool\n \n     bool accept(CTxDB& txdb, CTransaction &tx,\n                 bool fCheckInputs, bool* pfMissingInputs);\n-    bool addUnchecked(CTransaction &tx);\n+    bool addUnchecked(const uint256& hash, CTransaction &tx);\n     bool remove(CTransaction &tx);\n     void queryHashes(std::vector<uint256>& vtxid);\n "
      }
    ]
  },
  {
    "sha": "dab9fa7f919807885bd693c4fa14ed740792c294",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkYWI5ZmE3ZjkxOTgwNzg4NWJkNjkzYzRmYTE0ZWQ3NDA3OTJjMjk0",
    "commit": {
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2012-07-05T17:25:52Z"
      },
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2012-07-05T17:26:27Z"
      },
      "message": "Use unsigned ints to fix signed/unsigned warnings",
      "tree": {
        "sha": "c629ba7da872cb8b3a24fccfaeb984220c79c7de",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c629ba7da872cb8b3a24fccfaeb984220c79c7de"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dab9fa7f919807885bd693c4fa14ed740792c294",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dab9fa7f919807885bd693c4fa14ed740792c294",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/dab9fa7f919807885bd693c4fa14ed740792c294",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dab9fa7f919807885bd693c4fa14ed740792c294/comments",
    "author": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "b47d2bc164bd21d4bec988fa8abfecc74d5ce5da",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/b47d2bc164bd21d4bec988fa8abfecc74d5ce5da",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/b47d2bc164bd21d4bec988fa8abfecc74d5ce5da"
      }
    ],
    "stats": {
      "total": 21,
      "additions": 11,
      "deletions": 10
    },
    "files": [
      {
        "sha": "e83e4da5df14fa3dfa7c64a2baae0ca856f029e5",
        "filename": "src/bitcoinrpc.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 1,
        "changes": 2,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/dab9fa7f919807885bd693c4fa14ed740792c294/src/bitcoinrpc.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/dab9fa7f919807885bd693c4fa14ed740792c294/src/bitcoinrpc.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoinrpc.cpp?ref=dab9fa7f919807885bd693c4fa14ed740792c294",
        "patch": "@@ -72,7 +72,7 @@ Object JSONRPCError(int code, const string& message)\n void RPCTypeCheck(const Array& params,\n                   const list<Value_type>& typesExpected)\n {\n-    int i = 0;\n+    unsigned int i = 0;\n     BOOST_FOREACH(Value_type t, typesExpected)\n     {\n         if (params.size() <= i)"
      },
      {
        "sha": "63c2dfe0ac728b7aaa68239789e03a53e8bab614",
        "filename": "src/rpcrawtransaction.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 3,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/dab9fa7f919807885bd693c4fa14ed740792c294/src/rpcrawtransaction.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/dab9fa7f919807885bd693c4fa14ed740792c294/src/rpcrawtransaction.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/rpcrawtransaction.cpp?ref=dab9fa7f919807885bd693c4fa14ed740792c294",
        "patch": "@@ -75,12 +75,12 @@ TxToJSON(const CTransaction& tx, const uint256 hashBlock, Object& entry)\n     }\n     entry.push_back(Pair(\"vin\", vin));\n     Array vout;\n-    for (int i = 0; i < tx.vout.size(); i++)\n+    for (unsigned int i = 0; i < tx.vout.size(); i++)\n     {\n         const CTxOut& txout = tx.vout[i];\n         Object out;\n         out.push_back(Pair(\"value\", ValueFromAmount(txout.nValue)));\n-        out.push_back(Pair(\"n\", i));\n+        out.push_back(Pair(\"n\", (boost::int64_t)i));\n         Object o;\n         ScriptPubKeyToJSON(txout.scriptPubKey, o);\n         out.push_back(Pair(\"scriptPubKey\", o));\n@@ -402,7 +402,7 @@ Value signrawtransaction(const Array& params, bool fHelp)\n     const CKeyStore& keystore = (fGivenKeys ? tempKeystore : *pwalletMain);\n \n     // Sign what we can:\n-    for (int i = 0; i < mergedTx.vin.size(); i++)\n+    for (unsigned int i = 0; i < mergedTx.vin.size(); i++)\n     {\n         CTxIn& txin = mergedTx.vin[i];\n         if (mapPrevOut.count(txin.prevout) == 0)"
      },
      {
        "sha": "c29648c2bcd4042ab4083e69f8aea1ef2648377b",
        "filename": "src/script.cpp",
        "status": "modified",
        "additions": 7,
        "deletions": 6,
        "changes": 13,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/dab9fa7f919807885bd693c4fa14ed740792c294/src/script.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/dab9fa7f919807885bd693c4fa14ed740792c294/src/script.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/script.cpp?ref=dab9fa7f919807885bd693c4fa14ed740792c294",
        "patch": "@@ -1331,7 +1331,7 @@ bool SignN(const vector<valtype>& multisigdata, const CKeyStore& keystore, uint2\n {\n     int nSigned = 0;\n     int nRequired = multisigdata.front()[0];\n-    for (int i = 1; i < multisigdata.size()-1 && nSigned < nRequired; i++)\n+    for (unsigned int i = 1; i < multisigdata.size()-1 && nSigned < nRequired; i++)\n     {\n         const valtype& pubkey = multisigdata[i];\n         CKeyID keyID = CPubKey(pubkey).GetID();\n@@ -1672,12 +1672,13 @@ static CScript CombineMultisig(CScript scriptPubKey, const CTransaction& txTo, u\n     }\n \n     // Build a map of pubkey -> signature by matching sigs to pubkeys:\n-    int nSigsRequired = vSolutions.front()[0];\n-    int nPubKeys = vSolutions.size()-2;\n+    assert(vSolutions.size() > 1);\n+    unsigned int nSigsRequired = vSolutions.front()[0];\n+    unsigned int nPubKeys = vSolutions.size()-2;\n     map<valtype, valtype> sigs;\n     BOOST_FOREACH(const valtype& sig, allsigs)\n     {\n-        for (int i = 0; i < nPubKeys; i++)\n+        for (unsigned int i = 0; i < nPubKeys; i++)\n         {\n             const valtype& pubkey = vSolutions[i+1];\n             if (sigs.count(pubkey))\n@@ -1693,7 +1694,7 @@ static CScript CombineMultisig(CScript scriptPubKey, const CTransaction& txTo, u\n     // Now build a merged CScript:\n     unsigned int nSigsHave = 0;\n     CScript result; result << OP_0; // pop-one-too-many workaround\n-    for (int i = 0; i < nPubKeys && nSigsHave < nSigsRequired; i++)\n+    for (unsigned int i = 0; i < nPubKeys && nSigsHave < nSigsRequired; i++)\n     {\n         if (sigs.count(vSolutions[i+1]))\n         {\n@@ -1702,7 +1703,7 @@ static CScript CombineMultisig(CScript scriptPubKey, const CTransaction& txTo, u\n         }\n     }\n     // Fill any missing with OP_0:\n-    for (int i = nSigsHave; i < nSigsRequired; i++)\n+    for (unsigned int i = nSigsHave; i < nSigsRequired; i++)\n         result << OP_0;\n \n     return result;"
      }
    ]
  },
  {
    "sha": "50fc02d063e7799fc50da2a43421f001a28541b7",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo1MGZjMDJkMDYzZTc3OTlmYzUwZGEyYTQzNDIxZjAwMWEyODU0MWI3",
    "commit": {
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2012-07-05T20:38:12Z"
      },
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2012-07-05T20:38:12Z"
      },
      "message": "Merge branch 'uri' of https://github.com/TheBlueMatt/bitcoin",
      "tree": {
        "sha": "c9b8a53b47ce57b1a325bbd1099b0cc8fc1a1cdf",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c9b8a53b47ce57b1a325bbd1099b0cc8fc1a1cdf"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/50fc02d063e7799fc50da2a43421f001a28541b7",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/50fc02d063e7799fc50da2a43421f001a28541b7",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/50fc02d063e7799fc50da2a43421f001a28541b7",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/50fc02d063e7799fc50da2a43421f001a28541b7/comments",
    "author": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "dab9fa7f919807885bd693c4fa14ed740792c294",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dab9fa7f919807885bd693c4fa14ed740792c294",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/dab9fa7f919807885bd693c4fa14ed740792c294"
      },
      {
        "sha": "ad5f29b7437fbdf6b25c4a5823b3dea0ac68b3ff",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/ad5f29b7437fbdf6b25c4a5823b3dea0ac68b3ff",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/ad5f29b7437fbdf6b25c4a5823b3dea0ac68b3ff"
      }
    ],
    "stats": {
      "total": 79,
      "additions": 43,
      "deletions": 36
    },
    "files": [
      {
        "sha": "d9a0bed539b0d701734e0d48762e40df7c6ae76c",
        "filename": "contrib/gitian-descriptors/boost-win32.yml",
        "status": "modified",
        "additions": 21,
        "deletions": 5,
        "changes": 26,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/50fc02d063e7799fc50da2a43421f001a28541b7/contrib/gitian-descriptors/boost-win32.yml",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/50fc02d063e7799fc50da2a43421f001a28541b7/contrib/gitian-descriptors/boost-win32.yml",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/gitian-descriptors/boost-win32.yml?ref=50fc02d063e7799fc50da2a43421f001a28541b7",
        "patch": "@@ -11,12 +11,28 @@ packages:\n reference_datetime: \"2011-01-30 00:00:00\"\n remotes: []\n files:\n-- \"boost_1_47_0.tar.bz2\"\n+- \"boost_1_49_0.tar.bz2\"\n script: |\n   TMPDIR=\"$HOME/tmpdir\"\n   mkdir -p $TMPDIR/bin/$GBUILD_BITS $TMPDIR/include\n-  tar xjf boost_1_47_0.tar.bz2\n-  cd boost_1_47_0\n+  tar xjf boost_1_49_0.tar.bz2\n+  cd boost_1_49_0\n+  echo \"--- tmp_dir_helpers.orig.hpp\t2012-06-10 01:39:25.403268210 +0200\n++++ tmp_dir_helpers.hpp\t2012-06-10 01:41:14.653823479 +0200\n+@@ -19,9 +19,9 @@\n+ #include <string>\n+ \n+ #if defined(BOOST_INTERPROCESS_WINDOWS)\n+-   //#define BOOST_INTERPROCESS_HAS_WINDOWS_KERNEL_BOOTTIME\n+-   //#define BOOST_INTERPROCESS_HAS_KERNEL_BOOTTIME\n+-   //#include <boost/interprocess/detail/win32_api.hpp>\n++   #define BOOST_INTERPROCESS_HAS_WINDOWS_KERNEL_BOOTTIME\n++   #define BOOST_INTERPROCESS_HAS_KERNEL_BOOTTIME\n++   #include <boost/interprocess/detail/win32_api.hpp>\n+ #elif defined(__FreeBSD__) || defined(__NetBSD__) || defined(__OpenBSD__) || defined(__APPLE__)\n+    //#include <sys/sysctl.h>\n+    //#if defined(CTL_KERN) && defined (KERN_BOOTTIME)\" > useboottime.patch\n+  patch boost/interprocess/detail/tmp_dir_helpers.hpp useboottime.patch\n   echo \"using gcc : 4.4 : i586-mingw32msvc-g++\n         :\n         <rc>i586-mingw32msvc-windres\n@@ -34,5 +50,5 @@ script: |\n   cd $TMPDIR\n   export LD_PRELOAD=/usr/lib/faketime/libfaketime.so.1\n   export FAKETIME=$REFERENCE_DATETIME\n-  zip -r boost-win32-1.47.0-gitian.zip *\n-  cp boost-win32-1.47.0-gitian.zip $OUTDIR\n+  zip -r boost-win32-1.49.0-gitian2.zip *\n+  cp boost-win32-1.49.0-gitian2.zip $OUTDIR"
      },
      {
        "sha": "6e2eff15f3ecd95b7399e88f91aad8568a9aacb6",
        "filename": "contrib/gitian-descriptors/gitian-win32.yml",
        "status": "modified",
        "additions": 4,
        "deletions": 4,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/50fc02d063e7799fc50da2a43421f001a28541b7/contrib/gitian-descriptors/gitian-win32.yml",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/50fc02d063e7799fc50da2a43421f001a28541b7/contrib/gitian-descriptors/gitian-win32.yml",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/contrib/gitian-descriptors/gitian-win32.yml?ref=50fc02d063e7799fc50da2a43421f001a28541b7",
        "patch": "@@ -16,7 +16,7 @@ remotes:\n   \"dir\": \"bitcoin\"\n files:\n - \"qt-win32-4.7.4-gitian.zip\"\n-- \"boost-win32-1.47.0-gitian.zip\"\n+- \"boost-win32-1.49.0-gitian2.zip\"\n - \"bitcoin-deps-0.0.4.zip\"\n script: |\n   #\n@@ -26,10 +26,10 @@ script: |\n   cd $HOME/build/\n   export PATH=$PATH:$HOME/qt/bin/\n   #\n-  mkdir boost_1_47_0\n-  cd boost_1_47_0\n+  mkdir boost_1_49_0\n+  cd boost_1_49_0\n   mkdir -p stage/lib\n-  unzip ../boost-win32-1.47.0-gitian.zip\n+  unzip ../boost-win32-1.49.0-gitian2.zip\n   cd bin/$GBUILD_BITS\n   for lib in *; do\n     i586-mingw32msvc-ar rc ../../stage/lib/libboost_${lib}-mt-s.a $lib/*.o"
      },
      {
        "sha": "c0bc880a5675b0a451a408c8ac1f85392b6d446f",
        "filename": "share/setup.nsi",
        "status": "modified",
        "additions": 4,
        "deletions": 6,
        "changes": 10,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/50fc02d063e7799fc50da2a43421f001a28541b7/share/setup.nsi",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/50fc02d063e7799fc50da2a43421f001a28541b7/share/setup.nsi",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/share/setup.nsi?ref=50fc02d063e7799fc50da2a43421f001a28541b7",
        "patch": "@@ -98,12 +98,10 @@ Section -post SEC0001\n     WriteRegStr HKCU \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\$(^Name)\" UninstallString $INSTDIR\\uninstall.exe\r\n     WriteRegDWORD HKCU \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\$(^Name)\" NoModify 1\r\n     WriteRegDWORD HKCU \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Uninstall\\$(^Name)\" NoRepair 1\r\n-\r\n-    # bitcoin: URI handling disabled for 0.6.0\r\n-    #    WriteRegStr HKCR \"bitcoin\" \"URL Protocol\" \"\"\r\n-    #    WriteRegStr HKCR \"bitcoin\" \"\" \"URL:Bitcoin\"\r\n-    #    WriteRegStr HKCR \"bitcoin\\DefaultIcon\" \"\" $INSTDIR\\bitcoin-qt.exe\r\n-    #    WriteRegStr HKCR \"bitcoin\\shell\\open\\command\" \"\" '\"$INSTDIR\\bitcoin-qt.exe\" \"$$1\"'\r\n+    WriteRegStr HKCR \"bitcoin\" \"URL Protocol\" \"\"\r\n+    WriteRegStr HKCR \"bitcoin\" \"\" \"URL:Bitcoin\"\r\n+    WriteRegStr HKCR \"bitcoin\\DefaultIcon\" \"\" $INSTDIR\\bitcoin-qt.exe\r\n+    WriteRegStr HKCR \"bitcoin\\shell\\open\\command\" \"\" '\"$INSTDIR\\bitcoin-qt.exe\" \"$$1\"'\r\n SectionEnd\r\n \r\n # Macro for selecting uninstaller sections\r"
      },
      {
        "sha": "6cd464266db43e2c61a16a30590bfb4f1471a538",
        "filename": "src/makefile.linux-mingw",
        "status": "modified",
        "additions": 2,
        "deletions": 2,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/50fc02d063e7799fc50da2a43421f001a28541b7/src/makefile.linux-mingw",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/50fc02d063e7799fc50da2a43421f001a28541b7/src/makefile.linux-mingw",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/makefile.linux-mingw?ref=50fc02d063e7799fc50da2a43421f001a28541b7",
        "patch": "@@ -7,14 +7,14 @@ DEPSDIR:=/usr/i586-mingw32msvc\n USE_UPNP:=0\n \n INCLUDEPATHS= \\\n- -I\"$(DEPSDIR)/boost_1_47_0\" \\\n+ -I\"$(DEPSDIR)/boost_1_49_0\" \\\n  -I\"$(DEPSDIR)/db-4.8.30.NC/build_unix\" \\\n  -I\"$(DEPSDIR)/openssl-1.0.1b/include\" \\\n  -I\"$(DEPSDIR)\" \\\n  -I\"$(CURDIR)\"/obj \\\n \n LIBPATHS= \\\n- -L\"$(DEPSDIR)/boost_1_47_0/stage/lib\" \\\n+ -L\"$(DEPSDIR)/boost_1_49_0/stage/lib\" \\\n  -L\"$(DEPSDIR)/db-4.8.30.NC/build_unix\" \\\n  -L\"$(DEPSDIR)/openssl-1.0.1b\"\n "
      },
      {
        "sha": "c270d4599a850ff2df0d87b3532b16feb4888bea",
        "filename": "src/makefile.mingw",
        "status": "modified",
        "additions": 6,
        "deletions": 6,
        "changes": 12,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/50fc02d063e7799fc50da2a43421f001a28541b7/src/makefile.mingw",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/50fc02d063e7799fc50da2a43421f001a28541b7/src/makefile.mingw",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/makefile.mingw?ref=50fc02d063e7799fc50da2a43421f001a28541b7",
        "patch": "@@ -5,20 +5,20 @@\n USE_UPNP:=0\n \n INCLUDEPATHS= \\\n- -I\"C:\\boost-1.47.0-mgw\" \\\n+ -I\"C:\\boost-1.49.0-mgw\" \\\n  -I\"C:\\db-4.8.30.NC-mgw\\build_unix\" \\\n  -I\"C:\\openssl-1.0.0d-mgw\\include\"\n \n LIBPATHS= \\\n- -L\"C:\\boost-1.47.0-mgw\\stage\\lib\" \\\n+ -L\"C:\\boost-1.49.0-mgw\\stage\\lib\" \\\n  -L\"C:\\db-4.8.30.NC-mgw\\build_unix\" \\\n  -L\"C:\\openssl-1.0.0d-mgw\"\n \n LIBS= \\\n- -l boost_system-mgw45-mt-s-1_47 \\\n- -l boost_filesystem-mgw45-mt-s-1_47 \\\n- -l boost_program_options-mgw45-mt-s-1_47 \\\n- -l boost_thread-mgw45-mt-s-1_47 \\\n+ -l boost_system-mgw45-mt-s-1_49 \\\n+ -l boost_filesystem-mgw45-mt-s-1_49 \\\n+ -l boost_program_options-mgw45-mt-s-1_49 \\\n+ -l boost_thread-mgw45-mt-s-1_49 \\\n  -l db_cxx \\\n  -l ssl \\\n  -l crypto"
      },
      {
        "sha": "803baf92ed4b9fdb5dd12f57121afa2b776f3d31",
        "filename": "src/qt/bitcoin.cpp",
        "status": "modified",
        "additions": 1,
        "deletions": 7,
        "changes": 8,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/50fc02d063e7799fc50da2a43421f001a28541b7/src/qt/bitcoin.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/50fc02d063e7799fc50da2a43421f001a28541b7/src/qt/bitcoin.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/bitcoin.cpp?ref=50fc02d063e7799fc50da2a43421f001a28541b7",
        "patch": "@@ -116,9 +116,6 @@ static void handleRunawayException(std::exception *e)\n #ifndef BITCOIN_QT_TEST\n int main(int argc, char *argv[])\n {\n-#if !defined(MAC_OSX) && !defined(WIN32)\n-// TODO: implement qtipcserver.cpp for Mac and Windows\n-\n     // Do this early as we don't want to bother initializing if we are just calling IPC\n     for (int i = 1; i < argc; i++)\n     {\n@@ -137,7 +134,6 @@ int main(int argc, char *argv[])\n             }\n         }\n     }\n-#endif\n \n     // Internal string conversion is all UTF-8\n     QTextCodec::setCodecForTr(QTextCodec::codecForName(\"UTF-8\"));\n@@ -262,8 +258,6 @@ int main(int argc, char *argv[])\n                 {\n                     window.show();\n                 }\n-#if !defined(MAC_OSX) && !defined(WIN32)\n-// TODO: implement qtipcserver.cpp for Mac and Windows\n \n                 // Place this here as guiref has to be defined if we dont want to lose URIs\n                 ipcInit();\n@@ -282,7 +276,7 @@ int main(int argc, char *argv[])\n                         }\n                     }\n                 }\n-#endif\n+\n                 app.exec();\n \n                 window.hide();"
      },
      {
        "sha": "a887456855fcdda80942eaf27ef66a8b3d32f616",
        "filename": "src/qt/qtipcserver.cpp",
        "status": "modified",
        "additions": 5,
        "deletions": 6,
        "changes": 11,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/50fc02d063e7799fc50da2a43421f001a28541b7/src/qt/qtipcserver.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/50fc02d063e7799fc50da2a43421f001a28541b7/src/qt/qtipcserver.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/qt/qtipcserver.cpp?ref=50fc02d063e7799fc50da2a43421f001a28541b7",
        "patch": "@@ -6,6 +6,11 @@\n #include <boost/interprocess/ipc/message_queue.hpp>\n #include <boost/tokenizer.hpp>\n #include <boost/date_time/posix_time/posix_time.hpp>\n+#include <boost/version.hpp>\n+\n+#if defined(WIN32) && (!defined(BOOST_INTERPROCESS_HAS_WINDOWS_KERNEL_BOOTTIME) || !defined(BOOST_INTERPROCESS_HAS_KERNEL_BOOTTIME) || BOOST_VERSION < 104900)\n+#warning Compiling without BOOST_INTERPROCESS_HAS_WINDOWS_KERNEL_BOOTTIME and BOOST_INTERPROCESS_HAS_KERNEL_BOOTTIME uncommented in boost/interprocess/detail/tmp_dir_helpers.hpp or using a boost version before 1.49 may have unintended results see svn.boost.org/trac/boost/ticket/5392\n+#endif\n \n #include \"ui_interface.h\"\n #include \"qtipcserver.h\"\n@@ -49,12 +54,6 @@ void ipcInit()\n     // TODO: implement bitcoin: URI handling the Mac Way\n     return;\n #endif\n-#ifdef WIN32\n-    // TODO: THOROUGHLY test boost::interprocess fix,\n-    // and make sure there are no Windows argument-handling exploitable\n-    // problems.\n-    return;\n-#endif\n \n     message_queue* mq;\n     char strBuf[257];"
      }
    ]
  },
  {
    "sha": "698b9f3095f5a89126976593382e3af2c1152165",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2OThiOWYzMDk1ZjVhODkxMjY5NzY1OTMzODJlM2FmMmMxMTUyMTY1",
    "commit": {
      "author": {
        "name": "Jeff Garzik",
        "email": "jgarzik@exmulti.com",
        "date": "2012-07-05T22:18:15Z"
      },
      "committer": {
        "name": "Jeff Garzik",
        "email": "jgarzik@redhat.com",
        "date": "2012-07-05T22:18:15Z"
      },
      "message": "bitcoinrpc.cpp: Removed outdated comment\n\nFixes #1373",
      "tree": {
        "sha": "c79125103438fc1fc633c4c0a752c62761c88e1f",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/c79125103438fc1fc633c4c0a752c62761c88e1f"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/698b9f3095f5a89126976593382e3af2c1152165",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/698b9f3095f5a89126976593382e3af2c1152165",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/698b9f3095f5a89126976593382e3af2c1152165",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/698b9f3095f5a89126976593382e3af2c1152165/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "50fc02d063e7799fc50da2a43421f001a28541b7",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/50fc02d063e7799fc50da2a43421f001a28541b7",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/50fc02d063e7799fc50da2a43421f001a28541b7"
      }
    ],
    "stats": {
      "total": 4,
      "additions": 0,
      "deletions": 4
    },
    "files": [
      {
        "sha": "62b0b497edc1719e1bb201a89e853ab6703cc6ec",
        "filename": "src/bitcoinrpc.cpp",
        "status": "modified",
        "additions": 0,
        "deletions": 4,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/698b9f3095f5a89126976593382e3af2c1152165/src/bitcoinrpc.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/698b9f3095f5a89126976593382e3af2c1152165/src/bitcoinrpc.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/bitcoinrpc.cpp?ref=698b9f3095f5a89126976593382e3af2c1152165",
        "patch": "@@ -29,10 +29,6 @@\n #include <list>\n \n #define printf OutputDebugStringF\n-// MinGW 3.4.5 gets \"fatal error: had to relocate PCH\" if the json headers are\n-// precompiled in headers.h.  The problem might be when the pch file goes over\n-// a certain size around 145MB.  If we need access to json_spirit outside this\n-// file, we could use the compiled json_spirit option.\n \n using namespace std;\n using namespace boost;"
      }
    ]
  },
  {
    "sha": "6e3a1a374293a8a5adeb2ad464f7205e819585ee",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzo2ZTNhMWEzNzQyOTNhOGE1YWRlYjJhZDQ2NGY3MjA1ZTgxOTU4NWVl",
    "commit": {
      "author": {
        "name": "Jeff Garzik",
        "email": "jgarzik@exmulti.com",
        "date": "2012-07-05T22:28:42Z"
      },
      "committer": {
        "name": "Jeff Garzik",
        "email": "jgarzik@exmulti.com",
        "date": "2012-07-05T22:28:42Z"
      },
      "message": "Merge pull request #1304 from rebroad/ShowBlockTimestamp\n\nShow block timestamp",
      "tree": {
        "sha": "50cc8d6cf558c68f63bcccc74342da14154f2f12",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/50cc8d6cf558c68f63bcccc74342da14154f2f12"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/6e3a1a374293a8a5adeb2ad464f7205e819585ee",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6e3a1a374293a8a5adeb2ad464f7205e819585ee",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/6e3a1a374293a8a5adeb2ad464f7205e819585ee",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6e3a1a374293a8a5adeb2ad464f7205e819585ee/comments",
    "author": null,
    "committer": null,
    "parents": [
      {
        "sha": "698b9f3095f5a89126976593382e3af2c1152165",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/698b9f3095f5a89126976593382e3af2c1152165",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/698b9f3095f5a89126976593382e3af2c1152165"
      },
      {
        "sha": "e69a7979901d1df8f0d90fcd4e1a21eb1fd38602",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/e69a7979901d1df8f0d90fcd4e1a21eb1fd38602",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/e69a7979901d1df8f0d90fcd4e1a21eb1fd38602"
      }
    ],
    "stats": {
      "total": 17,
      "additions": 13,
      "deletions": 4
    },
    "files": [
      {
        "sha": "e494d28e3c5128aefe11bbc04f056c606dac3092",
        "filename": "src/db.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 1,
        "changes": 4,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6e3a1a374293a8a5adeb2ad464f7205e819585ee/src/db.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6e3a1a374293a8a5adeb2ad464f7205e819585ee/src/db.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/db.cpp?ref=6e3a1a374293a8a5adeb2ad464f7205e819585ee",
        "patch": "@@ -510,7 +510,9 @@ bool CTxDB::LoadBlockIndex()\n     pindexBest = mapBlockIndex[hashBestChain];\n     nBestHeight = pindexBest->nHeight;\n     bnBestChainWork = pindexBest->bnChainWork;\n-    printf(\"LoadBlockIndex(): hashBestChain=%s  height=%d\\n\", hashBestChain.ToString().substr(0,20).c_str(), nBestHeight);\n+    printf(\"LoadBlockIndex(): hashBestChain=%s  height=%d  date=%s\\n\",\n+      hashBestChain.ToString().substr(0,20).c_str(), nBestHeight,\n+      DateTimeStrFormat(\"%x %H:%M:%S\", pindexBest->GetBlockTime()).c_str());\n \n     // Load bnBestInvalidWork, OK if it doesn't exist\n     ReadBestInvalidWork(bnBestInvalidWork);"
      },
      {
        "sha": "b4e827098e7d844bbd23da8b7617441952d1812f",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 10,
        "deletions": 3,
        "changes": 13,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/6e3a1a374293a8a5adeb2ad464f7205e819585ee/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/6e3a1a374293a8a5adeb2ad464f7205e819585ee/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=6e3a1a374293a8a5adeb2ad464f7205e819585ee",
        "patch": "@@ -968,8 +968,13 @@ void static InvalidChainFound(CBlockIndex* pindexNew)\n         CTxDB().WriteBestInvalidWork(bnBestInvalidWork);\n         uiInterface.NotifyBlocksChanged();\n     }\n-    printf(\"InvalidChainFound: invalid block=%s  height=%d  work=%s\\n\", pindexNew->GetBlockHash().ToString().substr(0,20).c_str(), pindexNew->nHeight, pindexNew->bnChainWork.ToString().c_str());\n-    printf(\"InvalidChainFound:  current best=%s  height=%d  work=%s\\n\", hashBestChain.ToString().substr(0,20).c_str(), nBestHeight, bnBestChainWork.ToString().c_str());\n+    printf(\"InvalidChainFound: invalid block=%s  height=%d  work=%s  date=%s\\n\",\n+      pindexNew->GetBlockHash().ToString().substr(0,20).c_str(), pindexNew->nHeight,\n+      pindexNew->bnChainWork.ToString().c_str(), DateTimeStrFormat(\"%x %H:%M:%S\",\n+      pindexNew->GetBlockTime()).c_str());\n+    printf(\"InvalidChainFound:  current best=%s  height=%d  work=%s  date=%s\\n\",\n+      hashBestChain.ToString().substr(0,20).c_str(), nBestHeight, bnBestChainWork.ToString().c_str(),\n+      DateTimeStrFormat(\"%x %H:%M:%S\", pindexBest->GetBlockTime()).c_str());\n     if (pindexBest && bnBestInvalidWork > bnBestChainWork + pindexBest->GetBlockWork() * 6)\n         printf(\"InvalidChainFound: WARNING: Displayed transactions may not be correct!  You may need to upgrade, or other nodes may need to upgrade.\\n\");\n }\n@@ -1611,7 +1616,9 @@ bool CBlock::SetBestChain(CTxDB& txdb, CBlockIndex* pindexNew)\n     bnBestChainWork = pindexNew->bnChainWork;\n     nTimeBestReceived = GetTime();\n     nTransactionsUpdated++;\n-    printf(\"SetBestChain: new best=%s  height=%d  work=%s\\n\", hashBestChain.ToString().substr(0,20).c_str(), nBestHeight, bnBestChainWork.ToString().c_str());\n+    printf(\"SetBestChain: new best=%s  height=%d  work=%s  date=%s\\n\",\n+      hashBestChain.ToString().substr(0,20).c_str(), nBestHeight, bnBestChainWork.ToString().c_str(),\n+      DateTimeStrFormat(\"%x %H:%M:%S\", pindexBest->GetBlockTime()).c_str());\n \n     std::string strCmd = GetArg(\"-blocknotify\", \"\");\n "
      }
    ]
  },
  {
    "sha": "dae3e10a5abe93833c57183b7c00f1db9200f46e",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzpkYWUzZTEwYTVhYmU5MzgzM2M1NzE4M2I3YzAwZjFkYjkyMDBmNDZl",
    "commit": {
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2012-06-27T16:43:19Z"
      },
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2012-07-06T15:37:01Z"
      },
      "message": "Treat non-version-1 transactions as non-standard\n\nAdds CBlock::CURRENT_VERSION and CTransaction::CURRENT_VERSION\nconstants, and makes non-CURRENT_VERSION transactions nonstandard.\nThis will help make future upgrades smoother.",
      "tree": {
        "sha": "52799f24df21e1785c0e58e43438a8b130642ad5",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/52799f24df21e1785c0e58e43438a8b130642ad5"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/dae3e10a5abe93833c57183b7c00f1db9200f46e",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dae3e10a5abe93833c57183b7c00f1db9200f46e",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/dae3e10a5abe93833c57183b7c00f1db9200f46e",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dae3e10a5abe93833c57183b7c00f1db9200f46e/comments",
    "author": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "6e3a1a374293a8a5adeb2ad464f7205e819585ee",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/6e3a1a374293a8a5adeb2ad464f7205e819585ee",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/6e3a1a374293a8a5adeb2ad464f7205e819585ee"
      }
    ],
    "stats": {
      "total": 9,
      "additions": 7,
      "deletions": 2
    },
    "files": [
      {
        "sha": "499f4e336aaba775bffa2697f37a3d66288e9280",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 3,
        "deletions": 0,
        "changes": 3,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/dae3e10a5abe93833c57183b7c00f1db9200f46e/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/dae3e10a5abe93833c57183b7c00f1db9200f46e/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=dae3e10a5abe93833c57183b7c00f1db9200f46e",
        "patch": "@@ -268,6 +268,9 @@ bool CTransaction::ReadFromDisk(COutPoint prevout)\n \n bool CTransaction::IsStandard() const\n {\n+    if (nVersion > CTransaction::CURRENT_VERSION)\n+        return false;\n+\n     BOOST_FOREACH(const CTxIn& txin, vin)\n     {\n         // Biggest 'standard' txin is a 3-signature 3-of-3 CHECKMULTISIG"
      },
      {
        "sha": "b3cc9ab40e792fe3472cbcf18e584b34f20cded7",
        "filename": "src/main.h",
        "status": "modified",
        "additions": 4,
        "deletions": 2,
        "changes": 6,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/dae3e10a5abe93833c57183b7c00f1db9200f46e/src/main.h",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/dae3e10a5abe93833c57183b7c00f1db9200f46e/src/main.h",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.h?ref=dae3e10a5abe93833c57183b7c00f1db9200f46e",
        "patch": "@@ -386,6 +386,7 @@ typedef std::map<uint256, std::pair<CTxIndex, CTransaction> > MapPrevTx;\n class CTransaction\n {\n public:\n+    static const int CURRENT_VERSION=1;\n     int nVersion;\n     std::vector<CTxIn> vin;\n     std::vector<CTxOut> vout;\n@@ -411,7 +412,7 @@ class CTransaction\n \n     void SetNull()\n     {\n-        nVersion = 1;\n+        nVersion = CTransaction::CURRENT_VERSION;\n         vin.clear();\n         vout.clear();\n         nLockTime = 0;\n@@ -817,6 +818,7 @@ class CBlock\n {\n public:\n     // header\n+    static const int CURRENT_VERSION=1;\n     int nVersion;\n     uint256 hashPrevBlock;\n     uint256 hashMerkleRoot;\n@@ -858,7 +860,7 @@ class CBlock\n \n     void SetNull()\n     {\n-        nVersion = 1;\n+        nVersion = CBlock::CURRENT_VERSION;\n         hashPrevBlock = 0;\n         hashMerkleRoot = 0;\n         nTime = 0;"
      }
    ]
  },
  {
    "sha": "2a919e396d95425fd2a3411c1716b7ccfe719540",
    "node_id": "MDY6Q29tbWl0MTE4MTkyNzoyYTkxOWUzOTZkOTU0MjVmZDJhMzQxMWMxNzE2YjdjY2ZlNzE5NTQw",
    "commit": {
      "author": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2012-06-27T17:51:51Z"
      },
      "committer": {
        "name": "Gavin Andresen",
        "email": "gavinandresen@gmail.com",
        "date": "2012-07-06T15:37:01Z"
      },
      "message": "Warn if blockchain majority doesn't match CBlock::CURRENT_VERSION\n\nThis adds a warning \"this version is obsolete, upgrade required\" if\nmore than 50 of the previous 100 blocks in the blockchain are\na new version.",
      "tree": {
        "sha": "cdb1f7b2cfdae4fe17e687e2e05020e7485eade4",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/git/trees/cdb1f7b2cfdae4fe17e687e2e05020e7485eade4"
      },
      "url": "https://api.github.com/repos/bitcoin/bitcoin/git/commits/2a919e396d95425fd2a3411c1716b7ccfe719540",
      "comment_count": 0,
      "verification": {
        "verified": false,
        "reason": "unsigned",
        "signature": null,
        "payload": null
      }
    },
    "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2a919e396d95425fd2a3411c1716b7ccfe719540",
    "html_url": "https://github.com/bitcoin/bitcoin/commit/2a919e396d95425fd2a3411c1716b7ccfe719540",
    "comments_url": "https://api.github.com/repos/bitcoin/bitcoin/commits/2a919e396d95425fd2a3411c1716b7ccfe719540/comments",
    "author": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "committer": {
      "login": "gavinandresen",
      "id": 331997,
      "node_id": "MDQ6VXNlcjMzMTk5Nw==",
      "avatar_url": "https://avatars.githubusercontent.com/u/331997?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/gavinandresen",
      "html_url": "https://github.com/gavinandresen",
      "followers_url": "https://api.github.com/users/gavinandresen/followers",
      "following_url": "https://api.github.com/users/gavinandresen/following{/other_user}",
      "gists_url": "https://api.github.com/users/gavinandresen/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/gavinandresen/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/gavinandresen/subscriptions",
      "organizations_url": "https://api.github.com/users/gavinandresen/orgs",
      "repos_url": "https://api.github.com/users/gavinandresen/repos",
      "events_url": "https://api.github.com/users/gavinandresen/events{/privacy}",
      "received_events_url": "https://api.github.com/users/gavinandresen/received_events",
      "type": "User",
      "site_admin": false
    },
    "parents": [
      {
        "sha": "dae3e10a5abe93833c57183b7c00f1db9200f46e",
        "url": "https://api.github.com/repos/bitcoin/bitcoin/commits/dae3e10a5abe93833c57183b7c00f1db9200f46e",
        "html_url": "https://github.com/bitcoin/bitcoin/commit/dae3e10a5abe93833c57183b7c00f1db9200f46e"
      }
    ],
    "stats": {
      "total": 18,
      "additions": 18,
      "deletions": 0
    },
    "files": [
      {
        "sha": "3052cfb8c40839136a59fe6a6b54a54f6c90d1d1",
        "filename": "src/main.cpp",
        "status": "modified",
        "additions": 18,
        "deletions": 0,
        "changes": 18,
        "blob_url": "https://github.com/bitcoin/bitcoin/blob/2a919e396d95425fd2a3411c1716b7ccfe719540/src/main.cpp",
        "raw_url": "https://github.com/bitcoin/bitcoin/raw/2a919e396d95425fd2a3411c1716b7ccfe719540/src/main.cpp",
        "contents_url": "https://api.github.com/repos/bitcoin/bitcoin/contents/src/main.cpp?ref=2a919e396d95425fd2a3411c1716b7ccfe719540",
        "patch": "@@ -1623,6 +1623,24 @@ bool CBlock::SetBestChain(CTxDB& txdb, CBlockIndex* pindexNew)\n       hashBestChain.ToString().substr(0,20).c_str(), nBestHeight, bnBestChainWork.ToString().c_str(),\n       DateTimeStrFormat(\"%x %H:%M:%S\", pindexBest->GetBlockTime()).c_str());\n \n+    // Check the version of the last 100 blocks to see if we need to upgrade:\n+    if (!fIsInitialDownload)\n+    {\n+        int nUpgraded = 0;\n+        const CBlockIndex* pindex = pindexBest;\n+        for (int i = 0; i < 100 && pindex != NULL; i++)\n+        {\n+            if (pindex->nVersion > CBlock::CURRENT_VERSION)\n+                ++nUpgraded;\n+            pindex = pindex->pprev;\n+        }\n+        if (nUpgraded > 0)\n+            printf(\"SetBestChain: %d of last 100 blocks above version %d\\n\", nUpgraded, CBlock::CURRENT_VERSION);\n+        if (nUpgraded > 100/2)\n+            // strMiscWarning is read by GetWarnings(), called by Qt and the JSON-RPC code to warn the user:\n+            strMiscWarning = _(\"Warning: this version is obsolete, upgrade required\");\n+    }\n+\n     std::string strCmd = GetArg(\"-blocknotify\", \"\");\n \n     if (!fIsInitialDownload && !strCmd.empty())"
      }
    ]
  }
]