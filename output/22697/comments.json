[
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/898427713",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#issuecomment-898427713",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22697",
    "id": 898427713,
    "node_id": "IC_kwDOABII5841jOtB",
    "user": {
      "login": "Zero-1729",
      "id": 23586626,
      "node_id": "MDQ6VXNlcjIzNTg2NjI2",
      "avatar_url": "https://avatars.githubusercontent.com/u/23586626?u=4c5f63febc30f4a5019f91ed09313f3391e08f3f&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/Zero-1729",
      "html_url": "https://github.com/Zero-1729",
      "followers_url": "https://api.github.com/users/Zero-1729/followers",
      "following_url": "https://api.github.com/users/Zero-1729/following{/other_user}",
      "gists_url": "https://api.github.com/users/Zero-1729/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/Zero-1729/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/Zero-1729/subscriptions",
      "organizations_url": "https://api.github.com/users/Zero-1729/orgs",
      "repos_url": "https://api.github.com/users/Zero-1729/repos",
      "events_url": "https://api.github.com/users/Zero-1729/events{/privacy}",
      "received_events_url": "https://api.github.com/users/Zero-1729/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-13T12:34:39Z",
    "updated_at": "2021-08-13T12:37:36Z",
    "author_association": "CONTRIBUTOR",
    "body": "Concept ACK \r\n\r\nThanks for splitting up the changes!",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/898427713/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/898489060",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#issuecomment-898489060",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22697",
    "id": 898489060,
    "node_id": "IC_kwDOABII5841jdrk",
    "user": {
      "login": "DrahtBot",
      "id": 39886733,
      "node_id": "MDQ6VXNlcjM5ODg2NzMz",
      "avatar_url": "https://avatars.githubusercontent.com/u/39886733?u=3c1e73d828cf5a5850dfc25c8397c1cf751db5ac&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/DrahtBot",
      "html_url": "https://github.com/DrahtBot",
      "followers_url": "https://api.github.com/users/DrahtBot/followers",
      "following_url": "https://api.github.com/users/DrahtBot/following{/other_user}",
      "gists_url": "https://api.github.com/users/DrahtBot/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/DrahtBot/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/DrahtBot/subscriptions",
      "organizations_url": "https://api.github.com/users/DrahtBot/orgs",
      "repos_url": "https://api.github.com/users/DrahtBot/repos",
      "events_url": "https://api.github.com/users/DrahtBot/events{/privacy}",
      "received_events_url": "https://api.github.com/users/DrahtBot/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-13T14:15:57Z",
    "updated_at": "2021-08-19T09:00:39Z",
    "author_association": "CONTRIBUTOR",
    "body": "<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nNo conflicts as of last run.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/898489060/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/898491499",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#issuecomment-898491499",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22697",
    "id": 898491499,
    "node_id": "IC_kwDOABII5841jeRr",
    "user": {
      "login": "theStack",
      "id": 91535,
      "node_id": "MDQ6VXNlcjkxNTM1",
      "avatar_url": "https://avatars.githubusercontent.com/u/91535?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/theStack",
      "html_url": "https://github.com/theStack",
      "followers_url": "https://api.github.com/users/theStack/followers",
      "following_url": "https://api.github.com/users/theStack/following{/other_user}",
      "gists_url": "https://api.github.com/users/theStack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/theStack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/theStack/subscriptions",
      "organizations_url": "https://api.github.com/users/theStack/orgs",
      "repos_url": "https://api.github.com/users/theStack/repos",
      "events_url": "https://api.github.com/users/theStack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/theStack/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-13T14:19:35Z",
    "updated_at": "2021-08-13T14:19:35Z",
    "author_association": "CONTRIBUTOR",
    "body": "Concept ACK",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/898491499/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/898784453",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#issuecomment-898784453",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22697",
    "id": 898784453,
    "node_id": "IC_kwDOABII5841klzF",
    "user": {
      "login": "amitiuttarwar",
      "id": 1500952,
      "node_id": "MDQ6VXNlcjE1MDA5NTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1500952?u=f0ef8142342bcda68fe46c952d3c653456811ed4&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amitiuttarwar",
      "html_url": "https://github.com/amitiuttarwar",
      "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
      "following_url": "https://api.github.com/users/amitiuttarwar/following{/other_user}",
      "gists_url": "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
      "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
      "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
      "events_url": "https://api.github.com/users/amitiuttarwar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-14T00:54:45Z",
    "updated_at": "2021-08-14T00:54:45Z",
    "author_association": "MEMBER",
    "body": "concept ACK ",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/898784453/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/899092918",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#issuecomment-899092918",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22697",
    "id": 899092918,
    "node_id": "IC_kwDOABII5841lxG2",
    "user": {
      "login": "practicalswift",
      "id": 7826565,
      "node_id": "MDQ6VXNlcjc4MjY1NjU=",
      "avatar_url": "https://avatars.githubusercontent.com/u/7826565?u=5ff13e375b40ea55ecd3c108337dd6a23f68eddf&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/practicalswift",
      "html_url": "https://github.com/practicalswift",
      "followers_url": "https://api.github.com/users/practicalswift/followers",
      "following_url": "https://api.github.com/users/practicalswift/following{/other_user}",
      "gists_url": "https://api.github.com/users/practicalswift/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/practicalswift/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/practicalswift/subscriptions",
      "organizations_url": "https://api.github.com/users/practicalswift/orgs",
      "repos_url": "https://api.github.com/users/practicalswift/repos",
      "events_url": "https://api.github.com/users/practicalswift/events{/privacy}",
      "received_events_url": "https://api.github.com/users/practicalswift/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-15T18:33:07Z",
    "updated_at": "2021-08-15T18:33:07Z",
    "author_association": "CONTRIBUTOR",
    "body": "Concept ACK",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/899092918/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/900113407",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#issuecomment-900113407",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22697",
    "id": 900113407,
    "node_id": "IC_kwDOABII5841pqP_",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-17T08:48:48Z",
    "updated_at": "2021-08-17T08:48:48Z",
    "author_association": "MEMBER",
    "body": "rebased on master",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/900113407/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/900925684",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#issuecomment-900925684",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22697",
    "id": 900925684,
    "node_id": "IC_kwDOABII5841swj0",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-18T08:30:57Z",
    "updated_at": "2021-08-18T08:30:57Z",
    "author_association": "MEMBER",
    "body": "Rebased on master and addressed review comments from @jonatack and @fanquake.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/900925684/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/900982749",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#issuecomment-900982749",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22697",
    "id": 900982749,
    "node_id": "IC_kwDOABII5841s-fd",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-18T09:57:48Z",
    "updated_at": "2021-08-18T09:57:48Z",
    "author_association": "MEMBER",
    "body": "Thanks for the review @MarcoFalke. I've addressed all your comments.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/900982749/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/901097570",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#issuecomment-901097570",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22697",
    "id": 901097570,
    "node_id": "IC_kwDOABII5841tahi",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-18T13:04:08Z",
    "updated_at": "2021-08-18T13:04:08Z",
    "author_association": "MEMBER",
    "body": "Rebased",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/901097570/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/901180854",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#issuecomment-901180854",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22697",
    "id": 901180854,
    "node_id": "IC_kwDOABII5841tu22",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-18T14:50:59Z",
    "updated_at": "2021-08-18T14:50:59Z",
    "author_association": "MEMBER",
    "body": "Concept ACK on getting rid of the `Clear()` function, seems more robust this way.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/901180854/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/901392680",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#issuecomment-901392680",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22697",
    "id": 901392680,
    "node_id": "IC_kwDOABII5841uiko",
    "user": {
      "login": "amitiuttarwar",
      "id": 1500952,
      "node_id": "MDQ6VXNlcjE1MDA5NTI=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1500952?u=f0ef8142342bcda68fe46c952d3c653456811ed4&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/amitiuttarwar",
      "html_url": "https://github.com/amitiuttarwar",
      "followers_url": "https://api.github.com/users/amitiuttarwar/followers",
      "following_url": "https://api.github.com/users/amitiuttarwar/following{/other_user}",
      "gists_url": "https://api.github.com/users/amitiuttarwar/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/amitiuttarwar/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/amitiuttarwar/subscriptions",
      "organizations_url": "https://api.github.com/users/amitiuttarwar/orgs",
      "repos_url": "https://api.github.com/users/amitiuttarwar/repos",
      "events_url": "https://api.github.com/users/amitiuttarwar/events{/privacy}",
      "received_events_url": "https://api.github.com/users/amitiuttarwar/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-18T20:02:02Z",
    "updated_at": "2021-08-18T20:02:02Z",
    "author_association": "MEMBER",
    "body": "looks like both failing builds are failing in `addrman_tests` -> `addrman_serialization`\r\n\r\n[AppVeyor](https://ci.appveyor.com/project/DrahtBot/bitcoin/builds/40428513#L61):\r\n```\r\nC:\\projects\\bitcoin\\src\\test\\addrman_tests.cpp(758): Entering test case \"addrman_serialization\"\r\nunknown location(0): fatal error: in \"addrman_tests/addrman_serialization\": stack overflow\r\n```\r\n\r\n[Win64](https://cirrus-ci.com/task/5728778564403200?logs=ci#L5538):\r\n```\r\ntest/addrman_tests.cpp(758): Entering test case \"addrman_serialization\"\r\nwine: Unhandled stack overflow at address 0000000001180216 (thread 0018), starting debugger...\r\n```",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/901392680/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/901801141",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#issuecomment-901801141",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22697",
    "id": 901801141,
    "node_id": "IC_kwDOABII5841wGS1",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?u=71263a00d1269c7f0ed6660aa0c15c894df78a88&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-19T10:31:38Z",
    "updated_at": "2021-08-19T10:31:38Z",
    "author_association": "MEMBER",
    "body": "Thank you for the review @laanwj @amitiuttarwar @vasild @MarcoFalke. I believe that I've addressed all of your review comments.",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/901801141/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/901920506",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#issuecomment-901920506",
    "issue_url": "https://api.github.com/repos/bitcoin/bitcoin/issues/22697",
    "id": 901920506,
    "node_id": "IC_kwDOABII5841wjb6",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?u=13b19d1ff2f5f914e180c41418f451a4ba6f8bd1&v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "created_at": "2021-08-19T13:34:20Z",
    "updated_at": "2021-08-19T13:34:20Z",
    "author_association": "MEMBER",
    "body": "Code review ACK 4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/issues/comments/901920506/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "performed_via_github_app": null
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688524323",
    "pull_request_review_id": 729630877,
    "id": 688524323,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY4ODUyNDMyMw==",
    "diff_hunk": "@@ -70,13 +70,22 @@ static void FillAddrMan(CAddrMan& addrman)\n \n static void AddrManAdd(benchmark::Bench& bench)\n {\n-    CreateAddresses();\n+     /* Create many CAddrMan objects - one to be modified at each loop iteration. */\n \n-    CAddrMan addrman(/* deterministic */ false, /* consistency_check_ratio */ 0);\n+    bench.epochs(5).epochIterations(1);\n+    size_t addrman_count = bench.epochs() * bench.epochIterations();\n \n+    std::vector<std::unique_ptr<CAddrMan>> addrmans(addrman_count);\n+    for (size_t i{0}; i < addrman_count; i++) {",
    "path": "src/bench/addrman.cpp",
    "position": null,
    "original_position": 12,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "70147fe0e3e65e28049e9c6171758615e4387119",
    "user": {
      "login": "jonatack",
      "id": 2415484,
      "node_id": "MDQ6VXNlcjI0MTU0ODQ=",
      "avatar_url": "https://avatars.githubusercontent.com/u/2415484?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jonatack",
      "html_url": "https://github.com/jonatack",
      "followers_url": "https://api.github.com/users/jonatack/followers",
      "following_url": "https://api.github.com/users/jonatack/following{/other_user}",
      "gists_url": "https://api.github.com/users/jonatack/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jonatack/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jonatack/subscriptions",
      "organizations_url": "https://api.github.com/users/jonatack/orgs",
      "repos_url": "https://api.github.com/users/jonatack/repos",
      "events_url": "https://api.github.com/users/jonatack/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jonatack/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "a8bad2e16ed41c8d9 nit, prefer prefix iterator\r\n```suggestion\r\n    for (size_t i{0}; i < addrman_count; ++i) {\r\n```",
    "created_at": "2021-08-13T13:42:55Z",
    "updated_at": "2021-08-13T14:16:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r688524323",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688524323"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r688524323"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/688524323/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 79,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/690921078",
    "pull_request_review_id": 732456082,
    "id": 690921078,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MDkyMTA3OA==",
    "diff_hunk": "@@ -2534,18 +2534,6 @@ bool CConnman::Start(CScheduler& scheduler, const Options& connOptions)\n     if (clientInterface) {\n         clientInterface->InitMessage(_(\"Loading P2P addresses\u2026\").translated);",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 2,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "74fb306b58e1a6de0746eea6e7e9bc718a08e498",
    "user": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Should this message move too?",
    "created_at": "2021-08-18T05:51:30Z",
    "updated_at": "2021-08-18T06:00:40Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r690921078",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/690921078"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r690921078"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/690921078/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2535,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/690923912",
    "pull_request_review_id": 732456082,
    "id": 690923912,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MDkyMzkxMg==",
    "diff_hunk": "@@ -672,19 +640,19 @@ class CAddrMan\n     mutable std::vector<int> vRandom GUARDED_BY(cs);\n \n     // number of \"tried\" entries\n-    int nTried GUARDED_BY(cs);\n+    int nTried GUARDED_BY(cs){0};\n \n     //! list of \"tried\" buckets\n     int vvTried[ADDRMAN_TRIED_BUCKET_COUNT][ADDRMAN_BUCKET_SIZE] GUARDED_BY(cs);\n \n     //! number of (unique) \"new\" entries\n-    int nNew GUARDED_BY(cs);\n+    int nNew GUARDED_BY(cs){0};\n \n     //! list of \"new\" buckets\n     int vvNew[ADDRMAN_NEW_BUCKET_COUNT][ADDRMAN_BUCKET_SIZE] GUARDED_BY(cs);\n \n-    //! last time Good was called (memory only)\n-    int64_t nLastGood GUARDED_BY(cs);\n+    //! last time Good was called (memory only). Initially set to 1 so that \"never\" is strictly worse.",
    "path": "src/addrman.h",
    "position": 90,
    "original_position": 90,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "74fb306b58e1a6de0746eea6e7e9bc718a08e498",
    "user": {
      "login": "fanquake",
      "id": 863730,
      "node_id": "MDQ6VXNlcjg2MzczMA==",
      "avatar_url": "https://avatars.githubusercontent.com/u/863730?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/fanquake",
      "html_url": "https://github.com/fanquake",
      "followers_url": "https://api.github.com/users/fanquake/followers",
      "following_url": "https://api.github.com/users/fanquake/following{/other_user}",
      "gists_url": "https://api.github.com/users/fanquake/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/fanquake/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/fanquake/subscriptions",
      "organizations_url": "https://api.github.com/users/fanquake/orgs",
      "repos_url": "https://api.github.com/users/fanquake/repos",
      "events_url": "https://api.github.com/users/fanquake/events{/privacy}",
      "received_events_url": "https://api.github.com/users/fanquake/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "What is \"never\"? ",
    "created_at": "2021-08-18T05:58:24Z",
    "updated_at": "2021-08-18T06:00:40Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r690923912",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/690923912"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r690923912"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/690923912/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 654,
    "original_line": 654,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691015313",
    "pull_request_review_id": 732574413,
    "id": 691015313,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTAxNTMxMw==",
    "diff_hunk": "@@ -2534,18 +2534,6 @@ bool CConnman::Start(CScheduler& scheduler, const Options& connOptions)\n     if (clientInterface) {\n         clientInterface->InitMessage(_(\"Loading P2P addresses\u2026\").translated);",
    "path": "src/net.cpp",
    "position": null,
    "original_position": 2,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "74fb306b58e1a6de0746eea6e7e9bc718a08e498",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes! Thanks. Moved.",
    "created_at": "2021-08-18T08:23:28Z",
    "updated_at": "2021-08-18T08:23:28Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691015313",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691015313"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691015313"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691015313/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 2535,
    "side": "RIGHT",
    "in_reply_to_id": 690921078
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691019487",
    "pull_request_review_id": 732579841,
    "id": 691019487,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTAxOTQ4Nw==",
    "diff_hunk": "@@ -672,19 +640,19 @@ class CAddrMan\n     mutable std::vector<int> vRandom GUARDED_BY(cs);\n \n     // number of \"tried\" entries\n-    int nTried GUARDED_BY(cs);\n+    int nTried GUARDED_BY(cs){0};\n \n     //! list of \"tried\" buckets\n     int vvTried[ADDRMAN_TRIED_BUCKET_COUNT][ADDRMAN_BUCKET_SIZE] GUARDED_BY(cs);\n \n     //! number of (unique) \"new\" entries\n-    int nNew GUARDED_BY(cs);\n+    int nNew GUARDED_BY(cs){0};\n \n     //! list of \"new\" buckets\n     int vvNew[ADDRMAN_NEW_BUCKET_COUNT][ADDRMAN_BUCKET_SIZE] GUARDED_BY(cs);\n \n-    //! last time Good was called (memory only)\n-    int64_t nLastGood GUARDED_BY(cs);\n+    //! last time Good was called (memory only). Initially set to 1 so that \"never\" is strictly worse.",
    "path": "src/addrman.h",
    "position": 90,
    "original_position": 90,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "74fb306b58e1a6de0746eea6e7e9bc718a08e498",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "'never' means that `Good()` has not been called since the CAddrMan object was constructed. I moved this comment from the constructor (where `nLastGood` was previously being set) to the member declaration (which now has a default initialization value).",
    "created_at": "2021-08-18T08:28:54Z",
    "updated_at": "2021-08-18T08:28:55Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691019487",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691019487"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691019487"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691019487/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 654,
    "original_line": 654,
    "side": "RIGHT",
    "in_reply_to_id": 690923912
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691020686",
    "pull_request_review_id": 732581270,
    "id": 691020686,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTAyMDY4Ng==",
    "diff_hunk": "@@ -70,13 +70,22 @@ static void FillAddrMan(CAddrMan& addrman)\n \n static void AddrManAdd(benchmark::Bench& bench)\n {\n-    CreateAddresses();\n+     /* Create many CAddrMan objects - one to be modified at each loop iteration. */\n \n-    CAddrMan addrman(/* deterministic */ false, /* consistency_check_ratio */ 0);\n+    bench.epochs(5).epochIterations(1);\n+    size_t addrman_count = bench.epochs() * bench.epochIterations();\n \n+    std::vector<std::unique_ptr<CAddrMan>> addrmans(addrman_count);\n+    for (size_t i{0}; i < addrman_count; i++) {",
    "path": "src/bench/addrman.cpp",
    "position": null,
    "original_position": 12,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "70147fe0e3e65e28049e9c6171758615e4387119",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done",
    "created_at": "2021-08-18T08:30:19Z",
    "updated_at": "2021-08-18T08:30:20Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691020686",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691020686"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691020686"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691020686/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 79,
    "side": "RIGHT",
    "in_reply_to_id": 688524323
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691029194",
    "pull_request_review_id": 732464854,
    "id": 691029194,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTAyOTE5NA==",
    "diff_hunk": "@@ -205,21 +195,16 @@ BOOST_AUTO_TEST_CASE(addrman_simple)\n     // success.\n \n     CService addr2 = ResolveService(\"250.1.1.2\", 8333);\n-    BOOST_CHECK(addrman.Add({CAddress(addr2, NODE_NONE)}, source));\n-    BOOST_CHECK(addrman.size() >= 1);\n+    BOOST_CHECK(addrman->Add({CAddress(addr2, NODE_NONE)}, source));\n+    BOOST_CHECK(addrman->size() >= 1);\n \n-    // Test: AddrMan::Clear() should empty the new table.\n-    addrman.Clear();\n-    BOOST_CHECK_EQUAL(addrman.size(), 0U);\n-    CAddrInfo addr_null2 = addrman.Select();\n-    BOOST_CHECK_EQUAL(addr_null2.ToString(), \"[::]:0\");\n-\n-    // Test: AddrMan::Add multiple addresses works as expected\n+    // Test: reset addrman and test AddrMan::Add multiple addresses works as expected\n+    addrman = std::make_unique<CAddrManTest>();\n     std::vector<CAddress> vAddr;\n     vAddr.push_back(CAddress(ResolveService(\"250.1.1.3\", 8333), NODE_NONE));\n     vAddr.push_back(CAddress(ResolveService(\"250.1.1.4\", 8333), NODE_NONE));\n-    BOOST_CHECK(addrman.Add(vAddr, source));\n-    BOOST_CHECK(addrman.size() >= 1);\n+    BOOST_CHECK(addrman->Add(vAddr, source));\n+    BOOST_CHECK(addrman->size() >= 1);",
    "path": "src/test/addrman_tests.cpp",
    "position": 86,
    "original_position": 77,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "ec132b1f86b19e8a6cc11f6138edeb2655bda80f",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "is there a reason why you prefer `unique_ptr`? `unique_ptr` will result in a different memory layout, will add an unneeded abstraction and will make the diff larger than needed.\r\n\r\nSimply using a new object worked fine for me:\r\n\r\n```diff\r\ndiff --git a/src/test/addrman_tests.cpp b/src/test/addrman_tests.cpp\r\nindex 3c64461605..67c549689d 100644\r\n--- a/src/test/addrman_tests.cpp\r\n+++ b/src/test/addrman_tests.cpp\r\n@@ -148,18 +148,13 @@ BOOST_AUTO_TEST_CASE(addrman_simple)\r\n     BOOST_CHECK(addrman.Add(CAddress(addr2, NODE_NONE), source));\r\n     BOOST_CHECK(addrman.size() >= 1);\r\n \r\n-    // Test: AddrMan::Clear() should empty the new table.\r\n-    addrman.Clear();\r\n-    BOOST_CHECK_EQUAL(addrman.size(), 0U);\r\n-    CAddrInfo addr_null2 = addrman.Select();\r\n-    BOOST_CHECK_EQUAL(addr_null2.ToString(), \"[::]:0\");\r\n-\r\n     // Test: AddrMan::Add multiple addresses works as expected\r\n+    CAddrManTest addrman2{};\r\n     std::vector<CAddress> vAddr;\r\n     vAddr.push_back(CAddress(ResolveService(\"250.1.1.3\", 8333), NODE_NONE));\r\n     vAddr.push_back(CAddress(ResolveService(\"250.1.1.4\", 8333), NODE_NONE));\r\n-    BOOST_CHECK(addrman.Add(vAddr, source));\r\n-    BOOST_CHECK(addrman.size() >= 1);\r\n+    BOOST_CHECK(addrman2.Add(vAddr, source));\r\n+    BOOST_CHECK(addrman2.size() >= 1);\r\n }\r\n \r\n BOOST_AUTO_TEST_CASE(addrman_ports)\r\n",
    "created_at": "2021-08-18T08:41:17Z",
    "updated_at": "2021-08-18T08:49:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691029194",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691029194"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691029194"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691029194/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 207,
    "original_line": 207,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691032222",
    "pull_request_review_id": 732464854,
    "id": 691032222,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTAzMjIyMg==",
    "diff_hunk": "@@ -70,13 +70,22 @@ static void FillAddrMan(CAddrMan& addrman)\n \n static void AddrManAdd(benchmark::Bench& bench)\n {\n-    CreateAddresses();\n+     /* Create many CAddrMan objects - one to be modified at each loop iteration. */\n \n-    CAddrMan addrman(/* deterministic */ false, /* consistency_check_ratio */ 0);\n+    bench.epochs(5).epochIterations(1);\n+    size_t addrman_count = bench.epochs() * bench.epochIterations();\n+\n+    std::vector<std::unique_ptr<CAddrMan>> addrmans(addrman_count);",
    "path": "src/bench/addrman.cpp",
    "position": null,
    "original_position": 11,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "ec132b1f86b19e8a6cc11f6138edeb2655bda80f",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "not a huge difference here, but could use `reserve` (optional) and `emplace` to avoid unique_ptr?",
    "created_at": "2021-08-18T08:45:09Z",
    "updated_at": "2021-08-18T08:49:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691032222",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691032222"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691032222"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691032222/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 78,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691033355",
    "pull_request_review_id": 732464854,
    "id": 691033355,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTAzMzM1NQ==",
    "diff_hunk": "@@ -774,63 +759,63 @@ BOOST_AUTO_TEST_CASE(addrman_serialization)\n {\n     std::vector<bool> asmap1 = FromBytes(asmap_raw, sizeof(asmap_raw) * 8);\n \n-    CAddrManTest addrman_asmap1(true, asmap1);\n-    CAddrManTest addrman_asmap1_dup(true, asmap1);\n-    CAddrManTest addrman_noasmap;\n+    auto addrman_asmap1 = std::make_unique<CAddrManTest>(true, asmap1);\n+    auto addrman_asmap1_dup = std::make_unique<CAddrManTest>(true, asmap1);\n+    auto addrman_noasmap = std::make_unique<CAddrManTest>();\n     CDataStream stream(SER_NETWORK, PROTOCOL_VERSION);\n \n     CAddress addr = CAddress(ResolveService(\"250.1.1.1\"), NODE_NONE);\n     CNetAddr default_source;\n \n \n-    addrman_asmap1.Add({addr}, default_source);\n+    addrman_asmap1->Add({addr}, default_source);\n \n-    stream << addrman_asmap1;\n+    stream << *addrman_asmap1;\n     // serizalizing/deserializing addrman with the same asmap\n-    stream >> addrman_asmap1_dup;\n+    stream >> *addrman_asmap1_dup;\n \n-    std::pair<int, int> bucketAndEntry_asmap1 = addrman_asmap1.GetBucketAndEntry(addr);\n-    std::pair<int, int> bucketAndEntry_asmap1_dup = addrman_asmap1_dup.GetBucketAndEntry(addr);\n+    std::pair<int, int> bucketAndEntry_asmap1 = addrman_asmap1->GetBucketAndEntry(addr);\n+    std::pair<int, int> bucketAndEntry_asmap1_dup = addrman_asmap1_dup->GetBucketAndEntry(addr);\n     BOOST_CHECK(bucketAndEntry_asmap1.second != -1);\n     BOOST_CHECK(bucketAndEntry_asmap1_dup.second != -1);\n \n     BOOST_CHECK(bucketAndEntry_asmap1.first == bucketAndEntry_asmap1_dup.first);\n     BOOST_CHECK(bucketAndEntry_asmap1.second == bucketAndEntry_asmap1_dup.second);\n \n     // deserializing asmaped peers.dat to non-asmaped addrman\n-    stream << addrman_asmap1;\n-    stream >> addrman_noasmap;\n-    std::pair<int, int> bucketAndEntry_noasmap = addrman_noasmap.GetBucketAndEntry(addr);\n+    stream << *addrman_asmap1;\n+    stream >> *addrman_noasmap;\n+    std::pair<int, int> bucketAndEntry_noasmap = addrman_noasmap->GetBucketAndEntry(addr);\n     BOOST_CHECK(bucketAndEntry_noasmap.second != -1);\n     BOOST_CHECK(bucketAndEntry_asmap1.first != bucketAndEntry_noasmap.first);\n     BOOST_CHECK(bucketAndEntry_asmap1.second != bucketAndEntry_noasmap.second);\n \n     // deserializing non-asmaped peers.dat to asmaped addrman\n-    addrman_asmap1.Clear();\n-    addrman_noasmap.Clear();\n-    addrman_noasmap.Add({addr}, default_source);\n-    stream << addrman_noasmap;\n-    stream >> addrman_asmap1;\n-    std::pair<int, int> bucketAndEntry_asmap1_deser = addrman_asmap1.GetBucketAndEntry(addr);\n+    addrman_asmap1 = std::make_unique<CAddrManTest>(true, asmap1);\n+    addrman_noasmap = std::make_unique<CAddrManTest>();",
    "path": "src/test/addrman_tests.cpp",
    "position": 144,
    "original_position": 135,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "ec132b1f86b19e8a6cc11f6138edeb2655bda80f",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Same here? Could use new object with different name or even split the test into two and keep the same name?",
    "created_at": "2021-08-18T08:46:41Z",
    "updated_at": "2021-08-18T08:49:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691033355",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691033355"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691033355"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691033355/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 795,
    "original_line": 795,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691034731",
    "pull_request_review_id": 732464854,
    "id": 691034731,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTAzNDczMQ==",
    "diff_hunk": "@@ -228,29 +228,29 @@ FUZZ_TARGET_INIT(addrman, initialize_addrman)\n {\n     FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n     SetMockTime(ConsumeTime(fuzzed_data_provider));\n-    CAddrManDeterministic addr_man{fuzzed_data_provider};\n+    auto addr_man = std::make_unique<CAddrManDeterministic>(fuzzed_data_provider);\n     if (fuzzed_data_provider.ConsumeBool()) {\n         const std::vector<uint8_t> serialized_data{ConsumeRandomLengthByteVector(fuzzed_data_provider)};\n         CDataStream ds(serialized_data, SER_DISK, INIT_PROTO_VERSION);\n         const auto ser_version{fuzzed_data_provider.ConsumeIntegral<int32_t>()};\n         ds.SetVersion(ser_version);\n         try {\n-            ds >> addr_man;\n+            ds >> *addr_man;\n         } catch (const std::ios_base::failure&) {\n-            addr_man.Clear();\n+            addr_man = std::make_unique<CAddrManDeterministic>(fuzzed_data_provider);\n         }\n     }\n     while (fuzzed_data_provider.ConsumeBool()) {\n         CallOneOf(\n             fuzzed_data_provider,\n             [&] {\n-                addr_man.Clear();\n+                addr_man = std::make_unique<CAddrManDeterministic>(fuzzed_data_provider);",
    "path": "src/test/fuzz/addrman.cpp",
    "position": null,
    "original_position": 24,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "ec132b1f86b19e8a6cc11f6138edeb2655bda80f",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "it might be better to just remove this, as it is equivalent to just starting a fresh fuzz input that fails deser",
    "created_at": "2021-08-18T08:48:13Z",
    "updated_at": "2021-08-18T08:49:49Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691034731",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691034731"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691034731"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691034731/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 247,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691036749",
    "pull_request_review_id": 732601695,
    "id": 691036749,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTAzNjc0OQ==",
    "diff_hunk": "@@ -1167,6 +1167,19 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     assert(!node.addrman);\n     auto check_addrman = std::clamp<int32_t>(args.GetArg(\"-checkaddrman\", DEFAULT_ADDRMAN_CONSISTENCY_CHECKS), 0, 1000000);\n     node.addrman = std::make_unique<CAddrMan>(/* deterministic */ false, /* consistency_check_ratio */ check_addrman);\n+    {\n+        // Load addresses from peers.dat\n+        uiInterface.InitMessage(_(\"Loading P2P addresses\u2026\").translated);\n+        int64_t nStart = GetTimeMillis();\n+        CAddrDB adb;\n+        if (adb.Read(*node.addrman))",
    "path": "src/init.cpp",
    "position": null,
    "original_position": 9,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "c4b12a6cbb9add01aa2b2f12c9f21457dc308974",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "this line isn't move-only, so could add `{` while touching?",
    "created_at": "2021-08-18T08:50:54Z",
    "updated_at": "2021-08-18T08:50:55Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691036749",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691036749"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691036749"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691036749/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1175,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691037769",
    "pull_request_review_id": 732602998,
    "id": 691037769,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTAzNzc2OQ==",
    "diff_hunk": "@@ -48,7 +48,7 @@ class CAddrManCorrupted : public CAddrManSerializationMock\n         unsigned char nVersion = 1;\n         s << nVersion;\n         s << ((unsigned char)32);\n-        s << nKey;\n+        s << ((uint256)1);",
    "path": "src/test/addrman_tests.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "b0befadcc264d9b16419021bc1aabe1ae8161d4b",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I slightly prefer `{}` constructors (`uint256{1}`) or `uint256::ONE`.",
    "created_at": "2021-08-18T08:52:13Z",
    "updated_at": "2021-08-18T08:53:01Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691037769",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691037769"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691037769"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691037769/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 51,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691074691",
    "pull_request_review_id": 732650432,
    "id": 691074691,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTA3NDY5MQ==",
    "diff_hunk": "@@ -70,13 +70,22 @@ static void FillAddrMan(CAddrMan& addrman)\n \n static void AddrManAdd(benchmark::Bench& bench)\n {\n-    CreateAddresses();\n+     /* Create many CAddrMan objects - one to be modified at each loop iteration. */\n \n-    CAddrMan addrman(/* deterministic */ false, /* consistency_check_ratio */ 0);\n+    bench.epochs(5).epochIterations(1);\n+    size_t addrman_count = bench.epochs() * bench.epochIterations();\n+\n+    std::vector<std::unique_ptr<CAddrMan>> addrmans(addrman_count);",
    "path": "src/bench/addrman.cpp",
    "position": null,
    "original_position": 11,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "ec132b1f86b19e8a6cc11f6138edeb2655bda80f",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I did try that, but couldn't get it to work. `emplace()` requires the type to be [MoveInsertable](https://en.cppreference.com/w/cpp/named_req/MoveInsertable), which `CAddrMan` isn't since its move constructor is implicitly deleted.\r\n\r\nIf you have a suggestion for how to do this, I'd be happy to incorporate it.",
    "created_at": "2021-08-18T09:39:50Z",
    "updated_at": "2021-08-18T09:39:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691074691",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691074691"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691074691"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691074691/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 78,
    "side": "RIGHT",
    "in_reply_to_id": 691032222
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691083948",
    "pull_request_review_id": 732662270,
    "id": 691083948,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTA4Mzk0OA==",
    "diff_hunk": "@@ -228,29 +228,29 @@ FUZZ_TARGET_INIT(addrman, initialize_addrman)\n {\n     FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n     SetMockTime(ConsumeTime(fuzzed_data_provider));\n-    CAddrManDeterministic addr_man{fuzzed_data_provider};\n+    auto addr_man = std::make_unique<CAddrManDeterministic>(fuzzed_data_provider);\n     if (fuzzed_data_provider.ConsumeBool()) {\n         const std::vector<uint8_t> serialized_data{ConsumeRandomLengthByteVector(fuzzed_data_provider)};\n         CDataStream ds(serialized_data, SER_DISK, INIT_PROTO_VERSION);\n         const auto ser_version{fuzzed_data_provider.ConsumeIntegral<int32_t>()};\n         ds.SetVersion(ser_version);\n         try {\n-            ds >> addr_man;\n+            ds >> *addr_man;\n         } catch (const std::ios_base::failure&) {\n-            addr_man.Clear();\n+            addr_man = std::make_unique<CAddrManDeterministic>(fuzzed_data_provider);\n         }\n     }\n     while (fuzzed_data_provider.ConsumeBool()) {\n         CallOneOf(\n             fuzzed_data_provider,\n             [&] {\n-                addr_man.Clear();\n+                addr_man = std::make_unique<CAddrManDeterministic>(fuzzed_data_provider);",
    "path": "src/test/fuzz/addrman.cpp",
    "position": null,
    "original_position": 24,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "ec132b1f86b19e8a6cc11f6138edeb2655bda80f",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Removed",
    "created_at": "2021-08-18T09:51:52Z",
    "updated_at": "2021-08-18T09:51:52Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691083948",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691083948"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691083948"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691083948/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 247,
    "side": "RIGHT",
    "in_reply_to_id": 691034731
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691086453",
    "pull_request_review_id": 732665552,
    "id": 691086453,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTA4NjQ1Mw==",
    "diff_hunk": "@@ -48,7 +48,7 @@ class CAddrManCorrupted : public CAddrManSerializationMock\n         unsigned char nVersion = 1;\n         s << nVersion;\n         s << ((unsigned char)32);\n-        s << nKey;\n+        s << ((uint256)1);",
    "path": "src/test/addrman_tests.cpp",
    "position": null,
    "original_position": 5,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "b0befadcc264d9b16419021bc1aabe1ae8161d4b",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes, I agree that's better. Changed to `uint256::ONE`.",
    "created_at": "2021-08-18T09:55:18Z",
    "updated_at": "2021-08-18T09:55:18Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691086453",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691086453"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691086453"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691086453/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 51,
    "side": "RIGHT",
    "in_reply_to_id": 691037769
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691087818",
    "pull_request_review_id": 732667325,
    "id": 691087818,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTA4NzgxOA==",
    "diff_hunk": "@@ -1167,6 +1167,19 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     assert(!node.addrman);\n     auto check_addrman = std::clamp<int32_t>(args.GetArg(\"-checkaddrman\", DEFAULT_ADDRMAN_CONSISTENCY_CHECKS), 0, 1000000);\n     node.addrman = std::make_unique<CAddrMan>(/* deterministic */ false, /* consistency_check_ratio */ check_addrman);\n+    {\n+        // Load addresses from peers.dat\n+        uiInterface.InitMessage(_(\"Loading P2P addresses\u2026\").translated);\n+        int64_t nStart = GetTimeMillis();\n+        CAddrDB adb;\n+        if (adb.Read(*node.addrman))",
    "path": "src/init.cpp",
    "position": null,
    "original_position": 9,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "c4b12a6cbb9add01aa2b2f12c9f21457dc308974",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done",
    "created_at": "2021-08-18T09:57:04Z",
    "updated_at": "2021-08-18T09:57:04Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691087818",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691087818"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691087818"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691087818/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 1175,
    "side": "RIGHT",
    "in_reply_to_id": 691036749
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691087946",
    "pull_request_review_id": 732667506,
    "id": 691087946,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTA4Nzk0Ng==",
    "diff_hunk": "@@ -205,21 +195,16 @@ BOOST_AUTO_TEST_CASE(addrman_simple)\n     // success.\n \n     CService addr2 = ResolveService(\"250.1.1.2\", 8333);\n-    BOOST_CHECK(addrman.Add({CAddress(addr2, NODE_NONE)}, source));\n-    BOOST_CHECK(addrman.size() >= 1);\n+    BOOST_CHECK(addrman->Add({CAddress(addr2, NODE_NONE)}, source));\n+    BOOST_CHECK(addrman->size() >= 1);\n \n-    // Test: AddrMan::Clear() should empty the new table.\n-    addrman.Clear();\n-    BOOST_CHECK_EQUAL(addrman.size(), 0U);\n-    CAddrInfo addr_null2 = addrman.Select();\n-    BOOST_CHECK_EQUAL(addr_null2.ToString(), \"[::]:0\");\n-\n-    // Test: AddrMan::Add multiple addresses works as expected\n+    // Test: reset addrman and test AddrMan::Add multiple addresses works as expected\n+    addrman = std::make_unique<CAddrManTest>();\n     std::vector<CAddress> vAddr;\n     vAddr.push_back(CAddress(ResolveService(\"250.1.1.3\", 8333), NODE_NONE));\n     vAddr.push_back(CAddress(ResolveService(\"250.1.1.4\", 8333), NODE_NONE));\n-    BOOST_CHECK(addrman.Add(vAddr, source));\n-    BOOST_CHECK(addrman.size() >= 1);\n+    BOOST_CHECK(addrman->Add(vAddr, source));\n+    BOOST_CHECK(addrman->size() >= 1);",
    "path": "src/test/addrman_tests.cpp",
    "position": 86,
    "original_position": 77,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "ec132b1f86b19e8a6cc11f6138edeb2655bda80f",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done",
    "created_at": "2021-08-18T09:57:16Z",
    "updated_at": "2021-08-18T09:57:16Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691087946",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691087946"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691087946"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691087946/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 207,
    "original_line": 207,
    "side": "RIGHT",
    "in_reply_to_id": 691029194
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691088019",
    "pull_request_review_id": 732667606,
    "id": 691088019,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTA4ODAxOQ==",
    "diff_hunk": "@@ -774,63 +759,63 @@ BOOST_AUTO_TEST_CASE(addrman_serialization)\n {\n     std::vector<bool> asmap1 = FromBytes(asmap_raw, sizeof(asmap_raw) * 8);\n \n-    CAddrManTest addrman_asmap1(true, asmap1);\n-    CAddrManTest addrman_asmap1_dup(true, asmap1);\n-    CAddrManTest addrman_noasmap;\n+    auto addrman_asmap1 = std::make_unique<CAddrManTest>(true, asmap1);\n+    auto addrman_asmap1_dup = std::make_unique<CAddrManTest>(true, asmap1);\n+    auto addrman_noasmap = std::make_unique<CAddrManTest>();\n     CDataStream stream(SER_NETWORK, PROTOCOL_VERSION);\n \n     CAddress addr = CAddress(ResolveService(\"250.1.1.1\"), NODE_NONE);\n     CNetAddr default_source;\n \n \n-    addrman_asmap1.Add({addr}, default_source);\n+    addrman_asmap1->Add({addr}, default_source);\n \n-    stream << addrman_asmap1;\n+    stream << *addrman_asmap1;\n     // serizalizing/deserializing addrman with the same asmap\n-    stream >> addrman_asmap1_dup;\n+    stream >> *addrman_asmap1_dup;\n \n-    std::pair<int, int> bucketAndEntry_asmap1 = addrman_asmap1.GetBucketAndEntry(addr);\n-    std::pair<int, int> bucketAndEntry_asmap1_dup = addrman_asmap1_dup.GetBucketAndEntry(addr);\n+    std::pair<int, int> bucketAndEntry_asmap1 = addrman_asmap1->GetBucketAndEntry(addr);\n+    std::pair<int, int> bucketAndEntry_asmap1_dup = addrman_asmap1_dup->GetBucketAndEntry(addr);\n     BOOST_CHECK(bucketAndEntry_asmap1.second != -1);\n     BOOST_CHECK(bucketAndEntry_asmap1_dup.second != -1);\n \n     BOOST_CHECK(bucketAndEntry_asmap1.first == bucketAndEntry_asmap1_dup.first);\n     BOOST_CHECK(bucketAndEntry_asmap1.second == bucketAndEntry_asmap1_dup.second);\n \n     // deserializing asmaped peers.dat to non-asmaped addrman\n-    stream << addrman_asmap1;\n-    stream >> addrman_noasmap;\n-    std::pair<int, int> bucketAndEntry_noasmap = addrman_noasmap.GetBucketAndEntry(addr);\n+    stream << *addrman_asmap1;\n+    stream >> *addrman_noasmap;\n+    std::pair<int, int> bucketAndEntry_noasmap = addrman_noasmap->GetBucketAndEntry(addr);\n     BOOST_CHECK(bucketAndEntry_noasmap.second != -1);\n     BOOST_CHECK(bucketAndEntry_asmap1.first != bucketAndEntry_noasmap.first);\n     BOOST_CHECK(bucketAndEntry_asmap1.second != bucketAndEntry_noasmap.second);\n \n     // deserializing non-asmaped peers.dat to asmaped addrman\n-    addrman_asmap1.Clear();\n-    addrman_noasmap.Clear();\n-    addrman_noasmap.Add({addr}, default_source);\n-    stream << addrman_noasmap;\n-    stream >> addrman_asmap1;\n-    std::pair<int, int> bucketAndEntry_asmap1_deser = addrman_asmap1.GetBucketAndEntry(addr);\n+    addrman_asmap1 = std::make_unique<CAddrManTest>(true, asmap1);\n+    addrman_noasmap = std::make_unique<CAddrManTest>();",
    "path": "src/test/addrman_tests.cpp",
    "position": 144,
    "original_position": 135,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "ec132b1f86b19e8a6cc11f6138edeb2655bda80f",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Done",
    "created_at": "2021-08-18T09:57:24Z",
    "updated_at": "2021-08-18T09:57:24Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691088019",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691088019"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691088019"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691088019/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 795,
    "original_line": 795,
    "side": "RIGHT",
    "in_reply_to_id": 691033355
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691310217",
    "pull_request_review_id": 732963647,
    "id": 691310217,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTMxMDIxNw==",
    "diff_hunk": "@@ -1167,6 +1167,20 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     assert(!node.addrman);\n     auto check_addrman = std::clamp<int32_t>(args.GetArg(\"-checkaddrman\", DEFAULT_ADDRMAN_CONSISTENCY_CHECKS), 0, 1000000);\n     node.addrman = std::make_unique<CAddrMan>(/* deterministic */ false, /* consistency_check_ratio */ check_addrman);\n+    {",
    "path": "src/init.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "3fe1429a33ef181760fd21df06a4030854418be9",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "What is the reasoning for moving this to init.cpp? I think this goes in the wrong direction, of having parts take care of their own initialization instead of init.cpp being a hodge-podge of initialization functionality.",
    "created_at": "2021-08-18T14:46:07Z",
    "updated_at": "2021-08-18T14:46:07Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691310217",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691310217"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691310217"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691310217/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1170,
    "original_line": 1170,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691413337",
    "pull_request_review_id": 733105985,
    "id": 691413337,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTQxMzMzNw==",
    "diff_hunk": "@@ -1167,6 +1167,20 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     assert(!node.addrman);\n     auto check_addrman = std::clamp<int32_t>(args.GetArg(\"-checkaddrman\", DEFAULT_ADDRMAN_CONSISTENCY_CHECKS), 0, 1000000);\n     node.addrman = std::make_unique<CAddrMan>(/* deterministic */ false, /* consistency_check_ratio */ check_addrman);\n+    {",
    "path": "src/init.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "3fe1429a33ef181760fd21df06a4030854418be9",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Since #20228, addrman is owned by the `node.context` struct and gets constructed inside the `AppInitMain()` function. That PR includes motivation for why that is.\r\n\r\nSince `AppInitMain()` is responsible for constructing the addrman, it should also be responsible for making sure addrman deserializes from peers.dat (and recovers if there's an error). Before this PR, addrman peers.dat derserialization is happening in `CConnMan::Start()`, which doesn't make a lot of sense.",
    "created_at": "2021-08-18T16:22:58Z",
    "updated_at": "2021-08-18T16:22:58Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691413337",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691413337"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691413337"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691413337/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1170,
    "original_line": 1170,
    "side": "RIGHT",
    "in_reply_to_id": 691310217
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691866096",
    "pull_request_review_id": 733664406,
    "id": 691866096,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTg2NjA5Ng==",
    "diff_hunk": "@@ -70,13 +70,22 @@ static void FillAddrMan(CAddrMan& addrman)\n \n static void AddrManAdd(benchmark::Bench& bench)\n {\n-    CreateAddresses();\n+     /* Create many CAddrMan objects - one to be modified at each loop iteration. */\n \n-    CAddrMan addrman(/* deterministic */ false, /* consistency_check_ratio */ 0);\n+    bench.epochs(5).epochIterations(1);",
    "path": "src/bench/addrman.cpp",
    "position": null,
    "original_position": 8,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "3fe1429a33ef181760fd21df06a4030854418be9",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Hardcoding the number of runs could cripple the test (results vary too much). It is better to avoid that if possible, so that nanobench chooses how many runs to execute based on variance. In this case it is possible to avoid hardcoding, and also shorter:\r\n\r\n```cpp\r\nstatic void AddrManAdd(benchmark::Bench& bench)\r\n{\r\n    CreateAddresses();\r\n\r\n    bench.run([&] { \r\n        auto addrman = std::make_unique<CAddrMan>(/* deterministic */ false, /* consistency_check_ratio */ 0);\r\n        AddAddressesToAddrMan(*addrman);\r\n    }); \r\n}   \r\n```",
    "created_at": "2021-08-19T07:42:51Z",
    "updated_at": "2021-08-19T08:17:09Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691866096",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691866096"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691866096"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691866096/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 75,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691871131",
    "pull_request_review_id": 733664406,
    "id": 691871131,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTg3MTEzMQ==",
    "diff_hunk": "@@ -1167,6 +1167,20 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     assert(!node.addrman);\n     auto check_addrman = std::clamp<int32_t>(args.GetArg(\"-checkaddrman\", DEFAULT_ADDRMAN_CONSISTENCY_CHECKS), 0, 1000000);\n     node.addrman = std::make_unique<CAddrMan>(/* deterministic */ false, /* consistency_check_ratio */ check_addrman);\n+    {\n+        // Load addresses from peers.dat\n+        uiInterface.InitMessage(_(\"Loading P2P addresses\u2026\").translated);\n+        int64_t nStart = GetTimeMillis();\n+        CAddrDB adb;\n+        if (adb.Read(*node.addrman)) {\n+            LogPrintf(\"Loaded %i addresses from peers.dat  %dms\\n\", node.addrman->size(), GetTimeMillis() - nStart);\n+        } else {\n+            // Addrman can be in an inconsistent state after failure, reset it\n+            node.addrman = std::make_unique<CAddrMan>(/* deterministic */ false, /* consistency_check_ratio */ check_addrman);\n+            LogPrintf(\"Recreating peers.dat\\n\");\n+            adb.Write(*node.addrman);",
    "path": "src/init.cpp",
    "position": 15,
    "original_position": 15,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "3fe1429a33ef181760fd21df06a4030854418be9",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This would skip the message \"Flushed 0 addresses to peers.dat\" which was previously printed from `CConnman::DumpAddresses()`, is that intentional?",
    "created_at": "2021-08-19T07:50:11Z",
    "updated_at": "2021-08-19T08:17:09Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691871131",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691871131"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691871131"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691871131/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 1178,
    "original_start_line": 1178,
    "start_side": "RIGHT",
    "line": 1181,
    "original_line": 1181,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691872884",
    "pull_request_review_id": 733664406,
    "id": 691872884,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTg3Mjg4NA==",
    "diff_hunk": "@@ -208,18 +198,13 @@ BOOST_AUTO_TEST_CASE(addrman_simple)\n     BOOST_CHECK(addrman.Add({CAddress(addr2, NODE_NONE)}, source));\n     BOOST_CHECK(addrman.size() >= 1);\n \n-    // Test: AddrMan::Clear() should empty the new table.\n-    addrman.Clear();\n-    BOOST_CHECK_EQUAL(addrman.size(), 0U);\n-    CAddrInfo addr_null2 = addrman.Select();\n-    BOOST_CHECK_EQUAL(addr_null2.ToString(), \"[::]:0\");\n-\n     // Test: AddrMan::Add multiple addresses works as expected\n+    CAddrManTest addrman2{};",
    "path": "src/test/addrman_tests.cpp",
    "position": null,
    "original_position": 37,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "3fe1429a33ef181760fd21df06a4030854418be9",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "nit: I think `{}` is just clutter. Also, few objects below are constructed without it.",
    "created_at": "2021-08-19T07:52:40Z",
    "updated_at": "2021-08-19T08:17:09Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691872884",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691872884"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691872884"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691872884/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 1
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 202,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691885202",
    "pull_request_review_id": 733664406,
    "id": 691885202,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTg4NTIwMg==",
    "diff_hunk": "@@ -228,24 +228,22 @@ FUZZ_TARGET_INIT(addrman, initialize_addrman)\n {\n     FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n     SetMockTime(ConsumeTime(fuzzed_data_provider));\n-    CAddrManDeterministic addr_man{fuzzed_data_provider};\n+    auto addr_man_ptr = std::make_unique<CAddrManDeterministic>(fuzzed_data_provider);\n     if (fuzzed_data_provider.ConsumeBool()) {\n         const std::vector<uint8_t> serialized_data{ConsumeRandomLengthByteVector(fuzzed_data_provider)};\n         CDataStream ds(serialized_data, SER_DISK, INIT_PROTO_VERSION);\n         const auto ser_version{fuzzed_data_provider.ConsumeIntegral<int32_t>()};\n         ds.SetVersion(ser_version);\n         try {\n-            ds >> addr_man;\n+            ds >> *addr_man_ptr;\n         } catch (const std::ios_base::failure&) {\n-            addr_man.Clear();\n+            addr_man_ptr = std::make_unique<CAddrManDeterministic>(fuzzed_data_provider);",
    "path": "src/test/fuzz/addrman.cpp",
    "position": 16,
    "original_position": 16,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "3fe1429a33ef181760fd21df06a4030854418be9",
    "user": {
      "login": "vasild",
      "id": 266751,
      "node_id": "MDQ6VXNlcjI2Njc1MQ==",
      "avatar_url": "https://avatars.githubusercontent.com/u/266751?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/vasild",
      "html_url": "https://github.com/vasild",
      "followers_url": "https://api.github.com/users/vasild/followers",
      "following_url": "https://api.github.com/users/vasild/following{/other_user}",
      "gists_url": "https://api.github.com/users/vasild/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/vasild/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/vasild/subscriptions",
      "organizations_url": "https://api.github.com/users/vasild/orgs",
      "repos_url": "https://api.github.com/users/vasild/repos",
      "events_url": "https://api.github.com/users/vasild/events{/privacy}",
      "received_events_url": "https://api.github.com/users/vasild/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Previously the `Clear()` method would not have consumed anything from `fuzzed_data_provider`. Now, the `CAddrManDeterministic` constructor will consume one `uint256`, one `bool` and maybe one `RandomLengthBitVector`. I guess this is ok (it will invalidate the corpus, but I guess that is ok too).",
    "created_at": "2021-08-19T08:09:39Z",
    "updated_at": "2021-08-19T08:17:10Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691885202",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "CONTRIBUTOR",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691885202"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691885202"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691885202/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 240,
    "original_start_line": 240,
    "start_side": "LEFT",
    "line": 240,
    "original_line": 240,
    "side": "RIGHT"
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691893910",
    "pull_request_review_id": 733700858,
    "id": 691893910,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTg5MzkxMA==",
    "diff_hunk": "@@ -228,24 +228,22 @@ FUZZ_TARGET_INIT(addrman, initialize_addrman)\n {\n     FuzzedDataProvider fuzzed_data_provider(buffer.data(), buffer.size());\n     SetMockTime(ConsumeTime(fuzzed_data_provider));\n-    CAddrManDeterministic addr_man{fuzzed_data_provider};\n+    auto addr_man_ptr = std::make_unique<CAddrManDeterministic>(fuzzed_data_provider);\n     if (fuzzed_data_provider.ConsumeBool()) {\n         const std::vector<uint8_t> serialized_data{ConsumeRandomLengthByteVector(fuzzed_data_provider)};\n         CDataStream ds(serialized_data, SER_DISK, INIT_PROTO_VERSION);\n         const auto ser_version{fuzzed_data_provider.ConsumeIntegral<int32_t>()};\n         ds.SetVersion(ser_version);\n         try {\n-            ds >> addr_man;\n+            ds >> *addr_man_ptr;\n         } catch (const std::ios_base::failure&) {\n-            addr_man.Clear();\n+            addr_man_ptr = std::make_unique<CAddrManDeterministic>(fuzzed_data_provider);",
    "path": "src/test/fuzz/addrman.cpp",
    "position": 16,
    "original_position": 16,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "3fe1429a33ef181760fd21df06a4030854418be9",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The seeds are already invalidated by removing an item in `CallOneOf` below ;)",
    "created_at": "2021-08-19T08:21:24Z",
    "updated_at": "2021-08-19T08:21:24Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691893910",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691893910"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691893910"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691893910/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 240,
    "original_start_line": 240,
    "start_side": "LEFT",
    "line": 240,
    "original_line": 240,
    "side": "RIGHT",
    "in_reply_to_id": 691885202
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691896788",
    "pull_request_review_id": 733704576,
    "id": 691896788,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTg5Njc4OA==",
    "diff_hunk": "@@ -70,13 +70,22 @@ static void FillAddrMan(CAddrMan& addrman)\n \n static void AddrManAdd(benchmark::Bench& bench)\n {\n-    CreateAddresses();\n+     /* Create many CAddrMan objects - one to be modified at each loop iteration. */\n \n-    CAddrMan addrman(/* deterministic */ false, /* consistency_check_ratio */ 0);\n+    bench.epochs(5).epochIterations(1);",
    "path": "src/bench/addrman.cpp",
    "position": null,
    "original_position": 8,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "3fe1429a33ef181760fd21df06a4030854418be9",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Could also remove the make_unique and use the beautiful curly brackets?\r\n\r\n```cpp\r\nstatic void AddrManAdd(benchmark::Bench& bench)\r\n{\r\n    CreateAddresses();\r\n\r\n    bench.run([&] { \r\n        CAddrMan addrman{/* deterministic */ false, /* consistency_check_ratio */ 0};\r\n        AddAddressesToAddrMan(addrman);\r\n    }); \r\n}   \r\n",
    "created_at": "2021-08-19T08:25:13Z",
    "updated_at": "2021-08-19T08:25:13Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691896788",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691896788"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691896788"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691896788/reactions",
      "total_count": 1,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 1,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 75,
    "side": "RIGHT",
    "in_reply_to_id": 691866096
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691979535",
    "pull_request_review_id": 733813419,
    "id": 691979535,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTk3OTUzNQ==",
    "diff_hunk": "@@ -205,21 +195,16 @@ BOOST_AUTO_TEST_CASE(addrman_simple)\n     // success.\n \n     CService addr2 = ResolveService(\"250.1.1.2\", 8333);\n-    BOOST_CHECK(addrman.Add({CAddress(addr2, NODE_NONE)}, source));\n-    BOOST_CHECK(addrman.size() >= 1);\n+    BOOST_CHECK(addrman->Add({CAddress(addr2, NODE_NONE)}, source));\n+    BOOST_CHECK(addrman->size() >= 1);\n \n-    // Test: AddrMan::Clear() should empty the new table.\n-    addrman.Clear();\n-    BOOST_CHECK_EQUAL(addrman.size(), 0U);\n-    CAddrInfo addr_null2 = addrman.Select();\n-    BOOST_CHECK_EQUAL(addr_null2.ToString(), \"[::]:0\");\n-\n-    // Test: AddrMan::Add multiple addresses works as expected\n+    // Test: reset addrman and test AddrMan::Add multiple addresses works as expected\n+    addrman = std::make_unique<CAddrManTest>();\n     std::vector<CAddress> vAddr;\n     vAddr.push_back(CAddress(ResolveService(\"250.1.1.3\", 8333), NODE_NONE));\n     vAddr.push_back(CAddress(ResolveService(\"250.1.1.4\", 8333), NODE_NONE));\n-    BOOST_CHECK(addrman.Add(vAddr, source));\n-    BOOST_CHECK(addrman.size() >= 1);\n+    BOOST_CHECK(addrman->Add(vAddr, source));\n+    BOOST_CHECK(addrman->size() >= 1);",
    "path": "src/test/addrman_tests.cpp",
    "position": 86,
    "original_position": 77,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "ec132b1f86b19e8a6cc11f6138edeb2655bda80f",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "I've reverted this (and the similar change to the `addrman_serialization` test below). Constructing many large `CAddrMan` objects on the stack causes a stack overflow on some systems: https://github.com/bitcoin/bitcoin/pull/22697#issuecomment-901392680.",
    "created_at": "2021-08-19T10:16:54Z",
    "updated_at": "2021-08-19T10:16:54Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691979535",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691979535"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691979535"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691979535/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 207,
    "original_line": 207,
    "side": "RIGHT",
    "in_reply_to_id": 691029194
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691979693",
    "pull_request_review_id": 733813618,
    "id": 691979693,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTk3OTY5Mw==",
    "diff_hunk": "@@ -774,63 +759,63 @@ BOOST_AUTO_TEST_CASE(addrman_serialization)\n {\n     std::vector<bool> asmap1 = FromBytes(asmap_raw, sizeof(asmap_raw) * 8);\n \n-    CAddrManTest addrman_asmap1(true, asmap1);\n-    CAddrManTest addrman_asmap1_dup(true, asmap1);\n-    CAddrManTest addrman_noasmap;\n+    auto addrman_asmap1 = std::make_unique<CAddrManTest>(true, asmap1);\n+    auto addrman_asmap1_dup = std::make_unique<CAddrManTest>(true, asmap1);\n+    auto addrman_noasmap = std::make_unique<CAddrManTest>();\n     CDataStream stream(SER_NETWORK, PROTOCOL_VERSION);\n \n     CAddress addr = CAddress(ResolveService(\"250.1.1.1\"), NODE_NONE);\n     CNetAddr default_source;\n \n \n-    addrman_asmap1.Add({addr}, default_source);\n+    addrman_asmap1->Add({addr}, default_source);\n \n-    stream << addrman_asmap1;\n+    stream << *addrman_asmap1;\n     // serizalizing/deserializing addrman with the same asmap\n-    stream >> addrman_asmap1_dup;\n+    stream >> *addrman_asmap1_dup;\n \n-    std::pair<int, int> bucketAndEntry_asmap1 = addrman_asmap1.GetBucketAndEntry(addr);\n-    std::pair<int, int> bucketAndEntry_asmap1_dup = addrman_asmap1_dup.GetBucketAndEntry(addr);\n+    std::pair<int, int> bucketAndEntry_asmap1 = addrman_asmap1->GetBucketAndEntry(addr);\n+    std::pair<int, int> bucketAndEntry_asmap1_dup = addrman_asmap1_dup->GetBucketAndEntry(addr);\n     BOOST_CHECK(bucketAndEntry_asmap1.second != -1);\n     BOOST_CHECK(bucketAndEntry_asmap1_dup.second != -1);\n \n     BOOST_CHECK(bucketAndEntry_asmap1.first == bucketAndEntry_asmap1_dup.first);\n     BOOST_CHECK(bucketAndEntry_asmap1.second == bucketAndEntry_asmap1_dup.second);\n \n     // deserializing asmaped peers.dat to non-asmaped addrman\n-    stream << addrman_asmap1;\n-    stream >> addrman_noasmap;\n-    std::pair<int, int> bucketAndEntry_noasmap = addrman_noasmap.GetBucketAndEntry(addr);\n+    stream << *addrman_asmap1;\n+    stream >> *addrman_noasmap;\n+    std::pair<int, int> bucketAndEntry_noasmap = addrman_noasmap->GetBucketAndEntry(addr);\n     BOOST_CHECK(bucketAndEntry_noasmap.second != -1);\n     BOOST_CHECK(bucketAndEntry_asmap1.first != bucketAndEntry_noasmap.first);\n     BOOST_CHECK(bucketAndEntry_asmap1.second != bucketAndEntry_noasmap.second);\n \n     // deserializing non-asmaped peers.dat to asmaped addrman\n-    addrman_asmap1.Clear();\n-    addrman_noasmap.Clear();\n-    addrman_noasmap.Add({addr}, default_source);\n-    stream << addrman_noasmap;\n-    stream >> addrman_asmap1;\n-    std::pair<int, int> bucketAndEntry_asmap1_deser = addrman_asmap1.GetBucketAndEntry(addr);\n+    addrman_asmap1 = std::make_unique<CAddrManTest>(true, asmap1);\n+    addrman_noasmap = std::make_unique<CAddrManTest>();",
    "path": "src/test/addrman_tests.cpp",
    "position": 144,
    "original_position": 135,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "ec132b1f86b19e8a6cc11f6138edeb2655bda80f",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Reverted (see https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691979535)",
    "created_at": "2021-08-19T10:17:10Z",
    "updated_at": "2021-08-19T10:17:10Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691979693",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691979693"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691979693"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691979693/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 795,
    "original_line": 795,
    "side": "RIGHT",
    "in_reply_to_id": 691033355
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691987321",
    "pull_request_review_id": 733823431,
    "id": 691987321,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTk4NzMyMQ==",
    "diff_hunk": "@@ -208,18 +198,13 @@ BOOST_AUTO_TEST_CASE(addrman_simple)\n     BOOST_CHECK(addrman.Add({CAddress(addr2, NODE_NONE)}, source));\n     BOOST_CHECK(addrman.size() >= 1);\n \n-    // Test: AddrMan::Clear() should empty the new table.\n-    addrman.Clear();\n-    BOOST_CHECK_EQUAL(addrman.size(), 0U);\n-    CAddrInfo addr_null2 = addrman.Select();\n-    BOOST_CHECK_EQUAL(addr_null2.ToString(), \"[::]:0\");\n-\n     // Test: AddrMan::Add multiple addresses works as expected\n+    CAddrManTest addrman2{};",
    "path": "src/test/addrman_tests.cpp",
    "position": null,
    "original_position": 37,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "3fe1429a33ef181760fd21df06a4030854418be9",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "This has now been reverted so the `CAddrManTest` objects are constructed using `std::make_unique()`.",
    "created_at": "2021-08-19T10:28:42Z",
    "updated_at": "2021-08-19T10:28:42Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691987321",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691987321"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691987321"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691987321/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 202,
    "side": "RIGHT",
    "in_reply_to_id": 691872884
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691988715",
    "pull_request_review_id": 733825234,
    "id": 691988715,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTk4ODcxNQ==",
    "diff_hunk": "@@ -1167,6 +1167,20 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     assert(!node.addrman);\n     auto check_addrman = std::clamp<int32_t>(args.GetArg(\"-checkaddrman\", DEFAULT_ADDRMAN_CONSISTENCY_CHECKS), 0, 1000000);\n     node.addrman = std::make_unique<CAddrMan>(/* deterministic */ false, /* consistency_check_ratio */ check_addrman);\n+    {\n+        // Load addresses from peers.dat\n+        uiInterface.InitMessage(_(\"Loading P2P addresses\u2026\").translated);\n+        int64_t nStart = GetTimeMillis();\n+        CAddrDB adb;\n+        if (adb.Read(*node.addrman)) {\n+            LogPrintf(\"Loaded %i addresses from peers.dat  %dms\\n\", node.addrman->size(), GetTimeMillis() - nStart);\n+        } else {\n+            // Addrman can be in an inconsistent state after failure, reset it\n+            node.addrman = std::make_unique<CAddrMan>(/* deterministic */ false, /* consistency_check_ratio */ check_addrman);\n+            LogPrintf(\"Recreating peers.dat\\n\");\n+            adb.Write(*node.addrman);",
    "path": "src/init.cpp",
    "position": 15,
    "original_position": 15,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "3fe1429a33ef181760fd21df06a4030854418be9",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Yes, I don't think that log is necessary or helpful.",
    "created_at": "2021-08-19T10:30:45Z",
    "updated_at": "2021-08-19T10:30:46Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691988715",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691988715"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691988715"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691988715/reactions",
      "total_count": 1,
      "+1": 1,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": 1178,
    "original_start_line": 1178,
    "start_side": "RIGHT",
    "line": 1181,
    "original_line": 1181,
    "side": "RIGHT",
    "in_reply_to_id": 691871131
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691988738",
    "pull_request_review_id": 733825272,
    "id": 691988738,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MTk4ODczOA==",
    "diff_hunk": "@@ -70,13 +70,22 @@ static void FillAddrMan(CAddrMan& addrman)\n \n static void AddrManAdd(benchmark::Bench& bench)\n {\n-    CreateAddresses();\n+     /* Create many CAddrMan objects - one to be modified at each loop iteration. */\n \n-    CAddrMan addrman(/* deterministic */ false, /* consistency_check_ratio */ 0);\n+    bench.epochs(5).epochIterations(1);",
    "path": "src/bench/addrman.cpp",
    "position": null,
    "original_position": 8,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "3fe1429a33ef181760fd21df06a4030854418be9",
    "user": {
      "login": "jnewbery",
      "id": 1063656,
      "node_id": "MDQ6VXNlcjEwNjM2NTY=",
      "avatar_url": "https://avatars.githubusercontent.com/u/1063656?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/jnewbery",
      "html_url": "https://github.com/jnewbery",
      "followers_url": "https://api.github.com/users/jnewbery/followers",
      "following_url": "https://api.github.com/users/jnewbery/following{/other_user}",
      "gists_url": "https://api.github.com/users/jnewbery/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/jnewbery/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/jnewbery/subscriptions",
      "organizations_url": "https://api.github.com/users/jnewbery/orgs",
      "repos_url": "https://api.github.com/users/jnewbery/repos",
      "events_url": "https://api.github.com/users/jnewbery/events{/privacy}",
      "received_events_url": "https://api.github.com/users/jnewbery/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "The reason to construct the addrman objects outside the bench run is to prevent the time spent in constructing the object being included in the bench. I think that would be especially bad and could lead to variance if we're allocating memory for the object by making a unique_ptr.\r\n\r\nI've reverted to Marco's suggested version, which shouldn't be any worse than the current code, which calls `Clear()`.",
    "created_at": "2021-08-19T10:30:48Z",
    "updated_at": "2021-08-19T10:30:48Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691988738",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691988738"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r691988738"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/691988738/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": null,
    "original_line": 75,
    "side": "RIGHT",
    "in_reply_to_id": 691866096
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692102040",
    "pull_request_review_id": 733976328,
    "id": 692102040,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5MjEwMjA0MA==",
    "diff_hunk": "@@ -1167,6 +1167,20 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     assert(!node.addrman);\n     auto check_addrman = std::clamp<int32_t>(args.GetArg(\"-checkaddrman\", DEFAULT_ADDRMAN_CONSISTENCY_CHECKS), 0, 1000000);\n     node.addrman = std::make_unique<CAddrMan>(/* deterministic */ false, /* consistency_check_ratio */ check_addrman);\n+    {",
    "path": "src/init.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "3fe1429a33ef181760fd21df06a4030854418be9",
    "user": {
      "login": "laanwj",
      "id": 126646,
      "node_id": "MDQ6VXNlcjEyNjY0Ng==",
      "avatar_url": "https://avatars.githubusercontent.com/u/126646?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/laanwj",
      "html_url": "https://github.com/laanwj",
      "followers_url": "https://api.github.com/users/laanwj/followers",
      "following_url": "https://api.github.com/users/laanwj/following{/other_user}",
      "gists_url": "https://api.github.com/users/laanwj/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/laanwj/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/laanwj/subscriptions",
      "organizations_url": "https://api.github.com/users/laanwj/orgs",
      "repos_url": "https://api.github.com/users/laanwj/repos",
      "events_url": "https://api.github.com/users/laanwj/events{/privacy}",
      "received_events_url": "https://api.github.com/users/laanwj/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "Ok, I agree. I hope it can be factored out again at some point to a place that makes sense.",
    "created_at": "2021-08-19T13:18:50Z",
    "updated_at": "2021-08-19T13:18:51Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r692102040",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692102040"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r692102040"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692102040/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1170,
    "original_line": 1170,
    "side": "RIGHT",
    "in_reply_to_id": 691310217
  },
  {
    "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692857462",
    "pull_request_review_id": 734913101,
    "id": 692857462,
    "node_id": "MDI0OlB1bGxSZXF1ZXN0UmV2aWV3Q29tbWVudDY5Mjg1NzQ2Mg==",
    "diff_hunk": "@@ -1167,6 +1167,20 @@ bool AppInitMain(NodeContext& node, interfaces::BlockAndHeaderTipInfo* tip_info)\n     assert(!node.addrman);\n     auto check_addrman = std::clamp<int32_t>(args.GetArg(\"-checkaddrman\", DEFAULT_ADDRMAN_CONSISTENCY_CHECKS), 0, 1000000);\n     node.addrman = std::make_unique<CAddrMan>(/* deterministic */ false, /* consistency_check_ratio */ check_addrman);\n+    {",
    "path": "src/init.cpp",
    "position": 4,
    "original_position": 4,
    "commit_id": "4d2fa97031a6f31da984d4c2c105447ed692c6ed",
    "original_commit_id": "3fe1429a33ef181760fd21df06a4030854418be9",
    "user": {
      "login": "MarcoFalke",
      "id": 6399679,
      "node_id": "MDQ6VXNlcjYzOTk2Nzk=",
      "avatar_url": "https://avatars.githubusercontent.com/u/6399679?v=4",
      "gravatar_id": "",
      "url": "https://api.github.com/users/MarcoFalke",
      "html_url": "https://github.com/MarcoFalke",
      "followers_url": "https://api.github.com/users/MarcoFalke/followers",
      "following_url": "https://api.github.com/users/MarcoFalke/following{/other_user}",
      "gists_url": "https://api.github.com/users/MarcoFalke/gists{/gist_id}",
      "starred_url": "https://api.github.com/users/MarcoFalke/starred{/owner}{/repo}",
      "subscriptions_url": "https://api.github.com/users/MarcoFalke/subscriptions",
      "organizations_url": "https://api.github.com/users/MarcoFalke/orgs",
      "repos_url": "https://api.github.com/users/MarcoFalke/repos",
      "events_url": "https://api.github.com/users/MarcoFalke/events{/privacy}",
      "received_events_url": "https://api.github.com/users/MarcoFalke/received_events",
      "type": "User",
      "site_admin": false
    },
    "body": "See #22754",
    "created_at": "2021-08-20T10:57:09Z",
    "updated_at": "2021-08-20T10:57:09Z",
    "html_url": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r692857462",
    "pull_request_url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697",
    "author_association": "MEMBER",
    "_links": {
      "self": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692857462"
      },
      "html": {
        "href": "https://github.com/bitcoin/bitcoin/pull/22697#discussion_r692857462"
      },
      "pull_request": {
        "href": "https://api.github.com/repos/bitcoin/bitcoin/pulls/22697"
      }
    },
    "reactions": {
      "url": "https://api.github.com/repos/bitcoin/bitcoin/pulls/comments/692857462/reactions",
      "total_count": 0,
      "+1": 0,
      "-1": 0,
      "laugh": 0,
      "hooray": 0,
      "confused": 0,
      "heart": 0,
      "rocket": 0,
      "eyes": 0
    },
    "start_line": null,
    "original_start_line": null,
    "start_side": null,
    "line": 1170,
    "original_line": 1170,
    "side": "RIGHT",
    "in_reply_to_id": 691310217
  }
]