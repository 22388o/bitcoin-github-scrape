DrahtBot,2020-03-06 06:43:32,"<!--e57a25ab6845829454e8d69fc972939a-->\n\nThe following sections might be updated with supplementary metadata relevant to reviewers and maintainers.\n\n<!--174a7506f384e20aa4161008e828411d-->\n### Conflicts\nReviewers, this pull request conflicts with the following ones:\n\n* #17526 (Use Single Random Draw In addition to knapsack as coin selection fallback by achow101)\n* #17331 (Use effective va",https://github.com/bitcoin/bitcoin/pull/18275#issuecomment-595625000,595625000,
Sjors,2020-03-06 17:27:49,Can you add a test with `createfundedpsbt`'s `feeRate` argument?,https://github.com/bitcoin/bitcoin/pull/18275#issuecomment-595875359,595875359,
kallewoof,2020-03-07 01:30:08,"> Can you add a test with `createfundedpsbt`'s `feeRate` argument?\n\nI tried and that takes me all the way to `sendrawtransaction` before it hits `min relay fee not met, 1 < 141`. The PSBT stuff doesn't use the same method, unfortunately.",https://github.com/bitcoin/bitcoin/pull/18275#issuecomment-596028767,596028767,
Sjors,2020-03-07 09:12:10,"I was hoping this was only an RPC issue. The error message is not very GUI friendly, but this should be bellt-and-suspenders check. The GUI is supposed to prevent you from entering a too low amount.\n\nYour screenshot is a bit confusing, because the UI automatically corrects the input form when the value is below the minimum relay fee. But that correction only happens when you click somewhere el",https://github.com/bitcoin/bitcoin/pull/18275#issuecomment-596065493,596065493,
fjahr,2020-03-13 17:12:15,"tACK 7ac14a5a86d6bc8f15cf2c336a1bf560babf0c84\n\n",https://github.com/bitcoin/bitcoin/pull/18275#issuecomment-598826361,598826361,
meshcollider,2020-04-17 10:54:17,Concept ACK,https://github.com/bitcoin/bitcoin/pull/18275#issuecomment-615181285,615181285,
kallewoof,2020-04-24 05:01:45,"As @MarcoFalke pointed out, this actually does *not* rely on the current mempool limitations. I've updated the error message accordingly. It now reads\n\n> ""Fee rate is lower than the minimum fee rate setting. Increase it to %s or modify -minrelaytxfee"", nFeeRateNeeded.ToString()\n",https://github.com/bitcoin/bitcoin/pull/18275#issuecomment-618802784,618802784,
fjahr,2020-04-30 15:49:52,"re-ACK b8711d07c85271b31f035686f77d44ee1c7a4365\n\nOnly changes were rebasing and improvement of the error message.",https://github.com/bitcoin/bitcoin/pull/18275#issuecomment-621939382,621939382,
MarcoFalke,2020-05-01 13:31:10,I can not reproduce with the steps given here: https://github.com/bitcoin/bitcoin/pull/18275#discussion_r389212618,https://github.com/bitcoin/bitcoin/pull/18275#issuecomment-622389107,622389107,
MarcoFalke,2020-05-01 13:43:23,"Couldn't reproduce either with `feeRate` in fundrawtransaction. Still Concept ACK as a belt and suspenders, but this doesn't fix a bug I can reproduce.",https://github.com/bitcoin/bitcoin/pull/18275#issuecomment-622393944,622393944,
kallewoof,2020-05-02 05:52:16,"> I can not reproduce with the steps given here: [#18275 (comment)](https://github.com/bitcoin/bitcoin/pull/18275#discussion_r389212618)\n\nAre you trying to reproduce on this branch or on master? On master, this is what it ends up like (note that it silently resets my desired fee rate when I defocus and/or click send): https://youtu.be/I0JZpmJ-Gls",https://github.com/bitcoin/bitcoin/pull/18275#issuecomment-622674066,622674066,
MarcoFalke,2020-05-02 20:51:29,"I mean I couldn't get the newly introduced error to execute. Not in the GUI, and not in the RPC. \n\nJust tried again with recompile. Maybe this is a mac-specific issue? Or I have something in my gui settings that prevents it.",https://github.com/bitcoin/bitcoin/pull/18275#issuecomment-623011640,623011640,
Sjors,2020-05-04 10:14:22,tACK b8711d07c85271b31f035686f77d44ee1c7a4365. Just a rebase and text improvement since my last review.,https://github.com/bitcoin/bitcoin/pull/18275#issuecomment-623378672,623378672,
kallewoof,2020-05-04 12:49:19,"@MarcoFalke Sorry about that [previous now-deleted comment showing 'settxfee' error], I got the messages mixed up. You're right that it doesn't seem possible to trigger this error from RPC/CLI. To trigger in QT, you need to change the fee rate and then click send without defocusing the window. This is probably platform dependent, so it may not be reproducable on non-macOS.",https://github.com/bitcoin/bitcoin/pull/18275#issuecomment-623443683,623443683,
Sjors,2020-05-04 13:50:18,Just double checked: I can still produce this error in the GUI.,https://github.com/bitcoin/bitcoin/pull/18275#issuecomment-623476025,623476025,
MarcoFalke,2020-05-04 15:12:14,"code-review-only ACK b8711d07c85271b31f035686f77d44ee1c7a4365, seems this can only be hit on macos",https://github.com/bitcoin/bitcoin/pull/18275#issuecomment-623523101,623523101,
meshcollider,2020-05-05 03:30:15,"There is a silent merge conflict, `strFailReason` no longer exists on master (it has been replaced by a `bilingual_str` called `error`)",https://github.com/bitcoin/bitcoin/pull/18275#issuecomment-623813972,623813972,
kallewoof,2020-05-05 05:07:13,"@meshcollider ~Weird. Git happily automerged everything when I rebased on latest master. Pushed that rebase though.~\n\nEdit: Yeah, nevermind. Fixed.",https://github.com/bitcoin/bitcoin/pull/18275#issuecomment-623858555,623858555,
Sjors,2020-05-05 17:53:11,utACK 44cc75f80ee7805a117e9298a182af1a44bcbff4 (rebased),https://github.com/bitcoin/bitcoin/pull/18275#issuecomment-624210197,624210197,
fjahr,2020-05-05 20:54:27,re-ACK 44cc75f80ee7805a117e9298a182af1a44bcbff4,https://github.com/bitcoin/bitcoin/pull/18275#issuecomment-624300716,624300716,
Sjors,2020-06-16 10:07:13,@meshcollider?,https://github.com/bitcoin/bitcoin/pull/18275#issuecomment-644668697,644668697,
MarcoFalke,2020-03-06 19:04:44,"The mempool fee is not considered when the user picks the fee rate. See also https://doxygen.bitcoincore.org/wallet_2fees_8cpp_source.html#l00028\n\nHow did you trigger this bug? It would be nice to include a test vector or steps to reproduce, otherwise this will just be dead code.",https://github.com/bitcoin/bitcoin/pull/18275#discussion_r389086562,389086562,src/wallet/wallet.cpp
Sjors,2020-03-06 19:14:37,@MarcoFalke the error is triggered by setting a fee rate below 1 sat / byte in the updated `sendtoaddress` RPCs in #11413. See https://github.com/bitcoin/bitcoin/pull/11413#issuecomment-593284781 for discussion and some alternative ideas. ,https://github.com/bitcoin/bitcoin/pull/18275#discussion_r389091168,389091168,src/wallet/wallet.cpp
MarcoFalke,2020-03-06 19:18:24,"If it is not possible to hit this case with Bitcoin Core master, it probably makes sense to only add it when it can be hit. And also add a test to hit it.",https://github.com/bitcoin/bitcoin/pull/18275#discussion_r389093005,389093005,src/wallet/wallet.cpp
kallewoof,2020-03-07 01:21:43,"I triggered it with no problem in bitcoin-qt (set fee to 0.00000001 btc/kb; note that the GUI has changed it back to the minimum in the screenshot after I clicked ""Send"")...\n\n<img width=""744"" alt=""Screen Shot 2020-03-07 at 10 20 51"" src=""https://user-images.githubusercontent.com/250224/76133784-383d7c00-605d-11ea-847b-c6f1596ceb51.png"">\n\nWithout this patch, it goes to confirm screen, silen",https://github.com/bitcoin/bitcoin/pull/18275#discussion_r389212618,389212618,src/wallet/wallet.cpp
kallewoof,2020-03-07 01:38:23,"> The mempool fee is not considered when the user picks the fee rate. See also https://doxygen.bitcoincore.org/wallet_2fees_8cpp_source.html#l00028\n> \n> How did you trigger this bug? It would be nice to include a test vector or steps to reproduce, otherwise this will just be dead code.\n\nThat code calls `mempoolMinFee()` though.",https://github.com/bitcoin/bitcoin/pull/18275#discussion_r389214542,389214542,src/wallet/wallet.cpp
MarcoFalke,2020-04-17 11:05:24,"> That code calls mempoolMinFee() though.\n\nNo? It doesn't.\n\nThe code is\n\n```cpp\n         // Obey mempool min fee when using smart fee estimation\n         CFeeRate min_mempool_feerate = wallet.chain().mempoolMinFee();\n```\n\nSetting a fee manually in the gui is not ""smart fee"". What am I missing?",https://github.com/bitcoin/bitcoin/pull/18275#discussion_r410152462,410152462,src/wallet/wallet.cpp
kallewoof,2020-04-24 05:00:11,"You're not missing anything, because you're absolutely right. Should've read the code more carefully...\n\nI've fixed the message.",https://github.com/bitcoin/bitcoin/pull/18275#discussion_r414293650,414293650,src/wallet/wallet.cpp
MarcoFalke,2020-04-24 12:04:21,"\n\nI don't think we should encourage user to modify the min relay fee in reply to issues the wallet or rpc encounters. Lowering your min fee won't change transaction broadcast, as all your peers will still send you the same feefilter.",https://github.com/bitcoin/bitcoin/pull/18275#discussion_r414522852,414522852,src/wallet/wallet.cpp
kallewoof,2020-04-25 01:57:24,"Yeah, I'm not sure what to say here, though. That *is* the only way to do what they're attempting to do.",https://github.com/bitcoin/bitcoin/pull/18275#discussion_r414951144,414951144,src/wallet/wallet.cpp
MarcoFalke,2020-04-25 12:22:21,"```suggestion\n                strFailReason = strprintf(""Fee rate (%s) is lower than the minimum fee rate setting (%s)"", coin_control.m_feerate->ToString(), nFeeRateNeeded.ToString());\n```",https://github.com/bitcoin/bitcoin/pull/18275#discussion_r415052007,415052007,src/wallet/wallet.cpp
kallewoof,2020-04-25 14:19:28,Applied.,https://github.com/bitcoin/bitcoin/pull/18275#discussion_r415072064,415072064,src/wallet/wallet.cpp
